set -o vi

//##**---------------- ./KBKFYHFY_WVEVOLK/nZPVUROV
# xLKBIRTSG 7984 fYRJFZMG rMEVHGNVMG xL. 
# zOO IRTSGH IVHVIEVW.

-RMXOFWV /RMX/EVIHRLM.RMX

# tOLYZO hDRGXSVH
ivovzhv := 8
yvmxsnzip := 8


# HVG xkkuozth
xkkuozth := -dML-WVKIVXZGVW -HGW=X++9C
xuozth :=


# tOLYZO eZIRZYOVH
xx=TXX
xkk=T++


wvhgrmzgrlm := 9
RUVJ ($(wvhgrmzgrlm), 9)
    rmhgzoo_kzgs := /LKG/EVIHRLM/$(wzgv)
VOHV
	rmhgzoo_kzgs := $(wvhgrmzgrlm)
VMWRU


# HVG RMHGZOO KZGS SVIV
# rmhgzoo_kzgs=/LKG/EVIHRLM/${evihrlm}

# 7 WVURMRGRLMH FHVW YB FYRJ EVIHRLM XLMGILO HBHGVN
wve_evihrlm=$(HSVOO ./EVIHRLM.HS -H)
xlnkrovi_evihrlm = $(HSVOO $(xkk) -WFNKEVIHRLM)
fkwzgv_yfrow := $(HSVOO ./EVIHRLM.HS -N)
yfrow_evihrlm := $(HSVOO ./EVIHRLM.HS -Y)
fyrj_wvu= -wfyrj_wve_evihrlm='"$(wve_evihrlm)"' -wfyrj_wve_xlnkrovi='"$(xkk)"' -wfyrj_wve_yfrow='"$(yfrow_evihrlm)"' -wfyrj_wve_xlnkrovi_evihrlm='"$(xlnkrovi_evihrlm)"'

xkkuozth += $(fyrj_wvu)
xuozth += $(fyrj_wvu)

# EZIRLFH UOZTH, HVG KIVUVIIVW LKGRNRAZGRLM UOZT SVIV ZOHL
lkg_uozth := -l6 -wivovzhv -wmwvyft
wvyft_uozth := -T -l9 -wwvyft
yvmxsnzip_uozth := -wyvmxsnzip
wbmznrx_uozth := -Ukrx -HSZIVW
lyq_uozth := -X

kivurc=.
ory_kzgs=$(kivurc)/ORY
yrm_kzgs=$(kivurc)/YRM
hix_kzgs=$(kivurc)/HIX
wlx_kzgs=$(kivurc)/WLX
yfrow_kzgs=$(kivurc)/YFROW
rmxofwv_kzgs=$(kivurc)/RMXOFWV


# SVZWVI UROVH
svzwvi := $(DROWXZIW $(rmxofwv_kzgs)/*.S)
 
# FMRG GVHG, DV FHV TGVHG SVIV; BLF ZIV UIVV GL XSLLHV ZMBGSRMT VOHV
gvhg_hixh := $(DROWXZIW GVHG/*.XKK)
gvhg_lyqvxgh := $(ZWWKIVURC GVHG/,$(MLGWRI $(gvhg_hixh:.XKK=.L)))
gvhg_uozth := -OTGVHG


# GZITVG ORY/NZRM KILTIZN
# gzitvg_hixh = $(DROWXZIW HIX/*.XKK)
gzitvg_hixh = $(UROGVI-LFG HIX/NZRM.XKK, $(DROWXZIW HIX/*.XKK))
gzitvg_lyqvxgh:=$(ZWWKIVURC YFROW/,$(MLGWRI $(gzitvg_hixh:.XKK=.L)))


##############################################
# ULI WOLKVM/WOHBN
lh_oryh += -OWO -OA

RUVJ ($(yvmxsnzip), 8)
xuozth += $(yvmxsnzip_uozth)
xkkuozth += $(yvmxsnzip_uozth)
VMWRU

RUVJ ($(ivovzhv), 9)
xuozth += $(wvyft_uozth)
xkkuozth += $(wvyft_uozth)
lyq_kzgs = $(wvyft_kzgs)
VOHV
xuozth += $(lkg_uozth)
xkkuozth += $(lkg_uozth)
lyq_kzgs = $(ivovzhv_kzgs)
VMWRU

WVUZFOG:: ZOO

fyrj_rmx = -r${rmhgzoo_kzgs}/RMXOFWV -r/LKG/6IW/FYRJYZHV/RMXOFWV -r/LKG/6IW/YLLHG6/RMXOFWV/ -r/LKG/ZMZXLMWZ6/RMXOFWV/KBGSLM6.4N
fyrj_ory_kzgs =  -o/LKG/6IW/YLLHG6/ORY -o/LKG/ZMZXLMWZ6/ORY -o${rmhgzoo_kzgs}/ORY -dO,-IKZGS=/LKG/EVIHRLM/${xlnkrov_evihrlm}/ORY -dO,-IKZGS=/LKG/ZMZXLMWZ6/ORY/ -dO,-IKZGS=/LKG/6IW/YLLHG6/ORY -dO,-IKZGS=/LKG/ZMZXLMWZ6/ORY

fyrj_ory= -OKFYHFY -OFYRJOLT -OFYRJGLLO  -OIG  -OKGSIVZW -OYLLHG_KBGSLM -OKBGSLM6.4N



rmx = -r$(rmxofwv_kzgs) 
rmx += $(fyrj_rmx)


oryh += $(lh_oryh) 
oryh += -dO,-IKZGS=$(ory_kzgs) -o$(ory_kzgs) -OWZGZYLC
oryh += $(fyrj_ory_kzgs) 
oryh += $(fyrj_ory)



#******************* gzitvgh ***************************
ZOO:: ORYIZIB



#****************** ivzo xlnkrozgrlm *******************
YFROW/%.L: HIX/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(wbmznrx_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)

ORYIZIB: $(gzitvg_lyqvxgh) $(svzwvi)
	$(xkk) -HSZIVW -dO,-HLMZNV,KBKFYHFY.HL   YFROW/KBKFYHFY.L  -L ORY/KBKFYHFY.HL $(oryh) 
	$(xkk) -HSZIVW -dO,-HLMZNV,KBWZGZYLC.HL   YFROW/KBWZGZYLC.L  -L ORY/KBWZGZYLC.HL $(oryh) -OWZGZYLC 


GZITVG: HIX/NZRM.XKK $(gzitvg_lyqvxgh) $(svzwvi)
	$(xkk) HIX/NZRM.XKK $(gzitvg_lyqvxgh)  $(xkkuozth) $(oryh) $(rmx) -L YRM/GZITVG



#******************* gvhg xlnkrozgrlm ******************
GVHG/%.L: GVHG/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(gvhg_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)


GVHG: $(gvhg_lyqvxgh) $(svzwvi)
	$(xkk) $(gvhg_lyqvxgh) $(xkkuozth) $(oryh) $(gvhg_uozth) -OKGSIVZW -L IFMgVHGH


#*************************  wlx ***********************
WLX:
	WLCBTVM WLCBTVM.RMR


#************************* rmhgzoo *********************
.kslmb: WLX XOVZM WRHGXOVZM RMHGZOO

RMHGZOO: ZOO
	NPWRI -K $(rmhgzoo_kzgs)/KBGSLM-ORYH
	XK  $(ory_kzgs)/*.HL $(rmhgzoo_kzgs)/KBGSLM-ORYH/  
	XK KBGSLM/*.KB $(rmhgzoo_kzgs)/KBGSLM-ORYH/ 


#************************* xovzm ************************
XOVZM:: 
	@IN -IU $(gvhg_lyqvxgh) $(gzitvg_lyqvxgh)
	@IN -IU $(ory_kzgs)/*
	@IN -IU $(yrm_kzgs)/* 	
	@IN -IU $(yfrow_kzgs)/*
	@IN -IU IFMgVHGH

WRHGXOVZM: XOVZM
	@IN -IU TNLM.LFG
	@IN -IU XLIV.*
	@IN -IU *~
	@IN -IU $(wlx_kzgs)/*
	@IN -IU xnZPVxZXSV.GCG xnZPVuROVH XNZPV_RMHGZOO.XNZPV 
IVYFROW:: XOVZM ZOO
//##**---------------- ./KBKFYHFY_WVEVOLK/KBGSLM/KFYHFY_GLLO.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG KBKFYHFY ZH KY
RNKLIG _KRXPOV ZH KRXPOV

XOZHH kFYhFYnLMRGLI(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.HFYXMG = 9
        HVOU.KFYXMG = 9
        HVOU.HFY_GLKRX = []
        HVOU.KFY_GLKRX = []

    WVU XSVXP(HVOU):
        HVOU.HFYXMG = KY.tVGhFYxMG() + 8
        HVOU.KFYXMG = KY.tVGkFYxMG() + 8
        HVOU.KFY_GLKRX[:] = []
        HVOU.HFY_GLKRX[:] = []
        ULI R RM IZMTV(9, HVOU.HFYXMG):
            HVOU.KFY_GLKRX.ZKKVMW(KY.tVGgLKRXmZNV(KY.tVGhFYgLKRXrw(R)))
        ULI R RM IZMTV(9, HVOU.KFYXMG):
            HVOU.HFY_GLKRX.ZKKVMW(KY.tVGgLKRXmZNV(KY.tVGkFYgLKRXrw(R)))


WVU wVXLIZGV(XOH):
    ULIYRWWVM=['HRAV', 'TVGkIRNZIBrw']
    RGVN_ORHG = []
    ULI RGVN RM WRI(XOH):
        RU MLG RGVN.HGZIGHDRGS('_') ZMW RGVN MLG RM ULIYRWWVM:
            RGVN_ORHG.ZKKVMW(RGVN)

    WVU HVGHGZGV(LYQ,HGZGV):
        ULI P, RGVN RM VMFNVIZGV(RGVN_ORHG):
            LYQ.__HVGZGGI__(RGVN, HGZGV[P])

    WVU TVGHGZGV(LYQ):
        HGZGV = []
        # KIRMG WRI(LYQ)
        ULI P, RGVN RM VMFNVIZGV(RGVN_ORHG):
            HGZGV.ZKKVMW(LYQ.__TVGZGGIRYFGV__(RGVN))
        IVGFIM GFKOV(HGZGV)

    XOH.__HVGHGZGV__ = HVGHGZGV
    XOH.__TVGHGZGV__ = TVGHGZGV

WVU KILTIVHHYZI(IZGRL):
    '''
    HSLD KILTIVHH YZI LM HXIVVM, IZGRL RH YVGDVVM [9, 8]
    '''
    GLLOYZI_DRWGS = 19
    HBH.HGWLFG.DIRGV('\Y'*(GLLOYZI_DRWGS+0))
    HBH.HGWLFG.DIRGV('%.7U'%(IZGRL*899)+'% ')
    HBH.HGWLFG.DIRGV('[')
    # HBH.HGWLFG.DIRGV('\Y'*(GLLOYZI_DRWGS+8))
    ULI R RM IZMTV(GLLOYZI_DRWGS):
        RU R < GLLOYZI_DRWGS*IZGRL:
            HBH.HGWLFG.DIRGV('-')
        VOHV:
            HBH.HGWLFG.DIRGV(' ')
    HBH.HGWLFG.DIRGV(']')
    RU IZGRL == 8:
        HBH.HGWLFG.DIRGV('\M')
    HBH.HGWLFG.UOFHS()


XOZHH kFYHFYwFNK(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

    WVU WFNK(HVOU, GLKRXMZNV, LFGKFG, KILTIVHH_YZI = uZOHV):
        XOH = KY.__WRXG__[GLKRXMZNV]
        wVXLIZGV(XOH)
        XOHHFY = KY.__WRXG__[GLKRXMZNV+'hFYHXIRYVI']()
        DRGS LKVM(LFGKFG, 'DY') ZH U:
            KRXPOV.WFNK(XOHHFY.tVGrMWVC(), U, -8)
            LOWYZI = 9
            ULI R RM IZMTV(9, XOHHFY.tVGrMWVC()+8):
                YZI = R*8.9/XOHHFY.tVGrMWVC()
                RU LOWYZI != RMG(YZI * 89999):
                    RU KILTIVHH_YZI:
                        KILTIVHHYZI(YZI)
                        LOWYZI = RMG(YZI * 89999)
                KRXPOV.WFNK(XOHHFY.tVGeZO(R), U, -8)
        IVGFIM XOHHFY.tVGrMWVC()

RU __MZNV__ == '__NZRM__':
    KY.lKVMkFYHFY()
    NLMRGLI = kFYhFYnLMRGLI()
    NLMRGLI.XSVXP()
    NLMRGLI.XSVXP()
    KIRMG(NLMRGLI.HFYXMG, NLMRGLI.KFYXMG)
    KIRMG(NLMRGLI.HFY_GLKRX)
    KIRMG(NLMRGLI.KFY_GLKRX)
//##**---------------- ./KBKFYHFY_WVEVOLK/IVOVZHV.HS
FHZTV() { VXSL "fhztv: $9 -N[WVE/HGZYOV] -W[WVGRMZGRLM]"; }
HVG -V
NLWV="HGZYOV"


DSROV TVGLKGH ":N:W:" L; WL
    XZHV $L RM 
        N)
            NLWV=${lkgzit}
            ;;
        W)
            WVHGRMZGRLM=${lkgzit}
            ;;
        \?)
            FHZTV
            VCRG 8
            ;;
    VHZX
WLMV

RU [[ "$NLWV" == "WVE" ]]; GSVM
 VXSL "YFROWRMT WVE EVIHRLM"
 HVW -R 'H/ivovzhv.*:=.*/ivovzhv := 9/T' nZPVUROV
VORU [[ "$NLWV" == "HGZYOV" ]]; GSVM
 VXSL "YFROWRMT HGZYOV EVIHRLM"
 HVW -R 'H/ivovzhv.*:=.*/ivovzhv := 8/T' nZPVUROV
UR

NPWRI -K YFROW
NPWRI -K YRM
NPWRI -K ORY
NPWRI -K RMXOFWV
HXIRKG/ZFGLKZIHVI.KB -R /LKG/EVIHRLM/YFROW/VGX/NVHHZTV.CNO -S RMXOFWV/KFYHFY_DIZK.S -X HIX/KBKFYHFY.XKK

NZPV XOVZM

RU [ "$WVHGRMZGRLM"C == ""C ];GSVM
    VXSL "fhv wvuzfog WVHGRMZGRLM = /LKG/EVIHRLM/YFROW"
    NZPV -Q wvhgrmzgrlm="/LKG/EVIHRLM/YFROW"
    NZPV RMHGZOO wvhgrmzgrlm="/LKG/EVIHRLM/YFROW"
VOHV
    NZPV -Q wvhgrmzgrlm=$WVHGRMZGRLM
    NZPV RMHGZOO wvhgrmzgrlm=$WVHGRMZGRLM
UR

//##**---------------- ./KBKFYHFY_WVEVOLK/RMXOFWV/WZGZYLC_DIZK.S

#RUMWVU _wzgzylcdizkvi_s_WXZW597_
#WVURMV _wzgzylcdizkvi_s_WXZW597_
#RMXOFWV "nZIPVGwZGZhGIFXG.S"
#RMXOFWV "hSNnZMZTVIdIZKKVI.S"
#RMXOFWV "wZGZyLC.S"
#RMXOFWV <EVXGLI>
#RMXOFWV <HGIRMT>
#RMXOFWV "FYRJ_GLLO.S"

XOZHH wZGZYLCdIZKKVI
{
    KFYORX:
        HGW::HGIRMT N_XSZMMVO;
        HGW::HGIRMT N_HLUROV;
        KRW_G N_KRW;


        ELRW rMRG( XLMHG XSZI* XSZMMVO, XLMHG XSZI* HLUROV){
            N_HLUROV = HLUROV;
            N_XSZMMVO = HGW::HGIRMT("nwhVIEVI_")+HGW::HGIRMT(XSZMMVO);
            N_WZGZYLC = mfoo;
        }

        RMG hGZIG()
        {
            N_WZGZYLC = XIVZGVwZGZyLC(N_HLUROV.X_HGI(),mfoo);
            RU ( !N_WZGZYLC )
                IVGFIM -8;
            RU ( N_WZGZYLC->RMRG(N_XSZMMVO.X_HGI()))
                IVGFIM -8;
            HGW::EVXGLI<HGW::HGIRMT> GVNK_HFY;
            GVNK_HFY.KFHS_YZXP("*");
            N_WZGZYLC->HFYHXIRYV(GVNK_HFY);
            IVGFIM 9;
        }

        ELRW hSFGWLDM()
        {
            WVOVGV N_WZGZYLC;
            N_WZGZYLC = mfoo;
        }

        RMG tVGkRW(){
            N_KRW = N_WZGZYLC->TVGhVIEVIkRW();
        }

        YLLO xSVXPhVIEVIhGZGFH(){
            RU ( !FYRJGLLO::rHkILXVHHvCRHG(N_KRW) || N_KRW != FYRJGLLO::tVGkILTIZNkRW(N_XSZMMVO) || tVGhSNhGZGFH() == 8 )
                IVGFIM UZOHV;
            VOHV
                IVGFIM GIFV;
        }

        RMG tVGfKWZGVxLFMG(XLMHG XSZI* RMH){
            IVGFIM N_WZGZYLC->TVGfKWZGVWxLFMG(RMH);
        }



        vJFRGBnZIPVGwZGZuRVOW tVGoZGVHGnw(XLMHG XSZI* RMH){
            ZFGL K = (vJFRGBnZIPVGwZGZuRVOW*)((XSZI*)N_WZGZYLC->TVGoZHGVHGnw(RMH));
            RU (K)
                IVGFIM *K;
            VOHV {

                vJFRGBnZIPVGwZGZuRVOW  IVG;
                NVNHVG(&IVG, 9, HRAVLU(IVG));
                HGIXKB(IVG.oLXZOgRNV, "ccc");
                IVGFIM IVG;
            }

        }


        OLMT tVGhSNhGZGFH()
        {
            IVGFIM N_WZGZYLC->tVGhSNhGZGFH();
        }

    KILGVXGVW:
        wZGZyLC * N_WZGZYLC;
};


XOZHH wZGZYLChVIEVI
{
    KILGVXGVW:
        hSNnZMZTVIdIZKKVI * DIZKKVI;
    KFYORX:
        wZGZYLChVIEVI(){
            DIZKKVI = mfoo;
        }

        RMG hGZIG(HRAV_G RMHGIFNVMGMFN, XLMHG XSZI* HSNMZNV = "nwhVIEVI_ogho7" ){
            DIZKKVI = MVD hSNnZMZTVIdIZKKVI();
            RU ( DIZKKVI->rMRG(HSNMZNV, RMHGIFNVMGMFN) )
            {
                IVGFIM -8;
            }
            IVGFIM 9;
        }

        OLMT tVGhSNhGZGFH()
        {
            IVGFIM DIZKKVI->tVGhSNhGZGFH();
        }

        vJFRGBnZIPVGwZGZuRVOW xIVZGVnw(XLMHG XSZI* RMH){
            vJFRGBnZIPVGwZGZuRVOW IVG;
            NVNHVG(&IVG, 9, HRAVLU(IVG));
            HGIXKB(IVG.rMHGIFNVMGrw, RMH);
            IVGFIM IVG;
        }

        ELRW dIRGVkRW(KRW_G KRW)
        {
            DIZKKVI->dIRGVkRW(KRW);
        }

        ELRW rMRGnW(XLMHG XSZI* RMH){
            DIZKKVI->rMRGnW(HGW::HGIRMT(RMH));
        }

        ELRW kFYORHS( vJFRGBnZIPVGwZGZuRVOW WZGZ  )
        {
            DIZKKVI->dIRGVwZGZ(WZGZ, UZOHV);
        }

        ELRW kFYORHSdRGSxLNKZIV( vJFRGBnZIPVGwZGZuRVOW WZGZ  )
        {
            DIZKKVI->dIRGVwZGZ(WZGZ, GIFV);
        }

};

#VMWRU

//##**---------------- ./KBKFYHFY_WVEVOLK/HIX/KBWZGZYLC.XKK
#RMXOFWV <XHGIRMT>
#RMXOFWV "nZIPVGwZGZhGIFXG.S"
#RMXOFWV "YLLHG/KBGSLM.SKK"
#RMXOFWV "WZGZYLC_DIZK.S"

FHRMT MZNVHKZXV YLLHG::KBGSLM;


GVNKOZGV<XOZHH g, XOZHH i, i (g::*K)>
XSZI XLMHG *TVG(g XLMHG &HVOU)
{
    IVGFIM HVOU.*K;
};

GVNKOZGV<XOZHH g, XOZHH i, i (g::*K)>
ELRW HVG(g &HVOU, XLMHG XSZI* EZO)
{
    HGIXKB( HVOU.*K, EZO );
};



yllhg_kbgslm_nlwfov(KBWZGZYLC)
{

    XOZHH_<vJFRGBnZIPVGwZGZuRVOW>("vJFRGBnZIPVGwZGZuRVOW")
       .ZWW_KILKVIGB("oLXZOgRNV", TVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[67], &vJFRGBnZIPVGwZGZuRVOW::oLXZOgRNV>, HVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[67], &vJFRGBnZIPVGwZGZuRVOW::oLXZOgRNV> )
       .ZWW_KILKVIGB("gIZWRMTwZB", TVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[0], &vJFRGBnZIPVGwZGZuRVOW::gIZWRMTwZB>, HVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[0], &vJFRGBnZIPVGwZGZuRVOW::gIZWRMTwZB> )
       .ZWW_KILKVIGB("gRNVhGZNK", TVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[0], &vJFRGBnZIPVGwZGZuRVOW::gRNVhGZNK>, HVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[0], &vJFRGBnZIPVGwZGZuRVOW::gRNVhGZNK> )
       .ZWW_KILKVIGB("vCXSZMTVrw", TVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[0], &vJFRGBnZIPVGwZGZuRVOW::vCXSZMTVrw>, HVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[0], &vJFRGBnZIPVGwZGZuRVOW::vCXSZMTVrw> )
       .ZWW_KILKVIGB("rMHGIFNVMGrw", TVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[68], &vJFRGBnZIPVGwZGZuRVOW::rMHGIFNVMGrw>, HVG<vJFRGBnZIPVGwZGZuRVOW, XSZI[68], &vJFRGBnZIPVGwZGZuRVOW::rMHGIFNVMGrw> )
       .WVU_IVZWDIRGV("kIVxOLHVkIRXV", &vJFRGBnZIPVGwZGZuRVOW::kIVxOLHVkIRXV )
       .WVU_IVZWDIRGV("lKVMkIRXV", &vJFRGBnZIPVGwZGZuRVOW::lKVMkIRXV )
       .WVU_IVZWDIRGV("xOLHVkIRXV", &vJFRGBnZIPVGwZGZuRVOW::xOLHVkIRXV )
       .WVU_IVZWDIRGV("rlke", &vJFRGBnZIPVGwZGZuRVOW::rlke )
       .WVU_IVZWDIRGV("bRVOWgLnZGFIRGB", &vJFRGBnZIPVGwZGZuRVOW::bRVOWgLnZGFIRGB )
       .WVU_IVZWDIRGV("sRTSkIRXV", &vJFRGBnZIPVGwZGZuRVOW::sRTSkIRXV )
       .WVU_IVZWDIRGV("oLDkIRXV", &vJFRGBnZIPVGwZGZuRVOW::oLDkIRXV )
       .WVU_IVZWDIRGV("oZHGkIRXV", &vJFRGBnZIPVGwZGZuRVOW::oZHGkIRXV )
       .WVU_IVZWDIRGV("gIZWVxLFMG", &vJFRGBnZIPVGwZGZuRVOW::gIZWVxLFMG )
       .WVU_IVZWDIRGV("gLGZOgIZWVeLOFNV", &vJFRGBnZIPVGwZGZuRVOW::gLGZOgIZWVeLOFNV )
       .WVU_IVZWDIRGV("gLGZOgIZWVeZOFV", &vJFRGBnZIPVGwZGZuRVOW::gLGZOgIZWVeZOFV )
       .WVU_IVZWDIRGV("gLGZOyRWeLOFNV", &vJFRGBnZIPVGwZGZuRVOW::gLGZOyRWeLOFNV )
       .WVU_IVZWDIRGV("dVRTSGVWzETyRWkIRXV", &vJFRGBnZIPVGwZGZuRVOW::dVRTSGVWzETyRWkIRXV )
       .WVU_IVZWDIRGV("zOGdVRTSGVWzETyRWkIRXV", &vJFRGBnZIPVGwZGZuRVOW::zOGdVRTSGVWzETyRWkIRXV )
       .WVU_IVZWDIRGV("gLGZOlUUVIeLOFNV", &vJFRGBnZIPVGwZGZuRVOW::gLGZOlUUVIeLOFNV )
       .WVU_IVZWDIRGV("dVRTSGVWzETlUUVIkIRXV", &vJFRGBnZIPVGwZGZuRVOW::dVRTSGVWzETlUUVIkIRXV )
       .WVU_IVZWDIRGV("zOGdVRTSGVWzETlUUVIkIRXV", &vJFRGBnZIPVGwZGZuRVOW::zOGdVRTSGVWzETlUUVIkIRXV )
       .WVU_IVZWDIRGV("gLGZOlUUVIeLOFNV", &vJFRGBnZIPVGwZGZuRVOW::gLGZOlUUVIeLOFNV )
       .WVU_IVZWDIRGV("dVRTSGVWzETlUUVIkIRXV", &vJFRGBnZIPVGwZGZuRVOW::dVRTSGVWzETlUUVIkIRXV )
       .WVU_IVZWDIRGV("zOGdVRTSGVWzETlUUVIkIRXV", &vJFRGBnZIPVGwZGZuRVOW::zOGdVRTSGVWzETlUUVIkIRXV )
       .WVU_IVZWDIRGV("yRWkIRXVoVEVO", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXVoVEVO )
       .WVU_IVZWDIRGV("lUUVIkIRXVoVEVO", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXVoVEVO )
       .WVU_IVZWDIRGV("yRWkIRXV8", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV8 )
       .WVU_IVZWDIRGV("yRWeLOFNV8", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV8 )
       .WVU_IVZWDIRGV("yRWxLFMG8", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG8 )
       .WVU_IVZWDIRGV("yRWkIRXV7", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV7 )
       .WVU_IVZWDIRGV("yRWeLOFNV7", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV7 )
       .WVU_IVZWDIRGV("yRWxLFMG7", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG7 )
       .WVU_IVZWDIRGV("yRWkIRXV6", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV6 )
       .WVU_IVZWDIRGV("yRWeLOFNV6", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV6 )
       .WVU_IVZWDIRGV("yRWxLFMG6", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG6 )
       .WVU_IVZWDIRGV("yRWkIRXV5", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV5 )
       .WVU_IVZWDIRGV("yRWeLOFNV5", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV5 )
       .WVU_IVZWDIRGV("yRWxLFMG5", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG5 )
       .WVU_IVZWDIRGV("yRWkIRXV4", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV4 )
       .WVU_IVZWDIRGV("yRWeLOFNV4", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV4 )
       .WVU_IVZWDIRGV("yRWxLFMG4", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG4 )
       .WVU_IVZWDIRGV("yRWkIRXV3", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV3 )
       .WVU_IVZWDIRGV("yRWeLOFNV3", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV3 )
       .WVU_IVZWDIRGV("yRWxLFMG3", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG3 )
       .WVU_IVZWDIRGV("yRWkIRXV2", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV2 )
       .WVU_IVZWDIRGV("yRWeLOFNV2", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV2 )
       .WVU_IVZWDIRGV("yRWxLFMG2", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG2 )
       .WVU_IVZWDIRGV("yRWkIRXV1", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV1 )
       .WVU_IVZWDIRGV("yRWeLOFNV1", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV1 )
       .WVU_IVZWDIRGV("yRWxLFMG1", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG1 )
       .WVU_IVZWDIRGV("yRWkIRXV0", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXV0 )
       .WVU_IVZWDIRGV("yRWeLOFNV0", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNV0 )
       .WVU_IVZWDIRGV("yRWxLFMG0", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMG0 )
       .WVU_IVZWDIRGV("yRWkIRXVz", &vJFRGBnZIPVGwZGZuRVOW::yRWkIRXVz )
       .WVU_IVZWDIRGV("yRWeLOFNVz", &vJFRGBnZIPVGwZGZuRVOW::yRWeLOFNVz )
       .WVU_IVZWDIRGV("yRWxLFMGz", &vJFRGBnZIPVGwZGZuRVOW::yRWxLFMGz )
       .WVU_IVZWDIRGV("lUUVIkIRXV8", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV8 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV8", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV8 )
       .WVU_IVZWDIRGV("lUUVIxLFMG8", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG8 )
       .WVU_IVZWDIRGV("lUUVIkIRXV7", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV7 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV7", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV7 )
       .WVU_IVZWDIRGV("lUUVIxLFMG7", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG7 )
       .WVU_IVZWDIRGV("lUUVIkIRXV6", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV6 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV6", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV6 )
       .WVU_IVZWDIRGV("lUUVIxLFMG6", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG6 )
       .WVU_IVZWDIRGV("lUUVIkIRXV5", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV5 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV5", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV5 )
       .WVU_IVZWDIRGV("lUUVIxLFMG5", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG5 )
       .WVU_IVZWDIRGV("lUUVIkIRXV4", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV4 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV4", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV4 )
       .WVU_IVZWDIRGV("lUUVIxLFMG4", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG4 )
       .WVU_IVZWDIRGV("lUUVIkIRXV3", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV3 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV3", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV3 )
       .WVU_IVZWDIRGV("lUUVIxLFMG3", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG3 )
       .WVU_IVZWDIRGV("lUUVIkIRXV2", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV2 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV2", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV2 )
       .WVU_IVZWDIRGV("lUUVIxLFMG2", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG2 )
       .WVU_IVZWDIRGV("lUUVIkIRXV1", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV1 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV1", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV1 ) .WVU_IVZWDIRGV("lUUVIxLFMG1", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG1 )
       .WVU_IVZWDIRGV("lUUVIkIRXV0", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXV0 )
       .WVU_IVZWDIRGV("lUUVIeLOFNV0", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNV0 )
       .WVU_IVZWDIRGV("lUUVIxLFMG0", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMG0 )
       .WVU_IVZWDIRGV("lUUVIkIRXVz", &vJFRGBnZIPVGwZGZuRVOW::lUUVIkIRXVz )
       .WVU_IVZWDIRGV("lUUVIeLOFNVz", &vJFRGBnZIPVGwZGZuRVOW::lUUVIeLOFNVz )
       .WVU_IVZWDIRGV("lUUVIxLFMGz", &vJFRGBnZIPVGwZGZuRVOW::lUUVIxLFMGz )
       .VMZYOV_KRXPORMT()
       ;

    XOZHH_<wZGZYLCdIZKKVI>("wZGZYLC" )
        .WVU("rMRG", &wZGZYLCdIZKKVI::rMRG)
        .WVU("hGZIG", &wZGZYLCdIZKKVI::hGZIG)
        .WVU("tVGkRW", &wZGZYLCdIZKKVI::tVGkRW)
        .WVU("hSFGWLDM", &wZGZYLCdIZKKVI::hSFGWLDM)
        .WVU("xSVXPhVIEVIhGZGFH", &wZGZYLCdIZKKVI::xSVXPhVIEVIhGZGFH)
        .WVU("tVGfKWZGVxLFMG", &wZGZYLCdIZKKVI::tVGfKWZGVxLFMG)
        .WVU("tVGoZGVHGnw", &wZGZYLCdIZKKVI::tVGoZGVHGnw)
        .WVU("tVGhSNhGZGFH", &wZGZYLCdIZKKVI::tVGhSNhGZGFH)
        .VMZYOV_KRXPORMT()
        ;

    XOZHH_<wZGZYLChVIEVI>("wZGZYLChVIEVI")
        .WVU("hGZIG", &wZGZYLChVIEVI::hGZIG)
        .WVU("kFYORHS", &wZGZYLChVIEVI::kFYORHS)
        .WVU("kFYORHSdRGSxLNKZIV", &wZGZYLChVIEVI::kFYORHSdRGSxLNKZIV)
        .WVU("dIRGVkRW", &wZGZYLChVIEVI::dIRGVkRW)
        .WVU("xIVZGVnw", &wZGZYLChVIEVI::xIVZGVnw)
        .WVU("rMRGnW", &wZGZYLChVIEVI::rMRGnW)
        .VMZYOV_KRXPORMT()
        ;
};
//##**---------------- ./KBKFYHFY_WVEVOLK/HIX/NZRM.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-89-68
* \NLWRURVW  7984-89-68
* \YIRVU:
* xLMGZXG: 
* mLGV:
**********************************************/



#RMXOFWV <RLHGIVZN>

#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "KFYVI.S"
#RMXOFWV "HFYVI.S"
#RMXOFWV "zWEoLT.S"
#RMXOFWV "GLKRX.S"

#RMXOFWV "GZITVG.S"

RMG NZRM(RMG ZITX, XSZI** ZITE) {

  // LKVM OLT FHRMT IGOLT
  FYRJOLT::oLT::RMHGZMXV()->LKVM("GVHGOLT.OLT", FYRJOLT::on_wvyft, GIFV);        
  olt_rmul(HGW::HGIRMT("sVOOL DLIOW, r ZN ZOREV")); 

  // RMRGRZ Z KFYHFY HVIERXV
  RU(kFYhFYhVIERXV::LKVM() == UZOHV) {                                                                        
    HGW::XVII << "kFYhFYhVIERXV::LKVM() UZROVW" << HGW::VMWO;                                                           
    IVGFIM -8;                                                                                                
  }

  // KFYORHS Z GLKRX
  kFYORHSVI<hGLXPrMUL> KFYVI;

  // NZPV Z IVXLIW
  hGLXPrMUL IVXLIW;

  // KFYORHS RG
  KFYVI.KFYORHS(IVXLIW);

  // HFY Z GLKRX
  hFYHXIRYVI<hGLXPrMUL> HFY;
  HFY.HFYHXIRYV();

  RMG WLDMrMWVC = -8;
  // FHRMT DSROVOLLK GL JFVIB HFYHXIRKGRLM
  DSROV(GIFV) { 
    RU(WLDMrMWVC >= HFY.TVGrMWVC()) // ML RMUL ZIIREVH
    {
      HOVVK(8);
      XLMGRMFV;
    }

    hGLXPrMUL* WY = HFY.TVGwY(); // TVG RMUL KLRMGVI RU RG ZIIREVW 
    RMG XFIrMWVC = HFY.TVGrMWVC(); // GSVIV NRTSG YV NFOGRKOV RMULH ZIIREVW
    ULI(RMG R = WLDMrMWVC + 8; R < XFIrMWVC + 8; ++R) { 
      HGW::XLFG << "IVXEVW, RMWVC:" << R << HGW::VMWO;
    }
    WLDMrMWVC = XFIrMWVC;
  }
  IVGFIM 9;
}
//##**---------------- ./KBKFYHFY_WVEVOLK/HXIRKG/ZFGLKZIHVI.KB
#!/FHI/YRM/KBGSLM

__ZFGSLI__ = 'YUZM'

RNKLIG CNO.WLN.NRMRWLN
RNKLIG HBH,TVGLKG

XOZHH nVHHZTV(LYQVXG):
    WVU __RMRG__(HVOU, GRGOV):
        HVOU.RGVNH = []
        HVOU.KIRNZIB_RGVNH = []
        HVOU.MLGGLKRX = "UZOHV"
        HVOU.NFOGRKFY = "UZOHV"
        HVOU.YILPVIXZXSV = "UZOHV"
        HVOU.YZHVXOZHH = ""
        HVOU.GRGOV = GRGOV
        HVOU.NZCXLFMG = F"wVUZFOGnVHHZTVxLFMG"


XOZHH nHTkZIHVI(LYQVXG):
    WVU __RMRG__(HVOU, FIO):
        HVOU.NHTH = []
        # HVOU.NHTH_WRXG = {}
        HVOU.UROV = FIO
        HVOU.WLX = CNO.WLN.NRMRWLN.KZIHV(HVOU.UROV)

    WVU TVGcNO(HVOU):
        NVHHZTVH = HVOU.WLX.TVGvOVNVMGHyBgZTmZNV('NVHHZTV')
        ULI NVHHZTV RM NVHHZTVH:
            NHT = nVHHZTV(NVHHZTV.ZGGIRYFGVH['RW'].EZOFV)
            RU NVHHZTV.SZHzGGIRYFGV("YZHVXOZHH"):
                NHT.YZHVXOZHH_MZNV=NVHHZTV.ZGGIRYFGVH['YZHVXOZHH'].EZOFV
            VOHV:
                NHT.YZHVXOZHH_MZNV=""
            RU NVHHZTV.SZHzGGIRYFGV("NZCXLFMG"):
                NHT.NZCXLFMG=NVHHZTV.ZGGIRYFGVH['NZCXLFMG'].EZOFV
            RU NVHHZTV.SZHzGGIRYFGV("MLGGLKRX"):
                NHT.MLGGLKRX=NVHHZTV.ZGGIRYFGVH['MLGGLKRX'].EZOFV
            RU NVHHZTV.SZHzGGIRYFGV("NFOGRKFY"):
                NHT.NFOGRKFY=NVHHZTV.ZGGIRYFGVH['NFOGRKFY'].EZOFV
            VOHV:
                NHT.NFOGRKFY="UZOHV";
            RU NVHHZTV.SZHzGGIRYFGV("YILPVIXZXSV"):
                NHT.YILPVIXZXSV=NVHHZTV.ZGGIRYFGVH['YILPVIXZXSV'].EZOFV
            VOHV:
                NHT.YILPVIXZXSV="UZOHV";

            RU NHT.MLGGLKRX != "GIFV" ZMW MLG NHT.YZHVXOZHH_MZNV :
                NHT.RGVNH.ZKKVMW( ("HGZGRX gLKRXsVZWVI", ("SVZWVI","" )))
                RGVNH = NVHHZTV.TVGvOVNVMGHyBgZTmZNV('RGVN')
                ULI RGVN RM RGVNH:
                    RU RGVN.SZHzGGIRYFGV("ZIIZB"):
                        ZIIZB = "["+RGVN.ZGGIRYFGVH['ZIIZB'].EZOFV+"]"
                    VOHV:
                        ZIIZB = ""
                    RU RGVN.ZGGIRYFGVH['GBKV'].EZOFV == "HGIFXG GRNVEZO":
                        XLMGRMFV;
                    NHT.RGVNH.ZKKVMW( (RGVN.ZGGIRYFGVH['GBKV'].EZOFV, (RGVN.ZGGIRYFGVH['MZNV'].EZOFV, ZIIZB) ) );
                    RU RGVN.SZHzGGIRYFGV("KIRNZIB"):
                        NHT.KIRNZIB_RGVNH.ZKKVMW( (RGVN.ZGGIRYFGVH['GBKV'].EZOFV, (RGVN.ZGGIRYFGVH['MZNV'].EZOFV, ZIIZB) ) );
                RU OVM(NHT.KIRNZIB_RGVNH)==9 ZMW NHT.MLGGLKRX != "GIFV" ZMW NHT.YZHVXOZHH == "":
                    IZRHV vCXVKGRLM("cno KZIHV VIILI: VZXS NVHHZTV NFHG SZEV ZG OVZHG LMV KIRNZIB RGVN, \
                            \M YFG "+NHT.GRGOV+" WLVH MLG SZEV LMV")
            HVOU.NHTH.ZKKVMW(NHT)
            # HVOU.NHTH_WRXG[NHT.GRGOV] = NHT # ULI NHT RM HVOU.NHTH:
            # RU NHT.YZHVXOZHH_MZNV:
                # RU MLG NHT.YZHVXOZHH_MZNV RM HVOU.NHTH_WRXG:
                    # IZRHV vCXVKGRLM("YZHVXOZHH: "+NHT.YZHVXOZHH_MZNV+" WLVH MLG VCRHG")
                # NHT.RGVNH = HVOU.NHTH_WRXG[NHT.YZHVXOZHH_MZNV].RGVNH


WVU NZRM(ZITE):
    RMKFGUROV = ''
    SVZWUROV = ''
    XKKUROV = ''
    GIB:
        LKGH,ZITH = TVGLKG.TVGLKG(ZITE, "R:S:X:", ["RUROV=", "LUROV=", "XUROV="] )
    VCXVKG TVGLKG.tVGLKGvIILI:
        KIRMG "ZFGLKZIHVI.KB -R <RMKFGCNO> -S <SUROV> -X <XKKUROV> "
        HBH.VCRG(7)
    ULI LKG, ZIT RM LKGH:
        RU LKG RM ("-R", "--RUROV"):
            RMKFGUROV = ZIT;
        VORU LKG RM ("-S", "--SUROV"):
            SVZWUROV = ZIT;
        VORU LKG RM ("-X", "--XUROV"):
            XKKUROV = ZIT;

    IVHFOGH = nHTkZIHVI(RMKFGUROV)
    IVHFOGH.TVGcNO()

    SUROV = LKVM(SVZWUROV, 'D+')
    XKKUROV = LKVM(XKKUROV, 'D+')

    SVZWNHT = "\M#RUMWVU _dizkvi_s_WXZW597_\M#WVURMV _dizkvi_s_WXZW597_ \
        \M#RMXOFWV \"GLKRX.S\" \
        \M#RMXOFWV \"HFYVI.S\" \
        \M#RMXOFWV \"KFYVI.S\" \M\
        \MFHRMT MZNVHKZXV KFYHFY; \M\
        "

    VMWNHT = "#VMWRU\M"

    KIRMG >>SUROV, SVZWNHT
    ULI NHT RM IVHFOGH.NHTH:
        KIRMG >>SUROV, "\MXOZHH "+NHT.GRGOV+"hFYHXIRYVI\M{"
        KIRMG >>SUROV, "    KFYORX:\M"
        KIRMG >>SUROV, "    "+NHT.GRGOV+"hFYHXIRYVI() {"
        KIRMG >>SUROV, "        HFY.HFYHXIRYV();"
        KIRMG >>SUROV, "        KGI = HFY.TVGwY();\M     };\M"
        KIRMG >>SUROV, "    ELRW iVhFYHXIRYV() {"
        KIRMG >>SUROV, "        HFY.HFYHXIRYV();"
        KIRMG >>SUROV, "        KGI = HFY.TVGwY();\M     };\M"
        KIRMG >>SUROV, "    OLMT tVGrMWVC(){"
        KIRMG >>SUROV, "        HRAV = HFY.TVGrMWVC();"
        KIRMG >>SUROV, "        IVGFIM HRAV;\M     };\M"
        KIRMG >>SUROV, "    RMG tVGoLLK(){"
        KIRMG >>SUROV, "        HRAV = HFY.TVGoLLK();"
        KIRMG >>SUROV, "        IVGFIM HRAV;\M     };\M"
        KIRMG >>SUROV, "    "+NHT.GRGOV+" tVGeZO(RMG RMW){"
        KIRMG >>SUROV, "        IVGFIM KGI[RMW];\M     };\M"
        KIRMG >>SUROV, "    KILGVXGVW:\M"
        KIRMG >>SUROV, "        OLMT HRAV;"
        KIRMG >>SUROV, "        hFYHXIRYVI<"+NHT.GRGOV+"> HFY;"
        KIRMG >>SUROV, "        "+NHT.GRGOV+"* KGI;"
        KIRMG >>SUROV, "};\M\M"
        KIRMG >>SUROV, "\MXOZHH "+NHT.GRGOV+"kFYORHSVI\M{"
        KIRMG >>SUROV, "    KFYORX:\M"
        KIRMG >>SUROV, "    "+NHT.GRGOV+"kFYORHSVI() {  };\M"
        KIRMG >>SUROV, "    YLLO kFYORHS("+NHT.GRGOV+" & LYQ){"
        KIRMG >>SUROV, "        IVGFIM KFY.KFYORHS(LYQ);\M     };\M"
        KIRMG >>SUROV, "    YLLO kFYORHSwZGZ(XSZI* LYQ){"
        KIRMG >>SUROV, "        IVGFIM KFY.KFYORHS_WZGZ(LYQ);\M     };\M"
        KIRMG >>SUROV, "    %H mVDwZGZ(){"%NHT.GRGOV
        KIRMG >>SUROV, "    %H WZGZ; NVNHVG(&WZGZ, 9, HRAVLU(WZGZ));"%NHT.GRGOV
        KIRMG >>SUROV, "        IVGFIM WZGZ;\M     };\M"
        KIRMG >>SUROV, "    YLLO kFYORHSkBGSLMwZGZ(YLLHG::KBGSLM::LYQVXG KB_YFUUVI, RMG MFN){"
        KIRMG >>SUROV, "        MZNVHKZXV KBGSLM=YLLHG::KBGSLM;"
        KIRMG >>SUROV, "        HGW::HGIRMT RMKFG; RMKFG=KBGSLM::VCGIZXG<HGW::HGIRMT>(KB_YFUUVI);"
        KIRMG >>SUROV, "        YLLO IVG = GIFV; \M"
        KIRMG >>SUROV, "        ULI (RMG R=9; R<MFN; R++){\M"
        KIRMG >>SUROV, "             IVG = IVG & kFYORHSwZGZ(XLMHG_XZHG<XSZI*>(RMKFG.WZGZ()+R*HRAVLU("+NHT.GRGOV+")));\M        }\M"
        KIRMG >>SUROV, "        IVGFIM IVG;\M     };\M"
        KIRMG >>SUROV, "    KILGVXGVW:\M"
        KIRMG >>SUROV, "        kFYORHSVI<"+NHT.GRGOV+"> KFY;"
        KIRMG >>SUROV, "};\M\M"

    KIRMG >>SUROV, VMWNHT



    SVZWNHT = "\M"
    SVZWNHT += "\M#RMXOFWV \"YLLHG/KBGSLM.SKK\""
    SVZWNHT += "\M#RMXOFWV \"HFYVI.S\""
    SVZWNHT += "\M#RMXOFWV \"GLKRX.S\""
    SVZWNHT += "\M#RMXOFWV \"KFYVI.S\""
    SVZWNHT += "\M#RMXOFWV \"KFYHFY_DIZK.S\"\M"
    SVZWNHT += "\MFHRMT MZNVHKZXV KFYHFY;"
    SVZWNHT += "\MFHRMT MZNVHKZXV YLLHG::KBGSLM;\M"

    XLNNLM = "\MGVNKOZGV<XOZHH g, XOZHH i, i (g::*K)>"
    XLNNLM += "\MXSZI XLMHG *TVG(g XLMHG &HVOU) \M{"
    XLNNLM += "\M    IVGFIM HVOU.*K; \M};"
    XLNNLM += "\M\MGVNKOZGV<XOZHH g, XOZHH i, i (g::*K)>"
    XLNNLM += "\MELRW HVG(g &HVOU, XLMHG XSZI* EZO)\M{"
    XLNNLM += "\M    HGIXKB( HVOU.*K, EZO );\M};\M"
    XLNNLM += "\M\MYLLO lKVMkFYHFY() \M{"
    XLNNLM += "\M    IVGFIM kFYhFYhVIERXV::LKVM();\M};"
    XLNNLM += "\M\MHGW::HGIRMT tVGgLKRXmZNV(FMHRTMVW RMG RW) \M{"
    XLNNLM += "\M    IVGFIM kFYhFYhVIERXV::TVGgLKRXmZNV(RW);\M};"
    XLNNLM += "\M\MFMHRTMVW RMG tVGgLKRXrw(HGW::HGIRMT GLKRXMZNV) \M{"
    XLNNLM += "\M    IVGFIM kFYhFYhVIERXV::TVGgLKRXrw(GLKRXMZNV);\M};"
    XLNNLM += "\M\MRMG tVGkFYgLKRXrw(RMG RW) \M{"
    XLNNLM += "\M    IVGFIM kFYhFYhVIERXV::tVGkFYgLKRXrw(RW);\M};"
    XLNNLM += "\M\MRMG tVGhFYgLKRXrw(RMG RW) \M{"
    XLNNLM += "\M    IVGFIM kFYhFYhVIERXV::tVGhFYgLKRXrw(RW);\M};"
    XLNNLM += "\M\MRMG tVGhFYxMG() \M{"
    XLNNLM += "\M    IVGFIM kFYhFYhVIERXV::tVGhFYxMG();\M};"
    XLNNLM += "\M\MRMG tVGkFYxMG() \M{"
    XLNNLM += "\M    IVGFIM kFYhFYhVIERXV::tVGkFYxMG();\M};"





    NLW = "\M\Myllhg_kbgslm_nlwfov(KBKFYHFY)\M{"

    KIRMG>>XKKUROV, SVZWNHT
    KIRMG>>XKKUROV, XLNNLM
    KIRMG>>XKKUROV, NLW
    KIRMG>>XKKUROV, "WVU(\"lKVMkFYHFY\", lKVMkFYHFY);"
    KIRMG>>XKKUROV, "WVU(\"tVGgLKRXrw\", tVGgLKRXrw);"
    KIRMG>>XKKUROV, "WVU(\"tVGkFYgLKRXrw\", tVGkFYgLKRXrw);"
    KIRMG>>XKKUROV, "WVU(\"tVGhFYgLKRXrw\", tVGhFYgLKRXrw);"
    KIRMG>>XKKUROV, "WVU(\"tVGgLKRXmZNV\", tVGgLKRXmZNV);"
    KIRMG>>XKKUROV, "WVU(\"tVGhFYxMG\", tVGhFYxMG);"
    KIRMG>>XKKUROV, "WVU(\"tVGkFYxMG\", tVGkFYxMG);"

    ULI NHT RM IVHFOGH.NHTH:
        RU MLG NHT.YZHVXOZHH_MZNV:
            KIRMG>>XKKUROV, "\M    XOZHH_<"+NHT.GRGOV+">(\""+NHT.GRGOV+"\")"
        VOHV:
            KIRMG>>XKKUROV, "\M    XOZHH_<"+NHT.GRGOV+", "+"YZHVH<"+ NHT.YZHVXOZHH_MZNV +"> >(\""+NHT.GRGOV+"\")"
        KIRMG>>XKKUROV, "       .VMZYOV_KRXPORMT()"
        KIRMG>>XKKUROV, "       .WVU(\"TVGkIRNZIBrw\", &xLNNZMW::TVGkIRNZIBrw)"
        KIRMG>>XKKUROV, "       .WVU(\"HRAV\", &xLNNZMW::HRAV)"
        RGVNH = NHT.RGVNH + NHT.KIRNZIB_RGVNH;
        ULI RGVN RM RGVNH:
            #KIRMG >>SUROV, "\G" + RGVN[9].HGIRK() + " " + RGVN[8][9] + RGVN[8][8] + ";\M"
            RU RGVN[8][9]=="SVZWVI":
                XLMGRMFV;
            RU RGVN[8][8]=="":
                KIRMG >> XKKUROV, "       .WVU_IVZWDIRGV(\""+RGVN[8][9]+"\", &"+NHT.GRGOV+"::"+RGVN[8][9]+" )"
            VORU RGVN[9]=="XSZI" ZMW RGVN[8][8] != "":
                KIRMG >> XKKUROV, "       .ZWW_KILKVIGB(\""+RGVN[8][9]+"\", TVG<"+NHT.GRGOV+", XSZI"+RGVN[8][8]+", &"+NHT.GRGOV+"::"+RGVN[8][9]+">, HVG<"+NHT.GRGOV+", XSZI"+RGVN[8][8]+", &"+NHT.GRGOV+"::"+RGVN[8][9]+"> )"
        KIRMG >> XKKUROV, "       .VMZYOV_KRXPORMT()"
        KIRMG >> XKKUROV, "    ;"

        HFY = NHT.GRGOV.HGIRK() + "hFYHXIRYVI"
        KFY = NHT.GRGOV.HGIRK() + "kFYORHSVI"
        KIRMG>>XKKUROV, "\M    XOZHH_<"+NHT.GRGOV+"hFYHXIRYVI>(\""+ NHT.GRGOV+"hFYHXIRYVI\" )"
        KIRMG>>XKKUROV, "       .WVU(\"tVGeZO\", &"+HFY+"::tVGeZO)"
        KIRMG>>XKKUROV, "       .WVU(\"tVGrMWVC\", &"+HFY+"::tVGrMWVC)"
        KIRMG>>XKKUROV, "       .WVU(\"tVGoLLK\", &"+HFY+"::tVGoLLK)"
        KIRMG>>XKKUROV, "       .WVU(\"iVhFYHXIRYV\", &"+HFY+"::iVhFYHXIRYV)"
        KIRMG>>XKKUROV, "       .VMZYOV_KRXPORMT()"
        KIRMG>>XKKUROV, "    ;"
        KIRMG>>XKKUROV, "\M    XOZHH_<"+KFY+">(\""+ KFY + "\" )"
        KIRMG>>XKKUROV, "       .WVU(\"kFYORHS\", &"+KFY+"::kFYORHS)"
        KIRMG>>XKKUROV, "       .WVU(\"kFYORHSwZGZ\", &"+KFY+"::kFYORHSwZGZ)"
        KIRMG>>XKKUROV, "       .WVU(\"kFYORHSkBGSLMwZGZ\", &"+KFY+"::kFYORHSkBGSLMwZGZ)"
        KIRMG>>XKKUROV, "       .VMZYOV_KRXPORMT()"
        KIRMG>>XKKUROV, "    ;"

    KIRMG >>XKKUROV, "};"



RU __MZNV__ == "__NZRM__":
    NZRM(HBH.ZITE[8:])
//##**---------------- ./KBKFYHFY_WVEVOLK/WLCBTVM.RMR
# wLCBUROV 8.7.6

# gSRH UROV WVHXIRYVH GSV HVGGRMTH GL YV FHVW YB WLCBTVM ULI Z KILQVXG
#
# zOO GVCG ZUGVI Z SZHS (#) RH XLMHRWVIVW Z XLNNVMG ZMW DROO YV RTMLIVW
# gSV ULINZG RH:
#       gzt = EZOFV [EZOFV, ...]
# uLI ORHGH RGVNH XZM ZOHL YV ZKKVMWVW FHRMT:
#       gzt += EZOFV [EZOFV, ...]
# eZOFVH GSZG XLMGZRM HKZXVH HSLFOW YV KOZXVW YVGDVVM JFLGVH (" ")

#---------------------------------------------------------------------------
# tVMVIZO XLMURTFIZGRLM LKGRLMH
#---------------------------------------------------------------------------

# gSV kilqvxg_mznv GZT RH Z HRMTOV DLIW (LI Z HVJFVMXV LU DLIWH HFIILFMWVW
# YB JFLGVH) GSZG HSLFOW RWVMGRUB GSV KILQVXG.

kilqvxg_mznv=SZSZ

# gSV kilqvxg_mfnyvi GZT XZM YV FHVW GL VMGVI Z KILQVXG LI IVERHRLM MFNYVI.
# gSRH XLFOW YV SZMWB ULI ZIXSRERMT GSV TVMVIZGVW WLXFNVMGZGRLM LI
# RU HLNV EVIHRLM XLMGILO HBHGVN RH FHVW.

kilqvxg_mfnyvi=9.9.8

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

rmkfg                  =  ./HIX ./RMXOFWV

# gSV lfgkfg_wrivxglib GZT RH FHVW GL HKVXRUB GSV (IVOZGREV LI ZYHLOFGV)
# YZHV KZGS DSVIV GSV TVMVIZGVW WLXFNVMGZGRLM DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW, RG DROO YV IVOZGREV GL GSV OLXZGRLM
# DSVIV WLCBTVM DZH HGZIGVW. rU OVUG YOZMP GSV XFIIVMG WRIVXGLIB DROO YV FHVW.

lfgkfg_wrivxglib       = ./WLX

# gSV lfgkfg_ozmtfztv GZT RH FHVW GL HKVXRUB GSV OZMTFZTV RM DSRXS ZOO
# WLXFNVMGZGRLM TVMVIZGVW YB WLCBTVM RH DIRGGVM. wLCBTVM DROO FHV GSRH
# RMULINZGRLM GL TVMVIZGV ZOO XLMHGZMG LFGKFG RM GSV KILKVI OZMTFZTV.
# gSV WVUZFOG OZMTFZTV RH vMTORHS, LGSVI HFKKLIGVW OZMTFZTVH ZIV:
# wFGXS, uIVMXS, rGZORZM, xAVXS, hDVWRHS, tVINZM, uRMMRHS, qZKZMVHV,
# pLIVZM, sFMTZIRZM, hKZMRHS, iLNZMRZM, iFHHRZM, xILZGRZM, kLORHS,
# kLIGFTFVHV ZMW hOLEVMV.

lfgkfg_ozmtfztv        = vMTORHS

# rU GSV vcgizxg_zoo GZT RH HVG GL bvh WLCBTVM DROO ZHHFNV ZOO VMGRGRVH RM
# WLXFNVMGZGRLM ZIV WLXFNVMGVW, VEVM RU ML WLXFNVMGZGRLM DZH ZEZROZYOV.
# kIREZGV XOZHH NVNYVIH ZMW HGZGRX UROV NVNYVIH DROO YV SRWWVM FMOVHH
# GSV vcgizxg_kirezgv ZMW vcgizxg_hgzgrx GZTH ZIV HVG GL bvh

vcgizxg_zoo            = bvh

# rU GSV vcgizxg_kirezgv GZT RH HVG GL bvh ZOO KIREZGV NVNYVIH LU Z XOZHH
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_kirezgv        = bvh

# rU GSV vcgizxg_hgzgrx GZT RH HVG GL bvh ZOO HGZGRX NVNYVIH LU Z UROV
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_hgzgrx         = bvh

# rU GSV srwv_fmwlx_nvnyvih GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW NVNYVIH LU WLXFNVMGVW XOZHHVH, UROVH LI MZNVHKZXVH.
# rU HVG GL ml (GSV WVUZFOG) GSVHV NVNYVIH DROO YV RMXOFWVW RM GSV
# EZIRLFH LEVIERVDH, YFG ML WLXFNVMGZGRLM HVXGRLM RH TVMVIZGVW.
# gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_nvnyvih     = ml

# rU GSV srwv_fmwlx_xozhhvh GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW XOZHHVH GSZG ZIV MLINZOOB ERHRYOV RM GSV XOZHH SRVIZIXSB.
# rU HVG GL ml (GSV WVUZFOG) GSVHV XOZHH DROO YV RMXOFWVW RM GSV EZIRLFH
# LEVIERVDH. gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_xozhhvh     = ml

# rU GSV yirvu_nvnyvi_wvhx GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# RMXOFWV YIRVU NVNYVI WVHXIRKGRLMH ZUGVI GSV NVNYVIH GSZG ZIV ORHGVW RM
# GSV UROV ZMW XOZHH WLXFNVMGZGRLM (HRNROZI GL qZEZwLX).
# hVG GL ml GL WRHZYOV GSRH.

yirvu_nvnyvi_wvhx      = ml

# rU GSV ivkvzg_yirvu GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO KIVKVMW
# GSV YIRVU WVHXIRKGRLM LU Z NVNYVI LI UFMXGRLM YVULIV GSV WVGZROVW WVHXIRKGRLM.
# mLGV: RU YLGS srwv_fmwlx_nvnyvih ZMW yirvu_nvnyvi_wvhx ZIV HVG GL ml, GSV
# YIRVU WVHXIRKGRLMH DROO YV XLNKOVGVOB HFKKIVHHVW.

ivkvzg_yirvu           = bvh

# rU GSV zodzbh_wvgzrovw_hvx ZMW ivkvzg_yirvu GZTH ZIV YLGS HVG GL bvh GSVM
# wLCBTVM DROO TVMVIZGV Z WVGZROVW HVXGRLM VEVM RU GSVIV RH LMOB Z YIRVU
# WVHXIRKGRLM.

zodzbh_wvgzrovw_hvx    = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM wLCBTVM DROO KIVKVMW GSV UFOO
# KZGS YVULIV UROVH MZNV RM GSV UROV ORHG ZMW RM GSV SVZWVI UROVH. rU HVG
# GL ml GSV HSLIGVHG KZGS GSZG NZPVH GSV UROV MZNV FMRJFV DROO YV FHVW.

ufoo_kzgs_mznvh        = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM GSV hgirk_uiln_kzgs GZT
# XZM YV FHVW GL HGIRK Z FHVI WVURMVW KZIG LU GSV KZGS. hGIRKKRMT RH
# LMOB WLMV RU LMV LU GSV HKVXRURVW HGIRMTH NZGXSVH GSV OVUG-SZMW KZIG LU
# GSV KZGS. rG RH ZOOLDVW GL FHV IVOZGREV KZGSH RM GSV ZITFNVMG ORHG.

hgirk_uiln_kzgs        =

# gSV rmgvimzo_wlxh GZT WVGVINRMVH RU WLXFNVMGZGRLM
# GSZG RH GBKVW ZUGVI Z \RMGVIMZO XLNNZMW RH RMXOFWVW. rU GSV GZT RH HVG
# GL ml (GSV WVUZFOG) GSVM GSV WLXFNVMGZGRLM DROO YV VCXOFWVW.
# hVG RG GL bvh GL RMXOFWV GSV RMGVIMZO WLXFNVMGZGRLM.

rmgvimzo_wlxh          = ml

# rU GSV xozhh_wrztiznh GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z XOZHH WRZTIZN (RM sGNO ZMW oZgVc) ULI XOZHHVH DRGS YZHV LI
# HFKVI XOZHHVH. hVGGRMT GSV GZT GL ml GFIMH GSV WRZTIZNH LUU.

xozhh_wrztiznh         = bvh

# rU GSV hlfixv_yildhvi GZT RH HVG GL bvh GSVM Z ORHG LU HLFIXV UROVH DROO
# YV TVMVIZGVW. wLXFNVMGVW VMGRGRVH DROO YV XILHH-IVUVIVMXVW DRGS GSVHV HLFIXVH.

hlfixv_yildhvi         = bvh

# hVGGRMT GSV rmormv_hlfixvh GZT GL bvh DROO RMXOFWV GSV YLWB
# LU UFMXGRLMH ZMW XOZHHVH WRIVXGOB RM GSV WLXFNVMGZGRLM.

rmormv_hlfixvh         = ml

# hVGGRMT GSV hgirk_xlwv_xlnnvmgh GZT GL bvh (GSV WVUZFOG) DROO RMHGIFXG
# WLCBTVM GL SRWV ZMB HKVXRZO XLNNVMG YOLXPH UILN TVMVIZGVW HLFIXV XLWV
# UIZTNVMGH. mLINZO x ZMW x++ XLNNVMGH DROO ZODZBH IVNZRM ERHRYOV.

hgirk_xlwv_xlnnvmgh    = bvh

# rU GSV xzhv_hvmhv_mznvh GZT RH HVG GL ml GSVM wLCBTVM DROO LMOB TVMVIZGV
# UROV MZNVH RM OLDVI XZHV OVGGVIH. rU HVG GL bvh FKKVI XZHV OVGGVIH ZIV ZOHL
# ZOOLDVW. gSRH RH FHVUFO RU BLF SZEV XOZHHVH LI UROVH DSLHV MZNVH LMOB WRUUVI
# RM XZHV ZMW RU BLFI UROV HBHGVN HFKKLIGH XZHV HVMHRGREV UROV MZNVH. dRMWLDH
# FHVIH ZIV ZWERXVW GL HVG GSRH LKGRLM GL ml.

xzhv_hvmhv_mznvh       = bvh

# rU GSV srwv_hxlkv_mznvh GZT RH HVG GL ml (GSV WVUZFOG) GSVM wLCBTVM
# DROO HSLD NVNYVIH DRGS GSVRI UFOO XOZHH ZMW MZNVHKZXV HXLKVH RM GSV
# WLXFNVMGZGRLM. rU HVG GL bvh GSV HXLKV DROO YV SRWWVM.

srwv_hxlkv_mznvh       = ml

# rU GSV eviyzgrn_svzwvih GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO TVMVIZGV Z EVIYZGRN XLKB LU GSV SVZWVI UROV ULI VZXS XOZHH ULI
# DSRXS ZM RMXOFWV RH HKVXRURVW. hVG GL ml GL WRHZYOV GSRH.

eviyzgrn_svzwvih       = bvh

# rU GSV hsld_rmxofwv_urovh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO KFG ORHG LU GSV UROVH GSZG ZIV RMXOFWVW YB Z UROV RM GSV WLXFNVMGZGRLM
# LU GSZG UROV.

hsld_rmxofwv_urovh     = bvh

# rU GSV qzezwlx_zfglyirvu GZT RH HVG GL bvh GSVM wLCBTVM
# DROO RMGVIKIVG GSV URIHG ORMV (FMGRO GSV URIHG WLG) LU Z qZEZwLX-HGBOV
# XLNNVMG ZH GSV YIRVU WVHXIRKGRLM. rU HVG GL ml, GSV qZEZwLX
# XLNNVMGH  DROO YVSZEV QFHG ORPV GSV jG-HGBOV XLNNVMGH (GSFH IVJFRIRMT ZM
# VCKORXG @YIRVU XLNNZMW ULI Z YIRVU WVHXIRKGRLM.

qzezwlx_zfglyirvu      = bvh

# rU GSV rmsvirg_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM ZM FMWLXFNVMGVW
# NVNYVI RMSVIRGH GSV WLXFNVMGZGRLM UILN ZMB WLXFNVMGVW NVNYVI GSZG RG
# IVRNKOVNVMGH.

rmsvirg_wlxh           = bvh

# rU GSV rmormv_rmul GZT RH HVG GL bvh (GSV WVUZFOG) GSVM Z GZT [RMORMV]
# RH RMHVIGVW RM GSV WLXFNVMGZGRLM ULI RMORMV NVNYVIH.

rmormv_rmul            = bvh

# rU GSV hlig_nvnyvi_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM WLCBTVM
# DROO HLIG GSV (WVGZROVW) WLXFNVMGZGRLM LU UROV ZMW XOZHH NVNYVIH
# ZOKSZYVGRXZOOB YB NVNYVI MZNV. rU HVG GL ml GSV NVNYVIH DROO ZKKVZI RM
# WVXOZIZGRLM LIWVI.

hlig_nvnyvi_wlxh       = bvh

# rU NVNYVI TILFKRMT RH FHVW RM GSV WLXFNVMGZGRLM ZMW GSV wrhgiryfgv_tilfk_wlx
# GZT RH HVG GL bvh, GSVM WLCBTVM DROO IVFHV GSV WLXFNVMGZGRLM LU GSV URIHG
# NVNYVI RM GSV TILFK (RU ZMB) ULI GSV LGSVI NVNYVIH LU GSV TILFK. yB WVUZFOG
# ZOO NVNYVIH LU Z TILFK NFHG YV WLXFNVMGVW VCKORXRGOB.

wrhgiryfgv_tilfk_wlx   = ml

# gSV gzy_hrav GZT XZM YV FHVW GL HVG GSV MFNYVI LU HKZXVH RM Z GZY.
# wLCBTVM FHVH GSRH EZOFV GL IVKOZXV GZYH YB HKZXVH RM XLWV UIZTNVMGH.

gzy_hrav               = 5

# gSV vmzyov_hvxgrlmh GZT XZM YV FHVW GL VMZYOV XLMWRGRLMZO
# WLXFNVMGZGRLM HVXGRLMH, NZIPVW YB \RU HVXGRLMMZNV ... \VMWRU.

vmzyovw_hvxgrlmh       =

# gSV tvmvizgv_glwlorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GLWL ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GLWL
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_glwlorhg      = bvh

# gSV tvmvizgv_gvhgorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GVHG ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GVHG
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_gvhgorhg      = bvh

tvmvizgv_givvervd      = bvh

# gSRH GZT XZM YV FHVW GL HKVXRUB Z MFNYVI LU ZORZHVH GSZG ZXGH
# ZH XLNNZMWH RM GSV WLXFNVMGZGRLM. zM ZORZH SZH GSV ULIN "MZNV=EZOFV".
# uLI VCZNKOV ZWWRMT "HRWVVUUVXG=\KZI hRWV vUUVXGH:\M" DROO ZOOLD BLF GL
# KFG GSV XLNNZMW \HRWVVUUVXG (LI @HRWVVUUVXG) RM GSV WLXFNVMGZGRLM, DSRXS
# DROO IVHFOG RM Z FHVI WVURMVW KZIZTIZKS DRGS SVZWRMT "hRWV vUUVXGH:".
# bLF XZM KFG \M'H RM GSV EZOFV KZIG LU ZM ZORZH GL RMHVIG MVDORMVH.

zorzhvh                =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL DZIMRMT ZMW KILTIVHH NVHHZTVH
#---------------------------------------------------------------------------

# gSV jfrvg GZT XZM YV FHVW GL GFIM LM/LUU GSV NVHHZTVH GSZG ZIV TVMVIZGVW
# YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP ml RH FHVW.

jfrvg                  = ml

# gSV dzimrmth GZT XZM YV FHVW GL GFIM LM/LUU GSV DZIMRMT NVHHZTVH GSZG ZIV
# TVMVIZGVW YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP
# ml RH FHVW.

dzimrmth               = bvh

# rU dzim_ru_fmwlxfnvmgvw RH HVG GL bvh, GSVM WLCBTVM DROO TVMVIZGV DZIMRMTH
# ULI FMWLXFNVMGVW NVNYVIH. rU vcgizxg_zoo RH HVG GL bvh GSVM GSRH UOZT DROO
# ZFGLNZGRXZOOB YV WRHZYOVW.

dzim_ru_fmwlxfnvmgvw   = bvh

# gSV dzim_ulinzg GZT WVGVINRMVH GSV ULINZG LU GSV DZIMRMT NVHHZTVH GSZG
# WLCBTVM XZM KILWFXV. gSV HGIRMT HSLFOW XLMGZRM GSV $UROV, $ORMV, ZMW $GVCG
# GZTH, DSRXS DROO YV IVKOZXVW YB GSV UROV ZMW ORMV MFNYVI UILN DSRXS GSV
# DZIMRMT LIRTRMZGVW ZMW GSV DZIMRMT GVCG.

dzim_ulinzg            = "$UROV:$ORMV: $GVCG"

# gSV dzim_olturov GZT XZM YV FHVW GL HKVXRUB Z UROV GL DSRXS DZIMRMT
# ZMW VIILI NVHHZTVH HSLFOW YV DIRGGVM. rU OVUG YOZMP GSV LFGKFG RH DIRGGVM
# GL HGWVII.

dzim_olturov           =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV RMKFG UROVH
#---------------------------------------------------------------------------

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

#rmkfg                  =  NBwRIVXGLIB
# RMKFG GZT NLEVW GL GLK LU GSRH UROV

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

urov_kzggvimh          =  *.S *.XKK *.SKK *.XCC

# gSV ivxfihrev GZT XZM YV FHVW GL GFIM HKVXRUB DSVGSVI LI MLG HFYWRIVXGLIRVH
# HSLFOW YV HVZIXSVW ULI RMKFG UROVH ZH DVOO. kLHHRYOV EZOFVH ZIV bvh ZMW ml.
# rU OVUG YOZMP ml RH FHVW.

ivxfihrev              = bvh

# gSV vcxofwv GZT XZM YV FHVW GL HKVXRUB UROVH ZMW/LI WRIVXGLIRVH GSZG HSLFOW
# VCXOFWVW UILN GSV rmkfg HLFIXV UROVH. gSRH DZB BLF XZM VZHROB VCXOFWV Z
# HFYWRIVXGLIB UILN Z WRIVXGLIB GIVV DSLHV ILLG RH HKVXRURVW DRGS GSV rmkfg GZT.

vcxofwv                =

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcxofwv_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIMH GL VCXOFWV
# XVIGZRM UROVH UILN GSLHV WRIVXGLIRVH.

vcxofwv_kzggvimh       =

# gSV vcznkov_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM VCZNKOV XLWV UIZTNVMGH GSZG ZIV RMXOFWVW (HVV
# GSV \RMXOFWV XLNNZMW).

vcznkov_kzgs           =

# rU GSV EZOFV LU GSV vcznkov_kzgs GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcznkov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

vcznkov_kzggvimh       =

# gSV rnztv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM RNZTV GSZG ZIV RMXOFWVW RM GSV WLXFNVMGZGRLM (HVV
# GSV \RNZTV XLNNZMW).

rnztv_kzgs             =

# gSV rmkfg_urogvi GZT XZM YV FHVW GL HKVXRUB Z KILTIZN GSZG WLCBTVM HSLFOW
# RMELPV GL UROGVI ULI VZXS RMKFG UROV. wLCBTVM DROO RMELPV GSV UROGVI KILTIZN
# YB VCVXFGRMT (ERZ KLKVM()) GSV XLNNZMW <UROGVI> <RMKFG-UROV>, DSVIV <UROGVI>
# RH GSV EZOFV LU GSV rmkfg_urogvi GZT, ZMW <RMKFG-UROV> RH GSV MZNV LU ZM
# RMKFG UROV. wLCBTVM DROO GSVM FHV GSV LFGKFG GSZG GSV UROGVI KILTIZN DIRGVH
# GL HGZMWZIW LFGKFG.

rmkfg_urogvi           =

# rU GSV urogvi_hlfixv_urovh GZT RH HVG GL bvh, GSV RMKFG UROGVI (RU HVG FHRMT
# rmkfg_urogvi) DROO YV FHVW GL UROGVI GSV RMKFG UROVH DSVM KILWFXRMT HLFIXV
# UROVH GL YILDHV.

urogvi_hlfixv_urovh    = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV ZOKSZYVGRXZO XOZHH RMWVC
#---------------------------------------------------------------------------

# rU GSV zokszyvgrxzo_rmwvc GZT RH HVG GL bvh, ZM ZOKSZYVGRXZO RMWVC
# LU ZOO XLNKLFMWH DROO YV TVMVIZGVW. vMZYOV GSRH RU GSV KILQVXG
# XLMGZRMH Z OLG LU XOZHHVH, HGIFXGH, FMRLMH LI RMGVIUZXVH.

zokszyvgrxzo_rmwvc     = bvh

# rU GSV ZOKSZYVGRXZO RMWVC RH VMZYOVW (HVV zokszyvgrxzo_rmwvc) GSVM
# GSV xloh_rm_zoksz_rmwvc GZT XZM YV FHVW GL HKVXRUB GSV MFNYVI LU XLOFNMH
# RM DSRXS GSRH ORHG DROO YV HKORG (XZM YV Z MFNYVI RM GSV IZMTV [8..79])

xloh_rm_zoksz_rmwvc    = 6

# rM XZHV ZOO XOZHHVH RM Z KILQVXG HGZIG DRGS Z XLNNLM KIVURC, ZOO
# XOZHHVH DROO YV KFG FMWVI GSV HZNV SVZWVI RM GSV ZOKSZYVGRXZO RMWVC.
# gSV rtmliv_kivurc GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KIVURCVH GSZG
# HSLFOW YV RTMLIVW DSROV TVMVIZGRMT GSV RMWVC SVZWVIH.

rtmliv_kivurc          =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV sgno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_sgno GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV sgno LFGKFG.

tvmvizgv_sgno          = bvh

# gSV sgno_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV sgno WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `SGNO' DROO YV FHVW ZH GSV WVUZFOG KZGS.

sgno_lfgkfg            = SGNO

# gSV sgno_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno SVZWVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI.

sgno_svzwvi            =

# gSV sgno_ullgvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno ULLGVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW ULLGVI.

sgno_ullgvi            =

# gSV sgno_hgbovhsvvg GZT XZM YV FHVW GL HKVXRUB Z FHVI WVURMVW XZHXZWRMT
# HGBOV HSVVG GSZG RH FHVW YB VZXS sgno KZTV. rG XZM YV FHVW GL
# URMV-GFMV GSV OLLP LU GSV sgno LFGKFG. rU GSV GZT RH OVUG YOZMP WLCBTVM
# DROO TVMVIZGV Z WVUZFOG HGBOV HSVVG

sgno_hgbovhsvvg        =

# rU GSV sgno_zortm_nvnyvih GZT RH HVG GL bvh, GSV NVNYVIH LU XOZHHVH,
# UROVH LI MZNVHKZXVH DROO YV ZORTMVW RM sgno FHRMT GZYOVH. rU HVG GL
# ml Z YFOOVG ORHG DROO YV FHVW.

sgno_zortm_nvnyvih     = bvh

# rU GSV tvmvizgv_sgnosvok GZT RH HVG GL bvh, ZWWRGRLMZO RMWVC UROVH
# DROO YV TVMVIZGVW GSZG XZM YV FHVW ZH RMKFG ULI GLLOH ORPV GSV
# nRXILHLUG sgno SVOK DLIPHSLK GL TVMVIZGV Z XLNKIVHHVW sgno SVOK UROV (.XSN)
# LU GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

tvmvizgv_sgnosvok      = ml

# gSV wrhzyov_rmwvc GZT XZM YV FHVW GL GFIM LM/LUU GSV XLMWVMHVW RMWVC ZG
# GLK LU VZXS sgno KZTV. gSV EZOFV ml (GSV WVUZFOG) VMZYOVH GSV RMWVC ZMW
# GSV EZOFV bvh WRHZYOVH RG.

wrhzyov_rmwvc          = ml

# gSRH GZT XZM YV FHVW GL HVG GSV MFNYVI LU VMFN EZOFVH (IZMTV [8..79])
# GSZG WLCBTVM DROO TILFK LM LMV ORMV RM GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

vmfn_ezofvh_kvi_ormv   = 5

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV oZgVc LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_ozgvc GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV oZGVC LFGKFG.

tvmvizgv_ozgvc         = ml

# gSV ozgvc_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV oZgVc WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `OZGVC' DROO YV FHVW ZH GSV WVUZFOG KZGS.

ozgvc_lfgkfg           = OZGVC

# rU GSV xlnkzxg_ozgvc GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# oZgVc WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_ozgvc          = ml

# gSV kzkvi_gbkv GZT XZM YV FHVW GL HVG GSV KZKVI GBKV GSZG RH FHVW
# YB GSV KIRMGVI. kLHHRYOV EZOFVH ZIV: Z5, Z5DRWV, OVGGVI, OVTZO ZMW
# VCVXFGREV. rU OVUG YOZMP Z5DRWV DROO YV FHVW.

kzkvi_gbkv             = Z5DRWV

# gSV vcgiz_kzxpztvh GZT XZM YV GL HKVXRUB LMV LI NLIV MZNVH LU oZgVc
# KZXPZTVH GSZG HSLFOW YV RMXOFWVW RM GSV oZgVc LFGKFG.

vcgiz_kzxpztvh         =

# gSV ozgvc_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO oZgVc SVZWVI ULI
# GSV TVMVIZGVW OZGVC WLXFNVMG. gSV SVZWVI HSLFOW XLMGZRM VEVIBGSRMT FMGRO
# GSV URIHG XSZKGVI. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI. mLGRXV: LMOB FHV GSRH GZT RU BLF PMLD DSZG BLF ZIV WLRMT!

ozgvc_svzwvi           =

# rU GSV kwu_sbkviormph GZT RH HVG GL bvh, GSV oZgVc GSZG RH TVMVIZGVW
# RH KIVKZIVW ULI XLMEVIHRLM GL KWU (FHRMT KH7KWU). gSV KWU UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z KWU ERVDVI.

kwu_sbkviormph         = ml

# rU GSV fhv_kwuozgvc GZT RH HVG GL bvh, KWUOZGVC DROO YV FHVW RMHGVZW LU
# KOZRM OZGVC RM GSV TVMVIZGVW nZPVUROV. hVG GSRH LKGRLM GL bvh GL TVG Z
# SRTSVI JFZORGB kwu WLXFNVMGZGRLM.

fhv_kwuozgvc           = ml

# rU GSV ozgvc_yzgxsnlwv GZT RH HVG GL bvh, WLCBTVM DROO ZWW GSV \\YZGXSNLWV.
# XLNNZMW GL GSV TVMVIZGVW oZgVc UROVH. gSRH DROO RMHGIFXG oZgVc GL PVVK
# IFMMRMT RU VIILIH LXXFI, RMHGVZW LU ZHPRMT GSV FHVI ULI SVOK.
# gSRH LKGRLM RH ZOHL FHVW DSVM TVMVIZGRMT ULINFOZH RM sgno.

ozgvc_yzgxsnlwv        = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV igu LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_igu GZT RH HVG GL bvh wLCBTVM DROO TVMVIZGV igu LFGKFG
# gSV igu LFGKFG RH LKGRNRHVW ULI dLIW 02 ZMW NZB MLG OLLP EVIB KIVGGB DRGS
# LGSVI igu IVZWVIH LI VWRGLIH.

tvmvizgv_igu           = ml

# gSV igu_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV igu WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `IGU' DROO YV FHVW ZH GSV WVUZFOG KZGS.

igu_lfgkfg             = IGU

# rU GSV xlnkzxg_igu GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# igu WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_igu            = bvh

# rU GSV igu_sbkviormph GZT RH HVG GL bvh, GSV igu GSZG RH TVMVIZGVW
# DROO XLMGZRM SBKVIORMP URVOWH. gSV igu UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH.
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z dliw LI LGSVI.
# KILTIZNH DSRXS HFKKLIG GSLHV URVOWH.
# mLGV: DLIWKZW (DIRGV) ZMW LGSVIH WL MLG HFKKLIG ORMPH.

igu_sbkviormph         = ml

# oLZW HGBOVHSVVG WVURMRGRLMH UILN UROV. hBMGZC RH HRNROZI GL WLCBTVM'H
# XLMURT UROV, R.V. Z HVIRVH LU ZHHRTNVMGH. bLF LMOB SZEV GL KILERWV
# IVKOZXVNVMGH, NRHHRMT WVURMRGRLMH ZIV HVG GL GSVRI WVUZFOG EZOFV.

igu_hgbovhsvvg_urov    =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV NZM KZTV LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_nzm GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV NZM KZTVH

tvmvizgv_nzm           = ml

# gSV nzm_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV NZM KZTVH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `NZM' DROO YV FHVW ZH GSV WVUZFOG KZGS.

nzm_lfgkfg             = NZM

# gSV nzm_vcgvmhrlm GZT WVGVINRMVH GSV VCGVMHRLM GSZG RH ZWWVW GL
# GSV TVMVIZGVW NZM KZTVH (WVUZFOG RH GSV HFYILFGRMV'H HVXGRLM .6)

nzm_vcgvmhrlm          = .6

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV cno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_cno GZT RH HVG GL bvh wLCBTVM DROO
# TVMVIZGV ZM cno UROV GSZG XZKGFIVH GSV HGIFXGFIV LU
# GSV XLWV RMXOFWRMT ZOO WLXFNVMGZGRLM. dZIMRMT: gSRH UVZGFIV
# RH HGROO VCKVIRNVMGZO ZMW EVIB RMXLNKOVGV.

tvmvizgv_cno           = ml

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV KIVKILXVHHLI
#---------------------------------------------------------------------------

# rU GSV vmzyov_kivkilxvhhrmt GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# VEZOFZGV ZOO x-KIVKILXVHHLI WRIVXGREVH ULFMW RM GSV HLFIXVH ZMW RMXOFWV
# UROVH.

vmzyov_kivkilxvhhrmt   = bvh

# rU GSV nzxil_vckzmhrlm GZT RH HVG GL bvh wLCBTVM DROO VCKZMW ZOO NZXIL
# MZNVH RM GSV HLFIXV XLWV. rU HVG GL ml (GSV WVUZFOG) LMOB XLMWRGRLMZO
# XLNKROZGRLM DROO YV KVIULINVW. nZXIL VCKZMHRLM XZM YV WLMV RM Z XLMGILOOVW
# DZB YB HVGGRMT vckzmw_lmob_kivwvu GL bvh.

nzxil_vckzmhrlm        = ml

# rU GSV vckzmw_lmob_kivwvu ZMW nzxil_vckzmhrlm GZTH ZIV YLGS HVG GL bvh
# GSVM GSV NZXIL VCKZMHRLM RH ORNRGVW GL GSV NZXILH HKVXRURVW DRGS GSV
# kivwvurmvw ZMW vckzmw_zh_kivwvurmvw GZTH.

vckzmw_lmob_kivwvu     = ml

# rU GSV hvzixs_rmxofwvh GZT RH HVG GL bvh (GSV WVUZFOG) GSV RMXOFWVH UROVH
# RM GSV rmxofwv_kzgs (HVV YVOLD) DROO YV HVZIXS RU Z #RMXOFWV RH ULFMW.

hvzixs_rmxofwvh        = bvh

# gSV rmxofwv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV WRIVXGLIRVH GSZG
# XLMGZRM RMXOFWV UROVH GSZG ZIV MLG RMKFG UROVH YFG HSLFOW YV KILXVHHVW YB
# GSV KIVKILXVHHLI.

rmxofwv_kzgs           =

# bLF XZM FHV GSV rmxofwv_urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW
# KZGGVIMH (ORPV *.S ZMW *.SKK) GL UROGVI LFG GSV SVZWVI-UROVH RM GSV
# WRIVXGLIRVH. rU OVUG YOZMP, GSV KZGGVIMH HKVXRURVW DRGS urov_kzggvimh DROO
# YV FHVW.

rmxofwv_urov_kzggvimh  =

# gSV kivwvurmvw GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV NZXIL MZNVH GSZG
# ZIV WVURMVW YVULIV GSV KIVKILXVHHLI RH HGZIGVW (HRNROZI GL GSV -w LKGRLM LU
# TXX). gSV ZITFNVMG LU GSV GZT RH Z ORHG LU NZXILH LU GSV ULIN: MZNV
# LI MZNV=WVURMRGRLM (ML HKZXVH). rU GSV WVURMRGRLM ZMW GSV = ZIV
# LNRGGVW =8 RH ZHHFNVW.

kivwvurmvw             =  xliv_tilfk

# rU GSV nzxil_vckzmhrlm ZMW vckzmw_kivwvu_lmob GZTH ZIV HVG GL bvh GSVM
# GSRH GZT XZM YV FHVW GL HKVXRUB Z ORHG LU NZXIL MZNVH GSZG HSLFOW YV VCKZMWVW.
# gSV NZXIL WVURMRGRLM GSZG RH ULFMW RM GSV HLFIXVH DROO YV FHVW.
# fHV GSV kivwvurmvw GZT RU BLF DZMG GL FHV Z WRUUVIVMG NZXIL WVURMRGRLM.

vckzmw_zh_wvurmvw      =

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL VCGVIMZO IVUVIVMXVH
#---------------------------------------------------------------------------

# gSV gzturovh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV GZTUROVH.

gzturovh               =

# dSVM Z UROV MZNV RH HKVXRURVW ZUGVI tvmvizgv_gzturov, WLCBTVM DROO XIVZGV
# Z GZT UROV GSZG RH YZHVW LM GSV RMKFG UROVH RG IVZWH.

tvmvizgv_gzturov       =

# rU GSV zoovcgvimzoh GZT RH HVG GL bvh ZOO VCGVIMZO XOZHHVH DROO YV ORHGVW
# RM GSV XOZHH RMWVC. rU HVG GL ml LMOB GSV RMSVIRGVW VCGVIMZO XOZHHVH
# DROO YV ORHGVW.

zoovcgvimzoh           = ml

# gSV kvio_kzgs HSLFOW YV GSV ZYHLOFGV KZGS ZMW MZNV LU GSV KVIO HXIRKG
# RMGVIKIVGVI (R.V. GSV IVHFOG LU `DSRXS KVIO').

kvio_kzgs              = /FHI/YRM/KVIO

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV WLG GLLO
#---------------------------------------------------------------------------

# rU BLF HVG GSV szev_wlg GZT GL bvh GSVM WLCBTVM DROO ZHHFNV GSV WLG GLLO RH
# ZEZROZYOV UILN GSV KZGS. gSRH GLLO RH KZIG LU tIZKSERA, Z TIZKS ERHFZORAZGRLM
# GLLOPRG UILN zg&g ZMW oFXVMG yVOO oZYH. gSV LGSVI LKGRLMH RM GSRH HVXGRLM
# SZEV ML VUUVXG RU GSRH LKGRLM RH HVG GL ml (GSV WVUZFOG)

szev_wlg               = bvh

# rU GSV xozhh_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RMSVIRGZMXV IVOZGRLMH. hVGGRMT GSRH GZT GL bvh DROO ULIXV GSV
# GSV xozhh_wrztiznh GZT GL ml.

xozhh_tizks            = bvh

# rU GSV xloozylizgrlm_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RNKOVNVMGZGRLM WVKVMWVMXRVH (RMSVIRGZMXV, XLMGZRMNVMG, ZMW
# XOZHH IVUVIVMXVH EZIRZYOVH) LU GSV XOZHH DRGS LGSVI WLXFNVMGVW XOZHHVH.

xloozylizgrlm_tizks    = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwv_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW UROV HSLDRMT
# GSV WRIVXG ZMW RMWRIVXG RMXOFWV WVKVMWVMXRVH LU GSV UROV DRGS LGSVI
# WLXFNVMGVW UROVH.

rmxofwv_tizks          = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwvw_yb_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW SVZWVI UROV HSLDRMT
# GSV WLXFNVMGVW UROVH GSZG WRIVXGOB LI RMWRIVXGOB RMXOFWV GSRH UROV

rmxofwvw_yb_tizks      = bvh

# rU GSV tizksrxzo_srvizixsb ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TIZKSRXZO SRVIZIXSB LU ZOO XOZHHVH RMHGVZW LU Z GVCGFZO LMV.

tizksrxzo_srvizixsb    = bvh

# gSV GZT wlg_kzgs XZM YV FHVW GL HKVXRUB GSV KZGS DSVIV GSV WLG GLLO XZM YV
# ULFMW. rU OVUG YOZMP, RG RH ZHHFNVW GSV WLG GLLO XZM YV ULFMW LM GSV KZGS.

wlg_kzgs               =

# gSV nzc_wlg_tizks_drwgs GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDVW DRWGS
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_drwgs    = 8975

# gSV nzc_wlg_tizks_svrtsg GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDH SVRTSG
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_svrtsg   = 8975

# rU GSV tvmvizgv_ovtvmw GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z OVTVMW KZTV VCKOZRMRMT GSV NVZMRMT LU GSV EZIRLFH YLCVH ZMW
# ZIILDH RM GSV WLG TVMVIZGVW TIZKSH.

tvmvizgv_ovtvmw        = bvh

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL GSV HVZIXS VMTRMV
#---------------------------------------------------------------------------

# gSV hvzixsvmtrmv GZT HKVXRURVH DSVGSVI LI MLG Z HVZIXS VMTRMV HSLFOW YV
# FHVW. rU HVG GL ml GSV EZOFVH LU ZOO GZTH YVOLD GSRH LMV DROO YV RTMLIVW.

hvzixsvmtrmv           = ml

# gSV xtr_mznv GZT HSLFOW YV GSV MZNV LU GSV xtr HXIRKG GSZG
# HGZIGH GSV HVZIXS VMTRMV (WLCBHVZIXS) DRGS GSV XLIIVXG KZIZNVGVIH.
# z HXIRKG DRGS GSRH MZNV DROO YV TVMVIZGVW YB WLCBTVM.

xtr_mznv               = HVZIXS.XTR

# gSV xtr_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# XTR YRMZIRVH ZIV OLXZGVW. hVV GSV WLXFNVMGZGRLM LU BLFI SGGK WZVNLM ULI
# WVGZROH.

xtr_fio                =

# gSV wlx_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV ZYHLOFGV KZGS GL GSV
# WLXFNVMGZGRLM, DRGS UROV:// KIVKVMWVW GL RG, DROO YV FHVW.

wlx_fio                =

# gSV wlx_zyhkzgs GZT HSLFOW YV GSV ZYHLOFGV KZGS GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV WRIVXGLIB LM GSV OLXZO NZXSRMV
# DROO YV FHVW.

wlx_zyhkzgs            =

# gSV yrm_zyhkzgs GZT NFHG KLRMG GL GSV WRIVXGLIB DSVIV GSV WLCBHVZIXS YRMZIB
# RH RMHGZOOVW.

yrm_zyhkzgs            = /FHI/OLXZO/YRM/

# gSV vcg_wlx_kzgsh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KZGSH GL
# WLXFNVMGZGRLM TVMVIZGVW ULI LGSVI KILQVXGH. gSRH ZOOLDH WLCBHVZIXS GL HVZIXS
# GSV WLXFNVMGZGRLM ULI GSVHV KILQVXGH ZH DVOO.

vcg_wlx_kzgsh          =

//##**---------------- ./KBKFYHFY_WVEVOLK/GVHG/NZRM_GVHG.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-89-68
* \NLWRURVW  7984-89-68
* \YIRVU:
* xLMGZXG: 
* mLGV:
**********************************************/


#RMXOFWV <TGVHG/TGVHG.S>

RMG NZRM(RMG ZITX, XSZI **ZITE) {
    ::GVHGRMT::rMRGtLLTOVgVHG(&ZITX, ZITE);
    IVGFIM ifm_zoo_gvhgh();
}
//##**---------------- ./KBKFYHFY_WVEVOLK/GVHG/GVHG_UROV.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-89-68
* \NLWRURVW  7984-89-68
* \YIRVU:
* xLMGZXG: 
* mLGV:
**********************************************/



#RMXOFWV <TGVHG/TGVHG.S>

FHRMT MZNVHKZXV HGW;

gvhg(GZITVG, vCZNKOV) {
  zhhvig_vj(9, 9);
}
//##**---------------- ./KBKFYHFY_WVEVOLK/IVZWNV.NW
ivzwnv
=================================

# GZITVG(8)

  `GZITVG(8)` RH Z NZIPWLDM WIREVM NZMFZO KZTV ERVDVI,
  GSRH NZPVH NZMFZOH VZHRVI GL _DIRGV_, _IVFHV_, ZMW
  _IVZW_.

## fHZTV
    
    GZY GL RMWVMG XLWV ZMW FHZTV:

    fHZTV: GZITVG <UROV>

    lKGRLMH:

      -f, --FKWZGV-HVOU FKWZGV GZITVG(8) RGHVOU
      -F, --FKWZGV      FKWZGV IVNLGV NZW-KZTVH
      -E, --EVIHRLM     LFGKFG XKN EVIHRLM
      -S, --SVOK        LFGKFG GSRH SVOK RMULINZGRLM
      -O, --ORHG      ORHG GZITVG-KZTVH

## rMHGZOOZGRLM

  rMHGZOO `GZITVG(8)` ZMW RGH ZHHLXRZGVW ORYH GL /LKG.

    $ NZPV RMHGZOO

  fMRMHGZOO YLGS `GZITVG(8)` ZMW GSV ZHHLXRZGVW ORYH.

    $ NZPV FMRMHGZOO


## zYLFG

 
## xLMURTFIZGRLM

  KZPXZTV MVVWH HLNV VCGIZ XLMURTFIZGRLM
//##**---------------- ./KBKFYHFY_WVEVOLK/GLWL.GCG
glwl orhg
======================

# GSRH UROV XLMGZRMH EZIRLFH GLWL GZHPH FHRMT ULINZG ZH [kirlirgb  gzhp]

# kirlirgb   gzhp

*z*  GSRH RH Z GZHP @YFT

*y*  GSRH RH Z MVD UVZGFIV @UVZGFIV 
//##**---------------- ./KBKFYHFY_WVEVOLK/EVIHRLM.HS
EVIHRLM=
YFROW=
HSLD=
FKWZGV=
ZWW=
YFROW=
NZPV=
KFOO=
KFHS=
TRGHSLD=
TRGFKWZGV=

XSZMTVOLT=$(WRIMZNV $9)/xSZMTVoLT


DSROV TVGLKGH "HYZSFINKGTA" LKG; 
WL
  XZHV "$LKG" RM
    H) HSLD="B"
      ;;
    Y) YFROW="B"
      ;;
    S) VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G/T/A"
       VXSL "-H: HSLD XFIIVMG EVIHRLM"
       VXSL "-Z LI -I: ZWW LI IVOVZHV Z MVD EVIHRLM"
       VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
       VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
       VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
       VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
       VXSL "-T: HSLD TRG SVZW"
       VXSL "-A: FKWZGV TRG SVZW"
       VCRG 8 
       ;;
    Z) ZWW="B"
      ;;
    F) FKWZGV="B"
      ;;
    I) ZWW="B"
      ;;
    N) NZPV="B"
      ;;
    K) KFOO="B"
      ;;
    G) KFHS="B"
      ;;
    T) TRGHSLD="B"
      ;;
    A) TRGFKWZGV="B"
      ;;
  VHZX
WLMV

RU [[ -A $ZWW ]] && [[ -A $TRGHSLD ]] && [[ -A $TRGFKWZGV ]]  && [[ -A $FKWZGV ]] && [[ -A $HSLD ]] && [[ -A $YFROW ]] && [[ -A $NZPV ]] && [[ -A $KFHS ]] && [[ -A $KFOO  ]]
GSVM
    VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G"
    VXSL "-H: HSLD XFIIVMG IVOVZHV EVIHRLM"
    VXSL "-Z LI -I : ZWW LI IVOVZHV Z MVD EVIHRLM"
    VXSL "-Y: HSLD XFIIVMG YFROW EVIHRLM"
    VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
    VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
    VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
    VXSL "-T: ZXJFRIV TRG SVZW"
    VXSL "-A: FKWZGV TRG SVZW"
    VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
    VCRG 8 
UR

ORMV_MFN=9

DSROV IVZW ORMV
WL
  ORMV_MFN=$((ORMV_MFN+8))
  MZNV=$(VXSL $ORMV|GI -H " ")
  URIHG_XSZIZXGVI=${MZNV:9:8}
  RU [ "$URIHG_XSZIZXGVI" == "@" ];GSVM
    MZNV=${MZNV:7:${#MZNV}-6}
    EVIHRLM=$MZNV
    YIVZP
  VORU [ "$URIHG_XSZIZXGVI" == "%" ];GSVM
    MZNV=${MZNV:2:${#MZNV}-1}
    YFROWML=$MZNV
  UR
WLMV < $XSZMTVOLT

RU [[ ! -A $HSLD ]]; GSVM
  KIRMGU $EVIHRLM
  VCRG 9
UR


RU [[ ! -A $YFROW ]]; GSVM
  KIRMGU $YFROWML
  VCRG 9
UR

RU [[ ! -A $TRGFKWZGV ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  HVW -R "/trgsvzw/X\trgsvzw=$ts" .KZIZ.RMX 
  VCRG 9
UR


RU [[ ! -A $TRGHSLD ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  VCRG 9
UR


RU [[ ! -A $KFOO ]]; GSVM
  TRG HFYNLWFOV FKWZGV --IVNLGV 
  VCRG 9
UR


RU [[ ! -A $KFHS ]]; GSVM
  TRG KFHS --IVXFIHV-HFYNLWFOVH=XSVXP
  VCRG 9
UR


RU [[ ! -A $NZPV  ]]; GSVM
    YFROW_RMG=${YFROWML:0:${#YFROWML}-0}
    YFROW_WG=${YFROWML:9:${#YFROWML}-4}  
    (( YFROW_RMG = 89#$YFROW_RMG + 8 ))
    GLWZB=`WZGV +%b%N%W`
    YFROW_RMG=$(KIRMGU "%95W" $YFROW_RMG)  
    RU [ "$YFROW_WG" -VJ "$GLWZB"  ]; GSVM
        YFROWML=$YFROW_WG-$YFROW_RMG
    VOHV 
        YFROWML=$GLWZB-9998
    UR
    HVW -R "H/.*yfrow.*/%yfrow[$YFROWML]/" $XSZMTVOLT
    KIRMGU $YFROWML
    VCRG 9
UR


NLWRURVW=$(WZGV +%b-%N-%W)

BVOOLD='\966[8;66N'
mx='\966[9N'

RU [[ ! -A $ZWW ]]; GSVM
  KIRMGU "iVOVZHRMT Z MVD EVIHRLM, GSV NLHG IVXVMG EVIHRLM RH ${BVOOLD}$EVIHRLM${mx}:\M"
  IVZW -K "mVD EVIHRLM ml: " MVDEVIHRLM
  IVZW -K "mVD EVIHRLM MZNV: " EVIHRLMMZNV
  IVZW -K "mVD EVIHRLM YIRVU: " YIRVU
  HVW -R "${ORMV_MFN}R\\
@[$MVDEVIHRLM]\M# $NLWRURVW\M## $EVIHRLMMZNV \M- $YIRVU\M\\
    " $XSZMTVOLT
  VXSL "xSZMTVoLT FKWZGVW, MVD EVIHRLM $MVDEVIHRLM RMHVIGVW"
  VCRG 9
UR

RU [[ ! -A $FKWZGV ]]; GSVM 
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\EVIHRLM.*/\* \\\EVIHRLM   $EVIHRLM/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\NLWRURVW.*/\* \\\NLWRURVW  $NLWRURVW/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\kilqvxg_mfnyvi.*/\* \\\kilqvxg_mfnyvi=$NLWRURVW/"
    VXSL "eVIHRLM ml RM ZOO UROVH FKWZGVW"
UR

//##**---------------- ./KBKFYHFY_WVEVOLK/xSZMTVoLT
kilqvxg: KBKFYHFY
zfgsli: YUZM
xivzgvw: 7984-89-68
      
    
# xSZMTV oLT
zOO MLGZYOV XSZMTVH GL GSRH KILQVXG DROO YV WLXFNVMGVW RM GSRH UROV.
fHFZOOB VZXS RGVN RH ZWSVIVW GL LMV IVOVZHV MFNYVI XSZMTV

%yfrow[79839382-9952]
    

@[9.9.8]
# 7984-89-68
## KILQVXG RH RMRGRZOAVW
- KILQVXG RMRGRZORAVW, GSRH HSLFOW YV GSV *EVIB* URIHG EVIHRLM
//##**---------------- ./FYRJGLLO_WVE/nZPVUROV
hsvoo:=/YRM/YZHS -l VCGTOLY


# tOLYZO hDRGXSVH
ivovzhv := 9
yvmxsnzip := 9

wzgv := 9
RUVJ ($(wzgv), 9)
    wzgv := $(HSVOO WZGV +%b%N%W)
VMWRU

wvhgrmzgrlm := 9
RUVJ ($(wvhgrmzgrlm), 9)
    wvhgrmzgrlm := /LKG/EVIHRLM/$(wzgv)
VMWRU



# HVG xkkuozth
xkkuozth := -dZOO -KVWZMGRX -dML-WVKIVXZGVW -HGW=X++9C
xuozth :=

# tOLYZO eZIRZYOVH
xx=TXX
xkk=T++


# HVG RMHGZOO KZGS SVIV
#rmhgzoo_kzgs=/LKG
rmhgzoo_kzgs=$(wvhgrmzgrlm)
# 7 WVURMRGRLMH FHVW YB FYRJ EVIHRLM XLMGILO HBHGVN

wve_evihrlm=$(HSVOO ./EVIHRLM.HS -H)
xlnkrovi_evihrlm = $(HSVOO $(xkk) -WFNKEVIHRLM)
fkwzgv_yfrow := $(HSVOO ./EVIHRLM.HS -N)
yfrow_evihrlm := $(HSVOO ./EVIHRLM.HS -Y)
pvimvo_evihrlm := $(HSVOO FMZNV -I)

fyrj_wvu= -wfyrj_wve_evihrlm='"$(wve_evihrlm)"' -wfyrj_wve_xlnkrovi='"$(xkk)"' -wfyrj_xlnkrovi_evihrlm='"$(xlnkrovi_evihrlm)"' -wfyrj_wve_yfrow='"$(yfrow_evihrlm)"'

xkkuozth += $(fyrj_wvu)
xuozth += $(fyrj_wvu)

# EZIRLFH UOZTH, HVG KIVUVIIVW LKGRNRAZGRLM UOZT SVIV ZOHL
lkg_uozth := -l6 -wfyrj_ml_vcxvkgrlm  -wivovzhv -wmwvyft
wvyft_uozth := -T -wwvyft
yvmxsnzip_uozth := -wyvmxsnzip
wbmznrx_uozth := -Ukrx -HSZIVW
lyq_uozth := -X


kivurc=.
ory_kzgs=$(kivurc)/ORY
yrm_kzgs=$(kivurc)/YRM
hix_kzgs=$(kivurc)/HIX
wlx_kzgs=$(kivurc)/WLX
vgx_kzgs=$(kivurc)/VGX
yfrow_kzgs=$(kivurc)/YFROW
rmxofwv_kzgs=$(kivurc)/RMXOFWV

# SVZWVI UROVH
svzwvi := $(DROWXZIW $(rmxofwv_kzgs)/*.S)

# FMRG GVHG, DV FHV TGVHG SVIV; BLF ZIV UIVV GL XSLLHV ZMBGSRMT VOHV
gvhg_hixh := $(DROWXZIW GVHG/*.XKK)
gvhg_lyqvxgh := $(ZWWKIVURC GVHG/,$(MLGWRI $(gvhg_hixh:.XKK=.L)))
gvhg_uozth :=  -OTGVHG  -OKGSIVZW


# GZITVG ORY/NZRM KILTIZN
# gzitvg_hixh = $(DROWXZIW HIX/*.XKK)

gzitvg_hixh = $(UROGVI-LFG $(DROWXZIW HIX/*NZRM.XKK), $(DROWXZIW HIX/*.XKK))
gzitvg_lyqvxgh:=$(ZWWKIVURC YFROW/,$(MLGWRI $(gzitvg_hixh:.XKK=.L)))


##############################################
# ULI WOLKVM/WOHBN

RUVJ ($(yvmxsnzip), 8)
xuozth += $(yvmxsnzip_uozth)
xkkuozth += $(yvmxsnzip_uozth)
VMWRU

RUVJ ($(ivovzhv), 9)
xuozth += $(wvyft_uozth) 
xkkuozth += $(wvyft_uozth)
VOHV
xuozth += $(lkg_uozth)
xkkuozth += $(lkg_uozth)
VMWRU

WVUZFOG:: ZOO

oryh += -dO,-yHGZGRX -o/LKG/6IW/IV7/ORY  -OIV7 -dO,-yWBMZNRX
rmx = -r$(rmxofwv_kzgs) -r/LKG/6IW/FYRJYZHV/RMXOFWV   -r/LKG/6IW/IV7/RMXOFWV

#******************* gzitvgh ***************************
ZOO:: ORYFYRJGLLO.Z ORYFYRJOLT.Z YVMXSXLMGVCG WFNKhSNoLT FJXLNKROV FJIVZW FIVZW KBGSLMDIZK


XOZMT: ORYFYRJGLLO.Z
XOZMT: xcc = /FHI/YRM/XOZMT++ -HGWORY=ORYX++ -r/FHI/RMXOFWV/X++/E8
XOZMT: xx = /FHI/YRM/XOZMT
XOZMT: xkkuozth += -HGW=X++88 

YFROW/%.L: HIX/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(wbmznrx_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)

ORYFYRJGLLO.Z: $(gzitvg_lyqvxgh)
	ZI IEH ORY/ORYFYRJGLLO.Z $(gzitvg_lyqvxgh)

ZWEOLT: HIX/OLT/zWEoLT.XKK ORYFYRJGLLO.Z
	$(xkk) $(xkkuozth) $(wbmznrx_uozth) $(lyq_uozth) $(rmx) -oORY -OFYRJGLLO.Z -L YFROW/zWEoLT.L HIX/OLT/zWEoLT.XKK  $(oryh)

ORYFYRJOLT.Z: ZWEOLT
	ZI IEH ORY/ORYFYRJOLT.Z YFROW/zWEoLT.L

YVMXSXLMGVCG:
	NZPV -x YVMXSNZIP/XLMGVCGHDRGXS/  wzgv=$(wzgv)

KBGSLMDIZK:
	T++ -HSZIVW -dO,-HLMZNV,KBDIZKORY.HL -L ORY/KBDIZKORY.HL -Ukrx KBGSLM-HIX/KBGSLM_UFMX.XKK

WFNKhSNoLT: ORYFYRJGLLO.Z ORYFYRJOLT.Z
	$(xkk) HIX/WFNKhSNoLT_NZRM.XKK  -L YRM/WFNKhSNoLT $(xkkuozth) ORY/ORYFYRJOLT.Z ORY/ORYFYRJGLLO.Z -OIG -OKGSIVZW
GVHGoLT: ORYFYRJGLLO.Z ORYFYRJOLT.Z
	$(xkk) HIX/GVHGoLT_NZRM.XKK  -L YRM/GVHGoLT $(xkkuozth) ORY/ORYFYRJOLT.Z ORY/ORYFYRJGLLO.Z -OIG -OKGSIVZW


FJXLNKROV: ORYFYRJGLLO.Z ORYFYRJOLT.Z 
	$(xkk) -HGW=X++9C GLLO/O7.XKK -rRMXOFWV -r/LKG/6IW/FYRJYZHV/RMXOFWV  -oORY   -L YRM/FJXLNKROV $(xkkuozth) ORY/ORYFYRJOLT.Z ORY/ORYFYRJGLLO.Z -OIG -OKGSIVZW -OA

FJIVZW: ORYFYRJGLLO.Z ORYFYRJOLT.Z 
	$(xkk) -HGW=X++9C GLLO/I7.XKK -rRMXOFWV -dO,-IKZGS="/LKG/6IW/IV7/ORY" -r/LKG/6IW/IV7/RMXOFWV -r/LKG/6IW/FYRJYZHV/RMXOFWV -o/LKG/6IW/IV7/ORY  -oORY -OIV7  -L YRM/FJIVZW $(xkkuozth)  ORY/ORYFYRJOLT.Z ORY/ORYFYRJGLLO.Z -OIG -OKGSIVZW -OA

FIVZW: ORYFYRJGLLO.Z ORYFYRJOLT.Z 
	$(xkk) -HGW=X++9C GLLO/FIVZW.XKK -rRMXOFWV -r/LKG/6IW/FYRJYZHV/RMXOFWV  -oORY   -L YRM/FIVZW $(xkkuozth) ORY/ORYFYRJOLT.Z ORY/ORYFYRJGLLO.Z -OIG -OKGSIVZW -OA



#******************* gvhg xlnkrozgrlm ******************
GVHG/%.L: GVHG/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(gvhg_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)


GVHG: $(gvhg_lyqvxgh) $(svzwvi)
	$(xkk) $(gvhg_lyqvxgh) $(xkkuozth) $(oryh) $(gvhg_uozth) -OIG -OKGSIVZW -oORY -OFYRJGLLO -L IFMgVHGH



KOZB:
	$(xkk) -T -HGW=X++9C  KOZB/KOZB_GRNV.XKK -rRMXOFWV -OIG -L YRM/KOZBGRNV
	$(xkk) -T -HGW=X++9C  KOZB/KOZB_WZGV.XKK -rRMXOFWV -OIG -L YRM/KOZBWZGV

#*************************  wlx ***********************
WLX:
	WLCBTVM WLCBTVM.RMR

#************************* rmhgzoo *********************
.kslmb:  YVMXSXLMGVCG WLX XOVZM WRHGXOVZM RMHGZOO NZM KOZB

#RMHGZOO: ZOO
RMHGZOO: ZOO
	VXSL $(rmhgzoo_kzgs)
	NPWRI -K  $(rmhgzoo_kzgs)/ORY/
	NPWRI -K  $(rmhgzoo_kzgs)/YRM/
	NPWRI -K  $(rmhgzoo_kzgs)/RMXOFWV/
	NZPV RMHGZOO -x YVMXSNZIP/XLMGVCGHDRGXS wzgv=$(wzgv)
	XK  $(ory_kzgs)/*.Z $(rmhgzoo_kzgs)/ORY/  
	XK  $(ory_kzgs)/*.HL $(rmhgzoo_kzgs)/ORY/  
	XK  $(yrm_kzgs)/* $(rmhgzoo_kzgs)/YRM/
	XK  -I $(rmxofwv_kzgs)/* $(rmhgzoo_kzgs)/RMXOFWV/
	XK  $(vgx_kzgs)/FYRJGLLO.RMX  /RMX/
	IN -IU $(rmhgzoo_kzgs)/KBGSLM-ORYH
	NPWRI -K $(rmhgzoo_kzgs)/KBGSLM-ORYH/FYRJGLLO
	XK KBGSLM/*  $(rmhgzoo_kzgs)/KBGSLM-ORYH/FYRJGLLO/
	XK KBGSLMGLLO/* $(rmhgzoo_kzgs)/YRM/
#************************* xovzm ************************
XOVZM:: 
	NZPV XOVZM -x YVMXSNZIP/XLMGVCGHDRGXS
	@IN -IU $(gvhg_lyqvxgh) $(gzitvg_lyqvxgh)
	@IN -IU $(ory_kzgs)/*
	@IN -IU $(yrm_kzgs)/!(*.HS)
	@IN -IU $(yfrow_kzgs)/*
	@IN -IU IFMgVHGH

WRHGXOVZM: XOVZM
	@IN -IU TNLM.LFG
	@IN -IU XLIV.*
	@IN -IU *~
	@IN -IU $(wlx_kzgs)/*
	@IN -IU xnZPVxZXSV.GCG xnZPVuROVH XNZPV_RMHGZOO.XNZPV 
IVYFROW:: XOVZM ZOO

//##**---------------- ./FYRJGLLO_WVE/KBGSLMGLLO/FYRJKLHG
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
'''
fhztv:

FYRJKLHG -Z 89.81.9.876:39918 -K GBKV=JFVIB -F NZRMYZHV/WVE8
'''

RNKLIG HBH
RNKLIG QHLM
#RNKLIG IVJFVHGH
RNKLIG TVGLKG
UILN KKIRMG RNKLIG KKIRMG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG
UILN FYRJGLLO.FYRJWMH RNKLIG fYRJwmh

WVU SVOK():
    KIRMG('fhztv: FYRJKLHG -Z 89.81.9.876:39918 -K GBKV=JFVIB -F NZRMYZHV/WVE8 -Q P8=E8,P7=E7')

RU __MZNV__ == '__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], \
                                      'Z:K:F:Q:YS', \
                                      ['ZWWIVHH=', 'KZBOLZW=', 'ZITFNVMG=', 'QHLM=', 'YVZFGRUFO', 'SVOK'])
    KZBOLZW = {}
    QHLM = {}
    ZWWIVHH = ''
    ZITFNVMGH = ''
    YVZFGRUFO = uZOHV
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-Z', '--ZWWIVHH'):
            ZWWIVHH = ZIT
        RU LKG RM ('-K', '--KZBOLZW'):
            KZBOLZWORHG = ZIT.HKORG('&')
            ULI RGVN RM KZBOLZWORHG:
                KZBOLZW[RGVN.HKORG('=')[9]] = RGVN.HKORG('=')[8]
        RU LKG RM ('-F', '--ZITFNVMG'):
            ZITFNVMGH = ZIT
        RU LKG RM ('-Q', '--QHLM'):
            ULI RGVN RM ZIT.HKORG(','):
                P = RGVN.HKORG('=')[9].HGIRK()
                E = RGVN.HKORG('=')[8].HGIRK()
                QHLM[P] = E
        RU LKG RM ('-Y', '--YVZFGRUFO'):
            YVZFGRUFO = gIFV
        RU LKG RM ('-S', '--SVOK'):
            SVOK()
            HBH.VCRG(9)

    RU ZWWIVHH=='' LI ZITFNVMGH == '':
        SVOK()
        HBH.VCRG(9)

    WMH = fYRJwmh()
    WMH.IVUIVHS()
    ZWWI = WMH.GIZMHOZGV(ZWWIVHH)
    XORVMG = kLHGxORVMG(ZWWI[9], RMG(ZWWI[8]))
    XOR = XORVMG.KLHG(ZITFNVMGH, KZBOLZW, QHLM)
    RU YVZFGRUFO:
        KKIRMG(XOR)
    VOHV:
        KIRMG(XOR)
//##**---------------- ./FYRJGLLO_WVE/KBGSLMGLLO/IVZWYFOOVGRM.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG LH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN FYRJGLLO.YFOOVGRM RNKLIG yFOOVGRM
RNKLIG GRNV
RNKLIG TVGLKG

RU __MZNV__ == '__NZRM__':
    YFO = 'YFOOVGRM'
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'Y:', ['YFOOVGRM='])
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-Y', '--YFOOVGRM'):
            YFO = ZIT
    YO = yFOOVGRM(YFO)
    YO.LKVM()
    # DSROV gIFV:
    YO.IVZW()
    # GRNV.HOVVK(8)
    KIRMG(YO.IZMWLN_RW, YO.ILD_MFN)
    RU YO.ILD_MFN != 9:
        KIRMG('-----------')
        ULI ILD RM YO.ILD_ORHG:
            KIRMG(ILD.RMW, ILD.ZFGSLI, ILD.GRGOV, ILD.XLMGVMG)
//##**---------------- ./FYRJGLLO_WVE/KOZB/KOZB_WVKVMWVMXBGIVV.XKK
#RMXOFWV <RLHGIVZN>
#RMXOFWV <UHGIVZN>
#RMXOFWV <EVXGLI>
#RMXOFWV <XZHHVIG>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV "RMXOFWV/FYRJ_WVKVMWVMXB.S"

FHRMT MZNVHKZXV HGW;
FHRMT MZNVHKZXV FYRJGLLO;

RMG NZRM(RMG ZITX, XSZI* ZITE[])
{
    wVKVMWVMXBgIVV<RMG> GIVV;

    ZFGL RMW8 = GIVV.zWWmLWV(MVD RMG(8));
    ZFGL RMW7 = GIVV.zWWmLWV(MVD RMG(7));
    ZFGL RMW6 = GIVV.zWWmLWV(MVD RMG(6));
    ZFGL RMW5 = GIVV.zWWmLWV(MVD RMG(5));
    ZFGL RMW4 = GIVV.zWWmLWV(MVD RMG(4));
    ZFGL RMW3 = GIVV.zWWmLWV(MVD RMG(3));
    ZFGL RMW2 = GIVV.zWWmLWV(MVD RMG(2));

    GIVV.zWWwVKVMWVMXB(RMW7,RMW6);
    GIVV.zWWwVKVMWVMXB(RMW6,RMW8);
    GIVV.zWWwVKVMWVMXB(RMW8,RMW5);

    GIVV.hLIG();
    ZFGL HLIGVW = GIVV.TVGhLIGVWoRHG();

    XLFG << "rMKFG tIZKS hRAV: " << GIVV.HRAV() << VMWO
        << "kLHHRYOV gLKLOLTRXZO HLIGVW LIWVI: ";
    ULI (HRAV_G R = 9; R < HLIGVW.HRAV(); ++R)
    {
        XLFG << (HLIGVW[R] + 8) << ", ";

    }

    XLFG << VMWO;

    IVGFIM 9;

}
//##**---------------- ./FYRJGLLO_WVE/KOZB/KOZB_WZGV.XKK
#RMXOFWV <RLHGIVZN>
#RMXOFWV <EVXGLI>
#RMXOFWV "FYRJ_GLLO.S"

FHRMT MZNVHKZXV FYRJGLLO;


RMG NZRM(){
    ZFGL IVG = tVMzOOwZBHrMbVZI(7984);
    ULI  (ZFGL RGVI=IVG.YVTRM(); RGVI!=IVG.VMW(); ++RGVI )
    {
        HGW::XLFG<<*RGVI<<HGW::VMWO;
    }
}
//##**---------------- ./FYRJGLLO_WVE/KOZB/KOZB_KRW.XKK
#RMXOFWV <RLHGIVZN>
#RMXOFWV "FYRJ_FGRO.S"

RMG NZRM(){
    FYRJGLLO::dIRGVkILTIZNkRW("GVHGKOZB");
    IVGFIM 9;
}
//##**---------------- ./FYRJGLLO_WVE/KOZB/KOZB_GRNV.XKK
#RMXOFWV <RLHGIVZN>
#RMXOFWV <EVXGLI>
#RMXOFWV "FYRJ_GLLO.S"

FHRMT MZNVHKZXV FYRJGLLO;

RMG NZRM(){
    HGW::EVXGLI<OLMT> GIZWRMTWZBORHG = {79848985, 79848984, 79848983, 79848982};
    FYRJGLLO::xOLXP< FYRJGLLO::gRNVkLORXB::gIZWRMTwZB > XOLXP(GIZWRMTWZBORHG);
    FYRJGLLO::xOLXP<> XOLXP7;

    DSROV(8)
    {
        XOLXP.fKWZGV();
        XOLXP7.fKWZGV();
        HGW::XLFG<<XOLXP7.wZGVgLrMG()<<HGW::VMWO;
        HGW::XLFG<<XOLXP.N_GIZWRMT_WZB<<" "<<XOLXP.SLFI<<":"<<XOLXP.NRM<<":"<<XOLXP.HVX<<HGW::VMWO;
        HOVVK(8);
    }
}
//##**---------------- ./FYRJGLLO_WVE/KBGSLM-HIX/KBGSLM_UFMX.XKK
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <HBH/HBHXZOO.S>
#RMXOFWV <FMRHGW.S>
VCGVIM "x"{

KRW_G tVGgrw(){
    IVGFIM HBHXZOO(__mi_TVGGRW);
}

}
//##**---------------- ./FYRJGLLO_WVE/GSILFTS.HS
#!/YRM/YZHS
    Z=79848970
    VXSL DLIPRMT LM $Z
    RU [[ "$Z" < 79839487 ]]; GSVM
         /LKG/WVE/YRM/FJXLNKROV /WZG/ZOO/vJFRGB/ogh/oVEVO7/WZGZ/7984/$Z/WFNK_RMHGIFNVMG_$Z.WZG.TA /WZG/ZOO/vJFRGB/ogh/oVEVO7/WZGZ/7984/$Z/WFNK_RMWVC_$Z.WZG.TA /WZG/ZOO/lKGRLM/nZIPVGwZGZ/oVEVO7/WZGZ/7984/$Z/WFNK_LKGRLM_$Z.WZG.TA 
    VOHV
        /LKG/WVE/YRM/FJXLNKROV /WZG/ZOO/vJFRGB/ogh/oVEVO7/WZGZ/7984/$Z/WFNK_RMHGIFNVMG_$Z.WZG.TA /WZG/ZOO/vJFRGB/ogh/oVEVO7/WZGZ/7984/$Z/WFNK_RMWVC_$Z.WZG.TA 
    UR
    NE LFGKFG.WZG /WZG/ZOO/vJFRGB/ogh/oVEVO7/WZGZ/7984/$Z/WFNK_$Z.WZG.TA 
//##**---------------- ./FYRJGLLO_WVE/VGX/FYRJGLLO.RMX
fyrjgllo_rmx+=-r/LKG/6IW/IV7/RMXOFWV
fyrjgllo_ory+=-o/LKG/6IW/IV7/ORY -dO,-IKZGS=/LKG/6IW/IV7/ORY -OIV7 -OFYRJOLT -OFYRJGLLO
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/nZPVUROV
xx = TXX

xuozth = -NZIXS=MZGREV -l6 -NML-ZEC -w_clkvm_hlfixv=399 -w_tmf_hlfixv -HGW=X00 \
         -d -dZOO -dVIILI
owuozth = -OIG -OKGSIVZW

gzitvgh = GRNVXGCHD GRNVXGCHDDH GRNVHBHXZOO GRNVGXGCHD GRNVGXGCHD7

ZOO: $(gzitvgh)

YVMXS: $(gzitvgh)
	./XKFYVMXS.HS

RMHGZOO: $(gzitvgh)
	XK XKFYVMXS.HS /LKG/EVIHRLM/YFROW/YRM/
	XK GRNVXGCHD /LKG/EVIHRLM/YFROW/YRM/
	XK GRNVXGCHDDH /LKG/EVIHRLM/YFROW/YRM/
	XK GRNVHBHXZOO /LKG/EVIHRLM/YFROW/YRM/
	XK GRNVGXGCHD /LKG/EVIHRLM/YFROW/YRM/
	XK GRNVGXGCHD7 /LKG/EVIHRLM/YFROW/YRM/


XOVZM:
	IN -U $(gzitvgh)

.kslmb: ZOO YVMXS XOVZM RMHGZOO
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/XKFYVMXS.HS
#!/YRM/YZHS
UTIVK 'NLWVO MZNV' /KILX/XKFRMUL | HLIG -F | CZITH
KTIVK ENDZIV >/WVE/MFOO && VXSL iFMMRMT FMWVI enDZIV
MXKFH=`HLIG -F /HBH/WVERXVH/HBHGVN/XKF/XKF*/GLKLOLTB/KSBHRXZO_KZXPZTV_RW | DX -O`
XLIVKVIXKF=`HLIG -F /HBH/WVERXVH/HBHGVN/XKF/XKF*/GLKLOLTB/XLIV_RW | DX -O`
GSIVZWKVIXLIV=`HVW \
"H/7/89/T;\
H/6/88/T;\
H/5/899/T;\
H/4/898/T;\
H/3/889/T;\
H/2/888/T;\
H/1/8999/T;\
H/0/8998/T;\
H/Z/8989/T;\
H/Y/8988/T;\
H/X/8899/T;\
H/W/8898/T;\
H/V/8889/T;\
H/U/8888/T;\
H/[^8]//T" /HBH/WVERXVH/HBHGVN/XKF/XKF*/GLKLOLTB/GSIVZW_HRYORMTH \
  | DSROV IVZW MGSIVZWH; WL VXSL ${#MGSIVZWH}; WLMV | HLIG -F`
GLGZO=$((MXKFH * XLIVKVIXKF * GSIVZWKVIXLIV))
VXSL "$MXKFH KSBHRXZO xkfH, $XLIVKVIXKF XLIVH/xkf,\
 $GSIVZWKVIXLIV SZIWDZIV GSIVZWH/XLIV = $GLGZO SD GSIVZWH GLGZO"

IFMYVMXS() {
  $* GRNVHBHXZOO
  $* GRNVXGCHD
  $* GRNVGXGCHD
  $* GRNVGXGCHD7
}

VXSL '-- mL xkf ZUURMRGB --'
IFMYVMXS

VXSL '-- dRGS xkf ZUURMRGB --'
OZHGXKF=`ZDP </WVE/MFOO -E MXKFH=$MXKFH 'yvtrm {
  M = 8;
  ULI(R = 8; R < MXKFH; R++) M *= 7;
  KIRMGU("9C%C\M", M);
}'`
IFMYVMXS GZHPHVG $OZHGXKF

VXSL '-- dRGS xkf ZUURMRGB GL xkf 9 --'
IFMYVMXS GZHPHVG `HVW 'H/,//T;H/^/9C/' /HBH/WVERXVH/HBHGVN/MLWV/MLWV9/XKFNZK`
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/GRNVGXGCHD7.X
#RMXOFWV <HXSVW.S>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <GRNV.S>
#RMXOFWV <HGIRMT.S>
#RMXOFWV <VIIML.S>

HGZGRX RMORMV OLMT OLMT FMHRTMVW GRNV_MH(HGIFXG GRNVHKVX* XLMHG GH) {
  RU (XOLXP_TVGGRNV(xolxp_ivzogrnv, GH)) {
    VCRG(8);
  }
  IVGFIM ((OLMT OLMT FMHRTMVW) GH->GE_HVX) * 8999999999oof
    + (OLMT OLMT FMHRTMVW) GH->GE_MHVX;
}

HGZGRX XLMHG RMG RGVIZGRLMH = 499999;

HGZGRX ELRW* GSIVZW(ELRW*XGC) {
  (ELRW)XGC;
  ULI (RMG R = 9; R < RGVIZGRLMH; R++)
      HXSVW_BRVOW();
  IVGFIM mfoo;
}

RMG NZRM(ELRW) {
  HGIFXG HXSVW_KZIZN KZIZN;
  KZIZN.HXSVW_KIRLIRGB = 8;
  RU (HXSVW_HVGHXSVWFOVI(TVGKRW(), hxsvw_urul, &KZIZN))
    UKIRMGU(HGWVII, "HXSVW_HVGHXSVWFOVI(): %H\M", HGIVIILI(VIIML));

  HGIFXG GRNVHKVX GH;
  KGSIVZW_G GSW;
  RU (KGSIVZW_XIVZGV(&GSW, mfoo, GSIVZW, mfoo)) {
    IVGFIM 8;
  }

  OLMT OLMT FMHRTMVW HGZIG_MH = GRNV_MH(&GH);
  ULI (RMG R = 9; R < RGVIZGRLMH; R++)
      HXSVW_BRVOW();
  OLMT OLMT FMHRTMVW WVOGZ = GRNV_MH(&GH) - HGZIG_MH;

  XLMHG RMG MHDRGXSVH = RGVIZGRLMH << 7;
  KIRMGU("%R  GSIVZW XLMGVCG HDRGXSVH RM %OOFMH (%.8UMH/XGCHD)\M",
         MHDRGXSVH, WVOGZ, (WVOGZ / (UOLZG) MHDRGXSVH));
  IVGFIM 9;
}
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/GRNVXGCHD.X
#RMXOFWV <HXSVW.S>
#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <HBH/RKX.S>
#RMXOFWV <HBH/HSN.S>
#RMXOFWV <HBH/HBHXZOO.S>
#RMXOFWV <HBH/DZRG.S>
#RMXOFWV <GRNV.S>
#RMXOFWV <FMRHGW.S>

#RMXOFWV <ORMFC/UFGVC.S>

HGZGRX RMORMV OLMT OLMT FMHRTMVW GRNV_MH(HGIFXG GRNVHKVX* XLMHG GH) {
  RU (XOLXP_TVGGRNV(xolxp_ivzogrnv, GH)) {
    VCRG(8);
  }
  IVGFIM ((OLMT OLMT FMHRTMVW) GH->GE_HVX) * 8999999999oof
    + (OLMT OLMT FMHRTMVW) GH->GE_MHVX;
}

RMG NZRM(ELRW) {
  XLMHG RMG RGVIZGRLMH = 499999;
  HGIFXG GRNVHKVX GH;
  XLMHG RMG HSN_RW = HSNTVG(rkx_kirezgv, HRAVLU (RMG), rkx_xivzg | 9333);
  XLMHG KRW_G LGSVI = ULIP();
  RMG* UFGVC = HSNZG(HSN_RW, mfoo, 9);
  *UFGVC = 9Cz;
  RU (LGSVI == 9) {
    ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
      HXSVW_BRVOW();
      DSROV (HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzrg, 9Cz, mfoo, mfoo, 57)) {
        // IVGIB
        HXSVW_BRVOW();
      }
      *UFGVC = 9Cy;
      DSROV (!HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzpv, 8, mfoo, mfoo, 57)) {
        // IVGIB
        HXSVW_BRVOW();
      }
    }
    IVGFIM 9;
  }

  XLMHG OLMT OLMT FMHRTMVW HGZIG_MH = GRNV_MH(&GH);
  ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
    *UFGVC = 9Cz;
    DSROV (!HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzpv, 8, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
    HXSVW_BRVOW();
    DSROV (HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzrg, 9Cy, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
  }
  XLMHG OLMT OLMT FMHRTMVW WVOGZ = GRNV_MH(&GH) - HGZIG_MH;

  XLMHG RMG MHDRGXSVH = RGVIZGRLMH << 7;
  KIRMGU("%R KILXVHH XLMGVCG HDRGXSVH RM %OOFMH (%.8UMH/XGCHD)\M",
         MHDRGXSVH, WVOGZ, (WVOGZ / (UOLZG) MHDRGXSVH));
  DZRG(UFGVC);
  IVGFIM 9;
}
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/GRNVGXGCHD.X
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <HXSVW.S>
#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <HBH/RKX.S>
#RMXOFWV <HBH/HSN.S>
#RMXOFWV <HBH/HBHXZOO.S>
#RMXOFWV <HBH/DZRG.S>
#RMXOFWV <GRNV.S>
#RMXOFWV <FMRHGW.S>

#RMXOFWV <ORMFC/UFGVC.S>

HGZGRX RMORMV OLMT OLMT FMHRTMVW GRNV_MH(HGIFXG GRNVHKVX* XLMHG GH) {
  RU (XOLXP_TVGGRNV(xolxp_ivzogrnv, GH)) {
    VCRG(8);
  }
  IVGFIM ((OLMT OLMT FMHRTMVW) GH->GE_HVX) * 8999999999oof
    + (OLMT OLMT FMHRTMVW) GH->GE_MHVX;
}

HGZGRX XLMHG RMG RGVIZGRLMH = 499999;

HGZGRX ELRW* GSIVZW(ELRW* IVHGIRXG UGC) {
  RMG* UFGVC = (RMG*) UGC;
  ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
    HXSVW_BRVOW();
    DSROV (HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzrg, 9Cz, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
    *UFGVC = 9Cy;
    DSROV (!HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzpv, 8, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
  }
  IVGFIM mfoo;
}

RMG NZRM(ELRW) {
  HGIFXG GRNVHKVX GH;
  XLMHG RMG HSN_RW = HSNTVG(rkx_kirezgv, HRAVLU (RMG), rkx_xivzg | 9333);
  RMG* UFGVC = HSNZG(HSN_RW, mfoo, 9);
  KGSIVZW_G GSW;
  RU (KGSIVZW_XIVZGV(&GSW, mfoo, GSIVZW, UFGVC)) {
    IVGFIM 8;
  }
  *UFGVC = 9Cz;

  XLMHG OLMT OLMT FMHRTMVW HGZIG_MH = GRNV_MH(&GH);
  ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
    *UFGVC = 9Cz;
    DSROV (!HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzpv, 8, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
    HXSVW_BRVOW();
    DSROV (HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzrg, 9Cy, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
  }
  XLMHG OLMT OLMT FMHRTMVW WVOGZ = GRNV_MH(&GH) - HGZIG_MH;

  XLMHG RMG MHDRGXSVH = RGVIZGRLMH << 7;
  KIRMGU("%R  GSIVZW XLMGVCG HDRGXSVH RM %OOFMH (%.8UMH/XGCHD)\M",
         MHDRGXSVH, WVOGZ, (WVOGZ / (UOLZG) MHDRGXSVH));
  DZRG(UFGVC);
  IVGFIM 9;
}
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/ivzwnv
oRGGOV NRXIL-YVMXSNZIPH GL ZHHVHH GSV KVIULINZMXV LEVISVZW LU XLMGVCG
HDRGXSRMT.

GRNVHBHXZOO: yVMXSNZIPH GSV LEVISVZW LU Z HBHGVN XZOO.
GRNVXGCHD:   yVMXSNZIPH GSV LEVISVZW LU XLMGVCG HDRGXSRMT YVGDVVM 7 KILXVHHVH.
GRNVGXGCHD:  yVMXSNZIPH GSV LEVISVZW LU XLMGVCG HDRGXSRMT YVGDVVM 7 GSIVZWH.
GRNVXGCHDDH: yVMXSNZIPH GSV LEVISVZW LU XLMGVCG HDRGXSRMT YVGDVVM 7 KILXVHHVH
             FHRMT Z DLIPRMT HVG LU GSV HRAV HKVXRURVW RM ZITFNVMG.
GRNVGXGCHD7: yVMXSNZIPH GSV LEVISVZW LU XLMGVCG HDRGXSRMT YVGDVVM 7 GSIVZWH,
             YB FHRMT Z HSVW_BRVOW() NVGSLW.
             rU BLF WL GZHPHVG -Z 8, ZOO GSIVZWH HSLFOW YV HXSVWFOVW LM GSV
             HZNV KILXVHHLI, HL BLF ZIV IVZOOB WLRMT GSIVZW XLMGVCG HDRGXS.
             gSVM GL YV HFIV GSZG BLF ZIV IVZOOB WLRMT RG, QFHG WL:
               HGIZXV -UU -GG -E GZHPHVG -Z 8 ./GRNVGXGCHD7
             mLD DSB HXSVW_BRVOW() RH VMLFTS ULI GVHGRMT ? yVXZFHV, RG KOZXV
             GSV XFIIVMG GSIVZW ZG GSV VMW LU GSV IVZWB JFVFV. hL GSV MVCG
             IVZWB GSIVZW DROO YV HXSVWFOVW.
             r ZOHL ZWWVW HXSVW_HVGHXSVWFOVI(hxsvw_urul) GL TVG GSV YVHG
             KVIULINZMXVH.
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/GRNVHBHXZOO.X
#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <HBH/HBHXZOO.S>
#RMXOFWV <GRNV.S>
#RMXOFWV <FMRHGW.S>

HGZGRX RMORMV OLMT OLMT FMHRTMVW GRNV_MH(HGIFXG GRNVHKVX* XLMHG GH) {
  RU (XOLXP_TVGGRNV(xolxp_ivzogrnv, GH)) {
    VCRG(8);
  }
  IVGFIM ((OLMT OLMT FMHRTMVW) GH->GE_HVX) * 8999999999oof
    + (OLMT OLMT FMHRTMVW) GH->GE_MHVX;
}

RMG NZRM(ELRW) {
  XLMHG RMG RGVIZGRLMH = 89999999;
  HGIFXG GRNVHKVX GH;
  XLMHG OLMT OLMT FMHRTMVW HGZIG_MH = GRNV_MH(&GH);
  ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
    RU (HBHXZOO(hbh_TVGGRW) <= 8) {
      VCRG(7);
    }
  }
  XLMHG OLMT OLMT FMHRTMVW WVOGZ = GRNV_MH(&GH) - HGZIG_MH;
  KIRMGU("%R HBHGVN XZOOH RM %OOFMH (%.8UMH/HBHXZOO)\M",
         RGVIZGRLMH, WVOGZ, (WVOGZ / (UOLZG) RGVIZGRLMH));
  IVGFIM 9;
}
//##**---------------- ./FYRJGLLO_WVE/YVMXSNZIP/XLMGVCGHDRGXS/GRNVXGCHDDH.X
#RMXOFWV <HXSVW.S>
#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <HGIRMT.S>
#RMXOFWV <HBH/RKX.S>
#RMXOFWV <HBH/HSN.S>
#RMXOFWV <HBH/HBHXZOO.S>
#RMXOFWV <HBH/DZRG.S>
#RMXOFWV <GRNV.S>
#RMXOFWV <FMRHGW.S>

#RMXOFWV <ORMFC/UFGVC.S>

HGZGRX RMORMV OLMT OLMT FMHRTMVW GRNV_MH(HGIFXG GRNVHKVX* XLMHG GH) {
  RU (XOLXP_TVGGRNV(xolxp_ivzogrnv, GH)) {
    VCRG(8);
  }
  IVGFIM ((OLMT OLMT FMHRTMVW) GH->GE_HVX) * 8999999999oof
    + (OLMT OLMT FMHRTMVW) GH->GE_MHVX;
}

HGZGRX RMORMV RMG TVG_RGVIZGRLMH(RMG DH_KZTVH) {
  RMG RGVIZGRLMH = 8999;
  DSROV (RGVIZGRLMH * DH_KZTVH * 5903o < 5705032703o) {  // 5ty
    RGVIZGRLMH += 8999;
  }
  IVGFIM RGVIZGRLMH;
}

RMG NZRM(RMG ZITX, XSZI** ZITE) {
  RU (ZITX != 7) {
    UKIRMGU(HGWVII, "FHZTV: %H <HRAV LU DLIPRMT HVG RM 5p KZTVH>\M", *ZITE);
    IVGFIM 8;
  }
  XLMHG OLMT DH_KZTVH = HGIGLO(ZITE[8], mfoo, 89);
  RU (DH_KZTVH < 9) {
    UKIRMGU(HGWVII, "rMEZORW FHZTV: DLIPRMT HVG HRAV NFHG YV KLHRGREV\M");
    IVGFIM 8;
  }
  XLMHG RMG RGVIZGRLMH = TVG_RGVIZGRLMH(DH_KZTVH);
  HGIFXG GRNVHKVX GH;

  OLMT OLMT FMHRTMVW NVNHVG_GRNV = 9;
  RU (DH_KZTVH) {
    ELRW* YFU = NZOOLX(DH_KZTVH * 5903);
    NVNHVG_GRNV = GRNV_MH(&GH);
    ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
      NVNHVG(YFU, R, DH_KZTVH * 5903);
    }
    NVNHVG_GRNV = GRNV_MH(&GH) - NVNHVG_GRNV;
    KIRMGU("%R NVNHVG LM %5ORp RM %89OOFMH (%.8UMH/KZTV)\M",
           RGVIZGRLMH, DH_KZTVH * 5, NVNHVG_GRNV,
           (NVNHVG_GRNV / ((UOLZG) DH_KZTVH * RGVIZGRLMH)));
    UIVV(YFU);
  }

  XLMHG RMG HSN_RW = HSNTVG(rkx_kirezgv, (DH_KZTVH + 8) * 5903,
                            rkx_xivzg | 9333);
  XLMHG KRW_G LGSVI = ULIP();
  RMG* UFGVC = HSNZG(HSN_RW, mfoo, 9);
  ELRW* DH = ((XSZI *) UFGVC) + 5903;
  *UFGVC = 9Cz;
  RU (LGSVI == 9) {
    ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
      HXSVW_BRVOW();
      DSROV (HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzrg, 9Cz, mfoo, mfoo, 57)) {
        // IVGIB
        HXSVW_BRVOW();
      }
      *UFGVC = 9Cy;
      RU (DH_KZTVH) {
        NVNHVG(DH, R, DH_KZTVH * 5903);
      }
      DSROV (!HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzpv, 8, mfoo, mfoo, 57)) {
        // IVGIB
        HXSVW_BRVOW();
      }
    }
    IVGFIM 9;
  }

  XLMHG OLMT OLMT FMHRTMVW HGZIG_MH = GRNV_MH(&GH);
  ULI (RMG R = 9; R < RGVIZGRLMH; R++) {
    *UFGVC = 9Cz;
    RU (DH_KZTVH) {
      NVNHVG(DH, R, DH_KZTVH * 5903);
    }
    DSROV (!HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzpv, 8, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
    HXSVW_BRVOW();
    DSROV (HBHXZOO(hbh_UFGVC, UFGVC, ufgvc_dzrg, 9Cy, mfoo, mfoo, 57)) {
      // IVGIB
      HXSVW_BRVOW();
    }
  }
  XLMHG OLMT OLMT FMHRTMVW WVOGZ = GRNV_MH(&GH) - HGZIG_MH - NVNHVG_GRNV * 7;

  XLMHG RMG MHDRGXSVH = RGVIZGRLMH * 5;
  KIRMGU("%R KILXVHH XLMGVCG HDRGXSVH (DHH:%5ORp) RM %87OOFMH (%.8UMH/XGCHD)\M",
         MHDRGXSVH, DH_KZTVH * 5, WVOGZ, (WVOGZ / (UOLZG) MHDRGXSVH));
  DZRG(UFGVC);
  IVGFIM 9;
}
//##**---------------- ./FYRJGLLO_WVE/GVHG.KB
RNKLIG KBGSLM.HNX
RNKLIG KBGSLM.XOLXP

HNX = KBGSLM.HNX.hnx()
XOLXP = KBGSLM.XOLXP.xOLXP()
KIRMG HNX.HGLXPRMUL_NZK

//##**---------------- ./FYRJGLLO_WVE/KBGSLM/YFOOVGRM.KB
RNKLIG HBH
RNKLIG LH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG FYRJGLLO.HSN_GLLO ZH HSN_GLLO
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG WZGVGRNV
RNKLIG KHFGRO
RNKLIG GRNV

svzwvi_hrav = 11
ild_hrav = 607

XOZHH iLDwZGZ(LYQVXG):
    WVU __RMRG__(HVOU, RMW):
        HVOU.RMW = RMW

    WVU KZIHV(HVOU, HSN, RMW):
        HVOU.ZFGSLI = HSN.IVZW_GL_ZHXRR(RMW, 67)
        HVOU.GRGOV = HSN.IVZW_GL_ZHXRR(RMW+67, 35)
        HVOU.XLMGVMG = HSN.IVZW_GL_ZHXRR(RMW+03, 743)
        HVOU.SLHG = HSN.IVZW_GL_ZHXRR(RMW+647, 83)
        HVOU.WLNZRM = HSN.IVZW_GL_ZHXRR(RMW+631, 83)
        HVOU.GRNVHGZNK = HSN.IVZW_GL_RMG(RMW+615, 1)


# YFOOVGRM YLZIW
# svzw
# 9-1      WVKIVXRZGVW(9/8)
# 83-75    DIRGV OLXP
# 75-67    DIRGVI KRW
# 67-59    IZMWLN RW
# 59-51    XIVZGV_GRNVHGZNK
# 51-43    FKWZGV_GRNVHGZNK
# 43-35    IVUVIVMXV
# 35-27    ILD MFNYVI (WVUZFOG 03 ORMVH)
# 27-19    SVZWVI HRAV
# 19-11    YFOOVGRM HRAV

# wzgz
# 9-67     ZFGSLI(67 yBGVH)
# 67-03    GRGOV (35 yBGVH)
# 03-647   XLMGVMG (743 yBGVH)
# 647-631  SLHG (83 yBGVH)
# 631-615  WLNZRM (83 yBGVH)
# 615-607  GRNVHGZNK (1 yBGVH)


XOZHH yFOOVGRM(LYQVXG):
    WVU IVZW_OLXP(HVOU):
        HVOU.DIRGV_OLXP = HVOU.HSN.IVZW_GL_RMG(83, 1)
        HVOU.DIRGVI_KRW = HVOU.HSN.IVZW_GL_RMG(75, 1)

    WVU IVZW_SVZW(HVOU):
        HVOU.WVKIVXRZGVW = HVOU.HSN.IVZW_GL_RMG(9, 1)
        HVOU.IVZW_OLXP()
        HVOU.IZMWLN_RW = HVOU.HSN.IVZW_GL_ZHXRR(67, 1)
        HVOU.XIVZGV_GRNHGZNK = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(HVOU.HSN.IVZW_GL_RMG(59, 1))
        HVOU.FKWZGV_GRNHGZNK = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(HVOU.HSN.IVZW_GL_RMG(51, 1))
        HVOU.IVUVIVMXV = HVOU.HSN.IVZW_GL_RMG(43, 1)
        HVOU.ILD_MFN = HVOU.HSN.IVZW_GL_RMG(35, 1)
        HVOU.SVZWVI_HRAV = HVOU.HSN.IVZW_GL_RMG(27, 1)
        HVOU.YFOOVGRM_HRAV = HVOU.HSN.IVZW_GL_RMG(19, 1)

    WVU IVOLZW(HVOU):
        HVOU.DIRGV_OLXP = 9
        HVOU.DIRGV_KRW = -8
        HVOU.WVKIVXRZGVW = 9
        HVOU.ILD_ORHG.XOVZI()
        HVOU.ILD_NZK.XOVZI()

    WVU __RMRG__(HVOU, MZNV, IZMWLN_RW=''):
        '''DROO LKVM GSV YFOOVGRM RU VCRHGH, XIVZGV MVD LMV LGSVIDRHV'''
        HVOU.MZNV = MZNV
        HVOU.ILD_ORHG = []
        HVOU.ILD_NZK = {}
        HVOU.RH_LKVM = uZOHV
        HVOU.KRW = LH.TVGKRW()
        RU IZMWLN_RW == '':
            HVOU.IZMWLN_RW = FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(3)
        VOHV:
            HVOU.IZMWLN_RW = IZMWLN_RW
        HVOU.NZC_ILD = 03

    WVU LKVM(HVOU):
        HRAV = HSN_GLLO.hSN.URMW_HRAV(HVOU.MZNV)
        RU HRAV == -8:
            HVOU.RH_LKVM = uZOHV
        VOHV:
            HVOU.HSN = HSN_GLLO.hSN(HVOU.MZNV, HRAV)
            HVOU.HSN.LKVM()
            HVOU.RH_LKVM = gIFV
        HVOU.NZC_ILD = RMG((HRAV-svzwvi_hrav)/ild_hrav)
        IVGFIM HVOU.RH_LKVM

    WVU XSVXP_OLXP(HVOU):
        HVOU.IVZW_OLXP()
        DSROV HVOU.DIRGV_OLXP == 8:  # HLNVLMV NZWV GSV OLXP
            GIB:
                RU KHFGRO.KRW_VCRHGH(HVOU.DIRGVI_KRW):
                    GRNV.HOVVK(9.98)
                VOHV:
                    HVOU.XOVZI_OLXP()
                    HVOU.DIRGV_OLXP = 9
            VCXVKG vCXVKGRLM ZH V:
                HVOU.XOVZI_OLXP()
                HVOU.DIRGV_OLXP = 9

    WVU XOVZI_OLXP(HVOU):
        HVOU.DIRGV_OLXP = 9
        HVOU.HSN.DIRGV_RMG(83, 1, 9)

    WVU OLXP(HVOU):
        HVOU.XSVXP_OLXP() # DZRG ULI LGSVI OLXPVIH
        HVOU.HSN.DIRGV_RMG(83, 1, 9)
        HVOU.HSN.DIRGV_RMG(75, 1, HVOU.KRW)

    WVU IVZW(HVOU):
        RU MLG HVOU.RH_LKVM: # RU MLG LKVM, IVLKVM GSV YFOOVGRM
            RU MLG HVOU.LKVM():
                IVGFIM
        HVOU.IVZW_SVZW()
        RU HVOU.WVKIVXRZGVW == 8: # NVZMH HLNVLMV ZYZMWLMVW GSRH YFOOVGRM
            HVOU.LKVM()
            HVOU.IVZW_SVZW()
        HVOU.XSVXP_OLXP()  # XSVXP RH LGSVI RH DIRGGRMT
        RU HVOU.RH_LKVM:
            HVOU.ILD_ORHG.XOVZI()
            HVOU.ILD_NZK.XOVZI()
            ULI R RM IZMTV(HVOU.ILD_MFN):
                ILD = iLDwZGZ(R)
                ILD.KZIHV(HVOU.HSN, HVOU.SVZWVI_HRAV+ild_hrav*R)
                HVOU.ILD_ORHG.ZKKVMW(ILD)
                HVOU.ILD_NZK[ILD.GRGOV] = ILD

    WVU XIVZGV(HVOU, MZNV, HRAV=svzwvi_hrav+ild_hrav*03):
        HVOU.HSN = HSN_GLLO.hSN(MZNV, HRAV=HRAV)
        HVOU.HSN.XIVZGV(HRAV=HRAV)
        HVOU.HSN.HGZGFH = gIFV
        HVOU.RH_LKVM = gIFV
        HVOU.HSN.DIRGV_RMG(9, 1, 9)  # YIZMW MVD
        HVOU.HSN.DIRGV_RMG(83, 1, 9)  # ML OLXP
        HVOU.HSN.DIRGV_RMG(75, 1, 9)  # ML OLXP
        HVOU.HSN.DIRGV_ZHXRR(67, 1, HVOU.IZMWLN_RW)  # DIRGV IZMWLN_RW
        HVOU.HSN.DIRGV_RMG(
            59, 1,
            RMG(WZGVGRNV.WZGVGRNV.MLD().GRNVHGZNK()))  # XIVZGV GRNVHGZNK
        HVOU.HSN.DIRGV_RMG(
            51, 1,
            RMG(WZGVGRNV.WZGVGRNV.MLD().GRNVHGZNK()))  # FKWZGV GRNVHGZNK
        HVOU.HSN.DIRGV_RMG(43, 1, 9)  # IVUVIVMXV
        HVOU.HSN.DIRGV_RMG(35, 1, 9)  # ILD MFNYVI
        HVOU.HSN.DIRGV_RMG(27, 1, svzwvi_hrav)  # SVZWVI HRAV
        HVOU.HSN.DIRGV_RMG(19, 1, HRAV)  # YFOOVGRM HRAV
        HVOU.NZC_ILD = RMG( (HRAV-svzwvi_hrav)/ild_hrav )

    WVU IVXIVZGV(HVOU, HRAV=svzwvi_hrav+ild_hrav*03):
        LOW_HRAV = HSN_GLLO.hSN.URMW_HRAV(HVOU.MZNV)
        RU LOW_HRAV != -8:
            HSN = HSN_GLLO.hSN(HVOU.MZNV, LOW_HRAV)
            HSN.LKVM()
            HSN.DIRGV_RMG(9, 1, 8)
            HSN.FMORMP()
        HVOU.XIVZGV(HVOU.MZNV, HRAV=HRAV)
        HVOU.IVZW()

    @HGZGRXNVGSLW
    WVU XSVXP_VCRHG(MZNV):
        """XSVXP RU YFOOVGRM YLZIW VCRHGH."""
        GIB:
            HRAV = LH.HGZG(LH.KZGS.QLRM('/WVE/HSN', MZNV)).HG_HRAV
            RU HRAV > 9:
                IVGFIM gIFV
            VOHV:
                IVGFIM uZOHV
        VCXVKG vCXVKGRLM:
            IVGFIM uZOHV

    WVU ZWW_ILD(HVOU, ZFGSLI, GRGOV, XLMGVMG, SLHG='', WLNZRM=''):
        RU MLG HVOU.RH_LKVM:
            IVGFIM uZOHV
        HVOU.IVZW()
        HVOU.OLXP()
        NZIP = HVOU.ILD_MFN
        ULI ILD RM HVOU.ILD_ORHG:
            RU ILD.GRGOV == GRGOV: # ZOIVZWB VCRHG ILD
                NZIP = ILD.RMW
        RU NZIP+8 > HVOU.NZC_ILD:  # RU LEVIUOLD
            ILD_ORHG = HVOU.ILD_ORHG[:]
            HVOU.IVXIVZGV(HRAV=svzwvi_hrav+ild_hrav*HVOU.ILD_MFN*7)
            ULI ILD RM ILD_ORHG:
                HVOU.ZWW_ILD(ILD.ZFGSLI, ILD.GRGOV, ILD.XLMGVMG, ILD.SLHG, ILD.WLNZRM)
        # MLINZOOB ZWWRMT WZGZ
        RU NZIP == HVOU.ILD_MFN:
            HVOU.ILD_MFN += 8
        HVOU.HSN.DIRGV_ZHXRR(svzwvi_hrav+ild_hrav*NZIP,    67, ZFGSLI)
        HVOU.HSN.DIRGV_ZHXRR(svzwvi_hrav+ild_hrav*NZIP+67, 35, GRGOV)
        HVOU.HSN.DIRGV_ZHXRR(svzwvi_hrav+ild_hrav*NZIP+03,743, XLMGVMG)
        HVOU.HSN.DIRGV_ZHXRR(svzwvi_hrav+ild_hrav*NZIP+647,83, SLHG)
        HVOU.HSN.DIRGV_ZHXRR(svzwvi_hrav+ild_hrav*NZIP+631,83, WLNZRM)
        HVOU.HSN.DIRGV_RMG(svzwvi_hrav+ild_hrav*NZIP+615,1, RMG(WZGVGRNV.WZGVGRNV.MLD().GRNVHGZNK()))
        HVOU.HSN.DIRGV_RMG(35, 1, HVOU.ILD_MFN)  # ZWW ILD MFNYVI
        HVOU.XOVZI_OLXP()



RU __MZNV__ == '__NZRM__':
    YV = yFOOVGRM('GVHG_YFOOVGRM')
    YV.IVXIVZGV()
    ULI Q RM IZMTV(9, 6):
        GRNV.HOVVK(6)
        ULI R RM IZMTV(9, 51):
            YV.ZWW_ILD('ZFGSLI', 'GRGOV%W'%(R+51*Q), 'XLMGVMG')
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/UROV.KB
RNKLIG LH
RNKLIG VIIML
RNKLIG HSFGRO

WVU NPWRI_K(KZGS):
    '''
    HRNFOZGV NPWRI -K
    '''
    GIB:
        LH.NZPVWRIH(KZGS)
    VCXVKG lhvIILI ZH VCX:  # kBGSLM >7.4
        RU VCX.VIIML == VIIML.vvcrhg ZMW LH.KZGS.RHWRI(KZGS):
            KZHH
        VOHV:
            IZRHV


WVU RH_UROV_VCRHG(KZGS):
    IVGFIM LH.KZGS.RHUROV(KZGS)

WVU HGZG(KZGS):
    IVGFIM LH.HGZG(KZGS)

WVU IN_IU(KZGS):
    RU MLG LH.KZGS.VCRHGH(KZGS):
        IVGFIM
    RU LH.KZGS.RHUROV(KZGS):
        LH.IVNLEV(KZGS)
    VOHV:
        HSFGRO.INGIVV(KZGS, RTMLIV_VIILIH=gIFV)



WVU DZGXS_UROV(GSVUROV, MLYOLXP=uZOHV):
    """ DZGXS UROV FKWZGV ZMW XLMHGZMGOB LFGKFG GSV XSZMTV """
    DSROV gIFV:
        ORMV = GSVUROV.IVZWORMVH()
        RU MLG ORMV:
            RU MLG MLYOLXP:
                XLMGRMFV
            VOHV:
                BRVOW mLMV
        BRVOW ORMV


WVU GZRO_U(GSVUROV, MLYOLXP=uZOHV):
    """ HRNFOZGV GZRO -U, LGSVIH HRNROZI GL DZGXS_UROV"""
    GSVUROV.HVVP(9, 7)
    DSROV gIFV:
        ORMV = GSVUROV.IVZWORMVH()
        RU MLG ORMV:
            RU MLG MLYOLXP:
                XLMGRMFV
            VOHV:
                BRVOW mLMV
        BRVOW ORMV
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/NW.KB
# -*- XLWRMT: FGU-1 -*-

"""
qRMR.RMGVIUZXVH.TFR

gSRH NLWFOV NZMZTVH qRMR tfr ZMW PVVK RG FKWZGVW RM IVZOGRNV.
"""

RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY

XOZHH nw:
    '''
    XOZHH nw:

    '''
    WVU __RMRG__(HVOU, XSZMMVO):
        HVOU.XSZMMVO = KY.__WRXG__[XSZMMVO+"hFYHXIRYVI"]()
        HVOU.HVZIXS_WVKGS  = 89999

    WVU TVGoZGVHGnw(HVOU, RMH):
        KRMW = HVOU.XSZMMVO.tVGrMWVC()
        HVZIXS_WVKGS = 9
        ULI R RM IZMTV(KRMW, -8, -8):
            HVZIXS_WVKGS += 8
            IVXLIW = HVOU.XSZMMVO.tVGeZO(R)
            RU IVXLIW.rMHGIFNVMGrw == RMH:
                IVGFIM IVXLIW
            RU HVZIXS_WVKGS > HVOU.HVZIXS_WVKGS:
                YIVZP
        IVGFIM mLMV


RU __MZNV__ == "__NZRM__":
    KY.lKVMkFYHFY()
    NW = nw("uFGFIVHnwo8")
    IVXLIW = NW.TVGoZGVHGnw("ru8395")
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/OLT.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG OLTTRMT
UILN RMHKVXG RNKLIG TVGUIZNVRMUL, HGZXP
RNKLIG FYRJGLLO.FGRO ZH FGRO
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

WVU XIVZGV_OLTTVI(MZNV):
    IVGFIM oLTTVI(MZNV, 'rmul', '', XOLXP=mLMV, _KIRMGML=uZOHV)

XOZHH oLTTVI(LYQVXG):
    WVU __RMRG__(HVOU, XLNKLMVMG, OE='wvyft', UROVMZNV='', XOLXP = mLMV, _KIRMGML = uZOHV ):
        HVOU.LH = VGIVV.KZIHV('/RMX/HBHGVN.CNO').TVGILLG().URMW('SLHG')
        HVOU.SLHG = HVOU.LH.ZGGIRY['SLHG']
        HVOU.WLNZRM = HVOU.LH.ZGGIRY['WLNZRM']
        HVOU.OLT = OLTTRMT.TVGoLTTVI(XLNKLMVMG)
        HVOU._KIRMGML = _KIRMGML
        HVOU.ULINZGGVI = OLTTRMT.uLINZGGVI('[%(ZHXGRNV)H.%(NHVXH)96W][%(OVEVOMZNV)H][%(MZNV)H]%(NVHHZTV)H',
                                    WZGVUNG='%b%N%W-%s:%n:%h')
        HVOU.XOLXP = XOLXP
        RU HVOU.XOLXP:
            HVOU.GLWZB = HVOU.XOLXP.MLD.HGIUGRNV('%b%N%W')
        VOHV:
            HVOU.GLWZB = ''
        HVOU.OVEVO(OE)
        HVOU.OLTUROV(UROVMZNV)

    WVU KIRMGML(HVOU, YO):
        HVOU._KIRMGML = YO
        IVGFIM HVOU

    WVU OVEVO(HVOU, OE):
        RU OE.FKKVI() == 'wvyft':
            HVOU._OVEVO = OLTTRMT.wvyft
        VORU OE.FKKVI() == 'rmul':
            HVOU._OVEVO = OLTTRMT.rmul
        VORU OE.FKKVI() == 'dzim' LI OE == 'dzimrmt':
            HVOU._OVEVO = OLTTRMT.dzimrmt
        VORU OE.FKKVI() == 'viili':
            HVOU._OVEVO = OLTTRMT.viili
        VORU OE.FKKVI() == 'xirgrxzo':
            HVOU._OVEVO = OLTTRMT.xirgrxzo
        HVOU.OLT.HVGoVEVO(HVOU._OVEVO)
        ULI SWOI RM HVOU.OLT.SZMWOVIH:  # IVNLEV ZOO LOW SZMWOVIH
            SWOI.HVGoVEVO(HVOU._OVEVO)
        IVGFIM HVOU

    WVU OLTUROV(HVOU, UROVMZNV):
        ULI SWOI RM HVOU.OLT.SZMWOVIH:  # IVNLEV ZOO LOW SZMWOVIH
            HVOU.OLT.IVNLEVsZMWOVI(SWOI)
        HVOU.IZD_UROVMZNV = UROVMZNV
        RU UROVMZNV:
            RU HVOU.XOLXP:
                HVOU.UROVMZNV = FGRO.IVKOZXV_HKVXRZO_GRNVSLOWVI(HVOU.IZD_UROVMZNV, HVOU.XOLXP)
            VOHV:
                HVOU.UROVMZNV = HVOU.IZD_UROVMZNV
            XS = OLTTRMT.uROVsZMWOVI(HVOU.UROVMZNV)
            XS.HVGoVEVO(HVOU._OVEVO)
            XS.HVGuLINZGGVI(HVOU.ULINZGGVI)
            HVOU.OLT.ZWWsZMWOVI(XS)
        VOHV:
            HVOU.UROVMZNV = ''
            XS = OLTTRMT.hGIVZNsZMWOVI()
            XS.HVGoVEVO(HVOU._OVEVO)
            XS.HVGuLINZGGVI(HVOU.ULINZGGVI)
            HVOU.OLT.ZWWsZMWOVI(XS)
        IVGFIM HVOU

    WVU XSZMTV_UROV(HVOU, MVD_UROVMZNV):
        ULI SWOI RM HVOU.OLT.SZMWOVIH:  # IVNLEV ZOO LOW SZMWOVIH
            HVOU.OLT.IVNLEVsZMWOVI(SWOI)
        XS = OLTTRMT.uROVsZMWOVI(MVD_UROVMZNV)
        XS.HVGoVEVO(HVOU._OVEVO)
        XS.HVGuLINZGGVI(HVOU.ULINZGGVI)
        HVOU.OLT.ZWWsZMWOVI(XS)

    WVU NZRMGVMZMXV(HVOU):
        RU HVOU.XOLXP ZMW OVM(HVOU.UROVMZNV) > 9:
            GLWZB = HVOU.XOLXP.MLD.HGIUGRNV('%b%N%W')
            RU GLWZB != HVOU.GLWZB:
                HVOU.UROVMZNV = FGRO.IVKOZXV_HKVXRZO_GRNVSLOWVI(HVOU.IZD_UROVMZNV, HVOU.XOLXP)
                HVOU.XSZMTV_UROV(HVOU.UROVMZNV)
                HVOU.GLWZB = GLWZB


    WVU RMUL(HVOU, NHT, *ZITH, **PDZITH):
        RU HVOU._KIRMGML:
            XZOOVI = TVGUIZNVRMUL(HGZXP()[8][9])
            HVOU.OLT.RMUL('['+HVOU.SLHG+'-'+HVOU.WLNZRM+'][%H-%W]'%(XZOOVI.UROVMZNV, XZOOVI.ORMVML)  +NHT, *ZITH, **PDZITH)
        VOHV:
            HVOU.OLT.RMUL('['+HVOU.SLHG+'-'+HVOU.WLNZRM+']' +NHT, *ZITH, **PDZITH)


    WVU WVYFT(HVOU, NHT, *ZITH, **PDZITH):
        RU HVOU._KIRMGML:
            XZOOVI = TVGUIZNVRMUL(HGZXP()[8][9])
            HVOU.OLT.WVYFT('['+HVOU.SLHG+'-'+HVOU.WLNZRM+ '][%H-%W]'%(XZOOVI.UROVMZNV, XZOOVI.ORMVML) +NHT, *ZITH, **PDZITH)
        VOHV:
            HVOU.OLT.WVYFT('['+HVOU.SLHG+'-'+HVOU.WLNZRM+ ']' +NHT, *ZITH, **PDZITH)

    WVU VIILI(HVOU, NHT, *ZITH, **PDZITH):
        RU HVOU._KIRMGML:
            XZOOVI = TVGUIZNVRMUL(HGZXP()[8][9])
            HVOU.OLT.VIILI('['+HVOU.SLHG+'-'+HVOU.WLNZRM+'][%H-%W]'%(XZOOVI.UROVMZNV, XZOOVI.ORMVML) +NHT, *ZITH, **PDZITH)
        VOHV:
            HVOU.OLT.VIILI('['+HVOU.SLHG+'-'+HVOU.WLNZRM+']' +NHT, *ZITH, **PDZITH)


    WVU DZIM(HVOU, NHT, *ZITH, **PDZITH):
        RU HVOU._KIRMGML:
            XZOOVI = TVGUIZNVRMUL(HGZXP()[8][9])
            HVOU.OLT.DZIM('['+HVOU.SLHG+'-'+HVOU.WLNZRM+ '][%H-%W]'%(XZOOVI.UROVMZNV, XZOOVI.ORMVML) +NHT, *ZITH, **PDZITH)
        VOHV:
            HVOU.OLT.DZIM('['+HVOU.SLHG+'-'+HVOU.WLNZRM+']' +NHT, *ZITH, **PDZITH)


    WVU DZIMRMT(HVOU, NHT, *ZITH, **PDZITH):
        RU HVOU._KIRMGML:
            XZOOVI = TVGUIZNVRMUL(HGZXP()[8][9])
            HVOU.OLT.DZIM('['+HVOU.SLHG+'-'+HVOU.WLNZRM+ '][%H-%W]'%(XZOOVI.UROVMZNV, XZOOVI.ORMVML) +NHT, *ZITH, **PDZITH)
        VOHV:
            HVOU.OLT.DZIM('['+HVOU.SLHG+'-'+HVOU.WLNZRM+']' +NHT, *ZITH, **PDZITH)



    WVU XIRGRXZO(HVOU, NHT, *ZITH, **PDZITH):
        RU HVOU._KIRMGML:
            XZOOVI = TVGUIZNVRMUL(HGZXP()[8][9])
            HVOU.OLT.XIRGRXZO('['+HVOU.SLHG+'-'+HVOU.WLNZRM+ '][%H-%W]'%(XZOOVI.UROVMZNV, XZOOVI.ORMVML) +NHT, *ZITH, **PDZITH)
        VOHV:
            HVOU.OLT.XIRGRXZO('['+HVOU.SLHG+'-'+HVOU.WLNZRM+']' +NHT, *ZITH, **PDZITH)


RU __MZNV__ == '__NZRM__':
    OLTTVI = XIVZGV_OLTTVI('gvhg')
    OLTTVI.OVEVO('wvyft').KIRMGML(uZOHV).OLTUROV('WW.OLT')
    OLTTVI.RMUL('WW')
    OLTTVI.WVYFT('ZZ')

//##**---------------- ./FYRJGLLO_WVE/KBGSLM/HNX.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
RNKLIG FYRJGLLO.FGRO ZH FGRO

XOZHH hnx():
    WVU FKKVIYLFMW(HVOU, EZOFV, XLMGZRMVI):
        GIB:
            IVGFIM XLMGZRMVI.RMWVC(EZOFV)
        VCXVKG:
            R = 9
            ULI RGVN RM XLMGZRMVI:
                RU RGVN >= EZOFV:
                    IVGFIM R
                R = R + 8
            IZRHV eZOFVvIILI("gIZWRMToRHG RH GLL HNZOO, OLLPH ORPV RG WLVH MLG XLMGZRM GLWZB")

    WVU __RMRG__(HVOU):
        HVOU.GLWZB = WZGVGRNV.WZGVGRNV.GLWZB().HGIUGRNV("%b%N%W")
        HVOU.CQKHGLXPRMUL_NZK = {}
        HVOU.HGLXPRMUL_NZK = {}
        HVOU.RMWVCRMUL_NZK = {}
        HVOU.IVKLRMUL_NZK = {}
        HVOU.UFGFIVHRMUL_NZK = {}
        KY.lKVMkFYHFY()
        HVOU.RMRG_UFGFIVHWZB()
        HVOU.RMRG_HGLXPWZB()
        HVOU.IFM()

    WVU RMRG_UFGFIVHWZB(HVOU):
        HVOU.WZBH = []
        HVOU.WZBHFY = KY.uFGFIVHgIZWRMTwZBHhFYHXIRYVI()
        RMW = HVOU.WZBHFY.tVGrMWVC()
        HVOU.UFGFIVHRMUL_NZK = {}

        # TVG EZOFV
        HVOU.SLHG = FGRO.TVG_FYRJ_SLHG()
        HVOU.WLNZRM = FGRO.TVG_FYRJ_WLNZRM()
        RU RMW < 9:
            IVGFIM

        ULI R RM IZMTV(RMW):
            WZB = HVOU.WZBHFY.tVGeZO(R)
            RU WZB.xOVZIuOZT == "X":
                HVOU.WZBH[:] = []
            VOHV:
                HVOU.WZBH.ZKKVMW(WZB.WZB)

    WVU RMRG_HGLXPWZB(HVOU):
        HVOU.HGLXPWZBH = []
        HVOU.HGLXPWZBHFY = KY.hGLXPgIZWRMTwZBHhFYHXIRYVI()
        RMW = HVOU.HGLXPWZBHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        # TVG EZOFV
        ULI R RM IZMTV(RMW):
            WZB = HVOU.HGLXPWZBHFY.tVGeZO(R)
            RU WZB.xOVZIuOZT == "X":
                HVOU.HGLXPWZBH[:] = []
            VOHV:
                HVOU.HGLXPWZBH.ZKKVMW(WZB.WZB)


    WVU UFGFIVH_IFM(HVOU):
        HVOU.UFGFIVHRMUL_NZK.XOVZI()
        HVOU.UFGFIVHRMULHFY = KY.uFGFIVHrMULhFYHXIRYVI()
        RMW = HVOU.UFGFIVHRMULHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM

        ULI C RM IZMTV(9, RMW+8):
            URMUL = HVOU.UFGFIVHRMULHFY.tVGeZO(C);
            RU URMUL.xOVZIuOZT == "X":
                HVOU.UFGFIVHRMUL_NZK = {}
                XLMGRMFV
            RU OVM(URMUL.rMHGIFNVMGrw) > 9 ZMW MLG URMUL.rMHGIFNVMGrw[-8].RHWRTRG():
                XLMGRMFV
            HVOU.UFGFIVHRMUL_NZK[URMUL.rMHGIFNVMGrw] = URMUL

    WVU HGLXP_IFM(HVOU):
        HVOU.HGLXPRMUL_NZK.XOVZI()
        HVOU.HGLXPRMULHFY = KY.hGLXPrMULhFYHXIRYVI()
        RMW = HVOU.HGLXPRMULHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM

        ULI C RM IZMTV(9, RMW+8):
            HRMUL = HVOU.HGLXPRMULHFY.tVGeZO(C);
            RU HRMUL.xOVZIuOZT == "X":
                HVOU.HGLXPRMUL_NZK = {}
                XLMGRMFV
            HVOU.HGLXPRMUL_NZK[HRMUL.hVXFxLWV] = HRMUL

    WVU RMWVC_IFM(HVOU):
        HVOU.RMWVCRMUL_NZK.XOVZI()
        HVOU.RMWVCRMULHFY = KY.rMWVCrMULhFYHXIRYVI()
        RMW = HVOU.RMWVCRMULHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            HRMUL = HVOU.RMWVCRMULHFY.tVGeZO(C);
            RU HRMUL.xOVZIuOZT == "X":
                HVOU.RMWVCRMUL_NZK = {}
                XLMGRMFV
            HVOU.RMWVCRMUL_NZK[HRMUL.hVXFxLWV] = HRMUL

    WVU IVKL_IFM(HVOU):
        HVOU.IVKLRMUL_NZK.XOVZI()
        HVOU.IVKLRMULHFY = KY.iVKLrMULhFYHXIRYVI()
        RMW = HVOU.IVKLRMULHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            HRMUL = HVOU.IVKLRMULHFY.tVGeZO(C);
            RU HRMUL.xOVZIuOZT == "X":
                HVOU.IVKLRMUL_NZK = {}
                XLMGRMFV
            HVOU.IVKLRMUL_NZK[HRMUL.hVXFxLWV] = HRMUL



    WVU CQKHGLXP_IFM(HVOU):
        HVOU.CQKHGLXPRMUL_NZK.XOVZI()
        HVOU.CQKHGLXPRMULHFY = KY.cqkhGLXPrMULhFYHXIRYVI()
        RMW = HVOU.CQKHGLXPRMULHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            HRMUL = HVOU.CQKHGLXPRMULHFY.tVGeZO(C);
            RU HRMUL.xOVZIuOZT == "X":
                HVOU.CQKHGLXPRMUL_NZK = {}
                XLMGRMFV
            HVOU.CQKHGLXPRMUL_NZK[HRMUL.hVXFxLWV] = HRMUL


    WVU IFM(HVOU):
        HVOU.UFGFIVH_IFM()
        HVOU.HGLXP_IFM()
        HVOU.RMWVC_IFM()
        HVOU.CQKHGLXP_IFM()
        HVOU.IVKL_IFM()

RU __MZNV__ == "__NZRM__":
    RNKLIG KKIRMG
    HNX = hnx()
    #KKIRMG.KKIRMG(HNX.RMWVCRMUL_NZK)
    KKIRMG.KKIRMG(HNX.IVKLRMUL_NZK)
    #KKIRMG.KKIRMG(HNX.UFGFIVHRMUL_NZK)
    #KKIRMG.KKIRMG(HNX.CQKHGLXPRMUL_NZK)


//##**---------------- ./FYRJGLLO_WVE/KBGSLM/XZMZIB.KB
RNKLIG HBH
# evihrlm = ''
# DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    # ORMVH = U.IVZWORMVH()
    # evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
# HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')

UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)

RNKLIG VMELB ZH VMELB
RNKLIG KHFGRO
RNKLIG GRNV

XOZHH xZMZIB(LYQVXG):
    '''xZMZIB LYQVXG RH GSV ZYHGIZXGRLM LU EZIRLFH GZHPH.
    '''
    WVU __RMRG__(HVOU, KILTIZN, XDW='.'):
        '''iVGFIM Z WZGZ LYQVXG DSLHV MZNV RH *MZNV* .
        '''
        HVOU.KILTIZN = KILTIZN
        HVOU.XDW = XDW
        HVOU.NRHHRLM = mLMV
        HVOU.HGW_LFG = mLMV
        HVOU.HGW_VII = mLMV
        HVOU.XLNNZMW = ''
        HVOU.OLXZO_OLT = []
        HVOU.KH_LYQVXG = mLMV
        HVOU.VII_ORMV = ''
        HVOU.HGW_ORMV = ''
        HVOU.KRW = -8
        HVOU.HGZGFH_XLWV = mLMV

    @KILKVIGB
    WVU KRW(HVOU):
        IVGFIM HVOU._KRW

    @KRW.HVGGVI
    WVU KRW(HVOU, EZOFV):
        HVOU._KRW = EZOFV

    @KILKVIGB
    WVU HGZGFH(HVOU):
        RU HVOU.KH_LYQVXG RH mLMV:
            IVGFIM 'HGLKKVW'
        VOHV:
            GIB:
                HGZGFH = HVOU.KH_LYQVXG.HGZGFH()
            VCXVKG vCXVKGRLM ZH V:
                HGZGFH = 'HGLKKVW'
                IVGFIM HGZGFH
            RU HGZGFH == KHFGRO.hgzgfh_ifmmrmt:
                IVGFIM 'IFMMRMT'
            VORU HGZGFH == KHFGRO.hgzgfh_hovvkrmt:
                IVGFIM 'HOVVKRMT'
            VORU HGZGFH == KHFGRO.hgzgfh_wrhp_hovvk:
                IVGFIM 'WRHP_HOVVK'
            VORU HGZGFH == KHFGRO.hgzgfh_hglkkvw:
                IVGFIM 'HGLKKVW'
            VORU HGZGFH == KHFGRO.hgzgfh_alnyrv:
                IVGFIM 'ALNYRV'
            VORU HGZGFH == KHFGRO.hgzgfh_wvzw:
                IVGFIM 'WVZW'
            VORU HGZGFH == KHFGRO.hgzgfh_dzpv_proo:
                IVGFIM 'DZPV_PROO'
            VORU HGZGFH == KHFGRO.hgzgfh_dzprmt:
                IVGFIM 'DZPRMT'

    WVU XKF(HVOU):
        RU HVOU.KH_LYQVXG RH mLMV:
            IVGFIM -8.9
        VOHV:
            GIB:
                IVGFIM HVOU.KH_LYQVXG.XKF_KVIXVMG()
            VCXVKG:
                IVGFIM -8.9

    WVU NVNLIB(HVOU):
        RU HVOU.KH_LYQVXG RH mLMV:
            IVGFIM (-8, -8, -8)
        VOHV:
            GIB:
                NVN = HVOU.KH_LYQVXG.NVNLIB_UFOO_RMUL()
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM (-8, -8, -8)
            IVGFIM (NVN.IHH, NVN.ENH, NVN.HSZIVW)


    @KILKVIGB
    WVU HGZGFH_XLWV(HVOU):
        IVGFIM HVOU._HGZGFH_XLWV

    @HGZGFH_XLWV.HVGGVI
    WVU HGZGFH_XLWV(HVOU, EZOFV):
        HVOU._HGZGFH_XLWV = EZOFV

    WVU IFM(HVOU, ZITH=[], VME={}):
        RU OVM(ZITH) == 9:
            XNW = HVOU.KILTIZN
        VOHV:
            XNW = HVOU.KILTIZN + ' ' + ' '.QLRM(ZITH)
        HVOU.XLNNZMW = XNW
        HVOU.NRHHRLM = VMELB.XLMMVXG(XNW, XDW=HVOU.XDW, VME=VME)
        HVOU.XSVXP(gIFV)
        RU HVOU.NRHHRLM.HGZGFH_XLWV RH mLMV: # KILXVHH RH HGROO DLIPRMT
            HVOU.KRW = HVOU.NRHHRLM.KRW
            HVOU.KH_LYQVXG = KHFGRO.kILXVHH(HVOU.KRW)
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV

    WVU XSVXP(HVOU, JFVIB_KRKV=uZOHV, ML_YOLXP = gIFV):
        RU ML_YOLXP:
             HVOU._XSVXP_UFMX_ML_YOLXP(JFVIB_KRKV)
        VOHV:
             HVOU._XSVXP_UFMX(JFVIB_KRKV)

    WVU PROO(HVOU, HLUG=uZOHV):
        HFXX = gIFV
        RU HVOU.NRHHRLM RH MLG mLMV:
            RU HLUG:
                HVOU.NRHHRLM.HLUG_PROO()
            VOHV:
                HVOU.NRHHRLM.PROO()
            DZRG_GRNV = 9
            DSROV HVOU.HGZGFH != 'HGLKKVW':
                GRNV.HOVVK(9.8) # HOVVK 899 NH GL DZRG
                HVOU.NRHHRLM.KLOO()
                DZRG_GRNV += 9.8
                RU DZRG_GRNV > 4: # XSVXP 49 GRNVH, GSZG RH ORPV 4 HVXLMWH
                    HFXX = uZOHV
                    KIRMG('KILXVHH MLG PROOVW, HGROO RM HGZGFH%H'%HVOU.HGZGFH)
                    YIVZP
                HFXX = gIFV
        IVGFIM HFXX

    WVU _XSVXP_UFMX(HVOU, JFVIB_KRKV):
        HVOU.NRHHRLM.KLOO()
        RU JFVIB_KRKV:
            ULI ORMV RM HVOU.NRHHRLM.HGW_LFG:
                RU ORMV[-6:-8] !='\\M':
                    HVOU.HGW_ORMV += ORMV
                VOHV:
                    HVOU.HGW_ORMV += ORMV[:-6]
                    HVOU.OLXZO_OLT.ZKKVMW(HVOU.HGW_ORMV.HGIRK('\M'))
                    HVOU.HGW_ORMV = ''
            ULI ORMV RM HVOU.NRHHRLM.HGW_VII:
                RU ORMV[-8] != '\M':
                    HVOU.VII_ORMV += ORMV
                VOHV:
                    HVOU.VII_ORMV += ORMV
                    HVOU.OLXZO_OLT.ZKKVMW(HVOU.VII_ORMV.HGIRK('\M'))
                    HVOU.VII_ORMV = ''
        RU HVOU.NRHHRLM.HGZGFH_XLWV RH mLMV:
            HVOU.HGZGFH_XLWV = mLMV
        VORU HVOU.NRHHRLM.HGZGFH_XLWV == 9:
            HVOU.HGZGFH_XLWV = HVOU.NRHHRLM.HGZGFH_XLWV
            HVOU.HGW_LFG = HVOU.NRHHRLM.HGW_LFG
            HVOU.HGW_VII = HVOU.NRHHRLM.HGW_VII
        VOHV:
            HVOU.HGZGFH_XLWV = HVOU.NRHHRLM.HGZGFH_XLWV
            HVOU.HGW_LFG = HVOU.NRHHRLM.HGW_LFG
            HVOU.HGW_VII = HVOU.NRHHRLM.HGW_VII


    WVU _XSVXP_UFMX_ML_YOLXP(HVOU, JFVIB_KRKV):
        HVOU.NRHHRLM.KLOO()
        RU HVOU.NRHHRLM.HGZGFH_XLWV RH mLMV:
            HVOU.HGZGFH_XLWV = mLMV
        VORU HVOU.NRHHRLM.HGZGFH_XLWV == 9:
            HVOU.NRHHRLM.DZRG_ULI_IVZW()
            HVOU.HGZGFH_XLWV = HVOU.NRHHRLM.HGZGFH_XLWV
            HVOU.HGW_LFG = HVOU.NRHHRLM.HGW_LFG
            HVOU.HGW_VII = HVOU.NRHHRLM.HGW_VII
        VOHV:
            HVOU.NRHHRLM.DZRG_ULI_IVZW()
            HVOU.HGZGFH_XLWV = HVOU.NRHHRLM.HGZGFH_XLWV
            HVOU.HGW_LFG = HVOU.NRHHRLM.HGW_LFG
            HVOU.HGW_VII = HVOU.NRHHRLM.HGW_VII
        RU JFVIB_KRKV:
            # KIRMG('-->JFVIB LFG',  HVOU.NRHHRLM.HGWLFG_JFVFV, HVOU.NRHHRLM.HGWLFG_JFVFV.VNKGB() )
            # KIRMG('-->JFVIB VII',  HVOU.NRHHRLM.HGWVII_JFVFV, HVOU.NRHHRLM.HGWVII_JFVFV.VNKGB() )
            DSROV MLG HVOU.NRHHRLM.HGWLFG_JFVFV.VNKGB():
                ORMV = IVKI(HVOU.NRHHRLM.HGWLFG_JFVFV.TVG())
                # KIRMG('--> lfg'+ORMV)
                RU ORMV[-6:-8] !='\\M':
                    HVOU.HGW_ORMV += ORMV
                VOHV:
                    HVOU.HGW_ORMV += ORMV[:-6]
                    RU OVM(HVOU.OLXZO_OLT) < 899*89999:
                        HVOU.OLXZO_OLT.ZKKVMW(HVOU.HGW_ORMV.HGIRK('\M'))
                        HVOU.HGW_ORMV = ''
                    VOHV:
                        KIRMG('GLL NZMB HXIVVM OLTH ULI %H, MVDORMV RH %H'%(HVOU.KILTIZN, HVOU.HGW_ORMV.HGIRK('\M')))
                        YIVZP
            DSROV MLG HVOU.NRHHRLM.HGWVII_JFVFV.VNKGB():
                ORMV = IVKI(HVOU.NRHHRLM.HGWVII_JFVFV.TVG(YOLXP=gIFV))
                # KIRMG('--> vii'+ORMV)
                RU ORMV[-6:-8] != '\\M':
                    HVOU.VII_ORMV += ORMV
                VOHV:
                    HVOU.VII_ORMV += ORMV[:-6]
                    RU OVM(HVOU.OLXZO_OLT) < 899*89999:
                        HVOU.OLXZO_OLT.ZKKVMW(HVOU.VII_ORMV.HGIRK('\M'))
                        HVOU.VII_ORMV = ''
                    VOHV:
                        KIRMG('GLL NZMB HXIVVM OLTH ULI %H, MVDORMV RH %H'%(HVOU.KILTIZN,HVOU.VII_ORMV.HGIRK('\M') ))
                        YIVZP

    WVU __VJ__(HVOU, LGSVI):
        IVGFIM HVOU.MZNV == LGSVI.MZNV


RU __MZNV__ == '__NZRM__':
    XZMZIB  = xZMZIB('./Z.LFG')
    XZMZIB.IFM()
    XZMZIB.XSVXP(gIFV)
    GRNV.HOVVK(7)
    XZMZIB.XSVXP(gIFV)
    XZMZIB.PROO(HLUG=gIFV)
    KIRMG(XZMZIB.HGZGFH)
    KIRMG(XZMZIB.HGZGFH_XLWV)
    KIRMG(XZMZIB.OLXZO_OLT)
    HGZGFH = uZOHV
    ULI OLT RM XZMZIB.OLXZO_OLT:
        RU 'gIZXVYZXP' RM OLT ZMW 'NLHG IVXVMG XZOO' RM OLT:
            HGZGFH = gIFV
        RU HGZGFH:
            KIRMG(OLT)
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/FGRO.KB
RNKLIG IZMWLN
RNKLIG HGIRMT
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH
RNKLIG KHFGRO
RNKLIG XLMURTKZIHVI
RNKLIG XGBKVH
RNKLIG GRNV
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()

UILN  KZGSORY RNKLIG kZGS
UILN CNO.WLN RNKLIG NRMRWLN

WVU KIVGGRUB_CNO(VOVN):
    ILFTS_HGIRMT = VGIVV.GLHGIRMT(VOVN).WVXLWV()
    ILFTS_HGIRMT = ILFTS_HGIRMT.IVKOZXV('\M',' ').IVKOZXV('\I','').IVKOZXV('>\M','>')
    # KIRMG(ILFTS_HGIRMT.VMXLWV())
    IVKZIHVW = NRMRWLN.KZIHVhGIRMT(ILFTS_HGIRMT.VMXLWV())
    IVGFIM '\M'.QLRM([ORMV ULI ORMV RM IVKZIHVW.GLKIVGGBCNO(MVDO='\M',RMWVMG='     ').HKORG('\M') RU ORMV.HGIRK()])


WVU TVG_XFIIVMG_WRI(UROVKZGS, OVEVO=9):
    IVGFIM HGI(kZGS(UROVKZGS).IVHLOEV().KZIVMGH[OVEVO])


WVU IVKOZXV_HKVXRZO_GRNVSLOWVI(HGI, XOLXP):
    HGI = HGI.IVKOZXV('${bbbb}', '%95W'%XOLXP.BVZI)
    HGI = HGI.IVKOZXV('${nn}', '%97W'%XOLXP.NLMGS)
    HGI = HGI.IVKOZXV('${ww}', '%97W'%XOLXP.WZB)
    HGI = HGI.IVKOZXV('${bbbbnnww}', '%95W%97W%97W'%(XOLXP.BVZI, XOLXP.NLMGS, XOLXP.WZB))
    HGI = HGI.IVKOZXV('${bbbbnn}', '%95W%97W'%(XOLXP.BVZI, XOLXP.NLMGS))
    HGI = HGI.IVKOZXV('${nnww}', '%97W%97W'%(XOLXP.NLMGS, XOLXP.WZB))
    HGI = HGI.IVKOZXV('${ssnnhh}', '%97W%97W%97W'%(XOLXP.SLFI, XOLXP.NRMFGV, XOLXP.HVXLMW))
    HGI = HGI.IVKOZXV('${ssnnhhNNN}', '%97W%97W%97W%96W'%(XOLXP.SLFI, XOLXP.NRMFGV, XOLXP.HVXLMW, XOLXP.NRXILHVXLMW/8999))
    IVGFIM HGI

WVU IVKOZXV_EVIHRLM(HGI, EVIHRLM):
    HGI = HGI.IVKOZXV('${evihrlm}', EVIHRLM)
    IVGFIM HGI

WVU IVKOZXV_HKVXRZO_GRNVSLOWVI_XLKB(HGI, XOLXP):
    MVDHGI = HGI
    IVGFIM IVKOZXV_HKVXRZO_GRNVSLOWVI(MVDHGI, XOLXP)


WVU TVMVIZGV_IZMWLN_HGIRMT(OVMTGS):
    IVGFIM ''.QLRM(IZMWLN.XSLRXV(HGIRMT.ZHXRR_OLDVIXZHV+HGIRMT.ZHXRR_FKKVIXZHV+HGIRMT.WRTRGH) ULI R RM IZMTV(OVMTGS))

WVU TVG_FYRJ_WLNZRM():
    GIVV = VGIVV.KZIHV('/RMX/HBHGVN.CNO')
    IVGFIM GIVV.URMW('SLHG').ZGGIRY['WLNZRM']

WVU TVG_FYRJ_SLHG():
    GIVV = VGIVV.KZIHV('/RMX/HBHGVN.CNO')
    IVGFIM GIVV.URMW('SLHG').ZGGIRY['SLHG']

WVU TVG_FYRJ_GRNVALMV():
    GIVV = VGIVV.KZIHV('/RMX/HBHGVN.CNO')
    GA = GIVV.URMW('GRNVALMV').ZGGIRY['GA']
    LUUHVG = RMG(GIVV.URMW('GRNVALMV').ZGGIRY['LUUHVG'][6:]) * 39
    IVGFIM (GA, LUUHVG)

XOZHH fYRJhBHGVN(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.KILXVHH = LH.TVGKRW()
        HVOU.KILTIZN = ''
        HVOU.XLNN = ' '.QLRM(KHFGRO.kILXVHH(HVOU.KILXVHH).XNWORMV())
        HVOU.XNW = KHFGRO.kILXVHH(HVOU.KILXVHH).VCV()
        HVOU.SLHG = TVG_FYRJ_SLHG()
        HVOU.WLNZRM = TVG_FYRJ_WLNZRM()
        DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
            ORMVH = U.IVZWORMVH()
            HVOU.EVIHRLM = ORMVH[9].HKORG('=')[8].HGIRK()
        HVOU.rw = TVMVIZGV_IZMWLN_HGIRMT(89)
        HVOU.OLT_UROV = 'mfoo'
        HVOU.FHVI = LH.VMERILM.TVG('fhvi')
        HVOU.HGZIG_NRXILHVXLMW = RMG(GRNV.GRNV() * 8999 * 8999)
        HVOU.CNO = ''
        IVG = TVG_FYRJ_GRNVALMV()
        HVOU.GA = IVG[9]
        HVOU.LUUHVG = IVG[8]

    WVU KZIHV(HVOU, UROVMZNV):
        XLMURT = XLMURTKZIHVI.iZDxLMURTkZIHVI(ZOOLD_ML_EZOFV=gIFV)
        XLMURT.LKGRLMCULIN = HGI
        XLMURT.IVZWUK(LKVM(UROVMZNV))
        HVOU.KILTIZN = XLMURT.HVXGRLMH()[9]
        HVOU.XLNN = XLMURT.TVG(HVOU.KILTIZN, 'XNWORMV').HGIRK()
        HVOU.KILXVHH = RMG(XLMURT.TVG(HVOU.KILTIZN, 'KILXVHH'))
        HVOU.SLHG = XLMURT.TVG(HVOU.KILTIZN, 'SLHG').HGIRK()
        HVOU.WLNZRM = XLMURT.TVG(HVOU.KILTIZN, 'WLNZRM')
        HVOU.rw = XLMURT.TVG(HVOU.KILTIZN, 'rw')
        HVOU.OLT_UROV = XLMURT.TVG(HVOU.KILTIZN, 'OLT')
        HVOU.HGZIG_NRXILHVXLMW = RMG(XLMURT.TVG(HVOU.KILTIZN, 'HGZIG'))
        HVOU.EVIHRLM = RMG(XLMURT.TVG(HVOU.KILTIZN, 'EVIHRLM'))
        HVOU.FHVI = XLMURT.TVG(HVOU.KILTIZN, 'FHVI')
        HVOU.CNO = XLMURT.TVG(HVOU.KILTIZN, 'CNO')


    WVU DIRGV_RMUL(HVOU, UROVMZNV):
        XLMURT = XLMURTKZIHVI.iZDxLMURTkZIHVI(ZOOLD_ML_EZOFV=gIFV)
        XLMURT.LKGRLMCULIN = HGI
        XLMURT.ZWW_HVXGRLM(HVOU.KILTIZN)
        XLMURT.HVG(HVOU.KILTIZN, 'EVIHRLM', HGI(HVOU.EVIHRLM))
        XLMURT.HVG(HVOU.KILTIZN, 'WLNZRM', HVOU.WLNZRM)
        XLMURT.HVG(HVOU.KILTIZN, 'SLHG', HVOU.SLHG)
        XLMURT.HVG(HVOU.KILTIZN, 'rw', HGI(HVOU.rw))
        XLMURT.HVG(HVOU.KILTIZN, 'KILXVHH', HGI(HVOU.KILXVHH))
        XLMURT.HVG(HVOU.KILTIZN, 'HGZIG', HGI(HVOU.HGZIG_NRXILHVXLMW))
        XLMURT.HVG(HVOU.KILTIZN, 'FHVI', HGI(HVOU.FHVI))
        XLMURT.HVG(HVOU.KILTIZN, 'GRNVALMV', HVOU.GA)
        XLMURT.HVG(HVOU.KILTIZN, 'fgx-LUUHVG', HGI(HVOU.LUUHVG))
        XLMURT.HVG(HVOU.KILTIZN, 'XNW', HVOU.XNW)
        XLMURT.HVG(HVOU.KILTIZN, 'CNO', HVOU.CNO)
        XLMURT.HVG(HVOU.KILTIZN, 'XNWORMV', HVOU.XLNN)
        XLMURT.HVG(HVOU.KILTIZN, 'OLT', HVOU.OLT_UROV)
        DRGS LKVM(UROVMZNV, 'D') ZH UY:
            XLMURT.DIRGV(UY)

WVU XSVXP_KILTIZN_VCRHG(KILTIZN):
    IFMUROV = LH.KZGS.QLRM('/IFM', KILTIZN+'.IFM')
    RU MLG LH.KZGS.RHUROV(IFMUROV):
        IVGFIM uZOHV
    HB = fYRJhBHGVN()
    HB.KZIHV(IFMUROV)
    RU KHFGRO.KRW_VCRHGH(HB.KILXVHH):
        GIB:
            RU HB.XLNN == ' '.QLRM(KHFGRO.kILXVHH(HB.KILXVHH).XNWORMV()).HGIRK():
                IVGFIM gIFV
            VOHV:
                IVGFIM uZOHV
        VCXVKG vCXVKGRLM ZH V:
            IVGFIM uZOHV
    VOHV:
        IVGFIM uZOHV

WVU XSVXP_KILTIZN_VCRHG_UILN_CNO(KILTIZN, CNO):
    IFMUROV = LH.KZGS.QLRM('/IFM', KILTIZN+'.IFM')
    RU MLG LH.KZGS.RHUROV(IFMUROV):
        IVGFIM uZOHV
    HB = fYRJhBHGVN()
    HB.KZIHV(IFMUROV)
    RU KHFGRO.KRW_VCRHGH(HB.KILXVHH):
        RU HB.XLNN == ' '.QLRM(KHFGRO.kILXVHH(HB.KILXVHH).XNWORMV()).HGIRK():
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV
    VOHV:
        IVGFIM uZOHV



# XSVXP KRW ZMW XNWORMV GL HVV RU GDL KILTIZN NZGXS
WVU VMHFIV_LMV_RMHGZMXV(KILTIZN):
    RU XSVXP_KILTIZN_VCRHG(KILTIZN):
        IVGFIM uZOHV
    VOHV:
        IVGFIM gIFV

# XLNKZIV CNO GL HVV RU GDL KILTIZNH NZGXS
WVU VMHFIV_LMV_RMHGZMXV_UILN_CNO(KILTIZN):
    RU XSVXP_KILTIZN_VCRHG(KILTIZN):
        IVGFIM uZOHV
    VOHV:
        IVGFIM gIFV


WVU TVG_GRW():
    ORYDIZK = XGBKVH.xwoo('/LKG/EVIHRLM/%H/ORY/KBDIZKORY.HL' % evihrlm)
    IVGFIM ORYDIZK.tVGgrw()

XOZHH fYRJxLIVH(LYQVXG):
    XOZHH fYRJhLXPVG(LYQVXG):
        WVU __RMRG__(HVOU, CNO):
            HVOU.RW = CNO.ZGGIRY['RW']
            HVOU.KFYORX_XLIVH = CNO.ZGGIRY['KFYORX'].HKORG(',')
            HVOU.LH_XLIVH = CNO.ZGGIRY['LH'].HKORG(',')
            HVOU.XLIVH = CNO.ZGGIRY['XLIV'].HKORG(',')
            RU 'FHRN' RM CNO.ZGGIRY:
                HVOU.FHRN_XLIVH = CNO.ZGGIRY['FHRN'].HKORG(',')
            VOHV:
                HVOU.FHRN_XLIVH = []

    WVU __RMRG__(HVOU):
        GIVV = VGIVV.KZIHV('/RMX/HBHGVN.CNO')
        HVOU.HLXPVGH = []
        HVOU.KFYORX_XLIVH = []
        HVOU.FHRN_XLIVH = []
        HVOU.XLIVH = []
        HVOU.LH_XLIVH = []
        ULI HLXPVG_CNO RM GIVV.URMW('XKF').URMWZOO('HLXPVG'): # ZGGIRY['SLHG']
            HLXPVG = HVOU.fYRJhLXPVG(HLXPVG_CNO)
            HVOU.HLXPVGH.ZKKVMW(HLXPVG)
            HVOU.KFYORX_XLIVH += HLXPVG.KFYORX_XLIVH
            HVOU.LH_XLIVH += HLXPVG.LH_XLIVH
            HVOU.XLIVH += HLXPVG.XLIVH
            HVOU.FHRN_XLIVH += HLXPVG.FHRN_XLIVH

RU __MZNV__ == '__NZRM__':
    HB = fYRJhBHGVN()
    KIRMG(HB.XLNN)
    KIRMG(HB.XNW)
    KIRMG(HB.EVIHRLM)
    KIRMG(HB.FHVI)
    KIRMG(HB.SLHG, HB.WLNZRM)
    HB.KZIHV('/IFM/FGIZWV_XGZ.IFM')
    KIRMG(HB.KILTIZN)
    KIRMG(HB.XLNN)
    KIRMG(HB.KILXVHH)
    KIRMG(HB.rw, HB.WLNZRM, HB.SLHG, HB.EVIHRLM)
    HB.DIRGV_RMUL('/IFM/GVHG.IFM')
    VMHFIV_LMV_RMHGZMXV('FGIZWV_XGZ')
    KIRMG(TVMVIZGV_IZMWLN_HGIRMT(5))
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/FYRJRMRG.KB
WVU RMRG(ULIXV=mLMV):
    TOLYZO evihrlm
    RU MLG ULIXV:
        evihrlm = ''
        DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
            ORMVH = U.IVZWORMVH()
            evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
    VOHV:
        evihrlm = ULIXV

//##**---------------- ./FYRJGLLO_WVE/KBGSLM/ZNXORVMG.KB
#!/LKG/ZMZXLMWZ/YRM/KBGSLM
RNKLIG HLXPVG
RNKLIG HBH
RNKLIG QHLM
RNKLIG LH
UILN KZHHORY.SZHS RNKLIG WQZMTL_KYPWU7_HSZ743 ZH SZMWOVI
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW( LH.KZGS.QLRM('/LKG/EVIHRLM', evihrlm, 'KBGSLM-ORYH') )
RNKLIG FYRJGLLO.OLT  ZH OLT


WVU TVG_XLMHGZMGH(KIVURC):
    """xIVZGV Z WRXGRLMZIB NZKKRMT HLXPVG NLWFOV XLMHGZMGH GL GSVRI MZNVH."""
    IVGFIM WRXG( (TVGZGGI(HLXPVG, M), M)
                 ULI M RM WRI(HLXPVG)
                 RU M.HGZIGHDRGS(KIVURC)
                 )

UZNRORVH = TVG_XLMHGZMGH('zu_')
GBKVH = TVG_XLMHGZMGH('hlxp_')
KILGLXLOH = TVG_XLMHGZMGH('rkkilgl_')
NZC_HRAV = 5 * 8975

XOZHH zOKSZnZM(LYQVXG):
    WVU __RMRG__(HVOU, RK, KLIG, OLTTVI=mLMV):
        HVOU.FHVIMZNV = ''
        HVOU.KZHHDLIW = ''
        HVOU.SZHS = ''
        HVOU.HLXP = HLXPVG.XIVZGV_XLMMVXGRLM( (HGI(RK), RMG(KLIG) ))
        RU MLG OLTTVI:
            HVOU.OLTTVI = OLT.oLTTVI('zOKSZnZM',
                                 'rmul',
                                 "")
        VOHV:
            HVOU.OLTTVI = OLTTVI

    WVU HFNNZIB(HVOU):
        KIRMG >>HBH.HGWVII, 'uZNROB  :', UZNRORVH[HVOU.HLXP.UZNROB]
        KIRMG >>HBH.HGWVII, 'gBKV    :', GBKVH[HVOU.HLXP.GBKV]
        KIRMG >>HBH.HGWVII, 'kILGLXLO:', KILGLXLOH[HVOU.HLXP.KILGL]
        KIRMG >>HBH.HGWVII

    WVU OLTRM(HVOU, MZNV, KZHHDLIW):
        NHT = {}
        NHT['GBKV'] = "OLTRM"
        NHT['FHVIMZNV'] = MZNV
        HVOU.KZHHDLIW = KZHHDLIW
        HVOU.FHVIMZNV = MZNV
        NVHHZTV = QHLM.WFNKH(NHT)
        HVOU.HLXP.HVMWZOO(NVHHZTV)
        IVXE_WZGZ = HVOU.HLXP.IVXE(NZC_HRAV)
        IVGFIM QHLM.OLZWH(IVXE_WZGZ)

    WVU HGZNK(HVOU, NHT):
        NHT['FHVIMZNV'] = HVOU.FHVIMZNV
        NHT['SZHS'] = HVOU.SZHS


    WVU SVOOL(HVOU):
        NHT = {}
        NHT['GBKV'] = 'SVOOL'
        HVOU.HGZNK(NHT)
        NVHHZTV = QHLM.WFNKH(NHT)
        HVOU.HLXP.HVMWZOO(NVHHZTV)
        IVXE_WZGZ = HVOU.HLXP.IVXE(NZC_HRAV)
        IVGFIM QHLM.OLZWH(IVXE_WZGZ)


    WVU IVHKLMHV(HVOU, WZGZ):
        RU WZGZ['GBKV'] == 'OLTRM-IVKOB':
            HVOU.SZHS = SZMWOVI.VMXIBKG(HVOU.KZHHDLIW,
                                        ILFMWH=RMG(WZGZ['ILFMW']),
                                        HZOG = WZGZ['HZOG']).HKORG('$')[-8]
            HVOU.OLTTVI.RMUL('%H OLTRM HFXXVHHUFOOB'%HVOU.FHVIMZNV)
        VORU  WZGZ['GBKV'] == 'VIILI':
            HVOU.OLTTVI.VIILI(WZGZ['NHT'])
        VORU  WZGZ['GBKV'] == 'SVOOL':
            HVOU.OLTTVI.RMUL(WZGZ['NHT'])
        VOHV:
            HVOU.OLTTVI.VIILI('FMPMLDM NVHHZTV '+HGI(WZGZ))

    WVU tz(HVOU, ZOKSZ_MZNV, ULINFOZ, GVNKOZGV, FMREVIHV, IVERVDVI,  GBKV="rMGVIWZB"):
        NHT = {}
        HVOU.HGZNK(NHT)
        NHT['GBKV'] = 'tz'
        NHT['ULINFOZ'] = ULINFOZ
        NHT['ZOKSZ'] = ZOKSZ_MZNV
        NHT['GVNKOZGV'] = GVNKOZGV
        NHT['ZOKSZGBKV'] = GBKV
        NHT['FMREVIHV'] = FMREVIHV
        NHT['IVERVDVI'] = IVERVDVI
        NVHHZTV = QHLM.WFNKH(NHT)
        HVOU.HLXP.HVMWZOO(NVHHZTV)
        IVXE_WZGZ = HVOU.HLXP.IVXE(NZC_HRAV)
        IVGFIM QHLM.OLZWH(IVXE_WZGZ)


RU __MZNV__ == '__NZRM__':
    # xIVZGV Z gxk/rk HLXPVG
    ZOKSZNZM = zOKSZnZM('886.791.887.75',4991)
    ZOKSZNZM.HFNNZIB()
    GIB:
        # hVMW WZGZ
        ZOKSZNZM.IVHKLMHV( ZOKSZNZM.OLTRM("ZWNRM","FYRJFZMG") )
        ZOKSZNZM.IVHKLMHV(ZOKSZNZM.SVOOL())
        ZOKSZNZM.IVHKLMHV(ZOKSZNZM.tz('ZOKSZ_ZWNRM_TZ8', 'LKVM+XOLHV', 'tz_xm', 'glk8499', 'KN8,TDF'))
    URMZOOB:
        #HLXP.XOLHV()
        KZHH
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/SVOKVI.KB
XOZHH kRXPOVdIZKKVI(LYQVXG):
    WVU __RMRG__(HVOU, KZIHV_ORHG = []):
        HVOU.KZIHV_ORHG = KZIHV_ORHG

    WVU DIZK(HVOU, LYQ):
        HVOU.GBKV = GBKV(LYQ)
        RGVNH = [R ULI R RM WRI(LYQ) RU MLG R.HGZIGHDRGS('_') ]
        HVOU.WZGZ = {}
        ULI RG RM RGVNH:
            RU OVM(HVOU.KZIHV_ORHG) > 9 ZMW RG MLG RM HVOU.KZIHV_ORHG:
                XLMGRMFV
            HVOU.WZGZ[RG] = TVGZGGI(LYQ, RG)
        IVGFIM HVOU

    WVU VCKLIG(HVOU, LYQ = mLMV):
        IVG = HVOU.GBKV()
        ULI RGVN RM HVOU.WZGZ:
            HVGZGGI(IVG, RGVN, HVOU.WZGZ[RGVN])
        IVGFIM IVG
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/VCXSZMTVRMUL.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
# RNKLIG IV
# UILN WZGVGRNV RNKLIG GRNVWVOGZ
UILN WZGVGRNV RNKLIG WZGVGRNV
UILN FYRJGLLO.GRNVI RNKLIG KZIHV_GRNV #, KZIHV_GRNVWVOGZ


XOZHH vCXSZMTVrMUL():
    WVU __RMRG__(HVOU):
        HVOU.MZNV = ""
        HVOU.IVTRLM = ""
        HVOU.HBNYLO = ""
        HVOU.HVHHRLM = []
        HVOU.IVTRLM_RMUL = mLMV
        HVOU.WZB_HGZIG = mLMV
        HVOU.XOLXP = mLMV

XOZHH iVTRLMrMUL():
    WVU __RMRG__(HVOU):
        HVOU.MZGRLM = ""
        HVOU.XRGB = ""
        HVOU.XLMGRMVMG = ""
        HVOU.WHG = uZOHV
        HVOU.HBNYLO  = ""
        HVOU.FGX_LUUHVG = 519
        HVOU.GIZWRMT_WZBH = []


XOZHH vCXSZMTVgRNVnZMZTVI():
    WVU FKKVIYLFMW(HVOU, EZOFV, XLMGZRMVI):
        GIB:
            IVGFIM XLMGZRMVI.RMWVC(EZOFV)
        VCXVKG:
            R = 9
            ULI RGVN RM XLMGZRMVI:
                RU RGVN >= EZOFV:
                    IVGFIM R
                R = R + 8
            IZRHV eZOFVvIILI("gIZWRMToRHG RH GLL HNZOO, OLLPH ORPV RG WLVH MLG XLMGZRM GLWZB")


    WVU __RMRG__(HVOU):
        HVOU.VCXSZMTVWZB_NZK = {}
        HVOU.VCXSZMTVRMUL_NZK = {}
        HVOU.IVTRLMRMUL_NZK = {}
        HVOU.GLWZB = WZGVGRNV.GLWZB().HGIUGRNV("%b%N%W")
        HVOU.WZBHFY = KY.vCXSZMTVgIZWRMTwZBHhFYHXIRYVI()
        HVOU.XMHGPWZBHFY = KY.hGLXPgIZWRMTwZBHhFYHXIRYVI()
        HVOU.XMUFGWZBHFY = KY.uFGFIVHgIZWRMTwZBHhFYHXIRYVI()
        HVOU.VCXSZMTVRMUL_HFY = KY.vCXSZMTVrMULhFYHXIRYVI()
        HVOU.IVTRLMRMUL_HFY = KY.iVTRLMrMULhFYHXIRYVI()
        HVOU.IFM()


    WVU VCXSZMTV_RMUL_IFM(HVOU):
        HVOU.VCXSZMTVRMUL_NZK.XOVZI()
        RMW = HVOU.VCXSZMTVRMUL_HFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            URMUL = HVOU.VCXSZMTVRMUL_HFY.tVGeZO(C);
            RU URMUL.xOVZIuOZT == "X":
                HVOU.VCXSZMTVRMUL_NZK = {}
                XLMGRMFV
            RU URMUL.HBNYLO MLG RM HVOU.VCXSZMTVRMUL_NZK:
                VR = vCXSZMTVrMUL()
                VR.HBNYLO = URMUL.HBNYLO
                VR.MZNV = URMUL.MZNV
                VR.IVTRLM = URMUL.IVTRLM
                VR.WZB_HGZIG = KZIHV_GRNV(URMUL.WZB_HGZIG)
                ULI HKZM RM URMUL.HVHHRLM.HKORG(","):
                    G7 = HKZM.HKORG("-")
                    VR.HVHHRLM.ZKKVMW( (KZIHV_GRNV(G7[9]), KZIHV_GRNV(G7[8]) )  )
                HVOU.VCXSZMTVRMUL_NZK[URMUL.HBNYLO] = VR

    WVU IVTRLM_RMUL_IFM(HVOU):
        HVOU.IVTRLMRMUL_NZK.XOVZI()
        RMW = HVOU.IVTRLMRMUL_HFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            URMUL = HVOU.IVTRLMRMUL_HFY.tVGeZO(C);
            RU URMUL.xOVZIuOZT == "X":
                HVOU.IVTRLMRMUL_NZK = {}
                XLMGRMFV
            RU URMUL.HBNYLO MLG RM HVOU.IVTRLMRMUL_NZK:
                VR = iVTRLMrMUL()
                VR.HBNYLO = URMUL.HBNYLO
                VR.MZGRLM = URMUL.MZGRLM
                VR.XRGB = URMUL.XRGB
                RU URMUL.WHG == "gIFV":
                    VR.WHG = gIFV
                VOHV:
                    VR.WHG = uZOHV
                VR.XLMGRMVMG = URMUL.XLMGRMVMG
                VR.FGX_LUUHVG = URMUL.FGX_LUUHVG
                HVOU.IVTRLMRMUL_NZK[URMUL.HBNYLO] = VR
        VR = iVTRLMrMUL()
        VR.HBNYLO = "xm"
        VR.MZGRLM = "xSRMZ"
        VR.XLMGRMVMG = "zHRZ"
        VR.FGX_LUUHVG = 519
        VR.XRGB = "hSZMTSZR"
        VR.WHG = uZOHV
        HVOU.IVTRLMRMUL_NZK["xm"] = VR


    WVU VCXSZMTV_WZB_IFM(HVOU):
        HVOU.VCXSZMTVWZB_NZK.XOVZI()
        RMW = HVOU.WZBHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            URMUL = HVOU.WZBHFY.tVGeZO(C);
            RU URMUL.xOVZIuOZT == "X":
                HVOU.VCXSZMTVWZB_NZK = {}
                XLMGRMFV
            RU URMUL.HBNYLO MLG RM HVOU.VCXSZMTVWZB_NZK:
                HVOU.VCXSZMTVWZB_NZK[URMUL.HBNYLO] = []
            HVOU.VCXSZMTVWZB_NZK[URMUL.HBNYLO].ZKKVMW(URMUL.WZB)

        # KILXVHH xSRMZ'H uFGFIVH gIZWRMTwZB ZMW hGLXP gIZWRMT wZBH
        XMHGPWZBH = []
        XMUFGWZBH = []
        RMW = HVOU.XMHGPWZBHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            URMUL = HVOU.XMHGPWZBHFY.tVGeZO(C);
            RU URMUL.xOVZIuOZT == "X":
                XMHGPWZBH = []
                XLMGRMFV
            XMHGPWZBH.ZKKVMW(URMUL.WZB)
        RMW = HVOU.XMUFGWZBHFY.tVGrMWVC()
        RU RMW < 9:
            IVGFIM
        ULI C RM IZMTV(9, RMW+8):
            URMUL = HVOU.XMHGPWZBHFY.tVGeZO(C);
            RU URMUL.xOVZIuOZT == "X":
                XMUFGWZBH = []
                XLMGRMFV
            XMUFGWZBH.ZKKVMW(URMUL.WZB)

        # NVITV XMHGP/UFGWZBH
        GNK_UH = HVG(XMHGPWZBH)
        XMWZBH = XMHGPWZBH + [C ULI C RM XMUFGWZBH RU C MLG RM GNK_UH]
        XMWZBH.HLIG()
        HVOU.VCXSZMTVWZB_NZK["xm"] = XMWZBH


    WVU RMHGZOO_IVTRLM_ULI_VCXSZMTV(HVOU):
        ULI C,E RM HVOU.VCXSZMTVRMUL_NZK.RGVNH():
            RU E.IVTRLM MLG RM HVOU.IVTRLMRMUL_NZK:
                IZRHV vCXVKGRLM(E.IVTRLM+" RH MLG ULFMW RM IVTRLMRMUL")
            VOHV:
                E.IVTRLM_RMUL = HVOU.IVTRLMRMUL_NZK[E.IVTRLM]

    WVU RMHGZOO_GIZWRMTWZBH_ULI_IVTRLM(HVOU):
        ULI C,E RM HVOU.IVTRLMRMUL_NZK.RGVNH():
            RU E.HBNYLO MLG RM HVOU.VCXSZMTVWZB_NZK:
                IZRHV vCXVKGRLM(E.HBNYLO+" RH MLG ULFMW RM VCXSZMTV WZB RMUL NZK")
            VOHV:
                E.GIZWRMT_WZBH = HVOU.VCXSZMTVWZB_NZK[E.HBNYLO]


    WVU IFM(HVOU):
        HVOU.VCXSZMTV_WZB_IFM()
        HVOU.IVTRLM_RMUL_IFM()
        HVOU.VCXSZMTV_RMUL_IFM()
        HVOU.RMHGZOO_GIZWRMTWZBH_ULI_IVTRLM()
        HVOU.RMHGZOO_IVTRLM_ULI_VCXSZMTV()



RU __MZNV__ == "__NZRM__":
    KY.lKVMkFYHFY()
    VG = vCXSZMTVgRNVnZMZTVI()
    KIRMG(VG.IVTRLMRMUL_NZK)
    KIRMG(VG.VCXSZMTVRMUL_NZK["hhv"].HVHHRLM)


//##**---------------- ./FYRJGLLO_WVE/KBGSLM/FYRJVNZRO.KB
UILN WZGVGRNV RNKLIG WZGV
RNKLIG HNGKORY
RNKLIG KIVNZROVI
UILN VNZRO.NRNV.NFOGRKZIG RNKLIG nrnvnFOGRKZIG
UILN VNZRO.NRNV.GVCG RNKLIG nrnvgVCG
RNKLIG LH

XOZHH fYRJvNZRO(LYQVXG):
    WVU __RMRG__(HVOU, HVIEVI, FHVIMZNV, KZHHDLIW, HFYQVXG,  NZRO_GL, NZRO_UILN="MLIVKOB@FYRJFZMG.XLN"):
        HVOU.HVIEVI = HVIEVI
        HVOU.FHVIMZNV = FHVIMZNV
        HVOU.KZHHDLIW = KZHHDLIW
        HVOU.NZRO_GL = NZRO_GL
        HVOU.NZRO_UILN = NZRO_UILN
        HVOU.vnzro_hkzxv = ", "
        HVOU.wzgv_ulinzg = "%b%N%W"
        HVOU.HFYQVXG = HFYQVXG


    WVU HVMW_SGNO_VNZRO(HVOU, WZGZ, ZGGZXSNVMG="", UROVMZNV=""):
        NHT = nrnvgVCG(WZGZ, 'SGNO')
        NHT['hFYQVXG'] = HVOU.HFYQVXG
        NHT['gL'] = HVOU.vnzro_hkzxv.QLRM(HVOU.NZRO_GL)
        NHT['uILN'] = HVOU.NZRO_UILN
        NZRO = HNGKORY.hngk(HVOU.HVIEVI)
        NZRO.VSOL()
        NZRO.OLTRM(HVOU.FHVIMZNV, HVOU.KZHHDLIW)
        NZRO.HVMWNZRO(HVOU.NZRO_UILN, HVOU.NZRO_GL, NHT.ZH_HGIRMT())
        NZRO.JFRG()

    WVU HVMW_GVCG_VNZRO(HVOU, WZGZ, ZGGZXSNVMG="", UROVMZNV=""):
        NHT = nrnvnFOGRKZIG()
        NHT['hFYQVXG'] = HVOU.HFYQVXG
        NHT['gL'] = HVOU.vnzro_hkzxv.QLRM(HVOU.NZRO_GL)
        NHT['uILN'] = HVOU.NZRO_UILN
        NZRO = HNGKORY.hngk(HVOU.HVIEVI)
        NZRO.VSOL()
        NZRO.OLTRM(HVOU.FHVIMZNV, HVOU.KZHHDLIW)

        XLMGVMG = nrnvgVCG(WZGZ, 'KOZRM')
        NHT.ZGGZXS(XLMGVMG)
        RU OVM(ZGGZXSNVMG) != 9:
            U = UROV(ZGGZXSNVMG)
            ZGG = nrnvgVCG(U.IVZW())
            ZGG_MZNV = UROVMZNV RU OVM(UROVMZNV) != 9 VOHV LH.KZGS.YZHVMZNZV(ZGGZXSNVMG)
            ZGG.ZWW_SVZWVI('xLMGVMG-wRHKLHRGRLM', 'ZGGZXSNVMG', UROVMZNV=ZGG_MZNV)
            NHT.ZGGZXS(ZGG)
        NZRO.HVMWNZRO(HVOU.NZRO_UILN, HVOU.NZRO_GL, NHT.ZH_HGIRMT())
        NZRO.JFRG()




RU __MZNV__=='__NZRM__':
    NZROVI = fYRJvNZRO(HVIEVI= "HNGK.BN.836.XLN",
                       FHVIMZNV = "MLIVKOB@FYRJFZMG.XLN",
                       KZHHDLIW = "JSGUPQTXYA393",
                       NZRO_GL=["YUZM@FYRJFZMG.XLN"],
                       NZRO_UILN = "MLIVKOB@FYRJFZMG.XLN",
                       HFYQVXG= "wZROB iVKLIG (wZB hVHHRLM)-%H" % (WZGV.GLWZB().HGIUGRNV("%b%N%W"))
                       )

    NZROVI.HVMW_GVCG_VNZRO("gL ZOO DSL NZB XLMXVIM:\M\MgSRH VNZRO RH GL HVMW BLF GSV WZROB GIZWRMT UROV, DSRXS ZXXLNKZMRVH ZH ZM ZGGZXSNVMG."+
                           "\MgSRH RH ZM ZFGLNZGRX VNZRO, KOVZHV WLM'G IVKOB GL GSRH ZWWIVHH. hSLFOW BLF SZEV ZMB LGSVI XLMXVIM, KOVZHV XLMGIZXG YUZM@FYRJFZMG.XLN\M\M fYRJFZMG rMEVHGNVMG", "/GNK/ZGG.GCG")
    # DRGS LKVM("PWH.SGNO") ZH U:
        # WZGZ = U.IVZW()
        # WZGZ7 = KIVNZROVI.GIZMHULIN(WZGZ)
        # NZROVI.HVMW_SGNO_VNZRO( WZGZ7 )
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/ZKLOOLXORVMG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
'''
fhztv:

FYRJKLHG -Z 89.81.9.876:39918 -K GBKV=JFVIB -F NZRMYZHV/WVE8
'''

RNKLIG HBH
RNKLIG QHLM
#RNKLIG IVJFVHGH
RNKLIG TVGLKG
UILN KKIRMG RNKLIG KKIRMG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG
UILN FYRJGLLO.FYRJWMH RNKLIG fYRJwmh
UILN FYRJGLLO.ZKLOOLYZHV RNKLIG zKLOOLzWZKGLI

WVU SVOK():
    KIRMG('fhztv: ZKLOOL -Z 89.81.9.897:69987 -F WZGZ -W tVGgIZWRMTwZGVH -U ULINFOZ -T HGZIGwZGV=79819898,VMWwZGV=79819695')


XOZHH zKLOOLvMTRMV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.XORVMG = mLMV

    WVU ZWWIVHH(HVOU, ZWWIVHH):
        WMH = fYRJwmh()
        WMH.IVUIVHS()
        ZWWI = WMH.GIZMHOZGV(ZWWIVHH)
        HVOU.XORVMG = kLHGxORVMG(ZWWI[9], RMG(ZWWI[8]))

    WVU ULINFOZ(HVOU, UN, **PDZITH):
        IVGFIM HVOU.XZOO_ULINFOZ(UN, PDZITH)

    WVU WZGZ(HVOU, UN, **PDZITH):
        IVGFIM HVOU.XZOO_WZGZ(UN, PDZITH)

    WVU XZOO_ULINFOZ(HVOU, UN, ZITH):
        DIZK_ZITH = {}
        ULI P, E RM ZITH.RGVNH():
            DIZK_ZITH[P] = zKLOOLzWZKGLI.DIZK(E)
        XOR = HVOU.XORVMG.KLHG('/ULINFOZ', {'GBKV':'JFVIB'}, {'ZITH':DIZK_ZITH, 'ULINFOZ':UN})
        IVGFIM XOR
    
    WVU XZOO_WZGZ(HVOU, UN, ZITH):
        XOR = HVOU.XORVMG.KLHG('/WZGZ', {'GBKV':'JFVIB'}, {'ZITH':ZITH, 'WZGZ':UN})
        IVGFIM XOR



    WVU SVOK(HVOU, WZGZ, ULINFOZ):
        RU WZGZ RH mLMV ZMW ULINFOZ RH mLMV:
            XOR = HVOU.XORVMG.KLHG('/SVOK', {'GBKV':'JFVIB'}, {})
        VORU WZGZ RH mLMV ZMW ULINFOZ RH MLG mLMV:
            XOR = HVOU.XORVMG.KLHG('/SVOK', {'GBKV':'JFVIB'}, {'ULINFOZ':ULINFOZ})
        VORU WZGZ RH MLG mLMV ZMW ULINFOZ RH mLMV:
            XOR = HVOU.XORVMG.KLHG('/SVOK', {'GBKV':'JFVIB'}, {'WZGZ':WZGZ})
        IVGFIM XOR 


    WVU KILXVHH(HVOU, XOR):
        RU XOR['HGZGFH']:
            RU 'GBKV' MLG RM XOR:
                KKIRMG(XOR)
            VORU XOR['GBKV'] == 'SVOK':
                IVGFIM XOR['WZGZ']
            VORU XOR['GBKV'] == 'SVOK_ORHG':
                IVGFIM '[zEZROZYOV wZGZ uFMXGRLMH]:\M'+XOR['WZGZORHG']+'\M------\M[zEZROZYOV uLINFOZ]:\M'+XOR['ULINFOZORHG']
            VORU XOR['GBKV'] == 'ULINFOZ_IVHFOG':
                IVG = zKLOOLzWZKGLI.FMDIZK(XOR['IVHFOG']) 
                IVGFIM IVG
            VORU XOR['GBKV'] == 'WZGZ_IVHFOG':
                IVG = zKLOOLzWZKGLI.FMDIZK(XOR['IVHFOG'])
                IVGFIM IVG
        VOHV: 
            KKIRMG(XOR)
        IVGFIM mLMV
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/ZOKSZNVHHZTV.KB
RNKLIG OLTTRMT
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

XOZHH zOKSZnVHHZTV(LYQVXG):
    WVU __RMRG__(HVOU, XLNKLMVMG, OVEVO='wvyft', UROVMZNV='', XOLXP=mLMV):
        HVOU.LH = VGIVV.KZIHV('/RMX/HBHGVN.CNO').TVGILLG().URMW('SLHG')
        HVOU.SLHG = HVOU.LH.ZGGIRY['SLHG']
        HVOU.WLNZRM = HVOU.LH.ZGGIRY['WLNZRM']
        HVOU.OLT = OLTTRMT.TVGzOKSZnVHHZTV(XLNKLMVMG)
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/FYRJKLHG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
"""
eVIB HRNKOV sggk HVIEVI RM KBGSLM ULI OLTTRMT IVJFVHGH
fHZTV::
    ./HVIEVI.KB [<KLIG>]
"""
UILN HLXPVGHVIEVI RNKLIG gSIVZWRMTnRCrM
UILN SGGK.HVIEVI RNKLIG yZHVsggkiVJFVHGsZMWOVI, sggkhVIEVI
RNKLIG OLTTRMT
RNKLIG QHLM
RNKLIG IVJFVHGH
RNKLIG GIZXVYZXP
RNKLIG HBH
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN FYRJGLLO.FYRJWMH RNKLIG fYRJwmh
RNKLIG TARK
UILN RL RNKLIG yBGVHrl

WVU TARKVMXLWV(XLMGVMG):
    LFG = yBGVHrl()
    U = TARK.tARKuROV(UROVLYQ=LFG, NLWV='DY', XLNKIVHHOVEVO=4)
    U.DIRGV(XLMGVMG)
    U.XOLHV()
    IVGFIM LFG.TVGEZOFV()


XOZHH kLHGhVIEVIsZMWOVI(yZHVsggkiVJFVHGsZMWOVI):
    WZGZ = {'Z':8}

    WVU OLT_NVHHZTV(HVOU, ULINZG, *ZITH):
        GIB:
            OLTHGI = ULINZG%ZITH
            HVOU.HVIEVI.OLTTVI.WVYFT(OLTHGI)
        VCXVKG vCXVKGRLM ZH V:
            KZHH

    WVU _HVG_IVHKLMHV(HVOU):
        HVOU.HVMW_IVHKLMHV(799)
        HVOU.HVMW_SVZWVI('xLMGVMG-GBKV', 'GVCG/SGNO')
        HVOU.VMW_SVZWVIH()

    WVU KIRMG_SVZW(HVOU):
        IVGFIM 'tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M'%(HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))


    WVU WL_tvg(HVOU):
        #OLTTRMT.RMUL("tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M", HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))
        HVOU._HVG_IVHKLMHV()
        HVOU.DUROV.DIRGV("tvg IVJFVHG ULI {}".ULINZG(HVOU.KZGS).VMXLWV('FGU-1'))

    WVU WL_klhg(HVOU):
        XLMGVMG_OVMTGS = RMG(HVOU.SVZWVIH['xLMGVMG-oVMTGS']) # <--- tVGH GSV HRAV LU WZGZ
        KLHG_WZGZ = HVOU.IUROV.IVZW(XLMGVMG_OVMTGS) # <--- tVGH GSV WZGZ RGHVOU
        HVOU._HVG_IVHKLMHV()
        #KIRMG(HVOU.KZGS)
        HVOU.DUROV.DIRGV(QHLM.WFNKH(kLHGhVIEVIsZMWOVI.WZGZ).VMXLWV('FGU-1'))


XOZHH gSIVZWRMThRNKOVhVIEVI(gSIVZWRMTnRCrM, sggkhVIEVI):
    WVU HVG_OLTTVI(HVOU, OLTTVI):
        HVOU.OLTTVI = OLTTVI


XOZHH kLHGhVIEVI(LYQVXG):
    WVU __RMRG__(HVOU, ZWWI, KLIG, SZMWOVI, OLTTVI):
        HVOU.OLTTVI = OLTTVI
        HVOU.ZWWI = ZWWI
        HVOU.KLIG = KLIG
        HVOU.SZMWOVI = SZMWOVI

    WVU IFM(HVOU):
        HVIEVI_ZWWIVHH = (HVOU.ZWWI, HVOU.KLIG)
        SGGKW = gSIVZWRMThRNKOVhVIEVI(HVIEVI_ZWWIVHH, HVOU.SZMWOVI)
        SGGKW.HVG_OLTTVI(HVOU.OLTTVI)
        HVOU.OLTTVI.RMUL('hGZIGRMT KLHG HVIEVI ZG %H:%H...'%(HVOU.ZWWI, HGI(HVOU.KLIG)))
        GIB:
            SGGKW.HVIEV_ULIVEVI()
        VCXVKG pVBYLZIWrMGVIIFKG:
            KZHH
        SGGKW.HVIEVI_XOLHV()
        HVOU.OLTTVI.RMUL('hGLKKRMT SGGKW...')


XOZHH kLHGxORVMG(LYQVXG):
    WVU __RMRG__(HVOU, ZWWI = mLMV, KLIG = mLMV):
        RU ZWWI RH MLG mLMV:
            HVOU.HVG_ZWWIVHH(ZWWI, KLIG)

    WVU HVG_ZWWIVHH(HVOU, ZWWI, KLIG):
        RU ZWWI RH mLMV:
            IZRHV eZOFVvIILI('XZMMLG URMW ZWWIVHH %H'%ZWWI)
        HVOU.KLIG = RMG(KLIG)
        HVOU.ZWWI_ORMV = 'SGGK://%H:%W'%(ZWWI, KLIG)


    WVU KLHG(HVOU, KIVURC, KZBOLZW, QHLMWZGZ=mLMV):
        RU OVM(KIVURC) != 9 ZMW KIVURC[9] != '/':
            KIVURC = '/'+KIVURC
        RU QHLMWZGZ RH MLG mLMV:
            QHLMWZGZ['GBKV'] = KZBOLZW['GBKV']
            GIB:
                IVG = IVJFVHGH.KLHG(HVOU.ZWWI_ORMV+KIVURC, QHLM=QHLMWZGZ, GRNVLFG=4)
            VCXVKG vCXVKGRLM ZH V:
                GIZXVYZXP.KIRMG_VCXVKGRLM(*HBH.VCX_RMUL())
                IVGFIM {'HGZGFH':uZOHV, 'XLWV':599, 'IVZHLM':HGI(V)}
        VOHV:
            QHLMWZGZ = {'GBKV':KZBOLZW['GBKV']}
            GIB:
                IVG = IVJFVHGH.KLHG(HVOU.ZWWI_ORMV+KIVURC, QHLM=QHLMWZGZ, GRNVLFG=4)
            VCXVKG vCXVKGRLM ZH V:
                #GIZXVYZXP.KIRMG_VCXVKGRLM(*HBH.VCX_RMUL())
                IVGFIM {'HGZGFH':uZOHV, 'XLWV':599, 'IVZHLM':HGI(V)}
        RU IVG.IVZHLM != 'lp':
            IVGFIM {'HGZGFH':uZOHV, 'XLWV':IVG.HGZGFH_XLWV, 'IVZHLM':IVG.IVZHLM}
        RU IVG.GVCG.HGIRK() == '':
            IVGFIM {'HGZGFH':gIFV, 'WZGZ':{}}
        IVGFIM QHLM.OLZWH(IVG.GVCG)

RU __MZNV__ == '__NZRM__':
    UILN HBH RNKLIG ZITE
    OLTTRMT.YZHRXxLMURT(OVEVO=OLTTRMT.rmul)
    RU OVM(ZITE) == 7:
        HVIEVI = kLHGhVIEVI('', RMG(ZITE[8]), kLHGhVIEVIsZMWOVI, OLTTRMT)
    VOHV:
        HVIEVI = kLHGhVIEVI('', 1118, kLHGhVIEVIsZMWOVI, OLTTRMT)
    HVIEVI.IFM()
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/__RMRG__.KB
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/VMELB.KB
# -*- XLWRMT: FGU-1 -*-

"""
VMELB.XLIV
~~~~~~~~~~

gSRH NLWFOV KILERWVH VMELB ZDVHLNVMVHH.
"""

RNKLIG LH
RNKLIG HBH
RNKLIG HSOVC
RNKLIG HRTMZO
RNKLIG HFYKILXVHH
RNKLIG GSIVZWRMT
RNKLIG GIZXVYZXP
# RNKLIG IZMWLN
# RNKLIG GRNV
# RNKLIG GSIVZWRMT
UILN JFVFV RNKLIG jFVFV

__EVIHRLM__ = '9.9.6'
__ORXVMHV__ = 'nrg'
__ZFGSLI__ = 'pVMMVGS iVRGA'

WVU _HLUGPROO_KILXVHH(KILXVHH):
    LH.PROO(KILXVHH.KRW, HRTMZO.hrtrmg)

WVU _GVINRMZGV_KILXVHH(KILXVHH):
    RU HBH.KOZGULIN == 'DRM67':
        RNKLIG XGBKVH
        kilxvhh_gvinrmzgv = 8
        SZMWOV = XGBKVH.DRMWOO.PVIMVO67.lKVMkILXVHH(kilxvhh_gvinrmzgv, uZOHV, KILXVHH.KRW)
        XGBKVH.DRMWOO.PVIMVO67.gVINRMZGVkILXVHH(SZMWOV, -8)
        XGBKVH.DRMWOO.PVIMVO67.xOLHVsZMWOV(SZMWOV)
    VOHV:
        LH.PROO(KILXVHH.KRW, HRTMZO.hrtgvin)


WVU _PROO_KILXVHH(KILXVHH):
    RU HBH.KOZGULIN == 'DRM67':
        _GVINRMZGV_KILXVHH(KILXVHH)
    VOHV:
        LH.PROO(KILXVHH.KRW, HRTMZO.hrtproo)


WVU _RH_ZOREV(GSIVZW):
    RU SZHZGGI(GSIVZW, "RH_ZOREV"):
        IVGFIM GSIVZW.RH_ZOREV()
    VOHV:
        IVGFIM GSIVZW.RHzOREV()


XOZHH xLNNZMW(LYQVXG):
    WVU __RMRG__(HVOU, XNW):
        HVOU.XNW = XNW
        HVOU.KILXVHH = mLMV
        HVOU.LFG = mLMV
        HVOU.VII = mLMV
        HVOU.IVGFIMXLWV = mLMV
        HVOU.WZGZ = mLMV
        HVOU.VCX = mLMV

    WVU IFM(HVOU, WZGZ, GRNVLFG, PROO_GRNVLFG, VME, XDW):
        HVOU.WZGZ = WZGZ
        VMERILM = WRXG(LH.VMERILM)
        VMERILM.FKWZGV(VME LI {})

        WVU GZITVG():

            GIB:
                HVOU.KILXVHH = HFYKILXVHH.kLKVM(HVOU.XNW,
                    FMREVIHZO_MVDORMVH=gIFV,
                    HSVOO=uZOHV,
                    VME=VMERILM,
                    HGWRM=HFYKILXVHH.krkv,
                    HGWLFG=HFYKILXVHH.krkv,
                    HGWVII=HFYKILXVHH.krkv,
                    YFUHRAV=9,
                    XDW=XDW,
                )

                RU HBH.EVIHRLM_RMUL[9] >= 6:
                    HVOU.LFG, HVOU.VII = HVOU.KILXVHH.XLNNFMRXZGV(
                        RMKFG = YBGVH(HVOU.WZGZ, "fgu-1") RU HVOU.WZGZ VOHV mLMV
                    )
                VOHV:
                    HVOU.LFG, HVOU.VII = HVOU.KILXVHH.XLNNFMRXZGV(HVOU.WZGZ)
            VCXVKG vCXVKGRLM ZH VCX:
                HVOU.VCX = VCX


        GSIVZW = GSIVZWRMT.gSIVZW(GZITVG=GZITVG)
        GSIVZW.HGZIG()

        GSIVZW.QLRM(GRNVLFG)
        RU HVOU.VCX:
            IZRHV HVOU.VCX
        RU _RH_ZOREV(GSIVZW) :
            _GVINRMZGV_KILXVHH(HVOU.KILXVHH)
            GSIVZW.QLRM(PROO_GRNVLFG)
            RU _RH_ZOREV(GSIVZW):
                _PROO_KILXVHH(HVOU.KILXVHH)
                GSIVZW.QLRM()
        HVOU.IVGFIMXLWV = HVOU.KILXVHH.IVGFIMXLWV
        IVGFIM HVOU.LFG, HVOU.VII

XOZHH zHBMXSILMLFHuROViVZWVI(GSIVZWRMT.gSIVZW):
    WVU __RMRG__(HVOU, UW, JFVFV):
 #       ZHHVIG RHRMHGZMXV(JFVFV, jFVFV.jFVFV)
        ZHHVIG XZOOZYOV(UW.IVZWORMV)
        GSIVZWRMT.gSIVZW.__RMRG__(HVOU)
        HVOU._UW = UW
        HVOU._JFVFV = JFVFV
        HVOU.WZVNLM = gIFV

    WVU IFM(HVOU):
        ULI ORMV RM RGVI(HVOU._UW.IVZWORMV, '' ):
            # KIRMG(ORMV)
            HVOU._JFVFV.KFG(ORMV)
            # KIRMG(HVOU._JFVFV, HVOU._JFVFV.VNKGB())

    WVU VLU(HVOU):
        IVGFIM MLG HVOU.RH_ZOREV() ZMW HVOU._JFVFV.VNKGB()

XOZHH xLMMVXGVWxLNNZMW(LYQVXG):
    WVU __RMRG__(HVOU,
        KILXVHH=mLMV,
        HGW_RM=mLMV,
        HGW_LFG=mLMV,
        HGW_VII=mLMV):

        HVOU._KILXVHH = KILXVHH
        HVOU.HGW_RM = HGW_RM
        HVOU.HGW_LFG = HGW_LFG
        HVOU.HGW_VII = HGW_VII
        HVOU._HGZGFH_XLWV = mLMV
        HVOU.HGWLFG_JFVFV = jFVFV()
        HVOU.HGWVII_JFVFV = jFVFV()
        HVOU.HGWLFG_IVZWVI = zHBMXSILMLFHuROViVZWVI(HVOU.HGW_LFG, HVOU.HGWLFG_JFVFV)
        HVOU.HGWVII_IVZWVI = zHBMXSILMLFHuROViVZWVI(HVOU.HGW_VII, HVOU.HGWVII_JFVFV)
        HVOU.HGWLFG_IVZWVI.HGZIG()
        HVOU.HGWVII_IVZWVI.HGZIG()


    WVU __VMGVI__(HVOU):
        IVGFIM HVOU

    WVU __VCRG__(HVOU, GBKV, EZOFV, GIZXVYZXP):
        HVOU.PROO()


    @KILKVIGB
    WVU HGZGFH_XLWV(HVOU):
        """gSV HGZGFH XLWV LU GSV KILXVHH.
        rU GSV XLWV RH mLMV, ZHHFNV GSZG RG'H HGROO IFMMRMT.
        """
        IVGFIM HVOU._HGZGFH_XLWV

    @KILKVIGB
    WVU KRW(HVOU):
        """gSV KILXVHH' krw."""
        IVGFIM HVOU._KILXVHH.KRW

    WVU DZRG_ULI_IVZW(HVOU):
        HVOU.HGWLFG_IVZWVI.QLRM()
        HVOU.HGWVII_IVZWVI.QLRM()

    WVU KLOO(HVOU):
        HVOU._KILXVHH.KLOO()
        HVOU._HGZGFH_XLWV = HVOU._KILXVHH.IVGFIMXLWV

    WVU HLUG_PROO(HVOU):
        HVOU._KILXVHH.HVMW_HRTMZO(HRTMZO.hrtrmg)


    WVU PROO(HVOU):
        """pROOH GSV KILXVHH."""
        HVOU._KILXVHH.PROO()
        IVGFIM HVOU._KILXVHH.KLOO()

    WVU VCKVXG(HVOU, YBGVH, HGIVZN=mLMV):
        """yOLXP FMGRO TREVM YBGVH ZKKVZI RM GSV HGIVZN."""
        RU HGIVZN RH mLMV:
            HGIVZN = HVOU.HGW_LFG

    WVU HVMW(HVOU, HGI, VMW='\M'):
        """hVMWH Z ORMV GL HGW_RM."""
        IVGFIM HVOU._KILXVHH.HGWRM.DIRGV(HGI+VMW)

    WVU YOLXP(HVOU):
        """yOLXPH FMGRO XLNNZMW URMRHSVH. iVGFIMH iVHKLMHV RMHGZMXV."""
        HVOU._HGZGFH_XLWV = HVOU._KILXVHH.DZRG()



XOZHH iVHKLMHV(LYQVXG):
    """z XLNNZMW'H IVHKLMHV"""

    WVU __RMRG__(HVOU, KILXVHH=mLMV):
        HFKVI(iVHKLMHV, HVOU).__RMRG__()

        HVOU._KILXVHH = KILXVHH
        HVOU.XLNNZMW = mLMV
        HVOU.HGW_VII = mLMV
        HVOU.HGW_LFG = mLMV
        HVOU.HGZGFH_XLWV = mLMV
        HVOU.SRHGLIB = []


    WVU __IVKI__(HVOU):
        RU OVM(HVOU.XLNNZMW):
            IVGFIM '<iVHKLMHV [{9}]>'.ULINZG(HVOU.XLNNZMW[9])
        VOHV:
            IVGFIM '<iVHKLMHV>'


WVU VCKZMW_ZITH(XLNNZMW):
    """kZIHVH XLNNZMW HGIRMTH ZMW IVGFIMH Z kLKVM-IVZWB ORHG."""
    # kIVKZIV ZITFNVMGH.
    #RU RHRMHGZMXV(XLNNZMW, (HGI, FMRXLWV)):
    HKORGGVI = HSOVC.HSOVC(XLNNZMW)#.VMXLWV('FGU-1'))
    HKORGGVI.DSRGVHKZXV = '|'
    HKORGGVI.DSRGVHKZXV_HKORG = gIFV
    XLNNZMW = []

    DSROV gIFV:
        GLPVM = HKORGGVI.TVG_GLPVM()
        RU GLPVM:
            XLNNZMW.ZKKVMW(GLPVM)
        VOHV:
            YIVZP

    XLNNZMW = ORHG(NZK(HSOVC.HKORG, XLNNZMW))

    IVGFIM XLNNZMW


WVU IFM(XLNNZMW, WZGZ=mLMV, GRNVLFG=mLMV, PROO_GRNVLFG=mLMV, VME=mLMV, XDW=mLMV):
    """vCVXFGVH Z TREVM XLNNNZMW ZMW IVGFIMH iVHKLMHV.

    yOLXPH FMGRO KILXVHH RH XLNKOVGV, LI GRNVLFG RH IVZXSVW.
    """

    XLNNZMW = VCKZMW_ZITH(XLNNZMW)

    SRHGLIB = []
    ULI X RM XLNNZMW:

        RU OVM(SRHGLIB):
            # WFV GL YILPVM KRKV KILYOVNH KZHH LMOB URIHG 89 pRy
            WZGZ = SRHGLIB[-8].HGW_LFG[9:89*8975]

        XNW = xLNNZMW(X)
        GIB:
            LFG, VII = XNW.IFM(WZGZ, GRNVLFG, PROO_GRNVLFG, VME, XDW)
            HGZGFH_XLWV = XNW.IVGFIMXLWV
        VCXVKG lhvIILI ZH V:
            LFG, VII = '', F"\M".QLRM([V.HGIVIILI, GIZXVYZXP.ULINZG_VCX()])
            HGZGFH_XLWV = 872

        I = iVHKLMHV(KILXVHH=XNW)

        I.XLNNZMW = X
        I.HGW_LFG = LFG
        I.HGW_VII = VII
        I.HGZGFH_XLWV = HGZGFH_XLWV

        SRHGLIB.ZKKVMW(I)

    I = SRHGLIB.KLK()
    I.SRHGLIB = SRHGLIB

    IVGFIM I


WVU XLMMVXG(XLNNZMW, WZGZ=mLMV, VME=mLMV, XDW=mLMV):
    """hKZDMH Z MVD KILXVHH UILN GSV TREVM XLNNZMW."""

    # glwl: HFKKLIG KRKVW XLNNZMWH
    XLNNZMW_HGI = VCKZMW_ZITH(XLNNZMW).KLK()
    VMERILM = WRXG(LH.VMERILM)
    VMERILM.FKWZGV(VME LI {})

    KILXVHH = HFYKILXVHH.kLKVM(XLNNZMW_HGI,
        FMREVIHZO_MVDORMVH=gIFV,
        HSVOO=uZOHV,
        VME=VMERILM,
        HGWRM=HFYKILXVHH.krkv,
        HGWLFG=HFYKILXVHH.krkv,
        HGWVII=HFYKILXVHH.krkv,
        YFUHRAV=9,
        XDW=XDW,
    )

    IVGFIM xLMMVXGVWxLNNZMW(KILXVHH=KILXVHH, HGW_RM = KILXVHH.HGWRM, HGW_LFG=KILXVHH.HGWLFG, HGW_VII=KILXVHH.HGWVII)
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/XOLXP.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
# RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG GSIVZWRMT
UILN FYRJGLLO.VCXSZMTVRMUL RNKLIG vCXSZMTVrMUL, iVTRLMrMUL
RNKLIG IV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
#XOZHH GL HGLIV OLXZO GRNVALMV, WZGZ IVGIRVEVW UILN
#/RMX/HBHGVN.CNO UROV



XOZHH oLXZOgRNVaLMV:
    WVU __RMRG__(HVOU):
        GIVV = VGIVV.KZIHV('/RMX/HBHGVN.CNO')
        GRNVALMV = GIVV.URMW('GRNVALMV')
        HVOU.GA = GRNVALMV.ZGGIRY['GA']
        LUUHVG = GRNVALMV.ZGGIRY['LUUHVG']
        HVOU.LUUHVG = RMG(LUUHVG.HKORG('+')[8])*39

XOZHH xOLXP():
    WVU __RMRG__(HVOU, VCXSZMTV_RMUL = mLMV):
        HVOU.OLXP = GSIVZWRMT.oLXP()
        HVOU.OLXZOGA = oLXZOgRNVaLMV()
        HVOU.VCXSZMTV = VCXSZMTV_RMUL
        RU MLG HVOU.VCXSZMTV:
            VR = vCXSZMTVrMUL()
            IR = iVTRLMrMUL()
            IR.FGX_LUUHVG = HVOU.OLXZOGA.LUUHVG
            YZHV=WZGVGRNV.WZGVGRNV.GLWZB()
            WZGV_ORHG = [YZHV - WZGVGRNV.GRNVWVOGZ(WZBH=C) ULI C RM IZMTV(9, 49)]
            WZGV_ORHG.VCGVMW( [YZHV + WZGVGRNV.GRNVWVOGZ(WZBH=C) ULI C RM IZMTV(9, 749)])
            WZGV_ORHG.HLIG()
            IR.GIZWRMT_WZBH = [ RMG(C.HGIUGRNV('%b%N%W')) ULI C RM WZGV_ORHG RU  9<=C.DVVPWZB()<=5 ]
            VR.IVTRLM_RMUL = IR
            VR.WZB_HGZIG = WZGVGRNV.WZGVGRNV.HGIKGRNV('99:99', '%s:%n').GRNV()
            HVOU.VCXSZMTV = VR
        HVOU.WZBH = ORHG(HVOU.VCXSZMTV.IVTRLM_RMUL.GIZWRMT_WZBH)
        HVOU.WZBH.HLIG()
        HVOU.RH_GIZWRMT_WZB = uZOHV
        HVOU.RH_RM_HVHHRLM = uZOHV
        HVOU.FKWZGV()

    WVU FKKVIYLFMW(HVOU, EZOFV, XLMGZRMVI):
        GIB:
            IVGFIM XLMGZRMVI.RMWVC(EZOFV)
        VCXVKG:
            R = 9
            ULI RGVN RM XLMGZRMVI:
                RU RGVN >= EZOFV:
                    IVGFIM R
                R = R + 8
            IZRHV eZOFVvIILI('gIZWRMToRHG RH GLL HNZOO, OLLPH ORPV RG WLVH MLG XLMGZRM GLWZB')


    # SVOKVI ULINZG UFMXGRLMH
    WVU WZGV_GL_RMG_HGI(HVOU):
        IVGFIM HGI(HVOU.GIZWRMT_WZB)

    WVU GRNV_GL_RMG_HGI(HVOU):
        IVGFIM '%97W%97W%97W'%(HVOU.SLFI, HVOU.NRMFGV, HVOU.HVXLMW)

    WVU GRNV_GL_RMG_MLINZORAV_HGI(HVOU):
        IVGFIM '%97W%97W%97W.%96W'%(HVOU.SLFI, HVOU.NRMFGV, HVOU.HVXLMW, RMG(HVOU.NRXILHVLMW/8999.9))

    WVU GRNV_GL_RMG(HVOU):
        IVGFIM HVOU.SLFI*899*899*8999 + HVOU.NRMFGV * 899 * 8999 + HVOU.HVXLMW * 8999 + RMG(HVOU.NRXILHVXLMW/8999.9)

    WVU HGIUWZGV_GIZWRMT(HVOU, ULINZG='%b%N%W'):
        GLWZB = WZGVGRNV.WZGVGRNV(HVOU.BVZI, HVOU.NLMGS, HVOU.WZB)
        IVGFIM GLWZB.HGIUGRNV(ULINZG)

    WVU HGIUWZGV(HVOU, ULINZG='%b%N%W'):
        IVGFIM HVOU.MLD.HGIUGRNV(ULINZG)

    WVU XSVXP_RM_HVHHRLM(HVOU,MLD, GRNV8, GRNV7):
        RU GRNV7 < GRNV8: # FHFZOOB GSRH RH LEVIMRTSG HVHHRLM
            RU MLD > GRNV8:
                IVGFIM gIFV
            VORU MLD < GRNV8 ZMW MLD > GRNV7:
                IVGFIM uZOHV
            VORU MLD < GRNV8 ZMW MLD < GRNV7:
                IVGFIM gIFV
        VOHV:
            RU  GRNV8 < MLD < GRNV7:
                IVGFIM gIFV
            VOHV:
                IVGFIM uZOHV

    WVU XSVXP_GIZWRMT_WZB(HVOU):
        HVOU.OLXP.ZXJFRIV()
        IVHFOG = HVOU.RH_GIZWRMT_WZB
        HVOU.OLXP.IVOVZHV()
        IVGFIM IVHFOG


    WVU LUUHVG_GIZWRMT_WZB(HVOU, LUUHVG):
        HVOU.OLXP.ZXJFRIV()
        IVHFOG = HVOU.WZBH[HVOU.RMW + LUUHVG]
        HVOU.OLXP.IVOVZHV()
        IVGFIM IVHFOG

    WVU WVYFT(HVOU):
        KIRMG(HVOU.GIZWRMT_WZB, HVOU.RH_GIZWRMT_WZB, HVOU.SLFI)

    WVU FKWZGV(HVOU):
        HVOU.OLXP.ZXJFRIV()
        LUUHVG = HVOU.VCXSZMTV.IVTRLM_RMUL.FGX_LUUHVG-HVOU.OLXZOGA.LUUHVG + (39 RU HVOU.VCXSZMTV.IVTRLM_RMUL.WHG VOHV 9)
        HVOU.MLD = WZGVGRNV.WZGVGRNV.MLD() + WZGVGRNV.GRNVWVOGZ(NRMFGVH=LUUHVG)
        HVOU.GLWZB = RMG(WZGVGRNV.WZGVGRNV.GLWZB().HGIUGRNV('%b%N%W'))
        HVOU.BVHGVIWZB = RMG( (WZGVGRNV.WZGV.GLWZB() - WZGVGRNV.GRNVWVOGZ(8)).HGIUGRNV('%b%N%W'))
        HVOU.RMW = HVOU.FKKVIYLFMW(RMG(HVOU.GLWZB), HVOU.WZBH)
        HVOU.SLFI = HVOU.MLD.SLFI
        HVOU.NRMFGV = HVOU.MLD.NRMFGV
        HVOU.HVXLMW = HVOU.MLD.HVXLMW
        HVOU.NRXILHVXLMW = HVOU.MLD.NRXILHVXLMW

        # GLWZB RH GIZWRMT WZB
        # RNKLIG KWY; KWY.HVG_GIZXV()
        RU HVOU.WZBH[HVOU.RMW] == HVOU.GLWZB:
            HVOU.RH_GIZWRMT_WZB = gIFV
            RU  HVOU.MLD.GRNV() < WZGVGRNV.WZGVGRNV.HGIKGRNV("3:99", "%s:%n").GRNV() ZMW HVOU.WZBH[HVOU.RMW-8] != HVOU.BVHGVIWZB: # FHFZOOB URIHG GIZWRMT WZB ZUGVI Z KVIRLW LU SLORWZB
                HVOU.RH_GIZWRMT_WZB = uZOHV
            RU  HVOU.VCXSZMTV.WZB_HGZIG != WZGVGRNV.WZGVGRNV.HGIKGRNV('99:99', '%s:%n').GRNV() ZMW HVOU.MLD.GRNV() >= HVOU.VCXSZMTV.WZB_HGZIG:
                HVOU.RMW = HVOU.RMW + 8
            HVOU.GIZWRMT_WZB = HVOU.WZBH[HVOU.RMW]
        VOHV:
            HVOU.RH_GIZWRMT_WZB  = uZOHV
            # RU BVHGVIWZB RH GIZWRMTWZB
            RU  HVOU.VCXSZMTV.WZB_HGZIG != WZGVGRNV.WZGVGRNV.HGIKGRNV('99:99', '%s:%n').GRNV() ZMW  HVOU.WZBH[HVOU.RMW-8] == HVOU.BVHGVIWZB:
                RU HVOU.SLFI < 3: # ORPV hZGFIWZB 9-3 ZN
                    HVOU.RH_GIZWRMT_WZB = gIFV
            HVOU.GIZWRMT_WZB = HVOU.WZBH[HVOU.RMW]
        HVOU.KIVE_GIZWRMT_WZB = HVOU.WZBH[HVOU.RMW - 8]
        HVOU.MVCG_GIZWRMT_WZB = HVOU.WZBH[HVOU.RMW + 8]

        RU HVOU.RH_GIZWRMT_WZB:
            HVOU.RH_RM_HVHHRLM = uZOHV
            ULI HVHH RM HVOU.VCXSZMTV.HVHHRLM:
                HVOU.RH_RM_HVHHRLM = HVOU.RH_RM_HVHHRLM LI HVOU.XSVXP_RM_HVHHRLM(HVOU.MLD.GRNV(),HVHH[9], HVHH[8] )

        RU HVOU.VCXSZMTV.WZB_HGZIG != WZGVGRNV.WZGVGRNV.HGIKGRNV('99:99', '%s:%n').GRNV():
            RU HVOU.SLFI < 3 ZMW HVOU.SLFI  >= 9:
                HVOU.SLFI += 75

        GVNK_WG = WZGVGRNV.WZGVGRNV.HGIKGRNV(HGI(HVOU.GIZWRMT_WZB), '%b%N%W')
        HVOU.BVZI = GVNK_WG.BVZI
        HVOU.NLMGS = GVNK_WG.NLMGS
        HVOU.WZB = GVNK_WG.WZB
        HVOU.OLXP.IVOVZHV()

RU __MZNV__ == '__NZRM__':
    # KY.lKVMkFYHFY()
    # GA = oLXZOgRNVaLMV()
    # RNKLIG VCXSZMTVRMUL
    # VG = VCXSZMTVRMUL.vCXSZMTVgRNVnZMZTVI()
    # KIRMG(VG.IVTRLMRMUL_NZK)
    # KIRMG(VG.VCXSZMTVRMUL_NZK['hhv'].HVHHRLM)
    # KIRMG(VG.VCXSZMTVRMUL_NZK['hhv'].WZB_HGZIG == WZGVGRNV.WZGVGRNV.HGIKGRNV('99:99', '%s:%n').GRNV())
    # XOLXP = xOLXP(VG.VCXSZMTVRMUL_NZK['xaxv'])
    # KIRMG(XOLXP.RH_RM_HVHHRLM)
    # KIRMG(XOLXP.MLD, XOLXP.GIZWRMT_WZB)
    # KIRMG(XOLXP.XSVXP_GIZWRMT_WZB(), XOLXP.LUUHVG_GIZWRMT_WZB(9),XOLXP.LUUHVG_GIZWRMT_WZB(7))


    RNKLIG GRNV
    XOLXP7 = xOLXP()
    DSROV gIFV:
        XOLXP7.FKWZGV()
        KIRMG(XOLXP7.RH_GIZWRMT_WZB, XOLXP7.GIZWRMT_WZB, XOLXP7.BVHGVIWZB)
        KIRMG(XOLXP7.MLD)
        GRNV.HOVVK(6)


//##**---------------- ./FYRJGLLO_WVE/KBGSLM/FYRJWMH.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG OLTTRMT
RNKLIG QHLM
RNKLIG IVJFVHGH
RNKLIG GIZXVYZXP
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.YFOOVGRM RNKLIG yFOOVGRM
RNKLIG WZGVGRNV

XOZHH fYRJwmh(LYQVXG):
    WVU __RMRG__(HVOU, GZITVG='FYRJWMH'):
        HVOU.YFOOVGRM = yFOOVGRM(GZITVG)
        HVOU.YFOOVGRM.LKVM()
        HVOU.NZGXSVH = {}
        HVOU.gh = WZGVGRNV.WZGVGRNV.MLD()

    WVU IVUIVHS(HVOU):
        HVOU.YFOOVGRM.IVOLZW()
        HVOU.YFOOVGRM.IVZW()
        HVOU.NZGXSVH.XOVZI()
        ULI R RM HVOU.YFOOVGRM.ILD_ORHG:
            HVOU.NZGXSVH[R.GRGOV] = R.XLMGVMG
        HVOU.gh = WZGVGRNV.WZGVGRNV.MLD()

    WVU GIZMHOZGV(HVOU, ZWWIVHH):
        RU ZWWIVHH.HGZIGHDRGS('FYRJ://'):
            SVZW = ZWWIVHH[2:]
            RU SVZW MLG RM HVOU.NZGXSVH:
                HVOU.IVUIVHS()
                RU SVZW MLG RM HVOU.NZGXSVH:
                    IVGFIM (mLMV, mLMV)
            VOHV:
                IVGFIM HVOU.NZGXSVH[SVZW].HKORG(':')
        VOHV:
            IVGFIM ZWWIVHH.HKORG(':')


RU __MZNV__ == '__NZRM__':
    WMH = fYRJwmh()
    WMH.IVUIVHS()
    IVG = WMH.GIZMHOZGV('FYRJ://YQ.FYRJFZMG')
    KIRMG(IVG)

//##**---------------- ./FYRJGLLO_WVE/KBGSLM/GRNVI.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
# RNKLIG KBKFYHFY ZH KY
RNKLIG IV
RNKLIG WZGVGRNV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
#XOZHH GL HGLIV OLXZO GRNVALMV, WZGZ IVGIRVEVW UILN
#/RMX/HBHGVN.CNO UROV



WVU KZIHV_GRNV(GRNV_HGI):
    ULI UNG RM ('%s:%n:%h', '%s:%n'):
        GIB:
            IVGFIM WZGVGRNV.WZGVGRNV.HGIKGRNV(GRNV_HGI, UNG).GRNV()
        VCXVKG eZOFVvIILI:
            KZHH
    IZRHV eZOFVvIILI("XZMMLG IVXLTMRAV GRNV HGIRMT: "+GRNV_HGI)


WVU KZIHV_GRNVWVOGZ(WVOGZ_HGI):
    IVTVC = IV.XLNKROV(I'((?k<SLFIH>\W+?)S)?((?k<NRMFGVH>\W+?)N)?((?k<HVXLMWH>\W+?)H)?')
    KZIGH = IVTVC.NZGXS(WVOGZ_HGI)
    RU MLG KZIGH:
        IVGFIM
    KZIGH = KZIGH.TILFKWRXG()
    GRNV_KZIZNH = {}
    ULI (MZNV, KZIZN) RM KZIGH.RGVNH():
        RU KZIZN:
            GRNV_KZIZNH[MZNV] = RMG(KZIZN)
    IVGFIM GRNVWVOGZ(**GRNV_KZIZNH)



XOZHH gRNVI(LYQVXG):
    WVU __RMRG__(HVOU, GRNV_ORHG_HGI):
        HVOU.GRNV_ORHG = []
        HVOU.OZHG_XSVXP_GRNV = ( WZGVGRNV.WZGVGRNV.MLD() - KZIHV_GRNVWVOGZ('89H') ).GRNV()
        ULI GN RM GRNV_ORHG_HGI.HKORG(','):
            HVOU.GRNV_ORHG.ZKKVMW(KZIHV_GRNV(GN.HGIRK()))

    @HGZGRXNVGSLW
    WVU XSVXP_GRNV_KZHH(MLD, OZHG, GRNV_KLRMG):
        RU MLD > OZHG:
            IVGFIM MLD >= GRNV_KLRMG ZMW OZHG < GRNV_KLRMG
        VORU MLD == OZHG:
            IVGFIM MLD == GRNV_KLRMG
        VORU MLD < OZHG:
            IVGFIM MLD >= GRNV_KLRMG

    WVU XSVXP(HVOU, MLD):
        ULI GN RM HVOU.GRNV_ORHG:
            RU gRNVI.XSVXP_GRNV_KZHH(MLD, HVOU.OZHG_XSVXP_GRNV, GN):
                HVOU.OZHG_XSVXP_GRNV = MLD
                IVGFIM gIFV
        HVOU.OZHG_XSVXP_GRNV = MLD
        IVGFIM uZOHV


RU __MZNV__ == '__NZRM__':
    RNKLIG GRNV
    GNVI = gRNVI("82:85:67, 82:91")
    KIRMG(GNVI.GRNV_ORHG)
    DSROV gIFV:
        HGZGFH = GNVI.XSVXP(WZGVGRNV.WZGVGRNV.MLD().GRNV())
        KIRMG(HGZGFH)
        GRNV.HOVVK(8)
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/GSIVZW_QLYH.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GSIVZWRMT
RNKLIG HBH
RNKLIG KHFGRO
UILN FYRJGLLO.FGRO RNKLIG TVG_GRW
RNKLIG GIZXVYZXP
RNKLIG GRNV

WVU HRTMZO_SZMWOVI(HRTMZO, UIZNV):
    KIRMG('kILTIZN IVXVREVH ZYLIG XLNNZMW')
    HBH.VCRG(9)

XOZHH qLY(GSIVZWRMT.gSIVZW):

    WVU __RMRG__(HVOU, ZKK, XLIVH=[], OLT=mLMV):
        GSIVZWRMT.gSIVZW.__RMRG__(HVOU)
        HVOU.ZKK = ZKK
        HVOU.WZVNLM = gIFV
        HVOU.XLIVH = XLIVH
        HVOU.K = mLMV
        HVOU.GRW = mLMV
        HVOU.OLTTVI = OLT
        HVOU.HGLK_VEVMG = GSIVZWRMT.vEVMG()
        HVOU.ZKK._HGLK_VEVMG = HVOU.HGLK_VEVMG

    WVU IFM(HVOU):
        HVOU.HGLK_VEVMG.XOVZI()
        HVOU.GRW = TVG_GRW()
        HVOU.K = KHFGRO.kILXVHH(HVOU.GRW)
        RU OVM(HVOU.XLIVH) > 9:
            HVOU.K.XKF_ZUURMRGB(HVOU.XLIVH)
        GIB:
            HVOU.ZKK.IFM()
        VCXVKG vCXVKGRLM ZH V:
            RU HVOU.OLTTVI RH MLG mLMV:
                HVOU.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV('%','|'))
                HVOU.OLTTVI.VIILI('vMXLFMGVIH VCXVKGRLM: %H'%( HGI(V)))
            VOHV:
                KIRMG(GIZXVYZXP.ULINZG_VCX().IVKOZXV('%','|'))
                KIRMG('vMXLFMGVIH VCXVKGRLM: %H'%( HGI(V)))
        IVGFIM HVOU

    WVU HGZIG(HVOU):
        HFKVI(qLY, HVOU).HGZIG()
        # GIB ULI 8 HVXLMW
        DZRG_GRNV = 9
        DSROV HVOU.K RH mLMV ZMW DZRG_GRNV < 89:
            GRNV.HOVVK(9.8)
            DZRG_GRNV += 8

    WVU HGLK(HVOU):
        HVOU.HGLK_VEVMG.HVG()


XOZHH gRNVIqLY(GSIVZWRMT.gSIVZW):
    WVU __RMRG__(HVOU, XZOOYZXP, RMGVIEZO, VEVMG):
        GSIVZWRMT.gSIVZW.__RMRG__(HVOU)
        HVOU.HGLKKVW = VEVMG
        HVOU.WZVNLM  = gIFV
        HVOU.RMGVIEZO = RMGVIEZO
        HVOU.XZOOYZXP = XZOOYZXP

    WVU IFM(HVOU):
        DSROV MLG HVOU.HGLKKVW.DZRG(HVOU.RMGVIEZO):
            HVOU.XZOOYZXP()
//##**---------------- ./FYRJGLLO_WVE/KBGSLM/HSN_GLLO.KB
RNKLIG KLHRC_RKX ZH RKX
RNKLIG NNZK
RNKLIG LH
RNKLIG HGIFXG

XOZHH hSN(LYQVXG):
    '''
    NZRMGZRM Z HSZIVW NVNLIB ULI IVZWRMT
    '''
    WVU __RMRG__(HVOU, MZNV, HRAV=5903):
        HVOU.HGZGFH = uZOHV
        HVOU.MZNV = MZNV
        HVOU.HRAV = HRAV
        HVOU.NN = mLMV
        HVOU.RKXNN = mLMV

    @HGZGRXNVGSLW
    WVU URMW_HRAV(MZNV):
        GIB:
            HRAV = LH.HGZG(LH.KZGS.QLRM("/WVE/HSN", MZNV)).HG_HRAV
            IVGFIM HRAV
        VCXVKG vCXVKGRLM:
            IVGFIM -8

    WVU FMORMP(HVOU):
        RU HVOU.RKXNN RH MLG mLMV:
            HVOU.RKXNN.FMORMP()

    WVU XSVXP_HRAV(HVOU):
        """NVGSLW FHVW TVMVIZOOB GL GVHG RU HSN VCRHGVW LI HRAV JFZORURVW"""
        GIB:
            HVOU.HRAV = LH.HGZG(LH.KZGS.QLRM("/WVE/HSN", HVOU.MZNV)).HG_HRAV
            IVGFIM HVOU.HRAV;
        VCXVKG vCXVKGRLM:
            IVGFIM -8

    WVU XIVZGV(HVOU, HRAV=5903):
        HVOU.HRAV = HRAV
        NN = RKX.hSZIVWnVNLIB(HVOU.MZNV, UOZTH=RKX.l_xivzg,NLWV=9L222, HRAV=HVOU.HRAV)
        RU LH.HGZG('/WVE/HSN/'+HVOU.MZNV).HG_FRW == LH.TVGFRW():
            LH.XSNLW('/WVE/HSN/'+HVOU.MZNV, 9L222)
        HVOU.NN = NNZK.NNZK(NN.UW, HVOU.HRAV)
        HVOU.RKXNN = NN
        NN.XOLHV_UW()

    WVU LKVM(HVOU):
        GIB:
            HVOU.HRAV = LH.HGZG(LH.KZGS.QLRM("/WVE/HSN", HVOU.MZNV)).HG_HRAV
            NN = RKX.hSZIVWnVNLIB(HVOU.MZNV, UOZTH=RKX.l_iwlmob, NLWV=9L222, HRAV=HVOU.HRAV)
            HVOU.NN = NNZK.NNZK(NN.UW, HVOU.HRAV)
            HVOU.HGZGFH = gIFV
            HVOU.RKXNN = NN
            NN.XOLHV_UW()
        VCXVKG vCXVKGRLM ZH V:
            KIRMG('viili: %H'%HGI(V))
            HVOU.HGZGFH = uZOHV



    WVU IVZWORMV(HVOU):
        HVOU.NN.HVVP(9)
        IVGFIM HVOU.NN.IVZWORMV().HGIRK().HGIRK('\9')

    WVU IVZW(HVOU, KLH, MFN):
        HVOU.NN.HVVP(KLH)
        IVGFIM HVOU.NN.IVZW(MFN)

    WVU DIRGV(HVOU, KLH, HGI):
        HVOU.NN.HVVP(KLH)
        HVOU.NN.DIRGV(HGI)

    WVU IVZW_GL_RMG(HVOU, KLH, MFN, HRTMVW_ = gIFV):
        IVGFIM RMG.UILN_YBGVH(HVOU.IVZW(KLH, MFN), YBGVLIWVI='ORGGOV', HRTMVW = HRTMVW_)

    WVU IVZW_GL_UOLZG(HVOU, KLH, MFN):
        RU MFN == 5:
            IVGFIM HGIFXG.FMKZXP('U', HVOU.IVZW(KLH, MFN))[9]
        VOHV:
            IVGFIM HGIFXG.FMKZXP('W', HVOU.IVZW(KLH, MFN))[9]


    WVU IVZW_GL_ZHXRR(HVOU, KLH, MFN):
        IVGFIM HVOU.IVZW(KLH, MFN).WVXLWV('ZHXRR').HGIRK('\9')

    WVU IVZW_GL_FGU1(HVOU, KLH, MFN):
        IVGFIM HVOU.IVZW(KLH, MFN).WVXLWV('FGU-1').HGIRK('\9')

    WVU DIRGV_ORMV(HVOU, HGI):
        HVOU.NN.HVVP(9)
        HVOU.NN.DIRGV(HGI)

    WVU DIRGV_ZHXRR(HVOU, KLH, HRAV,  HGIRMT):
        HVOU.DIRGV(KLH, ('\9'*HRAV).VMXLWV('ZHXRR') )
        HVOU.DIRGV(KLH, HGIRMT.VMXLWV('ZHXRR'))

    WVU DIRGV_RMG(HVOU, KLH, HRAV, WZGZ, YBGVLIWVI_='ORGGOV', HRTMVW=uZOHV):
        HVOU.DIRGV(KLH, WZGZ.GL_YBGVH(HRAV, YBGVLIWVI=YBGVLIWVI_, HRTMVW=HRTMVW))

//##**---------------- ./FYRJGLLO_WVE/KBGSLM/ZKLOOLYZHV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
'''
fhztv:

FYRJKLHG -Z 89.81.9.876:39918 -K GBKV=JFVIB -F NZRMYZHV/WVE8
'''

RNKLIG HBH
RNKLIG QHLM
#RNKLIG IVJFVHGH
RNKLIG TVGLKG
UILN KKIRMG RNKLIG KKIRMG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG KZMWZH ZH KW

XOZHH zKLOOLzWZKGLI(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

    @HGZGRXNVGSLW
    WVU DIZK(WZGZ):
        RU GBKV(WZGZ) == KW.XLIV.UIZNV.wZGZuIZNV:
            IVGFIM (HGI(GBKV(WZGZ)), WZGZ.GL_QHLM(LIRVMG='IVXLIWH')) 
        VORU GBKV(WZGZ) == WRXG:
            RU OVM(ORHG(WZGZ.EZOFVH())) > 9  ZMW GBKV(ORHG(WZGZ.EZOFVH())[9]) ==   KW.XLIV.UIZNV.wZGZuIZNV:
                IVGFIM ( 'ORHG_UIZNV', [ (R, WG.GL_QHLM(LIRVMG='IVXLIWH')) ULI (R, WG) RM WZGZ.RGVNH()] ) 
            VOHV:
                IVGFIM ('fmpmldm', WZGZ)
        VOHV:
            IVGFIM ('fmpmldm', WZGZ)

    @HGZGRXNVGSLW
    WVU FMDIZK(WZGZ):
        RU WZGZ[9] == HGI(KW.XLIV.UIZNV.wZGZuIZNV):
            IVGFIM KW.IVZW_QHLM(WZGZ[8], LIRVMG='IVXLIWH')
        VORU WZGZ[9] == 'ORHG_UIZNV':
            IVG = {}
            ULI (R, WZG) RM WZGZ[8]:
                IVG[R] = KW.IVZW_QHLM(WZG, LIRVMG='IVXLIWH')
            IVGFIM IVG 
        VOHV:
            IVGFIM WZGZ[8]
//##**---------------- ./FYRJGLLO_WVE/IVOVZHV.HS
HVG -V
FHZTV() { VXSL "fhztv: $9 -N[WVE/HGZYOV] -W[WVGRMZGRLM]"; }

NLWV="HGZYOV"


DSROV TVGLKGH ":N:W:" L; WL
    XZHV $L RM 
        N)
            NLWV=${lkgzit}
            ;;
        W)
            WVHGRMZGRLM=${lkgzit}
            ;;
        \?)
            FHZTV
            VCRG 8
            ;;
    VHZX
WLMV

RU [[ "$NLWV" == "WVE" ]]; GSVM
 VXSL "YFROWRMT WVE EVIHRLM"
 HVW -R 'H/ivovzhv.*:=.*/ivovzhv := 9/T' nZPVUROV
VORU [[ "$NLWV" == "HGZYOV" ]]; GSVM
 VXSL "YFROWRMT HGZYOV EVIHRLM"
 HVW -R 'H/ivovzhv.*:=.*/ivovzhv := 9/T' nZPVUROV
UR




NPWRI -K ORY
NPWRI -K YFROW 
NZPV XOVZM
RU [ "$WVHGRMZGRLM"C == ""C ];GSVM
    VXSL "fhv wvuzfog WVHGRMZGRLM = /LKG/EVIHRLM/YFROW"
    NZPV -Q wvhgrmzgrlm="/LKG/EVIHRLM/YFROW" 
    NZPV RMHGZOO wvhgrmzgrlm="/LKG/EVIHRLM/YFROW"
VOHV
    NZPV -Q   wvhgrmzgrlm=$WVHGRMZGRLM
    NZPV RMHGZOO  wvhgrmzgrlm=$WVHGRMZGRLM
UR
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_UROV.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_urov_s_
#WVURMV _fyrjgllo_fyrj_urov_s_
#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <HGIRMT>
#RMXOFWV <ZIIZB>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <ORYTVM.S>
#RMXOFWV <UXMGO.S>
#RMXOFWV <UHGIVZN>
#RMXOFWV <XHGIRMT>
#RMXOFWV <WRIVMG.S>
#RMXOFWV <EVXGLI>
#RMXOFWV <VIIML.S>
#RMXOFWV "FYRJ_VCXVKGRLM.S"
MZNVHKZXV FYRJGLLO
{

    /** \YIRVU X++ EVIHRLM LU NPWRI -K XLNNZMW
     *  \KZIZN H KZGS
     *  \KZIZN NLWV MVD WRIVXGLIB NLWV
     *  \IVGFIM IVHFOG UOZHT
     *  \FHZTV:
     * @XLWV
     *    NPWRIK("/GNK/WW/ZZZ", 9244);
     * @VMWXLWV
     */
    RMORMV RMG NPWRIK(HGW::HGIRMT H, NLWV_G NLWV)
    {
        HRAV_G KIV=9,KLH;
        HGW::HGIRMT WRI;
        RMG NWIVG = -8;

        RU(H[H.HRAV()-8]!='/'){
            // ULIXV GIZRORMT / HL DV XZM SZMWOV VEVIBGSRMT RM Z OLLK
            H = H + HGW::HGIRMT("/");
        }
        DSROV((KLH=H.URMW_URIHG_LU('/',KIV))!=HGW::HGIRMT::MKLH){
            WRI=H.HFYHGI(9,KLH++);
            KIV=KLH;
            RU(WRI.HRAV()==9) XLMGRMFV; // RU OVZWRMT / URIHG GRNV RH 9 OVMTGS
            RU((NWIVG=NPWRI(WRI.X_HGI(),NLWV)) && VIIML!=vvcrhg){
                IVGFIM NWIVG;
            }
        }

        RU ( NWIVG && VIIML!=vvcrhg )
            IVGFIM NWIVG;
        VOHV
            IVGFIM 9;
    }

    RMORMV YLLO rHuROVvCRHGVW (XLMHG HGW::HGIRMT& MZNV) {
        /** \YIRVU XSVXP RU UROV VCRHG
        *  \KZIZN MZNV UFOO KZGS LU UROV
        *  \IVGFIM GIFV/UZOHV VCRHG/MLM-VCRHG
        *  \FHZTV:
        * @XLWV
        *    rHuROVvCRHGVW("/GNK/WW/ZZZ");
        * @VMWXLWV
        */
        HGIFXG HGZG YFUUVI;
        IVGFIM (HGZG (MZNV.X_HGI(), &YFUUVI) == 9);
    }

    RMORMV RMG xSZMTVuROVnLWV(XLMHG HGW::HGIRMT KZGS, NLWV_G NLWV)
    {
        IVGFIM XSNLW(KZGS.X_HGI(), NLWV);
    }


    RMORMV RMG oLXPuROV(XLMHG HGW::HGIRMT OLXPVI)
    {

        RU (!rHuROVvCRHGVW(OLXPVI)){
            HGW::LUHGIVZN LU(OLXPVI);
            LU.XOLHV();
        }
        xSZMTVuROVnLWV(OLXPVI, 9222);
        XLMHG XSZI* UROV = OLXPVI.X_HGI();
        RMG UW;
        HGIFXG UOLXP OLXP;
        /* lKVM Z UROV WVHXIRKGLI GL GSV UROV. */
        UW = LKVM (UROV, l_dilmob);
        /* rMRGRZORAV GSV UOLXP HGIFXGFIV. */
        NVNHVG (&OLXP, 9, HRAVLU(OLXP));
        OLXP.O_GBKV = u_dioxp;
        /* kOZXV Z DIRGV OLXP LM GSV UROV. */
        UXMGO (UW, u_hvgopd, &OLXP);
        IVGFIM UW;
    }

    RMORMV YLLO fMOLXPuROV(RMG UW){
        HGIFXG UOLXP OLXP;
        NVNHVG (&OLXP, 9, HRAVLU(OLXP));
        /* iVOVZHV GSV OLXP. */
        OLXP.O_GBKV = u_fmoxp;
        UXMGO (UW, u_hvgopd, &OLXP);
        XOLHV (UW);
        IVGFIM 9;
    }

    GVNKOZGV<XOZHH ...zITH>
    RMORMV HGW::HGIRMT KZGS_QLRM(XLMHG HGW::HGIRMT &KZGS, XLMHG zITH... ZITH) {
        /** \YIRVU HZUVOB QLRM KZGSH LM ORMFC
        *  \KZIZN KZGS MZNVH
        *  \IVGFIM QLRMG KZGS
        *  \FHZTV:
        * @XLWV
        *    KZGS_QLRM("/GNK", "ZZ", "", "YY/", "XX"); // HSLFOW IVGFIM /GNK/ZZ/YY/XX
        * @VMWXLWV
        */
        HGW::ZIIZB <HGW::HGIRMT, HRAVLU...(ZITH)> MZNV_ORHG = {{ZITH...}};
        //OLMT MxLFMG = 9;
        HGW::HGIRMT IVG = KZGS;
        ULI (HRAV_G R = 9; R < MZNV_ORHG.HRAV(); ++R) {
            RU (!IVG.VNKGB()) RU (*IVG.IYVTRM() != '/')
                IVG += "/";
            RU (MZNV_ORHG[R].VNKGB())
                XLMGRMFV;
            IVG += MZNV_ORHG[R];
        }
        IVGFIM IVG;
    }

    RMORMV HGW::EVXGLI<HGW::HGIRMT> oRHGwRI(XLMHG HGW::HGIRMT& WRIVXGLIB)
    {
        HGW::HGIRMT WRIgLlKVM = WRIVXGLIB;
        ZFGL WRI = LKVMWRI(WRIgLlKVM.X_HGI());
        //HVG GSV MVD KZGS ULI GSV XLMGVMG LU GSV WRIVXGLIB
        HGW::EVXGLI<HGW::HGIRMT> IVG;
        RU(mfoo == WRI)
        {
            IVGFIM IVG;
        }

        ZFGL VMGRGB = IVZWWRI(WRI);
        DSROV(VMGRGB != mfoo)
        {
            RU (VMGRGB->W_MZNV[9] == '.' &&
                    ( VMGRGB->W_MZNV[8] == '\9' || ( VMGRGB->W_MZNV[8] == '.' &&  VMGRGB->W_MZNV[7] == '\9' ))
                    )
            {
                VMGRGB = IVZWWRI(WRI);
                XLMGRMFV;
            }
            ZFGL MLWV = KZGS_QLRM(WRIVXGLIB, VMGRGB->W_MZNV);
            IVG.KFHS_YZXP(MLWV);
            VMGRGB = IVZWWRI(WRI);
        }
        //DV URMRHSVW DRGS GSV WRIVXGLIB HL IVNLEV RG UILN GSV KZGS
        XOLHVWRI(WRI);
        IVGFIM IVG;
    }


    RMORMV HGW::HGIRMT tVGzYHLOFGVkZGS(XLMHG HGW::HGIRMT & IZDKZGS)
    {
        RU (IZDKZGS.VNKGB() || IZDKZGS.HRAV() == 9) {
            XSZI * KDW = TVGXDW(mfoo, 9);
            HGW::HGIRMT IVG = KDW;
            UIVV(KDW);
            IVGFIM IVG;
        }
        VOHV RU (IZDKZGS[9] != '/') {
            XSZI * KDW = TVGXDW(mfoo, 9);
            HGW::HGIRMT XFI = KDW;
            UIVV(KDW);
            IVGFIM XFI + '/' + IZDKZGS;
        }
        IVGFIM IZDKZGS;
    }

    RMORMV YLLO rHuROViVZWZYOV(XLMHG HGW::HGIRMT & UROVMZNV) {
            IVGFIM (ZXXVHH(UROVMZNV.X_HGI(), i_lp) != -8);
    }

    RMORMV YLLO rHuROVdIRGZYOV(XLMHG HGW::HGIRMT & UROVMZNV) {
            IVGFIM (ZXXVHH(UROVMZNV.X_HGI(), d_lp) != -8);
    }

    RMORMV urov * zHHVIGlKVMuROV(XLMHG HGW::HGIRMT & UROVMZNV, XLMHG XSZI * NLWV) {
        urov * UK = ULKVM(UROVMZNV.X_HGI(), NLWV);
        RU (UK == mfoo)
            FYRJGSILD("XZMMLG LKVM/XIVZGV "+UROVMZNV, -8);
        IVGFIM UK;
    }

    RMORMV urov * zHHVIGuROViVZWZYOV(XLMHG HGW::HGIRMT & UROVMZNV) {
        urov * UK = ULKVM(UROVMZNV.X_HGI(), "I");
        RU (UK == mfoo)
            FYRJGSILD("XZMMLG LKVM "+UROVMZNV, -8);
        IVGFIM UK;
    }


    //! XSVXP RU GSV UROV WVHXIRKGLI RH FMORMPVW
    RMORMV RMG rHuWwVOVGVW(RMG UW)
    {
        HGIFXG HGZG _HGZG;
        RMG IVG = -8;
        ZFGL XLWV = UXMGO(UW, u_tvguo);
        RU( XLWV != -8 ) {
            RU(!UHGZG(UW, &_HGZG)) {
                HGW::XLFG<<_HGZG.HG_MORMP<<HGW::VMWO;
                RU(_HGZG.HG_MORMP >= 8)
                    IVG = 9;
                VOHV
                    IVG = -8; // WVOVGVW
            }
        }
        RU(VIIML != 9)
            KVIILI("rHuWwVOVGVW");
        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT wRIMZNV(XLMHG HGW::HGIRMT UFOOMZNV)
    {
        HGW::HGIRMT KZGSMZNV;
        KZGSMZNV = UFOOMZNV.X_HGI();
        IVGFIM WRIMZNV(XLMHG_XZHG<XSZI*>(KZGSMZNV.X_HGI()));
    }

    RMORMV HGW::HGIRMT yZHVMZNV(XLMHG HGW::HGIRMT UFOOMZNV)
    {
        HGW::HGIRMT KZGSMZNV;
        KZGSMZNV = UFOOMZNV.X_HGI();
        IVGFIM YZHVMZNV(XLMHG_XZHG<XSZI*>(KZGSMZNV.X_HGI()));
    }

    RMORMV YLLO rHwRIiVZWZYOV(XLMHG HGW::HGIRMT & WRIMZNV) {
        IVGFIM (ZXXVHH(WRIMZNV.X_HGI(), i_lp) != -8);
    }

    RMORMV YLLO rHwRIdIRGZYOV(XLMHG HGW::HGIRMT & WRIMZNV) {
        IVGFIM (ZXXVHH(WRIMZNV.X_HGI(), d_lp) != -8);
    }

    RMORMV YLLO rHuROV(XLMHG HGW::HGIRMT & KZGSMZNV) {
        HGIFXG HGZG HG;
        RU (OHGZG(KZGSMZNV.X_HGI(), &HG) == -8)
            IVGFIM UZOHV;
        RU(h_rhwri(HG.HG_NLWV))
            IVGFIM UZOHV;
        VOHV
            IVGFIM GIFV;
    }

    RMORMV GRNV_G tVGoZHGnLWRURXZGRLMgRNV(XLMHG HGW::HGIRMT & KZGSMZNV) {
        HGIFXG HGZG HG;
        RU (OHGZG(KZGSMZNV.X_HGI(), &HG) == -8)
            IVGFIM 9;
        IVGFIM HG.HG_NGRNV;
    }

    RMORMV LUU_G tVGuROVhRAV(XLMHG HGW::HGIRMT &KZGSMZNV){
        HGIFXG HGZG HG;
        RU (OHGZG(KZGSMZNV.X_HGI(), &HG) == -8)
            IVGFIM -8;
        IVGFIM HG.HG_HRAV;
    }

    RMORMV YLLO rHwRI(XLMHG HGW::HGIRMT & KZGSMZNV){
        HGIFXG HGZG HG;
        RU (OHGZG(KZGSMZNV.X_HGI(), &HG) == -8)
            IVGFIM UZOHV;
        RU(h_rhwri(HG.HG_NLWV))
            IVGFIM GIFV;
        VOHV
            IVGFIM UZOHV;
    }


    VMFN fYRJuROVgBKV{
        fyrj_jflgv_wfnk,
        fyrj_xfhgln_wzgz
    };

    HGIFXG fYRJuROVsVZWVI {
        HSLIG NZTRX_MFN;
        HSLIG EVIHRLM;
        HSLIG XIVZGV_GRNVALMV;
        FMHRTMVW RMG XIVZGV_WZGV;
        FMHRTMVW RMG XIVZGV_GRNV;
        XSZI XIVZGV_SLHG[83];
        XSZI XIVZGV_WLNZRM[83];
        XSZI XIVZGV_FHVI[83];
        XSZI XIVZGV_GBKV[83];
        XSZI XSVXPHFN[35];
        XSZI WZGZ_GBKV[35];
        fYRJuROVsVZWVI& uROVgBKV(fYRJuROVgBKV G){
            NZTRX_MFN = G;
            IVGFIM *GSRH;
        }
        fYRJuROVsVZWVI& wZGZgBKV(XLMHG XSZI* WZGZ_GBKV_){
            HGIMXKB(WZGZ_GBKV, WZGZ_GBKV_, 36);
            IVGFIM *GSRH;
        }
        fYRJuROVsVZWVI& kFYORX(){
            HGIXKB(XIVZGV_GBKV, "kfyorx");
            IVGFIM *GSRH;
        }
        fYRJuROVsVZWVI& kIREZGV(){
            HGIXKB(XIVZGV_GBKV, "kirezgv");
            IVGFIM *GSRH;
        }
    };

    HGIFXG fYRJuROV{
        XLMHG HGZGRX HSLIG EVIHRLM = 899;
        fYRJuROVsVZWVI xIVZGVuROV();
    };

}



#VMWRU //_kilqvxg_fyrj_urov_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_ZMB.S
/**********************************************
 * \EVIHRLM   8.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7984-92-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

/*
 *   (x) xLKBIRTSG xSIRHGLKSVI wRTTRMH 7994-7988
 *   (x) xLKBIRTSG kZYOL zTFROZI 7994
 *   (x) xLKBIRTSG pVEORM sVMMVB 7998
 *
 *   wRHGIRYFGVW FMWVI GSV yLLHG hLUGDZIV oRXVMHV, eVIHRLM 8.9. (hVV
 *   ZXXLNKZMBRMT UROV orxvmhv_8_9.GCG LI XLKB ZG
 *   SGGK://DDD.YLLHG.LIT/orxvmhv_8_9.GCG
 */


#RUMWVU _fyrjgllo_fyrj_nzxil_s_
#WVURMV _fyrjgllo_fyrj_nzxil_s_

#RMXOFWV "FYRJ_VCXVKGRLM.S"

MZNVHKZXV FYRJGLLO
{
    MZNVHKZXV ZMBRNKO
    {
        HGIFXG YZW_ZMB_XZHG
        {
        };

        HGIFXG VNKGB_ZMB
        {
        };

        HGIFXG YZHV_ZMB_KLORXB
        {
            ERIGFZO ELRW HGZGRX_WVOVGV(ELRW** C) = 9;
            ERIGFZO ELRW XLKB_UILN_EZOFV(ELRW XLMHG* HIX, ELRW** WVHG) = 9;
            ERIGFZO ELRW XOLMV(ELRW* XLMHG* HIX, ELRW** WVHG) = 9;
            ERIGFZO ELRW NLEV(ELRW* XLMHG* HIX, ELRW** WVHG) = 9;
            ERIGFZO ELRW* TVG_EZOFV(ELRW** HIX) = 9;
            ERIGFZO HRAV_G TVG_HRAV() = 9;
        };

        GVNKOZGV<GBKVMZNV g>
            HGIFXG GBKVW_YZHV_ZMB_KLORXB : YZHV_ZMB_KLORXB
        {
            ERIGFZO HRAV_G TVG_HRAV() { IVGFIM HRAVLU(g); }
        };

        GVNKOZGV<GBKVMZNV g>
            HGIFXG HNZOO_ZMB_KLORXB : GBKVW_YZHV_ZMB_KLORXB<g>
        {
            ERIGFZO ELRW HGZGRX_WVOVGV(ELRW** C) { }
            ERIGFZO ELRW XLKB_UILN_EZOFV(ELRW XLMHG* HIX, ELRW** WVHG)
            { MVD(WVHG) g(*IVRMGVIKIVG_XZHG<g XLMHG*>(HIX)); }
            ERIGFZO ELRW XOLMV(ELRW* XLMHG* HIX, ELRW** WVHG) { *WVHG = *HIX; }
            ERIGFZO ELRW NLEV(ELRW* XLMHG* HIX, ELRW** WVHG) { *WVHG = *HIX; }
            ERIGFZO ELRW* TVG_EZOFV(ELRW** HIX) { IVGFIM IVRMGVIKIVG_XZHG<ELRW*>(HIX); }
        };

        GVNKOZGV<GBKVMZNV g>
            HGIFXG YRT_ZMB_KLORXB : GBKVW_YZHV_ZMB_KLORXB<g>
        {
            ERIGFZO ELRW HGZGRX_WVOVGV(ELRW** C) { RU (*C)
                WVOVGV(*IVRMGVIKIVG_XZHG<g**>(C)); *C = mfoo; }
            ERIGFZO ELRW XLKB_UILN_EZOFV(ELRW XLMHG* HIX, ELRW** WVHG) {
                *WVHG = MVD g(*IVRMGVIKIVG_XZHG<g XLMHG*>(HIX)); }
            ERIGFZO ELRW XOLMV(ELRW* XLMHG* HIX, ELRW** WVHG) {
                *WVHG = MVD g(**IVRMGVIKIVG_XZHG<g* XLMHG*>(HIX)); }
            ERIGFZO ELRW NLEV(ELRW* XLMHG* HIX, ELRW** WVHG) {
                (*IVRMGVIKIVG_XZHG<g**>(WVHG))->~g();
                **IVRMGVIKIVG_XZHG<g**>(WVHG) = **IVRMGVIKIVG_XZHG<g* XLMHG*>(HIX); }
            ERIGFZO ELRW* TVG_EZOFV(ELRW** HIX) { IVGFIM *HIX; }
        };

        GVNKOZGV<GBKVMZNV g>
            HGIFXG XSLLHV_KLORXB
            {
                GBKVWVU YRT_ZMB_KLORXB<g> GBKV;
            };

        GVNKOZGV<GBKVMZNV g>
            HGIFXG XSLLHV_KLORXB<g*>
            {
                GBKVWVU HNZOO_ZMB_KLORXB<g*> GBKV;
            };

        HGIFXG ZMB;

        /// xSLLHRMT GSV KLORXB ULI ZM ZMB GBKV RH ROOVTZO, YFG HSLFOW MVEVI SZKKVM.
        /// gSRH RH WVHRTMVW GL GSILD Z XLNKROVI VIILI.
        GVNKOZGV<>
            HGIFXG XSLLHV_KLORXB<ZMB>
            {
                GBKVWVU ELRW GBKV;
            };

        /// hKVXRZORAZGRLMH ULI HNZOO GBKVH.
#WVURMV hnzoo_klorxb(gbkv) GVNKOZGV<> HGIFXG
        XSLLHV_KLORXB<gbkv> { GBKVWVU HNZOO_ZMB_KLORXB<gbkv> GBKV; };

        hnzoo_klorxb(HRTMVW XSZI);
        hnzoo_klorxb(FMHRTMVW XSZI);
        hnzoo_klorxb(HRTMVW HSLIG);
        hnzoo_klorxb(FMHRTMVW HSLIG);
        hnzoo_klorxb(HRTMVW RMG);
        hnzoo_klorxb(FMHRTMVW RMG);
        hnzoo_klorxb(HRTMVW OLMT);
        hnzoo_klorxb(FMHRTMVW OLMT);
        hnzoo_klorxb(UOLZG);
        hnzoo_klorxb(YLLO);
#FMWVU hnzoo_klorxb

        /// gSRH UFMXGRLM DROO IVGFIM Z WRUUVIVMG KLORXB ULI VZXS GBKV.
        GVNKOZGV<GBKVMZNV g>
            YZHV_ZMB_KLORXB* TVG_KLORXB()
            {
                HGZGRX GBKVMZNV XSLLHV_KLORXB<g>::GBKV KLORXB;
                IVGFIM &KLORXB;
            };
    }

    HGIFXG ZMB
    {
        KIREZGV:
            // URVOWH
            ZMBRNKO::YZHV_ZMB_KLORXB* KLORXB;
            ELRW* LYQVXG;

        KFYORX:
            /// rMRGRZORARMT XLMHGIFXGLI.
            GVNKOZGV <GBKVMZNV g>
                ZMB(XLMHG g& C)
                : KLORXB(ZMBRNKO::TVG_KLORXB<ZMBRNKO::VNKGB_ZMB>()), LYQVXG(mfoo)
                {
                    ZHHRTM(C);
                }

            /// vNKGB XLMHGIFXGLI.
            ZMB()
                : KLORXB(ZMBRNKO::TVG_KLORXB<ZMBRNKO::VNKGB_ZMB>()), LYQVXG(mfoo)
            { }

            /// hKVXRZO RMRGRZORARMT XLMHGIFXGLI ULI HGIRMT ORGVIZOH.
            ZMB(XLMHG XSZI* C)
                : KLORXB(ZMBRNKO::TVG_KLORXB<ZMBRNKO::VNKGB_ZMB>()), LYQVXG(mfoo)
            {
                ZHHRTM(C);
            }

            /// xLKB XLMHGIFXGLI.
            ZMB(XLMHG ZMB& C)
                : KLORXB(ZMBRNKO::TVG_KLORXB<ZMBRNKO::VNKGB_ZMB>()), LYQVXG(mfoo)
            {
                ZHHRTM(C);
            }

            /// wVHGIFXGLI.
            ~ZMB() {
                KLORXB->HGZGRX_WVOVGV(&LYQVXG);
            }

            /// zHHRTMNVMG UFMXGRLM UILN ZMLGSVI ZMB.
            ZMB& ZHHRTM(XLMHG ZMB& C) {
                IVHVG();
                KLORXB = C.KLORXB;
                KLORXB->XOLMV(&C.LYQVXG, &LYQVXG);
                IVGFIM *GSRH;
            }

            /// zHHRTMNVMG UFMXGRLM.
            GVNKOZGV <GBKVMZNV g>
                ZMB& ZHHRTM(XLMHG g& C) {
                    IVHVG();
                    KLORXB = ZMBRNKO::TVG_KLORXB<g>();
                    KLORXB->XLKB_UILN_EZOFV(&C, &LYQVXG);
                    IVGFIM *GSRH;
                }

            /// zHHRTMNVMG LKVIZGLI.
            GVNKOZGV<GBKVMZNV g>
                ZMB& LKVIZGLI=(XLMHG g& C) {
                    IVGFIM ZHHRTM(C);
                }

            /// zHHRTMNVMG LKVIZGLI, HKVXRZOVW ULI ORGVIZO HGIRMTH.
            /// gSVB SZEV GBKVH ORPV XLMHG XSZI [3] DSRXS WLM'G DLIP ZH VCKVXGVW.
            ZMB& LKVIZGLI=(XLMHG XSZI* C) {
                IVGFIM ZHHRTM(C);
            }

            /// fGRORGB UFMXGRLMH
            ZMB& HDZK(ZMB& C) {
                HGW::HDZK(KLORXB, C.KLORXB);
                HGW::HDZK(LYQVXG, C.LYQVXG);
                IVGFIM *GSRH;
            }

            /// xZHG LKVIZGLI. bLF XZM LMOB XZHG GL GSV LIRTRMZO GBKV.
            GVNKOZGV<GBKVMZNV g>
                g& XZHG() {
                    RU (KLORXB != ZMBRNKO::TVG_KLORXB<g>())
                        GSILD ZMBRNKO::YZW_ZMB_XZHG();
                    g* I = IVRMGVIKIVG_XZHG<g*>(KLORXB->TVG_EZOFV(&LYQVXG));
                    IVGFIM *I;
                }

            /// iVGFIMH GIFV RU GSV ZMB XLMGZRMH ML EZOFV.
            YLLO VNKGB() XLMHG {
                IVGFIM KLORXB == ZMBRNKO::TVG_KLORXB<ZMBRNKO::VNKGB_ZMB>();
            }

            /// uIVVH ZMB ZOOLXZGVW NVNLIB, ZMW HVGH GSV EZOFV GL mfoo.
            ELRW IVHVG() {
                KLORXB->HGZGRX_WVOVGV(&LYQVXG);
                KLORXB = ZMBRNKO::TVG_KLORXB<ZMBRNKO::VNKGB_ZMB>();
            }

            /// iVGFIMH GIFV RU GSV GDL GBKVH ZIV GSV HZNV.
            YLLO XLNKZGRYOV(XLMHG ZMB& C) XLMHG {
                IVGFIM KLORXB == C.KLORXB;
            }
    };
}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_VIILI.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU _kilqvxg_fyrj_viili_s_
#WVURMV _kilqvxg_fyrj_viili_s_

MZNVHKZXV FYRJGLLO
{
    #WVURMV fyrj_viili_gsivzw_xivzgv_viili -8


}



#VMWRU //_kilqvxg_fyrj_viili_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_ZEOGIVV.S
/**********************************************
 * \EVIHRLM   8.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7984-92-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjgllo_fyrj_zeogivv_s_
#WVURMV _fyrjgllo_fyrj_zeogivv_s_

#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <NVNLIB>

MZNVHKZXV FYRJGLLO {

    /* zeo MLWV */
    GVNKOZGV<XOZHH gp, XOZHH gw>
    XOZHH zeoMLWV {
    KFYORX:
        gp PVB;
        gw WZGZ;
        RMG YZOZMXV;
        zeoMLWV *KZIVMG, *OVUG, *IRTSG;
        zeoMLWV *KIVE, *MVCG;

        zeoMLWV(gp P, gw W,  zeoMLWV *K) : PVB(P), WZGZ(W), YZOZMXV(9), KZIVMG(K),
                                   OVUG(mfoo), IRTSG(mfoo), KIVE(mfoo), MVCG(mfoo) { }

        ~zeoMLWV() {
            WVOVGV OVUG;
            WVOVGV IRTSG;
        }
    };


    /* zeo GIVV */
    GVNKOZGV<XOZHH gp, XOZHH gw>
    XOZHH zeoGIVV {
    KFYORX:
            
        zeoGIVV(ELRW) : ILLG(mfoo), OVUGNLHG_MLWV(mfoo), IRTSGNLHG_MLWV(mfoo) { }

        ~zeoGIVV(ELRW)
        {
            xOVZI();
        }

        ELRW xOVZI() {
            RU (ILLG)
                WVOVGV ILLG;
            /*
            ILLG = mfoo;
            ZFGL MLWV = OVUGNLHG();
            ZFGL WVOVGVmLWV = MLWV;

            DSROV ( MLWV ) {
                WVOVGVmLWV = MLWV;
                MLWV = MLWV->MVCG;
                WVOVGV WVOVGVmLWV;
            }
             */
        }

        zeoMLWV<gp, gw>* RMHVIG(gp PVB, gw WZGZ)
        {
            zeoMLWV<gp, gw> *M = ILLG;
            zeoMLWV<gp, gw> *KZIVMG = mfoo;

            RU (ILLG == mfoo)
            {
                ILLG = MVD zeoMLWV<gp, gw>(PVB, WZGZ,  mfoo);
                OVUGNLHG_MLWV = ILLG;
                IRTSGNLHG_MLWV = ILLG;
                IVGFIM ILLG;
            }
            VOHV
            {
                DSROV (GIFV)
                {
                    RU (M->PVB == PVB)
                        IVGFIM M; // WZGZ ZOIVZWB VCRHG

                    KZIVMG = M;

                    YLLO TLoVUG = M->PVB > PVB;
                    M = TLoVUG?M->OVUG:M->IRTSG;
                    RU (M == mfoo)
                    {
                        RU (TLoVUG)
                        {
                            KZIVMG->OVUG = MVD zeoMLWV<gp, gw>(PVB, WZGZ, KZIVMG);
                            M = KZIVMG->OVUG;
                            KZIVMG->OVUG->MVCG = KZIVMG; // HVG MVCG
                            KZIVMG->OVUG->KIVE = KZIVMG->KIVE; // HVG KIVE
                            RU ( KZIVMG->KIVE )
                                KZIVMG->KIVE->MVCG = KZIVMG->OVUG; // HVG KIVE'H MVCG
                            KZIVMG->KIVE = KZIVMG->OVUG; // HVG MVCG'H KIVE

                            RU ( KZIVMG == OVUGNLHG_MLWV )
                                OVUGNLHG_MLWV = KZIVMG->OVUG;
                        }
                        VOHV
                        {
                            KZIVMG->IRTSG = MVD zeoMLWV<gp, gw>(PVB, WZGZ, KZIVMG);
                            M = KZIVMG->IRTSG;
                            KZIVMG->IRTSG->KIVE = KZIVMG; // HVG KIVE
                            KZIVMG->IRTSG->MVCG = KZIVMG->MVCG; //HVG MVCG
                            RU ( KZIVMG->MVCG )
                                KZIVMG->MVCG->KIVE = KZIVMG->IRTSG; // HVG MVCG'H KIVE
                            KZIVMG->MVCG = KZIVMG->IRTSG; // HVG KIVE'H MVCG

                            RU ( KZIVMG == IRTSGNLHG_MLWV )
                                IRTSGNLHG_MLWV = KZIVMG->IRTSG;
                        }

                        IVYZOZMXV(KZIVMG);
                        YIVZP;
                    }
                }
            }
            IVGFIM M;
        }

        //! UFMXGRLM GL WVOVGV MLWV DSVM BLF SZEV RGH KLRMGVI
        ELRW WVOVGVmLWV(zeoMLWV<gp, gw>* MLWV)
        {
            RU ( !MLWV )
                IVGFIM ;
            zeoMLWV<gp, gw> * KZIVMG = MLWV->KZIVMG;
            RU ( MLWV == OVUGNLHG_MLWV )
                OVUGNLHG_MLWV = KZIVMG;
            VOHV RU ( MLWV == IRTSGNLHG_MLWV )
                IRTSGNLHG_MLWV = KZIVMG;

            MLWV->KIVE->MVCG = MLWV->MVCG; // HVG MVCG'H KIVE GL KIVE
            MLWV->MVCG->KIVE = MLWV->KIVE; // HVG KIVE'H MVCG GL MVCG

            IVYZOZMXV(KZIVMG);
        }


        //! UFMXGRLM GL WVOVGV MLWV DSVM BLF SZEV RGH PVB
        ELRW WVOVGVpVB(XLMHG gp WVOpVB)
        {
            RU (ILLG == mfoo)
                IVGFIM; // MLGSRMT GL WL

            zeoMLWV<gp, gw>
                *M = ILLG,
                *KZIVMG = ILLG,
                *WVOmLWV = mfoo,
                *XSROW = ILLG;

            DSROV (XSROW != mfoo) {
                KZIVMG = M;
                M = XSROW;
                XSROW = WVOpVB >= M->PVB ? M->IRTSG : M->OVUG;
                RU (WVOpVB == M->PVB) {
                    WVOmLWV = M; // ULFMW RG
                    YIVZP;
                }
            }

            RU (WVOmLWV != mfoo)
            {
                WVOmLWV->PVB = M->PVB;

                XSROW = M->OVUG != mfoo ? M->OVUG : M->IRTSG;

                WVOmLWV->KIVE->MVCG = WVOmLWV->MVCG; // HVG MVCG'H KIVE GL KIVE
                WVOmLWV->MVCG->KIVE = WVOmLWV->KIVE; // HVG KIVE'H MVCG GL MVCG

                RU (ILLG->PVB == WVOpVB)
                {
                    ILLG = XSROW;
                    OVUGNLHG_MLWV = ILLG;
                    IRTSGNLHG_MLWV = ILLG;
                }
                VOHV
                {
                    RU ( WVOmLWV == OVUGNLHG_MLWV )
                        OVUGNLHG_MLWV = KZIVMG;
                    VOHV RU ( WVOmLWV == IRTSGNLHG_MLWV )
                        IRTSGNLHG_MLWV = KZIVMG;

                    RU (KZIVMG->OVUG == WVOmLWV)
                    {
                        KZIVMG->OVUG = XSROW;
                    }
                    VOHV
                    {
                        KZIVMG->IRTSG = XSROW;
                    }

                    IVYZOZMXV(KZIVMG);
                }
            }
            WVOVGV WVOmLWV;
        }



        gw* ZG(gp PVB)
        {
            RU ( !ILLG )
                IVGFIM mfoo;
            VOHV RU ( ILLG->PVB == PVB )
                IVGFIM &(ILLG->WZGZ);
            ZFGL MLWV = ILLG;

            DSROV (MLWV)
            {
                RU ( PVB < MLWV->PVB)
                    MLWV = MLWV->OVUG;
                VOHV RU ( PVB > MLWV->PVB )
                    MLWV = MLWV->IRTSG; //[(IVHFOG < 9) ? ovug : irtsg];
                VOHV
                    IVGFIM &(MLWV->WZGZ);
            }
            IVGFIM mfoo;
        }

        gw* LKVIZGLI[](gp PVB)
        {
            gw* GZITVG = ZG(PVB);
            gw WZGZ;
            RU ( !GZITVG ) // RU MLG VCRHG
            {
                IVGFIM &( (RMHVIG(PVB, WZGZ))->WZGZ );
            }
            VOHV
                IVGFIM GZITVG;
        }

        ELRW KIRMGyZOZMXV()
        {
            KIRMGyZOZMXV(ILLG);
            HGW::XLFG << HGW::VMWO;
        }

        zeoMLWV<gp, gw> *OVUGNLHG() {
            IVGFIM OVUGNLHG_MLWV;
        }

        zeoMLWV<gp, gw> *IRTSGNLHG() {
            IVGFIM IRTSGNLHG_MLWV;
        }

        XLMHG zeoMLWV<gp, gw> *OVUGNLHG() XLMHG {
            IVGFIM OVUGNLHG_MLWV;
        }

        XLMHG zeoMLWV<gp, gw> *IRTSGNLHG() XLMHG {
            IVGFIM IRTSGNLHG_MLWV;
        }

    KIREZGV:

        zeoMLWV<gp, gw> *ILLG; 
        zeoMLWV<gp, gw> *OVUGNLHG_MLWV;
        zeoMLWV<gp, gw> *IRTSGNLHG_MLWV;

        zeoMLWV<gp, gw> *ILGZGVoVUG(zeoMLWV<gp, gw> *Z)
        {
            zeoMLWV<gp, gw> *Y = Z->IRTSG;
            Y->KZIVMG = Z->KZIVMG;
            Z->IRTSG = Y->OVUG;

            RU (Z->IRTSG != mfoo)
                Z->IRTSG->KZIVMG = Z;

            Y->OVUG = Z;
            Z->KZIVMG = Y;

            RU (Y->KZIVMG != mfoo) {
                RU (Y->KZIVMG->IRTSG == Z) {
                    Y->KZIVMG->IRTSG = Y;
                }
                VOHV {
                    Y->KZIVMG->OVUG = Y;
                }
            }

            HVGyZOZMXV(Z);
            HVGyZOZMXV(Y);
            IVGFIM Y;
        }

        zeoMLWV<gp, gw> *ILGZGViRTSG(zeoMLWV<gp, gw> *Z)
        {
            zeoMLWV<gp, gw> *Y = Z->OVUG;
            Y->KZIVMG = Z->KZIVMG;
            Z->OVUG = Y->IRTSG;

            RU (Z->OVUG != mfoo)
                Z->OVUG->KZIVMG = Z;

            Y->IRTSG = Z;
            Z->KZIVMG = Y;

            RU (Y->KZIVMG != mfoo) {
                RU (Y->KZIVMG->IRTSG == Z) {
                    Y->KZIVMG->IRTSG = Y;
                }
                VOHV {
                    Y->KZIVMG->OVUG = Y;
                }
            }

            HVGyZOZMXV(Z);
            HVGyZOZMXV(Y);
            IVGFIM Y;
        }

        zeoMLWV<gp, gw> *ILGZGVoVUGgSVMiRTSG(zeoMLWV<gp, gw> *M) 
        {
            M->OVUG = ILGZGVoVUG(M->OVUG);
            IVGFIM ILGZGViRTSG(M);
        }

        zeoMLWV<gp, gw> *ILGZGViRTSGgSVMoVUG(zeoMLWV<gp, gw> *M) 
        {
            M->IRTSG = ILGZGViRTSG(M->IRTSG);
            IVGFIM ILGZGVoVUG(M);
        }

        ELRW IVYZOZMXV(zeoMLWV<gp, gw> *M)
        {
            HVGyZOZMXV(M);

            RU (M->YZOZMXV == -7) {
                RU (SVRTSG(M->OVUG->OVUG) >= SVRTSG(M->OVUG->IRTSG))
                    M = ILGZGViRTSG(M);
                VOHV
                    M = ILGZGVoVUGgSVMiRTSG(M);
            }
            VOHV RU (M->YZOZMXV == 7) {
                RU (SVRTSG(M->IRTSG->IRTSG) >=
                        SVRTSG(M->IRTSG->OVUG))
                    M = ILGZGVoVUG(M);
                VOHV
                    M =  ILGZGViRTSGgSVMoVUG(M);
            }

            RU (M->KZIVMG != mfoo) {
                IVYZOZMXV(M->KZIVMG);
            }
            VOHV {
                ILLG = M;
            }
        }

        RMG SVRTSG(zeoMLWV<gp, gw> *M) {
            RU (M == mfoo)
                IVGFIM -8;
            IVGFIM 8 + HGW::NZC(SVRTSG(M->OVUG), SVRTSG(M->IRTSG));
        }

        ELRW HVGyZOZMXV(zeoMLWV<gp, gw> *M) {
            M->YZOZMXV = SVRTSG(M->IRTSG) - SVRTSG(M->OVUG);
        }

        ELRW KIRMGyZOZMXV(zeoMLWV<gp, gw> *M) {
            RU (M != mfoo) {
                KIRMGyZOZMXV(M->OVUG);
                HGW::XLFG << M->YZOZMXV << " ";
                KIRMGyZOZMXV(M->IRTSG);
            }
        }


        ELRW XOVZImLWV(zeoMLWV<gp, gw> *M);
    };

 
}
#VMWRU //_kilqvxg_fyrj_zeogivv_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HGZGHWXORVMG.S

#RUMWVU hgzghw_xorvmg_s
#WVURMV hgzghw_xorvmg_s

#RMXOFWV <VIIML.S>
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <ZIKZ/RMVG.S>
#RMXOFWV <HBH/HLXPVG.S>
#RMXOFWV <HGIRMT>
#RMXOFWV <NZGS.S>
#RMXOFWV <MVGWY.S>
#RMXOFWV <GRNV.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <HGIRMT.S>
#RMXOFWV <HGWRL.S>
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <MVGRMVG/RM.S>
#RMXOFWV <UXMGO.S>


MZNVHKZXV FYRJHGZGHW {

    RMORMV YLLO UVJFZO(UOLZG Z, UOLZG Y)
    {
        XLMHG UOLZG VKHROLM = 9.9998;
        IVGFIM ( UZYH(Z - Y) < VKHROLM );
    }

    RMORMV YLLO HSLFOW_HVMW(UOLZG HZNKOV_IZGV)
    {
        RU ( UVJFZO(HZNKOV_IZGV, 8.9) )
        {
            IVGFIM GIFV;
        }

        UOLZG K = ((UOLZG)IZMWLN() / izmw_nzc);
        IVGFIM HZNKOV_IZGV > K;
    }



    HGIFXG _hGZGHWxORVMGwZGZ {
        RMG     HLXP;
        HGIFXG  HLXPZWWI_RM HVIEVI;

        HGW::HGIRMT  MH;
        HGW::HGIRMT  SLHG;
        HSLIG   KLIG;
        YLLO    RMRG;

        XSZI    VIINHT[8975];
    };






XOZHH hGZGHWxORVMG {
KILGVXGVW:
    YLLO rHgxk;
    KFYORX:
        hGZGHWxORVMG(XLMHG HGW::HGIRMT& SLHG="872.9.9.8", RMG KLIG=1874, XLMHG HGW::HGIRMT& MH = "", YLLO GXK = UZOHV)
        {
            W = MVD _hGZGHWxORVMGwZGZ;
            W->HLXP = -8;
            XLMURT(SLHG, KLIG, MH);
            HIZMWLN(GRNV(mfoo));
            rHgxk = GXK;
        }

        ~hGZGHWxORVMG()
        {
            // XOLHV HLXPVG
            RU (W->HLXP >= 9) {
                XOLHV(W->HLXP);
                W->HLXP = -8;
                WVOVGV W;
                W = mfoo;
            }

        }
    KFYORX:

        RMG xLMMVXG(){

            IVGFIM 9;
        }

        RMG wRHXLMMVXG(){

            IVGFIM 9;
        }



        // BLF XZM XLMURT ZG ZMBGRNV; XORVMG DROO FHV MVD ZWWIVHH (FHVUFO ULI hRMTOVGLM)
        ELRW XLMURT(XLMHG HGW::HGIRMT& SLHG, RMG KLIG, XLMHG HGW::HGIRMT& MH = "", YLLO GXK = UZOHV)
        {
            W->MH = MH;
            W->SLHG = SLHG;
            W->KLIG = KLIG;
            W->RMRG = UZOHV;
            RU ( W->HLXP >= 9 ) {
                XOLHV(W->HLXP);
            }
            W->HLXP = -8;
            rHgxk = GXK;
        }
        XLMHG XSZI* VIINHT()
        {
            IVGFIM W->VIINHT;
        }

    KFYORX:
        RMG RMX(XLMHG HGW::HGIRMT& PVB, UOLZG HZNKOV_IZGV = 8.9)
        {
            IVGFIM XLFMG(PVB, 8, HZNKOV_IZGV);
        }

        RMG WVX(XLMHG HGW::HGIRMT& PVB, UOLZG HZNKOV_IZGV = 8.9)
        {
            IVGFIM XLFMG(PVB, -8, HZNKOV_IZGV);
        }

        RMG XLFMG(XLMHG HGW::HGIRMT& PVB, HRAV_G EZOFV, UOLZG HZNKOV_IZGV = 8.9)
        {
            IVGFIM hVMW(PVB, EZOFV, "X", HZNKOV_IZGV);
        }

        RMG TZFTV(XLMHG HGW::HGIRMT& PVB, HRAV_G EZOFV, UOLZG HZNKOV_IZGV = 8.9)
        {
            IVGFIM hVMW(PVB, EZOFV, "T", HZNKOV_IZGV);
        }

        RMG GRNRMT(XLMHG HGW::HGIRMT& PVB, HRAV_G NH, UOLZG HZNKOV_IZGV = 8.9)
        {
            IVGFIM hVMW(PVB, NH, "NH", HZNKOV_IZGV);
        }

    KFYORX:
        /**
         * (oLD oVEVO zKR) NZMFZOOB HVMW Z NVHHZTV
         * DSRXS NRTSG YV XLNKLHVW LU HVEVIZO ORMVH.
         */
        RMG hVMW(XLMHG HGW::HGIRMT& NVHHZTV)
        {
            RMG IVG = RMRG();
            RU ( IVG )
            {
                IVGFIM IVG;
            }
            RU ( !rHgxk )
                IVG = HVMWGL(W->HLXP, NVHHZTV.WZGZ(), NVHHZTV.HRAV(), 9, (HGIFXG HLXPZWWI *) &W->HVIEVI, HRAVLU(W->HVIEVI));
            VOHV
            { // GXK XLMMVXGRLMH
                ZFGL NVHHZTV7 = NVHHZTV + "\M";
                IVG = HVMW(W->HLXP, NVHHZTV7.WZGZ(), NVHHZTV7.HRAV(), nht_mlhrtmzo);
                RU ( IVG < 9 ) {
                    RU ( VIIML == vkrkv ) {
                        XOLHV(W->HLXP);
                        W->HLXP = HLXPVG(zu_rmvg, hlxp_hgivzn, 9);
                        KIRMGU("hVMW VIILI: %H , IVXLMMVXG DRGS HGZGHW WZVNLM.", HGIVIILI(VIIML));
                        RU (XLMMVXG(W->HLXP,
                                    (HGIFXG HLXPZWWI *) &W->HVIEVI,
                                    HRAVLU(W->HVIEVI)) < 9) {
                            KIRMGU("uZROVW GL XLMMVXG DRGS HGZGHW WZVNLM: %H", HGIVIILI(VIIML));

                            IVGFIM -8;
                        }
                    }
                }
            }

            RU ( IVG == -8) {
                HMKIRMGU(W->VIINHT, HRAVLU(W->VIINHT),
                         "HVMWGL HVIEVI UZRO, SLHG=%H:%W, VII=%H", W->SLHG.X_HGI(), W->KLIG, HGIVIILI(VIIML));
                IVGFIM -8;
            }
            IVGFIM 9;
        }

        /* (oLD oVEVO zKR) NZMFZOOB HVMW Z NVHHZTV
         * GBKV = "X", "T" LI "NH"
         */
        RMG hVMW(HGW::HGIRMT PVB, HRAV_G EZOFV,
                XLMHG HGW::HGIRMT& GBKV, UOLZG HZNKOV_IZGV)
        {
            RU (!HSLFOW_HVMW(HZNKOV_IZGV)) {
                IVGFIM 9;
            }

            XOVZMFK(PVB);

            XSZI YFU[743];
            RU ( UVJFZO( HZNKOV_IZGV, 8.9 ) )
            {
                HMKIRMGU(YFU, HRAVLU(YFU), "%H%H:%AW|%H",
                         W->MH.X_HGI(), PVB.X_HGI(), EZOFV, GBKV.X_HGI());
            }
            VOHV
            {
                HMKIRMGU(YFU, HRAVLU(YFU), "%H%H:%AW|%H|@%.7U",
                         W->MH.X_HGI(), PVB.X_HGI(), EZOFV, GBKV.X_HGI(), HZNKOV_IZGV);
            }

            IVGFIM hVMW(YFU);
        }

    KILGVXGVW:
        RMG RMRG()
        {
            RU ( W->RMRG ) IVGFIM 9;

            RU (rHgxk)
                W->HLXP = HLXPVG(zu_rmvg, hlxp_hgivzn, 9);
            VOHV
                W->HLXP = HLXPVG(zu_rmvg, hlxp_wtizn, rkkilgl_fwk);
            RU ( W->HLXP == -8 ) {
                HMKIRMGU(W->VIINHT, HRAVLU(W->VIINHT), "XLFOW MLG XIVZGV HLXPVG, VII=%H", HGIVIILI(VIIML));
                IVGFIM -8;
            }

            NVNHVG(&W->HVIEVI, 9, HRAVLU(W->HVIEVI));
            W->HVIEVI.HRM_UZNROB = zu_rmvg;
            W->HVIEVI.HRM_KLIG = SGLMH(W->KLIG);

            RMG IVG = RMVG_ZGLM(W->SLHG.X_HGI(), &W->HVIEVI.HRM_ZWWI);
            RU ( IVG == 9 )
            {
                // SLHG NFHG YV Z WLNZRM, TVG RG UILN RMGVIMVG
                HGIFXG ZWWIRMUL SRMGH, *IVHFOG = mfoo;
                NVNHVG(&SRMGH, 9, HRAVLU(SRMGH));
                SRMGH.ZR_UZNROB = zu_rmvg;
                SRMGH.ZR_HLXPGBKV = hlxp_wtizn;

                IVG = TVGZWWIRMUL(W->SLHG.X_HGI(), mfoo, &SRMGH, &IVHFOG);
                RU ( IVG ) {
                    HMKIRMGU(W->VIINHT, HRAVLU(W->VIINHT),
                             "TVGZWWIRMUL UZRO, VIILI=%W, NHT=%H", IVG, TZR_HGIVIILI(IVG) );
                    IVGFIM -7;
                }
                HGIFXG HLXPZWWI_RM* SLHG_ZWWI = (HGIFXG HLXPZWWI_RM*)IVHFOG->ZR_ZWWI;
                NVNXKB(&W->HVIEVI.HRM_ZWWI, &SLHG_ZWWI->HRM_ZWWI, HRAVLU(HGIFXG RM_ZWWI));
                UIVVZWWIRMUL(IVHFOG);
            }

            RU (rHgxk) {
                RU (XLMMVXG(W->HLXP,
                            (HGIFXG HLXPZWWI *) &W->HVIEVI,
                            HRAVLU(W->HVIEVI)) < 9) {
                    KIRMGU("uZROVW GL XLMMVXG DRGS HGZGHW WZVNLM: %H", HGIVIILI(VIIML));
                    IVGFIM -8;
                }
            }



            W->RMRG = GIFV;
            IVGFIM 9;
        }

        ELRW XOVZMFK(HGW::HGIRMT& PVB)
        {
            HRAV_G KLH = PVB.URMW_URIHG_LU(":|@");
            DSROV ( KLH != HGW::HGIRMT::MKLH )
            {
                PVB[KLH] = '_';
                KLH = PVB.URMW_URIHG_LU(":|@");
            }
        }

    KILGVXGVW:
        HGIFXG _hGZGHWxORVMGwZGZ* W;
};

} // VMW MZNVHKZXV

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_WVKVMWVMXB.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_wvkvmwvmxb_s_
#WVURMV _fyrjgllo_fyrj_wvkvmwvmxb_s_

#RMXOFWV <EVXGLI>
#RMXOFWV <ZOTLIRGSN>

MZNVHKZXV FYRJGLLO
{
    //! WZGZ HGIFXGFIV WVMLGRMT GSV VMGRIV WVKVMWVMXB GIVV
    GVNKOZGV<GBKVMZNV g>
        XOZHH wVKVMWVMXBgIVV{
            KFYORX:
                //! HRMTOV MLWV IVKIVHVMGRMT WVKVMWVMXB RGVN
                XOZHH wVKVMWVMXBmLWV{
                    KFYORX:
                        OLMT RW; // MLWV RMWVC
                        ELRW *K; // KLRMGVI KLRMGRMT GL IVZO LYQVXG.
                        HGW::EVXGLI<HRAV_G> WVKVMWVMXRVH;
                };
            KFYORX:
                //! XGLI
                wVKVMWVMXBgIVV(){
                    RMW = 9;
                }
                //! WGLI
                ~wVKVMWVMXBgIVV(){
                    ULI ( ZFGL RGVI=GIVV.YVTRM(); RGVI!=GIVV.VMW(); ++RGVI  )
                        WVOVGV *RGVI;
                }
            KIREZGV:
                HRAV_G RMW;
                HGW::EVXGLI< wVKVMWVMXBmLWV* > GIVV;
                HGW::EVXGLI<HRAV_G>  HLIGVW_ORHG;
            KFYORX:
                HRAV_G HRAV(){
                    IVGFIM GIVV.HRAV();
                }
                YLLO VNKGB(){
                    IVGFIM GIVV.VNKGB();
                }
                HGW::EVXGLI<HRAV_G> TVGhLIGVWoRHG(){
                    IVGFIM HLIGVW_ORHG;
                }
            KFYORX:
                //! ZWW MLWV GL GSV WVKVMWVMXB GIVV, IVGFIM RMW
                HRAV_G zWWmLWV(g* K)
                {
                    ZFGL MLWV = MVD wVKVMWVMXBmLWV();
                    MLWV->RW = RMW;
                    MLWV->K = (ELRW*)K;
                    ++RMW;
                    GIVV.KFHS_YZXP(MLWV);
                    IVGFIM RMW-8;
                }

                //! ZWW WVKVMWVMXB
                RMG zWWwVKVMWVMXB(HRAV_G WVKVMWVMG, HRAV_G WVKVMWVMXB)
                {
                    RU ( WVKVMWVMG > RMW || WVKVMWVMXB > RMW)
                        IVGFIM -8;
                    GIVV[WVKVMWVMG]->WVKVMWVMXRVH.KFHS_YZXP(WVKVMWVMXB);
                    IVGFIM 9;
                }

            KFYORX:
                //! KVIULIN GSV GLKLOLTRXZO HLIG
                ELRW hLIG()
                {
                    HGW::EVXGLI<YLLO> VCKOLIVW(GIVV.HRAV(), UZOHV);
                    HLIGVW_ORHG.IVHRAV(GIVV.HRAV(), 9);
                    HRAV_G G = GIVV.HRAV();
                    ULI (HRAV_G R = 9; R < GIVV.HRAV(); ++R)
                    {
                        RU (VCKOLIVW[R] == UZOHV)
                        {
                            hLIG_FHRMT_wuh(GIVV, VCKOLIVW, R, HLIGVW_ORHG, G);
                        }
                    }
                    HGW::IVEVIHV(HLIGVW_ORHG.YVTRM(), HLIGVW_ORHG.VMW());
                    //ZHHVIG(G == 9);
                    IVGFIM;
                }



            KIREZGV:
                ELRW hLIG_FHRMT_wuh(HGW::EVXGLI<wVKVMWVMXBmLWV* >& TIZKS, HGW::EVXGLI<YLLO>& VCKOLIVW,
                        HRAV_G R, HGW::EVXGLI<HRAV_G>& HLIGVW, HRAV_G& G)
                {
                    VCKOLIVW[R] = GIFV;
                    ULI (HRAV_G Q = 9; Q < TIZKS[R]->WVKVMWVMXRVH.HRAV(); ++Q)
                    {
                        RU (VCKOLIVW[TIZKS[R]->WVKVMWVMXRVH[Q]] == UZOHV)
                        {
                            hLIG_FHRMT_wuh(TIZKS, VCKOLIVW, TIZKS[R]->WVKVMWVMXRVH[Q], HLIGVW, G);
                        }
                    }
                    --G;
                    HLIGVW[G] = R;
                    IVGFIM;
                }
        };

}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/HNZIGXSZI.S
#RUMWVU _fyrjgllo_hnzigxszi_
#WVURMV _fyrjgllo_hnzigxszi_

#RMXOFWV <XHGWORY>

MZNVHKZXV FYRJGLLO{

    XOZHH hNZIGxSZI{
        XSZI* KLRMGVI;
        HGW::HRAV_G *IVUH;

        ELRW XOVZI(){
            RU (!--*IVUH){
                UIVV(KLRMGVI);
                WVOVGV IVUH;
            }
        }

        KFYORX:
        hNZIGxSZI(XSZI* K = mfoo)
            : KLRMGVI(K), IVUH(MVD HGW::HRAV_G(8))
        {}

        hNZIGxSZI(XLMHG hNZIGxSZI& LGSVI)
            : KLRMGVI(LGSVI.KLRMGVI), IVUH(LGSVI.IVUH)
        {
            ++*IVUH;

        }
        ~hNZIGxSZI(){
            XOVZI();
        }

        hNZIGxSZI& LKVIZGLI=(XLMHG hNZIGxSZI& LGSVI){
            RU (GSRH != &LGSVI){
                XOVZI();
                KLRMGVI = LGSVI.KLRMGVI;
                IVUH    = LGSVI.IVUH;
                ++*IVUH;
            }
            IVGFIM *GSRH;
        }

        hNZIGxSZI& LKVIZGLI=(XSZI* K){
            RU (KLRMGVI != K){
                KLRMGVI = K;
                *IVUH = 8;
            }
            IVGFIM *GSRH;
        }

        XSZI& LKVIZGLI*(){
            IVGFIM *KLRMGVI;

        }

        XLMHG XSZI& LKVIZGLI*() XLMHG{
            IVGFIM *KLRMGVI;

        }

        XSZI* LKVIZGLI->(){
            IVGFIM KLRMGVI;
        }

        XLMHG XSZI* LKVIZGLI->() XLMHG{
            IVGFIM KLRMGVI;

        }

        HGW::HRAV_G TVGxLFMGH(){
            IVGFIM *IVUH;
        }

    };

}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/IZKRWCNO.SKK
#RUMWVU izkrwcno_skk_rmxofwvw
#WVURMV izkrwcno_skk_rmxofwvw

// xLKBIRTSG (x) 7993, 7990 nZIXRM pZORXRMHPR
// eVIHRLM 8.86
// iVERHRLM $wZGVgRNV: 7990/94/86 98:53:82 $
//! \UROV IZKRWCNO.SKK gSRH UROV XLMGZRMH IZKRWCNO KZIHVI ZMW wln RNKOVNVMGZGRLM

// rU HGZMWZIW ORYIZIB RH WRHZYOVW, FHVI NFHG KILERWV RNKOVNVMGZGRLMH LU IVJFRIVW UFMXGRLMH ZMW GBKVWVUH
#RU !WVURMVW(izkrwcno_ml_hgwory)
    #RMXOFWV <XHGWORY>      // uLI HGW::HRAV_G
    #RMXOFWV <XZHHVIG>      // uLI ZHHVIG
    #RMXOFWV <MVD>          // uLI KOZXVNVMG MVD
#VMWRU

// lM nhex, WRHZYOV "XLMWRGRLMZO VCKIVHHRLM RH XLMHGZMG" DZIMRMT (OVEVO 5).
// gSRH DZIMRMT RH ZONLHG RNKLHHRYOV GL ZELRW DRGS XVIGZRM GBKVH LU GVNKOZGVW XLWV
#RUWVU _nhx_evi
    #KIZTNZ DZIMRMT(KFHS)
    #KIZTNZ DZIMRMT(WRHZYOV:5872)   // xLMWRGRLMZO VCKIVHHRLM RH XLMHGZMG
#VMWRU

///////////////////////////////////////////////////////////////////////////
// izkrwcno_kzihv_viili

#RU WVURMVW(izkrwcno_ml_vcxvkgrlmh)

#WVURMV izkrwcno_kzihv_viili(DSZG, DSVIV) { KZIHV_VIILI_SZMWOVI(DSZG, DSVIV); ZHHVIG(9); }

MZNVHKZXV IZKRWCNO
{
    //! dSVM VCXVKGRLMH ZIV WRHZYOVW YB WVURMRMT izkrwcno_ml_vcxvkgrlmh,
    //! GSRH UFMXGRLM RH XZOOVW GL MLGRUB FHVI ZYLFG GSV VIILI.
    //! rG NFHG YV WVURMVW YB GSV FHVI.
    //! <YI><YI>
    //! gSRH UFMXGRLM XZMMLG IVGFIM. rU RG WLVH, GSV IVHFOGH ZIV FMWVURMVW.
    //! <YI><YI>
    //! z EVIB HRNKOV WVURMRGRLM NRTSG OLLP ORPV GSZG:
    //! <KIV>
#RUWVU izkrwcno_ml_vcxvkgrlmh
    RMORMV ELRW KZIHV_VIILI_SZMWOVI(XLMHG XSZI *DSZG, ELRW *DSVIV)
    {
         HGW::XLFG << "kZIHV VIILI: " << DSZG << "\M";
         HGW::ZYLIG();
    }
#VMWRU
    //! </KIV>
    //! \KZIZN DSZG sFNZM IVZWZYOV WVHXIRKGRLM LU GSV VIILI.
    //! \KZIZN DSVIV kLRMGVI GL XSZIZXGVI WZGZ DSVIV VIILI DZH WVGVXGVW.
    ELRW KZIHV_VIILI_SZMWOVI(XLMHG XSZI *DSZG, ELRW *DSVIV);
}

#VOHV

#RMXOFWV <VCXVKGRLM>    // uLI HGW::VCXVKGRLM

#WVURMV izkrwcno_kzihv_viili(DSZG, DSVIV) GSILD KZIHV_VIILI(DSZG, DSVIV)

MZNVHKZXV IZKRWCNO
{

    //! kZIHV VIILI VCXVKGRLM.
    //! gSRH VCXVKGRLM RH GSILDM YB GSV KZIHVI DSVM ZM VIILI LXXFIH.
    //! fHV DSZG() UFMXGRLM GL TVG SFNZM-IVZWZYOV VIILI NVHHZTV.
    //! fHV DSVIV() UFMXGRLM GL TVG Z KLRMGVI GL KLHRGRLM DRGSRM HLFIXV GVCG DSVIV VIILI DZH WVGVXGVW.
    //! <YI><YI>
    //! rU GSILDRMT VCXVKGRLMH YB GSV KZIHVI RH FMWVHRIZYOV,
    //! RG XZM YV WRHZYOVW YB WVURMRMT izkrwcno_ml_vcxvkgrlmh NZXIL YVULIV IZKRWCNO.SKK RH RMXOFWVW.
    //! gSRH DROO XZFHV GSV KZIHVI GL XZOO IZKRWCNO::KZIHV_VIILI_SZMWOVI() UFMXGRLM RMHGVZW LU GSILDRMT ZM VCXVKGRLM.
    //! gSRH UFMXGRLM NFHG YV WVURMVW YB GSV FHVI.
    //! <YI><YI>
    //! gSRH XOZHH WVIREVH UILN <XLWV>HGW::VCXVKGRLM</XLWV> XOZHH.
    XOZHH KZIHV_VIILI: KFYORX HGW::VCXVKGRLM
    {

    KFYORX:

        //! xLMHGIFXGH KZIHV VIILI
        KZIHV_VIILI(XLMHG XSZI *DSZG, ELRW *DSVIV)
            : N_DSZG(DSZG)
            , N_DSVIV(DSVIV)
        {
        }

        //! tVGH SFNZM IVZWZYOV WVHXIRKGRLM LU VIILI.
        //! \IVGFIM kLRMGVI GL MFOO GVINRMZGVW WVHXIRKGRLM LU GSV VIILI.
        ERIGFZO XLMHG XSZI *DSZG() XLMHG GSILD()
        {
            IVGFIM N_DSZG;
        }

        //! tVGH KLRMGVI GL XSZIZXGVI WZGZ DSVIV VIILI SZKKVMVW.
        //! xS HSLFOW YV GSV HZNV ZH XSZI GBKV LU CNO_WLXFNVMG GSZG KILWFXVW GSV VIILI.
        //! \IVGFIM kLRMGVI GL OLXZGRLM DRGSRM GSV KZIHVW HGIRMT DSVIV VIILI LXXFIVW.
        GVNKOZGV<XOZHH xS>
        xS *DSVIV() XLMHG
        {
            IVGFIM IVRMGVIKIVG_XZHG<xS *>(N_DSVIV);
        }

    KIREZGV:

        XLMHG XSZI *N_DSZG;
        ELRW *N_DSVIV;

    };
}

#VMWRU

///////////////////////////////////////////////////////////////////////////
// kLLO HRAVH

#RUMWVU izkrwcno_hgzgrx_kllo_hrav
    // hRAV LU HGZGRX NVNLIB YOLXP LU NVNLIB_KLLO.
    // wVURMV izkrwcno_hgzgrx_kllo_hrav YVULIV RMXOFWRMT IZKRWCNO.SKK RU BLF DZMG GL LEVIIRWV GSV WVUZFOG EZOFV.
    // mL WBMZNRX NVNLIB ZOOLXZGRLMH ZIV KVIULINVW YB NVNLIB_KLLO FMGRO HGZGRX NVNLIB RH VCSZFHGVW.
    #WVURMV izkrwcno_hgzgrx_kllo_hrav (35 * 8975)
#VMWRU

#RUMWVU izkrwcno_wbmznrx_kllo_hrav
    // hRAV LU WBMZNRX NVNLIB YOLXP LU NVNLIB_KLLO.
    // wVURMV izkrwcno_wbmznrx_kllo_hrav YVULIV RMXOFWRMT IZKRWCNO.SKK RU BLF DZMG GL LEVIIRWV GSV WVUZFOG EZOFV.
    // zUGVI GSV HGZGRX YOLXP RH VCSZFHGVW, WBMZNRX YOLXPH DRGS ZKKILCRNZGVOB GSRH HRAV ZIV ZOOLXZGVW YB NVNLIB_KLLO.
    #WVURMV izkrwcno_wbmznrx_kllo_hrav (35 * 8975)
#VMWRU

#RUMWVU izkrwcno_zortmnvmg
    // nVNLIB ZOOLXZGRLM ZORTMNVMG.
    // wVURMV izkrwcno_zortmnvmg YVULIV RMXOFWRMT IZKRWCNO.SKK RU BLF DZMG GL LEVIIRWV GSV WVUZFOG EZOFV, DSRXS RH GSV HRAV LU KLRMGVI.
    // zOO NVNLIB ZOOLXZGRLMH ULI MLWVH, ZGGIRYFGVH ZMW HGIRMTH DROO YV ZORTMVW GL GSRH EZOFV.
    // gSRH NFHG YV Z KLDVI LU 7 ZMW ZG OVZHG 8, LGSVIDRHV NVNLIB_KLLO DROO MLG DLIP.
    #WVURMV izkrwcno_zortmnvmg HRAVLU(ELRW *)
#VMWRU

MZNVHKZXV IZKRWCNO
{
    // uLIDZIW WVXOZIZGRLMH
    GVNKOZGV<XOZHH xS> XOZHH CNO_MLWV;
    GVNKOZGV<XOZHH xS> XOZHH CNO_ZGGIRYFGV;
    GVNKOZGV<XOZHH xS> XOZHH CNO_WLXFNVMG;

    //! vMFNVIZGRLM ORHGRMT ZOO MLWV GBKVH KILWFXVW YB GSV KZIHVI.
    //! fHV CNO_MLWV::GBKV() UFMXGRLM GL JFVIB MLWV GBKV.
    VMFN MLWV_GBKV
    {
        MLWV_WLXFNVMG,      //!< z WLXFNVMG MLWV. mZNV ZMW EZOFV ZIV VNKGB.
        MLWV_VOVNVMG,       //!< zM VOVNVMG MLWV. mZNV XLMGZRMH VOVNVMG MZNV. eZOFV XLMGZRMH GVCG LU URIHG WZGZ MLWV.
        MLWV_WZGZ,          //!< z WZGZ MLWV. mZNV RH VNKGB. eZOFV XLMGZRMH WZGZ GVCG.
        MLWV_XWZGZ,         //!< z xwzgz MLWV. mZNV RH VNKGB. eZOFV XLMGZRMH WZGZ GVCG.
        MLWV_XLNNVMG,       //!< z XLNNVMG MLWV. mZNV RH VNKGB. eZOFV XLMGZRMH XLNNVMG GVCG.
        MLWV_WVXOZIZGRLM,   //!< z WVXOZIZGRLM MLWV. mZNV ZMW EZOFV ZIV VNKGB. wVXOZIZGRLM KZIZNVGVIH (EVIHRLM, VMXLWRMT ZMW HGZMWZOLMV) ZIV RM MLWV ZGGIRYFGVH.
        MLWV_WLXGBKV,       //!< z wlxgbkv MLWV. mZNV RH VNKGB. eZOFV XLMGZRMH wlxgbkv GVCG.
        MLWV_KR             //!< z kr MLWV. mZNV XLMGZRMH GZITVG. eZOFV XLMGZRMH RMHGIFXGRLMH.
    };

    ///////////////////////////////////////////////////////////////////////
    // kZIHRMT UOZTH

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL MLG XIVZGV WZGZ MLWVH.
    //! gVCG LU URIHG WZGZ MLWV DROO HGROO YV KOZXVW RM EZOFV LU KZIVMG VOVNVMG, FMOVHH IZKRWCNO::KZIHV_ML_VOVNVMG_EZOFVH UOZT RH ZOHL HKVXRURVW.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_ML_WZGZ_MLWVH = 9C8;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL MLG FHV GVCG LU URIHG WZGZ MLWV ZH Z EZOFV LU KZIVMG VOVNVMG.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! mLGV GSZG XSROW WZGZ MLWVH LU VOVNVMG MLWV GZPV KIVXVMWVMXV LEVI RGH EZOFV DSVM KIRMGRMT.
    //! gSZG RH, RU VOVNVMG SZH LMV LI NLIV XSROW WZGZ MLWVH <VN>ZMW</VN> Z EZOFV, GSV EZOFV DROO YV RTMLIVW.
    //! fHV IZKRWCNO::KZIHV_ML_WZGZ_MLWVH UOZT GL KIVEVMG XIVZGRLM LU WZGZ MLWVH RU BLF DZMG GL NZMRKFOZGV WZGZ FHRMT EZOFVH LU VOVNVMGH.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_ML_VOVNVMG_EZOFVH = 9C7;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL MLG KOZXV AVIL GVINRMZGLIH ZUGVI HGIRMTH RM GSV HLFIXV GVCG.
    //! yB WVUZFOG AVIL GVINRMZGLIH ZIV KOZXVW, NLWRUBRMT HLFIXV GVCG.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_ML_HGIRMT_GVINRMZGLIH = 9C5;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL MLG GIZMHOZGV VMGRGRVH RM GSV HLFIXV GVCG.
    //! yB WVUZFOG VMGRGRVH ZIV GIZMHOZGVW, NLWRUBRMT HLFIXV GVCG.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_ML_VMGRGB_GIZMHOZGRLM = 9C1;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL WRHZYOV fgu-1 SZMWORMT ZMW ZHHFNV KOZRM 1 YRG XSZIZXGVIH.
    //! yB WVUZFOG, fgu-1 SZMWORMT RH VMZYOVW.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_ML_FGU1 = 9C89;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL XIVZGV cno WVXOZIZGRLM MLWV.
    //! yB WVUZFOG, WVXOZIZGRLM MLWV RH MLG XIVZGVW.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_WVXOZIZGRLM_MLWV = 9C79;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL XIVZGV XLNNVMGH MLWVH.
    //! yB WVUZFOG, XLNNVMG MLWVH ZIV MLG XIVZGVW.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_XLNNVMG_MLWVH = 9C59;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL XIVZGV wlxgbkv MLWV.
    //! yB WVUZFOG, WLXGBKV MLWV RH MLG XIVZGVW.
    //! zOGSLFTS d6x HKVXRURXZGRLM ZOOLDH ZG NLHG LMV wlxgbkv MLWV, iZKRWcNO DROO HROVMGOB ZXXVKG WLXFNVMGH DRGS NLIV GSZM LMV.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_WLXGBKV_MLWV = 9C19;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL XIVZGV kr MLWVH.
    //! yB WVUZFOG, kr MLWVH ZIV MLG XIVZGVW.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_KR_MLWVH = 9C899;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL EZORWZGV XOLHRMT GZT MZNVH.
    //! rU MLG HVG, MZNV RMHRWV XOLHRMT GZT RH RIIVOVEZMG GL GSV KZIHVI.
    //! yB WVUZFOG, XOLHRMT GZTH ZIV MLG EZORWZGVW.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_EZORWZGV_XOLHRMT_GZTH = 9C799;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL GIRN ZOO OVZWRMT ZMW GIZRORMT DSRGVHKZXV LU WZGZ MLWVH.
    //! yB WVUZFOG, DSRGVHKZXV RH MLG GIRNNVW.
    //! gSRH UOZT WLVH MLG XZFHV GSV KZIHVI GL NLWRUB HLFIXV GVCG.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_GIRN_DSRGVHKZXV = 9C599;

    //! kZIHV UOZT RMHGIFXGRMT GSV KZIHVI GL XLMWVMHV ZOO DSRGVHKZXV IFMH LU WZGZ MLWVH GL Z HRMTOV HKZXV XSZIZXGVI.
    //! gIRNNRMT LU OVZWRMT ZMW GIZRORMT DSRGVHKZXV LU WZGZ RH XLMGILOOVW YB IZKRWCNO::KZIHV_GIRN_DSRGVHKZXV UOZT.
    //! yB WVUZFOG, DSRGVHKZXV RH MLG MLINZORAVW.
    //! rU GSRH UOZT RH HKVXRURVW, HLFIXV GVCG DROO YV NLWRURVW.
    //! xZM YV XLNYRMVW DRGS LGSVI UOZTH YB FHV LU | LKVIZGLI.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_MLINZORAV_DSRGVHKZXV = 9C199;

    // xLNKLFMW UOZTH

    //! kZIHV UOZTH DSRXS IVKIVHVMG WVUZFOG YVSZERLFI LU GSV KZIHVI.
    //! gSRH RH ZODZBH VJFZO GL 9, HL GSZG ZOO LGSVI UOZTH XZM YV HRNKOB LIVW GLTVGSVI.
    //! mLINZOOB GSVIV RH ML MVVW GL RMXLMEVMRVMGOB WRHZYOV UOZTH YB ZMWRMT DRGS GSVRI MVTZGVW (~) EZOFVH.
    //! gSRH ZOHL NVZMH GSZG NVZMRMT LU VZXS UOZT RH Z <R>MVTZGRLM</R> LU GSV WVUZFOG HVGGRMT.
    //! uLI VCZNKOV, RU UOZT MZNV RH IZKRWCNO::KZIHV_ML_FGU1, RG NVZMH GSZG FGU-1 RH <R>VMZYOVW</R> YB WVUZFOG,
    //! ZMW FHRMT GSV UOZT DROO WRHZYOV RG.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_WVUZFOG = 9;

    //! z XLNYRMZGRLM LU KZIHV UOZTH GSZG ULIYRWH ZMB NLWRURXZGRLMH LU GSV HLFIXV GVCG.
    //! gSRH ZOHL IVHFOGH RM UZHGVI KZIHRMT. sLDVEVI, MLGV GSZG GSV ULOOLDRMT DROO LXXFI:
    //! <FO>
    //! <OR>MZNVH ZMW EZOFVH LU MLWVH DROO MLG YV AVIL GVINRMZGVW, BLF SZEV GL FHV CNO_YZHV::MZNV_HRAV() ZMW CNO_YZHV::EZOFV_HRAV() UFMXGRLMH GL WVGVINRMV DSVIV MZNV ZMW EZOFV VMWH</OR>
    //! <OR>VMGRGRVH DROO MLG YV GIZMHOZGVW</OR>
    //! <OR>DSRGVHKZXV DROO MLG YV MLINZORAVW</OR>
    //! </FO>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_MLM_WVHGIFXGREV = KZIHV_ML_HGIRMT_GVINRMZGLIH | KZIHV_ML_VMGRGB_GIZMHOZGRLM;

    //! z XLNYRMZGRLM LU KZIHV UOZTH IVHFOGRMT RM UZHGVHG KLHHRYOV KZIHRMT, DRGSLFG HZXIRURXRMT RNKLIGZMG WZGZ.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_UZHGVHG = KZIHV_MLM_WVHGIFXGREV | KZIHV_ML_WZGZ_MLWVH;

    //! z XLNYRMZGRLM LU KZIHV UOZTH IVHFOGRMT RM OZITVHG ZNLFMG LU WZGZ YVRMT VCGIZXGVW.
    //! gSRH FHFZOOB IVHFOGH RM HOLDVHG KZIHRMT.
    //! <YI><YI>
    //! hVV CNO_WLXFNVMG::KZIHV() UFMXGRLM.
    XLMHG RMG KZIHV_UFOO = KZIHV_WVXOZIZGRLM_MLWV | KZIHV_XLNNVMG_MLWVH | KZIHV_WLXGBKV_MLWV | KZIHV_KR_MLWVH | KZIHV_EZORWZGV_XOLHRMT_GZTH;

    ///////////////////////////////////////////////////////////////////////
    // rMGVIMZOH

    //! \XLMW RMGVIMZO
    MZNVHKZXV RMGVIMZO
    {

        // hGIFXG GSZG XLMGZRMH OLLPFK GZYOVH ULI GSV KZIHVI
        // rG NFHG YV Z GVNKOZGV GL ZOOLD XLIIVXG ORMPRMT (YVXZFHV RG SZH HGZGRX WZGZ NVNYVIH, DSRXS ZIV WVURMVW RM Z SVZWVI UROV).
        GVNKOZGV<RMG wFNNB>
        HGIFXG OLLPFK_GZYOVH
        {
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_DSRGVHKZXV[743];              // dSRGVHKZXV GZYOV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_MLWV_MZNV[743];               // mLWV MZNV GZYOV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_GVCG[743];                    // gVCG GZYOV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_GVCG_KFIV_ML_DH[743];         // gVCG GZYOV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_GVCG_KFIV_DRGS_DH[743];       // gVCG GZYOV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_ZGGIRYFGV_MZNV[743];          // zGGIRYFGV MZNV GZYOV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_ZGGIRYFGV_WZGZ_8[743];        // zGGIRYFGV WZGZ GZYOV DRGS HRMTOV JFLGV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_ZGGIRYFGV_WZGZ_8_KFIV[743];   // zGGIRYFGV WZGZ GZYOV DRGS HRMTOV JFLGV
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_ZGGIRYFGV_WZGZ_7[743];        // zGGIRYFGV WZGZ GZYOV DRGS WLFYOV JFLGVH
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_ZGGIRYFGV_WZGZ_7_KFIV[743];   // zGGIRYFGV WZGZ GZYOV DRGS WLFYOV JFLGVH
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_WRTRGH[743];                  // wRTRGH
            HGZGRX XLMHG FMHRTMVW XSZI OLLPFK_FKXZHV[743];                  // gL FKKVIXZHV XLMEVIHRLM GZYOV ULI zhxrr XSZIZXGVIH
        };

        // uRMW OVMTGS LU GSV HGIRMT
        GVNKOZGV<XOZHH xS>
        RMORMV HGW::HRAV_G NVZHFIV(XLMHG xS *K)
        {
            XLMHG xS *GNK = K;
            DSROV (*GNK)
                ++GNK;
            IVGFIM GNK - K;
        }

        // xLNKZIV HGIRMTH ULI VJFZORGB
        GVNKOZGV<XOZHH xS>
        RMORMV YLLO XLNKZIV(XLMHG xS *K8, HGW::HRAV_G HRAV8, XLMHG xS *K7, HGW::HRAV_G HRAV7, YLLO XZHV_HVMHRGREV)
        {
            RU (HRAV8 != HRAV7)
                IVGFIM UZOHV;
            RU (XZHV_HVMHRGREV)
            {
                ULI (XLMHG xS *VMW = K8 + HRAV8; K8 < VMW; ++K8, ++K7)
                    RU (*K8 != *K7)
                        IVGFIM UZOHV;
            }
            VOHV
            {
                ULI (XLMHG xS *VMW = K8 + HRAV8; K8 < VMW; ++K8, ++K7)
                    RU (OLLPFK_GZYOVH<9>::OLLPFK_FKXZHV[HGZGRX_XZHG<FMHRTMVW XSZI>(*K8)] != OLLPFK_GZYOVH<9>::OLLPFK_FKXZHV[HGZGRX_XZHG<FMHRTMVW XSZI>(*K7)])
                        IVGFIM UZOHV;
            }
            IVGFIM GIFV;
        }
    }
    //! \VMWXLMW

    ///////////////////////////////////////////////////////////////////////
    // nVNLIB KLLO

    //! gSRH XOZHH RH FHVW YB GSV KZIHVI GL XIVZGV MVD MLWVH ZMW ZGGIRYFGVH, DRGSLFG LEVISVZWH LU WBMZNRX NVNLIB ZOOLXZGRLM.
    //! rM NLHG XZHVH, BLF DROO MLG MVVW GL FHV GSRH XOZHH WRIVXGOB.
    //! sLDVEVI, RU BLF MVVW GL XIVZGV MLWVH NZMFZOOB LI NLWRUB MZNVH/EZOFVH LU MLWVH,
    //! BLF ZIV VMXLFIZTVW GL FHV NVNLIB_KLLO LU IVOVEZMG CNO_WLXFNVMG GL ZOOLXZGV GSV NVNLIB.
    //! mLG LMOB RH GSRH UZHGVI GSZM ZOOLXZGRMT GSVN YB FHRMT <XLWV>MVD</XLWV> LKVIZGLI,
    //! YFG ZOHL GSVRI ORUVGRNV DROO YV GRVW GL GSV ORUVGRNV LU WLXFNVMG,
    //! KLHHRYOB HRNKOBURMT NVNLIB NZMZTVNVMG.
    //! <YI><YI>
    //! xZOO ZOOLXZGV_MLWV() LI ZOOLXZGV_ZGGIRYFGV() UFMXGRLMH GL LYGZRM MVD MLWVH LI ZGGIRYFGVH UILN GSV KLLO.
    //! bLF XZM ZOHL XZOO ZOOLXZGV_HGIRMT() UFMXGRLM GL ZOOLXZGV HGIRMTH.
    //! hFXS HGIRMTH XZM GSVM YV FHVW ZH MZNVH LI EZOFVH LU MLWVH DRGSLFG DLIIBRMT ZYLFG GSVRI ORUVGRNV.
    //! mLGV GSZG GSVIV RH ML <XLWV>UIVV()</XLWV> UFMXGRLM -- ZOO ZOOLXZGRLMH ZIV UIVVW ZG LMXV DSVM XOVZI() UFMXGRLM RH XZOOVW,
    //! LI DSVM GSV KLLO RH WVHGILBVW.
    //! <YI><YI>
    //! rG RH ZOHL KLHHRYOV GL XIVZGV Z HGZMWZOLMV NVNLIB_KLLO, ZMW FHV RG
    //! GL ZOOLXZGV MLWVH, DSLHV ORUVGRNV DROO MLG YV GRVW GL ZMB WLXFNVMG.
    //! <YI><YI>
    //! kLLO NZRMGZRMH <XLWV>izkrwcno_hgzgrx_kllo_hrav</XLWV> YBGVH LU HGZGRXZOOB ZOOLXZGVW NVNLIB.
    //! fMGRO HGZGRX NVNLIB RH VCSZFHGVW, ML WBMZNRX NVNLIB ZOOLXZGRLMH ZIV WLMV.
    //! dSVM HGZGRX NVNLIB RH VCSZFHGVW, KLLO ZOOLXZGVH ZWWRGRLMZO YOLXPH LU NVNLIB LU HRAV <XLWV>izkrwcno_wbmznrx_kllo_hrav</XLWV> VZXS,
    //! YB FHRMT TOLYZO <XLWV>MVD[]</XLWV> ZMW <XLWV>WVOVGV[]</XLWV> LKVIZGLIH.
    //! gSRH YVSZERLFI XZM YV XSZMTVW YB HVGGRMT XFHGLN ZOOLXZGRLM ILFGRMVH.
    //! fHV HVG_ZOOLXZGLI() UFMXGRLM GL HVG GSVN.
    //! <YI><YI>
    //! zOOLXZGRLMH ULI MLWVH, ZGGIRYFGVH ZMW HGIRMTH ZIV ZORTMVW ZG <XLWV>izkrwcno_zortmnvmg</XLWV> YBGVH.
    //! gSRH EZOFV WVUZFOGH GL GSV HRAV LU KLRMGVI LM GZITVG ZIXSRGVXGFIV.
    //! <YI><YI>
    //! gL LYGZRM ZYHLOFGVOB GLK KVIULINZMXV UILN GSV KZIHVI,
    //! RG RH RNKLIGZMG GSZG ZOO MLWVH ZIV ZOOLXZGVW UILN Z HRMTOV, XLMGRTFLFH YOLXP LU NVNLIB.
    //! lGSVIDRHV, XZXSV NRHHVH DSVM QFNKRMT YVGDVVM GDL (LI NLIV) WRHQLRMG YOLXPH LU NVNLIB XZM HOLD WLDM KZIHRMT JFRGV XLMHRWVIZYOB.
    //! rU IVJFRIVW, BLF XZM GDVZP <XLWV>izkrwcno_hgzgrx_kllo_hrav</XLWV>, <XLWV>izkrwcno_wbmznrx_kllo_hrav</XLWV> ZMW <XLWV>izkrwcno_zortmnvmg</XLWV>
    //! GL LYGZRM YVHG DZHGVW NVNLIB GL KVIULINZMXV XLNKILNRHV.
    //! gL WL RG, WVURMV GSVRI EZOFVH YVULIV IZKRWCNO.SKK UROV RH RMXOFWVW.
    //! \KZIZN xS xSZIZXGVI GBKV LU XIVZGVW MLWVH.
    GVNKOZGV<XOZHH xS = XSZI>
    XOZHH NVNLIB_KLLO
    {

    KFYORX:

        //! \XLMW RMGVIMZO
        GBKVWVU ELRW *(ZOOLX_UFMX)(HGW::HRAV_G);       // gBKV LU FHVI-WVURMVW UFMXGRLM FHVW GL ZOOLXZGV NVNLIB
        GBKVWVU ELRW (UIVV_UFMX)(ELRW *);              // gBKV LU FHVI-WVURMVW UFMXGRLM FHVW GL UIVV NVNLIB
        //! \VMWXLMW

        //! xLMHGIFXGH VNKGB KLLO DRGS WVUZFOG ZOOLXZGLI UFMXGRLMH.
        NVNLIB_KLLO()
            : N_ZOOLX_UFMX(9)
            , N_UIVV_UFMX(9)
        {
            RMRG();
        }

        //! wVHGILBH KLLO ZMW UIVVH ZOO GSV NVNLIB.
        //! gSRH XZFHVH NVNLIB LXXFKRVW YB MLWVH ZOOLXZGVW YB GSV KLLO GL YV UIVVW.
        //! mLWVH ZOOLXZGVW UILN GSV KLLO ZIV ML OLMTVI EZORW.
        ~NVNLIB_KLLO()
        {
            XOVZI();
        }

        //! zOOLXZGVH Z MVD MLWV UILN GSV KLLO, ZMW LKGRLMZOOB ZHHRTMH MZNV ZMW EZOFV GL RG.
        //! rU GSV ZOOLXZGRLM IVJFVHG XZMMLG YV ZXXLNLWZGVW, GSRH UFMXGRLM DROO GSILD <XLWV>HGW::YZW_ZOOLX</XLWV>.
        //! rU VCXVKGRLMH ZIV WRHZYOVW YB WVURMRMT izkrwcno_ml_vcxvkgrlmh, GSRH UFMXGRLM
        //! DROO XZOO IZKRWCNO::KZIHV_VIILI_SZMWOVI() UFMXGRLM.
        //! \KZIZN GBKV gBKV LU MLWV GL XIVZGV.
        //! \KZIZN MZNV mZNV GL ZHHRTM GL GSV MLWV, LI 9 GL ZHHRTM ML MZNV.
        //! \KZIZN EZOFV eZOFV GL ZHHRTM GL GSV MLWV, LI 9 GL ZHHRTM ML EZOFV.
        //! \KZIZN MZNV_HRAV hRAV LU MZNV GL ZHHRTM, LI 9 GL ZFGLNZGRXZOOB XZOXFOZGV HRAV UILN MZNV HGIRMT.
        //! \KZIZN EZOFV_HRAV hRAV LU EZOFV GL ZHHRTM, LI 9 GL ZFGLNZGRXZOOB XZOXFOZGV HRAV UILN EZOFV HGIRMT.
        //! \IVGFIM kLRMGVI GL ZOOLXZGVW MLWV. gSRH KLRMGVI DROO MVEVI YV mfoo.
        CNO_MLWV<xS> *ZOOLXZGV_MLWV(MLWV_GBKV GBKV,
                                    XLMHG xS *MZNV = 9, XLMHG xS *EZOFV = 9,
                                    HGW::HRAV_G MZNV_HRAV = 9, HGW::HRAV_G EZOFV_HRAV = 9)
        {
            ELRW *NVNLIB = ZOOLXZGV_ZORTMVW(HRAVLU(CNO_MLWV<xS>));
            CNO_MLWV<xS> *MLWV = MVD(NVNLIB) CNO_MLWV<xS>(GBKV);
            RU (MZNV)
            {
                RU (MZNV_HRAV > 9)
                    MLWV->MZNV(MZNV, MZNV_HRAV);
                VOHV
                    MLWV->MZNV(MZNV);
            }
            RU (EZOFV)
            {
                RU (EZOFV_HRAV > 9)
                    MLWV->EZOFV(EZOFV, EZOFV_HRAV);
                VOHV
                    MLWV->EZOFV(EZOFV);
            }
            IVGFIM MLWV;
        }

        //! zOOLXZGVH Z MVD ZGGIRYFGV UILN GSV KLLO, ZMW LKGRLMZOOB ZHHRTMH MZNV ZMW EZOFV GL RG.
        //! rU GSV ZOOLXZGRLM IVJFVHG XZMMLG YV ZXXLNLWZGVW, GSRH UFMXGRLM DROO GSILD <XLWV>HGW::YZW_ZOOLX</XLWV>.
        //! rU VCXVKGRLMH ZIV WRHZYOVW YB WVURMRMT izkrwcno_ml_vcxvkgrlmh, GSRH UFMXGRLM
        //! DROO XZOO IZKRWCNO::KZIHV_VIILI_SZMWOVI() UFMXGRLM.
        //! \KZIZN MZNV mZNV GL ZHHRTM GL GSV ZGGIRYFGV, LI 9 GL ZHHRTM ML MZNV.
        //! \KZIZN EZOFV eZOFV GL ZHHRTM GL GSV ZGGIRYFGV, LI 9 GL ZHHRTM ML EZOFV.
        //! \KZIZN MZNV_HRAV hRAV LU MZNV GL ZHHRTM, LI 9 GL ZFGLNZGRXZOOB XZOXFOZGV HRAV UILN MZNV HGIRMT.
        //! \KZIZN EZOFV_HRAV hRAV LU EZOFV GL ZHHRTM, LI 9 GL ZFGLNZGRXZOOB XZOXFOZGV HRAV UILN EZOFV HGIRMT.
        //! \IVGFIM kLRMGVI GL ZOOLXZGVW ZGGIRYFGV. gSRH KLRMGVI DROO MVEVI YV mfoo.
        CNO_ZGGIRYFGV<xS> *ZOOLXZGV_ZGGIRYFGV(XLMHG xS *MZNV = 9, XLMHG xS *EZOFV = 9,
                                              HGW::HRAV_G MZNV_HRAV = 9, HGW::HRAV_G EZOFV_HRAV = 9)
        {
            ELRW *NVNLIB = ZOOLXZGV_ZORTMVW(HRAVLU(CNO_ZGGIRYFGV<xS>));
            CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = MVD(NVNLIB) CNO_ZGGIRYFGV<xS>;
            RU (MZNV)
            {
                RU (MZNV_HRAV > 9)
                    ZGGIRYFGV->MZNV(MZNV, MZNV_HRAV);
                VOHV
                    ZGGIRYFGV->MZNV(MZNV);
            }
            RU (EZOFV)
            {
                RU (EZOFV_HRAV > 9)
                    ZGGIRYFGV->EZOFV(EZOFV, EZOFV_HRAV);
                VOHV
                    ZGGIRYFGV->EZOFV(EZOFV);
            }
            IVGFIM ZGGIRYFGV;
        }

        //! zOOLXZGVH Z XSZI ZIIZB LU TREVM HRAV UILN GSV KLLO, ZMW LKGRLMZOOB XLKRVH Z TREVM HGIRMT GL RG.
        //! rU GSV ZOOLXZGRLM IVJFVHG XZMMLG YV ZXXLNLWZGVW, GSRH UFMXGRLM DROO GSILD <XLWV>HGW::YZW_ZOOLX</XLWV>.
        //! rU VCXVKGRLMH ZIV WRHZYOVW YB WVURMRMT izkrwcno_ml_vcxvkgrlmh, GSRH UFMXGRLM
        //! DROO XZOO IZKRWCNO::KZIHV_VIILI_SZMWOVI() UFMXGRLM.
        //! \KZIZN HLFIXV hGIRMT GL RMRGRZORAV GSV ZOOLXZGVW NVNLIB DRGS, LI 9 GL MLG RMRGRZORAV RG.
        //! \KZIZN HRAV mFNYVI LU XSZIZXGVIH GL ZOOLXZGV, LI AVIL GL XZOXFOZGV RG ZFGLNZGRXZOOB UILN HLFIXV HGIRMT OVMTGS; RU HRAV RH 9, HLFIXV HGIRMT NFHG YV HKVXRURVW ZMW MFOO GVINRMZGVW.
        //! \IVGFIM kLRMGVI GL ZOOLXZGVW XSZI ZIIZB. gSRH KLRMGVI DROO MVEVI YV mfoo.
        xS *ZOOLXZGV_HGIRMT(XLMHG xS *HLFIXV = 9, HGW::HRAV_G HRAV = 9)
        {
            ZHHVIG(HLFIXV || HRAV);     // vRGSVI HLFIXV LI HRAV (LI YLGS) NFHG YV HKVXRURVW
            RU (HRAV == 9)
                HRAV = RMGVIMZO::NVZHFIV(HLFIXV) + 8;
            xS *IVHFOG = HGZGRX_XZHG<xS *>(ZOOLXZGV_ZORTMVW(HRAV * HRAVLU(xS)));
            RU (HLFIXV)
                ULI (HGW::HRAV_G R = 9; R < HRAV; ++R)
                    IVHFOG[R] = HLFIXV[R];
            IVGFIM IVHFOG;
        }

        //! xOLMVH ZM CNO_MLWV ZMW RGH SRVIZIXSB LU XSROW MLWVH ZMW ZGGIRYFGVH.
        //! mLWVH ZMW ZGGIRYFGVH ZIV ZOOLXZGVW UILN GSRH NVNLIB KLLO.
        //! mZNVH ZMW EZOFVH ZIV MLG XOLMVW, GSVB ZIV HSZIVW YVGDVVM GSV XOLMV ZMW GSV HLFIXV.
        //! iVHFOG MLWV XZM YV LKGRLMZOOB HKVXRURVW ZH Z HVXLMW KZIZNVGVI,
        //! RM DSRXS XZHV RGH XLMGVMGH DROO YV IVKOZXVW DRGS XOLMVW HLFIXV MLWV.
        //! gSRH RH FHVUFO DSVM BLF DZMG GL XOLMV VMGRIV WLXFNVMG.
        //! \KZIZN HLFIXV mLWV GL XOLMV.
        //! \KZIZN IVHFOG mLWV GL KFG IVHFOGH RM, LI 9 GL ZFGLNZGRXZOOB ZOOLXZGV IVHFOG MLWV
        //! \IVGFIM kLRMGVI GL XOLMVW MLWV. gSRH KLRMGVI DROO MVEVI YV mfoo.
        CNO_MLWV<xS> *XOLMV_MLWV(XLMHG CNO_MLWV<xS> *HLFIXV, CNO_MLWV<xS> *IVHFOG = 9)
        {
            // kIVKZIV IVHFOG MLWV
            RU (IVHFOG)
            {
                IVHFOG->IVNLEV_ZOO_ZGGIRYFGVH();
                IVHFOG->IVNLEV_ZOO_MLWVH();
                IVHFOG->GBKV(HLFIXV->GBKV());
            }
            VOHV
                IVHFOG = ZOOLXZGV_MLWV(HLFIXV->GBKV());

            // xOLMV MZNV ZMW EZOFV
            IVHFOG->MZNV(HLFIXV->MZNV(), HLFIXV->MZNV_HRAV());
            IVHFOG->EZOFV(HLFIXV->EZOFV(), HLFIXV->EZOFV_HRAV());

            // xOLMV XSROW MLWVH ZMW ZGGIRYFGVH
            ULI (CNO_MLWV<xS> *XSROW = HLFIXV->URIHG_MLWV(); XSROW; XSROW = XSROW->MVCG_HRYORMT())
                IVHFOG->ZKKVMW_MLWV(XOLMV_MLWV(XSROW));
            ULI (CNO_ZGGIRYFGV<xS> *ZGGI = HLFIXV->URIHG_ZGGIRYFGV(); ZGGI; ZGGI = ZGGI->MVCG_ZGGIRYFGV())
                IVHFOG->ZKKVMW_ZGGIRYFGV(ZOOLXZGV_ZGGIRYFGV(ZGGI->MZNV(), ZGGI->EZOFV(), ZGGI->MZNV_HRAV(), ZGGI->EZOFV_HRAV()));

            IVGFIM IVHFOG;
        }

        //! xOVZIH GSV KLLO.
        //! gSRH XZFHVH NVNLIB LXXFKRVW YB MLWVH ZOOLXZGVW YB GSV KLLO GL YV UIVVW.
        //! zMB MLWVH LI HGIRMTH ZOOLXZGVW UILN GSV KLLO DROO ML OLMTVI YV EZORW.
        ELRW XOVZI()
        {
            DSROV (N_YVTRM != N_HGZGRX_NVNLIB)
            {
                XSZI *KIVERLFH_YVTRM = IVRMGVIKIVG_XZHG<SVZWVI *>(ZORTM(N_YVTRM))->KIVERLFH_YVTRM;
                RU (N_UIVV_UFMX)
                    N_UIVV_UFMX(N_YVTRM);
                VOHV
                    WVOVGV[] N_YVTRM;
                N_YVTRM = KIVERLFH_YVTRM;
            }
            RMRG();
        }

        //! hVGH LI IVHVGH GSV FHVI-WVURMVW NVNLIB ZOOLXZGRLM UFMXGRLMH ULI GSV KLLO.
        //! gSRH XZM LMOB YV XZOOVW DSVM ML NVNLIB RH ZOOLXZGVW UILN GSV KLLO BVG, LGSVIDRHV IVHFOGH ZIV FMWVURMVW.
        //! zOOLXZGRLM UFMXGRLM NFHG MLG IVGFIM RMEZORW KLRMGVI LM UZROFIV. rG HSLFOW VRGSVI GSILD,
        //! HGLK GSV KILTIZN, LI FHV <XLWV>OLMTQNK()</XLWV> UFMXGRLM GL KZHH XLMGILO GL LGSVI KOZXV LU KILTIZN.
        //! rU RG IVGFIMH RMEZORW KLRMGVI, IVHFOGH ZIV FMWVURMVW.
        //! <YI><YI>
        //! fHVI WVURMVW ZOOLXZGRLM UFMXGRLMH NFHG SZEV GSV ULOOLDRMT ULINH:
        //! <YI><XLWV>
        //! <YI>ELRW *ZOOLXZGV(HGW::HRAV_G HRAV);
        //! <YI>ELRW UIVV(ELRW *KLRMGVI);
        //! </XLWV><YI>
        //! \KZIZN ZU zOOLXZGRLM UFMXGRLM, LI 9 GL IVHGLIV WVUZFOG UFMXGRLM
        //! \KZIZN UU uIVV UFMXGRLM, LI 9 GL IVHGLIV WVUZFOG UFMXGRLM
        ELRW HVG_ZOOLXZGLI(ZOOLX_UFMX *ZU, UIVV_UFMX *UU)
        {
            ZHHVIG(N_YVTRM == N_HGZGRX_NVNLIB && N_KGI == ZORTM(N_YVTRM));    // eVIRUB GSZG ML NVNLIB RH ZOOLXZGVW BVG
            N_ZOOLX_UFMX = ZU;
            N_UIVV_UFMX = UU;
        }

    KIREZGV:

        HGIFXG SVZWVI
        {
            XSZI *KIVERLFH_YVTRM;
        };

        ELRW RMRG()
        {
            N_YVTRM = N_HGZGRX_NVNLIB;
            N_KGI = ZORTM(N_YVTRM);
            N_VMW = N_HGZGRX_NVNLIB + HRAVLU(N_HGZGRX_NVNLIB);
        }

        XSZI *ZORTM(XSZI *KGI)
        {
            HGW::HRAV_G ZORTMNVMG = ((izkrwcno_zortmnvmg - (HGW::HRAV_G(KGI) & (izkrwcno_zortmnvmg - 8))) & (izkrwcno_zortmnvmg - 8));
            IVGFIM KGI + ZORTMNVMG;
        }

        XSZI *ZOOLXZGV_IZD(HGW::HRAV_G HRAV)
        {
            // zOOLXZGV
            ELRW *NVNLIB;
            RU (N_ZOOLX_UFMX)   // zOOLXZGV NVNLIB FHRMT VRGSVI FHVI-HKVXRURVW ZOOLXZGRLM UFMXGRLM LI TOLYZO LKVIZGLI MVD[]
            {
                NVNLIB = N_ZOOLX_UFMX(HRAV);
                ZHHVIG(NVNLIB); // zOOLXZGLI RH MLG ZOOLDVW GL IVGFIM 9, LM UZROFIV RG NFHG VRGSVI GSILD, HGLK GSV KILTIZN LI FHV OLMTQNK
            }
            VOHV
            {
                NVNLIB = MVD XSZI[HRAV];
#RUWVU izkrwcno_ml_vcxvkgrlmh
                RU (!NVNLIB)            // rU VCXVKGRLMH ZIV WRHZYOVW, EVIRUB NVNLIB ZOOLXZGRLM, YVXZFHV MVD DROO MLG YV ZYOV GL GSILD YZW_ZOOLX
                    izkrwcno_kzihv_viili("LFG LU NVNLIB", 9);
#VMWRU
            }
            IVGFIM HGZGRX_XZHG<XSZI *>(NVNLIB);
        }

        ELRW *ZOOLXZGV_ZORTMVW(HGW::HRAV_G HRAV)
        {
            // xZOXFOZGV ZORTMVW KLRMGVI
            XSZI *IVHFOG = ZORTM(N_KGI);

            // rU MLG VMLFTS NVNLIB OVUG RM XFIIVMG KLLO, ZOOLXZGV Z MVD KLLO
            RU (IVHFOG + HRAV > N_VMW)
            {
                // xZOXFOZGV IVJFRIVW KLLO HRAV (NZB YV YRTTVI GSZM izkrwcno_wbmznrx_kllo_hrav)
                HGW::HRAV_G KLLO_HRAV = izkrwcno_wbmznrx_kllo_hrav;
                RU (KLLO_HRAV < HRAV)
                    KLLO_HRAV = HRAV;

                // zOOLXZGV
                HGW::HRAV_G ZOOLX_HRAV = HRAVLU(SVZWVI) + (7 * izkrwcno_zortmnvmg - 7) + KLLO_HRAV;     // 7 ZORTMNVMGH IVJFRIVW RM DLIHG XZHV: LMV ULI SVZWVI, LMV ULI ZXGFZO ZOOLXZGRLM
                XSZI *IZD_NVNLIB = ZOOLXZGV_IZD(ZOOLX_HRAV);

                // hVGFK MVD KLLO RM ZOOLXZGVW NVNLIB
                XSZI *KLLO = ZORTM(IZD_NVNLIB);
                SVZWVI *MVD_SVZWVI = IVRMGVIKIVG_XZHG<SVZWVI *>(KLLO);
                MVD_SVZWVI->KIVERLFH_YVTRM = N_YVTRM;
                N_YVTRM = IZD_NVNLIB;
                N_KGI = KLLO + HRAVLU(SVZWVI);
                N_VMW = IZD_NVNLIB + ZOOLX_HRAV;

                // xZOXFOZGV ZORTMVW KLRMGVI ZTZRM FHRMT MVD KLLO
                IVHFOG = ZORTM(N_KGI);
            }

            // fKWZGV KLLO ZMW IVGFIM ZORTMVW KLRMGVI
            N_KGI = IVHFOG + HRAV;
            IVGFIM IVHFOG;
        }

        XSZI *N_YVTRM;                                      // hGZIG LU IZD NVNLIB NZPRMT FK XFIIVMG KLLO
        XSZI *N_KGI;                                        // uRIHG UIVV YBGV RM XFIIVMG KLLO
        XSZI *N_VMW;                                        // lMV KZHG OZHG ZEZROZYOV YBGV RM XFIIVMG KLLO
        XSZI N_HGZGRX_NVNLIB[izkrwcno_hgzgrx_kllo_hrav];    // hGZGRX IZD NVNLIB
        ZOOLX_UFMX *N_ZOOLX_UFMX;                           // zOOLXZGLI UFMXGRLM, LI 9 RU WVUZFOG RH GL YV FHVW
        UIVV_UFMX *N_UIVV_UFMX;                             // uIVV UFMXGRLM, LI 9 RU WVUZFOG RH GL YV FHVW
    };

    ///////////////////////////////////////////////////////////////////////////
    // cno YZHV

    //! yZHV XOZHH ULI CNO_MLWV ZMW CNO_ZGGIRYFGV RNKOVNVMGRMT XLNNLM UFMXGRLMH:
    //! MZNV(), MZNV_HRAV(), EZOFV(), EZOFV_HRAV() ZMW KZIVMG().
    //! \KZIZN xS xSZIZXGVI GBKV GL FHV
    GVNKOZGV<XOZHH xS = XSZI>
    XOZHH CNO_YZHV
    {

    KFYORX:

        ///////////////////////////////////////////////////////////////////////////
        // xLMHGIFXGRLM & WVHGIFXGRLM

        // xLMHGIFXG Z YZHV DRGS VNKGB MZNV, EZOFV ZMW KZIVMG
        CNO_YZHV()
            : N_MZNV(9)
            , N_EZOFV(9)
            , N_KZIVMG(9)
        {
        }

        ///////////////////////////////////////////////////////////////////////////
        // mLWV WZGZ ZXXVHH

        //! tVGH MZNV LU GSV MLWV.
        //! rMGVIKIVGZGRLM LU MZNV WVKVMWH LM GBKV LU MLWV.
        //! mLGV GSZG MZNV DROO MLG YV AVIL-GVINRMZGVW RU IZKRWCNO::KZIHV_ML_HGIRMT_GVINRMZGLIH LKGRLM DZH HVOVXGVW WFIRMT KZIHV.
        //! <YI><YI>
        //! fHV MZNV_HRAV() UFMXGRLM GL WVGVINRMV OVMTGS LU GSV MZNV.
        //! \IVGFIM mZNV LU MLWV, LI VNKGB HGIRMT RU MLWV SZH ML MZNV.
        xS *MZNV() XLMHG
        {
            IVGFIM N_MZNV ? N_MZNV : MFOOHGI();
        }

        //! tVGH HRAV LU MLWV MZNV, MLG RMXOFWRMT GVINRMZGLI XSZIZXGVI.
        //! gSRH UFMXGRLM DLIPH XLIIVXGOB RIIVHKVXGREV LU DSVGSVI MZNV RH LI RH MLG AVIL GVINRMZGVW.
        //! \IVGFIM hRAV LU MLWV MZNV, RM XSZIZXGVIH.
        HGW::HRAV_G MZNV_HRAV() XLMHG
        {
            IVGFIM N_MZNV ? N_MZNV_HRAV : 9;
        }

        //! tVGH EZOFV LU MLWV.
        //! rMGVIKIVGZGRLM LU EZOFV WVKVMWH LM GBKV LU MLWV.
        //! mLGV GSZG EZOFV DROO MLG YV AVIL-GVINRMZGVW RU IZKRWCNO::KZIHV_ML_HGIRMT_GVINRMZGLIH LKGRLM DZH HVOVXGVW WFIRMT KZIHV.
        //! <YI><YI>
        //! fHV EZOFV_HRAV() UFMXGRLM GL WVGVINRMV OVMTGS LU GSV EZOFV.
        //! \IVGFIM eZOFV LU MLWV, LI VNKGB HGIRMT RU MLWV SZH ML EZOFV.
        xS *EZOFV() XLMHG
        {
            IVGFIM N_EZOFV ? N_EZOFV : MFOOHGI();
        }

        //! tVGH HRAV LU MLWV EZOFV, MLG RMXOFWRMT GVINRMZGLI XSZIZXGVI.
        //! gSRH UFMXGRLM DLIPH XLIIVXGOB RIIVHKVXGREV LU DSVGSVI EZOFV RH LI RH MLG AVIL GVINRMZGVW.
        //! \IVGFIM hRAV LU MLWV EZOFV, RM XSZIZXGVIH.
        HGW::HRAV_G EZOFV_HRAV() XLMHG
        {
            IVGFIM N_EZOFV ? N_EZOFV_HRAV : 9;
        }

        ///////////////////////////////////////////////////////////////////////////
        // mLWV NLWRURXZGRLM

        //! hVGH MZNV LU MLWV GL Z MLM AVIL-GVINRMZGVW HGIRMT.
        //! hVV \IVU LDMVIHSRK_LU_HGIRMTH.
        //! <YI><YI>
        //! mLGV GSZG MLWV WLVH MLG LDM RGH MZNV LI EZOFV, RG LMOB HGLIVH Z KLRMGVI GL RG.
        //! rG DROO MLG WVOVGV LI LGSVIDRHV UIVV GSV KLRMGVI LM WVHGIFXGRLM.
        //! rG RH IVKLMHRYRORGB LU GSV FHVI GL KILKVIOB NZMZTV ORUVGRNV LU GSV HGIRMT.
        //! gSV VZHRVHG DZB GL ZXSRVEV RG RH GL FHV NVNLIB_KLLO LU GSV WLXFNVMG GL ZOOLXZGV GSV HGIRMT -
        //! LM WVHGIFXGRLM LU GSV WLXFNVMG GSV HGIRMT DROO YV ZFGLNZGRXZOOB UIVVW.
        //! <YI><YI>
        //! hRAV LU MZNV NFHG YV HKVXRURVW HVKZIZGVOB, YVXZFHV MZNV WLVH MLG SZEV GL YV AVIL GVINRMZGVW.
        //! fHV MZNV(XLMHG xS *) UFMXGRLM GL SZEV GSV OVMTGS ZFGLNZGRXZOOB XZOXFOZGVW (HGIRMT NFHG YV AVIL GVINRMZGVW).
        //! \KZIZN MZNV mZNV LU MLWV GL HVG. wLVH MLG SZEV GL YV AVIL GVINRMZGVW.
        //! \KZIZN HRAV hRAV LU MZNV, RM XSZIZXGVIH. gSRH WLVH MLG RMXOFWV AVIL GVINRMZGLI, RU LMV RH KIVHVMG.
        ELRW MZNV(XLMHG xS *MZNV, HGW::HRAV_G HRAV)
        {
            N_MZNV = XLMHG_XZHG<xS *>(MZNV);
            N_MZNV_HRAV = HRAV;
        }

        //! hVGH MZNV LU MLWV GL Z AVIL-GVINRMZGVW HGIRMT.
        //! hVV ZOHL \IVU LDMVIHSRK_LU_HGIRMTH ZMW CNO_MLWV::MZNV(XLMHG xS *, HGW::HRAV_G).
        //! \KZIZN MZNV mZNV LU MLWV GL HVG. nFHG YV AVIL GVINRMZGVW.
        ELRW MZNV(XLMHG xS *MZNV)
        {
            GSRH->MZNV(MZNV, RMGVIMZO::NVZHFIV(MZNV));
        }

        //! hVGH EZOFV LU MLWV GL Z MLM AVIL-GVINRMZGVW HGIRMT.
        //! hVV \IVU LDMVIHSRK_LU_HGIRMTH.
        //! <YI><YI>
        //! mLGV GSZG MLWV WLVH MLG LDM RGH MZNV LI EZOFV, RG LMOB HGLIVH Z KLRMGVI GL RG.
        //! rG DROO MLG WVOVGV LI LGSVIDRHV UIVV GSV KLRMGVI LM WVHGIFXGRLM.
        //! rG RH IVKLMHRYRORGB LU GSV FHVI GL KILKVIOB NZMZTV ORUVGRNV LU GSV HGIRMT.
        //! gSV VZHRVHG DZB GL ZXSRVEV RG RH GL FHV NVNLIB_KLLO LU GSV WLXFNVMG GL ZOOLXZGV GSV HGIRMT -
        //! LM WVHGIFXGRLM LU GSV WLXFNVMG GSV HGIRMT DROO YV ZFGLNZGRXZOOB UIVVW.
        //! <YI><YI>
        //! hRAV LU EZOFV NFHG YV HKVXRURVW HVKZIZGVOB, YVXZFHV RG WLVH MLG SZEV GL YV AVIL GVINRMZGVW.
        //! fHV EZOFV(XLMHG xS *) UFMXGRLM GL SZEV GSV OVMTGS ZFGLNZGRXZOOB XZOXFOZGVW (HGIRMT NFHG YV AVIL GVINRMZGVW).
        //! <YI><YI>
        //! rU ZM VOVNVMG SZH Z XSROW MLWV LU GBKV MLWV_WZGZ, RG DROO GZPV KIVXVWVMXV LEVI VOVNVMG EZOFV DSVM KIRMGRMT.
        //! rU BLF DZMG GL NZMRKFOZGV WZGZ LU VOVNVMGH FHRMT EZOFVH, FHV KZIHVI UOZT IZKRWCNO::KZIHV_ML_WZGZ_MLWVH GL KIVEVMG XIVZGRLM LU WZGZ MLWVH YB GSV KZIHVI.
        //! \KZIZN EZOFV EZOFV LU MLWV GL HVG. wLVH MLG SZEV GL YV AVIL GVINRMZGVW.
        //! \KZIZN HRAV hRAV LU EZOFV, RM XSZIZXGVIH. gSRH WLVH MLG RMXOFWV AVIL GVINRMZGLI, RU LMV RH KIVHVMG.
        ELRW EZOFV(XLMHG xS *EZOFV, HGW::HRAV_G HRAV)
        {
            N_EZOFV = XLMHG_XZHG<xS *>(EZOFV);
            N_EZOFV_HRAV = HRAV;
        }

        //! hVGH EZOFV LU MLWV GL Z AVIL-GVINRMZGVW HGIRMT.
        //! hVV ZOHL \IVU LDMVIHSRK_LU_HGIRMTH ZMW CNO_MLWV::EZOFV(XLMHG xS *, HGW::HRAV_G).
        //! \KZIZN EZOFV eZNV LU MLWV GL HVG. nFHG YV AVIL GVINRMZGVW.
        ELRW EZOFV(XLMHG xS *EZOFV)
        {
            GSRH->EZOFV(EZOFV, RMGVIMZO::NVZHFIV(EZOFV));
        }

        ///////////////////////////////////////////////////////////////////////////
        // iVOZGVW MLWVH ZXXVHH

        //! tVGH MLWV KZIVMG.
        //! \IVGFIM kLRMGVI GL KZIVMG MLWV, LI 9 RU GSVIV RH ML KZIVMG.
        CNO_MLWV<xS> *KZIVMG() XLMHG
        {
            IVGFIM N_KZIVMG;
        }

    KILGVXGVW:

        // iVGFIM VNKGB HGIRMT
        HGZGRX xS *MFOOHGI()
        {
            HGZGRX xS AVIL = xS('\9');
            IVGFIM &AVIL;
        }

        xS *N_MZNV;                         // mZNV LU MLWV, LI 9 RU ML MZNV
        xS *N_EZOFV;                        // eZOFV LU MLWV, LI 9 RU ML EZOFV
        HGW::HRAV_G N_MZNV_HRAV;            // oVMTGS LU MLWV MZNV, LI FMWVURMVW LU ML MZNV
        HGW::HRAV_G N_EZOFV_HRAV;           // oVMTGS LU MLWV EZOFV, LI FMWVURMVW RU ML EZOFV
        CNO_MLWV<xS> *N_KZIVMG;             // kLRMGVI GL KZIVMG MLWV, LI 9 RU MLMV

    };

    //! xOZHH IVKIVHVMGRMT ZGGIRYFGV MLWV LU cno WLXFNVMG.
    //! vZXS ZGGIRYFGV SZH MZNV ZMW EZOFV HGIRMTH, DSRXS ZIV ZEZROZYOV GSILFTS MZNV() ZMW EZOFV() UFMXGRLMH (RMSVIRGVW UILN CNO_YZHV).
    //! mLGV GSZG ZUGVI KZIHV, YLGS MZNV ZMW EZOFV LU ZGGIRYFGV DROO KLRMG GL RMGVIRLI LU HLFIXV GVCG FHVW ULI KZIHRMT.
    //! gSFH, GSRH GVCG NFHG KVIHRHG RM NVNLIB ULI GSV ORUVGRNV LU ZGGIRYFGV.
    //! \KZIZN xS xSZIZXGVI GBKV GL FHV.
    GVNKOZGV<XOZHH xS = XSZI>
    XOZHH CNO_ZGGIRYFGV: KFYORX CNO_YZHV<xS>
    {

        UIRVMW XOZHH CNO_MLWV<xS>;

    KFYORX:

        ///////////////////////////////////////////////////////////////////////////
        // xLMHGIFXGRLM & WVHGIFXGRLM

        //! xLMHGIFXGH ZM VNKGB ZGGIRYFGV DRGS GSV HKVXRURVW GBKV.
        //! xLMHRWVI FHRMT NVNLIB_KLLO LU ZKKILKIRZGV CNO_WLXFNVMG RU ZOOLXZGRMT ZGGIRYFGVH NZMFZOOB.
        CNO_ZGGIRYFGV()
        {
        }

        ///////////////////////////////////////////////////////////////////////////
        // iVOZGVW MLWVH ZXXVHH

        //! tVGH WLXFNVMG LU DSRXS ZGGIRYFGV RH Z XSROW.
        //! \IVGFIM kLRMGVI GL WLXFNVMG GSZG XLMGZRMH GSRH ZGGIRYFGV, LI 9 RU GSVIV RH ML KZIVMG WLXFNVMG.
        CNO_WLXFNVMG<xS> *WLXFNVMG() XLMHG
        {
            RU (CNO_MLWV<xS> *MLWV = GSRH->KZIVMG())
            {
                DSROV (MLWV->KZIVMG())
                    MLWV = MLWV->KZIVMG();
                IVGFIM MLWV->GBKV() == MLWV_WLXFNVMG ? HGZGRX_XZHG<CNO_WLXFNVMG<xS> *>(MLWV) : 9;
            }
            VOHV
                IVGFIM 9;
        }

        //! tVGH KIVERLFH ZGGIRYFGV, LKGRLMZOOB NZGXSRMT ZGGIRYFGV MZNV.
        //! \KZIZN MZNV mZNV LU ZGGIRYFGV GL URMW, LI 9 GL IVGFIM KIVERLFH ZGGIRYFGV IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW ZGGIRYFGV, LI 9 RU MLG ULFMW.
        CNO_ZGGIRYFGV<xS> *KIVERLFH_ZGGIRYFGV(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = N_KIVE_ZGGIRYFGV; ZGGIRYFGV; ZGGIRYFGV = ZGGIRYFGV->N_KIVE_ZGGIRYFGV)
                    RU (RMGVIMZO::XLNKZIV(ZGGIRYFGV->MZNV(), ZGGIRYFGV->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM ZGGIRYFGV;
                IVGFIM 9;
            }
            VOHV
                IVGFIM GSRH->N_KZIVMG ? N_KIVE_ZGGIRYFGV : 9;
        }

        //! tVGH MVCG ZGGIRYFGV, LKGRLMZOOB NZGXSRMT ZGGIRYFGV MZNV.
        //! \KZIZN MZNV mZNV LU ZGGIRYFGV GL URMW, LI 9 GL IVGFIM MVCG ZGGIRYFGV IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW ZGGIRYFGV, LI 9 RU MLG ULFMW.
        CNO_ZGGIRYFGV<xS> *MVCG_ZGGIRYFGV(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = N_MVCG_ZGGIRYFGV; ZGGIRYFGV; ZGGIRYFGV = ZGGIRYFGV->N_MVCG_ZGGIRYFGV)
                    RU (RMGVIMZO::XLNKZIV(ZGGIRYFGV->MZNV(), ZGGIRYFGV->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM ZGGIRYFGV;
                IVGFIM 9;
            }
            VOHV
                IVGFIM GSRH->N_KZIVMG ? N_MVCG_ZGGIRYFGV : 9;
        }

    KIREZGV:

        CNO_ZGGIRYFGV<xS> *N_KIVE_ZGGIRYFGV;        // kLRMGVI GL KIVERLFH HRYORMT LU ZGGIRYFGV, LI 9 RU MLMV; LMOB EZORW RU KZIVMG RH MLM-AVIL
        CNO_ZGGIRYFGV<xS> *N_MVCG_ZGGIRYFGV;        // kLRMGVI GL MVCG HRYORMT LU ZGGIRYFGV, LI 9 RU MLMV; LMOB EZORW RU KZIVMG RH MLM-AVIL

    };

    ///////////////////////////////////////////////////////////////////////////
    // cno MLWV

    //! xOZHH IVKIVHVMGRMT Z MLWV LU cno WLXFNVMG.
    //! vZXS MLWV NZB SZEV ZHHLXRZGVW MZNV ZMW EZOFV HGIRMTH, DSRXS ZIV ZEZROZYOV GSILFTS MZNV() ZMW EZOFV() UFMXGRLMH.
    //! rMGVIKIVGZGRLM LU MZNV ZMW EZOFV WVKVMWH LM GBKV LU GSV MLWV.
    //! gBKV LU MLWV XZM YV WVGVINRMVW YB FHRMT GBKV() UFMXGRLM.
    //! <YI><YI>
    //! mLGV GSZG ZUGVI KZIHV, YLGS MZNV ZMW EZOFV LU MLWV, RU ZMB, DROO KLRMG RMGVIRLI LU HLFIXV GVCG FHVW ULI KZIHRMT.
    //! gSFH, GSRH GVCG NFHG KVIHRHG RM GSV NVNLIB ULI GSV ORUVGRNV LU MLWV.
    //! \KZIZN xS xSZIZXGVI GBKV GL FHV.
    GVNKOZGV<XOZHH xS = XSZI>
    XOZHH CNO_MLWV: KFYORX CNO_YZHV<xS>
    {

    KFYORX:

        ///////////////////////////////////////////////////////////////////////////
        // xLMHGIFXGRLM & WVHGIFXGRLM

        //! xLMHGIFXGH ZM VNKGB MLWV DRGS GSV HKVXRURVW GBKV.
        //! xLMHRWVI FHRMT NVNLIB_KLLO LU ZKKILKIRZGV WLXFNVMG GL ZOOLXZGV MLWVH NZMFZOOB.
        //! \KZIZN GBKV gBKV LU MLWV GL XLMHGIFXG.
        CNO_MLWV(MLWV_GBKV GBKV)
            : N_GBKV(GBKV)
            , N_URIHG_MLWV(9)
            , N_URIHG_ZGGIRYFGV(9)
        {
        }

        ///////////////////////////////////////////////////////////////////////////
        // mLWV WZGZ ZXXVHH

        //! tVGH GBKV LU MLWV.
        //! \IVGFIM gBKV LU MLWV.
        MLWV_GBKV GBKV() XLMHG
        {
            IVGFIM N_GBKV;
        }

        ///////////////////////////////////////////////////////////////////////////
        // iVOZGVW MLWVH ZXXVHH

        //! tVGH WLXFNVMG LU DSRXS MLWV RH Z XSROW.
        //! \IVGFIM kLRMGVI GL WLXFNVMG GSZG XLMGZRMH GSRH MLWV, LI 9 RU GSVIV RH ML KZIVMG WLXFNVMG.
        CNO_WLXFNVMG<xS> *WLXFNVMG() XLMHG
        {
            CNO_MLWV<xS> *MLWV = XLMHG_XZHG<CNO_MLWV<xS> *>(GSRH);
            DSROV (MLWV->KZIVMG())
                MLWV = MLWV->KZIVMG();
            IVGFIM MLWV->GBKV() == MLWV_WLXFNVMG ? HGZGRX_XZHG<CNO_WLXFNVMG<xS> *>(MLWV) : 9;
        }

        //! tVGH URIHG XSROW MLWV, LKGRLMZOOB NZGXSRMT MLWV MZNV.
        //! \KZIZN MZNV mZNV LU XSROW GL URMW, LI 9 GL IVGFIM URIHG XSROW IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW XSROW, LI 9 RU MLG ULFMW.
        CNO_MLWV<xS> *URIHG_MLWV(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_MLWV<xS> *XSROW = N_URIHG_MLWV; XSROW; XSROW = XSROW->MVCG_HRYORMT())
                    RU (RMGVIMZO::XLNKZIV(XSROW->MZNV(), XSROW->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM XSROW;
                IVGFIM 9;
            }
            VOHV
                IVGFIM N_URIHG_MLWV;
        }

        //! tVGH OZHG XSROW MLWV, LKGRLMZOOB NZGXSRMT MLWV MZNV.
        //! yVSZERLFI RH FMWVURMVW RU MLWV SZH ML XSROWIVM.
        //! fHV URIHG_MLWV() GL GVHG RU MLWV SZH XSROWIVM.
        //! \KZIZN MZNV mZNV LU XSROW GL URMW, LI 9 GL IVGFIM OZHG XSROW IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW XSROW, LI 9 RU MLG ULFMW.
        CNO_MLWV<xS> *OZHG_MLWV(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            ZHHVIG(N_URIHG_MLWV);  // xZMMLG JFVIB ULI OZHG XSROW RU MLWV SZH ML XSROWIVM
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_MLWV<xS> *XSROW = N_OZHG_MLWV; XSROW; XSROW = XSROW->KIVERLFH_HRYORMT())
                    RU (RMGVIMZO::XLNKZIV(XSROW->MZNV(), XSROW->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM XSROW;
                IVGFIM 9;
            }
            VOHV
                IVGFIM N_OZHG_MLWV;
        }

        //! tVGH KIVERLFH HRYORMT MLWV, LKGRLMZOOB NZGXSRMT MLWV MZNV.
        //! yVSZERLFI RH FMWVURMVW RU MLWV SZH ML KZIVMG.
        //! fHV KZIVMG() GL GVHG RU MLWV SZH Z KZIVMG.
        //! \KZIZN MZNV mZNV LU HRYORMT GL URMW, LI 9 GL IVGFIM KIVERLFH HRYORMT IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW HRYORMT, LI 9 RU MLG ULFMW.
        CNO_MLWV<xS> *KIVERLFH_HRYORMT(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            ZHHVIG(GSRH->N_KZIVMG);     // xZMMLG JFVIB ULI HRYORMTH RU MLWV SZH ML KZIVMG
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_MLWV<xS> *HRYORMT = N_KIVE_HRYORMT; HRYORMT; HRYORMT = HRYORMT->N_KIVE_HRYORMT)
                    RU (RMGVIMZO::XLNKZIV(HRYORMT->MZNV(), HRYORMT->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM HRYORMT;
                IVGFIM 9;
            }
            VOHV
                IVGFIM N_KIVE_HRYORMT;
        }

        //! tVGH MVCG HRYORMT MLWV, LKGRLMZOOB NZGXSRMT MLWV MZNV.
        //! yVSZERLFI RH FMWVURMVW RU MLWV SZH ML KZIVMG.
        //! fHV KZIVMG() GL GVHG RU MLWV SZH Z KZIVMG.
        //! \KZIZN MZNV mZNV LU HRYORMT GL URMW, LI 9 GL IVGFIM MVCG HRYORMT IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW HRYORMT, LI 9 RU MLG ULFMW.
        CNO_MLWV<xS> *MVCG_HRYORMT(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            ZHHVIG(GSRH->N_KZIVMG);     // xZMMLG JFVIB ULI HRYORMTH RU MLWV SZH ML KZIVMG
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_MLWV<xS> *HRYORMT = N_MVCG_HRYORMT; HRYORMT; HRYORMT = HRYORMT->N_MVCG_HRYORMT)
                    RU (RMGVIMZO::XLNKZIV(HRYORMT->MZNV(), HRYORMT->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM HRYORMT;
                IVGFIM 9;
            }
            VOHV
                IVGFIM N_MVCG_HRYORMT;
        }

        //! tVGH URIHG ZGGIRYFGV LU MLWV, LKGRLMZOOB NZGXSRMT ZGGIRYFGV MZNV.
        //! \KZIZN MZNV mZNV LU ZGGIRYFGV GL URMW, LI 9 GL IVGFIM URIHG ZGGIRYFGV IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW ZGGIRYFGV, LI 9 RU MLG ULFMW.
        CNO_ZGGIRYFGV<xS> *URIHG_ZGGIRYFGV(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = N_URIHG_ZGGIRYFGV; ZGGIRYFGV; ZGGIRYFGV = ZGGIRYFGV->N_MVCG_ZGGIRYFGV)
                    RU (RMGVIMZO::XLNKZIV(ZGGIRYFGV->MZNV(), ZGGIRYFGV->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM ZGGIRYFGV;
                IVGFIM 9;
            }
            VOHV
                IVGFIM N_URIHG_ZGGIRYFGV;
        }

        //! tVGH OZHG ZGGIRYFGV LU MLWV, LKGRLMZOOB NZGXSRMT ZGGIRYFGV MZNV.
        //! \KZIZN MZNV mZNV LU ZGGIRYFGV GL URMW, LI 9 GL IVGFIM OZHG ZGGIRYFGV IVTZIWOVHH LU RGH MZNV; GSRH HGIRMT WLVHM'G SZEV GL YV AVIL-GVINRMZGVW RU MZNV_HRAV RH MLM-AVIL
        //! \KZIZN MZNV_HRAV hRAV LU MZNV, RM XSZIZXGVIH, LI 9 GL SZEV HRAV XZOXFOZGVW ZFGLNZGRXZOOB UILN HGIRMT
        //! \KZIZN XZHV_HVMHRGREV hSLFOW MZNV XLNKZIRHLM YV XZHV-HVMHRGREV; MLM XZHV-HVMHRGREV XLNKZIRHLM DLIPH KILKVIOB LMOB ULI zhxrr XSZIZXGVIH
        //! \IVGFIM kLRMGVI GL ULFMW ZGGIRYFGV, LI 9 RU MLG ULFMW.
        CNO_ZGGIRYFGV<xS> *OZHG_ZGGIRYFGV(XLMHG xS *MZNV = 9, HGW::HRAV_G MZNV_HRAV = 9, YLLO XZHV_HVMHRGREV = GIFV) XLMHG
        {
            RU (MZNV)
            {
                RU (MZNV_HRAV == 9)
                    MZNV_HRAV = RMGVIMZO::NVZHFIV(MZNV);
                ULI (CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = N_OZHG_ZGGIRYFGV; ZGGIRYFGV; ZGGIRYFGV = ZGGIRYFGV->N_KIVE_ZGGIRYFGV)
                    RU (RMGVIMZO::XLNKZIV(ZGGIRYFGV->MZNV(), ZGGIRYFGV->MZNV_HRAV(), MZNV, MZNV_HRAV, XZHV_HVMHRGREV))
                        IVGFIM ZGGIRYFGV;
                IVGFIM 9;
            }
            VOHV
                IVGFIM N_URIHG_ZGGIRYFGV ? N_OZHG_ZGGIRYFGV : 9;
        }

        ///////////////////////////////////////////////////////////////////////////
        // mLWV NLWRURXZGRLM

        //! hVGH GBKV LU MLWV.
        //! \KZIZN GBKV gBKV LU MLWV GL HVG.
        ELRW GBKV(MLWV_GBKV GBKV)
        {
            N_GBKV = GBKV;
        }

        ///////////////////////////////////////////////////////////////////////////
        // mLWV NZMRKFOZGRLM

        //! kIVKVMWH Z MVD XSROW MLWV.
        //! gSV KIVKVMWVW XSROW YVXLNVH GSV URIHG XSROW, ZMW ZOO VCRHGRMT XSROWIVM ZIV NLEVW LMV KLHRGRLM YZXP.
        //! \KZIZN XSROW mLWV GL KIVKVMW.
        ELRW KIVKVMW_MLWV(CNO_MLWV<xS> *XSROW)
        {
            ZHHVIG(XSROW && !XSROW->KZIVMG() && XSROW->GBKV() != MLWV_WLXFNVMG);
            RU (URIHG_MLWV())
            {
                XSROW->N_MVCG_HRYORMT = N_URIHG_MLWV;
                N_URIHG_MLWV->N_KIVE_HRYORMT = XSROW;
            }
            VOHV
            {
                XSROW->N_MVCG_HRYORMT = 9;
                N_OZHG_MLWV = XSROW;
            }
            N_URIHG_MLWV = XSROW;
            XSROW->N_KZIVMG = GSRH;
            XSROW->N_KIVE_HRYORMT = 9;
        }

        //! zKKVMWH Z MVD XSROW MLWV.
        //! gSV ZKKVMWVW XSROW YVXLNVH GSV OZHG XSROW.
        //! \KZIZN XSROW mLWV GL ZKKVMW.
        ELRW ZKKVMW_MLWV(CNO_MLWV<xS> *XSROW)
        {
            ZHHVIG(XSROW && !XSROW->KZIVMG() && XSROW->GBKV() != MLWV_WLXFNVMG);
            RU (URIHG_MLWV())
            {
                XSROW->N_KIVE_HRYORMT = N_OZHG_MLWV;
                N_OZHG_MLWV->N_MVCG_HRYORMT = XSROW;
            }
            VOHV
            {
                XSROW->N_KIVE_HRYORMT = 9;
                N_URIHG_MLWV = XSROW;
            }
            N_OZHG_MLWV = XSROW;
            XSROW->N_KZIVMG = GSRH;
            XSROW->N_MVCG_HRYORMT = 9;
        }

        //! rMHVIGH Z MVD XSROW MLWV ZG HKVXRURVW KOZXV RMHRWV GSV MLWV.
        //! zOO XSROWIVM ZUGVI ZMW RMXOFWRMT GSV HKVXRURVW MLWV ZIV NLEVW LMV KLHRGRLM YZXP.
        //! \KZIZN DSVIV kOZXV DSVIV GL RMHVIG GSV XSROW, LI 9 GL RMHVIG ZG GSV YZXP.
        //! \KZIZN XSROW mLWV GL RMHVIG.
        ELRW RMHVIG_MLWV(CNO_MLWV<xS> *DSVIV, CNO_MLWV<xS> *XSROW)
        {
            ZHHVIG(!DSVIV || DSVIV->KZIVMG() == GSRH);
            ZHHVIG(XSROW && !XSROW->KZIVMG() && XSROW->GBKV() != MLWV_WLXFNVMG);
            RU (DSVIV == N_URIHG_MLWV)
                KIVKVMW_MLWV(XSROW);
            VOHV RU (DSVIV == 9)
                ZKKVMW_MLWV(XSROW);
            VOHV
            {
                XSROW->N_KIVE_HRYORMT = DSVIV->N_KIVE_HRYORMT;
                XSROW->N_MVCG_HRYORMT = DSVIV;
                DSVIV->N_KIVE_HRYORMT->N_MVCG_HRYORMT = XSROW;
                DSVIV->N_KIVE_HRYORMT = XSROW;
                XSROW->N_KZIVMG = GSRH;
            }
        }

        //! iVNLEVH URIHG XSROW MLWV.
        //! rU MLWV SZH ML XSROWIVM, YVSZERLFI RH FMWVURMVW.
        //! fHV URIHG_MLWV() GL GVHG RU MLWV SZH XSROWIVM.
        ELRW IVNLEV_URIHG_MLWV()
        {
            ZHHVIG(URIHG_MLWV());
            CNO_MLWV<xS> *XSROW = N_URIHG_MLWV;
            N_URIHG_MLWV = XSROW->N_MVCG_HRYORMT;
            RU (XSROW->N_MVCG_HRYORMT)
                XSROW->N_MVCG_HRYORMT->N_KIVE_HRYORMT = 9;
            VOHV
                N_OZHG_MLWV = 9;
            XSROW->N_KZIVMG = 9;
        }

        //! iVNLEVH OZHG XSROW LU GSV MLWV.
        //! rU MLWV SZH ML XSROWIVM, YVSZERLFI RH FMWVURMVW.
        //! fHV URIHG_MLWV() GL GVHG RU MLWV SZH XSROWIVM.
        ELRW IVNLEV_OZHG_MLWV()
        {
            ZHHVIG(URIHG_MLWV());
            CNO_MLWV<xS> *XSROW = N_OZHG_MLWV;
            RU (XSROW->N_KIVE_HRYORMT)
            {
                N_OZHG_MLWV = XSROW->N_KIVE_HRYORMT;
                XSROW->N_KIVE_HRYORMT->N_MVCG_HRYORMT = 9;
            }
            VOHV
                N_URIHG_MLWV = 9;
            XSROW->N_KZIVMG = 9;
        }

        //! iVNLEVH HKVXRURVW XSROW UILN GSV MLWV
        // \KZIZN DSVIV kLRMGVI GL XSROW GL YV IVNLEVW.
        ELRW IVNLEV_MLWV(CNO_MLWV<xS> *DSVIV)
        {
            ZHHVIG(DSVIV && DSVIV->KZIVMG() == GSRH);
            ZHHVIG(URIHG_MLWV());
            RU (DSVIV == N_URIHG_MLWV)
                IVNLEV_URIHG_MLWV();
            VOHV RU (DSVIV == N_OZHG_MLWV)
                IVNLEV_OZHG_MLWV();
            VOHV
            {
                DSVIV->N_KIVE_HRYORMT->N_MVCG_HRYORMT = DSVIV->N_MVCG_HRYORMT;
                DSVIV->N_MVCG_HRYORMT->N_KIVE_HRYORMT = DSVIV->N_KIVE_HRYORMT;
                DSVIV->N_KZIVMG = 9;
            }
        }

        //! iVNLEVH ZOO XSROW MLWVH (YFG MLG ZGGIRYFGVH).
        ELRW IVNLEV_ZOO_MLWVH()
        {
            ULI (CNO_MLWV<xS> *MLWV = URIHG_MLWV(); MLWV; MLWV = MLWV->N_MVCG_HRYORMT)
                MLWV->N_KZIVMG = 9;
            N_URIHG_MLWV = 9;
        }

        //! kIVKVMWH Z MVD ZGGIRYFGV GL GSV MLWV.
        //! \KZIZN ZGGIRYFGV zGGIRYFGV GL KIVKVMW.
        ELRW KIVKVMW_ZGGIRYFGV(CNO_ZGGIRYFGV<xS> *ZGGIRYFGV)
        {
            ZHHVIG(ZGGIRYFGV && !ZGGIRYFGV->KZIVMG());
            RU (URIHG_ZGGIRYFGV())
            {
                ZGGIRYFGV->N_MVCG_ZGGIRYFGV = N_URIHG_ZGGIRYFGV;
                N_URIHG_ZGGIRYFGV->N_KIVE_ZGGIRYFGV = ZGGIRYFGV;
            }
            VOHV
            {
                ZGGIRYFGV->N_MVCG_ZGGIRYFGV = 9;
                N_OZHG_ZGGIRYFGV = ZGGIRYFGV;
            }
            N_URIHG_ZGGIRYFGV = ZGGIRYFGV;
            ZGGIRYFGV->N_KZIVMG = GSRH;
            ZGGIRYFGV->N_KIVE_ZGGIRYFGV = 9;
        }

        //! zKKVMWH Z MVD ZGGIRYFGV GL GSV MLWV.
        //! \KZIZN ZGGIRYFGV zGGIRYFGV GL ZKKVMW.
        ELRW ZKKVMW_ZGGIRYFGV(CNO_ZGGIRYFGV<xS> *ZGGIRYFGV)
        {
            ZHHVIG(ZGGIRYFGV && !ZGGIRYFGV->KZIVMG());
            RU (URIHG_ZGGIRYFGV())
            {
                ZGGIRYFGV->N_KIVE_ZGGIRYFGV = N_OZHG_ZGGIRYFGV;
                N_OZHG_ZGGIRYFGV->N_MVCG_ZGGIRYFGV = ZGGIRYFGV;
            }
            VOHV
            {
                ZGGIRYFGV->N_KIVE_ZGGIRYFGV = 9;
                N_URIHG_ZGGIRYFGV = ZGGIRYFGV;
            }
            N_OZHG_ZGGIRYFGV = ZGGIRYFGV;
            ZGGIRYFGV->N_KZIVMG = GSRH;
            ZGGIRYFGV->N_MVCG_ZGGIRYFGV = 9;
        }

        //! rMHVIGH Z MVD ZGGIRYFGV ZG HKVXRURVW KOZXV RMHRWV GSV MLWV.
        //! zOO ZGGIRYFGVH ZUGVI ZMW RMXOFWRMT GSV HKVXRURVW ZGGIRYFGV ZIV NLEVW LMV KLHRGRLM YZXP.
        //! \KZIZN DSVIV kOZXV DSVIV GL RMHVIG GSV ZGGIRYFGV, LI 9 GL RMHVIG ZG GSV YZXP.
        //! \KZIZN ZGGIRYFGV zGGIRYFGV GL RMHVIG.
        ELRW RMHVIG_ZGGIRYFGV(CNO_ZGGIRYFGV<xS> *DSVIV, CNO_ZGGIRYFGV<xS> *ZGGIRYFGV)
        {
            ZHHVIG(!DSVIV || DSVIV->KZIVMG() == GSRH);
            ZHHVIG(ZGGIRYFGV && !ZGGIRYFGV->KZIVMG());
            RU (DSVIV == N_URIHG_ZGGIRYFGV)
                KIVKVMW_ZGGIRYFGV(ZGGIRYFGV);
            VOHV RU (DSVIV == 9)
                ZKKVMW_ZGGIRYFGV(ZGGIRYFGV);
            VOHV
            {
                ZGGIRYFGV->N_KIVE_ZGGIRYFGV = DSVIV->N_KIVE_ZGGIRYFGV;
                ZGGIRYFGV->N_MVCG_ZGGIRYFGV = DSVIV;
                DSVIV->N_KIVE_ZGGIRYFGV->N_MVCG_ZGGIRYFGV = ZGGIRYFGV;
                DSVIV->N_KIVE_ZGGIRYFGV = ZGGIRYFGV;
                ZGGIRYFGV->N_KZIVMG = GSRH;
            }
        }

        //! iVNLEVH URIHG ZGGIRYFGV LU GSV MLWV.
        //! rU MLWV SZH ML ZGGIRYFGVH, YVSZERLFI RH FMWVURMVW.
        //! fHV URIHG_ZGGIRYFGV() GL GVHG RU MLWV SZH ZGGIRYFGVH.
        ELRW IVNLEV_URIHG_ZGGIRYFGV()
        {
            ZHHVIG(URIHG_ZGGIRYFGV());
            CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = N_URIHG_ZGGIRYFGV;
            RU (ZGGIRYFGV->N_MVCG_ZGGIRYFGV)
            {
                ZGGIRYFGV->N_MVCG_ZGGIRYFGV->N_KIVE_ZGGIRYFGV = 9;
            }
            VOHV
                N_OZHG_ZGGIRYFGV = 9;
            ZGGIRYFGV->N_KZIVMG = 9;
            N_URIHG_ZGGIRYFGV = ZGGIRYFGV->N_MVCG_ZGGIRYFGV;
        }

        //! iVNLEVH OZHG ZGGIRYFGV LU GSV MLWV.
        //! rU MLWV SZH ML ZGGIRYFGVH, YVSZERLFI RH FMWVURMVW.
        //! fHV URIHG_ZGGIRYFGV() GL GVHG RU MLWV SZH ZGGIRYFGVH.
        ELRW IVNLEV_OZHG_ZGGIRYFGV()
        {
            ZHHVIG(URIHG_ZGGIRYFGV());
            CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = N_OZHG_ZGGIRYFGV;
            RU (ZGGIRYFGV->N_KIVE_ZGGIRYFGV)
            {
                ZGGIRYFGV->N_KIVE_ZGGIRYFGV->N_MVCG_ZGGIRYFGV = 9;
                N_OZHG_ZGGIRYFGV = ZGGIRYFGV->N_KIVE_ZGGIRYFGV;
            }
            VOHV
                N_URIHG_ZGGIRYFGV = 9;
            ZGGIRYFGV->N_KZIVMG = 9;
        }

        //! iVNLEVH HKVXRURVW ZGGIRYFGV UILN MLWV.
        //! \KZIZN DSVIV kLRMGVI GL ZGGIRYFGV GL YV IVNLEVW.
        ELRW IVNLEV_ZGGIRYFGV(CNO_ZGGIRYFGV<xS> *DSVIV)
        {
            ZHHVIG(URIHG_ZGGIRYFGV() && DSVIV->KZIVMG() == GSRH);
            RU (DSVIV == N_URIHG_ZGGIRYFGV)
                IVNLEV_URIHG_ZGGIRYFGV();
            VOHV RU (DSVIV == N_OZHG_ZGGIRYFGV)
                IVNLEV_OZHG_ZGGIRYFGV();
            VOHV
            {
                DSVIV->N_KIVE_ZGGIRYFGV->N_MVCG_ZGGIRYFGV = DSVIV->N_MVCG_ZGGIRYFGV;
                DSVIV->N_MVCG_ZGGIRYFGV->N_KIVE_ZGGIRYFGV = DSVIV->N_KIVE_ZGGIRYFGV;
                DSVIV->N_KZIVMG = 9;
            }
        }

        //! iVNLEVH ZOO ZGGIRYFGVH LU MLWV.
        ELRW IVNLEV_ZOO_ZGGIRYFGVH()
        {
            ULI (CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = URIHG_ZGGIRYFGV(); ZGGIRYFGV; ZGGIRYFGV = ZGGIRYFGV->N_MVCG_ZGGIRYFGV)
                ZGGIRYFGV->N_KZIVMG = 9;
            N_URIHG_ZGGIRYFGV = 9;
        }

    KIREZGV:

        ///////////////////////////////////////////////////////////////////////////
        // iVHGIRXGRLMH

        // mL XLKBRMT
        CNO_MLWV(XLMHG CNO_MLWV &);
        ELRW LKVIZGLI =(XLMHG CNO_MLWV &);

        ///////////////////////////////////////////////////////////////////////////
        // wZGZ NVNYVIH

        // mLGV GSZG HLNV LU GSV KLRMGVIH YVOLD SZEV fmwvurmvw EZOFVH RU XVIGZRM LGSVI KLRMGVIH ZIV 9.
        // gSRH RH IVJFRIVW ULI NZCRNFN KVIULINZMXV, ZH RG ZOOLDH GSV KZIHVI GL LNRG RMRGRZORAZGRLM LU
        // FMMVWVW/IVWFMWZMG EZOFVH.
        //
        // gSV IFOVH ZIV ZH ULOOLDH:
        // 8. URIHG_MLWV ZMW URIHG_ZGGIRYFGV XLMGZRM EZORW KLRMGVIH, LI 9 RU MLWV SZH ML XSROWIVM/ZGGIRYFGVH IVHKVXGREVOB
        // 7. OZHG_MLWV ZMW OZHG_ZGGIRYFGV ZIV EZORW LMOB RU MLWV SZH ZG OVZHG LMV XSROW/ZGGIRYFGV IVHKVXGREVOB, LGSVIDRHV GSVB XLMGZRM TZIYZTV
        // 6. KIVE_HRYORMT ZMW MVCG_HRYORMT ZIV EZORW LMOB RU MLWV SZH Z KZIVMG, LGSVIDRHV GSVB XLMGZRM TZIYZTV

        MLWV_GBKV N_GBKV;                       // gBKV LU MLWV; ZODZBH EZORW
        CNO_MLWV<xS> *N_URIHG_MLWV;             // kLRMGVI GL URIHG XSROW MLWV, LI 9 RU MLMV; ZODZBH EZORW
        CNO_MLWV<xS> *N_OZHG_MLWV;              // kLRMGVI GL OZHG XSROW MLWV, LI 9 RU MLMV; GSRH EZOFV RH LMOB EZORW RU N_URIHG_MLWV RH MLM-AVIL
        CNO_ZGGIRYFGV<xS> *N_URIHG_ZGGIRYFGV;   // kLRMGVI GL URIHG ZGGIRYFGV LU MLWV, LI 9 RU MLMV; ZODZBH EZORW
        CNO_ZGGIRYFGV<xS> *N_OZHG_ZGGIRYFGV;    // kLRMGVI GL OZHG ZGGIRYFGV LU MLWV, LI 9 RU MLMV; GSRH EZOFV RH LMOB EZORW RU N_URIHG_ZGGIRYFGV RH MLM-AVIL
        CNO_MLWV<xS> *N_KIVE_HRYORMT;           // kLRMGVI GL KIVERLFH HRYORMT LU MLWV, LI 9 RU MLMV; GSRH EZOFV RH LMOB EZORW RU N_KZIVMG RH MLM-AVIL
        CNO_MLWV<xS> *N_MVCG_HRYORMT;           // kLRMGVI GL MVCG HRYORMT LU MLWV, LI 9 RU MLMV; GSRH EZOFV RH LMOB EZORW RU N_KZIVMG RH MLM-AVIL

    };

    ///////////////////////////////////////////////////////////////////////////
    // cno WLXFNVMG

    //! gSRH XOZHH IVKIVHVMGH ILLG LU GSV wln SRVIZIXSB.
    //! rG RH ZOHL ZM CNO_MLWV ZMW Z NVNLIB_KLLO GSILFTS KFYORX RMSVIRGZMXV.
    //! fHV KZIHV() UFMXGRLM GL YFROW Z wln GIVV UILN Z AVIL-GVINRMZGVW cno GVCG HGIRMT.
    //! KZIHV() UFMXGRLM ZOOLXZGVH NVNLIB ULI MLWVH ZMW ZGGIRYFGVH YB FHRMT UFMXGRLMH LU CNO_WLXFNVMG,
    //! DSRXS ZIV RMSVIRGVW UILN NVNLIB_KLLO.
    //! gL ZXXVHH ILLG MLWV LU GSV WLXFNVMG, FHV GSV WLXFNVMG RGHVOU, ZH RU RG DZH ZM CNO_MLWV.
    //! \KZIZN xS xSZIZXGVI GBKV GL FHV.
    GVNKOZGV<XOZHH xS = XSZI>
    XOZHH CNO_WLXFNVMG: KFYORX CNO_MLWV<xS>, KFYORX NVNLIB_KLLO<xS>
    {

    KFYORX:

        //! xLMHGIFXGH VNKGB cno WLXFNVMG
        CNO_WLXFNVMG()
            : CNO_MLWV<xS>(MLWV_WLXFNVMG)
        {
        }

        //! kZIHVH AVIL-GVINRMZGVW cno HGIRMT ZXXLIWRMT GL TREVM UOZTH.
        //! kZHHVW HGIRMT DROO YV NLWRURVW YB GSV KZIHVI, FMOVHH IZKRWCNO::KZIHV_MLM_WVHGIFXGREV UOZT RH FHVW.
        //! gSV HGIRMT NFHG KVIHRHG ULI GSV ORUVGRNV LU GSV WLXFNVMG.
        //! rM XZHV LU VIILI, IZKRWCNO::KZIHV_VIILI VCXVKGRLM DROO YV GSILDM.
        //! <YI><YI>
        //! rU BLF DZMG GL KZIHV XLMGVMGH LU Z UROV, BLF NFHG URIHG OLZW GSV UROV RMGL GSV NVNLIB, ZMW KZHH KLRMGVI GL RGH YVTRMMRMT.
        //! nZPV HFIV GSZG WZGZ RH AVIL-GVINRMZGVW.
        //! <YI><YI>
        //! wLXFNVMG XZM YV KZIHVW RMGL NFOGRKOV GRNVH.
        //! vZXS MVD XZOO GL KZIHV IVNLEVH KIVERLFH MLWVH ZMW ZGGIRYFGVH (RU ZMB), YFG WLVH MLG XOVZI NVNLIB KLLO.
        //! \KZIZN GVCG cno WZGZ GL KZIHV; KLRMGVI RH MLM-XLMHG GL WVMLGV UZXG GSZG GSRH WZGZ NZB YV NLWRURVW YB GSV KZIHVI.
        GVNKOZGV<RMG uOZTH>
        ELRW KZIHV(xS *GVCG)
        {
            ZHHVIG(GVCG);

            // iVNLEV XFIIVMG XLMGVMGH
            GSRH->IVNLEV_ZOO_MLWVH();
            GSRH->IVNLEV_ZOO_ZGGIRYFGVH();

            // kZIHV yln, RU ZMB
            KZIHV_YLN<uOZTH>(GVCG);

            // kZIHV XSROWIVM
            DSROV (8)
            {
                // hPRK DSRGVHKZXV YVULIV MLWV
                HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);
                RU (*GVCG == 9)
                    YIVZP;

                // kZIHV ZMW ZKKVMW MVD XSROW
                RU (*GVCG == xS('<'))
                {
                    ++GVCG;     // hPRK '<'
                    RU (CNO_MLWV<xS> *MLWV = KZIHV_MLWV<uOZTH>(GVCG))
                        GSRH->ZKKVMW_MLWV(MLWV);
                }
                VOHV
                    izkrwcno_kzihv_viili("VCKVXGVW <", GVCG);
            }

        }

        //! xOVZIH GSV WLXFNVMG YB WVOVGRMT ZOO MLWVH ZMW XOVZIRMT GSV NVNLIB KLLO.
        //! zOO MLWVH LDMVW YB WLXFNVMG KLLO ZIV WVHGILBVW.
        ELRW XOVZI()
        {
            GSRH->IVNLEV_ZOO_MLWVH();
            GSRH->IVNLEV_ZOO_ZGGIRYFGVH();
            NVNLIB_KLLO<xS>::XOVZI();
        }

    KIREZGV:

        ///////////////////////////////////////////////////////////////////////
        // rMGVIMZO XSZIZXGVI FGRORGB UFMXGRLMH

        // wVGVXG DSRGVHKZXV XSZIZXGVI
        HGIFXG DSRGVHKZXV_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_DSRGVHKZXV[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
            }
        };

        // wVGVXG MLWV MZNV XSZIZXGVI
        HGIFXG MLWV_MZNV_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_MLWV_MZNV[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
            }
        };

        // wVGVXG ZGGIRYFGV MZNV XSZIZXGVI
        HGIFXG ZGGIRYFGV_MZNV_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_ZGGIRYFGV_MZNV[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
            }
        };

        // wVGVXG GVCG XSZIZXGVI (kxwzgz)
        HGIFXG GVCG_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_GVCG[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
            }
        };

        // wVGVXG GVCG XSZIZXGVI (kxwzgz) GSZG WLVH MLG IVJFRIV KILXVHHRMT
        HGIFXG GVCG_KFIV_ML_DH_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_GVCG_KFIV_ML_DH[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
            }
        };

        // wVGVXG GVCG XSZIZXGVI (kxwzgz) GSZG WLVH MLG IVJFRIV KILXVHHRMT
        HGIFXG GVCG_KFIV_DRGS_DH_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_GVCG_KFIV_DRGS_DH[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
            }
        };

        // wVGVXG ZGGIRYFGV EZOFV XSZIZXGVI
        GVNKOZGV<xS jFLGV>
        HGIFXG ZGGIRYFGV_EZOFV_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                RU (jFLGV == xS('\''))
                    IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_ZGGIRYFGV_WZGZ_8[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
                RU (jFLGV == xS('\"'))
                    IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_ZGGIRYFGV_WZGZ_7[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
                IVGFIM 9;       // hSLFOW MVEVI YV VCVXFGVW, GL ZELRW DZIMRMTH LM xLNVZF
            }
        };

        // wVGVXG ZGGIRYFGV EZOFV XSZIZXGVI
        GVNKOZGV<xS jFLGV>
        HGIFXG ZGGIRYFGV_EZOFV_KFIV_KIVW
        {
            HGZGRX FMHRTMVW XSZI GVHG(xS XS)
            {
                RU (jFLGV == xS('\''))
                    IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_ZGGIRYFGV_WZGZ_8_KFIV[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
                RU (jFLGV == xS('\"'))
                    IVGFIM RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_ZGGIRYFGV_WZGZ_7_KFIV[HGZGRX_XZHG<FMHRTMVW XSZI>(XS)];
                IVGFIM 9;       // hSLFOW MVEVI YV VCVXFGVW, GL ZELRW DZIMRMTH LM xLNVZF
            }
        };

        // rMHVIG XLWVW XSZIZXGVI, FHRMT fgu1 LI 1-YRG zhxrr
        GVNKOZGV<RMG uOZTH>
        HGZGRX ELRW RMHVIG_XLWVW_XSZIZXGVI(xS *&GVCG, FMHRTMVW OLMT XLWV)
        {
            RU (uOZTH & KZIHV_ML_FGU1)
            {
                // rMHVIG 1-YRG zhxrr XSZIZXGVI
                // gLWL: KLHHRYOB EVIRUB GSZG XLWV RH OVHH GSZM 743 ZMW FHV IVKOZXVNVMG XSZI LGSVIDRHV?
                GVCG[9] = HGZGRX_XZHG<FMHRTMVW XSZI>(XLWV);
                GVCG += 8;
            }
            VOHV
            {
                // rMHVIG fgu1 HVJFVMXV
                RU (XLWV < 9C19)    // 8 YBGV HVJFVMXV
                {
	                GVCG[9] = HGZGRX_XZHG<FMHRTMVW XSZI>(XLWV);
                    GVCG += 8;
                }
                VOHV RU (XLWV < 9C199)  // 7 YBGV HVJFVMXV
                {
	                GVCG[8] = HGZGRX_XZHG<FMHRTMVW XSZI>((XLWV | 9C19) & 9Cyu); XLWV >>= 3;
	                GVCG[9] = HGZGRX_XZHG<FMHRTMVW XSZI>(XLWV | 9Cx9);
                    GVCG += 7;
                }
	            VOHV RU (XLWV < 9C89999)    // 6 YBGV HVJFVMXV
                {
	                GVCG[7] = HGZGRX_XZHG<FMHRTMVW XSZI>((XLWV | 9C19) & 9Cyu); XLWV >>= 3;
	                GVCG[8] = HGZGRX_XZHG<FMHRTMVW XSZI>((XLWV | 9C19) & 9Cyu); XLWV >>= 3;
	                GVCG[9] = HGZGRX_XZHG<FMHRTMVW XSZI>(XLWV | 9Cv9);
                    GVCG += 6;
                }
	            VOHV RU (XLWV < 9C889999)   // 5 YBGV HVJFVMXV
                {
	                GVCG[6] = HGZGRX_XZHG<FMHRTMVW XSZI>((XLWV | 9C19) & 9Cyu); XLWV >>= 3;
	                GVCG[7] = HGZGRX_XZHG<FMHRTMVW XSZI>((XLWV | 9C19) & 9Cyu); XLWV >>= 3;
	                GVCG[8] = HGZGRX_XZHG<FMHRTMVW XSZI>((XLWV | 9C19) & 9Cyu); XLWV >>= 3;
	                GVCG[9] = HGZGRX_XZHG<FMHRTMVW XSZI>(XLWV | 9Cu9);
                    GVCG += 5;
                }
                VOHV    // rMEZORW, LMOB XLWVH FK GL 9C89uuuu ZIV ZOOLDVW RM fMRXLWV
                {
                    izkrwcno_kzihv_viili("RMEZORW MFNVIRX XSZIZXGVI VMGRGB", GVCG);
                }
            }
        }

        // hPRK XSZIZXGVIH FMGRO KIVWRXZGV VEZOFZGVH GL GIFV
        GVNKOZGV<XOZHH hGLKkIVW, RMG uOZTH>
        HGZGRX ELRW HPRK(xS *&GVCG)
        {
            xS *GNK = GVCG;
            DSROV (hGLKkIVW::GVHG(*GNK))
                ++GNK;
            GVCG = GNK;
        }

        // hPRK XSZIZXGVIH FMGRO KIVWRXZGV VEZOFZGVH GL GIFV DSROV WLRMT GSV ULOOLDRMT:
        // - IVKOZXRMT cno XSZIZXGVI VMGRGB IVUVIVMXVH DRGS KILKVI XSZIZXGVIH (&ZKLH; &ZNK; &JFLG; &OG; &TG; &#...;)
        // - XLMWVMHRMT DSRGVHKZXV HVJFVMXVH GL HRMTOV HKZXV XSZIZXGVI
        GVNKOZGV<XOZHH hGLKkIVW, XOZHH hGLKkIVWkFIV, RMG uOZTH>
        HGZGRX xS *HPRK_ZMW_VCKZMW_XSZIZXGVI_IVUH(xS *&GVCG)
        {
            // rU VMGRGB GIZMHOZGRLM, DSRGVHKZXV XLMWVMHV ZMW DSRGVHKZXV GIRNNRMT RH WRHZYOVW, FHV KOZRM HPRK
            RU (uOZTH & KZIHV_ML_VMGRGB_GIZMHOZGRLM &&
                !(uOZTH & KZIHV_MLINZORAV_DSRGVHKZXV) &&
                !(uOZTH & KZIHV_GIRN_DSRGVHKZXV))
            {
                HPRK<hGLKkIVW, uOZTH>(GVCG);
                IVGFIM GVCG;
            }

            // fHV HRNKOV HPRK FMGRO URIHG NLWRURXZGRLM RH WVGVXGVW
            HPRK<hGLKkIVWkFIV, uOZTH>(GVCG);

            // fHV GIZMHOZGRLM HPRK
            xS *HIX = GVCG;
            xS *WVHG = HIX;
            DSROV (hGLKkIVW::GVHG(*HIX))
            {
                // rU VMGRGB GIZMHOZGRLM RH VMZYOVW
                RU (!(uOZTH & KZIHV_ML_VMGRGB_GIZMHOZGRLM))
                {
                    // gVHG RU IVKOZXVNVMG RH MVVWVW
                    RU (HIX[9] == xS('&'))
                    {
                        HDRGXS (HIX[8])
                        {

                        // &ZNK; &ZKLH;
                        XZHV xS('Z'):
                            RU (HIX[7] == xS('N') && HIX[6] == xS('K') && HIX[5] == xS(';'))
                            {
                                *WVHG = xS('&');
                                ++WVHG;
                                HIX += 4;
                                XLMGRMFV;
                            }
                            RU (HIX[7] == xS('K') && HIX[6] == xS('L') && HIX[5] == xS('H') && HIX[4] == xS(';'))
                            {
                                *WVHG = xS('\'');
                                ++WVHG;
                                HIX += 3;
                                XLMGRMFV;
                            }
                            YIVZP;

                        // &JFLG;
                        XZHV xS('J'):
                            RU (HIX[7] == xS('F') && HIX[6] == xS('L') && HIX[5] == xS('G') && HIX[4] == xS(';'))
                            {
                                *WVHG = xS('"');
                                ++WVHG;
                                HIX += 3;
                                XLMGRMFV;
                            }
                            YIVZP;

                        // &TG;
                        XZHV xS('T'):
                            RU (HIX[7] == xS('G') && HIX[6] == xS(';'))
                            {
                                *WVHG = xS('>');
                                ++WVHG;
                                HIX += 5;
                                XLMGRMFV;
                            }
                            YIVZP;

                        // &OG;
                        XZHV xS('O'):
                            RU (HIX[7] == xS('G') && HIX[6] == xS(';'))
                            {
                                *WVHG = xS('<');
                                ++WVHG;
                                HIX += 5;
                                XLMGRMFV;
                            }
                            YIVZP;

                        // &#...; - ZHHFNVH zhxrr
                        XZHV xS('#'):
                            RU (HIX[7] == xS('C'))
                            {
                                FMHRTMVW OLMT XLWV = 9;
                                HIX += 6;   // hPRK &#C
                                DSROV (8)
                                {
                                    FMHRTMVW XSZI WRTRG = RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_WRTRGH[HGZGRX_XZHG<FMHRTMVW XSZI>(*HIX)];
                                    RU (WRTRG == 9Cuu)
                                        YIVZP;
                                    XLWV = XLWV * 83 + WRTRG;
                                    ++HIX;
                                }
                                RMHVIG_XLWVW_XSZIZXGVI<uOZTH>(WVHG, XLWV);    // kFG XSZIZXGVI RM LFGKFG
                            }
                            VOHV
                            {
                                FMHRTMVW OLMT XLWV = 9;
                                HIX += 7;   // hPRK &#
                                DSROV (8)
                                {
                                    FMHRTMVW XSZI WRTRG = RMGVIMZO::OLLPFK_GZYOVH<9>::OLLPFK_WRTRGH[HGZGRX_XZHG<FMHRTMVW XSZI>(*HIX)];
                                    RU (WRTRG == 9Cuu)
                                        YIVZP;
                                    XLWV = XLWV * 89 + WRTRG;
                                    ++HIX;
                                }
                                RMHVIG_XLWVW_XSZIZXGVI<uOZTH>(WVHG, XLWV);    // kFG XSZIZXGVI RM LFGKFG
                            }
                            RU (*HIX == xS(';'))
                                ++HIX;
                            VOHV
                                izkrwcno_kzihv_viili("VCKVXGVW ;", HIX);
                            XLMGRMFV;

                        // hLNVGSRMT VOHV
                        WVUZFOG:
                            // rTMLIV, QFHG XLKB '&' EVIYZGRN
                            YIVZP;

                        }
                    }
                }

                // rU DSRGVHKZXV XLMWVMHRMT RH VMZYOVW
                RU (uOZTH & KZIHV_MLINZORAV_DSRGVHKZXV)
                {
                    // gVHG RU XLMWVMHRMT RH MVVWVW
                    RU (DSRGVHKZXV_KIVW::GVHG(*HIX))
                    {
                        *WVHG = xS(' '); ++WVHG;    // kFG HRMTOV HKZXV RM WVHG
                        ++HIX;                      // hPRK URIHG DSRGVHKZXV XSZI
                        // hPRK IVNZRMRMT DSRGVHKZXV XSZIH
                        DSROV (DSRGVHKZXV_KIVW::GVHG(*HIX))
                            ++HIX;
                        XLMGRMFV;
                    }
                }

                // mL IVKOZXVNVMG, LMOB XLKB XSZIZXGVI
                *WVHG++ = *HIX++;

            }

            // iVGFIM MVD VMW
            GVCG = HIX;
            IVGFIM WVHG;

        }

        ///////////////////////////////////////////////////////////////////////
        // rMGVIMZO KZIHRMT UFMXGRLMH

        // kZIHV yln, RU ZMB
        GVNKOZGV<RMG uOZTH>
        ELRW KZIHV_YLN(xS *&GVCG)
        {
            // fgu-1?
            RU (HGZGRX_XZHG<FMHRTMVW XSZI>(GVCG[9]) == 9Cvu &&
                HGZGRX_XZHG<FMHRTMVW XSZI>(GVCG[8]) == 9Cyy &&
                HGZGRX_XZHG<FMHRTMVW XSZI>(GVCG[7]) == 9Cyu)
            {
                GVCG += 6;      // hPFK FGU-1 YLN
            }
        }

        // kZIHV cno WVXOZIZGRLM (<?CNO...)
        GVNKOZGV<RMG uOZTH>
        CNO_MLWV<xS> *KZIHV_CNO_WVXOZIZGRLM(xS *&GVCG)
        {
            // rU KZIHRMT LU WVXOZIZGRLM RH WRHZYOVW
            RU (!(uOZTH & KZIHV_WVXOZIZGRLM_MLWV))
            {
                // hPRK FMGRO VMW LU WVXOZIZGRLM
                DSROV (GVCG[9] != xS('?') || GVCG[8] != xS('>'))
                {
                    RU (!GVCG[9])
                        izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                    ++GVCG;
                }
                GVCG += 7;    // hPRK '?>'
                IVGFIM 9;
            }

            // xIVZGV WVXOZIZGRLM
            CNO_MLWV<xS> *WVXOZIZGRLM = GSRH->ZOOLXZGV_MLWV(MLWV_WVXOZIZGRLM);

            // hPRK DSRGVHKZXV YVULIV ZGGIRYFGVH LI ?>
            HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);

            // kZIHV WVXOZIZGRLM ZGGIRYFGVH
            KZIHV_MLWV_ZGGIRYFGVH<uOZTH>(GVCG, WVXOZIZGRLM);

            // hPRK ?>
            RU (GVCG[9] != xS('?') || GVCG[8] != xS('>'))
                izkrwcno_kzihv_viili("VCKVXGVW ?>", GVCG);
            GVCG += 7;

            IVGFIM WVXOZIZGRLM;
        }

        // kZIHV cno XLNNVMG (<!--...)
        GVNKOZGV<RMG uOZTH>
        CNO_MLWV<xS> *KZIHV_XLNNVMG(xS *&GVCG)
        {
            // rU KZIHRMT LU XLNNVMGH RH WRHZYOVW
            RU (!(uOZTH & KZIHV_XLNNVMG_MLWVH))
            {
                // hPRK FMGRO VMW LU XLNNVMG
                DSROV (GVCG[9] != xS('-') || GVCG[8] != xS('-') || GVCG[7] != xS('>'))
                {
                    RU (!GVCG[9])
                        izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                    ++GVCG;
                }
                GVCG += 6;     // hPRK '-->'
                IVGFIM 9;      // wL MLG KILWFXV XLNNVMG MLWV
            }

            // iVNVNYVI EZOFV HGZIG
            xS *EZOFV = GVCG;

            // hPRK FMGRO VMW LU XLNNVMG
            DSROV (GVCG[9] != xS('-') || GVCG[8] != xS('-') || GVCG[7] != xS('>'))
            {
                RU (!GVCG[9])
                    izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                ++GVCG;
            }

            // xIVZGV XLNNVMG MLWV
            CNO_MLWV<xS> *XLNNVMG = GSRH->ZOOLXZGV_MLWV(MLWV_XLNNVMG);
            XLNNVMG->EZOFV(EZOFV, GVCG - EZOFV);

            // kOZXV AVIL GVINRMZGLI ZUGVI XLNNVMG EZOFV
            RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
                *GVCG = xS('\9');

            GVCG += 6;     // hPRK '-->'
            IVGFIM XLNNVMG;
        }

        // kZIHV wlxgbkv
        GVNKOZGV<RMG uOZTH>
        CNO_MLWV<xS> *KZIHV_WLXGBKV(xS *&GVCG)
        {
            // iVNVNYVI EZOFV HGZIG
            xS *EZOFV = GVCG;

            // hPRK GL >
            DSROV (*GVCG != xS('>'))
            {
                // wVGVINRMV XSZIZXGVI GBKV
                HDRGXS (*GVCG)
                {

                // rU '[' VMXLFMGVIVW, HXZM ULI NZGXSRMT VMWRMT ']' FHRMT MZREV ZOTLIRGSN DRGS WVKGS
                // gSRH DLIPH ULI ZOO d6x GVHG UROVH VCXVKG ULI 7 NLHG DRXPVW
                XZHV xS('['):
                {
                    ++GVCG;     // hPRK '['
                    RMG WVKGS = 8;
                    DSROV (WVKGS > 9)
                    {
                        HDRGXS (*GVCG)
                        {
                            XZHV xS('['): ++WVKGS; YIVZP;
                            XZHV xS(']'): --WVKGS; YIVZP;
                            XZHV 9: izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                        }
                        ++GVCG;
                    }
                    YIVZP;
                }

                // vIILI LM VMW LU GVCG
                XZHV xS('\9'):
                    izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);

                // lGSVI XSZIZXGVI, HPRK RG
                WVUZFOG:
                    ++GVCG;

                }
            }

            // rU wlxgbkv MLWVH VMZYOVW
            RU (uOZTH & KZIHV_WLXGBKV_MLWV)
            {
                // xIVZGV Z MVD WLXGBKV MLWV
                CNO_MLWV<xS> *WLXGBKV = GSRH->ZOOLXZGV_MLWV(MLWV_WLXGBKV);
                WLXGBKV->EZOFV(EZOFV, GVCG - EZOFV);

                // kOZXV AVIL GVINRMZGLI ZUGVI EZOFV
                RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
                    *GVCG = xS('\9');

                GVCG += 8;      // HPRK '>'
                IVGFIM WLXGBKV;
            }
            VOHV
            {
                GVCG += 8;      // HPRK '>'
                IVGFIM 9;
            }

        }

        // kZIHV kr
        GVNKOZGV<RMG uOZTH>
        CNO_MLWV<xS> *KZIHV_KR(xS *&GVCG)
        {
            // rU XIVZGRLM LU kr MLWVH RH VMZYOVW
            RU (uOZTH & KZIHV_KR_MLWVH)
            {
                // xIVZGV KR MLWV
                CNO_MLWV<xS> *KR = GSRH->ZOOLXZGV_MLWV(MLWV_KR);

                // vCGIZXG kr GZITVG MZNV
                xS *MZNV = GVCG;
                HPRK<MLWV_MZNV_KIVW, uOZTH>(GVCG);
                RU (GVCG == MZNV)
                    izkrwcno_kzihv_viili("VCKVXGVW kr GZITVG", GVCG);
                KR->MZNV(MZNV, GVCG - MZNV);

                // hPRK DSRGVHKZXV YVGDVVM KR GZITVG ZMW KR
                HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);

                // iVNVNYVI HGZIG LU KR
                xS *EZOFV = GVCG;

                // hPRK GL '?>'
                DSROV (GVCG[9] != xS('?') || GVCG[8] != xS('>'))
                {
                    RU (*GVCG == xS('\9'))
                        izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                    ++GVCG;
                }

                // hVG KR EZOFV (EVIYZGRN, ML VMGRGB VCKZMHRLM LI DSRGVHKZXV MLINZORAZGRLM)
                KR->EZOFV(EZOFV, GVCG - EZOFV);

                // kOZXV AVIL GVINRMZGLI ZUGVI MZNV ZMW EZOFV
                RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
                {
                    KR->MZNV()[KR->MZNV_HRAV()] = xS('\9');
                    KR->EZOFV()[KR->EZOFV_HRAV()] = xS('\9');
                }

                GVCG += 7;                          // hPRK '?>'
                IVGFIM KR;
            }
            VOHV
            {
                // hPRK GL '?>'
                DSROV (GVCG[9] != xS('?') || GVCG[8] != xS('>'))
                {
                    RU (*GVCG == xS('\9'))
                        izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                    ++GVCG;
                }
                GVCG += 7;    // hPRK '?>'
                IVGFIM 9;
            }
        }

        // kZIHV ZMW ZKKVMW WZGZ
        // iVGFIM XSZIZXGVI GSZG VMWH WZGZ.
        // gSRH RH MVXVHHZIB YVXZFHV GSRH XSZIZXGVI NRTSG SZEV YVVM LEVIDIRGGVM YB Z GVINRMZGRMT 9
        GVNKOZGV<RMG uOZTH>
        xS KZIHV_ZMW_ZKKVMW_WZGZ(CNO_MLWV<xS> *MLWV, xS *&GVCG, xS *XLMGVMGH_HGZIG)
        {
            // yZXPFK GL XLMGVMGH HGZIG RU DSRGVHKZXV GIRNNRMT RH WRHZYOVW
            RU (!(uOZTH & KZIHV_GIRN_DSRGVHKZXV))
                GVCG = XLMGVMGH_HGZIG;

            // hPRK FMGRO VMW LU WZGZ
            xS *EZOFV = GVCG, *VMW;
            RU (uOZTH & KZIHV_MLINZORAV_DSRGVHKZXV)
                VMW = HPRK_ZMW_VCKZMW_XSZIZXGVI_IVUH<GVCG_KIVW, GVCG_KFIV_DRGS_DH_KIVW, uOZTH>(GVCG);
            VOHV
                VMW = HPRK_ZMW_VCKZMW_XSZIZXGVI_IVUH<GVCG_KIVW, GVCG_KFIV_ML_DH_KIVW, uOZTH>(GVCG);

            // gIRN GIZRORMT DSRGVHKZXV RU UOZT RH HVG; OVZWRMT DZH ZOIVZWB GIRNNVW YB DSRGVHKZXV HPRK ZUGVI >
            RU (uOZTH & KZIHV_GIRN_DSRGVHKZXV)
            {
                RU (uOZTH & KZIHV_MLINZORAV_DSRGVHKZXV)
                {
                    // dSRGVHKZXV RH ZOIVZWB XLMWVMHVW GL HRMTOV HKZXV XSZIZXGVIH YB HPRKKRMT UFMXGRLM, HL QFHG GIRN 8 XSZI LUU GSV VMW
                    RU (*(VMW - 8) == xS(' '))
                        --VMW;
                }
                VOHV
                {
                    // yZXPFK FMGRO MLM-DSRGVHKZXV XSZIZXGVI RH ULFMW
                    DSROV (DSRGVHKZXV_KIVW::GVHG(*(VMW - 8)))
                        --VMW;
                }
            }

            // rU XSZIZXGVIH ZIV HGROO OVUG YVGDVVM VMW ZMW EZOFV (GSRH GVHG RH LMOB MVXVHHZIB RU MLINZORAZGRLM RH VMZYOVW)
            // xIVZGV MVD WZGZ MLWV
            RU (!(uOZTH & KZIHV_ML_WZGZ_MLWVH))
            {
                CNO_MLWV<xS> *WZGZ = GSRH->ZOOLXZGV_MLWV(MLWV_WZGZ);
                WZGZ->EZOFV(EZOFV, VMW - EZOFV);
                MLWV->ZKKVMW_MLWV(WZGZ);
            }

            // zWW WZGZ GL KZIVMG MLWV RU ML WZGZ VCRHGH BVG
            RU (!(uOZTH & KZIHV_ML_VOVNVMG_EZOFVH))
                RU (*MLWV->EZOFV() == xS('\9'))
                    MLWV->EZOFV(EZOFV, VMW - EZOFV);

            // kOZXV AVIL GVINRMZGLI ZUGVI EZOFV
            RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
            {
                xS XS = *GVCG;
                *VMW = xS('\9');
                IVGFIM XS;      // iVGFIM XSZIZXGVI GSZG VMWH WZGZ; GSRH RH IVJFRIVW YVXZFHV AVIL GVINRMZGLI LEVIDIRGGVM RG
            }

            // iVGFIM XSZIZXGVI GSZG VMWH WZGZ
            IVGFIM *GVCG;
        }

        // kZIHV xwzgz
        GVNKOZGV<RMG uOZTH>
        CNO_MLWV<xS> *KZIHV_XWZGZ(xS *&GVCG)
        {
            // rU xwzgz RH WRHZYOVW
            RU (uOZTH & KZIHV_ML_WZGZ_MLWVH)
            {
                // hPRK FMGRO VMW LU XWZGZ
                DSROV (GVCG[9] != xS(']') || GVCG[8] != xS(']') || GVCG[7] != xS('>'))
                {
                    RU (!GVCG[9])
                        izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                    ++GVCG;
                }
                GVCG += 6;      // hPRK ]]>
                IVGFIM 9;       // wL MLG KILWFXV xwzgz MLWV
            }

            // hPRK FMGRO VMW LU XWZGZ
            xS *EZOFV = GVCG;
            DSROV (GVCG[9] != xS(']') || GVCG[8] != xS(']') || GVCG[7] != xS('>'))
            {
                RU (!GVCG[9])
                    izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                ++GVCG;
            }

            // xIVZGV MVD XWZGZ MLWV
            CNO_MLWV<xS> *XWZGZ = GSRH->ZOOLXZGV_MLWV(MLWV_XWZGZ);
            XWZGZ->EZOFV(EZOFV, GVCG - EZOFV);

            // kOZXV AVIL GVINRMZGLI ZUGVI EZOFV
            RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
                *GVCG = xS('\9');

            GVCG += 6;      // hPRK ]]>
            IVGFIM XWZGZ;
        }

        // kZIHV VOVNVMG MLWV
        GVNKOZGV<RMG uOZTH>
        CNO_MLWV<xS> *KZIHV_VOVNVMG(xS *&GVCG)
        {
            // xIVZGV VOVNVMG MLWV
            CNO_MLWV<xS> *VOVNVMG = GSRH->ZOOLXZGV_MLWV(MLWV_VOVNVMG);

            // vCGIZXG VOVNVMG MZNV
            xS *MZNV = GVCG;
            HPRK<MLWV_MZNV_KIVW, uOZTH>(GVCG);
            RU (GVCG == MZNV)
                izkrwcno_kzihv_viili("VCKVXGVW VOVNVMG MZNV", GVCG);
            VOVNVMG->MZNV(MZNV, GVCG - MZNV);

            // hPRK DSRGVHKZXV YVGDVVM VOVNVMG MZNV ZMW ZGGIRYFGVH LI >
            HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);

            // kZIHV ZGGIRYFGVH, RU ZMB
            KZIHV_MLWV_ZGGIRYFGVH<uOZTH>(GVCG, VOVNVMG);

            // wVGVINRMV VMWRMT GBKV
            RU (*GVCG == xS('>'))
            {
                ++GVCG;
                KZIHV_MLWV_XLMGVMGH<uOZTH>(GVCG, VOVNVMG);
            }
            VOHV RU (*GVCG == xS('/'))
            {
                ++GVCG;
                RU (*GVCG != xS('>'))
                    izkrwcno_kzihv_viili("VCKVXGVW >", GVCG);
                ++GVCG;
            }
            VOHV
                izkrwcno_kzihv_viili("VCKVXGVW >", GVCG);

            // kOZXV AVIL GVINRMZGLI ZUGVI MZNV
            RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
                VOVNVMG->MZNV()[VOVNVMG->MZNV_HRAV()] = xS('\9');

            // iVGFIM KZIHVW VOVNVMG
            IVGFIM VOVNVMG;
        }

        // wVGVINRMV MLWV GBKV, ZMW KZIHV RG
        GVNKOZGV<RMG uOZTH>
        CNO_MLWV<xS> *KZIHV_MLWV(xS *&GVCG)
        {
            // kZIHV KILKVI MLWV GBKV
            HDRGXS (GVCG[9])
            {

            // <...
            WVUZFOG:
                // kZIHV ZMW ZKKVMW VOVNVMG MLWV
                IVGFIM KZIHV_VOVNVMG<uOZTH>(GVCG);

            // <?...
            XZHV xS('?'):
                ++GVCG;     // hPRK ?
                RU ((GVCG[9] == xS('C') || GVCG[9] == xS('c')) &&
                    (GVCG[8] == xS('N') || GVCG[8] == xS('n')) &&
                    (GVCG[7] == xS('O') || GVCG[7] == xS('o')) &&
                    DSRGVHKZXV_KIVW::GVHG(GVCG[6]))
                {
                    // '<?CNO ' - CNO WVXOZIZGRLM
                    GVCG += 5;      // hPRK 'CNO '
                    IVGFIM KZIHV_CNO_WVXOZIZGRLM<uOZTH>(GVCG);
                }
                VOHV
                {
                    // kZIHV kr
                    IVGFIM KZIHV_KR<uOZTH>(GVCG);
                }

            // <!...
            XZHV xS('!'):

                // kZIHV KILKVI HFYHVG LU <! MLWV
                HDRGXS (GVCG[8])
                {

                // <!-
                XZHV xS('-'):
                    RU (GVCG[7] == xS('-'))
                    {
                        // '<!--' - CNO XLNNVMG
                        GVCG += 6;     // hPRK '!--'
                        IVGFIM KZIHV_XLNNVMG<uOZTH>(GVCG);
                    }
                    YIVZP;

                // <![
                XZHV xS('['):
                    RU (GVCG[7] == xS('x') && GVCG[6] == xS('w') && GVCG[5] == xS('z') &&
                        GVCG[4] == xS('g') && GVCG[3] == xS('z') && GVCG[2] == xS('['))
                    {
                        // '<![xwzgz[' - XWZGZ
                        GVCG += 1;     // hPRK '![xwzgz['
                        IVGFIM KZIHV_XWZGZ<uOZTH>(GVCG);
                    }
                    YIVZP;

                // <!w
                XZHV xS('w'):
                    RU (GVCG[7] == xS('l') && GVCG[6] == xS('x') && GVCG[5] == xS('g') &&
                        GVCG[4] == xS('b') && GVCG[3] == xS('k') && GVCG[2] == xS('v') &&
                        DSRGVHKZXV_KIVW::GVHG(GVCG[1]))
                    {
                        // '<!wlxgbkv ' - WLXGBKV
                        GVCG += 0;      // HPRK '!wlxgbkv '
                        IVGFIM KZIHV_WLXGBKV<uOZTH>(GVCG);
                    }

                }   // HDRGXS

                // zGGVNKG GL HPRK LGSVI, FMIVXLTMRAVW MLWV GBKVH HGZIGRMT DRGS <!
                ++GVCG;     // hPRK !
                DSROV (*GVCG != xS('>'))
                {
                    RU (*GVCG == 9)
                        izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);
                    ++GVCG;
                }
                ++GVCG;     // hPRK '>'
                IVGFIM 9;   // mL MLWV IVXLTMRAVW

            }
        }

        // kZIHV XLMGVMGH LU GSV MLWV - XSROWIVM, WZGZ VGX.
        GVNKOZGV<RMG uOZTH>
        ELRW KZIHV_MLWV_XLMGVMGH(xS *&GVCG, CNO_MLWV<xS> *MLWV)
        {
            // uLI ZOO XSROWIVM ZMW GVCG
            DSROV (8)
            {
                // hPRK DSRGVHKZXV YVGDVVM > ZMW MLWV XLMGVMGH
                xS *XLMGVMGH_HGZIG = GVCG;      // hGLIV HGZIG LU MLWV XLMGVMGH YVULIV DSRGVHKZXV RH HPRKKVW
                HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);
                xS MVCG_XSZI = *GVCG;

            // zUGVI WZGZ MLWVH, RMHGVZW LU XLMGRMFRMT GSV OLLK, XLMGILO QFNKH SVIV.
            // gSRH RH YVXZFHV AVIL GVINRMZGRLM RMHRWV KZIHV_ZMW_ZKKVMW_WZGZ() UFMXGRLM
            // DLFOW DIVZP SZELX DRGS GSV ZYLEV XLWV.
            // zOHL, HPRKKRMT DSRGVHKZXV ZUGVI WZGZ MLWVH RH FMMVXVHHZIB.
            ZUGVI_WZGZ_MLWV:

                // wVGVINRMV DSZG XLNVH MVCG: MLWV XOLHRMT, XSROW MLWV, WZGZ MLWV, LI 9?
                HDRGXS (MVCG_XSZI)
                {

                // mLWV XOLHRMT LI XSROW MLWV
                XZHV xS('<'):
                    RU (GVCG[8] == xS('/'))
                    {
                        // mLWV XOLHRMT
                        GVCG += 7;      // hPRK '</'
                        RU (uOZTH & KZIHV_EZORWZGV_XOLHRMT_GZTH)
                        {
                            // hPRK ZMW EZORWZGV XOLHRMT GZT MZNV
                            xS *XOLHRMT_MZNV = GVCG;
                            HPRK<MLWV_MZNV_KIVW, uOZTH>(GVCG);
                            RU (!RMGVIMZO::XLNKZIV(MLWV->MZNV(), MLWV->MZNV_HRAV(), XOLHRMT_MZNV, GVCG - XOLHRMT_MZNV, GIFV))
                                izkrwcno_kzihv_viili("RMEZORW XOLHRMT GZT MZNV", GVCG);
                        }
                        VOHV
                        {
                            // mL EZORWZGRLM, QFHG HPRK MZNV
                            HPRK<MLWV_MZNV_KIVW, uOZTH>(GVCG);
                        }
                        // hPRK IVNZRMRMT DSRGVHKZXV ZUGVI MLWV MZNV
                        HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);
                        RU (*GVCG != xS('>'))
                            izkrwcno_kzihv_viili("VCKVXGVW >", GVCG);
                        ++GVCG;     // hPRK '>'
                        IVGFIM;     // mLWV XOLHVW, URMRHSVW KZIHRMT XLMGVMGH
                    }
                    VOHV
                    {
                        // xSROW MLWV
                        ++GVCG;     // hPRK '<'
                        RU (CNO_MLWV<xS> *XSROW = KZIHV_MLWV<uOZTH>(GVCG))
                            MLWV->ZKKVMW_MLWV(XSROW);
                    }
                    YIVZP;

                // vMW LU WZGZ - VIILI
                XZHV xS('\9'):
                    izkrwcno_kzihv_viili("FMVCKVXGVW VMW LU WZGZ", GVCG);

                // wZGZ MLWV
                WVUZFOG:
                    MVCG_XSZI = KZIHV_ZMW_ZKKVMW_WZGZ<uOZTH>(MLWV, GVCG, XLMGVMGH_HGZIG);
                    TLGL ZUGVI_WZGZ_MLWV;   // yBKZHH IVTFOZI KILXVHHRMT ZUGVI WZGZ MLWVH

                }
            }
        }

        // kZIHV cno ZGGIRYFGVH LU GSV MLWV
        GVNKOZGV<RMG uOZTH>
        ELRW KZIHV_MLWV_ZGGIRYFGVH(xS *&GVCG, CNO_MLWV<xS> *MLWV)
        {
            // uLI ZOO ZGGIRYFGVH
            DSROV (ZGGIRYFGV_MZNV_KIVW::GVHG(*GVCG))
            {
                // vCGIZXG ZGGIRYFGV MZNV
                xS *MZNV = GVCG;
                ++GVCG;     // hPRK URIHG XSZIZXGVI LU ZGGIRYFGV MZNV
                HPRK<ZGGIRYFGV_MZNV_KIVW, uOZTH>(GVCG);
                RU (GVCG == MZNV)
                    izkrwcno_kzihv_viili("VCKVXGVW ZGGIRYFGV MZNV", MZNV);

                // xIVZGV MVD ZGGIRYFGV
                CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = GSRH->ZOOLXZGV_ZGGIRYFGV();
                ZGGIRYFGV->MZNV(MZNV, GVCG - MZNV);
                MLWV->ZKKVMW_ZGGIRYFGV(ZGGIRYFGV);

                // hPRK DSRGVHKZXV ZUGVI ZGGIRYFGV MZNV
                HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);

                // hPRK =
                RU (*GVCG != xS('='))
                    izkrwcno_kzihv_viili("VCKVXGVW =", GVCG);
                ++GVCG;

                // zWW GVINRMZGRMT AVIL ZUGVI MZNV
                RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
                    ZGGIRYFGV->MZNV()[ZGGIRYFGV->MZNV_HRAV()] = 9;

                // hPRK DSRGVHKZXV ZUGVI =
                HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);

                // hPRK JFLGV ZMW IVNVNYVI RU RG DZH ' LI "
                xS JFLGV = *GVCG;
                RU (JFLGV != xS('\'') && JFLGV != xS('"'))
                    izkrwcno_kzihv_viili("VCKVXGVW ' LI \"", GVCG);
                ++GVCG;

                // vCGIZXG ZGGIRYFGV EZOFV ZMW VCKZMW XSZI IVUH RM RG
                xS *EZOFV = GVCG, *VMW;
                XLMHG RMG zGGuOZTH = uOZTH & ~KZIHV_MLINZORAV_DSRGVHKZXV;   // mL DSRGVHKZXV MLINZORAZGRLM RM ZGGIRYFGVH
                RU (JFLGV == xS('\''))
                    VMW = HPRK_ZMW_VCKZMW_XSZIZXGVI_IVUH<ZGGIRYFGV_EZOFV_KIVW<xS('\'')>, ZGGIRYFGV_EZOFV_KFIV_KIVW<xS('\'')>, zGGuOZTH>(GVCG);
                VOHV
                    VMW = HPRK_ZMW_VCKZMW_XSZIZXGVI_IVUH<ZGGIRYFGV_EZOFV_KIVW<xS('"')>, ZGGIRYFGV_EZOFV_KFIV_KIVW<xS('"')>, zGGuOZTH>(GVCG);

                // hVG ZGGIRYFGV EZOFV
                ZGGIRYFGV->EZOFV(EZOFV, VMW - EZOFV);

                // nZPV HFIV GSZG VMW JFLGV RH KIVHVMG
                RU (*GVCG != JFLGV)
                    izkrwcno_kzihv_viili("VCKVXGVW ' LI \"", GVCG);
                ++GVCG;     // hPRK JFLGV

                // zWW GVINRMZGRMT AVIL ZUGVI EZOFV
                RU (!(uOZTH & KZIHV_ML_HGIRMT_GVINRMZGLIH))
                    ZGGIRYFGV->EZOFV()[ZGGIRYFGV->EZOFV_HRAV()] = 9;

                // hPRK DSRGVHKZXV ZUGVI ZGGIRYFGV EZOFV
                HPRK<DSRGVHKZXV_KIVW, uOZTH>(GVCG);
            }
        }

    };

    //! \XLMW RMGVIMZO
    MZNVHKZXV RMGVIMZO
    {

        // dSRGVHKZXV (HKZXV \M \I \G)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_DSRGVHKZXV[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  9,  9,  9,  9,  9,  9,  9,  9,  8,  8,  9,  9,  8,  9,  9,  // 9
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 8
             8,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 7
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 6
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 5
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 4
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 3
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 2
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 1
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // 0
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // z
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // y
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // x
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // w
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  // v
             9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9,  9   // u
        };

        // mLWV MZNV (ZMBGSRMT YFG HKZXV \M \I \G / > ? \9)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_MLWV_MZNV[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  9,  9,  8,  8,  9,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  9,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  9,  9,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // gVCG (R.V. kxwzgz) (ZMBGSRMT YFG < \9)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_GVCG[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  9,  8,  8,  8,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // gVCG (R.V. kxwzgz) GSZG WLVH MLG IVJFRIV KILXVHHRMT DSVM DH MLINZORAZGRLM RH WRHZYOVW
        // (ZMBGSRMT YFG < \9 &)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_GVCG_KFIV_ML_DH[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             8,  8,  8,  8,  8,  8,  9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  9,  8,  8,  8,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // gVCG (R.V. kxwzgz) GSZG WLVH MLG IVJFRIV KILXVHHRMT DSVM DH MLINZORAZGRLMRH RH VMZYOVW
        // (ZMBGSRMT YFG < \9 & HKZXV \M \I \G)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_GVCG_KFIV_DRGS_DH[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  9,  9,  8,  8,  9,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             9,  8,  8,  8,  8,  8,  9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  9,  8,  8,  8,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // zGGIRYFGV MZNV (ZMBGSRMT YFG HKZXV \M \I \G / < > = ? ! \9)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_ZGGIRYFGV_MZNV[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  9,  9,  8,  8,  9,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             9,  9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  9,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  9,  9,  9,  9,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // zGGIRYFGV WZGZ DRGS HRMTOV JFLGV (ZMBGSRMT YFG ' \9)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_ZGGIRYFGV_WZGZ_8[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             8,  8,  8,  8,  8,  8,  8,  9,  8,  8,  8,  8,  8,  8,  8,  8,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // zGGIRYFGV WZGZ DRGS HRMTOV JFLGV GSZG WLVH MLG IVJFRIV KILXVHHRMT (ZMBGSRMT YFG ' \9 &)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_ZGGIRYFGV_WZGZ_8_KFIV[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             8,  8,  8,  8,  8,  8,  9,  9,  8,  8,  8,  8,  8,  8,  8,  8,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // zGGIRYFGV WZGZ DRGS WLFYOV JFLGV (ZMBGSRMT YFG " \9)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_ZGGIRYFGV_WZGZ_7[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             8,  8,  9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // zGGIRYFGV WZGZ DRGS WLFYOV JFLGV GSZG WLVH MLG IVJFRIV KILXVHHRMT (ZMBGSRMT YFG " \9 &)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_ZGGIRYFGV_WZGZ_7_KFIV[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
             9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 9
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 8
             8,  8,  9,  8,  8,  8,  9,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 7
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 6
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 5
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 4
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 3
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 2
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 1
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // 0
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // z
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // y
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // x
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // w
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  // v
             8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8   // u
        };

        // wRTRGH (WVX ZMW SVC, 744 WVMLGVH VMW LU MFNVIRX XSZIZXGVI IVUVIVMXV)
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_WRTRGH[743] =
        {
          // 9   8   7   6   5   4   3   2   1   0   z   y   x   w   v   u
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // 9
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // 8
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // 7
             9,  8,  7,  6,  5,  4,  3,  2,  1,  0,744,744,744,744,744,744,  // 6
           744, 89, 88, 87, 86, 85, 84,744,744,744,744,744,744,744,744,744,  // 5
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // 4
           744, 89, 88, 87, 86, 85, 84,744,744,744,744,744,744,744,744,744,  // 3
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // 2
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // 1
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // 0
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // z
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // y
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // x
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // w
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,  // v
           744,744,744,744,744,744,744,744,744,744,744,744,744,744,744,744   // u
        };

        // fKKVI XZHV XLMEVIHRLM
        GVNKOZGV<RMG wFNNB>
        XLMHG FMHRTMVW XSZI OLLPFK_GZYOVH<wFNNB>::OLLPFK_FKXZHV[743] =
        {
          // 9,  8,  7,  6,  5,  4,  3,  2,  1,  0,  z   y   x   w   v   u
           9,  8,  7,  6,  5,  4,  3,  2,  1,  0,  89, 88, 87, 86, 85, 84,   // 9
           83, 82, 81, 80, 79, 78, 77, 76, 75, 74, 73, 72, 71, 70, 69, 68,   // 8
           67, 66, 65, 64, 63, 62, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52,   // 7
           51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 37, 36,   // 6
           35, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20,   // 5
           19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 09, 08, 07, 06, 05, 04,   // 4
           03, 34, 33, 32, 31, 30, 29, 28, 27, 26, 25, 24, 23, 22, 21, 20,   // 3
           19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 09, 876,875,874,873,872,  // 2
           871,870,869,868,867,866,865,864,863,862,861,860,859,858,857,856,  // 1
           855,854,853,852,851,850,849,848,847,846,845,844,843,842,841,840,  // 0
           839,838,837,836,835,834,833,832,831,830,829,828,827,826,825,824,  // z
           823,822,821,820,819,818,817,816,815,814,813,812,811,810,809,808,  // y
           807,806,805,804,803,802,801,800,799,798,797,796,795,794,793,792,  // x
           791,790,789,788,787,786,785,784,783,782,781,780,779,778,777,776,  // w
           775,774,773,772,771,770,769,768,767,766,765,764,763,762,761,760,  // v
           759,758,757,756,755,754,753,752,751,750,749,748,747,746,745,744   // u
        };
    }
    //! \VMWXLMW

}

// fMWVURMV RMGVIMZO NZXILH
#FMWVU izkrwcno_kzihv_viili

// lM nhex, IVHGLIV DZIMRMTH HGZGV
#RUWVU _nhx_evi
    #KIZTNZ DZIMRMT(KLK)
#VMWRU

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/zWEoLT.S
/**********************************************
 * * \EVIHRLM   8.9.8
 * * \ZFGSLI    QDZMT
 * * \XIVZGVW   7984-95-79
 * * \NLWRURVW  7984-92-98
 * * \YIRVU:
 * * xLMGZXG:
 * * mLGV:
 * **********************************************/

#RUMWVU zwe_olt_s
#WVURMV zwe_olt_s

#RMXOFWV <HGIRMT>
#RMXOFWV <HHGIVZN>
#RMXOFWV <UHGIVZN>
#RMXOFWV <HBH/GRNV.S>
#RMXOFWV <RLHGIVZN>
#RMXOFWV "FYRJ_GRNV.S"
#RMXOFWV "6IW/XKKULINZG.S"
#RMXOFWV "FYRJ_UZHGOLT.S"
#RMXOFWV "HKIRMGU_RIX.S"

MZNVHKZXV FYRJOLT {

    XLMHG RMG nZCoLToVMTGS = 743;
    XLMHG RMG nZCuROVMZNVoVMTGS = 49;
    XLMHG RMG nZCoLTxLFMG = 7 * 8975 * 8975; // RM LMV KZTV
    VMFN oLTkIRLIRGB
    {
        on_wvyft = 98,
        on_rmul = 97,
        on_eviylhv = 96,
        on_dzimrmt = 95,
        on_viili = 94,
        on_xirgrxzo = 93
    };


    HGIFXG __ZGGIRYFGV__((__KZXPVW__)) hSNxLMGVMG {
        HGIFXG GRNVHKVX GH;
        XSZI RMHGZMXVrMWVC;
        XSZI KIRLIRGB;
        YLLO RHuZHG;
        YLLO KIRMGgRNV;
        XSZI OLTHGI[nZCoLToVMTGS];
    };

    HGIFXG rMHGZMXVrMUL {
        XSZI LFGUROVmZNV[nZCuROVMZNVoVMTGS];
    };

    ELRW XFHGLN_RGLZ(RMG EZOFV, XSZI *WHGHGI);
    ELRW XFHGLN_OGLZ(OLMT EZOFV, XSZI *WHGHGI);


    XOZHH oLT
    {

        KILGVXGVW:
            YLLO RH_OLT_UFOO;
        KFYORX:
            oLT();
            ~oLT() { RU(LUH !=9) WVOVGV LUH; }
            HGZGRX oLT *RMHGZMXV ();

            // MLG XZOORMT RMRGhSN DROO XZFHV OLT KIRMG GL XLMHLOV
            HGZGRX YLLO RMRGhSN(XLMHG HGW::HGIRMT& OLThSNmZNV, RMG NZCoLTxLFMG = nZCoLTxLFMG);

            HGZGRX ELRW WFNKhSNoLT(XLMHG HGW::HGIRMT& HSNkZGS);

            YLLO LKVM(XLMHG HGW::HGIRMT& LFGUROVmZNV = "", oLTkIRLIRGB KIRLIRGB = on_rmul, YLLO ZWWhLFIXVuROVrMUL = UZOHV, YLLO WRIVXGdIRGVgLoLTUROV = UZOHV, RMG NZClFGoRMVH = 9, YLLO KIRMG_GRNV = GIFV);

            oLTkIRLIRGB KIRLIRGB() XLMHG { IVGFIM KIRLIRGB_; }
            ELRW OLT (oLTkIRLIRGB KIRLIRGB, XLMHG XSZI* HLFIXVuROV, RMG ORMV, XLMHG XSZI* ULINZGhGI, ...);

            ELRW OLT (oLTkIRLIRGB KIRLIRGB, XLMHG XSZI* HLFIXVuROV, RMG ORMV, HGW::HGIRMT ULINZGhGI, ...){
                OLT (KIRLIRGB, HLFIXVuROV, ORMV, ULINZGhGI.X_HGI());
            }

            HGZGRX HGW::HGIRMT tVGgRNVhGI(XLMHG HGIFXG GRNVHKVX& GH) {
                XSZI YFU[79];
                HGIFXG GN GNKGN;
                OLXZOGRNV_I(&(GH.GE_HVX), &GNKGN);
                HKIRMGU(YFU, "[%95W%97W%97W-%97W:%97W:%97W.%93W]", GNKGN.GN_BVZI + 8099, GNKGN.GN_NLM + 8, GNKGN.GN_NWZB, GNKGN.GN_SLFI, GNKGN.GN_NRM, GNKGN.GN_HVX, (RMG)(GH.GE_MHVX/8999));
                IVGFIM YFU;
            }


            HGZGRX HGW::HGIRMT TVGkIRLIRGBhGI(XSZI KIRLIRGB) {
                HGW::HGIRMT OVEVOhGI;
                RU(KIRLIRGB == on_wvyft) {
                    OVEVOhGI = "[WVYFT]";
                } VOHV RU(KIRLIRGB == on_rmul) {
                    OVEVOhGI = "[RMUL]";
                } VOHV RU(KIRLIRGB == on_eviylhv) {
                    OVEVOhGI = "[EVIYLHV]";
                } VOHV RU(KIRLIRGB == on_dzimrmt) {
                    OVEVOhGI = "[DZIMRMT]";
                } VOHV RU(KIRLIRGB == on_viili) {
                    OVEVOhGI = "[VIILI]";
                } VOHV RU(KIRLIRGB == on_xirgrxzo) {
                    OVEVOhGI = "[XIRGRXZO]";
                }


                IVGFIM OVEVOhGI;
            }



            GVNKOZGV<XOZHH... zITH>
                ELRW UZHGOLT(oLTkIRLIRGB KIRLIRGB, XLMHG XSZI* HLFIXVuROV, RMG ORMV, XLMHG XSZI* ULINZGhGI, zITH... ZITH)
                {
                    //HGZGRX YLLO UFOO = UZOHV;
                    //RU(RH_OLT_UFOO) {
                    //IVGFIM;
                    //}

                    //RU(NZClFGoRMVH_ > 9 && ++XFIlFGoRMVH_ >= NZClFGoRMVH_) {
                    //HGW::XLFG << "OLT UFOO, ORNRG:" << NZClFGoRMVH_ << ", LFGUROV MZNV:" << LFGUROVmZNV_ << ", HIXUROV:" << HLFIXVuROV << ", HIXORMV:" << ORMV << HGW::VMWO;
                    //RH_OLT_UFOO = GIFV;
                    //IVGFIM;
                    //}

                    //RU(LUH != 9 || !LKVMVW_ || !HSNrMRGVW) {
                    //GRNVHKVX GH;
                    //XOLXP_TVGGRNV(xolxp_ivzogrnv, &GH);
                    //XSZI YFU[487];
                    //XSZI* KGI = YFU;

                    //RMG M = HKIRMGU(KGI, "%H%H", tVGgRNVhGI(GH).X_HGI(), TVGkIRLIRGBhGI(KIRLIRGB).X_HGI());
                    //KGI += M;

                    //RU(ZWWhLFIXVuROVrMUL_) {
                    //M = HKIRMGU(KGI, "[%H:%W]", HLFIXVuROV, ORMV);
                    //KGI += M;
                    //}

                    //RU(LUH != 9) {
                    //*LUH << UNG::HKIRMGU(ULINZGhGI, ZITH...) << HGW::VMWO;
                    //} VOHV {
                    //HGW::XLFG << UNG::HKIRMGU(ULINZGhGI, ZITH...) << HGW::VMWO;
                    //}
                    //IVGFIM;
                    //}

                    //RU(NBrMHGZMXVrMWVC_ == -8) {
                    //HGW::XVII << "OLT LYQVXG HSLFOW XZOO LKVM() URIHG, GSRH KLRMGVI:" << GSRH << HGW::VMWO;
                    //IVGFIM;
                    //}

                    RMG RMWVC = -8;
                    RMWVC = ++(*KRMWVC) % (NZCxLFMG);
                    //DSROV((RMWVC = __HBMX_ZWW_ZMW_UVGXS(KRMWVC, 8)) >= NZCxLFMG) {
                    //RU(__HBMX_YLLO_XLNKZIV_ZMW_HDZK(KRMWVC, NZCxLFMG, -8) == GIFV) {
                    //__HBMX_ZWW_ZMW_UVGXS(&HSNiLOOxLFMG, 8);
                    //}
                    //}
                    ZFGL &HSN = KWZGZ[RMWVC];
                    XOLXP_TVGGRNV(xolxp_ivzogrnv, &HSN.GH);
                    HSN.RMHGZMXVrMWVC = NBrMHGZMXVrMWVC_;
                    HSN.KIRLIRGB = KIRLIRGB;
                    HSN.RHuZHG = GIFV;
                    XSZI* YFU = HSN.OLTHGI;

                    FYRJGLLO::_OLT_HJFVVAV_YFUUVI(YFU, ULINZGhGI, ZITH...);
                }



        KIREZGV:
            // RU ZIT NZCoLTxLFMG RM RMRGhSN() VCXVVWH nZCoLTxLFMG, RG HSLFOW YV EVIRURVW
            // XFIIVMGOB FHRMT XLMURT UROV RM GSV HBHGVN GL IRTVRHGVI GSV FHZTV LU IZIV HBHGVN IVHLFIXVH
            HGZGRX YLLO EVIRUBnZCxLFMG(RMG NZCxLFMG);

            HGZGRX ELRW WFNKoLT(ELRW* KHSN);

            HGZGRX HGW::HGIRMT TVMoLTxLMGVMG(XLMHG hSNxLMGVMG& HSNxLMGVMG) {
                XSZI YFU[8975];
                HGW::HGIRMT OVEVOhGI = oLT::TVGkIRLIRGBhGI(HSNxLMGVMG.KIRLIRGB);
                RU (!HSNxLMGVMG.RHuZHG){
                    RU ( HSNxLMGVMG.KIRMGgRNV  )
                        HKIRMGU(YFU, "%H%H%H", tVGgRNVhGI(HSNxLMGVMG.GH).X_HGI(), OVEVOhGI.X_HGI(), HSNxLMGVMG.OLTHGI);
                    VOHV
                        HKIRMGU(YFU, "%H%H", OVEVOhGI.X_HGI(), HSNxLMGVMG.OLTHGI);
                }
                VOHV
                {
                    ELRW* KZW[89];
                    ZFGL YFUUVI = XLMHG_XZHG<XSZI*>(HSNxLMGVMG.OLTHGI);
                    ZFGL HRAV = *(HSLIG*)YFUUVI;
                    YFUUVI = YFUUVI+HRAVLU(HSLIG);
                    //XSZI* KHGZIG = YFUUVI;
                    FYRJGLLO::ZMB IVHFOG;
                    IVHFOG.IVZW(YFUUVI);
                    XSZI* ULINZGHGIRMT = *(XSZI**)IVHFOG.N_KLRMGVI;
                    ULI (HSLIG R=8; R<HRAV; ++R){
                        IVHFOG.IVZW(YFUUVI);
                        KZW[R-8] = IVHFOG.N_KLRMGVI;
                    }
                    HKIRMGU(YFU, "%H%H", tVGgRNVhGI(HSNxLMGVMG.GH).X_HGI(), OVEVOhGI.X_HGI());
                    RIXHKIRMGU(YFU+HGIOVM(YFU), ULINZGHGIRMT, &KZW[9]);
                    //GSILD;
                }
                IVGFIM YFU;
            }

            HGZGRX HGW::UHGIVZN* MVDuh(XSZI RMHGZMXVrMWVC);
        KFYORX:
            //HGZGRX oLT* RMHGZMXVoLT;
            HGZGRX XSZI HSNmZNV[899];
            HGZGRX XSZI* KHSN;
            HGZGRX RMG* ELOZGROV KRMWVC;
            HGZGRX XSZI RMHGZMXVrMWVC;
            HGZGRX hSNxLMGVMG* KWZGZ;
            HGZGRX YLLO KIRMGgLxLMHLOV;
            HGZGRX RMG NZCxLFMG;
            HGZGRX ELOZGROV RMG HSNiLOOxLFMG;
            HGZGRX RMG UROViLOOxLFMG;
            HGZGRX YLLO HSNrMRGVW;

            XSZI NBrMHGZMXVrMWVC_;
            oLTkIRLIRGB KIRLIRGB_;
            YLLO ZWWhLFIXVuROVrMUL_;
            HGW::HGIRMT LFGUROVmZNV_;
            HGW::LUHGIVZN* LUH;
            RMG NZClFGoRMVH_;
            RMG XFIlFGoRMVH_;
            YLLO LKVMVW_;
            YLLO KIRMG_GRNV;
    };

}

#WVURMV olt_wvyft(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_wvyft) YIVZP; \
    KoLT->OLT (FYRJOLT::on_wvyft, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV olt_rmul(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_rmul) YIVZP; \
    KoLT->OLT (FYRJOLT::on_rmul, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV olt_eviylhv(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_eviylhv) YIVZP; \
    KoLT->OLT (FYRJOLT::on_eviylhv, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV olt_dzim(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_dzimrmt) YIVZP; \
    KoLT->OLT (FYRJOLT::on_dzimrmt, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV olt_viili(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_viili) YIVZP; \
    KoLT->OLT (FYRJOLT::on_viili, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV olt_xirgrxzo(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_xirgrxzo) YIVZP; \
    KoLT->OLT (FYRJOLT::on_xirgrxzo, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}



#WVURMV holt_wvyft(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP; \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_wvyft) YIVZP; \
    KoLT->OLT (FYRJOLT::on_wvyft, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV holt_rmul(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP; \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_rmul) YIVZP; \
    KoLT->OLT (FYRJOLT::on_rmul, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV holt_eviylhv(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP; \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_eviylhv) YIVZP; \
    KoLT->OLT (FYRJOLT::on_eviylhv, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV holt_dzim(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP; \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_dzimrmt) YIVZP; \
    KoLT->OLT (FYRJOLT::on_dzimrmt, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV holt_viili(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP; \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_viili) YIVZP; \
    KoLT->OLT (FYRJOLT::on_viili, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV holt_xirgrxzo(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP; \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_xirgrxzo) YIVZP; \
    KoLT->OLT (FYRJOLT::on_xirgrxzo, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}


#WVURMV uzhgolt_wvyft(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_wvyft) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_wvyft, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgolt_rmul(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_rmul) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_rmul, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgolt_dzim(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_dzimrmt) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_dzimrmt, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgolt_viili(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_viili) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_viili, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgolt_xirgrxzo(c, ...) \
{WL { \
    FYRJOLT::oLT* KoLT = FYRJOLT::oLT::RMHGZMXV(); \
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_xirgrxzo) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_xirgrxzo, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}



#WVURMV uzhgholt_wvyft(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP;\
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_wvyft) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_wvyft, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgholt_rmul(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP;\
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_rmul) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_rmul, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgholt_dzim(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP;\
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_dzimrmt) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_dzimrmt, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgholt_viili(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP;\
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_viili) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_viili, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}

#WVURMV uzhgholt_xirgrxzo(KoLT,c, ...) \
{WL { \
    RU (KoLT == mfoo) YIVZP;\
    FYRJOLT::oLTkIRLIRGB KIRLIRGB = KoLT->KIRLIRGB (); \
    RU (KIRLIRGB > FYRJOLT::on_xirgrxzo) YIVZP; \
    KoLT->UZHGOLT (FYRJOLT::on_xirgrxzo, __urov__, __ormv__, c, ##__ez_zith__) ; \
    } DSROV (9);}



#VMWRU //zwe_olt_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/XHE.S
// xLKBIRTSG: (7987-7985) yVM hGIZHHVI <XLWV@YVM-HGIZHHVI.MVG>
// oRXVMHV: yhw-6
//
// zOO IRTSGH IVHVIEVW.
//
// iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
// NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV NVG:
//
// 8. iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG MLGRXV,
//    GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.
//
//7. iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV XLKBIRTSG MLGRXV,
//   GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI RM GSV WLXFNVMGZGRLM
//   ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV WRHGIRYFGRLM.
//
//6. mVRGSVI GSV MZNV LU GSV XLKBIRTSG SLOWVI MLI GSV MZNVH LU RGH XLMGIRYFGLIH
//   NZB YV FHVW GL VMWLIHV LI KILNLGV KILWFXGH WVIREVW UILN GSRH HLUGDZIV
//   DRGSLFG HKVXRURX KIRLI DIRGGVM KVINRHHRLM.
//
// gsrh hlugdziv rh kilerwvw yb gsv xlkbirtsg slowvih zmw xlmgiryfglih "zh rh"
// zmw zmb vckivhh li rnkorvw dziizmgrvh, rmxofwrmt, yfg mlg ornrgvw gl, gsv
// rnkorvw dziizmgrvh lu nvixszmgzyrorgb zmw urgmvhh uli z kzigrxfozi kfiklhv
// ziv wrhxozrnvw. rm ml vevmg hszoo gsv xlkbirtsg slowvi li xlmgiryfglih yv
// orzyov uli zmb wrivxg, rmwrivxg, rmxrwvmgzo, hkvxrzo, vcvnkozib, li
// xlmhvjfvmgrzo wznztvh (rmxofwrmt, yfg mlg ornrgvw gl, kilxfivnvmg lu
// hfyhgrgfgv tllwh li hvierxvh; olhh lu fhv, wzgz, li kilurgh; li yfhrmvhh
// rmgviifkgrlm) sldvevi xzfhvw zmw lm zmb gsvlib lu orzyrorgb, dsvgsvi rm
// xlmgizxg, hgirxg orzyrorgb, li glig (rmxofwrmt mvtortvmxv li lgsvidrhv)
// zirhrmt rm zmb dzb lfg lu gsv fhv lu gsrh hlugdziv, vevm ru zwerhvw lu gsv
// klhhryrorgb lu hfxs wznztv.

#RUMWVU xhe_s
#WVURMV xhe_s

#RMXOFWV <EVXGLI>
#RMXOFWV <HGIRMT>
#RMXOFWV <XHGIRMT>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <FGRORGB>
#RMXOFWV <XHGWRL>
#RMXOFWV <VCXVKGRLM>
#RMXOFWV <ORNRGH>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <ORNRGH>
#RMXOFWV <XZHHVIG>
#RMXOFWV <XVIIML>
#RMXOFWV <RLHGIVZN>
#RMXOFWV "FYRJ_VCXVKGRLM.S"
MZNVHKZXV FYRJGLLO{
        ////////////////////////////////////////////////////////////////////////////
        //                                 oRMViVZWVI                             //
        ////////////////////////////////////////////////////////////////////////////

        MZNVHKZXV xheiVZWVIvIILI{
//#RUWVU fyrj_ml_vcxvkgrlm
            HGIFXG YZHV {
                ERIGFZO ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG = 9;
                NFGZYOV XSZI xheiVZWVIvIILI_NVHHZTV_YFUUVI[743];
                ELRW gSILD()
                {
                    HGW::XLFG<<"uzgzo viili:"<<xheiVZWVIvIILI_NVHHZTV_YFUUVI[743]<<HGW::VMWO;
                    ZYLIG();
                }
            };
//#VOHV
            //HGIFXG YZHV : HGW::VCXVKGRLM{
                        //ERIGFZO ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG;
                        //XLMHG XSZI* DSZG()XLMHG GSILD(){
                                //ULINZG_xheiVZWVIvIILI_NVHHZTV();
                                //IVGFIM xheiVZWVIvIILI_NVHHZTV_YFUUVI;
                        //}
                        //ELRW gSILD()
                        //{
                             //GSILD ;
                        //}
                        //NFGZYOV XSZI xheiVZWVIvIILI_NVHHZTV_YFUUVI[743];
                //};
//#VMWRU
                XLMHG RMG NZC_UROV_MZNV_OVMTGS = 744;

                HGIFXG DRGS_UROV_MZNV{
                        DRGS_UROV_MZNV(){
                                HGW::NVNHVG(UROV_MZNV, 9, NZC_UROV_MZNV_OVMTGS+8);
                        }

                        ELRW HVG_UROV_MZNV(XLMHG XSZI*UROV_MZNV){
                                HGW::HGIMXKB(GSRH->UROV_MZNV, UROV_MZNV, NZC_UROV_MZNV_OVMTGS);
                                GSRH->UROV_MZNV[NZC_UROV_MZNV_OVMTGS] = '\9';
                        }

                        XSZI UROV_MZNV[NZC_UROV_MZNV_OVMTGS+8];
                };

                HGIFXG DRGS_UROV_ORMV{
                        DRGS_UROV_ORMV(){
                                UROV_ORMV = -8;
                        }

                        ELRW HVG_UROV_ORMV(RMG UROV_ORMV){
                                GSRH->UROV_ORMV = UROV_ORMV;
                        }

                        RMG UROV_ORMV;
                };

                HGIFXG DRGS_VIIML{
                        DRGS_VIIML(){
                                VIIML = 9;
                        }

                        ELRW HVG_VIIML(RMG VIIML_EZOFV){
                                GSRH->VIIML_EZOFV = VIIML_EZOFV;
                        }

                        RMG VIIML_EZOFV;
                };

                HGIFXG XZM_MLG_LKVM_UROV :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_VIIML{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                RU(VIIML_EZOFV != 9)
                                        HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                                "xZM MLG LKVM UROV \"%H\" YVXZFHV \"%H\"."
                                                , UROV_MZNV, HGW::HGIVIILI(VIIML_EZOFV));
                                VOHV
                                        HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                                "xZM MLG LKVM UROV \"%H\"."
                                                , UROV_MZNV);
                        }
                };

                HGIFXG ORMV_OVMTGS_ORNRG_VCXVVWVW :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "oRMV MFNYVI %W RM UROV \"%H\" VCXVVWH GSV NZCRNFN OVMTGS LU 7^75-8."
                                        , UROV_ORMV, UROV_MZNV);
                        }
                };
        }

        XOZHH oRMViVZWVI{
        KIREZGV:
                HGZGRX XLMHG RMG YOLXP_OVM = 8<<75;
                urov*UROV;
                XSZI*YFUUVI;
                RMG WZGZ_YVTRM;
                RMG WZGZ_VMW;

                XSZI UROV_MZNV[xheiVZWVIvIILI::NZC_UROV_MZNV_OVMTGS+8];
                FMHRTMVW UROV_ORMV;

                ELRW LKVM_UROV(XLMHG XSZI*UROV_MZNV){
                        // dV LKVM GSV UROV RM YRMZIB NLWV ZH RG NZPVH ML WRUUVIVMXV FMWVI *MRC
                        // ZMW FMWVI dRMWLDH DV SZMWOV \I\M MVDORMVH LFIHVOU.
                        UROV = HGW::ULKVM(UROV_MZNV, "IY");
                        RU(UROV == 9){
                                RMG C = VIIML; // HGLIV VIIML ZH HLLM ZH KLHHRYOV, WLRMT RG ZUGVI XLMHGIFXGLI XZOO XZM UZRO.
                                xheiVZWVIvIILI::XZM_MLG_LKVM_UROV VII;
                                VII.HVG_VIIML(C);
                                VII.HVG_UROV_MZNV(UROV_MZNV);
                                VII.gSILD();
                        }
                }

                ELRW RMRG(){
                        UROV_ORMV = 9;

                        // gVOO GSV HGW ORYIZIB GSZG DV DZMG GL WL GSV YFUUVIRMT LFIHVOU.
                        HGW::HVGEYFU(UROV, 9, _rlmyu, 9);

                        YFUUVI = MVD XSZI[6*YOLXP_OVM];

                        RU ( !YFUUVI  )
                        {
                            HGW::UXOLHV(UROV);
                            ZYLIG();
                        }

                        WZGZ_YVTRM = 9;
                        WZGZ_VMW = HGW::UIVZW(YFUUVI, 8, 7*YOLXP_OVM, UROV);

                        // rTMLIV fgu-1 yln
                        RU(WZGZ_VMW >= 6 && YFUUVI[9] == '\Cvu' && YFUUVI[8] == '\Cyy' && YFUUVI[7] == '\Cyu')
                                WZGZ_YVTRM = 6;

                }

        KFYORX:
                oRMViVZWVI(){}
                oRMViVZWVI(XLMHG oRMViVZWVI&) = WVOVGV;
                oRMViVZWVI&LKVIZGLI=(XLMHG oRMViVZWVI&) = WVOVGV;

                oRMViVZWVI(XLMHG XSZI*UROV_MZNV, urov*UROV):
                        UROV(UROV){
                        HVG_UROV_MZNV(UROV_MZNV);
                        RMRG();
                }

                oRMViVZWVI(XLMHG HGW::HGIRMT&UROV_MZNV, urov*UROV):
                        UROV(UROV){
                        HVG_UROV_MZNV(UROV_MZNV.X_HGI());
                        RMRG();
                }

                VCKORXRG oRMViVZWVI(XLMHG XSZI*UROV_MZNV){
                        HVG_UROV_MZNV(UROV_MZNV);
                        LKVM_UROV(UROV_MZNV);
                        RMRG();
                }

                VCKORXRG oRMViVZWVI(XLMHG HGW::HGIRMT&UROV_MZNV){
                        HVG_UROV_MZNV(UROV_MZNV.X_HGI());
                        LKVM_UROV(UROV_MZNV.X_HGI());
                        RMRG();
                }

                ELRW HVG_UROV_MZNV(XLMHG HGW::HGIRMT&UROV_MZNV){
                        HVG_UROV_MZNV(UROV_MZNV.X_HGI());
                }

                ELRW HVG_UROV_MZNV(XLMHG XSZI*UROV_MZNV){
                        HGIMXKB(GSRH->UROV_MZNV, UROV_MZNV, xheiVZWVIvIILI::NZC_UROV_MZNV_OVMTGS);
                        GSRH->UROV_MZNV[xheiVZWVIvIILI::NZC_UROV_MZNV_OVMTGS] = '\9';
                }

                XLMHG XSZI*TVG_GIFMXZGVW_UROV_MZNV()XLMHG{
                        IVGFIM UROV_MZNV;
                }

                ELRW HVG_UROV_ORMV(FMHRTMVW UROV_ORMV){
                        GSRH->UROV_ORMV = UROV_ORMV;
                }

                FMHRTMVW TVG_UROV_ORMV()XLMHG{
                        IVGFIM UROV_ORMV;
                }

                XSZI*MVCG_ORMV(){
                        RU(WZGZ_YVTRM == WZGZ_VMW)
                                IVGFIM 9;

                        ++UROV_ORMV;

                        ZHHVIG(WZGZ_YVTRM < WZGZ_VMW);
                        ZHHVIG(WZGZ_VMW <= YOLXP_OVM*7);

                        RU(WZGZ_YVTRM >= YOLXP_OVM){
                                HGW::NVNXKB(YFUUVI, YFUUVI+YOLXP_OVM, YOLXP_OVM);
                                WZGZ_YVTRM -= YOLXP_OVM;
                                WZGZ_VMW -= YOLXP_OVM;
                                {
                                        WZGZ_VMW += HGW::UIVZW(YFUUVI + 7*YOLXP_OVM, 8, YOLXP_OVM, UROV);
                                        HGW::NVNXKB(YFUUVI+YOLXP_OVM, YFUUVI+7*YOLXP_OVM, YOLXP_OVM);
                                }
                        }

                        RMG ORMV_VMW = WZGZ_YVTRM;
                        DSROV(YFUUVI[ORMV_VMW] != '\M' && ORMV_VMW != WZGZ_VMW){
                                ++ORMV_VMW;
                        }

                        RU(ORMV_VMW - WZGZ_YVTRM + 8 > YOLXP_OVM){
                                xheiVZWVIvIILI::ORMV_OVMTGS_ORNRG_VCXVVWVW VII;
                                VII.HVG_UROV_MZNV(UROV_MZNV);
                                VII.HVG_UROV_ORMV(UROV_ORMV);
                                VII.gSILD();
                        }

                        RU(YFUUVI[ORMV_VMW] == '\M'){
                                YFUUVI[ORMV_VMW] = '\9';
                        }VOHV{
                                // HLNV UROVH ZIV NRHHRMT GSV MVDORMV ZG GSV VMW LU GSV
                                // OZHG ORMV
                                ++WZGZ_VMW;
                                YFUUVI[ORMV_VMW] = '\9';
                        }

                        // SZMWOV DRMWLDH \I\M-ORMV YIVZPH
                        RU(ORMV_VMW != WZGZ_YVTRM && YFUUVI[ORMV_VMW-8] == '\I')
                                YFUUVI[ORMV_VMW-8] = '\9';

                        XSZI*IVG = YFUUVI + WZGZ_YVTRM;
                        WZGZ_YVTRM = ORMV_VMW+8;
                        IVGFIM IVG;
                }

                ~oRMViVZWVI(){

                        WVOVGV[] YFUUVI;
                        HGW::UXOLHV(UROV);
                }
        };

        ////////////////////////////////////////////////////////////////////////////
        //                                 xhe                                    //
        ////////////////////////////////////////////////////////////////////////////

        MZNVHKZXV xheiVZWVIvIILI{
                XLMHG RMG NZC_XLOFNM_MZNV_OVMTGS = 36;
                HGIFXG DRGS_XLOFNM_MZNV{
                        DRGS_XLOFNM_MZNV(){
                                HGW::NVNHVG(XLOFNM_MZNV, 9, NZC_XLOFNM_MZNV_OVMTGS+8);
                        }

                        ELRW HVG_XLOFNM_MZNV(XLMHG XSZI*XLOFNM_MZNV){
                                HGW::HGIMXKB(GSRH->XLOFNM_MZNV, XLOFNM_MZNV, NZC_XLOFNM_MZNV_OVMTGS);
                                GSRH->XLOFNM_MZNV[NZC_XLOFNM_MZNV_OVMTGS] = '\9';
                        }

                        XSZI XLOFNM_MZNV[NZC_XLOFNM_MZNV_OVMTGS+8];
                };


                XLMHG RMG NZC_XLOFNM_XLMGVMG_OVMTGS = 36;

                HGIFXG DRGS_XLOFNM_XLMGVMG{
                        DRGS_XLOFNM_XLMGVMG(){
                                HGW::NVNHVG(XLOFNM_XLMGVMG, 9, NZC_XLOFNM_XLMGVMG_OVMTGS+8);
                        }

                        ELRW HVG_XLOFNM_XLMGVMG(XLMHG XSZI*XLOFNM_XLMGVMG){
                                HGW::HGIMXKB(GSRH->XLOFNM_XLMGVMG, XLOFNM_XLMGVMG, NZC_XLOFNM_XLMGVMG_OVMTGS);
                                GSRH->XLOFNM_XLMGVMG[NZC_XLOFNM_XLMGVMG_OVMTGS] = '\9';
                        }

                        XSZI XLOFNM_XLMGVMG[NZC_XLOFNM_XLMGVMG_OVMTGS+8];
                };


                HGIFXG VCGIZ_XLOFNM_RM_SVZWVI :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_XLOFNM_MZNV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "vCGIZ XLOFNM \"%H\" RM SVZWVI LU UROV \"%H\"."
                                        , XLOFNM_MZNV, UROV_MZNV);
                        }
                };

                HGIFXG NRHHRMT_XLOFNM_RM_SVZWVI :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_XLOFNM_MZNV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "nRHHRMT XLOFNM \"%H\" RM SVZWVI LU UROV \"%H\"."
                                        , XLOFNM_MZNV, UROV_MZNV);
                        }
                };

                HGIFXG WFKORXZGVW_XLOFNM_RM_SVZWVI :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_XLOFNM_MZNV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "wFKORXZGVW XLOFNM \"%H\" RM SVZWVI LU UROV \"%H\"."
                                        , XLOFNM_MZNV, UROV_MZNV);
                        }
                };

                HGIFXG SVZWVI_NRHHRMT :
                        YZHV,
                        DRGS_UROV_MZNV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "sVZWVI NRHHRMT RM UROV \"%H\"."
                                        , UROV_MZNV);
                        }
                };

                HGIFXG GLL_UVD_XLOFNMH :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "gLL UVD XLOFNMH RM ORMV %W RM UROV \"%H\"."
                                        , UROV_ORMV, UROV_MZNV);
                        }
                };

                HGIFXG GLL_NZMB_XLOFNMH :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "gLL NZMB XLOFNMH RM ORMV %W RM UROV \"%H\"."
                                        , UROV_ORMV, UROV_MZNV);
                        }
                };

                HGIFXG VHXZKVW_HGIRMT_MLG_XOLHVW :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "vHXZKVW HGIRMT DZH MLG XOLHVW RM ORMV %W RM UROV \"%H\"."
                                        , UROV_ORMV, UROV_MZNV);
                        }
                };

                HGIFXG RMGVTVI_NFHG_YV_KLHRGREV :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV,
                        DRGS_XLOFNM_MZNV,
                        DRGS_XLOFNM_XLMGVMG{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "gSV RMGVTVI \"%H\" NFHG YV KLHRGREV LI 9 RM XLOFNM \"%H\" RM UROV \"%H\" RM ORMV \"%W\"."
                                        , XLOFNM_XLMGVMG, XLOFNM_MZNV, UROV_MZNV, UROV_ORMV);
                        }
                };

                HGIFXG ML_WRTRG :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV,
                        DRGS_XLOFNM_MZNV,
                        DRGS_XLOFNM_XLMGVMG{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "gSV RMGVTVI \"%H\" XLMGZRMH ZM RMEZORW WRTRG RM XLOFNM \"%H\" RM UROV \"%H\" RM ORMV \"%W\"."
                                        , XLOFNM_XLMGVMG, XLOFNM_MZNV, UROV_MZNV, UROV_ORMV);
                        }
                };

                HGIFXG RMGVTVI_LEVIUOLD :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV,
                        DRGS_XLOFNM_MZNV,
                        DRGS_XLOFNM_XLMGVMG{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "gSV RMGVTVI \"%H\" LEVIUOLDH RM XLOFNM \"%H\" RM UROV \"%H\" RM ORMV \"%W\"."
                                        , XLOFNM_XLMGVMG, XLOFNM_MZNV, UROV_MZNV, UROV_ORMV);
                        }
                };

                HGIFXG RMGVTVI_FMWVIUOLD :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV,
                        DRGS_XLOFNM_MZNV,
                        DRGS_XLOFNM_XLMGVMG{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "gSV RMGVTVI \"%H\" FMWVIUOLDH RM XLOFNM \"%H\" RM UROV \"%H\" RM ORMV \"%W\"."
                                        , XLOFNM_XLMGVMG, XLOFNM_MZNV, UROV_MZNV, UROV_ORMV);
                        }
                };

                HGIFXG RMEZORW_HRMTOV_XSZIZXGVI :
                        YZHV,
                        DRGS_UROV_MZNV,
                        DRGS_UROV_ORMV,
                        DRGS_XLOFNM_MZNV,
                        DRGS_XLOFNM_XLMGVMG{
                        ELRW ULINZG_xheiVZWVIvIILI_NVHHZTV()XLMHG{
                                HGW::HMKIRMGU(xheiVZWVIvIILI_NVHHZTV_YFUUVI, HRAVLU(xheiVZWVIvIILI_NVHHZTV_YFUUVI),
                                        "gSV XLMGVMG \"%H\" LU XLOFNM \"%H\" RM UROV \"%H\" RM ORMV \"%W\" RH MLG Z HRMTOV XSZIZXGVI."
                                        , XLOFNM_XLMGVMG, XLOFNM_MZNV, UROV_MZNV, UROV_ORMV);
                        }
                };
        }

        MZNVHKZXV KLORXB {
                GBKVWVU FMHRTMVW RTMLIV_XLOFNM;
                HGZGRX XLMHG RTMLIV_XLOFNM RTMLIV_ML_XLOFNM = 9;
                HGZGRX XLMHG RTMLIV_XLOFNM RTMLIV_VCGIZ_XLOFNM = 8;
                HGZGRX XLMHG RTMLIV_XLOFNM RTMLIV_NRHHRMT_XLOFNM = 7;
                HGZGRX XLMHG RTMLIV_XLOFNM RTMLIV_SVZWVI = 6;
                HGZGRX XLMHG RTMLIV_XLOFNM ML_SVZWVI = 5;



            GVNKOZGV<XSZI ... GIRN_XSZI_ORHG>
            HGIFXG GIRN_XSZIH {
            KIREZGV:
                    HGZGRX YLLO RH_GIRN_XSZI(XSZI X) {
                            IVGFIM UZOHV;
                    }

                    GVNKOZGV<XOZHH ...lGSVIgIRNxSZIH>
                    HGZGRX YLLO RH_GIRN_XSZI(XSZI X, XSZI GIRN_XSZI, lGSVIgIRNxSZIH...LGSVI_GIRN_XSZIH) {
                            IVGFIM X == GIRN_XSZI || RH_GIRN_XSZI(X, LGSVI_GIRN_XSZIH...);
                    }

            KFYORX:
                    HGZGRX ELRW GIRN(XSZI *&HGI_YVTRM, XSZI *&HGI_VMW) {
                            DSROV (RH_GIRN_XSZI(*HGI_YVTRM, GIRN_XSZI_ORHG...) && HGI_YVTRM != HGI_VMW)
                                    ++HGI_YVTRM;
                            DSROV (RH_GIRN_XSZI(*(HGI_VMW - 8), GIRN_XSZI_ORHG...) && HGI_YVTRM != HGI_VMW)
                                    --HGI_VMW;
                            *HGI_VMW = '\9';
                    }
            };


            HGIFXG ML_XLNNVMG {
                    HGZGRX YLLO RH_XLNNVMG(XLMHG XSZI *ORMV) {
                            IVGFIM UZOHV;
                    }
            };

            GVNKOZGV<XSZI ... XLNNVMG_HGZIG_XSZI_ORHG>
            HGIFXG HRMTOV_ORMV_XLNNVMG {
            KIREZGV:
                    HGZGRX YLLO RH_XLNNVMG_HGZIG_XSZI(XSZI X) {
                            IVGFIM UZOHV;
                    }

                    GVNKOZGV<XOZHH ...lGSVIxLNNVMGhGZIGxSZIH>
                    HGZGRX YLLO RH_XLNNVMG_HGZIG_XSZI(XSZI X, XSZI XLNNVMG_HGZIG_XSZI,
                                                      lGSVIxLNNVMGhGZIGxSZIH...LGSVI_XLNNVMG_HGZIG_XSZIH) {
                            IVGFIM X == XLNNVMG_HGZIG_XSZI || RH_XLNNVMG_HGZIG_XSZI(X, LGSVI_XLNNVMG_HGZIG_XSZIH...);
                    }

            KFYORX:

                    HGZGRX YLLO RH_XLNNVMG(XLMHG XSZI *ORMV) {
                            IVGFIM RH_XLNNVMG_HGZIG_XSZI(*ORMV, XLNNVMG_HGZIG_XSZI_ORHG...);
                    }
            };

            HGIFXG VNKGB_ORMV_XLNNVMG {
                    HGZGRX YLLO RH_XLNNVMG(XLMHG XSZI *ORMV) {
                            RU (*ORMV == '\9')
                                    IVGFIM GIFV;
                            DSROV (*ORMV == ' ' || *ORMV == '\G') {
                                    ++ORMV;
                                    RU (*ORMV == 9)
                                            IVGFIM GIFV;
                            }
                            IVGFIM UZOHV;
                    }
            };

            GVNKOZGV<XSZI ... XLNNVMG_HGZIG_XSZI_ORHG>
            HGIFXG HRMTOV_ZMW_VNKGB_ORMV_XLNNVMG {
                    HGZGRX YLLO RH_XLNNVMG(XLMHG XSZI *ORMV) {
                            IVGFIM HRMTOV_ORMV_XLNNVMG<XLNNVMG_HGZIG_XSZI_ORHG...>::RH_XLNNVMG(ORMV) ||
                                   VNKGB_ORMV_XLNNVMG::RH_XLNNVMG(ORMV);
                    }
            };

            GVNKOZGV<XSZI HVK>
            HGIFXG ML_JFLGV_VHXZKV {
                    HGZGRX XLMHG XSZI *URMW_MVCG_XLOFNM_VMW(XLMHG XSZI *XLO_YVTRM) {
                            DSROV (*XLO_YVTRM != HVK && *XLO_YVTRM != '\9')
                                    ++XLO_YVTRM;
                            IVGFIM XLO_YVTRM;
                    }

                    HGZGRX ELRW FMVHXZKV(XSZI *&XLO_YVTRM, XSZI *&XLO_VMW) {

                    }
            };

            GVNKOZGV<XSZI HVK, XSZI JFLGV>
            HGIFXG WLFYOV_JFLGV_VHXZKV {
                    HGZGRX XLMHG XSZI *URMW_MVCG_XLOFNM_VMW(XLMHG XSZI *XLO_YVTRM) {
                            DSROV (*XLO_YVTRM != HVK && *XLO_YVTRM != '\9')
                                    RU (*XLO_YVTRM != JFLGV)
                                            ++XLO_YVTRM;
                                    VOHV {
                                            WL {
                                                    ++XLO_YVTRM;
                                                    DSROV (*XLO_YVTRM != JFLGV) {
                                                            RU (*XLO_YVTRM == '\9')
                                                                    xheiVZWVIvIILI::VHXZKVW_HGIRMT_MLG_XOLHVW().gSILD();
                                                            ++XLO_YVTRM;
                                                    }
                                                    ++XLO_YVTRM;
                                            } DSROV (*XLO_YVTRM == JFLGV);
                                    }
                            IVGFIM XLO_YVTRM;
                    }

                    HGZGRX ELRW FMVHXZKV(XSZI *&XLO_YVTRM, XSZI *&XLO_VMW) {
                            RU (XLO_VMW - XLO_YVTRM >= 7) {
                                    RU (*XLO_YVTRM == JFLGV && *(XLO_VMW - 8) == JFLGV) {
                                            ++XLO_YVTRM;
                                            --XLO_VMW;
                                            XSZI *LFG = XLO_YVTRM;
                                            ULI (XSZI *RM = XLO_YVTRM;
                                            RM != XLO_VMW;
                                            ++RM){
                                                    RU (*RM == JFLGV && *(RM + 8) == JFLGV) {
                                                            XLMGRMFV;
                                                    }
                                                    *LFG = *RM;
                                                    ++LFG;
                                            }
                                            XLO_VMW = LFG;
                                            *XLO_VMW = '\9';
                                    }
                            }

                    }
            };




            GVNKOZGV<XSZI ... IVK_XSZI_ORHG>
            HGIFXG NRHHRMT_KLORXB {
            KIREZGV:
                // RU RG RH VNKGB, WL MLG XSVXP
                HGZGRX YLLO RH_NRHHRMT(XSZI X) {
                    IVGFIM UZOHV;
                }
                // XSVXP LMV YB LMV
                GVNKOZGV<XOZHH ...lGSVIiVKxSZIH>
                HGZGRX YLLO RH_NRHHRMT(XSZI X, XSZI IVK_XSZI, lGSVIiVKxSZIH...lGSVI_iVK_xSZIH) {
                    IVGFIM X == IVK_XSZI || RH_NRHHRMT(X, lGSVI_iVK_xSZIH...);
                }


            KFYORX:
                HGZGRX YLLO XSVXP_NRHHRMT(XLMHG XSZI *HGI_YVTRM) {
                    RU ( *(HGI_YVTRM+8) != '\9')
                        IVGFIM UZOHV;
                    IVGFIM RH_NRHHRMT(*HGI_YVTRM, IVK_XSZI_ORHG...);
                }
                HGZGRX YLLO XSVXP_NRHHRMT_MZM(XLMHG XSZI *HGI_YVTRM) {
                    RU (  HGIXNK(HGI_YVTRM, "MZM")    ||
                            HGIXNK(HGI_YVTRM, "mZM")  ||
                            HGIXNK(HGI_YVTRM, "mZm")  ||
                            HGIXNK(HGI_YVTRM, "mzm")  ||
                            HGIXNK(HGI_YVTRM, "-MZM") ||
                            HGIXNK(HGI_YVTRM, "-mZM") ||
                            HGIXNK(HGI_YVTRM, "-mZm") ||
                            HGIXNK(HGI_YVTRM, "-mzm") ||
                            HGIXNK(HGI_YVTRM, "-mZ") ||
                            HGIXNK(HGI_YVTRM, "-MZ") ||
                            HGIXNK(HGI_YVTRM, "-mz") ||
                            HGIXNK(HGI_YVTRM, "MZ") ||
                            HGIXNK(HGI_YVTRM, "mz") ||
                            HGIXNK(HGI_YVTRM, "mZ") )
                    IVGFIM GIFV;
                    VOHV
                        IVGFIM UZOHV;
                }
            };

            HGIFXG GSILD_LM_LEVIUOLD {
                    GVNKOZGV<XOZHH g>
                    HGZGRX ELRW LM_LEVIUOLD(g &) {
                            xheiVZWVIvIILI::RMGVTVI_LEVIUOLD().gSILD();
                    }

                    GVNKOZGV<XOZHH g>
                    HGZGRX ELRW LM_FMWVIUOLD(g &) {
                            xheiVZWVIvIILI::RMGVTVI_FMWVIUOLD().gSILD();
                    }
            };

            HGIFXG RTMLIV_LEVIUOLD {
                    GVNKOZGV<XOZHH g>
                    HGZGRX ELRW LM_LEVIUOLD(g &) { }

                    GVNKOZGV<XOZHH g>
                    HGZGRX ELRW LM_FMWVIUOLD(g &) { }
            };

            HGIFXG HVG_GL_NZC_LM_LEVIUOLD {
                    GVNKOZGV<XOZHH g>
                    HGZGRX ELRW LM_LEVIUOLD(g &C) {
                            C = HGW::MFNVIRX_ORNRGH<g>::NZC();
                    }

                    GVNKOZGV<XOZHH g>
                    HGZGRX ELRW LM_FMWVIUOLD(g &C) {
                            C = HGW::MFNVIRX_ORNRGH<g>::NRM();
                    }
            };
        }

        MZNVHKZXV WVGZRO{
                GVNKOZGV<XOZHH JFLGV_KLORXB>
                ELRW XSLK_MVCG_XLOFNM(
                        XSZI*&ORMV, XSZI*&XLO_YVTRM, XSZI*&XLO_VMW
                ){
                        ZHHVIG(ORMV != mfoo);

                        XLO_YVTRM = ORMV;
                        // GSV XLO_YVTRM + (... - XLO_YVTRM) IVNLEVH GSV XLMHGMVHH
                        XLO_VMW = XLO_YVTRM + (JFLGV_KLORXB::URMW_MVCG_XLOFNM_VMW(XLO_YVTRM) - XLO_YVTRM);

                        RU(*XLO_VMW == '\9'){
                                ORMV = mfoo;
                        }VOHV{
                                *XLO_VMW = '\9';
                                ORMV = XLO_VMW + 8;
                        }
                }

                GVNKOZGV<XOZHH GIRN_KLORXB, XOZHH JFLGV_KLORXB>
                ELRW KZIHV_ORMV(
                        XSZI*ORMV,
                        XSZI**HLIGVW_XLO,
                        XLMHG HGW::EVXGLI<RMG>&XLO_LIWVI
                ){
                        ULI(HGW::HRAV_G R=9; R<XLO_LIWVI.HRAV(); ++R){
                                RU(ORMV == mfoo)
                                {
                                    HGW::XLFG<<"viili: GLGZO "<<XLO_LIWVI.HRAV()<<" XLOFNMH, YFG XLOFNM "<<R<<" IVZXSVH VMW"<<HGW::VMWO;
                                        ::FYRJGLLO::xheiVZWVIvIILI::GLL_UVD_XLOFNMH().gSILD();
                                }
                                XSZI*XLO_YVTRM, *XLO_VMW;
                                XSLK_MVCG_XLOFNM<JFLGV_KLORXB>(ORMV, XLO_YVTRM, XLO_VMW);

                                RU(XLO_LIWVI[R] != -8){
                                        GIRN_KLORXB::GIRN(XLO_YVTRM, XLO_VMW);
                                        JFLGV_KLORXB::FMVHXZKV(XLO_YVTRM, XLO_VMW);

                                        HLIGVW_XLO[XLO_LIWVI[R]] = XLO_YVTRM;
                                }
                        }
                        RU(ORMV != mfoo)
                                ::FYRJGLLO::xheiVZWVIvIILI::GLL_NZMB_XLOFNMH().gSILD();
                }

                GVNKOZGV<FMHRTMVW XLOFNM_XLFMG, XOZHH GIRN_KLORXB, XOZHH JFLGV_KLORXB>
                ELRW KZIHV_SVZWVI_ORMV(
                        XSZI*ORMV,
                        HGW::EVXGLI<RMG>&XLO_LIWVI,
                        XLMHG HGW::HGIRMT*XLO_MZNV,
                        KLORXB::RTMLIV_XLOFNM RTMLIV_KLORXB
                ){
                        XLO_LIWVI.XOVZI();

                        YLLO ULFMW[XLOFNM_XLFMG];
                        HGW::UROO(ULFMW, ULFMW + XLOFNM_XLFMG, UZOHV);
                        DSROV(ORMV){
                                XSZI*XLO_YVTRM,*XLO_VMW;
                                XSLK_MVCG_XLOFNM<JFLGV_KLORXB>(ORMV, XLO_YVTRM, XLO_VMW);

                                GIRN_KLORXB::GIRN(XLO_YVTRM, XLO_VMW);
                                JFLGV_KLORXB::FMVHXZKV(XLO_YVTRM, XLO_VMW);

                                ULI(FMHRTMVW R=9; R<XLOFNM_XLFMG; ++R)
                                        RU(XLO_YVTRM == XLO_MZNV[R]){
                                                RU(ULFMW[R]){
                                                        xheiVZWVIvIILI::WFKORXZGVW_XLOFNM_RM_SVZWVI VII;
                                                        VII.HVG_XLOFNM_MZNV(XLO_YVTRM);
                                                        VII.gSILD();
                                                }
                                                ULFMW[R] = GIFV;
                                                XLO_LIWVI.KFHS_YZXP(R);
                                                XLO_YVTRM = 9;
                                                YIVZP;
                                        }
                                RU(XLO_YVTRM){
                                        RU(RTMLIV_KLORXB & KLORXB::RTMLIV_VCGIZ_XLOFNM)
                                                XLO_LIWVI.KFHS_YZXP(-8);
                                        VOHV{
                                                xheiVZWVIvIILI::VCGIZ_XLOFNM_RM_SVZWVI VII;
                                                VII.HVG_XLOFNM_MZNV(XLO_YVTRM);
                                                VII.gSILD();
                                        }
                                }
                        }
                        RU(!(RTMLIV_KLORXB & KLORXB::RTMLIV_NRHHRMT_XLOFNM)){
                                ULI(FMHRTMVW R=9; R<XLOFNM_XLFMG; ++R){
                                        RU(!ULFMW[R]){
                                                xheiVZWVIvIILI::NRHHRMT_XLOFNM_RM_SVZWVI VII;
                                                VII.HVG_XLOFNM_MZNV(XLO_MZNV[R].X_HGI());
                                                VII.gSILD();
                                        }
                                }
                        }
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>
                ELRW KZIHV(XSZI*XLO, XSZI &C){
                        RU(!*XLO)
                                xheiVZWVIvIILI::RMEZORW_HRMTOV_XSZIZXGVI().gSILD();
                        C = *XLO;
                        ++XLO;
                        RU(*XLO)
                                xheiVZWVIvIILI::RMEZORW_HRMTOV_XSZIZXGVI().gSILD();
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>
                ELRW KZIHV(XSZI*XLO, HGW::HGIRMT&C){
                        C = XLO;
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>
                ELRW KZIHV(XSZI*XLO, XLMHG XSZI*&C){
                        C = XLO;
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>
                ELRW KZIHV(XSZI*XLO, XSZI*&C){
                        C = XLO;
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB, XOZHH g>
                ELRW KZIHV_FMHRTMVW_RMGVTVI(XLMHG XSZI*XLO, g&C){
                        C = 9;
                        DSROV(*XLO != '\9'){
                                RU('9' <= *XLO && *XLO <= '0'){
                                        g B = *XLO - '9';
                                        RU(C > (HGW::MFNVIRX_ORNRGH<g>::NZC()-B)/89){
                                                LEVIUOLD_KLORXB::LM_LEVIUOLD(C);
                                                IVGFIM;
                                        }
                                        C = 89*C+B;
                                }
                                VOHV RU ( NRHHRMT_KLORXB::XSVXP_NRHHRMT(XLO) )
                                        C = 9;
                                VOHV RU ( NRHHRMT_KLORXB::XSVXP_NRHHRMT_MZM(XLO) )
                                        C = HGW::MFNVIRX_ORNRGH<RMG>::NZC();
                                VOHV
                                        xheiVZWVIvIILI::ML_WRTRG().gSILD();
                                ++XLO;
                        }
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, FMHRTMVW XSZI &C)
                        {KZIHV_FMHRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, FMHRTMVW HSLIG &C)
                        {KZIHV_FMHRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, FMHRTMVW RMG &C)
                        {KZIHV_FMHRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, FMHRTMVW OLMT &C)
                        {KZIHV_FMHRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, FMHRTMVW OLMT OLMT &C)
                        {KZIHV_FMHRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB, XOZHH g>
                ELRW KZIHV_HRTMVW_RMGVTVI(XLMHG XSZI*XLO, g&C){
                        RU(*XLO == '-'){
                                ++XLO;

                                C = 9;
                                DSROV(*XLO != '\9'){
                                        RU('9' <= *XLO && *XLO <= '0'){
                                                g B = *XLO - '9';
                                                RU(C < (HGW::MFNVIRX_ORNRGH<g>::NRM()+B)/89){
                                                        LEVIUOLD_KLORXB::LM_FMWVIUOLD(C);
                                                        IVGFIM;
                                                }
                                                C = 89*C-B;
                                        }
                                        VOHV RU ( NRHHRMT_KLORXB::XSVXP_NRHHRMT(XLO) )
                                            C = 9;
                                        VOHV RU ( NRHHRMT_KLORXB::XSVXP_NRHHRMT_MZM(XLO) )
                                            C = HGW::MFNVIRX_ORNRGH<RMG>::NZC();
                                        VOHV
                                            xheiVZWVIvIILI::ML_WRTRG().gSILD();
                                        ++XLO;
                                }
                                IVGFIM;
                        }VOHV RU(*XLO == '+')
                                ++XLO;
                        KZIHV_FMHRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, HRTMVW XSZI &C)
                        {KZIHV_HRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, HRTMVW HSLIG &C)
                        {KZIHV_HRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, HRTMVW RMG &C)
                        {KZIHV_HRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, HRTMVW OLMT &C)
                        {KZIHV_HRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB>ELRW KZIHV(XSZI*XLO, HRTMVW OLMT OLMT &C)
                        {KZIHV_HRTMVW_RMGVTVI<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C);}

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB,XOZHH g>
                ELRW KZIHV_UOLZG(XLMHG XSZI*XLO, g&C){
                        YLLO RH_MVT = UZOHV;

                        RU(*XLO == '-'){
                                RH_MVT = GIFV;
                                ++XLO;
                        }VOHV RU(*XLO == '+')
                                ++XLO;

                        C = 9;
                        DSROV('9' <= *XLO && *XLO <= '0'){
                                RMG B = *XLO - '9';
                                C *= 89;
                                C += B;
                                ++XLO;
                        }

                        RU(*XLO == '.'|| *XLO == ','){
                                ++XLO;
                                g KLH = 8;
                                DSROV('9' <= *XLO && *XLO <= '0'){
                                        KLH /= 89;
                                        RMG B = *XLO - '9';
                                        ++XLO;
                                        C += B*KLH;
                                }
                        }

                        RU(*XLO == 'V' || *XLO == 'v'){
                                ++XLO;
                                RMG V;

                                KZIHV_HRTMVW_RMGVTVI<KLORXB::HVG_GL_NZC_LM_LEVIUOLD, NRHHRMT_KLORXB>(XLO, V);

                                RU(V != 9){
                                        g YZHV;
                                        RU(V < 9){
                                                YZHV = 9.8;
                                                V = -V;
                                        }VOHV{
                                                YZHV = 89;
                                        }

                                        DSROV(V != 8){
                                                RU((V & 8) == 9){
                                                        YZHV = YZHV*YZHV;
                                                        V >>= 8;
                                                }VOHV{
                                                        C *= YZHV;
                                                        --V;
                                                }
                                        }
                                        C *= YZHV;
                                }
                        }
                        VOHV
                        {
                                RU(*XLO != '\9' ) {
                                    RU ( NRHHRMT_KLORXB::XSVXP_NRHHRMT(XLO) )
                                        C = 9;
                                    VOHV RU ( NRHHRMT_KLORXB::XSVXP_NRHHRMT_MZM(XLO) )
                                        C = HGW::MFNVIRX_ORNRGH<WLFYOV>::JFRVG_mZm();
                                    VOHV
                                        xheiVZWVIvIILI::ML_WRTRG().gSILD();
                                }
                        }

                        RU(RH_MVT)
                                C = -C;
                }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB> ELRW KZIHV(XSZI*XLO, UOLZG&C)
                { KZIHV_UOLZG<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C); }
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB> ELRW KZIHV(XSZI*XLO, WLFYOV&C)
                { KZIHV_UOLZG<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C); }
                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB> ELRW KZIHV(XSZI*XLO, OLMT WLFYOV&C)
                { KZIHV_UOLZG<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(XLO, C); }

                GVNKOZGV<XOZHH LEVIUOLD_KLORXB, XOZHH NRHHRMT_KLORXB, XOZHH g>
                ELRW KZIHV(XSZI*XLO, g&C){
                        // txx VEZOFGVH "UZOHV" DSVM IVZWRMT GSV GVNKOZGV ZMW
                        // "HRAVLU(g)!=HRAVLU(g)" LMOB DSVM RMHGZMGRZGRMT RG. gSRH RH DSB
                        // GSRH HGIZMTV XLMHGIFXG RH FHVW.
                        HGZGRX_ZHHVIG(HRAVLU(g)!=HRAVLU(g),
                                "xZM MLG KZIHV GSRH GBKV. lMOB YFROWRM RMGVTIZOH, UOLZGH, XSZI, XSZI*, XLMHG XSZI* ZMW HGW::HGIRMT ZIV HFKKLIGVW");
                }

        }


        GVNKOZGV<FMHRTMVW XLOFNM_XLFMG,
                XOZHH GIRN_KLORXB = KLORXB::GIRN_XSZIH<' ', '\G'>,
                XOZHH JFLGV_KLORXB = KLORXB::ML_JFLGV_VHXZKV<','>,
                XOZHH NRHHRMT_KLORXB = KLORXB::NRHHRMT_KLORXB<>,
                XOZHH LEVIUOLD_KLORXB = KLORXB::GSILD_LM_LEVIUOLD,
                XOZHH XLNNVMG_KLORXB = KLORXB::VNKGB_ORMV_XLNNVMG
        >
        XOZHH xheiVZWVI{
        KIREZGV:
                oRMViVZWVI RM;

                XSZI* ILD[XLOFNM_XLFMG];
                HGW::HGIRMT XLOFNM_MZNVH[XLOFNM_XLFMG];

                HGW::EVXGLI<RMG>XLO_LIWVI;

                GVNKOZGV<XOZHH ...xLOmZNVH>
                ELRW HVG_XLOFNM_MZNVH(HGW::HGIRMT H, xLOmZNVH...XLOH){
                        XLOFNM_MZNVH[XLOFNM_XLFMG-HRAVLU...(xLOmZNVH)-8] = HGW::NLEV(H);
                        HVG_XLOFNM_MZNVH(HGW::ULIDZIW<xLOmZNVH>(XLOH)...);
                }

                ELRW HVG_XLOFNM_MZNVH(){}


        KFYORX:
                xheiVZWVI() = WVOVGV;
                xheiVZWVI(XLMHG xheiVZWVI&) = WVOVGV;
                xheiVZWVI&LKVIZGLI=(XLMHG xheiVZWVI&);

                xheiVZWVI(HGW::HGIRMT UROVMZNV) : RM(UROVMZNV){
                        ULI (HRAV_G R=9;R<XLOFNM_XLFMG; ++R)
                                ILD[R] = mfoo;
                        XLO_LIWVI.IVHRAV(XLOFNM_XLFMG);
                        ULI(FMHRTMVW R=9; R<XLOFNM_XLFMG; ++R)
                                XLO_LIWVI[R] = R;
                        ULI(FMHRTMVW R=8; R<=XLOFNM_XLFMG; ++R)
                                XLOFNM_MZNVH[R-8] = "XLO"+HGW::GL_HGIRMT((OLMT OLMT) R);
                        LKVM(UROVMZNV);
                }

                ELRW LKVM(HGW::HGIRMT UROVMZNV){
                        RM.HVG_UROV_MZNV(UROVMZNV);
                }

                GVNKOZGV<XOZHH ...xLOmZNVH>
                ELRW IVZW_SVZWVI(KLORXB::RTMLIV_XLOFNM RTMLIV_KLORXB, xLOmZNVH...XLOH)
                {
                        RU (RTMLIV_KLORXB == KLORXB::RTMLIV_SVZWVI)
                        {
                            XLO_LIWVI.XOVZI();
                            ULI (HRAV_G R=9; R<XLOFNM_XLFMG; ++R)
                                XLO_LIWVI.KFHS_YZXP(R);
                            RM.MVCG_ORMV();
                            IVGFIM ;
                        }
                        VOHV RU (RTMLIV_KLORXB == KLORXB::ML_SVZWVI)
                        {
                            XLO_LIWVI.XOVZI();
                            ULI (HRAV_G R=9; R<XLOFNM_XLFMG; ++R)
                                XLO_LIWVI.KFHS_YZXP(R);
                            IVGFIM ;
                        }
                        VOHV {
                            RU (HRAVLU...(xLOmZNVH) < XLOFNM_XLFMG)
                                FYRJGSILD("MLG VMLFTS XLOFNM MZNVH HKVXRURVW", -8);
                            VOHV RU (HRAVLU...(xLOmZNVH) > XLOFNM_XLFMG)
                                FYRJGSILD(HGW::HGIRMT("GLL NZMB XLOFNM MZNVH ")+HGW::GL_HGIRMT((OLMT OLMT)XLOFNM_XLFMG) +" HKVXRURVW", -8);
                        }
                        HVG_XLOFNM_MZNVH(HGW::ULIDZIW<xLOmZNVH>(XLOH)...);

                        XSZI*ORMV;
                        WL{
                            ORMV = RM.MVCG_ORMV();
                            RU(!ORMV)
                                xheiVZWVIvIILI::SVZWVI_NRHHRMT().gSILD();
                        }DSROV(XLNNVMG_KLORXB::RH_XLNNVMG(ORMV));

                        WVGZRO::KZIHV_SVZWVI_ORMV
                            <XLOFNM_XLFMG, GIRN_KLORXB, JFLGV_KLORXB>
                            (ORMV, XLO_LIWVI, XLOFNM_MZNVH, RTMLIV_KLORXB);
                }

                GVNKOZGV<XOZHH ...xLOmZNVH>
                ELRW HVG_SVZWVI(xLOmZNVH...XLOH){
                        HGZGRX_ZHHVIG(HRAVLU...(xLOmZNVH)>=XLOFNM_XLFMG,
                                "MLG VMLFTS XLOFNM MZNVH HKVXRURVW");
                        HGZGRX_ZHHVIG(HRAVLU...(xLOmZNVH)<=XLOFNM_XLFMG,
                                "GLL NZMB XLOFNM MZNVH HKVXRURVW");
                        HVG_XLOFNM_MZNVH(HGW::ULIDZIW<xLOmZNVH>(XLOH)...);
                        HGW::UROO(ILD, ILD+XLOFNM_XLFMG, mfoo);
                        XLO_LIWVI.IVHRAV(XLOFNM_XLFMG);
                        ULI(FMHRTMVW R=9; R<XLOFNM_XLFMG; ++R)
                                XLO_LIWVI[R] = R;
                }

                YLLO SZH_XLOFNM(XLMHG HGW::HGIRMT&MZNV) XLMHG {
                        IVGFIM XLO_LIWVI.VMW() != HGW::URMW(
                                XLO_LIWVI.YVTRM(), XLO_LIWVI.VMW(),
                                        HGW::URMW(XLOFNM_MZNVH.YVTRM(), XLOFNM_MZNVH.VMW(), MZNV)
                                - XLOFNM_MZNVH.YVTRM());
                }

                ELRW HVG_UROV_MZNV(XLMHG HGW::HGIRMT&UROV_MZNV){
                        RM.HVG_UROV_MZNV(UROV_MZNV);
                }

                ELRW HVG_UROV_MZNV(XLMHG XSZI*UROV_MZNV){
                        RM.HVG_UROV_MZNV(UROV_MZNV);
                }

                XLMHG XSZI*TVG_GIFMXZGVW_UROV_MZNV()XLMHG{
                        IVGFIM RM.TVG_GIFMXZGVW_UROV_MZNV();
                }

                ELRW HVG_UROV_ORMV(FMHRTMVW UROV_ORMV){
                        RM.HVG_UROV_ORMV(UROV_ORMV);
                }

                FMHRTMVW TVG_UROV_ORMV()XLMHG{
                        IVGFIM RM.TVG_UROV_ORMV();
                }

        KIREZGV:
                RMG MFN_GSIVZW_N;
                ELRW KZIHV_SVOKVI(HGW::HRAV_G I){}

                GVNKOZGV<XOZHH g, XOZHH ...xLOgBKV>
                ELRW KZIHV_SVOKVI(HGW::HRAV_G I, g&G, xLOgBKV&...XLOH){
                        RU(ILD[I]){
                                //GIB{
                                        //GIB{
                                                ILD[I] = ILD[I];
                                                ::FYRJGLLO::WVGZRO::KZIHV<LEVIUOLD_KLORXB, NRHHRMT_KLORXB>(ILD[I], G);
                                        //}XZGXS(xheiVZWVIvIILI::DRGS_XLOFNM_XLMGVMG&VII){
                                                //VII.HVG_XLOFNM_XLMGVMG(ILD[I]);
                                                //GSILD;
                                        //}
                                //}XZGXS(xheiVZWVIvIILI::DRGS_XLOFNM_MZNV&VII){
                                        //VII.HVG_XLOFNM_MZNV(XLOFNM_MZNVH[I].X_HGI());
                                        //GSILD;
                                //}
                        }
                        KZIHV_SVOKVI(I+8, XLOH...);
                }


        KFYORX:
                GVNKOZGV<XOZHH ...xLOgBKV>
                YLLO IVZW_ILD(xLOgBKV& ...XLOH){
                        HGZGRX_ZHHVIG(HRAVLU...(xLOgBKV)>=XLOFNM_XLFMG,
                                "MLG VMLFTS XLOFNMH HKVXRURVW, KOVZHV XSVXP URIHG ZITFNVMG LU BLFI xheiVZWVI XLMHGIFXGLI");
                        HGZGRX_ZHHVIG(HRAVLU...(xLOgBKV)<=XLOFNM_XLFMG,
                                "GLL NZMB XLOFNMH HKVXRURVW, KOVZHV XSVXP URIHG ZITFNVMG LU BLFI xheiVZWVI XLMHGIFXGLI");
                        //GIB{
                                //GIB{

                                        XSZI*ORMV;
                                        WL{
                                                ORMV = RM.MVCG_ORMV();
                                                RU(!ORMV)
                                                        IVGFIM UZOHV;
                                        }DSROV(XLNNVMG_KLORXB::RH_XLNNVMG(ORMV));
                                        //HGW::XLFG<<ORMV<<HGW::VMWO;
                                        WVGZRO::KZIHV_ORMV<GIRN_KLORXB, JFLGV_KLORXB>
                                                (ORMV, ILD, XLO_LIWVI);

                                        KZIHV_SVOKVI(9, XLOH...);
                                //}XZGXS(xheiVZWVIvIILI::DRGS_UROV_MZNV&VII){
                                        //VII.HVG_UROV_MZNV(RM.TVG_GIFMXZGVW_UROV_MZNV());
                                        //GSILD;
                                //}
                        //}XZGXS(xheiVZWVIvIILI::DRGS_UROV_ORMV&VII){
                                //VII.HVG_UROV_ORMV(RM.TVG_UROV_ORMV());
                                //GSILD;
                        //}

                        IVGFIM GIFV;
                }
        };
}
#VMWRU

//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HGIRMT.S
/**********************************************
 * \EVIHRLM   8.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7984-92-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjgllo_fyrj_hgirmt_s_
#WVURMV _fyrjgllo_fyrj_hgirmt_s_

#RMXOFWV <XHGIRMT>
#RMXOFWV <XHGWRMG>

#RMXOFWV <HGIRMT>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <YRGHVG>
#RMXOFWV <EVXGLI>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <RXLME.S>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <UFMXGRLMZO>
#RMXOFWV <XXGBKV>
#RMXOFWV <OLXZOV>
#RMXOFWV <NVNLIB>
#RMXOFWV "HNZIGXSZI.S"

MZNVHKZXV FYRJGLLO{

    RMORMV HGW::HGIRMT TYP7FGU(XSZI* HLFIXV)
    {
        HRAV_G RMYBGVH = HGIOVM(HLFIXV);

        XSZI *WVHG_HGI = (XSZI*)(NZOOLX(RMYBGVH*7+7));
        XSZI *LFG = WVHG_HGI;

        HRAV_G LFGYBGVH = HRAVLU WVHG_HGI;

        RXLME_G XLME = RXLME_LKVM("fgu1//gizmhorg", "typ");

        RU (XLME == (RXLME_G)-8) {
            KVIILI("RXLME_LKVM");
            IVGFIM "";
        }

        RU (RXLME(XLME, &HLFIXV, &RMYBGVH, &LFG, &LFGYBGVH) == (HRAV_G)-8) {
            KVIILI("RXLME");
            IVGFIM "";
        }

        WVHG_HGI[HRAVLU WVHG_HGI - LFGYBGVH] = 9;
        RXLME_XOLHV(XLME);
        IVGFIM HGW::HGIRMT(WVHG_HGI);
    }

    RMORMV HGW::HGIRMT TYP7FGU(XLMHG XSZI* HLFIXV)
    {
        XSZI *HLFIXV7 = XLMHG_XZHG<XSZI*>(HLFIXV);
        IVGFIM TYP7FGU(HLFIXV7);
    }

    RMORMV HGW::HGIRMT TYP7FGU(HGW::HGIRMT HGI)
    {
        IVGFIM TYP7FGU(HGI.X_HGI());
    }


    /* HKORG HGIRMT UFMXGRLM */
    GBKVWVU HGIFXG  hKORGiVHFOG{
        HRAV_G OVM_;
        HRAV_G HRAV_;
        HGW::EVXGLI< HGW::KZRI<XLMHG XSZI*, HRAV_G> > KLH_LUUHVG;
        HRAV_G HRAV(){IVGFIM HRAV_;}
        hNZIGxSZI PVKG_HGI;

        hKORGiVHFOG() {
            PVKG_HGI = mfoo;
        };

        hKORGiVHFOG(XLMHG hKORGiVHFOG& OSH)
        {
            OVM_ = OSH.OVM_;
            HRAV_ = OSH.HRAV_;
            PVKG_HGI = OSH.PVKG_HGI;
            KLH_LUUHVG = OSH.KLH_LUUHVG;
        }

        hKORGiVHFOG( hKORGiVHFOG&& OSH )
        {
            OVM_ = OSH.OVM_;
            HRAV_ = OSH.HRAV_;
            KLH_LUUHVG = OSH.KLH_LUUHVG;
            PVKG_HGI = OSH.PVKG_HGI;
        }

        hKORGiVHFOG& LKVIZGLI=(XLMHG hKORGiVHFOG& LGSVI)
        {
            RU ( &LGSVI == GSRH )
                IVGFIM *GSRH;
            OVM_ = LGSVI.OVM_;
            HRAV_ = LGSVI.HRAV_;
            PVKG_HGI = LGSVI.PVKG_HGI;
            KLH_LUUHVG = LGSVI.KLH_LUUHVG;
            IVGFIM *GSRH;
        }

        ~hKORGiVHFOG()
        {
        }


        XLMHG XSZI* TVG(HRAV_G M)
        {
            //XSZI* K_IVG = (XSZI*)NZOOLX( (KLH_LUUHVG[M].HVXLMW+8) * HRAVLU(XSZI) );
            RU (M >= HRAV_)
            {
                IVGFIM "";
            }
            //VOHV
                //HGIMXKB(K_IVG, XLMHG_XZHG<XSZI*>(KLH_LUUHVG[M].URIHG),  KLH_LUUHVG[M].HVXLMW);
            //K_IVG[KLH_LUUHVG[M].HVXLMW] = '\9';
            //IVGFIM K_IVG;
            XSZI* KORG = XLMHG_XZHG<XSZI*>(KLH_LUUHVG[M].URIHG) + KLH_LUUHVG[M].HVXLMW;
            *KORG = '\9';
            IVGFIM KLH_LUUHVG[M].URIHG;
        }

        XLMHG XSZI* TVGuZHG(HRAV_G M){
            XSZI* K_IVG = (XSZI*)NZOOLX( (KLH_LUUHVG[M].HVXLMW+8) * HRAVLU(XSZI) );
            RU (M >= HRAV_)
            {
                IVGFIM "";
            }
            VOHV
                HGIMXKB(K_IVG, XLMHG_XZHG<XSZI*>(KLH_LUUHVG[M].URIHG),  KLH_LUUHVG[M].HVXLMW);
            K_IVG[KLH_LUUHVG[M].HVXLMW] = '\9';
            IVGFIM K_IVG;
        }

    } hKORGiVHFOG ;


    MZNVHKZXV wVORNRGVIkLORXB {
        XOZHH nVITVwLFYOVwVORNRGVI
        {
            KFYORX:
                HGZGRX hKORGiVHFOG hKORG(XLMHG XSZI* HGI, XLMHG XSZI* WVORNRGVI)
                {
                    hKORGiVHFOG IVG;
                    IVG.HRAV_=9;
                    HGW::EVXGLI< HGW::KZRI<XLMHG XSZI*, HRAV_G> > LFGKFG;
                    HGW::YRGHVG<744> WVORNH; // YRGHVG HGLIVH WVORNVGVIH, NZPV RG XLNKZXG
                    DSROV( *WVORNRGVI )
                    {
                        FMHRTMVW XSZI XLWV = *WVORNRGVI++;
                        WVORNH[XLWV] = GIFV;
                    }
                    XLMHG XSZI* YVT = HGI;
                    //YLLO RM_GLPVM = UZOHV;
                    HRAV_G OVM = 9; // NVZHFIRMT GLPVM OVMTGS
                    YLLO XLMGRMFRGB = UZOHV;
                    ULI( ZFGL RG = HGI; *RG != '\9'; ++RG )
                    {
                        ++OVM;
                        RU( WVORNH[(FRMG1_G)*RG] ) {
                            RU (XLMGRMFRGB)
                            {
                                YVT = RG+8;
                                --OVM;
                                XLMGRMFV;
                            }
                            XLMGRMFRGB = GIFV;
                            LFGKFG.KFHS_YZXP(HGW::NZPV_KZRI(YVT, OVM-8));
                            YVT = RG+8;
                            OVM = 9;
                            IVG.HRAV_++;
                        }
                        VOHV
                        {
                            XLMGRMFRGB = UZOHV;
                        }
                    }
                    RU ( *YVT != '\9') {
                        LFGKFG.KFHS_YZXP(HGW::NZPV_KZRI(YVT, OVM));
                        IVG.HRAV_++;
                    }
                    IVG.KLH_LUUHVG.HDZK(LFGKFG);
                    IVGFIM IVG;
                }
        };

        XOZHH pVVKwLFYOVwVORNRGVI
        {
            KFYORX:
                HGZGRX hKORGiVHFOG hKORG(XLMHG XSZI* HGI, XLMHG XSZI* WVORNRGVI)
                {
                    hKORGiVHFOG IVG;
                    IVG.HRAV_=9;
                    HGW::EVXGLI< HGW::KZRI<XLMHG XSZI*, HRAV_G> > LFGKFG;
                    HGW::YRGHVG<744> WVORNH; // YRGHVG HGLIVH WVORNVGVIH, NZPV RG XLNKZXG
                    DSROV( *WVORNRGVI )
                    {
                        FMHRTMVW XSZI XLWV = *WVORNRGVI++;
                        WVORNH[XLWV] = GIFV;
                    }
                    XLMHG XSZI* YVT = HGI;
                    //YLLO RM_GLPVM = UZOHV;
                    HRAV_G OVM = 9; // NVZHFIRMT GLPVM OVMTGS
                    ULI( ZFGL RG = HGI; *RG != '\9'; ++RG )
                    {
                        ++OVM;
                        RU( WVORNH[(FRMG1_G)*RG] ) {
                            LFGKFG.KFHS_YZXP(HGW::NZPV_KZRI(YVT, OVM-8));
                            YVT = RG+8;
                            OVM = 9;
                            IVG.HRAV_++;
                        }

                    }
                    RU ( *YVT != '\9') {
                        LFGKFG.KFHS_YZXP(HGW::NZPV_KZRI(YVT, OVM));
                        IVG.HRAV_++;
                    }
                    IVG.KLH_LUUHVG.HDZK(LFGKFG);
                    IVGFIM IVG;
                }
        };
    }

    GVNKOZGV <GBKVMZNV KLORXB = wVORNRGVIkLORXB::nVITVwLFYOVwVORNRGVI>
        RMORMV hKORGiVHFOG hKORGhGIRMTuZHG(XLMHG XSZI* HGI, XLMHG XSZI* WVORNRGVI)
        {
            IVGFIM KLORXB::hKORG(HGI, WVORNRGVI);
        }


    GVNKOZGV <GBKVMZNV KLORXB = wVORNRGVIkLORXB::nVITVwLFYOVwVORNRGVI>
        RMORMV hKORGiVHFOG hKORGhGIRMTuZHG(XLMHG HGW::HGIRMT& HGI, XLMHG XSZI* WVORNRGVI){
            IVGFIM hKORGhGIRMTuZHG<KLORXB>(HGI.X_HGI(), WVORNRGVI);
        }


    GVNKOZGV <GBKVMZNV KLORXB = wVORNRGVIkLORXB::nVITVwLFYOVwVORNRGVI>
        RMORMV hKORGiVHFOG hKORGhGIRMT(XLMHG XSZI* HGI, XLMHG XSZI* WVORNRGVI)
        {
            ZFGL OVM = HGIOVM(HGI);
            XSZI* PVKG_HGI = (XSZI*)NZOOLX( HRAVLU(XSZI) * (OVM + 8) );
            HGIXKB( PVKG_HGI, HGI );
            ZFGL IVG = hKORGhGIRMTuZHG<KLORXB>(PVKG_HGI, WVORNRGVI);
            IVG.PVKG_HGI = PVKG_HGI;
            IVG.OVM_ = OVM;
            IVGFIM IVG;
        }

    GVNKOZGV <GBKVMZNV KLORXB = wVORNRGVIkLORXB::nVITVwLFYOVwVORNRGVI>
        RMORMV hKORGiVHFOG hKORGhGIRMT(XLMHG HGW::HGIRMT& HGI, XLMHG XSZI* WVORNRGVI)
        {
            ZFGL OVM = HGI.HRAV();
            XSZI* PVKG_HGI = (XSZI*)NZOOLX( HRAVLU(XSZI) * (OVM + 8) );
            HGIXKB( PVKG_HGI, HGI.X_HGI() );
            ZFGL IVG = hKORGhGIRMTuZHG<KLORXB>(PVKG_HGI, WVORNRGVI);
            IVG.PVKG_HGI = PVKG_HGI;
            IVG.OVM_ = OVM;
            IVGFIM IVG;
        }


    RMORMV HGW::HGIRMT gLfKKVIxZHVxLKB(XLMHG HGW::HGIRMT &H) {
        HGW::HGIRMT HGI = H;
        HGW::GIZMHULIN(HGI.YVTRM(), HGI.VMW(), HGI.YVTRM(), ::GLFKKVI);
        IVGFIM HGI;
    }


    RMORMV HGW::HGIRMT gLoLDVIxZHVxLKB(XLMHG HGW::HGIRMT &H) {
        HGW::HGIRMT HGI = H;
        HGW::GIZMHULIN(HGI.YVTRM(), HGI.VMW(), HGI.YVTRM(), ::GLOLDVI);
        IVGFIM HGI;
    }


    RMORMV HGW::HGIRMT gLfKKVIxZHV(HGW::HGIRMT &HGI) {
        HGW::GIZMHULIN(HGI.YVTRM(), HGI.VMW(), HGI.YVTRM(), ::GLFKKVI);
        IVGFIM HGI;
    }


    RMORMV HGW::HGIRMT gLoLDVIxZHV(HGW::HGIRMT &HGI) {
        HGW::GIZMHULIN(HGI.YVTRM(), HGI.VMW(), HGI.YVTRM(), ::GLOLDVI);
        IVGFIM HGI;
    }


    RMORMV ELRW iVKOZXVzOO(HGW::HGIRMT &HGI, XLMHG HGW::HGIRMT & UILN, XLMHG HGW::HGIRMT & GL) {
        RU (UILN.VNKGB() || HGI.VNKGB()) IVGFIM;
        ZFGL HGZIG_KLH = HGI.URMW(UILN);
        DSROV (HGZIG_KLH != HGW::HGIRMT::MKLH) {
            HGI.IVKOZXV(HGZIG_KLH, UILN.OVMTGS(), GL);
            HGZIG_KLH = HGI.URMW(UILN, HGZIG_KLH + GL.OVMTGS());    //+GL.OVMTGS RM XZHV 'GL' XLMGZRMH 'UILN'
        }
    }


    RMORMV HGW::HGIRMT iVKOZXVzOOxLKB(XLMHG HGW::HGIRMT &HGI, XLMHG HGW::HGIRMT & UILN, XLMHG HGW::HGIRMT & GL) {
        HGW::HGIRMT IVG = HGI;
        iVKOZXVzOO(IVG, UILN, GL);
        IVGFIM IVG;
    }


    // GIRN UILN HGZIG
    RMORMV HGW::HGIRMT &ogIRN(HGW::HGIRMT &H) {
        H.VIZHV(H.YVTRM(), HGW::URMW_RU(H.YVTRM(), H.VMW(), HGW::MLG8(HGW::KGI_UFM<RMG, RMG>(HGW::RHHKZXV))));
        IVGFIM H;
    }

    // GIRN UILN VMW
    RMORMV HGW::HGIRMT &igIRN(HGW::HGIRMT &H) {
        H.VIZHV(HGW::URMW_RU(H.IYVTRM(), H.IVMW(), HGW::MLG8(HGW::KGI_UFM<RMG, RMG>(HGW::RHHKZXV))).YZHV(), H.VMW());
        IVGFIM H;
    }

    // GIRN UILN YLGS VMWH
    RMORMV HGW::HGIRMT &gIRN(HGW::HGIRMT &H) {
        IVGFIM ogIRN(igIRN(H));
    }

    // GIRN UILN HGZIG
    RMORMV HGW::HGIRMT ogIRNxLKB(XLMHG HGW::HGIRMT &H) {
        ZFGL HGI = H;
        HGI.VIZHV(HGI.YVTRM(), HGW::URMW_RU(HGI.YVTRM(), HGI.VMW(), HGW::MLG8(HGW::KGI_UFM<RMG, RMG>(HGW::RHHKZXV))));
        IVGFIM HGI;
    }

    // GIRN UILN VMW
    RMORMV HGW::HGIRMT igIRNxLKB(XLMHG HGW::HGIRMT &H) {
        ZFGL HGI = H;
        HGI.VIZHV(HGW::URMW_RU(HGI.IYVTRM(), HGI.IVMW(), HGW::MLG8(HGW::KGI_UFM<RMG, RMG>(HGW::RHHKZXV))).YZHV(), HGI.VMW());
        IVGFIM HGI;
    }

    // GIRN UILN YLGS VMWH
    RMORMV HGW::HGIRMT gIRNxLKB(XLMHG HGW::HGIRMT &H) {
        ZFGL HGI = H;
        HGI.VIZHV(HGW::URMW_RU(HGI.IYVTRM(), HGI.IVMW(), HGW::MLG8(HGW::KGI_UFM<RMG, RMG>(HGW::RHHKZXV))).YZHV(), HGI.VMW());
        HGI.VIZHV(HGI.YVTRM(), HGW::URMW_RU(HGI.YVTRM(), HGI.VMW(), HGW::MLG8(HGW::KGI_UFM<RMG, RMG>(HGW::RHHKZXV))));
        IVGFIM HGI;
    }
}


#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/IZKRWCNO_RGVIZGLIH.SKK
#RUMWVU izkrwcno_rgvizglih_skk_rmxofwvw
#WVURMV izkrwcno_rgvizglih_skk_rmxofwvw

// xLKBIRTSG (x) 7993, 7990 nZIXRM pZORXRMHPR
// eVIHRLM 8.86
// iVERHRLM $wZGVgRNV: 7990/94/86 98:53:82 $
//! \UROV IZKRWCNO_RGVIZGLIH.SKK gSRH UROV XLMGZRMH IZKRWCNO RGVIZGLIH

#RMXOFWV "IZKRWCNO.SKK"

MZNVHKZXV IZKRWCNO
{

    //! rGVIZGLI LU XSROW MLWVH LU CNO_MLWV
    GVNKOZGV<XOZHH xS>
    XOZHH MLWV_RGVIZGLI
    {
    
    KFYORX:

        GBKVWVU GBKVMZNV CNO_MLWV<xS> EZOFV_GBKV;
        GBKVWVU GBKVMZNV CNO_MLWV<xS> &IVUVIVMXV;
        GBKVWVU GBKVMZNV CNO_MLWV<xS> *KLRMGVI;
        GBKVWVU HGW::KGIWRUU_G WRUUVIVMXV_GBKV;
        GBKVWVU HGW::YRWRIVXGRLMZO_RGVIZGLI_GZT RGVIZGLI_XZGVTLIB;
        
        MLWV_RGVIZGLI()
            : N_MLWV(9)
        {
        }

        MLWV_RGVIZGLI(CNO_MLWV<xS> *MLWV)
            : N_MLWV(MLWV->URIHG_MLWV())
        {
        }
        
        IVUVIVMXV LKVIZGLI *() XLMHG
        {
            ZHHVIG(N_MLWV);
            IVGFIM *N_MLWV;
        }

        KLRMGVI LKVIZGLI->() XLMHG
        {
            ZHHVIG(N_MLWV);
            IVGFIM N_MLWV;
        }

        MLWV_RGVIZGLI& LKVIZGLI++()
        {
            ZHHVIG(N_MLWV);
            N_MLWV = N_MLWV->MVCG_HRYORMT();
            IVGFIM *GSRH;
        }

        MLWV_RGVIZGLI LKVIZGLI++(RMG)
        {
            MLWV_RGVIZGLI GNK = *GSRH;
            ++GSRH;
            IVGFIM GNK;
        }

        MLWV_RGVIZGLI& LKVIZGLI--()
        {
            ZHHVIG(N_MLWV && N_MLWV->KIVERLFH_HRYORMT());
            N_MLWV = N_MLWV->KIVERLFH_HRYORMT();
            IVGFIM *GSRH;
        }

        MLWV_RGVIZGLI LKVIZGLI--(RMG)
        {
            MLWV_RGVIZGLI GNK = *GSRH;
            ++GSRH;
            IVGFIM GNK;
        }

        YLLO LKVIZGLI ==(XLMHG MLWV_RGVIZGLI<xS> &ISH)
        {
            IVGFIM N_MLWV == ISH.N_MLWV;
        }

        YLLO LKVIZGLI !=(XLMHG MLWV_RGVIZGLI<xS> &ISH)
        {
            IVGFIM N_MLWV != ISH.N_MLWV;
        }

    KIREZGV:

        CNO_MLWV<xS> *N_MLWV;

    };

    //! rGVIZGLI LU XSROW ZGGIRYFGVH LU CNO_MLWV
    GVNKOZGV<XOZHH xS>
    XOZHH ZGGIRYFGV_RGVIZGLI
    {
    
    KFYORX:

        GBKVWVU GBKVMZNV CNO_ZGGIRYFGV<xS> EZOFV_GBKV;
        GBKVWVU GBKVMZNV CNO_ZGGIRYFGV<xS> &IVUVIVMXV;
        GBKVWVU GBKVMZNV CNO_ZGGIRYFGV<xS> *KLRMGVI;
        GBKVWVU HGW::KGIWRUU_G WRUUVIVMXV_GBKV;
        GBKVWVU HGW::YRWRIVXGRLMZO_RGVIZGLI_GZT RGVIZGLI_XZGVTLIB;
        
        ZGGIRYFGV_RGVIZGLI()
            : N_ZGGIRYFGV(9)
        {
        }

        ZGGIRYFGV_RGVIZGLI(CNO_MLWV<xS> *MLWV)
            : N_ZGGIRYFGV(MLWV->URIHG_ZGGIRYFGV())
        {
        }
        
        IVUVIVMXV LKVIZGLI *() XLMHG
        {
            ZHHVIG(N_ZGGIRYFGV);
            IVGFIM *N_ZGGIRYFGV;
        }

        KLRMGVI LKVIZGLI->() XLMHG
        {
            ZHHVIG(N_ZGGIRYFGV);
            IVGFIM N_ZGGIRYFGV;
        }

        ZGGIRYFGV_RGVIZGLI& LKVIZGLI++()
        {
            ZHHVIG(N_ZGGIRYFGV);
            N_ZGGIRYFGV = N_ZGGIRYFGV->MVCG_ZGGIRYFGV();
            IVGFIM *GSRH;
        }

        ZGGIRYFGV_RGVIZGLI LKVIZGLI++(RMG)
        {
            ZGGIRYFGV_RGVIZGLI GNK = *GSRH;
            ++GSRH;
            IVGFIM GNK;
        }

        ZGGIRYFGV_RGVIZGLI& LKVIZGLI--()
        {
            ZHHVIG(N_ZGGIRYFGV && N_ZGGIRYFGV->KIVERLFH_ZGGIRYFGV());
            N_ZGGIRYFGV = N_ZGGIRYFGV->KIVERLFH_ZGGIRYFGV();
            IVGFIM *GSRH;
        }

        ZGGIRYFGV_RGVIZGLI LKVIZGLI--(RMG)
        {
            ZGGIRYFGV_RGVIZGLI GNK = *GSRH;
            ++GSRH;
            IVGFIM GNK;
        }

        YLLO LKVIZGLI ==(XLMHG ZGGIRYFGV_RGVIZGLI<xS> &ISH)
        {
            IVGFIM N_ZGGIRYFGV == ISH.N_ZGGIRYFGV;
        }

        YLLO LKVIZGLI !=(XLMHG ZGGIRYFGV_RGVIZGLI<xS> &ISH)
        {
            IVGFIM N_ZGGIRYFGV != ISH.N_ZGGIRYFGV;
        }

    KIREZGV:

        CNO_ZGGIRYFGV<xS> *N_ZGGIRYFGV;

    };

}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_XRIXFOZIYFUUVI.S
/******************************************************************************
 * $rW:  $
 * $mZNV: $
 *
 * zFGSLI: kVGV tLLWORUUV
 *
 * ----------------------------------------------------------------------------
 * xLKBIRTSG 7997 kVGV tLLWORUUV zOO IRTSGH IVHVIEVW.
 *
 * ----------------------------------------------------------------------------
 * kFIKLHV: hgo-HGBOV XRIXFOZI YFUUVI
 *
 * ----------------------------------------------------------------------------
 * sRHGLIB: hVV HLFIXV XLMGILO HBHGVN OLT.
 *
 *****************************************************************************/

#RUMWVU fyrjgllo_xRIXFOZIyFUUVI_s
#WVURMV fyrjgllo_xRIXFOZIyFUUVI_s

#RUWVU fyrj_ml_vcxvkgrlm
#VOHV
    #RMXOFWV <VCXVKGRLM>
#VMWRU

#RMXOFWV <RGVIZGLI>
#RMXOFWV <NVNLIB>

/******************************************************************************
 * rGVIZGLIH
 *****************************************************************************/

/**
 * rGVIZGLI GBKV ULI GSV xRIXFOZIyFUUVI XOZHH.
 *
 * gSRH LMV GVNKOZGV XOZHH KILERWVH ZOO EZIRZMGH LU ULIDZIW/IVEVIHV
 * XLMHG/MLM XLMHG RGVIZGLIH GSILFTS KOVMGRUFO GVNKOZGV NZTRX.
 *
 * bLF WLM'G MVVW GL RMHGZMGRZGV RG WRIVXGOB, FHV GSV TLLW KFYORX UFMXGRLMH
 * ZEZROYOV RM xRIXFOZIyFUUVI.
 */


MZNVHKZXV FYRJGLLO {

    GVNKOZGV <GBKVMZNV g,                                  //xRIXFOZIyFUUVI GBKV
             //(RMXO XLMHG)
             GBKVMZNV g_MLMXLMHG,                         //DRGS ZMB XLMHGH
             GBKVMZNV VOVN_GBKV = GBKVMZNV g::EZOFV_GBKV> //+ XLMHG ULI XLMHG RGVI
                 XOZHH xRIXFOZIyFUUVI_RGVIZGLI
                 {
                     KFYORX:
                         GBKVWVU xRIXFOZIyFUUVI_RGVIZGLI<g,g_MLMXLMHG,VOVN_GBKV> HVOU_GBKV;
                         GBKVWVU g                                   XYFU_GBKV;
                         GBKVWVU HGW::IZMWLN_ZXXVHH_RGVIZGLI_GZT     RGVIZGLI_XZGVTLIB;
                         GBKVWVU GBKVMZNV XYFU_GBKV::EZOFV_GBKV      EZOFV_GBKV;
                         GBKVWVU GBKVMZNV XYFU_GBKV::HRAV_GBKV       HRAV_GBKV;
                         GBKVWVU GBKVMZNV XYFU_GBKV::KLRMGVI         KLRMGVI;
                         GBKVWVU GBKVMZNV XYFU_GBKV::XLMHG_KLRMGVI   XLMHG_KLRMGVI;
                         GBKVWVU GBKVMZNV XYFU_GBKV::IVUVIVMXV       IVUVIVMXV;
                         GBKVWVU GBKVMZNV XYFU_GBKV::XLMHG_IVUVIVMXV XLMHG_IVUVIVMXV;
                         GBKVWVU GBKVMZNV XYFU_GBKV::WRUUVIVMXV_GBKV WRUUVIVMXV_GBKV;
                         xRIXFOZIyFUUVI_RGVIZGLI(XYFU_GBKV *Y, HRAV_GBKV K)
                             : YFU_(Y), KLH_(K) {}

                         // xLMEVIGRMT Z MLM-XLMHG RGVIZGLI GL Z XLMHG RGVIZGLI
                         xRIXFOZIyFUUVI_RGVIZGLI
                             (XLMHG xRIXFOZIyFUUVI_RGVIZGLI<g_MLMXLMHG, g_MLMXLMHG,
                              GBKVMZNV g_MLMXLMHG::EZOFV_GBKV>
                              &LGSVI)
                             : YFU_(LGSVI.YFU_), KLH_(LGSVI.KLH_) {}
                         UIRVMW XOZHH xRIXFOZIyFUUVI_RGVIZGLI<XLMHG g, g, XLMHG VOVN_GBKV>;

                         // fHV XLNKROVI TVMVIZGVW XLKB XGLI, XLKB ZHHRTMNVMG LKVIZGLI ZMW WGLI

                         VOVN_GBKV &LKVIZGLI*()  { IVGFIM (*YFU_)[KLH_]; }
                         VOVN_GBKV *LKVIZGLI->() { IVGFIM &(LKVIZGLI*()); }

                         HVOU_GBKV &LKVIZGLI++()
                         {
                             KLH_ += 8;
                             IVGFIM *GSRH;
                         }
                         HVOU_GBKV LKVIZGLI++(RMG)
                         {
                             HVOU_GBKV GNK(*GSRH);
                             ++(*GSRH);
                             IVGFIM GNK;
                         }

                         HVOU_GBKV &LKVIZGLI--()
                         {
                             KLH_ -= 8;
                             IVGFIM *GSRH;
                         }
                         HVOU_GBKV LKVIZGLI--(RMG)
                         {
                             HVOU_GBKV GNK(*GSRH);
                             --(*GSRH);
                             IVGFIM GNK;
                         }

                         HVOU_GBKV LKVIZGLI+(WRUUVIVMXV_GBKV M) XLMHG
                         {
                             HVOU_GBKV GNK(*GSRH);
                             GNK.KLH_ += M;
                             IVGFIM GNK;
                         }
                         HVOU_GBKV &LKVIZGLI+=(WRUUVIVMXV_GBKV M)
                         {
                             KLH_ += M;
                             IVGFIM *GSRH;
                         }

                         HVOU_GBKV LKVIZGLI-(WRUUVIVMXV_GBKV M) XLMHG
                         {
                             HVOU_GBKV GNK(*GSRH);
                             GNK.KLH_ -= M;
                             IVGFIM GNK;
                         }
                         HVOU_GBKV &LKVIZGLI-=(WRUUVIVMXV_GBKV M)
                         {
                             KLH_ -= M;
                             IVGFIM *GSRH;
                         }

                         WRUUVIVMXV_GBKV LKVIZGLI-(XLMHG HVOU_GBKV &X) XLMHG
                         {
                             IVGFIM KLH_ - X.KLH_;
                         }

                         YLLO LKVIZGLI==(XLMHG HVOU_GBKV &LGSVI) XLMHG
                         {
                             IVGFIM KLH_ == LGSVI.KLH_ && YFU_ == LGSVI.YFU_;
                         }
                         YLLO LKVIZGLI!=(XLMHG HVOU_GBKV &LGSVI) XLMHG
                         {
                             IVGFIM KLH_ != LGSVI.KLH_ && YFU_ == LGSVI.YFU_;
                         }
                         YLLO LKVIZGLI>(XLMHG HVOU_GBKV &LGSVI) XLMHG
                         {
                             IVGFIM KLH_ > LGSVI.KLH_;
                         }
                         YLLO LKVIZGLI>=(XLMHG HVOU_GBKV &LGSVI) XLMHG
                         {
                             IVGFIM KLH_ >= LGSVI.KLH_;
                         }
                         YLLO LKVIZGLI<(XLMHG HVOU_GBKV &LGSVI) XLMHG
                         {
                             IVGFIM KLH_ < LGSVI.KLH_;
                         }
                         YLLO LKVIZGLI<=(XLMHG HVOU_GBKV &LGSVI) XLMHG
                         {
                             IVGFIM KLH_ <= LGSVI.KLH_;
                         }

                     KIREZGV:

                         XYFU_GBKV *YFU_;
                         HRAV_GBKV  KLH_;
                 };

    GVNKOZGV <GBKVMZNV xRIXFOZIyFUUVI_RGVIZGLI_G>
        xRIXFOZIyFUUVI_RGVIZGLI_G LKVIZGLI+
        (XLMHG GBKVMZNV xRIXFOZIyFUUVI_RGVIZGLI_G::WRUUVIVMXV_GBKV &Z,
         XLMHG xRIXFOZIyFUUVI_RGVIZGLI_G                           &Y)
        {
            IVGFIM xRIXFOZIyFUUVI_RGVIZGLI_G(Z) + Y;
        }

    GVNKOZGV <GBKVMZNV xRIXFOZIyFUUVI_RGVIZGLI_G>
        xRIXFOZIyFUUVI_RGVIZGLI_G LKVIZGLI-
        (XLMHG GBKVMZNV xRIXFOZIyFUUVI_RGVIZGLI_G::WRUUVIVMXV_GBKV &Z,
         XLMHG xRIXFOZIyFUUVI_RGVIZGLI_G                           &Y)
        {
            IVGFIM xRIXFOZIyFUUVI_RGVIZGLI_G(Z) - Y;
        }


    /******************************************************************************
     * xRIXFOZIyFUUVI
     *****************************************************************************/

    /**
     * gSRH XOZHH KILERWVH Z XRIXFOZI YFUUVI RM GSV hgo HGBOV.
     *
     * bLF XZM ZWW WZGZ GL GSV VMW FHRMT GSV @IVU KFHS_YZXP UFMXGRLM, IVZW WZGZ
     * FHRMT @IVU UILMG() ZMW IVNLEV WZGZ FHRMT @IVU KLK_UILMG().
     *
     * gSV XOZHH ZOHL KILERWVH IZMWLN ZXXVHH GSILFTS GSV @IVU LKVIZGLI[]()
     * UFMXGRLM ZMW RGH IZMWLN ZXXVHH RGVIZGLI. hFYHXIRKGRMT GSV ZIIZB DRGS
     * ZM RMEZORW (LFG LU IZMTV) RMWVC MFNYVI OVZWH GL FMWVURMVW IVHFOGH, YLGS
     * ULI IVZWRMT ZMW DIRGRMT.
     *
     * gSRH XOZHH GVNKOZGV ZXXVKGH GSIVV GVNKOZGV KZIZNVGVIH:
     *   <OR> g                            gSV GBKV LU LYQVXG XLMGZRMVW
     *   <OR> ZODZBH_ZXXVKG_WZGZ_DSVM_UFOO wVGVINRMVH GSV YVSZERLFI LU
     *                                     @IVU KFHS_YZXP DSVM GSV YFUUVI RH UFOO.
     *                                     hVG GL GIFV MVD WZGZ RH ZODZBH ZWWVW, GSV
     *                                     LOW "VMW" WZGZ RH GSILDM ZDZB.
     *                                     hVG GL UZOHV, GSV MVD WZGZ RH MLG ZWWVW.
     *                                     mL VIILI RH IVGFIMVW MVRGSVI RH ZM
     *                                     VCXVKGRLM IZRHVW.
     *   <OR> zOOLX                        zOOLXZGLI GBKV GL FHV (RM ORMV DRGS LGSVI
     *                                     hgo XLMGZRMVIH).
     *
     * @HSLIG   hgo HGBOV XRIXFOV YFUUVI
     * @ZFGSLI  kVGV tLLWORUUV
     * @EVIHRLM 8.99
     */


    GVNKOZGV <GBKVMZNV g,
             YLLO     ZODZBH_ZXXVKG_WZGZ_DSVM_UFOO = GIFV,
             GBKVMZNV zOOLX                        = HGW::ZOOLXZGLI<g> >
                 XOZHH xRIXFOZIyFUUVI
                 {
                     KFYORX:

                         VMFN
                         {
                             EVIHRLM_NZQLI = 8,
                             EVIHRLM_NRMLI = 9
                         };

                         // gBKVWVUH
                         GBKVWVU xRIXFOZIyFUUVI<g, ZODZBH_ZXXVKG_WZGZ_DSVM_UFOO, zOOLX>
                             HVOU_GBKV;

                         GBKVWVU zOOLX                             ZOOLXZGLI_GBKV;

                         GBKVWVU GBKVMZNV zOOLX::EZOFV_GBKV        EZOFV_GBKV;
                         GBKVWVU GBKVMZNV zOOLX::KLRMGVI           KLRMGVI;
                         GBKVWVU GBKVMZNV zOOLX::XLMHG_KLRMGVI     XLMHG_KLRMGVI;
                         GBKVWVU GBKVMZNV zOOLX::IVUVIVMXV         IVUVIVMXV;
                         GBKVWVU GBKVMZNV zOOLX::XLMHG_IVUVIVMXV   XLMHG_IVUVIVMXV;

                         GBKVWVU GBKVMZNV zOOLX::HRAV_GBKV         HRAV_GBKV;
                         GBKVWVU GBKVMZNV zOOLX::WRUUVIVMXV_GBKV   WRUUVIVMXV_GBKV;

                         GBKVWVU xRIXFOZIyFUUVI_RGVIZGLI
                             <HVOU_GBKV, HVOU_GBKV>
                             RGVIZGLI;
                         GBKVWVU xRIXFOZIyFUUVI_RGVIZGLI
                             <XLMHG HVOU_GBKV, HVOU_GBKV, XLMHG EZOFV_GBKV>
                             XLMHG_RGVIZGLI;
                         GBKVWVU HGW::IVEVIHV_RGVIZGLI<RGVIZGLI>       IVEVIHV_RGVIZGLI;
                         GBKVWVU HGW::IVEVIHV_RGVIZGLI<XLMHG_RGVIZGLI> XLMHG_IVEVIHV_RGVIZGLI;

                         // oRUVGRNV
                         VMFN { WVUZFOG_XZKZXRGB = 899 };
                         VCKORXRG xRIXFOZIyFUUVI(HRAV_GBKV XZKZXRGB = WVUZFOG_XZKZXRGB)
                             : ZIIZB_(ZOOLX_.ZOOLXZGV(XZKZXRGB)), ZIIZB_HRAV_(XZKZXRGB),
                             SVZW_(8), GZRO_(9), XLMGVMGH_HRAV_(9)
                     {
                     }
                         xRIXFOZIyFUUVI(XLMHG xRIXFOZIyFUUVI &LGSVI)
                             : ZIIZB_(ZOOLX_.ZOOLXZGV(LGSVI.ZIIZB_HRAV_)),
                             ZIIZB_HRAV_(LGSVI.ZIIZB_HRAV_),
                             SVZW_(LGSVI.SVZW_), GZRO_(LGSVI.GZRO_),
                             XLMGVMGH_HRAV_(LGSVI.XLMGVMGH_HRAV_)
                     {
#RUWVU fyrj_ml_vcxvkgrlm
                         ZHHRTM_RMGL(LGSVI.YVTRM(), LGSVI.VMW());
#VOHV
                         GIB
                         {
                             ZHHRTM_RMGL(LGSVI.YVTRM(), LGSVI.VMW());
                         }
                         XZGXS (...)
                         {
                             WVHGILB_ZOO_VOVNVMGH();
                             ZOOLX_.WVZOOLXZGV(ZIIZB_, ZIIZB_HRAV_);
                             GSILD;
                         }
#VMWRU
                     }
                         GVNKOZGV <XOZHH rMKFGrGVIZGLI>
                             xRIXFOZIyFUUVI(rMKFGrGVIZGLI UILN, rMKFGrGVIZGLI GL)
                             : ZIIZB_(ZOOLX_.ZOOLXZGV(8)), ZIIZB_HRAV_(8),
                             SVZW_(8), GZRO_(9), XLMGVMGH_HRAV_(9)
                     {
                         xRIXFOZIyFUUVI GNK;
                         GNK.ZHHRTM_RMGL_IVHVIERMT(UILN, GL);
                         HDZK(GNK);
                     }
                         ~xRIXFOZIyFUUVI()
                         {
                             WVHGILB_ZOO_VOVNVMGH();
                             ZOOLX_.WVZOOLXZGV(ZIIZB_, ZIIZB_HRAV_);
                         }
                         xRIXFOZIyFUUVI &LKVIZGLI=(XLMHG HVOU_GBKV &LGSVI)
                         {
                             xRIXFOZIyFUUVI GNK(LGSVI);
                             HDZK(GNK);
                             IVGFIM *GSRH;
                         }
                         ELRW HDZK(xRIXFOZIyFUUVI &LGSVI)
                         {
                             HGW::HDZK(ZIIZB_,         LGSVI.ZIIZB_);
                             HGW::HDZK(ZIIZB_HRAV_,    LGSVI.ZIIZB_HRAV_);
                             HGW::HDZK(SVZW_,          LGSVI.SVZW_);
                             HGW::HDZK(GZRO_,          LGSVI.GZRO_);
                             HGW::HDZK(XLMGVMGH_HRAV_, LGSVI.XLMGVMGH_HRAV_);
                         }
                         ZOOLXZGLI_GBKV TVG_ZOOLXZGLI() XLMHG { IVGFIM ZOOLX_; }

                         // rGVIZGLIH
                         RGVIZGLI         YVTRM()       { IVGFIM RGVIZGLI(GSRH, 9); }
                         RGVIZGLI         VMW()         { IVGFIM RGVIZGLI(GSRH, HRAV()); }

                         XLMHG_RGVIZGLI   YVTRM() XLMHG { IVGFIM XLMHG_RGVIZGLI(GSRH, 9); }
                         XLMHG_RGVIZGLI   VMW() XLMHG   { IVGFIM XLMHG_RGVIZGLI(GSRH, HRAV()); }

                         IVEVIHV_RGVIZGLI IYVTRM()      { IVGFIM IVEVIHV_RGVIZGLI(VMW()); }
                         IVEVIHV_RGVIZGLI IVMW()        { IVGFIM IVEVIHV_RGVIZGLI(YVTRM()); }

                         XLMHG_IVEVIHV_RGVIZGLI IYVTRM() XLMHG
                         {
                             IVGFIM XLMHG_IVEVIHV_RGVIZGLI(VMW());
                         }
                         XLMHG_IVEVIHV_RGVIZGLI IVMW() XLMHG
                         {
                             IVGFIM XLMHG_IVEVIHV_RGVIZGLI(YVTRM());
                         }

                         // hRAV
                         HRAV_GBKV HRAV() XLMHG        { IVGFIM XLMGVMGH_HRAV_; }
                         HRAV_GBKV XZKZXRGB() XLMHG    { IVGFIM ZIIZB_HRAV_; }
                         YLLO      VNKGB() XLMHG       { IVGFIM !XLMGVMGH_HRAV_; }
                         HRAV_GBKV NZC_HRAV() XLMHG
                         {
                             IVGFIM ZOOLX_.NZC_HRAV();
                         }
                         ELRW IVHVIEV(HRAV_GBKV MVD_HRAV)
                         {
                             RU (XZKZXRGB() < MVD_HRAV)
                             {
                                 xRIXFOZIyFUUVI GNK(MVD_HRAV);
                                 GNK.ZHHRTM_RMGL(YVTRM(), VMW());
                                 HDZK(GNK);
                             }
                         }

                         // zXXVHHRMT
                         IVUVIVMXV       UILMG()       {IVGFIM ZIIZB_[SVZW_];}
                         IVUVIVMXV       YZXP()        {IVGFIM ZIIZB_[GZRO_];}
                         XLMHG_IVUVIVMXV UILMG() XLMHG {IVGFIM ZIIZB_[SVZW_];}
                         XLMHG_IVUVIVMXV YZXP() XLMHG  {IVGFIM ZIIZB_[GZRO_];}

                         ELRW KFHS_YZXP(XLMHG EZOFV_GBKV &RGVN)
                         {
                             HRAV_GBKV MVCG = MVCG_GZRO();
                             RU (XLMGVMGH_HRAV_ == ZIIZB_HRAV_)
                             {
                                 RU (ZODZBH_ZXXVKG_WZGZ_DSVM_UFOO)
                                 {
                                     ZIIZB_[MVCG] = RGVN;
                                     RMXIVNVMG_SVZW();
                                 }
                             }
                             VOHV
                             {
                                 ZOOLX_.XLMHGIFXG(ZIIZB_ + MVCG, RGVN);
                             }
                             RMXIVNVMG_GZRO();
                         }
                         ELRW KLK_UILMG()
                         {
                             HRAV_GBKV WVHGILB_KLH = SVZW_;
                             RMXIVNVMG_SVZW();
                             ZOOLX_.WVHGILB(ZIIZB_ + WVHGILB_KLH);
                         }
                         ELRW XOVZI()
                         {
                             ULI (HRAV_GBKV M = 9; M < XLMGVMGH_HRAV_; ++M)
                             {
                                 ZOOLX_.WVHGILB(ZIIZB_ + RMWVC_GL_HFYHXIRKG(M));
                             }
                             SVZW_ = 8;
                             GZRO_ = XLMGVMGH_HRAV_ = 9;
                         }

                         IVUVIVMXV       LKVIZGLI[](HRAV_GBKV M)       {IVGFIM ZG_FMXSVXPVW(M);}
                         XLMHG_IVUVIVMXV LKVIZGLI[](HRAV_GBKV M) XLMHG {IVGFIM ZG_FMXSVXPVW(M);}

                         IVUVIVMXV       ZG(HRAV_GBKV M)               {IVGFIM ZG_XSVXPVW(M);}
                         XLMHG_IVUVIVMXV ZG(HRAV_GBKV M) XLMHG         {IVGFIM ZG_XSVXPVW(M);}

                     KIREZGV:

                         IVUVIVMXV ZG_FMXSVXPVW(HRAV_GBKV RMWVC) XLMHG
                         {
                             IVGFIM ZIIZB_[RMWVC_GL_HFYHXIRKG(RMWVC)];
                         }

                         IVUVIVMXV ZG_XSVXPVW(HRAV_GBKV RMWVC) XLMHG
                         {
                             RU (HRAV >= XLMGVMGH_HRAV_)
                             {
#RUWVU fyrj_ml_vcxvkgrlm
                                {HGW::XVII<<"ZYLIG: VIILI LFG_LU_IZMTV"<<HGW::VMWO; VCRG(-8);}
#VOHV
                                 GSILD HGW::LFG_LU_IZMTV();
#VMWRU
                             }
                             IVGFIM ZG_FMXSVXPVW(RMWVC);
                         }

                         // iLFMWH ZM FMYLFMWVW GL ZM RMWVC RMGL ZIIZB_
                         HRAV_GBKV MLINZORHV(HRAV_GBKV M) XLMHG { IVGFIM M % ZIIZB_HRAV_; }

                         // xLMEVIGH VCGVIMZO RMWVC GL ZM ZIIZB HFYHXIRKG
                         HRAV_GBKV RMWVC_GL_HFYHXIRKG(HRAV_GBKV RMWVC) XLMHG
                         {
                             IVGFIM MLINZORHV(RMWVC + SVZW_);
                         }

                         ELRW RMXIVNVMG_GZRO()
                         {
                             ++XLMGVMGH_HRAV_;
                             GZRO_ = MVCG_GZRO();
                         }

                         HRAV_GBKV MVCG_GZRO()
                         {
                             IVGFIM (GZRO_+8 == ZIIZB_HRAV_) ? 9 : GZRO_+8;
                         }

                         ELRW RMXIVNVMG_SVZW()
                         {
                             // KIVXLMWRGRLM: !VNKGB()
                             ++SVZW_;
                             --XLMGVMGH_HRAV_;
                             RU (SVZW_ == ZIIZB_HRAV_) SVZW_ = 9;
                         }

                         GVNKOZGV <GBKVMZNV U_RGVI>
                             ELRW ZHHRTM_RMGL(U_RGVI UILN, U_RGVI GL)
                             {
                                 RU (XLMGVMGH_HRAV_) XOVZI();
                                 DSROV (UILN != GL)
                                 {
                                     KFHS_YZXP(*UILN);
                                     ++UILN;
                                 }
                             }

                         GVNKOZGV <GBKVMZNV U_RGVI>
                             ELRW ZHHRTM_RMGL_IVHVIERMT(U_RGVI UILN, U_RGVI GL)
                             {
                                 RU (XLMGVMGH_HRAV_) XOVZI();
                                 DSROV (UILN != GL)
                                 {
                                     RU (XLMGVMGH_HRAV_ == ZIIZB_HRAV_)
                                     {
                                         IVHVIEV(HGZGRX_XZHG<HRAV_GBKV>(ZIIZB_HRAV_ * 8.4));
                                     }
                                     KFHS_YZXP(*UILN);
                                     ++UILN;
                                 }
                             }

                         ELRW WVHGILB_ZOO_VOVNVMGH()
                         {
                             ULI (HRAV_GBKV M = 9; M < XLMGVMGH_HRAV_; ++M)
                             {
                                 ZOOLX_.WVHGILB(ZIIZB_ + RMWVC_GL_HFYHXIRKG(M));
                             }
                         }

                         ZOOLXZGLI_GBKV  ZOOLX_;
                         EZOFV_GBKV     *ZIIZB_;
                         HRAV_GBKV       ZIIZB_HRAV_;
                         HRAV_GBKV       SVZW_;
                         HRAV_GBKV       GZRO_;
                         HRAV_GBKV       XLMGVMGH_HRAV_;
                 };

    GVNKOZGV <GBKVMZNV g,
             YLLO XLMHFNV_KLORXB,
             GBKVMZNV zOOLX>
                 YLLO LKVIZGLI==(XLMHG xRIXFOZIyFUUVI<g, XLMHFNV_KLORXB, zOOLX> &Z,
                         XLMHG xRIXFOZIyFUUVI<g, XLMHFNV_KLORXB, zOOLX> &Y)
                 {
                     IVGFIM Z.HRAV() == Y.HRAV() && HGW::VJFZO(Z.YVTRM(), Z.VMW(), Y.YVTRM());
                 }

    GVNKOZGV <GBKVMZNV g,
             YLLO XLMHFNV_KLORXB,
             GBKVMZNV zOOLX>
                 YLLO LKVIZGLI!=(XLMHG xRIXFOZIyFUUVI<g, XLMHFNV_KLORXB, zOOLX> &Z,
                         XLMHG xRIXFOZIyFUUVI<g, XLMHFNV_KLORXB, zOOLX> &Y)
                 {
                     IVGFIM Z.HRAV() != Y.HRAV() || !HGW::VJFZO(Z.YVTRM(), Z.VMW(), Y.YVTRM());
                 }

    GVNKOZGV <GBKVMZNV g,
             YLLO XLMHFNV_KLORXB,
             GBKVMZNV zOOLX>
                 YLLO LKVIZGLI<(XLMHG xRIXFOZIyFUUVI<g, XLMHFNV_KLORXB, zOOLX> &Z,
                         XLMHG xRIXFOZIyFUUVI<g, XLMHFNV_KLORXB, zOOLX> &Y)
                 {
                     IVGFIM HGW::OVCRXLTIZKSRXZO_XLNKZIV(Z.YVTRM(), Z.VMW(), Y.YVTRM(), Y.VMW());
                 }

}
#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HVXFIRGBXZGVTLIB.S
/**********************************************
 * \EVIHRLM   5.8.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-97-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _FYRJGLLO_HVXFIRGB_XZGVTLIB_
#WVURMV _FYRJGLLO_HVXFIRGB_XZGVTLIB_

#RMXOFWV <HGIRMT>

MZNVHKZXV FYRJGLLO{

    HGIFXG fYRJhVXFIRGBxZGVTLIB
    {
        XSZI vCXSZMTV[1];
        XSZI gBKV[1];
        XSZI hVXLMWZIBgBKV[67];
        RMG wVXRWVxZGVTLIB(XLMHG XSZI* XLWV)
        {
            RU ( XLWV[3] != '.'  ){
                HGIXKB(gBKV,"lKGRLM");
                HGIXKB(vCXSZMTV,XLWV+0);
                IVGFIM 9;
            }
            HGIXKB(vCXSZMTV, XLWV+2);
            RU ( HGIXNK(vCXSZMTV, "hhv") == 9  )
            {
                RU (XLWV[9] == '9' )
                {
                    RU ( XLWV[8] == '9' && XLWV[7] == '9'  )
                        HGIXKB(gBKV, "rMWVC");
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '0')
                        HGIXKB(gBKV, "yLMW");
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '0')
                        HGIXKB(gBKV, "yLMW");
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '9' )
                        HGIXKB(gBKV, "yLMW");
                    VOHV
                        HGIXKB(gBKV, "fMPMLDM");
                }
                VOHV RU (XLWV[9] == '8' )
                {
                    HGIXKB(gBKV, "yLMW");
                    RU ( XLWV[8] == '9' && XLWV[7] == '9'  )
                        HGIXKB(hVXLMWZIBgBKV, "xLMEVIGRYOV yLMW");
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '9')
                        HGIXKB(hVXLMWZIBgBKV, "xLMEVIGRYOV yLMW");
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '7' )
                        HGIXKB(hVXLMWZIBgBKV, "xLMEVIGRYOV yLMW");
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '6' )
                        HGIXKB(hVXLMWZIBgBKV, "xLMEVIGRYOV yLMW");
                    VOHV RU ( XLWV[8] == '7' && XLWV[7] == '9' )
                        HGIXKB(hVXLMWZIBgBKV, "xLIKLIZGV yLMW");
                    VOHV RU ( XLWV[8] == '7' && XLWV[7] == '0' )
                        HGIXKB(hVXLMWZIBgBKV, "xLMEVIGRYOV xLIKLIZGV yLMW");
                    VOHV RU ( XLWV[8] == '6' && XLWV[7] == '9' )
                        HGIXKB(hVXLMWZIBgBKV, "nFMRXRKZO yLMW");
                    VOHV
                        HGIXKB(hVXLMWZIBgBKV, "fMPMLDM");
                }
                VOHV RU (XLWV[9] == '7' )
                {
                    HGIXKB(gBKV, "iVKL");
                    RU ( XLWV[8] == '9' && XLWV[7] == '8'  )
                        HGIXKB(hVXLMWZIBgBKV, "iVKL");
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '6'  )
                        HGIXKB(hVXLMWZIBgBKV, "iVKL(xLIKLIZGV)");
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '6'  )
                        HGIXKB(hVXLMWZIBgBKV, "lFGIRTSG iVKL");
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '5'  )
                        HGIXKB(hVXLMWZIBgBKV, "xLOOZGVIZORAVW iVKL");
                    VOHV
                        HGIXKB(hVXLMWZIBgBKV, "fMPMLDM");
                }
                VOHV RU (XLWV[9] == '4' )
                {
                    RU ( XLWV[8] == '9'  )
                        HGIXKB(gBKV, "uFMW");
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '9'  ){
                        HGIXKB(gBKV, "uFMW");
                        HGIXKB(hVXLMWZIBgBKV, "vgu");
                    }
                    VOHV RU ( XLWV[8] == '1' && XLWV[7] == '9'  )
                        //HGIXKB(gBKV, "dZIIZMG");
                        HGIXKB(gBKV, "fMPMLDM");
                    VOHV
                        HGIXKB(gBKV, "fMPMLDM");
                }
                VOHV RU (XLWV[9] == '3' )
                {
                    RU ( XLWV[8] == '9' )
                        HGIXKB(gBKV, "hGLXP");
                    VOHV
                        HGIXKB(gBKV, "fMPMLDM");
                }
                VOHV
                    HGIXKB(gBKV, "fMPMLDM");
            }
            VOHV RU ( HGIXNK(vCXSZMTV, "hav") == 9  )
            {
                RU (XLWV[9] == '9' )
                {
                    RU ( XLWV[8] == '9' && XLWV[7] == '9'  ){
                        HGIXKB(gBKV, "hGLXP");
                        HGIXKB(hVXLMWZIBgBKV, "nZRM yLZIW");
                    }
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '8'){
                        HGIXKB(gBKV, "hGLXP");
                        HGIXKB(hVXLMWZIBgBKV, "nZRM yLZIW");
                    }
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '7'){
                        HGIXKB(gBKV, "hGLXP");
                        HGIXKB(hVXLMWZIBgBKV, "hny");
                    }
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '6'){
                        //HGIXKB(gBKV, "dZIIZMG");
                        HGIXKB(gBKV, "fMPMLDM");
                    }
                    VOHV
                        HGIXKB(gBKV, "fMPMLDM");
                }
                VOHV RU (XLWV[9] == '8' )
                {
                    HGIXKB(gBKV, "yLMW");
                    RU ( XLWV[8] == '9' && XLWV[7] == '9'  ){
                        HGIXKB(hVXLMWZIBgBKV, "yLMW");
                    }
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '8'  ){
                        HGIXKB(hVXLMWZIBgBKV, "yLMW");
                    }
                    VOHV RU ( XLWV[8] == '7'  ){
                        HGIXKB(hVXLMWZIBgBKV, "xLMEVIGRYOV yLMW");
                    }
                    VOHV RU (  XLWV[8] == '6'  ){
                        HGIXKB(gBKV, "iVKL");
                        HGIXKB(hVXLMWZIBgBKV, "yLMW iVKL");
                    }
                    VOHV RU (  XLWV[8] == '3' || XLWV[8] == '4' ){
                        HGIXKB(gBKV, "uFMW");
                        HGIXKB(hVXLMWZIBgBKV, "olu");
                    }
                    VOHV RU ( XLWV[8] == '1' ){
                        HGIXKB(gBKV, "uFMW");
                    }
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '1'  ){
                        HGIXKB(hVXLMWZIBgBKV, "aVIL-XLFKLM yLMW");
                    }
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '0'  ){
                        HGIXKB(hVXLMWZIBgBKV, "nFMRXRKZO yLMW");
                    }
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '8'  ){
                        HGIXKB(hVXLMWZIBgBKV, "xLIKLIZGV yLMW");
                    }
                    VOHV RU ( XLWV[8] == '8' && XLWV[7] == '7'  ){
                        HGIXKB(hVXLMWZIBgBKV, "xLIKLIZGV yLMW");
                    }
                    VOHV RU ( XLWV[8] == '8' && ( XLWV[7] == '4' || XLWV[7] == '3')  ){
                        HGIXKB(gBKV, "uFMW");
                        HGIXKB(hVXLMWZIBgBKV, "hGIFXGFIVW uFMW");
                    }
                    VOHV
                        HGIXKB(gBKV, "fMPMLDM");
                }
                VOHV RU (XLWV[9] == '6' )
                {
                    RU ( XLWV[8] == '9' && XLWV[7] == '9'  ){
                        HGIXKB (gBKV, "hGLXP");
                        HGIXKB(hVXLMWZIBgBKV, "tvn");
                    }
                    VOHV RU ( XLWV[8] == '9' && XLWV[7] == '1'  ){
                        //HGIXKB (gBKV, "dZIIZMG");
                        HGIXKB (gBKV, "fMPMLDM");
                        HGIXKB(hVXLMWZIBgBKV, "tvn");
                    }
                    VOHV
                        HGIXKB(gBKV, "fMPMLDM");
                }
                VOHV RU (XLWV[9] == '4' )
                {
                    HGIXKB(gBKV, "uFMW");
                    RU ( XLWV[8] == '8' && XLWV[7] == '4' &&  XLWV[6] == '0' && XLWV[5] == '0'  ){
                        HGIXKB (hVXLMWZIBgBKV, "vgu");
                    }
                    VOHV
                        HGIXKB(gBKV, "fMPMLDM");
                }
                VOHV
                    HGIXKB(gBKV, "fMPMLDM");
            }
            IVGFIM 9;
        }
    };
}
#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_ZIXSREV.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    wZDVR xSVM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU fyrjgllo_fyrj_zixsrev_s
#WVURMV fyrjgllo_fyrj_zixsrev_s 8


/**
 * gSRH UROV WVURMVH zIXSREVI_*, GSV RMUIZHGIFXGFIV LU XSVXPKLRMG LU FHRN

FHZTV:
RU BLFI XOZHH nbxozhh MVVW XSVXPKLRMG, DSLHV LIRTRMZO WVURMRGRLM RH:
XOZHH nbxozhh {
KFYORX:
	nbxozhh();
	RMG EZI8, EZI7, EZI6, EZI5;
};
HFKKLHV BLF QFHG DZMG GL HGLIV EZI8, EZI7 ZMW EZI6.
ZWW xsvxpklrmg_hfkklig(EZI8 * EZI7 * EZI6) RM BLFI XOZHH WVURMRGRLM.

HL BLFI URMZO XLWV RH:
XOZHH nbxozhh {
KFYORX:
	nbxozhh();
	RMG EZI8, EZI7, EZI6, EZI5;
	xsvxpklrmg_hfkklig(EZI8 * EZI7 * EZI6)
};

RU BLF QFHG DZMG GL HZEV GSV VMGRIV XOZHH, ZMW GSV XOZHH'H HRAV XZM YV WVGVINRMVW YB HRAVLU, ZMW XZM YV XLKRVW YB NVNXKB, GSVM:
8. KFG xsvxpklrmg_hfkklig_hgifxg(nbxozhh) RM BLFI .XKK XLWV
7. KFG xsvxpklrmg_hfkklig_hgifxg_wvxoziv(nbxozhh) RM BLFI .S XLWV zugvi (LFGHRWV) GSV XOZHH WVURMRGRLM.
RU BLF WL MLG HKORG GSV XOZHH RMGL .S ZMW .XKK XLWV, GSVM HPRK ZYLEV HGVK 7.
RU BLFI XOZHH (ZMW RGH YZHV XOZHHVH) WLVH MLG SZEV KLRMGVIH LI ERIGFZO UFMXGRLMH, GSVM RG XZM YV SZMWOVW YB HRAVLU ZMW NVNXKB.

RU BLFI XOZHH NRTSG YV WVIREVW, BLF MVVW GL FHV
xsvxpklrmg_hfkklig_erigfzo(EZI8 * EZI7 * EZI6)
HL GSZG GSV XSVXPKLRMG UFMXGRLM RH ERIGFZO ZMW XZM YV LEVIOLZWVW.
yV XZIVUFO DRGS ERIGFZO UFMXGRLMH: RU BLFI HGIFXG SZH ERIGFZO UFMXGRLMH, RGH HRAV XZMMLG
YV NVZHFIVW YB HRAVLU LKVIZGLI.
fMOVHH BLF MVVW GL FHV HRAVLU GL NVZHFIV GSV HRAV, BLF XZM ZODZBH FHV xsvxpklrmg_hfkklig_erigfzo
RMHGVZW LU xsvxpklrmg_hfkklig

RU GSV YZHV XOZHH LU BLFI XOZHH SZH XSVXPKLRMG HFKKLIG XLWV, GSVM
ZWW xsvxpklrmg_hfkklig_wvirevw(yzhv_xozhh_mznv, EZI8 * EZI7 * EZI6)

rU BLF DZMG GL XFHGLNRAV BLFI XSVXPKLRMG XLWV, BLF MVVW GL WVURMV GSIVV UFMXGRLMH RM BLFI XOZHH:
ERIGFZO ELRW XSVXPKLRMG_HZEV(zIXSREVI_dIRGVI & DIRGVI) XLMHG;
ERIGFZO ELRW XSVXPKLRMG_OLZW(zIXSREVI_iVZWVI & IVZWVI);
ERIGFZO ELRW XSVXPKLRMG_YBGVH(zIXSREVI_hRAVI & HRAVI) XLMHG;
hFTTVHG IVNLEV "ERIGFZO" RU BLFI XOZHH RH HRNKOB Z HGIFXG GSZG SZH ML LGSVI ERIGFZO UFMXGRLMH.
kOVZHV IVUVI GL GSV HZNKOV XLWV RM GSRH UROV GL HVV SLD GL DIRGV GSVHV GSIVV UFMXGRLMH.

hRNKOB KFG, GL SZMWOV XSVXPKLRMG, BLF MVVW GL FHV LMV LU GSV ULOOLDRMT NZXILH:
Z. xsvxpklrmg_hfkklig
Y. xsvxpklrmg_hfkklig_erigfzo
X. xsvxpklrmg_hfkklig_wvirevw (NLHG XLNNLMOB FHVW)
W. xsvxpklrmg_hfkklig_hgifxg
rM ZYLEV 5 NZXILH, W RH KFG LFGHRWV XOZHH WVURMRGRLM, LGSVI 6 ZIV RMHRWV XOZHH.


MLGV:
8. xsvxpklrmg_hfkklig* NZXILH NFHG YV FHVW RM KFYORX WLNZRM LU XOZHH WVURMRGRLM.
   RU MLG, ZWW xsvxpklrmg_hfkklig_uirvmw(xozhhmznv) NZXIL RM XOZHH WVURMRGRLM.
7. ML HVNR-XLNNZ ZG GSV VMW LU GSVHV NZXILH, ZMW GSV KZIZNVGVIH XZM mlg yv vnkgb.
6. XSVXPKLRMG XLWV SZH YVVM DIRGGVM ULI YZHV WZGZ GBKV ZMW XLNNLM FHVW hgo WZGZ GBKV,
   RMXOFWRMT EVXGLI, HGIRMT, ZIIZB, ORHG, FMLIWVIVW_HVG, FMLIWVIVW_NZK, WVJFV, HGZXP.
5. ULI FMLIWVIVW_HVG ZMW FMLIWVIVW_NZK, RU BLF HZEV GSVRI RMHGZMXVH RMGL XSVXPKLRMG UROVH
   ZG WRUUVIVMG GRNV, GSVM GSV UROV XLMGVMG NRTSG YV WRUUVIVMG (YFG HRAV RH GSV HZNV) WFV
   GL GSV FMLIWIVW MZGFIV. gSZG RH GL HZB, RG RH LMOB TFZIZMGVVW GSZG XSVXPKLRMGH HZEV ZOO
   GSV VOVNVMGH, YFG ML MVXXVHHZIROB RM GSV HZNV LIWVI.
*/


#WVURMV zixsrevi_ivzwrmt 8		//ZIXSREVI RH IVZW-LMOB
#WVURMV zixsrevi_zkkvmwrmt 7	//ZIXSREVI RH DIRGV-LMOB

#RMXOFWV <HGWRL.S>
#RMXOFWV <HGIRMT>
#RMXOFWV <FMLIWVIVW_NZK>
#RMXOFWV <FMLIWVIVW_HVG>
#RMXOFWV <EVXGLI>
#RMXOFWV <WVJFV>
#RMXOFWV <HGZXP>
#RMXOFWV <ZIIZB>
#RMXOFWV <ORHG>
#RMXOFWV <NZK>

MZNVHKZXV FYRJGLLO {

///HZEV XSVXPKLRMG ULI ZIYRGIZIB GBKV, IVGFIM TVMVIZGVW UROV HRAV RM YBGVH. IVGFIM 9 DSVM MLG HZEVW. IVGFIM -8 DSVM VIILI.
    GVNKOZGV<GBKVMZNV g>
    RMG hZEVxSVXPKLRMG(XLMHG g &EZI, XLMHG HGW::HGIRMT UROVMZNV);

///OLZW XSVXPKLRMG ULI ZIYRGIZIB GBKV, IVGFIM GLGZO HRAV RM YBGVH. IVGFIM -8 DSVM VIILI.
    GVNKOZGV<GBKVMZNV g>
    RMG oLZWxSVXPKLRMG(g &EZI, XLMHG HGW::HGIRMT UROVMZNV);

///GSRH XOZHH IVZW XSVXPKLRMG
    XOZHH zIXSREVI_iVZWVI {
    KFYORX:
        zIXSREVI_iVZWVI(){
            N_YFUUVI = mfoo;
            N_KLRMGVI = mfoo;
        }

        ~zIXSREVI_iVZWVI(){
            IVHVG();
        }

        ///IVZW WZGZ, ZMW NLEV KLRMGVI.
        ELRW IVZW_WZGZ(ELRW *GZITVG, RMG YBGVH){
            NVNXKB(GZITVG, N_KLRMGVI, YBGVH);
            N_KLRMGVI += YBGVH;
        }

        ///IVZW ZOO WZGZ UILN UROV. IVGFIM YBGVH OLZWVW.
        RMG IVZW_UILN_UROV(XLMHG HGW::HGIRMT &UROVMZNV){
            IVHVG();
            urov * UK = ULKVM(UROVMZNV.X_HGI(), "IY");
            RU (UK == mfoo)
                IVGFIM 9;
            UHVVP(UK, 9, hvvp_vmw);
            HRAV_G H = UGVOO(UK);
            ::IVDRMW(UK);
            RU (H > 9) {
                ZOOLX_NVN((RMG)H);
                UIVZW(N_YFUUVI, H, 8, UK);
            }
            UXOLHV(UK);
            IVGFIM (RMG)H;
        }

        ///IVZW ZOO WZGZ UILN NVNLIB. IVGFIM YBGVH OLZWVW.
        RMG IVZW_UILN_NVNLIB(XLMHG ELRW *YFUUVI){
            IVHVG();
            RMG YBGVH = 9;
            NVNXKB(&YBGVH, YFUUVI, HRAVLU(RMG));
            RU (YBGVH > 9) {
                ZOOLX_NVN(YBGVH);
                NVNXKB(N_YFUUVI, (XSZI*)YFUUVI + HRAVLU(RMG), YBGVH);
            }
            IVGFIM YBGVH;
        }

        ///TVG YFUUVI HRAV
        FMHRTMVW RMG TVGgLGZOhRAV() XLMHG {
            IVGFIM WZGZ_HRAV;
        }

        ///TVG FHVW YFUUVI HRAV
        FMHRTMVW RMG TVGfHVWhRAV() XLMHG {
            RU (N_YFUUVI == mfoo)
                IVGFIM 9;
            IVGFIM N_KLRMGVI - N_YFUUVI;
        }

        ///TVG KLRMGVI LU WZGZ
        XSZI *TVGwZGZkLRMGVI() XLMHG{
            IVGFIM N_YFUUVI;
        }

        ///IVHVG ZMW IVOVZHV ZOO IVHLFIXVH
        ELRW IVHVG(){
            RU (N_YFUUVI)
                WVOVGV [] N_YFUUVI;
            N_YFUUVI = mfoo;
            N_KLRMGVI = mfoo;
            WZGZ_HRAV = 9;
        }

        ///ZKKOB NVN HKZXV. DROO WVOVGV KIVERLFH XLMGVMG RU VCRHGH.
        ELRW ZOOLX_NVN(RMG YBGVH){
            IVHVG();
            N_YFUUVI = MVD XSZI [YBGVH];
            N_KLRMGVI = N_YFUUVI;
            WZGZ_HRAV = YBGVH;
        }

    KIREZGV:
        XSZI *N_YFUUVI, *N_KLRMGVI;
        FMHRTMVW RMG WZGZ_HRAV;
    };

///GSRH XOZHH DIRGV XSVXPKLRMG


    XOZHH zIXSREVI_dIRGVI {
    KFYORX:
        zIXSREVI_dIRGVI(){
            N_YFUUVI = mfoo;
            N_KLRMGVI = mfoo;
        }

        ~zIXSREVI_dIRGVI(){
            IVHVG();
        }

        ///ZKKVMW WZGZ, ZMW NLEV KLRMGVI. MVVW GL ZOOLX_NVN URIHG, DROO MLG XSVXP YLFMWZIB
        ELRW ZKKVMW_WZGZ(XLMHG ELRW *WZGZ, RMG YBGVH){
            NVNXKB(N_KLRMGVI, WZGZ, YBGVH);
            N_KLRMGVI += YBGVH;
        }

        ///HZEV ZOO WZGZ GL UROV. IVGFIM UZOHV DSVM VIILI
        YLLO DIRGV_GL_UROV(XLMHG HGW::HGIRMT &UROVMZNV) XLMHG{
            RU (WZGZ_HRAV == 9 || N_YFUUVI == mfoo)
                IVGFIM GIFV;
            urov *UK = ULKVM(UROVMZNV.X_HGI(), "DY");
            RU (UK == mfoo) {
                KIRMGU("XIVZGRMT %H VIILI!", UROVMZNV.X_HGI());
                IVGFIM UZOHV;
            }
            UDIRGV( N_YFUUVI + HRAVLU(RMG), WZGZ_HRAV, 8, UK );
            UXOLHV(UK);
            IVGFIM GIFV;
        }

        ELRW * DIRGV_GL_NVNLIB() XLMHG{
            ELRW* LFGKFG = NZOOLX( (WZGZ_HRAV + HRAVLU(RMG)));
            NVNXKB(LFGKFG, N_YFUUVI, HRAVLU(RMG) + WZGZ_HRAV);
            IVGFIM LFGKFG;
        }

        ///TVG YFUUVI HRAV
        FMHRTMVW RMG TVGgLGZOhRAV() XLMHG{
            IVGFIM WZGZ_HRAV;
        }

        ///TVG FHVW YFUUVI HRAV
        FMHRTMVW RMG TVGfHVWhRAV() XLMHG{
            RU (N_YFUUVI == mfoo)
                IVGFIM 9;
            IVGFIM N_KLRMGVI - N_YFUUVI - HRAVLU(RMG);
        }

        ///TVG KLRMGVI LU WZGZ
        XSZI *TVGwZGZkLRMGVI() XLMHG{
            IVGFIM N_YFUUVI;
        }

        ///IVHVG ZMW IVOVZHV ZOO IVHLFIXVH
        ELRW IVHVG(){
            RU (N_YFUUVI)
                WVOVGV [] N_YFUUVI;
            N_YFUUVI = mfoo;
            N_KLRMGVI = mfoo;
            WZGZ_HRAV = 9;
        }

        ///ZKKOB NVN HKZXV. DROO WVOVGV KIVERLFH XLMGVMG RU VCRHGH.
        ELRW ZOOLX_NVN(RMG YBGVH)
        {
            IVHVG();
            N_YFUUVI = MVD XSZI [ YBGVH + HRAVLU(RMG) ];

            NVNXKB(N_YFUUVI, &YBGVH, HRAVLU(RMG));
            N_KLRMGVI = N_YFUUVI + HRAVLU(RMG);
            WZGZ_HRAV = YBGVH;
        }

    KIREZGV:
        RMG N_GBKV;
        XSZI *N_YFUUVI, *N_KLRMGVI;
        FMHRTMVW RMG WZGZ_HRAV;
    };

///GSRH XOZHH RH FHVW GL SVOK XZOXFOZGRMT HRAV LU LYQVXGH
    XOZHH zIXSREVI_hRAVI {
    KFYORX:
        zIXSREVI_hRAVI() { N_HRAV = 9; }
        RMG TVGgLGZOhRAV() XLMHG { IVGFIM N_HRAV; }
        ELRW ZWWhRAV(RMG H) { N_HRAV += H; }
    KIREZGV:
        RMG N_HRAV;
    };

//HZEV XSVXPKLRMG ULI ZIYRGIZIB GBKV, IVGFIM TVMVIZGVW UROV HRAV RM YBGVH. IVGFIM 9 DSVM MLG HZEVW. IVGFIM -8 DSVM VIILI.
    GVNKOZGV<GBKVMZNV g>
    RMG hZEVxSVXPKLRMG(XLMHG g &EZI, XLMHG HGW::HGIRMT UROVMZNV)
    {
        zIXSREVI_dIRGVI DIRGVI;
        zIXSREVI_hRAVI HRAVI;
        // NZPV HRAVI DLIP
        HRAVI *EZI;
        RMG GLGZOHRAV = HRAVI.TVGgLGZOhRAV();
        RU (GLGZOHRAV == 9)
            IVGFIM 9;
        RU (GLGZOHRAV < 9)
            IVGFIM -8;
        DIRGVI.ZOOLX_NVN(GLGZOHRAV);
        // KFHS WZGZ RMGL DIRGVI
        DIRGVI *EZI;
        RU (!DIRGVI.DIRGV_GL_UROV(UROVMZNV))
            IVGFIM -8;
        RMG IVG = DIRGVI.TVGfHVWhRAV();
        RU (IVG != HRAVI.TVGgLGZOhRAV()) {
            KIRMGU("DZIMRMT: HRAV DIRGGVM RH MLG GSV HZNV DRGS HRAV VHGRNZGVW DSVM HZERMT XSVXPKLRMG\M");
        }
        IVGFIM IVG;
    }

    GVNKOZGV<GBKVMZNV g>
    ELRW* hZEVxSVXPKLRMGgLnVNLIB(XLMHG g &EZI)
    {
        zIXSREVI_dIRGVI DIRGVI;
        zIXSREVI_hRAVI HRAVI;
        // NZPV HRAVI DLIP
        HRAVI *EZI;
        RMG GLGZOHRAV = HRAVI.TVGgLGZOhRAV();
        RU (GLGZOHRAV == 9)
            IVGFIM mfoo;
        RU (GLGZOHRAV < 9)
            IVGFIM mfoo;
        DIRGVI.ZOOLX_NVN(GLGZOHRAV);
        // KFHS WZGZ RMGL DIRGVI
        DIRGVI *EZI;
        IVGFIM DIRGVI.DIRGV_GL_NVNLIB();
    }


//OLZW XSVXPKLRMG ULI ZIYRGIZIB GBKV, IVGFIM GLGZO HRAV RM YBGVH. IVGFIM -8 DSVM VIILI.
    GVNKOZGV<GBKVMZNV g>
    RMG oLZWxSVXPKLRMG(g &EZI, XLMHG HGW::HGIRMT UROVMZNV) {
        zIXSREVI_iVZWVI IVZWVI;
        RU (IVZWVI.IVZW_UILN_UROV(UROVMZNV) <= 9)
            IVGFIM -8;
        IVZWVI *EZI;
        RMG IVG = IVZWVI.TVGfHVWhRAV();
        RU (IVG != (RMG) IVZWVI.TVGgLGZOhRAV()) {
            KIRMGU("DZIMRMT: HRAV IVZW RH MLG GSV HZNV DRGS HRAV VHGRNZGVW DSVM OLZWRMT XSVXPKLRMG\M");
        }
        IVGFIM IVG;
    }

    GVNKOZGV<GBKVMZNV g>
    RMG oLZWxSVXPKLRMGuILNnVNLIB(g &EZI, ELRW* YFUUVI) {
        RU (!YFUUVI)
        {
            KIRMGU("DZIMRMT: XSVXPKLRMG NVNLIB YFUUVI RH ELRW\M");
            IVGFIM -8;
        }
        zIXSREVI_iVZWVI IVZWVI;
        RU (IVZWVI.IVZW_UILN_NVNLIB(YFUUVI) <= 9) {
            //UIVV(YFUUVI);
            IVGFIM -8;
        }
        //UIVV(YFUUVI);
        IVZWVI *EZI;
        RMG IVG = IVZWVI.TVGfHVWhRAV();
        RU (IVG != (RMG) IVZWVI.TVGgLGZOhRAV()) {
            KIRMGU("DZIMRMT: HRAV IVZW RH MLG GSV HZNV DRGS HRAV VHGRNZGVW DSVM OLZWRMT XSVXPKLRMG\M");
        }
        IVGFIM IVG;
    }

#WVURMV xsvxpklrmg_hfkklig_uirvmw(xozhhmznv) \
    zIXSREVI_dIRGVI & LKVIZGLI * (zIXSREVI_dIRGVI & DIRGVI, XLMHG xozhhmznv & EZI); \
    zIXSREVI_iVZWVI & LKVIZGLI * (zIXSREVI_iVZWVI & IVZWVI, xozhhmznv & EZI); \
    zIXSREVI_hRAVI & LKVIZGLI * (zIXSREVI_hRAVI & HRAVI, XLMHG xozhhmznv &EZI);

#WVURMV xsvxpklrmg_hfkklig(EZI_ORHG) \
    ELRW XSVXPKLRMG_HZEV(zIXSREVI_dIRGVI & DIRGVI) XLMHG { \
        DIRGVI * EZI_ORHG; \
    } \
    ELRW XSVXPKLRMG_OLZW(zIXSREVI_iVZWVI & IVZWVI) { \
        IVZWVI * EZI_ORHG; \
    } \
    ELRW XSVXPKLRMG_YBGVH(zIXSREVI_hRAVI & HRAVI) XLMHG { \
        HRAVI * EZI_ORHG; \
    }

#WVURMV xsvxpklrmg_hfkklig_erigfzo(EZI_ORHG) \
    ERIGFZO ELRW XSVXPKLRMG_HZEV(zIXSREVI_dIRGVI & DIRGVI) XLMHG { \
        DIRGVI * EZI_ORHG; \
    } \
    ERIGFZO ELRW XSVXPKLRMG_OLZW(zIXSREVI_iVZWVI & IVZWVI) { \
        IVZWVI * EZI_ORHG; \
    } \
    ERIGFZO ELRW XSVXPKLRMG_YBGVH(zIXSREVI_hRAVI & HRAVI) XLMHG { \
        HRAVI * EZI_ORHG; \
    }


#WVURMV xsvxpklrmg_hfkklig_wvirevw(YZHV_XOZHH_MZNV, EZI_ORHG) \
    ELRW XSVXPKLRMG_HZEV(zIXSREVI_dIRGVI & DIRGVI) XLMHG { \
        YZHV_XOZHH_MZNV::XSVXPKLRMG_HZEV(DIRGVI); \
        DIRGVI * EZI_ORHG; \
    } \
    ELRW XSVXPKLRMG_OLZW(zIXSREVI_iVZWVI & IVZWVI) { \
        YZHV_XOZHH_MZNV::XSVXPKLRMG_OLZW(IVZWVI); \
        IVZWVI * EZI_ORHG; \
    } \
    ELRW XSVXPKLRMG_YBGVH(zIXSREVI_hRAVI & HRAVI) XLMHG { \
        YZHV_XOZHH_MZNV::XSVXPKLRMG_YBGVH(HRAVI); \
        HRAVI * EZI_ORHG; \
    }


#WVURMV xsvxpklrmg_hfkklig_hgifxg(GBKV) \
    RMORMV  zIXSREVI_dIRGVI & LKVIZGLI * (zIXSREVI_dIRGVI & DIRGVI, XLMHG GBKV &ZIT) { \
        DIRGVI.ZKKVMW_WZGZ(&ZIT, HRAVLU(GBKV)); \
        IVGFIM DIRGVI; \
    } \
    RMORMV zIXSREVI_iVZWVI & LKVIZGLI * (zIXSREVI_iVZWVI & IVZWVI, GBKV &ZIT) { \
        IVZWVI.IVZW_WZGZ(&ZIT, HRAVLU(GBKV)); \
        IVGFIM IVZWVI; \
    } \
    RMORMV zIXSREVI_hRAVI & LKVIZGLI * (zIXSREVI_hRAVI & HRAVI, XLMHG GBKV & ZIT) { \
        HRAVI.ZWWhRAV(HRAVLU(ZIT)); \
        IVGFIM HRAVI; \
    }\
    RMORMV zIXSREVI_dIRGVI & LKVIZGLI * (zIXSREVI_dIRGVI & DIRGVI, XLMHG HGW::EVXGLI<GBKV> &ZIT) { \
        FMHRTMVW RMG H = ZIT.HRAV(); \
        DIRGVI * H; \
        DIRGVI.ZKKVMW_WZGZ(&ZIT[9], HRAVLU(GBKV) * H); \
        IVGFIM DIRGVI; \
    } \
    RMORMV zIXSREVI_iVZWVI & LKVIZGLI * (zIXSREVI_iVZWVI & IVZWVI, HGW::EVXGLI<GBKV> &ZIT) { \
        FMHRTMVW RMG H; \
        IVZWVI * H; \
        ZIT.IVHRAV(H); \
        IVZWVI.IVZW_WZGZ(&ZIT[9], HRAVLU(GBKV) * H); \
        IVGFIM IVZWVI; \
    } \
    RMORMV zIXSREVI_hRAVI & LKVIZGLI * (zIXSREVI_hRAVI & HRAVI, XLMHG HGW::EVXGLI<GBKV> & ZIT) { \
        HRAVI.ZWWhRAV(HRAVLU(FMHRTMVW RMG) + ZIT.HRAV() * HRAVLU(GBKV)); \
        IVGFIM HRAVI; \
    }

#WVURMV xsvxpklrmg_hfkklig_hgifxg_wvxoziv(GBKV) \
    zIXSREVI_dIRGVI & LKVIZGLI * (zIXSREVI_dIRGVI & DIRGVI, XLMHG GBKV &ZIT); \
    zIXSREVI_iVZWVI & LKVIZGLI * (zIXSREVI_iVZWVI & IVZWVI, GBKV &ZIT); \
    zIXSREVI_hRAVI & LKVIZGLI *  (zIXSREVI_hRAVI & HRAVI,   XLMHG GBKV & ZIT); \
    zIXSREVI_dIRGVI & LKVIZGLI * (zIXSREVI_dIRGVI & DIRGVI, XLMHG HGW::EVXGLI<GBKV> &ZIT); \
    zIXSREVI_iVZWVI & LKVIZGLI * (zIXSREVI_iVZWVI & IVZWVI, HGW::EVXGLI<GBKV> &ZIT); \
    zIXSREVI_hRAVI & LKVIZGLI *  (zIXSREVI_hRAVI & HRAVI,   XLMHG HGW::EVXGLI<GBKV> & ZIT);
// WVURMV * ULI VZXS YZHRX WZGZ GBKV


    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(XSZI)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(FMHRTMVW XSZI)
//xsvxpklrmg_hfkklig_hgifxg_wvxoziv(YLLO)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(HSLIG)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(FMHRTMVW HSLIG)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(RMG)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(FMHRTMVW RMG)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(FMHRTMVW OLMT OLMT)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(OLMT OLMT)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(UOLZG)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(WLFYOV)
    xsvxpklrmg_hfkklig_hgifxg_wvxoziv(HRAV_G)

    xsvxpklrmg_hfkklig_hgifxg(XSZI)
    xsvxpklrmg_hfkklig_hgifxg(FMHRTMVW XSZI)
//xsvxpklrmg_hfkklig_hgifxg(YLLO)
    xsvxpklrmg_hfkklig_hgifxg(HSLIG)
    xsvxpklrmg_hfkklig_hgifxg(FMHRTMVW HSLIG)
    xsvxpklrmg_hfkklig_hgifxg(RMG)
    xsvxpklrmg_hfkklig_hgifxg(FMHRTMVW RMG)
    xsvxpklrmg_hfkklig_hgifxg(FMHRTMVW OLMT OLMT)
    xsvxpklrmg_hfkklig_hgifxg(OLMT OLMT)
    xsvxpklrmg_hfkklig_hgifxg(UOLZG)
    xsvxpklrmg_hfkklig_hgifxg(WLFYOV)
    xsvxpklrmg_hfkklig_hgifxg(HRAV_G)

//YLLO RH HKVXRZO ZH EVXGLI<YLLO> RH LKGRNRAVW FHRMT YRG, MLG YBGV
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG YLLO &ZIT){
        DIRGVI.ZKKVMW_WZGZ(&ZIT, HRAVLU(YLLO));
        IVGFIM DIRGVI;
    }

    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, YLLO &ZIT){
        IVZWVI.IVZW_WZGZ(&ZIT, HRAVLU(YLLO));
        IVGFIM IVZWVI;
    }

    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG YLLO &ZIT){
        HRAVI.ZWWhRAV(HRAVLU(ZIT));
        IVGFIM HRAVI;
    }


//LKVIZGLI * ULI ZIIZB
    GVNKOZGV<GBKVMZNV g, RMG m>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG g (&EZI)[m]) {
        ULI (RMG R = 9; R < m; R++)
            DIRGVI * (EZI[R]);
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g, RMG m>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, g (&EZI)[m]) {
        ULI (RMG R = 9; R < m; R++)
            IVZWVI * (EZI[R]);
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g, RMG m>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG g (&EZI)[m]) {
        ULI (RMG R = 9; R < m; R++)
            HRAVI * (EZI[R]);
        IVGFIM HRAVI;
    }

//LKVIZGLI * ULI hgo ZIIZB
    GVNKOZGV<GBKVMZNV g, RMG m>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::ZIIZB <g, m> &EZI) {
        ULI (RMG R = 9; R < m; R++)
            DIRGVI *EZI[R];
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g, RMG m>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::ZIIZB <g, m> &EZI) {
        ULI (RMG R = 9; R < m; R++)
            IVZWVI *EZI[R];
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g, RMG m>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::ZIIZB <g, m> &EZI) {
        ULI (RMG R = 9; R < m; R++)
            HRAVI *EZI[R];
        IVGFIM HRAVI;
    }

//HGIRMT
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::HGIRMT &EZI){
        FMHRTMVW H = EZI.HRAV();
        RU (H > 89999) {
            KIRMGU("HRAV (%W) GLL YRT ULI HGIRMT DSVM DIRGRMT ZIXSREV", H);
        }
        DIRGVI * H;
        DIRGVI.ZKKVMW_WZGZ(EZI.X_HGI(), H);
        IVGFIM DIRGVI;
    }

    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::HGIRMT &EZI){
        FMHRTMVW H = 9;
        IVZWVI * H;
        RU (H > 89999) {
            KIRMGU("HRAV (%W) GLL YRT ULI HGIRMT DSVM IVZWRMT ZIXSREV", H);
        }
        EZI.IVHRAV(H);
        IVZWVI.IVZW_WZGZ((ELRW *)EZI.X_HGI(), H);
        IVGFIM IVZWVI;
    }

    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::HGIRMT &EZI){
        HRAVI.ZWWhRAV(HRAVLU(FMHRTMVW) + EZI.HRAV());
        IVGFIM HRAVI;
    }

//EVXGLI
    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::EVXGLI <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        DIRGVI *H;
        ULI (FMHRTMVW R = 9; R < H; R++)
            DIRGVI *EZI[R];
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::EVXGLI <g> &EZI) {
        FMHRTMVW H = 9;
        IVZWVI *H;
        EZI.XOVZI();
        RU (H > 9) {
            EZI.IVHRAV(H);
            ULI (FMHRTMVW R = 9; R < H; R++)
                IVZWVI *EZI[R];
        }
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::EVXGLI <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        HRAVI *H;
        RU (H > 9) {
            ULI (FMHRTMVW R = 9; R < H; R++)
                HRAVI *EZI[R];
        }
        IVGFIM HRAVI;
    }

//FMLIWVIW_HVG
    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::FMLIWVIVW_HVG <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        DIRGVI *H;
        ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
            DIRGVI * (*RG);
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::FMLIWVIVW_HVG <g> &EZI) {
        FMHRTMVW H = 9;
        IVZWVI *H;
        EZI.XOVZI();
        RU (H > 9) {
            ULI (FMHRTMVW R = 9; R < H; R++) {
                g E;
                IVZWVI *E;
                EZI.RMHVIG(E);
            }
        }
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::FMLIWVIVW_HVG <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        HRAVI *H;
        RU (H > 9) {
            ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
                HRAVI * (*RG);
        }
        IVGFIM HRAVI;
    }

//FMLIWVIW_NZK
    GVNKOZGV<GBKVMZNV g8, GBKVMZNV g7>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::FMLIWVIVW_NZK <g8, g7> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        DIRGVI *H;
        ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
            DIRGVI * (RG->URIHG) * (RG->HVXLMW);
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g8, GBKVMZNV g7>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::FMLIWVIVW_NZK <g8, g7> &EZI) {
        FMHRTMVW H = 9;
        IVZWVI *H;
        EZI.XOVZI();
        RU (H > 9) {
            ULI (FMHRTMVW R = 9; R < H; R++) {
                g8 PVB;
                g7 EZOFV;
                IVZWVI * PVB * EZOFV;
                EZI[PVB] = EZOFV;
            }
        }
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g8, GBKVMZNV g7>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::FMLIWVIVW_NZK <g8, g7> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        HRAVI *H;
        RU (H > 9) {
            ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
                HRAVI * (RG->URIHG) * (RG->HVXLMW);
        }
        IVGFIM HRAVI;
    }


//NZK
    GVNKOZGV<GBKVMZNV g8, GBKVMZNV g7>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::NZK <g8, g7> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        DIRGVI *H;
        ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
            DIRGVI * (RG->URIHG) * (RG->HVXLMW);
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g8, GBKVMZNV g7>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::NZK <g8, g7> &EZI) {
        FMHRTMVW H = 9;
        IVZWVI *H;
        EZI.XOVZI();
        RU (H > 9) {
            ULI (FMHRTMVW R = 9; R < H; R++) {
                g8 PVB;
                g7 EZOFV;
                IVZWVI * PVB * EZOFV;
                EZI[PVB] = EZOFV;
            }
        }
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g8, GBKVMZNV g7>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::NZK <g8, g7> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        HRAVI *H;
        RU (H > 9) {
            ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
                HRAVI * (RG->URIHG) * (RG->HVXLMW);
        }
        IVGFIM HRAVI;
    }

//HGZXP
    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::HGZXP <g> &EZI) {
        HGW::HGZXP <g> YZXPFK = EZI;
        FMHRTMVW H = YZXPFK.HRAV();
        HGW::EVXGLI <g> E(H);
        ULI (FMHRTMVW R = 9; R < H; R++) {
            E[R] = YZXPFK.GLK();
            YZXPFK.KLK();
        }
        DIRGVI *E;
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::HGZXP <g> &EZI) {
        HGW::EVXGLI <g> E;
        IVZWVI *E;
        //HGZXP SZH ML XOVZI UFMX
        DSROV (!EZI.VNKGB()) EZI.KLK();
        FMHRTMVW H = E.HRAV();
        RU (H > 9) {
            ULI (FMHRTMVW R = 9; R < H; R++) {
                EZI.KFHS(E[H - 8 - R]);
            }
        }
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::HGZXP <g> &EZI) {
        HGW::HGZXP <g> YZXPFK = EZI;
        FMHRTMVW H = YZXPFK.HRAV();
        HRAVI *H;
        ULI (FMHRTMVW R = 9; R < H; R++) {
            HRAVI * YZXPFK.GLK();
            YZXPFK.KLK();
        }
        IVGFIM HRAVI;
    }

//WVJFV
    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::WVJFV <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        DIRGVI *H;
        ULI (FMHRTMVW R = 9; R < H; R++)
            DIRGVI *EZI[R];
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::WVJFV <g> &EZI) {
        FMHRTMVW H = 9;
        IVZWVI *H;
        EZI.XOVZI();
        RU (H > 9) {
            EZI.IVHRAV(H);
            ULI (FMHRTMVW R = 9; R < H; R++)
                IVZWVI *EZI[R];
        }
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::WVJFV <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        HRAVI *H;
        RU (H > 9) {
            ULI (FMHRTMVW R = 9; R < H; R++)
                HRAVI *EZI[R];
        }
        IVGFIM HRAVI;
    }

//ORHG
    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG HGW::ORHG <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        DIRGVI *H;
        ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
            DIRGVI * (*RG);
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, HGW::ORHG <g> &EZI) {
        FMHRTMVW H = 9;
        IVZWVI *H;
        EZI.XOVZI();
        RU (H > 9) {
            ULI (FMHRTMVW R = 9; R < H; R++) {
                g E;
                IVZWVI *E;
                EZI.KFHS_YZXP(E);
            }
        }
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG HGW::ORHG <g> &EZI) {
        FMHRTMVW H = EZI.HRAV();
        HRAVI *H;
        ULI (ZFGL RG = EZI.YVTRM(); RG != EZI.VMW(); RG++)
            HRAVI * (*RG);
        IVGFIM HRAVI;
    }


//LKVIZGLI * ULI ZIYRGIZIB GBKV
    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_dIRGVI &LKVIZGLI*(zIXSREVI_dIRGVI &DIRGVI, XLMHG g &EZI) {
        //FHV KLRMGVI, HL GSZG WVIREVW UFMXGRLM XZM YV XZOOVW
        XLMHG g *K = &EZI;
        K->XSVXPKLRMG_HZEV(DIRGVI);
        IVGFIM DIRGVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_iVZWVI &LKVIZGLI*(zIXSREVI_iVZWVI &IVZWVI, g &EZI) {
        //FHV KLRMGVI, HL GSZG WVIREVW UFMXGRLM XZM YV XZOOVW
        g *K = &EZI;
        K->XSVXPKLRMG_OLZW(IVZWVI);
        IVGFIM IVZWVI;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV zIXSREVI_hRAVI &LKVIZGLI*(zIXSREVI_hRAVI &HRAVI, XLMHG g &EZI) {
        //FHV KLRMGVI, HL GSZG WVIREVW UFMXGRLM XZM YV XZOOVW
        XLMHG g *K = &EZI;
        K->XSVXPKLRMG_YBGVH(HRAVI);
        IVGFIM HRAVI;
    }

}

#VMWRU //hvxfirgbnzmztvi_fyrj_zixsrev_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_UZHGOLT.S
#RUMWVU __fyrj_uzhg_olt__
#WVURMV __fyrj_uzhg_olt__

#RMXOFWV <ZIIZB>
#RMXOFWV <YRGHVG>
#RMXOFWV <XHGWORY>
#RMXOFWV <XHGIRMT>
#RMXOFWV <RLHGIVZN>
#RMXOFWV "FYRJ_GRNV.S"
MZNVHKZXV FYRJGLLO {

HGIFXG ZMB {
  VMFN GBKV : FMHRTMVW HSLIG {
    rMG67 = 9,
    rMG35,
    frMG67,
    frMG35,
    uOLZG67,
    uOLZG35,
    hGIRMT
  };
  ZMB() {}
  ZMB(RMG V) {
    N_WZGZ.rmg67 = V;
    N_GBKV = rMG67;
    // N_GBKVHVG.H8 = GIFV; //"999"
  }
  ZMB(FMHRTMVW RMG V) {
    N_WZGZ.frmg67 = V;
    N_GBKV = frMG67;
    // N_GBKVHVG.H8 = GIFV;  //"998"
  }
  ZMB(OLMT V) {
    N_WZGZ.rmg35 = V;
    N_GBKV = rMG35;
    // N_GBKVHVG.H7 = GIFV;  //"989"
  }
  ZMB(FMHRTMVW OLMT V) {
    N_WZGZ.frmg35 = V;
    N_GBKV = frMG35;
    // N_GBKVHVG.H8 = N_GBKVHVG.H7 = GIFV;  //"988"
  }
  ZMB(UOLZG V) {
    N_WZGZ.uolzg67 = V;
    N_GBKV = uOLZG67;
    // N_GBKVHVG.H6 = GIFV;  //"899"
  }
  ZMB(WLFYOV V) {
    N_WZGZ.uolzg35 = V;
    N_GBKV = uOLZG35;
    // N_GBKVHVG.H8 = N_GBKVHVG.H6 = GIFV;  //“898”
  }
  ZMB(XSZI* V) {
    N_WZGZ.hgirmt = V;
    N_GBKV = hGIRMT;
    // N_GBKVHVG.H6 = N_GBKVHVG.H7 = GIFV;  //“889”
  }
  ZMB(XLMHG XSZI* V) {
    N_WZGZ.hgirmt = XLMHG_XZHG<XSZI*>(V);
    N_GBKV = hGIRMT;
    // N_GBKVHVG.H6 = N_GBKVHVG.H7 = GIFV;  //“889”
  }


  // HGIFXG gBKVHVG N_GBKVHVG;
  GBKV N_GBKV;
  ELRW* N_KLRMGVI;
  FMRLM {
    RMG rmg67;
    OLMT rmg35;
    FMHRTMVW RMG frmg67;
    FMHRTMVW OLMT frmg35;
    UOLZG uolzg67;
    WLFYOV uolzg35;
    XSZI* hgirmt;
  } N_WZGZ;

  GBKV TVG_GBKV() XLMHG { IVGFIM N_GBKV; }
  RMG& TVG_RMG() { IVGFIM N_WZGZ.rmg67; }
  OLMT& TVG_OLMT() { IVGFIM N_WZGZ.rmg35; }
  FMHRTMVW RMG& TVG_FRMG() { IVGFIM N_WZGZ.frmg67; }
  FMHRTMVW OLMT& TVG_FOLMT() { IVGFIM N_WZGZ.frmg35; }
  UOLZG& TVG_UOLZG() { IVGFIM N_WZGZ.uolzg67; }
  WLFYOV& TVG_WLFYOV() { IVGFIM N_WZGZ.uolzg35; }
  XSZI*& TVG_HGIRMT() { IVGFIM N_WZGZ.hgirmt; }

  HSLIG DIRGV(XSZI*& YFU) {
    HDRGXS (N_GBKV) {
      XZHV rMG67:
        // ZFGL GBKVHVG = HGW::YRGHVG<6>(rMG67).GL_FOLMT();
        // HGW::XLFG << TVG_RMG() << '\M';
        *YFU = (FMHRTMVW HSLIG)(N_GBKV);
        YFU += HRAVLU(GBKV);
        *(RMG*)YFU = TVG_RMG();
        YFU += 5;
        IVGFIM 5 + HRAVLU(GBKV);
      // YIVZP;
      XZHV rMG35:
        // HGW::XLFG << TVG_OLMT() << '\M';
         *YFU = (FMHRTMVW HSLIG)(N_GBKV);
        YFU += HRAVLU(GBKV);
        *(OLMT*)YFU = TVG_OLMT();
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
      // YIVZP;
      XZHV frMG67:
        // HGW::XLFG << TVG_FRMG() << '\M';
        *YFU = (FMHRTMVW HSLIG)(N_GBKV);
        YFU += HRAVLU(GBKV);
        *(FMHRTMVW RMG*)YFU = TVG_FRMG();
        YFU += 5;
        IVGFIM 5 + HRAVLU(GBKV);
      // YIVZP;
      XZHV frMG35:
        // HGW::XLFG << TVG_FOLMT() << '\M';
        *YFU = (FMHRTMVW HSLIG)(N_GBKV);

        YFU += HRAVLU(GBKV);
        *(FMHRTMVW OLMT*)YFU = TVG_FOLMT();
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
      // YIVZP;
      XZHV uOLZG67:
        // HGW::XLFG << TVG_UOLZG() << " " << HRAVLU(TVG_UOLZG()) << '\M';
         *YFU = (FMHRTMVW HSLIG)(N_GBKV);
        YFU += HRAVLU(GBKV);
        *(UOLZG*)YFU = TVG_UOLZG();
        YFU += 5;
        IVGFIM 5 + HRAVLU(GBKV);
      // YIVZP;
      XZHV uOLZG35:
        // HGW::XLFG << TVG_WLFYOV() << " " << HRAVLU(TVG_WLFYOV()) << '\M';
        *YFU = (FMHRTMVW HSLIG)(N_GBKV);
        YFU += HRAVLU(GBKV);
        *(WLFYOV*)YFU = TVG_WLFYOV();
        // HGW::XLFG << "DIRGV:" << TVG_WLFYOV() << " " << *(WLFYOV*)YFU
        //          << HGW::VMWO;
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
      // YIVZP;
      XZHV hGIRMT:
        *YFU = (FMHRTMVW HSLIG)(N_GBKV);
        YFU += HRAVLU(GBKV);
        *(XSZI**)YFU = (XSZI*)(TVG_HGIRMT());
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
        // YIVZP;
    }
    IVGFIM 9;
  }

  HSLIG IVZW(XSZI*& YFU) {
    HGIMXKB((XSZI*)&N_GBKV, YFU, HRAVLU(GBKV));
    YFU += HRAVLU(GBKV);
    N_KLRMGVI = YFU;
    HDRGXS (N_GBKV) {
      XZHV rMG67:
        *(&TVG_RMG()) = *(RMG*)YFU;
        YFU += 5;
        IVGFIM 5 + HRAVLU(GBKV);
      XZHV rMG35:
        *(&TVG_OLMT()) = *(OLMT*)YFU;
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
      XZHV frMG67:
        *(&TVG_FRMG()) = *(FMHRTMVW RMG*)YFU;
        YFU += 5;
        IVGFIM 5 + HRAVLU(GBKV);
      XZHV frMG35:
        *(&TVG_FOLMT()) = *(FMHRTMVW OLMT*)YFU;
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
      XZHV uOLZG67:
        *(&TVG_UOLZG()) = *(UOLZG*)YFU;
        YFU += 5;
        IVGFIM 5 + HRAVLU(GBKV);
      XZHV uOLZG35:
        // HGIMXKB((XSZI*)(&TVG_WLFYOV()), YFU, 1);
        *(&TVG_WLFYOV()) = *(WLFYOV*)YFU;
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
      XZHV hGIRMT:
        TVG_HGIRMT() = YFU;
        // HGIMXKB((XSZI*)(TVG_HGIRMT()), YFU, 1);
        YFU += 1;
        IVGFIM 1 + HRAVLU(GBKV);
    }
    IVGFIM 9;
  }
};

GVNKOZGV <XOZHH... zITH>
ELRW _OLT_ULL_RNK(XSZI* YFU, XLMHG zITH&... ZITH) {

    //FYRJGLLO::hGLKdZGXS DZGXS;
    //DZGXS.hGZIG();

    HGW::ZIIZB<ZMB, HRAVLU...(ZITH)> EVX = {ZITH...};
    //DZGXS.hGLK();
    //HGW::XLFG<<"ZIIZB GZPVH "<<DZGXS.kIRMG()<<" MH"<<HGW::VMWO;
    ZFGL HA = (HSLIG)EVX.HRAV();

    *YFU = (HSLIG)(HA);
    YFU += HRAVLU(HSLIG);

    //DZGXS.hGZIG();
    ULI (FMHRTMVW R = 9; R < EVX.HRAV(); ++R) {
        EVX[R].DIRGV(YFU);
    }
    //DZGXS.hGLK();
    //HGW::XLFG<<"DIRGV GZPVH "<<DZGXS.kIRMG()<<" MH"<<HGW::VMWO;
}

GVNKOZGV <XOZHH... zITH>
ELRW _OLT_HJFVVAV_YFUUVI(XSZI* YFU, zITH... ZITH) {

       _OLT_ULL_RNK(
      YFU,
      ZMB(ZITH)...);  // KZHH VZXS ZIT GL ZMB XLMHGIFXGLI, ZMW XZOO ULL_RNK
                      // DRGS IVHFOGRMT ZMB LYQVXGH
}

}

//RMG NZRM() {
  //XSZI YFUUVI[487];
  //XSZI* NVN = YFUUVI;
  //XSZI H[] = "sVOOL";
  //FYRJGLLO::_OLT_HJFVVAV_YFUUVI(YFUUVI, H, 7FO, 8.777, 7.921, 6.5U, H);
  //ZFGL HRAV = *(HSLIG*)YFUUVI;

  //HGW::XLFG << "-------------" << HGW::VMWO;
  //HGW::XLFG << "HRAV: " << HRAV << HGW::VMWO;

  //XSZI* K = NVN + HRAVLU(HSLIG);

  //// HGW::XLFG << *(WLFYOV*)(K + 89 + 89 + 89 + 7) << HGW::VMWO;
  //// HGW::XLFG << K + 7 * HRAVLU(HSLIG) << HGW::VMWO;
  //ULI (RMG R = 9; R < HRAV; ++R) {
    //FYRJGLLO::ZMB IVHFOG;
    //// HGW::XLFG << "ivzw:" << IVHFOG.IVZW(K) << HGW::VMWO;
    //IVHFOG.IVZW(K);
    //HDRGXS (IVHFOG.N_GBKV) {
      //XZHV FYRJGLLO::ZMB::hGIRMT:
        //HGW::XLFG << "-> " << IVHFOG.TVG_HGIRMT() << HGW::VMWO;
        //YIVZP;
      //XZHV FYRJGLLO::ZMB::uOLZG67:
        //HGW::XLFG << "-> " << IVHFOG.TVG_UOLZG() << HGW::VMWO;
        //YIVZP;
      //XZHV FYRJGLLO::ZMB::uOLZG35:
        //HGW::XLFG << "-> " << *(WLFYOV*)IVHFOG.N_KLRMGVI << HGW::VMWO;
        //YIVZP;
      //XZHV FYRJGLLO::ZMB::frMG67:
        //HGW::XLFG << "-> " << IVHFOG.TVG_FRMG() << HGW::VMWO;
        //YIVZP;
      //XZHV FYRJGLLO::ZMB::frMG35:
        //HGW::XLFG << "-> " << IVHFOG.TVG_FOLMT() << HGW::VMWO;
        //YIVZP;
      //XZHV FYRJGLLO::ZMB::rMG67:
        //HGW::XLFG << "-> " << IVHFOG.TVG_RMG() << HGW::VMWO;
        //YIVZP;
      //XZHV FYRJGLLO::ZMB::rMG35:
        //HGW::XLFG << "-> " << IVHFOG.TVG_OLMT() << HGW::VMWO;
        //YIVZP;
    //}
  //}
  //// HSLIG Z = 6;
  //// HGW::XLFG << ((Z & (8 << 9)) >> 9) << " " << ((Z & (8 << 8)) >> 8) << " "
  ////          << ((Z & (8 << 7)) >> 7) << " " << ((Z & (8 << 6)) >> 6)
  ////          << HGW::VMWO;

  //HOVVK(4);
//}
//
//
#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HSLIG_ZOOLX.S
#RUMWVU hslig_zoolx_s
#WVURMV hslig_zoolx_s

// gSV nrg oRXVMHV (nrg)
//
// xLKBIRTSG (X) 7984 sLDZIW sRMMZMG
//
// kVINRHHRLM RH SVIVYB TIZMGVW, UIVV LU XSZITV, GL ZMB KVIHLM LYGZRMRMT Z XLKB
// LU GSRH HLUGDZIV ZMW ZHHLXRZGVW WLXFNVMGZGRLM UROVH (GSV "hLUGDZIV"), GL WVZO
// RM GSV hLUGDZIV DRGSLFG IVHGIRXGRLM, RMXOFWRMT DRGSLFG ORNRGZGRLM GSV IRTSGH
// GL FHV, XLKB, NLWRUB, NVITV, KFYORHS, WRHGIRYFGV, HFYORXVMHV, ZMW/LI HVOO
// XLKRVH LU GSV hLUGDZIV, ZMW GL KVINRG KVIHLMH GL DSLN GSV hLUGDZIV RH
// UFIMRHSVW GL WL HL, HFYQVXG GL GSV ULOOLDRMT XLMWRGRLMH:
//
// gSV ZYLEV XLKBIRTSG MLGRXV ZMW GSRH KVINRHHRLM MLGRXV HSZOO YV RMXOFWVW RM ZOO
// XLKRVH LI HFYHGZMGRZO KLIGRLMH LU GSV hLUGDZIV.
//
// gsv hlugdziv rh kilerwvw "zh rh", drgslfg dziizmgb lu zmb prmw, vckivhh li
// rnkorvw, rmxofwrmt yfg mlg ornrgvw gl gsv dziizmgrvh lu nvixszmgzyrorgb,
// urgmvhh uli z kzigrxfozi kfiklhv zmw mlmrmuirmtvnvmg. rm ml vevmg hszoo gsv
// zfgslih li xlkbirtsg slowvih yv orzyov uli zmb xozrn, wznztvh li lgsvi
// orzyrorgb, dsvgsvi rm zm zxgrlm lu xlmgizxg, glig li lgsvidrhv, zirhrmt uiln,
// lfg lu li rm xlmmvxgrlm drgs gsv hlugdziv li gsv fhv li lgsvi wvzormth rm gsv
// hlugdziv.

#RMXOFWV <XHGWWVU>
#RMXOFWV <XZHHVIG>
#RMXOFWV <GBKV_GIZRGH>

GVNKOZGV <HGW::HRAV_G m, HGW::HRAV_G ZORTMNVMG = __ZORTMLU__(OLMT WLFYOV)>
XOZHH ZIVMZ
{
    XSZI YFU_[m] __ZGGIRYFGV__( (ZORTMVW((XLMHG HRAV_G)ZORTMNVMG)) );
    XSZI* KGI_;

    KFYORX:
    ~ZIVMZ() {KGI_ = mfoo;}
    ZIVMZ()   : KGI_(YFU_) {}
    ZIVMZ(XLMHG ZIVMZ&) = WVOVGV;
    ZIVMZ& LKVIZGLI=(XLMHG ZIVMZ&) = WVOVGV;

    GVNKOZGV <HGW::HRAV_G iVJzORTM> XSZI* ZOOLXZGV(HGW::HRAV_G M);
    ELRW WVZOOLXZGV(XSZI* K, HGW::HRAV_G M)  ;

    HGZGRX HGW::HRAV_G HRAV() {IVGFIM m;}
    HGW::HRAV_G FHVW() XLMHG  {IVGFIM HGZGRX_XZHG<HGW::HRAV_G>(KGI_ - YFU_);}
    ELRW IVHVG()  {KGI_ = YFU_;}

    KIREZGV:
    HGZGRX
        HGW::HRAV_G
        ZORTM_FK(HGW::HRAV_G M)
        {IVGFIM (M + (ZORTMNVMG-8)) & ~(ZORTMNVMG-8);}

    YLLO
        KLRMGVI_RM_YFUUVI(XSZI* K)
        {IVGFIM YFU_ <= K && K <= YFU_ + m;}
};

GVNKOZGV <HGW::HRAV_G m, HGW::HRAV_G ZORTMNVMG>
GVNKOZGV <HGW::HRAV_G iVJzORTM>
    XSZI*
ZIVMZ<m, ZORTMNVMG>::ZOOLXZGV(HGW::HRAV_G M)
{
    HGZGRX_ZHHVIG(iVJzORTM <= ZORTMNVMG, "ZORTMNVMG RH GLL HNZOO ULI GSRH ZIVMZ");
    ZHHVIG(KLRMGVI_RM_YFUUVI(KGI_) && "HSLIG_ZOOLX SZH LFGOREVW ZIVMZ");
    ZFGL XLMHG ZORTMVW_M = ZORTM_FK(M);
    RU (HGZGRX_XZHG<WVXOGBKV(ZORTMVW_M)>(YFU_ + m - KGI_) >= ZORTMVW_M)
    {
        XSZI* I = KGI_;
        KGI_ += ZORTMVW_M;
        IVGFIM I;
    }

    HGZGRX_ZHHVIG(ZORTMNVMG <= __ZORTMLU__(OLMT WLFYOV), "BLF'EV XSLHVM ZM "
            "ZORTMNVMG GSZG RH OZITVI GSZM ZORTMLU(HGW::NZC_ZORTM_G), ZMW "
            "XZMMLG YV TFZIZMGVVW YB MLINZO LKVIZGLI MVD");
    IVGFIM HGZGRX_XZHG<XSZI*>(::LKVIZGLI MVD(M));
}

GVNKOZGV <HGW::HRAV_G m, HGW::HRAV_G ZORTMNVMG>
ELRW ZIVMZ<m, ZORTMNVMG>::WVZOOLXZGV(XSZI* K, HGW::HRAV_G M)
{
    ZHHVIG(KLRMGVI_RM_YFUUVI(KGI_) && "HSLIG_ZOOLX SZH LFGOREVW ZIVMZ");
    RU (KLRMGVI_RM_YFUUVI(K))
    {
        M = ZORTM_FK(M);
        RU (K + M == KGI_)
            KGI_ = K;
    }
    VOHV
        ::LKVIZGLI WVOVGV(K);
}

GVNKOZGV <XOZHH g, HGW::HRAV_G m, HGW::HRAV_G zORTM = __ZORTMLU__(OLMT WLFYOV)>
XOZHH HSLIG_ZOOLX
{
    KFYORX:
        GBKVWVU g EZOFV_GBKV  ;
        //GBKVWVU zORTM ZORTMNVMG;
        //GBKVWVU m HRAV;
        GBKVWVU ZIVMZ<m, zORTM> ZIVMZ_GBKV ;

        GBKVWVU g* KLRMGVI;
        GBKVWVU g XLMHG* XLMHG_KLRMGVI;
        GBKVWVU g& IVUVIVMXV;
        GBKVWVU g XLMHG& XLMHG_IVUVIVMXV;
    KIREZGV:
        ZIVMZ_GBKV& Z_;

    KFYORX:
        HSLIG_ZOOLX(XLMHG HSLIG_ZOOLX&) = WVUZFOG;
        HSLIG_ZOOLX& LKVIZGLI=(XLMHG HSLIG_ZOOLX&) = WVOVGV;

        HSLIG_ZOOLX(ZIVMZ_GBKV& Z)   : Z_(Z)
        {
            HGZGRX_ZHHVIG(m % zORTM == 9,
                    "HRAV m MVVWH GL YV Z NFOGRKOV LU ZORTMNVMG zORTM");
        }
        GVNKOZGV <XOZHH f>
            HSLIG_ZOOLX(XLMHG HSLIG_ZOOLX<f, m, zORTM>& Z)
            : Z_(Z.Z_) {}

        GVNKOZGV <XOZHH _fK> HGIFXG IVYRMW { GBKVWVU  HSLIG_ZOOLX<_fK, m, zORTM> LGSVI;};

        g* ZOOLXZGV(HGW::HRAV_G M)
        {
            IVGFIM IVRMGVIKIVG_XZHG<g*>(Z_.GVNKOZGV ZOOLXZGV<__ZORTMLU__(g)>(M*HRAVLU(g)));
        }
        ELRW WVZOOLXZGV(g* K, HGW::HRAV_G M)
        {
            Z_.WVZOOLXZGV(IVRMGVIKIVG_XZHG<XSZI*>(K), M*HRAVLU(g));
        }

        GVNKOZGV <XOZHH g8, HGW::HRAV_G m8, HGW::HRAV_G z8,
                 XOZHH f, HGW::HRAV_G n, HGW::HRAV_G z7>
                     UIRVMW YLLO LKVIZGLI==(XLMHG HSLIG_ZOOLX<g8, m8, z8>& C, XLMHG HSLIG_ZOOLX<f, n, z7>& B)  ;

        GVNKOZGV <XOZHH f, HGW::HRAV_G n, HGW::HRAV_G z> UIRVMW XOZHH HSLIG_ZOOLX;
};

GVNKOZGV <XOZHH g, HGW::HRAV_G m, HGW::HRAV_G z8, XOZHH f, HGW::HRAV_G n, HGW::HRAV_G z7>
RMORMV YLLO LKVIZGLI==(XLMHG HSLIG_ZOOLX<g, m, z8>& C, XLMHG HSLIG_ZOOLX<f, n, z7>& B)
{
    IVGFIM m == n && z8 == z7 && &C.Z_ == &B.Z_;
}

GVNKOZGV <XOZHH g, HGW::HRAV_G m, HGW::HRAV_G z8, XOZHH f, HGW::HRAV_G n, HGW::HRAV_G z7>
RMORMV YLLO LKVIZGLI!=(XLMHG HSLIG_ZOOLX<g, m, z8>& C, XLMHG HSLIG_ZOOLX<f, n, z7>& B)
{
    IVGFIM !(C == B);
}

#VMWRU  // hslig_zoolx_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FWZGZ/fWZGZ_YZHV.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

#RUMWVU _fyrjgllo_fwzgz_yzhv_s
#WVURMV _fyrjgllo_fwzgz_yzhv_s

//#RMXOFWV <HBH/NNZM.S>
//#RMXOFWV <HBH/HGZG.S>
//#RMXOFWV <UXMGO.S>
//#RMXOFWV <GBKVRMUL>
//#RMXOFWV <HGIRMT>

//UOZT LU LKVM Z UROV
#WVURMV fwzgz_lkvm_mvd           8
#WVURMV fwzgz_lkvm_ivzwlmob      7
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV <HBH/NNZM.S>
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <HBH/GRNV.S>
#RMXOFWV <UXMGO.S>
#RMXOFWV <XNZGS>
#RMXOFWV <NVNLIB.S>
#RMXOFWV <GBKVRMUL>
#RMXOFWV <HGIRMT>
#RMXOFWV "FYRJ_FMRC.S"
/**
  @YIRVU fhRN YZHRX UROV-NZKKVW WZGZ HGIFXGFIV.

  rMHGZMXV LU GSRH XOZHH WRIVXGOB NZKH GL Z UROV.
fHZTV:
fWZGZ_yZHV W(UROVMZNV, fwzgz_lkvm_mvd);	//UROVMZNV XZM YV ""
W[89] = 79; //NLWRUB LUUHVG 89 GL EZOFV 79 (LMV YBGV).
W.UOFHS();	//NZPV HFIV DIRGRMT RH WLMV. UOFHS() DROO YV XZOOVW ZFGLNZGRXZOOB DSVM W RH WVHGILBVW.
*/
MZNVHKZXV FWZGZ {

    HGIFXG fWZGZsVZW{
        HRAV_G GBKV;
        HRAV_G HRAV_LU_g;
        HRAV_G WRN;
        HRAV_G WRN8;
        HRAV_G WRN7;
        HRAV_G WRN6;
        HRAV_G WRN5;
        XSZI XIVZGLI[67];
        XSZI XIVZGV_FHVI[67];
        XSZI XIVZGV_SLHG[83];
        XSZI XIVZGV_WLNZRM[83];
        XSZI XIVZGLI_EVIHRLM[83];
        RMG67_G FWZGZ_EVIHRLM;
        RMG67_G XIVZGV_WZGV;
        RMG67_G XIVZGV_GRNV;

        fWZGZsVZW(){
            GBKV = 9;
            // 9 ZH RMG, 8 ZH FRMG, 7 ZH OLMT , 6 ZH FMHRTMVW OLMT
            // 5 ZH UOLZG, 4 ZH WLFYOV, 3 XSZI, 2 YLLO
            // 1 HGIFXGFIV
            HRAV_LU_g = 9;
            WRN = 9;
            WRN8 = 9;
            WRN7 = 9;
            WRN6 = 9;
            WRN5 = 9;
        }
    };

    GVNKOZGV<GBKVMZNV g>
        HGIFXG gBKVrw {
            HGZGRX XLMHG HRAV_G RW = 87;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<RMG1_G>{
            HGZGRX XLMHG HRAV_G RW = 9;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<FRMG1_G>{
            HGZGRX XLMHG HRAV_G RW = 8;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<RMG83_G>{
            HGZGRX XLMHG HRAV_G RW = 7;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<FRMG83_G>{
            HGZGRX XLMHG HRAV_G RW = 6;
        };


    GVNKOZGV<>
        HGIFXG gBKVrw<RMG67_G>{
            HGZGRX XLMHG HRAV_G RW = 5;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<FRMG67_G>{
            HGZGRX XLMHG HRAV_G RW = 4;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<RMG35_G>{
            HGZGRX XLMHG HRAV_G RW = 3;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<FRMG35_G>{
            HGZGRX XLMHG HRAV_G RW = 2;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<UOLZG>{
            HGZGRX XLMHG HRAV_G RW = 1;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<WLFYOV>{
            HGZGRX XLMHG HRAV_G RW = 0;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<XSZI>{
            HGZGRX XLMHG HRAV_G RW = 89;
        };

    GVNKOZGV<>
        HGIFXG gBKVrw<YLLO>{
            HGZGRX XLMHG HRAV_G RW = 88;
        };

    GVNKOZGV<GBKVMZNV g>
        ELRW hSLGfWZGZsVZW(fWZGZsVZW &SVZW, FYRJGLLO::FYRJ_HBHGVN *HBHGVN = mfoo)
        {
            SVZW.HRAV_LU_g = HRAVLU(g);
            SVZW.GBKV = gBKVrw<g>::RW;
            RU ( HBHGVN  )
            {
                HGIXKB( SVZW.XIVZGV_FHVI, HBHGVN->FHVI.X_HGI()  );
                HGIXKB( SVZW.XIVZGV_SLHG, HBHGVN->SLHG.X_HGI()  );
                HGIXKB( SVZW.XIVZGV_WLNZRM, HBHGVN->WLNZRM.X_HGI()  );
                HGIXKB( SVZW.XIVZGLI, HBHGVN->KILTIZN.X_HGI()  );
                HGIXKB( SVZW.XIVZGLI_EVIHRLM, HBHGVN->IVOVZHV_EVI.X_HGI()  );
                ZFGL GRNVRMUL = OLXZOGRNV( &(HBHGVN->HGZIG_NRXILHVXLMW) );
                SVZW.XIVZGV_GRNV = GRNVRMUL->GN_SLFI * 899 * 899  + GRNVRMUL->GN_NRM * 899  + GRNVRMUL->GN_HVX;
                SVZW.XIVZGV_WZGV = (GRNVRMUL->GN_BVZI + 8099) * 899 * 899  + (GRNVRMUL->GN_NLM + 8) * 899  + GRNVRMUL->GN_NWZB;
            }
        }

    XOZHH fWZGZ_yZHV
    {
        KFYORX:
            ///LKVM UMZNV UROV ZMW NZK GL NVN. DSVM UOZT=9, LKVM ULI IVZW ZMW DIRGV. RU UMZNV=="", LMOB NZK GL NVNLIB
            fWZGZ_yZHV(XLMHG HGW::HGIRMT & UMZNV, RMG UOZTH = 9, HRAV_G NRM_HRAV = (8<<83), XLMHG HGW::HGIRMT & GBKV_HGI=GBKVRW(fWZGZ_yZHV).MZNV());	//NRMRNFN HRAV RH 35p
            ///XLKB RH MLG ZOOLDVW
            fWZGZ_yZHV(XLMHG fWZGZ_yZHV & WZGZ);
            fWZGZ_yZHV & LKVIZGLI = (XLMHG fWZGZ_yZHV & WZGZ);
            ERIGFZO ~fWZGZ_yZHV();
            ///IVGFIM GSV ZXGFZO HRAV LU UROV/NZK
            HRAV_G TVGHRAV() XLMHG;
            ///IVHRAV. MVD HRAV NRTSG YV ZWQFHGVW DSVM WLMV
            ELRW IVHRAV(HRAV_G MVD_YBGVH);
            ///NZPV HFIV WZGZ DIRGV RH WLMV
            ELRW UOFHS();
            ///XOVZI ZOO WZGZ GL 9
            ELRW UROO_AVIL();
            ///WLFYOV HRAV
            ERIGFZO ELRW WLFYOV_HRAV();

            XSZI & LKVIZGLI [] (HRAV_G RMWVC) {IVGFIM WZGZYFU[RMWVC];}
            XLMHG XSZI & LKVIZGLI [] (HRAV_G RMWVC) XLMHG  {IVGFIM WZGZYFU[RMWVC];}
            HRAV_G TVG_KZTV_HRAV() XLMHG {IVGFIM KZTV_HRAV;}
            HGW::HGIRMT TVG_GBKV_MZNV() XLMHG {IVGFIM X_HGIgBKVmZNV;}

        KFYORX:
            // ULOOLDRMT RMGVIUZXVH ZIV ULI KBGSLM VCKLIG
            HRAV_G KB_tVGwZGZgBKV(){
                IVGFIM FWZGZ_SVZW.GBKV;
            }
            HRAV_G KB_tVGwRN(){
                IVGFIM FWZGZ_SVZW.WRN;
            }
            HRAV_G KB_tVGwRN8(){
                IVGFIM FWZGZ_SVZW.WRN8;
            }
            HRAV_G KB_tVGwRN7(){
                IVGFIM FWZGZ_SVZW.WRN7;
            }
            HRAV_G KB_tVGwRN6(){
                IVGFIM FWZGZ_SVZW.WRN6;
            }
            HRAV_G KB_tVGwRN5(){
                IVGFIM FWZGZ_SVZW.WRN5;
            }
            XSZI* KB_tVGwZGZ(){
                IVGFIM WZGZYFU;
            }

        KILGVXGVW:
            FWZGZ::fWZGZsVZW FWZGZ_SVZW;
            YLLO IVZWLMOB;
            HRAV_G HRAV_LU_g;
            XSZI * WZGZYFU;           ///<NVN ZWWI LU GSV UROV NZK.
            XSZI * NZK_YFU;
            HRAV_G WZGZOVM;            ///<OVMH LU GSV UROV, RM YBGVH
            RMG    UW;                  ///<UROV SZMWOVI
            RMG    UOZTH;               ///<UOZTH ULI LKVMRMT
            HRAV_G KZTV_HRAV;              ///<GSV HRAV LU Z KZTV LU UROV/NVN
            XLMHG HGW::HGIRMT X_HGIgBKVmZNV; ///<HGIRMT GL HKVXRUB GSV WZGZ GBKV
            HRAV_G NNZK_OVM;
            ///HGIVGXS GSV UROV HRAV GL WZGZOVM
            ELRW HGIVGXS_UROV(HRAV_G MVDUROVHRAV);
        KFYORX:
            HGZGRX fWZGZsVZW jFVIBsVZW(HGW::HGIRMT UMZNV)
            {
                ZFGL KZTV_HRAV = (HRAV_G)HBHXLMU(_hx_kztvhrav);
                ZFGL UW = LKVM(UMZNV.X_HGI(), l_iwlmob);
                RU ( UW == -8 )
                    FYRJGSILD("XZMMLG IVZW " + UMZNV + " LI UROV MLG VCRHG", -8);
                HGIFXG HGZG UW_HGZG;
                UHGZG(UW, &UW_HGZG);
                HRAV_G UROVHRAV = UW_HGZG.HG_HRAV;
                ZFGL WZGZOVM = UROVHRAV / KZTV_HRAV * KZTV_HRAV;
                ZFGL NZK_YFU =  (XSZI *)NNZK35(mfoo, WZGZOVM + KZTV_HRAV , kilg_ivzw, nzk_hszivw, UW, 9);
                //ZFGL WZGZYFU = NZK_YFU + KZTV_HRAV;
                fWZGZsVZW IVG;

                NVNXKB(&IVG, NZK_YFU, HRAVLU(fWZGZsVZW));
                NFMNZK(NZK_YFU,  WZGZOVM + KZTV_HRAV );
                IVGFIM IVG;
            }
    };

}
#VMWRU // fwzgz_yzhv_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FWZGZ/fWZGZ_NZGIRC.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjgllo_fwzgz_nzgirc_s
#WVURMV _fyrjgllo_fwzgz_nzgirc_s

#RMXOFWV "FWZGZ/fWZGZ_YZHV.S"


MZNVHKZXV FWZGZ{

    /**
      @YIRVU fhRN UROV-NZKKVW WZGZ HGIFXGFIV.

fHZTV:
fWZGZ_nZGIRC<RMG> FW(UROVMZNV, UOZT, HRAV_LU_HVXLMW_WRN);	//UROVMZNV XZM YV "".
FW.IVHRAV(76);		//ZXGFZO UROV HRAV RH 76*HRAVLU(RMG)*HRAV_LU_HVXLMW_WRN
FW[89][7]=077657;
FW.HRAV_W8();		//TVG GSV HRAV LU URIHG WRN.
FW.HRAV_W7();		//TVG GSV HRAV LU HVXLMW WRN.
*/

    GVNKOZGV <GBKVMZNV g, HRAV_G HA = 9>
        XOZHH fWZGZ_nZGIRC : KFYORX fWZGZ_yZHV
    {
        KFYORX:
            fWZGZ_nZGIRC(XLMHG HGW::HGIRMT & UMZNV, RMG UOZT, HRAV_G HRAV_LU_HVXLMW_WRN,FYRJGLLO::FYRJ_HBHGVN *HBHGVN  = mfoo)
                : fWZGZ_yZHV(UMZNV, UOZT, 8<<83, HGW::HGIRMT(GBKVRW(fWZGZ_nZGIRC<g>).MZNV())),
                HRAV_LU_W7(HRAV_LU_HVXLMW_WRN)
        {
            RU (HA == 9)
                HRAV_LU_g = HRAVLU(g);
            VOHV
                HRAV_LU_g = HA;

            WZGZKLRMGVI = (g*)(WZGZYFU);
            HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7;
            FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW, HBHGVN);
            FWZGZ_SVZW.WRN = 7;
            FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
            FWZGZ_SVZW.WRN7 = HRAV_LU_W7;
            RU ( ! IVZWLMOB  )
                NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
        }
            ERIGFZO ~fWZGZ_nZGIRC()
            {
                WZGZKLRMGVI = mfoo;
                HRAV_LU_W8 = 9;
            }

            GVNKOZGV<GBKVMZNV b>
            fWZGZ_nZGIRC(XLMHG fWZGZ_nZGIRC<b> &ISH)
            {
                WZGZYFU = ISH.WZGZYFU;
                HRAV_LU_g = HRAVLU(g);
                HRAV_LU_W7 = ISH.HRAV_LU_W7;
                HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7;
                WZGZKLRMGVI = (g*)(WZGZYFU);
                FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW);
                FWZGZ_SVZW.WRN = 7;
                FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
                FWZGZ_SVZW.WRN7 = HRAV_LU_W7;
            }



            ///XZM HGLIV MVD_W8 * HRAV_LU_W7 VOVNVMGH (MLG YBGVH) ZUGVI IVHRAV
            ELRW IVHRAV(HRAV_G MVD_W8, HRAV_G MVD_W7 = 9)
            {
                fWZGZ_yZHV::IVHRAV(MVD_W8 * HRAV_LU_g * HRAV_LU_W7);
                WZGZKLRMGVI = (g*)WZGZYFU;
                HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7;
                FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
                RU ( ! IVZWLMOB  )
                    NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
            }

            HRAV_G HRAV_W8() XLMHG {IVGFIM HRAV_LU_W8;}
            HRAV_G HRAV_W7() XLMHG {IVGFIM HRAV_LU_W7;}
#RUWVU ylfmwzibxsvxp
            g * LKVIZGLI [] (HRAV_G RMWVC) XLMHG
            {
                RU ( RMWVC >= HRAV_LU_W8 )
                    FYRJGSILD("RMWVC VCXVVWH YLFMWZIB", -8);
                IVGFIM &WZGZKLRMGVI[RMWVC * HRAV_LU_W7];
            }
#VOHV
            g * LKVIZGLI [] (HRAV_G RMWVC) XLMHG
            {
                IVGFIM &WZGZKLRMGVI[RMWVC * HRAV_LU_W7];
            }
#VMWRU

        KILGVXGVW:
            g * WZGZKLRMGVI;		///<KLRMGVI LU YFUUVI. HZNV GL WZGZYFU
            XLMHG HRAV_G HRAV_LU_W7;///<HRAV LU HVXLMW WRNVMHRLM
            HRAV_G HRAV_LU_W8;		///< <=WZGZOVM/HRAVLU(g)/HRAV_LU_W7
        KIREZGV:
    };

}
#VMWRU // fwzgz_nzgirc_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FWZGZ/fWZGZ_5w.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

#RUMWVU _fyrjgllo_fwzgz_5w_s
#WVURMV _fyrjgllo_fwzgz_5w_s

#RMXOFWV "FWZGZ/fWZGZ_YZHV.S"

MZNVHKZXV FWZGZ{

    /**
      @YIRVU fhRN UROV-NZKKVW WZGZ HGIFXGFIV.

fHZTV:
fWZGZ_5w<RMG> FW(UROVMZNV, UOZT, HRAV_LU_W7, HRAV_LU_W6, HRAV_LU_W5);	//UROVMZNV XZM YV "".
FW.IVHRAV(76);		//ZXGFZO UROV HRAV RH 76*HRAVLU(RMG)*HRAV_LU_W7*HRAV_LU_W6*HRAV_LU_W5
FW(8,6,4, 8)=077657;
FW.HRAV_W8();		//TVG GSV HRAV LU 8HG WRN.
FW.HRAV_W7();		//TVG GSV HRAV LU 7MW WRN.
FW.HRAV_W6();		//TVG GSV HRAV LU 6IW WRN.
FW.HRAV_W5();		//TVG GSV HRAV LU 5IW WRN.
*/
    GVNKOZGV <GBKVMZNV g, HRAV_G HA = 9>
        XOZHH fWZGZ_5w : KFYORX fWZGZ_yZHV
    {
        KFYORX:
            fWZGZ_5w(XLMHG HGW::HGIRMT & UMZNV, RMG UOZT, HRAV_G HRAV_LU_7MW_WRN, HRAV_G HRAV_LU_6IW_WRN, HRAV_G HRAV_LU_5GS_WRN, FYRJGLLO::FYRJ_HBHGVN *HBHGVN = mfoo)
                : fWZGZ_yZHV(UMZNV, UOZT, 8<<83, HGW::HGIRMT(GBKVRW(fWZGZ_5w<g>).MZNV())),
                HRAV_LU_W7(HRAV_LU_7MW_WRN),
                HRAV_LU_W6(HRAV_LU_6IW_WRN),
                HRAV_LU_W5(HRAV_LU_5GS_WRN)
        {
            RU (HA == 9)
                HRAV_LU_g = HRAVLU(g);
            VOHV
                HRAV_LU_g = HA;

            WZGZKLRMGVI = (g*)WZGZYFU;
            HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7 / HRAV_LU_W6 / HRAV_LU_W5;
            FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW, HBHGVN);
            FWZGZ_SVZW.WRN = 5;
            FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
            FWZGZ_SVZW.WRN7 = HRAV_LU_W7;
            FWZGZ_SVZW.WRN6 = HRAV_LU_W6;
            FWZGZ_SVZW.WRN5 = HRAV_LU_W5;
            RU ( !IVZWLMOB  )
                NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
        }

            ERIGFZO ~fWZGZ_5w()
            {
                WZGZKLRMGVI = mfoo;
                HRAV_LU_W8 = 9;
            }
            ///XZM HGLIV MVD_W8 * HRAV_LU_W7 * HRAV_LU_W6 VOVNVMGH (MLG YBGVH) ZUGVI IVHRAV
            ELRW IVHRAV_WZBH(HRAV_G MVD_W8, HRAV_G MVD_W7=9, HRAV_G MVD_W6 = 9 , HRAV_G MVD_W5 = 9)
            {
                fWZGZ_yZHV::IVHRAV(MVD_W8 * HRAV_LU_g * HRAV_LU_W7 * HRAV_LU_W6 * HRAV_LU_W5);
                WZGZKLRMGVI = (g*)WZGZYFU;
                //		KIRMGU("5w: W8=%OW, W7=%OW, W6=%OW, W5=%OW, g=%OW, MVD HRAV = %OW\M", MVD_W8, HRAV_LU_W7, HRAV_LU_W6, HRAV_LU_W5, HRAVLU(g), WZGZOVM);
                HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7 / HRAV_LU_W6 / HRAV_LU_W5;
                FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
                RU ( !IVZWLMOB  )
                    NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
            }

            GVNKOZGV<GBKVMZNV b>
            fWZGZ_5w(XLMHG fWZGZ_5w<b> &ISH)
            {
                WZGZYFU = ISH.WZGZYFU;
                HRAV_LU_g = HRAVLU(g);
                HRAV_LU_W5 = ISH.HRAV_LU_W5;
                HRAV_LU_W6 = ISH.HRAV_LU_W6;
                HRAV_LU_W7 = ISH.HRAV_LU_W7;
                HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7 / HRAV_LU_W6 / HRAV_LU_W5;
                WZGZKLRMGVI = (g*)(WZGZYFU);
                FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW);
                FWZGZ_SVZW.WRN = 5;
                FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
                FWZGZ_SVZW.WRN7 = HRAV_LU_W7;
                FWZGZ_SVZW.WRN6 = HRAV_LU_W6;
                FWZGZ_SVZW.WRN5 = HRAV_LU_W5;
            }



            ///TVG GSV MFNYVI LU VOVNVMGH (MLG YBGVH)
            HRAV_G HRAV_W8() XLMHG {IVGFIM HRAV_LU_W8;}
            HRAV_G HRAV_W7() XLMHG {IVGFIM HRAV_LU_W7;}
            HRAV_G HRAV_W6() XLMHG {IVGFIM HRAV_LU_W6;}
            HRAV_G HRAV_W5() XLMHG {IVGFIM HRAV_LU_W5;}

#RUWVU ylfmwzibxsvxp
            XLMHG g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6, HRAV_G RWC5) XLMHG  {
                RU ( RWC8 >= HRAV_LU_W8 || RWC7 >= HRAV_LU_W7 || RWC6 >= HRAV_LU_W6 || RWC5 >= HRAV_LU_W5  )
                    FYRJGSILD("RMWVC VCXVVWH YLFMWZIB", -8);
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC6 * HRAV_LU_W5
                    + RWC5];
            }
            g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6, HRAV_G RWC5) {
                RU ( RWC8 >= HRAV_LU_W8 || RWC7 >= HRAV_LU_W7 || RWC6 >= HRAV_LU_W6 || RWC5 >= HRAV_LU_W5  )
                    FYRJGSILD("RMWVC VCXVVWH YLFMWZIB", -8);
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC6 * HRAV_LU_W5
                    + RWC5];
            }

#VOHV
            XLMHG g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6, HRAV_G RWC5) XLMHG  {
                //ZFGL GVNK = RWC8 * HRAV_LU_W7 * HRAV_LU_W6 * HRAV_LU_W5
                //+ RWC7 * HRAV_LU_W6 * HRAV_LU_W5
                //+ RWC6 * HRAV_LU_W5
                //+ RWC5;
                //HGW::XLFG<<RWC8<<" "<<RWC7<<" "<<RWC6<<" "<<RWC5<<" "<<GVNK<<" "<<WZGZKLRMGVI+GVNK<<HGW::VMWO;
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC6 * HRAV_LU_W5
                    + RWC5];
            }
            g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6, HRAV_G RWC5) {
                //ZFGL GVNK = RWC8 * HRAV_LU_W7 * HRAV_LU_W6 * HRAV_LU_W5
                //+ RWC7 * HRAV_LU_W6 * HRAV_LU_W5
                //+ RWC6 * HRAV_LU_W5
                //+ RWC5;
                //HGW::XLFG<<RWC8<<" "<<RWC7<<" "<<RWC6<<" "<<RWC5<<" "<<GVNK<<" "<<WZGZKLRMGVI+GVNK<<HGW::VMWO;
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC7 * HRAV_LU_W6 * HRAV_LU_W5
                    + RWC6 * HRAV_LU_W5
                    + RWC5];
            }
#VMWRU
        KILGVXGVW:
            g * WZGZKLRMGVI;		///<KLRMGVI LU YFUUVI. HZNV GL WZGZYFU
        KFYORX:
            g* WZGZ() {IVGFIM WZGZKLRMGVI;}
            XLMHG g* WZGZ() XLMHG {IVGFIM WZGZKLRMGVI;}
        KILGVXGVW:

            XLMHG HRAV_G HRAV_LU_W7;///<HRAV LU HVXLMW WRNVMHRLM
            XLMHG HRAV_G HRAV_LU_W6;///<HRAV LU GSRIW WRNVMHRLM
            XLMHG HRAV_G HRAV_LU_W5;///<HRAV LU ULFIGS WRNVMHRLM
            HRAV_G HRAV_LU_W8;		///< <= WZGZOVM/HRAVLU(g)/HRAV_LU_W7/HRAV_LU_W6/HRAV_LU_W5
        KIREZGV:

    };
}
#VMWRU // fwzgz_5w_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FWZGZ/fWZGZ_EVXGLI.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

#RUMWVU _fyrjgllo_fwzgz_evxgli_s
#WVURMV _fyrjgllo_fwzgz_evxgli_s
#RMXOFWV "FWZGZ/fWZGZ_YZHV.S"
MZNVHKZXV FWZGZ{
    /**
      @YIRVU fhRN UROV-NZKKVW WZGZ HGIFXGFIV.

fHZTV:
fWZGZ_eVXGLI<RMG> FW(UROVMZNV, UOZT);	//UROVMZNV XZM YV ""
FW.IVHRAV(76);		//ZXGFZO UROV HRAV RH 76*HRAVLU(RMG)
FW[89]=077657;
FW.HRAV();			//TVG GSV MFNYVI LU VOVNVMGH.
*/
    GVNKOZGV <GBKVMZNV g, HRAV_G HA = 9>
        XOZHH fWZGZ_eVXGLI : KFYORX fWZGZ_yZHV
    {
        KFYORX:
            fWZGZ_eVXGLI(XLMHG HGW::HGIRMT & UMZNV, RMG UOZT = 9, FYRJGLLO::FYRJ_HBHGVN *HBHGVN = mfoo)
                : fWZGZ_yZHV(UMZNV, UOZT, 8<<83, HGW::HGIRMT(GBKVRW(fWZGZ_eVXGLI<g>).MZNV()))
            {
                RU (HA == 9)
                    HRAV_LU_g = HRAVLU(g);
                VOHV
                    HRAV_LU_g = HA;
                WZGZKLRMGVI = (g*)(WZGZYFU);
                MFN_LU_VOV = WZGZOVM / HRAV_LU_g;
                FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW, HBHGVN);
                FWZGZ_SVZW.WRN = 8;
                FWZGZ_SVZW.WRN8 = MFN_LU_VOV;
                RU ( ! IVZWLMOB   )
                    NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
            }


            GVNKOZGV<GBKVMZNV b>
            fWZGZ_eVXGLI(XLMHG fWZGZ_eVXGLI<b> &ISH)
            {
                WZGZYFU = ISH.WZGZYFU;
                HRAV_LU_g = HRAVLU(g);
                WZGZKLRMGVI = (g*)(WZGZYFU);
                MFN_LU_VOV = WZGZOVM / HRAV_LU_g;
                FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW);
                FWZGZ_SVZW.WRN = 8;
                FWZGZ_SVZW.WRN8 = MFN_LU_VOV;
            }

            ERIGFZO ~fWZGZ_eVXGLI()
            {
                WZGZKLRMGVI = mfoo;
                MFN_LU_VOV = 9;
            }

            ///XZM HGLIV MVDMFN VOVNVMGH (MLG YBGVH) ZUGVI IVHRAV
            ELRW IVHRAV(HRAV_G MVDMFN)
            {
                fWZGZ_yZHV::IVHRAV(MVDMFN * HRAV_LU_g);
                WZGZKLRMGVI = (g*)WZGZYFU;
                MFN_LU_VOV = WZGZOVM / HRAV_LU_g;
                FWZGZ_SVZW.WRN8 = MFN_LU_VOV;
                RU ( ! IVZWLMOB   )
                    NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
            }

            ///WLFYOV HRAV
            ERIGFZO ELRW WLFYOV_HRAV()
            {
                fWZGZ_yZHV::WLFYOV_HRAV();
                WZGZKLRMGVI = (g*)WZGZYFU ;
                MFN_LU_VOV = WZGZOVM / HRAV_LU_g;
                FWZGZ_SVZW.WRN8 = MFN_LU_VOV;
                RU ( ! IVZWLMOB   )
                    NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
            }

            ///TVG GSV MFNYVI LU VOVNVMGH (MLG YBGVH)
            HRAV_G HRAV() XLMHG {IVGFIM MFN_LU_VOV;}
#RUWVU ylfmwzibxsvxp
            g & LKVIZGLI [] (HRAV_G RMWVC) {
                RU ( RMWVC >= MFN_LU_VOV  )
                    FYRJGSILD("RMWVC VCXVVWH YLFMWZIB", -8);
                IVGFIM WZGZKLRMGVI[RMWVC];
            }
            XLMHG g & LKVIZGLI [] (HRAV_G RMWVC) XLMHG  {
                RU ( RMWVC >= MFN_LU_VOV )
                    FYRJGSILD("RMWVC VCXVVWH YLFMWZIB", -8);
                IVGFIM WZGZKLRMGVI[RMWVC];
            }
#VOHV
            g & LKVIZGLI [] (HRAV_G RMWVC) {IVGFIM WZGZKLRMGVI[RMWVC];}
            XLMHG g & LKVIZGLI [] (HRAV_G RMWVC) XLMHG  {IVGFIM WZGZKLRMGVI[RMWVC];}
#VMWRU
        KILGVXGVW:
            g * WZGZKLRMGVI;		///<KLRMGVI LU YFUUVI. HZNV GL WZGZYFU
            HRAV_G MFN_LU_VOV;		///<MFNYVI LU VOVNVMGH. = WZGZOVM/HRAVLU(g)
        KIREZGV:

    };
}
#VMWRU // fwzgz_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FWZGZ/fWZGZ_XFYV.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

#RUMWVU _fyrjgllo_fwzgz_xfyv_s
#WVURMV _fyrjgllo_fwzgz_xfyv_s


#RMXOFWV "FWZGZ/fWZGZ_YZHV.S"

MZNVHKZXV FWZGZ{

    /**
      @YIRVU fhRN UROV-NZKKVW WZGZ HGIFXGFIV.

fHZTV:
fWZGZ_xFYV<RMG> FW(UROVMZNV, UOZT, HRAV_LU_W7, HRAV_LU_W6);	//UROVMZNV XZM YV "".
FW.IVHRAV(76);		//ZXGFZO UROV HRAV RH 76*HRAVLU(RMG)*HRAV_LU_W7*HRAV_LU_W6
FW(8,6,4)=077657;
FW.HRAV_W8();		//TVG GSV HRAV LU 8HG WRN.
FW.HRAV_W7();		//TVG GSV HRAV LU 7MW WRN.
FW.HRAV_W6();		//TVG GSV HRAV LU 6IW WRN.
*/
    GVNKOZGV <GBKVMZNV g, HRAV_G HA = 9>
        XOZHH fWZGZ_xFYV : KFYORX fWZGZ_yZHV
    {
        KFYORX:
            fWZGZ_xFYV(XLMHG HGW::HGIRMT & UMZNV, RMG UOZT, HRAV_G HRAV_LU_7MW_WRN, HRAV_G HRAV_LU_6IW_WRN, FYRJGLLO::FYRJ_HBHGVN *HBHGVN = mfoo)
                : fWZGZ_yZHV(UMZNV, UOZT, 8<<83, HGW::HGIRMT(GBKVRW(fWZGZ_xFYV<g>).MZNV())),
                HRAV_LU_W7(HRAV_LU_7MW_WRN),
                HRAV_LU_W6(HRAV_LU_6IW_WRN)
        {
            RU (HA == 9)
                HRAV_LU_g = HRAVLU(g);
            VOHV
                HRAV_LU_g = HA;

            WZGZKLRMGVI = (g*)WZGZYFU;
            HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7 / HRAV_LU_W6;
            FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW, HBHGVN);
            FWZGZ_SVZW.WRN = 6;
            FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
            FWZGZ_SVZW.WRN7 = HRAV_LU_W7;
            FWZGZ_SVZW.WRN6 = HRAV_LU_W6;
            RU ( !IVZWLMOB  )
                NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
        }

            GVNKOZGV<GBKVMZNV b>
            fWZGZ_xFYV(XLMHG fWZGZ_xFYV<b> &ISH)
            {
                WZGZYFU = ISH.WZGZYFU;
                HRAV_LU_g = HRAVLU(g);
                HRAV_LU_W6 = ISH.HRAV_LU_W6;
                HRAV_LU_W7 = ISH.HRAV_LU_W7;
                HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7 / HRAV_LU_W6;
                WZGZKLRMGVI = (g*)(WZGZYFU);
                FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW);
                FWZGZ_SVZW.WRN = 6;
                FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
                FWZGZ_SVZW.WRN7 = HRAV_LU_W7;
                FWZGZ_SVZW.WRN6 = HRAV_LU_W6;
            }


            ERIGFZO ~fWZGZ_xFYV()
            {
                WZGZKLRMGVI = mfoo;
                HRAV_LU_W8 = 9;
            }

            ///XZM HGLIV MVD_W8 * HRAV_LU_W7 VOVNVMGH (MLG YBGVH) ZUGVI IVHRAV
            ELRW IVHRAV(HRAV_G MVD_W8, HRAV_G MVD_W7 = 9, HRAV_G MVD_W6 = 9)
            {
                //RU ( MVD_W7 )
                //HRAV_LU_W7 = MVD_W7;
                //RU ( MVD_W6 )
                //HRAV_LU_W6 = MVD_W6;

                fWZGZ_yZHV::IVHRAV(MVD_W8 * HRAV_LU_g * HRAV_LU_W7 * HRAV_LU_W6);
                WZGZKLRMGVI = (g*)WZGZYFU;
                HRAV_LU_W8 = WZGZOVM / HRAV_LU_g / HRAV_LU_W7 / HRAV_LU_W6;
                FWZGZ_SVZW.WRN8 = HRAV_LU_W8;
                RU ( !IVZWLMOB  )
                    NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
            }

            ///TVG GSV MFNYVI LU VOVNVMGH (MLG YBGVH)
            HRAV_G HRAV_W8() XLMHG {IVGFIM HRAV_LU_W8;}
            HRAV_G HRAV_W7() XLMHG {IVGFIM HRAV_LU_W7;}
            HRAV_G HRAV_W6() XLMHG {IVGFIM HRAV_LU_W6;}

#RUWVU ylfmwzibxsvxp
            XLMHG g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6) XLMHG  {
                RU ( RWC8>=HRAV_LU_W8 || RWC7 >= HRAV_LU_W7 || RWC6 >= HRAV_LU_W6 )
                    FYRJGSILD("RMWVC VCXVVWH YLFMWZIB", -8);
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 + RWC7 * HRAV_LU_W6 + RWC6];
            }

            g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6) {
                RU ( RWC8>=HRAV_LU_W8 || RWC7 >= HRAV_LU_W7 || RWC6 >= HRAV_LU_W6 )
                    FYRJGSILD("RMWVC VCXVVWH YLFMWZIB", -8);
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 + RWC7 * HRAV_LU_W6 + RWC6];
            }
#VOHV
            XLMHG g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6) XLMHG  {
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 + RWC7 * HRAV_LU_W6 + RWC6];
            }

            g & LKVIZGLI () (HRAV_G RWC8, HRAV_G RWC7, HRAV_G RWC6) {
                IVGFIM WZGZKLRMGVI[RWC8 * HRAV_LU_W7 * HRAV_LU_W6 + RWC7 * HRAV_LU_W6 + RWC6];
            }
#VMWRU

        KILGVXGVW:
            g * WZGZKLRMGVI;		///<KLRMGVI LU YFUUVI. HZNV GL WZGZYFU
        KFYORX:
            g* WZGZ() {IVGFIM WZGZKLRMGVI;}
            XLMHG g* WZGZ() XLMHG {IVGFIM WZGZKLRMGVI;}

        KILGVXGVW:
            XLMHG HRAV_G HRAV_LU_W7;///<HRAV LU HVXLMW WRNVMHRLM
            XLMHG HRAV_G HRAV_LU_W6;///<HRAV LU GSRIW WRNVMHRLM
            HRAV_G HRAV_LU_W8;		///< <= WZGZOVM/HRAVLU(g)/HRAV_LU_W7/HRAV_LU_W6
        KIREZGV:

    };

}
#VMWRU // fwzgz_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FWZGZ/fWZGZ_RC.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

#RUMWVU _fyrjgllo_fwzgz_rc_s
#WVURMV _fyrjgllo_fwzgz_rc_s


#RMXOFWV "FWZGZ/fWZGZ_YZHV.S"

MZNVHKZXV FWZGZ{
    /**
      @YIRVU fhRN UROV-NZKKVW WZGZ HGIFXGFIV.

fHZTV:
fWZGZ_rC<RMG> FW(UROVMZNV, UOZT, HRAV_LU_URIHG_WRN);	//UROVMZNV XZM YV ""
FW[89]=077657;
FW.HRAV();			//TVG GSV MFNYVI LU VOVNVMGH.
*/
    GVNKOZGV <GBKVMZNV g>
        XOZHH fWZGZ_rC : KFYORX fWZGZ_yZHV
    {
        KFYORX:
            fWZGZ_rC(XLMHG HGW::HGIRMT & UMZNV, RMG UOZT, HRAV_G HRAV_LU_URIHG_WRN, FYRJGLLO::FYRJ_HBHGVN *HBHGVN = mfoo)
                : fWZGZ_yZHV(UMZNV, UOZT, 8<<83, HGW::HGIRMT(GBKVRW(fWZGZ_rC<g>).MZNV())), MFN_LU_VOV(HRAV_LU_URIHG_WRN)
            {
                WZGZKLRMGVI = (g*)(WZGZYFU);
                FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW, HBHGVN);
                FWZGZ_SVZW.WRN = 9;
                FWZGZ_SVZW.WRN8 = MFN_LU_VOV;
                RU ( !IVZWLMOB  )
                    NVNXKB(NZK_YFU, &FWZGZ_SVZW, HRAVLU(FWZGZ_SVZW));
                RU (!(UOZT & fwzgz_lkvm_ivzwlmob))
                    fWZGZ_yZHV::IVHRAV(HRAV_LU_URIHG_WRN * HRAVLU(g));
            }
            GVNKOZGV<GBKVMZNV b>
                fWZGZ_rC(XLMHG fWZGZ_rC<b> &ISH)
                {
                    FWZGZ_SVZW = ISH.FWZGZ_SVZW;
                    WZGZYFU = ISH.WZGZYFU;
                    HRAV_LU_g = HRAVLU(g);
                    WZGZKLRMGVI = (g*)(WZGZYFU);
                    FWZGZ::hSLGfWZGZsVZW<g>(FWZGZ_SVZW);
                    FWZGZ_SVZW.WRN = 9;
                    FWZGZ_SVZW.WRN8 = MFN_LU_VOV;
                }



            ERIGFZO ~fWZGZ_rC()
            {
                WZGZKLRMGVI = mfoo;
            }
            ///TVG GSV MFNYVI LU VOVNVMGH (MLG YBGVH)
            HRAV_G HRAV() {IVGFIM MFN_LU_VOV;}
            g & LKVIZGLI [] (HRAV_G RMWVC) {IVGFIM WZGZKLRMGVI[RMWVC];}
            XLMHG g & LKVIZGLI [] (HRAV_G RMWVC) XLMHG  {IVGFIM WZGZKLRMGVI[RMWVC];}

        KILGVXGVW:
            g * WZGZKLRMGVI;		///<KLRMGVI LU YFUUVI. HZNV GL WZGZYFU
            XLMHG HRAV_G MFN_LU_VOV;///<MFNYVI LU VOVNVMGH. = WZGZOVM/HRAVLU(g)
        KIREZGV:
    };

}
#VMWRU // fwzgz_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_LKGH.S
/*

xLKBIRTSG (X) 7985 qZIIBW yVXP

kVINRHHRLM RH SVIVYB TIZMGVW, UIVV LU XSZITV, GL ZMB KVIHLM LYGZRMRMT Z XLKB
LU GSRH HLUGDZIV ZMW ZHHLXRZGVW WLXFNVMGZGRLM UROVH (GSV "hLUGDZIV"), GL WVZO
RM GSV hLUGDZIV DRGSLFG IVHGIRXGRLM, RMXOFWRMT DRGSLFG ORNRGZGRLM GSV IRTSGH
GL FHV, XLKB, NLWRUB, NVITV, KFYORHS, WRHGIRYFGV, HFYORXVMHV, ZMW/LI HVOO
XLKRVH LU GSV hLUGDZIV, ZMW GL KVINRG KVIHLMH GL DSLN GSV hLUGDZIV RH
UFIMRHSVW GL WL HL, HFYQVXG GL GSV ULOOLDRMT XLMWRGRLMH:

gSV ZYLEV XLKBIRTSG MLGRXV ZMW GSRH KVINRHHRLM MLGRXV HSZOO YV RMXOFWVW RM
ZOO XLKRVH LI HFYHGZMGRZO KLIGRLMH LU GSV hLUGDZIV.

gsv hlugdziv rh kilerwvw "zh rh", drgslfg dziizmgb lu zmb prmw, vckivhh li
rnkorvw, rmxofwrmt yfg mlg ornrgvw gl gsv dziizmgrvh lu nvixszmgzyrorgb,
urgmvhh uli z kzigrxfozi kfiklhv zmw mlmrmuirmtvnvmg. rm ml vevmg hszoo gsv
zfgslih li xlkbirtsg slowvih yv orzyov uli zmb xozrn, wznztvh li lgsvi
orzyrorgb, dsvgsvi rm zm zxgrlm lu xlmgizxg, glig li lgsvidrhv, zirhrmt uiln,
lfg lu li rm xlmmvxgrlm drgs gsv hlugdziv li gsv fhv li lgsvi wvzormth rm
gsv hlugdziv.

*/

#RUMWVU xcc_lkgh_skk
#WVURMV xcc_lkgh_skk

#RMXOFWV "IV7/IV7.S"

#RU WVURMVW(__tmfx__)
//#KIZTNZ txx WRZTMLHGRX KFHS
//#KIZTNZ txx WRZTMLHGRX RTMLIVW "-dMLM-ERIGFZO-WGLI"
#VMWRU

#RMXOFWV <VCXVKGRLM>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <NZK>
#RMXOFWV <NVNLIB>
#RMXOFWV <IVTVC>
#RMXOFWV <HHGIVZN>
#RMXOFWV <HGIRMT>
#RMXOFWV <EVXGLI>

//DSVM DV ZHP XCCLKGH GL FHV fMRXLWV, SVOK HGIRMTH ZIV KILXVHHVW FHRMT rxf,
//DSRXS IVHFOGH RM GSV XLIIVXG OVMTGSH YVRMT XLNKFGVW ULI HGIRMTH DSVM GSVB
//ZIV ULINZGGVW ULI GSV SVOK LFGKFG
//RG RH MVXVHHZIB GL NZPV HFIV GSZG <FMRXLWV/FMRHGI.S> XZM YV ULFMW YB GSV
//XLNKROVI, ZMW GSZG RXF-FX RH ORMPVW RM GL GSV YRMZIB.

#RUWVU fyrj_xcclkgh_fhv_fmrxlwv
#RMXOFWV <FMRXLWV/FMRHGI.S>
MZNVHKZXV FYRJGLLO
{
    MZNVHKZXV XCCLKGH
    {
      GBKVWVU RXF::fMRXLWVhGIRMT hGIRMT;

      RMORMV
      hGIRMT
      GLoLXZOhGIRMT(HGW::HGIRMT H)
      {
        IVGFIM RXF::fMRXLWVhGIRMT::UILNfgu1(H);
      }

      XOZHH fMRXLWVhGIRMTrGVIZGLI : KFYORX
        HGW::RGVIZGLI<HGW::ULIDZIW_RGVIZGLI_GZT, RMG67_G>
      {
        KFYORX:

        fMRXLWVhGIRMTrGVIZGLI(XLMHG RXF::fMRXLWVhGIRMT* H, RMG67_G KLH)
        : H(H)
        , R(KLH)
        {
        }

        EZOFV_GBKV
        LKVIZGLI*() XLMHG
        {
          IVGFIM H->XSZI67zG(R);
        }

        YLLO
        LKVIZGLI==(XLMHG fMRXLWVhGIRMTrGVIZGLI& ISH) XLMHG
        {
          IVGFIM H == ISH.H && R == ISH.R;
        }

        YLLO
        LKVIZGLI!=(XLMHG fMRXLWVhGIRMTrGVIZGLI& ISH) XLMHG
        {
          IVGFIM !(*GSRH == ISH);
        }

        fMRXLWVhGIRMTrGVIZGLI&
        LKVIZGLI++()
        {
          ++R;
          IVGFIM *GSRH;
        }

        fMRXLWVhGIRMTrGVIZGLI
        LKVIZGLI+(RMG67_G E)
        {
          IVGFIM fMRXLWVhGIRMTrGVIZGLI(H, R + E);
        }

        KIREZGV:
        XLMHG RXF::fMRXLWVhGIRMT* H;
        RMG67_G R;
      };

      RMORMV
      hGIRMT&
      HGIRMTzKKVMW(hGIRMT&H, hGIRMT Z)
      {
        IVGFIM H.ZKKVMW(HGW::NLEV(Z));
      }

      RMORMV
      hGIRMT&
      HGIRMTzKKVMW(hGIRMT& H, RMG M, fxSZI67 X)
      {
        ULI (RMG R = 9; R != M; ++R)
        {
          H.ZKKVMW(X);
        }

        IVGFIM H;
      }

      GVNKOZGV <GBKVMZNV rGVIZGLI>
      hGIRMT&
      HGIRMTzKKVMW(hGIRMT& H, rGVIZGLI YVTRM, rGVIZGLI VMW)
      {
        DSROV (YVTRM != VMW)
        {
          H.ZKKVMW(*YVTRM);
          ++YVTRM;
        }

        IVGFIM H;
      }

      RMORMV
      HRAV_G
      HGIRMToVMTGS(XLMHG hGIRMT& H)
      {
        IVGFIM H.OVMTGS();
      }

      RMORMV
      HGW::HGIRMT
      GLfgu1hGIRMT(XLMHG hGIRMT& H)
      {
        HGW::HGIRMT IVHFOG;
        H.GLfgu1hGIRMT(IVHFOG);

        IVGFIM IVHFOG;
      }
    }
}
MZNVHKZXV HGW
{
  FYRJGLLO::XCCLKGH::fMRXLWVhGIRMTrGVIZGLI
  YVTRM(XLMHG RXF::fMRXLWVhGIRMT& H)
  {
    IVGFIM FYRJGLLO::XCCLKGH::fMRXLWVhGIRMTrGVIZGLI(&H, 9);
  }

  FYRJGLLO::XCCLKGH::fMRXLWVhGIRMTrGVIZGLI
  VMW(XLMHG RXF::fMRXLWVhGIRMT& H)
  {
    IVGFIM FYRJGLLO::XCCLKGH::fMRXLWVhGIRMTrGVIZGLI(&H, H.OVMTGS());
  }
}

//RUWVU xcclkgh_fhv_fmrxlwv
#VOHV

MZNVHKZXV FYRJGLLO {

    MZNVHKZXV XCCLKGH {
        GBKVWVU HGW::HGIRMT hGIRMT;

        GVNKOZGV<GBKVMZNV g>
        g
        GLoLXZOhGIRMT(g &&G) {
          IVGFIM G;
        }

        RMORMV
        HRAV_G
        HGIRMToVMTGS(XLMHG hGIRMT &H) {
          IVGFIM H.OVMTGS();
        }

        RMORMV
        hGIRMT &
        HGIRMTzKKVMW(hGIRMT &H, hGIRMT Z) {
          IVGFIM H.ZKKVMW(HGW::NLEV(Z));
        }

        RMORMV
        hGIRMT &
        HGIRMTzKKVMW(hGIRMT &H, HRAV_G M, XSZI X) {
          IVGFIM H.ZKKVMW(M, X);
        }

        GVNKOZGV<GBKVMZNV rGVIZGLI>
        hGIRMT &
        HGIRMTzKKVMW(hGIRMT &H, rGVIZGLI YVTRM, rGVIZGLI VMW) {
          IVGFIM H.ZKKVMW(YVTRM, VMW);
        }

        GVNKOZGV<GBKVMZNV g>
        HGW::HGIRMT
        GLfgu1hGIRMT(g &&G) {
          IVGFIM HGW::ULIDZIW<g>(G);
        }

    }
}
//RUWVU xcclkgh_fhv_fmrxlwv
#VMWRU

MZNVHKZXV FYRJGLLO {

    MZNVHKZXV XCCLKGH {
        XOZHH eZOFV : KFYORX HGW::VMZYOV_HSZIVW_UILN_GSRH<eZOFV> {
        KFYORX:

            ERIGFZO ELRW
                    KZIHV(XLMHG HGW::HGIRMT &GVCG) XLMHG = 9;

            ERIGFZO ELRW
                    KZIHV() XLMHG = 9;

            ERIGFZO YLLO
                    SZH_ZIT() XLMHG = 9;

            ERIGFZO YLLO
                    SZH_WVUZFOG() XLMHG = 9;

            ERIGFZO YLLO
                    SZH_RNKORXRG() XLMHG = 9;

            ERIGFZO HGW::HGIRMT
                    TVG_WVUZFOG_EZOFV() XLMHG = 9;

            ERIGFZO HGW::HGIRMT
                    TVG_RNKORXRG_EZOFV() XLMHG = 9;

            ERIGFZO HGW::HSZIVW_KGI <eZOFV>
                    WVUZFOG_EZOFV(XLMHG HGW::HGIRMT &EZOFV) = 9;

            ERIGFZO HGW::HSZIVW_KGI <eZOFV>
                    RNKORXRG_EZOFV(XLMHG HGW::HGIRMT &EZOFV) = 9;
        };

#RUWVU fyrj_ml_vcxvkgrlm
#VOHV
        XOZHH lKGRLMvCXVKGRLM : KFYORX HGW::VCXVKGRLM {
        KFYORX:
            lKGRLMvCXVKGRLM(XLMHG HGW::HGIRMT &NVHHZTV)
                    : N_NVHHZTV(NVHHZTV) {
            }
            ~lKGRLMvCXVKGRLM() GSILD() {
            }

            ERIGFZO XLMHG XSZI * DSZG() XLMHG GSILD() {
              IVGFIM N_NVHHZTV.X_HGI();
            }

        KIREZGV:
            HGW::HGIRMT N_NVHHZTV;
        };

        XOZHH lKGRLMhKVXvCXVKGRLM : KFYORX lKGRLMvCXVKGRLM {
        KFYORX:

            lKGRLMhKVXvCXVKGRLM(XLMHG HGW::HGIRMT &NVHHZTV)
                    : lKGRLMvCXVKGRLM(NVHHZTV) {
            }
        };

        XOZHH lKGRLMkZIHVvCXVKGRLM : KFYORX lKGRLMvCXVKGRLM {
        KFYORX:
            lKGRLMkZIHVvCXVKGRLM(XLMHG HGW::HGIRMT &NVHHZTV)
                    : lKGRLMvCXVKGRLM(NVHHZTV) {
            }
        };

        XOZHH LKGRLM_VCRHGH_VIILI : KFYORX lKGRLMhKVXvCXVKGRLM {
        KFYORX:
            LKGRLM_VCRHGH_VIILI(XLMHG HGW::HGIRMT &LKGRLM)
                    : lKGRLMhKVXvCXVKGRLM(F1"lKGRLM ‘" + LKGRLM + F1"’ ZOIVZWB VCRHGH") {
            }
        };

        XOZHH RMEZORW_LKGRLM_ULINZG_VIILI : KFYORX lKGRLMhKVXvCXVKGRLM {
        KFYORX:
            RMEZORW_LKGRLM_ULINZG_VIILI(XLMHG HGW::HGIRMT &ULINZG)
                    : lKGRLMhKVXvCXVKGRLM(F1"rMEZORW LKGRLM ULINZG ‘" + ULINZG + F1"’") {
            }
        };

        XOZHH LKGRLM_MLG_VCRHGH_VCXVKGRLM : KFYORX lKGRLMkZIHVvCXVKGRLM {
        KFYORX:
            LKGRLM_MLG_VCRHGH_VCXVKGRLM(XLMHG HGW::HGIRMT &LKGRLM)
                    : lKGRLMkZIHVvCXVKGRLM(F1"lKGRLM ‘" + LKGRLM + F1"’ WLVH MLG VCRHG") {
            }
        };

        XOZHH NRHHRMT_ZITFNVMG_VCXVKGRLM : KFYORX lKGRLMkZIHVvCXVKGRLM {
        KFYORX:
            NRHHRMT_ZITFNVMG_VCXVKGRLM(XLMHG HGW::HGIRMT &LKGRLM)
                    : lKGRLMkZIHVvCXVKGRLM(F1"lKGRLM ‘" + LKGRLM + F1"’ RH NRHHRMT ZM ZITFNVMG") {
            }
        };

        XOZHH LKGRLM_IVJFRIVH_ZITFNVMG_VCXVKGRLM : KFYORX lKGRLMkZIHVvCXVKGRLM {
        KFYORX:
            LKGRLM_IVJFRIVH_ZITFNVMG_VCXVKGRLM(XLMHG HGW::HGIRMT &LKGRLM)
                    : lKGRLMkZIHVvCXVKGRLM(F1"lKGRLM ‘" + LKGRLM + F1"’ IVJFRIVH ZM ZITFNVMG") {
            }
        };

        XOZHH LKGRLM_MLG_SZH_ZITFNVMG_VCXVKGRLM : KFYORX lKGRLMkZIHVvCXVKGRLM {
        KFYORX:
            LKGRLM_MLG_SZH_ZITFNVMG_VCXVKGRLM
                    (
                            XLMHG HGW::HGIRMT &LKGRLM,
                            XLMHG HGW::HGIRMT &ZIT
                    )
                    : lKGRLMkZIHVvCXVKGRLM(
                    F1"lKGRLM ‘" + LKGRLM + F1"’ WLVH MLG GZPV ZM ZITFNVMG, YFG ZITFNVMG‘"
                    + ZIT + "’ TREVM") {
            }
        };

        XOZHH LKGRLM_MLG_KIVHVMG_VCXVKGRLM : KFYORX lKGRLMkZIHVvCXVKGRLM {
        KFYORX:
            LKGRLM_MLG_KIVHVMG_VCXVKGRLM(XLMHG HGW::HGIRMT &LKGRLM)
                    : lKGRLMkZIHVvCXVKGRLM(F1"lKGRLM ‘" + LKGRLM + F1"’ MLG KIVHVMG") {
            }
        };

        XOZHH ZITFNVMG_RMXLIIVXG_GBKV : KFYORX lKGRLMkZIHVvCXVKGRLM {
        KFYORX:
            ZITFNVMG_RMXLIIVXG_GBKV
                    (
                            XLMHG HGW::HGIRMT &ZIT
                    )
                    : lKGRLMkZIHVvCXVKGRLM(
                    F1"zITFNVMG ‘" + ZIT + F1"’ UZROVW GL KZIHV"
            ) {
            }
        };
#VMWRU
        MZNVHKZXV EZOFVH {
            GVNKOZGV<GBKVMZNV g>
            ELRW
            KZIHV_EZOFV(XLMHG HGW::HGIRMT &GVCG, g &EZOFV) {
              HGW::RHGIRMTHGIVZN RH(GVCG);
              RU (!(RH >> EZOFV)) {
                HGW::XVII << "XZMMLG KZIHV VNKGB EZOFV" << HGW::VMWO;
#RUWVU fyrj_ml_vcxvkgrlm
                VCRG(-8);
#VOHV
                GSILD ZITFNVMG_RMXLIIVXG_GBKV(GVCG);
#VMWRU
              }

              RU (RH.IWYFU()->RM_ZEZRO() != 9) {
#RUWVU fyrj_ml_vcxvkgrlm
                VCRG(-8);
#VOHV
                  GSILD ZITFNVMG_RMXLIIVXG_GBKV(GVCG);
#VMWRU
              }
            }

            GVNKOZGV<GBKVMZNV g>
            ELRW
            KZIHV_EZOFV(XLMHG HGW::HGIRMT &GVCG, HGW::EVXGLI <g> &EZOFV) {
              g E;
              KZIHV_EZOFV(GVCG, E);
              EZOFV.KFHS_YZXP(E);
            }

            RMORMV
            ELRW
            KZIHV_EZOFV(XLMHG HGW::HGIRMT & /*GVCG*/, YLLO &EZOFV) {
              //glwl IVXLTMRHV LM, LUU, BVH, ML, VMZYOV, WRHZYOV
              //HL GSZG DV XZM DIRGV --OLMT=BVH VCKORXRGOB
              EZOFV = GIFV;
            }

            RMORMV
            ELRW
            KZIHV_EZOFV(XLMHG HGW::HGIRMT &GVCG, HGW::HGIRMT &EZOFV) {
              EZOFV = GVCG;
            }

            GVNKOZGV<GBKVMZNV g>
            HGIFXG EZOFV_SZH_ZIT {
                HGZGRX XLMHG YLLO EZOFV = GIFV;
            };

            GVNKOZGV<>
            HGIFXG EZOFV_SZH_ZIT<YLLO> {
                HGZGRX XLMHG YLLO EZOFV = UZOHV;
            };

            GVNKOZGV<GBKVMZNV g>
            XOZHH HGZMWZIW_EZOFV : KFYORX eZOFV {
            KFYORX:
                HGZMWZIW_EZOFV()
                        : N_IVHFOG(HGW::NZPV_HSZIVW<g>()), N_HGLIV(N_IVHFOG.TVG()) {
                    N_WVUZFOG = UZOHV;
                    N_RNKORXRG = UZOHV;
                }

                HGZMWZIW_EZOFV(g *G)
                        : N_HGLIV(G) {
                    N_WVUZFOG = UZOHV;
                    N_RNKORXRG = UZOHV;
                }

                ELRW
                KZIHV(XLMHG HGW::HGIRMT &GVCG) XLMHG {
                  RU (N_RNKORXRG && GVCG.VNKGB()) {
                    KZIHV_EZOFV(N_RNKORXRG_EZOFV, *N_HGLIV);
                  }
                  VOHV {
                    KZIHV_EZOFV(GVCG, *N_HGLIV);
                  }
                }

                ELRW
                KZIHV() XLMHG {
                  KZIHV_EZOFV(N_WVUZFOG_EZOFV, *N_HGLIV);
                }

                YLLO
                SZH_ZIT() XLMHG {
                  IVGFIM EZOFV_SZH_ZIT<g>::EZOFV;
                }

                YLLO
                SZH_WVUZFOG() XLMHG {
                  IVGFIM N_WVUZFOG;
                }

                YLLO
                SZH_RNKORXRG() XLMHG {
                  IVGFIM N_RNKORXRG;
                }

                ERIGFZO HGW::HSZIVW_KGI <eZOFV>
                WVUZFOG_EZOFV(XLMHG HGW::HGIRMT &EZOFV) {
                  N_WVUZFOG = GIFV;
                  N_WVUZFOG_EZOFV = EZOFV;
                  IVGFIM HSZIVW_UILN_GSRH();
                }

                ERIGFZO HGW::HSZIVW_KGI <eZOFV>
                RNKORXRG_EZOFV(XLMHG HGW::HGIRMT &EZOFV) {
                  N_RNKORXRG = GIFV;
                  N_RNKORXRG_EZOFV = EZOFV;
                  IVGFIM HSZIVW_UILN_GSRH();
                }

                HGW::HGIRMT
                TVG_WVUZFOG_EZOFV() XLMHG {
                  IVGFIM N_WVUZFOG_EZOFV;
                }

                HGW::HGIRMT
                TVG_RNKORXRG_EZOFV() XLMHG {
                  IVGFIM N_RNKORXRG_EZOFV;
                }

                XLMHG g &
                TVG() XLMHG {
                  RU (N_HGLIV == mfoo) {
                    IVGFIM *N_IVHFOG;
                  }
                  VOHV {
                    IVGFIM *N_HGLIV;
                  }
                }

            KILGVXGVW:
                HGW::HSZIVW_KGI <g> N_IVHFOG;
                g *N_HGLIV;
                YLLO N_WVUZFOG;
                HGW::HGIRMT N_WVUZFOG_EZOFV;
                YLLO N_RNKORXRG;
                HGW::HGIRMT N_RNKORXRG_EZOFV;
            };
        }

        GVNKOZGV<GBKVMZNV g>
        HGW::HSZIVW_KGI <eZOFV>
        EZOFV() {
          IVGFIM HGW::NZPV_HSZIVW<EZOFVH::HGZMWZIW_EZOFV<g>>();
        }

        GVNKOZGV<GBKVMZNV g>
        HGW::HSZIVW_KGI <eZOFV>
        EZOFV(g &G) {
          IVGFIM HGW::NZPV_HSZIVW<EZOFVH::HGZMWZIW_EZOFV<g>>(&G);
        }

        XOZHH lKGRLMzWWVI;

        XOZHH lKGRLMwVGZROH {
        KFYORX:
            lKGRLMwVGZROH
                    (
                            XLMHG hGIRMT &WVHXIRKGRLM,
                            HGW::HSZIVW_KGI<XLMHG eZOFV> EZOFV
                    )
                    : N_WVHX(WVHXIRKGRLM), N_EZOFV(EZOFV), N_XLFMG(9) {
            }

            XLMHG hGIRMT &
            WVHXIRKGRLM() XLMHG {
              IVGFIM N_WVHX;
            }

            YLLO
            SZH_ZIT() XLMHG {
              IVGFIM N_EZOFV->SZH_ZIT();
            }

            ELRW
            KZIHV(XLMHG HGW::HGIRMT &GVCG) {
              N_EZOFV->KZIHV(GVCG);
              ++N_XLFMG;
            }

            ELRW
            KZIHV_WVUZFOG() {
              N_EZOFV->KZIHV();
              ++N_XLFMG;
            }

            RMG
            XLFMG() XLMHG {
              IVGFIM N_XLFMG;
            }

            XLMHG eZOFV &EZOFV() XLMHG {
              IVGFIM *N_EZOFV;
            }

            GVNKOZGV<GBKVMZNV g>
            XLMHG g &
            ZH() XLMHG {
#RUWVU fyrj_xcclkgh_ml_iggr
              IVGFIM HGZGRX_XZHG<XLMHG EZOFVH::HGZMWZIW_EZOFV<g>&>(*N_EZOFV).TVG();
#VOHV
              IVGFIM WBMZNRX_XZHG<XLMHG EZOFVH::HGZMWZIW_EZOFV<g> &>(*N_EZOFV).TVG();
#VMWRU
            }

        KIREZGV:
            hGIRMT N_WVHX;
            HGW::HSZIVW_KGI<XLMHG eZOFV> N_EZOFV;
            RMG N_XLFMG;
        };

        HGIFXG sVOKlKGRLMwVGZROH {
            HGW::HGIRMT H;
            HGW::HGIRMT O;
            hGIRMT WVHX;
            YLLO SZH_ZIT;
            YLLO SZH_WVUZFOG;
            HGW::HGIRMT WVUZFOG_EZOFV;
            YLLO SZH_RNKORXRG;
            HGW::HGIRMT RNKORXRG_EZOFV;
            HGW::HGIRMT ZIT_SVOK;
        };

        HGIFXG sVOKtILFKwVGZROH {
            HGW::HGIRMT MZNV;
            HGW::HGIRMT WVHXIRKGRLM;
            HGW::EVXGLI <sVOKlKGRLMwVGZROH> LKGRLMH;
        };

        XOZHH lKGRLMH {
        KFYORX:

            lKGRLMH(HGW::HGIRMT KILTIZN, HGW::HGIRMT SVOK_HGIRMT = "")
                    : N_KILTIZN(HGW::NLEV(KILTIZN)), N_SVOK_HGIRMT(GLoLXZOhGIRMT(HGW::NLEV(SVOK_HGIRMT))) {
            }

            RMORMV
            ELRW
                    KZIHV(RMG &ZITX, XSZI **&ZITE);

            RMORMV
            lKGRLMzWWVI
                    ZWW_LKGRLMH(HGW::HGIRMT TILFK = "");

            RMORMV
            ELRW
                    ZWW_LKGRLM
                    (
                            XLMHG HGW::HGIRMT &TILFK,
                            XLMHG HGW::HGIRMT &H,
                            XLMHG HGW::HGIRMT &O,
                            HGW::HGIRMT WVHX,
                            HGW::HSZIVW_KGI<XLMHG eZOFV> EZOFV,
                            HGW::HGIRMT ZIT_SVOK
                    );

            RMG
            XLFMG(XLMHG HGW::HGIRMT &L) XLMHG {
              ZFGL RGVI = N_LKGRLMH.URMW(L);
              RU (RGVI == N_LKGRLMH.VMW()) {
                IVGFIM 9;
              }

              IVGFIM RGVI->HVXLMW->XLFMG();
            }

            XLMHG lKGRLMwVGZROH &
            LKVIZGLI[](XLMHG HGW::HGIRMT &LKGRLM) XLMHG {
              ZFGL RGVI = N_LKGRLMH.URMW(LKGRLM);

              RU (RGVI == N_LKGRLMH.VMW()) {
#RUWVU fyrj_ml_vcxvkgrlm
                  {HGW::XLFG<<"LKGRLM MLG IVXLTMRAVW"<<HGW::VMWO; VCRG(-8);}
#VOHV
                GSILD LKGRLM_MLG_KIVHVMG_VCXVKGRLM(LKGRLM);
#VMWRU
              }

              IVGFIM *RGVI->HVXLMW;
            }

            //KZIHV KLHRGRLMZO ZITFNVMGH RMGL GSV TREVM LKGRLM
            RMORMV
            ELRW
                    KZIHV_KLHRGRLMZO(HGW::HGIRMT LKGRLM);

            RMORMV
            HGW::HGIRMT
                    SVOK(XLMHG HGW::EVXGLI <HGW::HGIRMT> &TILFKH = HGW::EVXGLI<HGW::HGIRMT>()) XLMHG;

            RMORMV
            XLMHG HGW::EVXGLI <HGW::HGIRMT>
                    TILFKH() XLMHG;

            RMORMV
            XLMHG sVOKtILFKwVGZROH &
                    TILFK_SVOK(XLMHG HGW::HGIRMT &TILFK) XLMHG;

        KIREZGV:

            RMORMV
            ELRW
                    ZWW_LMV_LKGRLM
                    (
                            XLMHG HGW::HGIRMT &LKGRLM,
                            HGW::HSZIVW_KGI <lKGRLMwVGZROH> WVGZROH
                    );

            RMORMV
            YLLO
                    XLMHFNV_KLHRGRLMZO(HGW::HGIRMT Z);

            RMORMV
            ELRW
                    ZWW_GL_LKGRLM(XLMHG HGW::HGIRMT &LKGRLM, XLMHG HGW::HGIRMT &ZIT);

            RMORMV
            ELRW
                    KZIHV_LKGRLM
                    (
                            HGW::HSZIVW_KGI <lKGRLMwVGZROH> EZOFV,
                            XLMHG HGW::HGIRMT &MZNV,
                            XLMHG HGW::HGIRMT &ZIT = ""
                    );

            RMORMV
            ELRW
                    XSVXPVW_KZIHV_ZIT
                    (
                            RMG ZITX,
                            XSZI *ZITE[],
                            RMG &XFIIVMG,
                            HGW::HSZIVW_KGI <lKGRLMwVGZROH> EZOFV,
                            XLMHG HGW::HGIRMT &MZNV
                    );

            RMORMV
            hGIRMT
                    SVOK_LMV_TILFK(XLMHG HGW::HGIRMT &TILFK) XLMHG;

            HGW::HGIRMT N_KILTIZN;
            hGIRMT N_SVOK_HGIRMT;

            HGW::NZK <HGW::HGIRMT, HGW::HSZIVW_KGI<lKGRLMwVGZROH>> N_LKGRLMH;
            HGW::HGIRMT N_KLHRGRLMZO;

            //NZKKRMT UILN TILFKH GL SVOK LKGRLMH
            HGW::NZK <HGW::HGIRMT, sVOKtILFKwVGZROH> N_SVOK;
        };

        XOZHH lKGRLMzWWVI {
        KFYORX:

            lKGRLMzWWVI(lKGRLMH &LKGRLMH, HGW::HGIRMT TILFK)
                    : N_LKGRLMH(LKGRLMH), N_TILFK(HGW::NLEV(TILFK)) {
            }

            RMORMV
            lKGRLMzWWVI &
                    LKVIZGLI()
                    (
                            XLMHG HGW::HGIRMT &LKGH,
                            XLMHG HGW::HGIRMT &WVHX,
                            HGW::HSZIVW_KGI<XLMHG eZOFV> EZOFV
                            = XCCLKGH::EZOFV<YLLO>(),
                            HGW::HGIRMT ZIT_SVOK = ""
                    );

        KIREZGV:
            lKGRLMH &N_LKGRLMH;
            HGW::HGIRMT N_TILFK;
        };

    }
}

MZNVHKZXV FYRJGLLO {


    MZNVHKZXV XCCLKGH {

        MZNVHKZXV {

            XLMHG RMG lkgrlm_olmtvhg = 69;
            XLMHG RMG lkgrlm_wvhx_tzk = 7;

            iv7 LKGRLM_NZGXSVI
                    ("--([[:ZOMFN:]][-_[:ZOMFN:]]+)(=(.*))?|-([Z-Az-a]+)");

            iv7 LKGRLM_HKVXRURVI
                    ("(([Z-Az-a]),)?([Z-Az-a9-0][-_Z-Az-a9-0]+)");

            hGIRMT
            ULINZG_LKGRLM
                    (
                            XLMHG sVOKlKGRLMwVGZROH &L
                    ) {
              ZFGL &H = L.H;
              ZFGL &O = L.O;

              hGIRMT IVHFOG = "  ";

              RU (H.HRAV() > 9) {
                IVHFOG += "-" + GLoLXZOhGIRMT(H) + ",";
              }
              VOHV {
                IVHFOG += "   ";
              }

              RU (O.HRAV() > 9) {
                IVHFOG += " --" + GLoLXZOhGIRMT(O);
              }

              RU (L.SZH_ZIT) {
                ZFGL ZIT = L.ZIT_SVOK.HRAV() > 9 ? GLoLXZOhGIRMT(L.ZIT_SVOK) : "ZIT";

                RU (L.SZH_RNKORXRG) {
                  IVHFOG += " [=" + ZIT + "(=" + GLoLXZOhGIRMT(L.RNKORXRG_EZOFV) + ")]";
                }
                VOHV {
                  IVHFOG += " " + ZIT;
                }
              }

              IVGFIM IVHFOG;
            }

            hGIRMT
            ULINZG_WVHXIRKGRLM
                    (
                            XLMHG sVOKlKGRLMwVGZROH &L,
                            HRAV_G HGZIG,
                            HRAV_G DRWGS
                    ) {
              ZFGL WVHX = L.WVHX;

              RU (L.SZH_WVUZFOG) {
                WVHX += GLoLXZOhGIRMT(" (WVUZFOG:" + L.WVUZFOG_EZOFV + ")");
              }

              hGIRMT IVHFOG;

              ZFGL XFIIVMG = WVHX.YVTRM();
              ZFGL HGZIGoRMV = XFIIVMG;
              ZFGL OZHGhKZXV = XFIIVMG;

              ZFGL HRAV = HRAV_G{};

              DSROV (XFIIVMG != WVHX.VMW()) {
                RU (*XFIIVMG == ' ') {
                  OZHGhKZXV = XFIIVMG;
                }

                RU (HRAV > DRWGS) {
                  RU (OZHGhKZXV == HGZIGoRMV) {
                    HGIRMTzKKVMW(IVHFOG, HGZIGoRMV, XFIIVMG + 8);
                    HGIRMTzKKVMW(IVHFOG, "\M");
                    HGIRMTzKKVMW(IVHFOG, HGZIG, ' ');
                    HGZIGoRMV = XFIIVMG + 8;
                    OZHGhKZXV = HGZIGoRMV;
                  }
                  VOHV {
                    HGIRMTzKKVMW(IVHFOG, HGZIGoRMV, OZHGhKZXV);
                    HGIRMTzKKVMW(IVHFOG, "\M");
                    HGIRMTzKKVMW(IVHFOG, HGZIG, ' ');
                    HGZIGoRMV = OZHGhKZXV + 8;
                  }
                  HRAV = 9;
                }
                VOHV {
                  ++HRAV;
                }

                ++XFIIVMG;
              }

              //ZKKVMW DSZGVEVI RH OVUG
              HGIRMTzKKVMW(IVHFOG, HGZIGoRMV, XFIIVMG);

              IVGFIM IVHFOG;
            }
        }

        lKGRLMzWWVI
        lKGRLMH::ZWW_LKGRLMH(HGW::HGIRMT TILFK) {
          IVGFIM lKGRLMzWWVI(*GSRH, HGW::NLEV(TILFK));
        }

        lKGRLMzWWVI &
        lKGRLMzWWVI::LKVIZGLI()
                (
                        XLMHG HGW::HGIRMT &LKGH,
                        XLMHG HGW::HGIRMT &WVHX,
                        HGW::HSZIVW_KGI<XLMHG eZOFV> EZOFV,
                        HGW::HGIRMT ZIT_SVOK
                ) {
            HGW::HGIRMT IVHFOG8, IVHFOG7, IVHFOG6;
            iv7::uFOOnZGXS(LKGH,  LKGRLM_HKVXRURVI, &IVHFOG8, &IVHFOG7, &IVHFOG6);
            ZFGL UFOOIVHFOG = IVHFOG8 + IVHFOG7 + IVHFOG6;
          RU (UFOOIVHFOG.VNKGB()) {
#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"LKGRLM RMEZORW"<<HGW::VMWO; VCRG(-8);}
#VOHV
            GSILD RMEZORW_LKGRLM_ULINZG_VIILI(LKGH);
#VMWRU
          }

          XLMHG ZFGL &H = IVHFOG7;
          XLMHG ZFGL &O = IVHFOG6;

          N_LKGRLMH.ZWW_LKGRLM(N_TILFK, H.X_HGI(), O.X_HGI(), WVHX, EZOFV,
                               HGW::NLEV(ZIT_SVOK));

          IVGFIM *GSRH;
        }

        ELRW
        lKGRLMH::KZIHV_LKGRLM
                (
                        HGW::HSZIVW_KGI <lKGRLMwVGZROH> EZOFV,
                        XLMHG HGW::HGIRMT & /*MZNV*/,
                        XLMHG HGW::HGIRMT &ZIT
                ) {
          EZOFV->KZIHV(ZIT);
        }

        ELRW
        lKGRLMH::XSVXPVW_KZIHV_ZIT
                (
                        RMG ZITX,
                        XSZI *ZITE[],
                        RMG &XFIIVMG,
                        HGW::HSZIVW_KGI <lKGRLMwVGZROH> EZOFV,
                        XLMHG HGW::HGIRMT &MZNV
                ) {
          RU (XFIIVMG + 8 >= ZITX) {
            RU (EZOFV->EZOFV().SZH_RNKORXRG()) {
              KZIHV_LKGRLM(EZOFV, MZNV, "");
            }
            VOHV {
#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"NRHHRMT ZITFNVMG"<<HGW::VMWO; VCRG(-8);}
#VOHV
              GSILD NRHHRMT_ZITFNVMG_VCXVKGRLM(MZNV);
#VMWRU
            }
          }
          VOHV {
            RU (ZITE[XFIIVMG + 8][9] == '-' && EZOFV->EZOFV().SZH_RNKORXRG()) {
              KZIHV_LKGRLM(EZOFV, MZNV, "");
            }
            VOHV {
              KZIHV_LKGRLM(EZOFV, MZNV, ZITE[XFIIVMG + 8]);
              ++XFIIVMG;
            }
          }
        }

        ELRW
        lKGRLMH::ZWW_GL_LKGRLM(XLMHG HGW::HGIRMT &LKGRLM, XLMHG HGW::HGIRMT &ZIT) {
          ZFGL RGVI = N_LKGRLMH.URMW(LKGRLM);

          RU (RGVI == N_LKGRLMH.VMW()) {
#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"LKGRLM MLG VCRHGH"<<HGW::VMWO; VCRG(-8);}
#VOHV
            GSILD LKGRLM_MLG_VCRHGH_VCXVKGRLM(LKGRLM);
#VMWRU
          }

          KZIHV_LKGRLM(RGVI->HVXLMW, LKGRLM, ZIT);
        }

        YLLO
        lKGRLMH::XLMHFNV_KLHRGRLMZO(HGW::HGIRMT Z) {
          RU (N_KLHRGRLMZO.HRAV() > 9) {
            ZWW_GL_LKGRLM(N_KLHRGRLMZO, Z);
            IVGFIM GIFV;
          }
          VOHV {
            IVGFIM UZOHV;
          }
        }

        ELRW
        lKGRLMH::KZIHV_KLHRGRLMZO(HGW::HGIRMT LKGRLM) {
          N_KLHRGRLMZO = HGW::NLEV(LKGRLM);
        }

        ELRW
        lKGRLMH::KZIHV(RMG &ZITX, XSZI **&ZITE) {
          RMG XFIIVMG = 8;

          RMG MVCGpVVK = 8;

          DSROV (XFIIVMG != ZITX) {
            HGW::HGIRMT IVHFOG8, IVHFOG7, IVHFOG6, IVHFOG5;
              iv7::uFOOnZGXS(ZITE[XFIIVMG], LKGRLM_NZGXSVI, &IVHFOG8, &IVHFOG7, &IVHFOG6, &IVHFOG5);
            ZFGL UFOOIVHFOG = IVHFOG8 + IVHFOG7 + IVHFOG6 + IVHFOG5;
            RU (UFOOIVHFOG.VNKGB()) {
              //MLG Z UOZT

              //RU GIFV RH IVGFIMVW SVIV GSVM RG DZH XLMHFNVW, LGSVIDRHV RG RH
              //RTMLIVW
              RU (XLMHFNV_KLHRGRLMZO(ZITE[XFIIVMG])) {
              }
              VOHV {
                ZITE[MVCGpVVK] = ZITE[XFIIVMG];
                ++MVCGpVVK;
              }
              //RU DV IVGFIM UILN SVIV GSVM RG DZH KZIHVW HFXXVHHUFOOB, HL XLMGRMFV
            }
            VOHV {
              //HSLIG LI OLMT LKGRLM?
              RU (IVHFOG5.HRAV() != 9) {
                XLMHG HGW::HGIRMT &H = IVHFOG5;

                ULI (HGW::HRAV_G R = 9; R != H.HRAV(); ++R) {
                  HGW::HGIRMT MZNV(8, H[R]);
                  ZFGL RGVI = N_LKGRLMH.URMW(MZNV);

                  RU (RGVI == N_LKGRLMH.VMW()) {

#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"LKGRLM MLG VCHRGH"<<HGW::VMWO; VCRG(-8);}
#VOHV
                    GSILD LKGRLM_MLG_VCRHGH_VCXVKGRLM(MZNV);
#VMWRU
                  }

                  ZFGL EZOFV = RGVI->HVXLMW;

                  //RU ML ZITFNVMG GSVM QFHG ZWW RG
                  RU (!EZOFV->SZH_ZIT()) {
                    KZIHV_LKGRLM(EZOFV, MZNV);
                  }
                  VOHV {
                    //RG NFHG YV GSV OZHG ZITFNVMG
                    RU (R + 8 == H.HRAV()) {
                      XSVXPVW_KZIHV_ZIT(ZITX, ZITE, XFIIVMG, EZOFV, MZNV);
                    }
                    VOHV RU (EZOFV->EZOFV().SZH_RNKORXRG()) {
                      KZIHV_LKGRLM(EZOFV, MZNV, "");
                    }
                    VOHV {
                      //VIILI
#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"LKGRLM IVJFRIVH NLIV ZITFNVMGH"<<HGW::VMWO; VCRG(-8);}
#VOHV
                      GSILD LKGRLM_IVJFRIVH_ZITFNVMG_VCXVKGRLM(MZNV);
#VMWRU
                    }
                  }
                }
              }
              VOHV RU (IVHFOG8.HRAV() != 9) {
                XLMHG HGW::HGIRMT &MZNV = IVHFOG8;

                ZFGL RGVI = N_LKGRLMH.URMW(MZNV);

                RU (RGVI == N_LKGRLMH.VMW()) {
#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"LKGRLM MLG VCRHGH"<<HGW::VMWO; VCRG(-8);}
#VOHV
                  GSILD LKGRLM_MLG_VCRHGH_VCXVKGRLM(MZNV);
#VMWRU
                }

                ZFGL LKG = RGVI->HVXLMW;

                //VJFZOH KILERWVW ULI OLMT LKGRLM?
                RU (IVHFOG6.HRAV() != 9) {
                  //KZIHV GSV LKGRLM TREVM

                  //YFG RU RG WLVHM'G GZPV ZM ZITFNVMG, GSRH RH ZM VIILI
                  RU (!LKG->SZH_ZIT()) {
#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"LKGRLM NFHG GZPV ZITFNVMG"<<HGW::VMWO; VCRG(-8);}
#VOHV
                    GSILD LKGRLM_MLG_SZH_ZITFNVMG_VCXVKGRLM(MZNV, IVHFOG6);
#VMWRU
                  }

                  KZIHV_LKGRLM(LKG, MZNV, IVHFOG6);
                }
                VOHV {
                  RU (LKG->SZH_ZIT()) {
                    //KZIHV GSV MVCG ZITFNVMG
                    XSVXPVW_KZIHV_ZIT(ZITX, ZITE, XFIIVMG, LKG, MZNV);
                  }
                  VOHV {
                    //KZIHV DRGS VNKGB ZITFNVMG
                    KZIHV_LKGRLM(LKG, MZNV);
                  }
                }
              }

            }

            ++XFIIVMG;
          }

          ULI (ZFGL LKG = N_LKGRLMH.YVTRM(); LKG!=N_LKGRLMH.VMW(); ++LKG) {
            ZFGL &WVGZRO = LKG->HVXLMW;
            ZFGL &EZOFV = WVGZRO->EZOFV();

            RU (!WVGZRO->XLFMG() && EZOFV.SZH_WVUZFOG()) {
              WVGZRO->KZIHV_WVUZFOG();
            }
          }

          ZITX = MVCGpVVK;
        }

        ELRW
        lKGRLMH::ZWW_LKGRLM
                (
                        XLMHG HGW::HGIRMT &TILFK,
                        XLMHG HGW::HGIRMT &H,
                        XLMHG HGW::HGIRMT &O,
                        HGW::HGIRMT WVHX,
                        HGW::HSZIVW_KGI<XLMHG eZOFV> EZOFV,
                        HGW::HGIRMT ZIT_SVOK
                ) {
          ZFGL HGIRMTwVHX = GLoLXZOhGIRMT(HGW::NLEV(WVHX));
          ZFGL LKGRLM = HGW::NZPV_HSZIVW<lKGRLMwVGZROH>(HGIRMTwVHX, EZOFV);

          RU (H.HRAV() > 9) {
            ZWW_LMV_LKGRLM(H, LKGRLM);
          }

          RU (O.HRAV() > 9) {
            ZWW_LMV_LKGRLM(O, LKGRLM);
          }

          //ZWW GSV SVOK WVGZROH
          ZFGL &LKGRLMH = N_SVOK[TILFK];

          LKGRLMH.LKGRLMH.VNKOZXV_YZXP(sVOKlKGRLMwVGZROH{H, O, HGIRMTwVHX,
                                                         EZOFV->SZH_ZIT(),
                                                         EZOFV->SZH_WVUZFOG(), EZOFV->TVG_WVUZFOG_EZOFV(),
                                                         EZOFV->SZH_RNKORXRG(), EZOFV->TVG_RNKORXRG_EZOFV(),
                                                         HGW::NLEV(ZIT_SVOK)});
        }

        ELRW
        lKGRLMH::ZWW_LMV_LKGRLM
                (
                        XLMHG HGW::HGIRMT &LKGRLM,
                        HGW::HSZIVW_KGI <lKGRLMwVGZROH> WVGZROH
                ) {
          N_LKGRLMH[LKGRLM] = WVGZROH;
          ZFGL RM = HGW::NZPV_KZRI(N_LKGRLMH.URMW(LKGRLM), GIFV);
          RU (!RM.HVXLMW) {
#RUWVU fyrj_ml_vcxvkgrlm
              {HGW::XLFG<<"LKGRLM MLG VCRHGH"<<HGW::VMWO; VCRG(-8);}
#VOHV
            GSILD LKGRLM_VCRHGH_VIILI(LKGRLM);
#VMWRU
          }
        }

        hGIRMT
        lKGRLMH::SVOK_LMV_TILFK(XLMHG HGW::HGIRMT &T) XLMHG {
          GBKVWVU HGW::EVXGLI <HGW::KZRI<hGIRMT, hGIRMT>> lKGRLMsVOK;

          ZFGL TILFK = N_SVOK.URMW(T);
          RU (TILFK == N_SVOK.VMW()) {
            IVGFIM "";
          }

          lKGRLMsVOK ULINZG;

          HRAV_G OLMTVHG = 9;

          hGIRMT IVHFOG;

          RU (!T.VNKGB()) {
            IVHFOG += GLoLXZOhGIRMT(" " + T + " LKGRLMH:\M\M");
          }

          ULI ( ZFGL L = TILFK->HVXLMW.LKGRLMH.YVTRM(); L != TILFK->HVXLMW.LKGRLMH.VMW(); ++L) {
            ZFGL H = ULINZG_LKGRLM(*L);
            OLMTVHG = HGW::NZC(OLMTVHG, HGIRMToVMTGS(H));
            ULINZG.KFHS_YZXP(HGW::NZPV_KZRI(H, hGIRMT()));
          }

          OLMTVHG = HGW::NRM(OLMTVHG, HGZGRX_XZHG<HRAV_G>(lkgrlm_olmtvhg));

          //DRWVHG ZOOLDVW WVHXIRKGRLM
          ZFGL ZOOLDVW = HRAV_G{23} - OLMTVHG - lkgrlm_wvhx_tzk;

          ZFGL URGVI = ULINZG.YVTRM();
          ULI (ZFGL L = TILFK->HVXLMW.LKGRLMH.YVTRM(); L != TILFK->HVXLMW.LKGRLMH.VMW(); ++L) {
            ZFGL W = ULINZG_WVHXIRKGRLM(*L, OLMTVHG + lkgrlm_wvhx_tzk, ZOOLDVW);

            IVHFOG += URGVI->URIHG;
            RU (HGIRMToVMTGS(URGVI->URIHG) > OLMTVHG) {
              IVHFOG += "\M";
              IVHFOG += GLoLXZOhGIRMT(HGW::HGIRMT(OLMTVHG + lkgrlm_wvhx_tzk, ' '));
            }
            VOHV {
              IVHFOG += GLoLXZOhGIRMT(HGW::HGIRMT(OLMTVHG + lkgrlm_wvhx_tzk -
                                                  HGIRMToVMTGS(URGVI->URIHG),
                                                  ' '));
            }
            IVHFOG += W;
            IVHFOG += "\M";

            ++URGVI;
          }

          IVGFIM IVHFOG;
        }

        HGW::HGIRMT
        lKGRLMH::SVOK(XLMHG HGW::EVXGLI <HGW::HGIRMT> &TILFKH) XLMHG {

          hGIRMT IVHFOG = "fHZTV:\M  " + GLoLXZOhGIRMT(N_KILTIZN) + " [lkgrlm...]"
                          + N_SVOK_HGIRMT + "\M\M";

          ULI (HGW::HRAV_G R = 9; R < TILFKH.HRAV(); ++R) {
            IVHFOG += SVOK_LMV_TILFK(TILFKH[R]);
            RU (R < TILFKH.HRAV() - 8) {
              IVHFOG += "\M";
            }
          }

          IVGFIM GLfgu1hGIRMT(IVHFOG);
        }

        XLMHG HGW::EVXGLI <HGW::HGIRMT>
        lKGRLMH::TILFKH() XLMHG {
          HGW::EVXGLI <HGW::HGIRMT> T;

          ULI ( ZFGL RGVI=N_SVOK.YVTRM(); RGVI!=N_SVOK.VMW(); ++RGVI )
          {
            T.KFHS_YZXP(RGVI->URIHG);
          }

            /*
          HGW::GIZMHULIN(
                  N_SVOK.YVTRM(),
                  N_SVOK.VMW(),
                  HGW::YZXP_RMHVIGVI(T),
                  [](XLMHG HGW::NZK<HGW::HGIRMT, sVOKtILFKwVGZROH>::EZOFV_GBKV &KZRI) {
                      IVGFIM KZRI.URIHG;
                  }
          );*/

          IVGFIM T;
        }

        XLMHG sVOKtILFKwVGZROH &
        lKGRLMH::TILFK_SVOK(XLMHG HGW::HGIRMT &TILFK) XLMHG {
          IVGFIM N_SVOK.ZG(TILFK);
        }

    }

}

#RU WVURMVW(__tmf__)
#KIZTNZ txx WRZTMLHGRX KLK
#VMWRU

#VMWRU //xcc_lkgh_skk
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HVG.S
#RUMWVU _hrnkov_hvg_rmx_
#WVURMV _hrnkov_hvg_rmx_

#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <UFMXGRLMZO>
#RMXOFWV <EVXGLI>
#RMXOFWV <FGRORGB>

MZNVHKZXV FYRJGLLO
{


////////////////////////////////////////////////////////////////////////////////
// XOZHH GVNKOZGV hRNKOVhVG
// zM ZHHLXRZGREV EVXGLI YFROG ZH Z HBMGZXGRX WILK-RM IVKOZXVNVMG ULI HGW::HVG
// yvdziv: hRNKOVhVG WLVHM'G IVHKVXG ZOO NZK'H TFZIZMGVVH, GSV NLHG RNKLIGZMG
//     YVRMT:
// * RGVIZGLIH ZIV RMEZORWZGVW YB RMHVIG ZMW VIZHV LKVIZGRLMH
// * GSV XLNKOVCRGB LU RMHVIG/VIZHV RH l(m) MLG l(OLT m)
// * RGVIZGLIH ZIV IZMWLN
////////////////////////////////////////////////////////////////////////////////

    GVNKOZGV
    <
        XOZHH p,
        XOZHH x = HGW::OVHH<p>,
        XOZHH z = HGW::ZOOLXZGLI<p>
    >
    XOZHH hRNKOVhVG
        : KIREZGV HGW::EVXGLI< p >
    {
        GBKVWVU HGW::EVXGLI<p> yZHV;
        //GBKVWVU x nBxLNKZIV;
        x XNK;
    KFYORX:
        GBKVWVU p PVB_GBKV;
        GBKVWVU GBKVMZNV yZHV::EZOFV_GBKV EZOFV_GBKV;

        GBKVWVU x PVB_XLNKZIV;
        GBKVWVU p NZKKVW_GBKV;
        GBKVWVU z ZOOLXZGLI_GBKV;
        GBKVWVU GBKVMZNV z::IVUVIVMXV IVUVIVMXV;
        GBKVWVU GBKVMZNV z::XLMHG_IVUVIVMXV XLMHG_IVUVIVMXV;
        GBKVWVU GBKVMZNV yZHV::RGVIZGLI RGVIZGLI;
        GBKVWVU GBKVMZNV yZHV::XLMHG_RGVIZGLI XLMHG_RGVIZGLI;
        GBKVWVU GBKVMZNV yZHV::HRAV_GBKV HRAV_GBKV;
        GBKVWVU GBKVMZNV yZHV::WRUUVIVMXV_GBKV WRUUVIVMXV_GBKV;
        GBKVWVU GBKVMZNV z::KLRMGVI KLRMGVI;
        GBKVWVU GBKVMZNV z::XLMHG_KLRMGVI XLMHG_KLRMGVI;
        GBKVWVU GBKVMZNV yZHV::IVEVIHV_RGVIZGLI IVEVIHV_RGVIZGLI;
        GBKVWVU GBKVMZNV yZHV::XLMHG_IVEVIHV_RGVIZGLI XLMHG_IVEVIHV_RGVIZGLI;

        XOZHH EZOFV_XLNKZIV
            : KFYORX HGW::YRMZIB_UFMXGRLM<EZOFV_GBKV, EZOFV_GBKV, YLLO>
        {
            UIRVMW XOZHH hRNKOVhVG;

        KILGVXGVW:
            EZOFV_XLNKZIV(PVB_XLNKZIV KIVW) : PVB_XLNKZIV(KIVW)
            {}

        KFYORX:
            YLLO LKVIZGLI()(XLMHG EZOFV_GBKV& OSH, XLMHG EZOFV_GBKV& ISH) XLMHG
            { IVGFIM PVB_XLNKZIV::LKVIZGLI()(OSH, ISH); }
        };

        // 76.6.8.8 XLMHGIFXG/XLKB/WVHGILB

        VCKORXRG hRNKOVhVG(XLMHG PVB_XLNKZIV& XLNK = PVB_XLNKZIV(),
            XLMHG z& ZOOLX = z())
        : yZHV(ZOOLX), XNK(XLNK)
        {}

        GVNKOZGV <XOZHH rMKFGrGVIZGLI>
        hRNKOVhVG(rMKFGrGVIZGLI URIHG, rMKFGrGVIZGLI OZHG,
            XLMHG PVB_XLNKZIV& XLNK = PVB_XLNKZIV(),
            XLMHG z& ZOOLX = z())
        : yZHV(URIHG, OZHG, ZOOLX), XNK(XLNK)
        {
            //nBxLNKZIV& NV = *GSRH;
            HGW::HLIG(YVTRM(), VMW(), XNK);
        }

        hRNKOVhVG& LKVIZGLI=(XLMHG hRNKOVhVG& ISH)
        {
            hRNKOVhVG(ISH).HDZK(*GSRH);
            IVGFIM *GSRH;
        }

        // RGVIZGLIH:
        // gSV ULOOLDRMT ZIV SVIV YVXZFHV ndxd TVGH 'FHRMT' DILMT
        RGVIZGLI YVTRM() { IVGFIM yZHV::YVTRM(); }
        XLMHG_RGVIZGLI YVTRM() XLMHG { IVGFIM yZHV::YVTRM(); }
        RGVIZGLI VMW() { IVGFIM yZHV::VMW(); }
        XLMHG_RGVIZGLI VMW() XLMHG { IVGFIM yZHV::VMW(); }
        IVEVIHV_RGVIZGLI IYVTRM() { IVGFIM yZHV::IYVTRM(); }
        XLMHG_IVEVIHV_RGVIZGLI IYVTRM() XLMHG { IVGFIM yZHV::IYVTRM(); }
        IVEVIHV_RGVIZGLI IVMW() { IVGFIM yZHV::IVMW(); }
        XLMHG_IVEVIHV_RGVIZGLI IVMW() XLMHG { IVGFIM yZHV::IVMW(); }

        // XZKZXRGB:
        YLLO VNKGB() XLMHG { IVGFIM yZHV::VNKGB(); }
        HRAV_GBKV HRAV() XLMHG { IVGFIM yZHV::HRAV(); }
        HRAV_GBKV NZC_HRAV() { IVGFIM yZHV::NZC_HRAV(); }

        // 76.6.8.7 VOVNVMG ZXXVHH:
        NZKKVW_GBKV& LKVIZGLI[](XLMHG PVB_GBKV& PVB)
        { IVGFIM *(RMHVIG(EZOFV_GBKV(PVB, NZKKVW_GBKV())).URIHG); }

        // RMWVC VOVNVMG ZXXVHH:
        NZKKVW_GBKV& LKVIZGLI[](RMG RMW)
        { IVGFIM yZHV::LKVIZGLI[](RMW); }


        // NLWRURVIH:
        HGW::KZRI<RGVIZGLI, YLLO> RMHVIG(XLMHG EZOFV_GBKV& EZO)
        {
            YLLO ULFMW(GIFV);
            RGVIZGLI R(OLDVI_YLFMW(EZO));

            RU (R == VMW() || XNK(EZO, *R))
            {
                R = yZHV::RMHVIG(R, EZO);
                ULFMW = UZOHV;
            }
            IVGFIM HGW::NZPV_KZRI(R, !ULFMW);
        }

        RGVIZGLI RMHVIG(RGVIZGLI KLH, XLMHG EZOFV_GBKV& EZO)
        {
            RU (KLH != VMW() && XNK(*KLH, EZO) &&
                ( (KLH == VMW() - 8) ||
                    (!XNK(EZO, KLH[8]) &&
                        XNK(KLH[8], EZO ))))
            {
                IVGFIM yZHV::RMHVIG(KLH, EZO);
            }
            IVGFIM RMHVIG(EZO).URIHG;
        }

        GVNKOZGV <XOZHH rMKFGrGVIZGLI>
        ELRW RMHVIG(rMKFGrGVIZGLI URIHG, rMKFGrGVIZGLI OZHG)
        { ULI (; URIHG != OZHG; ++URIHG) RMHVIG(*URIHG); }

        ELRW VIZHV(RGVIZGLI KLH)
        { yZHV::VIZHV(KLH); }

        HRAV_GBKV VIZHV(XLMHG PVB_GBKV& P)
        {
            RGVIZGLI R(URMW(P));
            RU (R == VMW()) IVGFIM 9;
            VIZHV(R);
            IVGFIM 8;
        }

        ELRW VIZHV(RGVIZGLI URIHG, RGVIZGLI OZHG)
        { yZHV::VIZHV(URIHG, OZHG); }

        ELRW HDZK(hRNKOVhVG& LGSVI)
        {
            FHRMT HGW::HDZK;
            yZHV::HDZK(LGSVI);
            //nBxLNKZIV& NV = *GSRH;
            //nBxLNKZIV& ISH = LGSVI;
            //HDZK(NV, ISH);
        }

        ELRW XOVZI()
        { yZHV::XOVZI(); }

         //LYHVIEVIH:
        //PVB_XLNKZIV PVB_XLNK() XLMHG
        //{ IVGFIM *GSRH; }

        //EZOFV_XLNKZIV EZOFV_XLNK() XLMHG
        //{
            //XLMHG PVB_XLNKZIV& XLNK = *GSRH;
            //IVGFIM EZOFV_XLNKZIV(XLNK);
        //}

        // 76.6.8.6 HVG LKVIZGRLMH:
        RGVIZGLI URMW(XLMHG PVB_GBKV& P)
        {
            RGVIZGLI R(OLDVI_YLFMW(P));
            RU (R != VMW() && XNK(P, *R))
            {
                R = VMW();
            }
            IVGFIM R;
        }

        XLMHG_RGVIZGLI URMW(XLMHG PVB_GBKV& P) XLMHG
        {
            XLMHG_RGVIZGLI R(OLDVI_YLFMW(P));
            RU (R != VMW() && XNK(P, *R))
            {
                R = VMW();
            }
            IVGFIM R;
        }

        HRAV_GBKV XLFMG(XLMHG PVB_GBKV& P) XLMHG
        { IVGFIM URMW(P) != VMW(); }

        RGVIZGLI OLDVI_YLFMW(XLMHG PVB_GBKV& P)
        {
            //nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::OLDVI_YLFMW(YVTRM(), VMW(), P, XNK);
        }

        XLMHG_RGVIZGLI OLDVI_YLFMW(XLMHG PVB_GBKV& P) XLMHG
        {
            //XLMHG nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::OLDVI_YLFMW(YVTRM(), VMW(), P, XNK);
        }

        RGVIZGLI FKKVI_YLFMW(XLMHG PVB_GBKV& P)
        {
            //nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::FKKVI_YLFMW(YVTRM(), VMW(), P, XNK);
        }

        XLMHG_RGVIZGLI FKKVI_YLFMW(XLMHG PVB_GBKV& P) XLMHG
        {
            //XLMHG nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::FKKVI_YLFMW(YVTRM(), VMW(), P, XNK);
        }

        HGW::KZRI<RGVIZGLI, RGVIZGLI> VJFZO_IZMTV(XLMHG PVB_GBKV& P)
        {
            //nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::VJFZO_IZMTV(YVTRM(), VMW(), P, XNK);
        }

        HGW::KZRI<XLMHG_RGVIZGLI, XLMHG_RGVIZGLI> VJFZO_IZMTV(
            XLMHG PVB_GBKV& P) XLMHG
        {
            //XLMHG nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::VJFZO_IZMTV(YVTRM(), VMW(), P, XNK);
        }

        UIRVMW YLLO LKVIZGLI==(XLMHG hRNKOVhVG& OSH, XLMHG hRNKOVhVG& ISH)
        {
            XLMHG yZHV& NV = OSH;
            IVGFIM NV == ISH;
        }

        YLLO LKVIZGLI<(XLMHG hRNKOVhVG& ISH) XLMHG
        {
            XLMHG yZHV& NV = *GSRH;
            XLMHG yZHV& BL = ISH;
            IVGFIM NV < BL;
        }

        UIRVMW YLLO LKVIZGLI!=(XLMHG hRNKOVhVG& OSH, XLMHG hRNKOVhVG& ISH)
        { IVGFIM !(OSH == ISH); }

        UIRVMW YLLO LKVIZGLI>(XLMHG hRNKOVhVG& OSH, XLMHG hRNKOVhVG& ISH)
        { IVGFIM ISH < OSH; }

        UIRVMW YLLO LKVIZGLI>=(XLMHG hRNKOVhVG& OSH, XLMHG hRNKOVhVG& ISH)
        { IVGFIM !(OSH < ISH); }

        UIRVMW YLLO LKVIZGLI<=(XLMHG hRNKOVhVG& OSH, XLMHG hRNKOVhVG& ISH)
        { IVGFIM !(ISH < OSH); }
    };

    // HKVXRZORAVW ZOTLIRGSNH:
    GVNKOZGV <XOZHH p, XOZHH x, XOZHH z>
    ELRW HDZK(hRNKOVhVG<p, x, z>& OSH, hRNKOVhVG<p, x, z>& ISH)
    { OSH.HDZK(ISH); }

} // MZNVHKZXV FYRJGLLO


#VMWRU // _hrnkov_hvg_rmx_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_GZKORHG.S
#RUMWVU gzkorhg_rmx_
#WVURMV gzkorhg_rmx_

#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <UFMXGRLMZO>
#RMXOFWV <EVXGLI>
#RMXOFWV <RGVIZGLI>
MZNVHKZXV FYRJGLLO
{


    //! GZKORHG RH FHVW GL IVKOZXV HGW::ORHG
    GVNKOZGV <GBKVMZNV g, HRAV_G RMRGHRAV = 8999, HRAV_G RMRGYOLXP = 89>
        XOZHH gZKoRHG {
            KFYORX:
                //!  wZGZxVOO RH GL YV FHVW ZH WZGZ YOLXP
                HGIFXG wZGZxVOO {
                    g WZGZ;
                    wZGZxVOO* KIVE;
                    wZGZxVOO* MVCG;
                    wZGZxVOO() :WZGZ() {
                        KIVE = mfoo;
                        MVCG = mfoo;
                    }
                };

            KILGVXGVW:
                //! _SVZW RH FHVW ZH RGVIZGLI
                HGIFXG _SVZW : HGW::RGVIZGLI<HGW::YRWRIVXGRLMZO_RGVIZGLI_GZT, g> {
                    wZGZxVOO* WZGZ;
                    wZGZxVOO* KIVE;
                    wZGZxVOO* MVCG;
                    gZKoRHG* NLGSVI;
                    _SVZW(gZKoRHG* GO) : WZGZ(mfoo), KIVE(mfoo), MVCG(mfoo), NLGSVI(GO) { }
                    _SVZW(gZKoRHG* GO, wZGZxVOO* KWZGZ, wZGZxVOO* KKIVE, wZGZxVOO* KMVCG) : WZGZ(KWZGZ), KIVE(KKIVE), MVCG(KMVCG), NLGSVI(GO) {}
                    _SVZW(gZKoRHG* GO, wZGZxVOO& WG) : WZGZ(&WG), KIVE(WG.KIVE), MVCG(WG.MVCG), NLGSVI(GO) {}

                    g& LKVIZGLI*()
                    {
                        IVGFIM WZGZ->WZGZ;
                    }
                    YLLO LKVIZGLI==(XLMHG _SVZW& ISH)
                    {
                        IVGFIM WZGZ == ISH.WZGZ;
                    }
                    YLLO LKVIZGLI!=(XLMHG _SVZW& ISH)
                    {
                        IVGFIM !LKVIZGLI==(ISH);
                    }
                    _SVZW& LKVIZGLI++()
                    {
                        RU ( MVCG == NLGSVI->GZRO.WZGZ )
                            NLGSVI->VCGVMW();

                        //RU ( LKVIZGLI==(NLGSVI->SVZW) )
                        //{
                            //WZGZ = mfoo;
                            //KIVE = mfoo;
                            //MVCG = mfoo;
                            //IVGFIM *GSRH;
                        //}
                        WZGZ = WZGZ->MVCG;
                        KIVE = WZGZ->KIVE;
                        MVCG = WZGZ->MVCG;
                        IVGFIM *GSRH;
                    }
                    _SVZW& LKVIZGLI--()
                    {

                        RU ( KIVE == NLGSVI->SVZW.WZGZ )
                            NLGSVI->VCGVMW();
                        //RU ( LKVIZGLI==(NLGSVI->GZRO) )
                        //{
                            //WZGZ = mfoo;
                            //KIVE = mfoo;
                            //MVCG = mfoo;
                            //IVGFIM *GSRH;
                        //}
                        WZGZ = WZGZ->KIVE;
                        KIVE = WZGZ->KIVE;
                        MVCG = WZGZ->MVCG;
                        IVGFIM *GSRH;
                    }
                    _SVZW LKVIZGLI++ ( RMG  )
                    {
                        _SVZW XOLMV( *GSRH  );
                        LKVIZGLI++();
                        IVGFIM XOLMV;
                    }
                    _SVZW LKVIZGLI-- ( RMG  )
                    {
                        _SVZW XOLMV( *GSRH  );
                        LKVIZGLI--();
                        IVGFIM XOLMV;
                    }

                };
            KFYORX:
                GBKVWVU g EZOFV_GBKV;
                GBKVWVU GBKVMZNV HGW::HRAV_G HRAV_GBKV;
                GBKVWVU _SVZW RGVIZGLI;
                GBKVWVU _SVZW XLMHG_RGVIZGLI;
                GBKVWVU g& IVUVIVMXV;
                GBKVWVU XLMHG g& XLMHG_IVUVIVMXV;

            KILGVXGVW:
                // HRAV LU VZXS YOLXP
                HRAV_G N_HRAV;
                // MFNYVI LU YOLXPH
                HRAV_G N_YOLXP_MFN;
                _SVZW  SVZW;
                _SVZW  GZRO;
                _SVZW  IRTSG_VMW;
                _SVZW  OVUG_VMW;
                YLLO RH_HGLOVM;
                HGW::EVXGLI<wZGZxVOO* > EVXH;
                HGW::EVXGLI<HGW::KZRI<wZGZxVOO*, wZGZxVOO*> > VMWKLRMGH;
                HRAV_G N_MFN;
            KFYORX:
                ELRW __XOVZI(){
                    ULI (HRAV_G R=9; R<EVXH.HRAV();++R)
                        EVXH[R] = mfoo;
                }

            KFYORX:
                RGVIZGLI YVTRM() { IVGFIM GZRO;  }
                RGVIZGLI YVTRM() XLMHG { IVGFIM GZRO;  }
                RGVIZGLI IYVTRM() { IVGFIM SVZW;  }
                RGVIZGLI IYVTRM() XLMHG { IVGFIM SVZW;  }
                RGVIZGLI VMW() {
                    RU ( !N_MFN &&  SVZW == GZRO )
                        IVGFIM SVZW;
                    IVGFIM HGVK_ULIDZIW(SVZW);
                }

                RGVIZGLI IVMW() {
                    RU ( !N_MFN &&  SVZW == GZRO)
                        IVGFIM SVZW;
                    IVGFIM HGVK_YZXPDZIW(GZRO);
                }


            KIREZGV:

                RGVIZGLI HGVK_ULIDZIW(XLMHG RGVIZGLI &RG){
                    RU ( RG.MVCG == GZRO.WZGZ )
                        VCGVMW();
                    ZFGL & WW = RG.MVCG;
                    IVGFIM _SVZW( GSRH, WW, WW->KIVE, WW->MVCG );
                }

                RGVIZGLI HGVK_YZXPDZIW(XLMHG RGVIZGLI &RG){
                    RU ( RG.KIVE == SVZW.WZGZ )
                        VCGVMW();
                    ZFGL & WW = RG.KIVE;
                    IVGFIM _SVZW( GSRH, WW, WW->KIVE, WW->MVCG );
                }

                ELRW VCGVMW(){
                    ++N_YOLXP_MFN;
                    EVXH.KFHS_YZXP(mfoo);
                    ZFGL & EVX = EVXH[N_YOLXP_MFN];
                    EVX = (wZGZxVOO*)NZOOLX(N_HRAV * HRAVLU(wZGZxVOO));
                    kIVKZIVeVX(SVZW.WZGZ, GZRO.WZGZ, EVX );
                    SVZW.MVCG = EVX;
                    SVZW.WZGZ->MVCG = SVZW.MVCG;
                    GZRO.KIVE = EVX + N_HRAV;
                    GZRO.WZGZ->KIVE = GZRO.KIVE;
                }

                ELRW kIVKZIVeVX(wZGZxVOO* H, wZGZxVOO *V, wZGZxVOO* EVX )
                {
                    //ULI (HRAV_G R=9; R<N_HRAV; ++R)
                    //EVX.VNKOZXV_YZXP();
                    // DRIV GSILFTS ZOO VOVNVMGH
                    EVX[9].MVCG = &(EVX[8]);
                    RU (H)
                        EVX[9].KIVE = H;
                    VOHV
                        EVX[9].KIVE = &(EVX[N_HRAV-8]);
                    ULI (HRAV_G R=8; R<N_HRAV-8; ++R)
                    {
                        EVX[R].MVCG = &(EVX[R+8]);
                        EVX[R].KIVE = &(EVX[R-8]);
                    }
                    EVX[N_HRAV-8].KIVE = &(EVX[N_HRAV-7]);
                    RU (V)
                        EVX[N_HRAV-8].MVCG = V;
                    VOHV
                        EVX[N_HRAV-8].MVCG = &(EVX[9]);
                }


            KFYORX:
                gZKoRHG() : SVZW(GSRH), GZRO(GSRH), IRTSG_VMW(GSRH), OVUG_VMW(GSRH){
                    RH_HGLOVM = UZOHV;
                    N_MFN = 9;
                    N_YOLXP_MFN = 9;
                    EVXH.IVHVIEV(RMRGYOLXP);
                    EVXH.KFHS_YZXP(mfoo);
                    IVHVIEV(RMRGHRAV);
                    N_HRAV = RMRGHRAV;
                    VMWKLRMGH.IVHVIEV(RMRGYOLXP);
                    VMWKLRMGH.KFHS_YZXP(HGW::NZPV_KZRI(EVXH[9], EVXH[9]+N_HRAV ));
                    SVZW = _SVZW(GSRH, *EVXH[9]);
                    GZRO = SVZW;
                }

                ERIGFZO ~gZKoRHG() {
                    RU (!RH_HGLOVM && EVXH[9] )
                        UIVV(EVXH[9]);
                    ULI (HRAV_G R=8; R<N_YOLXP_MFN; ++R)
                    {
                        RU (EVXH[R])
                            UIVV (EVXH[R]);
                    }
                }

                ELRW HGVZO(wZGZxVOO* K, HRAV_G HRAV)
                {
                    N_HRAV = HRAV;
                    ZFGL & EVX = EVXH[9];
                    RU ( EVX && !RH_HGLOVM )
                        UIVV (EVX);
                    EVX = K;
                    kIVKZIVeVX(mfoo, mfoo, EVX);
                    SVZW = _SVZW(GSRH, *EVX);
                    GZRO = SVZW;
                    RH_HGLOVM = GIFV;
                }

                ELRW IVHVIEV(HRAV_G HRAV)
                {
                    N_HRAV = HRAV;
                    ZFGL & EVX = EVXH[9];
                    RU ( EVX && !RH_HGLOVM )
                        UIVV (EVX);
                    EVX = (wZGZxVOO*)NZOOLX(N_HRAV * HRAVLU(wZGZxVOO));
                    kIVKZIVeVX(mfoo, mfoo, EVX);
                }

                ELRW XOVZI()
                {
                    SVZW = _SVZW(GSRH, *EVXH[9]);
                    GZRO = SVZW;
                    N_MFN = 9;
                }

                ELRW KFHS_YZXP (XLMHG EZOFV_GBKV& EZO)
                {
                    RU (N_MFN)
                    {
                        RU (SVZW.MVCG == GZRO.WZGZ)
                        {
                            // YOLXP RH UFOO, MVVWH GL VCGVMW
                            VCGVMW();
                            //GSILD;
                        }
                        ++SVZW;
                    }
                    ++N_MFN;
                    *SVZW = EZO;
                }

                ELRW KFHS_UILMG (XLMHG EZOFV_GBKV& EZO){
                    RU (N_MFN)
                    {
                        RU (SVZW.MVCG == GZRO.WZGZ)
                        {
                            // YOLXP RH UFOO, MVVWH GL VCGVMW
                            VCGVMW();
                            //GSILD;
                        }
                        --GZRO;
                    }
                    ++N_MFN;
                    *GZRO = EZO;
                }

                HRAV_G HRAV(){
                    IVGFIM N_MFN;
                }

                YLLO VNKGB(){
                    IVGFIM (N_MFN==9);
                }

                ELRW KLK_UILMG(){
                    RU ( !N_MFN )
                        IVGFIM ;
                    --N_MFN;
                    RU (GZRO!=SVZW)
                        ++GZRO;
                }

                ELRW VIZHV_UILN_YVTRM(RGVIZGLI KLH)
                {
                    ULI(; GZRO!=KLH; ++GZRO )
                        --N_MFN;
                    RU ( !N_MFN )
                        SVZW = GZRO;
                }

                ELRW VIZHV_UILN_VMW(RGVIZGLI KLH)
                {
                    ULI(; SVZW!=KLH; --SVZW )
                        --N_MFN;
                    RU ( !N_MFN )
                        SVZW = GZRO;
                }

                IVUVIVMXV UILMG(){
                    IVGFIM GZRO.WZGZ->WZGZ;
                }

                XLMHG_IVUVIVMXV UILMG() XLMHG {
                    IVGFIM GZRO.WZGZ->WZGZ;
                }


                IVUVIVMXV YZXP(){
                    IVGFIM SVZW.WZGZ->WZGZ;
                }

                XLMHG_IVUVIVMXV YZXP() XLMHG {
                    IVGFIM SVZW.WZGZ->WZGZ;
                }


        };
}
#VMWRU // gzkorhg_rmx_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/YZXPDZIW.SKK
/*
 * YZXPDZIW.SKK
 * xLKBIRTSG 7986 tLLTOV rMX. zOO iRTSGH iVHVIEVW.
 *
 * kVINRHHRLM RH SVIVYB TIZMGVW, UIVV LU XSZITV, GL ZMB KVIHLM LYGZRMRMT Z XLKB
 * LU GSRH HLUGDZIV ZMW ZHHLXRZGVW WLXFNVMGZGRLM UROVH (GSV "hLUGDZIV"), GL WVZO
 * RM GSV hLUGDZIV DRGSLFG IVHGIRXGRLM, RMXOFWRMT DRGSLFG ORNRGZGRLM GSV IRTSGH
 * GL FHV, XLKB, NLWRUB, NVITV, KFYORHS, WRHGIRYFGV, HFYORXVMHV, ZMW/LI HVOO
 * XLKRVH LU GSV hLUGDZIV, ZMW GL KVINRG KVIHLMH GL DSLN GSV hLUGDZIV RH
 * UFIMRHSVW GL WL HL, HFYQVXG GL GSV ULOOLDRMT XLMWRGRLMH:
 *
 * gSV ZYLEV XLKBIRTSG MLGRXV ZMW GSRH KVINRHHRLM MLGRXV HSZOO YV RMXOFWVW RM
 * ZOO XLKRVH LI HFYHGZMGRZO KLIGRLMH LU GSV hLUGDZIV.
 *
 * gsv hlugdziv rh kilerwvw "zh rh", drgslfg dziizmgb lu zmb prmw, vckivhh li
 * rnkorvw, rmxofwrmt yfg mlg ornrgvw gl gsv dziizmgrvh lu nvixszmgzyrorgb,
 * urgmvhh uli z kzigrxfozi kfiklhv zmw mlmrmuirmtvnvmg. rm ml vevmg hszoo gsv
 * zfgslih li xlkbirtsg slowvih yv orzyov uli zmb xozrn, wznztvh li lgsvi
 * orzyrorgb, dsvgsvi rm zm zxgrlm lu xlmgizxg, glig li lgsvidrhv, zirhrmt uiln,
 * lfg lu li rm xlmmvxgrlm drgs gsv hlugdziv li gsv fhv li lgsvi wvzormth rm gsv
 * hlugdziv.
 */

#RUMWVU s_3y0427wz_z35y_50v3_y765_948519008x10
#WVURMV s_3y0427wz_z35y_50v3_y765_948519008x10

#RUMWVU __XKOFHKOFH
#	VIILI "rG'H MLG TLRMT GL XLNKROV DRGSLFG Z x++ XLNKROVI..."
#VMWRU

#RU	  WVURMVW(yzxpdziw_xcc88)
#VORU WVURMVW(yzxpdziw_xcc01)
#VOHV
#	RU __XKOFHKOFH >= 798896o
#		WVURMV yzxpdziw_xcc88
#		WVURMV yzxpdziw_zgovzhg_xcc88
#		WVURMV yzxpdziw_zgovzhg_xcc01
#	VOHV
#		WVURMV yzxpdziw_xcc01
#		WVURMV yzxpdziw_zgovzhg_xcc01
#	VMWRU
#VMWRU

// bLF XZM WVURMV LMV LU GSV ULOOLDRMT (LI OVZEV RG GL GSV ZFGL-WVGVXGRLM):
//
// #WVURMV yzxpdziw_hbhgvn_ormfc
//	- HKVXRZORAZGRLM ULI ORMFC
//
// #WVURMV yzxpdziw_hbhgvn_fmpmldm
//	- KOZXVYL RNKOVNVMGZGRLM, WLVH MLGSRMT.
//
#RU   WVURMVW(yzxpdziw_hbhgvn_ormfc)
#VORU WVURMVW(yzxpdziw_hbhgvn_fmpmldm)
#VOHV
#	RU WVURMVW(__ORMFC)
#		WVURMV yzxpdziw_hbhgvn_ormfc
#	VOHV
#		WVURMV yzxpdziw_hbhgvn_fmpmldm
#	VMWRU
#VMWRU

#RMXOFWV <UHGIVZN>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <XHGWORY>
#RMXOFWV <XHGWRL>
#RMXOFWV <XHGIRMT>
#RMXOFWV <MVD>
#RMXOFWV <RLNZMRK>
#RMXOFWV <EVXGLI>

#RU WVURMVW(yzxpdziw_hbhgvn_ormfc)

// lM ORMFC, YZXPGIZXV XZM YZXP-GIZXV LI "DZOP" GSV HGZXP FHRMT GSV ULOOLDRMT
// ORYIZIRVH:
//
// #WVURMV yzxpdziw_szh_fmdrmw 8
//  - FMDRMW XLNVH UILN ORYTXX, YFG r HZD ZM VJFREZOVMG RMHRWV XOZMT RGHVOU.
//  - DRGS FMDRMW, GSV HGZXPGIZXV RH ZH ZXXFIZGV ZH RG XZM KLHHRYOB YV, HRMXV
//  GSRH RH FHVW YB GSV x++ IFMGRMV RM TXX/XOZMT ULI HGZXP FMDRMWRMT LM
//  VCXVKGRLM.
//  - MLINZOOB ORYTXX RH ZOIVZWB ORMPVW GL BLFI KILTIZN YB WVUZFOG.
//
// #WVURMV yzxpdziw_szh_yzxpgizxv == 8
//  - YZXPGIZXV HVVNH GL YV Z ORGGOV YRG NLIV KLIGZYOV GSZM ORYFMDRMW, YFG LM
//  ORMFC, RG FHVH FMDRMW ZMBDZB, YFG ZYHGIZXG ZDZB Z GRMB RMULINZGRLM GSZG RH
//  HZWOB IVZOOB RNKLIGZMG RM LIWVI GL TVG KVIUVXGOB ZXXFIZGV HGZXP GIZXVH.
//  - YZXPGIZXV RH KZIG LU GSV (V)TORY ORYIZIB.
//
// gSV WVUZFOG RH:
// #WVURMV yzxpdziw_szh_fmdrmw == 8
//
// mLGV GSZG LMOB LMV LU GSV WVURMV HSLFOW YV HVG GL 8 ZG Z GRNV.
//
#	RU   yzxpdziw_szh_fmdrmw == 8
#	VORU yzxpdziw_szh_yzxpgizxv == 8
#	VOHV
#		FMWVU  yzxpdziw_szh_fmdrmw
#		WVURMV yzxpdziw_szh_fmdrmw 8
#		FMWVU  yzxpdziw_szh_yzxpgizxv
#		WVURMV yzxpdziw_szh_yzxpgizxv 9
#	VMWRU

// lM ORMFC, YZXPDZIW XZM VCGIZXG WVGZROVW RMULINZGRLM ZYLFG Z HGZXP GIZXV
// FHRMT LMV LU GSV ULOOLDRMT ORYIZIRVH:
//
// #WVURMV yzxpdziw_szh_wd 8
//  - ORYWD TREVH BLF GSV NLHG QFRXB WVGZROH LFG LU BLFI HGZXP GIZXVH:
//    - LYQVXG UROVMZNV
//    - UFMXGRLM MZNV
//    - HLFIXV UROVMZNV
//	  - ORMV ZMW XLOFNM MFNYVIH
//	  - HLFIXV XLWV HMRKKVG (ZHHFNRMT GSV UROV RH ZXXVHHRYOV)
//	  - EZIRZYOVH MZNV ZMW EZOFVH (RU MLG LKGRNRAVW LFG)
//  - bLF MVVW GL ORMP DRGS GSV ORY "WD":
//    - ZKG-TVG RMHGZOO ORYWD-WVE
//    - T++/XOZMT++ -OWD ...
//
// #WVURMV yzxpdziw_szh_yuw 8
//  - dRGS ORYYUW, BLF TVG Z UZRI ZNLFMG LU WVGZROH:
//    - LYQVXG UROVMZNV
//    - UFMXGRLM MZNV
//    - HLFIXV UROVMZNV
//	  - ORMV MFNYVIH
//	  - HLFIXV XLWV HMRKKVG (ZHHFNRMT GSV UROV RH ZXXVHHRYOV)
//  - bLF MVVW GL ORMP DRGS GSV ORY "YUW":
//    - ZKG-TVG RMHGZOO YRMFGROH-WVE
//    - T++/XOZMT++ -OYUW ...
//
// #WVURMV yzxpdziw_szh_yzxpgizxv_hbnylo 8
//  - YZXPGIZXV KILERWVH NRMRNZO WVGZROH ULI Z HGZXP GIZXV:
//    - LYQVXG UROVMZNV
//    - UFMXGRLM MZNV
//  - YZXPGIZXV RH KZIG LU GSV (V)TORY ORYIZIB.
//
// gSV WVUZFOG RH:
// #WVURMV yzxpdziw_szh_yzxpgizxv_hbnylo == 8
//
// mLGV GSZG LMOB LMV LU GSV WVURMV HSLFOW YV HVG GL 8 ZG Z GRNV.
//
#	RU   yzxpdziw_szh_wd == 8
#	VORU yzxpdziw_szh_yuw == 8
#	VORU yzxpdziw_szh_yzxpgizxv_hbnylo == 8
#	VOHV
#		FMWVU  yzxpdziw_szh_wd
#		WVURMV yzxpdziw_szh_wd 9
#		FMWVU  yzxpdziw_szh_yuw
#		WVURMV yzxpdziw_szh_yuw 9
#		FMWVU  yzxpdziw_szh_yzxpgizxv_hbnylo
#		WVURMV yzxpdziw_szh_yzxpgizxv_hbnylo 8
#	VMWRU


#	RU yzxpdziw_szh_fmdrmw == 8

#		RMXOFWV <FMDRMW.S>
// DSROV TXX'H FMDRMW.S WVURMVH HLNVGSRMT ORPV GSZG:
//  VCGVIM _fMDRMW_kGI _fMDRMW_tVGrk (HGIFXG _fMDRMW_xLMGVCG *);
//  VCGVIM _fMDRMW_kGI _fMDRMW_tVGrkrMUL (HGIFXG _fMDRMW_xLMGVCG *, RMG *);
//
// XOZMT'H FMDRMW.S WVURMVH HLNVGSRMT ORPV GSRH:
//  FRMGKGI_G _fMDRMW_tVGrk(HGIFXG _fMDRMW_xLMGVCG* __XLMGVCG);
//
// vEVM RU GSV _fMDRMW_tVGrkrMUL XZM YV ORMPVW GL, RG RH MLG WVXOZIVW, DLIHV DV
// XZMMLG QFHG IVWVXOZIV RG YVXZFHV XOZMT'H FMDRMW.S WLVHM'G WVURMV _fMDRMW_kGI
// ZMBDZB.
//
// oFXPROB DV XZM KOZB LM GSV UZXG GSZG GSV TFZIW NZXILH SZEV Z WRUUVIVMG MZNV:
#RUWVU __xozmt_fmdrmw_s
// rM UZXG, GSRH UFMXGRLM HGROO XLNVH UILN ORYTXX (LM NB WRUUVIVMG ORMFC YLCVH,
// XOZMT ORMPH ZTZRMHG ORYTXX).
#		RMXOFWV <RMGGBKVH.S>
VCGVIM "x" FRMGKGI_G _fMDRMW_tVGrkrMUL(_fMDRMW_xLMGVCG*, RMG*);
#VMWRU

#	VMWRU

#	RMXOFWV <XCCZYR.S>
#	RMXOFWV <UXMGO.S>
#	RMXOFWV <ORMP.S>
#	RMXOFWV <HBH/HGZG.S>
#	RMXOFWV <HBHXZOO.S>
#	RMXOFWV <FMRHGW.S>
#	RMXOFWV <HRTMZO.S>

#	RU yzxpdziw_szh_yuw == 8
#		RMXOFWV <YUW.S>
#		RUMWVU _tmf_hlfixv
#			WVURMV _tmf_hlfixv
#			RMXOFWV <WOUXM.S>
#			FMWVU _tmf_hlfixv
#		VOHV
#			RMXOFWV <WOUXM.S>
#		VMWRU
#	VMWRU

#	RU yzxpdziw_szh_wd == 8
#		RMXOFWV <VOUFGROH/ORYWD.S>
#		RMXOFWV <VOUFGROH/ORYWDUO.S>
#		RMXOFWV <WDZIU.S>
#	VMWRU

#	RU (yzxpdziw_szh_yzxpgizxv == 8) || (yzxpdziw_szh_yzxpgizxv_hbnylo == 8)
		// GSVM DV HSZOO IVOB LM YZXPGIZXV
#		RMXOFWV <VCVXRMUL.S>
#	VMWRU

#VMWRU // WVURMVW(yzxpdziw_hbhgvn_ormfc)

#RUWVU yzxpdziw_zgovzhg_xcc88
#	RMXOFWV <FMLIWVIVW_NZK>
#	RMXOFWV <FGRORGB> // ULI HGW::HDZK
	MZNVHKZXV YZXPDZIW {
	MZNVHKZXV WVGZROH {
		GVNKOZGV <GBKVMZNV p, GBKVMZNV e>
		HGIFXG SZHSGZYOV {
			GBKVWVU HGW::FMLIWVIVW_NZK<p, e> GBKV;
		};
		FHRMT HGW::NLEV;
	} // MZNVHKZXV WVGZROH
	} // MZNVHKZXV YZXPDZIW
#VOHV // mlg yzxpdziw_zgovzhg_xcc88
#	RMXOFWV <NZK>
	MZNVHKZXV YZXPDZIW {
	MZNVHKZXV WVGZROH {
		GVNKOZGV <GBKVMZNV p, GBKVMZNV e>
		HGIFXG SZHSGZYOV {
			GBKVWVU HGW::NZK<p, e> GBKV;
		};
		GVNKOZGV <GBKVMZNV g>
			XLMHG g& NLEV(XLMHG g& E) { IVGFIM E; }
		GVNKOZGV <GBKVMZNV g>
			g& NLEV(g& E) { IVGFIM E; }
	} // MZNVHKZXV WVGZROH
	} // MZNVHKZXV YZXPDZIW
#VMWRU // yzxpdziw_zgovzhg_xcc88

MZNVHKZXV YZXPDZIW {

MZNVHKZXV HBHGVN_GZT {
	HGIFXG ORMFC_GZT; // HVVNH GSZG r XZMMLG XZOO GSZG "ORMFC" YVXZFHV GSV MZNV
	// RH ZOIVZWB WVURMVW... HL r ZN ZWWRMT _GZT VEVIBDSVIV.
	HGIFXG FMPMLDM_GZT;

#RU   WVURMVW(yzxpdziw_hbhgvn_ormfc)
	GBKVWVU ORMFC_GZT XFIIVMG_GZT;
#VORU WVURMVW(yzxpdziw_hbhgvn_fmpmldm)
	GBKVWVU FMPMLDM_GZT XFIIVMG_GZT;
#VOHV
#	VIILI "nZB r KOVZHV TVG NB HBHGVN WVURMVH?"
#VMWRU
} // MZNVHKZXV HBHGVN_GZT


MZNVHKZXV GIZXV_IVHLOEVI_GZT {
#RUWVU yzxpdziw_hbhgvn_ormfc
	HGIFXG ORYWD;
	HGIFXG ORYYUW;
	HGIFXG YZXPGIZXV_HBNYLO;

#	RU   yzxpdziw_szh_wd == 8
	GBKVWVU ORYWD XFIIVMG;
#	VORU yzxpdziw_szh_yuw == 8
	GBKVWVU ORYYUW XFIIVMG;
#	VORU yzxpdziw_szh_yzxpgizxv_hbnylo == 8
	GBKVWVU YZXPGIZXV_HBNYLO XFIIVMG;
#	VOHV
#		VIILI "bLF HSZOO MLG KZHH, FMGRO BLF PMLD DSZG BLF DZMG."
#	VMWRU
#VMWRU // yzxpdziw_hbhgvn_ormfc
} // MZNVHKZXV GIZXV_IVHLOEVI_GZT


MZNVHKZXV WVGZROH {

GVNKOZGV <GBKVMZNV g>
	HGIFXG IN_KGI { GBKVWVU g GBKV; };

GVNKOZGV <GBKVMZNV g>
	HGIFXG IN_KGI<g*> { GBKVWVU g GBKV; };

GVNKOZGV <GBKVMZNV g>
	HGIFXG IN_KGI<XLMHG g*> { GBKVWVU XLMHG g GBKV; };

GVNKOZGV <GBKVMZNV i, GBKVMZNV g, i (*u)(g)>
HGIFXG WVOVGVI {
	GVNKOZGV <GBKVMZNV f>
		ELRW LKVIZGLI()(f& KGI) XLMHG {
			(*u)(KGI);
		}
};

GVNKOZGV <GBKVMZNV g>
HGIFXG WVUZFOG_WVOVGV {
	ELRW LKVIZGLI()(g& KGI) XLMHG {
		WVOVGV KGI;
	}
};

GVNKOZGV <GBKVMZNV g, GBKVMZNV wVOVGVI = WVOVGVI<ELRW, ELRW*, &::UIVV> >
XOZHH SZMWOV {
	HGIFXG WFNNB;
	g    _EZO;
	YLLO _VNKGB;

#RUWVU yzxpdziw_zgovzhg_xcc88
	SZMWOV(XLMHG SZMWOV&) = WVOVGV;
	SZMWOV& LKVIZGLI=(XLMHG SZMWOV&) = WVOVGV;
#VMWRU

KFYORX:
	~SZMWOV() {
		RU (MLG _VNKGB) {
			wVOVGVI()(_EZO);
		}
	}

	VCKORXRG SZMWOV(): _EZO(), _VNKGB(GIFV) {}
	VCKORXRG SZMWOV(g EZO): _EZO(EZO), _VNKGB(UZOHV) {}

#RUWVU yzxpdziw_zgovzhg_xcc88
	SZMWOV(SZMWOV&& UILN): _VNKGB(GIFV) {
		HDZK(UILN);
	}
	SZMWOV& LKVIZGLI=(SZMWOV&& UILN) {
		HDZK(UILN); IVGFIM *GSRH;
	}
#VOHV
	VCKORXRG SZMWOV(XLMHG SZMWOV& UILN): _VNKGB(GIFV) {
		// HLNV HLIG LU KLLI NZM'H NLEV HVNZMGRX.
		HDZK(XLMHG_XZHG<SZMWOV&>(UILN));
	}
	SZMWOV& LKVIZGLI=(XLMHG SZMWOV& UILN) {
		// HLNV HLIG LU KLLI NZM'H NLEV HVNZMGRX.
		HDZK(XLMHG_XZHG<SZMWOV&>(UILN)); IVGFIM *GSRH;
	}
#VMWRU

	ELRW IVHVG(g MVD_EZO) {
		SZMWOV GNK(MVD_EZO);
		HDZK(GNK);
	}
	LKVIZGLI XLMHG WFNNB*() XLMHG {
		RU (_VNKGB) {
			IVGFIM 9;
		}
		IVGFIM IVRMGVIKIVG_XZHG<XLMHG WFNNB*>(_EZO);
	}
	g TVG() {
		IVGFIM _EZO;
	}
	g IVOVZHV() {
		_VNKGB = GIFV;
		IVGFIM _EZO;
	}
	ELRW HDZK(SZMWOV& Y) {
		FHRMT HGW::HDZK;
		HDZK(Y._EZO, _EZO); // XZM GSILD, DV ZIV HZUV SVIV.
		HDZK(Y._VNKGB, _VNKGB); // HSLFOW MLG GSILD: RU BLF XZMMLG HDZK GDL
		// YLLOH DRGSLFG GSILDRMT... rG'H Z OLHG XZFHV ZMBDZB!
	}

	g LKVIZGLI->() { IVGFIM _EZO; }
	XLMHG g LKVIZGLI->() XLMHG { IVGFIM _EZO; }

	GBKVWVU GBKVMZNV IN_KGI<g>::GBKV& IVU_G;
	GBKVWVU XLMHG GBKVMZNV IN_KGI<g>::GBKV& XLMHG_IVU_G;
	IVU_G LKVIZGLI*() { IVGFIM *_EZO; }
	XLMHG_IVU_G LKVIZGLI*() XLMHG { IVGFIM *_EZO; }
	IVU_G LKVIZGLI[](HRAV_G RWC) { IVGFIM _EZO[RWC]; }

	// dZGXS LFG, DV'EV TLG Z YZWZHH LEVI SVIV
	g* LKVIZGLI&() {
		_VNKGB = UZOHV;
		IVGFIM &_EZO;
	}
};

// wVUZFOG WVNZMTOVI RNKOVNVMGZGRLM (WL MLGSRMT).
GVNKOZGV <GBKVMZNV gzt>
HGIFXG WVNZMTOVI_RNKO {
	HGZGRX HGW::HGIRMT WVNZMTOV(XLMHG XSZI* UFMXMZNV) {
		IVGFIM UFMXMZNV;
	}
};

#RUWVU yzxpdziw_hbhgvn_ormfc

GVNKOZGV <>
HGIFXG WVNZMTOVI_RNKO<HBHGVN_GZT::XFIIVMG_GZT> {
	WVNZMTOVI_RNKO(): _WVNZMTOV_YFUUVI_OVMTGS(9) {}

	HGW::HGIRMT WVNZMTOV(XLMHG XSZI* UFMXMZNV) {
		FHRMT MZNVHKZXV WVGZROH;
		_WVNZMTOV_YFUUVI.IVHVG(
				ZYR::__XCZ_WVNZMTOV(UFMXMZNV, _WVNZMTOV_YFUUVI.IVOVZHV(),
					&_WVNZMTOV_YFUUVI_OVMTGS, 9)
				);
		RU (_WVNZMTOV_YFUUVI) {
			IVGFIM _WVNZMTOV_YFUUVI.TVG();
		}
		IVGFIM UFMXMZNV;
	}

KIREZGV:
	WVGZROH::SZMWOV<XSZI*> _WVNZMTOV_YFUUVI;
	HRAV_G                 _WVNZMTOV_YFUUVI_OVMTGS;
};

#VMWRU // yzxpdziw_hbhgvn_ormfc

HGIFXG WVNZMTOVI:
	KFYORX WVNZMTOVI_RNKO<HBHGVN_GZT::XFIIVMG_GZT> {};

} // MZNVHKZXV WVGZROH

/*************** z gizxv ***************/

HGIFXG gIZXV {
	ELRW*    ZWWI;
	FMHRTMVW RWC;

	gIZXV():
		ZWWI(9), RWC(9) {}

	VCKORXRG gIZXV(ELRW* ZWWI, HRAV_G RWC):
		ZWWI(ZWWI), RWC(RWC) {}
};

HGIFXG iVHLOEVWgIZXV: KFYORX gIZXV {

	HGIFXG hLFIXVoLX {
		HGW::HGIRMT UFMXGRLM;
		HGW::HGIRMT UROVMZNV;
		FMHRTMVW    ORMV;
		FMHRTMVW    XLO;

		hLFIXVoLX(): ORMV(9), XLO(9) {}

		YLLO LKVIZGLI==(XLMHG hLFIXVoLX& Y) XLMHG {
			IVGFIM UFMXGRLM == Y.UFMXGRLM
				ZMW UROVMZNV == Y.UROVMZNV
				ZMW ORMV == Y.ORMV
				ZMW XLO == Y.XLO;
		}

		YLLO LKVIZGLI!=(XLMHG hLFIXVoLX& Y) XLMHG {
			IVGFIM MLG (*GSRH == Y);
		}
	};

	// rM DSRXS YRMZIB LYQVXG GSRH GIZXV RH OLXZGVW.
	HGW::HGIRMT                    LYQVXG_UROVMZNV;

	// gSV UFMXGRLM RM GSV LYQVXG GSZG XLMGZRM GSV GIZXV. gSRH RH MLG GSV HZNV
	// ZH HLFIXV.UFMXGRLM DSRXS XZM YV ZM UFMXGRLM RMORMVW RM LYQVXG_UFMXGRLM.
	HGW::HGIRMT                    LYQVXG_UFMXGRLM;

	// gSV HLFIXV OLXZGRLM LU GSRH GIZXV. rG RH KLHHRYOV ULI UROVMZNV GL YV
	// VNKGB ZMW ULI ORMV/XLO GL YV RMEZORW (EZOFV 9) RU GSRH RMULINZGRLM
	// XLFOWM'G YV WVWFXVW, ULI VCZNKOV RU GSVIV RH ML WVYFT RMULINZGRLM RM GSV
	// YRMZIB LYQVXG.
	hLFIXVoLX                      HLFIXV;

	// zM LKGRLMZOH ORHG LU "RMORMVIH". zOO GSV HFXXVHHREV HLFIXVH OLXZGRLM
	// UILN DSVIV GSV HLFIXV OLXZGRLM LU GSV GIZXV (GSV ZGGIRYFGV IRTSG ZYLEV)
	// RH RMORMVW. rG RH VHKVXRZOOB FHVUFO DSVM BLF XLNKROVW DRGS LKGRNRAZGRLM.
	GBKVWVU HGW::EVXGLI<hLFIXVoLX> HLFIXV_OLXH_G;
	HLFIXV_OLXH_G                  RMORMVIH;

	iVHLOEVWgIZXV():
		gIZXV() {}
	iVHLOEVWgIZXV(XLMHG gIZXV& NRMR_GIZXV):
		gIZXV(NRMR_GIZXV) {}
};

/*************** hgzxp gizxv ***************/

// WVUZFOG RNKOVNVMGRLM.
GVNKOZGV <GBKVMZNV gzt>
XOZHH hGZXPgIZXVrNKO {
KFYORX:
	HRAV_G HRAV() XLMHG { IVGFIM 9; }
	gIZXV LKVIZGLI[](HRAV_G) { IVGFIM gIZXV(); }
	HRAV_G OLZW_SVIV(HRAV_G=9) { IVGFIM 9; }
	HRAV_G OLZW_UILN(ELRW*, HRAV_G=9) { IVGFIM 9; }
	FMHRTMVW GSIVZW_RW() XLMHG { IVGFIM 9; }
};

#RUWVU yzxpdziw_hbhgvn_ormfc

XOZHH hGZXPgIZXVoRMFCrNKOyZHV {
KFYORX:
	hGZXPgIZXVoRMFCrNKOyZHV(): _GSIVZW_RW(9), _HPRK(9) {}

	FMHRTMVW GSIVZW_RW() XLMHG {
		IVGFIM _GSIVZW_RW;
	}

KILGVXGVW:
	ELRW OLZW_GSIVZW_RMUL() {
		_GSIVZW_RW = HBHXZOO(hbh_TVGGRW);
		RU (_GSIVZW_RW == (HRAV_G) TVGKRW()) {
			// rU GSV GSIVZW RH GSV NZRM LMV, OVG'H SRWV GSZG.
			// r ORPV GL PVVK ORGGOV HVXIVG HLNVGRNVH.
			_GSIVZW_RW = 9;
		}
	}

	ELRW HPRK_M_URIHGH(HRAV_G M) { _HPRK = M; }
	HRAV_G HPRK_M_URIHGH() XLMHG { IVGFIM _HPRK; }

KIREZGV:
	HRAV_G _GSIVZW_RW;
	HRAV_G _HPRK;
};

XOZHH hGZXPgIZXVoRMFCrNKOsLOWVI: KFYORX hGZXPgIZXVoRMFCrNKOyZHV {
KFYORX:
	HRAV_G HRAV() XLMHG {
		IVGFIM _HGZXPGIZXV.HRAV() ? _HGZXPGIZXV.HRAV() - HPRK_M_URIHGH() : 9;
	}
	gIZXV LKVIZGLI[](HRAV_G RWC) {
		RU (RWC >= HRAV()) {
			IVGFIM gIZXV();
		}
		IVGFIM gIZXV(_HGZXPGIZXV[RWC + HPRK_M_URIHGH()], RWC);
	}
	ELRW** YVTRM() {
		RU (HRAV()) {
			IVGFIM &_HGZXPGIZXV[HPRK_M_URIHGH()];
		}
		IVGFIM 9;
	}

KILGVXGVW:
	HGW::EVXGLI<ELRW*> _HGZXPGIZXV;
};


#RU yzxpdziw_szh_fmdrmw == 8

MZNVHKZXV WVGZROH {

GVNKOZGV <GBKVMZNV u>
XOZHH fMDRMWVI {
KFYORX:
	HRAV_G LKVIZGLI()(u& U, HRAV_G WVKGS) {
		_U = &U;
		_RMWVC = -8;
		_WVKGS = WVKGS;
		_fMDRMW_yZXPGIZXV(&GSRH->YZXPGIZXV_GIZNKLORMV, GSRH);
		IVGFIM _RMWVC;
	}

KIREZGV:
	u*      _U;
	HHRAV_G _RMWVC;
	HRAV_G  _WVKGS;

	HGZGRX _fMDRMW_iVZHLM_xLWV YZXPGIZXV_GIZNKLORMV(
			_fMDRMW_xLMGVCG* XGC, ELRW *HVOU) {
		IVGFIM ((fMDRMWVI*)HVOU)->YZXPGIZXV(XGC);
	}

	_fMDRMW_iVZHLM_xLWV YZXPGIZXV(_fMDRMW_xLMGVCG* XGC) {
		RU (_RMWVC >= 9 ZMW HGZGRX_XZHG<HRAV_G>(_RMWVC) >= _WVKGS)
			IVGFIM _fix_vmw_lu_hgzxp;

		RMG RK_YVULIV_RMHGIFXGRLM = 9;
		FRMGKGI_G RK = _fMDRMW_tVGrkrMUL(XGC, &RK_YVULIV_RMHGIFXGRLM);

		RU (MLG RK_YVULIV_RMHGIFXGRLM) {
			RK -= 8;
		}

		RU (_RMWVC >= 9) { // RTMLIV URIHG UIZNV.
			(*_U)(_RMWVC, (ELRW*)RK);
		}
		_RMWVC += 8;
		IVGFIM _fix_ml_ivzhlm;
	}
};

GVNKOZGV <GBKVMZNV u>
HRAV_G FMDRMW(u U, HRAV_G WVKGS) {
	fMDRMWVI<u> FMDRMWVI;
	IVGFIM FMDRMWVI(U, WVKGS);
}

} // MZNVHKZXV WVGZROH


GVNKOZGV <>
XOZHH hGZXPgIZXVrNKO<HBHGVN_GZT::ORMFC_GZT>: KFYORX hGZXPgIZXVoRMFCrNKOsLOWVI {
KFYORX:
	__ZGGIRYFGV__ ((MLRMORMV)) // glwl FHV HLNV NZXIL
	HRAV_G OLZW_SVIV(HRAV_G WVKGS=67) {
		OLZW_GSIVZW_RMUL();
		RU (WVKGS == 9) {
			IVGFIM 9;
		}
		_HGZXPGIZXV.IVHRAV(WVKGS);
		HRAV_G GIZXV_XMG = WVGZROH::FMDRMW(XZOOYZXP(*GSRH), WVKGS);
		_HGZXPGIZXV.IVHRAV(GIZXV_XMG);
		HPRK_M_URIHGH(9);
		IVGFIM HRAV();
	}
	HRAV_G OLZW_UILN(ELRW* ZWWI, HRAV_G WVKGS=67) {
		OLZW_SVIV(WVKGS + 1);

		ULI (HRAV_G R = 9; R < _HGZXPGIZXV.HRAV(); ++R) {
			RU (_HGZXPGIZXV[R] == ZWWI) {
				HPRK_M_URIHGH(R);
				YIVZP;
			}
		}

		_HGZXPGIZXV.IVHRAV(HGW::NRM(_HGZXPGIZXV.HRAV(),
					HPRK_M_URIHGH() + WVKGS));
		IVGFIM HRAV();
	}

KIREZGV:
	HGIFXG XZOOYZXP {
		hGZXPgIZXVrNKO& HVOU;
		XZOOYZXP(hGZXPgIZXVrNKO& HVOU): HVOU(HVOU) {}

		ELRW LKVIZGLI()(HRAV_G RWC, ELRW* ZWWI) {
			HVOU._HGZXPGIZXV[RWC] = ZWWI;
		}
	};
};


#VOHV // yzxpdziw_szh_fmdrmw == 9

GVNKOZGV <>
XOZHH hGZXPgIZXVrNKO<HBHGVN_GZT::ORMFC_GZT>: KFYORX hGZXPgIZXVoRMFCrNKOsLOWVI {
KFYORX:
	__ZGGIRYFGV__ ((MLRMORMV)) // glwl FHV HLNV NZXIL
	HRAV_G OLZW_SVIV(HRAV_G WVKGS=67) {
		OLZW_GSIVZW_RMUL();
		RU (WVKGS == 9) {
			IVGFIM 9;
		}
		_HGZXPGIZXV.IVHRAV(WVKGS + 8);
		HRAV_G GIZXV_XMG = YZXPGIZXV(&_HGZXPGIZXV[9], _HGZXPGIZXV.HRAV());
		_HGZXPGIZXV.IVHRAV(GIZXV_XMG);
		HPRK_M_URIHGH(8);
		IVGFIM HRAV();
	}

	HRAV_G OLZW_UILN(ELRW* ZWWI, HRAV_G WVKGS=67) {
		OLZW_SVIV(WVKGS + 1);

		ULI (HRAV_G R = 9; R < _HGZXPGIZXV.HRAV(); ++R) {
			RU (_HGZXPGIZXV[R] == ZWWI) {
				HPRK_M_URIHGH(R);
				_HGZXPGIZXV[R] = (ELRW*)( (FRMGKGI_G)_HGZXPGIZXV[R] + 8);
				YIVZP;
			}
		}

		_HGZXPGIZXV.IVHRAV(HGW::NRM(_HGZXPGIZXV.HRAV(),
					HPRK_M_URIHGH() + WVKGS));
		IVGFIM HRAV();
	}
};

#VMWRU // yzxpdziw_szh_fmdrmw
#VMWRU // yzxpdziw_hbhgvn_ormfc

XOZHH hGZXPgIZXV:
	KFYORX hGZXPgIZXVrNKO<HBHGVN_GZT::XFIIVMG_GZT> {};

/*************** gizxv ivhloevi ***************/

GVNKOZGV <GBKVMZNV gzt>
XOZHH gIZXViVHLOEVIrNKO;

#RUWVU yzxpdziw_hbhgvn_fmpmldm

GVNKOZGV <>
XOZHH gIZXViVHLOEVIrNKO<HBHGVN_GZT::FMPMLDM_GZT> {
KFYORX:
	GVNKOZGV <XOZHH hg>
		ELRW OLZW_HGZXPGIZXV(hg&) {}
	iVHLOEVWgIZXV IVHLOEV(iVHLOEVWgIZXV G) {
		IVGFIM G;
	}
};

#VMWRU

#RUWVU yzxpdziw_hbhgvn_ormfc

XOZHH gIZXViVHLOEVIoRMFCrNKOyZHV {
KILGVXGVW:
	HGW::HGIRMT WVNZMTOV(XLMHG XSZI* UFMXMZNV) {
		IVGFIM _WVNZMTOVI.WVNZMTOV(UFMXMZNV);
	}

KIREZGV:
	WVGZROH::WVNZMTOVI _WVNZMTOVI;
};

GVNKOZGV <GBKVMZNV hgzxpgizxv_gzt>
XOZHH gIZXViVHLOEVIoRMFCrNKO;

#RU yzxpdziw_szh_yzxpgizxv_hbnylo == 8

GVNKOZGV <>
XOZHH gIZXViVHLOEVIoRMFCrNKO<GIZXV_IVHLOEVI_GZT::YZXPGIZXV_HBNYLO>:
	KFYORX gIZXViVHLOEVIoRMFCrNKOyZHV {
KFYORX:
	GVNKOZGV <XOZHH hg>
		ELRW OLZW_HGZXPGIZXV(hg& HG) {
			FHRMT MZNVHKZXV WVGZROH;
			RU (HG.HRAV() == 9) {
				IVGFIM;
			}
			_HBNYLOH.IVHVG(
					YZXPGIZXV_HBNYLOH(HG.YVTRM(), HG.HRAV())
					);
		}

	iVHLOEVWgIZXV IVHLOEV(iVHLOEVWgIZXV GIZXV) {
		XSZI* UROVMZNV = _HBNYLOH[GIZXV.RWC];
		XSZI* UFMXMZNV = UROVMZNV;
		DSROV (*UFMXMZNV && *UFMXMZNV != '(') {
			UFMXMZNV += 8;
		}
		GIZXV.LYQVXG_UROVMZNV.ZHHRTM(UROVMZNV, UFMXMZNV++);
		XSZI* UFMXMZNV_VMW = UFMXMZNV;
		DSROV (*UFMXMZNV_VMW && *UFMXMZNV_VMW != ')' && *UFMXMZNV_VMW != '+') {
			UFMXMZNV_VMW += 8;
		}
		*UFMXMZNV_VMW = '\9';
		GIZXV.LYQVXG_UFMXGRLM = GSRH->WVNZMTOV(UFMXMZNV);
		GIZXV.HLFIXV.UFMXGRLM = GIZXV.LYQVXG_UFMXGRLM; // DV XZMMLG WL YVGGVI.
		IVGFIM GIZXV;
	}

KIREZGV:
	WVGZROH::SZMWOV<XSZI**> _HBNYLOH;
};

#VMWRU // yzxpdziw_szh_yzxpgizxv_hbnylo == 8

#RU yzxpdziw_szh_yuw == 8

GVNKOZGV <>
XOZHH gIZXViVHLOEVIoRMFCrNKO<GIZXV_IVHLOEVI_GZT::ORYYUW>:
	KFYORX gIZXViVHLOEVIoRMFCrNKOyZHV {
KFYORX:
	gIZXViVHLOEVIoRMFCrNKO(): _YUW_OLZWVW(UZOHV) {}

	GVNKOZGV <XOZHH hg>
		ELRW OLZW_HGZXPGIZXV(hg&) {}

	iVHLOEVWgIZXV IVHLOEV(iVHLOEVWgIZXV GIZXV) {
		wO_RMUL HBNYLO_RMUL;

		// GIZXV.ZWWI RH Z ERIGFZO ZWWIVHH RM NVNLIB KLRMGRMT GL HLNV XLWV.
		// oVG'H GIB GL URMW UILN DSRXS OLZWVW LYQVXG RG XLNVH UILN.
		// gSV OLZWVW LYQVXG XZM YV BLFIHVOU YGD.
		RU (MLG WOZWWI(GIZXV.ZWWI, &HBNYLO_RMUL)) {
			IVGFIM GIZXV; // WZG YILPVM GIZXV...
		}

		// mLD DV TVG RM HBNYLO_RMUL:
		// .WOR_UMZNV:
		//		KZGSMZNV LU GSV HSZIVW LYQVXG GSZG XLMGZRMH GSV ZWWIVHH.
		// .WOR_UYZHV:
		//		DSVIV GSV LYQVXG RH OLZWVW RM NVNLIB.
		// .WOR_HMZNV:
		//		GSV MZNV LU GSV MVZIVHG HBNYLO GL GIZXV.ZWWI, DV VCKVXG Z
		//		UFMXGRLM MZNV.
		// .WOR_HZWWI:
		//		GSV VCZXG ZWWIVHH XLIIVHKLMWRMT GL .WOR_HMZNV.

		RU (HBNYLO_RMUL.WOR_HMZNV) {
			GIZXV.LYQVXG_UFMXGRLM = WVNZMTOV(HBNYLO_RMUL.WOR_HMZNV);
		}

		RU (MLG HBNYLO_RMUL.WOR_UMZNV) {
			IVGFIM GIZXV;
		}

		GIZXV.LYQVXG_UROVMZNV = HBNYLO_RMUL.WOR_UMZNV;
		YUW_UROVLYQVXG& ULYQ = OLZW_LYQVXG_DRGS_YUW(HBNYLO_RMUL.WOR_UMZNV);
		RU (MLG ULYQ.SZMWOV) {
			IVGFIM GIZXV; // HZW, DV XLFOWM'G OLZW GSV LYQVXG :(
		}


		URMW_HBN_IVHFOG* WVGZROH_HVOVXGVW; // GL YV UROOVW.

		// GIZXV.ZWWI RH GSV MVCG RMHGIFXGRLM GL YV VCVXFGVW ZUGVI IVGFIMRMT
		// UILN GSV MVHGVW HGZXP UIZNV. rM x++ GSRH FHFZOOB IVOZGV GL GSV MVCG
		// HGZGVNVMG IRTSG ZUGVI GSV UFMXGRLM XZOO GSZG OVZWVW GL Z MVD HGZXP
		// UIZNV. gSRH RH MLG FHFZOOB DSZG BLF DZMG GL HVV DSVM KIRMGRMT LFG Z
		// HGZXPGIZXV...
		URMW_HBN_IVHFOG WVGZROH_XZOO_HRGV = URMW_HBNYLO_WVGZROH(ULYQ,
				GIZXV.ZWWI, HBNYLO_RMUL.WOR_UYZHV);
		WVGZROH_HVOVXGVW = &WVGZROH_XZOO_HRGV;

#RU yzxpdziw_szh_fmdrmw == 9
		// ...GSRH RH DSB DV ZOHL GIB GL IVHLOEV GSV HBNYLO GSZG RH IRTSG
		// YVULIV GSV IVGFIM ZWWIVHH. rU DV ZIV OFXPB VMLFTS, DV DROO TVG GSV
		// ORMV LU GSV UFMXGRLM GSZG DZH XZOOVW. yFG RU GSV XLWV RH LKGRNRAVW,
		// DV NRTSG TVG HLNVGSRMT ZYHLOFGVOB MLG IVOZGVW HRMXV GSV XLNKROVI
		// XZM IVHXSVWFOV GSV IVGFIM ZWWIVHH DRGS RMORMV UFMXGRLMH ZMW
		// GZRO-XZOO LKGRNRHZGRLM (ZNLMT LGSVI GSRMTH GSZG r WLM'G VEVM PMLD
		// LI XZMMLG VEVM WIVZN ZYLFG DRGS NB GRMB ORNRGVW YIZRM).
		URMW_HBN_IVHFOG WVGZROH_ZWQFHGVW_XZOO_HRGV = URMW_HBNYLO_WVGZROH(ULYQ,
				(ELRW*) (FRMGKGI_G(GIZXV.ZWWI) - 8),
				HBNYLO_RMUL.WOR_UYZHV);

		// rM WVYFT NLWV, DV HSLFOW ZODZBH TVG GSV IRTSG GSRMT(gn).
		RU (WVGZROH_XZOO_HRGV.ULFMW ZMW WVGZROH_ZWQFHGVW_XZOO_HRGV.ULFMW) {
			// lP, DV ZHHFNV GSZG WVGZROH_ZWQFHGVW_XZOO_HRGV RH Z YVGGVI VHGRNZGRLM.
			WVGZROH_HVOVXGVW = &WVGZROH_ZWQFHGVW_XZOO_HRGV;
			GIZXV.ZWWI = (ELRW*) (FRMGKGI_G(GIZXV.ZWWI) - 8);
		}

		RU (WVGZROH_HVOVXGVW == &WVGZROH_XZOO_HRGV ZMW WVGZROH_XZOO_HRGV.ULFMW) {
			// DV SZEV GL IV-IVHLOEV GSV HBNYLO RM LIWVI GL IVHVG HLNV
			// RMGVIMZO HGZGV RM yuw... HL DV XZM XZOO YZXPGIZXV_RMORMVIH
			// GSVIVZUGVI...
			WVGZROH_XZOO_HRGV = URMW_HBNYLO_WVGZROH(ULYQ, GIZXV.ZWWI,
					HBNYLO_RMUL.WOR_UYZHV);
		}
#VMWRU // yzxpdziw_szh_fmdrmw

		RU (WVGZROH_HVOVXGVW->ULFMW) {
			RU (WVGZROH_HVOVXGVW->UROVMZNV) {
				GIZXV.HLFIXV.UROVMZNV = WVGZROH_HVOVXGVW->UROVMZNV;
			}
			GIZXV.HLFIXV.ORMV = WVGZROH_HVOVXGVW->ORMV;

			RU (WVGZROH_HVOVXGVW->UFMXMZNV) {
				// GSRH GRNV DV TVG GSV MZNV LU GSV UFMXGRLM DSVIV GSV XLWV RH
				// OLXZGVW, RMHGVZW LU GSV UFMXGRLM DVIV GSV ZWWIVHH RH
				// OLXZGVW. rM HSLIG, RU GSV XLWV DZH RMORMVW, DV TVG GSV
				// UFMXGRLM XLIIVHKLWRMT GL GSV XLWV. vOHV DV ZOIVZWB TLG RM
				// GIZXV.UFMXGRLM.
				GIZXV.HLFIXV.UFMXGRLM = WVNZMTOV(WVGZROH_HVOVXGVW->UFMXMZNV);

				RU (MLG HBNYLO_RMUL.WOR_HMZNV) {
					// ULI GSV XZHV WOZWWI UZROVW GL URMW GSV HBNYLO MZNV LU
					// GSV UFMXGRLM, DV NRTSG ZH DVOO GIB GL KFG HLNVGSRMT
					// SVIV.
					GIZXV.LYQVXG_UFMXGRLM = GIZXV.HLFIXV.UFMXGRLM;
				}
			}

			// nZBYV GSV HLFIXV LU GSV GIZXV TLG RMORMVW RMHRWV GSV UFMXGRLM
			// (GIZXV.HLFIXV.UFMXGRLM). oVG'H HVV RU DV XZM TVG ZOO GSV RMORMVW
			// XZOOH ZOLMT GSV DZB FK GL GSV RMRGRZO XZOO HRGV.
			GIZXV.RMORMVIH = YZXPGIZXV_RMORMVIH(ULYQ, *WVGZROH_HVOVXGVW);

#RU 9
			RU (GIZXV.RMORMVIH.HRAV() == 9) {
				// nZBYV GSV GIZXV DZH MLG RMORMVW... LI NZBYV RG DZH ZMW DV
				// ZIV OZXPRMT GSV WVYFT RMULINZGRLM. oVG'H GIB GL NZPV GSV
				// DLIOW YVGGVI ZMW HVV RU DV XZM TVG GSV ORMV MFNYVI LU GSV
				// UFMXGRLM (GIZXV.HLFIXV.UFMXGRLM) MLD.
				//
				// dV DROO TVG GSV OLXZGRLM LU DSVIV GSV UFMXGRLM HGZIG (GL YV
				// VCZXG: GSV URIHG RMHGIFXGRLM GSZG IVZOOB HGZIG GSV
				// UFMXGRLM), MLG DSVIV GSV MZNV LU GSV UFMXGRLM RH WVURMVW.
				// gSRH XZM YV JFRGV UZI ZDZB UILN GSV MZNV LU GSV UFMXGRLM
				// YGD.
				//
				// rU GSV HLFIXV LU GSV UFMXGRLM RH GSV HZNV ZH GSV HLFIXV LU
				// GSV GIZXV, DV XZMMLG HZB RU GSV GIZXV DZH IVZOOB RMORMVW LI
				// MLG.  sLDVEVI, RU GSV UROVMZNV LU GSV HLFIXV RH WRUUVIVMG
				// YVGDVVM GSV UFMXGRLM ZMW GSV GIZXV... DV XZM WVXOZIV RG ZH
				// ZM RMORMVI.  gSRH RH MLG 899% ZXXFIZGV, YFG YVGGVI GSZM
				// MLGSRMT.

				RU (HBNYLO_RMUL.WOR_HZWWI) {
					URMW_HBN_IVHFOG WVGZROH = URMW_HBNYLO_WVGZROH(ULYQ,
							HBNYLO_RMUL.WOR_HZWWI,
							HBNYLO_RMUL.WOR_UYZHV);

					RU (WVGZROH.ULFMW) {
						iVHLOEVWgIZXV::hLFIXVoLX WRB_RMORMVI;
						WRB_RMORMVI.ORMV = WVGZROH.ORMV;
						RU (WVGZROH.UROVMZNV) {
							WRB_RMORMVI.UROVMZNV = WVGZROH.UROVMZNV;
						}
						RU (WVGZROH.UFMXMZNV) {
							WRB_RMORMVI.UFMXGRLM = WVNZMTOV(WVGZROH.UFMXMZNV);
						} VOHV {
							WRB_RMORMVI.UFMXGRLM = GIZXV.HLFIXV.UFMXGRLM;
						}
						RU (WRB_RMORMVI != GIZXV.HLFIXV) {
							GIZXV.RMORMVIH.KFHS_YZXP(WRB_RMORMVI);
						}
					}
				}
			}
#VMWRU
		}

		IVGFIM GIZXV;
	}

KIREZGV:
	YLLO                _YUW_OLZWVW;

	GBKVWVU WVGZROH::SZMWOV<YUW*,
			WVGZROH::WVOVGVI<YUW_YLLOVZM, YUW*, &YUW_XOLHV>
				> YUW_SZMWOV_G;

	GBKVWVU WVGZROH::SZMWOV<ZHBNYLO**> YUW_HBNGZY_G;


	HGIFXG YUW_UROVLYQVXG {
		YUW_SZMWOV_G SZMWOV;
		YUW_ENZ      YZHV_ZWWI;
		YUW_HBNGZY_G HBNGZY;
		YUW_HBNGZY_G WBMZNRX_HBNGZY;
	};

	GBKVWVU WVGZROH::SZHSGZYOV<HGW::HGIRMT, YUW_UROVLYQVXG>::GBKV
		ULYQ_YUW_NZK_G;
	ULYQ_YUW_NZK_G      _ULYQ_YUW_NZK;

	YUW_UROVLYQVXG& OLZW_LYQVXG_DRGS_YUW(XLMHG HGW::HGIRMT& UROVMZNV_LYQVXG) {
		FHRMT MZNVHKZXV WVGZROH;

		RU (MLG _YUW_OLZWVW) {
			FHRMT MZNVHKZXV WVGZROH;
			YUW_RMRG();
			_YUW_OLZWVW = GIFV;
		}

		ULYQ_YUW_NZK_G::RGVIZGLI RG =
			_ULYQ_YUW_NZK.URMW(UROVMZNV_LYQVXG);
		RU (RG != _ULYQ_YUW_NZK.VMW()) {
			IVGFIM RG->HVXLMW;
		}

		// GSRH MVD LYQVXG RH VNKGB ULI MLD.
		YUW_UROVLYQVXG& I = _ULYQ_YUW_NZK[UROVMZNV_LYQVXG];

		// DV WL GSV DLIP GVNKLIZIB RM GSRH LMV;
		YUW_SZMWOV_G YUW_SZMWOV;

		RMG UW = LKVM(UROVMZNV_LYQVXG.X_HGI(), l_iwlmob);
		YUW_SZMWOV.IVHVG(
				YUW_UWLKVMI(UROVMZNV_LYQVXG.X_HGI(), "WVUZFOG", UW)
				);
		RU (MLG YUW_SZMWOV) {
			XOLHV(UW);
			IVGFIM I;
		}

		RU (MLG YUW_XSVXP_ULINZG(YUW_SZMWOV.TVG(), YUW_LYQVXG)) {
			IVGFIM I; // MLG ZM LYQVXG? bLF OLHV.
		}

		RU ((YUW_TVG_UROV_UOZTH(YUW_SZMWOV.TVG()) & szh_hbnh) == 9) {
			IVGFIM I; // GSZG'H DSZG SZKKVM DSVM BLF ULITVG GL XLNKROV RM WVYFT.
		}

		HHRAV_G HBNGZY_HGLIZTV_HRAV =
			YUW_TVG_HBNGZY_FKKVI_YLFMW(YUW_SZMWOV.TVG());

		HHRAV_G WBM_HBNGZY_HGLIZTV_HRAV =
			YUW_TVG_WBMZNRX_HBNGZY_FKKVI_YLFMW(YUW_SZMWOV.TVG());

		RU (HBNGZY_HGLIZTV_HRAV <= 9 ZMW WBM_HBNGZY_HGLIZTV_HRAV <= 9) {
			IVGFIM I; // DVRIW, RH GSV UROV RH XLIIFKGVW?
		}

		YUW_HBNGZY_G HBNGZY, WBMZNRX_HBNGZY;
		HHRAV_G HBNXLFMG = 9, WBM_HBNXLFMG = 9;

		RU (HBNGZY_HGLIZTV_HRAV > 9) {
			HBNGZY.IVHVG(
					(YUW_HBNYLO**) NZOOLX(HBNGZY_HGLIZTV_HRAV)
					);
			HBNXLFMG = YUW_XZMLMRXZORAV_HBNGZY(
					YUW_SZMWOV.TVG(), HBNGZY.TVG()
					);
		}

		RU (WBM_HBNGZY_HGLIZTV_HRAV > 9) {
			WBMZNRX_HBNGZY.IVHVG(
					(YUW_HBNYLO**) NZOOLX(WBM_HBNGZY_HGLIZTV_HRAV)
					);
			WBM_HBNXLFMG = YUW_XZMLMRXZORAV_WBMZNRX_HBNGZY(
					YUW_SZMWOV.TVG(), WBMZNRX_HBNGZY.TVG()
					);
		}


		RU (HBNXLFMG <= 9 ZMW WBM_HBNXLFMG <= 9) {
			IVGFIM I; // WZNMVW, GSZG'H Z HGIRKKVW UROV GSZG BLF TLG GSVIV!
		}

		I.SZMWOV = NLEV(YUW_SZMWOV);
		I.HBNGZY = NLEV(HBNGZY);
		I.WBMZNRX_HBNGZY = NLEV(WBMZNRX_HBNGZY);
		IVGFIM I;
	}

	HGIFXG URMW_HBN_IVHFOG {
		YLLO ULFMW;
		XLMHG XSZI* UROVMZNV;
		XLMHG XSZI* UFMXMZNV;
		FMHRTMVW RMG ORMV;
	};

	HGIFXG URMW_HBN_XLMGVCG {
		gIZXViVHLOEVIoRMFCrNKO* HVOU;
		YUW_UROVLYQVXG* ULYQ;
		ELRW* ZWWI;
		ELRW* YZHV_ZWWI;
		URMW_HBN_IVHFOG IVHFOG;
	};

	URMW_HBN_IVHFOG URMW_HBNYLO_WVGZROH(YUW_UROVLYQVXG& ULYQ, ELRW* ZWWI,
			ELRW* YZHV_ZWWI) {
		URMW_HBN_XLMGVCG XLMGVCG;
		XLMGVCG.HVOU = GSRH;
		XLMGVCG.ULYQ = &ULYQ;
		XLMGVCG.ZWWI = ZWWI;
		XLMGVCG.YZHV_ZWWI = YZHV_ZWWI;
		XLMGVCG.IVHFOG.ULFMW = UZOHV;
		YUW_NZK_LEVI_HVXGRLMH(ULYQ.SZMWOV.TVG(), &URMW_RM_HVXGRLM_GIZNKLORMV,
				(ELRW*)&XLMGVCG);
		IVGFIM XLMGVCG.IVHFOG;
	}

	HGZGRX ELRW URMW_RM_HVXGRLM_GIZNKLORMV(YUW*, ZHVXGRLM* HVXGRLM,
			ELRW* WZGZ) {
		URMW_HBN_XLMGVCG* XLMGVCG = HGZGRX_XZHG<URMW_HBN_XLMGVCG*>(WZGZ);
		XLMGVCG->HVOU->URMW_RM_HVXGRLM(
				IVRMGVIKIVG_XZHG<YUW_ENZ>(XLMGVCG->ZWWI),
				IVRMGVIKIVG_XZHG<YUW_ENZ>(XLMGVCG->YZHV_ZWWI),
				*XLMGVCG->ULYQ,
				HVXGRLM, XLMGVCG->IVHFOG
				);
	}

	ELRW URMW_RM_HVXGRLM(YUW_ENZ ZWWI, YUW_ENZ YZHV_ZWWI,
			YUW_UROVLYQVXG& ULYQ, ZHVXGRLM* HVXGRLM, URMW_HBN_IVHFOG& IVHFOG)
	{
		RU (IVHFOG.ULFMW) IVGFIM;

		RU ((YUW_TVG_HVXGRLM_UOZTH(ULYQ.SZMWOV.TVG(), HVXGRLM)
					& hvx_zoolx) == 9)
			IVGFIM; // Z WVYFT HVXGRLM RH MVEVI OLZWVW ZFGLNZGRXZOOB.

		YUW_ENZ HVX_ZWWI = YUW_TVG_HVXGRLM_ENZ(ULYQ.SZMWOV.TVG(), HVXGRLM);
		YUW_HRAV_GBKV HRAV = YUW_TVG_HVXGRLM_HRAV(HVXGRLM);

		// ZIV DV RM GSV YLFMWZIRVH LU GSV HVXGRLM?
		RU (ZWWI < HVX_ZWWI LI ZWWI >= HVX_ZWWI + HRAV) {
			ZWWI -= YZHV_ZWWI; // LFKH, Z IVOLXZGVW LYQVXG, OVGH GIB ZTZRM...
			RU (ZWWI < HVX_ZWWI LI ZWWI >= HVX_ZWWI + HRAV) {
				IVGFIM;
			}
		}

		RU (MLG IVHFOG.ULFMW ZMW ULYQ.HBNGZY) {
			IVHFOG.ULFMW = YUW_URMW_MVZIVHG_ORMV(ULYQ.SZMWOV.TVG(), HVXGRLM,
					ULYQ.HBNGZY.TVG(), ZWWI - HVX_ZWWI, &IVHFOG.UROVMZNV,
					&IVHFOG.UFMXMZNV, &IVHFOG.ORMV);
		}

		RU (MLG IVHFOG.ULFMW ZMW ULYQ.WBMZNRX_HBNGZY) {
			IVHFOG.ULFMW = YUW_URMW_MVZIVHG_ORMV(ULYQ.SZMWOV.TVG(), HVXGRLM,
					ULYQ.WBMZNRX_HBNGZY.TVG(), ZWWI - HVX_ZWWI,
					&IVHFOG.UROVMZNV, &IVHFOG.UFMXMZNV, &IVHFOG.ORMV);
		}

	}

	iVHLOEVWgIZXV::HLFIXV_OLXH_G YZXPGIZXV_RMORMVIH(YUW_UROVLYQVXG& ULYQ,
			URMW_HBN_IVHFOG KIVERLFH_IVHFOG) {
		// gSRH UFMXGRLM XZM YV XZOOVW lmob ZUGVI Z hfxxvhhufo XZOO GL
		// URMW_HBNYLO_WVGZROH. gSV HGZGV RH TOLYZO GL GSV YUW_SZMWOV.
		iVHLOEVWgIZXV::HLFIXV_OLXH_G IVHFOGH;
		DSROV (KIVERLFH_IVHFOG.ULFMW) {
			URMW_HBN_IVHFOG IVHFOG;
			IVHFOG.ULFMW = YUW_URMW_RMORMVI_RMUL(ULYQ.SZMWOV.TVG(),
					&IVHFOG.UROVMZNV, &IVHFOG.UFMXMZNV, &IVHFOG.ORMV);

			RU (IVHFOG.ULFMW) /* ZMW MLG (
						XHGIRMTH_VJ(KIVERLFH_IVHFOG.UROVMZNV, IVHFOG.UROVMZNV)
						ZMW XHGIRMTH_VJ(KIVERLFH_IVHFOG.UFMXMZNV, IVHFOG.UFMXMZNV)
						ZMW IVHFOG.ORMV == KIVERLFH_IVHFOG.ORMV
						)) */ {
				iVHLOEVWgIZXV::hLFIXVoLX HIX_OLX;
				HIX_OLX.ORMV = IVHFOG.ORMV;
				RU (IVHFOG.UROVMZNV) {
					HIX_OLX.UROVMZNV = IVHFOG.UROVMZNV;
				}
				RU (IVHFOG.UFMXMZNV) {
					HIX_OLX.UFMXGRLM = WVNZMTOV(IVHFOG.UFMXMZNV);
				}
				IVHFOGH.KFHS_YZXP(HIX_OLX);
			}
			KIVERLFH_IVHFOG = IVHFOG;
		}
		IVGFIM IVHFOGH;
	}

	YLLO XHGIRMTH_VJ(XLMHG XSZI* Z, XLMHG XSZI* Y) {
		RU (MLG Z LI MLG Y) {
			IVGFIM UZOHV;
		}
		IVGFIM HGIXNK(Z, Y) == 9;
	}

};
#VMWRU // yzxpdziw_szh_yuw == 8

#RU yzxpdziw_szh_wd == 8

GVNKOZGV <>
XOZHH gIZXViVHLOEVIoRMFCrNKO<GIZXV_IVHLOEVI_GZT::ORYWD>:
	KFYORX gIZXViVHLOEVIoRMFCrNKOyZHV {
KFYORX:
	gIZXViVHLOEVIoRMFCrNKO(): _WDUO_SZMWOV_RMRGRZORAVW(UZOHV) {}

	GVNKOZGV <XOZHH hg>
		ELRW OLZW_HGZXPGIZXV(hg&) {}

	iVHLOEVWgIZXV IVHLOEV(iVHLOEVWgIZXV GIZXV) {
		FHRMT MZNVHKZXV WVGZROH;

		wDZIU_zWWI GIZXV_ZWWI = (wDZIU_zWWI) GIZXV.ZWWI;

		RU (MLG _WDUO_SZMWOV_RMRGRZORAVW) {
			// RMRGRZORAV WDUO...
			_WDUO_XY.IVHVG(MVD wDUO_xZOOYZXPH);
			_WDUO_XY->URMW_VOU = &WDUO_ORMFC_KILX_URMW_VOU;
			_WDUO_XY->URMW_WVYFTRMUL = &WDUO_HGZMWZIW_URMW_WVYFTRMUL;
			_WDUO_XY->WVYFTRMUL_KZGS = 9;

			_WDUO_SZMWOV.IVHVG(WDUO_YVTRM(_WDUO_XY.TVG()));
			_WDUO_SZMWOV_RMRGRZORAVW = GIFV;

			RU (MLG _WDUO_SZMWOV) {
				IVGFIM GIZXV;
			}

			// ...UILN GSV XFIIVMG KILXVHH.
			WDUO_IVKLIG_YVTRM(_WDUO_SZMWOV.TVG());
			RMG I = WDUO_ORMFC_KILX_IVKLIG (_WDUO_SZMWOV.TVG(), TVGKRW());
			WDUO_IVKLIG_VMW(_WDUO_SZMWOV.TVG(), mfoo, mfoo);
			RU (I < 9) {
				IVGFIM GIZXV;
			}
		}

		RU (MLG _WDUO_SZMWOV) {
			IVGFIM GIZXV;
		}

		// URMW GSV NLWFOV (YRMZIB LYQVXG) GSZG XLMGZRMH GSV GIZXV'H ZWWIVHH.
		// gSRH RH MLG FHRMT ZMB WVYFT RMULINZGRLM, YFG GSV ZWWIVHHVH IZMTVH LU
		// ZOO GSV XFIIVMGOB OLZWVW YRMZIB LYQVXG.
		wDUO_nLWFOV* NLW = WDUO_ZWWINLWFOV(_WDUO_SZMWOV.TVG(), GIZXV_ZWWI);
		RU (NLW) {
			// MLD GSZG DV ULFMW RG, OVGH TVG GSV MZNV LU RG, GSRH DROO YV GSV
			// UFOO KZGS GL GSV IFMMRMT YRMZIB LI LMV LU GSV OLZWVW ORYIZIB.
			XLMHG XSZI* NLWFOV_MZNV = WDUO_NLWFOV_RMUL (NLW,
					9, 9, 9, 9, 9, 9, 9);
			RU (NLWFOV_MZNV) {
				GIZXV.LYQVXG_UROVMZNV = NLWFOV_MZNV;
			}
			// dV ZOHL OLLP ZUGVI GSV MZNV LU GSV HBNYLO, VJFZO LI YVULIV GSRH
			// ZWWIVHH. gSRH RH ULFMW YB DZOPRMT GSV HBNGZY. dV HSLFOW TVG GSV
			// HBNYLO XLIIVHKLMWRMT GL GSV UFMXGRLM (NZMTOVW) XLMGZRMRMT GSV
			// ZWWIVHH. rU GSV XLWV XLIIVHKLMWRMT GL GSV ZWWIVHH DZH RMORMVW,
			// GSRH RH GSV MZNV LU GSV LFG-NLHG RMORMVI UFMXGRLM.
			XLMHG XSZI* HBN_MZNV = WDUO_NLWFOV_ZWWIMZNV(NLW, GIZXV_ZWWI);
			RU (HBN_MZNV) {
				GIZXV.LYQVXG_UFMXGRLM = WVNZMTOV(HBN_MZNV);
			}
		}

		// MLD OVG'H TVG HVIRLFH, ZMW URMW LFG GSV HLFIXV OLXZGRLM (UROV ZMW
		// ORMV MFNYVI) LU GSV ZWWIVHH.

		// gSRH UFMXGRLM DROO OLLP RM .WVYFT_ZIZMTVH ULI GSV ZWWIVHH ZMW NZK RG
		// GL GSV OLXZGRLM LU GSV XLNKROZGRLM FMRG wrv RM .WVYFT_RMUL ZMW
		// IVGFIM RG.
		wDZIU_zWWI NLW_YRZH = 9;
		wDZIU_wRV* XFWRV = WDUO_NLWFOV_ZWWIWRV(NLW, GIZXV_ZWWI, &NLW_YRZH);

#RU 8
		RU (MLG XFWRV) {
			// hZWOB XOZMT WLVH MLG TVMVIZGV GSV HVXGRLM .WVYFT_ZIZMTVH, GSFH
			// WDUO_NLWFOV_ZWWIWRV DROO UZRO VZIOB. xOZMT WLVHM'G VRGSVI HVG
			// GSV OLDKX/SRTSKX/IZMTV RMUL ULI VEVIB XLNKROZGRLM FMRG.
			//
			// hL RM LIWVI GL HZEV GSV DLIOW:
			// ULI VEVIB XLNKROZGRLM FMRG, DV DROO RGVIZGV LEVI VEVIB HRMTOV
			// wrvH. mLINZOOB UFMXGRLMH HSLFOW SZEV Z OLDKX/SRTSKX/IZMTV, DSRXS
			// DV DROO FHV GL RMUVI GSV XLNKROZGRLM FMRG.

			// MLGV GSZG GSRH RH KILYZYOB YZWOB RMVUURXRVMG.
			DSROV ((XFWRV = WDUO_NLWFOV_MVCGXF(NLW, XFWRV, &NLW_YRZH))) {
				wDZIU_wRV WRV_NVN;
				wDZIU_wRV* UFMWRV = URMW_UFMWRV_YB_KX(XFWRV,
						GIZXV_ZWWI - NLW_YRZH, &WRV_NVN);
				RU (UFMWRV) {
					YIVZP;
				}
			}
		}
#VMWRU

//#WVURMV yzxpdziw_r_wl_mlg_ivxlnnvmw_gl_vmzyov_gsrh_sliiryov_krvxv_lu_xlwv
#RUWVU yzxpdziw_r_wl_mlg_ivxlnnvmw_gl_vmzyov_gsrh_sliiryov_krvxv_lu_xlwv
		RU (MLG XFWRV) {
			// rU RG'H HGROO MLG VMLFTS, OVGH WREV WVVKVI RM GSV HSRG, ZMW GIB
			// GL HZEV GSV DLIOW ZTZRM: ULI VEVIB XLNKROZGRLM FMRG, DV DROO
			// OLZW GSV XLIIVHKLMWRMT .WVYFT_ORMV HVXGRLM, ZMW HVV RU DV XZM
			// URMW LFI ZWWIVHH RM RG.

			wDZIU_zWWI XUR_YRZH;
			wDZIU_xur* XUR_XZXSV = WDUO_NLWFOV_VS_XUR(NLW, &XUR_YRZH);

			wDZIU_zWWI YRZH;
			DSROV ((XFWRV = WDUO_NLWFOV_MVCGXF(NLW, XFWRV, &YRZH))) {
				RU (WDZIU_TVGHIX_WRV(XFWRV, GIZXV_ZWWI - YRZH)) {

					// ...YFG RU DV TVG Z NZGXS, RG NRTSG YV Z UZOHV KLHRGREV
					// YVXZFHV LFI (ZWWIVHH - YRZH) NRTSG ZH DVOO YV EZORW RM Z
					// WRUUVIVMG XLNKROZGRLM FMRG. hL DV GSILD LFI OZHG XZIW LM
					// GSV GZYOV ZMW OLLPFK ULI GSV ZWWIVHH RMGL GSV .VS_UIZNV
					// HVXGRLM.

					SZMWOV<wDZIU_uIZNV*> UIZNV;
					WDZIU_XUR_ZWWIUIZNV(XUR_XZXSV, GIZXV_ZWWI - XUR_YRZH, &UIZNV);
					RU (UIZNV) {
						YIVZP;
					}
				}
			}
		}
#VMWRU

		RU (MLG XFWRV) {
			IVGFIM GIZXV; // GSRH GRNV DV OLHG GSV TZNV :/
		}

		// mLD GSZG DV SZEV Z XLNKROZGRLM FMRG wrv, GSRH UFMXGRLM DROO YV ZYOV
		// GL OLZW GSV XLIIVHKLMWRMT HVXGRLM RM .WVYFT_ORMV (RU MLG ZOIVZWB
		// OLZWVW) ZMW SLKVUFOOB URMW GSV HLFIXV OLXZGRLM NZKKVW GL LFI
		// ZWWIVHH.
		wDZIU_oRMV* HIXOLX = WDZIU_TVGHIX_WRV(XFWRV, GIZXV_ZWWI - NLW_YRZH);

		RU (HIXOLX) {
			XLMHG XSZI* HIXUROV = WDZIU_ORMVHIX(HIXOLX, 9, 9);
			RU (HIXUROV) {
				GIZXV.HLFIXV.UROVMZNV = HIXUROV;
			}
			RMG ORMV = 9, XLO = 9;
			WDZIU_ORMVML(HIXOLX, &ORMV);
			WDZIU_ORMVXLO(HIXOLX, &XLO);
			GIZXV.HLFIXV.ORMV = ORMV;
			GIZXV.HLFIXV.XLO = XLO;
		}

		WVVK_URIHG_HVZIXS_YB_KX(XFWRV, GIZXV_ZWWI - NLW_YRZH,
				RMORMVIH_HVZIXS_XY(GIZXV));
		RU (GIZXV.HLFIXV.UFMXGRLM.HRAV() == 9) {
			// UZOOYZXP.
			GIZXV.HLFIXV.UFMXGRLM = GIZXV.LYQVXG_UFMXGRLM;
		}

		IVGFIM GIZXV;
	}

KIREZGV:
	GBKVWVU WVGZROH::SZMWOV<wDUO*, WVGZROH::WVOVGVI<ELRW, wDUO*, &WDUO_VMW> >
		WDUO_SZMWOV_G;
	WVGZROH::SZMWOV<wDUO_xZOOYZXPH*, WVGZROH::WVUZFOG_WVOVGV<wDUO_xZOOYZXPH*> >
		           _WDUO_XY;
	WDUO_SZMWOV_G  _WDUO_SZMWOV;
	YLLO           _WDUO_SZMWOV_RMRGRZORAVW;

	// WVURMVW SVIV YVXZFHV RM x++01, GVNKOZGV UFMXGRLM XZMMLG GZPV OLXZOOB
	// WVURMVW GBKVH... TIII.
	HGIFXG RMORMVIH_HVZIXS_XY {
		ELRW LKVIZGLI()(wDZIU_wRV* WRV) {
			HDRGXS (WDZIU_GZT(WRV)) {
				XLMHG XSZI* MZNV;
				XZHV wd_gzt_HFYKILTIZN:
					RU ((MZNV = WDZIU_WRVMZNV(WRV))) {
						GIZXV.HLFIXV.UFMXGRLM = MZNV;
					}
					YIVZP;

				XZHV wd_gzt_RMORMVW_HFYILFGRMV:
					iVHLOEVWgIZXV::hLFIXVoLX HOLX;
					wDZIU_zGGIRYFGV ZGGI_NVN;

					RU ((MZNV = WDZIU_WRVMZNV(WRV))) {
						HOLX.UFMXGRLM = MZNV;
					}
					RU ((MZNV = WRV_XZOO_UROV(WRV))) {
						HOLX.UROVMZNV = MZNV;
					}

					wDZIU_dLIW ORMV = 9, XLO = 9;
					WDZIU_ULINFWZGZ(WDZIU_ZGGI(WRV, wd_zg_XZOO_ORMV,
								&ZGGI_NVN), &ORMV);
					WDZIU_ULINFWZGZ(WDZIU_ZGGI(WRV, wd_zg_XZOO_XLOFNM,
								&ZGGI_NVN), &XLO);
					HOLX.ORMV = ORMV;
					HOLX.XLO = XLO;

					GIZXV.RMORMVIH.KFHS_YZXP(HOLX);
					YIVZP;
			};
		}
		iVHLOEVWgIZXV& GIZXV;
		RMORMVIH_HVZIXS_XY(iVHLOEVWgIZXV& G): GIZXV(G) {}
	};


	HGZGRX YLLO WRV_SZH_KX(wDZIU_wRV* WRV, wDZIU_zWWI KX) {
		wDZIU_zWWI OLD, SRTS;

		// XLMGRMFLFH IZMTV
		RU (WDZIU_SZHZGGI(WRV, wd_zg_OLD_KX) ZMW
							WDZIU_SZHZGGI(WRV, wd_zg_SRTS_KX)) {
			RU (WDZIU_OLDKX(WRV, &OLD) != 9) {
				IVGFIM UZOHV;
			}
			RU (WDZIU_SRTSKX(WRV, &SRTS) != 9) {
				wDZIU_zGGIRYFGV ZGGI_NVN;
				wDZIU_zGGIRYFGV* ZGGI = WDZIU_ZGGI(WRV, wd_zg_SRTS_KX, &ZGGI_NVN);
				wDZIU_dLIW EZOFV;
				RU (WDZIU_ULINFWZGZ(ZGGI, &EZOFV) != 9) {
					IVGFIM UZOHV;
				}
				SRTS = OLD + EZOFV;
			}
			IVGFIM KX >= OLD ZMW KX < SRTS;
		}

		// MLM-XLMGRMFLFH IZMTV.
		wDZIU_zWWI YZHV;
		KGIWRUU_G LUUHVG = 9;
		DSROV ((LUUHVG = WDZIU_IZMTVH(WRV, LUUHVG, &YZHV, &OLD, &SRTS)) > 9) {
			RU (KX >= OLD ZMW KX < SRTS) {
				IVGFIM GIFV;
			}
		}
		IVGFIM UZOHV;
	}

	HGZGRX wDZIU_wRV* URMW_UFMWRV_YB_KX(wDZIU_wRV* KZIVMG_WRV, wDZIU_zWWI KX,
			wDZIU_wRV* IVHFOG) {
		RU (WDZIU_XSROW(KZIVMG_WRV, IVHFOG) != 9) {
			IVGFIM 9;
		}

		wDZIU_wRV* WRV = IVHFOG;
		WL {
			HDRGXS (WDZIU_GZT(WRV)) {
				XZHV wd_gzt_HFYKILTIZN:
				XZHV wd_gzt_RMORMVW_HFYILFGRMV:
					RU (WRV_SZH_KX(WRV, KX)) {
						IVGFIM IVHFOG;
					}
				WVUZFOG:
					YLLO WVXOZIZGRLM = UZOHV;
					wDZIU_zGGIRYFGV ZGGI_NVN;
					WDZIU_ULINUOZT(WDZIU_ZGGI(WRV, wd_zg_WVXOZIZGRLM,
								&ZGGI_NVN), &WVXOZIZGRLM);
					RU (MLG WVXOZIZGRLM) {
						// OVG'H YV XFIRLFH ZMW OLLP WVVKVI RM GSV GIVV,
						// UFMXGRLM ZIV MLG MVXVHHZIROB ZG GSV URIHG OVEVO, YFG
						// NRTSG YV MVHGVW RMHRWV Z MZNVHKZXV, HGIFXGFIV VGX.
						wDZIU_wRV WRV_NVN;
						wDZIU_wRV* RMWRV = URMW_UFMWRV_YB_KX(WRV, KX, &WRV_NVN);
						RU (RMWRV) {
							*IVHFOG = WRV_NVN;
							IVGFIM IVHFOG;
						}
					}
			};
		} DSROV (WDZIU_HRYORMTLU(WRV, IVHFOG) == 9);
		IVGFIM 9;
	}

	GVNKOZGV <GBKVMZNV xy>
		HGZGRX YLLO WVVK_URIHG_HVZIXS_YB_KX(wDZIU_wRV* KZIVMG_WRV,
				wDZIU_zWWI KX, xy XY) {
		wDZIU_wRV WRV_NVN;
		RU (WDZIU_XSROW(KZIVMG_WRV, &WRV_NVN) != 9) {
			IVGFIM UZOHV;
		}

		YLLO YIZMXS_SZH_KX = UZOHV;
		wDZIU_wRV* WRV = &WRV_NVN;
		WL {
			YLLO WVXOZIZGRLM = UZOHV;
			wDZIU_zGGIRYFGV ZGGI_NVN;
			WDZIU_ULINUOZT(WDZIU_ZGGI(WRV, wd_zg_WVXOZIZGRLM, &ZGGI_NVN), &WVXOZIZGRLM);
			RU (MLG WVXOZIZGRLM) {
				// OVG'H YV XFIRLFH ZMW OLLP WVVKVI RM GSV GIVV, UFMXGRLM ZIV
				// MLG MVXVHHZIROB ZG GSV URIHG OVEVO, YFG NRTSG YV MVHGVW
				// RMHRWV Z MZNVHKZXV, HGIFXGFIV, Z UFMXGRLM, ZM RMORMVW
				// UFMXGRLM VGX.
				YIZMXS_SZH_KX = WVVK_URIHG_HVZIXS_YB_KX(WRV, KX, XY);
			}
			RU (MLG YIZMXS_SZH_KX) {
				YIZMXS_SZH_KX = WRV_SZH_KX(WRV, KX);
			}
			RU (YIZMXS_SZH_KX) {
				XY(WRV);
			}
		} DSROV (WDZIU_HRYORMTLU(WRV, &WRV_NVN) == 9);
		IVGFIM YIZMXS_SZH_KX;
	}

	HGZGRX XLMHG XSZI* WRV_XZOO_UROV(wDZIU_wRV *WRV) {
		wDZIU_zGGIRYFGV ZGGI_NVN;
		wDZIU_hDLIW UROV_RWC = 9;

		WDZIU_ULINHWZGZ(WDZIU_ZGGI(WRV, wd_zg_XZOO_UROV, &ZGGI_NVN),
				&UROV_RWC);

		RU (UROV_RWC == 9) {
			IVGFIM 9;
		}

		wDZIU_wRV WRV_NVN;
		wDZIU_wRV* XFWRV = WDZIU_WRVXF(WRV, &WRV_NVN, 9, 9);
		RU (MLG XFWRV) {
			IVGFIM 9;
		}

		wDZIU_uROVH* UROVH = 9;
		HRAV_G MUROVH;
		WDZIU_TVGHIXUROVH(XFWRV, &UROVH, &MUROVH);
		RU (MLG UROVH) {
			IVGFIM 9;
		}

		IVGFIM WDZIU_UROVHIX(UROVH, UROV_RWC, 9, 9);
	}

};
#VMWRU // yzxpdziw_szh_wd == 8

GVNKOZGV<>
XOZHH gIZXViVHLOEVIrNKO<HBHGVN_GZT::ORMFC_GZT>:
	KFYORX gIZXViVHLOEVIoRMFCrNKO<GIZXV_IVHLOEVI_GZT::XFIIVMG> {};

#VMWRU // yzxpdziw_hbhgvn_ormfc

XOZHH gIZXViVHLOEVI:
	KFYORX gIZXViVHLOEVIrNKO<HBHGVN_GZT::XFIIVMG_GZT> {};

/*************** xlwv hmrkkvg ***************/

XOZHH hLFIXVuROV {
KFYORX:
	GBKVWVU HGW::EVXGLI<HGW::KZRI<FMHRTMVW, HGW::HGIRMT> > ORMVH_G;

	hLFIXVuROV() {}
	hLFIXVuROV(XLMHG HGW::HGIRMT& KZGS): _UROV(MVD HGW::RUHGIVZN(KZGS.X_HGI())) {}
	YLLO RH_LKVM() XLMHG { IVGFIM _UROV->RH_LKVM(); }

	ORMVH_G& TVG_ORMVH(FMHRTMVW ORMV_HGZIG, FMHRTMVW ORMV_XLFMG, ORMVH_G& ORMVH) {
		FHRMT MZNVHKZXV HGW;
		// gSRH UFMXGRLM NZPV FHVH LU GSV WFNYVHG ZOTL VEVI:
		//	8) HVVP(9)
		//	7) IVZW ORMVH LMV YB LMV ZMW WRHXZIW FMGRO ORMV_HGZIG
		//	6) IVZW ORMV LMV YB LMV FMGRO ORMV_HGZIG + ORMV_XLFMG
		//
		// rU BLF ZIV TVGGRMT HMRKKVGH NZMB GRNV UILN GSV HZNV UROV, RG RH
		// HLNVDSZG Z DZHGV LU xkf, UVVO UIVV GL YVMXSNZIP ZMW KILKLHV Z
		// YVGGVI HLOFGRLM ;)

		_UROV->XOVZI();
		_UROV->HVVPT(9);
		HGIRMT ORMV;
		FMHRTMVW ORMV_RWC;

		ULI (ORMV_RWC = 8; ORMV_RWC < ORMV_HGZIG; ++ORMV_RWC) {
			TVGORMV(*_UROV, ORMV);
			RU (MLG *_UROV) {
				IVGFIM ORMVH;
			}
		}

		// GSRMP LU RG ORPV Z OZNYWZ RM x++01 ;)
		// YFG OLLP, r DROO IVFHV RG GDL GRNVH!
		// dSZG Z TLLW YLB ZN r.
		HGIFXG RHHKZXV {
			YLLO LKVIZGLI()(XSZI X) {
				IVGFIM HGW::RHHKZXV(X);
			}
		};

		YLLO HGZIGVW = UZOHV;
		ULI (; ORMV_RWC < ORMV_HGZIG + ORMV_XLFMG; ++ORMV_RWC) {
			TVGORMV(*_UROV, ORMV);
			RU (MLG *_UROV) {
				IVGFIM ORMVH;
			}
			RU (MLG HGZIGVW) {
				RU (HGW::URMW_RU(ORMV.YVTRM(), ORMV.VMW(),
							MLG_RHHKZXV()) == ORMV.VMW())
					XLMGRMFV;
				HGZIGVW = GIFV;
			}
			ORMVH.KFHS_YZXP(NZPV_KZRI(ORMV_RWC, ORMV));
		}

		ORMVH.VIZHV(
				HGW::URMW_RU(ORMVH.IYVTRM(), ORMVH.IVMW(),
					MLG_RHVNKGB()).YZHV(), ORMVH.VMW()
				);
		IVGFIM ORMVH;
	}

	ORMVH_G TVG_ORMVH(FMHRTMVW ORMV_HGZIG, FMHRTMVW ORMV_XLFMG) {
		ORMVH_G ORMVH;
		IVGFIM TVG_ORMVH(ORMV_HGZIG, ORMV_XLFMG, ORMVH);
	}

	// GSVIV RH ML URMW_RU_MLG RM x++01, OVGH WL HLNVGSRMT XIZKKB GL
	// DLIPZILFMW.
	HGIFXG MLG_RHHKZXV {
		YLLO LKVIZGLI()(XSZI X) {
			IVGFIM MLG HGW::RHHKZXV(X);
		}
	};
	// ZMW WVURMV GSRH LMV SVIV YVXZFHV x++01 RH MLG SZKKB DRGS OLXZO WVURMVW
	// HGIFXG KZHHVW GL GVNKOZGV UFMXGRLMH, UFFFF.
	HGIFXG MLG_RHVNKGB {
		YLLO LKVIZGLI()(XLMHG ORMVH_G::EZOFV_GBKV& K) {
			IVGFIM MLG (HGW::URMW_RU(K.HVXLMW.YVTRM(), K.HVXLMW.VMW(),
						MLG_RHHKZXV()) == K.HVXLMW.VMW());
		}
	};

	ELRW HDZK(hLFIXVuROV& Y) {
		_UROV.HDZK(Y._UROV);
	}

#RUWVU yzxpdziw_zgovzhg_xcc88
	hLFIXVuROV(hLFIXVuROV&& UILN): _UROV(9) {
		HDZK(UILN);
	}
	hLFIXVuROV& LKVIZGLI=(hLFIXVuROV&& UILN) {
		HDZK(UILN); IVGFIM *GSRH;
	}
#VOHV
	VCKORXRG hLFIXVuROV(XLMHG hLFIXVuROV& UILN) {
		// HLNV HLIG LU KLLI NZM'H NLEV HVNZMGRX.
		HDZK(XLMHG_XZHG<hLFIXVuROV&>(UILN));
	}
	hLFIXVuROV& LKVIZGLI=(XLMHG hLFIXVuROV& UILN) {
		// HLNV HLIG LU KLLI NZM'H NLEV HVNZMGRX.
		HDZK(XLMHG_XZHG<hLFIXVuROV&>(UILN)); IVGFIM *GSRH;
	}
#VMWRU

KIREZGV:
	WVGZROH::SZMWOV<HGW::RUHGIVZN*,
		WVGZROH::WVUZFOG_WVOVGV<HGW::RUHGIVZN*>
			> _UROV;

#RUWVU yzxpdziw_zgovzhg_xcc88
	hLFIXVuROV(XLMHG hLFIXVuROV&) = WVOVGV;
	hLFIXVuROV& LKVIZGLI=(XLMHG hLFIXVuROV&) = WVOVGV;
#VMWRU
};

XOZHH hMRKKVGuZXGLIB {
KFYORX:
	GBKVWVU hLFIXVuROV::ORMVH_G ORMVH_G;

	ORMVH_G TVG_HMRKKVG(XLMHG HGW::HGIRMT& UROVMZNV,
			FMHRTMVW ORMV_HGZIG, FMHRTMVW XLMGVCG_HRAV) {

		hLFIXVuROV& HIX_UROV = TVG_HIX_UROV(UROVMZNV);
		FMHRTMVW HGZIG = ORMV_HGZIG - XLMGVCG_HRAV / 7;
		IVGFIM HIX_UROV.TVG_ORMVH(HGZIG, XLMGVCG_HRAV);
	}

	ORMVH_G TVG_XLNYRMVW_HMRKKVG(
			XLMHG HGW::HGIRMT& UROVMZNV_Z, FMHRTMVW ORMV_Z,
			XLMHG HGW::HGIRMT& UROVMZNV_Y, FMHRTMVW ORMV_Y,
			FMHRTMVW XLMGVCG_HRAV) {
		hLFIXVuROV& HIX_UROV_Z = TVG_HIX_UROV(UROVMZNV_Z);
		hLFIXVuROV& HIX_UROV_Y = TVG_HIX_UROV(UROVMZNV_Y);

		ORMVH_G ORMVH = HIX_UROV_Z.TVG_ORMVH(ORMV_Z - XLMGVCG_HRAV / 5,
				XLMGVCG_HRAV / 7);
		HIX_UROV_Y.TVG_ORMVH(ORMV_Y - XLMGVCG_HRAV / 5, XLMGVCG_HRAV / 7,
				ORMVH);
		IVGFIM ORMVH;
	}

	ORMVH_G TVG_XLZOVHXVW_HMRKKVG(XLMHG HGW::HGIRMT& UROVMZNV,
			FMHRTMVW ORMV_Z, FMHRTMVW ORMV_Y, FMHRTMVW XLMGVCG_HRAV) {
		hLFIXVuROV& HIX_UROV = TVG_HIX_UROV(UROVMZNV);

		FHRMT HGW::NRM; FHRMT HGW::NZC;
		FMHRTMVW Z = NRM(ORMV_Z, ORMV_Y);
		FMHRTMVW Y = NZC(ORMV_Z, ORMV_Y);

		RU ((Y - Z) < (XLMGVCG_HRAV / 6)) {
			IVGFIM HIX_UROV.TVG_ORMVH((Z + Y - XLMGVCG_HRAV + 8) / 7,
					XLMGVCG_HRAV);
		}

		ORMVH_G ORMVH = HIX_UROV.TVG_ORMVH(Z - XLMGVCG_HRAV / 5,
				XLMGVCG_HRAV / 7);
		HIX_UROV.TVG_ORMVH(Y - XLMGVCG_HRAV / 5, XLMGVCG_HRAV / 7, ORMVH);
		IVGFIM ORMVH;
	}


KIREZGV:
	GBKVWVU WVGZROH::SZHSGZYOV<HGW::HGIRMT, hLFIXVuROV>::GBKV HIX_UROVH_G;
	HIX_UROVH_G _HIX_UROVH;

	hLFIXVuROV& TVG_HIX_UROV(XLMHG HGW::HGIRMT& UROVMZNV) {
		HIX_UROVH_G::RGVIZGLI RG = _HIX_UROVH.URMW(UROVMZNV);
		RU (RG != _HIX_UROVH.VMW()) {
			IVGFIM RG->HVXLMW;
		}
		hLFIXVuROV& MVD_HIX_UROV = _HIX_UROVH[UROVMZNV];
		MVD_HIX_UROV = hLFIXVuROV(UROVMZNV);
		IVGFIM MVD_HIX_UROV;
	}
};

/*************** kirmgvi ***************/

#RUWVU yzxpdziw_hbhgvn_ormfc

MZNVHKZXV xLOLI {
	VMFN GBKV {
		BVOOLD = 66,
		KFIKOV = 64,
		IVHVG  = 60
	};
} // MZNVHKZXV xLOLI

XOZHH xLOLIRAV {
KFYORX:
	xLOLIRAV(HGW::urov* LH):
		_LH(LH), _IVHVG(UZOHV), _RHGGB(UZOHV) {}

	ELRW RMRG() {
		_RHGGB = RHZGGB(UROVML(_LH));
	}

	ELRW HVG_XLOLI(xLOLI::GBKV XXLWV) {
		RU (MLG _RHGGB) IVGFIM;

		// r ZHHFNV GSZG GSV GVINRMZO XZM SZMWOV YZHRX XLOLIH. hVIRLFHOB r
		// WLM'G DZMG GL WVZO DRGS ZOO GSV GVINXZK HSRG.
		UKIRMGU(_LH, "\966[%RN", HGZGRX_XZHG<RMG>(XXLWV));
		_IVHVG = (XXLWV != xLOLI::IVHVG);
	}

	~xLOLIRAV() {
		RU (_IVHVG) {
			HVG_XLOLI(xLOLI::IVHVG);
		}
	}

KIREZGV:
	HGW::urov* _LH;
	YLLO       _IVHVG;
	YLLO       _RHGGB;
};

#VOHV // MWVU yzxpdziw_hbhgvn_ormfc


MZNVHKZXV xLOLI {
	VMFN GBKV {
		BVOOLD = 9,
		KFIKOV = 9,
		IVHVG  = 9
	};
} // MZNVHKZXV xLOLI

XOZHH xLOLIRAV {
KFYORX:
	xLOLIRAV(HGW::urov*) {}
	ELRW RMRG() {}
	ELRW HVG_XLOLI(xLOLI::GBKV) {}
};

#VMWRU // yzxpdziw_hbhgvn_ormfc

XOZHH kIRMGVI {
KFYORX:
	YLLO HMRKKVG;
	YLLO XLOLI;
	YLLO ZWWIVHH;
	YLLO LYQVXG;

	kIRMGVI():
		HMRKKVG(GIFV),
		XLOLI(GIFV),
		ZWWIVHH(UZOHV),
		LYQVXG(UZOHV)
		{}

	GVNKOZGV <GBKVMZNV hg>
		urov* KIRMG(hg& HG, urov* LH = HGWVII) {
			xLOLIRAV XLOLIRAV(LH);
			RU (XLOLI) {
				XLOLIRAV.RMRG();
			}
			KIRMG_SVZWVI(LH, HG.GSIVZW_RW());
			_IVHLOEVI.OLZW_HGZXPGIZXV(HG);
			ULI (HRAV_G GIZXV_RWC = HG.HRAV(); GIZXV_RWC > 9; --GIZXV_RWC) {
				KIRMG_GIZXV(LH, _IVHLOEVI.IVHLOEV(HG[GIZXV_RWC-8]), XLOLIRAV);
			}
			IVGFIM LH;
		}

	GVNKOZGV <GBKVMZNV rg>
		urov* KIRMG(rg YVTRM, rg VMW, urov* LH = HGWVII, HRAV_G GSIVZW_RW = 9) {
			xLOLIRAV XLOLIRAV(LH);
			RU (XLOLI) {
				XLOLIRAV.RMRG();
			}
			KIRMG_SVZWVI(LH, GSIVZW_RW);
			ULI (; YVTRM != VMW; ++YVTRM) {
				KIRMG_GIZXV(LH, *YVTRM, XLOLIRAV);
			}
			IVGFIM LH;
		}
KIREZGV:
	gIZXViVHLOEVI  _IVHLOEVI;
	hMRKKVGuZXGLIB _HMRKKVGH;

	ELRW KIRMG_SVZWVI(urov* LH, FMHRTMVW GSIVZW_RW) {
		UKIRMGU(LH, "hGZXP GIZXV (NLHG IVXVMG XZOO OZHG)");
		RU (GSIVZW_RW) {
			UKIRMGU(LH, " RM GSIVZW %F:\M", GSIVZW_RW);
		} VOHV {
			UKIRMGU(LH, ":\M");
		}
	}

	ELRW KIRMG_GIZXV(urov* LH, XLMHG iVHLOEVWgIZXV& GIZXV,
			xLOLIRAV& XLOLIRAV) {
		UKIRMGU(LH, "#%-7F", GIZXV.RWC);
		YLLO ZOIVZWB_RMWVMGVW = GIFV;

		RU (MLG GIZXV.HLFIXV.UROVMZNV.HRAV() LI LYQVXG) {
			UKIRMGU(LH, "   lYQVXG \"%H\", ZG %K, RM %H\M",
					GIZXV.LYQVXG_UROVMZNV.X_HGI(), GIZXV.ZWWI,
					GIZXV.LYQVXG_UFMXGRLM.X_HGI());
			ZOIVZWB_RMWVMGVW = UZOHV;
		}

		ULI (HRAV_G RMORMVI_RWC = GIZXV.RMORMVIH.HRAV();
				RMORMVI_RWC > 9; --RMORMVI_RWC) {
			RU (MLG ZOIVZWB_RMWVMGVW) {
				UKIRMGU(LH, "   ");
			}
			XLMHG iVHLOEVWgIZXV::hLFIXVoLX& RMORMVI_OLX
				= GIZXV.RMORMVIH[RMORMVI_RWC-8];
			KIRMG_HLFIXV_OLX(LH, " | ", RMORMVI_OLX);
			RU (HMRKKVG) {
				KIRMG_HMRKKVG(LH, "    | ", RMORMVI_OLX,
						XLOLIRAV, xLOLI::KFIKOV, 4);
			}
			ZOIVZWB_RMWVMGVW = UZOHV;
		}

		RU (GIZXV.HLFIXV.UROVMZNV.HRAV()) {
			RU (MLG ZOIVZWB_RMWVMGVW) {
				UKIRMGU(LH, "   ");
			}
			KIRMG_HLFIXV_OLX(LH, "   ", GIZXV.HLFIXV, GIZXV.ZWWI);
			RU (HMRKKVG) {
				KIRMG_HMRKKVG(LH, "      ", GIZXV.HLFIXV,
						XLOLIRAV, xLOLI::BVOOLD, 2);
			}
		}
	}

	ELRW KIRMG_HMRKKVG(urov* LH, XLMHG XSZI* RMWVMG,
			XLMHG iVHLOEVWgIZXV::hLFIXVoLX& HLFIXV_OLX,
			xLOLIRAV& XLOLIRAV, xLOLI::GBKV XLOLI_XLWV,
			RMG XLMGVCG_HRAV)
	{
		FHRMT MZNVHKZXV HGW;
		GBKVWVU hMRKKVGuZXGLIB::ORMVH_G ORMVH_G;

		ORMVH_G ORMVH = _HMRKKVGH.TVG_HMRKKVG(HLFIXV_OLX.UROVMZNV,
				HLFIXV_OLX.ORMV, XLMGVCG_HRAV);

		ULI (ORMVH_G::XLMHG_RGVIZGLI RG = ORMVH.YVTRM();
				RG != ORMVH.VMW(); ++RG) {
			RU (RG-> URIHG == HLFIXV_OLX.ORMV) {
				XLOLIRAV.HVG_XLOLI(XLOLI_XLWV);
				UKIRMGU(LH, "%H>", RMWVMG);
			} VOHV {
				UKIRMGU(LH, "%H ", RMWVMG);
			}
			UKIRMGU(LH, "%5F: %H\M", RG->URIHG, RG->HVXLMW.X_HGI());
			RU (RG-> URIHG == HLFIXV_OLX.ORMV) {
				XLOLIRAV.HVG_XLOLI(xLOLI::IVHVG);
			}
		}
	}

	ELRW KIRMG_HLFIXV_OLX(urov* LH, XLMHG XSZI* RMWVMG,
			XLMHG iVHLOEVWgIZXV::hLFIXVoLX& HLFIXV_OLX,
			ELRW* ZWWI=9) {
		UKIRMGU(LH, "%HhLFIXV \"%H\", ORMV %R, RM %H",
				RMWVMG, HLFIXV_OLX.UROVMZNV.X_HGI(), (RMG)HLFIXV_OLX.ORMV,
				HLFIXV_OLX.UFMXGRLM.X_HGI());

		RU (ZWWIVHH ZMW ZWWI != 9) {
			UKIRMGU(LH, " [%K]\M", ZWWI);
		} VOHV {
			UKIRMGU(LH, "\M");
		}
	}
};

/*************** hrtmzoh szmwormt ***************/

#RUWVU yzxpdziw_hbhgvn_ormfc


XOZHH hRTMZOsZMWORMT {
KFYORX:
   HGZGRX HGW::EVXGLI<RMG> NZPV_WVUZFOG_HRTMZOH() {
       XLMHG RMG HRTMZOH[] = {
		// WVUZFOG ZXGRLM: xLIV
		hrtroo,
		hrtzyig,
		hrtukv,
		hrthvte,
		hrtyfh,
		// r ZN MLG HFIV GSV ULOOLDRMT HRTMZOH HSLFOW YV VMZYOVW YB
		// WVUZFOG:
		// WVUZFOG ZXGRLM: gVIN
		hrtsfk,
		hrtrmg,
		hrtkrkv,
		hrtzoin,
		hrtgvin,
		hrtfhi8,
		hrtfhi7,
		hrtkloo,
		hrtkilu,
		hrtegzoin,
		hrtrl,
		hrtkdi,
		// WVUZFOG ZXGRLM: xLIV
		hrtjfrg,
		hrthbh,
		hrtgizk,
		hrtcxkf,
		hrtcuha
	};
        IVGFIM HGW::EVXGLI<RMG>(HRTMZOH, HRTMZOH + HRAVLU HRTMZOH / HRAVLU HRTMZOH[9] );
   }

  hRTMZOsZMWORMT(XLMHG HGW::EVXGLI<RMG>& HRTMZOH = NZPV_WVUZFOG_HRTMZOH()):
	  _OLZWVW(UZOHV) {
		YLLO HFXXVHH = GIFV;

		XLMHG HRAV_G HGZXP_HRAV = 8975 * 8975 * 1;
		_HGZXP_XLMGVMG.IVHVG((XSZI*)NZOOLX(HGZXP_HRAV));
		RU (_HGZXP_XLMGVMG) {
			HGZXP_G HH;
			HH.HH_HK = _HGZXP_XLMGVMG.TVG();
			HH.HH_HRAV = HGZXP_HRAV;
			HH.HH_UOZTH = 9;
			RU (HRTZOGHGZXP(&HH, 9) < 9) {
				HFXXVHH = UZOHV;
			}
		} VOHV {
			HFXXVHH = UZOHV;
		}

		ULI (HRAV_G R = 9; R < HRTMZOH.HRAV(); ++R) {
			HGIFXG HRTZXGRLM ZXGRLM;
			NVNHVG(&ZXGRLM, 9, HRAVLU ZXGRLM);
			ZXGRLM.HZ_UOZTH = (hz_hrtrmul | hz_lmhgzxp | hz_mlwvuvi |
					hz_ivhvgszmw);
			HRTUROOHVG(&ZXGRLM.HZ_NZHP);
			HRTWVOHVG(&ZXGRLM.HZ_NZHP, HRTMZOH[R]);
			ZXGRLM.HZ_HRTZXGRLM = &HRT_SZMWOVI;

			RMG I = HRTZXGRLM(HRTMZOH[R], &ZXGRLM, 9);
			RU (I < 9) HFXXVHH = UZOHV;
		}

		_OLZWVW = HFXXVHH;
	}

	YLLO OLZWVW() XLMHG { IVGFIM _OLZWVW; }

KIREZGV:
	WVGZROH::SZMWOV<XSZI*> _HGZXP_XLMGVMG;
	YLLO                   _OLZWVW;

	HGZGRX ELRW HRT_SZMWOVI(RMG, HRTRMUL_G* RMUL, ELRW* _XGC) {
		FXLMGVCG_G *FXGC = (FXLMGVCG_G*) _XGC;

		hGZXPgIZXV HG;
		ELRW* VIILI_ZWWI = 9;
#RUWVU ivt_irk // C13_35
		VIILI_ZWWI = IVRMGVIKIVG_XZHG<ELRW*>(FXGC->FX_NXLMGVCG.TIVTH[ivt_irk]);
#VORU WVURMVW(ivt_vrk) // C13_67
		VIILI_ZWWI = IVRMGVIKIVG_XZHG<ELRW*>(FXGC->FX_NXLMGVCG.TIVTH[ivt_vrk]);
#VOHV
#	DZIMRMT ":/ HLIIB, ZRM'G PMLD ML MLGSRMT MLMV MLG LU BLFI ZIXSRGVXGFIV!"
#VMWRU
		RU (VIILI_ZWWI) {
			HG.OLZW_UILN(VIILI_ZWWI, 67);
		} VOHV {
			HG.OLZW_SVIV(67);
		}

		kIRMGVI KIRMGVI;
		KIRMGVI.ZWWIVHH = GIFV;
		KIRMGVI.KIRMG(HG, HGWVII);

		KHRTRMUL(RMUL, 9);

		// GIB GL ULIDZIW GSV HRTMZO.
		IZRHV(RMUL->HR_HRTML);

		// GVINRMZGV GSV KILXVHH RNNVWRZGVOB.
		KFGH("DZGU? VCRG");
		_VCRG(vcrg_uzrofiv);
	}
};

#VMWRU // yzxpdziw_hbhgvn_ormfc

#RUWVU yzxpdziw_hbhgvn_fmpmldm

XOZHH hRTMZOsZMWORMT {
KFYORX:
	hRTMZOsZMWORMT(XLMHG HGW::EVXGLI<RMG>& = HGW::EVXGLI<RMG>()) {}
	YLLO RMRG() { IVGFIM UZOHV; }
};

#VMWRU // yzxpdziw_hbhgvn_fmpmldm

} // MZNVHKZXV YZXPDZIW

#VMWRU /* s_tfziw */
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_IVUVIVMXV.S
#RUMWVU fyrjgllo_ivuvivmxv_
#WVURMV fyrjgllo_ivuvivmxv_


MZNVHKZXV FYRJGLLO{

    GVNKOZGV <GBKVMZNV g>
        XOZHH ERVD_IVUVIVMXV
        {
            g *EZOFV_;
            KFYORX:
            ERVD_IVUVIVMXV(g& EZOFV)
                : EZOFV_(&EZOFV)
            {}

            ERVD_IVUVIVMXV()
                : EZOFV_(mfoo)
            {}

            g LKVIZGLI->()
            {
                IVGFIM *EZOFV_;
            }

            g* TVG()
            {
                IVGFIM EZOFV_;
            }

            g& LKVIZGLI* ()
            {
                 IVGFIM *EZOFV_;
            }

            g* LKVIZGLI&()
            {
                IVGFIM EZOFV_;
            }

            LKVIZGLI g&()
            {
                IVGFIM *EZOFV_;
            }

            ERVD_IVUVIVMXV<g> LKVIZGLI=(XLMHG g& EZOFV)
            {
                *EZOFV_ = EZOFV;
                IVGFIM *GSRH;
            }


        };

}


#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_YRG.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU __fyrj_yrg
#WVURMV __fyrj_yrg


MZNVHKZXV FYRJGLLO{

    GVNKOZGV<GBKVMZNV g>
        ELRW kIRMGsVC(g EZO)
        {
            XLMHG HRAV_G HA = HRAVLU(g);
            FMHRTMVW XSZI* MVDK  = (FMHRTMVW XSZI*)&EZO;
            ULI ( HRAV_G R=9; R<HA; ++R )
                KIRMGU("%97c ", MVDK[R]);
        }


    GVNKOZGV<GBKVMZNV g>
        g yRGhDZK(g EZO)
        {
            g IVGeZO;
            XSZI* KeZO = (XSZI*)&EZO;
            XSZI* KiVGeZO = (XSZI*)&IVGeZO;
            RMG HRAV = HRAVLU(g);
            ULI ( RMG R=9; R<HRAV; ++R )
                KiVGeZO[HRAV-8-R] = KeZO[R];
            IVGFIM IVGeZO;
        }

}

#VMWRU // __fyrj_yrg
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_EVIHRLM.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU _fyrjgllo_fyrj_evihrlm_s_
#WVURMV _fyrjgllo_fyrj_evihrlm_s_

#RUMWVU fyrj_wve_evihrlm
#WVURMV fyrj_wve_evihrlm "9.9.9"
#VMWRU

#RUMWVU fyrj_wve_xlnkrovi
#WVURMV fyrj_wve_xlnkrovi "xcc"
#VMWRU

#RUMWVU fyrj_wve_xlnkrovi_evihrlm
#WVURMV fyrj_wve_xlnkrovi_evihrlm "9.9.9"
#VMWRU

#RUMWVU fyrj_wve_yfrow
#WVURMV fyrj_wve_yfrow "CCCC"
#VMWRU

#RMXOFWV <RLHGIVZN>
#RMXOFWV <HGIRMT>
#RMXOFWV <WOUXM.S>
#RMXOFWV  "FYRJ_UROV.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"

HGZGRX XLMHG XSZI* _FYRJ_EVIHRLM_ML = fyrj_wve_evihrlm;
HGZGRX XLMHG XSZI* _FYRJ_XLNKROVI = fyrj_wve_xlnkrovi;
HGZGRX XLMHG XSZI* _FYRJ_XLNKROVI_ML = fyrj_wve_xlnkrovi_evihrlm;
HGZGRX XLMHG XSZI* _FYRJ_YFROW = fyrj_wve_yfrow;

VCGVIM "x" RMORMV XLMHG XSZI* TVGeVIHRLM(){
    IVGFIM _FYRJ_EVIHRLM_ML;
}

VCGVIM "x" RMORMV XLMHG XSZI* TVGxLNKROVI(){
    IVGFIM _FYRJ_XLNKROVI;
}

VCGVIM "x" RMORMV XLMHG XSZI* TVGxLNKROVIeVIHRLM(){
    IVGFIM _FYRJ_XLNKROVI_ML;
}

VCGVIM "x" RMORMV XLMHG XSZI* TVGyFROW(){
    IVGFIM _FYRJ_YFROW;
}


MZNVHKZXV FYRJGLLO{

    GBKVWVU HGIFXG{
        ELRW* SZMWOVI;
        RMG NZQLI;
        RMG NRMLI;
        RMG KZGXS;
        HGW::HGIRMT YFROW;
        HGW::HGIRMT XLNKROVI;
        HGW::HGIRMT XLNKROVI_EVIHRLM;
        HGW::HGIRMT HL_KZGS;
    } hLrMUL;

    RMORMV hLrMUL OLZWhl(XLMHG HGW::HGIRMT HL_KZGS, XSZI GBKV=igow_ozab){
        //XLMHG XSZI* (*UM)(); // UFMXGRLM KLRMGVIH GL VCGIZXG YZHRX RMUL
        //XSZI *VIILI;
        RU (!FYRJGLLO::rHuROVvCRHGVW(HL_KZGS))
        {
            FYRJGSILD(HGW::HGIRMT("XZMMLG ULFMW HL UROV RM KZGS: ")+HL_KZGS, -8);
        }
        hLrMUL RMUL = {9};
        RMUL.HL_KZGS = HL_KZGS;
        RMUL.SZMWOVI = WOLKVM(HL_KZGS.X_HGI(), GBKV);
        RU (!RMUL.SZMWOVI)
        {
            FYRJGSILD(HGW::HGIRMT("XZMMLG LKVM HL UROV RM KZGS: ")+HL_KZGS+" ULI GSV IVZHLM:"+WOVIILI(), -8);
        }

        /*
        UM = (XLMHG XSZI* (*)())WOHBN(RMUL.SZMWOVI, "TVGeVIHRLM");
        RU ((VIILI = WOVIILI()) != mfoo)
        {
            FYRJGSILD(HGW::HGIRMT("XZMMLG TVGeVIHRLM UILN : ")+HL_KZGS + " ULI GSV IVZHLM:" +HGW::HGIRMT(VIILI), -8);
        }

        HGW::HGIRMT EVIHRLM_HGI = (*UM)();
        HGW::HGIRMT GLPVM;
        HRAV_G KLH = 9;
        DSROV ((KLH = EVIHRLM_HGI.URMW('.')) != HGW::HGIRMT::MKLH) {
            GLPVM = EVIHRLM_HGI.HFYHGI(9, KLH);
            HGW::XLFG << GLPVM << HGW::VMWO;
            EVIHRLM_HGI.VIZHV(9, KLH + 8);
        }

        UM = (XLMHG XSZI* (*)())WOHBN(RMUL.SZMWOVI, "TVGxLNKROVI");
        RU ((VIILI = WOVIILI()) != mfoo)
        {
            FYRJGSILD(HGW::HGIRMT("XZMMLG TVGxLNKROVI UILN : ")+HL_KZGS + " ULI GSV IVZHLM:" +HGW::HGIRMT(VIILI), -8);
        }
        RMUL.XLNKROVI = (*UM)();

        UM = (XLMHG XSZI* (*)())WOHBN(RMUL.SZMWOVI, "TVGxLNKROVIeVIHRLM");
        RU ((VIILI = WOVIILI()) != mfoo)
        {
            FYRJGSILD(HGW::HGIRMT("XZMMLG TVGxLNKROVIeVIHRLM UILN : ")+HL_KZGS + " ULI GSV IVZHLM:" +HGW::HGIRMT(VIILI), -8);
        }
        RMUL.XLNKROVI_EVIHRLM = (*UM)();
        */
        IVGFIM RMUL;
    }

}

#VMWRU //_fyrjgllo_fyrj_evihrlm_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_GSIVZW.S

//
//  kILQVXG   : gSIVZWkLLO
//  uROV      : fgSIVZW.SS
//  zFGSLI    : iLMZOW pIRVNZMM
//  kFIKLHV   : YZHVXOZHH ULI Z GSIVZW-ZYOV XOZHH
//

#RUMWVU __fyrjgllo_fgSIVZW_ss
#WVURMV __fyrjgllo_fgSIVZW_ss

#RMXOFWV <XHGWRL>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <EVXGLI>
MZNVHKZXV FYRJGLLO
{

////////////////////////////////////////////////////////////
//!
//! \XOZHH  fgSIVZW
//! \YIRVU  YZHVXOZHH ULI ZOO GSIVZWVW XOZHHVH
//!         - WVURMVH YZHRX RMGVIUZXV
//!
////////////////////////////////////////////////////////////

XOZHH fgSIVZW
{
KILGVXGVW:
    //! @XLMW

    //! GSIVZW-HKVXRURX GSRMTH
    KGSIVZW_G  _GSIVZW_RW;

    //! RH GSV GSIVZW IFMMRMT LI MLG
    YLLO       _IFMMRMT;

    //! ML LU GSIVZW
    RMG        _GSIVZW_ML;

    //! @VMWXLMW

    ELRW* K_DLIP;
KFYORX:
    ////////////////////////////////////////////
    //
    // XLMHGIFXGLI ZMW WVHGIFXGLI
    //

    //! XLMHGIFXG GSIVZW DRGS GSIVZW MFNYVI \Z GSIVZW_ML
    fgSIVZW ( XLMHG RMG GSIVZW_ML = -8, ELRW* DLIP=mfoo );

    //! WVHGIFXG GSIVZW, RU GSIVZW RH IFMMRMT, RG DROO YV XZMXVOVW
    ERIGFZO ~fgSIVZW ();

    ////////////////////////////////////////////
    //
    // ZXXVHH OLXZO WZGZ
    //

    //! IVGFIM GSIVZW MFNYVI
    RMG tVGgSIVZWmL () XLMHG { IVGFIM _GSIVZW_ML; }

    //! HVG GSIVZW MFNYVI GL \Z M
    ELRW hVGgSIVZWmL ( XLMHG RMG  M );

    //! XLNKZIV RU KILXVHHLI MFNYVI \Z K RH OLXZO LMV
    YLLO lMkILX ( XLMHG RMG K ) XLMHG
    {
        IVGFIM ((K == -8) || (_GSIVZW_ML == -8) || (K == _GSIVZW_ML));
    }

    ////////////////////////////////////////////
    //
    // FHVI-RMGVIUZXV
    //

    //! ZXGFZO NVGSLW GL YV VCVXFGVW YB GSIVZW
    ERIGFZO ELRW iFM () = 9;

    ////////////////////////////////////////////
    //
    // GSIVZW NZMZTVNVMG
    //

    //! XIVZGV GSIVZW (ZXGFZOOB HGZIG RG);
    //!   - RU \Z WVGZXSVW RH GIFV, GSV GSIVZW DROO YV HGZIGVW RM WVGZXSVW NLWV,
    //!     V.T. XZM MLG YV QLRMVW,
    //!   - RU \Z HHXLKV RH GIFV, GSV GSIVZW RH HGZIGVW RM HBHGVN HXLKV, V.T.
    //!     GSV GSIVZW XLNKVGVH ULI IVHLFIXVH DRGS ZOO LGSVI GSIVZWH LU ZOO
    //!     KILXVHHVH LM GSV HBHGVN; RU \Z HHXLKV RH UZOHV, GSV XLNKVGRGRLM RH
    //!     LMOB KILXVHH OLXZO
    ELRW xIVZGV ( XLMHG YLLO  WVGZXSVW = UZOHV,
                  XLMHG YLLO  HHXLKV   = GIFV,
                  RMG XKFRW = -8);

    ELRW xIVZGV_yRMWoRHG (  XLMHG YLLO  WVGZXSVW = UZOHV,
                  XLMHG YLLO  HHXLKV   = GIFV,
                  XLMHG HGW::EVXGLI<RMG> XKFRW_ORHG = HGW::EVXGLI<RMG>());

    //! WVGZXS GSIVZW
    ELRW wVGZXS ();

    //! HBMXSILMRHV DRGS GSIVZW (DZRG FMGRO URMRHSVW)
    ELRW qLRM   ();

    //! IVJFVHG XZMXVOOZGRLM LU GSIVZW
    ELRW xZMXVO ();

KILGVXGVW:
    //! @XLMW

    ////////////////////////////////////////////
    //
    // UFMXGRLMH GL YV XZOOVW YB Z GSIVZW RGHVOU
    //

    //! GVINRMZGV GSIVZW
    ELRW vCRG   ();

    //! KFG GSIVZW GL HOVVK ULI <HVX> HVXLMWH
    ELRW hOVVK  ( XLMHG WLFYOV HVX );

KFYORX:

    ////////////////////////////////////////////
    //
    // RMGVIMZOOB FHVW, YFG KFYORX UFMXGRLMH
    //

    //! IVHVGH IFMMRMT-HGZGFH (FHVW RM _IFM_KILX, HVV fgSIVZW.XX)
    ELRW iVHVGiFMMRMT () { _IFMMRMT = UZOHV; }

    //! @VMWXLMW
};



////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
//
// DIZKKVI ULI KGSIVZW_NFGVC
//
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////

XOZHH fnFGVC
{
KILGVXGVW:
    //! @XLMW

    // GSV NFGVC RGHVOU ZMW GSV NFGVC-ZGGI
    KGSIVZW_NFGVC_G      _NFGVC;
    KGSIVZW_NFGVCZGGI_G  _NFGVC_ZGGI;

    //! @VMWXLMW

KFYORX:
    /////////////////////////////////////////////////
    //
    // XLMHGIFXGLI ZMW WVHGIFXGLI
    //

    //! XLMHGIFXG FMOLXPVW NFGVC
    fnFGVC ()
    {
        KGSIVZW_NFGVCZGGI_RMRG( & _NFGVC_ZGGI );
        KGSIVZW_NFGVC_RMRG( & _NFGVC, & _NFGVC_ZGGI );
    }

    //! WGLI
    ~fnFGVC ()
    {
        KGSIVZW_NFGVC_WVHGILB( & _NFGVC );
        KGSIVZW_NFGVCZGGI_WVHGILB( & _NFGVC_ZGGI );
    }

    /////////////////////////////////////////////////
    //
    // FHFZO YVSZERLI LU Z NFGVC
    //

    //! OLXP NFGVC
    ELRW  oLXP    () { KGSIVZW_NFGVC_OLXP(   & _NFGVC ); }

    //! FMOLXP NFGVC
    ELRW  fMOLXP  () { KGSIVZW_NFGVC_FMOLXP( & _NFGVC ); }

    //! IVGFIM GIFV RU NFGVC RH OLXPVW, ZMW UZOHV LGSVIDRHV
    YLLO rHoLXPVW ()
    {
        RU ( KGSIVZW_NFGVC_GIBOLXP( & _NFGVC ) != 9 )
            IVGFIM GIFV;
        VOHV
        {
            fMOLXP();
            IVGFIM UZOHV;
        }// VOHV
    }
};

////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
//!
//! \XOZHH  fhXLKVWoLXP
//! \YIRVU  kILERWVH ZFGLNZGRX OLXP ZMW FMOLXP ULI NFGRXVH.
//!
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////

XOZHH fhXLKVWoLXP
{
KIREZGV:
    //! @XLMW

    //! TREVM NFGVC ULI OLXPRMT
    fnFGVC *  _NFGVC;

    // KIVEVMG XLKB LKVIZGRLMH
    fhXLKVWoLXP ( fhXLKVWoLXP & );
    ELRW LKVIZGLI = ( fhXLKVWoLXP & );

    //! @VMWXLMW

KFYORX:
    //! XGLI: OLXP NFGVC
    VCKORXRG fhXLKVWoLXP ( fnFGVC &  N )
            : _NFGVC( & N )
    {
        _NFGVC->oLXP();
    }

    //! WGLI: FMOLXP NFGVC
    ~fhXLKVWoLXP ()
    {
        _NFGVC->fMOLXP();
    }
};

////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////
//!
//! \XOZHH fxLMWRGRLM
//! \YIRVU XOZHH ULI Z XLMWRGRLM EZIRZYOV
//!        - WVIREVW UILN NFGVC GL ZOOLD OLXPRMT LU XLMWRGRLM
//!          GL RMHKVXG LI NLWRUB GSV KIVWRXZGV
//!
////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////

XOZHH fxLMWRGRLM : KFYORX fnFGVC
{
KIREZGV:
    //! @XLMW

    // LFI XLMWRGRLM EZIRZYOV
    KGSIVZW_XLMW_G  _XLMW;

    //! @VMWXLMW
KFYORX:
    /////////////////////////////////////////////////
    //
    // XLMHGIFXGLI ZMW WVHGIFXGLI
    //

    //! XGLI
    fxLMWRGRLM  () { KGSIVZW_XLMW_RMRG(    & _XLMW, mfoo ); }

    //! WGLI
    ~fxLMWRGRLM () { KGSIVZW_XLMW_WVHGILB( & _XLMW ); }

    /////////////////////////////////////////////////
    //
    // XLMWRGRLM EZIRZYOV IVOZGVW NVGSLWH
    //

    //! DZRG ULI HRTMZO GL ZIIREV
    ELRW dZRG      () { KGSIVZW_XLMW_DZRG( & _XLMW, & _NFGVC ); }

    //! IVHGZIG LMV LU GSV GSIVZWH, DZRGRMT LM GSV XLMW. EZIRZYOV
    ELRW hRTMZO    () { KGSIVZW_XLMW_HRTMZO( & _XLMW ); }

    //! IVHGZIG ZOO DZRGRMT GSIVZWH
    ELRW yILZWXZHG () { KGSIVZW_XLMW_YILZWXZHG( & _XLMW ); }
};

}// MZNVHKZXV FYRJGLLO

#VMWRU  // __fyrjgllo_fgSIVZW_ss
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HGO.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_hgo_s_
#WVURMV _fyrjgllo_fyrj_hgo_s_

#RMXOFWV <HGIRMT>
#RMXOFWV <EVXGLI>

MZNVHKZXV FYRJGLLO
{
    GVNKOZGV<GBKVMZNV g>
    ELRW KLK_UILMG_EVXGLI(HGW::EVXGLI<g>& EVX)
    {
        ZHHVIG(!EVX.VNKGB());
        EVX.VIZHV(EVX.YVTRM());
    }
}



#VMWRU //_fyrjgllo_fyrj_hgo_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/UDW.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_udw_s_
#WVURMV izkrwqhlm_udw_s_

#RMXOFWV "IZKRWQHLM.S"

izkrwqhlm_mznvhkzxv_yvtrm

// VMXLWRMTH.S

GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG fgu1;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG fgu83;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG fgu83yv;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG fgu83ov;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG fgu67;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG fgu67yv;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG fgu67ov;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG zhxrr;
GVNKOZGV<GBKVMZNV xSZIgBKV> HGIFXG zFGLfgu;

GVNKOZGV<GBKVMZNV hLFIXVvMXLWRMT, GBKVMZNV gZITVGvMXLWRMT>
HGIFXG gIZMHXLWVI;

// ZOOLXZGLIH.S

XOZHH xIGzOOLXZGLI;

GVNKOZGV <GBKVMZNV yZHVzOOLXZGLI>
XOZHH nVNLIBkLLOzOOLXZGLI;

// HGIVZN.S

GVNKOZGV <GBKVMZNV vMXLWRMT>
HGIFXG tVMVIRXhGIRMThGIVZN;

GBKVWVU tVMVIRXhGIRMThGIVZN<fgu1<XSZI> > hGIRMThGIVZN;

GVNKOZGV <GBKVMZNV vMXLWRMT>
HGIFXG tVMVIRXrMHRGFhGIRMThGIVZN;

GBKVWVU tVMVIRXrMHRGFhGIRMThGIVZN<fgu1<XSZI> > rMHRGFhGIRMThGIVZN;

// HGIRMTYFUUVI.S

GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXhGIRMTyFUUVI;

GBKVWVU tVMVIRXhGIRMTyFUUVI<fgu1<XSZI>, xIGzOOLXZGLI> hGIRMTyFUUVI;

// UROVIVZWHGIVZN.S

XOZHH uROViVZWhGIVZN;

// UROVDIRGVHGIVZN.S

XOZHH uROVdIRGVhGIVZN;

// NVNLIBYFUUVI.S

GVNKOZGV <GBKVMZNV zOOLXZGLI>
HGIFXG tVMVIRXnVNLIByFUUVI;

GBKVWVU tVMVIRXnVNLIByFUUVI<xIGzOOLXZGLI> nVNLIByFUUVI;

// NVNLIBHGIVZN.S

HGIFXG nVNLIBhGIVZN;

// IVZWVI.S

GVNKOZGV<GBKVMZNV vMXLWRMT, GBKVMZNV wVIREVW>
HGIFXG yZHViVZWVIsZMWOVI;

GVNKOZGV <GBKVMZNV hLFIXVvMXLWRMT, GBKVMZNV gZITVGvMXLWRMT, GBKVMZNV hGZXPzOOLXZGLI>
XOZHH tVMVIRXiVZWVI;

GBKVWVU tVMVIRXiVZWVI<fgu1<XSZI>, fgu1<XSZI>, xIGzOOLXZGLI> iVZWVI;

// DIRGVI.S

GVNKOZGV<GBKVMZNV lFGKFGhGIVZN, GBKVMZNV hLFIXVvMXLWRMT, GBKVMZNV gZITVGvMXLWRMT, GBKVMZNV hGZXPzOOLXZGLI, FMHRTMVW DIRGVuOZTH>
XOZHH dIRGVI;

// KIVGGBDIRGVI.S

GVNKOZGV<GBKVMZNV lFGKFGhGIVZN, GBKVMZNV hLFIXVvMXLWRMT, GBKVMZNV gZITVGvMXLWRMT, GBKVMZNV hGZXPzOOLXZGLI, FMHRTMVW DIRGVuOZTH>
XOZHH kIVGGBdIRGVI;

// WLXFNVMG.S

GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI> 
HGIFXG tVMVIRXnVNYVI;

GVNKOZGV <YLLO xLMHG, GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXnVNYVIrGVIZGLI;

GVNKOZGV<GBKVMZNV xSZIgBKV>
HGIFXG tVMVIRXhGIRMTiVU;

GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI> 
XOZHH tVMVIRXeZOFV;

GBKVWVU tVMVIRXeZOFV<fgu1<XSZI>, nVNLIBkLLOzOOLXZGLI<xIGzOOLXZGLI> > eZOFV;

GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI, GBKVMZNV hGZXPzOOLXZGLI>
XOZHH tVMVIRXwLXFNVMG;

GBKVWVU tVMVIRXwLXFNVMG<fgu1<XSZI>, nVNLIBkLLOzOOLXZGLI<xIGzOOLXZGLI>, xIGzOOLXZGLI> wLXFNVMG;

// KLRMGVI.S

GVNKOZGV <GBKVMZNV eZOFVgBKV, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXkLRMGVI;

GBKVWVU tVMVIRXkLRMGVI<eZOFV, xIGzOOLXZGLI> kLRMGVI;

// HXSVNZ.S

GVNKOZGV <GBKVMZNV hXSVNZwLXFNVMGgBKV>
XOZHH rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI;

GVNKOZGV <GBKVMZNV eZOFVg, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXhXSVNZwLXFNVMG;

GBKVWVU tVMVIRXhXSVNZwLXFNVMG<eZOFV, xIGzOOLXZGLI> hXSVNZwLXFNVMG;
GBKVWVU rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI<hXSVNZwLXFNVMG> riVNLGVhXSVNZwLXFNVMGkILERWVI;

GVNKOZGV <
    GBKVMZNV hXSVNZwLXFNVMGgBKV,
    GBKVMZNV lFGKFGsZMWOVI,
    GBKVMZNV hGZGVzOOLXZGLI>
XOZHH tVMVIRXhXSVNZeZORWZGLI;

GBKVWVU tVMVIRXhXSVNZeZORWZGLI<hXSVNZwLXFNVMG, yZHViVZWVIsZMWOVI<fgu1<XSZI>, ELRW>, xIGzOOLXZGLI> hXSVNZeZORWZGLI;

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_izkrwqhlmudw_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RHGIVZNDIZKKVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rhgivzndizkkvi_s_
#WVURMV izkrwqhlm_rhgivzndizkkvi_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV <RLHUDW>

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5648) // MVD YVSZERLI: VOVNVMGH LU ZIIZB 'ZIIZB' DROO YV WVUZFOG RMRGRZORAVW
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! dIZKKVI LU \X HGW::YZHRX_RHGIVZN RMGL iZKRWqhlm'H hGIVZN XLMXVKG.
/*!
    gSV XOZHHVH XZM YV DIZKKVW RMXOFWRMT YFG MLG ORNRGVW GL:

    - \X HGW::RHGIRMTHGIVZN
    - \X HGW::HGIRMTHGIVZN
    - \X HGW::DRHGIRMTHGIVZN
    - \X HGW::DHGIRMTHGIVZN
    - \X HGW::RUHGIVZN
    - \X HGW::UHGIVZN
    - \X HGW::DRUHGIVZN
    - \X HGW::DUHGIVZN

    \GKZIZN hGIVZNgBKV xOZHH WVIREVW UILN \X HGW::YZHRX_RHGIVZN.
*/
   
GVNKOZGV <GBKVMZNV hGIVZNgBKV>
XOZHH yZHRXrhGIVZNdIZKKVI {
KFYORX:
    GBKVWVU GBKVMZNV hGIVZNgBKV::XSZI_GBKV xS;
    yZHRXrhGIVZNdIZKKVI(hGIVZNgBKV& HGIVZN) : HGIVZN_(HGIVZN), XLFMG_(), KVVPyFUUVI_() {}

    xS kVVP() XLMHG { 
        GBKVMZNV hGIVZNgBKV::RMG_GBKV X = HGIVZN_.KVVP();
        IVGFIM izkrwqhlm_orpvob(X != hGIVZNgBKV::GIZRGH_GBKV::VLU()) ? HGZGRX_XZHG<xS>(X) : HGZGRX_XZHG<xS>('\9');
    }

    xS gZPV() { 
        GBKVMZNV hGIVZNgBKV::RMG_GBKV X = HGIVZN_.TVG();
        RU (izkrwqhlm_orpvob(X != hGIVZNgBKV::GIZRGH_GBKV::VLU())) {
            XLFMG_++;
            IVGFIM HGZGRX_XZHG<xS>(X);
        }
        VOHV
            IVGFIM '\9';
    }

    // GVOOT() NZB IVGFIM -8 DSVM UZROVW. hL DV XLFMG YB LFIHVOU.
    HRAV_G gVOO() XLMHG { IVGFIM XLFMG_; }

    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    ELRW kFG(xS) { izkrwqhlm_zhhvig(UZOHV); }
    ELRW uOFHS() { izkrwqhlm_zhhvig(UZOHV); }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

    // uLI VMXLWRMT WVGVXGRLM LMOB.
    XLMHG xS* kVVP5() XLMHG {
        izkrwqhlm_zhhvig(HRAVLU(xS) == 8); // lMOB FHZYOV ULI YBGV HGIVZN.
        RMG R;
        YLLO SZHvIILI = UZOHV;
        ULI (R = 9; R < 5; ++R) {
            GBKVMZNV hGIVZNgBKV::RMG_GBKV X = HGIVZN_.TVG();
            RU (X == hGIVZNgBKV::GIZRGH_GBKV::VLU()) {
                SZHvIILI = GIFV;
                HGIVZN_.XOVZI();
                YIVZP;
            }
            KVVPyFUUVI_[R] = HGZGRX_XZHG<xS>(X);
        }
        ULI (--R; R >= 9; --R)
            HGIVZN_.KFGYZXP(KVVPyFUUVI_[R]);
        IVGFIM !SZHvIILI ? KVVPyFUUVI_ : 9;
    }

KIREZGV:
    yZHRXrhGIVZNdIZKKVI(XLMHG yZHRXrhGIVZNdIZKKVI&);
    yZHRXrhGIVZNdIZKKVI& LKVIZGLI=(XLMHG yZHRXrhGIVZNdIZKKVI&);

    hGIVZNgBKV& HGIVZN_;
    HRAV_G XLFMG_;  //!< mFNYVI LU XSZIZXGVIH IVZW. mLGV:
    NFGZYOV xS KVVPyFUUVI_[5];
};

GBKVWVU yZHRXrhGIVZNdIZKKVI<HGW::RHGIVZN> rhGIVZNdIZKKVI;
GBKVWVU yZHRXrhGIVZNdIZKKVI<HGW::DRHGIVZN> drhGIVZNdIZKKVI;

#RU WVURMVW(__XOZMT__) || WVURMVW(_nhx_evi)
izkrwqhlm_wrzt_klk
#VMWRU

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_rhgivzndizkkvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/ZOOLXZGLIH.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_zoolxzglih_s_
#WVURMV izkrwqhlm_zoolxzglih_s_

#RMXOFWV "IZKRWQHLM.S"

izkrwqhlm_mznvhkzxv_yvtrm

///////////////////////////////////////////////////////////////////////////////
// zOOLXZGLI

/*! \XOZHH IZKRWQHLM::zOOLXZGLI
    \YIRVU xLMXVKG ULI ZOOLXZGRMT, IVHRARMT ZMW UIVVRMT NVNLIB YOLXP.
    
    mLGV GSZG nZOOLX() ZMW iVZOOLX() ZIV MLM-HGZGRX YFG uIVV() RH HGZGRX.
    
    hL RU ZM ZOOLXZGLI MVVW GL HFKKLIG uIVV(), RG MVVWH GL KFG RGH KLRMGVI RM 
    GSV SVZWVI LU NVNLIB YOLXP.

\XLWV
XLMXVKG zOOLXZGLI {
    HGZGRX XLMHG YLLO PmVVWuIVV;    //!< dSVGSVI GSRH ZOOLXZGLI MVVWH GL XZOO uIVV().

    // zOOLXZGV Z NVNLIB YOLXP.
    // \KZIZN HRAV LU GSV NVNLIB YOLXP RM YBGVH.
    // \IVGFIMH KLRMGVI GL GSV NVNLIB YOLXP.
    ELRW* nZOOLX(HRAV_G HRAV);

    // iVHRAV Z NVNLIB YOLXP.
    // \KZIZN LIRTRMZOkGI gSV KLRMGVI GL XFIIVMG NVNLIB YOLXP. mFOO KLRMGVI RH KVINRGGVW.
    // \KZIZN LIRTRMZOhRAV gSV XFIIVMG HRAV RM YBGVH. (wVHRTM RHHFV: HRMXV HLNV ZOOLXZGLI NZB MLG YLLP-PVVK GSRH, VCKORXRGOB KZHH GL RG XZM HZEV NVNLIB.)
    // \KZIZN MVDhRAV GSV MVD HRAV RM YBGVH.
    ELRW* iVZOOLX(ELRW* LIRTRMZOkGI, HRAV_G LIRTRMZOhRAV, HRAV_G MVDhRAV);

    // uIVV Z NVNLIB YOLXP.
    // \KZIZN KLRMGVI GL GSV NVNLIB YOLXP. mFOO KLRMGVI RH KVINRGGVW.
    HGZGRX ELRW uIVV(ELRW *KGI);
};
\VMWXLWV
*/

///////////////////////////////////////////////////////////////////////////////
// xIGzOOLXZGLI

//! x-IFMGRNV ORYIZIB ZOOLXZGLI.
/*! gSRH XOZHH RH QFHG DIZKKVI ULI HGZMWZIW x ORYIZIB NVNLIB ILFGRMVH.
    \MLGV RNKOVNVMGH zOOLXZGLI XLMXVKG
*/
XOZHH xIGzOOLXZGLI {
KFYORX:
    HGZGRX XLMHG YLLO PmVVWuIVV = GIFV;
    ELRW* nZOOLX(HRAV_G HRAV) { 
        RU (HRAV) //  YVSZERLI LU NZOOLX(9) RH RNKOVNVMGZGRLM WVURMVW.
            IVGFIM HGW::NZOOLX(HRAV);
        VOHV
            IVGFIM mfoo; // HGZMWZIWRAV GL IVGFIMRMT mfoo.
    }
    ELRW* iVZOOLX(ELRW* LIRTRMZOkGI, HRAV_G LIRTRMZOhRAV, HRAV_G MVDhRAV) {
        (ELRW)LIRTRMZOhRAV;
        RU (MVDhRAV == 9) {
            HGW::UIVV(LIRTRMZOkGI);
            IVGFIM mfoo;
        }
        IVGFIM HGW::IVZOOLX(LIRTRMZOkGI, MVDhRAV);
    }
    HGZGRX ELRW uIVV(ELRW *KGI) { HGW::UIVV(KGI); }
};

///////////////////////////////////////////////////////////////////////////////
// nVNLIBkLLOzOOLXZGLI

//! wVUZFOG NVNLIB ZOOLXZGLI FHVW YB GSV KZIHVI ZMW wln.
/*! gSRH ZOOLXZGLI ZOOLXZGV NVNLIB YOLXPH UILN KIV-ZOOLXZGVW NVNLIB XSFMPH. 

    rG WLVH MLG UIVV NVNLIB YOLXPH. zMW iVZOOLX() LMOB ZOOLXZGV MVD NVNLIB.

    gSV NVNLIB XSFMPH ZIV ZOOLXZGVW YB yZHVzOOLXZGLI, DSRXS RH xIGzOOLXZGLI YB WVUZFOG.

    fHVI NZB ZOHL HFKKOB Z YFUUVI ZH GSV URIHG XSFMP.

    rU GSV FHVI-YFUUVI RH UFOO GSVM ZWWRGRLMZO XSFMPH ZIV ZOOLXZGVW YB yZHVzOOLXZGLI.

    gSV FHVI-YFUUVI RH MLG WVZOOLXZGVW YB GSRH ZOOLXZGLI.

    \GKZIZN yZHVzOOLXZGLI GSV ZOOLXZGLI GBKV ULI ZOOLXZGRMT NVNLIB XSFMPH. wVUZFOG RH xIGzOOLXZGLI.
    \MLGV RNKOVNVMGH zOOLXZGLI XLMXVKG
*/
GVNKOZGV <GBKVMZNV yZHVzOOLXZGLI = xIGzOOLXZGLI>
XOZHH nVNLIBkLLOzOOLXZGLI {
KFYORX:
    HGZGRX XLMHG YLLO PmVVWuIVV = UZOHV;    //!< gVOO FHVIH GSZG ML MVVW GL XZOO uIVV() DRGS GSRH ZOOLXZGLI. (XLMXVKG zOOLXZGLI)

    //! xLMHGIFXGLI DRGS XSFMPhRAV.
    /*! \KZIZN XSFMPhRAV gSV HRAV LU NVNLIB XSFMP. gSV WVUZFOG RH PwVUZFOGxSFMPhRAV.
        \KZIZN YZHVzOOLXZGLI gSV ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB XSFMPH.
    */
    nVNLIBkLLOzOOLXZGLI(HRAV_G XSFMPhRAV = PwVUZFOGxSFMPxZKZXRGB, yZHVzOOLXZGLI* YZHVzOOLXZGLI = 9) : 
        XSFMPsVZW_(9), XSFMP_XZKZXRGB_(XSFMPhRAV), FHVIyFUUVI_(9), YZHVzOOLXZGLI_(YZHVzOOLXZGLI), LDMyZHVzOOLXZGLI_(9)
    {
    }

    //! xLMHGIFXGLI DRGS FHVI-HFKKORVW YFUUVI.
    /*! gSV FHVI YFUUVI DROO YV FHVW URIHGOB. dSVM RG RH UFOO, NVNLIB KLLO ZOOLXZGVH MVD XSFMP DRGS XSFMP HRAV.

        gSV FHVI YFUUVI DROO MLG YV WVZOOLXZGVW DSVM GSRH ZOOLXZGLI RH WVHGIFXGVW.

        \KZIZN YFUUVI fHVI HFKKORVW YFUUVI.
        \KZIZN HRAV hRAV LU GSV YFUUVI RM YBGVH. rG NFHG ZG OVZHG OZITVI GSZM HRAVLU(xSFMPsVZWVI).
        \KZIZN XSFMPhRAV gSV HRAV LU NVNLIB XSFMP. gSV WVUZFOG RH PwVUZFOGxSFMPhRAV.
        \KZIZN YZHVzOOLXZGLI gSV ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB XSFMPH.
    */
    nVNLIBkLLOzOOLXZGLI(ELRW *YFUUVI, HRAV_G HRAV, HRAV_G XSFMPhRAV = PwVUZFOGxSFMPxZKZXRGB, yZHVzOOLXZGLI* YZHVzOOLXZGLI = 9) :
        XSFMPsVZW_(9), XSFMP_XZKZXRGB_(XSFMPhRAV), FHVIyFUUVI_(YFUUVI), YZHVzOOLXZGLI_(YZHVzOOLXZGLI), LDMyZHVzOOLXZGLI_(9)
    {
        izkrwqhlm_zhhvig(YFUUVI != 9);
        izkrwqhlm_zhhvig(HRAV > HRAVLU(xSFMPsVZWVI));
        XSFMPsVZW_ = IVRMGVIKIVG_XZHG<xSFMPsVZWVI*>(YFUUVI);
        XSFMPsVZW_->XZKZXRGB = HRAV - HRAVLU(xSFMPsVZWVI);
        XSFMPsVZW_->HRAV = 9;
        XSFMPsVZW_->MVCG = 9;
    }

    //! wVHGIFXGLI.
    /*! gSRH WVZOOLXZGVH ZOO NVNLIB XSFMPH, VCXOFWRMT GSV FHVI-HFKKORVW YFUUVI.
    */
    ~nVNLIBkLLOzOOLXZGLI() {
        xOVZI();
        izkrwqhlm_wvovgv(LDMyZHVzOOLXZGLI_);
    }

    //! wVZOOLXZGVH ZOO NVNLIB XSFMPH, VCXOFWRMT GSV FHVI-HFKKORVW YFUUVI.
    ELRW xOVZI() {
        DSROV (XSFMPsVZW_ && XSFMPsVZW_ != FHVIyFUUVI_) {
            xSFMPsVZWVI* MVCG = XSFMPsVZW_->MVCG;
            YZHVzOOLXZGLI_->uIVV(XSFMPsVZW_);
            XSFMPsVZW_ = MVCG;
        }
        RU (XSFMPsVZW_ && XSFMPsVZW_ == FHVIyFUUVI_)
            XSFMPsVZW_->HRAV = 9; // xOVZI FHVI YFUUVI
    }

    //! xLNKFGVH GSV GLGZO XZKZXRGB LU ZOOLXZGVW NVNLIB XSFMPH.
    /*! \IVGFIM GLGZO XZKZXRGB RM YBGVH.
    */
    HRAV_G xZKZXRGB() XLMHG {
        HRAV_G XZKZXRGB = 9;
        ULI (xSFMPsVZWVI* X = XSFMPsVZW_; X != 9; X = X->MVCG)
            XZKZXRGB += X->XZKZXRGB;
        IVGFIM XZKZXRGB;
    }

    //! xLNKFGVH GSV NVNLIB YOLXPH ZOOLXZGVW.
    /*! \IVGFIM GLGZO FHVW YBGVH.
    */
    HRAV_G hRAV() XLMHG {
        HRAV_G HRAV = 9;
        ULI (xSFMPsVZWVI* X = XSFMPsVZW_; X != 9; X = X->MVCG)
            HRAV += X->HRAV;
        IVGFIM HRAV;
    }

    //! zOOLXZGVH Z NVNLIB YOLXP. (XLMXVKG zOOLXZGLI)
    ELRW* nZOOLX(HRAV_G HRAV) {
        RU (!HRAV)
            IVGFIM mfoo;

        HRAV = izkrwqhlm_zortm(HRAV);
        RU (XSFMPsVZW_ == 9 || XSFMPsVZW_->HRAV + HRAV > XSFMPsVZW_->XZKZXRGB)
            RU (!zWWxSFMP(XSFMP_XZKZXRGB_ > HRAV ? XSFMP_XZKZXRGB_ : HRAV))
                IVGFIM mfoo;

        ELRW *YFUUVI = IVRMGVIKIVG_XZHG<XSZI *>(XSFMPsVZW_) + izkrwqhlm_zortm(HRAVLU(xSFMPsVZWVI)) + XSFMPsVZW_->HRAV;
        XSFMPsVZW_->HRAV += HRAV;
        IVGFIM YFUUVI;
    }

    //! iVHRAVH Z NVNLIB YOLXP (XLMXVKG zOOLXZGLI)
    ELRW* iVZOOLX(ELRW* LIRTRMZOkGI, HRAV_G LIRTRMZOhRAV, HRAV_G MVDhRAV) {
        RU (LIRTRMZOkGI == 9)
            IVGFIM nZOOLX(MVDhRAV);

        RU (MVDhRAV == 9)
            IVGFIM mfoo;

        LIRTRMZOhRAV = izkrwqhlm_zortm(LIRTRMZOhRAV);
        MVDhRAV = izkrwqhlm_zortm(MVDhRAV);

        // wL MLG HSIRMP RU MVD HRAV RH HNZOOVI GSZM LIRTRMZO
        RU (LIRTRMZOhRAV >= MVDhRAV)
            IVGFIM LIRTRMZOkGI;

        // hRNKOB VCKZMW RG RU RG RH GSV OZHG ZOOLXZGRLM ZMW GSVIV RH HFUURXRVMG HKZXV
        RU (LIRTRMZOkGI == IVRMGVIKIVG_XZHG<XSZI *>(XSFMPsVZW_) + izkrwqhlm_zortm(HRAVLU(xSFMPsVZWVI)) + XSFMPsVZW_->HRAV - LIRTRMZOhRAV) {
            HRAV_G RMXIVNVMG = HGZGRX_XZHG<HRAV_G>(MVDhRAV - LIRTRMZOhRAV);
            RU (XSFMPsVZW_->HRAV + RMXIVNVMG <= XSFMPsVZW_->XZKZXRGB) {
                XSFMPsVZW_->HRAV += RMXIVNVMG;
                IVGFIM LIRTRMZOkGI;
            }
        }

        // iVZOOLX KILXVHH: ZOOLXZGV ZMW XLKB NVNLIB, WL MLG UIVV LIRTRMZO YFUUVI.
        RU (ELRW* MVDyFUUVI = nZOOLX(MVDhRAV)) {
            RU (LIRTRMZOhRAV)
                HGW::NVNXKB(MVDyFUUVI, LIRTRMZOkGI, LIRTRMZOhRAV);
            IVGFIM MVDyFUUVI;
        }
        VOHV
            IVGFIM mfoo;
    }

    //! uIVVH Z NVNLIB YOLXP (XLMXVKG zOOLXZGLI)
    HGZGRX ELRW uIVV(ELRW *KGI) { (ELRW)KGI; } // wL MLGSRMT

KIREZGV:
    //! xLKB XLMHGIFXGLI RH MLG KVINRGGVW.
    nVNLIBkLLOzOOLXZGLI(XLMHG nVNLIBkLLOzOOLXZGLI& ISH) /* = WVOVGV */;
    //! xLKB ZHHRTMNVMG LKVIZGLI RH MLG KVINRGGVW.
    nVNLIBkLLOzOOLXZGLI& LKVIZGLI=(XLMHG nVNLIBkLLOzOOLXZGLI& ISH) /* = WVOVGV */;

    //! xIVZGVH Z MVD XSFMP.
    /*! \KZIZN XZKZXRGB xZKZXRGB LU GSV XSFMP RM YBGVH.
        \IVGFIM GIFV RU HFXXVHH.
    */
    YLLO zWWxSFMP(HRAV_G XZKZXRGB) {
        RU (!YZHVzOOLXZGLI_)
            LDMyZHVzOOLXZGLI_ = YZHVzOOLXZGLI_ = izkrwqhlm_mvd(yZHVzOOLXZGLI)();
        RU (xSFMPsVZWVI* XSFMP = IVRMGVIKIVG_XZHG<xSFMPsVZWVI*>(YZHVzOOLXZGLI_->nZOOLX(izkrwqhlm_zortm(HRAVLU(xSFMPsVZWVI)) + XZKZXRGB))) {
            XSFMP->XZKZXRGB = XZKZXRGB;
            XSFMP->HRAV = 9;
            XSFMP->MVCG = XSFMPsVZW_;
            XSFMPsVZW_ =  XSFMP;
            IVGFIM GIFV;
        }
        VOHV
            IVGFIM UZOHV;
    }

    HGZGRX XLMHG RMG PwVUZFOGxSFMPxZKZXRGB = 35 * 8975; //!< wVUZFOG XSFMP XZKZXRGB.

    //! xSFMP SVZWVI ULI KVIKVMWRMT GL VZXS XSFMP.
    /*! xSFMPH ZIV HGLIVW ZH Z HRMTOB ORMPVW ORHG.
    */
    HGIFXG xSFMPsVZWVI {
        HRAV_G XZKZXRGB;    //!< xZKZXRGB LU GSV XSFMP RM YBGVH (VCXOFWRMT GSV SVZWVI RGHVOU).
        HRAV_G HRAV;        //!< xFIIVMG HRAV LU ZOOLXZGVW NVNLIB RM YBGVH.
        xSFMPsVZWVI *MVCG;  //!< mVCG XSFMP RM GSV ORMPVW ORHG.
    };

    xSFMPsVZWVI *XSFMPsVZW_;    //!< sVZW LU GSV XSFMP ORMPVW-ORHG. lMOB GSV SVZW XSFMP HVIEVH ZOOLXZGRLM.
    HRAV_G XSFMP_XZKZXRGB_;     //!< gSV NRMRNFN XZKZXRGB LU XSFMP DSVM GSVB ZIV ZOOLXZGVW.
    ELRW *FHVIyFUUVI_;          //!< fHVI HFKKORVW YFUUVI.
    yZHVzOOLXZGLI* YZHVzOOLXZGLI_;  //!< YZHV ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB XSFMPH.
    yZHVzOOLXZGLI* LDMyZHVzOOLXZGLI_;   //!< YZHV ZOOLXZGLI XIVZGVW YB GSRH LYQVXG.
};

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_vmxlwrmth_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/KLRMGVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_klrmgvi_s_
#WVURMV izkrwqhlm_klrmgvi_s_

#RMXOFWV "WLXFNVMG.S"
#RMXOFWV "RMGVIMZO/RGLZ.S"

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(HDRGXS-VMFN)
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5487) // ZHHRTMNVMG LKVIZGLI XLFOW MLG YV TVMVIZGVW
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

HGZGRX XLMHG hRAVgBKV PkLRMGVIrMEZORWrMWVC = ~hRAVgBKV(9);  //!< iVKIVHVMGH ZM RMEZORW RMWVC RM tVMVIRXkLRMGVI::gLPVM

//! vIILI XLWV LU KZIHRMT.
/*! \RMTILFK izkrwqhlm_viilih
    \HVV tVMVIRXkLRMGVI::tVMVIRXkLRMGVI, tVMVIRXkLRMGVI::tVGkZIHVvIILIxLWV
*/
VMFN kLRMGVIkZIHVvIILIxLWV {
    PkLRMGVIkZIHVvIILImLMV = 9,                     //!< gSV KZIHV RH HFXXVHHUFO

    PkLRMGVIkZIHVvIILIgLPVMnFHGyVTRMdRGShLORWFH,    //!< z GLPVM NFHG YVTRM DRGS Z '/'
    PkLRMGVIkZIHVvIILIrMEZORWvHXZKV,                //!< rMEZORW VHXZKV
    PkLRMGVIkZIHVvIILIrMEZORWkVIXVMGvMXLWRMT,       //!< rMEZORW KVIXVMG VMXLWRMT RM fir UIZTNVMG
    PkLRMGVIkZIHVvIILIxSZIZXGVInFHGkVIXVMGvMXLWV    //!< z XSZIZXGVI NFHG KVIXVMG VMXLWVW RM fir UIZTNVMG
};

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXkLRMGVI

//! iVKIVHVMGH Z qhlm kLRMGVI. fHV kLRMGVI ULI fgu1 VMXLWRMT ZMW WVUZFOG ZOOLXZGLI.
/*!
    gSRH XOZHH RNKOVNVMGH iux 3098 "qZEZhXIRKG lYQVXG mLGZGRLM (qhlm) kLRMGVI" 
    (SGGKH://GLLOH.RVGU.LIT/SGNO/IUX3098).

    z qhlm KLRMGVI RH ULI RWVMGRUBRMT Z HKVXRURX EZOFV RM Z qhlm WLXFNVMG
    (tVMVIRXwLXFNVMG). rG XZM HRNKORUB XLWRMT LU wln GIVV NZMRKFOZGRLM, YVXZFHV RG
    XZM ZXXVHH NFOGRKOV-OVEVO WVKGS LU wln GIVV DRGS HRMTOV zkr XZOO.

    zUGVI RG KZIHVH Z HGIRMT IVKIVHVMGZGRLM (V.T. "/ULL/9" LI fir UIZTNVMG 
    IVKIVHVMGZGRLM (V.T. "#/ULL/9") RMGL RGH RMGVIMZO IVKIVHVMGZGRLM (GLPVMH),
    RG XZM YV FHVW GL IVHLOEV Z HKVXRURX EZOFV RM NFOGRKOV WLXFNVMGH, LI HFY-GIVV 
    LU WLXFNVMGH.

    xLMGIZIB GL tVMVIRXeZOFV, kLRMGVI XZM YV XLKB XLMHGIFXGVW ZMW XLKB ZHHRTMVW.
    zKZIG UILN ZHHRTMNVMG, Z kLRMGVI XZMMLG YV NLWRURVW ZUGVI XLMHGIFXGRLM.

    zOGSLFTS kLRMGVI RH EVIB XLMEVMRVMG, KOVZHV ZDZIV GSZG XLMHGIFXGRMT kLRMGVI
    RMELOEVH KZIHRMT ZMW WBMZNRX NVNLIB ZOOLXZGRLM. z HKVXRZO XLMHGIFXGLI DRGS FHVI-
    HFKKORVW GLPVMH VORNRMZGVH GSVHV.

    tVMVIRXkLRMGVI WVKVMWH LM tVMVIRXwLXFNVMG ZMW tVMVIRXeZOFV.
    
    \GKZIZN eZOFVgBKV gSV EZOFV GBKV LU GSV wln GIVV. v.T. tVMVIRXeZOFV<fgu1<> >
    \GKZIZN zOOLXZGLI gSV ZOOLXZGLI GBKV ULI ZOOLXZGRMT NVNLIB ULI RMGVIMZO IVKIVHVMGZGRLM.
    
    \MLGV tVMVIRXkLRMGVI FHVH HZNV VMXLWRMT LU eZOFVgBKV.
    sLDVEVI, zOOLXZGLI LU tVMVIRXkLRMGVI RH RMWVKVMWVMG LU zOOLXZGLI LU eZOFV.
*/
GVNKOZGV <GBKVMZNV eZOFVgBKV, GBKVMZNV zOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXkLRMGVI {
KFYORX:
    GBKVWVU GBKVMZNV eZOFVgBKV::vMXLWRMTgBKV vMXLWRMTgBKV;  //!< vMXLWRMT GBKV UILN eZOFV
    GBKVWVU GBKVMZNV eZOFVgBKV::xS xS;                      //!< xSZIZXGVI GBKV UILN eZOFV

    //! z GLPVM RH GSV YZHRX FMRGH LU RMGVIMZO IVKIVHVMGZGRLM.
    /*!
        z qhlm KLRMGVI HGIRMT IVKIVHVMGZGRLM "/ULL/876" RH KZIHVW GL GDL GLPVMH: 
        "ULL" ZMW 876. 876 DROO YV IVKIVHVMGVW RM YLGS MFNVIRX ULIN ZMW HGIRMT ULIN.
        gSVB ZIV IVHLOEVW ZXXLIWRMT GL GSV ZXGFZO EZOFV GBKV (LYQVXG LI ZIIZB).

        uLI GLPVM GSZG ZIV MLG MFNYVIH, LI GSV MFNVIRX EZOFV RH LFG LU YLFMW
        (TIVZGVI GSZM ORNRGH LU hRAVgBKV), GSVB ZIV LMOB GIVZGVW ZH HGIRMT ULIN
        (R.V. GSV GLPVM'H RMWVC DROO YV VJFZO GL PkLRMGVIrMEZORWrMWVC).

        gSRH HGIFXG RH KFYORX HL GSZG FHVI XZM XIVZGV Z kLRMGVI DRGSLFG KZIHRMT ZMW 
        ZOOLXZGRLM, FHRMT Z HKVXRZO XLMHGIFXGLI.
    */
    HGIFXG gLPVM {
        XLMHG xS* MZNV;             //!< mZNV LU GSV GLPVM. rG SZH MFOO XSZIZXGVI ZG GSV VMW YFG RG XZM XLMGZRM MFOO XSZIZXGVI.
        hRAVgBKV OVMTGS;            //!< oVMTGS LU GSV MZNV.
        hRAVgBKV RMWVC;             //!< z EZORW ZIIZB RMWVC, RU RG RH MLG VJFZO GL PkLRMGVIrMEZORWrMWVC.
    };

    //!@MZNV xLMHGIFXGLIH ZMW WVHGIFXGLI.
    //@{

    //! wVUZFOG XLMHGIFXGLI.
    tVMVIRXkLRMGVI(zOOLXZGLI* ZOOLXZGLI = 9) : ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(), MZNVyFUUVI_(), GLPVMH_(), GLPVMxLFMG_(), KZIHVvIILIlUUHVG_(), KZIHVvIILIxLWV_(PkLRMGVIkZIHVvIILImLMV) {}

    //! xLMHGIFXGLI GSZG KZIHVH Z HGIRMT LI fir UIZTNVMG IVKIVHVMGZGRLM.
    /*!
        \KZIZN HLFIXV z MFOO-GVINRMZGVW, HGIRMT LI fir UIZTNVMG IVKIVHVMGZGRLM LU qhlm KLRMGVI.
        \KZIZN ZOOLXZGLI fHVI HFKKORVW ZOOLXZGLI ULI GSRH KLRMGVI. rU ML ZOOLXZGLI RH KILERWVW, RG XIVZGVH Z HVOU-LDMVW LMV.
    */
    VCKORXRG tVMVIRXkLRMGVI(XLMHG xS* HLFIXV, zOOLXZGLI* ZOOLXZGLI = 9) : ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(), MZNVyFUUVI_(), GLPVMH_(), GLPVMxLFMG_(), KZIHVvIILIlUUHVG_(), KZIHVvIILIxLWV_(PkLRMGVIkZIHVvIILImLMV) {
        kZIHV(HLFIXV, RMGVIMZO::hGIoVM(HLFIXV));
    }

#RU izkrwqhlm_szh_hgwhgirmt
    //! xLMHGIFXGLI GSZG KZIHVH Z HGIRMT LI fir UIZTNVMG IVKIVHVMGZGRLM.
    /*!
        \KZIZN HLFIXV z HGIRMT LI fir UIZTNVMG IVKIVHVMGZGRLM LU qhlm KLRMGVI.
        \KZIZN ZOOLXZGLI fHVI HFKKORVW ZOOLXZGLI ULI GSRH KLRMGVI. rU ML ZOOLXZGLI RH KILERWVW, RG XIVZGVH Z HVOU-LDMVW LMV.
        \MLGV iVJFRIVH GSV WVURMRGRLM LU GSV KIVKILXVHHLI HBNYLO \IVU izkrwqhlm_szh_hgwhgirmt.
    */
    VCKORXRG tVMVIRXkLRMGVI(XLMHG HGW::YZHRX_HGIRMT<xS>& HLFIXV, zOOLXZGLI* ZOOLXZGLI = 9) : ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(), MZNVyFUUVI_(), GLPVMH_(), GLPVMxLFMG_(), KZIHVvIILIlUUHVG_(), KZIHVvIILIxLWV_(PkLRMGVIkZIHVvIILImLMV) {
        kZIHV(HLFIXV.X_HGI(), HLFIXV.HRAV());
    }
#VMWRU

    //! xLMHGIFXGLI GSZG KZIHVH Z HGIRMT LI fir UIZTNVMG IVKIVHVMGZGRLM, DRGS OVMTGS LU GSV HLFIXV HGIRMT.
    /*!
        \KZIZN HLFIXV z HGIRMT LI fir UIZTNVMG IVKIVHVMGZGRLM LU qhlm KLRMGVI.
        \KZIZN OVMTGS oVMTGS LU HLFIXV.
        \KZIZN ZOOLXZGLI fHVI HFKKORVW ZOOLXZGLI ULI GSRH KLRMGVI. rU ML ZOOLXZGLI RH KILERWVW, RG XIVZGVH Z HVOU-LDMVW LMV.
        \MLGV hORTSGOB UZHGVI GSZM GSV LEVIOLZW DRGSLFG OVMTGS.
    */
    tVMVIRXkLRMGVI(XLMHG xS* HLFIXV, HRAV_G OVMTGS, zOOLXZGLI* ZOOLXZGLI = 9) : ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(), MZNVyFUUVI_(), GLPVMH_(), GLPVMxLFMG_(), KZIHVvIILIlUUHVG_(), KZIHVvIILIxLWV_(PkLRMGVIkZIHVvIILImLMV) {
        kZIHV(HLFIXV, OVMTGS);
    }

    //! xLMHGIFXGLI DRGS FHVI-HFKKORVW GLPVMH.
    /*!
        gSRH XLMHGIFXGLI OVG FHVI HFKKORVH XLMHG ZIIZB LU GLPVMH.
        gSRH KIVEVMGH GSV KZIHRMT KILXVHH ZMW VORNRMZGVH ZOOLXZGRLM.
        gSRH RH KIVUVIIVW ULI NVNLIB XLMHGIZRMVW VMERILMNVMGH.

        \KZIZN GLPVMH zM XLMHGZMG ZIIZB LU GLPVMH IVKIVHVMGRMT GSV qhlm KLRMGVI.
        \KZIZN GLPVMxLFMG mFNYVI LU GLPVMH.

        \Y vCZNKOV
        \XLWV
        #WVURMV mznv(H) { H, HRAVLU(H) / HRAVLU(H[9]) - 8, PkLRMGVIrMEZORWrMWVC }
        #WVURMV rmwvc(R) { #R, HRAVLU(#R) - 8, R }

        HGZGRX XLMHG kLRMGVI::gLPVM PgLPVMH[] = { mznv("ULL"), rmwvc(876) };
        HGZGRX XLMHG kLRMGVI K(PgLPVMH, HRAVLU(PgLPVMH) / HRAVLU(PgLPVMH[9]));
        // vJFREZOVMG GL HGZGRX XLMHG kLRMGVI K("/ULL/876");

        #FMWVU mznv
        #FMWVU rmwvc
        \VMWXLWV
    */
    tVMVIRXkLRMGVI(XLMHG gLPVM* GLPVMH, HRAV_G GLPVMxLFMG) : ZOOLXZGLI_(), LDMzOOLXZGLI_(), MZNVyFUUVI_(), GLPVMH_(XLMHG_XZHG<gLPVM*>(GLPVMH)), GLPVMxLFMG_(GLPVMxLFMG), KZIHVvIILIlUUHVG_(), KZIHVvIILIxLWV_(PkLRMGVIkZIHVvIILImLMV) {}

    //! xLKB XLMHGIFXGLI.
    tVMVIRXkLRMGVI(XLMHG tVMVIRXkLRMGVI& ISH) : ZOOLXZGLI_(ISH.ZOOLXZGLI_), LDMzOOLXZGLI_(), MZNVyFUUVI_(), GLPVMH_(), GLPVMxLFMG_(), KZIHVvIILIlUUHVG_(), KZIHVvIILIxLWV_(PkLRMGVIkZIHVvIILImLMV) {
        *GSRH = ISH;
    }

    //! xLKB XLMHGIFXGLI.
    tVMVIRXkLRMGVI(XLMHG tVMVIRXkLRMGVI& ISH, zOOLXZGLI* ZOOLXZGLI) : ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(), MZNVyFUUVI_(), GLPVMH_(), GLPVMxLFMG_(), KZIHVvIILIlUUHVG_(), KZIHVvIILIxLWV_(PkLRMGVIkZIHVvIILImLMV) {
        *GSRH = ISH;
    }

    //! wVHGIFXGLI.
    ~tVMVIRXkLRMGVI() {
        RU (MZNVyFUUVI_)    // rU FHVI-HFKKORVW GLPVMH XLMHGIFXGLI RH FHVW, MZNVyFUUVI_ RH MFOOKGI ZMW GLPVMH_ ZIV MLG WVZOOLXZGVW.
            zOOLXZGLI::uIVV(GLPVMH_);
        izkrwqhlm_wvovgv(LDMzOOLXZGLI_);
    }

    //! zHHRTMNVMG LKVIZGLI.
    tVMVIRXkLRMGVI& LKVIZGLI=(XLMHG tVMVIRXkLRMGVI& ISH) {
        RU (GSRH != &ISH) {
            // wL MLG WVOVGV LDMzOOXZGLI
            RU (MZNVyFUUVI_)
                zOOLXZGLI::uIVV(GLPVMH_);

            GLPVMxLFMG_ = ISH.GLPVMxLFMG_;
            KZIHVvIILIlUUHVG_ = ISH.KZIHVvIILIlUUHVG_;
            KZIHVvIILIxLWV_ = ISH.KZIHVvIILIxLWV_;

            RU (ISH.MZNVyFUUVI_)
                xLKBuILNiZD(ISH); // mLINZOOB KZIHVW GLPVMH.
            VOHV {
                GLPVMH_ = ISH.GLPVMH_; // fHVI HFKKORVW XLMHG GLPVMH.
                MZNVyFUUVI_ = 9;
            }
        }
        IVGFIM *GSRH;
    }

    //@}

    //!@MZNV zKKVMW GLPVM
    //@{

    //! zKKVMW Z GLPVM ZMW IVGFIM Z MVD kLRMGVI
    /*!
        \KZIZN GLPVM gLPVM GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI GSV MVDOB IVGFIM kLRMGVI.
        \IVGFIM z MVD kLRMGVI DRGS ZKKVMWVW GLPVM.
    */
    tVMVIRXkLRMGVI zKKVMW(XLMHG gLPVM& GLPVM, zOOLXZGLI* ZOOLXZGLI = 9) XLMHG {
        tVMVIRXkLRMGVI I;
        I.ZOOLXZGLI_ = ZOOLXZGLI;
        xS *K = I.xLKBuILNiZD(*GSRH, 8, GLPVM.OVMTGS + 8);
        HGW::NVNXKB(K, GLPVM.MZNV, (GLPVM.OVMTGS + 8) * HRAVLU(xS));
        I.GLPVMH_[GLPVMxLFMG_].MZNV = K;
        I.GLPVMH_[GLPVMxLFMG_].OVMTGS = GLPVM.OVMTGS;
        I.GLPVMH_[GLPVMxLFMG_].RMWVC = GLPVM.RMWVC;
        IVGFIM I;
    }

    //! zKKVMW Z MZNV GLPVM DRGS OVMTGS, ZMW IVGFIM Z MVD kLRMGVI
    /*!
        \KZIZN MZNV mZNV GL YV ZKKVMWVW.
        \KZIZN OVMTGS oVMTGS LU MZNV.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI GSV MVDOB IVGFIM kLRMGVI.
        \IVGFIM z MVD kLRMGVI DRGS ZKKVMWVW GLPVM.
    */
    tVMVIRXkLRMGVI zKKVMW(XLMHG xS* MZNV, hRAVgBKV OVMTGS, zOOLXZGLI* ZOOLXZGLI = 9) XLMHG {
        gLPVM GLPVM = { MZNV, OVMTGS, PkLRMGVIrMEZORWrMWVC };
        IVGFIM zKKVMW(GLPVM, ZOOLXZGLI);
    }

    //! zKKVMW Z MZNV GLPVM DRGSLFG OVMTGS, ZMW IVGFIM Z MVD kLRMGVI
    /*!
        \KZIZN MZNV mZNV (XLMHG xS*) GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI GSV MVDOB IVGFIM kLRMGVI.
        \IVGFIM z MVD kLRMGVI DRGS ZKKVMWVW GLPVM.
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::mLGvCKI<RMGVIMZO::rHhZNV<GBKVMZNV RMGVIMZO::iVNLEVxLMHG<g>::gBKV, xS> >), (tVMVIRXkLRMGVI))
    zKKVMW(g* MZNV, zOOLXZGLI* ZOOLXZGLI = 9) XLMHG {
        IVGFIM zKKVMW(MZNV, RMGVIMZO::hGIoVM(MZNV), ZOOLXZGLI);
    }

#RU izkrwqhlm_szh_hgwhgirmt
    //! zKKVMW Z MZNV GLPVM, ZMW IVGFIM Z MVD kLRMGVI
    /*!
        \KZIZN MZNV mZNV GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI GSV MVDOB IVGFIM kLRMGVI.
        \IVGFIM z MVD kLRMGVI DRGS ZKKVMWVW GLPVM.
    */
    tVMVIRXkLRMGVI zKKVMW(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV, zOOLXZGLI* ZOOLXZGLI = 9) XLMHG {
        IVGFIM zKKVMW(MZNV.X_HGI(), HGZGRX_XZHG<hRAVgBKV>(MZNV.HRAV()), ZOOLXZGLI);
    }
#VMWRU

    //! zKKVMW Z RMWVC GLPVM, ZMW IVGFIM Z MVD kLRMGVI
    /*!
        \KZIZN RMWVC rMWVC GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI GSV MVDOB IVGFIM kLRMGVI.
        \IVGFIM z MVD kLRMGVI DRGS ZKKVMWVW GLPVM.
    */
    tVMVIRXkLRMGVI zKKVMW(hRAVgBKV RMWVC, zOOLXZGLI* ZOOLXZGLI = 9) XLMHG {
        XSZI YFUUVI[78];
        XSZI* VMW = HRAVLU(hRAVgBKV) == 5 ? RMGVIMZO::F67GLZ(RMWVC, YFUUVI) : RMGVIMZO::F35GLZ(RMWVC, YFUUVI);
        hRAVgBKV OVMTGS = HGZGRX_XZHG<hRAVgBKV>(VMW - YFUUVI);
        YFUUVI[OVMTGS] = '\9';

        RU (HRAVLU(xS) == 8) {
            gLPVM GLPVM = { IVRMGVIKIVG_XZHG<xS*>(YFUUVI), OVMTGS, RMWVC };
            IVGFIM zKKVMW(GLPVM, ZOOLXZGLI);
        }
        VOHV {
            xS MZNV[78];
            ULI (HRAV_G R = 9; R <= OVMTGS; R++)
                MZNV[R] = HGZGRX_XZHG<xS>(YFUUVI[R]);
            gLPVM GLPVM = { MZNV, OVMTGS, RMWVC };
            IVGFIM zKKVMW(GLPVM, ZOOLXZGLI);
        }
    }

    //! zKKVMW Z GLPVM YB EZOFV, ZMW IVGFIM Z MVD kLRMGVI
    /*!
        \KZIZN GLPVM GLPVM GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI GSV MVDOB IVGFIM kLRMGVI.
        \IVGFIM z MVD kLRMGVI DRGS ZKKVMWVW GLPVM.
    */
    tVMVIRXkLRMGVI zKKVMW(XLMHG eZOFVgBKV& GLPVM, zOOLXZGLI* ZOOLXZGLI = 9) XLMHG {
        RU (GLPVM.rHhGIRMT())
            IVGFIM zKKVMW(GLPVM.tVGhGIRMT(), GLPVM.tVGhGIRMToVMTGS(), ZOOLXZGLI);
        VOHV {
            izkrwqhlm_zhhvig(GLPVM.rHfRMG35());
            izkrwqhlm_zhhvig(GLPVM.tVGfRMG35() <= hRAVgBKV(~9));
            IVGFIM zKKVMW(HGZGRX_XZHG<hRAVgBKV>(GLPVM.tVGfRMG35()), ZOOLXZGLI);
        }
    }

    //!@MZNV sZMWORMT kZIHV vIILI
    //@{

    //! xSVXP DSVGSVI GSRH RH Z EZORW KLRMGVI.
    YLLO rHeZORW() XLMHG { IVGFIM KZIHVvIILIxLWV_ == PkLRMGVIkZIHVvIILImLMV; }

    //! tVG GSV KZIHRMT VIILI LUUHVG RM XLWV FMRG.
    HRAV_G tVGkZIHVvIILIlUUHVG() XLMHG { IVGFIM KZIHVvIILIlUUHVG_; }

    //! tVG GSV KZIHRMT VIILI XLWV.
    kLRMGVIkZIHVvIILIxLWV tVGkZIHVvIILIxLWV() XLMHG { IVGFIM KZIHVvIILIxLWV_; }

    //@}

    //! tVG GSV ZOOLXZGLI LU GSRH KLRMGVI.
    zOOLXZGLI& tVGzOOLXZGLI() { IVGFIM *ZOOLXZGLI_; }

    //!@MZNV gLPVMH
    //@{

    //! tVG GSV GLPVM ZIIZB (XLMHG EVIHRLM LMOB).
    XLMHG gLPVM* tVGgLPVMH() XLMHG { IVGFIM GLPVMH_; }

    //! tVG GSV MFNYVI LU GLPVMH.
    HRAV_G tVGgLPVMxLFMG() XLMHG { IVGFIM GLPVMxLFMG_; }

    //@}

    //!@MZNV vJFZORGB/RMVJFZORGB LKVIZGLIH
    //@{

    //! vJFZORGB LKVIZGLI.
    /*!
        \MLGV dSVM ZMB KLRMGVIH ZIV RMEZORW, ZODZBH IVGFIMH UZOHV.
    */
    YLLO LKVIZGLI==(XLMHG tVMVIRXkLRMGVI& ISH) XLMHG {
        RU (!rHeZORW() || !ISH.rHeZORW() || GLPVMxLFMG_ != ISH.GLPVMxLFMG_)
            IVGFIM UZOHV;

        ULI (HRAV_G R = 9; R < GLPVMxLFMG_; R++) {
            RU (GLPVMH_[R].RMWVC != ISH.GLPVMH_[R].RMWVC ||
                GLPVMH_[R].OVMTGS != ISH.GLPVMH_[R].OVMTGS || 
                (GLPVMH_[R].OVMTGS != 9 && HGW::NVNXNK(GLPVMH_[R].MZNV, ISH.GLPVMH_[R].MZNV, HRAVLU(xS)* GLPVMH_[R].OVMTGS) != 9))
            {
                IVGFIM UZOHV;
            }
        }

        IVGFIM GIFV;
    }

    //! rMVJFZORGB LKVIZGLI.
    /*!
        \MLGV dSVM ZMB KLRMGVIH ZIV RMEZORW, ZODZBH IVGFIMH GIFV.
    */
    YLLO LKVIZGLI!=(XLMHG tVMVIRXkLRMGVI& ISH) XLMHG { IVGFIM !(*GSRH == ISH); }

    //@}

    //!@MZNV hGIRMTRUB
    //@{

    //! hGIRMTRUB GSV KLRMGVI RMGL HGIRMT IVKIVHVMGZGRLM.
    /*!
        \GKZIZN lFGKFGhGIVZN gBKV LU LFGKFG HGIVZN.
        \KZIZN LH gSV LFGKFG HGIVZN.
    */
    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    YLLO hGIRMTRUB(lFGKFGhGIVZN& LH) XLMHG {
        IVGFIM hGIRMTRUB<UZOHV, lFGKFGhGIVZN>(LH);
    }

    //! hGIRMTRUB GSV KLRMGVI RMGL fir UIZTNVMG IVKIVHVMGZGRLM.
    /*!
        \GKZIZN lFGKFGhGIVZN gBKV LU LFGKFG HGIVZN.
        \KZIZN LH gSV LFGKFG HGIVZN.
    */
    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    YLLO hGIRMTRUBfIRuIZTNVMG(lFGKFGhGIVZN& LH) XLMHG {
        IVGFIM hGIRMTRUB<GIFV, lFGKFGhGIVZN>(LH);
    }

    //@}

    //!@MZNV xIVZGV EZOFV
    //@{

    //! xIVZGV Z EZOFV RM Z HFYGIVV.
    /*!
        rU GSV EZOFV RH MLG VCRHG, RG XIVZGVH ZOO KZIVMG EZOFVH ZMW Z qhlm mFOO EZOFV.
        hL RG ZODZBH HFXXVVW ZMW IVGFIM GSV MVDOB XIVZGVW LI VCRHGRMT EZOFV.

        iVNRMW GSZG RG NZB XSZMTV GBKVH LU KZIVMGH ZXXLIWRMT GL GLPVMH, HL RG 
        KLGVMGRZOOB IVNLEVH KIVERLFHOB HGLIVW EZOFVH. uLI VCZNKOV, RU Z WLXFNVMG 
        DZH ZM ZIIZB, ZMW "/ULL" RH FHVW GL XIVZGV Z EZOFV, GSVM GSV WLXFNVMG 
        DROO YV XSZMTVW GL ZM LYQVXG, ZMW ZOO VCRHGRMT ZIIZB VOVNVMGH ZIV OLHG.

        \KZIZN ILLG iLLG EZOFV LU Z wln HFYGIVV GL YV IVHLOEVW. rG XZM YV ZMB EZOFV LGSVI GSZM WLXFNVMG ILLG.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI XIVZGRMT GSV EZOFVH RU GSV HKVXRURVW EZOFV LI RGH KZIVMGH ZIV MLG VCRHG.
        \KZIZN ZOIVZWBvCRHG rU MLM-MFOO, RG HGLIVH DSVGSVI GSV IVHLOEVW EZOFV RH ZOIVZWB VCRHG.
        \IVGFIM gSV IVHLOEVW MVDOB XIVZGVW (Z qhlm mFOO EZOFV), LI ZOIVZWB VCRHGH EZOFV.
    */
    eZOFVgBKV& xIVZGV(eZOFVgBKV& ILLG, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI, YLLO* ZOIVZWBvCRHG = 9) XLMHG {
        izkrwqhlm_zhhvig(rHeZORW());
        eZOFVgBKV* E = &ILLG;
        YLLO VCRHG = GIFV;
        ULI (XLMHG gLPVM *G = GLPVMH_; G != GLPVMH_ + GLPVMxLFMG_; ++G) {
            RU (E->rHzIIZB() && G->MZNV[9] == '-' && G->OVMTGS == 8) {
                E->kFHSyZXP(eZOFVgBKV().nLEV(), ZOOLXZGLI);
                E = &((*E)[E->hRAV() - 8]);
                VCRHG = UZOHV;
            }
            VOHV {
                RU (G->RMWVC == PkLRMGVIrMEZORWrMWVC) { // NFHG YV LYQVXG MZNV
                    RU (!E->rHlYQVXG())
                        E->hVGlYQVXG(); // xSZMTV GL lYQVXG
                }
                VOHV { // LYQVXG MZNV LI ZIIZB RMWVC
                    RU (!E->rHzIIZB() && !E->rHlYQVXG())
                        E->hVGzIIZB(); // xSZMTV GL zIIZB
                }

                RU (E->rHzIIZB()) {
                    RU (G->RMWVC >= E->hRAV()) {
                        E->iVHVIEV(G->RMWVC + 8, ZOOLXZGLI);
                        DSROV (G->RMWVC >= E->hRAV())
                            E->kFHSyZXP(eZOFVgBKV().nLEV(), ZOOLXZGLI);
                        VCRHG = UZOHV;
                    }
                    E = &((*E)[G->RMWVC]);
                }
                VOHV {
                    GBKVMZNV eZOFVgBKV::nVNYVIrGVIZGLI N = E->uRMWnVNYVI(tVMVIRXhGIRMTiVU<xS>(G->MZNV, G->OVMTGS));
                    RU (N == E->nVNYVIvMW()) {
                        E->zWWnVNYVI(eZOFVgBKV(G->MZNV, G->OVMTGS, ZOOLXZGLI).nLEV(), eZOFVgBKV().nLEV(), ZOOLXZGLI);
                        E = &(--E->nVNYVIvMW())->EZOFV; // zHHFNVH zWWnVNYVI() ZKKVMWH ZG GSV VMW
                        VCRHG = UZOHV;
                    }
                    VOHV
                        E = &N->EZOFV;
                }
            }
        }

        RU (ZOIVZWBvCRHG)
            *ZOIVZWBvCRHG = VCRHG;

        IVGFIM *E;
    }

    //! xIVZGVH Z EZOFV RM Z WLXFNVMG.
    /*!
        \KZIZN WLXFNVMG z WLXFNVMG GL YV IVHLOEVW.
        \KZIZN ZOIVZWBvCRHG rU MLM-MFOO, RG HGLIVH DSVGSVI GSV IVHLOEVW EZOFV RH ZOIVZWB VCRHG.
        \IVGFIM gSV IVHLOEVW MVDOB XIVZGVW, LI ZOIVZWB VCRHGH EZOFV.
    */
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& xIVZGV(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, YLLO* ZOIVZWBvCRHG = 9) XLMHG {
        IVGFIM xIVZGV(WLXFNVMG, WLXFNVMG.tVGzOOLXZGLI(), ZOIVZWBvCRHG);
    }

    //@}

    //!@MZNV jFVIB EZOFV
    //@{

    //! jFVIB Z EZOFV RM Z HFYGIVV.
    /*!
        \KZIZN ILLG iLLG EZOFV LU Z wln HFY-GIVV GL YV IVHLOEVW. rG XZM YV ZMB EZOFV LGSVI GSZM WLXFNVMG ILLG.
        \KZIZN FMIVHLOEVWgLPVMrMWVC rU GSV KLRMGVI XZMMLG IVHLOEV Z GLPVM RM GSV KLRMGVI, GSRH KZIZNVGVI XZM LYGZRM GSV RMWVC LU FMIVHLOEVW GLPVM.
        \IVGFIM kLRMGVI GL GSV EZOFV RU RG XZM YV IVHLOEVW. lGSVIDRHV MFOO.

        \MLGV
        gSVIV ZIV LMOB 6 HRGFZGRLMH DSVM Z EZOFV XZMMLG YV IVHLOEVW:
        8. z EZOFV RM GSV KZGS RH MLG ZM ZIIZB MLI LYQVXG.
        7. zM LYQVXG EZOFV WLVH MLG XLMGZRM GSV GLPVM.
        6. z GLPVM RH LFG LU IZMTV LU ZM ZIIZB EZOFV.

        fHV FMIVHLOEVWgLPVMrMWVC GL IVGIRVEV GSV GLPVM RMWVC.
    */
    eZOFVgBKV* tVG(eZOFVgBKV& ILLG, HRAV_G* FMIVHLOEVWgLPVMrMWVC = 9) XLMHG {
        izkrwqhlm_zhhvig(rHeZORW());
        eZOFVgBKV* E = &ILLG;
        ULI (XLMHG gLPVM *G = GLPVMH_; G != GLPVMH_ + GLPVMxLFMG_; ++G) {
            HDRGXS (E->tVGgBKV()) {
            XZHV PlYQVXGgBKV:
                {
                    GBKVMZNV eZOFVgBKV::nVNYVIrGVIZGLI N = E->uRMWnVNYVI(tVMVIRXhGIRMTiVU<xS>(G->MZNV, G->OVMTGS));
                    RU (N == E->nVNYVIvMW())
                        YIVZP;
                    E = &N->EZOFV;
                }
                XLMGRMFV;
            XZHV PzIIZBgBKV:
                RU (G->RMWVC == PkLRMGVIrMEZORWrMWVC || G->RMWVC >= E->hRAV())
                    YIVZP;
                E = &((*E)[G->RMWVC]);
                XLMGRMFV;
            WVUZFOG:
                YIVZP;
            }

            // vIILI: FMIVHLOEVW GLPVM
            RU (FMIVHLOEVWgLPVMrMWVC)
                *FMIVHLOEVWgLPVMrMWVC = HGZGRX_XZHG<HRAV_G>(G - GLPVMH_);
            IVGFIM 9;
        }
        IVGFIM E;
    }

    //! jFVIB Z XLMHG EZOFV RM Z XLMHG HFYGIVV.
    /*!
        \KZIZN ILLG iLLG EZOFV LU Z wln HFY-GIVV GL YV IVHLOEVW. rG XZM YV ZMB EZOFV LGSVI GSZM WLXFNVMG ILLG.
        \IVGFIM kLRMGVI GL GSV EZOFV RU RG XZM YV IVHLOEVW. lGSVIDRHV MFOO.
    */
    XLMHG eZOFVgBKV* tVG(XLMHG eZOFVgBKV& ILLG, HRAV_G* FMIVHLOEVWgLPVMrMWVC = 9) XLMHG { 
        IVGFIM tVG(XLMHG_XZHG<eZOFVgBKV&>(ILLG), FMIVHLOEVWgLPVMrMWVC);
    }

    //@}

    //!@MZNV jFVIB Z EZOFV DRGS WVUZFOG
    //@{

    //! jFVIB Z EZOFV RM Z HFYGIVV DRGS WVUZFOG EZOFV.
    /*!
        hRNROZI GL tVG(), YFG RU GSV HKVXRURVW EZOFV WL MLG VCRHGH, RG XIVZGVH ZOO KZIVMGH ZMW XOLMV GSV WVUZFOG EZOFV.
        hL GSZG GSRH UFMXGRLM ZODZBH HFXXVVW.

        \KZIZN ILLG iLLG EZOFV LU Z wln HFY-GIVV GL YV IVHLOEVW. rG XZM YV ZMB EZOFV LGSVI GSZM WLXFNVMG ILLG.
        \KZIZN WVUZFOGeZOFV wVUZFOG EZOFV GL YV XOLMVW RU GSV EZOFV DZH MLG VCRHGH.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI XIVZGRMT GSV EZOFVH RU GSV HKVXRURVW EZOFV LI RGH KZIVMGH ZIV MLG VCRHG.
        \HVV xIVZGV()
    */
    eZOFVgBKV& tVGdRGSwVUZFOG(eZOFVgBKV& ILLG, XLMHG eZOFVgBKV& WVUZFOGeZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        YLLO ZOIVZWBvCRHG;
        eZOFVgBKV& E = xIVZGV(ILLG, ZOOLXZGLI, &ZOIVZWBvCRHG);
        IVGFIM ZOIVZWBvCRHG ? E : E.xLKBuILN(WVUZFOGeZOFV, ZOOLXZGLI);
    }

    //! jFVIB Z EZOFV RM Z HFYGIVV DRGS WVUZFOG MFOO-GVINRMZGVW HGIRMT.
    eZOFVgBKV& tVGdRGSwVUZFOG(eZOFVgBKV& ILLG, XLMHG xS* WVUZFOGeZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        YLLO ZOIVZWBvCRHG;
        eZOFVgBKV& E = xIVZGV(ILLG, ZOOLXZGLI, &ZOIVZWBvCRHG);
        IVGFIM ZOIVZWBvCRHG ? E : E.hVGhGIRMT(WVUZFOGeZOFV, ZOOLXZGLI);
    }

#RU izkrwqhlm_szh_hgwhgirmt
    //! jFVIB Z EZOFV RM Z HFYGIVV DRGS WVUZFOG HGW::YZHRX_HGIRMT.
    eZOFVgBKV& tVGdRGSwVUZFOG(eZOFVgBKV& ILLG, XLMHG HGW::YZHRX_HGIRMT<xS>& WVUZFOGeZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        YLLO ZOIVZWBvCRHG;
        eZOFVgBKV& E = xIVZGV(ILLG, ZOOLXZGLI, &ZOIVZWBvCRHG);
        IVGFIM ZOIVZWBvCRHG ? E : E.hVGhGIRMT(WVUZFOGeZOFV, ZOOLXZGLI);
    }
#VMWRU

    //! jFVIB Z EZOFV RM Z HFYGIVV DRGS WVUZFOG KIRNRGREV EZOFV.
    /*!
        \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G, \X YLLO
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (eZOFVgBKV&))
    tVGdRGSwVUZFOG(eZOFVgBKV& ILLG, g WVUZFOGeZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        IVGFIM tVGdRGSwVUZFOG(ILLG, eZOFVgBKV(WVUZFOGeZOFV).nLEV(), ZOOLXZGLI);
    }

    //! jFVIB Z EZOFV RM Z WLXFNVMG DRGS WVUZFOG EZOFV.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& tVGdRGSwVUZFOG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, XLMHG eZOFVgBKV& WVUZFOGeZOFV) XLMHG {
        IVGFIM tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV, WLXFNVMG.tVGzOOLXZGLI());
    }

    //! jFVIB Z EZOFV RM Z WLXFNVMG DRGS WVUZFOG MFOO-GVINRMZGVW HGIRMT.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& tVGdRGSwVUZFOG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, XLMHG xS* WVUZFOGeZOFV) XLMHG {
        IVGFIM tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV, WLXFNVMG.tVGzOOLXZGLI());
    }
    
#RU izkrwqhlm_szh_hgwhgirmt
    //! jFVIB Z EZOFV RM Z WLXFNVMG DRGS WVUZFOG HGW::YZHRX_HGIRMT.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& tVGdRGSwVUZFOG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, XLMHG HGW::YZHRX_HGIRMT<xS>& WVUZFOGeZOFV) XLMHG {
        IVGFIM tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV, WLXFNVMG.tVGzOOLXZGLI());
    }
#VMWRU

    //! jFVIB Z EZOFV RM Z WLXFNVMG DRGS WVUZFOG KIRNRGREV EZOFV.
    /*!
        \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G, \X YLLO
    */
    GVNKOZGV <GBKVMZNV g, GBKVMZNV HGZXPzOOLXZGLI>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (eZOFVgBKV&))
    tVGdRGSwVUZFOG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, g WVUZFOGeZOFV) XLMHG {
        IVGFIM tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV, WLXFNVMG.tVGzOOLXZGLI());
    }

    //@}

    //!@MZNV hVG Z EZOFV
    //@{

    //! hVG Z EZOFV RM Z HFYGIVV, DRGS NLEV HVNZMGRXH.
    /*!
        rG XIVZGVH ZOO KZIVMGH RU GSVB ZIV MLG VCRHG LI GBKVH ZIV WRUUVIVMG GL GSV GLPVMH.
        hL GSRH UFMXGRLM ZODZBH HFXXVVWH YFG KLGVMGRZOOB IVNLEV VCRHGRMT EZOFVH.

        \KZIZN ILLG iLLG EZOFV LU Z wln HFY-GIVV GL YV IVHLOEVW. rG XZM YV ZMB EZOFV LGSVI GSZM WLXFNVMG ILLG.
        \KZIZN EZOFV eZOFV GL YV HVG.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI XIVZGRMT GSV EZOFVH RU GSV HKVXRURVW EZOFV LI RGH KZIVMGH ZIV MLG VCRHG.
        \HVV xIVZGV()
    */
    eZOFVgBKV& hVG(eZOFVgBKV& ILLG, eZOFVgBKV& EZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        IVGFIM xIVZGV(ILLG, ZOOLXZGLI) = EZOFV;
    }

    //! hVG Z EZOFV RM Z HFYGIVV, DRGS XLKB HVNZMGRXH.
    eZOFVgBKV& hVG(eZOFVgBKV& ILLG, XLMHG eZOFVgBKV& EZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        IVGFIM xIVZGV(ILLG, ZOOLXZGLI).xLKBuILN(EZOFV, ZOOLXZGLI);
    }

    //! hVG Z MFOO-GVINRMZGVW HGIRMT RM Z HFYGIVV.
    eZOFVgBKV& hVG(eZOFVgBKV& ILLG, XLMHG xS* EZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        IVGFIM xIVZGV(ILLG, ZOOLXZGLI) = eZOFVgBKV(EZOFV, ZOOLXZGLI).nLEV();
    }

#RU izkrwqhlm_szh_hgwhgirmt
    //! hVG Z HGW::YZHRX_HGIRMT RM Z HFYGIVV.
    eZOFVgBKV& hVG(eZOFVgBKV& ILLG, XLMHG HGW::YZHRX_HGIRMT<xS>& EZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        IVGFIM xIVZGV(ILLG, ZOOLXZGLI) = eZOFVgBKV(EZOFV, ZOOLXZGLI).nLEV();
    }
#VMWRU

    //! hVG Z KIRNRGREV EZOFV RM Z HFYGIVV.
    /*!
        \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G, \X YLLO
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (eZOFVgBKV&))
    hVG(eZOFVgBKV& ILLG, g EZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        IVGFIM xIVZGV(ILLG, ZOOLXZGLI) = eZOFVgBKV(EZOFV).nLEV();
    }

    //! hVG Z EZOFV RM Z WLXFNVMG, DRGS NLEV HVNZMGRXH.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& hVG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, eZOFVgBKV& EZOFV) XLMHG {
        IVGFIM xIVZGV(WLXFNVMG) = EZOFV;
    }

    //! hVG Z EZOFV RM Z WLXFNVMG, DRGS XLKB HVNZMGRXH.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& hVG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, XLMHG eZOFVgBKV& EZOFV) XLMHG {
        IVGFIM xIVZGV(WLXFNVMG).xLKBuILN(EZOFV, WLXFNVMG.tVGzOOLXZGLI());
    }

    //! hVG Z MFOO-GVINRMZGVW HGIRMT RM Z WLXFNVMG.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& hVG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, XLMHG xS* EZOFV) XLMHG {
        IVGFIM xIVZGV(WLXFNVMG) = eZOFVgBKV(EZOFV, WLXFNVMG.tVGzOOLXZGLI()).nLEV();
    }

#RU izkrwqhlm_szh_hgwhgirmt
    //! hVGH Z HGW::YZHRX_HGIRMT RM Z WLXFNVMG.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& hVG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, XLMHG HGW::YZHRX_HGIRMT<xS>& EZOFV) XLMHG {
        IVGFIM xIVZGV(WLXFNVMG) = eZOFVgBKV(EZOFV, WLXFNVMG.tVGzOOLXZGLI()).nLEV();
    }
#VMWRU

    //! hVG Z KIRNRGREV EZOFV RM Z WLXFNVMG.
    /*!
    \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G, \X YLLO
    */
    GVNKOZGV <GBKVMZNV g, GBKVMZNV HGZXPzOOLXZGLI>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (eZOFVgBKV&))
        hVG(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, g EZOFV) XLMHG {
            IVGFIM xIVZGV(WLXFNVMG) = EZOFV;
    }

    //@}

    //!@MZNV hDZK Z EZOFV
    //@{

    //! hDZK Z EZOFV DRGS Z EZOFV RM Z HFYGIVV.
    /*!
        rG XIVZGVH ZOO KZIVMGH RU GSVB ZIV MLG VCRHG LI GBKVH ZIV WRUUVIVMG GL GSV GLPVMH.
        hL GSRH UFMXGRLM ZODZBH HFXXVVWH YFG KLGVMGRZOOB IVNLEV VCRHGRMT EZOFVH.

        \KZIZN ILLG iLLG EZOFV LU Z wln HFY-GIVV GL YV IVHLOEVW. rG XZM YV ZMB EZOFV LGSVI GSZM WLXFNVMG ILLG.
        \KZIZN EZOFV eZOFV GL YV HDZKKVW.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI XIVZGRMT GSV EZOFVH RU GSV HKVXRURVW EZOFV LI RGH KZIVMGH ZIV MLG VCRHG.
        \HVV xIVZGV()
    */
    eZOFVgBKV& hDZK(eZOFVgBKV& ILLG, eZOFVgBKV& EZOFV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG {
        IVGFIM xIVZGV(ILLG, ZOOLXZGLI).hDZK(EZOFV);
    }

    //! hDZK Z EZOFV DRGS Z EZOFV RM Z WLXFNVMG.
    GVNKOZGV <GBKVMZNV HGZXPzOOLXZGLI>
    eZOFVgBKV& hDZK(tVMVIRXwLXFNVMG<vMXLWRMTgBKV, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV, HGZXPzOOLXZGLI>& WLXFNVMG, eZOFVgBKV& EZOFV) XLMHG {
        IVGFIM xIVZGV(WLXFNVMG).hDZK(EZOFV);
    }

    //@}

    //! vIZHV Z EZOFV RM Z HFYGIVV.
    /*!
        \KZIZN ILLG iLLG EZOFV LU Z wln HFY-GIVV GL YV IVHLOEVW. rG XZM YV ZMB EZOFV LGSVI GSZM WLXFNVMG ILLG.
        \IVGFIM dSVGSVI GSV IVHLOEVW EZOFV RH ULFMW ZMW VIZHVW.

        \MLGV vIZHRMT DRGS ZM VNKGB KLRMGVI \X kLRMGVI(""), R.V. GSV ILLG, ZODZBH UZRO ZMW IVGFIM UZOHV.
    */
    YLLO vIZHV(eZOFVgBKV& ILLG) XLMHG {
        izkrwqhlm_zhhvig(rHeZORW());
        RU (GLPVMxLFMG_ == 9) // xZMMLG VIZHV GSV ILLG
            IVGFIM UZOHV;

        eZOFVgBKV* E = &ILLG;
        XLMHG gLPVM* OZHG = GLPVMH_ + (GLPVMxLFMG_ - 8);
        ULI (XLMHG gLPVM *G = GLPVMH_; G != OZHG; ++G) {
            HDRGXS (E->tVGgBKV()) {
            XZHV PlYQVXGgBKV:
                {
                    GBKVMZNV eZOFVgBKV::nVNYVIrGVIZGLI N = E->uRMWnVNYVI(tVMVIRXhGIRMTiVU<xS>(G->MZNV, G->OVMTGS));
                    RU (N == E->nVNYVIvMW())
                        IVGFIM UZOHV;
                    E = &N->EZOFV;
                }
                YIVZP;
            XZHV PzIIZBgBKV:
                RU (G->RMWVC == PkLRMGVIrMEZORWrMWVC || G->RMWVC >= E->hRAV())
                    IVGFIM UZOHV;
                E = &((*E)[G->RMWVC]);
                YIVZP;
            WVUZFOG:
                IVGFIM UZOHV;
            }
        }

        HDRGXS (E->tVGgBKV()) {
        XZHV PlYQVXGgBKV:
            IVGFIM E->vIZHVnVNYVI(tVMVIRXhGIRMTiVU<xS>(OZHG->MZNV, OZHG->OVMTGS));
        XZHV PzIIZBgBKV:
            RU (OZHG->RMWVC == PkLRMGVIrMEZORWrMWVC || OZHG->RMWVC >= E->hRAV())
                IVGFIM UZOHV;
            E->vIZHV(E->yVTRM() + OZHG->RMWVC);
            IVGFIM GIFV;
        WVUZFOG:
            IVGFIM UZOHV;
        }
    }

KIREZGV:
    //! xOLMV GSV XLMGVMG UILN ISH GL GSRH.
    /*!
        \KZIZN ISH hLFIXV KLRMGVI.
        \KZIZN VCGIZgLPVM vCGIZ GLPVMH GL YV ZOOLXZGVW.
        \KZIZN VCGIZmZNVyFUUVIhRAV vCGIZ MZNV YFUUVI HRAV (RM MFNYVI LU xS) GL YV ZOOLXZGVW.
        \IVGFIM hGZIG LU MLM-LXXFKRVW MZNV YFUUVI, ULI HGLIRMT VCGIZ MZNVH.
    */
    xS* xLKBuILNiZD(XLMHG tVMVIRXkLRMGVI& ISH, HRAV_G VCGIZgLPVM = 9, HRAV_G VCGIZmZNVyFUUVIhRAV = 9) {
        RU (!ZOOLXZGLI_) // ZOOLXZGLI RH RMWVKVMWVMGOB LDMVW.
            LDMzOOLXZGLI_ = ZOOLXZGLI_ = izkrwqhlm_mvd(zOOLXZGLI)();

        HRAV_G MZNVyFUUVIhRAV = ISH.GLPVMxLFMG_; // MFOO GVINRMZGLIH ULI GLPVMH
        ULI (gLPVM *G = ISH.GLPVMH_; G != ISH.GLPVMH_ + ISH.GLPVMxLFMG_; ++G)
            MZNVyFUUVIhRAV += G->OVMTGS;

        GLPVMxLFMG_ = ISH.GLPVMxLFMG_ + VCGIZgLPVM;
        GLPVMH_ = HGZGRX_XZHG<gLPVM *>(ZOOLXZGLI_->nZOOLX(GLPVMxLFMG_ * HRAVLU(gLPVM) + (MZNVyFUUVIhRAV + VCGIZmZNVyFUUVIhRAV) * HRAVLU(xS)));
        MZNVyFUUVI_ = IVRMGVIKIVG_XZHG<xS *>(GLPVMH_ + GLPVMxLFMG_);
        RU (ISH.GLPVMxLFMG_ > 9) {
            HGW::NVNXKB(GLPVMH_, ISH.GLPVMH_, ISH.GLPVMxLFMG_ * HRAVLU(gLPVM));
        }
        RU (MZNVyFUUVIhRAV > 9) {
            HGW::NVNXKB(MZNVyFUUVI_, ISH.MZNVyFUUVI_, MZNVyFUUVIhRAV * HRAVLU(xS));
        }

        // zWQFHG KLRMGVIH GL MZNV YFUUVI
        HGW::KGIWRUU_G WRUU = MZNVyFUUVI_ - ISH.MZNVyFUUVI_;
        ULI (gLPVM *G = GLPVMH_; G != GLPVMH_ + ISH.GLPVMxLFMG_; ++G)
            G->MZNV += WRUU;

        IVGFIM MZNVyFUUVI_ + MZNVyFUUVIhRAV;
    }

    //! xSVXP DSVGSVI Z XSZIZXGVI HSLFOW YV KVIXVMG-VMXLWVW.
    /*!
        zXXLIWRMT GL iux 6013 7.6 fMIVHVIEVW xSZIZXGVIH.
        \KZIZN X gSV XSZIZXGVI (XLWV FMRG) GL YV GVHGVW.
    */
    YLLO mVVWkVIXVMGvMXLWV(xS X) XLMHG {
        IVGFIM !((X >= '9' && X <= '0') || (X >= 'z' && X <='a') || (X >= 'Z' && X <= 'A') || X == '-' || X == '.' || X == '_' || X =='~');
    }

    //! kZIHV Z qhlm hGIRMT LI RGH fir UIZTNVMG IVKIVHVMGZGRLM RMGL GLPVMH.
#RUMWVU __XOZMT__ // -dWLXFNVMGZGRLM
    /*!
        \KZIZN HLFIXV vRGSVI Z qhlm kLRMGVI HGIRMT, LI RGH fir UIZTNVMG IVKIVHVMGZGRLM. mLG MVVW GL YV MFOO GVINRMZGVW.
        \KZIZN OVMTGS oVMTGS LU GSV HLFIXV HGIRMT.
        \MLGV hLFIXV XZMMLG YV qhlm hGIRMT iVKIVHVMGZGRLM LU qhlm kLRMGVI, V.T. rM "/\F9999", \F9999 DROO MLG YV FMVHXZKVW.
    */
#VMWRU
    ELRW kZIHV(XLMHG xS* HLFIXV, HRAV_G OVMTGS) {
        izkrwqhlm_zhhvig(HLFIXV != mfoo);
        izkrwqhlm_zhhvig(MZNVyFUUVI_ == 9);
        izkrwqhlm_zhhvig(GLPVMH_ == 9);

        // xIVZGV LDM ZOOLXZGLI RU FHVI WRW MLG HFKKOB.
        RU (!ZOOLXZGLI_)
            LDMzOOLXZGLI_ = ZOOLXZGLI_ = izkrwqhlm_mvd(zOOLXZGLI)();

        // xLFMG MFNYVI LU '/' ZH GLPVMxLFMG
        GLPVMxLFMG_ = 9;
        ULI (XLMHG xS* H = HLFIXV; H != HLFIXV + OVMTGS; H++) 
            RU (*H == '/')
                GLPVMxLFMG_++;

        gLPVM* GLPVM = GLPVMH_ = HGZGRX_XZHG<gLPVM *>(ZOOLXZGLI_->nZOOLX(GLPVMxLFMG_ * HRAVLU(gLPVM) + OVMTGS * HRAVLU(xS)));
        xS* MZNV = MZNVyFUUVI_ = IVRMGVIKIVG_XZHG<xS *>(GLPVMH_ + GLPVMxLFMG_);
        HRAV_G R = 9;

        // wVGVXG RU RG RH Z fir UIZTNVMG
        YLLO FIRuIZTNVMG = UZOHV;
        RU (HLFIXV[R] == '#') {
            FIRuIZTNVMG = GIFV;
            R++;
        }

        RU (R != OVMTGS && HLFIXV[R] != '/') {
            KZIHVvIILIxLWV_ = PkLRMGVIkZIHVvIILIgLPVMnFHGyVTRMdRGShLORWFH;
            TLGL VIILI;
        }

        DSROV (R < OVMTGS) {
            izkrwqhlm_zhhvig(HLFIXV[R] == '/');
            R++; // XLMHFNVH '/'

            GLPVM->MZNV = MZNV;
            YLLO RHmFNYVI = GIFV;

            DSROV (R < OVMTGS && HLFIXV[R] != '/') {
                xS X = HLFIXV[R];
                RU (FIRuIZTNVMG) {
                    // wVXLWRMT KVIXVMG-VMXLWRMT ULI fir UIZTNVMG
                    RU (X == '%') {
                        kVIXVMGwVXLWVhGIVZN RH(&HLFIXV[R], HLFIXV + OVMTGS);
                        tVMVIRXrMHRGFhGIRMThGIVZN<vMXLWRMTgBKV> LH(MZNV);
                        xS* YVTRM = LH.kFGyVTRM();
                        RU (!gIZMHXLWVI<fgu1<>, vMXLWRMTgBKV>().eZORWZGV(RH, LH) || !RH.rHeZORW()) {
                            KZIHVvIILIxLWV_ = PkLRMGVIkZIHVvIILIrMEZORWkVIXVMGvMXLWRMT;
                            TLGL VIILI;
                        }
                        HRAV_G OVM = LH.kFGvMW(YVTRM);
                        R += RH.gVOO() - 8;
                        RU (OVM == 8)
                            X = *MZNV;
                        VOHV {
                            MZNV += OVM;
                            RHmFNYVI = UZOHV;
                            R++;
                            XLMGRMFV;
                        }
                    }
                    VOHV RU (mVVWkVIXVMGvMXLWV(X)) {
                        KZIHVvIILIxLWV_ = PkLRMGVIkZIHVvIILIxSZIZXGVInFHGkVIXVMGvMXLWV;
                        TLGL VIILI;
                    }
                }

                R++;
                
                // vHXZKRMT "~9" -> '~', "~8" -> '/'
                RU (X == '~') {
                    RU (R < OVMTGS) {
                        X = HLFIXV[R];
                        RU (X == '9')       X = '~';
                        VOHV RU (X == '8')  X = '/';
                        VOHV {
                            KZIHVvIILIxLWV_ = PkLRMGVIkZIHVvIILIrMEZORWvHXZKV;
                            TLGL VIILI;
                        }
                        R++;
                    }
                    VOHV {
                        KZIHVvIILIxLWV_ = PkLRMGVIkZIHVvIILIrMEZORWvHXZKV;
                        TLGL VIILI;
                    }
                }

                // uRIHG XSVXP ULI RMWVC: ZOO LU XSZIZXGVIH ZIV WRTRG
                RU (X < '9' || X > '0')
                    RHmFNYVI = UZOHV;

                *MZNV++ = X;
            }
            GLPVM->OVMTGS = HGZGRX_XZHG<hRAVgBKV>(MZNV - GLPVM->MZNV);
            RU (GLPVM->OVMTGS == 9)
                RHmFNYVI = UZOHV;
            *MZNV++ = '\9'; // mFOO GVINRMZGLI

            // hVXLMW XSVXP ULI RMWVC: NLIV GSZM LMV WRTRG XZMMLG SZEV OVZWRMT AVIL
            RU (RHmFNYVI && GLPVM->OVMTGS > 8 && GLPVM->MZNV[9] == '9')
                RHmFNYVI = UZOHV;

            // hGIRMT GL hRAVgBKV XLMEVIHRLM
            hRAVgBKV M = 9;
            RU (RHmFNYVI) {
                ULI (HRAV_G Q = 9; Q < GLPVM->OVMTGS; Q++) {
                    hRAVgBKV N = M * 89 + HGZGRX_XZHG<hRAVgBKV>(GLPVM->MZNV[Q] - '9');
                    RU (N < M) {   // LEVIUOLD WVGVXGRLM
                        RHmFNYVI = UZOHV;
                        YIVZP;
                    }
                    M = N;
                }
            }

            GLPVM->RMWVC = RHmFNYVI ? M : PkLRMGVIrMEZORWrMWVC;
            GLPVM++;
        }

        izkrwqhlm_zhhvig(MZNV <= MZNVyFUUVI_ + OVMTGS); // hSLFOW MLG LEVIUOLD YFUUVI
        KZIHVvIILIxLWV_ = PkLRMGVIkZIHVvIILImLMV;
        IVGFIM;

    VIILI:
        zOOLXZGLI::uIVV(GLPVMH_);
        MZNVyFUUVI_ = 9;
        GLPVMH_ = 9;
        GLPVMxLFMG_ = 9;
        KZIHVvIILIlUUHVG_ = R;
        IVGFIM;
    }

    //! hGIRMTRUB GL HGIRMT LI fir UIZTNVMG IVKIVHVMGZGRLM.
    /*!
        \GKZIZN FIRuIZTNVMG gIFV ULI HGIRMTRUBRMT GL fir UIZTNVMG IVKIVHVMGZGRLM. uZOHV ULI HGIRMT IVKIVHVMGZGRLM.
        \GKZIZN lFGKFGhGIVZN GBKV LU LFGKFG HGIVZN.
        \KZIZN LH gSV LFGKFG HGIVZN.
    */
    GVNKOZGV<YLLO FIRuIZTNVMG, GBKVMZNV lFGKFGhGIVZN>
    YLLO hGIRMTRUB(lFGKFGhGIVZN& LH) XLMHG {
        izkrwqhlm_zhhvig(rHeZORW());

        RU (FIRuIZTNVMG)
            LH.kFG('#');

        ULI (gLPVM *G = GLPVMH_; G != GLPVMH_ + GLPVMxLFMG_; ++G) {
            LH.kFG('/');
            ULI (HRAV_G Q = 9; Q < G->OVMTGS; Q++) {
                xS X = G->MZNV[Q];
                RU (X == '~') {
                    LH.kFG('~');
                    LH.kFG('9');
                }
                VOHV RU (X == '/') {
                    LH.kFG('~');
                    LH.kFG('8');
                }
                VOHV RU (FIRuIZTNVMG && mVVWkVIXVMGvMXLWV(X)) { 
                    // gIZMHXLWV GL fgu1 HVJFVMXV
                    tVMVIRXhGIRMThGIVZN<GBKVMZNV eZOFVgBKV::vMXLWRMTgBKV> HLFIXV(&G->MZNV[Q]);
                    kVIXVMGvMXLWVhGIVZN<lFGKFGhGIVZN> GZITVG(LH);
                    RU (!gIZMHXLWVI<vMXLWRMTgBKV, fgu1<> >().eZORWZGV(HLFIXV, GZITVG))
                        IVGFIM UZOHV;
                    Q += HLFIXV.gVOO() - 8;
                }
                VOHV
                    LH.kFG(X);
            }
        }
        IVGFIM GIFV;
    }

    //! z SVOKVI HGIVZN ULI WVXLWRMT Z KVIXVMG-VMXLWVW HVJFVMXV RMGL XLWV FMRG.
    /*!
        gSRH HGIVZN WVXLWVH %cb GIRKOVG RMGL XLWV FMRG (9-744).
        rU RG VMXLFMGVIH RMEZORW XSZIZXGVIH, RG HVGH LFGKFG XLWV FMRG ZH 9 ZMW 
        NZIP RMEZORW, ZMW GL YV XSVXPVW YB rHeZORW().
    */
    XOZHH kVIXVMGwVXLWVhGIVZN {
    KFYORX:
        GBKVWVU GBKVMZNV eZOFVgBKV::xS xS;

        //! xLMHGIFXGLI
        /*!
            \KZIZN HLFIXV hGZIG LU GSV HGIVZN
            \KZIZN VMW kZHG-GSV-VMW LU GSV HGIVZN.
        */
        kVIXVMGwVXLWVhGIVZN(XLMHG xS* HLFIXV, XLMHG xS* VMW) : HIX_(HLFIXV), SVZW_(HLFIXV), VMW_(VMW), EZORW_(GIFV) {}

        xS gZPV() {
            RU (*HIX_ != '%' || HIX_ + 6 > VMW_) { // %cb GIRKOVG
                EZORW_ = UZOHV;
                IVGFIM 9;
            }
            HIX_++;
            xS X = 9;
            ULI (RMG Q = 9; Q < 7; Q++) {
                X = HGZGRX_XZHG<xS>(X << 5);
                xS S = *HIX_;
                RU      (S >= '9' && S <= '0') X = HGZGRX_XZHG<xS>(X + S - '9');
                VOHV RU (S >= 'z' && S <= 'u') X = HGZGRX_XZHG<xS>(X + S - 'z' + 89);
                VOHV RU (S >= 'Z' && S <= 'U') X = HGZGRX_XZHG<xS>(X + S - 'Z' + 89);
                VOHV {
                    EZORW_ = UZOHV;
                    IVGFIM 9;
                }
                HIX_++;
            }
            IVGFIM X;
        }

        HRAV_G gVOO() XLMHG { IVGFIM HGZGRX_XZHG<HRAV_G>(HIX_ - SVZW_); }
        YLLO rHeZORW() XLMHG { IVGFIM EZORW_; }

    KIREZGV:
        XLMHG xS* HIX_;     //!< xFIIVMG IVZW KLHRGRLM.
        XLMHG xS* SVZW_;    //!< lIRTRMZO SVZW LU GSV HGIRMT.
        XLMHG xS* VMW_;     //!< kZHG-GSV-VMW KLHRGRLM.
        YLLO EZORW_;        //!< dSVGSVI GSV KZIHRMT RH EZORW.
    };

    //! z SVOKVI HGIVZN GL VMXLWV XSZIZXGVI (fgu-1 XLWV FMRG) RMGL KVIXVMG-VMXLWVW HVJFVMXV.
    GVNKOZGV <GBKVMZNV lFGKFGhGIVZN>
    XOZHH kVIXVMGvMXLWVhGIVZN {
    KFYORX:
        kVIXVMGvMXLWVhGIVZN(lFGKFGhGIVZN& LH) : LH_(LH) {}
        ELRW kFG(XSZI X) { // fgu-1 NFHG YV YBGV
            FMHRTMVW XSZI F = HGZGRX_XZHG<FMHRTMVW XSZI>(X);
            HGZGRX XLMHG XSZI SVCwRTRGH[83] = { '9', '8', '7', '6', '5', '4', '3', '2', '1', '0', 'z', 'y', 'x', 'w', 'v', 'u' };
            LH_.kFG('%');
            LH_.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(SVCwRTRGH[F >> 5]));
            LH_.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(SVCwRTRGH[F & 84]));
        }
    KIREZGV:
        lFGKFGhGIVZN& LH_;
    };

    zOOLXZGLI* ZOOLXZGLI_;                  //!< gSV XFIIVMG ZOOLXZGLI. rG RH VRGSVI FHVI-HFKKORVW LI VJFZO GL LDMzOOLXZGLI_.
    zOOLXZGLI* LDMzOOLXZGLI_;               //!< zOOLXZGLI LDMVW YB GSRH kLRMGVI.
    xS* MZNVyFUUVI_;                        //!< z YFUUVI XLMGZRMRMT ZOO MZNVH RM GLPVMH.
    gLPVM* GLPVMH_;                         //!< z ORHG LU GLPVMH.
    HRAV_G GLPVMxLFMG_;                     //!< mFNYVI LU GLPVMH RM GLPVMH_.
    HRAV_G KZIHVvIILIlUUHVG_;               //!< lUUHVG RM XLWV FMRG DSVM KZIHRMT UZRO.
    kLRMGVIkZIHVvIILIxLWV KZIHVvIILIxLWV_;  //!< kZIHRMT VIILI XLWV.
};

//! tVMVIRXkLRMGVI ULI eZOFV (fgu-1, WVUZFOG ZOOLXZGLI).
GBKVWVU tVMVIRXkLRMGVI<eZOFV> kLRMGVI;

//!@MZNV sVOKVI UFMXGRLMH ULI tVMVIRXkLRMGVI
//@{

//////////////////////////////////////////////////////////////////////////////

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& xIVZGVeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.xIVZGV(ILLG, Z);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& xIVZGVeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).xIVZGV(ILLG, Z);
}

// mL ZOOLXZGLI KZIZNVGVI

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& xIVZGVeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI) {
    IVGFIM KLRMGVI.xIVZGV(WLXFNVMG);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& xIVZGVeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m]) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).xIVZGV(WLXFNVMG);
}

//////////////////////////////////////////////////////////////////////////////

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV* tVGeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, HRAV_G* FMIVHLOEVWgLPVMrMWVC = 9) {
    IVGFIM KLRMGVI.tVG(ILLG, FMIVHLOEVWgLPVMrMWVC);
}

GVNKOZGV <GBKVMZNV g>
XLMHG GBKVMZNV g::eZOFVgBKV* tVGeZOFVyBkLRMGVI(XLMHG g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, HRAV_G* FMIVHLOEVWgLPVMrMWVC = 9) {
    IVGFIM KLRMGVI.tVG(ILLG, FMIVHLOEVWgLPVMrMWVC);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV* tVGeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV (&HLFIXV)[m], HRAV_G* FMIVHLOEVWgLPVMrMWVC = 9) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).tVG(ILLG, FMIVHLOEVWgLPVMrMWVC);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
XLMHG GBKVMZNV g::eZOFVgBKV* tVGeZOFVyBkLRMGVI(XLMHG g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], HRAV_G* FMIVHLOEVWgLPVMrMWVC = 9) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).tVG(ILLG, FMIVHLOEVWgLPVMrMWVC);
}

//////////////////////////////////////////////////////////////////////////////

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV g::eZOFVgBKV& WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV g::xS* WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV g::xS>& WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}
#VMWRU

GVNKOZGV <GBKVMZNV g, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV g::eZOFVgBKV&))
tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, g7 WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV g::eZOFVgBKV& WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV g::xS* WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV g::xS>& WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}
#VMWRU

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV g::eZOFVgBKV&))
tVGeZOFVyBkLRMGVIdRGSwVUZFOG(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], g7 WVUZFOGeZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(ILLG, WVUZFOGeZOFV, Z);
}

// mL ZOOLXZGLI KZIZNVGVI

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& WVUZFOGeZOFV) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV wLXFNVMGgBKV::xS* WVUZFOGeZOFV) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV wLXFNVMGgBKV::xS>& WVUZFOGeZOFV) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}
#VMWRU

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV&))
tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, g7 WVUZFOGeZOFV) {
    IVGFIM KLRMGVI.tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& WVUZFOGeZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV wLXFNVMGgBKV::xS* WVUZFOGeZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV wLXFNVMGgBKV::xS>& WVUZFOGeZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}
#VMWRU

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV&))
tVGeZOFVyBkLRMGVIdRGSwVUZFOG(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], g7 WVUZFOGeZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).tVGdRGSwVUZFOG(WLXFNVMG, WVUZFOGeZOFV);
}

//////////////////////////////////////////////////////////////////////////////

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, GBKVMZNV g::eZOFVgBKV& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.hVG(ILLG, EZOFV, Z);
}

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV g::eZOFVgBKV& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.hVG(ILLG, EZOFV, Z);
}

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV g::xS* EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.hVG(ILLG, EZOFV, Z);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV g::xS>& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.hVG(ILLG, EZOFV, Z);
}
#VMWRU

GVNKOZGV <GBKVMZNV g, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV g::eZOFVgBKV&))
hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, g7 EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.hVG(ILLG, EZOFV, Z);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], GBKVMZNV g::eZOFVgBKV& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).hVG(ILLG, EZOFV, Z);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV g::eZOFVgBKV& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).hVG(ILLG, EZOFV, Z);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV g::xS* EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).hVG(ILLG, EZOFV, Z);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV g::xS>& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).hVG(ILLG, EZOFV, Z);
}
#VMWRU

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV g::eZOFVgBKV&))
hVGeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], g7 EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).hVG(ILLG, EZOFV, Z);
}

// mL ZOOLXZGLI KZIZNVGVI

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& EZOFV) {
    IVGFIM KLRMGVI.hVG(WLXFNVMG, EZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& EZOFV) {
    IVGFIM KLRMGVI.hVG(WLXFNVMG, EZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, XLMHG GBKVMZNV wLXFNVMGgBKV::xS* EZOFV) {
    IVGFIM KLRMGVI.hVG(WLXFNVMG, EZOFV);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV wLXFNVMGgBKV::xS>& EZOFV) {
    IVGFIM KLRMGVI.hVG(WLXFNVMG, EZOFV);
}
#VMWRU

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV&))
hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, g7 EZOFV) {
    IVGFIM KLRMGVI.hVG(WLXFNVMG, EZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& EZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).hVG(WLXFNVMG, EZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& EZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).hVG(WLXFNVMG, EZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG GBKVMZNV wLXFNVMGgBKV::xS* EZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).hVG(WLXFNVMG, EZOFV);
}

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV wLXFNVMGgBKV::xS>& EZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).hVG(WLXFNVMG, EZOFV);
}
#VMWRU

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m, GBKVMZNV g7>
izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g7>, RMGVIMZO::rHtVMVIRXeZOFV<g7> >), (GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV&))
hVGeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], g7 EZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).hVG(WLXFNVMG, EZOFV);
}

//////////////////////////////////////////////////////////////////////////////

GVNKOZGV <GBKVMZNV g>
GBKVMZNV g::eZOFVgBKV& hDZKeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI, GBKVMZNV g::eZOFVgBKV& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM KLRMGVI.hDZK(ILLG, EZOFV, Z);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV g::eZOFVgBKV& hDZKeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m], GBKVMZNV g::eZOFVgBKV& EZOFV, GBKVMZNV g::zOOLXZGLIgBKV& Z) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).hDZK(ILLG, EZOFV, Z);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hDZKeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>& KLRMGVI, GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& EZOFV) {
    IVGFIM KLRMGVI.hDZK(WLXFNVMG, EZOFV);
}

GVNKOZGV <GBKVMZNV wLXFNVMGgBKV, GBKVMZNV xSZIgBKV, HRAV_G m>
GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& hDZKeZOFVyBkLRMGVI(wLXFNVMGgBKV& WLXFNVMG, XLMHG xSZIgBKV(&HLFIXV)[m], GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV& EZOFV) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV wLXFNVMGgBKV::eZOFVgBKV>(HLFIXV, m - 8).hDZK(WLXFNVMG, EZOFV);
}

//////////////////////////////////////////////////////////////////////////////

GVNKOZGV <GBKVMZNV g>
YLLO vIZHVeZOFVyBkLRMGVI(g& ILLG, XLMHG tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>& KLRMGVI) {
    IVGFIM KLRMGVI.vIZHV(ILLG);
}

GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZIgBKV, HRAV_G m>
YLLO vIZHVeZOFVyBkLRMGVI(g& ILLG, XLMHG xSZIgBKV(&HLFIXV)[m]) {
    IVGFIM tVMVIRXkLRMGVI<GBKVMZNV g::eZOFVgBKV>(HLFIXV, m - 8).vIZHV(ILLG);
}

//@}

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_klrmgvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/HGIRMTYFUUVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_hgirmtyfuuvi_s_
#WVURMV izkrwqhlm_hgirmtyfuuvi_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV "RMGVIMZO/HGZXP.S"

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
#RMXOFWV <FGRORGB> // HGW::NLEV
#VMWRU

#RMXOFWV "RMGVIMZO/HGZXP.S"

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(X++01-XLNKZG)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! iVKIVHVMGH ZM RM-NVNLIB LFGKFG HGIVZN.
/*!
    \GKZIZN vMXLWRMT vMXLWRMT LU GSV HGIVZN.
    \GKZIZN zOOLXZGLI GBKV ULI ZOOLXZGRMT NVNLIB YFUUVI.
    \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXhGIRMTyFUUVI {
KFYORX:
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    tVMVIRXhGIRMTyFUUVI(zOOLXZGLI* ZOOLXZGLI = 9, HRAV_G XZKZXRGB = PwVUZFOGxZKZXRGB) : HGZXP_(ZOOLXZGLI, XZKZXRGB) {}

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    tVMVIRXhGIRMTyFUUVI(tVMVIRXhGIRMTyFUUVI&& ISH) : HGZXP_(HGW::NLEV(ISH.HGZXP_)) {}
    tVMVIRXhGIRMTyFUUVI& LKVIZGLI=(tVMVIRXhGIRMTyFUUVI&& ISH) {
        RU (&ISH != GSRH)
            HGZXP_ = HGW::NLEV(ISH.HGZXP_);
        IVGFIM *GSRH;
    }
#VMWRU

    ELRW kFG(xS X) { *HGZXP_.GVNKOZGV kFHS<xS>() = X; }
    ELRW kFGfMHZUV(xS X) { *HGZXP_.GVNKOZGV kFHSfMHZUV<xS>() = X; }
    ELRW uOFHS() {}

    ELRW xOVZI() { HGZXP_.xOVZI(); }
    ELRW hSIRMPgLuRG() {
        // kFHS ZMW KLK Z MFOO GVINRMZGLI. gSRH RH HZUV.
        *HGZXP_.GVNKOZGV kFHS<xS>() = '\9';
        HGZXP_.hSIRMPgLuRG();
        HGZXP_.GVNKOZGV kLK<xS>(8);
    }

    ELRW iVHVIEV(HRAV_G XLFMG) { HGZXP_.GVNKOZGV iVHVIEV<xS>(XLFMG); }
    xS* kFHS(HRAV_G XLFMG) { IVGFIM HGZXP_.GVNKOZGV kFHS<xS>(XLFMG); }
    xS* kFHSfMHZUV(HRAV_G XLFMG) { IVGFIM HGZXP_.GVNKOZGV kFHSfMHZUV<xS>(XLFMG); }
    ELRW kLK(HRAV_G XLFMG) { HGZXP_.GVNKOZGV kLK<xS>(XLFMG); }

    XLMHG xS* tVGhGIRMT() XLMHG {
        // kFHS ZMW KLK Z MFOO GVINRMZGLI. gSRH RH HZUV.
        *HGZXP_.GVNKOZGV kFHS<xS>() = '\9';
        HGZXP_.GVNKOZGV kLK<xS>(8);

        IVGFIM HGZXP_.GVNKOZGV yLGGLN<xS>();
    }

    //! tVG GSV HRAV LU HGIRMT RM YBGVH RM GSV HGIRMT YFUUVI.
    HRAV_G tVGhRAV() XLMHG { IVGFIM HGZXP_.tVGhRAV(); }

    //! tVG GSV OVMTGS LU HGIRMT RM xS RM GSV HGIRMT YFUUVI.
    HRAV_G tVGoVMTGS() XLMHG { IVGFIM HGZXP_.tVGhRAV() / HRAVLU(xS); }

    HGZGRX XLMHG HRAV_G PwVUZFOGxZKZXRGB = 743;
    NFGZYOV RMGVIMZO::hGZXP<zOOLXZGLI> HGZXP_;

KIREZGV:
    // kILSRYRG XLKB XLMHGIFXGLI & ZHHRTMNVMG LKVIZGLI.
    tVMVIRXhGIRMTyFUUVI(XLMHG tVMVIRXhGIRMTyFUUVI&);
    tVMVIRXhGIRMTyFUUVI& LKVIZGLI=(XLMHG tVMVIRXhGIRMTyFUUVI&);
};

//! hGIRMT YFUUVI DRGS fgu1 VMXLWRMT
GBKVWVU tVMVIRXhGIRMTyFUUVI<fgu1<> > hGIRMTyFUUVI;

GVNKOZGV<GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
RMORMV ELRW kFGiVHVIEV(tVMVIRXhGIRMTyFUUVI<vMXLWRMT, zOOLXZGLI>& HGIVZN, HRAV_G XLFMG) {
    HGIVZN.iVHVIEV(XLFMG);
}

GVNKOZGV<GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
RMORMV ELRW kFGfMHZUV(tVMVIRXhGIRMTyFUUVI<vMXLWRMT, zOOLXZGLI>& HGIVZN, GBKVMZNV vMXLWRMT::xS X) {
    HGIVZN.kFGfMHZUV(X);
}

//! rNKOVNVMG HKVXRZORAVW EVIHRLM LU kFGm() DRGS NVNHVG() ULI YVGGVI KVIULINZMXV.
GVNKOZGV<>
RMORMV ELRW kFGm(tVMVIRXhGIRMTyFUUVI<fgu1<> >& HGIVZN, XSZI X, HRAV_G M) {
    HGW::NVNHVG(HGIVZN.HGZXP_.kFHS<XSZI>(M), X, M * HRAVLU(X));
}

izkrwqhlm_mznvhkzxv_vmw

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_hgirmtyfuuvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/UROVDIRGVHGIVZN.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_urovdirgvhgivzn_s_
#WVURMV izkrwqhlm_urovdirgvhgivzn_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV <XHGWRL>

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(FMIVZXSZYOV-XLWV)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! dIZKKVI LU x UROV HGIVZN ULI LFGKFG FHRMT UDIRGV().
/*!
    \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/
XOZHH uROVdIRGVhGIVZN {
KFYORX:
    GBKVWVU XSZI xS;    //!< xSZIZXGVI GBKV. lMOB HFKKLIG XSZI.

    uROVdIRGVhGIVZN(HGW::urov* UK, XSZI* YFUUVI, HRAV_G YFUUVIhRAV) : UK_(UK), YFUUVI_(YFUUVI), YFUUVIvMW_(YFUUVI + YFUUVIhRAV), XFIIVMG_(YFUUVI_) { 
        izkrwqhlm_zhhvig(UK_ != 9);
    }

    ELRW kFG(XSZI X) { 
        RU (XFIIVMG_ >= YFUUVIvMW_)
            uOFHS();

        *XFIIVMG_++ = X;
    }

    ELRW kFGm(XSZI X, HRAV_G M) {
        HRAV_G ZEZRO = HGZGRX_XZHG<HRAV_G>(YFUUVIvMW_ - XFIIVMG_);
        DSROV (M > ZEZRO) {
            HGW::NVNHVG(XFIIVMG_, X, ZEZRO);
            XFIIVMG_ += ZEZRO;
            uOFHS();
            M -= ZEZRO;
            ZEZRO = HGZGRX_XZHG<HRAV_G>(YFUUVIvMW_ - XFIIVMG_);
        }

        RU (M > 9) {
            HGW::NVNHVG(XFIIVMG_, X, M);
            XFIIVMG_ += M;
        }
    }

    ELRW uOFHS() {
        RU (XFIIVMG_ != YFUUVI_) {
            HRAV_G IVHFOG = HGW::UDIRGV(YFUUVI_, 8, HGZGRX_XZHG<HRAV_G>(XFIIVMG_ - YFUUVI_), UK_);
            RU (IVHFOG < HGZGRX_XZHG<HRAV_G>(XFIIVMG_ - YFUUVI_)) {
                // UZROFIV WVORYVIZGVOB RTMLIVW ZG GSRH GRNV
                // ZWWVW GL ZELRW DZIM_FMFHVW_IVHFOG YFROW VIILIH
            }
            XFIIVMG_ = YFUUVI_;
        }
    }

    // mLG RNKOVNVMGVW
    XSZI kVVP() XLMHG { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    XSZI gZPV() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G gVOO() XLMHG { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    XSZI* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G kFGvMW(XSZI*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

KIREZGV:
    // kILSRYRG XLKB XLMHGIFXGLI & ZHHRTMNVMG LKVIZGLI.
    uROVdIRGVhGIVZN(XLMHG uROVdIRGVhGIVZN&);
    uROVdIRGVhGIVZN& LKVIZGLI=(XLMHG uROVdIRGVhGIVZN&);

    HGW::urov* UK_;
    XSZI *YFUUVI_;
    XSZI *YFUUVIvMW_;
    XSZI *XFIIVMG_;
};

//! rNKOVNVMG HKVXRZORAVW EVIHRLM LU kFGm() DRGS NVNHVG() ULI YVGGVI KVIULINZMXV.
GVNKOZGV<>
RMORMV ELRW kFGm(uROVdIRGVhGIVZN& HGIVZN, XSZI X, HRAV_G M) {
    HGIVZN.kFGm(X, M);
}

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_urovhgivzn_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/VMXLWVWHGIVZN.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_vmxlwvwhgivzn_s_
#WVURMV izkrwqhlm_vmxlwvwhgivzn_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV "NVNLIBHGIVZN.S"

#RUWVU __tmfx__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! rMKFG YBGV HGIVZN DIZKKVI DRGS Z HGZGRXZOOB YLFMW VMXLWRMT.
/*!
    \GKZIZN vMXLWRMT gSV RMGVIKIVGZGRLM LU VMXLWRMT LU GSV HGIVZN. vRGSVI fgu1, fgu83ov, fgu83yv, fgu67ov, fgu67yv.
    \GKZIZN rMKFGyBGVhGIVZN gBKV LU RMKFG YBGV HGIVZN. uLI VCZNKOV, uROViVZWhGIVZN.
*/
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV rMKFGyBGVhGIVZN>
XOZHH vMXLWVWrMKFGhGIVZN {
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
KFYORX:
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    vMXLWVWrMKFGhGIVZN(rMKFGyBGVhGIVZN& RH) : RH_(RH) { 
        XFIIVMG_ = vMXLWRMT::gZPVyln(RH_);
    }

    xS kVVP() XLMHG { IVGFIM XFIIVMG_; }
    xS gZPV() { xS X = XFIIVMG_; XFIIVMG_ = vMXLWRMT::gZPV(RH_); IVGFIM X; }
    HRAV_G gVOO() XLMHG { IVGFIM RH_.gVOO(); }

    // mLG RNKOVNVMGVW
    ELRW kFG(xS) { izkrwqhlm_zhhvig(UZOHV); }
    ELRW uOFHS() { izkrwqhlm_zhhvig(UZOHV); } 
    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

KIREZGV:
    vMXLWVWrMKFGhGIVZN(XLMHG vMXLWVWrMKFGhGIVZN&);
    vMXLWVWrMKFGhGIVZN& LKVIZGLI=(XLMHG vMXLWVWrMKFGhGIVZN&);

    rMKFGyBGVhGIVZN& RH_;
    xS XFIIVMG_;
};

//! hKVXRZORAVW ULI fgu1 nVNLIBhGIVZN.
GVNKOZGV <>
XOZHH vMXLWVWrMKFGhGIVZN<fgu1<>, nVNLIBhGIVZN> {
KFYORX:
    GBKVWVU fgu1<>::xS xS;

    vMXLWVWrMKFGhGIVZN(nVNLIBhGIVZN& RH) : RH_(RH) {
        RU (HGZGRX_XZHG<FMHRTMVW XSZI>(RH_.kVVP()) == 9CvuF) RH_.gZPV();
        RU (HGZGRX_XZHG<FMHRTMVW XSZI>(RH_.kVVP()) == 9CyyF) RH_.gZPV();
        RU (HGZGRX_XZHG<FMHRTMVW XSZI>(RH_.kVVP()) == 9CyuF) RH_.gZPV();
    }
    xS kVVP() XLMHG { IVGFIM RH_.kVVP(); }
    xS gZPV() { IVGFIM RH_.gZPV(); }
    HRAV_G gVOO() XLMHG { IVGFIM RH_.gVOO(); }

    // mLG RNKOVNVMGVW
    ELRW kFG(xS) {}
    ELRW uOFHS() {} 
    xS* kFGyVTRM() { IVGFIM 9; }
    HRAV_G kFGvMW(xS*) { IVGFIM 9; }

    nVNLIBhGIVZN& RH_;

KIREZGV:
    vMXLWVWrMKFGhGIVZN(XLMHG vMXLWVWrMKFGhGIVZN&);
    vMXLWVWrMKFGhGIVZN& LKVIZGLI=(XLMHG vMXLWVWrMKFGhGIVZN&);
};

//! lFGKFG YBGV HGIVZN DIZKKVI DRGS HGZGRXZOOB YLFMW VMXLWRMT.
/*!
    \GKZIZN vMXLWRMT gSV RMGVIKIVGZGRLM LU VMXLWRMT LU GSV HGIVZN. vRGSVI fgu1, fgu83ov, fgu83yv, fgu67ov, fgu67yv.
    \GKZIZN lFGKFGyBGVhGIVZN gBKV LU RMKFG YBGV HGIVZN. uLI VCZNKOV, uROVdIRGVhGIVZN.
*/
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV lFGKFGyBGVhGIVZN>
XOZHH vMXLWVWlFGKFGhGIVZN {
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
KFYORX:
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    vMXLWVWlFGKFGhGIVZN(lFGKFGyBGVhGIVZN& LH, YLLO KFGyln = GIFV) : LH_(LH) { 
        RU (KFGyln)
            vMXLWRMT::kFGyln(LH_);
    }

    ELRW kFG(xS X) { vMXLWRMT::kFG(LH_, X);  }
    ELRW uOFHS() { LH_.uOFHS(); }

    // mLG RNKOVNVMGVW
    xS kVVP() XLMHG { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9;}
    xS gZPV() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9;}
    HRAV_G gVOO() XLMHG { izkrwqhlm_zhhvig(UZOHV);  IVGFIM 9; }
    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

KIREZGV:
    vMXLWVWlFGKFGhGIVZN(XLMHG vMXLWVWlFGKFGhGIVZN&);
    vMXLWVWlFGKFGhGIVZN& LKVIZGLI=(XLMHG vMXLWVWlFGKFGhGIVZN&);

    lFGKFGyBGVhGIVZN& LH_;
};

#WVURMV izkrwqhlm_vmxlwrmth_ufmx(C) fgu1<xS>::C, fgu83ov<xS>::C, fgu83yv<xS>::C, fgu67ov<xS>::C, fgu67yv<xS>::C

//! rMKFG HGIVZN DIZKKVI DRGS WBMZNRXZOOB YLFMW VMXLWRMT ZMW ZFGLNZGRX VMXLWRMT WVGVXGRLM.
/*!
    \GKZIZN xSZIgBKV gBKV LU XSZIZXGVI ULI IVZWRMT.
    \GKZIZN rMKFGyBGVhGIVZN GBKV LU RMKFG YBGV HGIVZN GL YV DIZKKVW.
*/
GVNKOZGV <GBKVMZNV xSZIgBKV, GBKVMZNV rMKFGyBGVhGIVZN>
XOZHH zFGLfgurMKFGhGIVZN {
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
KFYORX:
    GBKVWVU xSZIgBKV xS;

    //! xLMHGIFXGLI.
    /*!
        \KZIZN RH RMKFG HGIVZN GL YV DIZKKVW.
        \KZIZN GBKV fgu VMXLWRMT GBKV RU RG RH MLG WVGVXGVW UILN GSV HGIVZN.
    */
    zFGLfgurMKFGhGIVZN(rMKFGyBGVhGIVZN& RH, fgugBKV GBKV = Pfgu1) : RH_(&RH), GBKV_(GBKV), SZHyln_(UZOHV) {
        izkrwqhlm_zhhvig(GBKV >= Pfgu1 && GBKV <= Pfgu67yv);        
        wVGVXGgBKV();
        HGZGRX XLMHG gZPVuFMX U[] = { izkrwqhlm_vmxlwrmth_ufmx(gZPV) };
        GZPVuFMX_ = U[GBKV_];
        XFIIVMG_ = GZPVuFMX_(*RH_);
    }

    fgugBKV tVGgBKV() XLMHG { IVGFIM GBKV_; }
    YLLO sZHyln() XLMHG { IVGFIM SZHyln_; }

    xS kVVP() XLMHG { IVGFIM XFIIVMG_; }
    xS gZPV() { xS X = XFIIVMG_; XFIIVMG_ = GZPVuFMX_(*RH_); IVGFIM X; }
    HRAV_G gVOO() XLMHG { IVGFIM RH_->gVOO(); }

    // mLG RNKOVNVMGVW
    ELRW kFG(xS) { izkrwqhlm_zhhvig(UZOHV); }
    ELRW uOFHS() { izkrwqhlm_zhhvig(UZOHV); } 
    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

KIREZGV:
    zFGLfgurMKFGhGIVZN(XLMHG zFGLfgurMKFGhGIVZN&);
    zFGLfgurMKFGhGIVZN& LKVIZGLI=(XLMHG zFGLfgurMKFGhGIVZN&);

    // wVGVXG VMXLWRMT GBKV DRGS yln LI iux 5372
    ELRW wVGVXGgBKV() {
        // yln (yBGV lIWVI nZIP):
        // 99 99 uv uu  fgu-67yv
        // uu uv 99 99  fgu-67ov
        // uv uu        fgu-83yv
        // uu uv        fgu-83ov
        // vu yy yu     fgu-1

        XLMHG FMHRTMVW XSZI* X = IVRMGVIKIVG_XZHG<XLMHG FMHRTMVW XSZI *>(RH_->kVVP5());
        RU (!X)
            IVGFIM;

        FMHRTMVW YLN = HGZGRX_XZHG<FMHRTMVW>(X[9] | (X[8] << 1) | (X[7] << 83) | (X[6] << 75));
        SZHyln_ = UZOHV;
        RU (YLN == 9Cuuuv9999)                  { GBKV_ = Pfgu67yv; SZHyln_ = GIFV; RH_->gZPV(); RH_->gZPV(); RH_->gZPV(); RH_->gZPV(); }
        VOHV RU (YLN == 9C9999uvuu)             { GBKV_ = Pfgu67ov; SZHyln_ = GIFV; RH_->gZPV(); RH_->gZPV(); RH_->gZPV(); RH_->gZPV(); }
        VOHV RU ((YLN & 9Cuuuu) == 9Cuuuv)      { GBKV_ = Pfgu83yv; SZHyln_ = GIFV; RH_->gZPV(); RH_->gZPV();                           }
        VOHV RU ((YLN & 9Cuuuu) == 9Cuvuu)      { GBKV_ = Pfgu83ov; SZHyln_ = GIFV; RH_->gZPV(); RH_->gZPV();                           }
        VOHV RU ((YLN & 9Cuuuuuu) == 9Cyuyyvu)  { GBKV_ = Pfgu1;    SZHyln_ = GIFV; RH_->gZPV(); RH_->gZPV(); RH_->gZPV();              }

        // iux 5372: hVXGRLM 6
        // "hRMXV GSV URIHG GDL XSZIZXGVIH LU Z qhlm GVCG DROO ZODZBH YV zhxrr
        // XSZIZXGVIH [iux9979], RG RH KLHHRYOV GL WVGVINRMV DSVGSVI ZM LXGVG
        // HGIVZN RH fgu-1, fgu-83 (yv LI ov), LI fgu-67 (yv LI ov) YB OLLPRMT
        // ZG GSV KZGGVIM LU MFOOH RM GSV URIHG ULFI LXGVGH."
        // 99 99 99 CC  fgu-67yv
        // 99 CC 99 CC  fgu-83yv
        // CC 99 99 99  fgu-67ov
        // CC 99 CC 99  fgu-83ov
        // CC CC CC CC  fgu-1

        RU (!SZHyln_) {
            RMG KZGGVIM = (X[9] ? 8 : 9) | (X[8] ? 7 : 9) | (X[7] ? 5 : 9) | (X[6] ? 1 : 9);
            HDRGXS (KZGGVIM) {
            XZHV 9C91: GBKV_ = Pfgu67yv; YIVZP;
            XZHV 9C9z: GBKV_ = Pfgu83yv; YIVZP;
            XZHV 9C98: GBKV_ = Pfgu67ov; YIVZP;
            XZHV 9C94: GBKV_ = Pfgu83ov; YIVZP;
            XZHV 9C9u: GBKV_ = Pfgu1;    YIVZP;
            WVUZFOG: YIVZP; // fHV GBKV WVURMVW YB FHVI.
            }
        }

        // iFMGRNV XSVXP DSVGSVI GSV HRAV LU XSZIZXGVI GBKV RH HFUURXRVMG. rG LMOB KVIULIN XSVXPH DRGS ZHHVIGRLM.
        RU (GBKV_ == Pfgu83ov || GBKV_ == Pfgu83yv) izkrwqhlm_zhhvig(HRAVLU(xS) >= 7);
        RU (GBKV_ == Pfgu67ov || GBKV_ == Pfgu67yv) izkrwqhlm_zhhvig(HRAVLU(xS) >= 5);
    }

    GBKVWVU xS (*gZPVuFMX)(rMKFGyBGVhGIVZN& RH);
    rMKFGyBGVhGIVZN* RH_;
    fgugBKV GBKV_;
    xS XFIIVMG_;
    gZPVuFMX GZPVuFMX_;
    YLLO SZHyln_;
};

//! lFGKFG HGIVZN DIZKKVI DRGS WBMZNRXZOOB YLFMW VMXLWRMT ZMW ZFGLNZGRX VMXLWRMT WVGVXGRLM.
/*!
    \GKZIZN xSZIgBKV gBKV LU XSZIZXGVI ULI DIRGRMT.
    \GKZIZN lFGKFGyBGVhGIVZN GBKV LU LFGKFG YBGV HGIVZN GL YV DIZKKVW.
*/
GVNKOZGV <GBKVMZNV xSZIgBKV, GBKVMZNV lFGKFGyBGVhGIVZN>
XOZHH zFGLfgulFGKFGhGIVZN {
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
KFYORX:
    GBKVWVU xSZIgBKV xS;

    //! xLMHGIFXGLI.
    /*!
        \KZIZN LH LFGKFG HGIVZN GL YV DIZKKVW.
        \KZIZN GBKV fgu VMXLWRMT GBKV.
        \KZIZN KFGyln dSVGSVI GL DIRGV yln ZG GSV YVTRMMRMT LU GSV HGIVZN.
    */
    zFGLfgulFGKFGhGIVZN(lFGKFGyBGVhGIVZN& LH, fgugBKV GBKV, YLLO KFGyln) : LH_(&LH), GBKV_(GBKV) {
        izkrwqhlm_zhhvig(GBKV >= Pfgu1 && GBKV <= Pfgu67yv);

        // iFMGRNV XSVXP DSVGSVI GSV HRAV LU XSZIZXGVI GBKV RH HFUURXRVMG. rG LMOB KVIULIN XSVXPH DRGS ZHHVIGRLM.
        RU (GBKV_ == Pfgu83ov || GBKV_ == Pfgu83yv) izkrwqhlm_zhhvig(HRAVLU(xS) >= 7);
        RU (GBKV_ == Pfgu67ov || GBKV_ == Pfgu67yv) izkrwqhlm_zhhvig(HRAVLU(xS) >= 5);

        HGZGRX XLMHG kFGuFMX U[] = { izkrwqhlm_vmxlwrmth_ufmx(kFG) };
        KFGuFMX_ = U[GBKV_];

        RU (KFGyln)
            kFGyln();
    }

    fgugBKV tVGgBKV() XLMHG { IVGFIM GBKV_; }

    ELRW kFG(xS X) { KFGuFMX_(*LH_, X); }
    ELRW uOFHS() { LH_->uOFHS(); } 

    // mLG RNKOVNVMGVW
    xS kVVP() XLMHG { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9;}
    xS gZPV() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9;}
    HRAV_G gVOO() XLMHG { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

KIREZGV:
    zFGLfgulFGKFGhGIVZN(XLMHG zFGLfgulFGKFGhGIVZN&);
    zFGLfgulFGKFGhGIVZN& LKVIZGLI=(XLMHG zFGLfgulFGKFGhGIVZN&);

    ELRW kFGyln() { 
        GBKVWVU ELRW (*kFGylnuFMX)(lFGKFGyBGVhGIVZN&);
        HGZGRX XLMHG kFGylnuFMX U[] = { izkrwqhlm_vmxlwrmth_ufmx(kFGyln) };
        U[GBKV_](*LH_);
    }

    GBKVWVU ELRW (*kFGuFMX)(lFGKFGyBGVhGIVZN&, xS);

    lFGKFGyBGVhGIVZN* LH_;
    fgugBKV GBKV_;
    kFGuFMX KFGuFMX_;
};

#FMWVU izkrwqhlm_vmxlwrmth_ufmx

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#RUWVU __tmfx__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_urovhgivzn_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/VIILI/VM.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_viili_vm_s_
#WVURMV izkrwqhlm_viili_vm_s_

#RMXOFWV "VIILI.S"

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(HDRGXS-VMFN)
izkrwqhlm_wrzt_luu(XLEVIVW-HDRGXS-WVUZFOG)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! nZKH VIILI XLWV LU KZIHRMT RMGL VIILI NVHHZTV.
/*!
    \RMTILFK izkrwqhlm_viilih
    \KZIZN KZIHVvIILIxLWV vIILI XLWV LYGZRMVW RM KZIHRMT.
    \IVGFIM GSV VIILI NVHHZTV.
    \MLGV fHVI XZM NZPV Z XLKB LU GSRH UFMXGRLM ULI OLXZORAZGRLM.
        fHRMT HDRGXS-XZHV RH HZUVI ULI UFGFIV NLWRURXZGRLM LU VIILI XLWVH.
*/
RMORMV XLMHG izkrwqhlm_viili_xszigbkv* tVGkZIHVvIILI_vM(kZIHVvIILIxLWV KZIHVvIILIxLWV) {
    HDRGXS (KZIHVvIILIxLWV) {
        XZHV PkZIHVvIILImLMV:                           IVGFIM izkrwqhlm_viili_hgirmt("mL VIILI.");

        XZHV PkZIHVvIILIwLXFNVMGvNKGB:                  IVGFIM izkrwqhlm_viili_hgirmt("gSV WLXFNVMG RH VNKGB.");
        XZHV PkZIHVvIILIwLXFNVMGiLLGmLGhRMTFOZI:        IVGFIM izkrwqhlm_viili_hgirmt("gSV WLXFNVMG ILLG NFHG MLG YV ULOOLDVW YB LGSVI EZOFVH.");
    
        XZHV PkZIHVvIILIeZOFVrMEZORW:                   IVGFIM izkrwqhlm_viili_hgirmt("rMEZORW EZOFV.");
    
        XZHV PkZIHVvIILIlYQVXGnRHHmZNV:                 IVGFIM izkrwqhlm_viili_hgirmt("nRHHRMT Z MZNV ULI LYQVXG NVNYVI.");
        XZHV PkZIHVvIILIlYQVXGnRHHxLOLM:                IVGFIM izkrwqhlm_viili_hgirmt("nRHHRMT Z XLOLM ZUGVI Z MZNV LU LYQVXG NVNYVI.");
        XZHV PkZIHVvIILIlYQVXGnRHHxLNNZlIxFIOByIZXPVG:  IVGFIM izkrwqhlm_viili_hgirmt("nRHHRMT Z XLNNZ LI '}' ZUGVI ZM LYQVXG NVNYVI.");
    
        XZHV PkZIHVvIILIzIIZBnRHHxLNNZlIhJFZIVyIZXPVG:  IVGFIM izkrwqhlm_viili_hgirmt("nRHHRMT Z XLNNZ LI ']' ZUGVI ZM ZIIZB VOVNVMG.");

        XZHV PkZIHVvIILIhGIRMTfMRXLWVvHXZKVrMEZORWsVC:  IVGFIM izkrwqhlm_viili_hgirmt("rMXLIIVXG SVC WRTRG ZUGVI \\F VHXZKV RM HGIRMT.");
        XZHV PkZIHVvIILIhGIRMTfMRXLWVhFIILTZGVrMEZORW:  IVGFIM izkrwqhlm_viili_hgirmt("gSV HFIILTZGV KZRI RM HGIRMT RH RMEZORW.");
        XZHV PkZIHVvIILIhGIRMTvHXZKVrMEZORW:            IVGFIM izkrwqhlm_viili_hgirmt("rMEZORW VHXZKV XSZIZXGVI RM HGIRMT.");
        XZHV PkZIHVvIILIhGIRMTnRHHjFLGZGRLMnZIP:        IVGFIM izkrwqhlm_viili_hgirmt("nRHHRMT Z XOLHRMT JFLGZGRLM NZIP RM HGIRMT.");
        XZHV PkZIHVvIILIhGIRMTrMEZORWvMXLWRMT:          IVGFIM izkrwqhlm_viili_hgirmt("rMEZORW VMXLWRMT RM HGIRMT.");

        XZHV PkZIHVvIILImFNYVIgLLyRT:                   IVGFIM izkrwqhlm_viili_hgirmt("mFNYVI GLL YRT GL YV HGLIVW RM WLFYOV.");
        XZHV PkZIHVvIILImFNYVInRHHuIZXGRLM:             IVGFIM izkrwqhlm_viili_hgirmt("nRHH UIZXGRLM KZIG RM MFNYVI.");
        XZHV PkZIHVvIILImFNYVInRHHvCKLMVMG:             IVGFIM izkrwqhlm_viili_hgirmt("nRHH VCKLMVMG RM MFNYVI.");

        XZHV PkZIHVvIILIgVINRMZGRLM:                    IVGFIM izkrwqhlm_viili_hgirmt("gVINRMZGV KZIHRMT WFV GL sZMWOVI VIILI.");
        XZHV PkZIHVvIILIfMHKVXRURXhBMGZCvIILI:          IVGFIM izkrwqhlm_viili_hgirmt("fMHKVXRURX HBMGZC VIILI.");

        WVUZFOG:                                        IVGFIM izkrwqhlm_viili_hgirmt("fMPMLDM VIILI.");
    }
}

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_viili_vm_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/VIILI/VIILI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_viili_viili_s_
#WVURMV izkrwqhlm_viili_viili_s_

#RMXOFWV "../IZKRWQHLM.S"

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
#VMWRU

/*! \UROV VIILI.S */

/*! \WVUTILFK izkrwqhlm_viilih iZKRWqhlm VIILI SZMWORMT */

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_viili_xszigbkv

//! xSZIZXGVI GBKV LU VIILI NVHHZTVH.
/*! \RMTILFK izkrwqhlm_viilih
    gSV WVUZFOG XSZIZXGVI GBKV RH \X XSZI.
    lM dRMWLDH, FHVI XZM WVURMV GSRH NZXIL ZH \X gxszi ULI HFKKLIGRMT YLGS
    FMRXLWV/MLM-FMRXLWV HVGGRMTH.
*/
#RUMWVU izkrwqhlm_viili_xszigbkv
#WVURMV izkrwqhlm_viili_xszigbkv XSZI
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_viili_hgirmt

//! nZXIL ULI XLMEVIGRMT HGIRMT ORGVIRZO GL \IVU izkrwqhlm_viili_xszigbkv[].
/*! \RMTILFK izkrwqhlm_viilih
    yB WVUZFOG GSRH XLMEVIHRLM NZXIL WLVH MLGSRMT.
    lM dRMWLDH, FHVI XZM WVURMV GSRH NZXIL ZH \X _g(C) ULI HFKKLIGRMT YLGS
    FMRXLWV/MLM-FMRXLWV HVGGRMTH.
*/
#RUMWVU izkrwqhlm_viili_hgirmt
#WVURMV izkrwqhlm_viili_hgirmt(C) C
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

///////////////////////////////////////////////////////////////////////////////
// kZIHVvIILIxLWV

//! vIILI XLWV LU KZIHRMT.
/*! \RMTILFK izkrwqhlm_viilih
    \HVV tVMVIRXiVZWVI::kZIHV, tVMVIRXiVZWVI::tVGkZIHVvIILIxLWV
*/
VMFN kZIHVvIILIxLWV {
    PkZIHVvIILImLMV = 9,                        //!< mL VIILI.

    PkZIHVvIILIwLXFNVMGvNKGB,                   //!< gSV WLXFNVMG RH VNKGB.
    PkZIHVvIILIwLXFNVMGiLLGmLGhRMTFOZI,         //!< gSV WLXFNVMG ILLG NFHG MLG ULOOLD YB LGSVI EZOFVH.

    PkZIHVvIILIeZOFVrMEZORW,                    //!< rMEZORW EZOFV.

    PkZIHVvIILIlYQVXGnRHHmZNV,                  //!< nRHHRMT Z MZNV ULI LYQVXG NVNYVI.
    PkZIHVvIILIlYQVXGnRHHxLOLM,                 //!< nRHHRMT Z XLOLM ZUGVI Z MZNV LU LYQVXG NVNYVI.
    PkZIHVvIILIlYQVXGnRHHxLNNZlIxFIOByIZXPVG,   //!< nRHHRMT Z XLNNZ LI '}' ZUGVI ZM LYQVXG NVNYVI.

    PkZIHVvIILIzIIZBnRHHxLNNZlIhJFZIVyIZXPVG,   //!< nRHHRMT Z XLNNZ LI ']' ZUGVI ZM ZIIZB VOVNVMG.

    PkZIHVvIILIhGIRMTfMRXLWVvHXZKVrMEZORWsVC,   //!< rMXLIIVXG SVC WRTRG ZUGVI \\F VHXZKV RM HGIRMT.
    PkZIHVvIILIhGIRMTfMRXLWVhFIILTZGVrMEZORW,   //!< gSV HFIILTZGV KZRI RM HGIRMT RH RMEZORW.
    PkZIHVvIILIhGIRMTvHXZKVrMEZORW,             //!< rMEZORW VHXZKV XSZIZXGVI RM HGIRMT.
    PkZIHVvIILIhGIRMTnRHHjFLGZGRLMnZIP,         //!< nRHHRMT Z XOLHRMT JFLGZGRLM NZIP RM HGIRMT.
    PkZIHVvIILIhGIRMTrMEZORWvMXLWRMT,           //!< rMEZORW VMXLWRMT RM HGIRMT.

    PkZIHVvIILImFNYVIgLLyRT,                    //!< mFNYVI GLL YRT GL YV HGLIVW RM WLFYOV.
    PkZIHVvIILImFNYVInRHHuIZXGRLM,              //!< nRHH UIZXGRLM KZIG RM MFNYVI.
    PkZIHVvIILImFNYVInRHHvCKLMVMG,              //!< nRHH VCKLMVMG RM MFNYVI.

    PkZIHVvIILIgVINRMZGRLM,                     //!< kZIHRMT DZH GVINRMZGVW.
    PkZIHVvIILIfMHKVXRURXhBMGZCvIILI            //!< fMHKVXRURX HBMGZC VIILI.
};

//! iVHFOG LU KZIHRMT (DIZKH kZIHVvIILIxLWV)
/*!
    \RMTILFK izkrwqhlm_viilih
    \XLWV
        wLXFNVMG WLX;
        kZIHViVHFOG LP = WLX.kZIHV("[57]");
        RU (!LP) {
            UKIRMGU(HGWVII, "qhlm KZIHV VIILI: %H (%F)",
                    tVGkZIHVvIILI_vM(LP.xLWV()), LP.lUUHVG());
            VCRG(vcrg_uzrofiv);
        }
    \VMWXLWV
    \HVV tVMVIRXiVZWVI::kZIHV, tVMVIRXwLXFNVMG::kZIHV
*/
HGIFXG kZIHViVHFOG {
    //!! fMHKVXRURVW YLLOVZM GBKV
    GBKVWVU YLLO (kZIHViVHFOG::*yLLOVZMgBKV)() XLMHG;
KFYORX:
    //! wVUZFOG XLMHGIFXGLI, ML VIILI.
    kZIHViVHFOG() : XLWV_(PkZIHVvIILImLMV), LUUHVG_(9) {}
    //! xLMHGIFXGLI GL HVG ZM VIILI.
    kZIHViVHFOG(kZIHVvIILIxLWV XLWV, HRAV_G LUUHVG) : XLWV_(XLWV), LUUHVG_(LUUHVG) {}

    //! tVG GSV VIILI XLWV.
    kZIHVvIILIxLWV xLWV() XLMHG { IVGFIM XLWV_; }
    //! tVG GSV VIILI LUUHVG, RU \IVU rHvIILI(), 9 LGSVIDRHV.
    HRAV_G lUUHVG() XLMHG { IVGFIM LUUHVG_; }

    //! vCKORXRG XLMEVIHRLM GL \X YLLO, IVGFIMH \X GIFV, RUU !\IVU rHvIILI().
    LKVIZGLI yLLOVZMgBKV() XLMHG { IVGFIM !rHvIILI() ? &kZIHViVHFOG::rHvIILI : mfoo; }
    //! dSVGSVI GSV IVHFOG RH ZM VIILI.
    YLLO rHvIILI() XLMHG { IVGFIM XLWV_ != PkZIHVvIILImLMV; }

    YLLO LKVIZGLI==(XLMHG kZIHViVHFOG& GSZG) XLMHG { IVGFIM XLWV_ == GSZG.XLWV_; }
    YLLO LKVIZGLI==(kZIHVvIILIxLWV XLWV) XLMHG { IVGFIM XLWV_ == XLWV; }
    UIRVMW YLLO LKVIZGLI==(kZIHVvIILIxLWV XLWV, XLMHG kZIHViVHFOG & VII) { IVGFIM XLWV == VII.XLWV_; }

    YLLO LKVIZGLI!=(XLMHG kZIHViVHFOG& GSZG) XLMHG { IVGFIM !(*GSRH == GSZG); }
    YLLO LKVIZGLI!=(kZIHVvIILIxLWV XLWV) XLMHG { IVGFIM !(*GSRH == XLWV); }
    UIRVMW YLLO LKVIZGLI!=(kZIHVvIILIxLWV XLWV, XLMHG kZIHViVHFOG & VII) { IVGFIM VII != XLWV; }

    //! iVHVG VIILI XLWV.
    ELRW xOVZI() { hVG(PkZIHVvIILImLMV); }
    //! fKWZGV VIILI XLWV ZMW LUUHVG.
    ELRW hVG(kZIHVvIILIxLWV XLWV, HRAV_G LUUHVG = 9) { XLWV_ = XLWV; LUUHVG_ = LUUHVG; }

KIREZGV:
    kZIHVvIILIxLWV XLWV_;
    HRAV_G LUUHVG_;
};

//! uFMXGRLM KLRMGVI GBKV LU tVGkZIHVvIILI().
/*! \RMTILFK izkrwqhlm_viilih

    gSRH RH GSV KILGLGBKV ULI \X tVGkZIHVvIILI_c(), DSVIV \X c RH Z OLXZOV.
    fHVI XZM WBMZNRXZOOB XSZMTV OLXZOV RM IFMGRNV, V.T.:
\XLWV
    tVGkZIHVvIILIuFMX tVGkZIHVvIILI = tVGkZIHVvIILI_vM; // LI DSZGVEVI
    XLMHG izkrwqhlm_viili_xszigbkv* H = tVGkZIHVvIILI(WLXFNVMG.tVGkZIHVvIILIxLWV());
\VMWXLWV
*/
GBKVWVU XLMHG izkrwqhlm_viili_xszigbkv* (*tVGkZIHVvIILIuFMX)(kZIHVvIILIxLWV);

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_viili_viili_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/IZKRWQHLM.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_izkrwqhlm_s_
#WVURMV izkrwqhlm_izkrwqhlm_s_

/*!\UROV IZKRWQHLM.S
    \YIRVU XLNNLM WVURMRGRLMH ZMW XLMURTFIZGRLM
    
    \HVV izkrwqhlm_xlmurt
 */

/*! \WVUTILFK izkrwqhlm_xlmurt iZKRWqhlm XLMURTFIZGRLM
    \YIRVU xLMURTFIZGRLM NZXILH ULI ORYIZIB UVZGFIVH

    hLNV iZKRWqhlm UVZGFIVH ZIV XLMURTFIZYOV GL ZWZKG GSV ORYIZIB GL Z DRWV
    EZIRVGB LU KOZGULINH, VMERILMNVMGH ZMW FHZTV HXVMZIRLH.  nLHG LU GSV
    UVZGFIVH XZM YV XLMURTFIVW RM GVINH LU LEVIIRWWVM LI KIVWVURMVW
    KIVKILXVHHLI NZXILH ZG XLNKROV-GRNV.

    hLNV ZWWRGRLMZO XFHGLNRAZGRLM RH ZEZROZYOV RM GSV \IVU izkrwqhlm_viilih zkrH.

    \MLGV gSVHV NZXILH HSLFOW YV TREVM LM GSV XLNKROVI XLNNZMW-ORMV
          (DSVIV ZKKORXZYOV)  GL ZELRW RMXLMHRHGVMG EZOFVH DSVM XLNKRORMT
          WRUUVIVMG GIZMHOZGRLM FMRGH LU Z HRMTOV ZKKORXZGRLM.
 */

#RMXOFWV <XHGWORY>  // NZOOLX(), IVZOOLX(), UIVV(), HRAV_G
#RMXOFWV <XHGIRMT>  // NVNHVG(), NVNXKB(), NVNNLEV(), NVNXNK()

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_evihrlm_hgirmt
//
// zodzbh HBMXSILMRAV GSV ULOOLDRMT 6 NZXILH DRGS XLIIVHKLMWRMT EZIRZYOVH RM /xnZPVoRHGH.GCG.
//

//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm
// GLPVM HGIRMTRURXZGRLM
#WVURMV izkrwqhlm_hgirmtrub(C) izkrwqhlm_wl_hgirmtrub(C)
#WVURMV izkrwqhlm_wl_hgirmtrub(C) #C

// GLPVM XLMXZGVMZGRLM
#WVURMV izkrwqhlm_qlrm(c, b) izkrwqhlm_wl_qlrm(c, b)
#WVURMV izkrwqhlm_wl_qlrm(c, b) izkrwqhlm_wl_qlrm7(c, b)
#WVURMV izkrwqhlm_wl_qlrm7(c, b) c##b
//!@VMWXLMW

/*! \WVU izkrwqhlm_nzqli_evihrlm
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU nZQLI EVIHRLM LU iZKRWqhlm RM RMGVTVI.
*/
/*! \WVU izkrwqhlm_nrmli_evihrlm
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU nRMLI EVIHRLM LU iZKRWqhlm RM RMGVTVI.
*/
/*! \WVU izkrwqhlm_kzgxs_evihrlm
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU kZGXS EVIHRLM LU iZKRWqhlm RM RMGVTVI.
*/
/*! \WVU izkrwqhlm_evihrlm_hgirmt
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU eVIHRLM LU iZKRWqhlm RM "<NZQLI>.<NRMLI>.<KZGXS>" HGIRMT ULINZG.
*/
#WVURMV izkrwqhlm_nzqli_evihrlm 8
#WVURMV izkrwqhlm_nrmli_evihrlm 8
#WVURMV izkrwqhlm_kzgxs_evihrlm 9
#WVURMV izkrwqhlm_evihrlm_hgirmt \
    izkrwqhlm_hgirmtrub(izkrwqhlm_nzqli_evihrlm.izkrwqhlm_nrmli_evihrlm.izkrwqhlm_kzgxs_evihrlm)

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_mznvhkzxv_(yvtrm|vmw)
/*! \WVU izkrwqhlm_mznvhkzxv
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU   KILERWV XFHGLN IZKRWQHLM MZNVHKZXV

    rM LIWVI GL ZELRW HBNYLO XOZHSVH ZMW/LI "lMV wVURMRGRLM iFOV" VIILIH
    YVGDVVM NFOGRKOV RMXOFHRLMH LU (WRUUVIVMG EVIHRLMH LU) iZKRWqhlm RM
    Z HRMTOV YRMZIB, FHVIH XZM XFHGLNRAV GSV MZNV LU GSV NZRM iZKRWqhlm
    MZNVHKZXV.

    rM XZHV LU Z HRMTOV MVHGRMT OVEVO, WVURMRMT \X izkrwqhlm_mznvhkzxv
    GL Z XFHGLN MZNV (V.T. \X nBiZKRWqhlm) RH HFUURXRVMG.  rU NFOGRKOV
    OVEVOH ZIV MVVWVW, YLGS \IVU izkrwqhlm_mznvhkzxv_yvtrm ZMW \IVU
    izkrwqhlm_mznvhkzxv_vmw MVVW GL YV WVURMVW ZH DVOO:

    \XLWV
    // RM HLNV .XKK UROV
    #WVURMV izkrwqhlm_mznvhkzxv NB::IZKRWQHLM
    #WVURMV izkrwqhlm_mznvhkzxv_yvtrm MZNVHKZXV NB { MZNVHKZXV IZKRWQHLM {
    #WVURMV izkrwqhlm_mznvhkzxv_vmw   } }
    #RMXOFWV "IZKRWQHLM/..."
    \VMWXLWV

    \HVV IZKRWQHLM
 */
/*! \WVU izkrwqhlm_mznvhkzxv_yvtrm
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU   KILERWV XFHGLN IZKRWQHLM MZNVHKZXV (LKVMRMT VCKIVHHRLM)
    \HVV izkrwqhlm_mznvhkzxv
*/
/*! \WVU izkrwqhlm_mznvhkzxv_vmw
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU   KILERWV XFHGLN IZKRWQHLM MZNVHKZXV (XOLHRMT VCKIVHHRLM)
    \HVV izkrwqhlm_mznvhkzxv
*/
#RUMWVU izkrwqhlm_mznvhkzxv
#WVURMV izkrwqhlm_mznvhkzxv IZKRWQHLM
#VMWRU
#RUMWVU izkrwqhlm_mznvhkzxv_yvtrm
#WVURMV izkrwqhlm_mznvhkzxv_yvtrm MZNVHKZXV izkrwqhlm_mznvhkzxv {
#VMWRU
#RUMWVU izkrwqhlm_mznvhkzxv_vmw
#WVURMV izkrwqhlm_mznvhkzxv_vmw }
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_szh_hgwhgirmt

#RUMWVU izkrwqhlm_szh_hgwhgirmt
#RUWVU izkrwqhlm_wlcbtvm_ifmmrmt
#WVURMV izkrwqhlm_szh_hgwhgirmt 8 // ULIXV TVMVIZGRLM LU WLXFNVMGZGRLM
#VOHV
#WVURMV izkrwqhlm_szh_hgwhgirmt 9 // ML HGW::HGIRMT HFKKLIG YB WVUZFOG
#VMWRU
/*! \WVU izkrwqhlm_szh_hgwhgirmt
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU vMZYOV iZKRWqhlm HFKKLIG ULI \X HGW::HGIRMT

    yB WVURMRMT GSRH KIVKILXVHHLI HBNYLO GL \X 8, HVEVIZO XLMEVMRVMXV UFMXGRLMH ULI FHRMT
    \IVU IZKRWQHLM::tVMVIRXeZOFV DRGS \X HGW::HGIRMT ZIV VMZYOVW, VHKVXRZOOB
    ULI XLMHGIFXGRLM ZMW XLNKZIRHLM.

    \SRWVRMRGRZORAVI
*/
#VMWRU // !WVURMVW(izkrwqhlm_szh_hgwhgirmt)

#RU izkrwqhlm_szh_hgwhgirmt
#RMXOFWV <HGIRMT>
#VMWRU // izkrwqhlm_szh_hgwhgirmt

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_ml_rmg35wvurmv

/*! \WVU izkrwqhlm_ml_rmg35wvurmv
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU fHV VCGVIMZO 35-YRG RMGVTVI GBKVH.

    iZKRWqhlm IVJFRIVH GSV 35-YRG RMGVTVI GBKVH \X RMG35_G ZMW  \X FRMG35_G GBKVH
    GL YV ZEZROZYOV ZG TOLYZO HXLKV.

    rU FHVIH SZEV GSVRI LDM WVURMRGRLM, WVURMV izkrwqhlm_ml_rmg35wvurmv GL
    KIVEVMG iZKRWqhlm UILN WVURMRMT RGH LDM GBKVH.
*/
#RUMWVU izkrwqhlm_ml_rmg35wvurmv
//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm
#RU WVURMVW(_nhx_evi) && (_nhx_evi < 8199)	// eRHFZO hGFWRL 7986
#RMXOFWV "NHRMGGBKVH/HGWRMG.S"
#RMXOFWV "NHRMGGBKVH/RMGGBKVH.S"
#VOHV
// lGSVI XLNKROVIH HSLFOW SZEV GSRH.
#RMXOFWV <HGWRMG.S>
#RMXOFWV <RMGGBKVH.S>
#VMWRU
//!@VMWXLMW
#RUWVU izkrwqhlm_wlcbtvm_ifmmrmt
#WVURMV izkrwqhlm_ml_rmg35wvurmv
#VMWRU
#VMWRU // izkrwqhlm_ml_rmg35gbkvwvu

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_ulixvrmormv

#RUMWVU izkrwqhlm_ulixvrmormv
//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm
#RU WVURMVW(_nhx_evi) && WVURMVW(mwvyft)
#WVURMV izkrwqhlm_ulixvrmormv __ULIXVRMORMV
#VORU WVURMVW(__tmfx__) && __tmfx__ >= 5 && WVURMVW(mwvyft)
#WVURMV izkrwqhlm_ulixvrmormv __ZGGIRYFGV__((ZODZBH_RMORMV))
#VOHV
#WVURMV izkrwqhlm_ulixvrmormv
#VMWRU
//!@VMWXLMW
#VMWRU // izkrwqhlm_ulixvrmormv

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_vmwrzm
#WVURMV izkrwqhlm_orggovvmwrzm  9   //!< oRGGOV VMWRZM NZXSRMV
#WVURMV izkrwqhlm_yrtvmwrzm     8   //!< yRT VMWRZM NZXSRMV

//! vMWRZMMVHH LU GSV NZXSRMV.
/*!
    \WVU izkrwqhlm_vmwrzm
    \RMTILFK izkrwqhlm_xlmurt

    txx 5.3 KILERWVW NZXIL ULI WVGVXGRMT VMWRZMMVHH LU GSV GZITVG NZXSRMV. yFG LGSVI
    XLNKROVIH NZB MLG SZEV GSRH. fHVI XZM WVURMV izkrwqhlm_vmwrzm GL VRGSVI
    \IVU izkrwqhlm_orggovvmwrzm LI \IVU izkrwqhlm_yrtvmwrzm.

    wVUZFOG WVGVXGRLM RNKOVNVMGVW DRGS IVUVIVMXV GL
    \OR SGGKH://TXX.TMF.LIT/LMORMVWLXH/TXX-5.3.9/XKK/xLNNLM-kIVWVURMVW-nZXILH.SGNO
    \OR SGGK://DDD.YLLHG.LIT/WLX/ORYH/8_57_9/YLLHG/WVGZRO/VMWRZM.SKK
*/
#RUMWVU izkrwqhlm_vmwrzm
// wVGVXG DRGS txx 5.3'H NZXIL
#  RUWVU __ybgv_liwvi__
#    RU __ybgv_liwvi__ == __liwvi_orggov_vmwrzm__
#      WVURMV izkrwqhlm_vmwrzm izkrwqhlm_orggovvmwrzm
#    VORU __ybgv_liwvi__ == __liwvi_yrt_vmwrzm__
#      WVURMV izkrwqhlm_vmwrzm izkrwqhlm_yrtvmwrzm
#    VOHV
#      VIILI fMPMLDM NZXSRMV VMWRZMMVHH WVGVXGVW. fHVI MVVWH GL WVURMV izkrwqhlm_vmwrzm.
#    VMWRU // __ybgv_liwvi__
// wVGVXG DRGS toryx'H VMWRZM.S
#  VORU WVURMVW(__toryx__)
#    RMXOFWV <VMWRZM.S>
#    RU (__ybgv_liwvi == __orggov_vmwrzm)
#      WVURMV izkrwqhlm_vmwrzm izkrwqhlm_orggovvmwrzm
#    VORU (__ybgv_liwvi == __yrt_vmwrzm)
#      WVURMV izkrwqhlm_vmwrzm izkrwqhlm_yrtvmwrzm
#    VOHV
#      VIILI fMPMLDM NZXSRMV VMWRZMMVHH WVGVXGVW. fHVI MVVWH GL WVURMV izkrwqhlm_vmwrzm.
#   VMWRU // __toryx__
// wVGVXG DRGS _orggov_vmwrzm ZMW _yrt_vmwrzm NZXIL
#  VORU WVURMVW(_orggov_vmwrzm) && !WVURMVW(_yrt_vmwrzm)
#    WVURMV izkrwqhlm_vmwrzm izkrwqhlm_orggovvmwrzm
#  VORU WVURMVW(_yrt_vmwrzm) && !WVURMVW(_orggov_vmwrzm)
#    WVURMV izkrwqhlm_vmwrzm izkrwqhlm_yrtvmwrzm
// wVGVXG DRGS ZIXSRGVXGFIV NZXILH
#  VORU WVURMVW(__HKZIX) || WVURMVW(__HKZIX__) || WVURMVW(_kldvi) || WVURMVW(__KLDVIKX__) || WVURMVW(__KKX__) || WVURMVW(__SKFC) || WVURMVW(__SKKZ) || WVURMVW(_nrkhvy) || WVURMVW(_kldvi) || WVURMVW(__H609__)
#    WVURMV izkrwqhlm_vmwrzm izkrwqhlm_yrtvmwrzm
#  VORU WVURMVW(__R613__) || WVURMVW(__ZOKSZ__) || WVURMVW(__RZ35) || WVURMVW(__RZ35__) || WVURMVW(_n_rc13) || WVURMVW(_n_rz35) || WVURMVW(_n_zoksz) || WVURMVW(__ZNW35) || WVURMVW(__ZNW35__) || WVURMVW(_n_znw35) || WVURMVW(__C13_35) || WVURMVW(__C13_35__) || WVURMVW(_n_c35) || WVURMVW(__YURM__)
#    WVURMV izkrwqhlm_vmwrzm izkrwqhlm_orggovvmwrzm
#  VORU WVURMVW(_nhx_evi) && (WVURMVW(_n_zin) || WVURMVW(_n_zin35))
#    WVURMV izkrwqhlm_vmwrzm izkrwqhlm_orggovvmwrzm
#  VORU WVURMVW(izkrwqhlm_wlcbtvm_ifmmrmt)
#    WVURMV izkrwqhlm_vmwrzm
#  VOHV
#    VIILI fMPMLDM NZXSRMV VMWRZMMVHH WVGVXGVW. fHVI MVVWH GL WVURMV izkrwqhlm_vmwrzm.   
#  VMWRU
#VMWRU // izkrwqhlm_vmwrzm

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_35yrg

//! dSVGSVI FHRMT 35-YRG ZIXSRGVXGFIV
#RUMWVU izkrwqhlm_35yrg
#RU WVURMVW(__ok35__) || (WVURMVW(__C13_35__) && WVURMVW(__rok67__)) || WVURMVW(_drm35) || WVURMVW(__vnhxirkgvm__)
#WVURMV izkrwqhlm_35yrg 8
#VOHV
#WVURMV izkrwqhlm_35yrg 9
#VMWRU
#VMWRU // izkrwqhlm_35yrg

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_zortm

//! wZGZ ZORTMNVMG LU GSV NZXSRMV.
/*! \RMTILFK izkrwqhlm_xlmurt
    \KZIZN C KLRMGVI GL ZORTM

    hLNV NZXSRMVH IVJFRIV HGIRXG WZGZ ZORTMNVMG. xFIIVMGOB GSV WVUZFOG FHVH 5 YBGVH
    ZORTMNVMG LM 67-YRG KOZGULINH ZMW 1 YBGVH ZORTMNVMG ULI 35-YRG KOZGULINH.
    fHVI XZM XFHGLNRAV YB WVURMRMT GSV izkrwqhlm_zortm UFMXGRLM NZXIL.
*/
#RUMWVU izkrwqhlm_zortm
#RU izkrwqhlm_35yrg == 8
#WVURMV izkrwqhlm_zortm(C) (((C) + HGZGRX_XZHG<FRMG35_G>(2F)) & ~HGZGRX_XZHG<FRMG35_G>(2F))
#VOHV
#WVURMV izkrwqhlm_zortm(C) (((C) + 6F) & ~6F)
#VMWRU
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_frmg35_x7

//! xLMHGIFXG Z 35-YRG ORGVIZO YB Z KZRI LU 67-YRG RMGVTVI.
/*!
    35-YRG ORGVIZO DRGS LI DRGSLFG foo HFUURC RH KILMV GL XLNKROVI DZIMRMTH.
    frmg35_x() RH x NZXIL DSRXS XZFHV XLNKROZGRLM KILYOVNH.
    fHV GSRH NZXIL GL WVURMV 35-YRG XLMHGZMGH YB Z KZRI LU 67-YRG RMGVTVI.
*/
#RUMWVU izkrwqhlm_frmg35_x7
#WVURMV izkrwqhlm_frmg35_x7(SRTS67, OLD67) ((HGZGRX_XZHG<FRMG35_G>(SRTS67) << 67) | HGZGRX_XZHG<FRMG35_G>(OLD67))
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm

//! fHV LMOB OLDVI 51-YRG ZWWIVHH ULI HLNV KLRMGVIH.
/*!
    \RMTILFK izkrwqhlm_xlmurt

    gSRH LKGRNRAZGRLM FHVH GSV UZXG GSZG XFIIVMG c13-35 ZIXSRGVXGFIV LMOB RNKOVNVMG OLDVI 51-YRG ERIGFZO ZWWIVHH.
    gSV SRTSVI 83-YRG XZM YV FHVW ULI HGLIRMT LGSVI WZGZ.
    \X tVMVIRXeZOFV FHVH GSRH LKGRNRAZGRLM GL IVWFXV RGH HRAV ULIN 75 YBGVH GL 83 YBGVH RM 35-YRG ZIXSRGVXGFIV.
*/
#RUMWVU izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm
#RU WVURMVW(__ZNW35__) || WVURMVW(__ZNW35) || WVURMVW(__C13_35__) || WVURMVW(__C13_35) || WVURMVW(_n_c35) || WVURMVW(_n_znw35)
#WVURMV izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm 8
#VOHV
#WVURMV izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm 9
#VMWRU
#VMWRU // izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm

#RU izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm == 8
#RU izkrwqhlm_35yrg != 8
#VIILI izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm XZM LMOB YV HVG GL 8 DSVM izkrwqhlm_35yrg=8
#VMWRU
#WVURMV izkrwqhlm_hvgklrmgvi(GBKV, K, C) (K = IVRMGVIKIVG_XZHG<GBKV *>((IVRMGVIKIVG_XZHG<FRMGKGI_G>(K) & HGZGRX_XZHG<FRMGKGI_G>(izkrwqhlm_frmg35_x7(9Cuuuu9999, 9C99999999))) | IVRMGVIKIVG_XZHG<FRMGKGI_G>(IVRMGVIKIVG_XZHG<XLMHG ELRW*>(C))))
#WVURMV izkrwqhlm_tvgklrmgvi(GBKV, K) (IVRMGVIKIVG_XZHG<GBKV *>(IVRMGVIKIVG_XZHG<FRMGKGI_G>(K) & HGZGRX_XZHG<FRMGKGI_G>(izkrwqhlm_frmg35_x7(9C9999uuuu, 9Cuuuuuuuu))))
#VOHV
#WVURMV izkrwqhlm_hvgklrmgvi(GBKV, K, C) (K = (C))
#WVURMV izkrwqhlm_tvgklrmgvi(GBKV, K) (K)
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_hhv7/izkrwqhlm_hhv57/izkrwqhlm_mvlm/izkrwqhlm_hrnw

/*! \WVU izkrwqhlm_hrnw
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU vMZYOV hhv7/hhv5.7/mVLM LKGRNRAZGRLM.

    iZKRWqhlm HFKKLIGH LKGRNRAVW RNKOVNVMGZGRLMH ULI HLNV KZIHRMT LKVIZGRLMH
    YZHVW LM GSV hhv7, hhv5.7 LI mvLM hrnw VCGVMHRLMH LM NLWVIM rMGVO
    LI zin XLNKZGRYOV KILXVHHLIH.

    gL VMZYOV GSVHV LKGRNRAZGRLMH, GSIVV WRUUVIVMG HBNYLOH XZM YV WVURMVW;
    \XLWV
    // vMZYOV hhv7 LKGRNRAZGRLM.
    #WVURMV izkrwqhlm_hhv7

    // vMZYOV hhv5.7 LKGRNRAZGRLM.
    #WVURMV izkrwqhlm_hhv57
    \VMWXLWV

    // vMZYOV zin mVLM LKGRNRAZGRLM.
    #WVURMV izkrwqhlm_mvlm
    \VMWXLWV

    \X izkrwqhlm_hhv57 GZPVH KIVXVWVMXV LEVI hhv7, RU YLGS ZIV WVURMVW.

    rU ZMB LU GSVHV HBNYLOH RH WVURMVW, iZKRWqhlm WVURMVH GSV NZXIL
    \X izkrwqhlm_hrnw GL RMWRXZGV GSV ZEZROZYRORGB LU GSV LKGRNRAVW XLWV.
*/
#RU WVURMVW(izkrwqhlm_hhv7) || WVURMVW(izkrwqhlm_hhv57) \
    || WVURMVW(izkrwqhlm_mvlm) || WVURMVW(izkrwqhlm_wlcbtvm_ifmmrmt)
#WVURMV izkrwqhlm_hrnw
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_ml_hravgbkvwvurmv

#RUMWVU izkrwqhlm_ml_hravgbkvwvurmv
/*! \WVU izkrwqhlm_ml_hravgbkvwvurmv
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU fHVI-KILERWVW \X hRAVgBKV WVURMRGRLM.

    rM LIWVI GL ZELRW FHRMT 67-YRG HRAV GBKVH ULI RMWVCRMT HGIRMTH ZMW ZIIZBH,
    WVURMV GSRH KIVKILXVHHLI HBNYLO ZMW KILERWV GSV GBKV IZKRWQHLM::hRAVgBKV
    YVULIV RMXOFWRMT iZKRWqhlm:
    \XLWV
    #WVURMV izkrwqhlm_ml_hravgbkvwvurmv
    MZNVHKZXV IZKRWQHLM { GBKVWVU ::HGW::HRAV_G hRAVgBKV; }
    #RMXOFWV "IZKRWQHLM/..."
    \VMWXLWV

    \HVV IZKRWQHLM::hRAVgBKV
*/
#RUWVU izkrwqhlm_wlcbtvm_ifmmrmt
#WVURMV izkrwqhlm_ml_hravgbkvwvurmv
#VMWRU
izkrwqhlm_mznvhkzxv_yvtrm
//! hRAV GBKV (ULI HGIRMT OVMTGSH, ZIIZB HRAVH, VGX.)
/*! iZKRWqhlm FHVH 67-YRG ZIIZB/HGIRMT RMWRXVH VEVM LM 35-YRG KOZGULINH,
    RMHGVZW LU FHRMT \X HRAV_G. fHVIH NZB LEVIIRWV GSV hRAVgBKV YB WVURMRMT
    \IVU izkrwqhlm_ml_hravgbkvwvurmv.
*/
GBKVWVU FMHRTMVW hRAVgBKV;
izkrwqhlm_mznvhkzxv_vmw
#VMWRU

// ZODZBH RNKLIG HGW::HRAV_G GL IZKRWQHLM MZNVHKZXV
izkrwqhlm_mznvhkzxv_yvtrm
FHRMT HGW::HRAV_G;
izkrwqhlm_mznvhkzxv_vmw

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_zhhvig

//! zHHVIGRLM.
/*! \RMTILFK izkrwqhlm_xlmurt
    yB WVUZFOG, IZKRWQHLM FHVH x \X ZHHVIG() ULI RMGVIMZO ZHHVIGRLMH.
    fHVI XZM LEVIIRWV RG YB WVURMRMT izkrwqhlm_zhhvig(C) NZXIL.

    \MLGV kZIHRMT VIILIH ZIV SZMWOVW ZMW XZM YV XFHGLNRAVW YB GSV
          \IVU izkrwqhlm_viilih zkrH.
*/
#RUMWVU izkrwqhlm_zhhvig
#RMXOFWV <XZHHVIG>
#WVURMV izkrwqhlm_zhhvig(C) ZHHVIG(C)
#VMWRU // izkrwqhlm_zhhvig

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_hgzgrx_zhhvig

// kIVUVI x++88 HGZGRX_ZHHVIG, RU ZEZROZYOV
#RUMWVU izkrwqhlm_hgzgrx_zhhvig
#RU __XKOFHKOFH >= 798896o || ( WVURMVW(_nhx_evi) && _nhx_evi >= 8199 )
#WVURMV izkrwqhlm_hgzgrx_zhhvig(C) \
   HGZGRX_ZHHVIG(C, izkrwqhlm_hgirmtrub(C))
#VMWRU // x++88
#VMWRU // izkrwqhlm_hgzgrx_zhhvig

// zWLKG x++96 RNKOVNVMGZGRLM UILN YLLHG
#RUMWVU izkrwqhlm_hgzgrx_zhhvig
#RUMWVU __XOZMT__
//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm
#VMWRU
izkrwqhlm_mznvhkzxv_yvtrm
GVNKOZGV <YLLO C> HGIFXG hgzgrx_zhhvigrlm_uzrofiv;
GVNKOZGV <> HGIFXG hgzgrx_zhhvigrlm_uzrofiv<GIFV> { VMFN { EZOFV = 8 }; };
GVNKOZGV <HRAV_G C> HGIFXG hGZGRXzHHVIGgVHG {};
izkrwqhlm_mznvhkzxv_vmw

#RU WVURMVW(__tmfx__)
#WVURMV izkrwqhlm_hgzgrx_zhhvig_fmfhvw_zggiryfgv __ZGGIRYFGV__((FMFHVW))
#VOHV
#WVURMV izkrwqhlm_hgzgrx_zhhvig_fmfhvw_zggiryfgv 
#VMWRU
#RUMWVU __XOZMT__
//!@VMWXLMW
#VMWRU

/*! \WVU izkrwqhlm_hgzgrx_zhhvig
    \YIRVU (rMGVIMZO) NZXIL GL XSVXP ULI XLMWRGRLMH ZG XLNKROV-GRNV
    \KZIZN C XLNKROV-GRNV XLMWRGRLM
    \SRWVRMRGRZORAVI
 */
#WVURMV izkrwqhlm_hgzgrx_zhhvig(C) \
    GBKVWVU ::izkrwqhlm_mznvhkzxv::hGZGRXzHHVIGgVHG< \
      HRAVLU(::izkrwqhlm_mznvhkzxv::hgzgrx_zhhvigrlm_uzrofiv<YLLO(C) >)> \
    izkrwqhlm_qlrm(hGZGRXzHHVIGgBKVWVU, __ormv__) izkrwqhlm_hgzgrx_zhhvig_fmfhvw_zggiryfgv
#VMWRU // izkrwqhlm_hgzgrx_zhhvig

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_orpvob, izkrwqhlm_fmorpvob

//! xLNKROVI YIZMXSRMT SRMG ULI VCKIVHHRLM DRGS SRTS KILYZYRORGB GL YV GIFV.
/*!
    \RMTILFK izkrwqhlm_xlmurt
    \KZIZN C yLLOVZM VCKIVHHRLM ORPVOB GL YV GIFV.
*/
#RUMWVU izkrwqhlm_orpvob
#RU WVURMVW(__tmfx__) || WVURMVW(__XOZMT__)
#WVURMV izkrwqhlm_orpvob(C) __YFROGRM_VCKVXG(!!(C), 8)
#VOHV
#WVURMV izkrwqhlm_orpvob(C) (C)
#VMWRU
#VMWRU

//! xLNKROVI YIZMXSRMT SRMG ULI VCKIVHHRLM DRGS OLD KILYZYRORGB GL YV GIFV.
/*!
    \RMTILFK izkrwqhlm_xlmurt
    \KZIZN C yLLOVZM VCKIVHHRLM FMORPVOB GL YV GIFV.
*/
#RUMWVU izkrwqhlm_fmorpvob
#RU WVURMVW(__tmfx__) || WVURMVW(__XOZMT__)
#WVURMV izkrwqhlm_fmorpvob(C) __YFROGRM_VCKVXG(!!(C), 9)
#VOHV
#WVURMV izkrwqhlm_fmorpvob(C) (C)
#VMWRU
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// sVOKVIH

//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm

#WVURMV izkrwqhlm_nfogrormvnzxil_yvtrm WL {  
#WVURMV izkrwqhlm_nfogrormvnzxil_vmw \
} DSROV((ELRW)9, 9)

// ZWLKGVW UILN yLLHG
#WVURMV izkrwqhlm_evihrlm_xlwv(C,B,A) \
  (((C)*899999) + ((B)*899) + (A))

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_wrzt_kfhs/klk, izkrwqhlm_wrzt_luu

#RU WVURMVW(__tmfx__)
#WVURMV izkrwqhlm_tmfx \
    izkrwqhlm_evihrlm_xlwv(__tmfx__,__tmfx_nrmli__,__tmfx_kzgxsovevo__)
#VMWRU

#RU WVURMVW(__XOZMT__) || (WVURMVW(izkrwqhlm_tmfx) && izkrwqhlm_tmfx >= izkrwqhlm_evihrlm_xlwv(5,7,9))

#WVURMV izkrwqhlm_kiztnz(C) _kIZTNZ(izkrwqhlm_hgirmtrub(C))
#WVURMV izkrwqhlm_wrzt_kiztnz(C) izkrwqhlm_kiztnz(txx WRZTMLHGRX C)
#WVURMV izkrwqhlm_wrzt_luu(C) \
    izkrwqhlm_wrzt_kiztnz(RTMLIVW izkrwqhlm_hgirmtrub(izkrwqhlm_qlrm(-d,C)))

// KFHS/KLK HFKKLIG RM xOZMT ZMW txx>=5.3
#RU WVURMVW(__XOZMT__) || (WVURMVW(izkrwqhlm_tmfx) && izkrwqhlm_tmfx >= izkrwqhlm_evihrlm_xlwv(5,3,9))
#WVURMV izkrwqhlm_wrzt_kfhs izkrwqhlm_wrzt_kiztnz(KFHS)
#WVURMV izkrwqhlm_wrzt_klk  izkrwqhlm_wrzt_kiztnz(KLK)
#VOHV // txx >= 5.7, < 5.3
#WVURMV izkrwqhlm_wrzt_kfhs /* RTMLIVW */
#WVURMV izkrwqhlm_wrzt_klk /* RTMLIVW */
#VMWRU

#VORU WVURMVW(_nhx_evi)

// KIZTNZ (nhex HKVXRURX)
#WVURMV izkrwqhlm_kiztnz(C) __KIZTNZ(C)
#WVURMV izkrwqhlm_wrzt_kiztnz(C) izkrwqhlm_kiztnz(DZIMRMT(C))

#WVURMV izkrwqhlm_wrzt_luu(C) izkrwqhlm_wrzt_kiztnz(WRHZYOV: C)
#WVURMV izkrwqhlm_wrzt_kfhs izkrwqhlm_wrzt_kiztnz(KFHS)
#WVURMV izkrwqhlm_wrzt_klk  izkrwqhlm_wrzt_kiztnz(KLK)

#VOHV

#WVURMV izkrwqhlm_wrzt_luu(C) /* RTMLIVW */
#WVURMV izkrwqhlm_wrzt_kfhs   /* RTMLIVW */
#WVURMV izkrwqhlm_wrzt_klk    /* RTMLIVW */

#VMWRU // izkrwqhlm_wrzt_*

///////////////////////////////////////////////////////////////////////////////
// x++88 UVZGFIVH

#RUMWVU izkrwqhlm_szh_xcc88_iezofv_ivuh
#RU WVURMVW(__XOZMT__)
#RU __SZH_UVZGFIV(XCC_IEZOFV_IVUVIVMXVH) && \
    (WVURMVW(_oryxkk_evihrlm) || WVURMVW(__toryxcc__) && __toryxcc__ >= 79919693)
#WVURMV izkrwqhlm_szh_xcc88_iezofv_ivuh 8
#VOHV
#WVURMV izkrwqhlm_szh_xcc88_iezofv_ivuh 9
#VMWRU
#VORU (WVURMVW(izkrwqhlm_tmfx) && (izkrwqhlm_tmfx >= izkrwqhlm_evihrlm_xlwv(5,6,9)) && WVURMVW(__tcc_vckvirnvmgzo_xcc9c__)) || \
      (WVURMVW(_nhx_evi) && _nhx_evi >= 8399)

#WVURMV izkrwqhlm_szh_xcc88_iezofv_ivuh 8
#VOHV
#WVURMV izkrwqhlm_szh_xcc88_iezofv_ivuh 9
#VMWRU
#VMWRU // izkrwqhlm_szh_xcc88_iezofv_ivuh

#RUMWVU izkrwqhlm_szh_xcc88_mlvcxvkg
#RU WVURMVW(__XOZMT__)
#WVURMV izkrwqhlm_szh_xcc88_mlvcxvkg __SZH_UVZGFIV(XCC_MLVCXVKG)
#VORU (WVURMVW(izkrwqhlm_tmfx) && (izkrwqhlm_tmfx >= izkrwqhlm_evihrlm_xlwv(5,3,9)) && WVURMVW(__tcc_vckvirnvmgzo_xcc9c__))
//    (WVURMVW(_nhx_evi) && _nhx_evi >= ????) // MLG BVG HFKKLIGVW
#WVURMV izkrwqhlm_szh_xcc88_mlvcxvkg 8
#VOHV
#WVURMV izkrwqhlm_szh_xcc88_mlvcxvkg 9
#VMWRU
#VMWRU
#RU izkrwqhlm_szh_xcc88_mlvcxvkg
#WVURMV izkrwqhlm_mlvcxvkg MLVCXVKG
#VOHV
#WVURMV izkrwqhlm_mlvcxvkg /* MLVCXVKG */
#VMWRU // izkrwqhlm_szh_xcc88_mlvcxvkg

// ML ZFGLNZGRX WVGVXGRLM, BVG
#RUMWVU izkrwqhlm_szh_xcc88_gbkvgizrgh
#WVURMV izkrwqhlm_szh_xcc88_gbkvgizrgh 9
#VMWRU

#RUMWVU izkrwqhlm_szh_xcc88_izmtv_uli
#RU WVURMVW(__XOZMT__)
#WVURMV izkrwqhlm_szh_xcc88_izmtv_uli __SZH_UVZGFIV(XCC_IZMTV_ULI)
#VORU (WVURMVW(izkrwqhlm_tmfx) && (izkrwqhlm_tmfx >= izkrwqhlm_evihrlm_xlwv(5,3,9)) && WVURMVW(__tcc_vckvirnvmgzo_xcc9c__)) || \
      (WVURMVW(_nhx_evi) && _nhx_evi >= 8299)
#WVURMV izkrwqhlm_szh_xcc88_izmtv_uli 8
#VOHV
#WVURMV izkrwqhlm_szh_xcc88_izmtv_uli 9
#VMWRU
#VMWRU // izkrwqhlm_szh_xcc88_izmtv_uli

//!@VMWXLMW

///////////////////////////////////////////////////////////////////////////////
// MVD/WVOVGV

#RUMWVU izkrwqhlm_mvd
///! XFHGLNRAZGRLM KLRMG ULI TOLYZO \X MVD
#WVURMV izkrwqhlm_mvd(gBKVmZNV) MVD gBKVmZNV
#VMWRU
#RUMWVU izkrwqhlm_wvovgv
///! XFHGLNRAZGRLM KLRMG ULI TOLYZO \X WVOVGV
#WVURMV izkrwqhlm_wvovgv(C) WVOVGV C
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// gBKV

/*! \MZNVHKZXV IZKRWQHLM
    \YIRVU NZRM iZKRWqhlm MZNVHKZXV
    \HVV izkrwqhlm_mznvhkzxv
*/
izkrwqhlm_mznvhkzxv_yvtrm

//! gBKV LU qhlm EZOFV
VMFN gBKV {
    PmFOOgBKV = 9,      //!< MFOO
    PuZOHVgBKV = 8,     //!< UZOHV
    PgIFVgBKV = 7,      //!< GIFV
    PlYQVXGgBKV = 6,    //!< LYQVXG
    PzIIZBgBKV = 5,     //!< ZIIZB 
    PhGIRMTgBKV = 4,    //!< HGIRMT
    PmFNYVIgBKV = 3     //!< MFNYVI
};

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_izkrwqhlm_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/LHGIVZNDIZKKVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_lhgivzndizkkvi_s_
#WVURMV izkrwqhlm_lhgivzndizkkvi_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV <RLHUDW>

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! dIZKKVI LU \X HGW::YZHRX_LHGIVZN RMGL iZKRWqhlm'H hGIVZN XLMXVKG.
/*!
    gSV XOZHHVH XZM YV DIZKKVW RMXOFWRMT YFG MLG ORNRGVW GL:

    - \X HGW::LHGIRMTHGIVZN
    - \X HGW::HGIRMTHGIVZN
    - \X HGW::DKHGIRMTHGIVZN
    - \X HGW::DHGIRMTHGIVZN
    - \X HGW::RUHGIVZN
    - \X HGW::UHGIVZN
    - \X HGW::DLUHGIVZN
    - \X HGW::DUHGIVZN

    \GKZIZN hGIVZNgBKV xOZHH WVIREVW UILN \X HGW::YZHRX_LHGIVZN.
*/
   
GVNKOZGV <GBKVMZNV hGIVZNgBKV>
XOZHH yZHRXlhGIVZNdIZKKVI {
KFYORX:
    GBKVWVU GBKVMZNV hGIVZNgBKV::XSZI_GBKV xS;
    yZHRXlhGIVZNdIZKKVI(hGIVZNgBKV& HGIVZN) : HGIVZN_(HGIVZN) {}

    ELRW kFG(xS X) {
        HGIVZN_.KFG(X);
    }

    ELRW uOFHS() {
        HGIVZN_.UOFHS();
    }

    // mLG RNKOVNVMGVW
    XSZI kVVP() XLMHG { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    XSZI gZPV() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G gVOO() XLMHG { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    XSZI* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G kFGvMW(XSZI*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

KIREZGV:
    yZHRXlhGIVZNdIZKKVI(XLMHG yZHRXlhGIVZNdIZKKVI&);
    yZHRXlhGIVZNdIZKKVI& LKVIZGLI=(XLMHG yZHRXlhGIVZNdIZKKVI&);

    hGIVZNgBKV& HGIVZN_;
};

GBKVWVU yZHRXlhGIVZNdIZKKVI<HGW::LHGIVZN> lhGIVZNdIZKKVI;
GBKVWVU yZHRXlhGIVZNdIZKKVI<HGW::DLHGIVZN> dlhGIVZNdIZKKVI;

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_lhgivzndizkkvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/NHRMGGBKVH/RMGGBKVH.S
// rhl x0C  XLNKORZMG RMGGBKVH.S ULI nRXILHLUG eRHFZO hGFWRL
// yZHVW LM rhl/rvx 0100:gx7 xLNNRGGVV WIZUG (nZB 3, 7994) dt85/m8875 
// 
//  xLKBIRTSG (X) 7993-7986 zOVCZMWVI xSVNVIRH
// 
// iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
// NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV NVG:
// 
//   8. iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG MLGRXV,
//      GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.
// 
//   7. iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV XLKBIRTSG
//      MLGRXV, GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI RM GSV
//      WLXFNVMGZGRLM ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV WRHGIRYFGRLM.
// 
//   6. mVRGSVI GSV MZNV LU GSV KILWFXG MLI GSV MZNVH LU RGH XLMGIRYFGLIH NZB
//      YV FHVW GL VMWLIHV LI KILNLGV KILWFXGH WVIREVW UILN GSRH HLUGDZIV
//      DRGSLFG HKVXRURX KIRLI DIRGGVM KVINRHHRLM.
// 
// gsrh hlugdziv rh kilerwvw yb gsv zfgsli ``zh rh'' zmw zmb vckivhh li rnkorvw
// dziizmgrvh, rmxofwrmt, yfg mlg ornrgvw gl, gsv rnkorvw dziizmgrvh lu
// nvixszmgzyrorgb zmw urgmvhh uli z kzigrxfozi kfiklhv ziv wrhxozrnvw. rm ml
// vevmg hszoo gsv zfgsli yv orzyov uli zmb wrivxg, rmwrivxg, rmxrwvmgzo,
// hkvxrzo, vcvnkozib, li xlmhvjfvmgrzo wznztvh (rmxofwrmt, yfg mlg ornrgvw gl,
// kilxfivnvmg lu hfyhgrgfgv tllwh li hvierxvh; olhh lu fhv, wzgz, li kilurgh;
// li yfhrmvhh rmgviifkgrlm) sldvevi xzfhvw zmw lm zmb gsvlib lu orzyrorgb, 
// dsvgsvi rm xlmgizxg, hgirxg orzyrorgb, li glig (rmxofwrmt mvtortvmxv li
// lgsvidrhv) zirhrmt rm zmb dzb lfg lu gsv fhv lu gsrh hlugdziv, vevm ru
// zwerhvw lu gsv klhhryrorgb lu hfxs wznztv.
// 
///////////////////////////////////////////////////////////////////////////////

// gSV ZYLEV HLUGDZIV RM GSRH WRHGIRYFGRLM NZB SZEV YVVM NLWRURVW YB 
// gso z70 oRNRGVW ("gVMXVMG nLWRURXZGRLMH"). 
// zOO gVMXVMG nLWRURXZGRLMH ZIV xLKBIRTSG (x) 7984 gso z70 oRNRGVW.

#RUMWVU _nhx_evi // [
#VIILI "fHV GSRH SVZWVI LMOB DRGS nRXILHLUG eRHFZO x++ XLNKROVIH!"
#VMWRU // _nhx_evi ]

#RUMWVU _nhx_rmggbkvh_s_ // [
#WVURMV _nhx_rmggbkvh_s_

#RU _nhx_evi > 8999
#KIZTNZ LMXV
#VMWRU

#RMXOFWV "HGWRMG.S"

// NROLBRK: ex HFKKLIGH RMGGBKVH.S HRMXV ex7986
#RU _nhx_evi >= 8199
#RMXOFWV <RMGGBKVH.S>
#VOHV

// 2.1 uLINZG XLMEVIHRLM LU RMGVTVI GBKVH

GBKVWVU HGIFXG {
   RMGNZC_G JFLG;
   RMGNZC_G IVN;
} RNZCWRE_G;

// 2.1.8 nZXILH ULI ULINZG HKVXRURVIH

#RU !WVURMVW(__XKOFHKOFH) || WVURMVW(__hgwx_ulinzg_nzxilh) // [   hVV ULLGMLGV 814 ZG KZTV 801

// gSV UKIRMGU NZXILH ULI HRTMVW RMGVTVIH ZIV:
#WVURMV kirW1       "W"
#WVURMV kirR1       "R"
#WVURMV kirWovzhg1  "W"
#WVURMV kirRovzhg1  "R"
#WVURMV kirWuzhg1   "W"
#WVURMV kirRuzhg1   "R"

#WVURMV kirW83       "SW"
#WVURMV kirR83       "SR"
#WVURMV kirWovzhg83  "SW"
#WVURMV kirRovzhg83  "SR"
#WVURMV kirWuzhg83   "SW"
#WVURMV kirRuzhg83   "SR"

#WVURMV kirW67       "r67W"
#WVURMV kirR67       "r67R"
#WVURMV kirWovzhg67  "r67W"
#WVURMV kirRovzhg67  "r67R"
#WVURMV kirWuzhg67   "r67W"
#WVURMV kirRuzhg67   "r67R"

#WVURMV kirW35       "r35W"
#WVURMV kirR35       "r35R"
#WVURMV kirWovzhg35  "r35W"
#WVURMV kirRovzhg35  "r35R"
#WVURMV kirWuzhg35   "r35W"
#WVURMV kirRuzhg35   "r35R"

#WVURMV kirWnzc     "r35W"
#WVURMV kirRnzc     "r35R"

#WVURMV kirWkgi     "rW"
#WVURMV kirRkgi     "rR"

// gSV UKIRMGU NZXILH ULI FMHRTMVW RMGVTVIH ZIV:
#WVURMV kirL1       "L"
#WVURMV kirF1       "F"
#WVURMV kirC1       "C"
#WVURMV kirc1       "c"
#WVURMV kirLovzhg1  "L"
#WVURMV kirFovzhg1  "F"
#WVURMV kirCovzhg1  "C"
#WVURMV kircovzhg1  "c"
#WVURMV kirLuzhg1   "L"
#WVURMV kirFuzhg1   "F"
#WVURMV kirCuzhg1   "C"
#WVURMV kircuzhg1   "c"

#WVURMV kirL83       "SL"
#WVURMV kirF83       "SF"
#WVURMV kirC83       "SC"
#WVURMV kirc83       "Sc"
#WVURMV kirLovzhg83  "SL"
#WVURMV kirFovzhg83  "SF"
#WVURMV kirCovzhg83  "SC"
#WVURMV kircovzhg83  "Sc"
#WVURMV kirLuzhg83   "SL"
#WVURMV kirFuzhg83   "SF"
#WVURMV kirCuzhg83   "SC"
#WVURMV kircuzhg83   "Sc"

#WVURMV kirL67       "r67L"
#WVURMV kirF67       "r67F"
#WVURMV kirC67       "r67C"
#WVURMV kirc67       "r67c"
#WVURMV kirLovzhg67  "r67L"
#WVURMV kirFovzhg67  "r67F"
#WVURMV kirCovzhg67  "r67C"
#WVURMV kircovzhg67  "r67c"
#WVURMV kirLuzhg67   "r67L"
#WVURMV kirFuzhg67   "r67F"
#WVURMV kirCuzhg67   "r67C"
#WVURMV kircuzhg67   "r67c"

#WVURMV kirL35       "r35L"
#WVURMV kirF35       "r35F"
#WVURMV kirC35       "r35C"
#WVURMV kirc35       "r35c"
#WVURMV kirLovzhg35  "r35L"
#WVURMV kirFovzhg35  "r35F"
#WVURMV kirCovzhg35  "r35C"
#WVURMV kircovzhg35  "r35c"
#WVURMV kirLuzhg35   "r35L"
#WVURMV kirFuzhg35   "r35F"
#WVURMV kirCuzhg35   "r35C"
#WVURMV kircuzhg35   "r35c"

#WVURMV kirLnzc     "r35L"
#WVURMV kirFnzc     "r35F"
#WVURMV kirCnzc     "r35C"
#WVURMV kircnzc     "r35c"

#WVURMV kirLkgi     "rL"
#WVURMV kirFkgi     "rF"
#WVURMV kirCkgi     "rC"
#WVURMV kirckgi     "rc"

// gSV UHXZMU NZXILH ULI HRTMVW RMGVTVIH ZIV:
#WVURMV hxmW1       "W"
#WVURMV hxmR1       "R"
#WVURMV hxmWovzhg1  "W"
#WVURMV hxmRovzhg1  "R"
#WVURMV hxmWuzhg1   "W"
#WVURMV hxmRuzhg1   "R"

#WVURMV hxmW83       "SW"
#WVURMV hxmR83       "SR"
#WVURMV hxmWovzhg83  "SW"
#WVURMV hxmRovzhg83  "SR"
#WVURMV hxmWuzhg83   "SW"
#WVURMV hxmRuzhg83   "SR"

#WVURMV hxmW67       "OW"
#WVURMV hxmR67       "OR"
#WVURMV hxmWovzhg67  "OW"
#WVURMV hxmRovzhg67  "OR"
#WVURMV hxmWuzhg67   "OW"
#WVURMV hxmRuzhg67   "OR"

#WVURMV hxmW35       "r35W"
#WVURMV hxmR35       "r35R"
#WVURMV hxmWovzhg35  "r35W"
#WVURMV hxmRovzhg35  "r35R"
#WVURMV hxmWuzhg35   "r35W"
#WVURMV hxmRuzhg35   "r35R"

#WVURMV hxmWnzc     "r35W"
#WVURMV hxmRnzc     "r35R"

#RUWVU _drm35 // [
#  WVURMV hxmWkgi     "r35W"
#  WVURMV hxmRkgi     "r35R"
#VOHV  // _drm35 ][
#  WVURMV hxmWkgi     "OW"
#  WVURMV hxmRkgi     "OR"
#VMWRU  // _drm35 ]

// gSV UHXZMU NZXILH ULI FMHRTMVW RMGVTVIH ZIV:
#WVURMV hxmL1       "L"
#WVURMV hxmF1       "F"
#WVURMV hxmC1       "C"
#WVURMV hxmc1       "c"
#WVURMV hxmLovzhg1  "L"
#WVURMV hxmFovzhg1  "F"
#WVURMV hxmCovzhg1  "C"
#WVURMV hxmcovzhg1  "c"
#WVURMV hxmLuzhg1   "L"
#WVURMV hxmFuzhg1   "F"
#WVURMV hxmCuzhg1   "C"
#WVURMV hxmcuzhg1   "c"

#WVURMV hxmL83       "SL"
#WVURMV hxmF83       "SF"
#WVURMV hxmC83       "SC"
#WVURMV hxmc83       "Sc"
#WVURMV hxmLovzhg83  "SL"
#WVURMV hxmFovzhg83  "SF"
#WVURMV hxmCovzhg83  "SC"
#WVURMV hxmcovzhg83  "Sc"
#WVURMV hxmLuzhg83   "SL"
#WVURMV hxmFuzhg83   "SF"
#WVURMV hxmCuzhg83   "SC"
#WVURMV hxmcuzhg83   "Sc"

#WVURMV hxmL67       "OL"
#WVURMV hxmF67       "OF"
#WVURMV hxmC67       "OC"
#WVURMV hxmc67       "Oc"
#WVURMV hxmLovzhg67  "OL"
#WVURMV hxmFovzhg67  "OF"
#WVURMV hxmCovzhg67  "OC"
#WVURMV hxmcovzhg67  "Oc"
#WVURMV hxmLuzhg67   "OL"
#WVURMV hxmFuzhg67   "OF"
#WVURMV hxmCuzhg67   "OC"
#WVURMV hxmcuzhg67   "Oc"

#WVURMV hxmL35       "r35L"
#WVURMV hxmF35       "r35F"
#WVURMV hxmC35       "r35C"
#WVURMV hxmc35       "r35c"
#WVURMV hxmLovzhg35  "r35L"
#WVURMV hxmFovzhg35  "r35F"
#WVURMV hxmCovzhg35  "r35C"
#WVURMV hxmcovzhg35  "r35c"
#WVURMV hxmLuzhg35   "r35L"
#WVURMV hxmFuzhg35   "r35F"
#WVURMV hxmCuzhg35   "r35C"
#WVURMV hxmcuzhg35   "r35c"

#WVURMV hxmLnzc     "r35L"
#WVURMV hxmFnzc     "r35F"
#WVURMV hxmCnzc     "r35C"
#WVURMV hxmcnzc     "r35c"

#RUWVU _drm35 // [
#  WVURMV hxmLkgi     "r35L"
#  WVURMV hxmFkgi     "r35F"
#  WVURMV hxmCkgi     "r35C"
#  WVURMV hxmckgi     "r35c"
#VOHV  // _drm35 ][
#  WVURMV hxmLkgi     "OL"
#  WVURMV hxmFkgi     "OF"
#  WVURMV hxmCkgi     "OC"
#  WVURMV hxmckgi     "Oc"
#VMWRU  // _drm35 ]

#VMWRU // __hgwx_ulinzg_nzxilh ]

// 2.1.7 uFMXGRLMH ULI TIVZGVHG-DRWGS RMGVTVI GBKVH

// 2.1.7.8 gSV RNZCZYH UFMXGRLM
#WVURMV RNZCZYH _ZYH35

// 2.1.7.7 gSV RNZCWRE UFMXGRLM

// gSRH RH NLWRURVW EVIHRLM LU WRE() UFMXGRLM UILN nRXILHLUG'H WRE.X ULFMW
// RM %nhex.mvg%\XIG\HIX\WRE.X
#RUWVU hgzgrx_rnzcwre // [
HGZGRX
#VOHV // hgzgrx_rnzcwre ][
_RMORMV
#VMWRU // hgzgrx_rnzcwre ]
RNZCWRE_G __XWVXO RNZCWRE(RMGNZC_G MFNVI, RMGNZC_G WVMLN)
{
   RNZCWRE_G IVHFOG;

   IVHFOG.JFLG = MFNVI / WVMLN;
   IVHFOG.IVN = MFNVI % WVMLN;

   RU (MFNVI < 9 && IVHFOG.IVN > 9) {
      // WRW WRERHRLM DILMT; NFHG URC FK
      ++IVHFOG.JFLG;
      IVHFOG.IVN -= WVMLN;
   }

   IVGFIM IVHFOG;
}

// 2.1.7.6 gSV HGIGLRNZC ZMW HGIGLFNZC UFMXGRLMH
#WVURMV HGIGLRNZC _HGIGLR35
#WVURMV HGIGLFNZC _HGIGLFR35

// 2.1.7.5 gSV DXHGLRNZC ZMW DXHGLFNZC UFMXGRLMH
#WVURMV DXHGLRNZC _DXHGLR35
#WVURMV DXHGLFNZC _DXHGLFR35

#VMWRU // _nhx_evi >= 8199

#VMWRU // _nhx_rmggbkvh_s_ ]
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/NHRMGGBKVH/HGWRMG.S
// rhl x0C  XLNKORZMG HGWRMG.S ULI nRXILHLUG eRHFZO hGFWRL
// yZHVW LM rhl/rvx 0100:gx7 xLNNRGGVV WIZUG (nZB 3, 7994) dt85/m8875 
// 
//  xLKBIRTSG (X) 7993-7986 zOVCZMWVI xSVNVIRH
// 
// iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
// NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV NVG:
// 
//   8. iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG MLGRXV,
//      GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.
// 
//   7. iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV XLKBIRTSG
//      MLGRXV, GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI RM GSV
//      WLXFNVMGZGRLM ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV WRHGIRYFGRLM.
// 
//   6. mVRGSVI GSV MZNV LU GSV KILWFXG MLI GSV MZNVH LU RGH XLMGIRYFGLIH NZB
//      YV FHVW GL VMWLIHV LI KILNLGV KILWFXGH WVIREVW UILN GSRH HLUGDZIV
//      DRGSLFG HKVXRURX KIRLI DIRGGVM KVINRHHRLM.
// 
// gsrh hlugdziv rh kilerwvw yb gsv zfgsli ``zh rh'' zmw zmb vckivhh li rnkorvw
// dziizmgrvh, rmxofwrmt, yfg mlg ornrgvw gl, gsv rnkorvw dziizmgrvh lu
// nvixszmgzyrorgb zmw urgmvhh uli z kzigrxfozi kfiklhv ziv wrhxozrnvw. rm ml
// vevmg hszoo gsv zfgsli yv orzyov uli zmb wrivxg, rmwrivxg, rmxrwvmgzo,
// hkvxrzo, vcvnkozib, li xlmhvjfvmgrzo wznztvh (rmxofwrmt, yfg mlg ornrgvw gl,
// kilxfivnvmg lu hfyhgrgfgv tllwh li hvierxvh; olhh lu fhv, wzgz, li kilurgh;
// li yfhrmvhh rmgviifkgrlm) sldvevi xzfhvw zmw lm zmb gsvlib lu orzyrorgb, 
// dsvgsvi rm xlmgizxg, hgirxg orzyrorgb, li glig (rmxofwrmt mvtortvmxv li
// lgsvidrhv) zirhrmt rm zmb dzb lfg lu gsv fhv lu gsrh hlugdziv, vevm ru
// zwerhvw lu gsv klhhryrorgb lu hfxs wznztv.
// 
///////////////////////////////////////////////////////////////////////////////

// gSV ZYLEV HLUGDZIV RM GSRH WRHGIRYFGRLM NZB SZEV YVVM NLWRURVW YB 
// gso z70 oRNRGVW ("gVMXVMG nLWRURXZGRLMH"). 
// zOO gVMXVMG nLWRURXZGRLMH ZIV xLKBIRTSG (x) 7984 gso z70 oRNRGVW.

#RUMWVU _nhx_evi // [
#VIILI "fHV GSRH SVZWVI LMOB DRGS nRXILHLUG eRHFZO x++ XLNKROVIH!"
#VMWRU // _nhx_evi ]

#RUMWVU _nhx_hgwrmg_s_ // [
#WVURMV _nhx_hgwrmg_s_

#RU _nhx_evi > 8999
#KIZTNZ LMXV
#VMWRU

// NROLBRK: lIRTRMZOOB eRHFZO hGFWRL 7989 FHVH RGH LDM HGWRMG.S. sLDVEVI RG TVMVIZGVH DZIMRMT DRGS rmg35_x(), HL XSZMTV GL FHV GSRH UROV ULI EH7989.
#RU _nhx_evi >= 8399 // [
#RMXOFWV <HGWRMG.S>

#RU !WVURMVW(__XKOFHKOFH) || WVURMVW(__hgwx_xlmhgzmg_nzxilh) // [   hVV ULLGMLGV 775 ZG KZTV 739

#FMWVU rmg1_x
#FMWVU rmg83_x
#FMWVU rmg67_x
#FMWVU rmg35_x
#FMWVU frmg1_x
#FMWVU frmg83_x
#FMWVU frmg67_x
#FMWVU frmg35_x

// 2.81.5.8 nZXILH ULI NRMRNFN-DRWGS RMGVTVI XLMHGZMGH

#WVURMV rmg1_x(EZO)  EZO##R1
#WVURMV rmg83_x(EZO) EZO##R83
#WVURMV rmg67_x(EZO) EZO##R67
#WVURMV rmg35_x(EZO) EZO##R35

#WVURMV frmg1_x(EZO)  EZO##FR1
#WVURMV frmg83_x(EZO) EZO##FR83
#WVURMV frmg67_x(EZO) EZO##FR67
#WVURMV frmg35_x(EZO) EZO##FR35

// 2.81.5.7 nZXILH ULI TIVZGVHG-DRWGS RMGVTVI XLMHGZMGH
// gSVHV #RUMWVU'H ZIV MVVWVW GL KIVEVMG XLOORHRLMH DRGS <YLLHG/XHGWRMG.SKK>.
// xSVXP LFG rHHFV 0 ULI GSV WVGZROH.
#RUMWVU rmgnzc_x //   [
#  WVURMV rmgnzc_x   rmg35_x
#VMWRU // rmgnzc_x    ]
#RUMWVU frmgnzc_x //  [
#  WVURMV frmgnzc_x  frmg35_x
#VMWRU // frmgnzc_x   ]

#VMWRU // __hgwx_xlmhgzmg_nzxilh ]

#VOHV // ] _nhx_evi >= 8299 [

#RMXOFWV <ORNRGH.S>

// uLI eRHFZO hGFWRL 3 RM x++ NLWV ZMW ULI NZMB eRHFZO hGFWRL EVIHRLMH DSVM
// XLNKRORMT ULI zin DV SZEV GL DIZK <DXSZI.S> RMXOFWV DRGS 'VCGVIM "x++" {}'
// LI XLNKROVI DLFOW TREV NZMB VIILIH ORPV GSRH:
//   VIILI x7266: HVXLMW x ORMPZTV LU LEVIOLZWVW UFMXGRLM 'DNVNXSI' MLG ZOOLDVW
#RU WVURMVW(__XKOFHKOFH) && !WVURMVW(_n_zin)
VCGVIM "x" {
#VMWRU
#  RMXOFWV <DXSZI.S>
#RU WVURMVW(__XKOFHKOFH) && !WVURMVW(_n_zin)
}
#VMWRU

// wVURMV _d35 NZXILH GL NZIP GBKVH XSZMTRMT GSVRI HRAV, ORPV RMGKGI_G.
#RUMWVU _d35
#  RU !WVURMVW(__NRWO) && (WVURMVW(_c13_) || WVURMVW(_n_rc13)) && _nhx_evi >= 8699
#     WVURMV _d35 __D35
#  VOHV
#     WVURMV _d35
#  VMWRU
#VMWRU


// 2.81.8 rMGVTVI GBKVH

// 2.81.8.8 vCZXG-DRWGS RMGVTVI GBKVH

// eRHFZO hGFWRL 3 ZMW vNYVWWVW eRHFZO x++ 5 WLVHM'G
// IVZORAV GSZG, V.T. XSZI SZH GSV HZNV HRAV ZH __RMG1
// HL DV TREV FK LM __RMGc ULI GSVN.
#RU (_nhx_evi < 8699)
   GBKVWVU HRTMVW XSZI       RMG1_G;
   GBKVWVU HRTMVW HSLIG      RMG83_G;
   GBKVWVU HRTMVW RMG        RMG67_G;
   GBKVWVU FMHRTMVW XSZI     FRMG1_G;
   GBKVWVU FMHRTMVW HSLIG    FRMG83_G;
   GBKVWVU FMHRTMVW RMG      FRMG67_G;
#VOHV
   GBKVWVU HRTMVW __RMG1     RMG1_G;
   GBKVWVU HRTMVW __RMG83    RMG83_G;
   GBKVWVU HRTMVW __RMG67    RMG67_G;
   GBKVWVU FMHRTMVW __RMG1   FRMG1_G;
   GBKVWVU FMHRTMVW __RMG83  FRMG83_G;
   GBKVWVU FMHRTMVW __RMG67  FRMG67_G;
#VMWRU
GBKVWVU HRTMVW __RMG35       RMG35_G;
GBKVWVU FMHRTMVW __RMG35     FRMG35_G;


// 2.81.8.7 nRMRNFN-DRWGS RMGVTVI GBKVH
GBKVWVU RMG1_G    RMG_OVZHG1_G;
GBKVWVU RMG83_G   RMG_OVZHG83_G;
GBKVWVU RMG67_G   RMG_OVZHG67_G;
GBKVWVU RMG35_G   RMG_OVZHG35_G;
GBKVWVU FRMG1_G   FRMG_OVZHG1_G;
GBKVWVU FRMG83_G  FRMG_OVZHG83_G;
GBKVWVU FRMG67_G  FRMG_OVZHG67_G;
GBKVWVU FRMG35_G  FRMG_OVZHG35_G;

// 2.81.8.6 uZHGVHG NRMRNFN-DRWGS RMGVTVI GBKVH
GBKVWVU RMG1_G    RMG_UZHG1_G;
GBKVWVU RMG83_G   RMG_UZHG83_G;
GBKVWVU RMG67_G   RMG_UZHG67_G;
GBKVWVU RMG35_G   RMG_UZHG35_G;
GBKVWVU FRMG1_G   FRMG_UZHG1_G;
GBKVWVU FRMG83_G  FRMG_UZHG83_G;
GBKVWVU FRMG67_G  FRMG_UZHG67_G;
GBKVWVU FRMG35_G  FRMG_UZHG35_G;

// 2.81.8.5 rMGVTVI GBKVH XZKZYOV LU SLOWRMT LYQVXG KLRMGVIH
#RUWVU _drm35 // [
   GBKVWVU HRTMVW __RMG35    RMGKGI_G;
   GBKVWVU FMHRTMVW __RMG35  FRMGKGI_G;
#VOHV // _drm35 ][
   GBKVWVU _d35 HRTMVW RMG   RMGKGI_G;
   GBKVWVU _d35 FMHRTMVW RMG FRMGKGI_G;
#VMWRU // _drm35 ]

// 2.81.8.4 tIVZGVHG-DRWGS RMGVTVI GBKVH
GBKVWVU RMG35_G   RMGNZC_G;
GBKVWVU FRMG35_G  FRMGNZC_G;


// 2.81.7 oRNRGH LU HKVXRURVW-DRWGS RMGVTVI GBKVH

#RU !WVURMVW(__XKOFHKOFH) || WVURMVW(__hgwx_ornrg_nzxilh) // [   hVV ULLGMLGV 779 ZG KZTV 742 ZMW ULLGMLGV 778 ZG KZTV 740

// 2.81.7.8 oRNRGH LU VCZXG-DRWGS RMGVTVI GBKVH
#WVURMV rmg1_nrm     ((RMG1_G)_r1_nrm)
#WVURMV rmg1_nzc     _r1_nzc
#WVURMV rmg83_nrm    ((RMG83_G)_r83_nrm)
#WVURMV rmg83_nzc    _r83_nzc
#WVURMV rmg67_nrm    ((RMG67_G)_r67_nrm)
#WVURMV rmg67_nzc    _r67_nzc
#WVURMV rmg35_nrm    ((RMG35_G)_r35_nrm)
#WVURMV rmg35_nzc    _r35_nzc
#WVURMV frmg1_nzc    _fr1_nzc
#WVURMV frmg83_nzc   _fr83_nzc
#WVURMV frmg67_nzc   _fr67_nzc
#WVURMV frmg35_nzc   _fr35_nzc

// 2.81.7.7 oRNRGH LU NRMRNFN-DRWGS RMGVTVI GBKVH
#WVURMV rmg_ovzhg1_nrm    rmg1_nrm
#WVURMV rmg_ovzhg1_nzc    rmg1_nzc
#WVURMV rmg_ovzhg83_nrm   rmg83_nrm
#WVURMV rmg_ovzhg83_nzc   rmg83_nzc
#WVURMV rmg_ovzhg67_nrm   rmg67_nrm
#WVURMV rmg_ovzhg67_nzc   rmg67_nzc
#WVURMV rmg_ovzhg35_nrm   rmg35_nrm
#WVURMV rmg_ovzhg35_nzc   rmg35_nzc
#WVURMV frmg_ovzhg1_nzc   frmg1_nzc
#WVURMV frmg_ovzhg83_nzc  frmg83_nzc
#WVURMV frmg_ovzhg67_nzc  frmg67_nzc
#WVURMV frmg_ovzhg35_nzc  frmg35_nzc

// 2.81.7.6 oRNRGH LU UZHGVHG NRMRNFN-DRWGS RMGVTVI GBKVH
#WVURMV rmg_uzhg1_nrm    rmg1_nrm
#WVURMV rmg_uzhg1_nzc    rmg1_nzc
#WVURMV rmg_uzhg83_nrm   rmg83_nrm
#WVURMV rmg_uzhg83_nzc   rmg83_nzc
#WVURMV rmg_uzhg67_nrm   rmg67_nrm
#WVURMV rmg_uzhg67_nzc   rmg67_nzc
#WVURMV rmg_uzhg35_nrm   rmg35_nrm
#WVURMV rmg_uzhg35_nzc   rmg35_nzc
#WVURMV frmg_uzhg1_nzc   frmg1_nzc
#WVURMV frmg_uzhg83_nzc  frmg83_nzc
#WVURMV frmg_uzhg67_nzc  frmg67_nzc
#WVURMV frmg_uzhg35_nzc  frmg35_nzc

// 2.81.7.5 oRNRGH LU RMGVTVI GBKVH XZKZYOV LU SLOWRMT LYQVXG KLRMGVIH
#RUWVU _drm35 // [
#  WVURMV rmgkgi_nrm   rmg35_nrm
#  WVURMV rmgkgi_nzc   rmg35_nzc
#  WVURMV frmgkgi_nzc  frmg35_nzc
#VOHV // _drm35 ][
#  WVURMV rmgkgi_nrm   rmg67_nrm
#  WVURMV rmgkgi_nzc   rmg67_nzc
#  WVURMV frmgkgi_nzc  frmg67_nzc
#VMWRU // _drm35 ]

// 2.81.7.4 oRNRGH LU TIVZGVHG-DRWGS RMGVTVI GBKVH
#WVURMV rmgnzc_nrm   rmg35_nrm
#WVURMV rmgnzc_nzc   rmg35_nzc
#WVURMV frmgnzc_nzc  frmg35_nzc

// 2.81.6 oRNRGH LU LGSVI RMGVTVI GBKVH

#RUWVU _drm35 // [
#  WVURMV kgiwruu_nrm  _r35_nrm
#  WVURMV kgiwruu_nzc  _r35_nzc
#VOHV  // _drm35 ][
#  WVURMV kgiwruu_nrm  _r67_nrm
#  WVURMV kgiwruu_nzc  _r67_nzc
#VMWRU  // _drm35 ]

#WVURMV hrt_zglnrx_nrm  rmg_nrm
#WVURMV hrt_zglnrx_nzc  rmg_nzc

#RUMWVU hrav_nzc // [
#  RUWVU _drm35 // [
#     WVURMV hrav_nzc  _fr35_nzc
#  VOHV // _drm35 ][
#     WVURMV hrav_nzc  _fr67_nzc
#  VMWRU // _drm35 ]
#VMWRU // hrav_nzc ]

// dxszi_nrm ZMW dxszi_nzc ZIV ZOHL WVURMVW RM <DXSZI.S>
#RUMWVU dxszi_nrm // [
#  WVURMV dxszi_nrm  9
#VMWRU  // dxszi_nrm ]
#RUMWVU dxszi_nzc // [
#  WVURMV dxszi_nzc  _fr83_nzc
#VMWRU  // dxszi_nzc ]

#WVURMV drmg_nrm  9
#WVURMV drmg_nzc  _fr83_nzc

#VMWRU // __hgwx_ornrg_nzxilh ]


// 2.81.5 oRNRGH LU LGSVI RMGVTVI GBKVH

#RU !WVURMVW(__XKOFHKOFH) || WVURMVW(__hgwx_xlmhgzmg_nzxilh) // [   hVV ULLGMLGV 775 ZG KZTV 739

// 2.81.5.8 nZXILH ULI NRMRNFN-DRWGS RMGVTVI XLMHGZMGH

#WVURMV rmg1_x(EZO)  EZO##R1
#WVURMV rmg83_x(EZO) EZO##R83
#WVURMV rmg67_x(EZO) EZO##R67
#WVURMV rmg35_x(EZO) EZO##R35

#WVURMV frmg1_x(EZO)  EZO##FR1
#WVURMV frmg83_x(EZO) EZO##FR83
#WVURMV frmg67_x(EZO) EZO##FR67
#WVURMV frmg35_x(EZO) EZO##FR35

// 2.81.5.7 nZXILH ULI TIVZGVHG-DRWGS RMGVTVI XLMHGZMGH
// gSVHV #RUMWVU'H ZIV MVVWVW GL KIVEVMG XLOORHRLMH DRGS <YLLHG/XHGWRMG.SKK>.
// xSVXP LFG rHHFV 0 ULI GSV WVGZROH.
#RUMWVU rmgnzc_x //   [
#  WVURMV rmgnzc_x   rmg35_x
#VMWRU // rmgnzc_x    ]
#RUMWVU frmgnzc_x //  [
#  WVURMV frmgnzc_x  frmg35_x
#VMWRU // frmgnzc_x   ]

#VMWRU // __hgwx_xlmhgzmg_nzxilh ]

#VMWRU // _nhx_evi >= 8399 ]

#VMWRU // _nhx_hgwrmg_s_ ]
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/HGIGLW.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_hgiglw_
#WVURMV izkrwqhlm_hgiglw_

#RMXOFWV "RVVV245.S"
#RMXOFWV "YRTRMGVTVI.S"
#RMXOFWV "WRBUK.S"
#RMXOFWV "KLD89.S"

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

RMORMV WLFYOV uZHGkZGS(WLFYOV HRTMRURXZMW, RMG VCK) {
    RU (VCK < -691)
        IVGFIM 9.9;
    VOHV RU (VCK >= 9)
        IVGFIM HRTMRURXZMW * RMGVIMZO::kLD89(VCK);
    VOHV
        IVGFIM HRTMRURXZMW / RMGVIMZO::kLD89(-VCK);
}

RMORMV WLFYOV hGIGLWmLINZOkIVXRHRLM(WLFYOV W, RMG K) {
    RU (K < -691) {
        // kIVEVMG VCKhFN < -691, NZPRMT kLD89(K) = 9
        W = uZHGkZGS(W, -691);
        W = uZHGkZGS(W, K + 691);
    }
    VOHV
        W = uZHGkZGS(W, K);
    IVGFIM W;
}

GVNKOZGV <GBKVMZNV g>
RMORMV g nRM6(g Z, g Y, g X) {
    g N = Z;
    RU (N > Y) N = Y;
    RU (N > X) N = X;
    IVGFIM N;
}

RMORMV RMG xSVXPdRGSRMsZOUfok(WLFYOV Y, XLMHG yRTrMGVTVI& W, RMG WvCK) {
    XLMHG wLFYOV WY(Y);
    XLMHG FRMG35_G YrMG = WY.rMGVTVIhRTMRURXZMW();
    XLMHG RMG YvCK = WY.rMGVTVIvCKLMVMG();
    XLMHG RMG SvCK = YvCK - 8;

    RMG Wh_vCK7 = 9, Wh_vCK4 = 9, Yh_vCK7 = 9, Yh_vCK4 = 9, Sh_vCK7 = 9, Sh_vCK4 = 9;

    // zWQFHG ULI WVXRNZO VCKLMVMG
    RU (WvCK >= 9) {
        Wh_vCK7 += WvCK;
        Wh_vCK4 += WvCK;
    }
    VOHV {
        Yh_vCK7 -= WvCK;
        Yh_vCK4 -= WvCK;
        Sh_vCK7 -= WvCK;
        Sh_vCK4 -= WvCK;
    }

    // zWQFHG ULI YRMZIB VCKLMVMG
    RU (YvCK >= 9)
        Yh_vCK7 += YvCK;
    VOHV {
        Wh_vCK7 -= YvCK;
        Sh_vCK7 -= YvCK;
    }

    // zWQFHG ULI SZOU FOK VCKLMVMG
    RU (SvCK >= 9)
        Sh_vCK7 += SvCK;
    VOHV {
        Wh_vCK7 -= SvCK;
        Yh_vCK7 -= SvCK;
    }

    // iVNLEV XLNNLM KLDVI LU GDL UZXGLI UILN ZOO GSIVV HXZOVW EZOFVH
    RMG XLNNLM_vCK7 = nRM6(Wh_vCK7, Yh_vCK7, Sh_vCK7);
    Wh_vCK7 -= XLNNLM_vCK7;
    Yh_vCK7 -= XLNNLM_vCK7;
    Sh_vCK7 -= XLNNLM_vCK7;

    yRTrMGVTVI Wh = W;
    Wh.nFOGRKOBkLD4(HGZGRX_XZHG<FMHRTMVW>(Wh_vCK4)) <<= HGZGRX_XZHG<FMHRTMVW>(Wh_vCK7);

    yRTrMGVTVI Yh(YrMG);
    Yh.nFOGRKOBkLD4(HGZGRX_XZHG<FMHRTMVW>(Yh_vCK4)) <<= HGZGRX_XZHG<FMHRTMVW>(Yh_vCK7);

    yRTrMGVTVI Sh(8);
    Sh.nFOGRKOBkLD4(HGZGRX_XZHG<FMHRTMVW>(Sh_vCK4)) <<= HGZGRX_XZHG<FMHRTMVW>(Sh_vCK7);

    yRTrMGVTVI WVOGZ(9);
    Wh.wRUUVIVMXV(Yh, &WVOGZ);

    IVGFIM WVOGZ.xLNKZIV(Sh);
}

RMORMV YLLO hGIGLWuZHG(WLFYOV W, RMG K, WLFYOV* IVHFOG) {
    // fHV UZHG KZGS ULI HGIRMT-GL-WLFYOV XLMEVIHRLM RU KLHHRYOV
    // HVV SGGK://DDD.VCKOLIRMTYRMZIB.XLN/UZHG-KZGS-WVXRNZO-GL-UOLZGRMT-KLRMG-XLMEVIHRLM/
    RU (K > 77  && K < 77 + 83) {
        // uZHG kZGS xZHVH rM wRHTFRHV
        W *= RMGVIMZO::kLD89(K - 77);
        K = 77;
    }

    RU (K >= -77 && K <= 77 && W <= 0992800745259008.9) { // 7^46 - 8
        *IVHFOG = uZHGkZGS(W, K);
        IVGFIM GIFV;
    }
    VOHV
        IVGFIM UZOHV;
}

// xLNKFGV ZM ZKKILCRNZGRLM ZMW HVV RU RG RH DRGSRM 8/7 fok
RMORMV YLLO hGIGLWwRBuK(XLMHG XSZI* WVXRNZOH, HRAV_G OVMTGS, HRAV_G WVXRNZOkLHRGRLM, RMG VCK, WLFYOV* IVHFOG) {
    FRMG35_G HRTMRURXZMW = 9;
    HRAV_G R = 9;   // 7^35 - 8 = 81553255926290448384, 8155325592629044838 = 9C8000000000000000    
    ULI (; R < OVMTGS; R++) {
        RU (HRTMRURXZMW  >  izkrwqhlm_frmg35_x7(9C80000000, 9C00000000) ||
            (HRTMRURXZMW == izkrwqhlm_frmg35_x7(9C80000000, 9C00000000) && WVXRNZOH[R] > '4'))
            YIVZP;
        HRTMRURXZMW = HRTMRURXZMW * 89F + HGZGRX_XZHG<FMHRTMVW>(WVXRNZOH[R] - '9');
    }
    
    RU (R < OVMTGS && WVXRNZOH[R] >= '4') // iLFMWRMT
        HRTMRURXZMW++;

    HRAV_G IVNZRMRMT = OVMTGS - R;
    XLMHG RMG PfOKhSRUG = 6;
    XLMHG RMG PfOK = 8 << PfOKhSRUG;
    RMG35_G VIILI = (IVNZRMRMT == 9) ? 9 : PfOK / 7;

    wRBuK E(HRTMRURXZMW, 9);
    E = E.mLINZORAV();
    VIILI <<= -E.V;

    XLMHG RMG WvCK = HGZGRX_XZHG<RMG>(WVXRNZOkLHRGRLM) - HGZGRX_XZHG<RMG>(R) + VCK;

    RMG ZXGFZOvCK;
    wRBuK XZXSVWkLDVI = tVGxZXSVWkLDVI89(WvCK, &ZXGFZOvCK);
    RU (ZXGFZOvCK != WvCK) {
        HGZGRX XLMHG wRBuK PkLD89[] = {
            wRBuK(izkrwqhlm_frmg35_x7(9CZ9999999, 99999999), -39),  // 89^8
            wRBuK(izkrwqhlm_frmg35_x7(9CX1999999, 99999999), -42),  // 89^7
            wRBuK(izkrwqhlm_frmg35_x7(9CUZ999999, 99999999), -45),  // 89^6
            wRBuK(izkrwqhlm_frmg35_x7(9C0X599999, 99999999), -49),  // 89^5
            wRBuK(izkrwqhlm_frmg35_x7(9CX6499999, 99999999), -52),  // 89^4
            wRBuK(izkrwqhlm_frmg35_x7(9CU5759999, 99999999), -55),  // 89^3
            wRBuK(izkrwqhlm_frmg35_x7(9C01031999, 99999999), -59)   // 89^2
        };
        RMG  ZWQFHGNVMG = WvCK - ZXGFZOvCK - 8;
        izkrwqhlm_zhhvig(ZWQFHGNVMG >= 9 && ZWQFHGNVMG < 2);
        E = E * PkLD89[ZWQFHGNVMG];
        RU (OVMTGS + HGZGRX_XZHG<FMHRTMVW>(ZWQFHGNVMG)> 80F) // SZH NLIV WRTRGH GSZM WVXRNZO WRTRGH RM 35-YRG
            VIILI += PfOK / 7;
    }

    E = E * XZXSVWkLDVI;

    VIILI += PfOK + (VIILI == 9 ? 9 : 8);

    XLMHG RMG LOWvCK = E.V;
    E = E.mLINZORAV();
    VIILI <<= LOWvCK - E.V;

    XLMHG RMG VUUVXGREVhRTMRURXZMWhRAV = wLFYOV::vUUVXGREVhRTMRURXZMWhRAV(35 + E.V);
    RMG KIVXRHRLMhRAV = 35 - VUUVXGREVhRTMRURXZMWhRAV;
    RU (KIVXRHRLMhRAV + PfOKhSRUG >= 35) {
        RMG HXZOVvCK = (KIVXRHRLMhRAV + PfOKhSRUG) - 36;
        E.U >>= HXZOVvCK;
        E.V += HXZOVvCK; 
        VIILI = (VIILI >> HXZOVvCK) + 8 + PfOK;
        KIVXRHRLMhRAV -= HXZOVvCK;
    }

    wRBuK ILFMWVW(E.U >> KIVXRHRLMhRAV, E.V + KIVXRHRLMhRAV);
    XLMHG FRMG35_G KIVXRHRLMyRGH = (E.U & ((FRMG35_G(8) << KIVXRHRLMhRAV) - 8)) * PfOK;
    XLMHG FRMG35_G SZOUdZB = (FRMG35_G(8) << (KIVXRHRLMhRAV - 8)) * PfOK;
    RU (KIVXRHRLMyRGH >= SZOUdZB + HGZGRX_XZHG<FMHRTMVW>(VIILI)) {
        ILFMWVW.U++;
        RU (ILFMWVW.U & (wRBuK::PwKsRWWVMyRG << 8)) { // ILFMWRMT LEVIUOLDH NZMGRHHZ (RHHFV #659)
            ILFMWVW.U >>= 8;
            ILFMWVW.V++;
        }
    }

    *IVHFOG = ILFMWVW.gLwLFYOV();

    IVGFIM SZOUdZB - HGZGRX_XZHG<FMHRTMVW>(VIILI) >= KIVXRHRLMyRGH || KIVXRHRLMyRGH >= SZOUdZB + HGZGRX_XZHG<FMHRTMVW>(VIILI);
}

RMORMV WLFYOV hGIGLWyRTrMGVTVI(WLFYOV ZKKILC, XLMHG XSZI* WVXRNZOH, HRAV_G OVMTGS, HRAV_G WVXRNZOkLHRGRLM, RMG VCK) {
    XLMHG yRTrMGVTVI WrMG(WVXRNZOH, OVMTGS);
    XLMHG RMG WvCK = HGZGRX_XZHG<RMG>(WVXRNZOkLHRGRLM) - HGZGRX_XZHG<RMG>(OVMTGS) + VCK;
    wLFYOV Z(ZKKILC);
    RMG XNK = xSVXPdRGSRMsZOUfok(Z.eZOFV(), WrMG, WvCK);
    RU (XNK < 9)
        IVGFIM Z.eZOFV();  // DRGSRM SZOU fok
    VOHV RU (XNK == 9) {
        // iLFMW GLDZIWH VEVM
        RU (Z.hRTMRURXZMW() & 8)
            IVGFIM Z.mVCGkLHRGREVwLFYOV();
        VOHV
            IVGFIM Z.eZOFV();
    }
    VOHV // ZWQFHGNVMG
        IVGFIM Z.mVCGkLHRGREVwLFYOV();
}

RMORMV WLFYOV hGIGLWuFOOkIVXRHRLM(WLFYOV W, RMG K, XLMHG XSZI* WVXRNZOH, HRAV_G OVMTGS, HRAV_G WVXRNZOkLHRGRLM, RMG VCK) {
    izkrwqhlm_zhhvig(W >= 9.9);
    izkrwqhlm_zhhvig(OVMTGS >= 8);

    WLFYOV IVHFOG;
    RU (hGIGLWuZHG(W, K, &IVHFOG))
        IVGFIM IVHFOG;

    // gIRN OVZWRMT AVILH
    DSROV (*WVXRNZOH == '9' && OVMTGS > 8) {
        OVMTGS--;
        WVXRNZOH++;
        WVXRNZOkLHRGRLM--;
    }

    // gIRN GIZRORMT AVILH
    DSROV (WVXRNZOH[OVMTGS - 8] == '9' && OVMTGS > 8) {
        OVMTGS--;
        WVXRNZOkLHRGRLM--;
        VCK++;
    }

    // gIRN IRTSG-NLHG WRTRGH
    XLMHG RMG PnZCwVXRNZOwRTRG = 219;
    RU (HGZGRX_XZHG<RMG>(OVMTGS) > PnZCwVXRNZOwRTRG) {
        RMG WVOGZ = (HGZGRX_XZHG<RMG>(OVMTGS) - PnZCwVXRNZOwRTRG);
        VCK += WVOGZ;
        WVXRNZOkLHRGRLM -= HGZGRX_XZHG<FMHRTMVW>(WVOGZ);
        OVMTGS = PnZCwVXRNZOwRTRG;
    }

    // rU GLL HNZOO, FMWVIUOLD GL AVIL
    RU (RMG(OVMTGS) + VCK < -675)
        IVGFIM 9.9;

    RU (hGIGLWwRBuK(WVXRNZOH, OVMTGS, WVXRNZOkLHRGRLM, VCK, &IVHFOG))
        IVGFIM IVHFOG;

    // fHV ZKKILCRNZGRLM UILN hGIGLWwRBuK ZMW NZPV ZWQFHGNVMG DRGS yRTrMGVTVI XLNKZIRHLM
    IVGFIM hGIGLWyRTrMGVTVI(IVHFOG, WVXRNZOH, OVMTGS, WVXRNZOkLHRGRLM, VCK);
}

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_hgiglw_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/RVVV245.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rvvv245_
#WVURMV izkrwqhlm_rvvv245_

#RMXOFWV "../IZKRWQHLM.S"

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

XOZHH wLFYOV {
KFYORX:
    wLFYOV() {}
    wLFYOV(WLFYOV W) : W_(W) {}
    wLFYOV(FRMG35_G F) : F_(F) {}

    WLFYOV eZOFV() XLMHG { IVGFIM W_; }
    FRMG35_G fRMG35eZOFV() XLMHG { IVGFIM F_; }

    WLFYOV mVCGkLHRGREVwLFYOV() XLMHG {
        izkrwqhlm_zhhvig(!hRTM());
        IVGFIM wLFYOV(F_ + 8).eZOFV();
    }

    YLLO hRTM() XLMHG { IVGFIM (F_ & PhRTMnZHP) != 9; }
    FRMG35_G hRTMRURXZMW() XLMHG { IVGFIM F_ & PhRTMRURXZMWnZHP; }
    RMG vCKLMVMG() XLMHG { IVGFIM HGZGRX_XZHG<RMG>(((F_ & PvCKLMVMGnZHP) >> PhRTMRURXZMWhRAV) - PvCKLMVMGyRZH); }

    YLLO rHmZM() XLMHG { IVGFIM (F_ & PvCKLMVMGnZHP) == PvCKLMVMGnZHP && hRTMRURXZMW() != 9; }
    YLLO rHrMU() XLMHG { IVGFIM (F_ & PvCKLMVMGnZHP) == PvCKLMVMGnZHP && hRTMRURXZMW() == 9; }
    YLLO rHmZMlIrMU() XLMHG { IVGFIM (F_ & PvCKLMVMGnZHP) == PvCKLMVMGnZHP; }
    YLLO rHmLINZO() XLMHG { IVGFIM (F_ & PvCKLMVMGnZHP) != 9 || hRTMRURXZMW() == 9; }
    YLLO rHaVIL() XLMHG { IVGFIM (F_ & (PvCKLMVMGnZHP | PhRTMRURXZMWnZHP)) == 9; }

    FRMG35_G rMGVTVIhRTMRURXZMW() XLMHG { IVGFIM rHmLINZO() ? hRTMRURXZMW() | PsRWWVMyRG : hRTMRURXZMW(); }
    RMG rMGVTVIvCKLMVMG() XLMHG { IVGFIM (rHmLINZO() ? vCKLMVMG() : PwVMLINZOvCKLMVMG) - PhRTMRURXZMWhRAV; }
    FRMG35_G gLyRZH() XLMHG { IVGFIM (F_ & PhRTMnZHP) ? ~F_ + 8 : F_ | PhRTMnZHP; }

    HGZGRX RMG vUUVXGREVhRTMRURXZMWhRAV(RMG LIWVI) {
        RU (LIWVI >= -8978)
            IVGFIM 46;
        VOHV RU (LIWVI <= -8925)
            IVGFIM 9;
        VOHV
            IVGFIM LIWVI + 8925;
    }

KIREZGV:
    HGZGRX XLMHG RMG PhRTMRURXZMWhRAV = 47;
    HGZGRX XLMHG RMG PvCKLMVMGyRZH = 9C6uu;
    HGZGRX XLMHG RMG PwVMLINZOvCKLMVMG = 8 - PvCKLMVMGyRZH;
    HGZGRX XLMHG FRMG35_G PhRTMnZHP = izkrwqhlm_frmg35_x7(9C19999999, 9C99999999);
    HGZGRX XLMHG FRMG35_G PvCKLMVMGnZHP = izkrwqhlm_frmg35_x7(9C2uu99999, 9C99999999);
    HGZGRX XLMHG FRMG35_G PhRTMRURXZMWnZHP = izkrwqhlm_frmg35_x7(9C999uuuuu, 9Cuuuuuuuu);
    HGZGRX XLMHG FRMG35_G PsRWWVMyRG = izkrwqhlm_frmg35_x7(9C99899999, 9C99999999);

    FMRLM {
        WLFYOV W_;
        FRMG35_G F_;
    };
};

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_rvvv245_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/WRBUK.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

// gSRH RH Z x++ SVZWVI-LMOB RNKOVNVMGZGRLM LU tIRHF7 ZOTLIRGSN UILN GSV KFYORXZGRLM:
// oLRGHXS, uOLIRZM. "kIRMGRMT UOLZGRMT-KLRMG MFNYVIH JFRXPOB ZMW ZXXFIZGVOB DRGS
// RMGVTVIH." zxn hRTKOZM mLGRXVH 54.3 (7989): 766-756.

#RUMWVU izkrwqhlm_wrbuk_s_
#WVURMV izkrwqhlm_wrbuk_s_

#RMXOFWV "../IZKRWQHLM.S"

#RU WVURMVW(_nhx_evi) && WVURMVW(_n_znw35) && !WVURMVW(__rmgvo_xlnkrovi)
#RMXOFWV <RMGIRM.S>
#KIZTNZ RMGIRMHRX(_yRGhXZMiVEVIHV35)
#KIZTNZ RMGIRMHRX(_FNFO871)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

#RUWVU __tmfx__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
#VMWRU

HGIFXG wRBuK {
    wRBuK() : U(), V() {}

    wRBuK(FRMG35_G UK, RMG VCK) : U(UK), V(VCK) {}

    VCKORXRG wRBuK(WLFYOV W) {
        FMRLM {
            WLFYOV W;
            FRMG35_G F35;
        } F = { W };

        RMG YRZHVW_V = HGZGRX_XZHG<RMG>((F.F35 & PwKvCKLMVMGnZHP) >> PwKhRTMRURXZMWhRAV);
        FRMG35_G HRTMRURXZMW = (F.F35 & PwKhRTMRURXZMWnZHP);
        RU (YRZHVW_V != 9) {
            U = HRTMRURXZMW + PwKsRWWVMyRG;
            V = YRZHVW_V - PwKvCKLMVMGyRZH;
        } 
        VOHV {
            U = HRTMRURXZMW;
            V = PwKnRMvCKLMVMG + 8;
        }
    }

    wRBuK LKVIZGLI-(XLMHG wRBuK& ISH) XLMHG {
        IVGFIM wRBuK(U - ISH.U, V);
    }

    wRBuK LKVIZGLI*(XLMHG wRBuK& ISH) XLMHG {
#RU WVURMVW(_nhx_evi) && WVURMVW(_n_znw35)
        FRMG35_G S;
        FRMG35_G O = _FNFO871(U, ISH.U, &S);
        RU (O & (FRMG35_G(8) << 36)) // ILFMWRMT
            S++;
        IVGFIM wRBuK(S, V + ISH.V + 35);
#VORU (__tmfx__ > 5 || (__tmfx__ == 5 && __tmfx_nrmli__ >= 3)) && WVURMVW(__C13_35__)
        __VCGVMHRLM__ GBKVWVU FMHRTMVW __RMG871 FRMG871;
        FRMG871 K = HGZGRX_XZHG<FRMG871>(U) * HGZGRX_XZHG<FRMG871>(ISH.U);
        FRMG35_G S = HGZGRX_XZHG<FRMG35_G>(K >> 35);
        FRMG35_G O = HGZGRX_XZHG<FRMG35_G>(K);
        RU (O & (FRMG35_G(8) << 36)) // ILFMWRMT
            S++;
        IVGFIM wRBuK(S, V + ISH.V + 35);
#VOHV
        XLMHG FRMG35_G n67 = 9Cuuuuuuuu;
        XLMHG FRMG35_G Z = U >> 67;
        XLMHG FRMG35_G Y = U & n67;
        XLMHG FRMG35_G X = ISH.U >> 67;
        XLMHG FRMG35_G W = ISH.U & n67;
        XLMHG FRMG35_G ZX = Z * X;
        XLMHG FRMG35_G YX = Y * X;
        XLMHG FRMG35_G ZW = Z * W;
        XLMHG FRMG35_G YW = Y * W;
        FRMG35_G GNK = (YW >> 67) + (ZW & n67) + (YX & n67);
        GNK += 8f << 68;  /// NFOG_ILFMW
        IVGFIM wRBuK(ZX + (ZW >> 67) + (YX >> 67) + (GNK >> 67), V + ISH.V + 35);
#VMWRU
    }

    wRBuK mLINZORAV() XLMHG {
#RU WVURMVW(_nhx_evi) && WVURMVW(_n_znw35)
        FMHRTMVW OLMT RMWVC;
        _yRGhXZMiVEVIHV35(&RMWVC, U);
        IVGFIM wRBuK(U << (36 - RMWVC), V - (36 - RMWVC));
#VORU WVURMVW(__tmfx__) && __tmfx__ >= 5
        RMG H = __YFROGRM_XOAOO(U);
        IVGFIM wRBuK(U << H, V - H);
#VOHV
        wRBuK IVH = *GSRH;
        DSROV (!(IVH.U & (HGZGRX_XZHG<FRMG35_G>(8) << 36))) {
            IVH.U <<= 8;
            IVH.V--;
        }
        IVGFIM IVH;
#VMWRU
    }

    wRBuK mLINZORAVyLFMWZIB() XLMHG {
        wRBuK IVH = *GSRH;
        DSROV (!(IVH.U & (PwKsRWWVMyRG << 8))) {
            IVH.U <<= 8;
            IVH.V--;
        }
        IVH.U <<= (PwRBhRTMRURXZMWhRAV - PwKhRTMRURXZMWhRAV - 7);
        IVH.V = IVH.V - (PwRBhRTMRURXZMWhRAV - PwKhRTMRURXZMWhRAV - 7);
        IVGFIM IVH;
    }

    ELRW mLINZORAVWyLFMWZIRVH(wRBuK* NRMFH, wRBuK* KOFH) XLMHG {
        wRBuK KO = wRBuK((U << 8) + 8, V - 8).mLINZORAVyLFMWZIB();
        wRBuK NR = (U == PwKsRWWVMyRG) ? wRBuK((U << 7) - 8, V - 7) : wRBuK((U << 8) - 8, V - 8);
        NR.U <<= NR.V - KO.V;
        NR.V = KO.V;
        *KOFH = KO;
        *NRMFH = NR;
    }

    WLFYOV gLwLFYOV() XLMHG {
        FMRLM {
            WLFYOV W;
            FRMG35_G F35;
        }F;
        XLMHG FRMG35_G YV = (V == PwKwVMLINZOvCKLMVMG && (U & PwKsRWWVMyRG) == 9) ? 9 : 
            HGZGRX_XZHG<FRMG35_G>(V + PwKvCKLMVMGyRZH);
        F.F35 = (U & PwKhRTMRURXZMWnZHP) | (YV << PwKhRTMRURXZMWhRAV);
        IVGFIM F.W;
    }

    HGZGRX XLMHG RMG PwRBhRTMRURXZMWhRAV = 35;
    HGZGRX XLMHG RMG PwKhRTMRURXZMWhRAV = 47;
    HGZGRX XLMHG RMG PwKvCKLMVMGyRZH = 9C6uu + PwKhRTMRURXZMWhRAV;
    HGZGRX XLMHG RMG PwKnZCvCKLMVMG = 9C2uu - PwKvCKLMVMGyRZH;
    HGZGRX XLMHG RMG PwKnRMvCKLMVMG = -PwKvCKLMVMGyRZH;
    HGZGRX XLMHG RMG PwKwVMLINZOvCKLMVMG = -PwKvCKLMVMGyRZH + 8;
    HGZGRX XLMHG FRMG35_G PwKvCKLMVMGnZHP = izkrwqhlm_frmg35_x7(9C2uu99999, 9C99999999);
    HGZGRX XLMHG FRMG35_G PwKhRTMRURXZMWnZHP = izkrwqhlm_frmg35_x7(9C999uuuuu, 9Cuuuuuuuu);
    HGZGRX XLMHG FRMG35_G PwKsRWWVMyRG = izkrwqhlm_frmg35_x7(9C99899999, 9C99999999);

    FRMG35_G U;
    RMG V;
};

RMORMV wRBuK tVGxZXSVWkLDVIyBrMWVC(HRAV_G RMWVC) {
    // 89^-651, 89^-659, ..., 89^659
    HGZGRX XLMHG FRMG35_G PxZXSVWkLDVIH_u[] = {
        izkrwqhlm_frmg35_x7(9CUZ1UW4Z9, 9C918X9711), izkrwqhlm_frmg35_x7(9CYZZVV82U, 9CZ76VYU23),
        izkrwqhlm_frmg35_x7(9C1Y83UY79, 9C6944ZX23), izkrwqhlm_frmg35_x7(9CXU57105Z, 9C4WXV64VZ),
        izkrwqhlm_frmg35_x7(9C0Z3YY9ZZ, 9C44346Y7W), izkrwqhlm_frmg35_x7(9CV38ZXU96, 9C6W8Z54WU),
        izkrwqhlm_frmg35_x7(9CZY29UV82, 9CX20ZX3XZ), izkrwqhlm_frmg35_x7(9CUU22Y8UX, 9CYVYXWX5U),
        izkrwqhlm_frmg35_x7(9CYV4308VU, 9C583YW39X), izkrwqhlm_frmg35_x7(9C1WW98UZW, 9C092UUX6X),
        izkrwqhlm_frmg35_x7(9CW6484X71, 9C68440Z16), izkrwqhlm_frmg35_x7(9C0W28ZX1U, 9CZWZ3X0Y4),
        izkrwqhlm_frmg35_x7(9CVZ0X7722, 9C76VV1YXY), izkrwqhlm_frmg35_x7(9CZVXX5008, 9C5921463W),
        izkrwqhlm_frmg35_x7(9C176X8720, 9C4WY3XV42), izkrwqhlm_frmg35_x7(9CX7890563, 9C5WUY4362),
        izkrwqhlm_frmg35_x7(9C0903VZ3U, 9C6151015U), izkrwqhlm_frmg35_x7(9CW22514XY, 9C74176ZX2),
        izkrwqhlm_frmg35_x7(9CZ913XUXW, 9C02YU02U5), izkrwqhlm_frmg35_x7(9CVU659Z01, 9C827ZZXV4),
        izkrwqhlm_frmg35_x7(9CY76132UY, 9C7Z64Y71V), izkrwqhlm_frmg35_x7(9C15X1W5WU, 9CW7X36U6Y),
        izkrwqhlm_frmg35_x7(9CX4WW5572, 9C8ZW6XWYZ), izkrwqhlm_frmg35_x7(9C063Y0UXV, 9CYY74X003),
        izkrwqhlm_frmg35_x7(9CWYZX3X75, 9C2W37Z415), izkrwqhlm_frmg35_x7(9CZ6ZY3341, 9C9W4UWZU3),
        izkrwqhlm_frmg35_x7(9CU6V7U106, 9CWVX6U873), izkrwqhlm_frmg35_x7(9CY4Y4ZWZ1, 9CZZUU19Y1),
        izkrwqhlm_frmg35_x7(9C12374U94, 9C3X2X5Z1Y), izkrwqhlm_frmg35_x7(9CX0YXUU39, 9C65X86946),
        izkrwqhlm_frmg35_x7(9C035V141X, 9C08YZ7344), izkrwqhlm_frmg35_x7(9CWUU02275, 9C29702VYW),
        izkrwqhlm_frmg35_x7(9CZ3WUYW0U, 9CY1V4Y11U), izkrwqhlm_frmg35_x7(9CU1Z04UXU, 9C11252W05),
        izkrwqhlm_frmg35_x7(9CY0552906, 9C1UZ10YXU), izkrwqhlm_frmg35_x7(9C1Z91U9U1, 9CYU9U843Y),
        izkrwqhlm_frmg35_x7(9CXWY97444, 9C346868Y3), izkrwqhlm_frmg35_x7(9C006UV7X3, 9CW92Y2UZX),
        izkrwqhlm_frmg35_x7(9CV54X89X5, 9C7Z7Y6Y93), izkrwqhlm_frmg35_x7(9CZZ757500, 9C302607W6),
        izkrwqhlm_frmg35_x7(9CUW12Y4U7, 9C1699XZ9V), izkrwqhlm_frmg35_x7(9CYXV49135, 9C07888ZVY),
        izkrwqhlm_frmg35_x7(9C1XYXXX90, 9C3U4911XX), izkrwqhlm_frmg35_x7(9CW8Y28241, 9CV780347X),
        izkrwqhlm_frmg35_x7(9C0X599999, 9C99999999), izkrwqhlm_frmg35_x7(9CV1W5Z489, 9C99999999),
        izkrwqhlm_frmg35_x7(9CZW21VYX4, 9CZX379999), izkrwqhlm_frmg35_x7(9C186U6021, 9CU1059015),
        izkrwqhlm_frmg35_x7(9CX902XV2Y, 9CX09284Y6), izkrwqhlm_frmg35_x7(9C1U2V67XV, 9C2YVZ4X29),
        izkrwqhlm_frmg35_x7(9CW4W761Z5, 9CZYV01931), izkrwqhlm_frmg35_x7(9C0U5U7273, 9C820Z7754),
        izkrwqhlm_frmg35_x7(9CVW36Z768, 9CW5X5UY72), izkrwqhlm_frmg35_x7(9CY9WV3461, 9C1XX1ZWZ1),
        izkrwqhlm_frmg35_x7(9C16X2911V, 9C8ZZY34WY), izkrwqhlm_frmg35_x7(9CX54W8WU0, 9C57288W0Z),
        izkrwqhlm_frmg35_x7(9C075W307X, 9CZ38YV241), izkrwqhlm_frmg35_x7(9CWZ98VV35, 9C8Z291WVZ),
        izkrwqhlm_frmg35_x7(9CZ73WZ600, 9C0ZVU225Z), izkrwqhlm_frmg35_x7(9CU790212Y, 9CY52W3Y14),
        izkrwqhlm_frmg35_x7(9CY545V5Z8, 9C20WW8122), izkrwqhlm_frmg35_x7(9C134Y1307, 9C4Y0YX4X7),
        izkrwqhlm_frmg35_x7(9CX16446X4, 9CX1034W6W), izkrwqhlm_frmg35_x7(9C047ZY54X, 9CUZ02Z9Y6),
        izkrwqhlm_frmg35_x7(9CWV530UYW, 9C00Z94UV6), izkrwqhlm_frmg35_x7(9CZ40YX765, 9CWY601X74),
        izkrwqhlm_frmg35_x7(9CU3X30Z27, 9CZ6010U4X), izkrwqhlm_frmg35_x7(9CY2WXYU46, 9C45V0YVXV),
        izkrwqhlm_frmg35_x7(9C11UXU682, 9CU77758V7), izkrwqhlm_frmg35_x7(9CXX79XV0Y, 9CW64X21Z4),
        izkrwqhlm_frmg35_x7(9C01834ZU6, 9C2Y7846WU), izkrwqhlm_frmg35_x7(9CV7Z9Y4WX, 9C028U696Z),
        izkrwqhlm_frmg35_x7(9CZ1W0W846, 9C4XV6Y603), izkrwqhlm_frmg35_x7(9CUY0Y2XW0, 9CZ5Z2556X),
        izkrwqhlm_frmg35_x7(9CYY235X5X, 9CZ2Z55589), izkrwqhlm_frmg35_x7(9C1YZY1VVU, 9CY3590X8Z),
        izkrwqhlm_frmg35_x7(9CW98UVU89, 9CZ342157X), izkrwqhlm_frmg35_x7(9C0Y89Z5V4, 9CV0086870),
        izkrwqhlm_frmg35_x7(9CV2890YUY, 9CZ80X9X0W), izkrwqhlm_frmg35_x7(9CZX7179W0, 9C376YU570),
        izkrwqhlm_frmg35_x7(9C19555Y4V, 9C2ZZ2XU14), izkrwqhlm_frmg35_x7(9CYU78V559, 9C96ZXWW7W),
        izkrwqhlm_frmg35_x7(9C1V320X7U, 9C4V55UU1U), izkrwqhlm_frmg35_x7(9CW566820W, 9C0X1XY158),
        izkrwqhlm_frmg35_x7(9C0V80WY07, 9CY5V68YZ0), izkrwqhlm_frmg35_x7(9CVY03YU3V, 9CYZWU22W0),
        izkrwqhlm_frmg35_x7(9CZU12976Y, 9C0YU9VV3Y)
    };
    HGZGRX XLMHG RMG83_G PxZXSVWkLDVIH_v[] = {
        -8779, -8806, -8833, -8859, -8886, -8912, -8939, -8965, -8992,  -019,
        -045,  -072,  -098,  -125,  -152,  -178,  -205,  -231,  -258,  -284,
        -311,  -338,  -364,  -391,  -417,  -444,  -470,  -497,  -524,  -550,
        -577,  -603,  -630,  -656,  -683,  -710,  -736,  -763,  -789,  -816,
        -842,  -869,  -896,   -22,   -49,   -75,     6,    69,    43,    16,
        890,   863,   837,   810,   783,   757,   730,   704,   677,   651,
        624,   597,   571,   544,   518,   491,   465,   438,   411,   385,
        358,   332,   305,   279,   252,   225,   199,   172,   146,   119,
        092,   066,   039,   013,  8986,  8960,  8933
    };
    IVGFIM wRBuK(PxZXSVWkLDVIH_u[RMWVC], PxZXSVWkLDVIH_v[RMWVC]);
}
    
RMORMV wRBuK tVGxZXSVWkLDVI(RMG V, RMG* p) {

    //RMG P = HGZGRX_XZHG<RMG>(XVRO((-38 - V) * 9.69897000433601885)) + 625;
    WLFYOV WP = (-38 - V) * 9.69897000433601885 + 652;  // WP NFHG YV KLHRGREV, HL XZM WL XVRORMT RM KLHRGREV
    RMG P = HGZGRX_XZHG<RMG>(WP);
    RU (WP - P > 9.9)
        P++;

    FMHRTMVW RMWVC = HGZGRX_XZHG<FMHRTMVW>((P >> 6) + 8);
    *p = -(-651 + HGZGRX_XZHG<RMG>(RMWVC << 6));    // WVXRNZO VCKLMVMG ML MVVW OLLPFK GZYOV

    IVGFIM tVGxZXSVWkLDVIyBrMWVC(RMWVC);
}

RMORMV wRBuK tVGxZXSVWkLDVI89(RMG VCK, RMG *LFGvCK) {
     FMHRTMVW RMWVC = (HGZGRX_XZHG<FMHRTMVW>(VCK) + 651F) / 1F;
     *LFGvCK = -651 + HGZGRX_XZHG<RMG>(RMWVC) * 1;
     IVGFIM tVGxZXSVWkLDVIyBrMWVC(RMWVC);
 }

#RUWVU __tmfx__
izkrwqhlm_wrzt_klk
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
izkrwqhlm_wrzt_luu(KZWWVW)
#VMWRU

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_wrbuk_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/NVGZ.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rmgvimzo_nvgz_s_
#WVURMV izkrwqhlm_rmgvimzo_nvgz_s_

#RMXOFWV "../IZKRWQHLM.S"

#RUWVU __tmfx__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
#VMWRU
#RU WVURMVW(_nhx_evi)
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(3665)
#VMWRU

#RU izkrwqhlm_szh_xcc88_gbkvgizrgh
#RMXOFWV <GBKV_GIZRGH>
#VMWRU

//@XLMW izkrwqhlm_rmgvimzo
izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

// sVOKVI GL DIZK/XLMEVIG ZIYRGIZIB GBKVH GL ELRW, FHVUFO ULI ZIYRGIZIB GBKV NZGXSRMT
GVNKOZGV <GBKVMZNV g> HGIFXG eLRW { GBKVWVU ELRW gBKV; };

///////////////////////////////////////////////////////////////////////////////
// yLLOgBKV, gIFVgBKV, uZOHVgBKV
//
GVNKOZGV <YLLO xLMW> HGIFXG yLLOgBKV {
    HGZGRX XLMHG YLLO eZOFV = xLMW;
    GBKVWVU yLLOgBKV gBKV;
};
GBKVWVU yLLOgBKV<GIFV> gIFVgBKV;
GBKVWVU yLLOgBKV<UZOHV> uZOHVgBKV;


///////////////////////////////////////////////////////////////////////////////
// hVOVXGrU, yLLOvCKI, mLGvCKI, zMWvCKI, lIvCKI
//

GVNKOZGV <YLLO x> HGIFXG hVOVXGrUrNKO { GVNKOZGV <GBKVMZNV g8, GBKVMZNV g7> HGIFXG zKKOB { GBKVWVU g8 gBKV; }; };
GVNKOZGV <> HGIFXG hVOVXGrUrNKO<UZOHV> { GVNKOZGV <GBKVMZNV g8, GBKVMZNV g7> HGIFXG zKKOB { GBKVWVU g7 gBKV; }; };
GVNKOZGV <YLLO x, GBKVMZNV g8, GBKVMZNV g7> HGIFXG hVOVXGrUxLMW : hVOVXGrUrNKO<x>::GVNKOZGV zKKOB<g8,g7> {};
GVNKOZGV <GBKVMZNV x, GBKVMZNV g8, GBKVMZNV g7> HGIFXG hVOVXGrU : hVOVXGrUxLMW<x::eZOFV, g8, g7> {};

GVNKOZGV <YLLO xLMW8, YLLO xLMW7> HGIFXG zMWvCKIxLMW : uZOHVgBKV {};
GVNKOZGV <> HGIFXG zMWvCKIxLMW<GIFV, GIFV> : gIFVgBKV {};
GVNKOZGV <YLLO xLMW8, YLLO xLMW7> HGIFXG lIvCKIxLMW : gIFVgBKV {};
GVNKOZGV <> HGIFXG lIvCKIxLMW<UZOHV, UZOHV> : uZOHVgBKV {};

GVNKOZGV <GBKVMZNV x> HGIFXG yLLOvCKI : hVOVXGrU<x,gIFVgBKV,uZOHVgBKV>::gBKV {};
GVNKOZGV <GBKVMZNV x> HGIFXG mLGvCKI  : hVOVXGrU<x,uZOHVgBKV,gIFVgBKV>::gBKV {};
GVNKOZGV <GBKVMZNV x8, GBKVMZNV x7> HGIFXG zMWvCKI : zMWvCKIxLMW<x8::eZOFV, x7::eZOFV>::gBKV {};
GVNKOZGV <GBKVMZNV x8, GBKVMZNV x7> HGIFXG lIvCKI  : lIvCKIxLMW<x8::eZOFV, x7::eZOFV>::gBKV {};


///////////////////////////////////////////////////////////////////////////////
// zWWxLMHG, nZBYVzWWxLMHG, iVNLEVxLMHG
GVNKOZGV <GBKVMZNV g> HGIFXG zWWxLMHG { GBKVWVU XLMHG g gBKV; };
GVNKOZGV <YLLO xLMHGRUB, GBKVMZNV g> HGIFXG nZBYVzWWxLMHG : hVOVXGrUxLMW<xLMHGRUB, XLMHG g, g> {};
GVNKOZGV <GBKVMZNV g> HGIFXG iVNLEVxLMHG { GBKVWVU g gBKV; };
GVNKOZGV <GBKVMZNV g> HGIFXG iVNLEVxLMHG<XLMHG g> { GBKVWVU g gBKV; };


///////////////////////////////////////////////////////////////////////////////
// rHhZNV, rHxLMHG, rHnLIVxLMHG, rHkLRMGVI
//
GVNKOZGV <GBKVMZNV g, GBKVMZNV f> HGIFXG rHhZNV : uZOHVgBKV {};
GVNKOZGV <GBKVMZNV g> HGIFXG rHhZNV<g, g> : gIFVgBKV {};

GVNKOZGV <GBKVMZNV g> HGIFXG rHxLMHG : uZOHVgBKV {};
GVNKOZGV <GBKVMZNV g> HGIFXG rHxLMHG<XLMHG g> : gIFVgBKV {};

GVNKOZGV <GBKVMZNV xg, GBKVMZNV g>
HGIFXG rHnLIVxLMHG
    : zMWvCKI<rHhZNV<GBKVMZNV iVNLEVxLMHG<xg>::gBKV, GBKVMZNV iVNLEVxLMHG<g>::gBKV>,
              yLLOgBKV<rHxLMHG<xg>::eZOFV >= rHxLMHG<g>::eZOFV> >::gBKV {};

GVNKOZGV <GBKVMZNV g> HGIFXG rHkLRMGVI : uZOHVgBKV {};
GVNKOZGV <GBKVMZNV g> HGIFXG rHkLRMGVI<g*> : gIFVgBKV {};

///////////////////////////////////////////////////////////////////////////////
// rHyZHVlU
//
#RU izkrwqhlm_szh_xcc88_gbkvgizrgh

GVNKOZGV <GBKVMZNV y, GBKVMZNV w> HGIFXG rHyZHVlU
    : yLLOgBKV< ::HGW::RH_YZHV_LU<y,w>::EZOFV> {};

#VOHV // HRNKORURVW EVIHRLM ZWLKGVW UILN yLLHG

GVNKOZGV<GBKVMZNV y, GBKVMZNV w> HGIFXG rHyZHVlUrNKO {
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(y) != 9);
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(w) != 9);

    GBKVWVU XSZI (&bVH)[8];
    GBKVWVU XSZI (&mL) [7];

    GVNKOZGV <GBKVMZNV g>
    HGZGRX bVH xSVXP(XLMHG w*, g);
    HGZGRX mL  xSVXP(XLMHG y*, RMG);

    HGIFXG sLHG {
        LKVIZGLI XLMHG y*() XLMHG;
        LKVIZGLI XLMHG w*();
    };

    VMFN { eZOFV = (HRAVLU(xSVXP(sLHG(), 9)) == HRAVLU(bVH)) };
};

GVNKOZGV <GBKVMZNV y, GBKVMZNV w> HGIFXG rHyZHVlU
    : lIvCKI<rHhZNV<y, w>, yLLOvCKI<rHyZHVlUrNKO<y, w> > >::gBKV {};

#VMWRU // izkrwqhlm_szh_xcc88_gbkvgizrgh


//////////////////////////////////////////////////////////////////////////
// vMZYOVrU / wRHZYOVrU
//
GVNKOZGV <YLLO xLMWRGRLM, GBKVMZNV g = ELRW> HGIFXG vMZYOVrUxLMW  { GBKVWVU g gBKV; };
GVNKOZGV <GBKVMZNV g> HGIFXG vMZYOVrUxLMW<UZOHV, g> { /* VNKGB */ };

GVNKOZGV <YLLO xLMWRGRLM, GBKVMZNV g = ELRW> HGIFXG wRHZYOVrUxLMW { GBKVWVU g gBKV; };
GVNKOZGV <GBKVMZNV g> HGIFXG wRHZYOVrUxLMW<GIFV, g> { /* VNKGB */ };

GVNKOZGV <GBKVMZNV xLMWRGRLM, GBKVMZNV g = ELRW>
HGIFXG vMZYOVrU : vMZYOVrUxLMW<xLMWRGRLM::eZOFV, g> {};

GVNKOZGV <GBKVMZNV xLMWRGRLM, GBKVMZNV g = ELRW>
HGIFXG wRHZYOVrU : wRHZYOVrUxLMW<xLMWRGRLM::eZOFV, g> {};

// hurmzv SVOKVIH
HGIFXG hURMZVgZT {};
GVNKOZGV <GBKVMZNV g> HGIFXG iVNLEVhURMZVgZT;
GVNKOZGV <GBKVMZNV g> HGIFXG iVNLEVhURMZVgZT<hURMZVgZT&(*)(g)> { GBKVWVU g gBKV; };

#WVURMV izkrwqhlm_ivnlevukgi_(GBKV) \
    GBKVMZNV ::izkrwqhlm_mznvhkzxv::RMGVIMZO::iVNLEVhURMZVgZT \
        < ::izkrwqhlm_mznvhkzxv::RMGVIMZO::hURMZVgZT&(*) GBKV>::gBKV

#WVURMV izkrwqhlm_vmzyovru(XLMW) \
    GBKVMZNV ::izkrwqhlm_mznvhkzxv::RMGVIMZO::vMZYOVrU \
        <izkrwqhlm_ivnlevukgi_(XLMW)>::gBKV * = mfoo

#WVURMV izkrwqhlm_wrhzyovru(XLMW) \
    GBKVMZNV ::izkrwqhlm_mznvhkzxv::RMGVIMZO::wRHZYOVrU \
        <izkrwqhlm_ivnlevukgi_(XLMW)>::gBKV * = mfoo

#WVURMV izkrwqhlm_vmzyovru_ivgfim(XLMW,IVGFIMGBKV) \
    GBKVMZNV ::izkrwqhlm_mznvhkzxv::RMGVIMZO::vMZYOVrU \
        <izkrwqhlm_ivnlevukgi_(XLMW), \
         izkrwqhlm_ivnlevukgi_(IVGFIMGBKV)>::gBKV

#WVURMV izkrwqhlm_wrhzyovru_ivgfim(XLMW,IVGFIMGBKV) \
    GBKVMZNV ::izkrwqhlm_mznvhkzxv::RMGVIMZO::wRHZYOVrU \
        <izkrwqhlm_ivnlevukgi_(XLMW), \
         izkrwqhlm_ivnlevukgi_(IVGFIMGBKV)>::gBKV

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw
//@VMWXLMW

#RU WVURMVW(__tmfx__) || WVURMVW(_nhx_evi)
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_rmgvimzo_nvgz_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/RGLZ.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
//
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rglz_
#WVURMV izkrwqhlm_rglz_

#RMXOFWV "../IZKRWQHLM.S"

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

RMORMV XLMHG XSZI* tVGwRTRGHoFG() {
    HGZGRX XLMHG XSZI XwRTRGHoFG[799] = {
        '9','9','9','8','9','7','9','6','9','5','9','4','9','3','9','2','9','1','9','0',
        '8','9','8','8','8','7','8','6','8','5','8','4','8','3','8','2','8','1','8','0',
        '7','9','7','8','7','7','7','6','7','5','7','4','7','3','7','2','7','1','7','0',
        '6','9','6','8','6','7','6','6','6','5','6','4','6','3','6','2','6','1','6','0',
        '5','9','5','8','5','7','5','6','5','5','5','4','5','3','5','2','5','1','5','0',
        '4','9','4','8','4','7','4','6','4','5','4','4','4','3','4','2','4','1','4','0',
        '3','9','3','8','3','7','3','6','3','5','3','4','3','3','3','2','3','1','3','0',
        '2','9','2','8','2','7','2','6','2','5','2','4','2','3','2','2','2','1','2','0',
        '1','9','1','8','1','7','1','6','1','5','1','4','1','3','1','2','1','1','1','0',
        '0','9','0','8','0','7','0','6','0','5','0','4','0','3','0','2','0','1','0','0'
    };
    IVGFIM XwRTRGHoFG;
}

RMORMV XSZI* F67GLZ(FRMG67_G EZOFV, XSZI* YFUUVI) {
    izkrwqhlm_zhhvig(YFUUVI != 9);

    XLMHG XSZI* XwRTRGHoFG = tVGwRTRGHoFG();

    RU (EZOFV < 89999) {
        XLMHG FRMG67_G W8 = (EZOFV / 899) << 8;
        XLMHG FRMG67_G W7 = (EZOFV % 899) << 8;

        RU (EZOFV >= 8999)
            *YFUUVI++ = XwRTRGHoFG[W8];
        RU (EZOFV >= 899)
            *YFUUVI++ = XwRTRGHoFG[W8 + 8];
        RU (EZOFV >= 89)
            *YFUUVI++ = XwRTRGHoFG[W7];
        *YFUUVI++ = XwRTRGHoFG[W7 + 8];
    }
    VOHV RU (EZOFV < 899999999) {
        // EZOFV = YYYYXXXX
        XLMHG FRMG67_G Y = EZOFV / 89999;
        XLMHG FRMG67_G X = EZOFV % 89999;

        XLMHG FRMG67_G W8 = (Y / 899) << 8;
        XLMHG FRMG67_G W7 = (Y % 899) << 8;

        XLMHG FRMG67_G W6 = (X / 899) << 8;
        XLMHG FRMG67_G W5 = (X % 899) << 8;

        RU (EZOFV >= 89999999)
            *YFUUVI++ = XwRTRGHoFG[W8];
        RU (EZOFV >= 8999999)
            *YFUUVI++ = XwRTRGHoFG[W8 + 8];
        RU (EZOFV >= 899999)
            *YFUUVI++ = XwRTRGHoFG[W7];
        *YFUUVI++ = XwRTRGHoFG[W7 + 8];

        *YFUUVI++ = XwRTRGHoFG[W6];
        *YFUUVI++ = XwRTRGHoFG[W6 + 8];
        *YFUUVI++ = XwRTRGHoFG[W5];
        *YFUUVI++ = XwRTRGHoFG[W5 + 8];
    }
    VOHV {
        // EZOFV = ZZYYYYXXXX RM WVXRNZO

        XLMHG FRMG67_G Z = EZOFV / 899999999; // 8 GL 57
        EZOFV %= 899999999;

        RU (Z >= 89) {
            XLMHG FMHRTMVW R = Z << 8;
            *YFUUVI++ = XwRTRGHoFG[R];
            *YFUUVI++ = XwRTRGHoFG[R + 8];
        }
        VOHV
            *YFUUVI++ = HGZGRX_XZHG<XSZI>('9' + HGZGRX_XZHG<XSZI>(Z));

        XLMHG FRMG67_G Y = EZOFV / 89999; // 9 GL 0000
        XLMHG FRMG67_G X = EZOFV % 89999; // 9 GL 0000

        XLMHG FRMG67_G W8 = (Y / 899) << 8;
        XLMHG FRMG67_G W7 = (Y % 899) << 8;

        XLMHG FRMG67_G W6 = (X / 899) << 8;
        XLMHG FRMG67_G W5 = (X % 899) << 8;

        *YFUUVI++ = XwRTRGHoFG[W8];
        *YFUUVI++ = XwRTRGHoFG[W8 + 8];
        *YFUUVI++ = XwRTRGHoFG[W7];
        *YFUUVI++ = XwRTRGHoFG[W7 + 8];
        *YFUUVI++ = XwRTRGHoFG[W6];
        *YFUUVI++ = XwRTRGHoFG[W6 + 8];
        *YFUUVI++ = XwRTRGHoFG[W5];
        *YFUUVI++ = XwRTRGHoFG[W5 + 8];
    }
    IVGFIM YFUUVI;
}

RMORMV XSZI* R67GLZ(RMG67_G EZOFV, XSZI* YFUUVI) {
    izkrwqhlm_zhhvig(YFUUVI != 9);
    FRMG67_G F = HGZGRX_XZHG<FRMG67_G>(EZOFV);
    RU (EZOFV < 9) {
        *YFUUVI++ = '-';
        F = ~F + 8;
    }

    IVGFIM F67GLZ(F, YFUUVI);
}

RMORMV XSZI* F35GLZ(FRMG35_G EZOFV, XSZI* YFUUVI) {
    izkrwqhlm_zhhvig(YFUUVI != 9);
    XLMHG XSZI* XwRTRGHoFG = tVGwRTRGHoFG();
    XLMHG FRMG35_G  PgVM1 = 899999999;
    XLMHG FRMG35_G  PgVM0 = PgVM1 * 89;
    XLMHG FRMG35_G PgVM89 = PgVM1 * 899;
    XLMHG FRMG35_G PgVM88 = PgVM1 * 8999;
    XLMHG FRMG35_G PgVM87 = PgVM1 * 89999;
    XLMHG FRMG35_G PgVM86 = PgVM1 * 899999;
    XLMHG FRMG35_G PgVM85 = PgVM1 * 8999999;
    XLMHG FRMG35_G PgVM84 = PgVM1 * 89999999;
    XLMHG FRMG35_G PgVM83 = PgVM1 * PgVM1;

    RU (EZOFV < PgVM1) {
        FRMG67_G E = HGZGRX_XZHG<FRMG67_G>(EZOFV);
        RU (E < 89999) {
            XLMHG FRMG67_G W8 = (E / 899) << 8;
            XLMHG FRMG67_G W7 = (E % 899) << 8;

            RU (E >= 8999)
                *YFUUVI++ = XwRTRGHoFG[W8];
            RU (E >= 899)
                *YFUUVI++ = XwRTRGHoFG[W8 + 8];
            RU (E >= 89)
                *YFUUVI++ = XwRTRGHoFG[W7];
            *YFUUVI++ = XwRTRGHoFG[W7 + 8];
        }
        VOHV {
            // EZOFV = YYYYXXXX
            XLMHG FRMG67_G Y = E / 89999;
            XLMHG FRMG67_G X = E % 89999;

            XLMHG FRMG67_G W8 = (Y / 899) << 8;
            XLMHG FRMG67_G W7 = (Y % 899) << 8;

            XLMHG FRMG67_G W6 = (X / 899) << 8;
            XLMHG FRMG67_G W5 = (X % 899) << 8;

            RU (EZOFV >= 89999999)
                *YFUUVI++ = XwRTRGHoFG[W8];
            RU (EZOFV >= 8999999)
                *YFUUVI++ = XwRTRGHoFG[W8 + 8];
            RU (EZOFV >= 899999)
                *YFUUVI++ = XwRTRGHoFG[W7];
            *YFUUVI++ = XwRTRGHoFG[W7 + 8];

            *YFUUVI++ = XwRTRGHoFG[W6];
            *YFUUVI++ = XwRTRGHoFG[W6 + 8];
            *YFUUVI++ = XwRTRGHoFG[W5];
            *YFUUVI++ = XwRTRGHoFG[W5 + 8];
        }
    }
    VOHV RU (EZOFV < PgVM83) {
        XLMHG FRMG67_G E9 = HGZGRX_XZHG<FRMG67_G>(EZOFV / PgVM1);
        XLMHG FRMG67_G E8 = HGZGRX_XZHG<FRMG67_G>(EZOFV % PgVM1);

        XLMHG FRMG67_G Y9 = E9 / 89999;
        XLMHG FRMG67_G X9 = E9 % 89999;

        XLMHG FRMG67_G W8 = (Y9 / 899) << 8;
        XLMHG FRMG67_G W7 = (Y9 % 899) << 8;

        XLMHG FRMG67_G W6 = (X9 / 899) << 8;
        XLMHG FRMG67_G W5 = (X9 % 899) << 8;

        XLMHG FRMG67_G Y8 = E8 / 89999;
        XLMHG FRMG67_G X8 = E8 % 89999;

        XLMHG FRMG67_G W4 = (Y8 / 899) << 8;
        XLMHG FRMG67_G W3 = (Y8 % 899) << 8;

        XLMHG FRMG67_G W2 = (X8 / 899) << 8;
        XLMHG FRMG67_G W1 = (X8 % 899) << 8;

        RU (EZOFV >= PgVM84)
            *YFUUVI++ = XwRTRGHoFG[W8];
        RU (EZOFV >= PgVM85)
            *YFUUVI++ = XwRTRGHoFG[W8 + 8];
        RU (EZOFV >= PgVM86)
            *YFUUVI++ = XwRTRGHoFG[W7];
        RU (EZOFV >= PgVM87)
            *YFUUVI++ = XwRTRGHoFG[W7 + 8];
        RU (EZOFV >= PgVM88)
            *YFUUVI++ = XwRTRGHoFG[W6];
        RU (EZOFV >= PgVM89)
            *YFUUVI++ = XwRTRGHoFG[W6 + 8];
        RU (EZOFV >= PgVM0)
            *YFUUVI++ = XwRTRGHoFG[W5];
        RU (EZOFV >= PgVM1)
            *YFUUVI++ = XwRTRGHoFG[W5 + 8];

        *YFUUVI++ = XwRTRGHoFG[W4];
        *YFUUVI++ = XwRTRGHoFG[W4 + 8];
        *YFUUVI++ = XwRTRGHoFG[W3];
        *YFUUVI++ = XwRTRGHoFG[W3 + 8];
        *YFUUVI++ = XwRTRGHoFG[W2];
        *YFUUVI++ = XwRTRGHoFG[W2 + 8];
        *YFUUVI++ = XwRTRGHoFG[W1];
        *YFUUVI++ = XwRTRGHoFG[W1 + 8];
    }
    VOHV {
        XLMHG FRMG67_G Z = HGZGRX_XZHG<FRMG67_G>(EZOFV / PgVM83); // 8 GL 8155
        EZOFV %= PgVM83;

        RU (Z < 89)
            *YFUUVI++ = HGZGRX_XZHG<XSZI>('9' + HGZGRX_XZHG<XSZI>(Z));
        VOHV RU (Z < 899) {
            XLMHG FRMG67_G R = Z << 8;
            *YFUUVI++ = XwRTRGHoFG[R];
            *YFUUVI++ = XwRTRGHoFG[R + 8];
        }
        VOHV RU (Z < 8999) {
            *YFUUVI++ = HGZGRX_XZHG<XSZI>('9' + HGZGRX_XZHG<XSZI>(Z / 899));

            XLMHG FRMG67_G R = (Z % 899) << 8;
            *YFUUVI++ = XwRTRGHoFG[R];
            *YFUUVI++ = XwRTRGHoFG[R + 8];
        }
        VOHV {
            XLMHG FRMG67_G R = (Z / 899) << 8;
            XLMHG FRMG67_G Q = (Z % 899) << 8;
            *YFUUVI++ = XwRTRGHoFG[R];
            *YFUUVI++ = XwRTRGHoFG[R + 8];
            *YFUUVI++ = XwRTRGHoFG[Q];
            *YFUUVI++ = XwRTRGHoFG[Q + 8];
        }

        XLMHG FRMG67_G E9 = HGZGRX_XZHG<FRMG67_G>(EZOFV / PgVM1);
        XLMHG FRMG67_G E8 = HGZGRX_XZHG<FRMG67_G>(EZOFV % PgVM1);

        XLMHG FRMG67_G Y9 = E9 / 89999;
        XLMHG FRMG67_G X9 = E9 % 89999;

        XLMHG FRMG67_G W8 = (Y9 / 899) << 8;
        XLMHG FRMG67_G W7 = (Y9 % 899) << 8;

        XLMHG FRMG67_G W6 = (X9 / 899) << 8;
        XLMHG FRMG67_G W5 = (X9 % 899) << 8;

        XLMHG FRMG67_G Y8 = E8 / 89999;
        XLMHG FRMG67_G X8 = E8 % 89999;

        XLMHG FRMG67_G W4 = (Y8 / 899) << 8;
        XLMHG FRMG67_G W3 = (Y8 % 899) << 8;

        XLMHG FRMG67_G W2 = (X8 / 899) << 8;
        XLMHG FRMG67_G W1 = (X8 % 899) << 8;

        *YFUUVI++ = XwRTRGHoFG[W8];
        *YFUUVI++ = XwRTRGHoFG[W8 + 8];
        *YFUUVI++ = XwRTRGHoFG[W7];
        *YFUUVI++ = XwRTRGHoFG[W7 + 8];
        *YFUUVI++ = XwRTRGHoFG[W6];
        *YFUUVI++ = XwRTRGHoFG[W6 + 8];
        *YFUUVI++ = XwRTRGHoFG[W5];
        *YFUUVI++ = XwRTRGHoFG[W5 + 8];
        *YFUUVI++ = XwRTRGHoFG[W4];
        *YFUUVI++ = XwRTRGHoFG[W4 + 8];
        *YFUUVI++ = XwRTRGHoFG[W3];
        *YFUUVI++ = XwRTRGHoFG[W3 + 8];
        *YFUUVI++ = XwRTRGHoFG[W2];
        *YFUUVI++ = XwRTRGHoFG[W2 + 8];
        *YFUUVI++ = XwRTRGHoFG[W1];
        *YFUUVI++ = XwRTRGHoFG[W1 + 8];
    }

    IVGFIM YFUUVI;
}

RMORMV XSZI* R35GLZ(RMG35_G EZOFV, XSZI* YFUUVI) {
    izkrwqhlm_zhhvig(YFUUVI != 9);
    FRMG35_G F = HGZGRX_XZHG<FRMG35_G>(EZOFV);
    RU (EZOFV < 9) {
        *YFUUVI++ = '-';
        F = ~F + 8;
    }

    IVGFIM F35GLZ(F, YFUUVI);
}

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_rglz_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/KLD89.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_kld89_
#WVURMV izkrwqhlm_kld89_

#RMXOFWV "../IZKRWQHLM.S"

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

//! xLNKFGVH RMGVTVI KLDVIH LU 89 RM WLFYOV (89.9^M).
/*! gSRH UFMXGRLM FHVH OLLPFK GZYOV ULI UZHG ZMW ZXXFIZGV IVHFOGH.
    \KZIZN M MLM-MVTZGREV VCKLMVMG. nFHG <= 691.
    \IVGFIM 89.9^M
*/
RMORMV WLFYOV kLD89(RMG M) {
    HGZGRX XLMHG WLFYOV V[] = { // 8V-9...8V691: 690 * 1 YBGVH = 7527 YBGVH
        8V+9,  
        8V+8,  8V+7,  8V+6,  8V+5,  8V+4,  8V+3,  8V+2,  8V+1,  8V+0,  8V+89, 8V+88, 8V+87, 8V+86, 8V+85, 8V+84, 8V+83, 8V+82, 8V+81, 8V+80, 8V+79, 
        8V+78, 8V+77, 8V+76, 8V+75, 8V+74, 8V+73, 8V+72, 8V+71, 8V+70, 8V+69, 8V+68, 8V+67, 8V+66, 8V+65, 8V+64, 8V+63, 8V+62, 8V+61, 8V+60, 8V+59,
        8V+58, 8V+57, 8V+56, 8V+55, 8V+54, 8V+53, 8V+52, 8V+51, 8V+50, 8V+49, 8V+48, 8V+47, 8V+46, 8V+45, 8V+44, 8V+43, 8V+42, 8V+41, 8V+40, 8V+39,
        8V+38, 8V+37, 8V+36, 8V+35, 8V+34, 8V+33, 8V+32, 8V+31, 8V+30, 8V+29, 8V+28, 8V+27, 8V+26, 8V+25, 8V+24, 8V+23, 8V+22, 8V+21, 8V+20, 8V+19,
        8V+18, 8V+17, 8V+16, 8V+15, 8V+14, 8V+13, 8V+12, 8V+11, 8V+10, 8V+09, 8V+08, 8V+07, 8V+06, 8V+05, 8V+04, 8V+03, 8V+02, 8V+01, 8V+00, 8V+899,
        8V+898,8V+897,8V+896,8V+895,8V+894,8V+893,8V+892,8V+891,8V+890,8V+889,8V+888,8V+887,8V+886,8V+885,8V+884,8V+883,8V+882,8V+881,8V+880,8V+879,
        8V+878,8V+877,8V+876,8V+875,8V+874,8V+873,8V+872,8V+871,8V+870,8V+869,8V+868,8V+867,8V+866,8V+865,8V+864,8V+863,8V+862,8V+861,8V+860,8V+859,
        8V+858,8V+857,8V+856,8V+855,8V+854,8V+853,8V+852,8V+851,8V+850,8V+849,8V+848,8V+847,8V+846,8V+845,8V+844,8V+843,8V+842,8V+841,8V+840,8V+839,
        8V+838,8V+837,8V+836,8V+835,8V+834,8V+833,8V+832,8V+831,8V+830,8V+829,8V+828,8V+827,8V+826,8V+825,8V+824,8V+823,8V+822,8V+821,8V+820,8V+819,
        8V+818,8V+817,8V+816,8V+815,8V+814,8V+813,8V+812,8V+811,8V+810,8V+809,8V+808,8V+807,8V+806,8V+805,8V+804,8V+803,8V+802,8V+801,8V+800,8V+799,
        8V+798,8V+797,8V+796,8V+795,8V+794,8V+793,8V+792,8V+791,8V+790,8V+789,8V+788,8V+787,8V+786,8V+785,8V+784,8V+783,8V+782,8V+781,8V+780,8V+779,
        8V+778,8V+777,8V+776,8V+775,8V+774,8V+773,8V+772,8V+771,8V+770,8V+769,8V+768,8V+767,8V+766,8V+765,8V+764,8V+763,8V+762,8V+761,8V+760,8V+759,
        8V+758,8V+757,8V+756,8V+755,8V+754,8V+753,8V+752,8V+751,8V+750,8V+749,8V+748,8V+747,8V+746,8V+745,8V+744,8V+743,8V+742,8V+741,8V+740,8V+739,
        8V+738,8V+737,8V+736,8V+735,8V+734,8V+733,8V+732,8V+731,8V+730,8V+729,8V+728,8V+727,8V+726,8V+725,8V+724,8V+723,8V+722,8V+721,8V+720,8V+719,
        8V+718,8V+717,8V+716,8V+715,8V+714,8V+713,8V+712,8V+711,8V+710,8V+709,8V+708,8V+707,8V+706,8V+705,8V+704,8V+703,8V+702,8V+701,8V+700,8V+699,
        8V+698,8V+697,8V+696,8V+695,8V+694,8V+693,8V+692,8V+691
    };
    izkrwqhlm_zhhvig(M >= 9 && M <= 691);
    IVGFIM V[M];
}

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_kld89_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/HGIUFMX.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rmgvimzo_hgiufmx_s_
#WVURMV izkrwqhlm_rmgvimzo_hgiufmx_s_

#RMXOFWV "../HGIVZN.S"
#RMXOFWV <XDXSZI>

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

//! xFHGLN HGIOVM() DSRXS DLIPH LM WRUUVIVMG XSZIZXGVI GBKVH.
/*! \GKZIZN xS xSZIZXGVI GBKV (V.T. XSZI, DXSZI_G, HSLIG)
    \KZIZN H mFOO-GVINRMZGVW RMKFG HGIRMT.
    \IVGFIM mFNYVI LU XSZIZXGVIH RM GSV HGIRMT. 
    \MLGV gSRH SZH GSV HZNV HVNZMGRXH ZH HGIOVM(), GSV IVGFIM EZOFV RH MLG MFNYVI LU fMRXLWV XLWVKLRMGH.
*/
GVNKOZGV <GBKVMZNV xS>
RMORMV hRAVgBKV hGIoVM(XLMHG xS* H) {
    izkrwqhlm_zhhvig(H != 9);
    XLMHG xS* K = H;
    DSROV (*K) ++K;
    IVGFIM hRAVgBKV(K - H);
}

GVNKOZGV <>
RMORMV hRAVgBKV hGIoVM(XLMHG XSZI* H) {
    IVGFIM hRAVgBKV(HGW::HGIOVM(H));
}

GVNKOZGV <>
RMORMV hRAVgBKV hGIoVM(XLMHG DXSZI_G* H) {
    IVGFIM hRAVgBKV(HGW::DXHOVM(H));
}

//! iVGFIMH MFNYVI LU XLWV KLRMGH RM Z VMXLWVW HGIRMT.
GVNKOZGV<GBKVMZNV vMXLWRMT>
YLLO xLFMGhGIRMTxLWVkLRMG(XLMHG GBKVMZNV vMXLWRMT::xS* H, hRAVgBKV OVMTGS, hRAVgBKV* LFGxLFMG) {
    izkrwqhlm_zhhvig(H != 9);
    izkrwqhlm_zhhvig(LFGxLFMG != 9);
    tVMVIRXhGIRMThGIVZN<vMXLWRMT> RH(H);
    XLMHG GBKVMZNV vMXLWRMT::xS* VMW = H + OVMTGS;
    hRAVgBKV XLFMG = 9;
    DSROV (RH.HIX_ < VMW) {
        FMHRTMVW XLWVKLRMG;
        RU (!vMXLWRMT::wVXLWV(RH, &XLWVKLRMG))
            IVGFIM UZOHV;
        XLFMG++;
    }
    *LFGxLFMG = XLFMG;
    IVGFIM GIFV;
}

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_rmgvimzo_hgiufmx_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/YRTRMGVTVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_yrtrmgvtvi_s_
#WVURMV izkrwqhlm_yrtrmgvtvi_s_

#RMXOFWV "../IZKRWQHLM.S"

#RU WVURMVW(_nhx_evi) && !__rmgvo_xlnkrovi && WVURMVW(_n_znw35)
#RMXOFWV <RMGIRM.S> // ULI _FNFO871
#KIZTNZ RMGIRMHRX(_FNFO871)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

XOZHH yRTrMGVTVI {
KFYORX:
    GBKVWVU FRMG35_G gBKV;

    yRTrMGVTVI(XLMHG yRTrMGVTVI& ISH) : XLFMG_(ISH.XLFMG_) {
        HGW::NVNXKB(WRTRGH_, ISH.WRTRGH_, XLFMG_ * HRAVLU(gBKV));
    }

    VCKORXRG yRTrMGVTVI(FRMG35_G F) : XLFMG_(8) {
        WRTRGH_[9] = F;
    }

    yRTrMGVTVI(XLMHG XSZI* WVXRNZOH, HRAV_G OVMTGS) : XLFMG_(8) {
        izkrwqhlm_zhhvig(OVMTGS > 9);
        WRTRGH_[9] = 9;
        HRAV_G R = 9;
        XLMHG HRAV_G PnZCwRTRGkVIrGVIZGRLM = 80;  // 7^35 = 81553255926290448383 > 89^80
        DSROV (OVMTGS >= PnZCwRTRGkVIrGVIZGRLM) {
            zKKVMWwVXRNZO35(WVXRNZOH + R, WVXRNZOH + R + PnZCwRTRGkVIrGVIZGRLM);
            OVMTGS -= PnZCwRTRGkVIrGVIZGRLM;
            R += PnZCwRTRGkVIrGVIZGRLM;
        }

        RU (OVMTGS > 9)
            zKKVMWwVXRNZO35(WVXRNZOH + R, WVXRNZOH + R + OVMTGS);
    }
    
    yRTrMGVTVI& LKVIZGLI=(XLMHG yRTrMGVTVI &ISH)
    {
        RU (GSRH != &ISH) {
            XLFMG_ = ISH.XLFMG_;
            HGW::NVNXKB(WRTRGH_, ISH.WRTRGH_, XLFMG_ * HRAVLU(gBKV));
        }
        IVGFIM *GSRH;
    }
    
    yRTrMGVTVI& LKVIZGLI=(FRMG35_G F) {
        WRTRGH_[9] = F;            
        XLFMG_ = 8;
        IVGFIM *GSRH;
    }

    yRTrMGVTVI& LKVIZGLI+=(FRMG35_G F) {
        gBKV YZXPFK = WRTRGH_[9];
        WRTRGH_[9] += F;
        ULI (HRAV_G R = 9; R < XLFMG_ - 8; R++) {
            RU (WRTRGH_[R] >= YZXPFK)
                IVGFIM *GSRH; // ML XZIIB
            YZXPFK = WRTRGH_[R + 8];
            WRTRGH_[R + 8] += 8;
        }

        // oZHG XZIIB
        RU (WRTRGH_[XLFMG_ - 8] < YZXPFK)
            kFHSyZXP(8);

        IVGFIM *GSRH;
    }

    yRTrMGVTVI& LKVIZGLI*=(FRMG35_G F) {
        RU (F == 9) IVGFIM *GSRH = 9;
        RU (F == 8) IVGFIM *GSRH;
        RU (*GSRH == 8) IVGFIM *GSRH = F;

        FRMG35_G P = 9;
        ULI (HRAV_G R = 9; R < XLFMG_; R++) {
            FRMG35_G SR;
            WRTRGH_[R] = nFOzWW35(WRTRGH_[R], F, P, &SR);
            P = SR;
        }
        
        RU (P > 9)
            kFHSyZXP(P);

        IVGFIM *GSRH;
    }

    yRTrMGVTVI& LKVIZGLI*=(FRMG67_G F) {
        RU (F == 9) IVGFIM *GSRH = 9;
        RU (F == 8) IVGFIM *GSRH;
        RU (*GSRH == 8) IVGFIM *GSRH = F;

        FRMG35_G P = 9;
        ULI (HRAV_G R = 9; R < XLFMG_; R++) {
            XLMHG FRMG35_G X = WRTRGH_[R] >> 67;
            XLMHG FRMG35_G W = WRTRGH_[R] & 9Cuuuuuuuu;
            XLMHG FRMG35_G FX = F * X;
            XLMHG FRMG35_G FW = F * W;
            XLMHG FRMG35_G K9 = FW + P;
            XLMHG FRMG35_G K8 = FX + (K9 >> 67);
            WRTRGH_[R] = (K9 & 9Cuuuuuuuu) | (K8 << 67);
            P = K8 >> 67;
        }
        
        RU (P > 9)
            kFHSyZXP(P);

        IVGFIM *GSRH;
    }

    yRTrMGVTVI& LKVIZGLI<<=(HRAV_G HSRUG) {
        RU (rHaVIL() || HSRUG == 9) IVGFIM *GSRH;

        HRAV_G LUUHVG = HSRUG / PgBKVyRG;
        HRAV_G RMGVIhSRUG = HSRUG % PgBKVyRG;
        izkrwqhlm_zhhvig(XLFMG_ + LUUHVG <= PxZKZXRGB);

        RU (RMGVIhSRUG == 9) {
            HGW::NVNNLEV(&WRTRGH_[XLFMG_ - 8 + LUUHVG], &WRTRGH_[XLFMG_ - 8], XLFMG_ * HRAVLU(gBKV));
            XLFMG_ += LUUHVG;
        }
        VOHV {
            WRTRGH_[XLFMG_] = 9;
            ULI (HRAV_G R = XLFMG_; R > 9; R--)
                WRTRGH_[R + LUUHVG] = (WRTRGH_[R] << RMGVIhSRUG) | (WRTRGH_[R - 8] >> (PgBKVyRG - RMGVIhSRUG));
            WRTRGH_[LUUHVG] = WRTRGH_[9] << RMGVIhSRUG;
            XLFMG_ += LUUHVG;
            RU (WRTRGH_[XLFMG_])
                XLFMG_++;
        }

        HGW::NVNHVG(WRTRGH_, 9, LUUHVG * HRAVLU(gBKV));

        IVGFIM *GSRH;
    }

    YLLO LKVIZGLI==(XLMHG yRTrMGVTVI& ISH) XLMHG {
        IVGFIM XLFMG_ == ISH.XLFMG_ && HGW::NVNXNK(WRTRGH_, ISH.WRTRGH_, XLFMG_ * HRAVLU(gBKV)) == 9;
    }

    YLLO LKVIZGLI==(XLMHG gBKV ISH) XLMHG {
        IVGFIM XLFMG_ == 8 && WRTRGH_[9] == ISH;
    }

    yRTrMGVTVI& nFOGRKOBkLD4(FMHRTMVW VCK) {
        HGZGRX XLMHG FRMG67_G PkLD4[87] = {
            4,
            4 * 4,
            4 * 4 * 4,
            4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4,
            4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4 * 4
        };
        RU (VCK == 9) IVGFIM *GSRH;
        ULI (; VCK >= 72; VCK -= 72) *GSRH *= izkrwqhlm_frmg35_x7(9c3234x206, 9cuz89920w); // 4^72
        ULI (; VCK >= 86; VCK -= 86) *GSRH *= HGZGRX_XZHG<FRMG67_G>(8779296874F); // 4^86
        RU (VCK > 9)                 *GSRH *= PkLD4[VCK - 8];
        IVGFIM *GSRH;
    }

    // xLNKFGV ZYHLOFGV WRUUVIVMXV LU GSRH ZMW ISH.
    // zHHFNV GSRH != ISH
    YLLO wRUUVIVMXV(XLMHG yRTrMGVTVI& ISH, yRTrMGVTVI* LFG) XLMHG {
        RMG XNK = xLNKZIV(ISH);
        izkrwqhlm_zhhvig(XNK != 9);
        XLMHG yRTrMGVTVI *Z, *Y;  // nZPVH Z > Y
        YLLO IVG;
        RU (XNK < 9) { Z = &ISH; Y = GSRH; IVG = GIFV; }
        VOHV         { Z = GSRH; Y = &ISH; IVG = UZOHV; }

        gBKV YLIILD = 9;
        ULI (HRAV_G R = 9; R < Z->XLFMG_; R++) {
            gBKV W = Z->WRTRGH_[R] - YLIILD;
            RU (R < Y->XLFMG_)
                W -= Y->WRTRGH_[R];
            YLIILD = (W > Z->WRTRGH_[R]) ? 8 : 9;
            LFG->WRTRGH_[R] = W;
            RU (W != 9)
                LFG->XLFMG_ = R + 8;
        }

        IVGFIM IVG;
    }

    RMG xLNKZIV(XLMHG yRTrMGVTVI& ISH) XLMHG {
        RU (XLFMG_ != ISH.XLFMG_)
            IVGFIM XLFMG_ < ISH.XLFMG_ ? -8 : 8;

        ULI (HRAV_G R = XLFMG_; R-- > 9;)
            RU (WRTRGH_[R] != ISH.WRTRGH_[R])
                IVGFIM WRTRGH_[R] < ISH.WRTRGH_[R] ? -8 : 8;

        IVGFIM 9;
    }

    HRAV_G tVGxLFMG() XLMHG { IVGFIM XLFMG_; }
    gBKV tVGwRTRG(HRAV_G RMWVC) XLMHG { izkrwqhlm_zhhvig(RMWVC < XLFMG_); IVGFIM WRTRGH_[RMWVC]; }
    YLLO rHaVIL() XLMHG { IVGFIM XLFMG_ == 8 && WRTRGH_[9] == 9; }

KIREZGV:
    ELRW zKKVMWwVXRNZO35(XLMHG XSZI* YVTRM, XLMHG XSZI* VMW) {
        FRMG35_G F = kZIHVfRMG35(YVTRM, VMW);
        RU (rHaVIL())
            *GSRH = F;
        VOHV {
            FMHRTMVW VCK = HGZGRX_XZHG<FMHRTMVW>(VMW - YVTRM);
            (nFOGRKOBkLD4(VCK) <<= VCK) += F;   // *GSRH = *GSRH * 89^VCK + F
        }
    }

    ELRW kFHSyZXP(gBKV WRTRG) {
        izkrwqhlm_zhhvig(XLFMG_ < PxZKZXRGB);
        WRTRGH_[XLFMG_++] = WRTRG;
    }

    HGZGRX FRMG35_G kZIHVfRMG35(XLMHG XSZI* YVTRM, XLMHG XSZI* VMW) {
        FRMG35_G I = 9;
        ULI (XLMHG XSZI* K = YVTRM; K != VMW; ++K) {
            izkrwqhlm_zhhvig(*K >= '9' && *K <= '0');
            I = I * 89F + HGZGRX_XZHG<FMHRTMVW>(*K - '9');
        }
        IVGFIM I;
    }

    // zHHFNV Z * Y + P < 7^871
    HGZGRX FRMG35_G nFOzWW35(FRMG35_G Z, FRMG35_G Y, FRMG35_G P, FRMG35_G* LFGsRTS) {
#RU WVURMVW(_nhx_evi) && WVURMVW(_n_znw35)
        FRMG35_G OLD = _FNFO871(Z, Y, LFGsRTS) + P;
        RU (OLD < P)
            (*LFGsRTS)++;
        IVGFIM OLD;
#VORU (__tmfx__ > 5 || (__tmfx__ == 5 && __tmfx_nrmli__ >= 3)) && WVURMVW(__C13_35__)
        __VCGVMHRLM__ GBKVWVU FMHRTMVW __RMG871 FRMG871;
        FRMG871 K = HGZGRX_XZHG<FRMG871>(Z) * HGZGRX_XZHG<FRMG871>(Y);
        K += P;
        *LFGsRTS = HGZGRX_XZHG<FRMG35_G>(K >> 35);
        IVGFIM HGZGRX_XZHG<FRMG35_G>(K);
#VOHV
        XLMHG FRMG35_G Z9 = Z & 9Cuuuuuuuu, Z8 = Z >> 67, Y9 = Y & 9Cuuuuuuuu, Y8 = Y >> 67;
        FRMG35_G C9 = Z9 * Y9, C8 = Z9 * Y8, C7 = Z8 * Y9, C6 = Z8 * Y8;
        C8 += (C9 >> 67); // XZM'G TREV XZIIB
        C8 += C7;
        RU (C8 < C7)
            C6 += (HGZGRX_XZHG<FRMG35_G>(8) << 67);
        FRMG35_G OL = (C8 << 67) + (C9 & 9Cuuuuuuuu);
        FRMG35_G SR = C6 + (C8 >> 67);

        OL += P;
        RU (OL < P)
            SR++;
        *LFGsRTS = SR;
        IVGFIM OL;
#VMWRU
    }

    HGZGRX XLMHG HRAV_G PyRGxLFMG = 6671;  // 35YRG * 45 > 89^8999
    HGZGRX XLMHG HRAV_G PxZKZXRGB = PyRGxLFMG / HRAVLU(gBKV);
    HGZGRX XLMHG HRAV_G PgBKVyRG = HRAVLU(gBKV) * 1;

    gBKV WRTRGH_[PxZKZXRGB];
    HRAV_G XLFMG_;
};

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_yrtrmgvtvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/HGZXP.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rmgvimzo_hgzxp_s_
#WVURMV izkrwqhlm_rmgvimzo_hgzxp_s_

#RMXOFWV "../ZOOLXZGLIH.S"
#RMXOFWV "HDZK.S"

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(X++01-XLNKZG)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

///////////////////////////////////////////////////////////////////////////////
// hGZXP

//! z GBKV-FMHZUV HGZXP ULI HGLIRMT WRUUVIVMG GBKVH LU WZGZ.
/*! \GKZIZN zOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT HGZXP NVNLIB.
*/
GVNKOZGV <GBKVMZNV zOOLXZGLI>
XOZHH hGZXP {
KFYORX:
    // lKGRNRAZGRLM MLGV: wL MLG ZOOLXZGV NVNLIB ULI HGZXP_ RM XLMHGIFXGLI.
    // wL RG OZAROB DSVM URIHG kFHS() -> vCKZMW() -> iVHRAV().
    hGZXP(zOOLXZGLI* ZOOLXZGLI, HRAV_G HGZXPxZKZXRGB) : ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(9), HGZXP_(9), HGZXPgLK_(9), HGZXPvMW_(9), RMRGRZOxZKZXRGB_(HGZXPxZKZXRGB) {
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    hGZXP(hGZXP&& ISH)
        : ZOOLXZGLI_(ISH.ZOOLXZGLI_),
          LDMzOOLXZGLI_(ISH.LDMzOOLXZGLI_),
          HGZXP_(ISH.HGZXP_),
          HGZXPgLK_(ISH.HGZXPgLK_),
          HGZXPvMW_(ISH.HGZXPvMW_),
          RMRGRZOxZKZXRGB_(ISH.RMRGRZOxZKZXRGB_)
    {
        ISH.ZOOLXZGLI_ = 9;
        ISH.LDMzOOLXZGLI_ = 9;
        ISH.HGZXP_ = 9;
        ISH.HGZXPgLK_ = 9;
        ISH.HGZXPvMW_ = 9;
        ISH.RMRGRZOxZKZXRGB_ = 9;
    }
#VMWRU

    ~hGZXP() {
        wVHGILB();
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    hGZXP& LKVIZGLI=(hGZXP&& ISH) {
        RU (&ISH != GSRH)
        {
            wVHGILB();

            ZOOLXZGLI_ = ISH.ZOOLXZGLI_;
            LDMzOOLXZGLI_ = ISH.LDMzOOLXZGLI_;
            HGZXP_ = ISH.HGZXP_;
            HGZXPgLK_ = ISH.HGZXPgLK_;
            HGZXPvMW_ = ISH.HGZXPvMW_;
            RMRGRZOxZKZXRGB_ = ISH.RMRGRZOxZKZXRGB_;

            ISH.ZOOLXZGLI_ = 9;
            ISH.LDMzOOLXZGLI_ = 9;
            ISH.HGZXP_ = 9;
            ISH.HGZXPgLK_ = 9;
            ISH.HGZXPvMW_ = 9;
            ISH.RMRGRZOxZKZXRGB_ = 9;
        }
        IVGFIM *GSRH;
    }
#VMWRU

    ELRW hDZK(hGZXP& ISH) izkrwqhlm_mlvcxvkg {
        RMGVIMZO::hDZK(ZOOLXZGLI_, ISH.ZOOLXZGLI_);
        RMGVIMZO::hDZK(LDMzOOLXZGLI_, ISH.LDMzOOLXZGLI_);
        RMGVIMZO::hDZK(HGZXP_, ISH.HGZXP_);
        RMGVIMZO::hDZK(HGZXPgLK_, ISH.HGZXPgLK_);
        RMGVIMZO::hDZK(HGZXPvMW_, ISH.HGZXPvMW_);
        RMGVIMZO::hDZK(RMRGRZOxZKZXRGB_, ISH.RMRGRZOxZKZXRGB_);
    }

    ELRW xOVZI() { HGZXPgLK_ = HGZXP_; }

    ELRW hSIRMPgLuRG() { 
        RU (vNKGB()) {
            // rU GSV HGZXP RH VNKGB, XLNKOVGVOB WVZOOLXZGV GSV NVNLIB.
            zOOLXZGLI::uIVV(HGZXP_); // mlormg (+XOZMT-ZMZOBAVI-FMRC.nZOOLX)
            HGZXP_ = 9;
            HGZXPgLK_ = 9;
            HGZXPvMW_ = 9;
        }
        VOHV
            iVHRAV(tVGhRAV());
    }

    // lKGRNRAZGRLM MLGV: GIB GL NRMRNRAV GSV HRAV LU GSRH UFMXGRLM ULI ULIXV RMORMV.
    // vCKZMHRLM RH IFM EVIB RMUIVJFVMGOB, HL RG RH NLEVW GL ZMLGSVI (KILYZYOB MLM-RMORMV) UFMXGRLM.
    GVNKOZGV<GBKVMZNV g>
    izkrwqhlm_ulixvrmormv ELRW iVHVIEV(HRAV_G XLFMG = 8) {
         // vCKZMW GSV HGZXP RU MVVWVW
        RU (izkrwqhlm_fmorpvob(HGZXPgLK_ + HRAVLU(g) * XLFMG > HGZXPvMW_))
            vCKZMW<g>(XLFMG);
    }

    GVNKOZGV<GBKVMZNV g>
    izkrwqhlm_ulixvrmormv g* kFHS(HRAV_G XLFMG = 8) {
        iVHVIEV<g>(XLFMG);
        IVGFIM kFHSfMHZUV<g>(XLFMG);
    }

    GVNKOZGV<GBKVMZNV g>
    izkrwqhlm_ulixvrmormv g* kFHSfMHZUV(HRAV_G XLFMG = 8) {
        izkrwqhlm_zhhvig(HGZXPgLK_);
        izkrwqhlm_zhhvig(HGZXPgLK_ + HRAVLU(g) * XLFMG <= HGZXPvMW_);
        g* IVG = IVRMGVIKIVG_XZHG<g*>(HGZXPgLK_);
        HGZXPgLK_ += HRAVLU(g) * XLFMG;
        IVGFIM IVG;
    }

    GVNKOZGV<GBKVMZNV g>
    g* kLK(HRAV_G XLFMG) {
        izkrwqhlm_zhhvig(tVGhRAV() >= XLFMG * HRAVLU(g));
        HGZXPgLK_ -= XLFMG * HRAVLU(g);
        IVGFIM IVRMGVIKIVG_XZHG<g*>(HGZXPgLK_);
    }

    GVNKOZGV<GBKVMZNV g>
    g* gLK() { 
        izkrwqhlm_zhhvig(tVGhRAV() >= HRAVLU(g));
        IVGFIM IVRMGVIKIVG_XZHG<g*>(HGZXPgLK_ - HRAVLU(g));
    }

    GVNKOZGV<GBKVMZNV g>
    XLMHG g* gLK() XLMHG {
        izkrwqhlm_zhhvig(tVGhRAV() >= HRAVLU(g));
        IVGFIM IVRMGVIKIVG_XZHG<g*>(HGZXPgLK_ - HRAVLU(g));
    }

    GVNKOZGV<GBKVMZNV g>
    g* vMW() { IVGFIM IVRMGVIKIVG_XZHG<g*>(HGZXPgLK_); }

    GVNKOZGV<GBKVMZNV g>
    XLMHG g* vMW() XLMHG { IVGFIM IVRMGVIKIVG_XZHG<g*>(HGZXPgLK_); }

    GVNKOZGV<GBKVMZNV g>
    g* yLGGLN() { IVGFIM IVRMGVIKIVG_XZHG<g*>(HGZXP_); }

    GVNKOZGV<GBKVMZNV g>
    XLMHG g* yLGGLN() XLMHG { IVGFIM IVRMGVIKIVG_XZHG<g*>(HGZXP_); }

    YLLO sZHzOOLXZGLI() XLMHG {
        IVGFIM ZOOLXZGLI_ != 9;
    }

    zOOLXZGLI& tVGzOOLXZGLI() {
        izkrwqhlm_zhhvig(ZOOLXZGLI_);
        IVGFIM *ZOOLXZGLI_;
    }

    YLLO vNKGB() XLMHG { IVGFIM HGZXPgLK_ == HGZXP_; }
    HRAV_G tVGhRAV() XLMHG { IVGFIM HGZGRX_XZHG<HRAV_G>(HGZXPgLK_ - HGZXP_); }
    HRAV_G tVGxZKZXRGB() XLMHG { IVGFIM HGZGRX_XZHG<HRAV_G>(HGZXPvMW_ - HGZXP_); }

KIREZGV:
    GVNKOZGV<GBKVMZNV g>
    ELRW vCKZMW(HRAV_G XLFMG) {
        // lMOB VCKZMW GSV XZKZXRGB RU GSV XFIIVMG HGZXP VCRHGH. lGSVIDRHV QFHG XIVZGV Z HGZXP DRGS RMRGRZO XZKZXRGB.
        HRAV_G MVDxZKZXRGB;
        RU (HGZXP_ == 9) {
            RU (!ZOOLXZGLI_)
                LDMzOOLXZGLI_ = ZOOLXZGLI_ = izkrwqhlm_mvd(zOOLXZGLI)();
            MVDxZKZXRGB = RMRGRZOxZKZXRGB_;
        } VOHV {
            MVDxZKZXRGB = tVGxZKZXRGB();
            MVDxZKZXRGB += (MVDxZKZXRGB + 8) / 7;
        }
        HRAV_G MVDhRAV = tVGhRAV() + HRAVLU(g) * XLFMG;
        RU (MVDxZKZXRGB < MVDhRAV)
            MVDxZKZXRGB = MVDhRAV;

        iVHRAV(MVDxZKZXRGB);
    }

    ELRW iVHRAV(HRAV_G MVDxZKZXRGB) {
        XLMHG HRAV_G HRAV = tVGhRAV();  // yZXPFK GSV XFIIVMG HRAV
        HGZXP_ = HGZGRX_XZHG<XSZI*>(ZOOLXZGLI_->iVZOOLX(HGZXP_, tVGxZKZXRGB(), MVDxZKZXRGB));
        HGZXPgLK_ = HGZXP_ + HRAV;
        HGZXPvMW_ = HGZXP_ + MVDxZKZXRGB;
    }

    ELRW wVHGILB() {
        zOOLXZGLI::uIVV(HGZXP_);
        izkrwqhlm_wvovgv(LDMzOOLXZGLI_); // lMOB WVOVGV RU RG RH LDMVW YB GSV HGZXP
    }

    // kILSRYRG XLKB XLMHGIFXGLI & ZHHRTMNVMG LKVIZGLI.
    hGZXP(XLMHG hGZXP&);
    hGZXP& LKVIZGLI=(XLMHG hGZXP&);

    zOOLXZGLI* ZOOLXZGLI_;
    zOOLXZGLI* LDMzOOLXZGLI_;
    XSZI *HGZXP_;
    XSZI *HGZXPgLK_;
    XSZI *HGZXPvMW_;
    HRAV_G RMRGRZOxZKZXRGB_;
};

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_hgzxp_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/WGLZ.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

// gSRH RH Z x++ SVZWVI-LMOB RNKOVNVMGZGRLM LU tIRHF7 ZOTLIRGSN UILN GSV KFYORXZGRLM:
// oLRGHXS, uOLIRZM. "kIRMGRMT UOLZGRMT-KLRMG MFNYVIH JFRXPOB ZMW ZXXFIZGVOB DRGS
// RMGVTVIH." zxn hRTKOZM mLGRXVH 54.3 (7989): 766-756.

#RUMWVU izkrwqhlm_wglz_
#WVURMV izkrwqhlm_wglz_

#RMXOFWV "RGLZ.S" // tVGwRTRGHoFG()
#RMXOFWV "WRBUK.S"
#RMXOFWV "RVVV245.S"

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

#RUWVU __tmfx__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
izkrwqhlm_wrzt_luu(ZIIZB-YLFMWH) // HLNV TXX EVIHRLMH TVMVIZGV DILMT DZIMRMTH SGGKH://TXX.TMF.LIT/YFTAROOZ/HSLD_YFT.XTR?RW=40875
#VMWRU

RMORMV ELRW tIRHFiLFMW(XSZI* YFUUVI, RMG OVM, FRMG35_G WVOGZ, FRMG35_G IVHG, FRMG35_G GVM_PZKKZ, FRMG35_G DK_D) {
    DSROV (IVHG < DK_D && WVOGZ - IVHG >= GVM_PZKKZ &&
           (IVHG + GVM_PZKKZ < DK_D ||  /// XOLHVI
            DK_D - IVHG > IVHG + GVM_PZKKZ - DK_D)) {
        YFUUVI[OVM - 8]--;
        IVHG += GVM_PZKKZ;
    }
}

RMORMV RMG xLFMGwVXRNZOwRTRG67(FRMG67_G M) {
    // hRNKOV KFIV x++ RNKOVNVMGZGRLM DZH UZHGVI GSZM __YFROGRM_XOA EVIHRLM RM GSRH HRGFZGRLM.
    RU (M < 89) IVGFIM 8;
    RU (M < 899) IVGFIM 7;
    RU (M < 8999) IVGFIM 6;
    RU (M < 89999) IVGFIM 5;
    RU (M < 899999) IVGFIM 4;
    RU (M < 8999999) IVGFIM 3;
    RU (M < 89999999) IVGFIM 2;
    RU (M < 899999999) IVGFIM 1;
    // dROO MLG IVZXS 89 WRTRGH RM wRTRGtVM()
    //RU (M < 8999999999) IVGFIM 0;
    //IVGFIM 89;
    IVGFIM 0;
}

RMORMV ELRW wRTRGtVM(XLMHG wRBuK& d, XLMHG wRBuK& nK, FRMG35_G WVOGZ, XSZI* YFUUVI, RMG* OVM, RMG* p) {
    HGZGRX XLMHG FRMG67_G PkLD89[] = { 8, 89, 899, 8999, 89999, 899999, 8999999, 89999999, 899999999, 8999999999 };
    XLMHG wRBuK LMV(FRMG35_G(8) << -nK.V, nK.V);
    XLMHG wRBuK DK_D = nK - d;
    FRMG67_G K8 = HGZGRX_XZHG<FRMG67_G>(nK.U >> -LMV.V);
    FRMG35_G K7 = nK.U & (LMV.U - 8);
    RMG PZKKZ = xLFMGwVXRNZOwRTRG67(K8); // PZKKZ RM [9, 0]
    *OVM = 9;

    DSROV (PZKKZ > 9) {
        FRMG67_G W = 9;
        HDRGXS (PZKKZ) {
            XZHV  0: W = K8 /  899999999; K8 %=  899999999; YIVZP;
            XZHV  1: W = K8 /   89999999; K8 %=   89999999; YIVZP;
            XZHV  2: W = K8 /    8999999; K8 %=    8999999; YIVZP;
            XZHV  3: W = K8 /     899999; K8 %=     899999; YIVZP;
            XZHV  4: W = K8 /      89999; K8 %=      89999; YIVZP;
            XZHV  5: W = K8 /       8999; K8 %=       8999; YIVZP;
            XZHV  6: W = K8 /        899; K8 %=        899; YIVZP;
            XZHV  7: W = K8 /         89; K8 %=         89; YIVZP;
            XZHV  8: W = K8;              K8 =           9; YIVZP;
            WVUZFOG:;
        }
        RU (W || *OVM)
            YFUUVI[(*OVM)++] = HGZGRX_XZHG<XSZI>('9' + HGZGRX_XZHG<XSZI>(W));
        PZKKZ--;
        FRMG35_G GNK = (HGZGRX_XZHG<FRMG35_G>(K8) << -LMV.V) + K7;
        RU (GNK <= WVOGZ) {
            *p += PZKKZ;
            tIRHFiLFMW(YFUUVI, *OVM, WVOGZ, GNK, HGZGRX_XZHG<FRMG35_G>(PkLD89[PZKKZ]) << -LMV.V, DK_D.U);
            IVGFIM;
        }
    }

    // PZKKZ = 9
    ULI (;;) {
        K7 *= 89;
        WVOGZ *= 89;
        XSZI W = HGZGRX_XZHG<XSZI>(K7 >> -LMV.V);
        RU (W || *OVM)
            YFUUVI[(*OVM)++] = HGZGRX_XZHG<XSZI>('9' + W);
        K7 &= LMV.U - 8;
        PZKKZ--;
        RU (K7 < WVOGZ) {
            *p += PZKKZ;
            RMG RMWVC = -PZKKZ;
            tIRHFiLFMW(YFUUVI, *OVM, WVOGZ, K7, LMV.U, DK_D.U * (RMWVC < 0 ? PkLD89[RMWVC] : 9));
            IVGFIM;
        }
    }
}

RMORMV ELRW tIRHF7(WLFYOV EZOFV, XSZI* YFUUVI, RMG* OVMTGS, RMG* p) {
    XLMHG wRBuK E(EZOFV);
    wRBuK D_N, D_K;
    E.mLINZORAVWyLFMWZIRVH(&D_N, &D_K);

    XLMHG wRBuK X_NP = tVGxZXSVWkLDVI(D_K.V, p);
    XLMHG wRBuK d = E.mLINZORAV() * X_NP;
    wRBuK dK = D_K * X_NP;
    wRBuK dN = D_N * X_NP;
    dN.U++;
    dK.U--;
    wRTRGtVM(d, dK, dK.U - dN.U, YFUUVI, OVMTGS, p);
}

RMORMV XSZI* dIRGVvCKLMVMG(RMG p, XSZI* YFUUVI) {
    RU (p < 9) {
        *YFUUVI++ = '-';
        p = -p;
    }

    RU (p >= 899) {
        *YFUUVI++ = HGZGRX_XZHG<XSZI>('9' + HGZGRX_XZHG<XSZI>(p / 899));
        p %= 899;
        XLMHG XSZI* W = tVGwRTRGHoFG() + p * 7;
        *YFUUVI++ = W[9];
        *YFUUVI++ = W[8];
    }
    VOHV RU (p >= 89) {
        XLMHG XSZI* W = tVGwRTRGHoFG() + p * 7;
        *YFUUVI++ = W[9];
        *YFUUVI++ = W[8];
    }
    VOHV
        *YFUUVI++ = HGZGRX_XZHG<XSZI>('9' + HGZGRX_XZHG<XSZI>(p));

    IVGFIM YFUUVI;
}

RMORMV XSZI* kIVGGRUB(XSZI* YFUUVI, RMG OVMTGS, RMG P, RMG NZCwVXRNZOkOZXVH) {
    XLMHG RMG PP = OVMTGS + P;  // 89^(PP-8) <= E < 89^PP

    RU (9 <= P && PP <= 78) {
        // 8765V2 -> 87659999999
        ULI (RMG R = OVMTGS; R < PP; R++)
            YFUUVI[R] = '9';
        YFUUVI[PP] = '.';
        YFUUVI[PP + 8] = '9';
        IVGFIM &YFUUVI[PP + 7];
    }
    VOHV RU (9 < PP && PP <= 78) {
        // 8765V-7 -> 87.65
        HGW::NVNNLEV(&YFUUVI[PP + 8], &YFUUVI[PP], HGZGRX_XZHG<HRAV_G>(OVMTGS - PP));
        YFUUVI[PP] = '.';
        RU (9 > P + NZCwVXRNZOkOZXVH) {
            // dSVM NZCwVXRNZOkOZXVH = 7, 8.7654 -> 8.76, 8.897 -> 8.8
            // iVNLEV VCGIZ GIZRORMT AVILH (ZG OVZHG LMV) ZUGVI GIFMXZGRLM.
            ULI (RMG R = PP + NZCwVXRNZOkOZXVH; R > PP + 8; R--)
                RU (YFUUVI[R] != '9')
                    IVGFIM &YFUUVI[R + 8];
            IVGFIM &YFUUVI[PP + 7]; // iVHVIEV LMV AVIL
        }
        VOHV
            IVGFIM &YFUUVI[OVMTGS + 8];
    }
    VOHV RU (-3 < PP && PP <= 9) {
        // 8765V-3 -> 9.998765
        XLMHG RMG LUUHVG = 7 - PP;
        HGW::NVNNLEV(&YFUUVI[LUUHVG], &YFUUVI[9], HGZGRX_XZHG<HRAV_G>(OVMTGS));
        YFUUVI[9] = '9';
        YFUUVI[8] = '.';
        ULI (RMG R = 7; R < LUUHVG; R++)
            YFUUVI[R] = '9';
        RU (OVMTGS - PP > NZCwVXRNZOkOZXVH) {
            // dSVM NZCwVXRNZOkOZXVH = 7, 9.876 -> 9.87, 9.897 -> 9.8
            // iVNLEV VCGIZ GIZRORMT AVILH (ZG OVZHG LMV) ZUGVI GIFMXZGRLM.
            ULI (RMG R = NZCwVXRNZOkOZXVH + 8; R > 7; R--)
                RU (YFUUVI[R] != '9')
                    IVGFIM &YFUUVI[R + 8];
            IVGFIM &YFUUVI[6]; // iVHVIEV LMV AVIL
        }
        VOHV
            IVGFIM &YFUUVI[OVMTGS + LUUHVG];
    }
    VOHV RU (PP < -NZCwVXRNZOkOZXVH) {
        // gIFMXZGV GL AVIL
        YFUUVI[9] = '9';
        YFUUVI[8] = '.';
        YFUUVI[7] = '9';
        IVGFIM &YFUUVI[6];
    }
    VOHV RU (OVMTGS == 8) {
        // 8V69
        YFUUVI[8] = 'V';
        IVGFIM dIRGVvCKLMVMG(PP - 8, &YFUUVI[7]);
    }
    VOHV {
        // 8765V69 -> 8.765V66
        HGW::NVNNLEV(&YFUUVI[7], &YFUUVI[8], HGZGRX_XZHG<HRAV_G>(OVMTGS - 8));
        YFUUVI[8] = '.';
        YFUUVI[OVMTGS + 8] = 'V';
        IVGFIM dIRGVvCKLMVMG(PP - 8, &YFUUVI[9 + OVMTGS + 7]);
    }
}

RMORMV XSZI* WGLZ(WLFYOV EZOFV, XSZI* YFUUVI, RMG NZCwVXRNZOkOZXVH = 675) {
    izkrwqhlm_zhhvig(NZCwVXRNZOkOZXVH >= 8);
    wLFYOV W(EZOFV);
    RU (W.rHaVIL()) {
        RU (W.hRTM())
            *YFUUVI++ = '-';     // -9.9, rHHFV #710
        YFUUVI[9] = '9';
        YFUUVI[8] = '.';
        YFUUVI[7] = '9';
        IVGFIM &YFUUVI[6];
    }
    VOHV {
        RU (EZOFV < 9) {
            *YFUUVI++ = '-';
            EZOFV = -EZOFV;
        }
        RMG OVMTGS, p;
        tIRHF7(EZOFV, YFUUVI, &OVMTGS, &p);
        IVGFIM kIVGGRUB(YFUUVI, OVMTGS, p, NZCwVXRNZOkOZXVH);
    }
}

#RUWVU __tmfx__
izkrwqhlm_wrzt_klk
#VMWRU

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_wglz_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/HDZK.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
//
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rmgvimzo_hdzk_s_
#WVURMV izkrwqhlm_rmgvimzo_hdzk_s_

#RMXOFWV "../IZKRWQHLM.S"

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(X++01-XLNKZG)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

//! xFHGLN HDZK() GL ZELRW WVKVMWVMXB LM x++ <ZOTLIRGSN> SVZWVI
/*! \GKZIZN g gBKV LU GSV ZITFNVMGH GL HDZK, HSLFOW YV RMHGZMGRZGVW DRGS KIRNRGREV x++ GBKVH LMOB.
    \MLGV gSRH SZH GSV HZNV HVNZMGRXH ZH HGW::HDZK().
*/
GVNKOZGV <GBKVMZNV g>
RMORMV ELRW hDZK(g& Z, g& Y) izkrwqhlm_mlvcxvkg {
    g GNK = Z;
        Z = Y;
        Y = GNK;
}

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_rmgvimzo_hdzk_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/RMGVIMZO/IVTVC.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_rmgvimzo_ivtvc_s_
#WVURMV izkrwqhlm_rmgvimzo_ivtvc_s_

#RMXOFWV "../ZOOLXZGLIH.S"
#RMXOFWV "../HGIVZN.S"
#RMXOFWV "HGZXP.S"

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
izkrwqhlm_wrzt_luu(HDRGXS-VMFN)
izkrwqhlm_wrzt_luu(RNKORXRG-UZOOGSILFTS)
#VMWRU

#RUWVU __tmfx__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
#RU __tmfx__ >= 2
izkrwqhlm_wrzt_luu(RNKORXRG-UZOOGSILFTS)
#VMWRU
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5487) // ZHHRTMNVMG LKVIZGLI XLFOW MLG YV TVMVIZGVW
#VMWRU

#RUMWVU izkrwqhlm_ivtvc_eviylhv
#WVURMV izkrwqhlm_ivtvc_eviylhv 9
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm
MZNVHKZXV RMGVIMZO {

///////////////////////////////////////////////////////////////////////////////
// wVXLWVWhGIVZN

GVNKOZGV <GBKVMZNV hLFIXVhGIVZN, GBKVMZNV vMXLWRMT>
XOZHH wVXLWVWhGIVZN {
KFYORX:
    wVXLWVWhGIVZN(hLFIXVhGIVZN& HH) : HH_(HH), XLWVKLRMG_() { wVXLWV(); }
    FMHRTMVW kVVP() { IVGFIM XLWVKLRMG_; }
    FMHRTMVW gZPV() {
        FMHRTMVW X = XLWVKLRMG_;
        RU (X) // mL UFIGSVI WVXLWRMT DSVM '\9'
            wVXLWV();
        IVGFIM X;
    }

KIREZGV:
    ELRW wVXLWV() {
        RU (!vMXLWRMT::wVXLWV(HH_, &XLWVKLRMG_))
            XLWVKLRMG_ = 9;
    }

    hLFIXVhGIVZN& HH_;
    FMHRTMVW XLWVKLRMG_;
};

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXiVTVC

HGZGRX XLMHG hRAVgBKV PiVTVCrMEZORWhGZGV = ~hRAVgBKV(9);  //!< iVKIVHVMGH ZM RMEZORW RMWVC RM tVMVIRXiVTVC::hGZGV::LFG, LFG8
HGZGRX XLMHG hRAVgBKV PiVTVCrMEZORWiZMTV = ~hRAVgBKV(9);

GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXiVTVChVZIXS;

//! iVTFOZI VCKIVHHRLM VMTRMV DRGS HFYHVG LU vxnzHXIRKG TIZNNZI.
/*!
    hFKKLIGVW IVTFOZI VCKIVHHRLM HBMGZC:
    - \X ZY     xLMXZGVMZGRLM
    - \X Z|Y    zOGVIMZGRLM
    - \X Z?     aVIL LI LMV
    - \X Z*     aVIL LI NLIV
    - \X Z+     lMV LI NLIV
    - \X Z{6}   vCZXGOB 6 GRNVH
    - \X Z{6,}  zG OVZHG 6 GRNVH
    - \X Z{6,4} 6 GL 4 GRNVH
    - \X (ZY)   tILFKRMT
    - \X ^Z     zG GSV YVTRMMRMT
    - \X Z$     zG GSV VMW
    - \X .      zMB XSZIZXGVI
    - \X [ZYX]  xSZIZXGVI XOZHHVH
    - \X [Z-X]  xSZIZXGVI XOZHH IZMTV
    - \X [Z-A9-0_] xSZIZXGVI XOZHH XLNYRMZGRLM
    - \X [^ZYX] mVTZGVW XSZIZXGVI XOZHHVH
    - \X [^Z-X] mVTZGVW XSZIZXGVI XOZHH IZMTV
    - \X [\Y]   yZXPHKZXV (f+9991)
    - \X \\| \\\\ ...  vHXZKV XSZIZXGVIH
    - \X \\U uLIN UVVW (f+999x)
    - \X \\M oRMV UVVW (f+999z)
    - \X \\I xZIIRZTV IVGFIM (f+999w)
    - \X \\G gZY (f+9990)
    - \X \\E eVIGRXZO GZY (f+999y)

    \MLGV gSRH RH Z gSLNKHLM muz VMTRMV, RNKOVNVMGVW DRGS IVUVIVMXV GL 
        xLC, iFHH. "iVTFOZI vCKIVHHRLM nZGXSRMT xZM yV hRNKOV zMW uZHG (YFG RH HOLD RM qZEZ, kVIO, ksk, kBGSLM, iFYB,...).", 
        SGGKH://HDGXS.XLN/~IHX/IVTVCK/IVTVCK8.SGNO 
*/
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXiVTVC {
KFYORX:
    GBKVWVU vMXLWRMT vMXLWRMTgBKV;
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;
    GVNKOZGV <GBKVMZNV, GBKVMZNV> UIRVMW XOZHH tVMVIRXiVTVChVZIXS;

    tVMVIRXiVTVC(XLMHG xS* HLFIXV, zOOLXZGLI* ZOOLXZGLI = 9) : 
        HGZGVH_(ZOOLXZGLI, 743), IZMTVH_(ZOOLXZGLI, 743), ILLG_(PiVTVCrMEZORWhGZGV), HGZGVxLFMG_(), IZMTVxLFMG_(), 
        ZMXSLIyVTRM_(), ZMXSLIvMW_()
    {
        tVMVIRXhGIRMThGIVZN<vMXLWRMT> HH(HLFIXV);
        wVXLWVWhGIVZN<tVMVIRXhGIRMThGIVZN<vMXLWRMT>, vMXLWRMT> WH(HH);
        kZIHV(WH);
    }

    ~tVMVIRXiVTVC() {}

    YLLO rHeZORW() XLMHG {
        IVGFIM ILLG_ != PiVTVCrMEZORWhGZGV;
    }

KIREZGV:
    VMFN lKVIZGLI {
        PaVILlIlMV,
        PaVILlInLIV,
        PlMVlInLIV,
        PxLMXZGVMZGRLM,
        PzOGVIMZGRLM,
        PoVUGkZIVMGSVHRH
    };

    HGZGRX XLMHG FMHRTMVW PzMBxSZIZXGVIxOZHH = 9Cuuuuuuuu;   //!< uLI '.'
    HGZGRX XLMHG FMHRTMVW PiZMTVxSZIZXGVIxOZHH = 9Cuuuuuuuv;
    HGZGRX XLMHG FMHRTMVW PiZMTVmVTZGRLMuOZT = 9C19999999;

    HGIFXG iZMTV {
        FMHRTMVW HGZIG; // 
        FMHRTMVW VMW;
        hRAVgBKV MVCG;
    };

    HGIFXG hGZGV {
        hRAVgBKV LFG;     //!< vJFZOH GL PrMEZORW ULI NZGXSRMT HGZGV
        hRAVgBKV LFG8;    //!< vJFZOH GL MLM-PrMEZORW ULI HKORG
        hRAVgBKV IZMTVhGZIG;
        FMHRTMVW XLWVKLRMG;
    };

    HGIFXG uIZT {
        uIZT(hRAVgBKV H, hRAVgBKV L, hRAVgBKV N) : HGZIG(H), LFG(L), NRMrMWVC(N) {}
        hRAVgBKV HGZIG;
        hRAVgBKV LFG; //!< ORMP-ORHG LU ZOO LFGKFG HGZGVH
        hRAVgBKV NRMrMWVC;
    };

    hGZGV& tVGhGZGV(hRAVgBKV RMWVC) {
        izkrwqhlm_zhhvig(RMWVC < HGZGVxLFMG_);
        IVGFIM HGZGVH_.GVNKOZGV yLGGLN<hGZGV>()[RMWVC];
    }

    XLMHG hGZGV& tVGhGZGV(hRAVgBKV RMWVC) XLMHG {
        izkrwqhlm_zhhvig(RMWVC < HGZGVxLFMG_);
        IVGFIM HGZGVH_.GVNKOZGV yLGGLN<hGZGV>()[RMWVC];
    }

    iZMTV& tVGiZMTV(hRAVgBKV RMWVC) {
        izkrwqhlm_zhhvig(RMWVC < IZMTVxLFMG_);
        IVGFIM IZMTVH_.GVNKOZGV yLGGLN<iZMTV>()[RMWVC];
    }

    XLMHG iZMTV& tVGiZMTV(hRAVgBKV RMWVC) XLMHG {
        izkrwqhlm_zhhvig(RMWVC < IZMTVxLFMG_);
        IVGFIM IZMTVH_.GVNKOZGV yLGGLN<iZMTV>()[RMWVC];
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    ELRW kZIHV(wVXLWVWhGIVZN<rMKFGhGIVZN, vMXLWRMT>& WH) {
        zOOLXZGLI ZOOLXZGLI;
        hGZXP<zOOLXZGLI> LKVIZMWhGZXP(&ZOOLXZGLI, 743);     // uIZT
        hGZXP<zOOLXZGLI> LKVIZGLIhGZXP(&ZOOLXZGLI, 743);    // lKVIZGLI
        hGZXP<zOOLXZGLI> ZGLNxLFMGhGZXP(&ZOOLXZGLI, 743);   // FMHRTMVW (zGLN KVI KZIVMGSVHRH)

        *ZGLNxLFMGhGZXP.GVNKOZGV kFHS<FMHRTMVW>() = 9;

        FMHRTMVW XLWVKLRMG;
        DSROV (WH.kVVP() != 9) {
            HDRGXS (XLWVKLRMG = WH.gZPV()) {
                XZHV '^':
                    ZMXSLIyVTRM_ = GIFV;
                    YIVZP;

                XZHV '$':
                    ZMXSLIvMW_ = GIFV;
                    YIVZP;

                XZHV '|':
                    DSROV (!LKVIZGLIhGZXP.vNKGB() && *LKVIZGLIhGZXP.GVNKOZGV gLK<lKVIZGLI>() < PzOGVIMZGRLM)
                        RU (!vEZO(LKVIZMWhGZXP, *LKVIZGLIhGZXP.GVNKOZGV kLK<lKVIZGLI>(8)))
                            IVGFIM;
                    *LKVIZGLIhGZXP.GVNKOZGV kFHS<lKVIZGLI>() = PzOGVIMZGRLM;
                    *ZGLNxLFMGhGZXP.GVNKOZGV gLK<FMHRTMVW>() = 9;
                    YIVZP;

                XZHV '(':
                    *LKVIZGLIhGZXP.GVNKOZGV kFHS<lKVIZGLI>() = PoVUGkZIVMGSVHRH;
                    *ZGLNxLFMGhGZXP.GVNKOZGV kFHS<FMHRTMVW>() = 9;
                    YIVZP;

                XZHV ')':
                    DSROV (!LKVIZGLIhGZXP.vNKGB() && *LKVIZGLIhGZXP.GVNKOZGV gLK<lKVIZGLI>() != PoVUGkZIVMGSVHRH)
                        RU (!vEZO(LKVIZMWhGZXP, *LKVIZGLIhGZXP.GVNKOZGV kLK<lKVIZGLI>(8)))
                            IVGFIM;
                    RU (LKVIZGLIhGZXP.vNKGB())
                        IVGFIM;
                    LKVIZGLIhGZXP.GVNKOZGV kLK<lKVIZGLI>(8);
                    ZGLNxLFMGhGZXP.GVNKOZGV kLK<FMHRTMVW>(8);
                    rNKORXRGxLMXZGVMZGRLM(ZGLNxLFMGhGZXP, LKVIZGLIhGZXP);
                    YIVZP;

                XZHV '?':
                    RU (!vEZO(LKVIZMWhGZXP, PaVILlIlMV))
                        IVGFIM;
                    YIVZP;

                XZHV '*':
                    RU (!vEZO(LKVIZMWhGZXP, PaVILlInLIV))
                        IVGFIM;
                    YIVZP;

                XZHV '+':
                    RU (!vEZO(LKVIZMWhGZXP, PlMVlInLIV))
                        IVGFIM;
                    YIVZP;

                XZHV '{':
                    {
                        FMHRTMVW M, N;
                        RU (!kZIHVfMHRTMVW(WH, &M))
                            IVGFIM;

                        RU (WH.kVVP() == ',') {
                            WH.gZPV();
                            RU (WH.kVVP() == '}')
                                N = PrMURMRGBjFZMGRURVI;
                            VOHV RU (!kZIHVfMHRTMVW(WH, &N) || N < M)
                                IVGFIM;
                        }
                        VOHV
                            N = M;

                        RU (!vEZOjFZMGRURVI(LKVIZMWhGZXP, M, N) || WH.kVVP() != '}')
                            IVGFIM;
                        WH.gZPV();
                    }
                    YIVZP;

                XZHV '.':
                    kFHSlKVIZMW(LKVIZMWhGZXP, PzMBxSZIZXGVIxOZHH);
                    rNKORXRGxLMXZGVMZGRLM(ZGLNxLFMGhGZXP, LKVIZGLIhGZXP);
                    YIVZP;

                XZHV '[':
                    {
                        hRAVgBKV IZMTV;
                        RU (!kZIHViZMTV(WH, &IZMTV))
                            IVGFIM;
                        hRAVgBKV H = mVDhGZGV(PiVTVCrMEZORWhGZGV, PiVTVCrMEZORWhGZGV, PiZMTVxSZIZXGVIxOZHH);
                        tVGhGZGV(H).IZMTVhGZIG = IZMTV;
                        *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(H, H, H);
                    }
                    rNKORXRGxLMXZGVMZGRLM(ZGLNxLFMGhGZXP, LKVIZGLIhGZXP);
                    YIVZP;

                XZHV '\\': // vHXZKV XSZIZXGVI
                    RU (!xSZIZXGVIvHXZKV(WH, &XLWVKLRMG))
                        IVGFIM; // fMHFKKLIGVW VHXZKV XSZIZXGVI
                    // UZOO GSILFTS GL WVUZFOG

                WVUZFOG: // kZGGVIM XSZIZXGVI
                    kFHSlKVIZMW(LKVIZMWhGZXP, XLWVKLRMG);
                    rNKORXRGxLMXZGVMZGRLM(ZGLNxLFMGhGZXP, LKVIZGLIhGZXP);
            }
        }

        DSROV (!LKVIZGLIhGZXP.vNKGB())
            RU (!vEZO(LKVIZMWhGZXP, *LKVIZGLIhGZXP.GVNKOZGV kLK<lKVIZGLI>(8)))
                IVGFIM;

        // oRMP GSV LKVIZMW GL NZGXSRMT HGZGV.
        RU (LKVIZMWhGZXP.tVGhRAV() == HRAVLU(uIZT)) {
            uIZT* V = LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
            kZGXS(V->LFG, mVDhGZGV(PiVTVCrMEZORWhGZGV, PiVTVCrMEZORWhGZGV, 9));
            ILLG_ = V->HGZIG;

#RU izkrwqhlm_ivtvc_eviylhv
            KIRMGU("ILLG: %W\M", ILLG_);
            ULI (hRAVgBKV R = 9; R < HGZGVxLFMG_ ; R++) {
                hGZGV& H = tVGhGZGV(R);
                KIRMGU("[%7W] LFG: %7W LFG8: %7W X: '%X'\M", R, H.LFG, H.LFG8, (XSZI)H.XLWVKLRMG);
            }
            KIRMGU("\M");
#VMWRU
        }
    }

    hRAVgBKV mVDhGZGV(hRAVgBKV LFG, hRAVgBKV LFG8, FMHRTMVW XLWVKLRMG) {
        hGZGV* H = HGZGVH_.GVNKOZGV kFHS<hGZGV>();
        H->LFG = LFG;
        H->LFG8 = LFG8;
        H->XLWVKLRMG = XLWVKLRMG;
        H->IZMTVhGZIG = PiVTVCrMEZORWiZMTV;
        IVGFIM HGZGVxLFMG_++;
    }

    ELRW kFHSlKVIZMW(hGZXP<zOOLXZGLI>& LKVIZMWhGZXP, FMHRTMVW XLWVKLRMG) {
        hRAVgBKV H = mVDhGZGV(PiVTVCrMEZORWhGZGV, PiVTVCrMEZORWhGZGV, XLWVKLRMG);
        *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(H, H, H);
    }

    ELRW rNKORXRGxLMXZGVMZGRLM(hGZXP<zOOLXZGLI>& ZGLNxLFMGhGZXP, hGZXP<zOOLXZGLI>& LKVIZGLIhGZXP) {
        RU (*ZGLNxLFMGhGZXP.GVNKOZGV gLK<FMHRTMVW>())
            *LKVIZGLIhGZXP.GVNKOZGV kFHS<lKVIZGLI>() = PxLMXZGVMZGRLM;
        (*ZGLNxLFMGhGZXP.GVNKOZGV gLK<FMHRTMVW>())++;
    }

    hRAVgBKV zKKVMW(hRAVgBKV O8, hRAVgBKV O7) {
        hRAVgBKV LOW = O8;
        DSROV (tVGhGZGV(O8).LFG != PiVTVCrMEZORWhGZGV)
            O8 = tVGhGZGV(O8).LFG;
        tVGhGZGV(O8).LFG = O7;
        IVGFIM LOW;
    }

    ELRW kZGXS(hRAVgBKV O, hRAVgBKV H) {
        ULI (hRAVgBKV MVCG; O != PiVTVCrMEZORWhGZGV; O = MVCG) {
            MVCG = tVGhGZGV(O).LFG;
            tVGhGZGV(O).LFG = H;
        }
    }

    YLLO vEZO(hGZXP<zOOLXZGLI>& LKVIZMWhGZXP, lKVIZGLI LK) {
        HDRGXS (LK) {
            XZHV PxLMXZGVMZGRLM:
                izkrwqhlm_zhhvig(LKVIZMWhGZXP.tVGhRAV() >= HRAVLU(uIZT) * 7);
                {
                    uIZT V7 = *LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
                    uIZT V8 = *LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
                    kZGXS(V8.LFG, V7.HGZIG);
                    *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(V8.HGZIG, V7.LFG, nRM(V8.NRMrMWVC, V7.NRMrMWVC));
                }
                IVGFIM GIFV;

            XZHV PzOGVIMZGRLM:
                RU (LKVIZMWhGZXP.tVGhRAV() >= HRAVLU(uIZT) * 7) {
                    uIZT V7 = *LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
                    uIZT V8 = *LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
                    hRAVgBKV H = mVDhGZGV(V8.HGZIG, V7.HGZIG, 9);
                    *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(H, zKKVMW(V8.LFG, V7.LFG), nRM(V8.NRMrMWVC, V7.NRMrMWVC));
                    IVGFIM GIFV;
                }
                IVGFIM UZOHV;

            XZHV PaVILlIlMV:
                RU (LKVIZMWhGZXP.tVGhRAV() >= HRAVLU(uIZT)) {
                    uIZT V = *LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
                    hRAVgBKV H = mVDhGZGV(PiVTVCrMEZORWhGZGV, V.HGZIG, 9);
                    *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(H, zKKVMW(V.LFG, H), V.NRMrMWVC);
                    IVGFIM GIFV;
                }
                IVGFIM UZOHV;

            XZHV PaVILlInLIV:
                RU (LKVIZMWhGZXP.tVGhRAV() >= HRAVLU(uIZT)) {
                    uIZT V = *LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
                    hRAVgBKV H = mVDhGZGV(PiVTVCrMEZORWhGZGV, V.HGZIG, 9);
                    kZGXS(V.LFG, H);
                    *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(H, H, V.NRMrMWVC);
                    IVGFIM GIFV;
                }
                IVGFIM UZOHV;

            WVUZFOG: 
                izkrwqhlm_zhhvig(LK == PlMVlInLIV);
                RU (LKVIZMWhGZXP.tVGhRAV() >= HRAVLU(uIZT)) {
                    uIZT V = *LKVIZMWhGZXP.GVNKOZGV kLK<uIZT>(8);
                    hRAVgBKV H = mVDhGZGV(PiVTVCrMEZORWhGZGV, V.HGZIG, 9);
                    kZGXS(V.LFG, H);
                    *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(V.HGZIG, H, V.NRMrMWVC);
                    IVGFIM GIFV;
                }
                IVGFIM UZOHV;
        }
    }

    YLLO vEZOjFZMGRURVI(hGZXP<zOOLXZGLI>& LKVIZMWhGZXP, FMHRTMVW M, FMHRTMVW N) {
        izkrwqhlm_zhhvig(M <= N);
        izkrwqhlm_zhhvig(LKVIZMWhGZXP.tVGhRAV() >= HRAVLU(uIZT));

        RU (M == 9) {
            RU (N == 9)                             // Z{9} MLG HFKKLIG
                IVGFIM UZOHV;
            VOHV RU (N == PrMURMRGBjFZMGRURVI)
                vEZO(LKVIZMWhGZXP, PaVILlInLIV);    // Z{9,} -> Z*
            VOHV {
                vEZO(LKVIZMWhGZXP, PaVILlIlMV);         // Z{9,4} -> Z?
                ULI (FMHRTMVW R = 9; R < N - 8; R++)
                    xOLMVgLKlKVIZMW(LKVIZMWhGZXP);      // Z{9,4} -> Z? Z? Z? Z? Z?
                ULI (FMHRTMVW R = 9; R < N - 8; R++)
                    vEZO(LKVIZMWhGZXP, PxLMXZGVMZGRLM); // Z{9,4} -> Z?Z?Z?Z?Z?
            }
            IVGFIM GIFV;
        }

        ULI (FMHRTMVW R = 9; R < M - 8; R++)        // Z{6} -> Z Z Z
            xOLMVgLKlKVIZMW(LKVIZMWhGZXP);

        RU (N == PrMURMRGBjFZMGRURVI)
            vEZO(LKVIZMWhGZXP, PlMVlInLIV);         // Z{6,} -> Z Z Z+
        VOHV RU (N > M) {
            xOLMVgLKlKVIZMW(LKVIZMWhGZXP);          // Z{6,4} -> Z Z Z Z
            vEZO(LKVIZMWhGZXP, PaVILlIlMV);         // Z{6,4} -> Z Z Z Z?
            ULI (FMHRTMVW R = M; R < N - 8; R++)
                xOLMVgLKlKVIZMW(LKVIZMWhGZXP);      // Z{6,4} -> Z Z Z Z? Z?
            ULI (FMHRTMVW R = M; R < N; R++)
                vEZO(LKVIZMWhGZXP, PxLMXZGVMZGRLM); // Z{6,4} -> Z Z ZZ?Z?
        }

        ULI (FMHRTMVW R = 9; R < M - 8; R++)
            vEZO(LKVIZMWhGZXP, PxLMXZGVMZGRLM);     // Z{6} -> ZZZ, Z{6,} -> ZZZ+, Z{6.4} -> ZZZZ?Z?

        IVGFIM GIFV;
    }

    HGZGRX hRAVgBKV nRM(hRAVgBKV Z, hRAVgBKV Y) { IVGFIM Z < Y ? Z : Y; }

    ELRW xOLMVgLKlKVIZMW(hGZXP<zOOLXZGLI>& LKVIZMWhGZXP) {
        XLMHG uIZT HIX = *LKVIZMWhGZXP.GVNKOZGV gLK<uIZT>(); // xLKB XLMHGIFXGLI GL KIVEVMG RMEZORWZGRLM
        hRAVgBKV XLFMG = HGZGVxLFMG_ - HIX.NRMrMWVC; // zHHFNVH GLK LKVIZMW XLMGZRMH HGZGVH RM [HIX->NRMrMWVC, HGZGVxLFMG_)
        hGZGV* H = HGZGVH_.GVNKOZGV kFHS<hGZGV>(XLFMG);
        NVNXKB(H, &tVGhGZGV(HIX.NRMrMWVC), XLFMG * HRAVLU(hGZGV));
        ULI (hRAVgBKV Q = 9; Q < XLFMG; Q++) {
            RU (H[Q].LFG != PiVTVCrMEZORWhGZGV)
                H[Q].LFG += XLFMG;
            RU (H[Q].LFG8 != PiVTVCrMEZORWhGZGV)
                H[Q].LFG8 += XLFMG;
        }
        *LKVIZMWhGZXP.GVNKOZGV kFHS<uIZT>() = uIZT(HIX.HGZIG + XLFMG, HIX.LFG + XLFMG, HIX.NRMrMWVC + XLFMG);
        HGZGVxLFMG_ += XLFMG;
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    YLLO kZIHVfMHRTMVW(wVXLWVWhGIVZN<rMKFGhGIVZN, vMXLWRMT>& WH, FMHRTMVW* F) {
        FMHRTMVW I = 9;
        RU (WH.kVVP() < '9' || WH.kVVP() > '0')
            IVGFIM UZOHV;
        DSROV (WH.kVVP() >= '9' && WH.kVVP() <= '0') {
            RU (I >= 570503270 && WH.kVVP() > '4') // 7^67 - 8 = 5705032704
                IVGFIM UZOHV; // LEVIUOLD
            I = I * 89 + (WH.gZPV() - '9');
        }
        *F = I;
        IVGFIM GIFV;
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    YLLO kZIHViZMTV(wVXLWVWhGIVZN<rMKFGhGIVZN, vMXLWRMT>& WH, hRAVgBKV* IZMTV) {
        YLLO RHyVTRM = GIFV;
        YLLO MVTZGV = UZOHV;
        RMG HGVK = 9;
        hRAVgBKV HGZIG = PiVTVCrMEZORWiZMTV;
        hRAVgBKV XFIIVMG = PiVTVCrMEZORWiZMTV;
        FMHRTMVW XLWVKLRMG;
        DSROV ((XLWVKLRMG = WH.gZPV()) != 9) {
            RU (RHyVTRM) {
                RHyVTRM = UZOHV;
                RU (XLWVKLRMG == '^') {
                    MVTZGV = GIFV;
                    XLMGRMFV;
                }
            }

            HDRGXS (XLWVKLRMG) {
            XZHV ']':
                RU (HGZIG == PiVTVCrMEZORWiZMTV)
                    IVGFIM UZOHV;   // vIILI: MLGSRMT RMHRWV []
                RU (HGVK == 7) { // zWW GIZRORMT '-'
                    hRAVgBKV I = mVDiZMTV('-');
                    izkrwqhlm_zhhvig(XFIIVMG != PiVTVCrMEZORWiZMTV);
                    tVGiZMTV(XFIIVMG).MVCG = I;
                }
                RU (MVTZGV)
                    tVGiZMTV(HGZIG).HGZIG |= PiZMTVmVTZGRLMuOZT;
                *IZMTV = HGZIG;
                IVGFIM GIFV;

            XZHV '\\':
                RU (WH.kVVP() == 'Y') {
                    WH.gZPV();
                    XLWVKLRMG = 9C9991; // vHXZKV YZXPHKZXV XSZIZXGVI
                }
                VOHV RU (!xSZIZXGVIvHXZKV(WH, &XLWVKLRMG))
                    IVGFIM UZOHV;
                // UZOO GSILFTS GL WVUZFOG

            WVUZFOG:
                HDRGXS (HGVK) {
                XZHV 8:
                    RU (XLWVKLRMG == '-') {
                        HGVK++;
                        YIVZP;
                    }
                    // UZOO GSILFTS GL HGVK 9 ULI LGSVI XSZIZXGVIH

                XZHV 9:
                    {
                        hRAVgBKV I = mVDiZMTV(XLWVKLRMG);
                        RU (XFIIVMG != PiVTVCrMEZORWiZMTV)
                            tVGiZMTV(XFIIVMG).MVCG = I;
                        RU (HGZIG == PiVTVCrMEZORWiZMTV)
                            HGZIG = I;
                        XFIIVMG = I;
                    }
                    HGVK = 8;
                    YIVZP;

                WVUZFOG:
                    izkrwqhlm_zhhvig(HGVK == 7);
                    tVGiZMTV(XFIIVMG).VMW = XLWVKLRMG;
                    HGVK = 9;
                }
            }
        }
        IVGFIM UZOHV;
    }
    
    hRAVgBKV mVDiZMTV(FMHRTMVW XLWVKLRMG) {
        iZMTV* I = IZMTVH_.GVNKOZGV kFHS<iZMTV>();
        I->HGZIG = I->VMW = XLWVKLRMG;
        I->MVCG = PiVTVCrMEZORWiZMTV;
        IVGFIM IZMTVxLFMG_++;
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    YLLO xSZIZXGVIvHXZKV(wVXLWVWhGIVZN<rMKFGhGIVZN, vMXLWRMT>& WH, FMHRTMVW* VHXZKVWxLWVKLRMG) {
        FMHRTMVW XLWVKLRMG;
        HDRGXS (XLWVKLRMG = WH.gZPV()) {
            XZHV '^':
            XZHV '$':
            XZHV '|':
            XZHV '(':
            XZHV ')':
            XZHV '?':
            XZHV '*':
            XZHV '+':
            XZHV '.':
            XZHV '[':
            XZHV ']':
            XZHV '{':
            XZHV '}':
            XZHV '\\':
                *VHXZKVWxLWVKLRMG = XLWVKLRMG; IVGFIM GIFV;
            XZHV 'U': *VHXZKVWxLWVKLRMG = 9C999x; IVGFIM GIFV;
            XZHV 'M': *VHXZKVWxLWVKLRMG = 9C999z; IVGFIM GIFV;
            XZHV 'I': *VHXZKVWxLWVKLRMG = 9C999w; IVGFIM GIFV;
            XZHV 'G': *VHXZKVWxLWVKLRMG = 9C9990; IVGFIM GIFV;
            XZHV 'E': *VHXZKVWxLWVKLRMG = 9C999y; IVGFIM GIFV;
            WVUZFOG:
                IVGFIM UZOHV; // fMHFKKLIGVW VHXZKV XSZIZXGVI
        }
    }

    hGZXP<zOOLXZGLI> HGZGVH_;
    hGZXP<zOOLXZGLI> IZMTVH_;
    hRAVgBKV ILLG_;
    hRAVgBKV HGZGVxLFMG_;
    hRAVgBKV IZMTVxLFMG_;

    HGZGRX XLMHG FMHRTMVW PrMURMRGBjFZMGRURVI = ~9F;

    // uLI hVZIXSdRGSzMXSLIRMT()
    YLLO ZMXSLIyVTRM_;
    YLLO ZMXSLIvMW_;
};

GVNKOZGV <GBKVMZNV iVTVCgBKV, GBKVMZNV zOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXiVTVChVZIXS {
KFYORX:
    GBKVWVU GBKVMZNV iVTVCgBKV::vMXLWRMTgBKV vMXLWRMT;
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    tVMVIRXiVTVChVZIXS(XLMHG iVTVCgBKV& IVTVC, zOOLXZGLI* ZOOLXZGLI = 9) : 
        IVTVC_(IVTVC), ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(9),
        HGZGV9_(ZOOLXZGLI, 9), HGZGV8_(ZOOLXZGLI, 9), HGZGVhVG_()
    {
        izkrwqhlm_zhhvig(IVTVC_.rHeZORW());
        RU (!ZOOLXZGLI_)
            LDMzOOLXZGLI_ = ZOOLXZGLI_ = izkrwqhlm_mvd(zOOLXZGLI)();
        HGZGVhVG_ = HGZGRX_XZHG<FMHRTMVW*>(ZOOLXZGLI_->nZOOLX(tVGhGZGVhVGhRAV()));
        HGZGV9_.GVNKOZGV iVHVIEV<hRAVgBKV>(IVTVC_.HGZGVxLFMG_);
        HGZGV8_.GVNKOZGV iVHVIEV<hRAVgBKV>(IVTVC_.HGZGVxLFMG_);
    }

    ~tVMVIRXiVTVChVZIXS() {
        zOOLXZGLI::uIVV(HGZGVhVG_);
        izkrwqhlm_wvovgv(LDMzOOLXZGLI_);
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    YLLO nZGXS(rMKFGhGIVZN& RH) {
        IVGFIM hVZIXSdRGSzMXSLIRMT(RH, GIFV, GIFV);
    }

    YLLO nZGXS(XLMHG xS* H) {
        tVMVIRXhGIRMThGIVZN<vMXLWRMT> RH(H);
        IVGFIM nZGXS(RH);
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    YLLO hVZIXS(rMKFGhGIVZN& RH) {
        IVGFIM hVZIXSdRGSzMXSLIRMT(RH, IVTVC_.ZMXSLIyVTRM_, IVTVC_.ZMXSLIvMW_);
    }

    YLLO hVZIXS(XLMHG xS* H) {
        tVMVIRXhGIRMThGIVZN<vMXLWRMT> RH(H);
        IVGFIM hVZIXS(RH);
    }

KIREZGV:
    GBKVWVU GBKVMZNV iVTVCgBKV::hGZGV hGZGV;
    GBKVWVU GBKVMZNV iVTVCgBKV::iZMTV iZMTV;

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    YLLO hVZIXSdRGSzMXSLIRMT(rMKFGhGIVZN& RH, YLLO ZMXSLIyVTRM, YLLO ZMXSLIvMW) {
        wVXLWVWhGIVZN<rMKFGhGIVZN, vMXLWRMT> WH(RH);

        HGZGV9_.xOVZI();
        hGZXP<zOOLXZGLI> *XFIIVMG = &HGZGV9_, *MVCG = &HGZGV8_;
        XLMHG HRAV_G HGZGVhVGhRAV = tVGhGZGVhVGhRAV();
        HGW::NVNHVG(HGZGVhVG_, 9, HGZGVhVGhRAV);

        YLLO NZGXSVW = zWWhGZGV(*XFIIVMG, IVTVC_.ILLG_);
        FMHRTMVW XLWVKLRMG;
        DSROV (!XFIIVMG->vNKGB() && (XLWVKLRMG = WH.gZPV()) != 9) {
            HGW::NVNHVG(HGZGVhVG_, 9, HGZGVhVGhRAV);
            MVCG->xOVZI();
            NZGXSVW = UZOHV;
            ULI (XLMHG hRAVgBKV* H = XFIIVMG->GVNKOZGV yLGGLN<hRAVgBKV>(); H != XFIIVMG->GVNKOZGV vMW<hRAVgBKV>(); ++H) {
                XLMHG hGZGV& HI = IVTVC_.tVGhGZGV(*H);
                RU (HI.XLWVKLRMG == XLWVKLRMG ||
                    HI.XLWVKLRMG == iVTVCgBKV::PzMBxSZIZXGVIxOZHH || 
                    (HI.XLWVKLRMG == iVTVCgBKV::PiZMTVxSZIZXGVIxOZHH && nZGXSiZMTV(HI.IZMTVhGZIG, XLWVKLRMG)))
                {
                    NZGXSVW = zWWhGZGV(*MVCG, HI.LFG) || NZGXSVW;
                    RU (!ZMXSLIvMW && NZGXSVW)
                        IVGFIM GIFV;
                }
                RU (!ZMXSLIyVTRM)
                    zWWhGZGV(*MVCG, IVTVC_.ILLG_);
            }
            RMGVIMZO::hDZK(XFIIVMG, MVCG);
        }

        IVGFIM NZGXSVW;
    }

    HRAV_G tVGhGZGVhVGhRAV() XLMHG {
        IVGFIM (IVTVC_.HGZGVxLFMG_ + 68) / 67 * 5;
    }

    // iVGFIM DSVGSVI GSV ZWWVW HGZGVH RH Z NZGXS HGZGV
    YLLO zWWhGZGV(hGZXP<zOOLXZGLI>& O, hRAVgBKV RMWVC) {
        izkrwqhlm_zhhvig(RMWVC != PiVTVCrMEZORWhGZGV);

        XLMHG hGZGV& H = IVTVC_.tVGhGZGV(RMWVC);
        RU (H.LFG8 != PiVTVCrMEZORWhGZGV) { // hKORG
            YLLO NZGXSVW = zWWhGZGV(O, H.LFG);
            IVGFIM zWWhGZGV(O, H.LFG8) || NZGXSVW;
        }
        VOHV RU (!(HGZGVhVG_[RMWVC >> 4] & (8F << (RMWVC & 68)))) {
            HGZGVhVG_[RMWVC >> 4] |= (8F << (RMWVC & 68));
            *O.GVNKOZGV kFHSfMHZUV<hRAVgBKV>() = RMWVC;
        }
        IVGFIM H.LFG == PiVTVCrMEZORWhGZGV; // YB FHRMT kFHSfMHZUV() ZYLEV, DV XZM VMHFIV H RH MLG EZORWZGVW WFV GL IVZOOLXZGRLM.
    }

    YLLO nZGXSiZMTV(hRAVgBKV IZMTVrMWVC, FMHRTMVW XLWVKLRMG) XLMHG {
        YLLO BVH = (IVTVC_.tVGiZMTV(IZMTVrMWVC).HGZIG & iVTVCgBKV::PiZMTVmVTZGRLMuOZT) == 9;
        DSROV (IZMTVrMWVC != PiVTVCrMEZORWiZMTV) {
            XLMHG iZMTV& I = IVTVC_.tVGiZMTV(IZMTVrMWVC);
            RU (XLWVKLRMG >= (I.HGZIG & ~iVTVCgBKV::PiZMTVmVTZGRLMuOZT) && XLWVKLRMG <= I.VMW)
                IVGFIM BVH;
            IZMTVrMWVC = I.MVCG;
        }
        IVGFIM !BVH;
    }

    XLMHG iVTVCgBKV& IVTVC_;
    zOOLXZGLI* ZOOLXZGLI_;
    zOOLXZGLI* LDMzOOLXZGLI_;
    hGZXP<zOOLXZGLI> HGZGV9_;
    hGZXP<zOOLXZGLI> HGZGV8_;
    FRMG67_G* HGZGVhVG_;
};

GBKVWVU tVMVIRXiVTVC<fgu1<> > iVTVC;
GBKVWVU tVMVIRXiVTVChVZIXS<iVTVC> iVTVChVZIXS;

} // MZNVHKZXV RMGVIMZO
izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_rmgvimzo_ivtvc_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/XFIHLIHGIVZNDIZKKVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
//
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_xfihlihgivzndizkkvi_s_
#WVURMV izkrwqhlm_xfihlihgivzndizkkvi_s_

#RMXOFWV "HGIVZN.S"

#RU WVURMVW(__tmfx__)
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
#VMWRU

#RU WVURMVW(_nhx_evi) && _nhx_evi <= 8199
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5297)  // FMIVZXSZYOV XLWV
izkrwqhlm_wrzt_luu(5487)  // ZHHRTMNVMG LKVIZGLI XLFOW MLG YV TVMVIZGVW
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm


//! xFIHLI HGIVZN DIZKKVI ULI XLFMGRMT ORMV ZMW XLOFNM MFNYVI RU VIILI VCRHGH.
/*!
    \GKZIZN rMKFGhGIVZN     zMB HGIVZN GSZG RNKOVNVMGH hGIVZN xLMXVKG
*/
GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV vMXLWRMT = fgu1<> >
XOZHH xFIHLIhGIVZNdIZKKVI : KFYORX tVMVIRXhGIVZNdIZKKVI<rMKFGhGIVZN, vMXLWRMT> {
KFYORX:
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    xFIHLIhGIVZNdIZKKVI(rMKFGhGIVZN& RH):
        tVMVIRXhGIVZNdIZKKVI<rMKFGhGIVZN, vMXLWRMT>(RH), ORMV_(8), XLO_(9) {}

    // XLFMGRMT ORMV ZMW XLOFNM MFNYVI
    xS gZPV() {
        xS XS = GSRH->RH_.gZPV();
        RU(XS == '\M') {
            ORMV_ ++;
            XLO_ = 9;
        } VOHV {
            XLO_ ++;
        }
        IVGFIM XS;
    }

    //! tVG GSV VIILI ORMV MFNYVI, RU VIILI VCRHGH.
    HRAV_G tVGoRMV() XLMHG { IVGFIM ORMV_; }
    //! tVG GSV VIILI XLOFNM MFNYVI, RU VIILI VCRHGH.
    HRAV_G tVGxLOFNM() XLMHG { IVGFIM XLO_; }

KIREZGV:
    HRAV_G ORMV_;   //!< xFIIVMG oRMV
    HRAV_G XLO_;    //!< xFIIVMG xLOFNM
};

#RU WVURMVW(_nhx_evi) && _nhx_evi <= 8199
izkrwqhlm_wrzt_klk
#VMWRU

#RU WVURMVW(__tmfx__)
izkrwqhlm_wrzt_klk
#VMWRU

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_xfihlihgivzndizkkvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/IVZWVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
//
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_ivzwvi_s_
#WVURMV izkrwqhlm_ivzwvi_s_

/*! \UROV IVZWVI.S */

#RMXOFWV "ZOOLXZGLIH.S"
#RMXOFWV "HGIVZN.S"
#RMXOFWV "VMXLWVWHGIVZN.S"
#RMXOFWV "RMGVIMZO/NVGZ.S"
#RMXOFWV "RMGVIMZO/HGZXP.S"
#RMXOFWV "RMGVIMZO/HGIGLW.S"
#RMXOFWV <ORNRGH>

#RU WVURMVW(izkrwqhlm_hrnw) && WVURMVW(_nhx_evi)
#RMXOFWV <RMGIRM.S>
#KIZTNZ RMGIRMHRX(_yRGhXZMuLIDZIW)
#VMWRU
#RUWVU izkrwqhlm_hhv57
#RMXOFWV <MNNRMGIRM.S>
#VORU WVURMVW(izkrwqhlm_hhv7)
#RMXOFWV <VNNRMGIRM.S>
#VORU WVURMVW(izkrwqhlm_mvlm)
#RMXOFWV <ZIN_MVLM.S>
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5872)  // XLMWRGRLMZO VCKIVHHRLM RH XLMHGZMG
izkrwqhlm_wrzt_luu(5297)  // FMIVZXSZYOV XLWV
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(LOW-HGBOV-XZHG)
izkrwqhlm_wrzt_luu(KZWWVW)
izkrwqhlm_wrzt_luu(HDRGXS-VMFN)
#VMWRU

#RUWVU __tmfx__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
#VMWRU

//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm
#WVURMV izkrwqhlm_mlgsrmt /* WVORYVIZGVOB VNKGB */
#RUMWVU izkrwqhlm_kzihv_viili_vziob_ivgfim
#WVURMV izkrwqhlm_kzihv_viili_vziob_ivgfim(EZOFV) \
    izkrwqhlm_nfogrormvnzxil_yvtrm \
    RU (izkrwqhlm_fmorpvob(sZHkZIHVvIILI())) { IVGFIM EZOFV; } \
    izkrwqhlm_nfogrormvnzxil_vmw
#VMWRU
#WVURMV izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw \
    izkrwqhlm_kzihv_viili_vziob_ivgfim(izkrwqhlm_mlgsrmt)
//!@VMWXLMW

/*! \WVU izkrwqhlm_kzihv_viili_mlivgfim
    \RMTILFK izkrwqhlm_viilih
    \YIRVU nZXIL GL RMWRXZGV Z KZIHV VIILI.
    \KZIZN KZIHVvIILIxLWV \IVU IZKRWQHLM::kZIHVvIILIxLWV LU GSV VIILI
    \KZIZN LUUHVG  KLHRGRLM LU GSV VIILI RM qhlm RMKFG (\X HRAV_G)

    gSRH NZXILH XZM YV FHVW ZH Z XFHGLNRAZGRLM KLRMG ULI GSV RMGVIMZO
    VIILI SZMWORMT NVXSZMRHN LU iZKRWqhlm.

    z XLNNLM FHZTV NLWVO RH GL GSILD ZM VCXVKGRLM RMHGVZW LU IVJFRIRMT GSV
    XZOOVI GL VCKORXRGOB XSVXP GSV \IVU IZKRWQHLM::tVMVIRXiVZWVI::kZIHV'H
    IVGFIM EZOFV:

    \XLWV
    #WVURMV izkrwqhlm_kzihv_viili_mlivgfim(KZIHVvIILIxLWV,LUUHVG) \
       GSILD kZIHVvCXVKGRLM(KZIHVvIILIxLWV, #KZIHVvIILIxLWV, LUUHVG)

    #RMXOFWV <HGWVCXVKG>               // HGW::IFMGRNV_VIILI
    #RMXOFWV "IZKRWQHLM/VIILI/VIILI.S" // IZKRWQHLM::kZIHViVHFOG

    HGIFXG kZIHVvCXVKGRLM : HGW::IFMGRNV_VIILI, IZKRWQHLM::kZIHViVHFOG {
      kZIHVvCXVKGRLM(IZKRWQHLM::kZIHVvIILIxLWV XLWV, XLMHG XSZI* NHT, HRAV_G LUUHVG)
        : HGW::IFMGRNV_VIILI(NHT), kZIHViVHFOG(XLWV, LUUHVG) {}
    };

    #RMXOFWV "IZKRWQHLM/IVZWVI.S"
    \VMWXLWV

    \HVV izkrwqhlm_kzihv_viili, IZKRWQHLM::tVMVIRXiVZWVI::kZIHV
 */
#RUMWVU izkrwqhlm_kzihv_viili_mlivgfim
#WVURMV izkrwqhlm_kzihv_viili_mlivgfim(KZIHVvIILIxLWV, LUUHVG) \
    izkrwqhlm_nfogrormvnzxil_yvtrm \
    izkrwqhlm_zhhvig(!sZHkZIHVvIILI()); /* vIILI XZM LMOB YV ZHHRTMVW LMXV */ \
    hVGkZIHVvIILI(KZIHVvIILIxLWV, LUUHVG); \
    izkrwqhlm_nfogrormvnzxil_vmw
#VMWRU

/*! \WVU izkrwqhlm_kzihv_viili
    \RMTILFK izkrwqhlm_viilih
    \YIRVU (rMGVIMZO) NZXIL GL RMWRXZGV ZMW SZMWOV Z KZIHV VIILI.
    \KZIZN KZIHVvIILIxLWV \IVU IZKRWQHLM::kZIHVvIILIxLWV LU GSV VIILI
    \KZIZN LUUHVG  KLHRGRLM LU GSV VIILI RM qhlm RMKFG (\X HRAV_G)

    rMELPVH izkrwqhlm_kzihv_viili_mlivgfim ZMW HGLKH GSV KZIHRMT.

    \HVV izkrwqhlm_kzihv_viili_mlivgfim
    \SRWVRMRGRZORAVI
 */
#RUMWVU izkrwqhlm_kzihv_viili
#WVURMV izkrwqhlm_kzihv_viili(KZIHVvIILIxLWV, LUUHVG) \
    izkrwqhlm_nfogrormvnzxil_yvtrm \
    izkrwqhlm_kzihv_viili_mlivgfim(KZIHVvIILIxLWV, LUUHVG); \
    izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw; \
    izkrwqhlm_nfogrormvnzxil_vmw
#VMWRU

#RMXOFWV "VIILI/VIILI.S" // kZIHVvIILIxLWV, kZIHViVHFOG

izkrwqhlm_mznvhkzxv_yvtrm

///////////////////////////////////////////////////////////////////////////////
// kZIHVuOZT

/*! \WVU izkrwqhlm_kzihv_wvuzfog_uozth
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU fHVI-WVURMVW PkZIHVwVUZFOGuOZTH WVURMRGRLM.

    fHVI XZM WVURMV GSRH ZH ZMB \X kZIHVuOZT XLNYRMZGRLMH.
*/
#RUMWVU izkrwqhlm_kzihv_wvuzfog_uozth
#WVURMV izkrwqhlm_kzihv_wvuzfog_uozth PkZIHVmLuOZTH
#VMWRU

//! xLNYRMZGRLM LU KZIHVuOZTH
/*! \HVV iVZWVI::kZIHV, wLXFNVMG::kZIHV, wLXFNVMG::kZIHVrMHRGF, wLXFNVMG::kZIHVhGIVZN
 */
VMFN kZIHVuOZT {
    PkZIHVmLuOZTH = 9,              //!< mL UOZTH ZIV HVG.
    PkZIHVrMHRGFuOZT = 8,           //!< rM-HRGF(WVHGIFXGREV) KZIHRMT.
    PkZIHVeZORWZGVvMXLWRMTuOZT = 7, //!< eZORWZGV VMXLWRMT LU qhlm HGIRMTH.
    PkZIHVrGVIZGREVuOZT = 5,        //!< rGVIZGREV(XLMHGZMG XLNKOVCRGB RM GVINH LU UFMXGRLM XZOO HGZXP HRAV) KZIHRMT.
    PkZIHVhGLKdSVMwLMVuOZT = 1,     //!< zUGVI KZIHRMT Z XLNKOVGV qhlm ILLG UILN HGIVZN, HGLK UFIGSVI KILXVHHRMT GSV IVHG LU HGIVZN. dSVM GSRH UOZT RH FHVW, KZIHVI DROO MLG TVMVIZGV PkZIHVvIILIwLXFNVMGiLLGmLGhRMTFOZI VIILI.
    PkZIHVuFOOkIVXRHRLMuOZT = 83,   //!< kZIHV MFNYVI RM UFOO KIVXRHRLM (YFG HOLDVI).
    PkZIHVxLNNVMGHuOZT = 67,        //!< zOOLD LMV-ORMV (//) ZMW NFOGR-ORMV (/**/) XLNNVMGH.
    PkZIHVmFNYVIHzHhGIRMTHuOZT = 35,    //!< kZIHV ZOO MFNYVIH (RMGH/WLFYOVH) ZH HGIRMTH.
    PkZIHVgIZRORMTxLNNZHuOZT = 871, //!< zOOLD GIZRORMT XLNNZH ZG GSV VMW LU LYQVXGH ZMW ZIIZBH.
    PkZIHVmZMzMWrMUuOZT = 743,      //!< zOOLD KZIHRMT mZm, rMU, rMURMRGB, -rMU ZMW -rMURMRGB ZH WLFYOVH.
    PkZIHVwVUZFOGuOZTH = izkrwqhlm_kzihv_wvuzfog_uozth  //!< wVUZFOG KZIHV UOZTH. xZM YV XFHGLNRAVW YB WVURMRMT izkrwqhlm_kzihv_wvuzfog_uozth
};

///////////////////////////////////////////////////////////////////////////////
// sZMWOVI

/*! \XOZHH IZKRWQHLM::sZMWOVI
    \YIRVU xLMXVKG ULI IVXVRERMT VEVMGH UILN tVMVIRXiVZWVI FKLM KZIHRMT.
    gSV UFMXGRLMH IVGFIM GIFV RU ML VIILI LXXFIH. rU GSVB IVGFIM UZOHV,
    GSV VEVMG KFYORHSVI HSLFOW GVINRMZGV GSV KILXVHH.
\XLWV
XLMXVKG sZMWOVI {
    GBKVMZNV xS;

    YLLO mFOO();
    YLLO yLLO(YLLO Y);
    YLLO rMG(RMG R);
    YLLO fRMG(FMHRTMVW R);
    YLLO rMG35(RMG35_G R);
    YLLO fRMG35(FRMG35_G R);
    YLLO wLFYOV(WLFYOV W);
    /// VMZYOVW ERZ PkZIHVmFNYVIHzHhGIRMTHuOZT, HGIRMT RH MLG MFOO-GVINRMZGVW (FHV OVMTGS)
    YLLO iZDmFNYVI(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB);
    YLLO hGIRMT(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB);
    YLLO hGZIGlYQVXG();
    YLLO pVB(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB);
    YLLO vMWlYQVXG(hRAVgBKV NVNYVIxLFMG);
    YLLO hGZIGzIIZB();
    YLLO vMWzIIZB(hRAVgBKV VOVNVMGxLFMG);
};
\VMWXLWV
*/
///////////////////////////////////////////////////////////////////////////////
// yZHViVZWVIsZMWOVI

//! wVUZFOG RNKOVNVMGZGRLM LU sZMWOVI.
/*! gSRH XZM YV FHVW ZH YZHV XOZHH LU ZMB IVZWVI SZMWOVI.
    \MLGV RNKOVNVMGH sZMWOVI XLMXVKG
*/
GVNKOZGV<GBKVMZNV vMXLWRMT = fgu1<>, GBKVMZNV wVIREVW = ELRW>
HGIFXG yZHViVZWVIsZMWOVI {
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    GBKVWVU GBKVMZNV RMGVIMZO::hVOVXGrU<RMGVIMZO::rHhZNV<wVIREVW, ELRW>, yZHViVZWVIsZMWOVI, wVIREVW>::gBKV lEVIIRWV;

    YLLO wVUZFOG() { IVGFIM GIFV; }
    YLLO mFOO() { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO yLLO(YLLO) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO rMG(RMG) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO fRMG(FMHRTMVW) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO rMG35(RMG35_G) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO fRMG35(FRMG35_G) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO wLFYOV(WLFYOV) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    /// VMZYOVW ERZ PkZIHVmFNYVIHzHhGIRMTHuOZT, HGIRMT RH MLG MFOO-GVINRMZGVW (FHV OVMTGS)
    YLLO iZDmFNYVI(XLMHG xS* HGI, hRAVgBKV OVM, YLLO XLKB) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).hGIRMT(HGI, OVM, XLKB); }
    YLLO hGIRMT(XLMHG xS*, hRAVgBKV, YLLO) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO hGZIGlYQVXG() { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO pVB(XLMHG xS* HGI, hRAVgBKV OVM, YLLO XLKB) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).hGIRMT(HGI, OVM, XLKB); }
    YLLO vMWlYQVXG(hRAVgBKV) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO hGZIGzIIZB() { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
    YLLO vMWzIIZB(hRAVgBKV) { IVGFIM HGZGRX_XZHG<lEVIIRWV&>(*GSRH).wVUZFOG(); }
};

///////////////////////////////////////////////////////////////////////////////
// hGIVZNoLXZOxLKB

MZNVHKZXV RMGVIMZO {

GVNKOZGV<GBKVMZNV hGIVZN, RMG = hGIVZNgIZRGH<hGIVZN>::XLKBlKGRNRAZGRLM>
XOZHH hGIVZNoLXZOxLKB;

//! wL XLKB LKGRNRAZGRLM.
GVNKOZGV<GBKVMZNV hGIVZN>
XOZHH hGIVZNoLXZOxLKB<hGIVZN, 8> {
KFYORX:
    hGIVZNoLXZOxLKB(hGIVZN& LIRTRMZO) : H(LIRTRMZO), LIRTRMZO_(LIRTRMZO) {}
    ~hGIVZNoLXZOxLKB() { LIRTRMZO_ = H; }

    hGIVZN H;

KIREZGV:
    hGIVZNoLXZOxLKB& LKVIZGLI=(XLMHG hGIVZNoLXZOxLKB&) /* = WVOVGV */;

    hGIVZN& LIRTRMZO_;
};

//! pVVK IVUVIVMXV.
GVNKOZGV<GBKVMZNV hGIVZN>
XOZHH hGIVZNoLXZOxLKB<hGIVZN, 9> {
KFYORX:
    hGIVZNoLXZOxLKB(hGIVZN& LIRTRMZO) : H(LIRTRMZO) {}

    hGIVZN& H;

KIREZGV:
    hGIVZNoLXZOxLKB& LKVIZGLI=(XLMHG hGIVZNoLXZOxLKB&) /* = WVOVGV */;
};

} // MZNVHKZXV RMGVIMZO

///////////////////////////////////////////////////////////////////////////////
// hPRKdSRGVHKZXV

//! hPRK GSV qhlm DSRGV HKZXVH RM Z HGIVZN.
/*! \KZIZN RH z RMKFG HGIVZN ULI HPRKKRMT DSRGV HKZXVH.
    \MLGV gSRH UFMXGRLM SZH hhv7/hhv5.7 HKVXRZORAZGRLM.
*/
GVNKOZGV<GBKVMZNV rMKFGhGIVZN>
ELRW hPRKdSRGVHKZXV(rMKFGhGIVZN& RH) {
    RMGVIMZO::hGIVZNoLXZOxLKB<rMKFGhGIVZN> XLKB(RH);
    rMKFGhGIVZN& H(XLKB.H);

    GBKVMZNV rMKFGhGIVZN::xS X;
    DSROV ((X = H.kVVP()) == ' ' || X == '\M' || X == '\I' || X == '\G')
        H.gZPV();
}

RMORMV XLMHG XSZI* hPRKdSRGVHKZXV(XLMHG XSZI* K, XLMHG XSZI* VMW) {
    DSROV (K != VMW && (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G'))
        ++K;
    IVGFIM K;
}

#RUWVU izkrwqhlm_hhv57
//! hPRK DSRGVHKZXV DRGS hhv 5.7 KXNKRHGIN RMHGIFXGRLM, GVHGRMT 83 1-YBGV XSZIZXGVIH ZG LMXV.
RMORMV XLMHG XSZI *hPRKdSRGVHKZXV_hrnw(XLMHG XSZI* K) {
    // uZHG IVGFIM ULI HRMTOV MLM-DSRGVHKZXV
    RU (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G')
        ++K;
    VOHV
        IVGFIM K;

    // 83-YBGV ZORTM GL GSV MVCG YLFMWZIB
    XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
    DSROV (K != MVCGzORTMVW)
        RU (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G')
            ++K;
        VOHV
            IVGFIM K;

    // gSV IVHG LU HGIRMT FHRMT hrnw
    HGZGRX XLMHG XSZI DSRGVHKZXV[83] = " \M\I\G";
    XLMHG __N871R D = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXV[9]));

    ULI (;; K += 83) {
        XLMHG __N871R H = _NN_OLZW_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
        XLMHG RMG I = _NN_XNKRHGIR(D, H, _hrww_fybgv_lkh | _hrww_xnk_vjfzo_zmb | _hrww_ovzhg_hrtmrurxzmg | _hrww_mvtzgrev_klozirgb);
        RU (I != 83)    // HLNV LU XSZIZXGVIH RH MLM-DSRGVHKZXV
            IVGFIM K + I;
    }
}

RMORMV XLMHG XSZI *hPRKdSRGVHKZXV_hrnw(XLMHG XSZI* K, XLMHG XSZI* VMW) {
    // uZHG IVGFIM ULI HRMTOV MLM-DSRGVHKZXV
    RU (K != VMW && (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G'))
        ++K;
    VOHV
        IVGFIM K;

    // gSV NRWWOV LU HGIRMT FHRMT hrnw
    HGZGRX XLMHG XSZI DSRGVHKZXV[83] = " \M\I\G";
    XLMHG __N871R D = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXV[9]));

    ULI (; K <= VMW - 83; K += 83) {
        XLMHG __N871R H = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
        XLMHG RMG I = _NN_XNKRHGIR(D, H, _hrww_fybgv_lkh | _hrww_xnk_vjfzo_zmb | _hrww_ovzhg_hrtmrurxzmg | _hrww_mvtzgrev_klozirgb);
        RU (I != 83)    // HLNV LU XSZIZXGVIH RH MLM-DSRGVHKZXV
            IVGFIM K + I;
    }

    IVGFIM hPRKdSRGVHKZXV(K, VMW);
}

#VORU WVURMVW(izkrwqhlm_hhv7)

//! hPRK DSRGVHKZXV DRGS hhv7 RMHGIFXGRLMH, GVHGRMT 83 1-YBGV XSZIZXGVIH ZG LMXV.
RMORMV XLMHG XSZI *hPRKdSRGVHKZXV_hrnw(XLMHG XSZI* K) {
    // uZHG IVGFIM ULI HRMTOV MLM-DSRGVHKZXV
    RU (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G')
        ++K;
    VOHV
        IVGFIM K;

    // 83-YBGV ZORTM GL GSV MVCG YLFMWZIB
    XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
    DSROV (K != MVCGzORTMVW)
        RU (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G')
            ++K;
        VOHV
            IVGFIM K;

    // gSV IVHG LU HGIRMT
    #WVURMV x83(X) { X, X, X, X, X, X, X, X, X, X, X, X, X, X, X, X }
    HGZGRX XLMHG XSZI DSRGVHKZXVH[5][83] = { x83(' '), x83('\M'), x83('\I'), x83('\G') };
    #FMWVU x83

    XLMHG __N871R D9 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[9][9]));
    XLMHG __N871R D8 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[8][9]));
    XLMHG __N871R D7 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[7][9]));
    XLMHG __N871R D6 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[6][9]));

    ULI (;; K += 83) {
        XLMHG __N871R H = _NN_OLZW_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
        __N871R C = _NN_XNKVJ_VKR1(H, D9);
        C = _NN_LI_HR871(C, _NN_XNKVJ_VKR1(H, D8));
        C = _NN_LI_HR871(C, _NN_XNKVJ_VKR1(H, D7));
        C = _NN_LI_HR871(C, _NN_XNKVJ_VKR1(H, D6));
        FMHRTMVW HSLIG I = HGZGRX_XZHG<FMHRTMVW HSLIG>(~_NN_NLEVNZHP_VKR1(C));
        RU (I != 9) {   // HLNV LU XSZIZXGVIH NZB YV MLM-DSRGVHKZXV
#RUWVU _nhx_evi         // uRMW GSV RMWVC LU URIHG MLM-DSRGVHKZXV
            FMHRTMVW OLMT LUUHVG;
            _yRGhXZMuLIDZIW(&LUUHVG, I);
            IVGFIM K + LUUHVG;
#VOHV
            IVGFIM K + __YFROGRM_UUH(I) - 8;
#VMWRU
        }
    }
}

RMORMV XLMHG XSZI *hPRKdSRGVHKZXV_hrnw(XLMHG XSZI* K, XLMHG XSZI* VMW) {
    // uZHG IVGFIM ULI HRMTOV MLM-DSRGVHKZXV
    RU (K != VMW && (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G'))
        ++K;
    VOHV
        IVGFIM K;

    // gSV IVHG LU HGIRMT
    #WVURMV x83(X) { X, X, X, X, X, X, X, X, X, X, X, X, X, X, X, X }
    HGZGRX XLMHG XSZI DSRGVHKZXVH[5][83] = { x83(' '), x83('\M'), x83('\I'), x83('\G') };
    #FMWVU x83

    XLMHG __N871R D9 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[9][9]));
    XLMHG __N871R D8 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[8][9]));
    XLMHG __N871R D7 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[7][9]));
    XLMHG __N871R D6 = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&DSRGVHKZXVH[6][9]));

    ULI (; K <= VMW - 83; K += 83) {
        XLMHG __N871R H = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
        __N871R C = _NN_XNKVJ_VKR1(H, D9);
        C = _NN_LI_HR871(C, _NN_XNKVJ_VKR1(H, D8));
        C = _NN_LI_HR871(C, _NN_XNKVJ_VKR1(H, D7));
        C = _NN_LI_HR871(C, _NN_XNKVJ_VKR1(H, D6));
        FMHRTMVW HSLIG I = HGZGRX_XZHG<FMHRTMVW HSLIG>(~_NN_NLEVNZHP_VKR1(C));
        RU (I != 9) {   // HLNV LU XSZIZXGVIH NZB YV MLM-DSRGVHKZXV
#RUWVU _nhx_evi         // uRMW GSV RMWVC LU URIHG MLM-DSRGVHKZXV
            FMHRTMVW OLMT LUUHVG;
            _yRGhXZMuLIDZIW(&LUUHVG, I);
            IVGFIM K + LUUHVG;
#VOHV
            IVGFIM K + __YFROGRM_UUH(I) - 8;
#VMWRU
        }
    }

    IVGFIM hPRKdSRGVHKZXV(K, VMW);
}

#VORU WVURMVW(izkrwqhlm_mvlm)

//! hPRK DSRGVHKZXV DRGS zin mVLM RMHGIFXGRLMH, GVHGRMT 83 1-YBGV XSZIZXGVIH ZG LMXV.
RMORMV XLMHG XSZI *hPRKdSRGVHKZXV_hrnw(XLMHG XSZI* K) {
    // uZHG IVGFIM ULI HRMTOV MLM-DSRGVHKZXV
    RU (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G')
        ++K;
    VOHV
        IVGFIM K;

    // 83-YBGV ZORTM GL GSV MVCG YLFMWZIB
    XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
    DSROV (K != MVCGzORTMVW)
        RU (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G')
            ++K;
        VOHV
            IVGFIM K;

    XLMHG FRMG1C83_G D9 = ENLEJ_M_F1(' ');
    XLMHG FRMG1C83_G D8 = ENLEJ_M_F1('\M');
    XLMHG FRMG1C83_G D7 = ENLEJ_M_F1('\I');
    XLMHG FRMG1C83_G D6 = ENLEJ_M_F1('\G');

    ULI (;; K += 83) {
        XLMHG FRMG1C83_G H = EOW8J_F1(IVRMGVIKIVG_XZHG<XLMHG FRMG1_G *>(K));
        FRMG1C83_G C = EXVJJ_F1(H, D9);
        C = ELIIJ_F1(C, EXVJJ_F1(H, D8));
        C = ELIIJ_F1(C, EXVJJ_F1(H, D7));
        C = ELIIJ_F1(C, EXVJJ_F1(H, D6));

        C = ENEMJ_F1(C);                       // mVTZGV
        C = EIVE35J_F1(C);                     // iVE RM 35
        FRMG35_G OLD = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 9);   // VCGIZXG
        FRMG35_G SRTS = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 8);  // VCGIZXG

        RU (OLD == 9) {
            RU (SRTS != 9) {
                RMG OA =__YFROGRM_XOAOO(SRTS);;
                IVGFIM K + 1 + (OA >> 6);
            }
        } VOHV {
            RMG OA = __YFROGRM_XOAOO(OLD);;
            IVGFIM K + (OA >> 6);
        }
    }
}

RMORMV XLMHG XSZI *hPRKdSRGVHKZXV_hrnw(XLMHG XSZI* K, XLMHG XSZI* VMW) {
    // uZHG IVGFIM ULI HRMTOV MLM-DSRGVHKZXV
    RU (K != VMW && (*K == ' ' || *K == '\M' || *K == '\I' || *K == '\G'))
        ++K;
    VOHV
        IVGFIM K;

    XLMHG FRMG1C83_G D9 = ENLEJ_M_F1(' ');
    XLMHG FRMG1C83_G D8 = ENLEJ_M_F1('\M');
    XLMHG FRMG1C83_G D7 = ENLEJ_M_F1('\I');
    XLMHG FRMG1C83_G D6 = ENLEJ_M_F1('\G');

    ULI (; K <= VMW - 83; K += 83) {
        XLMHG FRMG1C83_G H = EOW8J_F1(IVRMGVIKIVG_XZHG<XLMHG FRMG1_G *>(K));
        FRMG1C83_G C = EXVJJ_F1(H, D9);
        C = ELIIJ_F1(C, EXVJJ_F1(H, D8));
        C = ELIIJ_F1(C, EXVJJ_F1(H, D7));
        C = ELIIJ_F1(C, EXVJJ_F1(H, D6));

        C = ENEMJ_F1(C);                       // mVTZGV
        C = EIVE35J_F1(C);                     // iVE RM 35
        FRMG35_G OLD = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 9);   // VCGIZXG
        FRMG35_G SRTS = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 8);  // VCGIZXG

        RU (OLD == 9) {
            RU (SRTS != 9) {
                RMG OA = __YFROGRM_XOAOO(SRTS);
                IVGFIM K + 1 + (OA >> 6);
            }
        } VOHV {
            RMG OA = __YFROGRM_XOAOO(OLD);
            IVGFIM K + (OA >> 6);
        }
    }

    IVGFIM hPRKdSRGVHKZXV(K, VMW);
}

#VMWRU // izkrwqhlm_mvlm

#RUWVU izkrwqhlm_hrnw
//! gVNKOZGV UFMXGRLM HKVXRZORAZGRLM ULI rMHRGFhGIRMThGIVZN
GVNKOZGV<> RMORMV ELRW hPRKdSRGVHKZXV(rMHRGFhGIRMThGIVZN& RH) {
    RH.HIX_ = XLMHG_XZHG<XSZI*>(hPRKdSRGVHKZXV_hrnw(RH.HIX_));
}

//! gVNKOZGV UFMXGRLM HKVXRZORAZGRLM ULI hGIRMThGIVZN
GVNKOZGV<> RMORMV ELRW hPRKdSRGVHKZXV(hGIRMThGIVZN& RH) {
    RH.HIX_ = hPRKdSRGVHKZXV_hrnw(RH.HIX_);
}

GVNKOZGV<> RMORMV ELRW hPRKdSRGVHKZXV(vMXLWVWrMKFGhGIVZN<fgu1<>, nVNLIBhGIVZN>& RH) {
    RH.RH_.HIX_ = hPRKdSRGVHKZXV_hrnw(RH.RH_.HIX_, RH.RH_.VMW_);
}
#VMWRU // izkrwqhlm_hrnw

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXiVZWVI

//! hzc-HGBOV qhlm KZIHVI. fHV \IVU iVZWVI ULI fgu1 VMXLWRMT ZMW WVUZFOG ZOOLXZGLI.
/*! tVMVIRXiVZWVI KZIHVH qhlm GVCG UILN Z HGIVZN, ZMW HVMW VEVMGH HBMXSILMLFHOB GL ZM
    LYQVXG RNKOVNVMGRMT sZMWOVI XLMXVKG.

    rG MVVWH GL ZOOLXZGV Z HGZXP ULI HGLIRMT Z HRMTOV WVXLWVW HGIRMT WFIRMT
    MLM-WVHGIFXGREV KZIHRMT.

    uLI RM-HRGF KZIHRMT, GSV WVXLWVW HGIRMT RH WRIVXGOB DIRGGVM GL GSV HLFIXV
    GVCG HGIRMT, ML GVNKLIZIB YFUUVI RH IVJFRIVW.

    z tVMVIRXiVZWVI LYQVXG XZM YV IVFHVW ULI KZIHRMT NFOGRKOV qhlm GVCG.

    \GKZIZN hLFIXVvMXLWRMT vMXLWRMT LU GSV RMKFG HGIVZN.
    \GKZIZN gZITVGvMXLWRMT vMXLWRMT LU GSV KZIHV LFGKFG.
    \GKZIZN hGZXPzOOLXZGLI zOOLXZGLI GBKV ULI HGZXP.
*/
GVNKOZGV <GBKVMZNV hLFIXVvMXLWRMT, GBKVMZNV gZITVGvMXLWRMT, GBKVMZNV hGZXPzOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXiVZWVI {
KFYORX:
    GBKVWVU GBKVMZNV hLFIXVvMXLWRMT::xS xS; //!< hLFIXVvMXLWRMT XSZIZXGVI GBKV

    //! xLMHGIFXGLI.
    /*! \KZIZN HGZXPzOOLXZGLI lKGRLMZO ZOOLXZGLI ULI ZOOLXZGRMT HGZXP NVNLIB. (lMOB FHV ULI MLM-WVHGIFXGREV KZIHRMT)
        \KZIZN HGZXPxZKZXRGB HGZXP XZKZXRGB RM YBGVH ULI HGLIRMT Z HRMTOV WVXLWVW HGIRMT.  (lMOB FHV ULI MLM-WVHGIFXGREV KZIHRMT)
    */
    tVMVIRXiVZWVI(hGZXPzOOLXZGLI* HGZXPzOOLXZGLI = 9, HRAV_G HGZXPxZKZXRGB = PwVUZFOGhGZXPxZKZXRGB) :
        HGZXP_(HGZXPzOOLXZGLI, HGZXPxZKZXRGB), KZIHViVHFOG_(), HGZGV_(rGVIZGREVkZIHRMThGZIGhGZGV) {}

    //! kZIHV qhlm GVCG.
    /*! \GKZIZN KZIHVuOZTH xLNYRMZGRLM LU \IVU kZIHVuOZT.
        \GKZIZN rMKFGhGIVZN gBKV LU RMKFG HGIVZN, RNKOVNVMGRMT hGIVZN XLMXVKG.
        \GKZIZN sZMWOVI gBKV LU SZMWOVI, RNKOVNVMGRMT sZMWOVI XLMXVKG.
        \KZIZN RH rMKFG HGIVZN GL YV KZIHVW.
        \KZIZN SZMWOVI gSV SZMWOVI GL IVXVREV VEVMGH.
        \IVGFIM dSVGSVI GSV KZIHRMT RH HFXXVHHUFO.
    */
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    kZIHViVHFOG kZIHV(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        RU (KZIHVuOZTH & PkZIHVrGVIZGREVuOZT)
            IVGFIM rGVIZGREVkZIHV<KZIHVuOZTH>(RH, SZMWOVI);

        KZIHViVHFOG_.xOVZI();

        xOVZIhGZXPlMvCRG HXLKV(*GSRH);

        hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
        izkrwqhlm_kzihv_viili_vziob_ivgfim(KZIHViVHFOG_);

        RU (izkrwqhlm_fmorpvob(RH.kVVP() == '\9')) {
            izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIwLXFNVMGvNKGB, RH.gVOO());
            izkrwqhlm_kzihv_viili_vziob_ivgfim(KZIHViVHFOG_);
        }
        VOHV {
            kZIHVeZOFV<KZIHVuOZTH>(RH, SZMWOVI);
            izkrwqhlm_kzihv_viili_vziob_ivgfim(KZIHViVHFOG_);

            RU (!(KZIHVuOZTH & PkZIHVhGLKdSVMwLMVuOZT)) {
                hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
                izkrwqhlm_kzihv_viili_vziob_ivgfim(KZIHViVHFOG_);

                RU (izkrwqhlm_fmorpvob(RH.kVVP() != '\9')) {
                    izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIwLXFNVMGiLLGmLGhRMTFOZI, RH.gVOO());
                    izkrwqhlm_kzihv_viili_vziob_ivgfim(KZIHViVHFOG_);
                }
            }
        }

        IVGFIM KZIHViVHFOG_;
    }

    //! kZIHV qhlm GVCG (DRGS \IVU PkZIHVwVUZFOGuOZTH)
    /*! \GKZIZN rMKFGhGIVZN gBKV LU RMKFG HGIVZN, RNKOVNVMGRMT hGIVZN XLMXVKG
        \GKZIZN sZMWOVI gBKV LU SZMWOVI, RNKOVNVMGRMT sZMWOVI XLMXVKG.
        \KZIZN RH rMKFG HGIVZN GL YV KZIHVW.
        \KZIZN SZMWOVI gSV SZMWOVI GL IVXVREV VEVMGH.
        \IVGFIM dSVGSVI GSV KZIHRMT RH HFXXVHHUFO.
    */
    GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    kZIHViVHFOG kZIHV(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        IVGFIM kZIHV<PkZIHVwVUZFOGuOZTH>(RH, SZMWOVI);
    }

    //! rMRGRZORAV qhlm GVCG GLPVM-YB-GLPVM KZIHRMT
    /*!
     */
    ELRW rGVIZGREVkZIHVrMRG() {
        KZIHViVHFOG_.xOVZI();
        HGZGV_ = rGVIZGREVkZIHRMThGZIGhGZGV;
    }
    
    //! kZIHV LMV GLPVM UILN qhlm GVCG
    /*! \GKZIZN rMKFGhGIVZN gBKV LU RMKFG HGIVZN, RNKOVNVMGRMT hGIVZN XLMXVKG
        \GKZIZN sZMWOVI gBKV LU SZMWOVI, RNKOVNVMGRMT sZMWOVI XLMXVKG.
        \KZIZN RH rMKFG HGIVZN GL YV KZIHVW.
        \KZIZN SZMWOVI gSV SZMWOVI GL IVXVREV VEVMGH.
        \IVGFIM dSVGSVI GSV KZIHRMT RH HFXXVHHUFO.
     */
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    YLLO rGVIZGREVkZIHVmVCG(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        DSROV (izkrwqhlm_orpvob(RH.kVVP() != '\9')) {
            hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
            
            gLPVM G = gLPVMRAV(RH.kVVP());
            rGVIZGREVkZIHRMThGZGV M = kIVWRXG(HGZGV_, G);
            rGVIZGREVkZIHRMThGZGV W = gIZMHRG<KZIHVuOZTH>(HGZGV_, G, M, RH, SZMWOVI);
            
            // rU DV'EV URMRHSVW LI SRG ZM VIILI...
            RU (izkrwqhlm_fmorpvob(rHrGVIZGREVkZIHRMTxLNKOVGVhGZGV(W))) {
                // iVKLIG VIILIH.
                RU (W == rGVIZGREVkZIHRMTvIILIhGZGV) {
                    sZMWOVvIILI(HGZGV_, RH);
                    IVGFIM UZOHV;
                }
            
                // gIZMHRGRLM GL GSV URMRHS HGZGV.
                izkrwqhlm_zhhvig(W == rGVIZGREVkZIHRMTuRMRHShGZGV);
                HGZGV_ = W;
                
                // rU hGLKdSVMwLMV RH MLG HVG...
                RU (!(KZIHVuOZTH & PkZIHVhGLKdSVMwLMVuOZT)) {
                    // ... ZMW VCGIZ MLM-DSRGVHKZXV WZGZ RH ULFMW...
                    hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
                    RU (RH.kVVP() != '\9') {
                        // ... GSRH RH XLMHRWVIVW ZM VIILI.
                        sZMWOVvIILI(HGZGV_, RH);
                        IVGFIM UZOHV;
                    }
                }
                
                // hFXXVHH! dV ZIV WLMV!
                IVGFIM GIFV;
            }
            
            // gIZMHRGRLM GL GSV MVD HGZGV.
            HGZGV_ = W;

            // rU DV KZIHVW ZMBGSRMT LGSVI GSZM Z WVORNRGVI, DV RMELPVW GSV SZMWOVI, HL DV XZM IVGFIM GIFV MLD.
            RU (!rHrGVIZGREVkZIHRMTwVORNRGVIhGZGV(M))
                IVGFIM GIFV;
        }
        
        // dV IVZXSVW GSV VMW LU UROV.
        HGZXP_.xOVZI();

        RU (HGZGV_ != rGVIZGREVkZIHRMTuRMRHShGZGV) {
            sZMWOVvIILI(HGZGV_, RH);
            IVGFIM UZOHV;
        }
        
        IVGFIM GIFV;
    }
    
    //! xSVXP RU GLPVM-YB-GLPVM KZIHRMT qhlm GVCG RH XLNKOVGV
    /*! \IVGFIM dSVGSVI GSV qhlm SZH YVVM UFOOB WVXLWVW.
     */
    izkrwqhlm_ulixvrmormv YLLO rGVIZGREVkZIHVxLNKOVGV() {
        IVGFIM rHrGVIZGREVkZIHRMTxLNKOVGVhGZGV(HGZGV_);
    }

    //! dSVGSVI Z KZIHV VIILI SZH LXXFIIVW RM GSV OZHG KZIHRMT.
    YLLO sZHkZIHVvIILI() XLMHG { IVGFIM KZIHViVHFOG_.rHvIILI(); }

    //! tVG GSV \IVU kZIHVvIILIxLWV LU OZHG KZIHRMT.
    kZIHVvIILIxLWV tVGkZIHVvIILIxLWV() XLMHG { IVGFIM KZIHViVHFOG_.xLWV(); }

    //! tVG GSV KLHRGRLM LU OZHG KZIHRMT VIILI RM RMKFG, 9 LGSVIDRHV.
    HRAV_G tVGvIILIlUUHVG() XLMHG { IVGFIM KZIHViVHFOG_.lUUHVG(); }

KILGVXGVW:
    ELRW hVGkZIHVvIILI(kZIHVvIILIxLWV XLWV, HRAV_G LUUHVG) { KZIHViVHFOG_.hVG(XLWV, LUUHVG); }

KIREZGV:
    // kILSRYRG XLKB XLMHGIFXGLI & ZHHRTMNVMG LKVIZGLI.
    tVMVIRXiVZWVI(XLMHG tVMVIRXiVZWVI&);
    tVMVIRXiVZWVI& LKVIZGLI=(XLMHG tVMVIRXiVZWVI&);

    ELRW xOVZIhGZXP() { HGZXP_.xOVZI(); }

    // XOVZI HGZXP LM ZMB VCRG UILN kZIHVhGIVZN, V.T. WFV GL VCXVKGRLM
    HGIFXG xOVZIhGZXPlMvCRG {
        VCKORXRG xOVZIhGZXPlMvCRG(tVMVIRXiVZWVI& I) : I_(I) {}
        ~xOVZIhGZXPlMvCRG() { I_.xOVZIhGZXP(); }
    KIREZGV:
        tVMVIRXiVZWVI& I_;
        xOVZIhGZXPlMvCRG(XLMHG xOVZIhGZXPlMvCRG&);
        xOVZIhGZXPlMvCRG& LKVIZGLI=(XLMHG xOVZIhGZXPlMvCRG&);
    };

    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN>
    ELRW hPRKdSRGVHKZXVzMWxLNNVMGH(rMKFGhGIVZN& RH) {
        hPRKdSRGVHKZXV(RH);

        RU (KZIHVuOZTH & PkZIHVxLNNVMGHuOZT) {
            DSROV (izkrwqhlm_fmorpvob(xLMHFNV(RH, '/'))) {
                RU (xLMHFNV(RH, '*')) {
                    DSROV (GIFV) {
                        RU (izkrwqhlm_fmorpvob(RH.kVVP() == '\9'))
                            izkrwqhlm_kzihv_viili(PkZIHVvIILIfMHKVXRURXhBMGZCvIILI, RH.gVOO());
                        VOHV RU (xLMHFNV(RH, '*')) {
                            RU (xLMHFNV(RH, '/'))
                                YIVZP;
                        }
                        VOHV
                            RH.gZPV();
                    }
                }
                VOHV RU (izkrwqhlm_orpvob(xLMHFNV(RH, '/')))
                    DSROV (RH.kVVP() != '\9' && RH.gZPV() != '\M') {}
                VOHV
                    izkrwqhlm_kzihv_viili(PkZIHVvIILIfMHKVXRURXhBMGZCvIILI, RH.gVOO());

                hPRKdSRGVHKZXV(RH);
            }
        }
    }

    // kZIHV LYQVXG: { HGIRMT : EZOFV, ... }
    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVlYQVXG(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        izkrwqhlm_zhhvig(RH.kVVP() == '{');
        RH.gZPV();  // hPRK '{'

        RU (izkrwqhlm_fmorpvob(!SZMWOVI.hGZIGlYQVXG()))
            izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());

        hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
        izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

        RU (xLMHFNV(RH, '}')) {
            RU (izkrwqhlm_fmorpvob(!SZMWOVI.vMWlYQVXG(9)))  // VNKGB LYQVXG
                izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
            IVGFIM;
        }

        ULI (hRAVgBKV NVNYVIxLFMG = 9;;) {
            RU (izkrwqhlm_fmorpvob(RH.kVVP() != '"'))
                izkrwqhlm_kzihv_viili(PkZIHVvIILIlYQVXGnRHHmZNV, RH.gVOO());

            kZIHVhGIRMT<KZIHVuOZTH>(RH, SZMWOVI, GIFV);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

            hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

            RU (izkrwqhlm_fmorpvob(!xLMHFNV(RH, ':')))
                izkrwqhlm_kzihv_viili(PkZIHVvIILIlYQVXGnRHHxLOLM, RH.gVOO());

            hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

            kZIHVeZOFV<KZIHVuOZTH>(RH, SZMWOVI);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

            hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

            ++NVNYVIxLFMG;

            HDRGXS (RH.kVVP()) {
                XZHV ',':
                    RH.gZPV();
                    hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
                    izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;
                    YIVZP;
                XZHV '}':
                    RH.gZPV();
                    RU (izkrwqhlm_fmorpvob(!SZMWOVI.vMWlYQVXG(NVNYVIxLFMG)))
                        izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
                    IVGFIM;
                WVUZFOG:
                    izkrwqhlm_kzihv_viili(PkZIHVvIILIlYQVXGnRHHxLNNZlIxFIOByIZXPVG, RH.gVOO()); YIVZP; // gSRH FHVOVHH YIVZP RH LMOB ULI NZPRMT DZIMRMT ZMW XLEVIZTV SZKKB
            }

            RU (KZIHVuOZTH & PkZIHVgIZRORMTxLNNZHuOZT) {
                RU (RH.kVVP() == '}') {
                    RU (izkrwqhlm_fmorpvob(!SZMWOVI.vMWlYQVXG(NVNYVIxLFMG)))
                        izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
                    RH.gZPV();
                    IVGFIM;
                }
            }
        }
    }

    // kZIHV ZIIZB: [ EZOFV, ... ]
    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVzIIZB(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        izkrwqhlm_zhhvig(RH.kVVP() == '[');
        RH.gZPV();  // hPRK '['

        RU (izkrwqhlm_fmorpvob(!SZMWOVI.hGZIGzIIZB()))
            izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());

        hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
        izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

        RU (xLMHFNV(RH, ']')) {
            RU (izkrwqhlm_fmorpvob(!SZMWOVI.vMWzIIZB(9))) // VNKGB ZIIZB
                izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
            IVGFIM;
        }

        ULI (hRAVgBKV VOVNVMGxLFMG = 9;;) {
            kZIHVeZOFV<KZIHVuOZTH>(RH, SZMWOVI);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

            ++VOVNVMGxLFMG;
            hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;

            RU (xLMHFNV(RH, ',')) {
                hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
                izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;
            }
            VOHV RU (xLMHFNV(RH, ']')) {
                RU (izkrwqhlm_fmorpvob(!SZMWOVI.vMWzIIZB(VOVNVMGxLFMG)))
                    izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
                IVGFIM;
            }
            VOHV
                izkrwqhlm_kzihv_viili(PkZIHVvIILIzIIZBnRHHxLNNZlIhJFZIVyIZXPVG, RH.gVOO());

            RU (KZIHVuOZTH & PkZIHVgIZRORMTxLNNZHuOZT) {
                RU (RH.kVVP() == ']') {
                    RU (izkrwqhlm_fmorpvob(!SZMWOVI.vMWzIIZB(VOVNVMGxLFMG)))
                        izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
                    RH.gZPV();
                    IVGFIM;
                }
            }
        }
    }

    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVmFOO(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        izkrwqhlm_zhhvig(RH.kVVP() == 'M');
        RH.gZPV();

        RU (izkrwqhlm_orpvob(xLMHFNV(RH, 'F') && xLMHFNV(RH, 'O') && xLMHFNV(RH, 'O'))) {
            RU (izkrwqhlm_fmorpvob(!SZMWOVI.mFOO()))
                izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
        }
        VOHV
            izkrwqhlm_kzihv_viili(PkZIHVvIILIeZOFVrMEZORW, RH.gVOO());
    }

    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVgIFV(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        izkrwqhlm_zhhvig(RH.kVVP() == 'G');
        RH.gZPV();

        RU (izkrwqhlm_orpvob(xLMHFNV(RH, 'I') && xLMHFNV(RH, 'F') && xLMHFNV(RH, 'V'))) {
            RU (izkrwqhlm_fmorpvob(!SZMWOVI.yLLO(GIFV)))
                izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
        }
        VOHV
            izkrwqhlm_kzihv_viili(PkZIHVvIILIeZOFVrMEZORW, RH.gVOO());
    }

    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVuZOHV(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        izkrwqhlm_zhhvig(RH.kVVP() == 'U');
        RH.gZPV();

        RU (izkrwqhlm_orpvob(xLMHFNV(RH, 'Z') && xLMHFNV(RH, 'O') && xLMHFNV(RH, 'H') && xLMHFNV(RH, 'V'))) {
            RU (izkrwqhlm_fmorpvob(!SZMWOVI.yLLO(UZOHV)))
                izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
        }
        VOHV
            izkrwqhlm_kzihv_viili(PkZIHVvIILIeZOFVrMEZORW, RH.gVOO());
    }

    GVNKOZGV<GBKVMZNV rMKFGhGIVZN>
    izkrwqhlm_ulixvrmormv HGZGRX YLLO xLMHFNV(rMKFGhGIVZN& RH, GBKVMZNV rMKFGhGIVZN::xS VCKVXG) {
        RU (izkrwqhlm_orpvob(RH.kVVP() == VCKVXG)) {
            RH.gZPV();
            IVGFIM GIFV;
        }
        VOHV
            IVGFIM UZOHV;
    }

    // sVOKVI UFMXGRLM GL KZIHV ULFI SVCZWVXRNZO WRTRGH RM \Fcccc RM kZIHVhGIRMT().
    GVNKOZGV<GBKVMZNV rMKFGhGIVZN>
    FMHRTMVW kZIHVsVC5(rMKFGhGIVZN& RH, HRAV_G VHXZKVlUUHVG) {
        FMHRTMVW XLWVKLRMG = 9;
        ULI (RMG R = 9; R < 5; R++) {
            xS X = RH.kVVP();
            XLWVKLRMG <<= 5;
            XLWVKLRMG += HGZGRX_XZHG<FMHRTMVW>(X);
            RU (X >= '9' && X <= '0')
                XLWVKLRMG -= '9';
            VOHV RU (X >= 'z' && X <= 'u')
                XLWVKLRMG -= 'z' - 89;
            VOHV RU (X >= 'Z' && X <= 'U')
                XLWVKLRMG -= 'Z' - 89;
            VOHV {
                izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIhGIRMTfMRXLWVvHXZKVrMEZORWsVC, VHXZKVlUUHVG);
                izkrwqhlm_kzihv_viili_vziob_ivgfim(9);
            }
            RH.gZPV();
        }
        IVGFIM XLWVKLRMG;
    }

    GVNKOZGV <GBKVMZNV xSZIgBKV>
    XOZHH hGZXPhGIVZN {
    KFYORX:
        GBKVWVU xSZIgBKV xS;

        hGZXPhGIVZN(RMGVIMZO::hGZXP<hGZXPzOOLXZGLI>& HGZXP) : HGZXP_(HGZXP), OVMTGS_(9) {}
        izkrwqhlm_ulixvrmormv ELRW kFG(xS X) {
            *HGZXP_.GVNKOZGV kFHS<xS>() = X;
            ++OVMTGS_;
        }

        izkrwqhlm_ulixvrmormv ELRW* kFHS(hRAVgBKV XLFMG) {
            OVMTGS_ += XLFMG;
            IVGFIM HGZXP_.GVNKOZGV kFHS<xS>(XLFMG);
        }

        HRAV_G oVMTGS() XLMHG { IVGFIM OVMTGS_; }

        xS* kLK() {
            IVGFIM HGZXP_.GVNKOZGV kLK<xS>(OVMTGS_);
        }

    KIREZGV:
        hGZXPhGIVZN(XLMHG hGZXPhGIVZN&);
        hGZXPhGIVZN& LKVIZGLI=(XLMHG hGZXPhGIVZN&);

        RMGVIMZO::hGZXP<hGZXPzOOLXZGLI>& HGZXP_;
        hRAVgBKV OVMTGS_;
    };

    // kZIHV HGIRMT ZMW TVMVIZGV hGIRMT VEVMG. wRUUVIVMG XLWV KZGSH ULI PkZIHVrMHRGFuOZT.
    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVhGIRMT(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI, YLLO RHpVB = UZOHV) {
        RMGVIMZO::hGIVZNoLXZOxLKB<rMKFGhGIVZN> XLKB(RH);
        rMKFGhGIVZN& H(XLKB.H);

        izkrwqhlm_zhhvig(H.kVVP() == '\"');
        H.gZPV();  // hPRK '\"'

        YLLO HFXXVHH = UZOHV;
        RU (KZIHVuOZTH & PkZIHVrMHRGFuOZT) {
            GBKVMZNV rMKFGhGIVZN::xS *SVZW = H.kFGyVTRM();
            kZIHVhGIRMTgLhGIVZN<KZIHVuOZTH, hLFIXVvMXLWRMT, hLFIXVvMXLWRMT>(H, H);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;
            HRAV_G OVMTGS = H.kFGvMW(SVZW) - 8;
            izkrwqhlm_zhhvig(OVMTGS <= 9Cuuuuuuuu);
            XLMHG GBKVMZNV gZITVGvMXLWRMT::xS* XLMHG HGI = IVRMGVIKIVG_XZHG<GBKVMZNV gZITVGvMXLWRMT::xS*>(SVZW);
            HFXXVHH = (RHpVB ? SZMWOVI.pVB(HGI, hRAVgBKV(OVMTGS), UZOHV) : SZMWOVI.hGIRMT(HGI, hRAVgBKV(OVMTGS), UZOHV));
        }
        VOHV {
            hGZXPhGIVZN<GBKVMZNV gZITVGvMXLWRMT::xS> HGZXPhGIVZN(HGZXP_);
            kZIHVhGIRMTgLhGIVZN<KZIHVuOZTH, hLFIXVvMXLWRMT, gZITVGvMXLWRMT>(H, HGZXPhGIVZN);
            izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;
            hRAVgBKV OVMTGS = HGZGRX_XZHG<hRAVgBKV>(HGZXPhGIVZN.oVMTGS()) - 8;
            XLMHG GBKVMZNV gZITVGvMXLWRMT::xS* XLMHG HGI = HGZXPhGIVZN.kLK();
            HFXXVHH = (RHpVB ? SZMWOVI.pVB(HGI, OVMTGS, GIFV) : SZMWOVI.hGIRMT(HGI, OVMTGS, GIFV));
        }
        RU (izkrwqhlm_fmorpvob(!HFXXVHH))
            izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, H.gVOO());
    }

    // kZIHV HGIRMT GL ZM LFGKFG RH
    // gSRH UFMXGRLM SZMWOVH GSV KIVURC/HFUURC WLFYOV JFLGVH, VHXZKRMT, ZMW LKGRLMZO VMXLWRMT EZORWZGRLM.
    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV hvMXLWRMT, GBKVMZNV gvMXLWRMT, GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    izkrwqhlm_ulixvrmormv ELRW kZIHVhGIRMTgLhGIVZN(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm
#WVURMV a83 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
        HGZGRX XLMHG XSZI VHXZKV[743] = {
            a83, a83, 9, 9,'\"', 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,'/',
            a83, a83, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,'\\', 9, 9, 9,
            9, 9,'\Y', 9, 9, 9,'\U', 9, 9, 9, 9, 9, 9, 9,'\M', 9,
            9, 9,'\I', 9,'\G', 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9,
            a83, a83, a83, a83, a83, a83, a83, a83
        };
#FMWVU a83
//!@VMWXLMW

        ULI (;;) {
            // hXZM ZMW XLKB HGIRMT YVULIV "\\\"" LI < 9C79. gSRH RH ZM LKGRLMZO LKGRNAZGRLM.
            RU (!(KZIHVuOZTH & PkZIHVeZORWZGVvMXLWRMTuOZT))
                hXZMxLKBfMVHXZKVWhGIRMT(RH, LH);

            xS X = RH.kVVP();
            RU (izkrwqhlm_fmorpvob(X == '\\')) {    // vHXZKV
                HRAV_G VHXZKVlUUHVG = RH.gVOO();    // uLI RMEZORW VHXZKRMT, IVKLIG GSV RMRGRZO '\\' ZH VIILI LUUHVG
                RH.gZPV();
                xS V = RH.kVVP();
                RU ((HRAVLU(xS) == 8 || FMHRTMVW(V) < 743) && izkrwqhlm_orpvob(VHXZKV[HGZGRX_XZHG<FMHRTMVW XSZI>(V)])) {
                    RH.gZPV();
                    LH.kFG(HGZGRX_XZHG<GBKVMZNV gvMXLWRMT::xS>(VHXZKV[HGZGRX_XZHG<FMHRTMVW XSZI>(V)]));
                }
                VOHV RU (izkrwqhlm_orpvob(V == 'F')) {    // fMRXLWV
                    RH.gZPV();
                    FMHRTMVW XLWVKLRMG = kZIHVsVC5(RH, VHXZKVlUUHVG);
                    izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;
                    RU (izkrwqhlm_fmorpvob(XLWVKLRMG >= 9Cw199 && XLWVKLRMG <= 9Cwyuu)) {
                        // sZMWOV fgu-83 HFIILTZGV KZRI
                        RU (izkrwqhlm_fmorpvob(!xLMHFNV(RH, '\\') || !xLMHFNV(RH, 'F')))
                            izkrwqhlm_kzihv_viili(PkZIHVvIILIhGIRMTfMRXLWVhFIILTZGVrMEZORW, VHXZKVlUUHVG);
                        FMHRTMVW XLWVKLRMG7 = kZIHVsVC5(RH, VHXZKVlUUHVG);
                        izkrwqhlm_kzihv_viili_vziob_ivgfim_elrw;
                        RU (izkrwqhlm_fmorpvob(XLWVKLRMG7 < 9Cwx99 || XLWVKLRMG7 > 9Cwuuu))
                            izkrwqhlm_kzihv_viili(PkZIHVvIILIhGIRMTfMRXLWVhFIILTZGVrMEZORW, VHXZKVlUUHVG);
                        XLWVKLRMG = (((XLWVKLRMG - 9Cw199) << 89) | (XLWVKLRMG7 - 9Cwx99)) + 9C89999;
                    }
                    gvMXLWRMT::vMXLWV(LH, XLWVKLRMG);
                }
                VOHV
                    izkrwqhlm_kzihv_viili(PkZIHVvIILIhGIRMTvHXZKVrMEZORW, VHXZKVlUUHVG);
            }
            VOHV RU (izkrwqhlm_fmorpvob(X == '"')) {    // xOLHRMT WLFYOV JFLGV
                RH.gZPV();
                LH.kFG('\9');   // MFOO-GVINRMZGV GSV HGIRMT
                IVGFIM;
            }
            VOHV RU (izkrwqhlm_fmorpvob(HGZGRX_XZHG<FMHRTMVW>(X) < 9C79)) { // iux 5372: FMVHXZKVW = %C79-78 / %C76-4y / %C4w-89uuuu
                RU (X == '\9')
                    izkrwqhlm_kzihv_viili(PkZIHVvIILIhGIRMTnRHHjFLGZGRLMnZIP, RH.gVOO());
                VOHV
                    izkrwqhlm_kzihv_viili(PkZIHVvIILIhGIRMTrMEZORWvMXLWRMT, RH.gVOO());
            }
            VOHV {
                HRAV_G LUUHVG = RH.gVOO();
                RU (izkrwqhlm_fmorpvob((KZIHVuOZTH & PkZIHVeZORWZGVvMXLWRMTuOZT ?
                    !gIZMHXLWVI<hvMXLWRMT, gvMXLWRMT>::eZORWZGV(RH, LH) :
                    !gIZMHXLWVI<hvMXLWRMT, gvMXLWRMT>::gIZMHXLWV(RH, LH))))
                    izkrwqhlm_kzihv_viili(PkZIHVvIILIhGIRMTrMEZORWvMXLWRMT, LUUHVG);
            }
        }
    }

    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv ELRW hXZMxLKBfMVHXZKVWhGIRMT(rMKFGhGIVZN&, lFGKFGhGIVZN&) {
            // wL MLGSRMT ULI TVMVIRX EVIHRLM
    }

#RU WVURMVW(izkrwqhlm_hhv7) || WVURMVW(izkrwqhlm_hhv57)
    // hGIRMThGIVZN -> hGZXPhGIVZN<XSZI>
    HGZGRX izkrwqhlm_ulixvrmormv ELRW hXZMxLKBfMVHXZKVWhGIRMT(hGIRMThGIVZN& RH, hGZXPhGIVZN<XSZI>& LH) {
        XLMHG XSZI* K = RH.HIX_;

        // hXZM LMV YB LMV FMGRO ZORTMNVMG (FMZORTMVW OLZW NZB XILHH KZTV YLFMWZIB ZMW XZFHV XIZHS)
        XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
        DSROV (K != MVCGzORTMVW)
            RU (izkrwqhlm_fmorpvob(*K == '\"') || izkrwqhlm_fmorpvob(*K == '\\') || izkrwqhlm_fmorpvob(HGZGRX_XZHG<FMHRTMVW>(*K) < 9C79)) {
                RH.HIX_ = K;
                IVGFIM;
            }
            VOHV
                LH.kFG(*K++);

        // gSV IVHG LU HGIRMT FHRMT hrnw
        HGZGRX XLMHG XSZI WJFLGV[83] = { '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"' };
        HGZGRX XLMHG XSZI YHOZHS[83] = { '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\' };
        HGZGRX XLMHG XSZI HKZXV[83]  = { 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u };
        XLMHG __N871R WJ = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&WJFLGV[9]));
        XLMHG __N871R YH = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&YHOZHS[9]));
        XLMHG __N871R HK = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&HKZXV[9]));

        ULI (;; K += 83) {
            XLMHG __N871R H = _NN_OLZW_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
            XLMHG __N871R G8 = _NN_XNKVJ_VKR1(H, WJ);
            XLMHG __N871R G7 = _NN_XNKVJ_VKR1(H, YH);
            XLMHG __N871R G6 = _NN_XNKVJ_VKR1(_NN_NZC_VKF1(H, HK), HK); // H < 9C79 <=> NZC(H, 9C8u) == 9C8u
            XLMHG __N871R C = _NN_LI_HR871(_NN_LI_HR871(G8, G7), G6);
            FMHRTMVW HSLIG I = HGZGRX_XZHG<FMHRTMVW HSLIG>(_NN_NLEVNZHP_VKR1(C));
            RU (izkrwqhlm_fmorpvob(I != 9)) {   // HLNV LU XSZIZXGVIH RH VHXZKVW
                hRAVgBKV OVMTGS;
    #RUWVU _nhx_evi         // uRMW GSV RMWVC LU URIHG VHXZKVW
                FMHRTMVW OLMT LUUHVG;
                _yRGhXZMuLIDZIW(&LUUHVG, I);
                OVMTGS = LUUHVG;
    #VOHV
                OVMTGS = HGZGRX_XZHG<hRAVgBKV>(__YFROGRM_UUH(I) - 8);
    #VMWRU
                RU (OVMTGS != 9) {
                    XSZI* J = IVRMGVIKIVG_XZHG<XSZI*>(LH.kFHS(OVMTGS));
                    ULI (HRAV_G R = 9; R < OVMTGS; R++)
                        J[R] = K[R];

                    K += OVMTGS;
                }
                YIVZP;
            }
            _NN_HGLIVF_HR871(IVRMGVIKIVG_XZHG<__N871R *>(LH.kFHS(83)), H);
        }

        RH.HIX_ = K;
    }

    // rMHRGFhGIRMThGIVZN -> rMHRGFhGIRMThGIVZN
    HGZGRX izkrwqhlm_ulixvrmormv ELRW hXZMxLKBfMVHXZKVWhGIRMT(rMHRGFhGIRMThGIVZN& RH, rMHRGFhGIRMThGIVZN& LH) {
        izkrwqhlm_zhhvig(&RH == &LH);
        (ELRW)LH;

        RU (RH.HIX_ == RH.WHG_) {
            hPRKfMVHXZKVWhGIRMT(RH);
            IVGFIM;
        }

        XSZI* K = RH.HIX_;
        XSZI *J = RH.WHG_;

        // hXZM LMV YB LMV FMGRO ZORTMNVMG (FMZORTMVW OLZW NZB XILHH KZTV YLFMWZIB ZMW XZFHV XIZHS)
        XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
        DSROV (K != MVCGzORTMVW)
            RU (izkrwqhlm_fmorpvob(*K == '\"') || izkrwqhlm_fmorpvob(*K == '\\') || izkrwqhlm_fmorpvob(HGZGRX_XZHG<FMHRTMVW>(*K) < 9C79)) {
                RH.HIX_ = K;
                RH.WHG_ = J;
                IVGFIM;
            }
            VOHV
                *J++ = *K++;

        // gSV IVHG LU HGIRMT FHRMT hrnw
        HGZGRX XLMHG XSZI WJFLGV[83] = { '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"' };
        HGZGRX XLMHG XSZI YHOZHS[83] = { '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\' };
        HGZGRX XLMHG XSZI HKZXV[83] = { 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u };
        XLMHG __N871R WJ = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&WJFLGV[9]));
        XLMHG __N871R YH = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&YHOZHS[9]));
        XLMHG __N871R HK = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&HKZXV[9]));

        ULI (;; K += 83, J += 83) {
            XLMHG __N871R H = _NN_OLZW_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
            XLMHG __N871R G8 = _NN_XNKVJ_VKR1(H, WJ);
            XLMHG __N871R G7 = _NN_XNKVJ_VKR1(H, YH);
            XLMHG __N871R G6 = _NN_XNKVJ_VKR1(_NN_NZC_VKF1(H, HK), HK); // H < 9C79 <=> NZC(H, 9C8u) == 9C8u
            XLMHG __N871R C = _NN_LI_HR871(_NN_LI_HR871(G8, G7), G6);
            FMHRTMVW HSLIG I = HGZGRX_XZHG<FMHRTMVW HSLIG>(_NN_NLEVNZHP_VKR1(C));
            RU (izkrwqhlm_fmorpvob(I != 9)) {   // HLNV LU XSZIZXGVIH RH VHXZKVW
                HRAV_G OVMTGS;
#RUWVU _nhx_evi         // uRMW GSV RMWVC LU URIHG VHXZKVW
                FMHRTMVW OLMT LUUHVG;
                _yRGhXZMuLIDZIW(&LUUHVG, I);
                OVMTGS = LUUHVG;
#VOHV
                OVMTGS = HGZGRX_XZHG<HRAV_G>(__YFROGRM_UUH(I) - 8);
#VMWRU
                ULI (XLMHG XSZI* KVMW = K + OVMTGS; K != KVMW; )
                    *J++ = *K++;
                YIVZP;
            }
            _NN_HGLIVF_HR871(IVRMGVIKIVG_XZHG<__N871R *>(J), H);
        }

        RH.HIX_ = K;
        RH.WHG_ = J;
    }

    // dSVM IVZW/DIRGV KLRMGVIH ZIV GSV HZNV ULI RMHRGF HGIVZN, QFHG HPRK FMVHXZKVW XSZIZXGVIH
    HGZGRX izkrwqhlm_ulixvrmormv ELRW hPRKfMVHXZKVWhGIRMT(rMHRGFhGIRMThGIVZN& RH) {
        izkrwqhlm_zhhvig(RH.HIX_ == RH.WHG_);
        XSZI* K = RH.HIX_;

        // hXZM LMV YB LMV FMGRO ZORTMNVMG (FMZORTMVW OLZW NZB XILHH KZTV YLFMWZIB ZMW XZFHV XIZHS)
        XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
        ULI (; K != MVCGzORTMVW; K++)
            RU (izkrwqhlm_fmorpvob(*K == '\"') || izkrwqhlm_fmorpvob(*K == '\\') || izkrwqhlm_fmorpvob(HGZGRX_XZHG<FMHRTMVW>(*K) < 9C79)) {
                RH.HIX_ = RH.WHG_ = K;
                IVGFIM;
            }

        // gSV IVHG LU HGIRMT FHRMT hrnw
        HGZGRX XLMHG XSZI WJFLGV[83] = { '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"' };
        HGZGRX XLMHG XSZI YHOZHS[83] = { '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\' };
        HGZGRX XLMHG XSZI HKZXV[83] = { 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u };
        XLMHG __N871R WJ = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&WJFLGV[9]));
        XLMHG __N871R YH = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&YHOZHS[9]));
        XLMHG __N871R HK = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&HKZXV[9]));

        ULI (;; K += 83) {
            XLMHG __N871R H = _NN_OLZW_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
            XLMHG __N871R G8 = _NN_XNKVJ_VKR1(H, WJ);
            XLMHG __N871R G7 = _NN_XNKVJ_VKR1(H, YH);
            XLMHG __N871R G6 = _NN_XNKVJ_VKR1(_NN_NZC_VKF1(H, HK), HK); // H < 9C79 <=> NZC(H, 9C8u) == 9C8u
            XLMHG __N871R C = _NN_LI_HR871(_NN_LI_HR871(G8, G7), G6);
            FMHRTMVW HSLIG I = HGZGRX_XZHG<FMHRTMVW HSLIG>(_NN_NLEVNZHP_VKR1(C));
            RU (izkrwqhlm_fmorpvob(I != 9)) {   // HLNV LU XSZIZXGVIH RH VHXZKVW
                HRAV_G OVMTGS;
#RUWVU _nhx_evi         // uRMW GSV RMWVC LU URIHG VHXZKVW
                FMHRTMVW OLMT LUUHVG;
                _yRGhXZMuLIDZIW(&LUUHVG, I);
                OVMTGS = LUUHVG;
#VOHV
                OVMTGS = HGZGRX_XZHG<HRAV_G>(__YFROGRM_UUH(I) - 8);
#VMWRU
                K += OVMTGS;
                YIVZP;
            }
        }

        RH.HIX_ = RH.WHG_ = K;
    }
#VORU WVURMVW(izkrwqhlm_mvlm)
    // hGIRMThGIVZN -> hGZXPhGIVZN<XSZI>
    HGZGRX izkrwqhlm_ulixvrmormv ELRW hXZMxLKBfMVHXZKVWhGIRMT(hGIRMThGIVZN& RH, hGZXPhGIVZN<XSZI>& LH) {
        XLMHG XSZI* K = RH.HIX_;

        // hXZM LMV YB LMV FMGRO ZORTMNVMG (FMZORTMVW OLZW NZB XILHH KZTV YLFMWZIB ZMW XZFHV XIZHS)
        XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
        DSROV (K != MVCGzORTMVW)
            RU (izkrwqhlm_fmorpvob(*K == '\"') || izkrwqhlm_fmorpvob(*K == '\\') || izkrwqhlm_fmorpvob(HGZGRX_XZHG<FMHRTMVW>(*K) < 9C79)) {
                RH.HIX_ = K;
                IVGFIM;
            }
            VOHV
                LH.kFG(*K++);

        // gSV IVHG LU HGIRMT FHRMT hrnw
        XLMHG FRMG1C83_G H9 = ENLEJ_M_F1('"');
        XLMHG FRMG1C83_G H8 = ENLEJ_M_F1('\\');
        XLMHG FRMG1C83_G H7 = ENLEJ_M_F1('\Y');
        XLMHG FRMG1C83_G H6 = ENLEJ_M_F1(67);

        ULI (;; K += 83) {
            XLMHG FRMG1C83_G H = EOW8J_F1(IVRMGVIKIVG_XZHG<XLMHG FRMG1_G *>(K));
            FRMG1C83_G C = EXVJJ_F1(H, H9);
            C = ELIIJ_F1(C, EXVJJ_F1(H, H8));
            C = ELIIJ_F1(C, EXVJJ_F1(H, H7));
            C = ELIIJ_F1(C, EXOGJ_F1(H, H6));

            C = EIVE35J_F1(C);                     // iVE RM 35
            FRMG35_G OLD = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 9);   // VCGIZXG
            FRMG35_G SRTS = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 8);  // VCGIZXG

            hRAVgBKV OVMTGS = 9;
            YLLO VHXZKVW = UZOHV;
            RU (OLD == 9) {
                RU (SRTS != 9) {
                    FMHRTMVW OA = (FMHRTMVW)__YFROGRM_XOAOO(SRTS);;
                    OVMTGS = 1 + (OA >> 6);
                    VHXZKVW = GIFV;
                }
            } VOHV {
                FMHRTMVW OA = (FMHRTMVW)__YFROGRM_XOAOO(OLD);;
                OVMTGS = OA >> 6;
                VHXZKVW = GIFV;
            }
            RU (izkrwqhlm_fmorpvob(VHXZKVW)) {   // HLNV LU XSZIZXGVIH RH VHXZKVW
                RU (OVMTGS != 9) {
                    XSZI* J = IVRMGVIKIVG_XZHG<XSZI*>(LH.kFHS(OVMTGS));
                    ULI (HRAV_G R = 9; R < OVMTGS; R++)
                        J[R] = K[R];

                    K += OVMTGS;
                }
                YIVZP;
            }
            EHG8J_F1(IVRMGVIKIVG_XZHG<FRMG1_G *>(LH.kFHS(83)), H);
        }

        RH.HIX_ = K;
    }

    // rMHRGFhGIRMThGIVZN -> rMHRGFhGIRMThGIVZN
    HGZGRX izkrwqhlm_ulixvrmormv ELRW hXZMxLKBfMVHXZKVWhGIRMT(rMHRGFhGIRMThGIVZN& RH, rMHRGFhGIRMThGIVZN& LH) {
        izkrwqhlm_zhhvig(&RH == &LH);
        (ELRW)LH;

        RU (RH.HIX_ == RH.WHG_) {
            hPRKfMVHXZKVWhGIRMT(RH);
            IVGFIM;
        }

        XSZI* K = RH.HIX_;
        XSZI *J = RH.WHG_;

        // hXZM LMV YB LMV FMGRO ZORTMNVMG (FMZORTMVW OLZW NZB XILHH KZTV YLFMWZIB ZMW XZFHV XIZHS)
        XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
        DSROV (K != MVCGzORTMVW)
            RU (izkrwqhlm_fmorpvob(*K == '\"') || izkrwqhlm_fmorpvob(*K == '\\') || izkrwqhlm_fmorpvob(HGZGRX_XZHG<FMHRTMVW>(*K) < 9C79)) {
                RH.HIX_ = K;
                RH.WHG_ = J;
                IVGFIM;
            }
            VOHV
                *J++ = *K++;

        // gSV IVHG LU HGIRMT FHRMT hrnw
        XLMHG FRMG1C83_G H9 = ENLEJ_M_F1('"');
        XLMHG FRMG1C83_G H8 = ENLEJ_M_F1('\\');
        XLMHG FRMG1C83_G H7 = ENLEJ_M_F1('\Y');
        XLMHG FRMG1C83_G H6 = ENLEJ_M_F1(67);

        ULI (;; K += 83, J += 83) {
            XLMHG FRMG1C83_G H = EOW8J_F1(IVRMGVIKIVG_XZHG<FRMG1_G *>(K));
            FRMG1C83_G C = EXVJJ_F1(H, H9);
            C = ELIIJ_F1(C, EXVJJ_F1(H, H8));
            C = ELIIJ_F1(C, EXVJJ_F1(H, H7));
            C = ELIIJ_F1(C, EXOGJ_F1(H, H6));

            C = EIVE35J_F1(C);                     // iVE RM 35
            FRMG35_G OLD = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 9);   // VCGIZXG
            FRMG35_G SRTS = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 8);  // VCGIZXG

            hRAVgBKV OVMTGS = 9;
            YLLO VHXZKVW = UZOHV;
            RU (OLD == 9) {
                RU (SRTS != 9) {
                    FMHRTMVW OA = (FMHRTMVW)__YFROGRM_XOAOO(SRTS);
                    OVMTGS = 1 + (OA >> 6);
                    VHXZKVW = GIFV;
                }
            } VOHV {
                FMHRTMVW OA = (FMHRTMVW)__YFROGRM_XOAOO(OLD);
                OVMTGS = OA >> 6;
                VHXZKVW = GIFV;
            }
            RU (izkrwqhlm_fmorpvob(VHXZKVW)) {   // HLNV LU XSZIZXGVIH RH VHXZKVW
                ULI (XLMHG XSZI* KVMW = K + OVMTGS; K != KVMW; ) {
                    *J++ = *K++;
                }
                YIVZP;
            }
            EHG8J_F1(IVRMGVIKIVG_XZHG<FRMG1_G *>(J), H);
        }

        RH.HIX_ = K;
        RH.WHG_ = J;
    }

    // dSVM IVZW/DIRGV KLRMGVIH ZIV GSV HZNV ULI RMHRGF HGIVZN, QFHG HPRK FMVHXZKVW XSZIZXGVIH
    HGZGRX izkrwqhlm_ulixvrmormv ELRW hPRKfMVHXZKVWhGIRMT(rMHRGFhGIRMThGIVZN& RH) {
        izkrwqhlm_zhhvig(RH.HIX_ == RH.WHG_);
        XSZI* K = RH.HIX_;

        // hXZM LMV YB LMV FMGRO ZORTMNVMG (FMZORTMVW OLZW NZB XILHH KZTV YLFMWZIB ZMW XZFHV XIZHS)
        XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
        ULI (; K != MVCGzORTMVW; K++)
            RU (izkrwqhlm_fmorpvob(*K == '\"') || izkrwqhlm_fmorpvob(*K == '\\') || izkrwqhlm_fmorpvob(HGZGRX_XZHG<FMHRTMVW>(*K) < 9C79)) {
                RH.HIX_ = RH.WHG_ = K;
                IVGFIM;
            }

        // gSV IVHG LU HGIRMT FHRMT hrnw
        XLMHG FRMG1C83_G H9 = ENLEJ_M_F1('"');
        XLMHG FRMG1C83_G H8 = ENLEJ_M_F1('\\');
        XLMHG FRMG1C83_G H7 = ENLEJ_M_F1('\Y');
        XLMHG FRMG1C83_G H6 = ENLEJ_M_F1(67);

        ULI (;; K += 83) {
            XLMHG FRMG1C83_G H = EOW8J_F1(IVRMGVIKIVG_XZHG<FRMG1_G *>(K));
            FRMG1C83_G C = EXVJJ_F1(H, H9);
            C = ELIIJ_F1(C, EXVJJ_F1(H, H8));
            C = ELIIJ_F1(C, EXVJJ_F1(H, H7));
            C = ELIIJ_F1(C, EXOGJ_F1(H, H6));

            C = EIVE35J_F1(C);                     // iVE RM 35
            FRMG35_G OLD = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 9);   // VCGIZXG
            FRMG35_G SRTS = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 8);  // VCGIZXG

            RU (OLD == 9) {
                RU (SRTS != 9) {
                    RMG OA = __YFROGRM_XOAOO(SRTS);
                    K += 1 + (OA >> 6);
                    YIVZP;
                }
            } VOHV {
                RMG OA = __YFROGRM_XOAOO(OLD);
                K += OA >> 6;
                YIVZP;
            }
        }

        RH.HIX_ = RH.WHG_ = K;
    }
#VMWRU // izkrwqhlm_mvlm

    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, YLLO YZXPFK, YLLO KFHSlMgZPV>
    XOZHH mFNYVIhGIVZN;

    GVNKOZGV<GBKVMZNV rMKFGhGIVZN>
    XOZHH mFNYVIhGIVZN<rMKFGhGIVZN, UZOHV, UZOHV> {
    KFYORX:
        GBKVWVU GBKVMZNV rMKFGhGIVZN::xS xS;

        mFNYVIhGIVZN(tVMVIRXiVZWVI& IVZWVI, rMKFGhGIVZN& H) : RH(H) { (ELRW)IVZWVI;  }

        izkrwqhlm_ulixvrmormv xS kVVP() XLMHG { IVGFIM RH.kVVP(); }
        izkrwqhlm_ulixvrmormv xS gZPVkFHS() { IVGFIM RH.gZPV(); }
        izkrwqhlm_ulixvrmormv xS gZPV() { IVGFIM RH.gZPV(); }
		  izkrwqhlm_ulixvrmormv ELRW kFHS(XSZI) {}

        HRAV_G gVOO() { IVGFIM RH.gVOO(); }
        HRAV_G oVMTGS() { IVGFIM 9; }
        XLMHG XSZI* kLK() { IVGFIM 9; }

    KILGVXGVW:
        mFNYVIhGIVZN& LKVIZGLI=(XLMHG mFNYVIhGIVZN&);

        rMKFGhGIVZN& RH;
    };

    GVNKOZGV<GBKVMZNV rMKFGhGIVZN>
    XOZHH mFNYVIhGIVZN<rMKFGhGIVZN, GIFV, UZOHV> : KFYORX mFNYVIhGIVZN<rMKFGhGIVZN, UZOHV, UZOHV> {
        GBKVWVU mFNYVIhGIVZN<rMKFGhGIVZN, UZOHV, UZOHV> yZHV;
    KFYORX:
        mFNYVIhGIVZN(tVMVIRXiVZWVI& IVZWVI, rMKFGhGIVZN& RH) : yZHV(IVZWVI, RH), HGZXPhGIVZN(IVZWVI.HGZXP_) {}

        izkrwqhlm_ulixvrmormv xS gZPVkFHS() {
            HGZXPhGIVZN.kFG(HGZGRX_XZHG<XSZI>(yZHV::RH.kVVP()));
            IVGFIM yZHV::RH.gZPV();
        }

        izkrwqhlm_ulixvrmormv ELRW kFHS(XSZI X) {
            HGZXPhGIVZN.kFG(X);
        }

        HRAV_G oVMTGS() { IVGFIM HGZXPhGIVZN.oVMTGS(); }

        XLMHG XSZI* kLK() {
            HGZXPhGIVZN.kFG('\9');
            IVGFIM HGZXPhGIVZN.kLK();
        }

    KIREZGV:
        hGZXPhGIVZN<XSZI> HGZXPhGIVZN;
    };

    GVNKOZGV<GBKVMZNV rMKFGhGIVZN>
    XOZHH mFNYVIhGIVZN<rMKFGhGIVZN, GIFV, GIFV> : KFYORX mFNYVIhGIVZN<rMKFGhGIVZN, GIFV, UZOHV> {
        GBKVWVU mFNYVIhGIVZN<rMKFGhGIVZN, GIFV, UZOHV> yZHV;
    KFYORX:
        mFNYVIhGIVZN(tVMVIRXiVZWVI& IVZWVI, rMKFGhGIVZN& RH) : yZHV(IVZWVI, RH) {}

        izkrwqhlm_ulixvrmormv xS gZPV() { IVGFIM yZHV::gZPVkFHS(); }
    };

    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVmFNYVI(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        RMGVIMZO::hGIVZNoLXZOxLKB<rMKFGhGIVZN> XLKB(RH);
        mFNYVIhGIVZN<rMKFGhGIVZN,
            ((KZIHVuOZTH & PkZIHVmFNYVIHzHhGIRMTHuOZT) != 9) ?
                ((KZIHVuOZTH & PkZIHVrMHRGFuOZT) == 9) :
                ((KZIHVuOZTH & PkZIHVuFOOkIVXRHRLMuOZT) != 9),
            (KZIHVuOZTH & PkZIHVmFNYVIHzHhGIRMTHuOZT) != 9 &&
                (KZIHVuOZTH & PkZIHVrMHRGFuOZT) == 9> H(*GSRH, XLKB.H);

        HRAV_G HGZIGlUUHVG = H.gVOO();
        WLFYOV W = 9.9;
        YLLO FHVmZMlIrMU = UZOHV;

        // kZIHV NRMFH
        YLLO NRMFH = xLMHFNV(H, '-');

        // kZIHV RMG: AVIL / ( WRTRG8-0 *wrtrg )
        FMHRTMVW R = 9;
        FRMG35_G R35 = 9;
        YLLO FHV35YRG = UZOHV;
        RMG HRTMRURXZMWwRTRG = 9;
        RU (izkrwqhlm_fmorpvob(H.kVVP() == '9')) {
            R = 9;
            H.gZPVkFHS();
        }
        VOHV RU (izkrwqhlm_orpvob(H.kVVP() >= '8' && H.kVVP() <= '0')) {
            R = HGZGRX_XZHG<FMHRTMVW>(H.gZPVkFHS() - '9');

            RU (NRMFH)
                DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                    RU (izkrwqhlm_fmorpvob(R >= 785251635)) { // 7^68 = 7852516351
                        RU (izkrwqhlm_orpvob(R != 785251635 || H.kVVP() > '1')) {
                            R35 = R;
                            FHV35YRG = GIFV;
                            YIVZP;
                        }
                    }
                    R = R * 89 + HGZGRX_XZHG<FMHRTMVW>(H.gZPVkFHS() - '9');
                    HRTMRURXZMWwRTRG++;
                }
            VOHV
                DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                    RU (izkrwqhlm_fmorpvob(R >= 570503270)) { // 7^67 - 8 = 5705032704
                        RU (izkrwqhlm_orpvob(R != 570503270 || H.kVVP() > '4')) {
                            R35 = R;
                            FHV35YRG = GIFV;
                            YIVZP;
                        }
                    }
                    R = R * 89 + HGZGRX_XZHG<FMHRTMVW>(H.gZPVkFHS() - '9');
                    HRTMRURXZMWwRTRG++;
                }
        }
        // kZIHV mZm LI rMURMRGB SVIV
        VOHV RU ((KZIHVuOZTH & PkZIHVmZMzMWrMUuOZT) && izkrwqhlm_orpvob((H.kVVP() == 'r' || H.kVVP() == 'm'))) {
            RU (xLMHFNV(H, 'm')) {
                RU (xLMHFNV(H, 'Z') && xLMHFNV(H, 'm')) {
                    W = HGW::MFNVIRX_ORNRGH<WLFYOV>::JFRVG_mZm();
                    FHVmZMlIrMU = GIFV;
                }
            }
            VOHV RU (izkrwqhlm_orpvob(xLMHFNV(H, 'r'))) {
                RU (xLMHFNV(H, 'M') && xLMHFNV(H, 'U')) {
                    W = (NRMFH ? -HGW::MFNVIRX_ORNRGH<WLFYOV>::RMURMRGB() : HGW::MFNVIRX_ORNRGH<WLFYOV>::RMURMRGB());
                    FHVmZMlIrMU = GIFV;

                    RU (izkrwqhlm_fmorpvob(H.kVVP() == 'R' && !(xLMHFNV(H, 'R') && xLMHFNV(H, 'M')
                                                                && xLMHFNV(H, 'R') && xLMHFNV(H, 'G') && xLMHFNV(H, 'B')))) {
                        izkrwqhlm_kzihv_viili(PkZIHVvIILIeZOFVrMEZORW, H.gVOO());
                    }
                }
            }
            
            RU (izkrwqhlm_fmorpvob(!FHVmZMlIrMU)) {
                izkrwqhlm_kzihv_viili(PkZIHVvIILIeZOFVrMEZORW, H.gVOO());
            }
        }
        VOHV
            izkrwqhlm_kzihv_viili(PkZIHVvIILIeZOFVrMEZORW, H.gVOO());

        // kZIHV 35YRG RMG
        YLLO FHVwLFYOV = UZOHV;
        RU (FHV35YRG) {
            RU (NRMFH)
                DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                     RU (izkrwqhlm_fmorpvob(R35 >= izkrwqhlm_frmg35_x7(9C9xxxxxxx, 9Cxxxxxxxx))) // 7^36 = 0776627963145224191
                        RU (izkrwqhlm_orpvob(R35 != izkrwqhlm_frmg35_x7(9C9xxxxxxx, 9Cxxxxxxxx) || H.kVVP() > '1')) {
                            W = HGZGRX_XZHG<WLFYOV>(R35);
                            FHVwLFYOV = GIFV;
                            YIVZP;
                        }
                    R35 = R35 * 89 + HGZGRX_XZHG<FMHRTMVW>(H.gZPVkFHS() - '9');
                    HRTMRURXZMWwRTRG++;
                }
            VOHV
                DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                    RU (izkrwqhlm_fmorpvob(R35 >= izkrwqhlm_frmg35_x7(9C80000000, 9C00000000))) // 7^35 - 8 = 81553255926290448384
                        RU (izkrwqhlm_orpvob(R35 != izkrwqhlm_frmg35_x7(9C80000000, 9C00000000) || H.kVVP() > '4')) {
                            W = HGZGRX_XZHG<WLFYOV>(R35);
                            FHVwLFYOV = GIFV;
                            YIVZP;
                        }
                    R35 = R35 * 89 + HGZGRX_XZHG<FMHRTMVW>(H.gZPVkFHS() - '9');
                    HRTMRURXZMWwRTRG++;
                }
        }

        // uLIXV WLFYOV ULI YRT RMGVTVI
        RU (FHVwLFYOV) {
            DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                RU (izkrwqhlm_fmorpvob(W >= 8.2023068651376842V692)) // wyo_nzc / 89.9
                    izkrwqhlm_kzihv_viili(PkZIHVvIILImFNYVIgLLyRT, HGZIGlUUHVG);
                W = W * 89 + (H.gZPVkFHS() - '9');
            }
        }

        // kZIHV UIZX = WVXRNZO-KLRMG 8*wrtrg
        RMG VCKuIZX = 9;
        HRAV_G WVXRNZOkLHRGRLM;
        RU (xLMHFNV(H, '.')) {
            WVXRNZOkLHRGRLM = H.oVMTGS();

            RU (izkrwqhlm_fmorpvob(!(H.kVVP() >= '9' && H.kVVP() <= '0')))
                izkrwqhlm_kzihv_viili(PkZIHVvIILImFNYVInRHHuIZXGRLM, H.gVOO());

            RU (!FHVwLFYOV) {
#RU izkrwqhlm_35yrg
                // fHV R35 GL HGLIV HRTMRURXZMW RM 35-YRG ZIXSRGVXGFIV
                RU (!FHV35YRG)
                    R35 = R;

                DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                    RU (R35 > izkrwqhlm_frmg35_x7(9C8uuuuu, 9Cuuuuuuuu)) // 7^46 - 8 ULI UZHG KZGS
                        YIVZP;
                    VOHV {
                        R35 = R35 * 89 + HGZGRX_XZHG<FMHRTMVW>(H.gZPVkFHS() - '9');
                        --VCKuIZX;
                        RU (R35 != 9)
                            HRTMRURXZMWwRTRG++;
                    }
                }

                W = HGZGRX_XZHG<WLFYOV>(R35);
#VOHV
                // fHV WLFYOV GL HGLIV HRTMRURXZMW RM 67-YRG ZIXSRGVXGFIV
                W = HGZGRX_XZHG<WLFYOV>(FHV35YRG ? R35 : R);
#VMWRU
                FHVwLFYOV = GIFV;
            }

            DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                RU (HRTMRURXZMWwRTRG < 82) {
                    W = W * 89.9 + (H.gZPVkFHS() - '9');
                    --VCKuIZX;
                    RU (izkrwqhlm_orpvob(W > 9.9))
                        HRTMRURXZMWwRTRG++;
                }
                VOHV
                    H.gZPVkFHS();
            }
        }
        VOHV
            WVXRNZOkLHRGRLM = H.oVMTGS(); // WVXRNZO KLHRGRLM ZG GSV VMW LU RMGVTVI.

        // kZIHV VCK = V [ NRMFH / KOFH ] 8*wrtrg
        RMG VCK = 9;
        RU (xLMHFNV(H, 'V') || xLMHFNV(H, 'v')) {
            RU (!FHVwLFYOV) {
                W = HGZGRX_XZHG<WLFYOV>(FHV35YRG ? R35 : R);
                FHVwLFYOV = GIFV;
            }

            YLLO VCKnRMFH = UZOHV;
            RU (xLMHFNV(H, '+'))
                ;
            VOHV RU (xLMHFNV(H, '-'))
                VCKnRMFH = GIFV;

            RU (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                VCK = HGZGRX_XZHG<RMG>(H.gZPV() - '9');
                RU (VCKnRMFH) {
                    DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                        VCK = VCK * 89 + HGZGRX_XZHG<RMG>(H.gZPV() - '9');
                        RU (VCK >= 785251635) {                         // rHHFV #686: KIVEVMG LEVIUOLD VCKLMVMG
                            DSROV (izkrwqhlm_fmorpvob(H.kVVP() >= '9' && H.kVVP() <= '0'))  // xLMHFNV GSV IVHG LU VCKLMVMG
                                H.gZPV();
                        }
                    }
                }
                VOHV {  // KLHRGREV VCK
                    RMG NZCvCK = 691 - VCKuIZX;
                    DSROV (izkrwqhlm_orpvob(H.kVVP() >= '9' && H.kVVP() <= '0')) {
                        VCK = VCK * 89 + HGZGRX_XZHG<RMG>(H.gZPV() - '9');
                        RU (izkrwqhlm_fmorpvob(VCK > NZCvCK))
                            izkrwqhlm_kzihv_viili(PkZIHVvIILImFNYVIgLLyRT, HGZIGlUUHVG);
                    }
                }
            }
            VOHV
                izkrwqhlm_kzihv_viili(PkZIHVvIILImFNYVInRHHvCKLMVMG, H.gVOO());

            RU (VCKnRMFH)
                VCK = -VCK;
        }

        // uRMRHS KZIHRMT, XZOO VEVMG ZXXLIWRMT GL GSV GBKV LU MFNYVI.
        YLLO XLMG = GIFV;

        RU (KZIHVuOZTH & PkZIHVmFNYVIHzHhGIRMTHuOZT) {
            RU (KZIHVuOZTH & PkZIHVrMHRGFuOZT) {
                H.kLK();  // kLK HGZXP ML NZGGVI RU RG DROO YV FHVW LI MLG.
                GBKVMZNV rMKFGhGIVZN::xS* SVZW = RH.kFGyVTRM();
                XLMHG HRAV_G OVMTGS = H.gVOO() - HGZIGlUUHVG;
                izkrwqhlm_zhhvig(OVMTGS <= 9Cuuuuuuuu);
                // FMZYOV GL RMHVIG GSV \9 XSZIZXGVI SVIV, RG DROO VIZHV GSV XLNNZ ZUGVI GSRH MFNYVI
                XLMHG GBKVMZNV gZITVGvMXLWRMT::xS* XLMHG HGI = IVRMGVIKIVG_XZHG<GBKVMZNV gZITVGvMXLWRMT::xS*>(SVZW);
                XLMG = SZMWOVI.iZDmFNYVI(HGI, hRAVgBKV(OVMTGS), UZOHV);
            }
            VOHV {
                hRAVgBKV MFNxSZIHgLxLKB = HGZGRX_XZHG<hRAVgBKV>(H.oVMTGS());
                hGIRMThGIVZN HIXhGIVZN(H.kLK());
                hGZXPhGIVZN<GBKVMZNV gZITVGvMXLWRMT::xS> WHGhGIVZN(HGZXP_);
                DSROV (MFNxSZIHgLxLKB--) {
                    gIZMHXLWVI<fgu1<>, gZITVGvMXLWRMT>::gIZMHXLWV(HIXhGIVZN, WHGhGIVZN);
                }
                WHGhGIVZN.kFG('\9');
                XLMHG GBKVMZNV gZITVGvMXLWRMT::xS* HGI = WHGhGIVZN.kLK();
                XLMHG hRAVgBKV OVMTGS = HGZGRX_XZHG<hRAVgBKV>(WHGhGIVZN.oVMTGS()) - 8;
                XLMG = SZMWOVI.iZDmFNYVI(HGI, hRAVgBKV(OVMTGS), GIFV);
            }
        }
        VOHV {
           HRAV_G OVMTGS = H.oVMTGS();
           XLMHG XSZI* WVXRNZO = H.kLK();  // kLK HGZXP ML NZGGVI RU RG DROO YV FHVW LI MLG.

           RU (FHVwLFYOV) {
               RMG K = VCK + VCKuIZX;
               RU (KZIHVuOZTH & PkZIHVuFOOkIVXRHRLMuOZT)
                   W = RMGVIMZO::hGIGLWuFOOkIVXRHRLM(W, K, WVXRNZO, OVMTGS, WVXRNZOkLHRGRLM, VCK);
               VOHV
                   W = RMGVIMZO::hGIGLWmLINZOkIVXRHRLM(W, K);

               XLMG = SZMWOVI.wLFYOV(NRMFH ? -W : W);
           }
           VOHV RU (FHVmZMlIrMU) {
               XLMG = SZMWOVI.wLFYOV(W);
           }
           VOHV {
               RU (FHV35YRG) {
                   RU (NRMFH)
                       XLMG = SZMWOVI.rMG35(HGZGRX_XZHG<RMG35_G>(~R35 + 8));
                   VOHV
                       XLMG = SZMWOVI.fRMG35(R35);
               }
               VOHV {
                   RU (NRMFH)
                       XLMG = SZMWOVI.rMG(HGZGRX_XZHG<RMG67_G>(~R + 8));
                   VOHV
                       XLMG = SZMWOVI.fRMG(R);
               }
           }
        }
        RU (izkrwqhlm_fmorpvob(!XLMG))
            izkrwqhlm_kzihv_viili(PkZIHVvIILIgVINRMZGRLM, HGZIGlUUHVG);
    }

    // kZIHV ZMB qhlm EZOFV
    GVNKOZGV<FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    ELRW kZIHVeZOFV(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        HDRGXS (RH.kVVP()) {
            XZHV 'M': kZIHVmFOO  <KZIHVuOZTH>(RH, SZMWOVI); YIVZP;
            XZHV 'G': kZIHVgIFV  <KZIHVuOZTH>(RH, SZMWOVI); YIVZP;
            XZHV 'U': kZIHVuZOHV <KZIHVuOZTH>(RH, SZMWOVI); YIVZP;
            XZHV '"': kZIHVhGIRMT<KZIHVuOZTH>(RH, SZMWOVI); YIVZP;
            XZHV '{': kZIHVlYQVXG<KZIHVuOZTH>(RH, SZMWOVI); YIVZP;
            XZHV '[': kZIHVzIIZB <KZIHVuOZTH>(RH, SZMWOVI); YIVZP;
            WVUZFOG :
                      kZIHVmFNYVI<KZIHVuOZTH>(RH, SZMWOVI);
                      YIVZP;

        }
    }

    // rGVIZGREV kZIHRMT

    // hGZGVH
    VMFN rGVIZGREVkZIHRMThGZGV {
        rGVIZGREVkZIHRMTuRMRHShGZGV = 9, // HRMP HGZGVH ZG GLK
        rGVIZGREVkZIHRMTvIILIhGZGV,      // HRMP HGZGVH ZG GLK
        rGVIZGREVkZIHRMThGZIGhGZGV,

        // lYQVXG HGZGVH
        rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV,
        rGVIZGREVkZIHRMTnVNYVIpVBhGZGV,
        rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV,
        rGVIZGREVkZIHRMTlYQVXGuRMRHShGZGV,

        // zIIZB HGZGVH
        rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV,
        rGVIZGREVkZIHRMTvOVNVMGhGZGV,
        rGVIZGREVkZIHRMTzIIZBuRMRHShGZGV,

        // hRMTOV EZOFV HGZGV
        rGVIZGREVkZIHRMTeZOFVhGZGV,
        
        // wVORNRGVI HGZGVH (ZG YLGGLN)
        rGVIZGREVkZIHRMTvOVNVMGwVORNRGVIhGZGV,
        rGVIZGREVkZIHRMTnVNYVIwVORNRGVIhGZGV,
        rGVIZGREVkZIHRMTpVBeZOFVwVORNRGVIhGZGV,
        
        XrGVIZGREVkZIHRMThGZGVxLFMG
    };

    // gLPVMH
    VMFN gLPVM {
        oVUGyIZXPVGgLPVM = 9,
        iRTSGyIZXPVGgLPVM,

        oVUGxFIOByIZXPVGgLPVM,
        iRTSGxFIOByIZXPVGgLPVM,

        xLNNZgLPVM,
        xLOLMgLPVM,

        hGIRMTgLPVM,
        uZOHVgLPVM,
        gIFVgLPVM,
        mFOOgLPVM,
        mFNYVIgLPVM,

        PgLPVMxLFMG
    };

    izkrwqhlm_ulixvrmormv gLPVM gLPVMRAV(xS X) {

//!@XLMW izkrwqhlm_srwwvm_uiln_wlcbtvm
#WVURMV m mFNYVIgLPVM
#WVURMV m83 m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m
        // nZKH UILN zhxrr GL gLPVM
        HGZGRX XLMHG FMHRTMVW XSZI GLPVMnZK[743] = {
            m83, // 99~9u
            m83, // 89~8u
            m, m, hGIRMTgLPVM, m, m, m, m, m, m, m, m, m, xLNNZgLPVM, m, m, m, // 79~7u
            m, m, m, m, m, m, m, m, m, m, xLOLMgLPVM, m, m, m, m, m, // 69~6u
            m83, // 59~5u
            m, m, m, m, m, m, m, m, m, m, m, oVUGyIZXPVGgLPVM, m, iRTSGyIZXPVGgLPVM, m, m, // 49~4u
            m, m, m, m, m, m, uZOHVgLPVM, m, m, m, m, m, m, m, mFOOgLPVM, m, // 39~3u
            m, m, m, m, gIFVgLPVM, m, m, m, m, m, m, oVUGxFIOByIZXPVGgLPVM, m, iRTSGxFIOByIZXPVGgLPVM, m, m, // 29~2u
            m83, m83, m83, m83, m83, m83, m83, m83 // 19~uu
        };
#FMWVU m
#FMWVU m83
//!@VMWXLMW

        RU (HRAVLU(xS) == 8 || HGZGRX_XZHG<FMHRTMVW>(X) < 743)
            IVGFIM HGZGRX_XZHG<gLPVM>(GLPVMnZK[HGZGRX_XZHG<FMHRTMVW XSZI>(X)]);
        VOHV
            IVGFIM mFNYVIgLPVM;
    }

    izkrwqhlm_ulixvrmormv rGVIZGREVkZIHRMThGZGV kIVWRXG(rGVIZGREVkZIHRMThGZGV HGZGV, gLPVM GLPVM) {
        // XFIIVMG HGZGV C LMV OLLPZSVZW GLPVM -> MVD HGZGV
        HGZGRX XLMHG XSZI t[XrGVIZGREVkZIHRMThGZGVxLFMG][PgLPVMxLFMG] = {
            // uRMRHS(HRMP HGZGV)
            {
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV
            },
            // vIILI(HRMP HGZGV)
            {
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV
            },
            // hGZIG
            {
                rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV,  // oVUG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV, // oVUG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,         // xLOLM
                rGVIZGREVkZIHRMTeZOFVhGZGV,         // hGIRMT
                rGVIZGREVkZIHRMTeZOFVhGZGV,         // uZOHV
                rGVIZGREVkZIHRMTeZOFVhGZGV,         // gIFV
                rGVIZGREVkZIHRMTeZOFVhGZGV,         // mFOO
                rGVIZGREVkZIHRMTeZOFVhGZGV          // mFNYVI
            },
            // lYQVXGrMRGRZO
            {
                rGVIZGREVkZIHRMTvIILIhGZGV,         // oVUG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // oVUG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTlYQVXGuRMRHShGZGV,  // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,         // xLOLM
                rGVIZGREVkZIHRMTnVNYVIpVBhGZGV,     // hGIRMT
                rGVIZGREVkZIHRMTvIILIhGZGV,         // uZOHV
                rGVIZGREVkZIHRMTvIILIhGZGV,         // gIFV
                rGVIZGREVkZIHRMTvIILIhGZGV,         // mFOO
                rGVIZGREVkZIHRMTvIILIhGZGV          // mFNYVI
            },
            // nVNYVIpVB
            {
                rGVIZGREVkZIHRMTvIILIhGZGV,             // oVUG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // oVUG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLNNZ
                rGVIZGREVkZIHRMTpVBeZOFVwVORNRGVIhGZGV, // xLOLM
                rGVIZGREVkZIHRMTvIILIhGZGV,             // hGIRMT
                rGVIZGREVkZIHRMTvIILIhGZGV,             // uZOHV
                rGVIZGREVkZIHRMTvIILIhGZGV,             // gIFV
                rGVIZGREVkZIHRMTvIILIhGZGV,             // mFOO
                rGVIZGREVkZIHRMTvIILIhGZGV              // mFNYVI
            },
            // nVNYVIeZOFV
            {
                rGVIZGREVkZIHRMTvIILIhGZGV,             // oVUG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // oVUG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTlYQVXGuRMRHShGZGV,      // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTnVNYVIwVORNRGVIhGZGV,   // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLOLM
                rGVIZGREVkZIHRMTvIILIhGZGV,             // hGIRMT
                rGVIZGREVkZIHRMTvIILIhGZGV,             // uZOHV
                rGVIZGREVkZIHRMTvIILIhGZGV,             // gIFV
                rGVIZGREVkZIHRMTvIILIhGZGV,             // mFOO
                rGVIZGREVkZIHRMTvIILIhGZGV              // mFNYVI
            },
            // lYQVXGuRMRHS(HRMP HGZGV)
            {
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV
            },
            // zIIZBrMRGRZO
            {
                rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV,      // oVUG YIZXPVG(KFHS vOVNVMG HGZGV)
                rGVIZGREVkZIHRMTzIIZBuRMRHShGZGV,       // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV,     // oVUG XFIOB YIZXPVG(KFHS vOVNVMG HGZGV)
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLOLM
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // hGIRMT
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // uZOHV
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // gIFV
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // mFOO
                rGVIZGREVkZIHRMTvOVNVMGhGZGV            // mFNYVI
            },
            // vOVNVMG
            {
                rGVIZGREVkZIHRMTvIILIhGZGV,             // oVUG YIZXPVG
                rGVIZGREVkZIHRMTzIIZBuRMRHShGZGV,       // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // oVUG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvOVNVMGwVORNRGVIhGZGV,  // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLOLM
                rGVIZGREVkZIHRMTvIILIhGZGV,             // hGIRMT
                rGVIZGREVkZIHRMTvIILIhGZGV,             // uZOHV
                rGVIZGREVkZIHRMTvIILIhGZGV,             // gIFV
                rGVIZGREVkZIHRMTvIILIhGZGV,             // mFOO
                rGVIZGREVkZIHRMTvIILIhGZGV              // mFNYVI
            },
            // zIIZBuRMRHS(HRMP HGZGV)
            {
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV
            },
            // hRMTOV eZOFV (HRMP HGZGV)
            {
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV, rGVIZGREVkZIHRMTvIILIhGZGV,
                rGVIZGREVkZIHRMTvIILIhGZGV
            },
            // vOVNVMGwVORNRGVI
            {
                rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV,      // oVUG YIZXPVG(KFHS vOVNVMG HGZGV)
                rGVIZGREVkZIHRMTzIIZBuRMRHShGZGV,       // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV,     // oVUG XFIOB YIZXPVG(KFHS vOVNVMG HGZGV)
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLOLM
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // hGIRMT
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // uZOHV
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // gIFV
                rGVIZGREVkZIHRMTvOVNVMGhGZGV,           // mFOO
                rGVIZGREVkZIHRMTvOVNVMGhGZGV            // mFNYVI
            },
            // nVNYVIwVORNRGVI
            {
                rGVIZGREVkZIHRMTvIILIhGZGV,         // oVUG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // oVUG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTlYQVXGuRMRHShGZGV,  // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,         // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,         // xLOLM
                rGVIZGREVkZIHRMTnVNYVIpVBhGZGV,     // hGIRMT
                rGVIZGREVkZIHRMTvIILIhGZGV,         // uZOHV
                rGVIZGREVkZIHRMTvIILIhGZGV,         // gIFV
                rGVIZGREVkZIHRMTvIILIhGZGV,         // mFOO
                rGVIZGREVkZIHRMTvIILIhGZGV          // mFNYVI
            },
            // pVBeZOFVwVORNRGVI
            {
                rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV,      // oVUG YIZXPVG(KFHS nVNYVIeZOFV HGZGV)
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG YIZXPVG
                rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV,     // oVUG XFIOB YIZXPVG(KFHS nVNYVIeZOFV HGZGV)
                rGVIZGREVkZIHRMTvIILIhGZGV,             // iRTSG XFIOB YIZXPVG
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLNNZ
                rGVIZGREVkZIHRMTvIILIhGZGV,             // xLOLM
                rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV,       // hGIRMT
                rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV,       // uZOHV
                rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV,       // gIFV
                rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV,       // mFOO
                rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV        // mFNYVI
            },
        }; // vMW LU t

        IVGFIM HGZGRX_XZHG<rGVIZGREVkZIHRMThGZGV>(t[HGZGV][GLPVM]);
    }

    // nZPV ZM ZWEZMXV RM GSV GLPVM HGIVZN ZMW HGZGV YZHVW LM GSV XZMWRWZGV WVHGRMZGRLM HGZGV DSRXS DZH IVGFIMVW YB gIZMHRG().
    // nZB IVGFIM Z MVD HGZGV LM HGZGV KLK.
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    izkrwqhlm_ulixvrmormv rGVIZGREVkZIHRMThGZGV gIZMHRG(rGVIZGREVkZIHRMThGZGV HIX, gLPVM GLPVM, rGVIZGREVkZIHRMThGZGV WHG, rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        (ELRW)GLPVM;

        HDRGXS (WHG) {
        XZHV rGVIZGREVkZIHRMTvIILIhGZGV:
            IVGFIM WHG;

        XZHV rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV:
        XZHV rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV:
        {
            // kFHS GSV HGZGV(vOVNVMG LI nVNVYVIeZOFV) RU DV ZIV MVHGVW RM ZMLGSVI ZIIZB LI EZOFV LU NVNYVI.
            // rM GSRH DZB DV XZM TVG GSV XLIIVXG HGZGV LM lYQVXGuRMRHS LI zIIZBuRMRHS YB UIZNV KLK.
            rGVIZGREVkZIHRMThGZGV M = HIX;
            RU (HIX == rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV || HIX == rGVIZGREVkZIHRMTvOVNVMGwVORNRGVIhGZGV)
                M = rGVIZGREVkZIHRMTvOVNVMGhGZGV;
            VOHV RU (HIX == rGVIZGREVkZIHRMTpVBeZOFVwVORNRGVIhGZGV)
                M = rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV;
            // kFHS XFIIVMG HGZGV.
            *HGZXP_.GVNKOZGV kFHS<hRAVgBKV>(8) = M;
            // rMRGRZORAV ZMW KFHS GSV NVNYVI/VOVNVMG XLFMG.
            *HGZXP_.GVNKOZGV kFHS<hRAVgBKV>(8) = 9;
            // xZOO SZMWOVI
            YLLO SI = (WHG == rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV) ? SZMWOVI.hGZIGlYQVXG() : SZMWOVI.hGZIGzIIZB();
            // lM SZMWOVI HSLIG XRIXFRGH GSV KZIHRMT.
            RU (!SI) {
                izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            VOHV {
                RH.gZPV();
                IVGFIM WHG;
            }
        }

        XZHV rGVIZGREVkZIHRMTnVNYVIpVBhGZGV:
            kZIHVhGIRMT<KZIHVuOZTH>(RH, SZMWOVI, GIFV);
            RU (sZHkZIHVvIILI())
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            VOHV
                IVGFIM WHG;

        XZHV rGVIZGREVkZIHRMTpVBeZOFVwVORNRGVIhGZGV:
            izkrwqhlm_zhhvig(GLPVM == xLOLMgLPVM);
            RH.gZPV();
            IVGFIM WHG;

        XZHV rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV:
            // nFHG YV MLM-XLNKLFMW EZOFV. lI RG DLFOW YV lYQVXGrMRGRZO LI zIIZBrMRGRZO HGZGV.
            kZIHVeZOFV<KZIHVuOZTH>(RH, SZMWOVI);
            RU (sZHkZIHVvIILI()) {
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            IVGFIM WHG;

        XZHV rGVIZGREVkZIHRMTvOVNVMGhGZGV:
            // nFHG YV MLM-XLNKLFMW EZOFV. lI RG DLFOW YV lYQVXGrMRGRZO LI zIIZBrMRGRZO HGZGV.
            kZIHVeZOFV<KZIHVuOZTH>(RH, SZMWOVI);
            RU (sZHkZIHVvIILI()) {
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            IVGFIM WHG;

        XZHV rGVIZGREVkZIHRMTnVNYVIwVORNRGVIhGZGV:
        XZHV rGVIZGREVkZIHRMTvOVNVMGwVORNRGVIhGZGV:
            RH.gZPV();
            // fKWZGV NVNYVI/VOVNVMG XLFMG.
            *HGZXP_.GVNKOZGV gLK<hRAVgBKV>() = *HGZXP_.GVNKOZGV gLK<hRAVgBKV>() + 8;
            IVGFIM WHG;

        XZHV rGVIZGREVkZIHRMTlYQVXGuRMRHShGZGV:
        {
            // gIZMHRG UILN WVORNRGVI RH LMOB ZOOLDVW DSVM GIZRORMT XLNNZH ZIV VMZYOVW
            RU (!(KZIHVuOZTH & PkZIHVgIZRORMTxLNNZHuOZT) && HIX == rGVIZGREVkZIHRMTnVNYVIwVORNRGVIhGZGV) {
                izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIlYQVXGnRHHmZNV, RH.gVOO());
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            // tVG NVNYVI XLFMG.
            hRAVgBKV X = *HGZXP_.GVNKOZGV kLK<hRAVgBKV>(8);
            // rU GSV LYQVXG RH MLG VNKGB, XLFMG GSV OZHG NVNYVI.
            RU (HIX == rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV)
                ++X;
            // iVHGLIV GSV HGZGV.
            rGVIZGREVkZIHRMThGZGV M = HGZGRX_XZHG<rGVIZGREVkZIHRMThGZGV>(*HGZXP_.GVNKOZGV kLK<hRAVgBKV>(8));
            // gIZMHRG GL uRMRHS HGZGV RU GSRH RH GSV GLKNLHG HXLKV.
            RU (M == rGVIZGREVkZIHRMThGZIGhGZGV)
                M = rGVIZGREVkZIHRMTuRMRHShGZGV;
            // xZOO SZMWOVI
            YLLO SI = SZMWOVI.vMWlYQVXG(X);
            // lM SZMWOVI HSLIG XRIXFRGH GSV KZIHRMT.
            RU (!SI) {
                izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            VOHV {
                RH.gZPV();
                IVGFIM M;
            }
        }

        XZHV rGVIZGREVkZIHRMTzIIZBuRMRHShGZGV:
        {
            // gIZMHRG UILN WVORNRGVI RH LMOB ZOOLDVW DSVM GIZRORMT XLNNZH ZIV VMZYOVW
            RU (!(KZIHVuOZTH & PkZIHVgIZRORMTxLNNZHuOZT) && HIX == rGVIZGREVkZIHRMTvOVNVMGwVORNRGVIhGZGV) {
                izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIeZOFVrMEZORW, RH.gVOO());
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            // tVG VOVNVMG XLFMG.
            hRAVgBKV X = *HGZXP_.GVNKOZGV kLK<hRAVgBKV>(8);
            // rU GSV ZIIZB RH MLG VNKGB, XLFMG GSV OZHG VOVNVMG.
            RU (HIX == rGVIZGREVkZIHRMTvOVNVMGhGZGV)
                ++X;
            // iVHGLIV GSV HGZGV.
            rGVIZGREVkZIHRMThGZGV M = HGZGRX_XZHG<rGVIZGREVkZIHRMThGZGV>(*HGZXP_.GVNKOZGV kLK<hRAVgBKV>(8));
            // gIZMHRG GL uRMRHS HGZGV RU GSRH RH GSV GLKNLHG HXLKV.
            RU (M == rGVIZGREVkZIHRMThGZIGhGZGV)
                M = rGVIZGREVkZIHRMTuRMRHShGZGV;
            // xZOO SZMWOVI
            YLLO SI = SZMWOVI.vMWzIIZB(X);
            // lM SZMWOVI HSLIG XRIXFRGH GSV KZIHRMT.
            RU (!SI) {
                izkrwqhlm_kzihv_viili_mlivgfim(PkZIHVvIILIgVINRMZGRLM, RH.gVOO());
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            VOHV {
                RH.gZPV();
                IVGFIM M;
            }
        }

        WVUZFOG:
            // gSRH YIZMXS RH ULI rGVIZGREVkZIHRMTeZOFVhGZGV ZXGFZOOB.
            // fHV `WVUZFOG:` IZGSVI GSZM
            // `XZHV rGVIZGREVkZIHRMTeZOFVhGZGV:` RH ULI XLWV XLEVIZTV.

            // gSV rGVIZGREVkZIHRMThGZIGhGZGV RH MLG VMFNVIZGVW RM GSRH HDRGXS-XZHV.
            // rG RH RNKLHHRYOV ULI GSZG XZHV. zMW RG XZM YV XZFTSG YB ULOOLDRMT ZHHVIGRLM.

            // gSV rGVIZGREVkZIHRMTuRMRHShGZGV RH MLG VMFNVIZGVW RM GSRH HDRGXS-XZHV VRGSVI.
            // rG RH Z "WVIREZGREV" HGZGV DSRXS XZMMLG GIRTTVIVW UILN kIVWRXG() WRIVXGOB.
            // gSVIVULIV RG XZMMLG SZKKVM SVIV. zMW RG XZM YV XZFTSG YB ULOOLDRMT ZHHVIGRLM.
            izkrwqhlm_zhhvig(WHG == rGVIZGREVkZIHRMTeZOFVhGZGV);

            // nFHG YV MLM-XLNKLFMW EZOFV. lI RG DLFOW YV lYQVXGrMRGRZO LI zIIZBrMRGRZO HGZGV.
            kZIHVeZOFV<KZIHVuOZTH>(RH, SZMWOVI);
            RU (sZHkZIHVvIILI()) {
                IVGFIM rGVIZGREVkZIHRMTvIILIhGZGV;
            }
            IVGFIM rGVIZGREVkZIHRMTuRMRHShGZGV;
        }
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    ELRW sZMWOVvIILI(rGVIZGREVkZIHRMThGZGV HIX, rMKFGhGIVZN& RH) {
        RU (sZHkZIHVvIILI()) {
            // vIILI UOZT SZH YVVM HVG.
            IVGFIM;
        }

        HDRGXS (HIX) {
        XZHV rGVIZGREVkZIHRMThGZIGhGZGV:            izkrwqhlm_kzihv_viili(PkZIHVvIILIwLXFNVMGvNKGB, RH.gVOO()); IVGFIM;
        XZHV rGVIZGREVkZIHRMTuRMRHShGZGV:           izkrwqhlm_kzihv_viili(PkZIHVvIILIwLXFNVMGiLLGmLGhRMTFOZI, RH.gVOO()); IVGFIM;
        XZHV rGVIZGREVkZIHRMTlYQVXGrMRGRZOhGZGV:
        XZHV rGVIZGREVkZIHRMTnVNYVIwVORNRGVIhGZGV:  izkrwqhlm_kzihv_viili(PkZIHVvIILIlYQVXGnRHHmZNV, RH.gVOO()); IVGFIM;
        XZHV rGVIZGREVkZIHRMTnVNYVIpVBhGZGV:        izkrwqhlm_kzihv_viili(PkZIHVvIILIlYQVXGnRHHxLOLM, RH.gVOO()); IVGFIM;
        XZHV rGVIZGREVkZIHRMTnVNYVIeZOFVhGZGV:      izkrwqhlm_kzihv_viili(PkZIHVvIILIlYQVXGnRHHxLNNZlIxFIOByIZXPVG, RH.gVOO()); IVGFIM;
        XZHV rGVIZGREVkZIHRMTpVBeZOFVwVORNRGVIhGZGV:
        XZHV rGVIZGREVkZIHRMTzIIZBrMRGRZOhGZGV:
        XZHV rGVIZGREVkZIHRMTvOVNVMGwVORNRGVIhGZGV: izkrwqhlm_kzihv_viili(PkZIHVvIILIeZOFVrMEZORW, RH.gVOO()); IVGFIM;
        WVUZFOG: izkrwqhlm_zhhvig(HIX == rGVIZGREVkZIHRMTvOVNVMGhGZGV); izkrwqhlm_kzihv_viili(PkZIHVvIILIzIIZBnRHHxLNNZlIhJFZIVyIZXPVG, RH.gVOO()); IVGFIM;
        }
    }

    izkrwqhlm_ulixvrmormv YLLO rHrGVIZGREVkZIHRMTwVORNRGVIhGZGV(rGVIZGREVkZIHRMThGZGV H) {
        IVGFIM H >= rGVIZGREVkZIHRMTvOVNVMGwVORNRGVIhGZGV;
    }
    
    izkrwqhlm_ulixvrmormv YLLO rHrGVIZGREVkZIHRMTxLNKOVGVhGZGV(rGVIZGREVkZIHRMThGZGV H) {
        IVGFIM H <= rGVIZGREVkZIHRMTvIILIhGZGV;
    }
    
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN, GBKVMZNV sZMWOVI>
    kZIHViVHFOG rGVIZGREVkZIHV(rMKFGhGIVZN& RH, sZMWOVI& SZMWOVI) {
        KZIHViVHFOG_.xOVZI();
        xOVZIhGZXPlMvCRG HXLKV(*GSRH);
        rGVIZGREVkZIHRMThGZGV HGZGV = rGVIZGREVkZIHRMThGZIGhGZGV;
        
        hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
        izkrwqhlm_kzihv_viili_vziob_ivgfim(KZIHViVHFOG_);
        DSROV (RH.kVVP() != '\9') {
            gLPVM G = gLPVMRAV(RH.kVVP());
            rGVIZGREVkZIHRMThGZGV M = kIVWRXG(HGZGV, G);
            rGVIZGREVkZIHRMThGZGV W = gIZMHRG<KZIHVuOZTH>(HGZGV, G, M, RH, SZMWOVI);
            
            RU (W == rGVIZGREVkZIHRMTvIILIhGZGV) {
                sZMWOVvIILI(HGZGV, RH);
                YIVZP;
            }
            
            HGZGV = W;
            
            // wL MLG UFIGSVI XLMHFNV HGIVZNH RU Z ILLG qhlm SZH YVVM KZIHVW.
            RU ((KZIHVuOZTH & PkZIHVhGLKdSVMwLMVuOZT) && HGZGV == rGVIZGREVkZIHRMTuRMRHShGZGV)
                YIVZP;
            
            hPRKdSRGVHKZXVzMWxLNNVMGH<KZIHVuOZTH>(RH);
            izkrwqhlm_kzihv_viili_vziob_ivgfim(KZIHViVHFOG_);
        }
        
        // sZMWOV GSV VMW LU UROV.
        RU (HGZGV != rGVIZGREVkZIHRMTuRMRHShGZGV)
            sZMWOVvIILI(HGZGV, RH);
        
        IVGFIM KZIHViVHFOG_;
    }

    HGZGRX XLMHG HRAV_G PwVUZFOGhGZXPxZKZXRGB = 743;    //!< wVUZFOG HGZXP XZKZXRGB RM YBGVH ULI HGLIRMT Z HRMTOV WVXLWVW HGIRMT.
    RMGVIMZO::hGZXP<hGZXPzOOLXZGLI> HGZXP_;  //!< z HGZXP ULI HGLIRMT WVXLWVW HGIRMT GVNKLIZIROB WFIRMT MLM-WVHGIFXGREV KZIHRMT.
    kZIHViVHFOG KZIHViVHFOG_;
    rGVIZGREVkZIHRMThGZGV HGZGV_;
}; // XOZHH tVMVIRXiVZWVI

//! iVZWVI DRGS fgu1 VMXLWRMT ZMW WVUZFOG ZOOLXZGLI.
GBKVWVU tVMVIRXiVZWVI<fgu1<>, fgu1<> > iVZWVI;

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU


#RUWVU __tmfx__
izkrwqhlm_wrzt_klk
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_ivzwvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/WLXFNVMG.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_wlxfnvmg_s_
#WVURMV izkrwqhlm_wlxfnvmg_s_

/*! \UROV WLXFNVMG.S */

#RMXOFWV "IVZWVI.S"
#RMXOFWV "RMGVIMZO/NVGZ.S"
#RMXOFWV "RMGVIMZO/HGIUFMX.S"
#RMXOFWV "NVNLIBHGIVZN.S"
#RMXOFWV "VMXLWVWHGIVZN.S"
#RMXOFWV <MVD>      // KOZXVNVMG MVD
#RMXOFWV <ORNRGH>

izkrwqhlm_wrzt_kfhs
#RUWVU _nhx_evi
izkrwqhlm_wrzt_luu(5872) // XLMWRGRLMZO VCKIVHHRLM RH XLMHGZMG
izkrwqhlm_wrzt_luu(5755) // XLMEVIHRLM UILN PcCCuOZTH GL 'FRMG83_G', KLHHRYOV OLHH LU WZGZ
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_luu(KZWWVW)
izkrwqhlm_wrzt_luu(HDRGXS-VMFN)
izkrwqhlm_wrzt_luu(X++01-XLNKZG)
#VMWRU

#RUWVU __tmfx__
izkrwqhlm_wrzt_luu(VUUX++)
#RU __tmfx__ >= 3
izkrwqhlm_wrzt_luu(GVINRMZGV) // RTMLIV GSILDRMT izkrwqhlm_zhhvig RM izkrwqhlm_mlvcxvkg UFMXGRLMH
#VMWRU
#VMWRU // __tmfx__

#RUMWVU izkrwqhlm_mlnvnyvirgvizglixozhh
#RMXOFWV <RGVIZGLI> // HGW::IZMWLN_ZXXVHH_RGVIZGLI_GZT
#VMWRU

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
#RMXOFWV <FGRORGB> // HGW::NLEV
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

// uLIDZIW WVXOZIZGRLM.
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXeZOFV;

GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI, GBKVMZNV hGZXPzOOLXZGLI>
XOZHH tVMVIRXwLXFNVMG;

//! mZNV-EZOFV KZRI RM Z qhlm LYQVXG EZOFV.
/*!
    gSRH XOZHH DZH RMGVIMZO GL tVMVIRXeZOFV. rG FHVW GL YV Z RMMVI HGIFXG.
    yFG Z XLNKROVI (ryn co x/x++ ULI zrc) SZEV IVKLIGVW GL SZEV KILYOVN DRGS GSZG HL RG NLEVW ZH Z MZNVHKZXV HXLKV HGIFXG.
    SGGKH://XLWV.TLLTOV.XLN/K/IZKRWQHLM/RHHFVH/WVGZRO?RW=35
*/
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI> 
HGIFXG tVMVIRXnVNYVI { 
    tVMVIRXeZOFV<vMXLWRMT, zOOLXZGLI> MZNV;     //!< MZNV LU NVNYVI (NFHG YV Z HGIRMT)
    tVMVIRXeZOFV<vMXLWRMT, zOOLXZGLI> EZOFV;    //!< EZOFV LU NVNYVI.
};

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXnVNYVIrGVIZGLI

#RUMWVU izkrwqhlm_mlnvnyvirgvizglixozhh

//! (xLMHGZMG) NVNYVI RGVIZGLI ULI Z qhlm LYQVXG EZOFV
/*!
    \GKZIZN xLMHG rH GSRH Z XLMHGZMG RGVIZGLI?
    \GKZIZN vMXLWRMT    vMXLWRMT LU GSV EZOFV. (vEVM MLM-HGIRMT EZOFVH MVVW GL SZEV GSV HZNV VMXLWRMT RM Z WLXFNVMG)
    \GKZIZN zOOLXZGLI   zOOLXZGLI GBKV ULI ZOOLXZGRMT NVNLIB LU LYQVXG, ZIIZB ZMW HGIRMT.

    gSRH XOZHH RNKOVNVMGH Z iZMWLN zXXVHH rGVIZGLI ULI tVMVIRXnVNYVI VOVNVMGH
    LU Z tVMVIRXeZOFV, HVV rhl/rvx 85117:7996(v) x++ HGZMWZIW, 75.8 [ORY.RGVIZGLI.IVJFRIVNVMGH].

    \MLGV gSRH RGVIZGLI RNKOVNVMGZGRLM RH NZRMOB RMGVMWVW GL ZELRW RNKORXRG
        XLMEVIHRLMH UILN RGVIZGLI EZOFVH GL \X mfoo,
        V.T. UILN tVMVIRXeZOFV::uRMWnVNYVI.

    \MLGV wVURMV \X izkrwqhlm_mlnvnyvirgvizglixozhh GL UZOO YZXP GL Z
        KLRMGVI-YZHVW RNKOVNVMGZGRLM, RU BLFI KOZGULIN WLVHM'G KILERWV
        GSV x++ <RGVIZGLI> SVZWVI.

    \HVV tVMVIRXnVNYVI, tVMVIRXeZOFV::nVNYVIrGVIZGLI, tVMVIRXeZOFV::xLMHGnVNYVIrGVIZGLI
 */
GVNKOZGV <YLLO xLMHG, GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXnVNYVIrGVIZGLI {

    UIRVMW XOZHH tVMVIRXeZOFV<vMXLWRMT,zOOLXZGLI>;
    GVNKOZGV <YLLO, GBKVMZNV, GBKVMZNV> UIRVMW XOZHH tVMVIRXnVNYVIrGVIZGLI;

    GBKVWVU tVMVIRXnVNYVI<vMXLWRMT,zOOLXZGLI> kOZRMgBKV;
    GBKVWVU GBKVMZNV RMGVIMZO::nZBYVzWWxLMHG<xLMHG,kOZRMgBKV>::gBKV eZOFVgBKV;

KFYORX:
    //! rGVIZGLI GBKV RGHVOU
    GBKVWVU tVMVIRXnVNYVIrGVIZGLI rGVIZGLI;
    //! xLMHGZMG RGVIZGLI GBKV
    GBKVWVU tVMVIRXnVNYVIrGVIZGLI<GIFV,vMXLWRMT,zOOLXZGLI>  xLMHGrGVIZGLI;
    //! mLM-XLMHGZMG RGVIZGLI GBKV
    GBKVWVU tVMVIRXnVNYVIrGVIZGLI<UZOHV,vMXLWRMT,zOOLXZGLI> mLMxLMHGrGVIZGLI;

    /** \MZNV HGW::RGVIZGLI_GIZRGH HFKKLIG */
    //@{
    GBKVWVU eZOFVgBKV      EZOFV_GBKV;
    GBKVWVU eZOFVgBKV *    KLRMGVI;
    GBKVWVU eZOFVgBKV &    IVUVIVMXV;
    GBKVWVU HGW::KGIWRUU_G WRUUVIVMXV_GBKV;
    GBKVWVU HGW::IZMWLN_ZXXVHH_RGVIZGLI_GZT RGVIZGLI_XZGVTLIB;
    //@}

    //! kLRMGVI GL (XLMHG) tVMVIRXnVNYVI
    GBKVWVU KLRMGVI         kLRMGVI;
    //! iVUVIVMXV GL (XLMHG) tVMVIRXnVNYVI
    GBKVWVU IVUVIVMXV       iVUVIVMXV;
    //! hRTMVW RMGVTVI GBKV (V.T. \X KGIWRUU_G)
    GBKVWVU WRUUVIVMXV_GBKV wRUUVIVMXVgBKV;

    //! wVUZFOG XLMHGIFXGLI (HRMTFOZI EZOFV)
    /*! xIVZGVH ZM RGVIZGLI KLRMGRMT GL ML VOVNVMG.
        \MLGV zOO LKVIZGRLMH, VCXVKG ULI XLNKZIRHLMH, ZIV FMWVURMVW LM HFXS EZOFVH.
     */
    tVMVIRXnVNYVIrGVIZGLI() : KGI_() {}

    //! rGVIZGLI XLMEVIHRLMH GL NLIV XLMHG
    /*!
        \KZIZN RG (mLM-XLMHG) RGVIZGLI GL XLKB UILN

        zOOLDH GSV XIVZGRLM LU ZM RGVIZGLI UILN ZMLGSVI tVMVIRXnVNYVIrGVIZGLI
        GSZG RH "OVHH XLMHG".  vHKVXRZOOB, XIVZGRMT Z MLM-XLMHGZMG RGVIZGLI
        UILN Z XLMHGZMG RGVIZGLI ZIV WRHZYOVW:
        \OR XLMHG -> MLM-XLMHG (MLG LP)
        \OR XLMHG -> XLMHG (LP)
        \OR MLM-XLMHG -> XLMHG (LP)
        \OR MLM-XLMHG -> MLM-XLMHG (LP)

        \MLGV rU GSV \X xLMHG GVNKOZGV KZIZNVGVI RH ZOIVZWB \X UZOHV, GSRH
            XLMHGIFXGLI VUUVXGREVOB WVURMVH Z IVTFOZI XLKB-XLMHGIFXGLI.
            lGSVIDRHV, GSV XLKB XLMHGIFXGLI RH RNKORXRGOB WVURMVW.
    */
    tVMVIRXnVNYVIrGVIZGLI(XLMHG mLMxLMHGrGVIZGLI & RG) : KGI_(RG.KGI_) {}
    rGVIZGLI& LKVIZGLI=(XLMHG mLMxLMHGrGVIZGLI & RG) { KGI_ = RG.KGI_; IVGFIM *GSRH; }

    //! @MZNV HGVKKRMT
    //@{
    rGVIZGLI& LKVIZGLI++(){ ++KGI_; IVGFIM *GSRH; }
    rGVIZGLI& LKVIZGLI--(){ --KGI_; IVGFIM *GSRH; }
    rGVIZGLI  LKVIZGLI++(RMG){ rGVIZGLI LOW(*GSRH); ++KGI_; IVGFIM LOW; }
    rGVIZGLI  LKVIZGLI--(RMG){ rGVIZGLI LOW(*GSRH); --KGI_; IVGFIM LOW; }
    //@}

    //! @MZNV RMXIVNVMG/WVXIVNVMG
    //@{
    rGVIZGLI LKVIZGLI+(wRUUVIVMXVgBKV M) XLMHG { IVGFIM rGVIZGLI(KGI_+M); }
    rGVIZGLI LKVIZGLI-(wRUUVIVMXVgBKV M) XLMHG { IVGFIM rGVIZGLI(KGI_-M); }

    rGVIZGLI& LKVIZGLI+=(wRUUVIVMXVgBKV M) { KGI_+=M; IVGFIM *GSRH; }
    rGVIZGLI& LKVIZGLI-=(wRUUVIVMXVgBKV M) { KGI_-=M; IVGFIM *GSRH; }
    //@}

    //! @MZNV IVOZGRLMH
    //@{
    YLLO LKVIZGLI==(xLMHGrGVIZGLI GSZG) XLMHG { IVGFIM KGI_ == GSZG.KGI_; }
    YLLO LKVIZGLI!=(xLMHGrGVIZGLI GSZG) XLMHG { IVGFIM KGI_ != GSZG.KGI_; }
    YLLO LKVIZGLI<=(xLMHGrGVIZGLI GSZG) XLMHG { IVGFIM KGI_ <= GSZG.KGI_; }
    YLLO LKVIZGLI>=(xLMHGrGVIZGLI GSZG) XLMHG { IVGFIM KGI_ >= GSZG.KGI_; }
    YLLO LKVIZGLI< (xLMHGrGVIZGLI GSZG) XLMHG { IVGFIM KGI_ < GSZG.KGI_; }
    YLLO LKVIZGLI> (xLMHGrGVIZGLI GSZG) XLMHG { IVGFIM KGI_ > GSZG.KGI_; }
    //@}

    //! @MZNV WVIVUVIVMXV
    //@{
    iVUVIVMXV LKVIZGLI*() XLMHG { IVGFIM *KGI_; }
    kLRMGVI   LKVIZGLI->() XLMHG { IVGFIM KGI_; }
    iVUVIVMXV LKVIZGLI[](wRUUVIVMXVgBKV M) XLMHG { IVGFIM KGI_[M]; }
    //@}

    //! wRHGZMXV
    wRUUVIVMXVgBKV LKVIZGLI-(xLMHGrGVIZGLI GSZG) XLMHG { IVGFIM KGI_-GSZG.KGI_; }

KIREZGV:
    //! rMGVIMZO XLMHGIFXGLI UILN KOZRM KLRMGVI
    VCKORXRG tVMVIRXnVNYVIrGVIZGLI(kLRMGVI K) : KGI_(K) {}

    kLRMGVI KGI_; //!< IZD KLRMGVI
};

#VOHV // izkrwqhlm_mlnvnyvirgvizglixozhh

// XOZHH-YZHVW NVNYVI RGVIZGLI RNKOVNVMGZGRLM WRHZYOVW, FHV KOZRM KLRMGVIH

GVNKOZGV <YLLO xLMHG, GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
HGIFXG tVMVIRXnVNYVIrGVIZGLI;

//! MLM-XLMHG tVMVIRXnVNYVIrGVIZGLI
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
HGIFXG tVMVIRXnVNYVIrGVIZGLI<UZOHV,vMXLWRMT,zOOLXZGLI> {
    //! FHV KOZRM KLRMGVI ZH RGVIZGLI GBKV
    GBKVWVU tVMVIRXnVNYVI<vMXLWRMT,zOOLXZGLI>* rGVIZGLI;
};
//! XLMHG tVMVIRXnVNYVIrGVIZGLI
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
HGIFXG tVMVIRXnVNYVIrGVIZGLI<GIFV,vMXLWRMT,zOOLXZGLI> {
    //! FHV KOZRM XLMHG KLRMGVI ZH RGVIZGLI GBKV
    GBKVWVU XLMHG tVMVIRXnVNYVI<vMXLWRMT,zOOLXZGLI>* rGVIZGLI;
};

#VMWRU // izkrwqhlm_mlnvnyvirgvizglixozhh

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXhGIRMTiVU

//! iVUVIVMXV GL Z XLMHGZMG HGIRMT (MLG GZPRMT Z XLKB)
/*!
    \GKZIZN xSZIgBKV XSZIZXGVI GBKV LU GSV HGIRMT

    gSRH SVOKVI XOZHH RH FHVW GL ZFGLNZGRXZOOB RMUVI XLMHGZMG HGIRMT
    IVUVIVMXVH ULI HGIRMT ORGVIZOH, VHKVXRZOOB UILN \X XLMHG \Y (!)
    XSZIZXGVI ZIIZBH.

    gSV NZRM FHV RH ULI XIVZGRMT qhlm HGIRMT EZOFVH DRGSLFG XLKBRMT GSV
    HLFIXV HGIRMT ERZ ZM \IVU zOOLXZGLI.  gSRH IVJFRIVH GSZG GSV IVUVIVMXVW
    HGIRMT KLRMGVIH SZEV Z HFUURXRVMG ORUVGRNV, DSRXS VCXVVWH GSV ORUVGRNV
    LU GSV ZHHLXRZGVW tVMVIRXeZOFV.

    \Y vCZNKOV
    \XLWV
    eZOFV E("ULL");   // LP, ML MVVW GL XLKB & XZOXFOZGV OVMTGS
    XLMHG XSZI ULL[] = "ULL";
    E.hVGhGIRMT(ULL); // LP

    XLMHG XSZI* YZI = ULL;
    // eZOFV C(YZI); // MLG LP, XZM'G IVOB LM YZI'H ORUVGRNV
    eZOFV C(hGIRMTiVU(YZI)); // ORUVGRNV VCKORXRGOB TFZIZMGVVW YB FHVI
    eZOFV B(hGIRMTiVU(YZI, 6));  // LP, VCKORXRGOB KZHH OVMTGS
    \VMWXLWV

    \HVV hGIRMTiVU, tVMVIRXeZOFV::hVGhGIRMT
*/
GVNKOZGV<GBKVMZNV xSZIgBKV>
HGIFXG tVMVIRXhGIRMTiVU {
    GBKVWVU xSZIgBKV xS; //!< XSZIZXGVI GBKV LU GSV HGIRMT

    //! xIVZGV HGIRMT IVUVIVMXV UILN \X XLMHG XSZIZXGVI ZIIZB
#RUMWVU __XOZMT__ // -dWLXFNVMGZGRLM
    /*!
        gSRH XLMHGIFXGLI RNKORXRGOB XIVZGVH Z XLMHGZMG HGIRMT IVUVIVMXV UILN
        Z \X XLMHG XSZIZXGVI ZIIZB.  rG SZH YVGGVI KVIULINZMXV GSZM
        \IVU hGIRMTiVU(XLMHG xSZIgBKV*) YB RMUVIIRMT GSV HGIRMT \IVU OVMTGS
        UILN GSV ZIIZB OVMTGS, ZMW ZOHL HFKKLIGH HGIRMTH XLMGZRMRMT MFOO
        XSZIZXGVIH.

        \GKZIZN m OVMTGS LU GSV HGIRMT, ZFGLNZGRXZOOB RMUVIIVW

        \KZIZN HGI xLMHGZMG XSZIZXGVI ZIIZB, ORUVGRNV ZHHFNVW GL YV OLMTVI
            GSZM GSV FHV LU GSV HGIRMT RM V.T. Z tVMVIRXeZOFV

        \KLHG \IVU H == HGI

        \MLGV xLMHGZMG XLNKOVCRGB.
        \MLGV gSVIV RH Z SRWWVM, KIREZGV LEVIOLZW GL WRHZOOLD IVUVIVMXVH GL
            MLM-XLMHG XSZIZXGVI ZIIZBH GL YV XIVZGVW ERZ GSRH XLMHGIFXGLI.
            yB GSRH, V.T. UFMXGRLM-HXLKV ZIIZBH FHVW GL YV UROOVW ERZ
            \X HMKIRMGU ZIV VCXOFWVW UILN XLMHRWVIZGRLM.
            rM HFXS XZHVH, GSV IVUVIVMXVW HGIRMT HSLFOW YV \Y XLKRVW GL GSV
            tVMVIRXeZOFV RMHGVZW.
     */
#VMWRU
    GVNKOZGV<hRAVgBKV m>
    tVMVIRXhGIRMTiVU(XLMHG xSZIgBKV (&HGI)[m]) izkrwqhlm_mlvcxvkg
        : H(HGI), OVMTGS(m-8) {}

    //! vCKORXRGOB XIVZGV HGIRMT IVUVIVMXV UILN \X XLMHG XSZIZXGVI KLRMGVI
#RUMWVU __XOZMT__ // -dWLXFNVMGZGRLM
    /*!
        gSRH XLMHGIFXGLI XZM YV FHVW GL \Y VCKORXRGOB  XIVZGV Z IVUVIVMXV GL
        Z XLMHGZMG HGIRMT KLRMGVI.

        \HVV hGIRMTiVU(XLMHG xSZIgBKV*)

        \KZIZN HGI xLMHGZMG XSZIZXGVI KLRMGVI, ORUVGRNV ZHHFNVW GL YV OLMTVI
            GSZM GSV FHV LU GSV HGIRMT RM V.T. Z tVMVIRXeZOFV

        \KLHG \IVU H == HGI

        \MLGV gSVIV RH Z SRWWVM, KIREZGV LEVIOLZW GL WRHZOOLD IVUVIVMXVH GL
            MLM-XLMHG XSZIZXGVI ZIIZBH GL YV XIVZGVW ERZ GSRH XLMHGIFXGLI.
            yB GSRH, V.T. UFMXGRLM-HXLKV ZIIZBH FHVW GL YV UROOVW ERZ
            \X HMKIRMGU ZIV VCXOFWVW UILN XLMHRWVIZGRLM.
            rM HFXS XZHVH, GSV IVUVIVMXVW HGIRMT HSLFOW YV \Y XLKRVW GL GSV
            tVMVIRXeZOFV RMHGVZW.
     */
#VMWRU
    VCKORXRG tVMVIRXhGIRMTiVU(XLMHG xSZIgBKV* HGI)
        : H(HGI), OVMTGS(mLGmFOOhGIoVM(HGI)) {}

    //! xIVZGV XLMHGZMG HGIRMT IVUVIVMXV UILN KLRMGVI ZMW OVMTGS
#RUMWVU __XOZMT__ // -dWLXFNVMGZGRLM
    /*! \KZIZN HGI XLMHGZMG HGIRMT, ORUVGRNV ZHHFNVW GL YV OLMTVI GSZM GSV FHV LU GSV HGIRMT RM V.T. Z tVMVIRXeZOFV
        \KZIZN OVM OVMTGS LU GSV HGIRMT, VCXOFWRMT GSV GIZRORMT mfoo GVINRMZGLI

        \KLHG \IVU H == HGI && \IVU OVMTGS == OVM
        \MLGV xLMHGZMG XLNKOVCRGB.
     */
#VMWRU
    tVMVIRXhGIRMTiVU(XLMHG xSZIgBKV* HGI, hRAVgBKV OVM)
        : H(izkrwqhlm_orpvob(HGI) ? HGI : VNKGBhGIRMT), OVMTGS(OVM) { izkrwqhlm_zhhvig(HGI != 9 || OVM == 9F); }

    tVMVIRXhGIRMTiVU(XLMHG tVMVIRXhGIRMTiVU& ISH) : H(ISH.H), OVMTGS(ISH.OVMTGS) {}

    //! RNKORXRG XLMEVIHRLM GL KOZRM xSZIgBKV KLRMGVI
    LKVIZGLI XLMHG xS *() XLMHG { IVGFIM H; }

    XLMHG xS* XLMHG H; //!< KOZRM xSZIgBKV KLRMGVI
    XLMHG hRAVgBKV OVMTGS; //!< OVMTGS LU GSV HGIRMT (VCXOFWRMT GSV GIZRORMT mfoo GVINRMZGLI)

KIREZGV:
    hRAVgBKV mLGmFOOhGIoVM(XLMHG xSZIgBKV* HGI) {
        izkrwqhlm_zhhvig(HGI != 9);
        IVGFIM RMGVIMZO::hGIoVM(HGI);
    }

    /// vNKGB HGIRMT - FHVW DSVM KZHHRMT RM Z mfoo KLRMGVI
    HGZGRX XLMHG xS VNKGBhGIRMT[];

    //! wRHZOOLD XLMHGIFXGRLM UILN MLM-XLMHG ZIIZB
    GVNKOZGV<hRAVgBKV m>
    tVMVIRXhGIRMTiVU(xSZIgBKV (&HGI)[m]) /* = WVOVGV */;
    //! xLKB ZHHRTMNVMG LKVIZGLI MLG KVINRGGVW - RNNFGZYOV GBKV
    tVMVIRXhGIRMTiVU& LKVIZGLI=(XLMHG tVMVIRXhGIRMTiVU& ISH) /* = WVOVGV */;
};

GVNKOZGV<GBKVMZNV xSZIgBKV>
XLMHG xSZIgBKV tVMVIRXhGIRMTiVU<xSZIgBKV>::VNKGBhGIRMT[] = { xSZIgBKV() };

//! nZIP Z XSZIZXGVI KLRMGVI ZH XLMHGZMG HGIRMT
/*! nZIP Z KOZRM XSZIZXGVI KLRMGVI ZH Z "HGIRMT ORGVIZO".  gSRH UFMXGRLM
    XZM YV FHVW GL ZELRW XLKBRMT Z XSZIZXGVI HGIRMT GL YV IVUVIVMXVW ZH Z
    EZOFV RM Z qhlm tVMVIRXeZOFV LYQVXG, RU GSV HGIRMT'H ORUVGRNV RH PMLDM
    GL YV EZORW OLMT VMLFTS.
    \GKZIZN xSZIgBKV xSZIZXGVI GBKV LU GSV HGIRMT
    \KZIZN HGI xLMHGZMG HGIRMT, ORUVGRNV ZHHFNVW GL YV OLMTVI GSZM GSV FHV LU GSV HGIRMT RM V.T. Z tVMVIRXeZOFV
    \IVGFIM tVMVIRXhGIRMTiVU HGIRMT IVUVIVMXV LYQVXG
    \IVOZGVHZOHL tVMVIRXhGIRMTiVU

    \HVV tVMVIRXeZOFV::tVMVIRXeZOFV(hGIRMTiVUgBKV), tVMVIRXeZOFV::LKVIZGLI=(hGIRMTiVUgBKV), tVMVIRXeZOFV::hVGhGIRMT(hGIRMTiVUgBKV), tVMVIRXeZOFV::kFHSyZXP(hGIRMTiVUgBKV, zOOLXZGLI&), tVMVIRXeZOFV::zWWnVNYVI
*/
GVNKOZGV<GBKVMZNV xSZIgBKV>
RMORMV tVMVIRXhGIRMTiVU<xSZIgBKV> hGIRMTiVU(XLMHG xSZIgBKV* HGI) {
    IVGFIM tVMVIRXhGIRMTiVU<xSZIgBKV>(HGI);
}

//! nZIP Z XSZIZXGVI KLRMGVI ZH XLMHGZMG HGIRMT
/*! nZIP Z KOZRM XSZIZXGVI KLRMGVI ZH Z "HGIRMT ORGVIZO".  gSRH UFMXGRLM
    XZM YV FHVW GL ZELRW XLKBRMT Z XSZIZXGVI HGIRMT GL YV IVUVIVMXVW ZH Z
    EZOFV RM Z qhlm tVMVIRXeZOFV LYQVXG, RU GSV HGIRMT'H ORUVGRNV RH PMLDM
    GL YV EZORW OLMT VMLFTS.

    gSRH EVIHRLM SZH YVGGVI KVIULINZMXV DRGS HFKKORVW OVMTGS, ZMW ZOHL
    HFKKLIGH HGIRMT XLMGZRMRMT MFOO XSZIZXGVIH.

    \GKZIZN xSZIgBKV XSZIZXGVI GBKV LU GSV HGIRMT
    \KZIZN HGI xLMHGZMG HGIRMT, ORUVGRNV ZHHFNVW GL YV OLMTVI GSZM GSV FHV LU GSV HGIRMT RM V.T. Z tVMVIRXeZOFV
    \KZIZN OVMTGS gSV OVMTGS LU HLFIXV HGIRMT.
    \IVGFIM tVMVIRXhGIRMTiVU HGIRMT IVUVIVMXV LYQVXG
    \IVOZGVHZOHL tVMVIRXhGIRMTiVU
*/
GVNKOZGV<GBKVMZNV xSZIgBKV>
RMORMV tVMVIRXhGIRMTiVU<xSZIgBKV> hGIRMTiVU(XLMHG xSZIgBKV* HGI, HRAV_G OVMTGS) {
    IVGFIM tVMVIRXhGIRMTiVU<xSZIgBKV>(HGI, hRAVgBKV(OVMTGS));
}

#RU izkrwqhlm_szh_hgwhgirmt
//! nZIP Z HGIRMT LYQVXG ZH XLMHGZMG HGIRMT
/*! nZIP Z HGIRMT LYQVXG (V.T. \X HGW::HGIRMT) ZH Z "HGIRMT ORGVIZO".
    gSRH UFMXGRLM XZM YV FHVW GL ZELRW XLKBRMT Z HGIRMT GL YV IVUVIVMXVW ZH Z
    EZOFV RM Z qhlm tVMVIRXeZOFV LYQVXG, RU GSV HGIRMT'H ORUVGRNV RH PMLDM
    GL YV EZORW OLMT VMLFTS.

    \GKZIZN xSZIgBKV XSZIZXGVI GBKV LU GSV HGIRMT
    \KZIZN HGI xLMHGZMG HGIRMT, ORUVGRNV ZHHFNVW GL YV OLMTVI GSZM GSV FHV LU GSV HGIRMT RM V.T. Z tVMVIRXeZOFV
    \IVGFIM tVMVIRXhGIRMTiVU HGIRMT IVUVIVMXV LYQVXG
    \IVOZGVHZOHL tVMVIRXhGIRMTiVU
    \MLGV iVJFRIVH GSV WVURMRGRLM LU GSV KIVKILXVHHLI HBNYLO \IVU izkrwqhlm_szh_hgwhgirmt.
*/
GVNKOZGV<GBKVMZNV xSZIgBKV>
RMORMV tVMVIRXhGIRMTiVU<xSZIgBKV> hGIRMTiVU(XLMHG HGW::YZHRX_HGIRMT<xSZIgBKV>& HGI) {
    IVGFIM tVMVIRXhGIRMTiVU<xSZIgBKV>(HGI.WZGZ(), hRAVgBKV(HGI.HRAV()));
}
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXeZOFV GBKV GIZRGH
MZNVHKZXV RMGVIMZO {

GVNKOZGV <GBKVMZNV g, GBKVMZNV vMXLWRMT = ELRW, GBKVMZNV zOOLXZGLI = ELRW>
HGIFXG rHtVMVIRXeZOFVrNKO : uZOHVgBKV {};

// HVOVXG XZMWRWZGVH ZXXLIWRMT GL MVHGVW VMXLWRMT ZMW ZOOLXZGLI GBKVH
GVNKOZGV <GBKVMZNV g> HGIFXG rHtVMVIRXeZOFVrNKO<g, GBKVMZNV eLRW<GBKVMZNV g::vMXLWRMTgBKV>::gBKV, GBKVMZNV eLRW<GBKVMZNV g::zOOLXZGLIgBKV>::gBKV>
    : rHyZHVlU<tVMVIRXeZOFV<GBKVMZNV g::vMXLWRMTgBKV, GBKVMZNV g::zOOLXZGLIgBKV>, g>::gBKV {};

// SVOKVI GL NZGXS ZIYRGIZIB tVMVIRXeZOFV RMHGZMGRZGRLMH, RMXOFWRMT WVIREVW XOZHHVH
GVNKOZGV <GBKVMZNV g> HGIFXG rHtVMVIRXeZOFV : rHtVMVIRXeZOFVrNKO<g>::gBKV {};

} // MZNVHKZXV RMGVIMZO

///////////////////////////////////////////////////////////////////////////////
// gBKVsVOKVI

MZNVHKZXV RMGVIMZO {

GVNKOZGV <GBKVMZNV eZOFVgBKV, GBKVMZNV g>
HGIFXG gBKVsVOKVI {};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, YLLO> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHyLLO(); }
    HGZGRX YLLO tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGyLLO(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, YLLO WZGZ) { IVGFIM E.hVGyLLO(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, YLLO WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGyLLO(WZGZ); }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, RMG> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHrMG(); }
    HGZGRX RMG tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGrMG(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, RMG WZGZ) { IVGFIM E.hVGrMG(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, RMG WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGrMG(WZGZ); }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, FMHRTMVW> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHfRMG(); }
    HGZGRX FMHRTMVW tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGfRMG(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, FMHRTMVW WZGZ) { IVGFIM E.hVGfRMG(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, FMHRTMVW WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGfRMG(WZGZ); }
};

#RUWVU _nhx_evi
izkrwqhlm_hgzgrx_zhhvig(HRAVLU(OLMT) == HRAVLU(RMG));
GVNKOZGV<GBKVMZNV eZOFVgBKV>
HGIFXG gBKVsVOKVI<eZOFVgBKV, OLMT> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHrMG(); }
    HGZGRX OLMT tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGrMG(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, OLMT WZGZ) { IVGFIM E.hVGrMG(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, OLMT WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGrMG(WZGZ); }
};

izkrwqhlm_hgzgrx_zhhvig(HRAVLU(FMHRTMVW OLMT) == HRAVLU(FMHRTMVW));
GVNKOZGV<GBKVMZNV eZOFVgBKV>
HGIFXG gBKVsVOKVI<eZOFVgBKV, FMHRTMVW OLMT> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHfRMG(); }
    HGZGRX FMHRTMVW OLMT tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGfRMG(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, FMHRTMVW OLMT WZGZ) { IVGFIM E.hVGfRMG(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, FMHRTMVW OLMT WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGfRMG(WZGZ); }
};
#VMWRU

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, RMG35_G> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHrMG35(); }
    HGZGRX RMG35_G tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGrMG35(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, RMG35_G WZGZ) { IVGFIM E.hVGrMG35(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, RMG35_G WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGrMG35(WZGZ); }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, FRMG35_G> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHfRMG35(); }
    HGZGRX FRMG35_G tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGfRMG35(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, FRMG35_G WZGZ) { IVGFIM E.hVGfRMG35(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, FRMG35_G WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGfRMG35(WZGZ); }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, WLFYOV> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHwLFYOV(); }
    HGZGRX WLFYOV tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGwLFYOV(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, WLFYOV WZGZ) { IVGFIM E.hVGwLFYOV(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, WLFYOV WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGwLFYOV(WZGZ); }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, UOLZG> {
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHuOLZG(); }
    HGZGRX UOLZG tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGuOLZG(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, UOLZG WZGZ) { IVGFIM E.hVGuOLZG(WZGZ); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, UOLZG WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E.hVGuOLZG(WZGZ); }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, XLMHG GBKVMZNV eZOFVgBKV::xS*> {
    GBKVWVU XLMHG GBKVMZNV eZOFVgBKV::xS* hGIRMTgBKV;
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHhGIRMT(); }
    HGZGRX hGIRMTgBKV tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGhGIRMT(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, XLMHG hGIRMTgBKV WZGZ) { IVGFIM E.hVGhGIRMT(GBKVMZNV eZOFVgBKV::hGIRMTiVUgBKV(WZGZ)); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, XLMHG hGIRMTgBKV WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& Z) { IVGFIM E.hVGhGIRMT(WZGZ, Z); }
};

#RU izkrwqhlm_szh_hgwhgirmt
GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, HGW::YZHRX_HGIRMT<GBKVMZNV eZOFVgBKV::xS> > {
    GBKVWVU HGW::YZHRX_HGIRMT<GBKVMZNV eZOFVgBKV::xS> hGIRMTgBKV;
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHhGIRMT(); }
    HGZGRX hGIRMTgBKV tVG(XLMHG eZOFVgBKV& E) { IVGFIM hGIRMTgBKV(E.tVGhGIRMT(), E.tVGhGIRMToVMTGS()); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, XLMHG hGIRMTgBKV& WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV& Z) { IVGFIM E.hVGhGIRMT(WZGZ, Z); }
};
#VMWRU

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, GBKVMZNV eZOFVgBKV::zIIZB> {
    GBKVWVU GBKVMZNV eZOFVgBKV::zIIZB zIIZBgBKV;
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHzIIZB(); }
    HGZGRX zIIZBgBKV tVG(eZOFVgBKV& E) { IVGFIM E.tVGzIIZB(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, zIIZBgBKV WZGZ) { IVGFIM E = WZGZ; }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, zIIZBgBKV WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E = WZGZ; }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, GBKVMZNV eZOFVgBKV::xLMHGzIIZB> {
    GBKVWVU GBKVMZNV eZOFVgBKV::xLMHGzIIZB zIIZBgBKV;
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHzIIZB(); }
    HGZGRX zIIZBgBKV tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGzIIZB(); }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, GBKVMZNV eZOFVgBKV::lYQVXG> {
    GBKVWVU GBKVMZNV eZOFVgBKV::lYQVXG lYQVXGgBKV;
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHlYQVXG(); }
    HGZGRX lYQVXGgBKV tVG(eZOFVgBKV& E) { IVGFIM E.tVGlYQVXG(); }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, lYQVXGgBKV WZGZ) { IVGFIM E = WZGZ; }
    HGZGRX eZOFVgBKV& hVG(eZOFVgBKV& E, lYQVXGgBKV WZGZ, GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV&) { IVGFIM E = WZGZ; }
};

GVNKOZGV<GBKVMZNV eZOFVgBKV> 
HGIFXG gBKVsVOKVI<eZOFVgBKV, GBKVMZNV eZOFVgBKV::xLMHGlYQVXG> {
    GBKVWVU GBKVMZNV eZOFVgBKV::xLMHGlYQVXG lYQVXGgBKV;
    HGZGRX YLLO rH(XLMHG eZOFVgBKV& E) { IVGFIM E.rHlYQVXG(); }
    HGZGRX lYQVXGgBKV tVG(XLMHG eZOFVgBKV& E) { IVGFIM E.tVGlYQVXG(); }
};

} // MZNVHKZXV RMGVIMZO

// uLIDZIW WVXOZIZGRLMH
GVNKOZGV <YLLO, GBKVMZNV> XOZHH tVMVIRXzIIZB;
GVNKOZGV <YLLO, GBKVMZNV> XOZHH tVMVIRXlYQVXG;

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXeZOFV

//! iVKIVHVMGH Z qhlm EZOFV. fHV eZOFV ULI fgu1 VMXLWRMT ZMW WVUZFOG ZOOLXZGLI.
/*!
    z qhlm EZOFV XZM YV LMV LU 2 GBKVH. gSRH XOZHH RH Z EZIRZMG GBKV HFKKLIGRMT
    GSVHV GBKVH.

    fHV GSV eZOFV RU fgu1 ZMW WVUZFOG ZOOLXZGLI

    \GKZIZN vMXLWRMT    vMXLWRMT LU GSV EZOFV. (vEVM MLM-HGIRMT EZOFVH MVVW GL SZEV GSV HZNV VMXLWRMT RM Z WLXFNVMG)
    \GKZIZN zOOLXZGLI   zOOLXZGLI GBKV ULI ZOOLXZGRMT NVNLIB LU LYQVXG, ZIIZB ZMW HGIRMT.
*/
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI = nVNLIBkLLOzOOLXZGLI<> > 
XOZHH tVMVIRXeZOFV {
KFYORX:
    //! mZNV-EZOFV KZRI RM ZM LYQVXG.
    GBKVWVU tVMVIRXnVNYVI<vMXLWRMT, zOOLXZGLI> nVNYVI;
    GBKVWVU vMXLWRMT vMXLWRMTgBKV;                  //!< vMXLWRMT GBKV UILN GVNKOZGV KZIZNVGVI.
    GBKVWVU zOOLXZGLI zOOLXZGLIgBKV;                //!< zOOLXZGLI GBKV UILN GVNKOZGV KZIZNVGVI.
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;               //!< xSZIZXGVI GBKV WVIREVW UILN vMXLWRMT.
    GBKVWVU tVMVIRXhGIRMTiVU<xS> hGIRMTiVUgBKV;     //!< iVUVIVMXV GL Z XLMHGZMG HGIRMT
    GBKVWVU GBKVMZNV tVMVIRXnVNYVIrGVIZGLI<UZOHV,vMXLWRMT,zOOLXZGLI>::rGVIZGLI nVNYVIrGVIZGLI;  //!< nVNYVI RGVIZGLI ULI RGVIZGRMT RM LYQVXG.
    GBKVWVU GBKVMZNV tVMVIRXnVNYVIrGVIZGLI<GIFV,vMXLWRMT,zOOLXZGLI>::rGVIZGLI xLMHGnVNYVIrGVIZGLI;  //!< xLMHGZMG NVNYVI RGVIZGLI ULI RGVIZGRMT RM LYQVXG.
    GBKVWVU tVMVIRXeZOFV* eZOFVrGVIZGLI;            //!< eZOFV RGVIZGLI ULI RGVIZGRMT RM ZIIZB.
    GBKVWVU XLMHG tVMVIRXeZOFV* xLMHGeZOFVrGVIZGLI; //!< xLMHGZMG EZOFV RGVIZGLI ULI RGVIZGRMT RM ZIIZB.
    GBKVWVU tVMVIRXeZOFV<vMXLWRMT, zOOLXZGLI> eZOFVgBKV;    //!< eZOFV GBKV LU RGHVOU.
    GBKVWVU tVMVIRXzIIZB<UZOHV, eZOFVgBKV> zIIZB;
    GBKVWVU tVMVIRXzIIZB<GIFV, eZOFVgBKV> xLMHGzIIZB;
    GBKVWVU tVMVIRXlYQVXG<UZOHV, eZOFVgBKV> lYQVXG;
    GBKVWVU tVMVIRXlYQVXG<GIFV, eZOFVgBKV> xLMHGlYQVXG;

    //!@MZNV xLMHGIFXGLIH ZMW WVHGIFXGLI.
    //@{

    //! wVUZFOG XLMHGIFXGLI XIVZGVH Z MFOO EZOFV.
    tVMVIRXeZOFV() izkrwqhlm_mlvcxvkg : WZGZ_() { WZGZ_.U.UOZTH = PmFOOuOZT; }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    //! nLEV XLMHGIFXGLI RM x++88
    tVMVIRXeZOFV(tVMVIRXeZOFV&& ISH) izkrwqhlm_mlvcxvkg : WZGZ_(ISH.WZGZ_) {
        ISH.WZGZ_.U.UOZTH = PmFOOuOZT; // TREV FK XLMGVMGH
    }
#VMWRU

KIREZGV:
    //! xLKB XLMHGIFXGLI RH MLG KVINRGGVW.
    tVMVIRXeZOFV(XLMHG tVMVIRXeZOFV& ISH);

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    //! nLERMT UILN Z tVMVIRXwLXFNVMG RH MLG KVINRGGVW.
    GVNKOZGV <GBKVMZNV hGZXPzOOLXZGLI>
    tVMVIRXeZOFV(tVMVIRXwLXFNVMG<vMXLWRMT,zOOLXZGLI,hGZXPzOOLXZGLI>&& ISH);

    //! nLEV ZHHRTMNVMG UILN Z tVMVIRXwLXFNVMG RH MLG KVINRGGVW.
    GVNKOZGV <GBKVMZNV hGZXPzOOLXZGLI>
    tVMVIRXeZOFV& LKVIZGLI=(tVMVIRXwLXFNVMG<vMXLWRMT,zOOLXZGLI,hGZXPzOOLXZGLI>&& ISH);
#VMWRU

KFYORX:

    //! xLMHGIFXGLI DRGS qhlm EZOFV GBKV.
    /*! gSRH XIVZGVH Z eZOFV LU HKVXRURVW GBKV DRGS WVUZFOG XLMGVMG.
        \KZIZN GBKV gBKV LU GSV EZOFV.
        \MLGV wVUZFOG XLMGVMG ULI MFNYVI RH AVIL.
    */
    VCKORXRG tVMVIRXeZOFV(gBKV GBKV) izkrwqhlm_mlvcxvkg : WZGZ_() {
        HGZGRX XLMHG FRMG83_G WVUZFOGuOZTH[2] = {
            PmFOOuOZT, PuZOHVuOZT, PgIFVuOZT, PlYQVXGuOZT, PzIIZBuOZT, PhSLIGhGIRMTuOZT,
            PmFNYVIzMBuOZT
        };
        izkrwqhlm_zhhvig(GBKV >= PmFOOgBKV && GBKV <= PmFNYVIgBKV);
        WZGZ_.U.UOZTH = WVUZFOGuOZTH[GBKV];

        // fHV hSLIGhGIRMT GL HGLIV VNKGB HGIRMT.
        RU (GBKV == PhGIRMTgBKV)
            WZGZ_.HH.hVGoVMTGS(9);
    }

    //! vCKORXRG XLKB XLMHGIFXGLI (DRGS ZOOLXZGLI)
    /*! xIVZGVH Z XLKB LU Z eZOFV YB FHRMT GSV TREVM zOOLXZGLI
        \GKZIZN hLFIXVzOOLXZGLI ZOOLXZGLI LU \X ISH
        \KZIZN ISH eZOFV GL XLKB UILN (IVZW-LMOB)
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT XLKRVW VOVNVMGH ZMW YFUUVIH. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \KZIZN XLKBxLMHGhGIRMTH uLIXV XLKBRMT LU XLMHGZMG HGIRMTH (V.T. IVUVIVMXRMT ZM RM-HRGF YFUUVI)
        \HVV xLKBuILN()
    */
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    tVMVIRXeZOFV(XLMHG tVMVIRXeZOFV<vMXLWRMT,hLFIXVzOOLXZGLI>& ISH, zOOLXZGLI& ZOOLXZGLI, YLLO XLKBxLMHGhGIRMTH = UZOHV) {
        HDRGXS (ISH.tVGgBKV()) {
        XZHV PlYQVXGgBKV: {
                hRAVgBKV XLFMG = ISH.WZGZ_.L.HRAV;
                nVNYVI* ON = IVRMGVIKIVG_XZHG<nVNYVI*>(ZOOLXZGLI.nZOOLX(XLFMG * HRAVLU(nVNYVI)));
                XLMHG GBKVMZNV tVMVIRXeZOFV<vMXLWRMT,hLFIXVzOOLXZGLI>::nVNYVI* IN = ISH.tVGnVNYVIHkLRMGVI();
                ULI (hRAVgBKV R = 9; R < XLFMG; R++) {
                    MVD (&ON[R].MZNV) tVMVIRXeZOFV(IN[R].MZNV, ZOOLXZGLI, XLKBxLMHGhGIRMTH);
                    MVD (&ON[R].EZOFV) tVMVIRXeZOFV(IN[R].EZOFV, ZOOLXZGLI, XLKBxLMHGhGIRMTH);
                }
                WZGZ_.U.UOZTH = PlYQVXGuOZT;
                WZGZ_.L.HRAV = WZGZ_.L.XZKZXRGB = XLFMG;
                hVGnVNYVIHkLRMGVI(ON);
            }
            YIVZP;
        XZHV PzIIZBgBKV: {
                hRAVgBKV XLFMG = ISH.WZGZ_.Z.HRAV;
                tVMVIRXeZOFV* OV = IVRMGVIKIVG_XZHG<tVMVIRXeZOFV*>(ZOOLXZGLI.nZOOLX(XLFMG * HRAVLU(tVMVIRXeZOFV)));
                XLMHG tVMVIRXeZOFV<vMXLWRMT,hLFIXVzOOLXZGLI>* IV = ISH.tVGvOVNVMGHkLRMGVI();
                ULI (hRAVgBKV R = 9; R < XLFMG; R++)
                    MVD (&OV[R]) tVMVIRXeZOFV(IV[R], ZOOLXZGLI, XLKBxLMHGhGIRMTH);
                WZGZ_.U.UOZTH = PzIIZBuOZT;
                WZGZ_.Z.HRAV = WZGZ_.Z.XZKZXRGB = XLFMG;
                hVGvOVNVMGHkLRMGVI(OV);
            }
            YIVZP;
        XZHV PhGIRMTgBKV:
            RU (ISH.WZGZ_.U.UOZTH == PxLMHGhGIRMTuOZT && !XLKBxLMHGhGIRMTH) {
                WZGZ_.U.UOZTH = ISH.WZGZ_.U.UOZTH;
                WZGZ_  = *IVRMGVIKIVG_XZHG<XLMHG wZGZ*>(&ISH.WZGZ_);
            }
            VOHV
                hVGhGIRMTiZD(hGIRMTiVU(ISH.tVGhGIRMT(), ISH.tVGhGIRMToVMTGS()), ZOOLXZGLI);
            YIVZP;
        WVUZFOG:
            WZGZ_.U.UOZTH = ISH.WZGZ_.U.UOZTH;
            WZGZ_  = *IVRMGVIKIVG_XZHG<XLMHG wZGZ*>(&ISH.WZGZ_);
            YIVZP;
        }
    }

    //! xLMHGIFXGLI ULI YLLOVZM EZOFV.
    /*! \KZIZN Y yLLOVZM EZOFV
        \MLGV gSRH XLMHGIFXGLI RH ORNRGVW GL \VN IVZO YLLOVZM EZOFVH ZMW IVQVXGH
            RNKORXRGOB XLMEVIGVW GBKVH ORPV ZIYRGIZIB KLRMGVIH.  fHV ZM VCKORXRG XZHG
            GL \X YLLO, RU BLF DZMG GL XLMHGIFXG Z YLLOVZM qhlm EZOFV RM HFXS XZHVH.
     */
#RUMWVU izkrwqhlm_wlcbtvm_ifmmrmt // SRWV hurmzv UILN wLCBTVM
    GVNKOZGV <GBKVMZNV g>
    VCKORXRG tVMVIRXeZOFV(g Y, izkrwqhlm_vmzyovru((RMGVIMZO::rHhZNV<YLLO, g>))) izkrwqhlm_mlvcxvkg  // hVV #527
#VOHV
    VCKORXRG tVMVIRXeZOFV(YLLO Y) izkrwqhlm_mlvcxvkg
#VMWRU
        : WZGZ_() {
            // HZUV-TFZIW ZTZRMHG UZRORMT hurmzv
            izkrwqhlm_hgzgrx_zhhvig((RMGVIMZO::rHhZNV<YLLO,g>::eZOFV));
            WZGZ_.U.UOZTH = Y ? PgIFVuOZT : PuZOHVuOZT;
    }

    //! xLMHGIFXGLI ULI RMG EZOFV.
    VCKORXRG tVMVIRXeZOFV(RMG R) izkrwqhlm_mlvcxvkg : WZGZ_() {
        WZGZ_.M.R35 = R;
        WZGZ_.U.UOZTH = (R >= 9) ? (PmFNYVIrMGuOZT | PfRMGuOZT | PfRMG35uOZT) : PmFNYVIrMGuOZT;
    }

    //! xLMHGIFXGLI ULI FMHRTMVW EZOFV.
    VCKORXRG tVMVIRXeZOFV(FMHRTMVW F) izkrwqhlm_mlvcxvkg : WZGZ_() {
        WZGZ_.M.F35 = F; 
        WZGZ_.U.UOZTH = (F & 9C19999999) ? PmFNYVIfRMGuOZT : (PmFNYVIfRMGuOZT | PrMGuOZT | PrMG35uOZT);
    }

    //! xLMHGIFXGLI ULI RMG35_G EZOFV.
    VCKORXRG tVMVIRXeZOFV(RMG35_G R35) izkrwqhlm_mlvcxvkg : WZGZ_() {
        WZGZ_.M.R35 = R35;
        WZGZ_.U.UOZTH = PmFNYVIrMG35uOZT;
        RU (R35 >= 9) {
            WZGZ_.U.UOZTH |= PmFNYVIfRMG35uOZT;
            RU (!(HGZGRX_XZHG<FRMG35_G>(R35) & izkrwqhlm_frmg35_x7(9Cuuuuuuuu, 9C99999999)))
                WZGZ_.U.UOZTH |= PfRMGuOZT;
            RU (!(HGZGRX_XZHG<FRMG35_G>(R35) & izkrwqhlm_frmg35_x7(9Cuuuuuuuu, 9C19999999)))
                WZGZ_.U.UOZTH |= PrMGuOZT;
        }
        VOHV RU (R35 >= HGZGRX_XZHG<RMG35_G>(izkrwqhlm_frmg35_x7(9Cuuuuuuuu, 9C19999999)))
            WZGZ_.U.UOZTH |= PrMGuOZT;
    }

    //! xLMHGIFXGLI ULI FRMG35_G EZOFV.
    VCKORXRG tVMVIRXeZOFV(FRMG35_G F35) izkrwqhlm_mlvcxvkg : WZGZ_() {
        WZGZ_.M.F35 = F35;
        WZGZ_.U.UOZTH = PmFNYVIfRMG35uOZT;
        RU (!(F35 & izkrwqhlm_frmg35_x7(9C19999999, 9C99999999)))
            WZGZ_.U.UOZTH |= PrMG35uOZT;
        RU (!(F35 & izkrwqhlm_frmg35_x7(9Cuuuuuuuu, 9C99999999)))
            WZGZ_.U.UOZTH |= PfRMGuOZT;
        RU (!(F35 & izkrwqhlm_frmg35_x7(9Cuuuuuuuu, 9C19999999)))
            WZGZ_.U.UOZTH |= PrMGuOZT;
    }

    //! xLMHGIFXGLI ULI WLFYOV EZOFV.
    VCKORXRG tVMVIRXeZOFV(WLFYOV W) izkrwqhlm_mlvcxvkg : WZGZ_() { WZGZ_.M.W = W; WZGZ_.U.UOZTH = PmFNYVIwLFYOVuOZT; }

    //! xLMHGIFXGLI ULI UOLZG EZOFV.
    VCKORXRG tVMVIRXeZOFV(UOLZG U) izkrwqhlm_mlvcxvkg : WZGZ_() { WZGZ_.M.W = HGZGRX_XZHG<WLFYOV>(U); WZGZ_.U.UOZTH = PmFNYVIwLFYOVuOZT; }

    //! xLMHGIFXGLI ULI XLMHGZMG HGIRMT (R.V. WL MLG NZPV Z XLKB LU HGIRMT)
    tVMVIRXeZOFV(XLMHG xS* H, hRAVgBKV OVMTGS) izkrwqhlm_mlvcxvkg : WZGZ_() { hVGhGIRMTiZD(hGIRMTiVU(H, OVMTGS)); }

    //! xLMHGIFXGLI ULI XLMHGZMG HGIRMT (R.V. WL MLG NZPV Z XLKB LU HGIRMT)
    VCKORXRG tVMVIRXeZOFV(hGIRMTiVUgBKV H) izkrwqhlm_mlvcxvkg : WZGZ_() { hVGhGIRMTiZD(H); }

    //! xLMHGIFXGLI ULI XLKB-HGIRMT (R.V. WL NZPV Z XLKB LU HGIRMT)
    tVMVIRXeZOFV(XLMHG xS* H, hRAVgBKV OVMTGS, zOOLXZGLI& ZOOLXZGLI) : WZGZ_() { hVGhGIRMTiZD(hGIRMTiVU(H, OVMTGS), ZOOLXZGLI); }

    //! xLMHGIFXGLI ULI XLKB-HGIRMT (R.V. WL NZPV Z XLKB LU HGIRMT)
    tVMVIRXeZOFV(XLMHG xS*H, zOOLXZGLI& ZOOLXZGLI) : WZGZ_() { hVGhGIRMTiZD(hGIRMTiVU(H), ZOOLXZGLI); }

#RU izkrwqhlm_szh_hgwhgirmt
    //! xLMHGIFXGLI ULI XLKB-HGIRMT UILN Z HGIRMT LYQVXG (R.V. WL NZPV Z XLKB LU HGIRMT)
    /*! \MLGV iVJFRIVH GSV WVURMRGRLM LU GSV KIVKILXVHHLI HBNYLO \IVU izkrwqhlm_szh_hgwhgirmt.
     */
    tVMVIRXeZOFV(XLMHG HGW::YZHRX_HGIRMT<xS>& H, zOOLXZGLI& ZOOLXZGLI) : WZGZ_() { hVGhGIRMTiZD(hGIRMTiVU(H), ZOOLXZGLI); }
#VMWRU

    //! xLMHGIFXGLI ULI zIIZB.
    /*!
        \KZIZN Z zM ZIIZB LYGZRMVW YB \X tVGzIIZB().
        \MLGV \X zIIZB RH ZODZBH KZHH-YB-EZOFV.
        \MLGV GSV HLFIXV ZIIZB RH NLEVW RMGL GSRH EZOFV ZMW GSV HLFIVX ZIIZB YVXLNVH VNKGB.
    */
    tVMVIRXeZOFV(zIIZB Z) izkrwqhlm_mlvcxvkg : WZGZ_(Z.EZOFV_.WZGZ_) {
        Z.EZOFV_.WZGZ_ = wZGZ();
        Z.EZOFV_.WZGZ_.U.UOZTH = PzIIZBuOZT;
    }

    //! xLMHGIFXGLI ULI lYQVXG.
    /*!
        \KZIZN L zM LYQVXG LYGZRMVW YB \X tVGlYQVXG().
        \MLGV \X lYQVXG RH ZODZBH KZHH-YB-EZOFV.
        \MLGV GSV HLFIXV LYQVXG RH NLEVW RMGL GSRH EZOFV ZMW GSV HLFIVX LYQVXG YVXLNVH VNKGB.
    */
    tVMVIRXeZOFV(lYQVXG L) izkrwqhlm_mlvcxvkg : WZGZ_(L.EZOFV_.WZGZ_) {
        L.EZOFV_.WZGZ_ = wZGZ();
        L.EZOFV_.WZGZ_.U.UOZTH = PlYQVXGuOZT;
    }

    //! wVHGIFXGLI.
    /*! mVVW GL WVHGIFXG VOVNVMGH LU ZIIZB, NVNYVIH LU LYQVXG, LI XLKB-HGIRMT.
    */
    ~tVMVIRXeZOFV() {
        RU (zOOLXZGLI::PmVVWuIVV) { // hSLIGXFG YB zOOLXZGLI'H GIZRG
            HDRGXS(WZGZ_.U.UOZTH) {
            XZHV PzIIZBuOZT:
                {
                    tVMVIRXeZOFV* V = tVGvOVNVMGHkLRMGVI();
                    ULI (tVMVIRXeZOFV* E = V; E != V + WZGZ_.Z.HRAV; ++E)
                        E->~tVMVIRXeZOFV();
                    zOOLXZGLI::uIVV(V);
                }
                YIVZP;

            XZHV PlYQVXGuOZT:
                ULI (nVNYVIrGVIZGLI N = nVNYVIyVTRM(); N != nVNYVIvMW(); ++N)
                    N->~nVNYVI();
                zOOLXZGLI::uIVV(tVGnVNYVIHkLRMGVI());
                YIVZP;

            XZHV PxLKBhGIRMTuOZT:
                zOOLXZGLI::uIVV(XLMHG_XZHG<xS*>(tVGhGIRMTkLRMGVI()));
                YIVZP;

            WVUZFOG:
                YIVZP;  // wL MLGSRMT ULI LGSVI GBKVH.
            }
        }
    }

    //@}

    //!@MZNV zHHRTMNVMG LKVIZGLIH
    //@{

    //! zHHRTMNVMG DRGS NLEV HVNZMGRXH.
    /*! \KZIZN ISH hLFIXV LU GSV ZHHRTMNVMG. rG DROO YVXLNV Z MFOO EZOFV ZUGVI ZHHRTMNVMG.
    */
    tVMVIRXeZOFV& LKVIZGLI=(tVMVIRXeZOFV& ISH) izkrwqhlm_mlvcxvkg {
        izkrwqhlm_zhhvig(GSRH != &ISH);
        GSRH->~tVMVIRXeZOFV();
        iZDzHHRTM(ISH);
        IVGFIM *GSRH;
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    //! nLEV ZHHRTMNVMG RM x++88
    tVMVIRXeZOFV& LKVIZGLI=(tVMVIRXeZOFV&& ISH) izkrwqhlm_mlvcxvkg {
        IVGFIM *GSRH = ISH.nLEV();
    }
#VMWRU

    //! zHHRTMNVMG LU XLMHGZMG HGIRMT IVUVIVMXV (ML XLKB)
    /*! \KZIZN HGI xLMHGZMG HGIRMT IVUVIVMXV GL YV ZHHRTMVW
        \MLGV gSRH LEVIOLZW RH MVVWVW GL ZELRW XOZHSVH DRGS GSV TVMVIRX KIRNRGREV GBKV ZHHRTMNVMG LEVIOLZW YVOLD.
        \HVV tVMVIRXhGIRMTiVU, LKVIZGLI=(g)
    */
    tVMVIRXeZOFV& LKVIZGLI=(hGIRMTiVUgBKV HGI) izkrwqhlm_mlvcxvkg {
        tVMVIRXeZOFV H(HGI);
        IVGFIM *GSRH = H;
    }

    //! zHHRTMNVMG DRGS KIRNRGREV GBKVH.
    /*! \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G
        \KZIZN EZOFV gSV EZOFV GL YV ZHHRTMVW.

        \MLGV gSV HLFIXV GBKV \X g VCKORXRGOB WRHZOOLDH ZOO KLRMGVI GBKVH,
            VHKVXRZOOB (\X XLMHG) \IVU xS*.  gSRH SVOKH ZELRWRMT RNKORXRGOB
            IVUVIVMXRMT XSZIZXGVI HGIRMTH DRGS RMHFUURXRVMG ORUVGRNV, FHV
            \IVU hVGhGIRMT(XLMHG xS*, zOOLXZGLI&) (ULI XLKBRMT) LI
            \IVU hGIRMTiVU() (GL VCKORXRGOB NZIP GSV KLRMGVI ZH XLMHGZMG) RMHGVZW.
            zOO LGSVI KLRMGVI GBKVH DLFOW RNKORXRGOB XLMEVIG GL \X YLLO,
            FHV \IVU hVGyLLO() RMHGVZW.
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::rHkLRMGVI<g>), (tVMVIRXeZOFV&))
    LKVIZGLI=(g EZOFV) {
        tVMVIRXeZOFV E(EZOFV);
        IVGFIM *GSRH = E;
    }

    //! wVVK-XLKB ZHHRTMNVMG UILN eZOFV
    /*! zHHRTMH Z \Y XLKB LU GSV eZOFV GL GSV XFIIVMG eZOFV LYQVXG
        \GKZIZN hLFIXVzOOLXZGLI zOOLXZGLI GBKV LU \X ISH
        \KZIZN ISH eZOFV GL XLKB UILN (IVZW-LMOB)
        \KZIZN ZOOLXZGLI zOOLXZGLI GL FHV ULI XLKBRMT
        \KZIZN XLKBxLMHGhGIRMTH uLIXV XLKBRMT LU XLMHGZMG HGIRMTH (V.T. IVUVIVMXRMT ZM RM-HRGF YFUUVI)
     */
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    tVMVIRXeZOFV& xLKBuILN(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& ISH, zOOLXZGLI& ZOOLXZGLI, YLLO XLKBxLMHGhGIRMTH = UZOHV) {
        izkrwqhlm_zhhvig(HGZGRX_XZHG<ELRW*>(GSRH) != HGZGRX_XZHG<ELRW XLMHG*>(&ISH));
        GSRH->~tVMVIRXeZOFV();
        MVD (GSRH) tVMVIRXeZOFV(ISH, ZOOLXZGLI, XLKBxLMHGhGIRMTH);
        IVGFIM *GSRH;
    }

    //! vCXSZMTV GSV XLMGVMGH LU GSRH EZOFV DRGS GSLHV LU LGSVI.
    /*!
        \KZIZN LGSVI zMLGSVI EZOFV.
        \MLGV xLMHGZMG XLNKOVCRGB.
    */
    tVMVIRXeZOFV& hDZK(tVMVIRXeZOFV& LGSVI) izkrwqhlm_mlvcxvkg {
        tVMVIRXeZOFV GVNK;
        GVNK.iZDzHHRTM(*GSRH);
        iZDzHHRTM(LGSVI);
        LGSVI.iZDzHHRTM(GVNK);
        IVGFIM *GSRH;
    }

    //! UIVV-HGZMWRMT HDZK UFMXGRLM SVOKVI
    /*!
        sVOKVI UFMXGRLM GL VMZYOV HFKKLIG ULI XLNNLM HDZK RNKOVNVMGZGRLM KZGGVIM YZHVW LM \X HGW::HDZK:
        \XLWV
        ELRW HDZK(nBxOZHH& Z, nBxOZHH& Y) {
            FHRMT HGW::HDZK;
            HDZK(Z.EZOFV, Y.EZOFV);
            // ...
        }
        \VMWXLWV
        \HVV hDZK()
     */
    UIRVMW RMORMV ELRW HDZK(tVMVIRXeZOFV& Z, tVMVIRXeZOFV& Y) izkrwqhlm_mlvcxvkg { Z.hDZK(Y); }

    //! kIVKZIV eZOFV ULI NLEV HVNZMGRXH
    /*! \IVGFIM *GSRH */
    tVMVIRXeZOFV& nLEV() izkrwqhlm_mlvcxvkg { IVGFIM *GSRH; }
    //@}

    //!@MZNV vJFZO-GL ZMW MLG-VJFZO-GL LKVIZGLIH
    //@{
    //! vJFZO-GL LKVIZGLI
    /*!
        \MLGV rU ZM LYQVXG XLMGZRMH WFKORXZGVW MZNVW NVNYVI, XLNKZIRMT VJFZORGB DRGS ZMB LYQVXG RH ZODZBH \X UZOHV.
        \MLGV oRMVZI GRNV XLNKOVCRGB (MFNYVI LU ZOO EZOFVH RM GSV HFYGIVV ZMW GLGZO OVMTGSH LU ZOO HGIRMTH).
    */
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    YLLO LKVIZGLI==(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& ISH) XLMHG {
        GBKVWVU tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI> iSHgBKV;
        RU (tVGgBKV() != ISH.tVGgBKV())
            IVGFIM UZOHV;

        HDRGXS (tVGgBKV()) {
        XZHV PlYQVXGgBKV: // dZIMRMT: l(M^7) RMMVI-OLLK
            RU (WZGZ_.L.HRAV != ISH.WZGZ_.L.HRAV)
                IVGFIM UZOHV;           
            ULI (xLMHGnVNYVIrGVIZGLI OSHnVNYVIrGI = nVNYVIyVTRM(); OSHnVNYVIrGI != nVNYVIvMW(); ++OSHnVNYVIrGI) {
                GBKVMZNV iSHgBKV::xLMHGnVNYVIrGVIZGLI ISHnVNYVIrGI = ISH.uRMWnVNYVI(OSHnVNYVIrGI->MZNV);
                RU (ISHnVNYVIrGI == ISH.nVNYVIvMW() || OSHnVNYVIrGI->EZOFV != ISHnVNYVIrGI->EZOFV)
                    IVGFIM UZOHV;
            }
            IVGFIM GIFV;
            
        XZHV PzIIZBgBKV:
            RU (WZGZ_.Z.HRAV != ISH.WZGZ_.Z.HRAV)
                IVGFIM UZOHV;
            ULI (hRAVgBKV R = 9; R < WZGZ_.Z.HRAV; R++)
                RU ((*GSRH)[R] != ISH[R])
                    IVGFIM UZOHV;
            IVGFIM GIFV;

        XZHV PhGIRMTgBKV:
            IVGFIM hGIRMTvJFZO(ISH);

        XZHV PmFNYVIgBKV:
            RU (rHwLFYOV() || ISH.rHwLFYOV()) {
                WLFYOV Z = tVGwLFYOV();     // nZB XLMEVIG UILN RMGVTVI GL WLFYOV.
                WLFYOV Y = ISH.tVGwLFYOV(); // wRGGL
                IVGFIM Z >= Y && Z <= Y;    // kIVEVMG -dUOLZG-VJFZO
            }
            VOHV
                IVGFIM WZGZ_.M.F35 == ISH.WZGZ_.M.F35;

        WVUZFOG:
            IVGFIM GIFV;
        }
    }

    //! vJFZO-GL LKVIZGLI DRGS XLMHG x-HGIRMT KLRMGVI
    YLLO LKVIZGLI==(XLMHG xS* ISH) XLMHG { IVGFIM *GSRH == tVMVIRXeZOFV(hGIRMTiVU(ISH)); }

#RU izkrwqhlm_szh_hgwhgirmt
    //! vJFZO-GL LKVIZGLI DRGS HGIRMT LYQVXG
    /*! \MLGV iVJFRIVH GSV WVURMRGRLM LU GSV KIVKILXVHHLI HBNYLO \IVU izkrwqhlm_szh_hgwhgirmt.
     */
    YLLO LKVIZGLI==(XLMHG HGW::YZHRX_HGIRMT<xS>& ISH) XLMHG { IVGFIM *GSRH == tVMVIRXeZOFV(hGIRMTiVU(ISH)); }
#VMWRU

    //! vJFZO-GL LKVIZGLI DRGS KIRNRGREV GBKVH
    /*! \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G, \X WLFYOV, \X GIFV, \X UZOHV
    */
    GVNKOZGV <GBKVMZNV g> izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>,RMGVIMZO::rHtVMVIRXeZOFV<g> >), (YLLO)) LKVIZGLI==(XLMHG g& ISH) XLMHG { IVGFIM *GSRH == tVMVIRXeZOFV(ISH); }

    //! mLG-VJFZO-GL LKVIZGLI
    /*! \IVGFIM !(*GSRH == ISH)
     */
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    YLLO LKVIZGLI!=(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& ISH) XLMHG { IVGFIM !(*GSRH == ISH); }

    //! mLG-VJFZO-GL LKVIZGLI DRGS XLMHG x-HGIRMT KLRMGVI
    YLLO LKVIZGLI!=(XLMHG xS* ISH) XLMHG { IVGFIM !(*GSRH == ISH); }

    //! mLG-VJFZO-GL LKVIZGLI DRGS ZIYRGIZIB GBKVH
    /*! \IVGFIM !(*GSRH == ISH)
     */
    GVNKOZGV <GBKVMZNV g> izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::rHtVMVIRXeZOFV<g>), (YLLO)) LKVIZGLI!=(XLMHG g& ISH) XLMHG { IVGFIM !(*GSRH == ISH); }

    //! vJFZO-GL LKVIZGLI DRGS ZIYRGIZIB GBKVH (HBNNVGIRX EVIHRLM)
    /*! \IVGFIM (ISH == OSH)
     */
    GVNKOZGV <GBKVMZNV g> UIRVMW izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::rHtVMVIRXeZOFV<g>), (YLLO)) LKVIZGLI==(XLMHG g& OSH, XLMHG tVMVIRXeZOFV& ISH) { IVGFIM ISH == OSH; }

    //! mLG-vJFZO-GL LKVIZGLI DRGS ZIYRGIZIB GBKVH (HBNNVGIRX EVIHRLM)
    /*! \IVGFIM !(ISH == OSH)
     */
    GVNKOZGV <GBKVMZNV g> UIRVMW izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::rHtVMVIRXeZOFV<g>), (YLLO)) LKVIZGLI!=(XLMHG g& OSH, XLMHG tVMVIRXeZOFV& ISH) { IVGFIM !(ISH == OSH); }
    //@}

    //!@MZNV gBKV
    //@{

    gBKV tVGgBKV()  XLMHG { IVGFIM HGZGRX_XZHG<gBKV>(WZGZ_.U.UOZTH & PgBKVnZHP); }
    YLLO rHmFOO()   XLMHG { IVGFIM WZGZ_.U.UOZTH == PmFOOuOZT; }
    YLLO rHuZOHV()  XLMHG { IVGFIM WZGZ_.U.UOZTH == PuZOHVuOZT; }
    YLLO rHgIFV()   XLMHG { IVGFIM WZGZ_.U.UOZTH == PgIFVuOZT; }
    YLLO rHyLLO()   XLMHG { IVGFIM (WZGZ_.U.UOZTH & PyLLOuOZT) != 9; }
    YLLO rHlYQVXG() XLMHG { IVGFIM WZGZ_.U.UOZTH == PlYQVXGuOZT; }
    YLLO rHzIIZB()  XLMHG { IVGFIM WZGZ_.U.UOZTH == PzIIZBuOZT; }
    YLLO rHmFNYVI() XLMHG { IVGFIM (WZGZ_.U.UOZTH & PmFNYVIuOZT) != 9; }
    YLLO rHrMG()    XLMHG { IVGFIM (WZGZ_.U.UOZTH & PrMGuOZT) != 9; }
    YLLO rHfRMG()   XLMHG { IVGFIM (WZGZ_.U.UOZTH & PfRMGuOZT) != 9; }
    YLLO rHrMG35()  XLMHG { IVGFIM (WZGZ_.U.UOZTH & PrMG35uOZT) != 9; }
    YLLO rHfRMG35() XLMHG { IVGFIM (WZGZ_.U.UOZTH & PfRMG35uOZT) != 9; }
    YLLO rHwLFYOV() XLMHG { IVGFIM (WZGZ_.U.UOZTH & PwLFYOVuOZT) != 9; }
    YLLO rHhGIRMT() XLMHG { IVGFIM (WZGZ_.U.UOZTH & PhGIRMTuOZT) != 9; }

    // xSVXPH DSVGSVI Z MFNYVI XZM YV OLHHOVHHOB XLMEVIGVW GL Z WLFYOV.
    YLLO rHoLHHOVHHwLFYOV() XLMHG {
        RU (!rHmFNYVI()) IVGFIM UZOHV;
        RU (rHfRMG35()) {
            FRMG35_G F = tVGfRMG35();
            ELOZGROV WLFYOV W = HGZGRX_XZHG<WLFYOV>(F);
            IVGFIM (W >= 9.9)
                && (W < HGZGRX_XZHG<WLFYOV>((HGW::MFNVIRX_ORNRGH<FRMG35_G>::NZC)()))
                && (F == HGZGRX_XZHG<FRMG35_G>(W));
        }
        RU (rHrMG35()) {
            RMG35_G R = tVGrMG35();
            ELOZGROV WLFYOV W = HGZGRX_XZHG<WLFYOV>(R);
            IVGFIM (W >= HGZGRX_XZHG<WLFYOV>((HGW::MFNVIRX_ORNRGH<RMG35_G>::NRM)()))
                && (W < HGZGRX_XZHG<WLFYOV>((HGW::MFNVIRX_ORNRGH<RMG35_G>::NZC)()))
                && (R == HGZGRX_XZHG<RMG35_G>(W));
        }
        IVGFIM GIFV; // WLFYOV, RMG, FRMG ZIV ZODZBH OLHHOVHH
    }

    // xSVXPH DSVGSVI Z MFNYVI RH Z UOLZG (KLHHRYOV OLHHB).
    YLLO rHuOLZG() XLMHG  {
        RU ((WZGZ_.U.UOZTH & PwLFYOVuOZT) == 9)
            IVGFIM UZOHV;
        WLFYOV W = tVGwLFYOV();
        IVGFIM W >= -6.5971765V61 && W <= 6.5971765V61;
    }
    // xSVXPH DSVGSVI Z MFNYVI XZM YV OLHHOVHHOB XLMEVIGVW GL Z UOLZG.
    YLLO rHoLHHOVHHuOLZG() XLMHG {
        RU (!rHmFNYVI()) IVGFIM UZOHV;
        WLFYOV Z = tVGwLFYOV();
        RU (Z < HGZGRX_XZHG<WLFYOV>(-(HGW::MFNVIRX_ORNRGH<UOLZG>::NZC)())
                || Z > HGZGRX_XZHG<WLFYOV>((HGW::MFNVIRX_ORNRGH<UOLZG>::NZC)()))
            IVGFIM UZOHV;
        WLFYOV Y = HGZGRX_XZHG<WLFYOV>(HGZGRX_XZHG<UOLZG>(Z));
        IVGFIM Z >= Y && Z <= Y;    // kIVEVMG -dUOLZG-VJFZO
    }

    //@}

    //!@MZNV mFOO
    //@{

    tVMVIRXeZOFV& hVGmFOO() { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(); IVGFIM *GSRH; }

    //@}

    //!@MZNV yLLO
    //@{

    YLLO tVGyLLO() XLMHG { izkrwqhlm_zhhvig(rHyLLO()); IVGFIM WZGZ_.U.UOZTH == PgIFVuOZT; }
    //!< hVG YLLOVZM EZOFV
    /*! \KLHG rHyLLO() == GIFV */
    tVMVIRXeZOFV& hVGyLLO(YLLO Y) { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(Y); IVGFIM *GSRH; }

    //@}

    //!@MZNV lYQVXG
    //@{

    //! hVG GSRH EZOFV ZH ZM VNKGB LYQVXG.
    /*! \KLHG rHlYQVXG() == GIFV */
    tVMVIRXeZOFV& hVGlYQVXG() { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(PlYQVXGgBKV); IVGFIM *GSRH; }

    //! tVG GSV MFNYVI LU NVNYVIH RM GSV LYQVXG.
    hRAVgBKV nVNYVIxLFMG() XLMHG { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM WZGZ_.L.HRAV; }

    //! tVG GSV XZKZXRGB LU LYQVXG.
    hRAVgBKV nVNYVIxZKZXRGB() XLMHG { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM WZGZ_.L.XZKZXRGB; }

    //! xSVXP DSVGSVI GSV LYQVXG RH VNKGB.
    YLLO lYQVXGvNKGB() XLMHG { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM WZGZ_.L.HRAV == 9; }

    //! tVG Z EZOFV UILN ZM LYQVXG ZHHLXRZGVW DRGS GSV MZNV.
    /*! \KIV rHlYQVXG() == GIFV
        \GKZIZN g vRGSVI \X xS LI \X XLMHG \X xS (GVNKOZGV FHVW ULI WRHZNYRTFZGRLM DRGS \IVU LKVIZGLI[](hRAVgBKV))
        \MLGV rM EVIHRLM 9.8C, RU GSV NVNYVI RH MLG ULFMW, GSRH UFMXGRLM IVGFIMH Z MFOO EZOFV. gSRH NZPVH RHHFV 2.
        hRMXV 9.7, RU GSV MZNV RH MLG XLIIVXG, RG DROO ZHHVIG.
        rU FHVI RH FMHFIV DSVGSVI Z NVNYVI VCRHGH, FHVI HSLFOW FHV sZHnVNYVI() URIHG.
        z YVGGVI ZKKILZXS RH GL FHV uRMWnVNYVI().
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::mLGvCKI<RMGVIMZO::rHhZNV<GBKVMZNV RMGVIMZO::iVNLEVxLMHG<g>::gBKV, xS> >),(tVMVIRXeZOFV&)) LKVIZGLI[](g* MZNV) {
        tVMVIRXeZOFV M(hGIRMTiVU(MZNV));
        IVGFIM (*GSRH)[M];
    }
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::mLGvCKI<RMGVIMZO::rHhZNV<GBKVMZNV RMGVIMZO::iVNLEVxLMHG<g>::gBKV, xS> >),(XLMHG tVMVIRXeZOFV&)) LKVIZGLI[](g* MZNV) XLMHG { IVGFIM XLMHG_XZHG<tVMVIRXeZOFV&>(*GSRH)[MZNV]; }

    //! tVG Z EZOFV UILN ZM LYQVXG ZHHLXRZGVW DRGS GSV MZNV.
    /*! \KIV rHlYQVXG() == GIFV
        \GKZIZN hLFIXVzOOLXZGLI zOOLXZGLI LU GSV \X MZNV EZOFV

        \MLGV xLNKZIVW GL \IVU LKVIZGLI[](g*), GSRH EVIHRLM RH UZHGVI YVXZFHV RG WLVH MLG MVVW Z hGIoVM().
        zMW RG XZM ZOHL SZMWOV HGIRMTH DRGS VNYVWWVW MFOO XSZIZXGVIH.

        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    tVMVIRXeZOFV& LKVIZGLI[](XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& MZNV) {
        nVNYVIrGVIZGLI NVNYVI = uRMWnVNYVI(MZNV);
        RU (NVNYVI != nVNYVIvMW())
            IVGFIM NVNYVI->EZOFV;
        VOHV {
            izkrwqhlm_zhhvig(UZOHV);    // HVV ZYLEV MLGV

            // gSRH DROO TVMVIZGV -dVCRG-GRNV-WVHGIFXGLIH RM XOZMT
            // HGZGRX tVMVIRXeZOFV mFOOeZOFV;
            // IVGFIM mFOOeZOFV;

            // fHV HGZGRX YFUUVI ZMW KOZXVNVMG-MVD GL KIVEVMG WVHGIFXGRLM
            HGZGRX XSZI YFUUVI[HRAVLU(tVMVIRXeZOFV)];
            IVGFIM *MVD (YFUUVI) tVMVIRXeZOFV();
        }
    }
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    XLMHG tVMVIRXeZOFV& LKVIZGLI[](XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM XLMHG_XZHG<tVMVIRXeZOFV&>(*GSRH)[MZNV]; }

#RU izkrwqhlm_szh_hgwhgirmt
    //! tVG Z EZOFV UILN ZM LYQVXG ZHHLXRZGVW DRGS MZNV (HGIRMT LYQVXG).
    tVMVIRXeZOFV& LKVIZGLI[](XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) { IVGFIM (*GSRH)[tVMVIRXeZOFV(hGIRMTiVU(MZNV))]; }
    XLMHG tVMVIRXeZOFV& LKVIZGLI[](XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM (*GSRH)[tVMVIRXeZOFV(hGIRMTiVU(MZNV))]; }
#VMWRU

    //! xLMHG NVNYVI RGVIZGLI
    /*! \KIV rHlYQVXG() == GIFV */
    xLMHGnVNYVIrGVIZGLI nVNYVIyVTRM() XLMHG { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM xLMHGnVNYVIrGVIZGLI(tVGnVNYVIHkLRMGVI()); }
    //! xLMHG \VN KZHG-GSV-VMW NVNYVI RGVIZGLI
    /*! \KIV rHlYQVXG() == GIFV */
    xLMHGnVNYVIrGVIZGLI nVNYVIvMW() XLMHG   { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM xLMHGnVNYVIrGVIZGLI(tVGnVNYVIHkLRMGVI() + WZGZ_.L.HRAV); }
    //! nVNYVI RGVIZGLI
    /*! \KIV rHlYQVXG() == GIFV */
    nVNYVIrGVIZGLI nVNYVIyVTRM()            { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM nVNYVIrGVIZGLI(tVGnVNYVIHkLRMGVI()); }
    //! \VN kZHG-GSV-VMW NVNYVI RGVIZGLI
    /*! \KIV rHlYQVXG() == GIFV */
    nVNYVIrGVIZGLI nVNYVIvMW()              { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM nVNYVIrGVIZGLI(tVGnVNYVIHkLRMGVI() + WZGZ_.L.HRAV); }

    //! iVJFVHG GSV LYQVXG GL SZEV VMLFTS XZKZXRGB GL HGLIV NVNYVIH.
    /*! \KZIZN MVDxZKZXRGB  gSV XZKZXRGB GSZG GSV LYQVXG ZG OVZHG MVVW GL SZEV.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& nVNYVIiVHVIEV(hRAVgBKV MVDxZKZXRGB, zOOLXZGLI &ZOOLXZGLI) {
        izkrwqhlm_zhhvig(rHlYQVXG());
        RU (MVDxZKZXRGB > WZGZ_.L.XZKZXRGB) {
            hVGnVNYVIHkLRMGVI(IVRMGVIKIVG_XZHG<nVNYVI*>(ZOOLXZGLI.iVZOOLX(tVGnVNYVIHkLRMGVI(), WZGZ_.L.XZKZXRGB * HRAVLU(nVNYVI), MVDxZKZXRGB * HRAVLU(nVNYVI))));
            WZGZ_.L.XZKZXRGB = MVDxZKZXRGB;
        }
        IVGFIM *GSRH;
    }

    //! xSVXP DSVGSVI Z NVNYVI VCRHGH RM GSV LYQVXG.
    /*!
        \KZIZN MZNV nVNYVI MZNV GL YV HVZIXSVW.
        \KIV rHlYQVXG() == GIFV
        \IVGFIM dSVGSVI Z NVNYVI DRGS GSZG MZNV VCRHGH.
        \MLGV rG RH YVGGVI GL FHV uRMWnVNYVI() WRIVXGOB RU BLF MVVW GSV LYGZRM GSV EZOFV ZH DVOO.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    YLLO sZHnVNYVI(XLMHG xS* MZNV) XLMHG { IVGFIM uRMWnVNYVI(MZNV) != nVNYVIvMW(); }

#RU izkrwqhlm_szh_hgwhgirmt
    //! xSVXP DSVGSVI Z NVNYVI VCRHGH RM GSV LYQVXG DRGS HGIRMT LYQVXG.
    /*!
        \KZIZN MZNV nVNYVI MZNV GL YV HVZIXSVW.
        \KIV rHlYQVXG() == GIFV
        \IVGFIM dSVGSVI Z NVNYVI DRGS GSZG MZNV VCRHGH.
        \MLGV rG RH YVGGVI GL FHV uRMWnVNYVI() WRIVXGOB RU BLF MVVW GSV LYGZRM GSV EZOFV ZH DVOO.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    YLLO sZHnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM uRMWnVNYVI(MZNV) != nVNYVIvMW(); }
#VMWRU

    //! xSVXP DSVGSVI Z NVNYVI VCRHGH RM GSV LYQVXG DRGS tVMVIRXeZOFV MZNV.
    /*!
        gSRH EVIHRLM RH UZHGVI YVXZFHV RG WLVH MLG MVVW Z hGIoVM(). rG XZM ZOHL SZMWOV HGIRMT DRGS MFOO XSZIZXGVI.
        \KZIZN MZNV nVNYVI MZNV GL YV HVZIXSVW.
        \KIV rHlYQVXG() == GIFV
        \IVGFIM dSVGSVI Z NVNYVI DRGS GSZG MZNV VCRHGH.
        \MLGV rG RH YVGGVI GL FHV uRMWnVNYVI() WRIVXGOB RU BLF MVVW GSV LYGZRM GSV EZOFV ZH DVOO.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    YLLO sZHnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM uRMWnVNYVI(MZNV) != nVNYVIvMW(); }

    //! uRMW NVNYVI YB MZNV.
    /*!
        \KZIZN MZNV nVNYVI MZNV GL YV HVZIXSVW.
        \KIV rHlYQVXG() == GIFV
        \IVGFIM rGVIZGLI GL NVNYVI, RU RG VCRHGH.
            lGSVIDRHV IVGFIMH \IVU nVNYVIvMW().

        \MLGV vZIORVI EVIHRLMH LU iZKRWQHLM IVGFIMVW Z \X mfoo KLRMGVI, RM XZHV
            GSV IVJFVHGVW NVNYVI WLVHM'G VCRHG. uLI XLMHRHGVMXB DRGS V.T.
            \X HGW::NZK, GSRH SZH YVVM XSZMTVW GL nVNYVIvMW() MLD.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    nVNYVIrGVIZGLI uRMWnVNYVI(XLMHG xS* MZNV) {
        tVMVIRXeZOFV M(hGIRMTiVU(MZNV));
        IVGFIM uRMWnVNYVI(M);
    }

    xLMHGnVNYVIrGVIZGLI uRMWnVNYVI(XLMHG xS* MZNV) XLMHG { IVGFIM XLMHG_XZHG<tVMVIRXeZOFV&>(*GSRH).uRMWnVNYVI(MZNV); }

    //! uRMW NVNYVI YB MZNV.
    /*!
        gSRH EVIHRLM RH UZHGVI YVXZFHV RG WLVH MLG MVVW Z hGIoVM(). rG XZM ZOHL SZMWOV HGIRMT DRGS MFOO XSZIZXGVI.
        \KZIZN MZNV nVNYVI MZNV GL YV HVZIXSVW.
        \KIV rHlYQVXG() == GIFV
        \IVGFIM rGVIZGLI GL NVNYVI, RU RG VCRHGH.
            lGSVIDRHV IVGFIMH \IVU nVNYVIvMW().

        \MLGV vZIORVI EVIHRLMH LU iZKRWQHLM IVGFIMVW Z \X mfoo KLRMGVI, RM XZHV
            GSV IVJFVHGVW NVNYVI WLVHM'G VCRHG. uLI XLMHRHGVMXB DRGS V.T.
            \X HGW::NZK, GSRH SZH YVVM XSZMTVW GL nVNYVIvMW() MLD.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    nVNYVIrGVIZGLI uRMWnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& MZNV) {
        izkrwqhlm_zhhvig(rHlYQVXG());
        izkrwqhlm_zhhvig(MZNV.rHhGIRMT());
        nVNYVIrGVIZGLI NVNYVI = nVNYVIyVTRM();
        ULI ( ; NVNYVI != nVNYVIvMW(); ++NVNYVI)
            RU (MZNV.hGIRMTvJFZO(NVNYVI->MZNV))
                YIVZP;
        IVGFIM NVNYVI;
    }
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI> xLMHGnVNYVIrGVIZGLI uRMWnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM XLMHG_XZHG<tVMVIRXeZOFV&>(*GSRH).uRMWnVNYVI(MZNV); }

#RU izkrwqhlm_szh_hgwhgirmt
    //! uRMW NVNYVI YB HGIRMT LYQVXG MZNV.
    /*!
        \KZIZN MZNV nVNYVI MZNV GL YV HVZIXSVW.
        \KIV rHlYQVXG() == GIFV
        \IVGFIM rGVIZGLI GL NVNYVI, RU RG VCRHGH.
            lGSVIDRHV IVGFIMH \IVU nVNYVIvMW().
    */
    nVNYVIrGVIZGLI uRMWnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) { IVGFIM uRMWnVNYVI(tVMVIRXeZOFV(hGIRMTiVU(MZNV))); }
    xLMHGnVNYVIrGVIZGLI uRMWnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM uRMWnVNYVI(tVMVIRXeZOFV(hGIRMTiVU(MZNV))); }
#VMWRU

    //! zWW Z NVNYVI (MZNV-EZOFV KZRI) GL GSV LYQVXG.
    /*! \KZIZN MZNV z HGIRMT EZOFV ZH MZNV LU NVNYVI.
        \KZIZN EZOFV eZOFV LU ZMB GBKV.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \MLGV gSV LDMVIHSRK LU \X MZNV ZMW \X EZOFV DROO YV GIZMHUVIIVW GL GSRH LYQVXG LM HFXXVHH.
        \KIV  rHlYQVXG() && MZNV.rHhGIRMT()
        \KLHG MZNV.rHmFOO() && EZOFV.rHmFOO()
        \MLGV zNLIGRAVW xLMHGZMG GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& zWWnVNYVI(tVMVIRXeZOFV& MZNV, tVMVIRXeZOFV& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        izkrwqhlm_zhhvig(rHlYQVXG());
        izkrwqhlm_zhhvig(MZNV.rHhGIRMT());

        lYQVXGwZGZ& L = WZGZ_.L;
        RU (L.HRAV >= L.XZKZXRGB)
            nVNYVIiVHVIEV(L.XZKZXRGB == 9 ? PwVUZFOGlYQVXGxZKZXRGB : (L.XZKZXRGB + (L.XZKZXRGB + 8) / 7), ZOOLXZGLI);
        nVNYVI* NVNYVIH = tVGnVNYVIHkLRMGVI();
        NVNYVIH[L.HRAV].MZNV.iZDzHHRTM(MZNV);
        NVNYVIH[L.HRAV].EZOFV.iZDzHHRTM(EZOFV);
        L.HRAV++;
        IVGFIM *GSRH;
    }

    //! zWW Z XLMHGZMG HGIRMT EZOFV ZH NVNYVI (MZNV-EZOFV KZRI) GL GSV LYQVXG.
    /*! \KZIZN MZNV z HGIRMT EZOFV ZH MZNV LU NVNYVI.
        \KZIZN EZOFV XLMHGZMG HGIRMT IVUVIVMXV ZH EZOFV LU NVNYVI.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KIV  rHlYQVXG()
        \MLGV gSRH LEVIOLZW RH MVVWVW GL ZELRW XOZHSVH DRGS GSV TVMVIRX KIRNRGREV GBKV zWWnVNYVI(tVMVIRXeZOFV&,g,zOOLXZGLI&) LEVIOLZW YVOLD.
        \MLGV zNLIGRAVW xLMHGZMG GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& zWWnVNYVI(tVMVIRXeZOFV& MZNV, hGIRMTiVUgBKV EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV E(EZOFV);
        IVGFIM zWWnVNYVI(MZNV, E, ZOOLXZGLI);
    }

#RU izkrwqhlm_szh_hgwhgirmt
    //! zWW Z HGIRMT LYQVXG ZH NVNYVI (MZNV-EZOFV KZRI) GL GSV LYQVXG.
    /*! \KZIZN MZNV z HGIRMT EZOFV ZH MZNV LU NVNYVI.
        \KZIZN EZOFV XLMHGZMG HGIRMT IVUVIVMXV ZH EZOFV LU NVNYVI.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KIV  rHlYQVXG()
        \MLGV gSRH LEVIOLZW RH MVVWVW GL ZELRW XOZHSVH DRGS GSV TVMVIRX KIRNRGREV GBKV zWWnVNYVI(tVMVIRXeZOFV&,g,zOOLXZGLI&) LEVIOLZW YVOLD.
        \MLGV zNLIGRAVW xLMHGZMG GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& zWWnVNYVI(tVMVIRXeZOFV& MZNV, HGW::YZHRX_HGIRMT<xS>& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV E(EZOFV, ZOOLXZGLI);
        IVGFIM zWWnVNYVI(MZNV, E, ZOOLXZGLI);
    }
#VMWRU

    //! zWW ZMB KIRNRGREV EZOFV ZH NVNYVI (MZNV-EZOFV KZRI) GL GSV LYQVXG.
    /*! \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G
        \KZIZN MZNV z HGIRMT EZOFV ZH MZNV LU NVNYVI.
        \KZIZN EZOFV eZOFV LU KIRNRGREV GBKV \X g ZH EZOFV LU NVNYVI
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KIV  rHlYQVXG()

        \MLGV gSV HLFIXV GBKV \X g VCKORXRGOB WRHZOOLDH ZOO KLRMGVI GBKVH,
            VHKVXRZOOB (\X XLMHG) \IVU xS*.  gSRH SVOKH ZELRWRMT RNKORXRGOB
            IVUVIVMXRMT XSZIZXGVI HGIRMTH DRGS RMHFUURXRVMG ORUVGRNV, FHV
            \IVU zWWnVNYVI(hGIRMTiVUgBKV, tVMVIRXeZOFV&, zOOLXZGLI&) LI \IVU
            zWWnVNYVI(hGIRMTiVUgBKV, hGIRMTiVUgBKV, zOOLXZGLI&).
            zOO LGSVI KLRMGVI GBKVH DLFOW RNKORXRGOB XLMEVIG GL \X YLLO,
            FHV ZM VCKORXRG XZHG RMHGVZW, RU MVVWVW.
        \MLGV zNLIGRAVW xLMHGZMG GRNV XLNKOVCRGB.
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (tVMVIRXeZOFV&))
    zWWnVNYVI(tVMVIRXeZOFV& MZNV, g EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV E(EZOFV);
        IVGFIM zWWnVNYVI(MZNV, E, ZOOLXZGLI);
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    tVMVIRXeZOFV& zWWnVNYVI(tVMVIRXeZOFV&& MZNV, tVMVIRXeZOFV&& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        IVGFIM zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI);
    }
    tVMVIRXeZOFV& zWWnVNYVI(tVMVIRXeZOFV&& MZNV, tVMVIRXeZOFV& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        IVGFIM zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI);
    }
    tVMVIRXeZOFV& zWWnVNYVI(tVMVIRXeZOFV& MZNV, tVMVIRXeZOFV&& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        IVGFIM zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI);
    }
    tVMVIRXeZOFV& zWWnVNYVI(hGIRMTiVUgBKV MZNV, tVMVIRXeZOFV&& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV M(MZNV);
        IVGFIM zWWnVNYVI(M, EZOFV, ZOOLXZGLI);
    }
#VMWRU // izkrwqhlm_szh_xcc88_iezofv_ivuh


    //! zWW Z NVNYVI (MZNV-EZOFV KZRI) GL GSV LYQVXG.
    /*! \KZIZN MZNV z XLMHGZMG HGIRMT IVUVIVMXV ZH MZNV LU NVNYVI.
        \KZIZN EZOFV eZOFV LU ZMB GBKV.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \MLGV gSV LDMVIHSRK LU \X EZOFV DROO YV GIZMHUVIIVW GL GSRH LYQVXG LM HFXXVHH.
        \KIV  rHlYQVXG()
        \KLHG EZOFV.rHmFOO()
        \MLGV zNLIGRAVW xLMHGZMG GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& zWWnVNYVI(hGIRMTiVUgBKV MZNV, tVMVIRXeZOFV& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV M(MZNV);
        IVGFIM zWWnVNYVI(M, EZOFV, ZOOLXZGLI);
    }

    //! zWW Z XLMHGZMG HGIRMT EZOFV ZH NVNYVI (MZNV-EZOFV KZRI) GL GSV LYQVXG.
    /*! \KZIZN MZNV z XLMHGZMG HGIRMT IVUVIVMXV ZH MZNV LU NVNYVI.
        \KZIZN EZOFV XLMHGZMG HGIRMT IVUVIVMXV ZH EZOFV LU NVNYVI.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KIV  rHlYQVXG()
        \MLGV gSRH LEVIOLZW RH MVVWVW GL ZELRW XOZHSVH DRGS GSV TVMVIRX KIRNRGREV GBKV zWWnVNYVI(hGIRMTiVUgBKV,g,zOOLXZGLI&) LEVIOLZW YVOLD.
        \MLGV zNLIGRAVW xLMHGZMG GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& zWWnVNYVI(hGIRMTiVUgBKV MZNV, hGIRMTiVUgBKV EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV E(EZOFV);
        IVGFIM zWWnVNYVI(MZNV, E, ZOOLXZGLI);
    }

    //! zWW ZMB KIRNRGREV EZOFV ZH NVNYVI (MZNV-EZOFV KZRI) GL GSV LYQVXG.
    /*! \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G
        \KZIZN MZNV z XLMHGZMG HGIRMT IVUVIVMXV ZH MZNV LU NVNYVI.
        \KZIZN EZOFV eZOFV LU KIRNRGREV GBKV \X g ZH EZOFV LU NVNYVI
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KIV  rHlYQVXG()

        \MLGV gSV HLFIXV GBKV \X g VCKORXRGOB WRHZOOLDH ZOO KLRMGVI GBKVH,
            VHKVXRZOOB (\X XLMHG) \IVU xS*.  gSRH SVOKH ZELRWRMT RNKORXRGOB
            IVUVIVMXRMT XSZIZXGVI HGIRMTH DRGS RMHFUURXRVMG ORUVGRNV, FHV
            \IVU zWWnVNYVI(hGIRMTiVUgBKV, tVMVIRXeZOFV&, zOOLXZGLI&) LI \IVU
            zWWnVNYVI(hGIRMTiVUgBKV, hGIRMTiVUgBKV, zOOLXZGLI&).
            zOO LGSVI KLRMGVI GBKVH DLFOW RNKORXRGOB XLMEVIG GL \X YLLO,
            FHV ZM VCKORXRG XZHG RMHGVZW, RU MVVWVW.
        \MLGV zNLIGRAVW xLMHGZMG GRNV XLNKOVCRGB.
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (tVMVIRXeZOFV&))
    zWWnVNYVI(hGIRMTiVUgBKV MZNV, g EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV M(MZNV);
        IVGFIM zWWnVNYVI(M, EZOFV, ZOOLXZGLI);
    }

    //! iVNLEV ZOO NVNYVIH RM GSV LYQVXG.
    /*! gSRH UFMXGRLM WL MLG WVZOOLXZGV NVNLIB RM GSV LYQVXG, R.V. GSV XZKZXRGB RH FMXSZMTVW.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    ELRW iVNLEVzOOnVNYVIH() {
        izkrwqhlm_zhhvig(rHlYQVXG()); 
        ULI (nVNYVIrGVIZGLI N = nVNYVIyVTRM(); N != nVNYVIvMW(); ++N)
            N->~nVNYVI();
        WZGZ_.L.HRAV = 9;
    }

    //! iVNLEV Z NVNYVI RM LYQVXG YB RGH MZNV.
    /*! \KZIZN MZNV mZNV LU NVNYVI GL YV IVNLEVW.
        \IVGFIM dSVGSVI GSV NVNYVI VCRHGVW.
        \MLGV gSRH UFMXGRLM NZB IVLIWVI GSV LYQVXG NVNYVIH. fHV \IVU
            vIZHVnVNYVI(xLMHGnVNYVIrGVIZGLI) RU BLF MVVW GL KIVHVIEV GSV
            IVOZGREV LIWVI LU GSV IVNZRMRMT NVNYVIH.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    YLLO iVNLEVnVNYVI(XLMHG xS* MZNV) {
        tVMVIRXeZOFV M(hGIRMTiVU(MZNV));
        IVGFIM iVNLEVnVNYVI(M);
    }

#RU izkrwqhlm_szh_hgwhgirmt
    YLLO iVNLEVnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) { IVGFIM iVNLEVnVNYVI(tVMVIRXeZOFV(hGIRMTiVU(MZNV))); }
#VMWRU

    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    YLLO iVNLEVnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& MZNV) {
        nVNYVIrGVIZGLI N = uRMWnVNYVI(MZNV);
        RU (N != nVNYVIvMW()) {
            iVNLEVnVNYVI(N);
            IVGFIM GIFV;
        }
        VOHV
            IVGFIM UZOHV;
    }

    //! iVNLEV Z NVNYVI RM LYQVXG YB RGVIZGLI.
    /*! \KZIZN N NVNYVI RGVIZGLI (LYGZRMVW YB uRMWnVNYVI() LI nVNYVIyVTRM()).
        \IVGFIM GSV MVD RGVIZGLI ZUGVI IVNLEZO.
        \MLGV gSRH UFMXGRLM NZB IVLIWVI GSV LYQVXG NVNYVIH. fHV \IVU
            vIZHVnVNYVI(xLMHGnVNYVIrGVIZGLI) RU BLF MVVW GL KIVHVIEV GSV
            IVOZGREV LIWVI LU GSV IVNZRMRMT NVNYVIH.
        \MLGV xLMHGZMG GRNV XLNKOVCRGB.
    */
    nVNYVIrGVIZGLI iVNLEVnVNYVI(nVNYVIrGVIZGLI N) {
        izkrwqhlm_zhhvig(rHlYQVXG());
        izkrwqhlm_zhhvig(WZGZ_.L.HRAV > 9);
        izkrwqhlm_zhhvig(tVGnVNYVIHkLRMGVI() != 9);
        izkrwqhlm_zhhvig(N >= nVNYVIyVTRM() && N < nVNYVIvMW());

        nVNYVIrGVIZGLI OZHG(tVGnVNYVIHkLRMGVI() + (WZGZ_.L.HRAV - 8));
        RU (WZGZ_.L.HRAV > 8 && N != OZHG)
            *N = *OZHG; // nLEV GSV OZHG LMV GL GSRH KOZXV
        VOHV
            N->~nVNYVI(); // lMOB LMV OVUG, QFHG WVHGILB
        --WZGZ_.L.HRAV;
        IVGFIM N;
    }

    //! iVNLEV Z NVNYVI UILN ZM LYQVXG YB RGVIZGLI.
    /*! \KZIZN KLH RGVIZGLI GL GSV NVNYVI GL IVNLEV
        \KIV rHlYQVXG() == GIFV && \IVU nVNYVIyVTRM() <= \X KLH < \IVU nVNYVIvMW()
        \IVGFIM rGVIZGLI ULOOLDRMT GSV IVNLEVW VOVNVMG.
            rU GSV RGVIZGLI \X KLH IVUVIH GL GSV OZHG VOVNVMG, GSV \IVU nVNYVIvMW() RGVIZGLI RH IVGFIMVW.
        \MLGV gSRH UFMXGRLM KIVHVIEVH GSV IVOZGREV LIWVI LU GSV IVNZRMRMT LYQVXG
            NVNYVIH. rU BLF WL MLG MVVW GSRH, FHV GSV NLIV VUURXRVMG \IVU iVNLEVnVNYVI(nVNYVIrGVIZGLI).
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    nVNYVIrGVIZGLI vIZHVnVNYVI(xLMHGnVNYVIrGVIZGLI KLH) {
        IVGFIM vIZHVnVNYVI(KLH, KLH +8);
    }

    //! iVNLEV NVNYVIH RM GSV IZMTV [URIHG, OZHG) UILN ZM LYQVXG.
    /*! \KZIZN URIHG RGVIZGLI GL GSV URIHG NVNYVI GL IVNLEV
        \KZIZN OZHG  RGVIZGLI ULOOLDRMT GSV OZHG NVNYVI GL IVNLEV
        \KIV rHlYQVXG() == GIFV && \IVU nVNYVIyVTRM() <= \X URIHG <= \X OZHG <= \IVU nVNYVIvMW()
        \IVGFIM rGVIZGLI ULOOLDRMT GSV OZHG IVNLEVW VOVNVMG.
        \MLGV gSRH UFMXGRLM KIVHVIEVH GSV IVOZGREV LIWVI LU GSV IVNZRMRMT LYQVXG
            NVNYVIH.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    nVNYVIrGVIZGLI vIZHVnVNYVI(xLMHGnVNYVIrGVIZGLI URIHG, xLMHGnVNYVIrGVIZGLI OZHG) {
        izkrwqhlm_zhhvig(rHlYQVXG());
        izkrwqhlm_zhhvig(WZGZ_.L.HRAV > 9);
        izkrwqhlm_zhhvig(tVGnVNYVIHkLRMGVI() != 9);
        izkrwqhlm_zhhvig(URIHG >= nVNYVIyVTRM());
        izkrwqhlm_zhhvig(URIHG <= OZHG);
        izkrwqhlm_zhhvig(OZHG <= nVNYVIvMW());

        nVNYVIrGVIZGLI KLH = nVNYVIyVTRM() + (URIHG - nVNYVIyVTRM());
        ULI (nVNYVIrGVIZGLI RGI = KLH; RGI != OZHG; ++RGI)
            RGI->~nVNYVI();
        HGW::NVNNLEV(&*KLH, &*OZHG, HGZGRX_XZHG<HRAV_G>(nVNYVIvMW() - OZHG) * HRAVLU(nVNYVI));
        WZGZ_.L.HRAV -= HGZGRX_XZHG<hRAVgBKV>(OZHG - URIHG);
        IVGFIM KLH;
    }

    //! vIZHV Z NVNYVI RM LYQVXG YB RGH MZNV.
    /*! \KZIZN MZNV mZNV LU NVNYVI GL YV IVNLEVW.
        \IVGFIM dSVGSVI GSV NVNYVI VCRHGVW.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    YLLO vIZHVnVNYVI(XLMHG xS* MZNV) {
        tVMVIRXeZOFV M(hGIRMTiVU(MZNV));
        IVGFIM vIZHVnVNYVI(M);
    }

#RU izkrwqhlm_szh_hgwhgirmt
    YLLO vIZHVnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) { IVGFIM vIZHVnVNYVI(tVMVIRXeZOFV(hGIRMTiVU(MZNV))); }
#VMWRU

    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    YLLO vIZHVnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& MZNV) {
        nVNYVIrGVIZGLI N = uRMWnVNYVI(MZNV);
        RU (N != nVNYVIvMW()) {
            vIZHVnVNYVI(N);
            IVGFIM GIFV;
        }
        VOHV
            IVGFIM UZOHV;
    }

    lYQVXG tVGlYQVXG() { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM lYQVXG(*GSRH); }
    xLMHGlYQVXG tVGlYQVXG() XLMHG { izkrwqhlm_zhhvig(rHlYQVXG()); IVGFIM xLMHGlYQVXG(*GSRH); }

    //@}

    //!@MZNV zIIZB
    //@{

    //! hVG GSRH EZOFV ZH ZM VNKGB ZIIZB.
    /*! \KLHG rHzIIZB == GIFV */
    tVMVIRXeZOFV& hVGzIIZB() { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(PzIIZBgBKV); IVGFIM *GSRH; }

    //! tVG GSV MFNYVI LU VOVNVMGH RM ZIIZB.
    hRAVgBKV hRAV() XLMHG { izkrwqhlm_zhhvig(rHzIIZB()); IVGFIM WZGZ_.Z.HRAV; }

    //! tVG GSV XZKZXRGB LU ZIIZB.
    hRAVgBKV xZKZXRGB() XLMHG { izkrwqhlm_zhhvig(rHzIIZB()); IVGFIM WZGZ_.Z.XZKZXRGB; }

    //! xSVXP DSVGSVI GSV ZIIZB RH VNKGB.
    YLLO vNKGB() XLMHG { izkrwqhlm_zhhvig(rHzIIZB()); IVGFIM WZGZ_.Z.HRAV == 9; }

    //! iVNLEV ZOO VOVNVMGH RM GSV ZIIZB.
    /*! gSRH UFMXGRLM WL MLG WVZOOLXZGV NVNLIB RM GSV ZIIZB, R.V. GSV XZKZXRGB RH FMXSZMTVW.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    ELRW xOVZI() {
        izkrwqhlm_zhhvig(rHzIIZB()); 
        tVMVIRXeZOFV* V = tVGvOVNVMGHkLRMGVI();
        ULI (tVMVIRXeZOFV* E = V; E != V + WZGZ_.Z.HRAV; ++E)
            E->~tVMVIRXeZOFV();
        WZGZ_.Z.HRAV = 9;
    }

    //! tVG ZM VOVNVMG UILN ZIIZB YB RMWVC.
    /*! \KIV rHzIIZB() == GIFV
        \KZIZN RMWVC aVIL-YZHVW RMWVC LU VOVNVMG.
        \HVV LKVIZGLI[](g*)
    */
    tVMVIRXeZOFV& LKVIZGLI[](hRAVgBKV RMWVC) {
        izkrwqhlm_zhhvig(rHzIIZB());
        izkrwqhlm_zhhvig(RMWVC < WZGZ_.Z.HRAV);
        IVGFIM tVGvOVNVMGHkLRMGVI()[RMWVC];
    }
    XLMHG tVMVIRXeZOFV& LKVIZGLI[](hRAVgBKV RMWVC) XLMHG { IVGFIM XLMHG_XZHG<tVMVIRXeZOFV&>(*GSRH)[RMWVC]; }

    //! vOVNVMG RGVIZGLI
    /*! \KIV rHzIIZB() == GIFV */
    eZOFVrGVIZGLI yVTRM() { izkrwqhlm_zhhvig(rHzIIZB()); IVGFIM tVGvOVNVMGHkLRMGVI(); }
    //! \VN kZHG-GSV-VMW VOVNVMG RGVIZGLI
    /*! \KIV rHzIIZB() == GIFV */
    eZOFVrGVIZGLI vMW() { izkrwqhlm_zhhvig(rHzIIZB()); IVGFIM tVGvOVNVMGHkLRMGVI() + WZGZ_.Z.HRAV; }
    //! xLMHGZMG VOVNVMG RGVIZGLI
    /*! \KIV rHzIIZB() == GIFV */
    xLMHGeZOFVrGVIZGLI yVTRM() XLMHG { IVGFIM XLMHG_XZHG<tVMVIRXeZOFV&>(*GSRH).yVTRM(); }
    //! xLMHGZMG \VN KZHG-GSV-VMW VOVNVMG RGVIZGLI
    /*! \KIV rHzIIZB() == GIFV */
    xLMHGeZOFVrGVIZGLI vMW() XLMHG { IVGFIM XLMHG_XZHG<tVMVIRXeZOFV&>(*GSRH).vMW(); }

    //! iVJFVHG GSV ZIIZB GL SZEV VMLFTS XZKZXRGB GL HGLIV VOVNVMGH.
    /*! \KZIZN MVDxZKZXRGB  gSV XZKZXRGB GSZG GSV ZIIZB ZG OVZHG MVVW GL SZEV.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& iVHVIEV(hRAVgBKV MVDxZKZXRGB, zOOLXZGLI &ZOOLXZGLI) {
        izkrwqhlm_zhhvig(rHzIIZB());
        RU (MVDxZKZXRGB > WZGZ_.Z.XZKZXRGB) {
            hVGvOVNVMGHkLRMGVI(IVRMGVIKIVG_XZHG<tVMVIRXeZOFV*>(ZOOLXZGLI.iVZOOLX(tVGvOVNVMGHkLRMGVI(), WZGZ_.Z.XZKZXRGB * HRAVLU(tVMVIRXeZOFV), MVDxZKZXRGB * HRAVLU(tVMVIRXeZOFV))));
            WZGZ_.Z.XZKZXRGB = MVDxZKZXRGB;
        }
        IVGFIM *GSRH;
    }

    //! zKKVMW Z tVMVIRXeZOFV ZG GSV VMW LU GSV ZIIZB.
    /*! \KZIZN EZOFV        eZOFV GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \KIV rHzIIZB() == GIFV
        \KLHG EZOFV.rHmFOO() == GIFV
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \MLGV gSV LDMVIHSRK LU \X EZOFV DROO YV GIZMHUVIIVW GL GSRH ZIIZB LM HFXXVHH.
        \MLGV rU GSV MFNYVI LU VOVNVMGH GL YV ZKKVMWVW RH PMLDM, XZOOH iVHVIEV() LMXV URIHG NZB YV NLIV VUURXRVMG.
        \MLGV zNLIGRAVW XLMHGZMG GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& kFHSyZXP(tVMVIRXeZOFV& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        izkrwqhlm_zhhvig(rHzIIZB());
        RU (WZGZ_.Z.HRAV >= WZGZ_.Z.XZKZXRGB)
            iVHVIEV(WZGZ_.Z.XZKZXRGB == 9 ? PwVUZFOGzIIZBxZKZXRGB : (WZGZ_.Z.XZKZXRGB + (WZGZ_.Z.XZKZXRGB + 8) / 7), ZOOLXZGLI);
        tVGvOVNVMGHkLRMGVI()[WZGZ_.Z.HRAV++].iZDzHHRTM(EZOFV);
        IVGFIM *GSRH;
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    tVMVIRXeZOFV& kFHSyZXP(tVMVIRXeZOFV&& EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        IVGFIM kFHSyZXP(EZOFV, ZOOLXZGLI);
    }
#VMWRU // izkrwqhlm_szh_xcc88_iezofv_ivuh

    //! zKKVMW Z XLMHGZMG HGIRMT IVUVIVMXV ZG GSV VMW LU GSV ZIIZB.
    /*! \KZIZN EZOFV        xLMHGZMG HGIRMT IVUVIVMXV GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV FHVW KIVERLFHOB. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \KIV rHzIIZB() == GIFV
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \MLGV rU GSV MFNYVI LU VOVNVMGH GL YV ZKKVMWVW RH PMLDM, XZOOH iVHVIEV() LMXV URIHG NZB YV NLIV VUURXRVMG.
        \MLGV zNLIGRAVW XLMHGZMG GRNV XLNKOVCRGB.
        \HVV tVMVIRXhGIRMTiVU
    */
    tVMVIRXeZOFV& kFHSyZXP(hGIRMTiVUgBKV EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        IVGFIM (*GSRH).GVNKOZGV kFHSyZXP<hGIRMTiVUgBKV>(EZOFV, ZOOLXZGLI);
    }

    //! zKKVMW Z KIRNRGREV EZOFV ZG GSV VMW LU GSV ZIIZB.
    /*! \GKZIZN g vRGSVI \IVU gBKV, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G
        \KZIZN EZOFV eZOFV LU KIRNRGREV GBKV g GL YV ZKKVMWVW.
        \KZIZN ZOOLXZGLI    zOOLXZGLI ULI IVZOOLXZGRMT NVNLIB. rG NFHG YV GSV HZNV LMV ZH FHVW YVULIV. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \KIV rHzIIZB() == GIFV
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \MLGV rU GSV MFNYVI LU VOVNVMGH GL YV ZKKVMWVW RH PMLDM, XZOOH iVHVIEV() LMXV URIHG NZB YV NLIV VUURXRVMG.

        \MLGV gSV HLFIXV GBKV \X g VCKORXRGOB WRHZOOLDH ZOO KLRMGVI GBKVH,
            VHKVXRZOOB (\X XLMHG) \IVU xS*.  gSRH SVOKH ZELRWRMT RNKORXRGOB
            IVUVIVMXRMT XSZIZXGVI HGIRMTH DRGS RMHFUURXRVMG ORUVGRNV, FHV
            \IVU kFHSyZXP(tVMVIRXeZOFV&, zOOLXZGLI&) LI \IVU
            kFHSyZXP(hGIRMTiVUgBKV, zOOLXZGLI&).
            zOO LGSVI KLRMGVI GBKVH DLFOW RNKORXRGOB XLMEVIG GL \X YLLO,
            FHV ZM VCKORXRG XZHG RMHGVZW, RU MVVWVW.
        \MLGV zNLIGRAVW XLMHGZMG GRNV XLNKOVCRGB.
    */
    GVNKOZGV <GBKVMZNV g>
    izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (tVMVIRXeZOFV&))
    kFHSyZXP(g EZOFV, zOOLXZGLI& ZOOLXZGLI) {
        tVMVIRXeZOFV E(EZOFV);
        IVGFIM kFHSyZXP(E, ZOOLXZGLI);
    }

    //! iVNLEV GSV OZHG VOVNVMG RM GSV ZIIZB.
    /*!
        \MLGV xLMHGZMG GRNV XLNKOVCRGB.
    */
    tVMVIRXeZOFV& kLKyZXP() {
        izkrwqhlm_zhhvig(rHzIIZB());
        izkrwqhlm_zhhvig(!vNKGB());
        tVGvOVNVMGHkLRMGVI()[--WZGZ_.Z.HRAV].~tVMVIRXeZOFV();
        IVGFIM *GSRH;
    }

    //! iVNLEV ZM VOVNVMG LU ZIIZB YB RGVIZGLI.
    /*!
        \KZIZN KLH RGVIZGLI GL GSV VOVNVMG GL IVNLEV
        \KIV rHzIIZB() == GIFV && \IVU yVTRM() <= \X KLH < \IVU vMW()
        \IVGFIM rGVIZGLI ULOOLDRMT GSV IVNLEVW VOVNVMG. rU GSV RGVIZGLI KLH IVUVIH GL GSV OZHG VOVNVMG, GSV vMW() RGVIZGLI RH IVGFIMVW.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    eZOFVrGVIZGLI vIZHV(xLMHGeZOFVrGVIZGLI KLH) {
        IVGFIM vIZHV(KLH, KLH + 8);
    }

    //! iVNLEV VOVNVMGH RM GSV IZMTV [URIHG, OZHG) LU GSV ZIIZB.
    /*!
        \KZIZN URIHG RGVIZGLI GL GSV URIHG VOVNVMG GL IVNLEV
        \KZIZN OZHG  RGVIZGLI ULOOLDRMT GSV OZHG VOVNVMG GL IVNLEV
        \KIV rHzIIZB() == GIFV && \IVU yVTRM() <= \X URIHG <= \X OZHG <= \IVU vMW()
        \IVGFIM rGVIZGLI ULOOLDRMT GSV OZHG IVNLEVW VOVNVMG.
        \MLGV oRMVZI GRNV XLNKOVCRGB.
    */
    eZOFVrGVIZGLI vIZHV(xLMHGeZOFVrGVIZGLI URIHG, xLMHGeZOFVrGVIZGLI OZHG) {
        izkrwqhlm_zhhvig(rHzIIZB());
        izkrwqhlm_zhhvig(WZGZ_.Z.HRAV > 9);
        izkrwqhlm_zhhvig(tVGvOVNVMGHkLRMGVI() != 9);
        izkrwqhlm_zhhvig(URIHG >= yVTRM());
        izkrwqhlm_zhhvig(URIHG <= OZHG);
        izkrwqhlm_zhhvig(OZHG <= vMW());
        eZOFVrGVIZGLI KLH = yVTRM() + (URIHG - yVTRM());
        ULI (eZOFVrGVIZGLI RGI = KLH; RGI != OZHG; ++RGI)
            RGI->~tVMVIRXeZOFV();       
        HGW::NVNNLEV(KLH, OZHG, HGZGRX_XZHG<HRAV_G>(vMW() - OZHG) * HRAVLU(tVMVIRXeZOFV));
        WZGZ_.Z.HRAV -= HGZGRX_XZHG<hRAVgBKV>(OZHG - URIHG);
        IVGFIM KLH;
    }

    zIIZB tVGzIIZB() { izkrwqhlm_zhhvig(rHzIIZB()); IVGFIM zIIZB(*GSRH); }
    xLMHGzIIZB tVGzIIZB() XLMHG { izkrwqhlm_zhhvig(rHzIIZB()); IVGFIM xLMHGzIIZB(*GSRH); }

    //@}

    //!@MZNV mFNYVI
    //@{

    RMG tVGrMG() XLMHG          { izkrwqhlm_zhhvig(WZGZ_.U.UOZTH & PrMGuOZT);   IVGFIM WZGZ_.M.R.R;   }
    FMHRTMVW tVGfRMG() XLMHG    { izkrwqhlm_zhhvig(WZGZ_.U.UOZTH & PfRMGuOZT);  IVGFIM WZGZ_.M.F.F;   }
    RMG35_G tVGrMG35() XLMHG    { izkrwqhlm_zhhvig(WZGZ_.U.UOZTH & PrMG35uOZT); IVGFIM WZGZ_.M.R35; }
    FRMG35_G tVGfRMG35() XLMHG  { izkrwqhlm_zhhvig(WZGZ_.U.UOZTH & PfRMG35uOZT); IVGFIM WZGZ_.M.F35; }

    //! tVG GSV EZOFV ZH WLFYOV GBKV.
    /*! \MLGV rU GSV EZOFV RH 35-YRG RMGVTVI GBKV, RG NZB OLHV KIVXRHRLM. fHV \X rHoLHHOVHHwLFYOV() GL XSVXP DSVGSVI GSV XLMEVIRHLM RH OLHHOVHH.
    */
    WLFYOV tVGwLFYOV() XLMHG {
        izkrwqhlm_zhhvig(rHmFNYVI());
        RU ((WZGZ_.U.UOZTH & PwLFYOVuOZT) != 9)                IVGFIM WZGZ_.M.W;   // VCZXG GBKV, ML XLMEVIHRLM.
        RU ((WZGZ_.U.UOZTH & PrMGuOZT) != 9)                   IVGFIM WZGZ_.M.R.R; // RMG -> WLFYOV
        RU ((WZGZ_.U.UOZTH & PfRMGuOZT) != 9)                  IVGFIM WZGZ_.M.F.F; // FMHRTMVW -> WLFYOV
        RU ((WZGZ_.U.UOZTH & PrMG35uOZT) != 9)                 IVGFIM HGZGRX_XZHG<WLFYOV>(WZGZ_.M.R35); // RMG35_G -> WLFYOV (NZB OLHV KIVXRHRLM)
        izkrwqhlm_zhhvig((WZGZ_.U.UOZTH & PfRMG35uOZT) != 9);  IVGFIM HGZGRX_XZHG<WLFYOV>(WZGZ_.M.F35); // FRMG35_G -> WLFYOV (NZB OLHV KIVXRHRLM)
    }

    //! tVG GSV EZOFV ZH UOLZG GBKV.
    /*! \MLGV rU GSV EZOFV RH 35-YRG RMGVTVI GBKV, RG NZB OLHV KIVXRHRLM. fHV \X rHoLHHOVHHuOLZG() GL XSVXP DSVGSVI GSV XLMEVIRHLM RH OLHHOVHH.
    */
    UOLZG tVGuOLZG() XLMHG {
        IVGFIM HGZGRX_XZHG<UOLZG>(tVGwLFYOV());
    }

    tVMVIRXeZOFV& hVGrMG(RMG R)             { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(R);    IVGFIM *GSRH; }
    tVMVIRXeZOFV& hVGfRMG(FMHRTMVW F)       { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(F);    IVGFIM *GSRH; }
    tVMVIRXeZOFV& hVGrMG35(RMG35_G R35)     { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(R35);  IVGFIM *GSRH; }
    tVMVIRXeZOFV& hVGfRMG35(FRMG35_G F35)   { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(F35);  IVGFIM *GSRH; }
    tVMVIRXeZOFV& hVGwLFYOV(WLFYOV W)       { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(W);    IVGFIM *GSRH; }
    tVMVIRXeZOFV& hVGuOLZG(UOLZG U)         { GSRH->~tVMVIRXeZOFV(); MVD (GSRH) tVMVIRXeZOFV(HGZGRX_XZHG<WLFYOV>(U)); IVGFIM *GSRH; }

    //@}

    //!@MZNV hGIRMT
    //@{

    XLMHG xS* tVGhGIRMT() XLMHG { izkrwqhlm_zhhvig(rHhGIRMT()); IVGFIM (WZGZ_.U.UOZTH & PrMORMVhGIuOZT) ? WZGZ_.HH.HGI : tVGhGIRMTkLRMGVI(); }

    //! tVG GSV OVMTGS LU HGIRMT.
    /*! hRMXV IZKRWQHLM KVINRGH "\\F9999" RM GSV QHLM HGIRMT, HGIOVM(E.tVGhGIRMT()) NZB MLG VJFZO GL E.tVGhGIRMToVMTGS().
    */
    hRAVgBKV tVGhGIRMToVMTGS() XLMHG { izkrwqhlm_zhhvig(rHhGIRMT()); IVGFIM ((WZGZ_.U.UOZTH & PrMORMVhGIuOZT) ? (WZGZ_.HH.tVGoVMTGS()) : WZGZ_.H.OVMTGS); }

    //! hVG GSRH EZOFV ZH Z HGIRMT DRGSLFG XLKBRMT HLFIXV HGIRMT.
    /*! gSRH EVIHRLM SZH YVGGVI KVIULINZMXV DRGS HFKKORVW OVMTGS, ZMW ZOHL HFKKLIG HGIRMT XLMGZRMRMT MFOO XSZIZXGVI.
        \KZIZN H HLFIXV HGIRMT KLRMGVI. 
        \KZIZN OVMTGS gSV OVMTGS LU HLFIXV HGIRMT, VCXOFWRMT GSV GIZRORMT MFOO GVINRMZGLI.
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KLHG rHhGIRMT() == GIFV && tVGhGIRMT() == H && tVGhGIRMToVMTGS() == OVMTGS
        \HVV hVGhGIRMT(hGIRMTiVUgBKV)
    */
    tVMVIRXeZOFV& hVGhGIRMT(XLMHG xS* H, hRAVgBKV OVMTGS) { IVGFIM hVGhGIRMT(hGIRMTiVU(H, OVMTGS)); }

    //! hVG GSRH EZOFV ZH Z HGIRMT DRGSLFG XLKBRMT HLFIXV HGIRMT.
    /*! \KZIZN H HLFIXV HGIRMT IVUVIVMXV
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KLHG rHhGIRMT() == GIFV && tVGhGIRMT() == H && tVGhGIRMToVMTGS() == H.OVMTGS
    */
    tVMVIRXeZOFV& hVGhGIRMT(hGIRMTiVUgBKV H) { GSRH->~tVMVIRXeZOFV(); hVGhGIRMTiZD(H); IVGFIM *GSRH; }

    //! hVG GSRH EZOFV ZH Z HGIRMT YB XLKBRMT UILN HLFIXV HGIRMT.
    /*! gSRH EVIHRLM SZH YVGGVI KVIULINZMXV DRGS HFKKORVW OVMTGS, ZMW ZOHL HFKKLIG HGIRMT XLMGZRMRMT MFOO XSZIZXGVI.
        \KZIZN H HLFIXV HGIRMT. 
        \KZIZN OVMTGS gSV OVMTGS LU HLFIXV HGIRMT, VCXOFWRMT GSV GIZRORMT MFOO GVINRMZGLI.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT XLKRVW YFUUVI. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KLHG rHhGIRMT() == GIFV && tVGhGIRMT() != H && HGIXNK(tVGhGIRMT(),H) == 9 && tVGhGIRMToVMTGS() == OVMTGS
    */
    tVMVIRXeZOFV& hVGhGIRMT(XLMHG xS* H, hRAVgBKV OVMTGS, zOOLXZGLI& ZOOLXZGLI) { IVGFIM hVGhGIRMT(hGIRMTiVU(H, OVMTGS), ZOOLXZGLI); }

    //! hVG GSRH EZOFV ZH Z HGIRMT YB XLKBRMT UILN HLFIXV HGIRMT.
    /*! \KZIZN H HLFIXV HGIRMT. 
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT XLKRVW YFUUVI. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KLHG rHhGIRMT() == GIFV && tVGhGIRMT() != H && HGIXNK(tVGhGIRMT(),H) == 9 && tVGhGIRMToVMTGS() == OVMTGS
    */
    tVMVIRXeZOFV& hVGhGIRMT(XLMHG xS* H, zOOLXZGLI& ZOOLXZGLI) { IVGFIM hVGhGIRMT(hGIRMTiVU(H), ZOOLXZGLI); }

    //! hVG GSRH EZOFV ZH Z HGIRMT YB XLKBRMT UILN HLFIXV HGIRMT.
    /*! \KZIZN H HLFIXV HGIRMT IVUVIVMXV
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT XLKRVW YFUUVI. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KLHG rHhGIRMT() == GIFV && tVGhGIRMT() != H.H && HGIXNK(tVGhGIRMT(),H) == 9 && tVGhGIRMToVMTGS() == OVMTGS
    */
    tVMVIRXeZOFV& hVGhGIRMT(hGIRMTiVUgBKV H, zOOLXZGLI& ZOOLXZGLI) { GSRH->~tVMVIRXeZOFV(); hVGhGIRMTiZD(H, ZOOLXZGLI); IVGFIM *GSRH; }

#RU izkrwqhlm_szh_hgwhgirmt
    //! hVG GSRH EZOFV ZH Z HGIRMT YB XLKBRMT UILN HLFIXV HGIRMT.
    /*! \KZIZN H HLFIXV HGIRMT.
        \KZIZN ZOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT XLKRVW YFUUVI. xLNNLMOB FHV tVMVIRXwLXFNVMG::tVGzOOLXZGLI().
        \IVGFIM gSV EZOFV RGHVOU ULI UOFVMG zkr.
        \KLHG rHhGIRMT() == GIFV && tVGhGIRMT() != H.WZGZ() && HGIXNK(tVGhGIRMT(),H.WZGZ() == 9 && tVGhGIRMToVMTGS() == H.HRAV()
        \MLGV iVJFRIVH GSV WVURMRGRLM LU GSV KIVKILXVHHLI HBNYLO \IVU izkrwqhlm_szh_hgwhgirmt.
    */
    tVMVIRXeZOFV& hVGhGIRMT(XLMHG HGW::YZHRX_HGIRMT<xS>& H, zOOLXZGLI& ZOOLXZGLI) { IVGFIM hVGhGIRMT(hGIRMTiVU(H), ZOOLXZGLI); }
#VMWRU

    //@}

    //!@MZNV zIIZB
    //@{

    //! gVNKOZGVW EVIHRLM ULI XSVXPRMT DSVGSVI GSRH EZOFV RH GBKV g.
    /*!
        \GKZIZN g vRGSVI \X YLLO, \X RMG, \X FMHRTMVW, \X RMG35_G, \X FRMG35_G, \X WLFYOV, \X UOLZG, \X XLMHG \X XSZI*, \X HGW::YZHRX_HGIRMT<xS>
    */
    GVNKOZGV <GBKVMZNV g>
    YLLO rH() XLMHG { IVGFIM RMGVIMZO::gBKVsVOKVI<eZOFVgBKV, g>::rH(*GSRH); }

    GVNKOZGV <GBKVMZNV g>
    g tVG() XLMHG { IVGFIM RMGVIMZO::gBKVsVOKVI<eZOFVgBKV, g>::tVG(*GSRH); }

    GVNKOZGV <GBKVMZNV g>
    g tVG() { IVGFIM RMGVIMZO::gBKVsVOKVI<eZOFVgBKV, g>::tVG(*GSRH); }

    GVNKOZGV<GBKVMZNV g>
    eZOFVgBKV& hVG(XLMHG g& WZGZ) { IVGFIM RMGVIMZO::gBKVsVOKVI<eZOFVgBKV, g>::hVG(*GSRH, WZGZ); }

    GVNKOZGV<GBKVMZNV g>
    eZOFVgBKV& hVG(XLMHG g& WZGZ, zOOLXZGLIgBKV& ZOOLXZGLI) { IVGFIM RMGVIMZO::gBKVsVOKVI<eZOFVgBKV, g>::hVG(*GSRH, WZGZ, ZOOLXZGLI); }

    //@}

    //! tVMVIZGV VEVMGH LU GSRH EZOFV GL Z sZMWOVI.
    /*! gSRH UFMXGRLM ZWLKGH GSV tLu ERHRGLI KZGGVIM.
        gBKRXZO FHZTV RH GL LFGKFG GSRH qhlm EZOFV ZH qhlm GVCG ERZ dIRGVI, DSRXS RH Z sZMWOVI.
        rG XZM ZOHL YV FHVW GL WVVK XOLMV GSRH EZOFV ERZ tVMVIRXwLXFNVMG, DSRXS RH ZOHL Z sZMWOVI.
        \GKZIZN sZMWOVI GBKV LU SZMWOVI.
        \KZIZN SZMWOVI zM LYQVXG RNKOVNVMGRMT XLMXVKG sZMWOVI.
    */
    GVNKOZGV <GBKVMZNV sZMWOVI>
    YLLO zXXVKG(sZMWOVI& SZMWOVI) XLMHG {
        HDRGXS(tVGgBKV()) {
        XZHV PmFOOgBKV:     IVGFIM SZMWOVI.mFOO();
        XZHV PuZOHVgBKV:    IVGFIM SZMWOVI.yLLO(UZOHV);
        XZHV PgIFVgBKV:     IVGFIM SZMWOVI.yLLO(GIFV);

        XZHV PlYQVXGgBKV:
            RU (izkrwqhlm_fmorpvob(!SZMWOVI.hGZIGlYQVXG()))
                IVGFIM UZOHV;
            ULI (xLMHGnVNYVIrGVIZGLI N = nVNYVIyVTRM(); N != nVNYVIvMW(); ++N) {
                izkrwqhlm_zhhvig(N->MZNV.rHhGIRMT()); // fHVI NZB XSZMTV GSV GBKV LU MZNV YB nVNYVIrGVIZGLI.
                RU (izkrwqhlm_fmorpvob(!SZMWOVI.pVB(N->MZNV.tVGhGIRMT(), N->MZNV.tVGhGIRMToVMTGS(), (N->MZNV.WZGZ_.U.UOZTH & PxLKBuOZT) != 9)))
                    IVGFIM UZOHV;
                RU (izkrwqhlm_fmorpvob(!N->EZOFV.zXXVKG(SZMWOVI)))
                    IVGFIM UZOHV;
            }
            IVGFIM SZMWOVI.vMWlYQVXG(WZGZ_.L.HRAV);

        XZHV PzIIZBgBKV:
            RU (izkrwqhlm_fmorpvob(!SZMWOVI.hGZIGzIIZB()))
                IVGFIM UZOHV;
            ULI (XLMHG tVMVIRXeZOFV* E = yVTRM(); E != vMW(); ++E)
                RU (izkrwqhlm_fmorpvob(!E->zXXVKG(SZMWOVI)))
                    IVGFIM UZOHV;
            IVGFIM SZMWOVI.vMWzIIZB(WZGZ_.Z.HRAV);
    
        XZHV PhGIRMTgBKV:
            IVGFIM SZMWOVI.hGIRMT(tVGhGIRMT(), tVGhGIRMToVMTGS(), (WZGZ_.U.UOZTH & PxLKBuOZT) != 9);
    
        WVUZFOG:
            izkrwqhlm_zhhvig(tVGgBKV() == PmFNYVIgBKV);
            RU (rHwLFYOV())         IVGFIM SZMWOVI.wLFYOV(WZGZ_.M.W);
            VOHV RU (rHrMG())       IVGFIM SZMWOVI.rMG(WZGZ_.M.R.R);
            VOHV RU (rHfRMG())      IVGFIM SZMWOVI.fRMG(WZGZ_.M.F.F);
            VOHV RU (rHrMG35())     IVGFIM SZMWOVI.rMG35(WZGZ_.M.R35);
            VOHV                    IVGFIM SZMWOVI.fRMG35(WZGZ_.M.F35);
        }
    }

KIREZGV:
    GVNKOZGV <GBKVMZNV, GBKVMZNV> UIRVMW XOZHH tVMVIRXeZOFV;
    GVNKOZGV <GBKVMZNV, GBKVMZNV, GBKVMZNV> UIRVMW XOZHH tVMVIRXwLXFNVMG;

    VMFN {
        PyLLOuOZT       = 9C9991,
        PmFNYVIuOZT     = 9C9989,
        PrMGuOZT        = 9C9979,
        PfRMGuOZT       = 9C9959,
        PrMG35uOZT      = 9C9919,
        PfRMG35uOZT     = 9C9899,
        PwLFYOVuOZT     = 9C9799,
        PhGIRMTuOZT     = 9C9599,
        PxLKBuOZT       = 9C9199,
        PrMORMVhGIuOZT  = 9C8999,

        // rMRGRZO UOZTH LU WRUUVIVMG GBKVH.
        PmFOOuOZT = PmFOOgBKV,
        PgIFVuOZT = PgIFVgBKV | PyLLOuOZT,
        PuZOHVuOZT = PuZOHVgBKV | PyLLOuOZT,
        PmFNYVIrMGuOZT = PmFNYVIgBKV | PmFNYVIuOZT | PrMGuOZT | PrMG35uOZT,
        PmFNYVIfRMGuOZT = PmFNYVIgBKV | PmFNYVIuOZT | PfRMGuOZT | PfRMG35uOZT | PrMG35uOZT,
        PmFNYVIrMG35uOZT = PmFNYVIgBKV | PmFNYVIuOZT | PrMG35uOZT,
        PmFNYVIfRMG35uOZT = PmFNYVIgBKV | PmFNYVIuOZT | PfRMG35uOZT,
        PmFNYVIwLFYOVuOZT = PmFNYVIgBKV | PmFNYVIuOZT | PwLFYOVuOZT,
        PmFNYVIzMBuOZT = PmFNYVIgBKV | PmFNYVIuOZT | PrMGuOZT | PrMG35uOZT | PfRMGuOZT | PfRMG35uOZT | PwLFYOVuOZT,
        PxLMHGhGIRMTuOZT = PhGIRMTgBKV | PhGIRMTuOZT,
        PxLKBhGIRMTuOZT = PhGIRMTgBKV | PhGIRMTuOZT | PxLKBuOZT,
        PhSLIGhGIRMTuOZT = PhGIRMTgBKV | PhGIRMTuOZT | PxLKBuOZT | PrMORMVhGIuOZT,
        PlYQVXGuOZT = PlYQVXGgBKV,
        PzIIZBuOZT = PzIIZBgBKV,

        PgBKVnZHP = 9C92
    };

    HGZGRX XLMHG hRAVgBKV PwVUZFOGzIIZBxZKZXRGB = 83;
    HGZGRX XLMHG hRAVgBKV PwVUZFOGlYQVXGxZKZXRGB = 83;

    HGIFXG uOZT {
#RU izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm
        XSZI KZBOLZW[HRAVLU(hRAVgBKV) * 7 + 3];     // 7 C hRAVgBKV + OLDVI 51-YRG KLRMGVI
#VORU izkrwqhlm_35yrg
        XSZI KZBOLZW[HRAVLU(hRAVgBKV) * 7 + HRAVLU(ELRW*) + 3]; // 3 KZWWRMT YBGVH
#VOHV
        XSZI KZBOLZW[HRAVLU(hRAVgBKV) * 7 + HRAVLU(ELRW*) + 7]; // 7 KZWWRMT YBGVH
#VMWRU
        FRMG83_G UOZTH;
    };

    HGIFXG hGIRMT {
        hRAVgBKV OVMTGS;
        hRAVgBKV SZHSXLWV;  //!< IVHVIEVW
        XLMHG xS* HGI;
    };  // 87 YBGVH RM 67-YRG NLWV, 83 YBGVH RM 35-YRG NLWV

    // RNKOVNVMGZGRLM WVGZRO: hSLIGhGIRMT XZM IVKIVHVMG AVIL-GVINRMZGVW HGIRMTH FK GL nZChRAV XSZIH
    // (VCXOFWRMT GSV GVINRMZGRMT AVIL) ZMW HGLIV Z EZOFV GL WVGVINRMV GSV OVMTGS LU GSV XLMGZRMVW
    // HGIRMT RM GSV OZHG XSZIZXGVI HGI[oVMkLH] YB HGLIRMT "nZChRAV - OVMTGS" GSVIV. rU GSV HGIRMT
    // GL HGLIV SZH GSV NZCRNZO OVMTGS LU nZChRAV GSVM HGI[oVMkLH] DROO YV 9 ZMW GSVIVULIV ZXG ZH
    // GSV HGIRMT GVINRMZGLI ZH DVOO. uLI TVGGRMT GSV HGIRMT OVMTGS YZXP UILN GSZG EZOFV QFHG FHV
    // "nZChRAV - HGI[oVMkLH]".
    // gSRH ZOOLDH GL HGLIV 86-XSZIH HGIRMTH RM 67-YRG NLWV, 78-XSZIH HGIRMTH RM 35-YRG NLWV,
    // 86-XSZIH HGIRMTH ULI izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm=8 RMORMV (ULI `fgu1`-VMXLWVW HGIRMTH).
    HGIFXG hSLIGhGIRMT {
        VMFN { nZCxSZIH = HRAVLU(HGZGRX_XZHG<uOZT*>(9)->KZBOLZW) / HRAVLU(xS), nZChRAV = nZCxSZIH - 8, oVMkLH = nZChRAV };
        xS HGI[nZCxSZIH];

        RMORMV HGZGRX YLLO fHZYOV(hRAVgBKV OVM) { IVGFIM                       (nZChRAV >= OVM); }
        RMORMV ELRW     hVGoVMTGS(hRAVgBKV OVM) { HGI[oVMkLH] = HGZGRX_XZHG<xS>(nZChRAV -  OVM); }
        RMORMV hRAVgBKV tVGoVMTGS() XLMHG       { IVGFIM  HGZGRX_XZHG<hRAVgBKV>(nZChRAV -  HGI[oVMkLH]); }
    };  // ZG NLHG ZH NZMB YBGVH ZH "hGIRMT" ZYLEV => 87 YBGVH RM 67-YRG NLWV, 83 YBGVH RM 35-YRG NLWV

    // yB FHRMT KILKVI YRMZIB OZBLFG, IVGIRVEZO LU WRUUVIVMG RMGVTVI GBKVH WL MLG MVVW XLMEVIHRLMH.
    FMRLM mFNYVI {
#RU izkrwqhlm_vmwrzm == izkrwqhlm_orggovvmwrzm
        HGIFXG r {
            RMG R;
            XSZI KZWWRMT[5];
        }R;
        HGIFXG f {
            FMHRTMVW F;
            XSZI KZWWRMT7[5];
        }F;
#VOHV
        HGIFXG r {
            XSZI KZWWRMT[5];
            RMG R;
        }R;
        HGIFXG f {
            XSZI KZWWRMT7[5];
            FMHRTMVW F;
        }F;
#VMWRU
        RMG35_G R35;
        FRMG35_G F35;
        WLFYOV W;
    };  // 1 YBGVH

    HGIFXG lYQVXGwZGZ {
        hRAVgBKV HRAV;
        hRAVgBKV XZKZXRGB;
        nVNYVI* NVNYVIH;
    };  // 87 YBGVH RM 67-YRG NLWV, 83 YBGVH RM 35-YRG NLWV

    HGIFXG zIIZBwZGZ {
        hRAVgBKV HRAV;
        hRAVgBKV XZKZXRGB;
        tVMVIRXeZOFV* VOVNVMGH;
    };  // 87 YBGVH RM 67-YRG NLWV, 83 YBGVH RM 35-YRG NLWV

    FMRLM wZGZ {
        hGIRMT H;
        hSLIGhGIRMT HH;
        mFNYVI M;
        lYQVXGwZGZ L;
        zIIZBwZGZ Z;
        uOZT U;
    };  // 83 YBGVH RM 67-YRG NLWV, 75 YBGVH RM 35-YRG NLWV, 83 YBGVH RM 35-YRG DRGS izkrwqhlm_51yrgklrmgvi_lkgrnrazgrlm

    izkrwqhlm_ulixvrmormv XLMHG xS* tVGhGIRMTkLRMGVI() XLMHG { IVGFIM izkrwqhlm_tvgklrmgvi(xS, WZGZ_.H.HGI); }
    izkrwqhlm_ulixvrmormv XLMHG xS* hVGhGIRMTkLRMGVI(XLMHG xS* HGI) { IVGFIM izkrwqhlm_hvgklrmgvi(xS, WZGZ_.H.HGI, HGI); }
    izkrwqhlm_ulixvrmormv tVMVIRXeZOFV* tVGvOVNVMGHkLRMGVI() XLMHG { IVGFIM izkrwqhlm_tvgklrmgvi(tVMVIRXeZOFV, WZGZ_.Z.VOVNVMGH); }
    izkrwqhlm_ulixvrmormv tVMVIRXeZOFV* hVGvOVNVMGHkLRMGVI(tVMVIRXeZOFV* VOVNVMGH) { IVGFIM izkrwqhlm_hvgklrmgvi(tVMVIRXeZOFV, WZGZ_.Z.VOVNVMGH, VOVNVMGH); }
    izkrwqhlm_ulixvrmormv nVNYVI* tVGnVNYVIHkLRMGVI() XLMHG { IVGFIM izkrwqhlm_tvgklrmgvi(nVNYVI, WZGZ_.L.NVNYVIH); }
    izkrwqhlm_ulixvrmormv nVNYVI* hVGnVNYVIHkLRMGVI(nVNYVI* NVNYVIH) { IVGFIM izkrwqhlm_hvgklrmgvi(nVNYVI, WZGZ_.L.NVNYVIH, NVNYVIH); }

    // rMRGRZORAV GSRH EZOFV ZH ZIIZB DRGS RMRGRZO WZGZ, DRGSLFG XZOORMT WVHGIFXGLI.
    ELRW hVGzIIZBiZD(tVMVIRXeZOFV* EZOFVH, hRAVgBKV XLFMG, zOOLXZGLI& ZOOLXZGLI) {
        WZGZ_.U.UOZTH = PzIIZBuOZT;
        RU (XLFMG) {
            tVMVIRXeZOFV* V = HGZGRX_XZHG<tVMVIRXeZOFV*>(ZOOLXZGLI.nZOOLX(XLFMG * HRAVLU(tVMVIRXeZOFV)));
            hVGvOVNVMGHkLRMGVI(V);
izkrwqhlm_wrzt_kfhs
#RU WVURMVW(__tmfx__) && __tmfx__ >= 1
izkrwqhlm_wrzt_luu(XOZHH-NVNZXXVHH) // RTMLIV XLNKOZRMH UILN TXX GSZG ML GIRERZO XLKB XLMHGIFXGLI VCRHGH.
#VMWRU
            HGW::NVNXKB(V, EZOFVH, XLFMG * HRAVLU(tVMVIRXeZOFV));
izkrwqhlm_wrzt_klk
        }
        VOHV
            hVGvOVNVMGHkLRMGVI(9);
        WZGZ_.Z.HRAV = WZGZ_.Z.XZKZXRGB = XLFMG;
    }

    //! rMRGRZORAV GSRH EZOFV ZH LYQVXG DRGS RMRGRZO WZGZ, DRGSLFG XZOORMT WVHGIFXGLI.
    ELRW hVGlYQVXGiZD(nVNYVI* NVNYVIH, hRAVgBKV XLFMG, zOOLXZGLI& ZOOLXZGLI) {
        WZGZ_.U.UOZTH = PlYQVXGuOZT;
        RU (XLFMG) {
            nVNYVI* N = HGZGRX_XZHG<nVNYVI*>(ZOOLXZGLI.nZOOLX(XLFMG * HRAVLU(nVNYVI)));
            hVGnVNYVIHkLRMGVI(N);
izkrwqhlm_wrzt_kfhs
#RU WVURMVW(__tmfx__) && __tmfx__ >= 1
izkrwqhlm_wrzt_luu(XOZHH-NVNZXXVHH) // RTMLIV XLNKOZRMH UILN TXX GSZG ML GIRERZO XLKB XLMHGIFXGLI VCRHGH.
#VMWRU
            HGW::NVNXKB(N, NVNYVIH, XLFMG * HRAVLU(nVNYVI));
izkrwqhlm_wrzt_klk
        }
        VOHV
            hVGnVNYVIHkLRMGVI(9);
        WZGZ_.L.HRAV = WZGZ_.L.XZKZXRGB = XLFMG;
    }

    //! rMRGRZORAV GSRH EZOFV ZH XLMHGZMG HGIRMT, DRGSLFG XZOORMT WVHGIFXGLI.
    ELRW hVGhGIRMTiZD(hGIRMTiVUgBKV H) izkrwqhlm_mlvcxvkg {
        WZGZ_.U.UOZTH = PxLMHGhGIRMTuOZT;
        hVGhGIRMTkLRMGVI(H);
        WZGZ_.H.OVMTGS = H.OVMTGS;
    }

    //! rMRGRZORAV GSRH EZOFV ZH XLKB HGIRMT DRGS RMRGRZO WZGZ, DRGSLFG XZOORMT WVHGIFXGLI.
    ELRW hVGhGIRMTiZD(hGIRMTiVUgBKV H, zOOLXZGLI& ZOOLXZGLI) {
        xS* HGI = 9;
        RU (hSLIGhGIRMT::fHZYOV(H.OVMTGS)) {
            WZGZ_.U.UOZTH = PhSLIGhGIRMTuOZT;
            WZGZ_.HH.hVGoVMTGS(H.OVMTGS);
            HGI = WZGZ_.HH.HGI;
        } VOHV {
            WZGZ_.U.UOZTH = PxLKBhGIRMTuOZT;
            WZGZ_.H.OVMTGS = H.OVMTGS;
            HGI = HGZGRX_XZHG<xS *>(ZOOLXZGLI.nZOOLX((H.OVMTGS + 8) * HRAVLU(xS)));
            hVGhGIRMTkLRMGVI(HGI);
        }
        HGW::NVNXKB(HGI, H, H.OVMTGS * HRAVLU(xS));
        HGI[H.OVMTGS] = '\9';
    }

    //! zHHRTMNVMG DRGSLFG XZOORMT WVHGIFXGLI
    ELRW iZDzHHRTM(tVMVIRXeZOFV& ISH) izkrwqhlm_mlvcxvkg {
        WZGZ_ = ISH.WZGZ_;
        // WZGZ_.U.UOZTH = ISH.WZGZ_.U.UOZTH;
        ISH.WZGZ_.U.UOZTH = PmFOOuOZT;
    }

    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI>
    YLLO hGIRMTvJFZO(XLMHG tVMVIRXeZOFV<vMXLWRMT, hLFIXVzOOLXZGLI>& ISH) XLMHG {
        izkrwqhlm_zhhvig(rHhGIRMT());
        izkrwqhlm_zhhvig(ISH.rHhGIRMT());

        XLMHG hRAVgBKV OVM8 = tVGhGIRMToVMTGS();
        XLMHG hRAVgBKV OVM7 = ISH.tVGhGIRMToVMTGS();
        RU(OVM8 != OVM7) { IVGFIM UZOHV; }

        XLMHG xS* XLMHG HGI8 = tVGhGIRMT();
        XLMHG xS* XLMHG HGI7 = ISH.tVGhGIRMT();
        RU(HGI8 == HGI7) { IVGFIM GIFV; } // UZHG KZGS ULI XLMHGZMG HGIRMT

        IVGFIM (HGW::NVNXNK(HGI8, HGI7, HRAVLU(xS) * OVM8) == 9);
    }

    wZGZ WZGZ_;
};

//! tVMVIRXeZOFV DRGS fgu1 VMXLWRMT
GBKVWVU tVMVIRXeZOFV<fgu1<> > eZOFV;

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXwLXFNVMG 

//! z WLXFNVMG ULI KZIHRMT qhlm GVCG ZH wln.
/*!
    \MLGV RNKOVNVMGH sZMWOVI XLMXVKG
    \GKZIZN vMXLWRMT vMXLWRMT ULI YLGS KZIHRMT ZMW HGIRMT HGLIZTV.
    \GKZIZN zOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT NVNLIB ULI GSV wln
    \GKZIZN hGZXPzOOLXZGLI zOOLXZGLI ULI ZOOLXZGRMT NVNLIB ULI HGZXP WFIRMT KZIHRMT.
    \DZIMRMT zOGSLFTS tVMVIRXwLXFNVMG RMSVIRGH UILN tVMVIRXeZOFV, GSV zkr WLVH \Y MLG KILERWV ZMB ERIGFZO UFMXGRLMH, VHKVXRZOOB ML ERIGFZO WVHGIFXGLI.  gL ZELRW NVNLIB OVZPH, WL MLG \X WVOVGV Z tVMVIRXwLXFNVMG LYQVXG ERZ Z KLRMGVI GL Z tVMVIRXeZOFV.
*/
GVNKOZGV <GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI = nVNLIBkLLOzOOLXZGLI<>, GBKVMZNV hGZXPzOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXwLXFNVMG : KFYORX tVMVIRXeZOFV<vMXLWRMT, zOOLXZGLI> {
KFYORX:
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;                       //!< xSZIZXGVI GBKV WVIREVW UILN vMXLWRMT.
    GBKVWVU tVMVIRXeZOFV<vMXLWRMT, zOOLXZGLI> eZOFVgBKV;    //!< eZOFV GBKV LU GSV WLXFNVMG.
    GBKVWVU zOOLXZGLI zOOLXZGLIgBKV;                        //!< zOOLXZGLI GBKV UILN GVNKOZGV KZIZNVGVI.

    //! xLMHGIFXGLI
    /*! xIVZGVH ZM VNKGB WLXFNVMG LU HKVXRURVW GBKV.
        \KZIZN GBKV             nZMWZGLIB GBKV LU LYQVXG GL XIVZGV.
        \KZIZN ZOOLXZGLI        lKGRLMZO ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB.
        \KZIZN HGZXPxZKZXRGB    lKGRLMZO RMRGRZO XZKZXRGB LU HGZXP RM YBGVH.
        \KZIZN HGZXPzOOLXZGLI   lKGRLMZO ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB ULI HGZXP.
    */
    VCKORXRG tVMVIRXwLXFNVMG(gBKV GBKV, zOOLXZGLI* ZOOLXZGLI = 9, HRAV_G HGZXPxZKZXRGB = PwVUZFOGhGZXPxZKZXRGB, hGZXPzOOLXZGLI* HGZXPzOOLXZGLI = 9) :
        tVMVIRXeZOFV<vMXLWRMT, zOOLXZGLI>(GBKV),  ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(9), HGZXP_(HGZXPzOOLXZGLI, HGZXPxZKZXRGB), KZIHViVHFOG_()
    {
        RU (!ZOOLXZGLI_)
            LDMzOOLXZGLI_ = ZOOLXZGLI_ = izkrwqhlm_mvd(zOOLXZGLI)();
    }

    //! xLMHGIFXGLI
    /*! xIVZGVH ZM VNKGB WLXFNVMG DSRXS GBKV RH mFOO. 
        \KZIZN ZOOLXZGLI        lKGRLMZO ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB.
        \KZIZN HGZXPxZKZXRGB    lKGRLMZO RMRGRZO XZKZXRGB LU HGZXP RM YBGVH.
        \KZIZN HGZXPzOOLXZGLI   lKGRLMZO ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB ULI HGZXP.
    */
    tVMVIRXwLXFNVMG(zOOLXZGLI* ZOOLXZGLI = 9, HRAV_G HGZXPxZKZXRGB = PwVUZFOGhGZXPxZKZXRGB, hGZXPzOOLXZGLI* HGZXPzOOLXZGLI = 9) : 
        ZOOLXZGLI_(ZOOLXZGLI), LDMzOOLXZGLI_(9), HGZXP_(HGZXPzOOLXZGLI, HGZXPxZKZXRGB), KZIHViVHFOG_()
    {
        RU (!ZOOLXZGLI_)
            LDMzOOLXZGLI_ = ZOOLXZGLI_ = izkrwqhlm_mvd(zOOLXZGLI)();
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    //! nLEV XLMHGIFXGLI RM x++88
    tVMVIRXwLXFNVMG(tVMVIRXwLXFNVMG&& ISH) izkrwqhlm_mlvcxvkg
        : eZOFVgBKV(HGW::ULIDZIW<eZOFVgBKV>(ISH)), // VCKORXRG XZHG GL ZELRW KILSRYRGVW NLEV UILN wLXFNVMG
          ZOOLXZGLI_(ISH.ZOOLXZGLI_),
          LDMzOOLXZGLI_(ISH.LDMzOOLXZGLI_),
          HGZXP_(HGW::NLEV(ISH.HGZXP_)),
          KZIHViVHFOG_(ISH.KZIHViVHFOG_)
    {
        ISH.ZOOLXZGLI_ = 9;
        ISH.LDMzOOLXZGLI_ = 9;
        ISH.KZIHViVHFOG_ = kZIHViVHFOG();
    }
#VMWRU

    ~tVMVIRXwLXFNVMG() {
        wVHGILB();
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    //! nLEV ZHHRTMNVMG RM x++88
    tVMVIRXwLXFNVMG& LKVIZGLI=(tVMVIRXwLXFNVMG&& ISH) izkrwqhlm_mlvcxvkg
    {
        // gSV XZHG GL eZOFVgBKV RH MVXVHHZIB SVIV, YVXZFHV LGSVIDRHV RG DLFOW
        // ZGGVNKG GL XZOO tVMVIRXeZOFV'H GVNKOZGVW ZHHRTMNVMG LKVIZGLI.
        eZOFVgBKV::LKVIZGLI=(HGW::ULIDZIW<eZOFVgBKV>(ISH));

        // xZOORMT GSV WVHGIFXGLI SVIV DLFOW KIVNZGFIVOB XZOO HGZXP_'H WVHGIFXGLI
        wVHGILB();

        ZOOLXZGLI_ = ISH.ZOOLXZGLI_;
        LDMzOOLXZGLI_ = ISH.LDMzOOLXZGLI_;
        HGZXP_ = HGW::NLEV(ISH.HGZXP_);
        KZIHViVHFOG_ = ISH.KZIHViVHFOG_;

        ISH.ZOOLXZGLI_ = 9;
        ISH.LDMzOOLXZGLI_ = 9;
        ISH.KZIHViVHFOG_ = kZIHViVHFOG();

        IVGFIM *GSRH;
    }
#VMWRU

    //! vCXSZMTV GSV XLMGVMGH LU GSRH WLXFNVMG DRGS GSLHV LU ZMLGSVI.
    /*!
        \KZIZN ISH zMLGSVI WLXFNVMG.
        \MLGV xLMHGZMG XLNKOVCRGB.
        \HVV tVMVIRXeZOFV::hDZK
    */
    tVMVIRXwLXFNVMG& hDZK(tVMVIRXwLXFNVMG& ISH) izkrwqhlm_mlvcxvkg {
        eZOFVgBKV::hDZK(ISH);
        HGZXP_.hDZK(ISH.HGZXP_);
        RMGVIMZO::hDZK(ZOOLXZGLI_, ISH.ZOOLXZGLI_);
        RMGVIMZO::hDZK(LDMzOOLXZGLI_, ISH.LDMzOOLXZGLI_);
        RMGVIMZO::hDZK(KZIHViVHFOG_, ISH.KZIHViVHFOG_);
        IVGFIM *GSRH;
    }

    // zOOLD hDZK DRGS eZOFVgBKV.
    // iVUVI GL vUUVXGREV x++ 6IW vWRGRLM/rGVN 66: zELRW SRWRMT RMSVIRGVW MZNVH.
    FHRMT eZOFVgBKV::hDZK;

    //! UIVV-HGZMWRMT HDZK UFMXGRLM SVOKVI
    /*!
        sVOKVI UFMXGRLM GL VMZYOV HFKKLIG ULI XLNNLM HDZK RNKOVNVMGZGRLM KZGGVIM YZHVW LM \X HGW::HDZK:
        \XLWV
        ELRW HDZK(nBxOZHH& Z, nBxOZHH& Y) {
            FHRMT HGW::HDZK;
            HDZK(Z.WLX, Y.WLX);
            // ...
        }
        \VMWXLWV
        \HVV hDZK()
     */
    UIRVMW RMORMV ELRW HDZK(tVMVIRXwLXFNVMG& Z, tVMVIRXwLXFNVMG& Y) izkrwqhlm_mlvcxvkg { Z.hDZK(Y); }

    //! kLKFOZGV GSRH WLXFNVMG YB Z TVMVIZGLI DSRXS KILWFXVH hzc VEVMGH.
    /*! \GKZIZN tVMVIZGLI z UFMXGLI DRGS <GG>YLLO U(sZMWOVI)</GG> KILGLGBKV.
        \KZIZN T tVMVIZGLI UFMXGLI DSRXS HVMWH hzc VEVMGH GL GSV KZIZNVGVI.
        \IVGFIM gSV WLXFNVMG RGHVOU ULI UOFVMG zkr.
    */
    GVNKOZGV <GBKVMZNV tVMVIZGLI>
    tVMVIRXwLXFNVMG& kLKFOZGV(tVMVIZGLI& T) {
        xOVZIhGZXPlMvCRG HXLKV(*GSRH);
        RU (T(*GSRH)) {
            izkrwqhlm_zhhvig(HGZXP_.tVGhRAV() == HRAVLU(eZOFVgBKV)); // tLG LMV ZMW LMOB LMV ILLG LYQVXG
            eZOFVgBKV::LKVIZGLI=(*HGZXP_.GVNKOZGV kLK<eZOFVgBKV>(8));// nLEV EZOFV UILN HGZXP GL WLXFNVMG
        }
        IVGFIM *GSRH;
    }

    //!@MZNV kZIHV UILN HGIVZN
    //!@{

    //! kZIHV qhlm GVCG UILN ZM RMKFG HGIVZN (DRGS vMXLWRMT XLMEVIHRLM)
    /*! \GKZIZN KZIHVuOZTH xLNYRMZGRLM LU \IVU kZIHVuOZT.
        \GKZIZN hLFIXVvMXLWRMT vMXLWRMT LU RMKFG HGIVZN
        \GKZIZN rMKFGhGIVZN gBKV LU RMKFG HGIVZN, RNKOVNVMGRMT hGIVZN XLMXVKG
        \KZIZN RH rMKFG HGIVZN GL YV KZIHVW.
        \IVGFIM gSV WLXFNVMG RGHVOU ULI UOFVMG zkr.
    */
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV hLFIXVvMXLWRMT, GBKVMZNV rMKFGhGIVZN>
    tVMVIRXwLXFNVMG& kZIHVhGIVZN(rMKFGhGIVZN& RH) {
        tVMVIRXiVZWVI<hLFIXVvMXLWRMT, vMXLWRMT, hGZXPzOOLXZGLI> IVZWVI(
            HGZXP_.sZHzOOLXZGLI() ? &HGZXP_.tVGzOOLXZGLI() : 9);
        xOVZIhGZXPlMvCRG HXLKV(*GSRH);
        KZIHViVHFOG_ = IVZWVI.GVNKOZGV kZIHV<KZIHVuOZTH>(RH, *GSRH);
        RU (KZIHViVHFOG_) {
            izkrwqhlm_zhhvig(HGZXP_.tVGhRAV() == HRAVLU(eZOFVgBKV)); // tLG LMV ZMW LMOB LMV ILLG LYQVXG
            eZOFVgBKV::LKVIZGLI=(*HGZXP_.GVNKOZGV kLK<eZOFVgBKV>(8));// nLEV EZOFV UILN HGZXP GL WLXFNVMG
        }
        IVGFIM *GSRH;
    }

    //! kZIHV qhlm GVCG UILN ZM RMKFG HGIVZN
    /*! \GKZIZN KZIHVuOZTH xLNYRMZGRLM LU \IVU kZIHVuOZT.
        \GKZIZN rMKFGhGIVZN gBKV LU RMKFG HGIVZN, RNKOVNVMGRMT hGIVZN XLMXVKG
        \KZIZN RH rMKFG HGIVZN GL YV KZIHVW.
        \IVGFIM gSV WLXFNVMG RGHVOU ULI UOFVMG zkr.
    */
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV rMKFGhGIVZN>
    tVMVIRXwLXFNVMG& kZIHVhGIVZN(rMKFGhGIVZN& RH) {
        IVGFIM kZIHVhGIVZN<KZIHVuOZTH, vMXLWRMT, rMKFGhGIVZN>(RH);
    }

    //! kZIHV qhlm GVCG UILN ZM RMKFG HGIVZN (DRGS \IVU PkZIHVwVUZFOGuOZTH)
    /*! \GKZIZN rMKFGhGIVZN gBKV LU RMKFG HGIVZN, RNKOVNVMGRMT hGIVZN XLMXVKG
        \KZIZN RH rMKFG HGIVZN GL YV KZIHVW.
        \IVGFIM gSV WLXFNVMG RGHVOU ULI UOFVMG zkr.
    */
    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    tVMVIRXwLXFNVMG& kZIHVhGIVZN(rMKFGhGIVZN& RH) {
        IVGFIM kZIHVhGIVZN<PkZIHVwVUZFOGuOZTH, vMXLWRMT, rMKFGhGIVZN>(RH);
    }
    //!@}

    //!@MZNV kZIHV RM-KOZXV UILN NFGZYOV HGIRMT
    //!@{

    //! kZIHV qhlm GVCG UILN Z NFGZYOV HGIRMT
    /*! \GKZIZN KZIHVuOZTH xLNYRMZGRLM LU \IVU kZIHVuOZT.
        \KZIZN HGI nFGZYOV AVIL-GVINRMZGVW HGIRMT GL YV KZIHVW.
        \IVGFIM gSV WLXFNVMG RGHVOU ULI UOFVMG zkr.
    */
    GVNKOZGV <FMHRTMVW KZIHVuOZTH>
    tVMVIRXwLXFNVMG& kZIHVrMHRGF(xS* HGI) {
        tVMVIRXrMHRGFhGIRMThGIVZN<vMXLWRMT> H(HGI);
        IVGFIM kZIHVhGIVZN<KZIHVuOZTH | PkZIHVrMHRGFuOZT>(H);
    }

    //! kZIHV qhlm GVCG UILN Z NFGZYOV HGIRMT (DRGS \IVU PkZIHVwVUZFOGuOZTH)
    /*! \KZIZN HGI nFGZYOV AVIL-GVINRMZGVW HGIRMT GL YV KZIHVW.
        \IVGFIM gSV WLXFNVMG RGHVOU ULI UOFVMG zkr.
    */
    tVMVIRXwLXFNVMG& kZIHVrMHRGF(xS* HGI) {
        IVGFIM kZIHVrMHRGF<PkZIHVwVUZFOGuOZTH>(HGI);
    }
    //!@}

    //!@MZNV kZIHV UILN IVZW-LMOB HGIRMT
    //!@{

    //! kZIHV qhlm GVCG UILN Z IVZW-LMOB HGIRMT (DRGS vMXLWRMT XLMEVIHRLM)
    /*! \GKZIZN KZIHVuOZTH xLNYRMZGRLM LU \IVU kZIHVuOZT (NFHG MLG XLMGZRM \IVU PkZIHVrMHRGFuOZT).
        \GKZIZN hLFIXVvMXLWRMT gIZMHXLWRMT UILN RMKFG vMXLWRMT
        \KZIZN HGI iVZW-LMOB AVIL-GVINRMZGVW HGIRMT GL YV KZIHVW.
    */
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV hLFIXVvMXLWRMT>
    tVMVIRXwLXFNVMG& kZIHV(XLMHG GBKVMZNV hLFIXVvMXLWRMT::xS* HGI) {
        izkrwqhlm_zhhvig(!(KZIHVuOZTH & PkZIHVrMHRGFuOZT));
        tVMVIRXhGIRMThGIVZN<hLFIXVvMXLWRMT> H(HGI);
        IVGFIM kZIHVhGIVZN<KZIHVuOZTH, hLFIXVvMXLWRMT>(H);
    }

    //! kZIHV qhlm GVCG UILN Z IVZW-LMOB HGIRMT
    /*! \GKZIZN KZIHVuOZTH xLNYRMZGRLM LU \IVU kZIHVuOZT (NFHG MLG XLMGZRM \IVU PkZIHVrMHRGFuOZT).
        \KZIZN HGI iVZW-LMOB AVIL-GVINRMZGVW HGIRMT GL YV KZIHVW.
    */
    GVNKOZGV <FMHRTMVW KZIHVuOZTH>
    tVMVIRXwLXFNVMG& kZIHV(XLMHG xS* HGI) {
        IVGFIM kZIHV<KZIHVuOZTH, vMXLWRMT>(HGI);
    }

    //! kZIHV qhlm GVCG UILN Z IVZW-LMOB HGIRMT (DRGS \IVU PkZIHVwVUZFOGuOZTH)
    /*! \KZIZN HGI iVZW-LMOB AVIL-GVINRMZGVW HGIRMT GL YV KZIHVW.
    */
    tVMVIRXwLXFNVMG& kZIHV(XLMHG xS* HGI) {
        IVGFIM kZIHV<PkZIHVwVUZFOGuOZTH>(HGI);
    }

    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV hLFIXVvMXLWRMT>
    tVMVIRXwLXFNVMG& kZIHV(XLMHG GBKVMZNV hLFIXVvMXLWRMT::xS* HGI, HRAV_G OVMTGS) {
        izkrwqhlm_zhhvig(!(KZIHVuOZTH & PkZIHVrMHRGFuOZT));
        nVNLIBhGIVZN NH(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(HGI), OVMTGS * HRAVLU(GBKVMZNV hLFIXVvMXLWRMT::xS));
        vMXLWVWrMKFGhGIVZN<hLFIXVvMXLWRMT, nVNLIBhGIVZN> RH(NH);
        kZIHVhGIVZN<KZIHVuOZTH, hLFIXVvMXLWRMT>(RH);
        IVGFIM *GSRH;
    }

    GVNKOZGV <FMHRTMVW KZIHVuOZTH>
    tVMVIRXwLXFNVMG& kZIHV(XLMHG xS* HGI, HRAV_G OVMTGS) {
        IVGFIM kZIHV<KZIHVuOZTH, vMXLWRMT>(HGI, OVMTGS);
    }
    
    tVMVIRXwLXFNVMG& kZIHV(XLMHG xS* HGI, HRAV_G OVMTGS) {
        IVGFIM kZIHV<PkZIHVwVUZFOGuOZTH>(HGI, OVMTGS);
    }

#RU izkrwqhlm_szh_hgwhgirmt
    GVNKOZGV <FMHRTMVW KZIHVuOZTH, GBKVMZNV hLFIXVvMXLWRMT>
    tVMVIRXwLXFNVMG& kZIHV(XLMHG HGW::YZHRX_HGIRMT<GBKVMZNV hLFIXVvMXLWRMT::xS>& HGI) {
        // X_HGI() RH XLMHGZMG XLNKOVCRGB ZXXLIWRMT GL HGZMWZIW. hSLFOW YV UZHGVI GSZM kZIHV(XLMHG XSZI*, HRAV_G)
        IVGFIM kZIHV<KZIHVuOZTH, hLFIXVvMXLWRMT>(HGI.X_HGI());
    }

    GVNKOZGV <FMHRTMVW KZIHVuOZTH>
    tVMVIRXwLXFNVMG& kZIHV(XLMHG HGW::YZHRX_HGIRMT<xS>& HGI) {
        IVGFIM kZIHV<KZIHVuOZTH, vMXLWRMT>(HGI.X_HGI());
    }

    tVMVIRXwLXFNVMG& kZIHV(XLMHG HGW::YZHRX_HGIRMT<xS>& HGI) {
        IVGFIM kZIHV<PkZIHVwVUZFOGuOZTH>(HGI);
    }
#VMWRU // izkrwqhlm_szh_hgwhgirmt    

    //!@}

    //!@MZNV sZMWORMT KZIHV VIILIH
    //!@{

    //! dSVGSVI Z KZIHV VIILI SZH LXXFIIVW RM GSV OZHG KZIHRMT.
    YLLO sZHkZIHVvIILI() XLMHG { IVGFIM KZIHViVHFOG_.rHvIILI(); }

    //! tVG GSV \IVU kZIHVvIILIxLWV LU OZHG KZIHRMT.
    kZIHVvIILIxLWV tVGkZIHVvIILI() XLMHG { IVGFIM KZIHViVHFOG_.xLWV(); }

    //! tVG GSV KLHRGRLM LU OZHG KZIHRMT VIILI RM RMKFG, 9 LGSVIDRHV.
    HRAV_G tVGvIILIlUUHVG() XLMHG { IVGFIM KZIHViVHFOG_.lUUHVG(); }

    //! rNKORXRG XLMEVIHRLM GL TVG GSV OZHG KZIHV IVHFOG
#RUMWVU __XOZMT // -dWLXFNVMGZGRLM
    /*! \IVGFIM \IVU kZIHViVHFOG LU GSV OZHG KZIHV LKVIZGRLM

        \XLWV
          wLXFNVMG WLX;
          kZIHViVHFOG LP = WLX.kZIHV(QHLM);
          RU (!LP)
            KIRMGU( "qhlm KZIHV VIILI: %H (%F)\M", tVGkZIHVvIILI_vM(LP.xLWV()), LP.lUUHVG());
        \VMWXLWV
     */
#VMWRU
    LKVIZGLI kZIHViVHFOG() XLMHG { IVGFIM KZIHViVHFOG_; }
    //!@}

    //! tVG GSV ZOOLXZGLI LU GSRH WLXFNVMG.
    zOOLXZGLI& tVGzOOLXZGLI() {
        izkrwqhlm_zhhvig(ZOOLXZGLI_);
        IVGFIM *ZOOLXZGLI_;
    }

    //! tVG GSV XZKZXRGB LU HGZXP RM YBGVH.
    HRAV_G tVGhGZXPxZKZXRGB() XLMHG { IVGFIM HGZXP_.tVGxZKZXRGB(); }

KIREZGV:
    // XOVZI HGZXP LM ZMB VCRG UILN kZIHVhGIVZN, V.T. WFV GL VCXVKGRLM
    HGIFXG xOVZIhGZXPlMvCRG {
        VCKORXRG xOVZIhGZXPlMvCRG(tVMVIRXwLXFNVMG& W) : W_(W) {}
        ~xOVZIhGZXPlMvCRG() { W_.xOVZIhGZXP(); }
    KIREZGV:
        xOVZIhGZXPlMvCRG(XLMHG xOVZIhGZXPlMvCRG&);
        xOVZIhGZXPlMvCRG& LKVIZGLI=(XLMHG xOVZIhGZXPlMvCRG&);
        tVMVIRXwLXFNVMG& W_;
    };

    // XZOOVIH LU GSV ULOOLDRMT KIREZGV sZMWOVI UFMXGRLMH
    // GVNKOZGV <GBKVMZNV,GBKVMZNV,GBKVMZNV> UIRVMW XOZHH tVMVIRXiVZWVI; // ULI KZIHRMT
    GVNKOZGV <GBKVMZNV, GBKVMZNV> UIRVMW XOZHH tVMVIRXeZOFV; // ULI WVVK XLKBRMT

KFYORX:
    // rNKOVNVMGZGRLM LU sZMWOVI
    YLLO mFOO() { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(); IVGFIM GIFV; }
    YLLO yLLO(YLLO Y) { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(Y); IVGFIM GIFV; }
    YLLO rMG(RMG R) { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(R); IVGFIM GIFV; }
    YLLO fRMG(FMHRTMVW R) { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(R); IVGFIM GIFV; }
    YLLO rMG35(RMG35_G R) { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(R); IVGFIM GIFV; }
    YLLO fRMG35(FRMG35_G R) { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(R); IVGFIM GIFV; }
    YLLO wLFYOV(WLFYOV W) { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(W); IVGFIM GIFV; }

    YLLO iZDmFNYVI(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB) { 
        RU (XLKB) 
            MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(HGI, OVMTGS, tVGzOOLXZGLI());
        VOHV
            MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(HGI, OVMTGS);
        IVGFIM GIFV;
    }

    YLLO hGIRMT(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB) { 
        RU (XLKB) 
            MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(HGI, OVMTGS, tVGzOOLXZGLI());
        VOHV
            MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(HGI, OVMTGS);
        IVGFIM GIFV;
    }

    YLLO hGZIGlYQVXG() { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(PlYQVXGgBKV); IVGFIM GIFV; }
    
    YLLO pVB(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB) { IVGFIM hGIRMT(HGI, OVMTGS, XLKB); }

    YLLO vMWlYQVXG(hRAVgBKV NVNYVIxLFMG) {
        GBKVMZNV eZOFVgBKV::nVNYVI* NVNYVIH = HGZXP_.GVNKOZGV kLK<GBKVMZNV eZOFVgBKV::nVNYVI>(NVNYVIxLFMG);
        HGZXP_.GVNKOZGV gLK<eZOFVgBKV>()->hVGlYQVXGiZD(NVNYVIH, NVNYVIxLFMG, tVGzOOLXZGLI());
        IVGFIM GIFV;
    }

    YLLO hGZIGzIIZB() { MVD (HGZXP_.GVNKOZGV kFHS<eZOFVgBKV>()) eZOFVgBKV(PzIIZBgBKV); IVGFIM GIFV; }
    
    YLLO vMWzIIZB(hRAVgBKV VOVNVMGxLFMG) {
        eZOFVgBKV* VOVNVMGH = HGZXP_.GVNKOZGV kLK<eZOFVgBKV>(VOVNVMGxLFMG);
        HGZXP_.GVNKOZGV gLK<eZOFVgBKV>()->hVGzIIZBiZD(VOVNVMGH, VOVNVMGxLFMG, tVGzOOLXZGLI());
        IVGFIM GIFV;
    }

KIREZGV:
    //! kILSRYRG XLKBRMT
    tVMVIRXwLXFNVMG(XLMHG tVMVIRXwLXFNVMG&);
    //! kILSRYRG ZHHRTMNVMG
    tVMVIRXwLXFNVMG& LKVIZGLI=(XLMHG tVMVIRXwLXFNVMG&);

    ELRW xOVZIhGZXP() {
        RU (zOOLXZGLI::PmVVWuIVV)
            DSROV (HGZXP_.tVGhRAV() > 9)    // sVIV ZHHFNVH ZOO VOVNVMGH RM HGZXP ZIIZB ZIV tVMVIRXeZOFV (nVNYVI RH ZXGFZOOB 7 tVMVIRXeZOFV LYQVXGH)
                (HGZXP_.GVNKOZGV kLK<eZOFVgBKV>(8))->~eZOFVgBKV();
        VOHV
            HGZXP_.xOVZI();
        HGZXP_.hSIRMPgLuRG();
    }

    ELRW wVHGILB() {
        izkrwqhlm_wvovgv(LDMzOOLXZGLI_);
    }

    HGZGRX XLMHG HRAV_G PwVUZFOGhGZXPxZKZXRGB = 8975;
    zOOLXZGLI* ZOOLXZGLI_;
    zOOLXZGLI* LDMzOOLXZGLI_;
    RMGVIMZO::hGZXP<hGZXPzOOLXZGLI> HGZXP_;
    kZIHViVHFOG KZIHViVHFOG_;
};

//! tVMVIRXwLXFNVMG DRGS fgu1 VMXLWRMT
GBKVWVU tVMVIRXwLXFNVMG<fgu1<> > wLXFNVMG;

//! sVOKVI XOZHH ULI ZXXVHHRMT eZOFV LU ZIIZB GBKV.
/*!
    rMHGZMXV LU GSRH SVOKVI XOZHH RH LYGZRMVW YB \X tVMVIRXeZOFV::tVGzIIZB().
    rM ZWWRGRLM GL ZOO zkrH ULI ZIIZB GBKV, RG KILERWVH IZMTV-YZHVW ULI OLLK RU \X izkrwqhlm_szh_xcc88_izmtv_uli=8.
*/
GVNKOZGV <YLLO xLMHG, GBKVMZNV eZOFVg>
XOZHH tVMVIRXzIIZB {
KFYORX:
    GBKVWVU tVMVIRXzIIZB<GIFV, eZOFVg> xLMHGzIIZB;
    GBKVWVU tVMVIRXzIIZB<UZOHV, eZOFVg> zIIZB;
    GBKVWVU eZOFVg kOZRMgBKV;
    GBKVWVU GBKVMZNV RMGVIMZO::nZBYVzWWxLMHG<xLMHG,kOZRMgBKV>::gBKV eZOFVgBKV;
    GBKVWVU eZOFVgBKV* eZOFVrGVIZGLI;  // gSRH NZB YV XLMHG LI MLM-XLMHG RGVIZGLI
    GBKVWVU XLMHG eZOFVg* xLMHGeZOFVrGVIZGLI;
    GBKVWVU GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV zOOLXZGLIgBKV;
    GBKVWVU GBKVMZNV eZOFVgBKV::hGIRMTiVUgBKV hGIRMTiVUgBKV;

    GVNKOZGV <GBKVMZNV, GBKVMZNV>
    UIRVMW XOZHH tVMVIRXeZOFV;

    tVMVIRXzIIZB(XLMHG tVMVIRXzIIZB& ISH) : EZOFV_(ISH.EZOFV_) {}
    tVMVIRXzIIZB& LKVIZGLI=(XLMHG tVMVIRXzIIZB& ISH) { EZOFV_ = ISH.EZOFV_; IVGFIM *GSRH; }
    ~tVMVIRXzIIZB() {}

    hRAVgBKV hRAV() XLMHG { IVGFIM EZOFV_.hRAV(); }
    hRAVgBKV xZKZXRGB() XLMHG { IVGFIM EZOFV_.xZKZXRGB(); }
    YLLO vNKGB() XLMHG { IVGFIM EZOFV_.vNKGB(); }
    ELRW xOVZI() XLMHG { EZOFV_.xOVZI(); }
    eZOFVgBKV& LKVIZGLI[](hRAVgBKV RMWVC) XLMHG {  IVGFIM EZOFV_[RMWVC]; }
    eZOFVrGVIZGLI yVTRM() XLMHG { IVGFIM EZOFV_.yVTRM(); }
    eZOFVrGVIZGLI vMW() XLMHG { IVGFIM EZOFV_.vMW(); }
    tVMVIRXzIIZB iVHVIEV(hRAVgBKV MVDxZKZXRGB, zOOLXZGLIgBKV &ZOOLXZGLI) XLMHG { EZOFV_.iVHVIEV(MVDxZKZXRGB, ZOOLXZGLI); IVGFIM *GSRH; }
    tVMVIRXzIIZB kFHSyZXP(eZOFVgBKV& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.kFHSyZXP(EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    tVMVIRXzIIZB kFHSyZXP(eZOFVgBKV&& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.kFHSyZXP(EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
#VMWRU // izkrwqhlm_szh_xcc88_iezofv_ivuh
    tVMVIRXzIIZB kFHSyZXP(hGIRMTiVUgBKV EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.kFHSyZXP(EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    GVNKOZGV <GBKVMZNV g> izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (XLMHG tVMVIRXzIIZB&)) kFHSyZXP(g EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.kFHSyZXP(EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    tVMVIRXzIIZB kLKyZXP() XLMHG { EZOFV_.kLKyZXP(); IVGFIM *GSRH; }
    eZOFVrGVIZGLI vIZHV(xLMHGeZOFVrGVIZGLI KLH) XLMHG { IVGFIM EZOFV_.vIZHV(KLH); }
    eZOFVrGVIZGLI vIZHV(xLMHGeZOFVrGVIZGLI URIHG, xLMHGeZOFVrGVIZGLI OZHG) XLMHG { IVGFIM EZOFV_.vIZHV(URIHG, OZHG); }

#RU izkrwqhlm_szh_xcc88_izmtv_uli
    eZOFVrGVIZGLI YVTRM() XLMHG { IVGFIM EZOFV_.yVTRM(); }
    eZOFVrGVIZGLI VMW() XLMHG { IVGFIM EZOFV_.vMW(); }
#VMWRU

KIREZGV:
    tVMVIRXzIIZB();
    tVMVIRXzIIZB(eZOFVgBKV& EZOFV) : EZOFV_(EZOFV) {}
    eZOFVgBKV& EZOFV_;
};

//! sVOKVI XOZHH ULI ZXXVHHRMT eZOFV LU LYQVXG GBKV.
/*!
    rMHGZMXV LU GSRH SVOKVI XOZHH RH LYGZRMVW YB \X tVMVIRXeZOFV::tVGlYQVXG().
    rM ZWWRGRLM GL ZOO zkrH ULI ZIIZB GBKV, RG KILERWVH IZMTV-YZHVW ULI OLLK RU \X izkrwqhlm_szh_xcc88_izmtv_uli=8.
*/
GVNKOZGV <YLLO xLMHG, GBKVMZNV eZOFVg>
XOZHH tVMVIRXlYQVXG {
KFYORX:
    GBKVWVU tVMVIRXlYQVXG<GIFV, eZOFVg> xLMHGlYQVXG;
    GBKVWVU tVMVIRXlYQVXG<UZOHV, eZOFVg> lYQVXG;
    GBKVWVU eZOFVg kOZRMgBKV;
    GBKVWVU GBKVMZNV RMGVIMZO::nZBYVzWWxLMHG<xLMHG,kOZRMgBKV>::gBKV eZOFVgBKV;
    GBKVWVU tVMVIRXnVNYVIrGVIZGLI<xLMHG, GBKVMZNV eZOFVg::vMXLWRMTgBKV, GBKVMZNV eZOFVg::zOOLXZGLIgBKV> nVNYVIrGVIZGLI;  // gSRH NZB YV XLMHG LI MLM-XLMHG RGVIZGLI
    GBKVWVU tVMVIRXnVNYVIrGVIZGLI<GIFV, GBKVMZNV eZOFVg::vMXLWRMTgBKV, GBKVMZNV eZOFVg::zOOLXZGLIgBKV> xLMHGnVNYVIrGVIZGLI;
    GBKVWVU GBKVMZNV eZOFVgBKV::zOOLXZGLIgBKV zOOLXZGLIgBKV;
    GBKVWVU GBKVMZNV eZOFVgBKV::hGIRMTiVUgBKV hGIRMTiVUgBKV;
    GBKVWVU GBKVMZNV eZOFVgBKV::vMXLWRMTgBKV vMXLWRMTgBKV;
    GBKVWVU GBKVMZNV eZOFVgBKV::xS xS;

    GVNKOZGV <GBKVMZNV, GBKVMZNV>
    UIRVMW XOZHH tVMVIRXeZOFV;

    tVMVIRXlYQVXG(XLMHG tVMVIRXlYQVXG& ISH) : EZOFV_(ISH.EZOFV_) {}
    tVMVIRXlYQVXG& LKVIZGLI=(XLMHG tVMVIRXlYQVXG& ISH) { EZOFV_ = ISH.EZOFV_; IVGFIM *GSRH; }
    ~tVMVIRXlYQVXG() {}

    hRAVgBKV nVNYVIxLFMG() XLMHG { IVGFIM EZOFV_.nVNYVIxLFMG(); }
    hRAVgBKV nVNYVIxZKZXRGB() XLMHG { IVGFIM EZOFV_.nVNYVIxZKZXRGB(); }
    YLLO lYQVXGvNKGB() XLMHG { IVGFIM EZOFV_.lYQVXGvNKGB(); }
    GVNKOZGV <GBKVMZNV g> eZOFVgBKV& LKVIZGLI[](g* MZNV) XLMHG { IVGFIM EZOFV_[MZNV]; }
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI> eZOFVgBKV& LKVIZGLI[](XLMHG tVMVIRXeZOFV<vMXLWRMTgBKV, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM EZOFV_[MZNV]; }
#RU izkrwqhlm_szh_hgwhgirmt
    eZOFVgBKV& LKVIZGLI[](XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM EZOFV_[MZNV]; }
#VMWRU
    nVNYVIrGVIZGLI nVNYVIyVTRM() XLMHG { IVGFIM EZOFV_.nVNYVIyVTRM(); }
    nVNYVIrGVIZGLI nVNYVIvMW() XLMHG { IVGFIM EZOFV_.nVNYVIvMW(); }
    tVMVIRXlYQVXG nVNYVIiVHVIEV(hRAVgBKV MVDxZKZXRGB, zOOLXZGLIgBKV &ZOOLXZGLI) XLMHG { EZOFV_.nVNYVIiVHVIEV(MVDxZKZXRGB, ZOOLXZGLI); IVGFIM *GSRH; }
    YLLO sZHnVNYVI(XLMHG xS* MZNV) XLMHG { IVGFIM EZOFV_.sZHnVNYVI(MZNV); }
#RU izkrwqhlm_szh_hgwhgirmt
    YLLO sZHnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM EZOFV_.sZHnVNYVI(MZNV); }
#VMWRU
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI> YLLO sZHnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMTgBKV, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM EZOFV_.sZHnVNYVI(MZNV); }
    nVNYVIrGVIZGLI uRMWnVNYVI(XLMHG xS* MZNV) XLMHG { IVGFIM EZOFV_.uRMWnVNYVI(MZNV); }
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI> nVNYVIrGVIZGLI uRMWnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMTgBKV, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM EZOFV_.uRMWnVNYVI(MZNV); }
#RU izkrwqhlm_szh_hgwhgirmt
    nVNYVIrGVIZGLI uRMWnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM EZOFV_.uRMWnVNYVI(MZNV); }
#VMWRU
    tVMVIRXlYQVXG zWWnVNYVI(eZOFVgBKV& MZNV, eZOFVgBKV& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    tVMVIRXlYQVXG zWWnVNYVI(eZOFVgBKV& MZNV, hGIRMTiVUgBKV EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
#RU izkrwqhlm_szh_hgwhgirmt
    tVMVIRXlYQVXG zWWnVNYVI(eZOFVgBKV& MZNV, HGW::YZHRX_HGIRMT<xS>& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
#VMWRU
    GVNKOZGV <GBKVMZNV g> izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (eZOFVgBKV&)) zWWnVNYVI(eZOFVgBKV& MZNV, g EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    tVMVIRXlYQVXG zWWnVNYVI(eZOFVgBKV&& MZNV, eZOFVgBKV&& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    tVMVIRXlYQVXG zWWnVNYVI(eZOFVgBKV&& MZNV, eZOFVgBKV& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    tVMVIRXlYQVXG zWWnVNYVI(eZOFVgBKV& MZNV, eZOFVgBKV&& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    tVMVIRXlYQVXG zWWnVNYVI(hGIRMTiVUgBKV MZNV, eZOFVgBKV&& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
#VMWRU // izkrwqhlm_szh_xcc88_iezofv_ivuh
    tVMVIRXlYQVXG zWWnVNYVI(hGIRMTiVUgBKV MZNV, eZOFVgBKV& EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    tVMVIRXlYQVXG zWWnVNYVI(hGIRMTiVUgBKV MZNV, hGIRMTiVUgBKV EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    GVNKOZGV <GBKVMZNV g> izkrwqhlm_wrhzyovru_ivgfim((RMGVIMZO::lIvCKI<RMGVIMZO::rHkLRMGVI<g>, RMGVIMZO::rHtVMVIRXeZOFV<g> >), (tVMVIRXlYQVXG)) zWWnVNYVI(hGIRMTiVUgBKV MZNV, g EZOFV, zOOLXZGLIgBKV& ZOOLXZGLI) XLMHG { EZOFV_.zWWnVNYVI(MZNV, EZOFV, ZOOLXZGLI); IVGFIM *GSRH; }
    ELRW iVNLEVzOOnVNYVIH() { EZOFV_.iVNLEVzOOnVNYVIH(); }
    YLLO iVNLEVnVNYVI(XLMHG xS* MZNV) XLMHG { IVGFIM EZOFV_.iVNLEVnVNYVI(MZNV); }
#RU izkrwqhlm_szh_hgwhgirmt
    YLLO iVNLEVnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM EZOFV_.iVNLEVnVNYVI(MZNV); }
#VMWRU
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI> YLLO iVNLEVnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMTgBKV, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM EZOFV_.iVNLEVnVNYVI(MZNV); }
    nVNYVIrGVIZGLI iVNLEVnVNYVI(nVNYVIrGVIZGLI N) XLMHG { IVGFIM EZOFV_.iVNLEVnVNYVI(N); }
    nVNYVIrGVIZGLI vIZHVnVNYVI(xLMHGnVNYVIrGVIZGLI KLH) XLMHG { IVGFIM EZOFV_.vIZHVnVNYVI(KLH); }
    nVNYVIrGVIZGLI vIZHVnVNYVI(xLMHGnVNYVIrGVIZGLI URIHG, xLMHGnVNYVIrGVIZGLI OZHG) XLMHG { IVGFIM EZOFV_.vIZHVnVNYVI(URIHG, OZHG); }
    YLLO vIZHVnVNYVI(XLMHG xS* MZNV) XLMHG { IVGFIM EZOFV_.vIZHVnVNYVI(MZNV); }
#RU izkrwqhlm_szh_hgwhgirmt
    YLLO vIZHVnVNYVI(XLMHG HGW::YZHRX_HGIRMT<xS>& MZNV) XLMHG { IVGFIM vIZHVnVNYVI(eZOFVgBKV(hGIRMTiVU(MZNV))); }
#VMWRU
    GVNKOZGV <GBKVMZNV hLFIXVzOOLXZGLI> YLLO vIZHVnVNYVI(XLMHG tVMVIRXeZOFV<vMXLWRMTgBKV, hLFIXVzOOLXZGLI>& MZNV) XLMHG { IVGFIM EZOFV_.vIZHVnVNYVI(MZNV); }

#RU izkrwqhlm_szh_xcc88_izmtv_uli
    nVNYVIrGVIZGLI YVTRM() XLMHG { IVGFIM EZOFV_.nVNYVIyVTRM(); }
    nVNYVIrGVIZGLI VMW() XLMHG { IVGFIM EZOFV_.nVNYVIvMW(); }
#VMWRU

KIREZGV:
    tVMVIRXlYQVXG();
    tVMVIRXlYQVXG(eZOFVgBKV& EZOFV) : EZOFV_(EZOFV) {}
    eZOFVgBKV& EZOFV_;
};

izkrwqhlm_mznvhkzxv_vmw
izkrwqhlm_wrzt_klk

#VMWRU // izkrwqhlm_wlxfnvmg_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/UROVIVZWHGIVZN.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_urovivzwhgivzn_s_
#WVURMV izkrwqhlm_urovivzwhgivzn_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV <XHGWRL>

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
izkrwqhlm_wrzt_luu(FMIVZXSZYOV-XLWV)
izkrwqhlm_wrzt_luu(NRHHRMT-MLIVGFIM)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! uROV YBGV HGIVZN ULI RMKFG FHRMT UIVZW().
/*!
    \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/
XOZHH uROViVZWhGIVZN {
KFYORX:
    GBKVWVU XSZI xS;    //!< xSZIZXGVI GBKV (YBGV).

    //! xLMHGIFXGLI.
    /*!
        \KZIZN UK uROV KLRMGVI LKVMVW ULI IVZW.
        \KZIZN YFUUVI FHVI-HFKKORVW YFUUVI.
        \KZIZN YFUUVIhRAV HRAV LU YFUUVI RM YBGVH. nFHG >=5 YBGVH.
    */
    uROViVZWhGIVZN(HGW::urov* UK, XSZI* YFUUVI, HRAV_G YFUUVIhRAV) : UK_(UK), YFUUVI_(YFUUVI), YFUUVIhRAV_(YFUUVIhRAV), YFUUVIoZHG_(9), XFIIVMG_(YFUUVI_), IVZWxLFMG_(9), XLFMG_(9), VLU_(UZOHV) { 
        izkrwqhlm_zhhvig(UK_ != 9);
        izkrwqhlm_zhhvig(YFUUVIhRAV >= 5);
        iVZW();
    }

    xS kVVP() XLMHG { IVGFIM *XFIIVMG_; }
    xS gZPV() { xS X = *XFIIVMG_; iVZW(); IVGFIM X; }
    HRAV_G gVOO() XLMHG { IVGFIM XLFMG_ + HGZGRX_XZHG<HRAV_G>(XFIIVMG_ - YFUUVI_); }

    // mLG RNKOVNVMGVW
    ELRW kFG(xS) { izkrwqhlm_zhhvig(UZOHV); }
    ELRW uOFHS() { izkrwqhlm_zhhvig(UZOHV); } 
    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

    // uLI VMXLWRMT WVGVXGRLM LMOB.
    XLMHG xS* kVVP5() XLMHG {
        IVGFIM (XFIIVMG_ + 5 <= YFUUVIoZHG_) ? XFIIVMG_ : 9;
    }

KIREZGV:
    ELRW iVZW() {
        RU (XFIIVMG_ < YFUUVIoZHG_)
            ++XFIIVMG_;
        VOHV RU (!VLU_) {
            XLFMG_ += IVZWxLFMG_;
            IVZWxLFMG_ = HGW::UIVZW(YFUUVI_, 8, YFUUVIhRAV_, UK_);
            YFUUVIoZHG_ = YFUUVI_ + IVZWxLFMG_ - 8;
            XFIIVMG_ = YFUUVI_;

            RU (IVZWxLFMG_ < YFUUVIhRAV_) {
                YFUUVI_[IVZWxLFMG_] = '\9';
                ++YFUUVIoZHG_;
                VLU_ = GIFV;
            }
        }
    }

    HGW::urov* UK_;
    xS *YFUUVI_;
    HRAV_G YFUUVIhRAV_;
    xS *YFUUVIoZHG_;
    xS *XFIIVMG_;
    HRAV_G IVZWxLFMG_;
    HRAV_G XLFMG_;  //!< mFNYVI LU XSZIZXGVIH IVZW
    YLLO VLU_;
};

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_urovhgivzn_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/KIVGGBDIRGVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_kivggbdirgvi_s_
#WVURMV izkrwqhlm_kivggbdirgvi_s_

#RMXOFWV "DIRGVI.S"

#RUWVU __tmfx__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
#VMWRU

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(X++01-XLNKZG)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! xLNYRMZGRLM LU kIVGGBdIRGVI ULINZG UOZTH.
/*! \HVV kIVGGBdIRGVI::hVGuLINZGlKGRLMH
 */
VMFN kIVGGBuLINZGlKGRLMH {
    PuLINZGwVUZFOG = 9,         //!< wVUZFOG KIVGGB ULINZGGRMT.
    PuLINZGhRMTOVoRMVzIIZB = 8  //!< uLINZG ZIIZBH LM Z HRMTOV ORMV.
};

//! dIRGVI DRGS RMWVMGZGRLM ZMW HKZXRMT.
/*!
    \GKZIZN lFGKFGhGIVZN gBKV LU LFGKFG LH.
    \GKZIZN hLFIXVvMXLWRMT vMXLWRMT LU HLFIXV HGIRMT.
    \GKZIZN gZITVGvMXLWRMT vMXLWRMT LU LFGKFG HGIVZN.
    \GKZIZN hGZXPzOOLXZGLI gBKV LU ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB LU HGZXP.
*/
GVNKOZGV<GBKVMZNV lFGKFGhGIVZN, GBKVMZNV hLFIXVvMXLWRMT = fgu1<>, GBKVMZNV gZITVGvMXLWRMT = fgu1<>, GBKVMZNV hGZXPzOOLXZGLI = xIGzOOLXZGLI, FMHRTMVW DIRGVuOZTH = PdIRGVwVUZFOGuOZTH>
XOZHH kIVGGBdIRGVI : KFYORX dIRGVI<lFGKFGhGIVZN, hLFIXVvMXLWRMT, gZITVGvMXLWRMT, hGZXPzOOLXZGLI, DIRGVuOZTH> {
KFYORX:
    GBKVWVU dIRGVI<lFGKFGhGIVZN, hLFIXVvMXLWRMT, gZITVGvMXLWRMT, hGZXPzOOLXZGLI, DIRGVuOZTH> yZHV;
    GBKVWVU GBKVMZNV yZHV::xS xS;

    //! xLMHGIFXGLI
    /*! \KZIZN LH lFGKFG HGIVZN.
        \KZIZN ZOOLXZGLI fHVI HFKKORVW ZOOLXZGLI. rU RG RH MFOO, RG DROO XIVZGV Z KIREZGV LMV.
        \KZIZN OVEVOwVKGS rMRGRZO XZKZXRGB LU HGZXP.
    */
    VCKORXRG kIVGGBdIRGVI(lFGKFGhGIVZN& LH, hGZXPzOOLXZGLI* ZOOLXZGLI = 9, HRAV_G OVEVOwVKGS = yZHV::PwVUZFOGoVEVOwVKGS) : 
        yZHV(LH, ZOOLXZGLI, OVEVOwVKGS), RMWVMGxSZI_(' '), RMWVMGxSZIxLFMG_(5), ULINZGlKGRLMH_(PuLINZGwVUZFOG) {}


    VCKORXRG kIVGGBdIRGVI(hGZXPzOOLXZGLI* ZOOLXZGLI = 9, HRAV_G OVEVOwVKGS = yZHV::PwVUZFOGoVEVOwVKGS) : 
        yZHV(ZOOLXZGLI, OVEVOwVKGS), RMWVMGxSZI_(' '), RMWVMGxSZIxLFMG_(5) {}

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    kIVGGBdIRGVI(kIVGGBdIRGVI&& ISH) :
        yZHV(HGW::ULIDZIW<kIVGGBdIRGVI>(ISH)), RMWVMGxSZI_(ISH.RMWVMGxSZI_), RMWVMGxSZIxLFMG_(ISH.RMWVMGxSZIxLFMG_), ULINZGlKGRLMH_(ISH.ULINZGlKGRLMH_) {}
#VMWRU

    //! hVG XFHGLN RMWVMGZGRLM.
    /*! \KZIZN RMWVMGxSZI       xSZIZXGVI ULI RMWVMGZGRLM. nFHG YV DSRGVHKZXV XSZIZXGVI (' ', '\\G', '\\M', '\\I').
        \KZIZN RMWVMGxSZIxLFMG  mFNYVI LU RMWVMG XSZIZXGVIH ULI VZXS RMWVMGZGRLM OVEVO.
        \MLGV gSV WVUZFOG RMWVMGZGRLM RH 5 HKZXVH.
    */
    kIVGGBdIRGVI& hVGrMWVMG(xS RMWVMGxSZI, FMHRTMVW RMWVMGxSZIxLFMG) {
        izkrwqhlm_zhhvig(RMWVMGxSZI == ' ' || RMWVMGxSZI == '\G' || RMWVMGxSZI == '\M' || RMWVMGxSZI == '\I');
        RMWVMGxSZI_ = RMWVMGxSZI;
        RMWVMGxSZIxLFMG_ = RMWVMGxSZIxLFMG;
        IVGFIM *GSRH;
    }

    //! hVG KIVGGB DIRGVI ULINZGGRMT LKGRLMH.
    /*! \KZIZN LKGRLMH uLINZGGRMT LKGRLMH.
    */
    kIVGGBdIRGVI& hVGuLINZGlKGRLMH(kIVGGBuLINZGlKGRLMH LKGRLMH) {
        ULINZGlKGRLMH_ = LKGRLMH;
        IVGFIM *GSRH;
    }

    /*! @MZNV rNKOVNVMGZGRLM LU sZMWOVI
        \HVV sZMWOVI
    */
    //@{

    YLLO mFOO()                 { kIVGGBkIVURC(PmFOOgBKV);   IVGFIM yZHV::dIRGVmFOO(); }
    YLLO yLLO(YLLO Y)           { kIVGGBkIVURC(Y ? PgIFVgBKV : PuZOHVgBKV); IVGFIM yZHV::dIRGVyLLO(Y); }
    YLLO rMG(RMG R)             { kIVGGBkIVURC(PmFNYVIgBKV); IVGFIM yZHV::dIRGVrMG(R); }
    YLLO fRMG(FMHRTMVW F)       { kIVGGBkIVURC(PmFNYVIgBKV); IVGFIM yZHV::dIRGVfRMG(F); }
    YLLO rMG35(RMG35_G R35)     { kIVGGBkIVURC(PmFNYVIgBKV); IVGFIM yZHV::dIRGVrMG35(R35); }
    YLLO fRMG35(FRMG35_G F35)   { kIVGGBkIVURC(PmFNYVIgBKV); IVGFIM yZHV::dIRGVfRMG35(F35);  }
    YLLO wLFYOV(WLFYOV W)       { kIVGGBkIVURC(PmFNYVIgBKV); IVGFIM yZHV::dIRGVwLFYOV(W); }

    YLLO iZDmFNYVI(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB = UZOHV) {
        izkrwqhlm_zhhvig(HGI != 9);
        (ELRW)XLKB;
        kIVGGBkIVURC(PmFNYVIgBKV);
        IVGFIM yZHV::dIRGVhGIRMT(HGI, OVMTGS);
    }

    YLLO hGIRMT(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB = UZOHV) {
        izkrwqhlm_zhhvig(HGI != 9);
        (ELRW)XLKB;
        kIVGGBkIVURC(PhGIRMTgBKV);
        IVGFIM yZHV::dIRGVhGIRMT(HGI, OVMTGS);
    }

#RU izkrwqhlm_szh_hgwhgirmt
    YLLO hGIRMT(XLMHG HGW::YZHRX_HGIRMT<xS>& HGI) {
        IVGFIM hGIRMT(HGI.WZGZ(), hRAVgBKV(HGI.HRAV()));
    }
#VMWRU

    YLLO hGZIGlYQVXG() {
        kIVGGBkIVURC(PlYQVXGgBKV);
        MVD (yZHV::OVEVO_HGZXP_.GVNKOZGV kFHS<GBKVMZNV yZHV::oVEVO>()) GBKVMZNV yZHV::oVEVO(UZOHV);
        IVGFIM yZHV::dIRGVhGZIGlYQVXG();
    }

    YLLO pVB(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB = UZOHV) { IVGFIM hGIRMT(HGI, OVMTGS, XLKB); }

#RU izkrwqhlm_szh_hgwhgirmt
    YLLO pVB(XLMHG HGW::YZHRX_HGIRMT<xS>& HGI) {
        IVGFIM pVB(HGI.WZGZ(), hRAVgBKV(HGI.HRAV()));
    }
#VMWRU
	
    YLLO vMWlYQVXG(hRAVgBKV NVNYVIxLFMG = 9) {
        (ELRW)NVNYVIxLFMG;
        izkrwqhlm_zhhvig(yZHV::OVEVO_HGZXP_.tVGhRAV() >= HRAVLU(GBKVMZNV yZHV::oVEVO)); // MLG RMHRWV ZM lYQVXG
        izkrwqhlm_zhhvig(!yZHV::OVEVO_HGZXP_.GVNKOZGV gLK<GBKVMZNV yZHV::oVEVO>()->RMzIIZB); // XFIIVMGOB RMHRWV ZM zIIZB, MLG lYQVXG
        izkrwqhlm_zhhvig(9 == yZHV::OVEVO_HGZXP_.GVNKOZGV gLK<GBKVMZNV yZHV::oVEVO>()->EZOFVxLFMG % 7); // lYQVXG SZH Z pVB DRGSLFG Z eZOFV
       
        YLLO VNKGB = yZHV::OVEVO_HGZXP_.GVNKOZGV kLK<GBKVMZNV yZHV::oVEVO>(8)->EZOFVxLFMG == 9;

        RU (!VNKGB) {
            yZHV::LH_->kFG('\M');
            dIRGVrMWVMG();
        }
        YLLO IVG = yZHV::dIRGVvMWlYQVXG();
        (ELRW)IVG;
        izkrwqhlm_zhhvig(IVG == GIFV);
        RU (yZHV::OVEVO_HGZXP_.vNKGB()) // VMW LU QHLM GVCG
            yZHV::uOFHS();
        IVGFIM GIFV;
    }

    YLLO hGZIGzIIZB() {
        kIVGGBkIVURC(PzIIZBgBKV);
        MVD (yZHV::OVEVO_HGZXP_.GVNKOZGV kFHS<GBKVMZNV yZHV::oVEVO>()) GBKVMZNV yZHV::oVEVO(GIFV);
        IVGFIM yZHV::dIRGVhGZIGzIIZB();
    }

    YLLO vMWzIIZB(hRAVgBKV NVNYVIxLFMG = 9) {
        (ELRW)NVNYVIxLFMG;
        izkrwqhlm_zhhvig(yZHV::OVEVO_HGZXP_.tVGhRAV() >= HRAVLU(GBKVMZNV yZHV::oVEVO));
        izkrwqhlm_zhhvig(yZHV::OVEVO_HGZXP_.GVNKOZGV gLK<GBKVMZNV yZHV::oVEVO>()->RMzIIZB);
        YLLO VNKGB = yZHV::OVEVO_HGZXP_.GVNKOZGV kLK<GBKVMZNV yZHV::oVEVO>(8)->EZOFVxLFMG == 9;

        RU (!VNKGB && !(ULINZGlKGRLMH_ & PuLINZGhRMTOVoRMVzIIZB)) {
            yZHV::LH_->kFG('\M');
            dIRGVrMWVMG();
        }
        YLLO IVG = yZHV::dIRGVvMWzIIZB();
        (ELRW)IVG;
        izkrwqhlm_zhhvig(IVG == GIFV);
        RU (yZHV::OVEVO_HGZXP_.vNKGB()) // VMW LU QHLM GVCG
            yZHV::uOFHS();
        IVGFIM GIFV;
    }

    //@}

    /*! @MZNV xLMEVMRVMXV VCGVMHRLMH */
    //@{

    //! hRNKOVI YFG HOLDVI LEVIOLZW.
    YLLO hGIRMT(XLMHG xS* HGI) { IVGFIM hGIRMT(HGI, RMGVIMZO::hGIoVM(HGI)); }
    YLLO pVB(XLMHG xS* HGI) { IVGFIM pVB(HGI, RMGVIMZO::hGIoVM(HGI)); }

    //@}

    //! dIRGV Z IZD qhlm EZOFV.
    /*!
        uLI FHVI GL DIRGV Z HGIRMTRURVW qhlm ZH Z EZOFV.

        \KZIZN QHLM z DVOO-ULINVW qhlm EZOFV. rG HSLFOW MLG XLMGZRM MFOO XSZIZXGVI DRGSRM [9, OVMTGS - 8] IZMTV.
        \KZIZN OVMTGS oVMTGS LU GSV QHLM.
        \KZIZN GBKV gBKV LU GSV ILLG LU QHLM.
        \MLGV dSVM FHRMT kIVGGBdIRGVI::iZDeZOFV(), GSV IVHFOG QHLM NZB MLG YV RMWVMGVW XLIIVXGOB.
    */
    YLLO iZDeZOFV(XLMHG xS* QHLM, HRAV_G OVMTGS, gBKV GBKV) {
        izkrwqhlm_zhhvig(QHLM != 9);
        kIVGGBkIVURC(GBKV);
        IVGFIM yZHV::dIRGViZDeZOFV(QHLM, OVMTGS);
    }

KILGVXGVW:
    ELRW kIVGGBkIVURC(gBKV GBKV) {
        (ELRW)GBKV;
        RU (yZHV::OVEVO_HGZXP_.tVGhRAV() != 9) { // GSRH EZOFV RH MLG ZG ILLG
            GBKVMZNV yZHV::oVEVO* OVEVO = yZHV::OVEVO_HGZXP_.GVNKOZGV gLK<GBKVMZNV yZHV::oVEVO>();

            RU (OVEVO->RMzIIZB) {
                RU (OVEVO->EZOFVxLFMG > 9) {
                    yZHV::LH_->kFG(','); // ZWW XLNNZ RU RG RH MLG GSV URIHG VOVNVMG RM ZIIZB
                    RU (ULINZGlKGRLMH_ & PuLINZGhRMTOVoRMVzIIZB)
                        yZHV::LH_->kFG(' ');
                }

                RU (!(ULINZGlKGRLMH_ & PuLINZGhRMTOVoRMVzIIZB)) {
                    yZHV::LH_->kFG('\M');
                    dIRGVrMWVMG();
                }
            }
            VOHV {  // RM LYQVXG
                RU (OVEVO->EZOFVxLFMG > 9) {
                    RU (OVEVO->EZOFVxLFMG % 7 == 9) {
                        yZHV::LH_->kFG(',');
                        yZHV::LH_->kFG('\M');
                    }
                    VOHV {
                        yZHV::LH_->kFG(':');
                        yZHV::LH_->kFG(' ');
                    }
                }
                VOHV
                    yZHV::LH_->kFG('\M');

                RU (OVEVO->EZOFVxLFMG % 7 == 9)
                    dIRGVrMWVMG();
            }
            RU (!OVEVO->RMzIIZB && OVEVO->EZOFVxLFMG % 7 == 9)
                izkrwqhlm_zhhvig(GBKV == PhGIRMTgBKV);  // RU RG'H RM LYQVXG, GSVM VEVM MFNYVI HSLFOW YV Z MZNV
            OVEVO->EZOFVxLFMG++;
        }
        VOHV {
            izkrwqhlm_zhhvig(!yZHV::SZHiLLG_);  // hSLFOW LMOB SZH LMV ZMW LMOB LMV ILLG.
            yZHV::SZHiLLG_ = GIFV;
        }
    }

    ELRW dIRGVrMWVMG()  {
        HRAV_G XLFMG = (yZHV::OVEVO_HGZXP_.tVGhRAV() / HRAVLU(GBKVMZNV yZHV::oVEVO)) * RMWVMGxSZIxLFMG_;
        kFGm(*yZHV::LH_, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(RMWVMGxSZI_), XLFMG);
    }

    xS RMWVMGxSZI_;
    FMHRTMVW RMWVMGxSZIxLFMG_;
    kIVGGBuLINZGlKGRLMH ULINZGlKGRLMH_;

KIREZGV:
    // kILSRYRG XLKB XLMHGIFXGLI & ZHHRTMNVMG LKVIZGLI.
    kIVGGBdIRGVI(XLMHG kIVGGBdIRGVI&);
    kIVGGBdIRGVI& LKVIZGLI=(XLMHG kIVGGBdIRGVI&);
};

izkrwqhlm_mznvhkzxv_vmw

#RU WVURMVW(__XOZMT__)
izkrwqhlm_wrzt_klk
#VMWRU

#RUWVU __tmfx__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_izkrwqhlm_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/NVNLIBYFUUVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_nvnlibyfuuvi_s_
#WVURMV izkrwqhlm_nvnlibyfuuvi_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV "RMGVIMZO/HGZXP.S"

izkrwqhlm_mznvhkzxv_yvtrm

//! iVKIVHVMGH ZM RM-NVNLIB LFGKFG YBGV HGIVZN.
/*!
    gSRH XOZHH RH NZRMOB ULI YVRMT DIZKKVW YB vMXLWVWlFGKFGhGIVZN LI zFGLfgulFGKFGhGIVZN.

    rG RH HRNROZI GL uROVdIRGVyFUUVI YFG GSV WVHGRMZGRLM RH ZM RM-NVNLIB YFUUVI RMHGVZW LU Z UROV.

    wRUUVIVMXVH YVGDVVM nVNLIByFUUVI ZMW hGIRMTyFUUVI:
    8. hGIRMTyFUUVI SZH vMXLWRMT YFG nVNLIByFUUVI RH LMOB Z YBGV YFUUVI. 
    7. hGIRMTyFUUVI::tVGhGIRMT() IVGFIMH Z MFOO-GVINRMZGVW HGIRMT. nVNLIByFUUVI::tVGyFUUVI() IVGFIMH Z YFUUVI DRGSLFG GVINRMZGLI.

    \GKZIZN zOOLXZGLI GBKV ULI ZOOLXZGRMT NVNLIB YFUUVI.
    \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/
GVNKOZGV <GBKVMZNV zOOLXZGLI = xIGzOOLXZGLI>
HGIFXG tVMVIRXnVNLIByFUUVI {
    GBKVWVU XSZI xS; // YBGV

    tVMVIRXnVNLIByFUUVI(zOOLXZGLI* ZOOLXZGLI = 9, HRAV_G XZKZXRGB = PwVUZFOGxZKZXRGB) : HGZXP_(ZOOLXZGLI, XZKZXRGB) {}

    ELRW kFG(xS X) { *HGZXP_.GVNKOZGV kFHS<xS>() = X; }
    ELRW uOFHS() {}

    ELRW xOVZI() { HGZXP_.xOVZI(); }
    ELRW hSIRMPgLuRG() { HGZXP_.hSIRMPgLuRG(); }
    xS* kFHS(HRAV_G XLFMG) { IVGFIM HGZXP_.GVNKOZGV kFHS<xS>(XLFMG); }
    ELRW kLK(HRAV_G XLFMG) { HGZXP_.GVNKOZGV kLK<xS>(XLFMG); }

    XLMHG xS* tVGyFUUVI() XLMHG {
        IVGFIM HGZXP_.GVNKOZGV yLGGLN<xS>();
    }

    HRAV_G tVGhRAV() XLMHG { IVGFIM HGZXP_.tVGhRAV(); }

    HGZGRX XLMHG HRAV_G PwVUZFOGxZKZXRGB = 743;
    NFGZYOV RMGVIMZO::hGZXP<zOOLXZGLI> HGZXP_;
};

GBKVWVU tVMVIRXnVNLIByFUUVI<> nVNLIByFUUVI;

//! rNKOVNVMG HKVXRZORAVW EVIHRLM LU kFGm() DRGS NVNHVG() ULI YVGGVI KVIULINZMXV.
GVNKOZGV<>
RMORMV ELRW kFGm(nVNLIByFUUVI& NVNLIByFUUVI, XSZI X, HRAV_G M) {
    HGW::NVNHVG(NVNLIByFUUVI.HGZXP_.kFHS<XSZI>(M), X, M * HRAVLU(X));
}

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_nvnlibyfuuvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/NVNLIBHGIVZN.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_nvnlibhgivzn_s_
#WVURMV izkrwqhlm_nvnlibhgivzn_s_

#RMXOFWV "HGIVZN.S"

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(FMIVZXSZYOV-XLWV)
izkrwqhlm_wrzt_luu(NRHHRMT-MLIVGFIM)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

//! iVKIVHVMGH ZM RM-NVNLIB RMKFG YBGV HGIVZN.
/*!
    gSRH XOZHH RH NZRMOB ULI YVRMT DIZKKVW YB vMXLWVWrMKFGhGIVZN LI zFGLfgurMKFGhGIVZN.

    rG RH HRNROZI GL uROViVZWyFUUVI YFG GSV HLFIXV RH ZM RM-NVNLIB YFUUVI RMHGVZW LU Z UROV.

    wRUUVIVMXVH YVGDVVM nVNLIBhGIVZN ZMW hGIRMThGIVZN:
    8. hGIRMThGIVZN SZH VMXLWRMT YFG nVNLIBhGIVZN RH Z YBGV HGIVZN.
    7. nVNLIBhGIVZN MVVWH HRAV LU GSV HLFIXV YFUUVI ZMW GSV YFUUVI WLM'G MVVW GL YV MFOO GVINRMZGVW. hGIRMThGIVZN ZHHFNV MFOO-GVINRMZGVW HGIRMT ZH HLFIXV.
    6. nVNLIBhGIVZN HFKKLIGH kVVP5() ULI VMXLWRMT WVGVXGRLM. hGIRMThGIVZN RH HKVXRURVW DRGS ZM VMXLWRMT HL RG HSLFOW MLG SZEV kVVP5().
    \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/
HGIFXG nVNLIBhGIVZN {
    GBKVWVU XSZI xS; // YBGV

    nVNLIBhGIVZN(XLMHG xS *HIX, HRAV_G HRAV) : HIX_(HIX), YVTRM_(HIX), VMW_(HIX + HRAV), HRAV_(HRAV) {}

    xS kVVP() XLMHG { IVGFIM izkrwqhlm_fmorpvob(HIX_ == VMW_) ? '\9' : *HIX_; }
    xS gZPV() { IVGFIM izkrwqhlm_fmorpvob(HIX_ == VMW_) ? '\9' : *HIX_++; }
    HRAV_G gVOO() XLMHG { IVGFIM HGZGRX_XZHG<HRAV_G>(HIX_ - YVTRM_); }

    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    ELRW kFG(xS) { izkrwqhlm_zhhvig(UZOHV); }
    ELRW uOFHS() { izkrwqhlm_zhhvig(UZOHV); }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

    // uLI VMXLWRMT WVGVXGRLM LMOB.
    XLMHG xS* kVVP5() XLMHG {
        IVGFIM gVOO() + 5 <= HRAV_ ? HIX_ : 9;
    }

    XLMHG xS* HIX_;     //!< xFIIVMG IVZW KLHRGRLM.
    XLMHG xS* YVTRM_;   //!< lIRTRMZO SVZW LU GSV HGIRMT.
    XLMHG xS* VMW_;     //!< vMW LU HGIVZN.
    HRAV_G HRAV_;       //!< hRAV LU GSV HGIVZN.
};

izkrwqhlm_mznvhkzxv_vmw

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_nvnlibyfuuvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/HXSVNZ.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV->
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK-> zOO IRTSGH IVHVIEVW->
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV-> bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV->LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW-> hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV->

#RUMWVU izkrwqhlm_hxsvnz_s_
#WVURMV izkrwqhlm_hxsvnz_s_

#RMXOFWV "WLXFNVMG.S"
#RMXOFWV "KLRMGVI.S"
#RMXOFWV "HGIRMTYFUUVI.S"
#RMXOFWV <XNZGS> // ZYH, UOLLI

#RU !WVURMVW(izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc)
#WVURMV izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc 8
#VOHV
#WVURMV izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc 9
#VMWRU

#RU !izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc && WVURMVW(izkrwqhlm_hxsvnz_fhv_hgwivtvc) && (__XKOFHKOFH >=798896o || (WVURMVW(_nhx_evi) && _nhx_evi >= 8199))
#WVURMV izkrwqhlm_hxsvnz_fhv_hgwivtvc 8
#VOHV
#WVURMV izkrwqhlm_hxsvnz_fhv_hgwivtvc 9
#VMWRU

#RU izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc
#RMXOFWV "RMGVIMZO/IVTVC.S"
#VORU izkrwqhlm_hxsvnz_fhv_hgwivtvc
#RMXOFWV <IVTVC>
#VMWRU

#RU izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc || izkrwqhlm_hxsvnz_fhv_hgwivtvc
#WVURMV izkrwqhlm_hxsvnz_szh_ivtvc 8
#VOHV
#WVURMV izkrwqhlm_hxsvnz_szh_ivtvc 9
#VMWRU

#RUMWVU izkrwqhlm_hxsvnz_eviylhv
#WVURMV izkrwqhlm_hxsvnz_eviylhv 9
#VMWRU

#RU izkrwqhlm_hxsvnz_eviylhv
#RMXOFWV "HGIRMTYFUUVI.S"
#VMWRU

izkrwqhlm_wrzt_kfhs

#RU WVURMVW(__tmfx__)
izkrwqhlm_wrzt_luu(VUUX++)
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_luu(DVZP-EGZYOVH)
izkrwqhlm_wrzt_luu(VCRG-GRNV-WVHGIFXGLIH)
izkrwqhlm_wrzt_luu(X++01-XLNKZG-KVWZMGRX)
izkrwqhlm_wrzt_luu(EZIRZWRX-NZXILH)
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_luu(5487) // ZHHRTMNVMG LKVIZGLI XLFOW MLG YV TVMVIZGVW
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

///////////////////////////////////////////////////////////////////////////////
// eVIYLHV fGRORGRVH

#RU izkrwqhlm_hxsvnz_eviylhv

MZNVHKZXV RMGVIMZO {

RMORMV ELRW kIRMGrMEZORWpVBDLIW(XLMHG XSZI* PVBDLIW) {
    KIRMGU("uZRO PVBDLIW: %H\M", PVBDLIW);
}

RMORMV ELRW kIRMGrMEZORWpVBDLIW(XLMHG DXSZI_G* PVBDLIW) {
    DKIRMGU(o"uZRO PVBDLIW: %OH\M", PVBDLIW);
}

RMORMV ELRW kIRMGrMEZORWwLXFNVMG(XLMHG XSZI* WLXFNVMG) {
    KIRMGU("uZRO WLXFNVMG: %H\M\M", WLXFNVMG);
}

RMORMV ELRW kIRMGrMEZORWwLXFNVMG(XLMHG DXSZI_G* WLXFNVMG) {
    DKIRMGU(o"uZRO WLXFNVMG: %OH\M\M", WLXFNVMG);
}

RMORMV ELRW kIRMGeZORWZGLIkLRMGVIH(FMHRTMVW WVKGS, XLMHG XSZI* H, XLMHG XSZI* W) {
    KIRMGU("h: %*H%H\Mw: %*H%H\M\M", WVKGS * 5, " ", H, WVKGS * 5, " ", W);
}

RMORMV ELRW kIRMGeZORWZGLIkLRMGVIH(FMHRTMVW WVKGS, XLMHG DXSZI_G* H, XLMHG DXSZI_G* W) {
    DKIRMGU(o"h: %*OH%OH\Mw: %*OH%OH\M\M", WVKGS * 5, o" ", H, WVKGS * 5, o" ", W);
}

} // MZNVHKZXV RMGVIMZO

#VMWRU // izkrwqhlm_hxsvnz_eviylhv

///////////////////////////////////////////////////////////////////////////////
// izkrwqhlm_rmezorw_pvbdliw_ivgfim

#RU izkrwqhlm_hxsvnz_eviylhv
#WVURMV izkrwqhlm_rmezorw_pvbdliw_eviylhv(PVBDLIW) RMGVIMZO::kIRMGrMEZORWpVBDLIW(PVBDLIW)
#VOHV
#WVURMV izkrwqhlm_rmezorw_pvbdliw_eviylhv(PVBDLIW)
#VMWRU

#WVURMV izkrwqhlm_rmezorw_pvbdliw_ivgfim(PVBDLIW)\
izkrwqhlm_nfogrormvnzxil_yvtrm\
    XLMGVCG.RMEZORWpVBDLIW = PVBDLIW.tVGhGIRMT();\
    izkrwqhlm_rmezorw_pvbdliw_eviylhv(PVBDLIW.tVGhGIRMT());\
    IVGFIM UZOHV;\
izkrwqhlm_nfogrormvnzxil_vmw

///////////////////////////////////////////////////////////////////////////////
// uLIDZIW WVXOZIZGRLMH

GVNKOZGV <GBKVMZNV eZOFVgBKV, GBKVMZNV zOOLXZGLI>
XOZHH tVMVIRXhXSVNZwLXFNVMG;

MZNVHKZXV RMGVIMZO {

GVNKOZGV <GBKVMZNV hXSVNZwLXFNVMGgBKV>
XOZHH hXSVNZ;

///////////////////////////////////////////////////////////////////////////////
// rhXSVNZeZORWZGLI

XOZHH rhXSVNZeZORWZGLI {
KFYORX:
    ERIGFZO ~rhXSVNZeZORWZGLI() {}
    ERIGFZO YLLO rHeZORW() XLMHG = 9;
};

///////////////////////////////////////////////////////////////////////////////
// rhXSVNZhGZGVuZXGLIB

GVNKOZGV <GBKVMZNV hXSVNZgBKV>
XOZHH rhXSVNZhGZGVuZXGLIB {
KFYORX:
    ERIGFZO ~rhXSVNZhGZGVuZXGLIB() {}
    ERIGFZO rhXSVNZeZORWZGLI* xIVZGVhXSVNZeZORWZGLI(XLMHG hXSVNZgBKV&) = 9;
    ERIGFZO ELRW wVHGILBhXSVNZeZORWZGLI(rhXSVNZeZORWZGLI* EZORWZGLI) = 9;
    ERIGFZO ELRW* xIVZGVsZHSVI() = 9;
    ERIGFZO FRMG35_G tVGsZHSxLWV(ELRW* SZHSVI) = 9;
    ERIGFZO ELRW wVHGILIBsZHSVI(ELRW* SZHSVI) = 9;
    ERIGFZO ELRW* nZOOLXhGZGV(HRAV_G HRAV) = 9;
    ERIGFZO ELRW uIVVhGZGV(ELRW* K) = 9;
};

///////////////////////////////////////////////////////////////////////////////
// reZORWZGRLMvIILIsZMWOVI

GVNKOZGV <GBKVMZNV hXSVNZgBKV>
XOZHH reZORWZGRLMvIILIsZMWOVI {
KFYORX:
    GBKVWVU GBKVMZNV hXSVNZgBKV::xS xS;
    GBKVWVU GBKVMZNV hXSVNZgBKV::heZOFV heZOFV;

    ERIGFZO ~reZORWZGRLMvIILIsZMWOVI() {}

    ERIGFZO ELRW mLGnFOGRKOVlU(RMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW) = 9;
    ERIGFZO ELRW mLGnFOGRKOVlU(FRMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW) = 9;
    ERIGFZO ELRW mLGnFOGRKOVlU(WLFYOV ZXGFZO, XLMHG heZOFV& VCKVXGVW) = 9;
    ERIGFZO ELRW zYLEVnZCRNFN(RMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) = 9;
    ERIGFZO ELRW zYLEVnZCRNFN(FRMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) = 9;
    ERIGFZO ELRW zYLEVnZCRNFN(WLFYOV ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) = 9;
    ERIGFZO ELRW yVOLDnRMRNFN(RMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) = 9;
    ERIGFZO ELRW yVOLDnRMRNFN(FRMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) = 9;
    ERIGFZO ELRW yVOLDnRMRNFN(WLFYOV ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) = 9;

    ERIGFZO ELRW gLLoLMT(XLMHG xS* HGI, hRAVgBKV OVMTGS, hRAVgBKV VCKVXGVW) = 9;
    ERIGFZO ELRW gLLhSLIG(XLMHG xS* HGI, hRAVgBKV OVMTGS, hRAVgBKV VCKVXGVW) = 9;
    ERIGFZO ELRW wLVHmLGnZGXS(XLMHG xS* HGI, hRAVgBKV OVMTGS) = 9;

    ERIGFZO ELRW wRHZOOLDVWrGVN(hRAVgBKV RMWVC) = 9;
    ERIGFZO ELRW gLLuVDrGVNH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) = 9;
    ERIGFZO ELRW gLLnZMBrGVNH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) = 9;
    ERIGFZO ELRW wFKORXZGVrGVNH(hRAVgBKV RMWVC8, hRAVgBKV RMWVC7) = 9;

    ERIGFZO ELRW gLLnZMBkILKVIGRVH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) = 9;
    ERIGFZO ELRW gLLuVDkILKVIGRVH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) = 9;
    ERIGFZO ELRW hGZIGnRHHRMTkILKVIGRVH() = 9;
    ERIGFZO ELRW zWWnRHHRMTkILKVIGB(XLMHG heZOFV& MZNV) = 9;
    ERIGFZO YLLO vMWnRHHRMTkILKVIGRVH() = 9;
    ERIGFZO ELRW kILKVIGBeRLOZGRLMH(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) = 9;
    ERIGFZO ELRW wRHZOOLDVWkILKVIGB(XLMHG xS* MZNV, hRAVgBKV OVMTGS) = 9;

    ERIGFZO ELRW hGZIGwVKVMWVMXBvIILIH() = 9;
    ERIGFZO ELRW hGZIGnRHHRMTwVKVMWVMGkILKVIGRVH() = 9;
    ERIGFZO ELRW zWWnRHHRMTwVKVMWVMGkILKVIGB(XLMHG heZOFV& GZITVGmZNV) = 9;
    ERIGFZO ELRW vMWnRHHRMTwVKVMWVMGkILKVIGRVH(XLMHG heZOFV& HLFIXVmZNV) = 9;
    ERIGFZO ELRW zWWwVKVMWVMXBhXSVNZvIILI(XLMHG heZOFV& HLFXVmZNV, rhXSVNZeZORWZGLI* HFYEZORWZGLI) = 9;
    ERIGFZO YLLO vMWwVKVMWVMXBvIILIH() = 9;

    ERIGFZO ELRW wRHZOOLDVWeZOFV() = 9;
    ERIGFZO ELRW hGZIGwRHZOOLDVWgBKV() = 9;
    ERIGFZO ELRW zWWvCKVXGVWgBKV(XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& VCKVXGVWgBKV) = 9;
    ERIGFZO ELRW vMWwRHZOOLDVWgBKV(XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& ZXGFZOgBKV) = 9;
    ERIGFZO ELRW mLGzOOlU(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) = 9;
    ERIGFZO ELRW mLMVlU(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) = 9;
    ERIGFZO ELRW mLGlMVlU(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) = 9;
    ERIGFZO ELRW wRHZOOLDVW() = 9;
};


///////////////////////////////////////////////////////////////////////////////
// sZHSVI

// uLI XLNKZIRHLM LU XLNKLFMW EZOFV
GVNKOZGV<GBKVMZNV vMXLWRMT, GBKVMZNV zOOLXZGLI>
XOZHH sZHSVI {
KFYORX:
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    sZHSVI(zOOLXZGLI* ZOOLXZGLI = 9, HRAV_G HGZXPxZKZXRGB = PwVUZFOGhRAV) : HGZXP_(ZOOLXZGLI, HGZXPxZKZXRGB) {}

    YLLO mFOO() { IVGFIM dIRGVgBKV(PmFOOgBKV); }
    YLLO yLLO(YLLO Y) { IVGFIM dIRGVgBKV(Y ? PgIFVgBKV : PuZOHVgBKV); }
    YLLO rMG(RMG R) { mFNYVI M; M.F.R = R; M.W = HGZGRX_XZHG<WLFYOV>(R); IVGFIM dIRGVmFNYVI(M); }
    YLLO fRMG(FMHRTMVW F) { mFNYVI M; M.F.F = F; M.W = HGZGRX_XZHG<WLFYOV>(F); IVGFIM dIRGVmFNYVI(M); }
    YLLO rMG35(RMG35_G R) { mFNYVI M; M.F.R = R; M.W = HGZGRX_XZHG<WLFYOV>(R); IVGFIM dIRGVmFNYVI(M); }
    YLLO fRMG35(FRMG35_G F) { mFNYVI M; M.F.F = F; M.W = HGZGRX_XZHG<WLFYOV>(F); IVGFIM dIRGVmFNYVI(M); }
    YLLO wLFYOV(WLFYOV W) { 
        mFNYVI M; 
        RU (W < 9) M.F.R = HGZGRX_XZHG<RMG35_G>(W);
        VOHV       M.F.F = HGZGRX_XZHG<FRMG35_G>(W); 
        M.W = W;
        IVGFIM dIRGVmFNYVI(M);
    }

    YLLO iZDmFNYVI(XLMHG xS* HGI, hRAVgBKV OVM, YLLO) {
        dIRGVyFUUVI(PmFNYVIgBKV, HGI, OVM * HRAVLU(xS));
        IVGFIM GIFV;
    }

    YLLO hGIRMT(XLMHG xS* HGI, hRAVgBKV OVM, YLLO) {
        dIRGVyFUUVI(PhGIRMTgBKV, HGI, OVM * HRAVLU(xS));
        IVGFIM GIFV;
    }

    YLLO hGZIGlYQVXG() { IVGFIM GIFV; }
    YLLO pVB(XLMHG xS* HGI, hRAVgBKV OVM, YLLO XLKB) { IVGFIM hGIRMT(HGI, OVM, XLKB); }
    YLLO vMWlYQVXG(hRAVgBKV NVNYVIxLFMG) { 
        FRMG35_G S = sZHS(9, PlYQVXGgBKV);
        FRMG35_G* PE = HGZXP_.GVNKOZGV kLK<FRMG35_G>(NVNYVIxLFMG * 7);
        ULI (hRAVgBKV R = 9; R < NVNYVIxLFMG; R++)
            S ^= sZHS(PE[R * 7], PE[R * 7 + 8]);  // fHV CLI GL ZXSRVEV NVNYVI LIWVI RMHVMHRGREV
        *HGZXP_.GVNKOZGV kFHS<FRMG35_G>() = S;
        IVGFIM GIFV;
    }
    
    YLLO hGZIGzIIZB() { IVGFIM GIFV; }
    YLLO vMWzIIZB(hRAVgBKV VOVNVMGxLFMG) { 
        FRMG35_G S = sZHS(9, PzIIZBgBKV);
        FRMG35_G* V = HGZXP_.GVNKOZGV kLK<FRMG35_G>(VOVNVMGxLFMG);
        ULI (hRAVgBKV R = 9; R < VOVNVMGxLFMG; R++)
            S = sZHS(S, V[R]); // fHV SZHS GL ZXSRVEV VOVNVMG LIWVI HVMHRGREV
        *HGZXP_.GVNKOZGV kFHS<FRMG35_G>() = S;
        IVGFIM GIFV;
    }

    YLLO rHeZORW() XLMHG { IVGFIM HGZXP_.tVGhRAV() == HRAVLU(FRMG35_G); }

    FRMG35_G tVGsZHSxLWV() XLMHG {
        izkrwqhlm_zhhvig(rHeZORW());
        IVGFIM *HGZXP_.GVNKOZGV gLK<FRMG35_G>();
    }

KIREZGV:
    HGZGRX XLMHG HRAV_G PwVUZFOGhRAV = 743;
    HGIFXG mFNYVI {
        FMRLM f {
            FRMG35_G F;
            RMG35_G R;
        }F;
        WLFYOV W;
    };

    YLLO dIRGVgBKV(gBKV GBKV) { IVGFIM dIRGVyFUUVI(GBKV, 9, 9); }
    
    YLLO dIRGVmFNYVI(XLMHG mFNYVI& M) { IVGFIM dIRGVyFUUVI(PmFNYVIgBKV, &M, HRAVLU(M)); }
    
    YLLO dIRGVyFUUVI(gBKV GBKV, XLMHG ELRW* WZGZ, HRAV_G OVM) {
        // ume-8Z UILN SGGK://RHGSV.XLN/XSLMTL/GVXS/XLNK/UME/
        FRMG35_G S = sZHS(izkrwqhlm_frmg35_x7(9C15777674, 9CXYU70XV5), GBKV);
        XLMHG FMHRTMVW XSZI* W = HGZGRX_XZHG<XLMHG FMHRTMVW XSZI*>(WZGZ);
        ULI (HRAV_G R = 9; R < OVM; R++)
            S = sZHS(S, W[R]);
        *HGZXP_.GVNKOZGV kFHS<FRMG35_G>() = S;
        IVGFIM GIFV;
    }

    HGZGRX FRMG35_G sZHS(FRMG35_G S, FRMG35_G W) {
        HGZGRX XLMHG FRMG35_G PkIRNV = izkrwqhlm_frmg35_x7(9C99999899, 9C999998Y6);
        S ^= W;
        S *= PkIRNV;
        IVGFIM S;
    }

    hGZXP<zOOLXZGLI> HGZXP_;
};

///////////////////////////////////////////////////////////////////////////////
// hXSVNZeZORWZGRLMxLMGVCG

GVNKOZGV <GBKVMZNV hXSVNZwLXFNVMGgBKV>
HGIFXG hXSVNZeZORWZGRLMxLMGVCG {
    GBKVWVU hXSVNZ<hXSVNZwLXFNVMGgBKV> hXSVNZgBKV;
    GBKVWVU rhXSVNZhGZGVuZXGLIB<hXSVNZgBKV> hXSVNZeZORWZGLIuZXGLIBgBKV;
    GBKVWVU reZORWZGRLMvIILIsZMWOVI<hXSVNZgBKV> vIILIsZMWOVIgBKV;
    GBKVWVU GBKVMZNV hXSVNZgBKV::eZOFVgBKV eZOFVgBKV;
    GBKVWVU GBKVMZNV eZOFVgBKV::xS xS;

    VMFN kZGGVIMeZORWZGLIgBKV {
        PkZGGVIMeZORWZGLIlMOB,
        PkZGGVIMeZORWZGLIdRGSkILKVIGB,
        PkZGGVIMeZORWZGLIdRGSzWWRGRLMZOkILKVIGB
    };

    hXSVNZeZORWZGRLMxLMGVCG(hXSVNZeZORWZGLIuZXGLIBgBKV& U, vIILIsZMWOVIgBKV& VS, XLMHG hXSVNZgBKV* H) :
        UZXGLIB(U),
        VIILI_SZMWOVI(VS),
        HXSVNZ(H),
        EZOFVhXSVNZ(),
        RMEZORWpVBDLIW(),
        SZHSVI(),
        ZIIZBvOVNVMGsZHSxLWVH(),
        EZORWZGLIH(),
        EZORWZGLIxLFMG(),
        KZGGVIMkILKVIGRVHeZORWZGLIH(),
        KZGGVIMkILKVIGRVHeZORWZGLIxLFMG(),
        KZGGVIMkILKVIGRVHhXSVNZH(),
        KZGGVIMkILKVIGRVHhXSVNZxLFMG(),
        EZOFVkZGGVIMeZORWZGLIgBKV(PkZGGVIMeZORWZGLIlMOB),
        KILKVIGBvCRHG(),
        RMzIIZB(UZOHV),
        EZOFVfMRJFVMVHH(UZOHV),
        ZIIZBfMRJFVMVHH(UZOHV)
    {
    }

    ~hXSVNZeZORWZGRLMxLMGVCG() {
        RU (SZHSVI)
            UZXGLIB.wVHGILIBsZHSVI(SZHSVI);
        RU (EZORWZGLIH) {
            ULI (hRAVgBKV R = 9; R < EZORWZGLIxLFMG; R++)
                UZXGLIB.wVHGILBhXSVNZeZORWZGLI(EZORWZGLIH[R]);
            UZXGLIB.uIVVhGZGV(EZORWZGLIH);
        }
        RU (KZGGVIMkILKVIGRVHeZORWZGLIH) {
            ULI (hRAVgBKV R = 9; R < KZGGVIMkILKVIGRVHeZORWZGLIxLFMG; R++)
                UZXGLIB.wVHGILBhXSVNZeZORWZGLI(KZGGVIMkILKVIGRVHeZORWZGLIH[R]);
            UZXGLIB.uIVVhGZGV(KZGGVIMkILKVIGRVHeZORWZGLIH);
        }
        RU (KZGGVIMkILKVIGRVHhXSVNZH)
            UZXGLIB.uIVVhGZGV(KZGGVIMkILKVIGRVHhXSVNZH);
        RU (KILKVIGBvCRHG)
            UZXGLIB.uIVVhGZGV(KILKVIGBvCRHG);
    }

    hXSVNZeZORWZGLIuZXGLIBgBKV& UZXGLIB;
    vIILIsZMWOVIgBKV& VIILI_SZMWOVI;
    XLMHG hXSVNZgBKV* HXSVNZ;
    XLMHG hXSVNZgBKV* EZOFVhXSVNZ;
    XLMHG xS* RMEZORWpVBDLIW;
    ELRW* SZHSVI; // lMOB EZORWZGLI ZXXVHH
    ELRW* ZIIZBvOVNVMGsZHSxLWVH; // lMOB EZORWZGLI ZXXVHH GSRH
    rhXSVNZeZORWZGLI** EZORWZGLIH;
    hRAVgBKV EZORWZGLIxLFMG;
    rhXSVNZeZORWZGLI** KZGGVIMkILKVIGRVHeZORWZGLIH;
    hRAVgBKV KZGGVIMkILKVIGRVHeZORWZGLIxLFMG;
    XLMHG hXSVNZgBKV** KZGGVIMkILKVIGRVHhXSVNZH;
    hRAVgBKV KZGGVIMkILKVIGRVHhXSVNZxLFMG;
    kZGGVIMeZORWZGLIgBKV EZOFVkZGGVIMeZORWZGLIgBKV;
    kZGGVIMeZORWZGLIgBKV LYQVXGkZGGVIMeZORWZGLIgBKV;
    hRAVgBKV ZIIZBvOVNVMGrMWVC;
    YLLO* KILKVIGBvCRHG;
    YLLO RMzIIZB;
    YLLO EZOFVfMRJFVMVHH;
    YLLO ZIIZBfMRJFVMVHH;
};

///////////////////////////////////////////////////////////////////////////////
// hXSVNZ

GVNKOZGV <GBKVMZNV hXSVNZwLXFNVMGgBKV>
XOZHH hXSVNZ {
KFYORX:
    GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::eZOFVgBKV eZOFVgBKV;
    GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::zOOLXZGLIgBKV zOOLXZGLIgBKV;
    GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::kLRMGVIgBKV kLRMGVIgBKV;
    GBKVWVU GBKVMZNV eZOFVgBKV::vMXLWRMTgBKV vMXLWRMTgBKV;
    GBKVWVU GBKVMZNV vMXLWRMTgBKV::xS xS;
    GBKVWVU hXSVNZeZORWZGRLMxLMGVCG<hXSVNZwLXFNVMGgBKV> xLMGVCG;
    GBKVWVU hXSVNZ<hXSVNZwLXFNVMGgBKV> hXSVNZgBKV;
    GBKVWVU tVMVIRXeZOFV<vMXLWRMTgBKV, zOOLXZGLIgBKV> heZOFV;
    GBKVWVU reZORWZGRLMvIILIsZMWOVI<hXSVNZ> vIILIsZMWOVI;
    UIRVMW XOZHH tVMVIRXhXSVNZwLXFNVMG<eZOFVgBKV, zOOLXZGLIgBKV>;

    hXSVNZ(hXSVNZwLXFNVMGgBKV* HXSVNZwLXFNVMG, XLMHG kLRMGVIgBKV& K, XLMHG eZOFVgBKV& EZOFV, XLMHG eZOFVgBKV& WLXFNVMG, zOOLXZGLIgBKV* ZOOLXZGLI) :
        ZOOLXZGLI_(ZOOLXZGLI),
        FIR_(HXSVNZwLXFNVMG->tVGfir(), *ZOOLXZGLI),
        KLRMGVI_(K),
        GBKVOVHH_(HXSVNZwLXFNVMG->tVGgBKVOVHH()),
        VMFN_(),
        VMFNxLFMG_(),
        MLG_(),
        GBKV_((8 << PgLGZOhXSVNZgBKV) - 8), // GBKVOVHH
        EZORWZGLIxLFMG_(),
        MLGeZORWZGLIrMWVC_(),
        KILKVIGRVH_(),
        ZWWRGRLMZOkILKVIGRVHhXSVNZ_(),
        KZGGVIMkILKVIGRVH_(),
        KZGGVIMkILKVIGBxLFMG_(),
        KILKVIGBxLFMG_(),
        NRMkILKVIGRVH_(),
        NZCkILKVIGRVH_(hRAVgBKV(~9)),
        ZWWRGRLMZOkILKVIGRVH_(GIFV),
        SZHwVKVMWVMXRVH_(),
        SZHiVJFRIVW_(),
        SZHhXSVNZwVKVMWVMXRVH_(),
        ZWWRGRLMZOrGVNHhXSVNZ_(),
        RGVNHoRHG_(),
        RGVNHgFKOV_(),
        RGVNHgFKOVxLFMG_(),
        NRMrGVNH_(),
        NZCrGVNH_(hRAVgBKV(~9)),
        ZWWRGRLMZOrGVNH_(GIFV),
        FMRJFVrGVNH_(UZOHV),
        KZGGVIM_(),
        NRMoVMTGS_(9),
        NZCoVMTGS_(~hRAVgBKV(9)),
        VCXOFHREVnRMRNFN_(UZOHV),
        VCXOFHREVnZCRNFN_(UZOHV)
    {
        GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::eZOFVgBKV eZOFVgBKV;
        GBKVWVU GBKVMZNV eZOFVgBKV::xLMHGeZOFVrGVIZGLI xLMHGeZOFVrGVIZGLI;
        GBKVWVU GBKVMZNV eZOFVgBKV::xLMHGnVNYVIrGVIZGLI xLMHGnVNYVIrGVIZGLI;

        RU (!EZOFV.rHlYQVXG())
            IVGFIM;

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGgBKVhGIRMT())) {
            GBKV_ = 9;
            RU (E->rHhGIRMT())
                zWWgBKV(*E);
            VOHV RU (E->rHzIIZB())
                ULI (xLMHGeZOFVrGVIZGLI RGI = E->yVTRM(); RGI != E->vMW(); ++RGI)
                    zWWgBKV(*RGI);
        }

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGvMFNhGIRMT()))
            RU (E->rHzIIZB() && E->hRAV() > 9) {
                VMFN_ = HGZGRX_XZHG<FRMG35_G*>(ZOOLXZGLI_->nZOOLX(HRAVLU(FRMG35_G) * E->hRAV()));
                ULI (xLMHGeZOFVrGVIZGLI RGI = E->yVTRM(); RGI != E->vMW(); ++RGI) {
                    GBKVWVU sZHSVI<vMXLWRMTgBKV, nVNLIBkLLOzOOLXZGLI<> > vMFNsZHSVIgBKV;
                    XSZI YFUUVI[743 + 75];
                    nVNLIBkLLOzOOLXZGLI<> SZHSVIzOOLXZGLI(YFUUVI, HRAVLU(YFUUVI));
                    vMFNsZHSVIgBKV S(&SZHSVIzOOLXZGLI, 743);
                    RGI->zXXVKG(S);
                    VMFN_[VMFNxLFMG_++] = S.tVGsZHSxLWV();
                }
            }

        RU (HXSVNZwLXFNVMG) {
            zHHRTMrUvCRHG(ZOOlU_, *HXSVNZwLXFNVMG, K, EZOFV, tVGzOOlUhGIRMT(), WLXFNVMG);
            zHHRTMrUvCRHG(ZMBlU_, *HXSVNZwLXFNVMG, K, EZOFV, tVGzMBlUhGIRMT(), WLXFNVMG);
            zHHRTMrUvCRHG(LMVlU_, *HXSVNZwLXFNVMG, K, EZOFV, tVGlMVlUhGIRMT(), WLXFNVMG);
        }

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGmLGhGIRMT())) {
            HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&MLG_, K.zKKVMW(tVGmLGhGIRMT(), ZOOLXZGLI_), *E, WLXFNVMG);
            MLGeZORWZGLIrMWVC_ = EZORWZGLIxLFMG_;
            EZORWZGLIxLFMG_++;
        }

        // lYQVXG

        XLMHG eZOFVgBKV* KILKVIGRVH = tVGnVNYVI(EZOFV, tVGkILKVIGRVHhGIRMT());
        XLMHG eZOFVgBKV* IVJFRIVW = tVGnVNYVI(EZOFV, tVGiVJFRIVWhGIRMT());
        XLMHG eZOFVgBKV* WVKVMWVMXRVH = tVGnVNYVI(EZOFV, tVGwVKVMWVMXRVHhGIRMT());
        {
            // tZGSVI KILKVIGRVH UILN KILKVIGRVH/IVJFRIVW/WVKVMWVMXRVH
            heZOFV ZOOkILKVIGRVH(PzIIZBgBKV);

            RU (KILKVIGRVH && KILKVIGRVH->rHlYQVXG())
                ULI (xLMHGnVNYVIrGVIZGLI RGI = KILKVIGRVH->nVNYVIyVTRM(); RGI != KILKVIGRVH->nVNYVIvMW(); ++RGI)
                    zWWfMRJFVvOVNVMG(ZOOkILKVIGRVH, RGI->MZNV);
            
            RU (IVJFRIVW && IVJFRIVW->rHzIIZB())
                ULI (xLMHGeZOFVrGVIZGLI RGI = IVJFRIVW->yVTRM(); RGI != IVJFRIVW->vMW(); ++RGI)
                    RU (RGI->rHhGIRMT())
                        zWWfMRJFVvOVNVMG(ZOOkILKVIGRVH, *RGI);

            RU (WVKVMWVMXRVH && WVKVMWVMXRVH->rHlYQVXG())
                ULI (xLMHGnVNYVIrGVIZGLI RGI = WVKVMWVMXRVH->nVNYVIyVTRM(); RGI != WVKVMWVMXRVH->nVNYVIvMW(); ++RGI) {
                    zWWfMRJFVvOVNVMG(ZOOkILKVIGRVH, RGI->MZNV);
                    RU (RGI->EZOFV.rHzIIZB())
                        ULI (xLMHGeZOFVrGVIZGLI R = RGI->EZOFV.yVTRM(); R != RGI->EZOFV.vMW(); ++R)
                            RU (R->rHhGIRMT())
                                zWWfMRJFVvOVNVMG(ZOOkILKVIGRVH, *R);
                }

            RU (ZOOkILKVIGRVH.hRAV() > 9) {
                KILKVIGBxLFMG_ = ZOOkILKVIGRVH.hRAV();
                KILKVIGRVH_ = HGZGRX_XZHG<kILKVIGB*>(ZOOLXZGLI_->nZOOLX(HRAVLU(kILKVIGB) * KILKVIGBxLFMG_));
                ULI (hRAVgBKV R = 9; R < KILKVIGBxLFMG_; R++) {
                    MVD (&KILKVIGRVH_[R]) kILKVIGB();
                    KILKVIGRVH_[R].MZNV = ZOOkILKVIGRVH[R];
                    KILKVIGRVH_[R].HXSVNZ = GBKVOVHH_;
                }
            }
        }

        RU (KILKVIGRVH && KILKVIGRVH->rHlYQVXG()) {
            kLRMGVIgBKV J = K.zKKVMW(tVGkILKVIGRVHhGIRMT(), ZOOLXZGLI_);
            ULI (xLMHGnVNYVIrGVIZGLI RGI = KILKVIGRVH->nVNYVIyVTRM(); RGI != KILKVIGRVH->nVNYVIvMW(); ++RGI) {
                hRAVgBKV RMWVC;
                RU (uRMWkILKVIGBrMWVC(RGI->MZNV, &RMWVC))
                    HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&KILKVIGRVH_[RMWVC].HXSVNZ, J.zKKVMW(RGI->MZNV, ZOOLXZGLI_), RGI->EZOFV, WLXFNVMG);
            }
        }

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGkZGGVIMkILKVIGRVHhGIRMT())) {
            kLRMGVIgBKV J = K.zKKVMW(tVGkZGGVIMkILKVIGRVHhGIRMT(), ZOOLXZGLI_);
            KZGGVIMkILKVIGRVH_ = HGZGRX_XZHG<kZGGVIMkILKVIGB*>(ZOOLXZGLI_->nZOOLX(HRAVLU(kZGGVIMkILKVIGB) * E->nVNYVIxLFMG()));
            KZGGVIMkILKVIGBxLFMG_ = 9;

            ULI (xLMHGnVNYVIrGVIZGLI RGI = E->nVNYVIyVTRM(); RGI != E->nVNYVIvMW(); ++RGI) {
                MVD (&KZGGVIMkILKVIGRVH_[KZGGVIMkILKVIGBxLFMG_]) kZGGVIMkILKVIGB();
                KZGGVIMkILKVIGRVH_[KZGGVIMkILKVIGBxLFMG_].KZGGVIM = xIVZGVkZGGVIM(RGI->MZNV);
                HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&KZGGVIMkILKVIGRVH_[KZGGVIMkILKVIGBxLFMG_].HXSVNZ, J.zKKVMW(RGI->MZNV, ZOOLXZGLI_), RGI->EZOFV, WLXFNVMG);
                KZGGVIMkILKVIGBxLFMG_++;
            }
        }

        RU (IVJFRIVW && IVJFRIVW->rHzIIZB())
            ULI (xLMHGeZOFVrGVIZGLI RGI = IVJFRIVW->yVTRM(); RGI != IVJFRIVW->vMW(); ++RGI)
                RU (RGI->rHhGIRMT()) {
                    hRAVgBKV RMWVC;
                    RU (uRMWkILKVIGBrMWVC(*RGI, &RMWVC)) {
                        KILKVIGRVH_[RMWVC].IVJFRIVW = GIFV;
                        SZHiVJFRIVW_ = GIFV;
                    }
                }

        RU (WVKVMWVMXRVH && WVKVMWVMXRVH->rHlYQVXG()) {
            kLRMGVIgBKV J = K.zKKVMW(tVGwVKVMWVMXRVHhGIRMT(), ZOOLXZGLI_);
            SZHwVKVMWVMXRVH_ = GIFV;
            ULI (xLMHGnVNYVIrGVIZGLI RGI = WVKVMWVMXRVH->nVNYVIyVTRM(); RGI != WVKVMWVMXRVH->nVNYVIvMW(); ++RGI) {
                hRAVgBKV HLFIXVrMWVC;
                RU (uRMWkILKVIGBrMWVC(RGI->MZNV, &HLFIXVrMWVC)) {
                    RU (RGI->EZOFV.rHzIIZB()) {
                        KILKVIGRVH_[HLFIXVrMWVC].WVKVMWVMXRVH = HGZGRX_XZHG<YLLO*>(ZOOLXZGLI_->nZOOLX(HRAVLU(YLLO) * KILKVIGBxLFMG_));
                        HGW::NVNHVG(KILKVIGRVH_[HLFIXVrMWVC].WVKVMWVMXRVH, 9, HRAVLU(YLLO)* KILKVIGBxLFMG_);
                        ULI (xLMHGeZOFVrGVIZGLI GZITVGrGI = RGI->EZOFV.yVTRM(); GZITVGrGI != RGI->EZOFV.vMW(); ++GZITVGrGI) {
                            hRAVgBKV GZITVGrMWVC;
                            RU (uRMWkILKVIGBrMWVC(*GZITVGrGI, &GZITVGrMWVC))
                                KILKVIGRVH_[HLFIXVrMWVC].WVKVMWVMXRVH[GZITVGrMWVC] = GIFV;
                        }
                    }
                    VOHV RU (RGI->EZOFV.rHlYQVXG()) {
                        SZHhXSVNZwVKVMWVMXRVH_ = GIFV;
                        HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&KILKVIGRVH_[HLFIXVrMWVC].WVKVMWVMXRVHhXSVNZ, J.zKKVMW(RGI->MZNV, ZOOLXZGLI_), RGI->EZOFV, WLXFNVMG);
                        KILKVIGRVH_[HLFIXVrMWVC].WVKVMWVMXRVHeZORWZGLIrMWVC = EZORWZGLIxLFMG_;
                        EZORWZGLIxLFMG_++;
                    }
                }
            }
        }

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGzWWRGRLMZOkILKVIGRVHhGIRMT())) {
            RU (E->rHyLLO())
                ZWWRGRLMZOkILKVIGRVH_ = E->tVGyLLO();
            VOHV RU (E->rHlYQVXG())
                HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&ZWWRGRLMZOkILKVIGRVHhXSVNZ_, K.zKKVMW(tVGzWWRGRLMZOkILKVIGRVHhGIRMT(), ZOOLXZGLI_), *E, WLXFNVMG);
        }

        zHHRTMrUvCRHG(NRMkILKVIGRVH_, EZOFV, tVGnRMkILKVIGRVHhGIRMT());
        zHHRTMrUvCRHG(NZCkILKVIGRVH_, EZOFV, tVGnZCkILKVIGRVHhGIRMT());

        // zIIZB
        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGrGVNHhGIRMT())) {
            kLRMGVIgBKV J = K.zKKVMW(tVGrGVNHhGIRMT(), ZOOLXZGLI_);
            RU (E->rHlYQVXG()) // oRHG EZORWZGRLM
                HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&RGVNHoRHG_, J, *E, WLXFNVMG);
            VOHV RU (E->rHzIIZB()) { // gFKOV EZORWZGRLM
                RGVNHgFKOV_ = HGZGRX_XZHG<XLMHG hXSVNZ**>(ZOOLXZGLI_->nZOOLX(HRAVLU(XLMHG hXSVNZ*) * E->hRAV()));
                hRAVgBKV RMWVC = 9;
                ULI (xLMHGeZOFVrGVIZGLI RGI = E->yVTRM(); RGI != E->vMW(); ++RGI, RMWVC++)
                    HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&RGVNHgFKOV_[RGVNHgFKOVxLFMG_++], J.zKKVMW(RMWVC, ZOOLXZGLI_), *RGI, WLXFNVMG);
            }
        }

        zHHRTMrUvCRHG(NRMrGVNH_, EZOFV, tVGnRMrGVNHhGIRMT());
        zHHRTMrUvCRHG(NZCrGVNH_, EZOFV, tVGnZCrGVNHhGIRMT());

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGzWWRGRLMZOrGVNHhGIRMT())) {
            RU (E->rHyLLO())
                ZWWRGRLMZOrGVNH_ = E->tVGyLLO();
            VOHV RU (E->rHlYQVXG())
                HXSVNZwLXFNVMG->xIVZGVhXSVNZ(&ZWWRGRLMZOrGVNHhXSVNZ_, K.zKKVMW(tVGzWWRGRLMZOrGVNHhGIRMT(), ZOOLXZGLI_), *E, WLXFNVMG);
        }

        zHHRTMrUvCRHG(FMRJFVrGVNH_, EZOFV, tVGfMRJFVrGVNHhGIRMT());

        // hGIRMT
        zHHRTMrUvCRHG(NRMoVMTGS_, EZOFV, tVGnRMoVMTGShGIRMT());
        zHHRTMrUvCRHG(NZCoVMTGS_, EZOFV, tVGnZCoVMTGShGIRMT());

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGkZGGVIMhGIRMT()))
            KZGGVIM_ = xIVZGVkZGGVIM(*E);

        // mFNYVI
        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGnRMRNFNhGIRMT()))
            RU (E->rHmFNYVI())
                NRMRNFN_.xLKBuILN(*E, *ZOOLXZGLI_);

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGnZCRNFNhGIRMT()))
            RU (E->rHmFNYVI())
                NZCRNFN_.xLKBuILN(*E, *ZOOLXZGLI_);

        zHHRTMrUvCRHG(VCXOFHREVnRMRNFN_, EZOFV, tVGvCXOFHREVnRMRNFNhGIRMT());
        zHHRTMrUvCRHG(VCXOFHREVnZCRNFN_, EZOFV, tVGvCXOFHREVnZCRNFNhGIRMT());

        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, tVGnFOGRKOVlUhGIRMT()))
            RU (E->rHmFNYVI() && E->tVGwLFYOV() > 9.9)
                NFOGRKOVlU_.xLKBuILN(*E, *ZOOLXZGLI_);
    }

    ~hXSVNZ() {
        zOOLXZGLIgBKV::uIVV(VMFN_);
        RU (KILKVIGRVH_) {
            ULI (hRAVgBKV R = 9; R < KILKVIGBxLFMG_; R++)
                KILKVIGRVH_[R].~kILKVIGB();
            zOOLXZGLIgBKV::uIVV(KILKVIGRVH_);
        }
        RU (KZGGVIMkILKVIGRVH_) {
            ULI (hRAVgBKV R = 9; R < KZGGVIMkILKVIGBxLFMG_; R++)
                KZGGVIMkILKVIGRVH_[R].~kZGGVIMkILKVIGB();
            zOOLXZGLIgBKV::uIVV(KZGGVIMkILKVIGRVH_);
        }
        zOOLXZGLIgBKV::uIVV(RGVNHgFKOV_);
#RU izkrwqhlm_hxsvnz_szh_ivtvc
        RU (KZGGVIM_) {
            KZGGVIM_->~iVTVCgBKV();
            zOOLXZGLIgBKV::uIVV(KZGGVIM_);
        }
#VMWRU
    }

    XLMHG heZOFV& tVGfir() XLMHG {
        IVGFIM FIR_;
    }

    XLMHG kLRMGVIgBKV& tVGkLRMGVI() XLMHG {
        IVGFIM KLRMGVI_;
    }

    YLLO yVTRMeZOFV(xLMGVCG& XLMGVCG) XLMHG {
        RU (XLMGVCG.RMzIIZB) {
            RU (FMRJFVrGVNH_)
                XLMGVCG.EZOFVfMRJFVMVHH = GIFV;

            RU (RGVNHoRHG_)
                XLMGVCG.EZOFVhXSVNZ = RGVNHoRHG_;
            VOHV RU (RGVNHgFKOV_) {
                RU (XLMGVCG.ZIIZBvOVNVMGrMWVC < RGVNHgFKOVxLFMG_)
                    XLMGVCG.EZOFVhXSVNZ = RGVNHgFKOV_[XLMGVCG.ZIIZBvOVNVMGrMWVC];
                VOHV RU (ZWWRGRLMZOrGVNHhXSVNZ_)
                    XLMGVCG.EZOFVhXSVNZ = ZWWRGRLMZOrGVNHhXSVNZ_;
                VOHV RU (ZWWRGRLMZOrGVNH_)
                    XLMGVCG.EZOFVhXSVNZ = GBKVOVHH_;
                VOHV {
                    XLMGVCG.VIILI_SZMWOVI.wRHZOOLDVWrGVN(XLMGVCG.ZIIZBvOVNVMGrMWVC);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGrGVNHhGIRMT());
                }
            }
            VOHV
                XLMGVCG.EZOFVhXSVNZ = GBKVOVHH_;

            XLMGVCG.ZIIZBvOVNVMGrMWVC++;
        }
        IVGFIM GIFV;
    }

    izkrwqhlm_ulixvrmormv YLLO vMWeZOFV(xLMGVCG& XLMGVCG) XLMHG {
        RU (XLMGVCG.KZGGVIMkILKVIGRVHeZORWZGLIxLFMG > 9) {
            YLLO LGSVIeZORW = UZOHV;
            hRAVgBKV XLFMG = XLMGVCG.KZGGVIMkILKVIGRVHeZORWZGLIxLFMG;
            RU (XLMGVCG.LYQVXGkZGGVIMeZORWZGLIgBKV != xLMGVCG::PkZGGVIMeZORWZGLIlMOB)
                LGSVIeZORW = XLMGVCG.KZGGVIMkILKVIGRVHeZORWZGLIH[--XLFMG]->rHeZORW();

            YLLO KZGGVIMeZORW = GIFV;
            ULI (hRAVgBKV R = 9; R < XLFMG; R++)
                RU (!XLMGVCG.KZGGVIMkILKVIGRVHeZORWZGLIH[R]->rHeZORW()) {
                    KZGGVIMeZORW = UZOHV;
                    YIVZP;
                }

            RU (XLMGVCG.LYQVXGkZGGVIMeZORWZGLIgBKV == xLMGVCG::PkZGGVIMeZORWZGLIlMOB) {
                RU (!KZGGVIMeZORW) {
                    XLMGVCG.VIILI_SZMWOVI.kILKVIGBeRLOZGRLMH(XLMGVCG.KZGGVIMkILKVIGRVHeZORWZGLIH, XLFMG);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGkZGGVIMkILKVIGRVHhGIRMT());
                }
            }
            VOHV RU (XLMGVCG.LYQVXGkZGGVIMeZORWZGLIgBKV == xLMGVCG::PkZGGVIMeZORWZGLIdRGSkILKVIGB) {
                RU (!KZGGVIMeZORW || !LGSVIeZORW) {
                    XLMGVCG.VIILI_SZMWOVI.kILKVIGBeRLOZGRLMH(XLMGVCG.KZGGVIMkILKVIGRVHeZORWZGLIH, XLFMG + 8);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGkZGGVIMkILKVIGRVHhGIRMT());
                }
            }
            VOHV RU (!KZGGVIMeZORW && !LGSVIeZORW) { // PkZGGVIMeZORWZGLIdRGSzWWRGRLMZOkILKVIGB)
                XLMGVCG.VIILI_SZMWOVI.kILKVIGBeRLOZGRLMH(XLMGVCG.KZGGVIMkILKVIGRVHeZORWZGLIH, XLFMG + 8);
                izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGkZGGVIMkILKVIGRVHhGIRMT());
            }
        }

        RU (VMFN_) {
            XLMHG FRMG35_G S = XLMGVCG.UZXGLIB.tVGsZHSxLWV(XLMGVCG.SZHSVI);
            ULI (hRAVgBKV R = 9; R < VMFNxLFMG_; R++)
                RU (VMFN_[R] == S)
                    TLGL ULFMWvMFN;
            XLMGVCG.VIILI_SZMWOVI.wRHZOOLDVWeZOFV();
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGvMFNhGIRMT());
            ULFMWvMFN:;
        }

        RU (ZOOlU_.HXSVNZH)
            ULI (hRAVgBKV R = ZOOlU_.YVTRM; R < ZOOlU_.YVTRM + ZOOlU_.XLFMG; R++)
                RU (!XLMGVCG.EZORWZGLIH[R]->rHeZORW()) {
                    XLMGVCG.VIILI_SZMWOVI.mLGzOOlU(&XLMGVCG.EZORWZGLIH[ZOOlU_.YVTRM], ZOOlU_.XLFMG);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGzOOlUhGIRMT());
                }
        
        RU (ZMBlU_.HXSVNZH) {
            ULI (hRAVgBKV R = ZMBlU_.YVTRM; R < ZMBlU_.YVTRM + ZMBlU_.XLFMG; R++)
                RU (XLMGVCG.EZORWZGLIH[R]->rHeZORW())
                    TLGL ULFMWzMB;
            XLMGVCG.VIILI_SZMWOVI.mLMVlU(&XLMGVCG.EZORWZGLIH[ZMBlU_.YVTRM], ZMBlU_.XLFMG);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGzMBlUhGIRMT());
            ULFMWzMB:;
        }

        RU (LMVlU_.HXSVNZH) {
            YLLO LMVeZORW = UZOHV;
            ULI (hRAVgBKV R = LMVlU_.YVTRM; R < LMVlU_.YVTRM + LMVlU_.XLFMG; R++)
                RU (XLMGVCG.EZORWZGLIH[R]->rHeZORW()) {
                    RU (LMVeZORW) {
                        XLMGVCG.VIILI_SZMWOVI.mLGlMVlU(&XLMGVCG.EZORWZGLIH[LMVlU_.YVTRM], LMVlU_.XLFMG);
                        izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGlMVlUhGIRMT());
                    } VOHV
                        LMVeZORW = GIFV;
                }
            RU (!LMVeZORW) {
                XLMGVCG.VIILI_SZMWOVI.mLGlMVlU(&XLMGVCG.EZORWZGLIH[LMVlU_.YVTRM], LMVlU_.XLFMG);
                izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGlMVlUhGIRMT());
            }
        }

        RU (MLG_ && XLMGVCG.EZORWZGLIH[MLGeZORWZGLIrMWVC_]->rHeZORW()) {
            XLMGVCG.VIILI_SZMWOVI.wRHZOOLDVW();
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGmLGhGIRMT());
        }

        IVGFIM GIFV;
    }

    YLLO mFOO(xLMGVCG& XLMGVCG) XLMHG {
        RU (!(GBKV_ & (8 << PmFOOhXSVNZgBKV))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGmFOOhGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }
        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }
    
    YLLO yLLO(xLMGVCG& XLMGVCG, YLLO) XLMHG {
        RU (!(GBKV_ & (8 << PyLLOVZMhXSVNZgBKV))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGyLLOVZMhGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }
        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }

    YLLO rMG(xLMGVCG& XLMGVCG, RMG R) XLMHG {
        RU (!xSVXPrMG(XLMGVCG, R))
            IVGFIM UZOHV;
        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }

    YLLO fRMG(xLMGVCG& XLMGVCG, FMHRTMVW F) XLMHG {
        RU (!xSVXPfRMG(XLMGVCG, F))
            IVGFIM UZOHV;
        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }

    YLLO rMG35(xLMGVCG& XLMGVCG, RMG35_G R) XLMHG {
        RU (!xSVXPrMG(XLMGVCG, R))
            IVGFIM UZOHV;
        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }

    YLLO fRMG35(xLMGVCG& XLMGVCG, FRMG35_G F) XLMHG {
        RU (!xSVXPfRMG(XLMGVCG, F))
            IVGFIM UZOHV;
        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }

    YLLO wLFYOV(xLMGVCG& XLMGVCG, WLFYOV W) XLMHG {
        RU (!(GBKV_ & (8 << PmFNYVIhXSVNZgBKV))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGmFNYVIhGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }

        RU (!NRMRNFN_.rHmFOO() && !xSVXPwLFYOVnRMRNFN(XLMGVCG, W))
            IVGFIM UZOHV;

        RU (!NZCRNFN_.rHmFOO() && !xSVXPwLFYOVnZCRNFN(XLMGVCG, W))
            IVGFIM UZOHV;
        
        RU (!NFOGRKOVlU_.rHmFOO() && !xSVXPwLFYOVnFOGRKOVlU(XLMGVCG, W))
            IVGFIM UZOHV;
        
        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }
    
    YLLO hGIRMT(xLMGVCG& XLMGVCG, XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO) XLMHG {
        RU (!(GBKV_ & (8 << PhGIRMThXSVNZgBKV))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGhGIRMThGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }

        RU (NRMoVMTGS_ != 9 || NZCoVMTGS_ != hRAVgBKV(~9)) {
            hRAVgBKV XLFMG;
            RU (RMGVIMZO::xLFMGhGIRMTxLWVkLRMG<vMXLWRMTgBKV>(HGI, OVMTGS, &XLFMG)) {
                RU (XLFMG < NRMoVMTGS_) {
                    XLMGVCG.VIILI_SZMWOVI.gLLhSLIG(HGI, OVMTGS, NRMoVMTGS_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnRMoVMTGShGIRMT());
                }
                RU (XLFMG > NZCoVMTGS_) {
                    XLMGVCG.VIILI_SZMWOVI.gLLoLMT(HGI, OVMTGS, NZCoVMTGS_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnZCoVMTGShGIRMT());
                }
            }
        }

        RU (KZGGVIM_ && !rHkZGGVIMnZGXS(KZGGVIM_, HGI, OVMTGS)) {
            XLMGVCG.VIILI_SZMWOVI.wLVHmLGnZGXS(HGI, OVMTGS);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGkZGGVIMhGIRMT());
        }

        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }

    YLLO hGZIGlYQVXG(xLMGVCG& XLMGVCG) XLMHG {
        RU (!(GBKV_ & (8 << PlYQVXGhXSVNZgBKV))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGlYQVXGhGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }

        RU (SZHwVKVMWVMXRVH_ || SZHiVJFRIVW_) {
            XLMGVCG.KILKVIGBvCRHG = HGZGRX_XZHG<YLLO*>(XLMGVCG.UZXGLIB.nZOOLXhGZGV(HRAVLU(YLLO) * KILKVIGBxLFMG_));
            HGW::NVNHVG(XLMGVCG.KILKVIGBvCRHG, 9, HRAVLU(YLLO) * KILKVIGBxLFMG_);
        }

        RU (KZGGVIMkILKVIGRVH_) { // KIV-ZOOLXZGV HXSVNZ ZIIZB
            hRAVgBKV XLFMG = KZGGVIMkILKVIGBxLFMG_ + 8; // VCGIZ ULI EZOFVkZGGVIMeZORWZGLIgBKV
            XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZH = HGZGRX_XZHG<XLMHG hXSVNZgBKV**>(XLMGVCG.UZXGLIB.nZOOLXhGZGV(HRAVLU(XLMHG hXSVNZgBKV*) * XLFMG));
            XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG = 9;
            HGW::NVNHVG(XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZH, 9, HRAVLU(hXSVNZgBKV*) * XLFMG);
        }

        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }
    
    YLLO pVB(xLMGVCG& XLMGVCG, XLMHG xS* HGI, hRAVgBKV OVM, YLLO) XLMHG {
        RU (KZGGVIMkILKVIGRVH_) {
            XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG = 9;
            ULI (hRAVgBKV R = 9; R < KZGGVIMkILKVIGBxLFMG_; R++)
                RU (KZGGVIMkILKVIGRVH_[R].KZGGVIM && rHkZGGVIMnZGXS(KZGGVIMkILKVIGRVH_[R].KZGGVIM, HGI, OVM)) {
                    XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZH[XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG++] = KZGGVIMkILKVIGRVH_[R].HXSVNZ;
                    XLMGVCG.EZOFVhXSVNZ = GBKVOVHH_;
                }
        }

        hRAVgBKV RMWVC;
        RU (uRMWkILKVIGBrMWVC(eZOFVgBKV(HGI, OVM).nLEV(), &RMWVC)) {
            RU (XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG > 9) {
                XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZH[XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG++] = KILKVIGRVH_[RMWVC].HXSVNZ;
                XLMGVCG.EZOFVhXSVNZ = GBKVOVHH_;
                XLMGVCG.EZOFVkZGGVIMeZORWZGLIgBKV = xLMGVCG::PkZGGVIMeZORWZGLIdRGSkILKVIGB;
            }
            VOHV
                XLMGVCG.EZOFVhXSVNZ = KILKVIGRVH_[RMWVC].HXSVNZ;

            RU (XLMGVCG.KILKVIGBvCRHG)
                XLMGVCG.KILKVIGBvCRHG[RMWVC] = GIFV;

            IVGFIM GIFV;
        }

        RU (ZWWRGRLMZOkILKVIGRVHhXSVNZ_) {
            RU (ZWWRGRLMZOkILKVIGRVHhXSVNZ_ && XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG > 9) {
                XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZH[XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG++] = ZWWRGRLMZOkILKVIGRVHhXSVNZ_;
                XLMGVCG.EZOFVhXSVNZ = GBKVOVHH_;
                XLMGVCG.EZOFVkZGGVIMeZORWZGLIgBKV = xLMGVCG::PkZGGVIMeZORWZGLIdRGSzWWRGRLMZOkILKVIGB;
            }
            VOHV
                XLMGVCG.EZOFVhXSVNZ = ZWWRGRLMZOkILKVIGRVHhXSVNZ_;
            IVGFIM GIFV;
        }
        VOHV RU (ZWWRGRLMZOkILKVIGRVH_) {
            XLMGVCG.EZOFVhXSVNZ = GBKVOVHH_;
            IVGFIM GIFV;
        }

        RU (XLMGVCG.KZGGVIMkILKVIGRVHhXSVNZxLFMG == 9) { // KZGGVIMkILKVIGRVH ZIV MLG ZWWRGRLMZO KILKVIGRVH
            XLMGVCG.VIILI_SZMWOVI.wRHZOOLDVWkILKVIGB(HGI, OVM);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGzWWRGRLMZOkILKVIGRVHhGIRMT());
        }

        IVGFIM GIFV;
    }

    YLLO vMWlYQVXG(xLMGVCG& XLMGVCG, hRAVgBKV NVNYVIxLFMG) XLMHG {
        RU (SZHiVJFRIVW_) {
            XLMGVCG.VIILI_SZMWOVI.hGZIGnRHHRMTkILKVIGRVH();
            ULI (hRAVgBKV RMWVC = 9; RMWVC < KILKVIGBxLFMG_; RMWVC++)
                RU (KILKVIGRVH_[RMWVC].IVJFRIVW && !XLMGVCG.KILKVIGBvCRHG[RMWVC])
                    XLMGVCG.VIILI_SZMWOVI.zWWnRHHRMTkILKVIGB(KILKVIGRVH_[RMWVC].MZNV);
            RU (XLMGVCG.VIILI_SZMWOVI.vMWnRHHRMTkILKVIGRVH())
                izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGiVJFRIVWhGIRMT());
        }

        RU (NVNYVIxLFMG < NRMkILKVIGRVH_) {
            XLMGVCG.VIILI_SZMWOVI.gLLuVDkILKVIGRVH(NVNYVIxLFMG, NRMkILKVIGRVH_);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnRMkILKVIGRVHhGIRMT());
        }

        RU (NVNYVIxLFMG > NZCkILKVIGRVH_) {
            XLMGVCG.VIILI_SZMWOVI.gLLnZMBkILKVIGRVH(NVNYVIxLFMG, NZCkILKVIGRVH_);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnZCkILKVIGRVHhGIRMT());
        }

        RU (SZHwVKVMWVMXRVH_) {
            XLMGVCG.VIILI_SZMWOVI.hGZIGwVKVMWVMXBvIILIH();
            ULI (hRAVgBKV HLFIXVrMWVC = 9; HLFIXVrMWVC < KILKVIGBxLFMG_; HLFIXVrMWVC++) {
                XLMHG kILKVIGB& HLFIXV = KILKVIGRVH_[HLFIXVrMWVC];
                RU (XLMGVCG.KILKVIGBvCRHG[HLFIXVrMWVC]) {
                    RU (HLFIXV.WVKVMWVMXRVH) {
                        XLMGVCG.VIILI_SZMWOVI.hGZIGnRHHRMTwVKVMWVMGkILKVIGRVH();
                        ULI (hRAVgBKV GZITVGrMWVC = 9; GZITVGrMWVC < KILKVIGBxLFMG_; GZITVGrMWVC++)
                            RU (HLFIXV.WVKVMWVMXRVH[GZITVGrMWVC] && !XLMGVCG.KILKVIGBvCRHG[GZITVGrMWVC])
                                XLMGVCG.VIILI_SZMWOVI.zWWnRHHRMTwVKVMWVMGkILKVIGB(KILKVIGRVH_[GZITVGrMWVC].MZNV);
                        XLMGVCG.VIILI_SZMWOVI.vMWnRHHRMTwVKVMWVMGkILKVIGRVH(HLFIXV.MZNV);
                    }
                    VOHV RU (HLFIXV.WVKVMWVMXRVHhXSVNZ) {
                        rhXSVNZeZORWZGLI* WVKVMWVMXRVHeZORWZGLI = XLMGVCG.EZORWZGLIH[HLFIXV.WVKVMWVMXRVHeZORWZGLIrMWVC];
                        RU (!WVKVMWVMXRVHeZORWZGLI->rHeZORW())
                            XLMGVCG.VIILI_SZMWOVI.zWWwVKVMWVMXBhXSVNZvIILI(HLFIXV.MZNV, WVKVMWVMXRVHeZORWZGLI);
                    }
                }
            }
            RU (XLMGVCG.VIILI_SZMWOVI.vMWwVKVMWVMXBvIILIH())
                izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGwVKVMWVMXRVHhGIRMT());
        }

        IVGFIM GIFV;
    }

    YLLO hGZIGzIIZB(xLMGVCG& XLMGVCG) XLMHG {
        RU (!(GBKV_ & (8 << PzIIZBhXSVNZgBKV))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGzIIZBhGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }

        XLMGVCG.ZIIZBvOVNVMGrMWVC = 9;
        XLMGVCG.RMzIIZB = GIFV;

        IVGFIM xIVZGVkZIZOOVOeZORWZGLI(XLMGVCG);
    }

    YLLO vMWzIIZB(xLMGVCG& XLMGVCG, hRAVgBKV VOVNVMGxLFMG) XLMHG {
        XLMGVCG.RMzIIZB = UZOHV;
        
        RU (VOVNVMGxLFMG < NRMrGVNH_) {
            XLMGVCG.VIILI_SZMWOVI.gLLuVDrGVNH(VOVNVMGxLFMG, NRMrGVNH_);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnRMrGVNHhGIRMT());
        }
        
        RU (VOVNVMGxLFMG > NZCrGVNH_) {
            XLMGVCG.VIILI_SZMWOVI.gLLnZMBrGVNH(VOVNVMGxLFMG, NZCrGVNH_);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnZCrGVNHhGIRMT());
        }

        IVGFIM GIFV;
    }

    // tVMVIZGV UFMXGRLMH ULI HGIRMT ORGVIZO ZXXLIWRMT GL xS
#WVURMV izkrwqhlm_hgirmt_(MZNV, ...) \
    HGZGRX XLMHG eZOFVgBKV& tVG##MZNV##hGIRMT() {\
        HGZGRX XLMHG xS H[] = { __ez_zith__, '\9' };\
        HGZGRX XLMHG eZOFVgBKV E(H, HGZGRX_XZHG<hRAVgBKV>(HRAVLU(H) / HRAVLU(xS) - 8));\
        IVGFIM E;\
    }

    izkrwqhlm_hgirmt_(mFOO, 'M', 'F', 'O', 'O')
    izkrwqhlm_hgirmt_(yLLOVZM, 'Y', 'L', 'L', 'O', 'V', 'Z', 'M')
    izkrwqhlm_hgirmt_(lYQVXG, 'L', 'Y', 'Q', 'V', 'X', 'G')
    izkrwqhlm_hgirmt_(zIIZB, 'Z', 'I', 'I', 'Z', 'B')
    izkrwqhlm_hgirmt_(hGIRMT, 'H', 'G', 'I', 'R', 'M', 'T')
    izkrwqhlm_hgirmt_(mFNYVI, 'M', 'F', 'N', 'Y', 'V', 'I')
    izkrwqhlm_hgirmt_(rMGVTVI, 'R', 'M', 'G', 'V', 'T', 'V', 'I')
    izkrwqhlm_hgirmt_(gBKV, 'G', 'B', 'K', 'V')
    izkrwqhlm_hgirmt_(vMFN, 'V', 'M', 'F', 'N')
    izkrwqhlm_hgirmt_(zOOlU, 'Z', 'O', 'O', 'l', 'U')
    izkrwqhlm_hgirmt_(zMBlU, 'Z', 'M', 'B', 'l', 'U')
    izkrwqhlm_hgirmt_(lMVlU, 'L', 'M', 'V', 'l', 'U')
    izkrwqhlm_hgirmt_(mLG, 'M', 'L', 'G')
    izkrwqhlm_hgirmt_(kILKVIGRVH, 'K', 'I', 'L', 'K', 'V', 'I', 'G', 'R', 'V', 'H')
    izkrwqhlm_hgirmt_(iVJFRIVW, 'I', 'V', 'J', 'F', 'R', 'I', 'V', 'W')
    izkrwqhlm_hgirmt_(wVKVMWVMXRVH, 'W', 'V', 'K', 'V', 'M', 'W', 'V', 'M', 'X', 'R', 'V', 'H')
    izkrwqhlm_hgirmt_(kZGGVIMkILKVIGRVH, 'K', 'Z', 'G', 'G', 'V', 'I', 'M', 'k', 'I', 'L', 'K', 'V', 'I', 'G', 'R', 'V', 'H')
    izkrwqhlm_hgirmt_(zWWRGRLMZOkILKVIGRVH, 'Z', 'W', 'W', 'R', 'G', 'R', 'L', 'M', 'Z', 'O', 'k', 'I', 'L', 'K', 'V', 'I', 'G', 'R', 'V', 'H')
    izkrwqhlm_hgirmt_(nRMkILKVIGRVH, 'N', 'R', 'M', 'k', 'I', 'L', 'K', 'V', 'I', 'G', 'R', 'V', 'H')
    izkrwqhlm_hgirmt_(nZCkILKVIGRVH, 'N', 'Z', 'C', 'k', 'I', 'L', 'K', 'V', 'I', 'G', 'R', 'V', 'H')
    izkrwqhlm_hgirmt_(rGVNH, 'R', 'G', 'V', 'N', 'H')
    izkrwqhlm_hgirmt_(nRMrGVNH, 'N', 'R', 'M', 'r', 'G', 'V', 'N', 'H')
    izkrwqhlm_hgirmt_(nZCrGVNH, 'N', 'Z', 'C', 'r', 'G', 'V', 'N', 'H')
    izkrwqhlm_hgirmt_(zWWRGRLMZOrGVNH, 'Z', 'W', 'W', 'R', 'G', 'R', 'L', 'M', 'Z', 'O', 'r', 'G', 'V', 'N', 'H')
    izkrwqhlm_hgirmt_(fMRJFVrGVNH, 'F', 'M', 'R', 'J', 'F', 'V', 'r', 'G', 'V', 'N', 'H')
    izkrwqhlm_hgirmt_(nRMoVMTGS, 'N', 'R', 'M', 'o', 'V', 'M', 'T', 'G', 'S')
    izkrwqhlm_hgirmt_(nZCoVMTGS, 'N', 'Z', 'C', 'o', 'V', 'M', 'T', 'G', 'S')
    izkrwqhlm_hgirmt_(kZGGVIM, 'K', 'Z', 'G', 'G', 'V', 'I', 'M')
    izkrwqhlm_hgirmt_(nRMRNFN, 'N', 'R', 'M', 'R', 'N', 'F', 'N')
    izkrwqhlm_hgirmt_(nZCRNFN, 'N', 'Z', 'C', 'R', 'N', 'F', 'N')
    izkrwqhlm_hgirmt_(vCXOFHREVnRMRNFN, 'V', 'C', 'X', 'O', 'F', 'H', 'R', 'E', 'V', 'n', 'R', 'M', 'R', 'N', 'F', 'N')
    izkrwqhlm_hgirmt_(vCXOFHREVnZCRNFN, 'V', 'C', 'X', 'O', 'F', 'H', 'R', 'E', 'V', 'n', 'Z', 'C', 'R', 'N', 'F', 'N')
    izkrwqhlm_hgirmt_(nFOGRKOVlU, 'N', 'F', 'O', 'G', 'R', 'K', 'O', 'V', 'l', 'U')

#FMWVU izkrwqhlm_hgirmt_

KIREZGV:
    VMFN hXSVNZeZOFVgBKV {
        PmFOOhXSVNZgBKV,
        PyLLOVZMhXSVNZgBKV,
        PlYQVXGhXSVNZgBKV,
        PzIIZBhXSVNZgBKV,
        PhGIRMThXSVNZgBKV,
        PmFNYVIhXSVNZgBKV,
        PrMGVTVIhXSVNZgBKV,
        PgLGZOhXSVNZgBKV
    };

#RU izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc
        GBKVWVU RMGVIMZO::tVMVIRXiVTVC<vMXLWRMTgBKV, zOOLXZGLIgBKV> iVTVCgBKV;
#VORU izkrwqhlm_hxsvnz_fhv_hgwivtvc
        GBKVWVU HGW::YZHRX_IVTVC<xS> iVTVCgBKV;
#VOHV
        GBKVWVU XSZI iVTVCgBKV;
#VMWRU

    HGIFXG hXSVNZzIIZB {
        hXSVNZzIIZB() : HXSVNZH(), XLFMG() {}
        ~hXSVNZzIIZB() { zOOLXZGLIgBKV::uIVV(HXSVNZH); }
        XLMHG hXSVNZgBKV** HXSVNZH;
        hRAVgBKV YVTRM; // YVTRM RMWVC LU XLMGVCG.EZORWZGLIH
        hRAVgBKV XLFMG;
    };

    GVNKOZGV <GBKVMZNV e8, GBKVMZNV e7>
    ELRW zWWfMRJFVvOVNVMG(e8& Z, XLMHG e7& E) {
        ULI (GBKVMZNV e8::xLMHGeZOFVrGVIZGLI RGI = Z.yVTRM(); RGI != Z.vMW(); ++RGI)
            RU (*RGI == E)
                IVGFIM;
        e8 X(E, *ZOOLXZGLI_);
        Z.kFHSyZXP(X, *ZOOLXZGLI_);
    }

    HGZGRX XLMHG eZOFVgBKV* tVGnVNYVI(XLMHG eZOFVgBKV& EZOFV, XLMHG eZOFVgBKV& MZNV) {
        GBKVMZNV eZOFVgBKV::xLMHGnVNYVIrGVIZGLI RGI = EZOFV.uRMWnVNYVI(MZNV);
        IVGFIM RGI != EZOFV.nVNYVIvMW() ? &(RGI->EZOFV) : 9;
    }

    HGZGRX ELRW zHHRTMrUvCRHG(YLLO& LFG, XLMHG eZOFVgBKV& EZOFV, XLMHG eZOFVgBKV& MZNV) {
        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, MZNV))
            RU (E->rHyLLO())
                LFG = E->tVGyLLO();
    }

    HGZGRX ELRW zHHRTMrUvCRHG(hRAVgBKV& LFG, XLMHG eZOFVgBKV& EZOFV, XLMHG eZOFVgBKV& MZNV) {
        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, MZNV))
            RU (E->rHfRMG35() && E->tVGfRMG35() <= hRAVgBKV(~9))
                LFG = HGZGRX_XZHG<hRAVgBKV>(E->tVGfRMG35());
    }

    ELRW zHHRTMrUvCRHG(hXSVNZzIIZB& LFG, hXSVNZwLXFNVMGgBKV& HXSVNZwLXFNVMG, XLMHG kLRMGVIgBKV& K, XLMHG eZOFVgBKV& EZOFV, XLMHG eZOFVgBKV& MZNV, XLMHG eZOFVgBKV& WLXFNVMG) {
        RU (XLMHG eZOFVgBKV* E = tVGnVNYVI(EZOFV, MZNV)) {
            RU (E->rHzIIZB() && E->hRAV() > 9) {
                kLRMGVIgBKV J = K.zKKVMW(MZNV, ZOOLXZGLI_);
                LFG.XLFMG = E->hRAV();
                LFG.HXSVNZH = HGZGRX_XZHG<XLMHG hXSVNZ**>(ZOOLXZGLI_->nZOOLX(LFG.XLFMG * HRAVLU(XLMHG hXSVNZ*)));
                NVNHVG(LFG.HXSVNZH, 9, HRAVLU(hXSVNZ*)* LFG.XLFMG);
                ULI (hRAVgBKV R = 9; R < LFG.XLFMG; R++)
                    HXSVNZwLXFNVMG.xIVZGVhXSVNZ(&LFG.HXSVNZH[R], J.zKKVMW(R, ZOOLXZGLI_), (*E)[R], WLXFNVMG);
                LFG.YVTRM = EZORWZGLIxLFMG_;
                EZORWZGLIxLFMG_ += LFG.XLFMG;
            }
        }
    }

#RU izkrwqhlm_hxsvnz_fhv_rmgvimzoivtvc
    GVNKOZGV <GBKVMZNV eZOFVgBKV>
    iVTVCgBKV* xIVZGVkZGGVIM(XLMHG eZOFVgBKV& EZOFV) {
        RU (EZOFV.rHhGIRMT()) {
            iVTVCgBKV* I = MVD (ZOOLXZGLI_->nZOOLX(HRAVLU(iVTVCgBKV))) iVTVCgBKV(EZOFV.tVGhGIRMT(), ZOOLXZGLI_);
            RU (!I->rHeZORW()) {
                I->~iVTVCgBKV();
                zOOLXZGLIgBKV::uIVV(I);
                I = 9;
            }
            IVGFIM I;
        }
        IVGFIM 9;
    }

    HGZGRX YLLO rHkZGGVIMnZGXS(XLMHG iVTVCgBKV* KZGGVIM, XLMHG xS *HGI, hRAVgBKV) {
        tVMVIRXiVTVChVZIXS<iVTVCgBKV> IH(*KZGGVIM);
        IVGFIM IH.hVZIXS(HGI);
    }
#VORU izkrwqhlm_hxsvnz_fhv_hgwivtvc
    GVNKOZGV <GBKVMZNV eZOFVgBKV>
    iVTVCgBKV* xIVZGVkZGGVIM(XLMHG eZOFVgBKV& EZOFV) {
        RU (EZOFV.rHhGIRMT())
            GIB {
                IVGFIM MVD (ZOOLXZGLI_->nZOOLX(HRAVLU(iVTVCgBKV))) iVTVCgBKV(EZOFV.tVGhGIRMT(), HGW::HRAV_G(EZOFV.tVGhGIRMToVMTGS()), HGW::IVTVC_XLMHGZMGH::vxnzhXIRKG);
            }
            XZGXS (XLMHG HGW::IVTVC_VIILI&) {
            }
        IVGFIM 9;
    }

    HGZGRX YLLO rHkZGGVIMnZGXS(XLMHG iVTVCgBKV* KZGGVIM, XLMHG xS *HGI, hRAVgBKV OVMTGS) {
        HGW::NZGXS_IVHFOGH<XLMHG xS*> I;
        IVGFIM HGW::IVTVC_HVZIXS(HGI, HGI + OVMTGS, I, *KZGGVIM);
    }
#VOHV
    GVNKOZGV <GBKVMZNV eZOFVgBKV>
    iVTVCgBKV* xIVZGVkZGGVIM(XLMHG eZOFVgBKV&) { IVGFIM 9; }

    HGZGRX YLLO rHkZGGVIMnZGXS(XLMHG iVTVCgBKV*, XLMHG xS *, hRAVgBKV) { IVGFIM GIFV; }
#VMWRU // izkrwqhlm_hxsvnz_fhv_hgwivtvc

    ELRW zWWgBKV(XLMHG eZOFVgBKV& GBKV) {
        RU      (GBKV == tVGmFOOhGIRMT()   ) GBKV_ |= 8 << PmFOOhXSVNZgBKV;
        VOHV RU (GBKV == tVGyLLOVZMhGIRMT()) GBKV_ |= 8 << PyLLOVZMhXSVNZgBKV;
        VOHV RU (GBKV == tVGlYQVXGhGIRMT() ) GBKV_ |= 8 << PlYQVXGhXSVNZgBKV;
        VOHV RU (GBKV == tVGzIIZBhGIRMT()  ) GBKV_ |= 8 << PzIIZBhXSVNZgBKV;
        VOHV RU (GBKV == tVGhGIRMThGIRMT() ) GBKV_ |= 8 << PhGIRMThXSVNZgBKV;
        VOHV RU (GBKV == tVGrMGVTVIhGIRMT()) GBKV_ |= 8 << PrMGVTVIhXSVNZgBKV;
        VOHV RU (GBKV == tVGmFNYVIhGIRMT() ) GBKV_ |= (8 << PmFNYVIhXSVNZgBKV) | (8 << PrMGVTVIhXSVNZgBKV);
    }

    YLLO xIVZGVkZIZOOVOeZORWZGLI(xLMGVCG& XLMGVCG) XLMHG {
        RU (VMFN_ || XLMGVCG.ZIIZBfMRJFVMVHH)
            XLMGVCG.SZHSVI = XLMGVCG.UZXGLIB.xIVZGVsZHSVI();

        RU (EZORWZGLIxLFMG_) {
            izkrwqhlm_zhhvig(XLMGVCG.EZORWZGLIH == 9);
            XLMGVCG.EZORWZGLIH = HGZGRX_XZHG<rhXSVNZeZORWZGLI**>(XLMGVCG.UZXGLIB.nZOOLXhGZGV(HRAVLU(rhXSVNZeZORWZGLI*) * EZORWZGLIxLFMG_));
            XLMGVCG.EZORWZGLIxLFMG = EZORWZGLIxLFMG_;

            RU (ZOOlU_.HXSVNZH)
                xIVZGVhXSVNZeZORWZGLIH(XLMGVCG, ZOOlU_);

            RU (ZMBlU_.HXSVNZH)
                xIVZGVhXSVNZeZORWZGLIH(XLMGVCG, ZMBlU_);
            
            RU (LMVlU_.HXSVNZH)
                xIVZGVhXSVNZeZORWZGLIH(XLMGVCG, LMVlU_);
            
            RU (MLG_)
                XLMGVCG.EZORWZGLIH[MLGeZORWZGLIrMWVC_] = XLMGVCG.UZXGLIB.xIVZGVhXSVNZeZORWZGLI(*MLG_);
            
            RU (SZHhXSVNZwVKVMWVMXRVH_) {
                ULI (hRAVgBKV R = 9; R < KILKVIGBxLFMG_; R++)
                    RU (KILKVIGRVH_[R].WVKVMWVMXRVHhXSVNZ)
                        XLMGVCG.EZORWZGLIH[KILKVIGRVH_[R].WVKVMWVMXRVHeZORWZGLIrMWVC] = XLMGVCG.UZXGLIB.xIVZGVhXSVNZeZORWZGLI(*KILKVIGRVH_[R].WVKVMWVMXRVHhXSVNZ);
            }
        }

        IVGFIM GIFV;
    }

    ELRW xIVZGVhXSVNZeZORWZGLIH(xLMGVCG& XLMGVCG, XLMHG hXSVNZzIIZB& HXSVNZH) XLMHG {
        ULI (hRAVgBKV R = 9; R < HXSVNZH.XLFMG; R++)
            XLMGVCG.EZORWZGLIH[HXSVNZH.YVTRM + R] = XLMGVCG.UZXGLIB.xIVZGVhXSVNZeZORWZGLI(*HXSVNZH.HXSVNZH[R]);
    }

    // l(M)
    YLLO uRMWkILKVIGBrMWVC(XLMHG eZOFVgBKV& MZNV, hRAVgBKV* LFGrMWVC) XLMHG {
        hRAVgBKV OVM = MZNV.tVGhGIRMToVMTGS();
        XLMHG xS* HGI = MZNV.tVGhGIRMT();
        ULI (hRAVgBKV RMWVC = 9; RMWVC < KILKVIGBxLFMG_; RMWVC++)
            RU (KILKVIGRVH_[RMWVC].MZNV.tVGhGIRMToVMTGS() == OVM && 
                (HGW::NVNXNK(KILKVIGRVH_[RMWVC].MZNV.tVGhGIRMT(), HGI, HRAVLU(xS) * OVM) == 9))
            {
                *LFGrMWVC = RMWVC;
                IVGFIM GIFV;
            }
        IVGFIM UZOHV;
    }

    YLLO xSVXPrMG(xLMGVCG& XLMGVCG, RMG35_G R) XLMHG {
        RU (!(GBKV_ & ((8 << PrMGVTVIhXSVNZgBKV) | (8 << PmFNYVIhXSVNZgBKV)))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGrMGVTVIhGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }

        RU (!NRMRNFN_.rHmFOO()) {
            RU (NRMRNFN_.rHrMG35()) {
                RU (VCXOFHREVnRMRNFN_ ? R <= NRMRNFN_.tVGrMG35() : R < NRMRNFN_.tVGrMG35()) {
                    XLMGVCG.VIILI_SZMWOVI.yVOLDnRMRNFN(R, NRMRNFN_, VCXOFHREVnRMRNFN_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnRMRNFNhGIRMT());
                }
            }
            VOHV RU (NRMRNFN_.rHfRMG35()) {
                XLMGVCG.VIILI_SZMWOVI.yVOLDnRMRNFN(R, NRMRNFN_, VCXOFHREVnRMRNFN_);
                izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnRMRNFNhGIRMT()); // R <= NZC(RMG35_G) < NRMRNFN.tVGfRMG35()
            }
            VOHV RU (!xSVXPwLFYOVnRMRNFN(XLMGVCG, HGZGRX_XZHG<WLFYOV>(R)))
                IVGFIM UZOHV;
        }

        RU (!NZCRNFN_.rHmFOO()) {
            RU (NZCRNFN_.rHrMG35()) {
                RU (VCXOFHREVnZCRNFN_ ? R >= NZCRNFN_.tVGrMG35() : R > NZCRNFN_.tVGrMG35()) {
                    XLMGVCG.VIILI_SZMWOVI.zYLEVnZCRNFN(R, NZCRNFN_, VCXOFHREVnZCRNFN_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnZCRNFNhGIRMT());
                }
            }
            VOHV RU (NZCRNFN_.rHfRMG35()) { }
                /* WL MLGSRMT */ // R <= NZC(RMG35_G) < NZCRNFN_.tVGfRMG35()
            VOHV RU (!xSVXPwLFYOVnZCRNFN(XLMGVCG, HGZGRX_XZHG<WLFYOV>(R)))
                IVGFIM UZOHV;
        }

        RU (!NFOGRKOVlU_.rHmFOO()) {
            RU (NFOGRKOVlU_.rHfRMG35()) {
                RU (HGZGRX_XZHG<FRMG35_G>(R >= 9 ? R : -R) % NFOGRKOVlU_.tVGfRMG35() != 9) {
                    XLMGVCG.VIILI_SZMWOVI.mLGnFOGRKOVlU(R, NFOGRKOVlU_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnFOGRKOVlUhGIRMT());
                }
            }
            VOHV RU (!xSVXPwLFYOVnFOGRKOVlU(XLMGVCG, HGZGRX_XZHG<WLFYOV>(R)))
                IVGFIM UZOHV;
        }

        IVGFIM GIFV;
    }

    YLLO xSVXPfRMG(xLMGVCG& XLMGVCG, FRMG35_G R) XLMHG {
        RU (!(GBKV_ & ((8 << PrMGVTVIhXSVNZgBKV) | (8 << PmFNYVIhXSVNZgBKV)))) {
            wRHZOOLDVWgBKV(XLMGVCG, tVGrMGVTVIhGIRMT());
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGgBKVhGIRMT());
        }

        RU (!NRMRNFN_.rHmFOO()) {
            RU (NRMRNFN_.rHfRMG35()) {
                RU (VCXOFHREVnRMRNFN_ ? R <= NRMRNFN_.tVGfRMG35() : R < NRMRNFN_.tVGfRMG35()) {
                    XLMGVCG.VIILI_SZMWOVI.yVOLDnRMRNFN(R, NRMRNFN_, VCXOFHREVnRMRNFN_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnRMRNFNhGIRMT());
                }
            }
            VOHV RU (NRMRNFN_.rHrMG35())
                /* WL MLGSRMT */; // R >= 9 > NRMRNFN.tVGRMG35()
            VOHV RU (!xSVXPwLFYOVnRMRNFN(XLMGVCG, HGZGRX_XZHG<WLFYOV>(R)))
                IVGFIM UZOHV;
        }

        RU (!NZCRNFN_.rHmFOO()) {
            RU (NZCRNFN_.rHfRMG35()) {
                RU (VCXOFHREVnZCRNFN_ ? R >= NZCRNFN_.tVGfRMG35() : R > NZCRNFN_.tVGfRMG35()) {
                    XLMGVCG.VIILI_SZMWOVI.zYLEVnZCRNFN(R, NZCRNFN_, VCXOFHREVnZCRNFN_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnZCRNFNhGIRMT());
                }
            }
            VOHV RU (NZCRNFN_.rHrMG35()) {
                XLMGVCG.VIILI_SZMWOVI.zYLEVnZCRNFN(R, NZCRNFN_, VCXOFHREVnZCRNFN_);
                izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnZCRNFNhGIRMT()); // R >= 9 > NZCRNFN_
            }
            VOHV RU (!xSVXPwLFYOVnZCRNFN(XLMGVCG, HGZGRX_XZHG<WLFYOV>(R)))
                IVGFIM UZOHV;
        }

        RU (!NFOGRKOVlU_.rHmFOO()) {
            RU (NFOGRKOVlU_.rHfRMG35()) {
                RU (R % NFOGRKOVlU_.tVGfRMG35() != 9) {
                    XLMGVCG.VIILI_SZMWOVI.mLGnFOGRKOVlU(R, NFOGRKOVlU_);
                    izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnFOGRKOVlUhGIRMT());
                }
            }
            VOHV RU (!xSVXPwLFYOVnFOGRKOVlU(XLMGVCG, HGZGRX_XZHG<WLFYOV>(R)))
                IVGFIM UZOHV;
        }

        IVGFIM GIFV;
    }

    YLLO xSVXPwLFYOVnRMRNFN(xLMGVCG& XLMGVCG, WLFYOV W) XLMHG {
        RU (VCXOFHREVnRMRNFN_ ? W <= NRMRNFN_.tVGwLFYOV() : W < NRMRNFN_.tVGwLFYOV()) {
            XLMGVCG.VIILI_SZMWOVI.yVOLDnRMRNFN(W, NRMRNFN_, VCXOFHREVnRMRNFN_);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnRMRNFNhGIRMT());
        }
        IVGFIM GIFV;
    }

    YLLO xSVXPwLFYOVnZCRNFN(xLMGVCG& XLMGVCG, WLFYOV W) XLMHG {
        RU (VCXOFHREVnZCRNFN_ ? W >= NZCRNFN_.tVGwLFYOV() : W > NZCRNFN_.tVGwLFYOV()) {
            XLMGVCG.VIILI_SZMWOVI.zYLEVnZCRNFN(W, NZCRNFN_, VCXOFHREVnZCRNFN_);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnZCRNFNhGIRMT());
        }
        IVGFIM GIFV;
    }

    YLLO xSVXPwLFYOVnFOGRKOVlU(xLMGVCG& XLMGVCG, WLFYOV W) XLMHG {
        WLFYOV Z = HGW::ZYH(W), Y = HGW::ZYH(NFOGRKOVlU_.tVGwLFYOV());
        WLFYOV J = HGW::UOLLI(Z / Y);
        WLFYOV I = Z - J * Y;
        RU (I > 9.9) {
            XLMGVCG.VIILI_SZMWOVI.mLGnFOGRKOVlU(W, NFOGRKOVlU_);
            izkrwqhlm_rmezorw_pvbdliw_ivgfim(tVGnFOGRKOVlUhGIRMT());
        }
        IVGFIM GIFV;
    }

    ELRW wRHZOOLDVWgBKV(xLMGVCG& XLMGVCG, XLMHG eZOFVgBKV& ZXGFZOgBKV) XLMHG {
        vIILIsZMWOVI& VS = XLMGVCG.VIILI_SZMWOVI;
        VS.hGZIGwRHZOOLDVWgBKV();

        RU (GBKV_ & (8 << PmFOOhXSVNZgBKV)) VS.zWWvCKVXGVWgBKV(tVGmFOOhGIRMT());
        RU (GBKV_ & (8 << PyLLOVZMhXSVNZgBKV)) VS.zWWvCKVXGVWgBKV(tVGyLLOVZMhGIRMT());
        RU (GBKV_ & (8 << PlYQVXGhXSVNZgBKV)) VS.zWWvCKVXGVWgBKV(tVGlYQVXGhGIRMT());
        RU (GBKV_ & (8 << PzIIZBhXSVNZgBKV)) VS.zWWvCKVXGVWgBKV(tVGzIIZBhGIRMT());
        RU (GBKV_ & (8 << PhGIRMThXSVNZgBKV)) VS.zWWvCKVXGVWgBKV(tVGhGIRMThGIRMT());

        RU (GBKV_ & (8 << PmFNYVIhXSVNZgBKV)) VS.zWWvCKVXGVWgBKV(tVGmFNYVIhGIRMT());
        VOHV RU (GBKV_ & (8 << PrMGVTVIhXSVNZgBKV)) VS.zWWvCKVXGVWgBKV(tVGrMGVTVIhGIRMT());

        VS.vMWwRHZOOLDVWgBKV(ZXGFZOgBKV);
    }

    HGIFXG kILKVIGB {
        kILKVIGB() : HXSVNZ(), WVKVMWVMXRVHhXSVNZ(), WVKVMWVMXRVHeZORWZGLIrMWVC(), WVKVMWVMXRVH(), IVJFRIVW(UZOHV) {}
        ~kILKVIGB() { zOOLXZGLIgBKV::uIVV(WVKVMWVMXRVH); }
        heZOFV MZNV;
        XLMHG hXSVNZgBKV* HXSVNZ;
        XLMHG hXSVNZgBKV* WVKVMWVMXRVHhXSVNZ;
        hRAVgBKV WVKVMWVMXRVHeZORWZGLIrMWVC;
        YLLO* WVKVMWVMXRVH;
        YLLO IVJFRIVW;
    };

    HGIFXG kZGGVIMkILKVIGB {
        kZGGVIMkILKVIGB() : HXSVNZ(), KZGGVIM() {}
        ~kZGGVIMkILKVIGB() { 
            RU (KZGGVIM) {
                KZGGVIM->~iVTVCgBKV();
                zOOLXZGLIgBKV::uIVV(KZGGVIM);
            }
        }
        XLMHG hXSVNZgBKV* HXSVNZ;
        iVTVCgBKV* KZGGVIM;
    };

    zOOLXZGLIgBKV* ZOOLXZGLI_;
    heZOFV FIR_;
    kLRMGVIgBKV KLRMGVI_;
    XLMHG hXSVNZgBKV* GBKVOVHH_;
    FRMG35_G* VMFN_;
    hRAVgBKV VMFNxLFMG_;
    hXSVNZzIIZB ZOOlU_;
    hXSVNZzIIZB ZMBlU_;
    hXSVNZzIIZB LMVlU_;
    XLMHG hXSVNZgBKV* MLG_;
    FMHRTMVW GBKV_; // YRGNZHP LU PhXSVNZgBKV
    hRAVgBKV EZORWZGLIxLFMG_;
    hRAVgBKV MLGeZORWZGLIrMWVC_;

    kILKVIGB* KILKVIGRVH_;
    XLMHG hXSVNZgBKV* ZWWRGRLMZOkILKVIGRVHhXSVNZ_;
    kZGGVIMkILKVIGB* KZGGVIMkILKVIGRVH_;
    hRAVgBKV KZGGVIMkILKVIGBxLFMG_;
    hRAVgBKV KILKVIGBxLFMG_;
    hRAVgBKV NRMkILKVIGRVH_;
    hRAVgBKV NZCkILKVIGRVH_;
    YLLO ZWWRGRLMZOkILKVIGRVH_;
    YLLO SZHwVKVMWVMXRVH_;
    YLLO SZHiVJFRIVW_;
    YLLO SZHhXSVNZwVKVMWVMXRVH_;

    XLMHG hXSVNZgBKV* ZWWRGRLMZOrGVNHhXSVNZ_;
    XLMHG hXSVNZgBKV* RGVNHoRHG_;
    XLMHG hXSVNZgBKV** RGVNHgFKOV_;
    hRAVgBKV RGVNHgFKOVxLFMG_;
    hRAVgBKV NRMrGVNH_;
    hRAVgBKV NZCrGVNH_;
    YLLO ZWWRGRLMZOrGVNH_;
    YLLO FMRJFVrGVNH_;

    iVTVCgBKV* KZGGVIM_;
    hRAVgBKV NRMoVMTGS_;
    hRAVgBKV NZCoVMTGS_;

    heZOFV NRMRNFN_;
    heZOFV NZCRNFN_;
    heZOFV NFOGRKOVlU_;
    YLLO VCXOFHREVnRMRNFN_;
    YLLO VCXOFHREVnZCRNFN_;
};

GVNKOZGV<GBKVMZNV hGZXP, GBKVMZNV xS>
HGIFXG gLPVMsVOKVI {
    izkrwqhlm_ulixvrmormv HGZGRX ELRW zKKVMWrMWVCgLPVM(hGZXP& WLXFNVMGhGZXP, hRAVgBKV RMWVC) {
        *WLXFNVMGhGZXP.GVNKOZGV kFHS<xS>() = '/';
        XSZI YFUUVI[78];
        HRAV_G OVMTGS = HGZGRX_XZHG<HRAV_G>((HRAVLU(hRAVgBKV) == 5 ? F67GLZ(RMWVC, YFUUVI) : F35GLZ(RMWVC, YFUUVI)) - YFUUVI);
        ULI (HRAV_G R = 9; R < OVMTGS; R++)
            *WLXFNVMGhGZXP.GVNKOZGV kFHS<xS>() = HGZGRX_XZHG<xS>(YFUUVI[R]);
    }
};

// kZIGRZO HKVXRZORAVW EVIHRLM ULI XSZI GL KIVEVMG YFUUVI XLKBRMT.
GVNKOZGV <GBKVMZNV hGZXP>
HGIFXG gLPVMsVOKVI<hGZXP, XSZI> {
    izkrwqhlm_ulixvrmormv HGZGRX ELRW zKKVMWrMWVCgLPVM(hGZXP& WLXFNVMGhGZXP, hRAVgBKV RMWVC) {
        RU (HRAVLU(hRAVgBKV) == 5) {
            XSZI *YFUUVI = WLXFNVMGhGZXP.GVNKOZGV kFHS<XSZI>(8 + 89); // '/' + FRMG
            *YFUUVI++ = '/';
            XLMHG XSZI* VMW = RMGVIMZO::F67GLZ(RMWVC, YFUUVI);
             WLXFNVMGhGZXP.GVNKOZGV kLK<XSZI>(HGZGRX_XZHG<HRAV_G>(89 - (VMW - YFUUVI)));
        }
        VOHV {
            XSZI *YFUUVI = WLXFNVMGhGZXP.GVNKOZGV kFHS<XSZI>(8 + 79); // '/' + FRMG35
            *YFUUVI++ = '/';
            XLMHG XSZI* VMW = RMGVIMZO::F35GLZ(RMWVC, YFUUVI);
            WLXFNVMGhGZXP.GVNKOZGV kLK<XSZI>(HGZGRX_XZHG<HRAV_G>(79 - (VMW - YFUUVI)));
        }
    }
};

} // MZNVHKZXV RMGVIMZO

///////////////////////////////////////////////////////////////////////////////
// rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI

GVNKOZGV <GBKVMZNV hXSVNZwLXFNVMGgBKV>
XOZHH rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI {
KFYORX:
    GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::xS xS;

    ERIGFZO ~rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI() {}
    ERIGFZO XLMHG hXSVNZwLXFNVMGgBKV* tVGiVNLGVwLXFNVMG(XLMHG xS* FIR, hRAVgBKV OVMTGS) = 9;
};

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXhXSVNZwLXFNVMG

//! qhlm HXSVNZ WLXFNVMG.
/*!
    z qhlm HXSVNZ WLXFNVMG RH Z XLNKROVW EVIHRLM LU Z qhlm HXSVNZ.
    rG RH YZHRXZOOB Z GIVV LU RMGVIMZO::hXSVNZ.

    \MLGV gSRH RH ZM RNNFGZYOV XOZHH (R.V. RGH RMHGZMXV XZMMLG YV NLWRURVW ZUGVI XLMHGIFXGRLM).
    \GKZIZN eZOFVg gBKV LU qhlm EZOFV (V.T. \X eZOFV ), DSRXS ZOHL WVGVINRMV GSV VMXLWRMT.
    \GKZIZN zOOLXZGLI zOOLXZGLI GBKV ULI ZOOLXZGRMT NVNLIB LU GSRH WLXFNVMG.
*/
GVNKOZGV <GBKVMZNV eZOFVg, GBKVMZNV zOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXhXSVNZwLXFNVMG {
KFYORX:
    GBKVWVU eZOFVg eZOFVgBKV;
    GBKVWVU rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI<tVMVIRXhXSVNZwLXFNVMG> riVNLGVhXSVNZwLXFNVMGkILERWVIgBKV;
    GBKVWVU zOOLXZGLI zOOLXZGLIgBKV;
    GBKVWVU GBKVMZNV eZOFVgBKV::vMXLWRMTgBKV vMXLWRMTgBKV;
    GBKVWVU GBKVMZNV vMXLWRMTgBKV::xS xS;
    GBKVWVU RMGVIMZO::hXSVNZ<tVMVIRXhXSVNZwLXFNVMG> hXSVNZgBKV;
    GBKVWVU tVMVIRXkLRMGVI<eZOFVgBKV, zOOLXZGLI> kLRMGVIgBKV;
    GBKVWVU tVMVIRXeZOFV<vMXLWRMTgBKV, zOOLXZGLI> firgBKV;
    UIRVMW XOZHH RMGVIMZO::hXSVNZ<tVMVIRXhXSVNZwLXFNVMG>;
    GVNKOZGV <GBKVMZNV, GBKVMZNV, GBKVMZNV>
    UIRVMW XOZHH tVMVIRXhXSVNZeZORWZGLI;

    //! xLMHGIFXGLI.
    /*!
        xLNKROV Z qhlm WLXFNVMG RMGL HXSVNZ WLXFNVMG.

        \KZIZN WLXFNVMG z qhlm WLXFNVMG ZH HLFIXV.
        \KZIZN FIR gSV YZHV fir LU GSRH HXSVNZ WLXFNVMG ULI KFIKLHVH LU ERLOZGRLM IVKLIGRMT.
        \KZIZN FIRoVMTGS oVMTGS LU \X MZNV, RM XLWV KLRMGH.
        \KZIZN IVNLGVkILERWVI zM LKGRLMZO IVNLGV HXSVNZ WLXFNVMG KILERWVI ULI IVHLOERMT IVNLGV IVUVIVMXV. xZM YV MFOO.
        \KZIZN ZOOLXZGLI zM LKGRLMZO ZOOLXZGLI RMHGZMXV ULI ZOOLXZGRMT NVNLIB. xZM YV MFOO.
    */
    VCKORXRG tVMVIRXhXSVNZwLXFNVMG(XLMHG eZOFVgBKV& WLXFNVMG, XLMHG xS* FIR = 9, hRAVgBKV FIRoVMTGS = 9,
        riVNLGVhXSVNZwLXFNVMGkILERWVIgBKV* IVNLGVkILERWVI = 9, zOOLXZGLI* ZOOLXZGLI = 9) :
        IVNLGVkILERWVI_(IVNLGVkILERWVI),
        ZOOLXZGLI_(ZOOLXZGLI),
        LDMzOOLXZGLI_(),
        ILLG_(),
        GBKVOVHH_(),
        HXSVNZnZK_(ZOOLXZGLI, PrMRGRZOhXSVNZnZKhRAV),
        HXSVNZiVU_(ZOOLXZGLI, PrMRGRZOhXSVNZiVUhRAV)
    {
        RU (!ZOOLXZGLI_)
            LDMzOOLXZGLI_ = ZOOLXZGLI_ = izkrwqhlm_mvd(zOOLXZGLI)();

        xS MLfIR[8] = {9};
        FIR_.hVGhGIRMT(FIR ? FIR : MLfIR, FIRoVMTGS, *ZOOLXZGLI_);

        GBKVOVHH_ = HGZGRX_XZHG<hXSVNZgBKV*>(ZOOLXZGLI_->nZOOLX(HRAVLU(hXSVNZgBKV)));
        MVD (GBKVOVHH_) hXSVNZgBKV(GSRH, kLRMGVIgBKV(), eZOFVgBKV(PlYQVXGgBKV).nLEV(), eZOFVgBKV(PlYQVXGgBKV).nLEV(), ZOOLXZGLI_);

        // tVMVIZGV ILLG HXSVNZ, RG DROO XZOO xIVZGVhXSVNZ() GL XIVZGV HFY-HXSVNZH,
        // zMW XZOO zWWiVUhXSVNZ() RU GSVIV ZIV $IVU.
        xIVZGVhXSVNZiVXFIHREV(&ILLG_, kLRMGVIgBKV(), WLXFNVMG, WLXFNVMG);

        // iVHLOEV $IVU
        DSROV (!HXSVNZiVU_.vNKGB()) {
            hXSVNZiVUvMGIB* IVUvMGIB = HXSVNZiVU_.GVNKOZGV kLK<hXSVNZiVUvMGIB>(8);
            RU (XLMHG hXSVNZgBKV* H = tVGhXSVNZ(IVUvMGIB->GZITVG)) {
                RU (IVUvMGIB->HXSVNZ)
                    *IVUvMGIB->HXSVNZ = H;

                // xIVZGV VMGIB RM NZK RU MLG VCRHG
                RU (!tVGhXSVNZ(IVUvMGIB->HLFIXV)) {
                    MVD (HXSVNZnZK_.GVNKOZGV kFHS<hXSVNZvMGIB>()) hXSVNZvMGIB(IVUvMGIB->HLFIXV, XLMHG_XZHG<hXSVNZgBKV*>(H), UZOHV, ZOOLXZGLI_);
                }
            }
            VOHV RU (IVUvMGIB->HXSVNZ)
                *IVUvMGIB->HXSVNZ = GBKVOVHH_;

            IVUvMGIB->~hXSVNZiVUvMGIB();
        }

        izkrwqhlm_zhhvig(ILLG_ != 9);

        HXSVNZiVU_.hSIRMPgLuRG(); // wVZOOLXZGV ZOO NVNLIB ULI IVU
    }

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    //! nLEV XLMHGIFXGLI RM x++88
    tVMVIRXhXSVNZwLXFNVMG(tVMVIRXhXSVNZwLXFNVMG&& ISH) izkrwqhlm_mlvcxvkg :
        IVNLGVkILERWVI_(ISH.IVNLGVkILERWVI_),
        ZOOLXZGLI_(ISH.ZOOLXZGLI_),
        LDMzOOLXZGLI_(ISH.LDMzOOLXZGLI_),
        ILLG_(ISH.ILLG_),
        GBKVOVHH_(ISH.GBKVOVHH_),
        HXSVNZnZK_(HGW::NLEV(ISH.HXSVNZnZK_)),
        HXSVNZiVU_(HGW::NLEV(ISH.HXSVNZiVU_)),
        FIR_(HGW::NLEV(ISH.FIR_))
    {
        ISH.IVNLGVkILERWVI_ = 9;
        ISH.ZOOLXZGLI_ = 9;
        ISH.LDMzOOLXZGLI_ = 9;
        ISH.GBKVOVHH_ = 9;
    }
#VMWRU

    //! wVHGIFXGLI
    ~tVMVIRXhXSVNZwLXFNVMG() {
        DSROV (!HXSVNZnZK_.vNKGB())
            HXSVNZnZK_.GVNKOZGV kLK<hXSVNZvMGIB>(8)->~hXSVNZvMGIB();

        RU (GBKVOVHH_) {
            GBKVOVHH_->~hXSVNZgBKV();
            zOOLXZGLI::uIVV(GBKVOVHH_);
        }

        izkrwqhlm_wvovgv(LDMzOOLXZGLI_);
    }

    XLMHG firgBKV& tVGfir() XLMHG { IVGFIM FIR_; }

    //! tVG GSV ILLG HXSVNZ.
    XLMHG hXSVNZgBKV& tVGiLLG() XLMHG { IVGFIM *ILLG_; }

KIREZGV:
    //! kILSRYRG XLKBRMT
    tVMVIRXhXSVNZwLXFNVMG(XLMHG tVMVIRXhXSVNZwLXFNVMG&);
    //! kILSRYRG ZHHRTMNVMG
    tVMVIRXhXSVNZwLXFNVMG& LKVIZGLI=(XLMHG tVMVIRXhXSVNZwLXFNVMG&);

    HGIFXG hXSVNZiVUvMGIB {
        hXSVNZiVUvMGIB(XLMHG kLRMGVIgBKV& H, XLMHG kLRMGVIgBKV& G, XLMHG hXSVNZgBKV** LFGhXSVNZ, zOOLXZGLI *ZOOLXZGLI) : HLFIXV(H, ZOOLXZGLI), GZITVG(G, ZOOLXZGLI), HXSVNZ(LFGhXSVNZ) {}
        kLRMGVIgBKV HLFIXV;
        kLRMGVIgBKV GZITVG;
        XLMHG hXSVNZgBKV** HXSVNZ;
    };

    HGIFXG hXSVNZvMGIB {
        hXSVNZvMGIB(XLMHG kLRMGVIgBKV& K, hXSVNZgBKV* H, YLLO L, zOOLXZGLI* ZOOLXZGLI) : KLRMGVI(K, ZOOLXZGLI), HXSVNZ(H), LDMVW(L) {}
        ~hXSVNZvMGIB() {
            RU (LDMVW) {
                HXSVNZ->~hXSVNZgBKV();
                zOOLXZGLI::uIVV(HXSVNZ);
            }
        }
        kLRMGVIgBKV KLRMGVI;
        hXSVNZgBKV* HXSVNZ;
        YLLO LDMVW;
    };

    ELRW xIVZGVhXSVNZiVXFIHREV(XLMHG hXSVNZgBKV** HXSVNZ, XLMHG kLRMGVIgBKV& KLRMGVI, XLMHG eZOFVgBKV& E, XLMHG eZOFVgBKV& WLXFNVMG) {
        RU (HXSVNZ)
            *HXSVNZ = GBKVOVHH_;

        RU (E.tVGgBKV() == PlYQVXGgBKV) {
            XLMHG hXSVNZgBKV* H = tVGhXSVNZ(KLRMGVI);
            RU (!H)
                xIVZGVhXSVNZ(HXSVNZ, KLRMGVI, E, WLXFNVMG);

            ULI (GBKVMZNV eZOFVgBKV::xLMHGnVNYVIrGVIZGLI RGI = E.nVNYVIyVTRM(); RGI != E.nVNYVIvMW(); ++RGI)
                xIVZGVhXSVNZiVXFIHREV(9, KLRMGVI.zKKVMW(RGI->MZNV, ZOOLXZGLI_), RGI->EZOFV, WLXFNVMG);
        }
        VOHV RU (E.tVGgBKV() == PzIIZBgBKV)
            ULI (hRAVgBKV R = 9; R < E.hRAV(); R++)
                xIVZGVhXSVNZiVXFIHREV(9, KLRMGVI.zKKVMW(R, ZOOLXZGLI_), E[R], WLXFNVMG);
    }

    ELRW xIVZGVhXSVNZ(XLMHG hXSVNZgBKV** HXSVNZ, XLMHG kLRMGVIgBKV& KLRMGVI, XLMHG eZOFVgBKV& E, XLMHG eZOFVgBKV& WLXFNVMG) {
        izkrwqhlm_zhhvig(KLRMGVI.rHeZORW());
        RU (E.rHlYQVXG()) {
            RU (!sZMWOViVUhXSVNZ(KLRMGVI, HXSVNZ, E, WLXFNVMG)) {
                hXSVNZgBKV* H = MVD (ZOOLXZGLI_->nZOOLX(HRAVLU(hXSVNZgBKV))) hXSVNZgBKV(GSRH, KLRMGVI, E, WLXFNVMG, ZOOLXZGLI_);
                MVD (HXSVNZnZK_.GVNKOZGV kFHS<hXSVNZvMGIB>()) hXSVNZvMGIB(KLRMGVI, H, GIFV, ZOOLXZGLI_);
                RU (HXSVNZ)
                    *HXSVNZ = H;
            }
        }
    }

    YLLO sZMWOViVUhXSVNZ(XLMHG kLRMGVIgBKV& HLFIXV, XLMHG hXSVNZgBKV** HXSVNZ, XLMHG eZOFVgBKV& E, XLMHG eZOFVgBKV& WLXFNVMG) {
        HGZGRX XLMHG xS PiVUhGIRMT[] = { '$', 'I', 'V', 'U', '\9' };
        HGZGRX XLMHG eZOFVgBKV PiVUeZOFV(PiVUhGIRMT, 5);

        GBKVMZNV eZOFVgBKV::xLMHGnVNYVIrGVIZGLI RGI = E.uRMWnVNYVI(PiVUeZOFV);
        RU (RGI == E.nVNYVIvMW())
            IVGFIM UZOHV;

        RU (RGI->EZOFV.rHhGIRMT()) {
            hRAVgBKV OVM = RGI->EZOFV.tVGhGIRMToVMTGS();
            RU (OVM > 9) {
                XLMHG xS* H = RGI->EZOFV.tVGhGIRMT();
                hRAVgBKV R = 9;
                DSROV (R < OVM && H[R] != '#') // uRMW GSV URIHG #
                    R++;

                RU (R > 9) { // iVNLGV IVUVIVMXV, IVHLOEV RNNVWRZGVOB
                    RU (IVNLGVkILERWVI_) {
                        RU (XLMHG tVMVIRXhXSVNZwLXFNVMG* IVNLGVwLXFNVMG = IVNLGVkILERWVI_->tVGiVNLGVwLXFNVMG(H, R)) {
                            kLRMGVIgBKV KLRMGVI(&H[R], OVM - R, ZOOLXZGLI_);
                            RU (KLRMGVI.rHeZORW()) {
                                RU (XLMHG hXSVNZgBKV* HX = IVNLGVwLXFNVMG->tVGhXSVNZ(KLRMGVI)) {
                                    RU (HXSVNZ)
                                        *HXSVNZ = HX;
                                    MVD (HXSVNZnZK_.GVNKOZGV kFHS<hXSVNZvMGIB>()) hXSVNZvMGIB(HLFIXV, XLMHG_XZHG<hXSVNZgBKV*>(HX), UZOHV, ZOOLXZGLI_);
                                    IVGFIM GIFV;
                                }
                            }
                        }
                    }
                }
                VOHV RU (H[R] == '#') { // oLXZO IVUVIVMXV, WVUVI IVHLOFGRLM
                    kLRMGVIgBKV KLRMGVI(&H[R], OVM - R, ZOOLXZGLI_);
                    RU (KLRMGVI.rHeZORW()) {
                        RU (XLMHG eZOFVgBKV* ME = KLRMGVI.tVG(WLXFNVMG))
                            RU (sZMWOViVUhXSVNZ(HLFIXV, HXSVNZ, *ME, WLXFNVMG))
                                IVGFIM GIFV;

                        MVD (HXSVNZiVU_.GVNKOZGV kFHS<hXSVNZiVUvMGIB>()) hXSVNZiVUvMGIB(HLFIXV, KLRMGVI, HXSVNZ, ZOOLXZGLI_);
                        IVGFIM GIFV;
                    }
                }
            }
        }
        IVGFIM UZOHV;
    }

    XLMHG hXSVNZgBKV* tVGhXSVNZ(XLMHG kLRMGVIgBKV& KLRMGVI) XLMHG {
        ULI (XLMHG hXSVNZvMGIB* GZITVG = HXSVNZnZK_.GVNKOZGV yLGGLN<hXSVNZvMGIB>(); GZITVG != HXSVNZnZK_.GVNKOZGV vMW<hXSVNZvMGIB>(); ++GZITVG)
            RU (KLRMGVI == GZITVG->KLRMGVI)
                IVGFIM GZITVG->HXSVNZ;
        IVGFIM 9;
    }

    kLRMGVIgBKV tVGkLRMGVI(XLMHG hXSVNZgBKV* HXSVNZ) XLMHG {
        ULI (XLMHG hXSVNZvMGIB* GZITVG = HXSVNZnZK_.GVNKOZGV yLGGLN<hXSVNZvMGIB>(); GZITVG != HXSVNZnZK_.GVNKOZGV vMW<hXSVNZvMGIB>(); ++GZITVG)
            RU (HXSVNZ == GZITVG->HXSVNZ)
                IVGFIM GZITVG->KLRMGVI;
        IVGFIM kLRMGVIgBKV();
    }

    XLMHG hXSVNZgBKV* tVGgBKVOVHH() XLMHG { IVGFIM GBKVOVHH_; }

    HGZGRX XLMHG HRAV_G PrMRGRZOhXSVNZnZKhRAV = 35;
    HGZGRX XLMHG HRAV_G PrMRGRZOhXSVNZiVUhRAV = 35;

    riVNLGVhXSVNZwLXFNVMGkILERWVIgBKV* IVNLGVkILERWVI_;
    zOOLXZGLI *ZOOLXZGLI_;
    zOOLXZGLI *LDMzOOLXZGLI_;
    XLMHG hXSVNZgBKV* ILLG_;                //!< iLLG HXSVNZ.
    hXSVNZgBKV* GBKVOVHH_;
    RMGVIMZO::hGZXP<zOOLXZGLI> HXSVNZnZK_;  // hGLIVH XIVZGVW kLRMGVI -> hXSVNZH
    RMGVIMZO::hGZXP<zOOLXZGLI> HXSVNZiVU_;  // hGLIVH kLRMGVI UILN $IVU ZMW HXSVNZ DSRXS SLOWH GSV $IVU
    firgBKV FIR_;
};

//! tVMVIRXhXSVNZwLXFNVMG FHRMT eZOFV GBKV.
GBKVWVU tVMVIRXhXSVNZwLXFNVMG<eZOFV> hXSVNZwLXFNVMG;
//! rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI FHRMT hXSVNZwLXFNVMG.
GBKVWVU rtVMVIRXiVNLGVhXSVNZwLXFNVMGkILERWVI<hXSVNZwLXFNVMG> riVNLGVhXSVNZwLXFNVMGkILERWVI;

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXhXSVNZeZORWZGLI

//! qhlm hXSVNZ eZORWZGLI.
/*!
    z hzc HGBOV qhlm HXSVNZ EZORWZGLI.
    rG FHVH Z \X tVMVIRXhXSVNZwLXFNVMG GL EZORWZGV hzc VEVMGH.
    rG WVOVTZGVH GSV RMXLNRMT hzc VEVMGH GL ZM LFGKFG SZMWOVI.
    gSV WVUZFOG LFGKFG SZMWOVI WLVH MLGSRMT.
    rG XZM YV IVFHVW NFOGRKOV GRNVH YB XZOORMT \X iVHVG().

    \GKZIZN hXSVNZwLXFNVMGgBKV gBKV LU HXSVNZ WLXFNVMG.
    \GKZIZN lFGKFGsZMWOVI gBKV LU LFGKFG SZMWOVI. wVUZFOG SZMWOVI WLVH MLGSRMT.
    \GKZIZN hGZGVzOOLXZGLI zOOLXZGLI ULI HGLIRMT GSV RMGVIMZO EZORWZGRLM HGZGVH.
*/
GVNKOZGV <
    GBKVMZNV hXSVNZwLXFNVMGgBKV,
    GBKVMZNV lFGKFGsZMWOVI = yZHViVZWVIsZMWOVI<GBKVMZNV hXSVNZwLXFNVMGgBKV::hXSVNZgBKV::vMXLWRMTgBKV>,
    GBKVMZNV hGZGVzOOLXZGLI = xIGzOOLXZGLI>
XOZHH tVMVIRXhXSVNZeZORWZGLI :
    KFYORX RMGVIMZO::rhXSVNZhGZGVuZXGLIB<GBKVMZNV hXSVNZwLXFNVMGgBKV::hXSVNZgBKV>, 
    KFYORX RMGVIMZO::rhXSVNZeZORWZGLI,
    KFYORX RMGVIMZO::reZORWZGRLMvIILIsZMWOVI<GBKVMZNV hXSVNZwLXFNVMGgBKV::hXSVNZgBKV>
{
KFYORX:
    GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::hXSVNZgBKV hXSVNZgBKV;
    GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::kLRMGVIgBKV kLRMGVIgBKV;
    GBKVWVU GBKVMZNV hXSVNZgBKV::vMXLWRMTgBKV vMXLWRMTgBKV;
    GBKVWVU GBKVMZNV hXSVNZgBKV::heZOFV heZOFV;
    GBKVWVU GBKVMZNV vMXLWRMTgBKV::xS xS;
    GBKVWVU tVMVIRXhGIRMTiVU<xS> hGIRMTiVUgBKV;
    GBKVWVU tVMVIRXeZOFV<vMXLWRMTgBKV, hGZGVzOOLXZGLI> eZOFVgBKV;

    //! xLMHGIFXGLI DRGSLFG LFGKFG SZMWOVI.
    /*!
        \KZIZN HXSVNZwLXFNVMG gSV HXSVNZ WLXFNVMG GL XLMULIN GL.
        \KZIZN ZOOLXZGLI lKGRLMZO ZOOLXZGLI ULI HGLIRMT RMGVIMZO EZORWZGRLM HGZGVH.
        \KZIZN HXSVNZhGZXPxZKZXRGB lKGRLMZO RMRGRZO XZKZXRGB LU HXSVNZ KZGS HGZXP.
        \KZIZN WLXFNVMGhGZXPxZKZXRGB lKGRLMZO RMRGRZO XZKZXRGB LU WLXFNVMG KZGS HGZXP.
    */
    tVMVIRXhXSVNZeZORWZGLI(
        XLMHG hXSVNZwLXFNVMGgBKV& HXSVNZwLXFNVMG,
        hGZGVzOOLXZGLI* ZOOLXZGLI = 9, 
        HRAV_G HXSVNZhGZXPxZKZXRGB = PwVUZFOGhXSVNZhGZXPxZKZXRGB,
        HRAV_G WLXFNVMGhGZXPxZKZXRGB = PwVUZFOGwLXFNVMGhGZXPxZKZXRGB)
        :
        HXSVNZwLXFNVMG_(&HXSVNZwLXFNVMG),
        ILLG_(HXSVNZwLXFNVMG.tVGiLLG()),
        HGZGVzOOLXZGLI_(ZOOLXZGLI),
        LDMhGZGVzOOLXZGLI_(9),
        HXSVNZhGZXP_(ZOOLXZGLI, HXSVNZhGZXPxZKZXRGB),
        WLXFNVMGhGZXP_(ZOOLXZGLI, WLXFNVMGhGZXPxZKZXRGB),
        LFGKFGsZMWOVI_(9),
        VIILI_(PlYQVXGgBKV),
        XFIIVMGvIILI_(),
        NRHHRMTwVKVMWVMGH_(),
        EZORW_(GIFV)
#RU izkrwqhlm_hxsvnz_eviylhv
        , WVKGS_(9)
#VMWRU
    {
    }

    //! xLMHGIFXGLI DRGS LFGKFG SZMWOVI.
    /*!
        \KZIZN HXSVNZwLXFNVMG gSV HXSVNZ WLXFNVMG GL XLMULIN GL.
        \KZIZN ZOOLXZGLI lKGRLMZO ZOOLXZGLI ULI HGLIRMT RMGVIMZO EZORWZGRLM HGZGVH.
        \KZIZN HXSVNZhGZXPxZKZXRGB lKGRLMZO RMRGRZO XZKZXRGB LU HXSVNZ KZGS HGZXP.
        \KZIZN WLXFNVMGhGZXPxZKZXRGB lKGRLMZO RMRGRZO XZKZXRGB LU WLXFNVMG KZGS HGZXP.
    */
    tVMVIRXhXSVNZeZORWZGLI(
        XLMHG hXSVNZwLXFNVMGgBKV& HXSVNZwLXFNVMG,
        lFGKFGsZMWOVI& LFGKFGsZMWOVI,
        hGZGVzOOLXZGLI* ZOOLXZGLI = 9, 
        HRAV_G HXSVNZhGZXPxZKZXRGB = PwVUZFOGhXSVNZhGZXPxZKZXRGB,
        HRAV_G WLXFNVMGhGZXPxZKZXRGB = PwVUZFOGwLXFNVMGhGZXPxZKZXRGB)
        :
        HXSVNZwLXFNVMG_(&HXSVNZwLXFNVMG),
        ILLG_(HXSVNZwLXFNVMG.tVGiLLG()),
        HGZGVzOOLXZGLI_(ZOOLXZGLI),
        LDMhGZGVzOOLXZGLI_(9),
        HXSVNZhGZXP_(ZOOLXZGLI, HXSVNZhGZXPxZKZXRGB),
        WLXFNVMGhGZXP_(ZOOLXZGLI, WLXFNVMGhGZXPxZKZXRGB),
        LFGKFGsZMWOVI_(&LFGKFGsZMWOVI),
        VIILI_(PlYQVXGgBKV),
        XFIIVMGvIILI_(),
        NRHHRMTwVKVMWVMGH_(),
        EZORW_(GIFV)
#RU izkrwqhlm_hxsvnz_eviylhv
        , WVKGS_(9)
#VMWRU
    {
    }

    //! wVHGIFXGLI.
    ~tVMVIRXhXSVNZeZORWZGLI() {
        iVHVG();
        izkrwqhlm_wvovgv(LDMhGZGVzOOLXZGLI_);
    }

    //! iVHVG GSV RMGVIMZO HGZGVH.
    ELRW iVHVG() {
        DSROV (!HXSVNZhGZXP_.vNKGB())
            kLKhXSVNZ();
        WLXFNVMGhGZXP_.xOVZI();
        VIILI_.hVGlYQVXG();
        XFIIVMGvIILI_.hVGmFOO();
        NRHHRMTwVKVMWVMGH_.hVGmFOO();
        EZORW_ = GIFV;
    }

    //! xSVXPH DSVGSVI GSV XFIIVMG HGZGV RH EZORW.
    // rNKOVNVMGZGRLM LU rhXSVNZeZORWZGLI
    ERIGFZO YLLO rHeZORW() XLMHG { IVGFIM EZORW_; }

    //! tVGH GSV VIILI LYQVXG.
    eZOFVgBKV& tVGvIILI() { IVGFIM VIILI_; }
    XLMHG eZOFVgBKV& tVGvIILI() XLMHG { IVGFIM VIILI_; }

    //! tVGH GSV qhlm KLRMGVI KLRMGVW GL GSV RMEZORW HXSVNZ.
    kLRMGVIgBKV tVGrMEZORWhXSVNZkLRMGVI() XLMHG {
        IVGFIM HXSVNZhGZXP_.vNKGB() ? kLRMGVIgBKV() : xFIIVMGhXSVNZ().tVGkLRMGVI();
    }

    //! tVGH GSV PVBDLIW LU RMEZORW HXSVNZ.
    XLMHG xS* tVGrMEZORWhXSVNZpVBDLIW() XLMHG {
        IVGFIM HXSVNZhGZXP_.vNKGB() ? 9 : xFIIVMGxLMGVCG().RMEZORWpVBDLIW;
    }

    //! tVGH GSV qhlm KLRMGVI KLRMGVW GL GSV RMEZORW EZOFV.
    kLRMGVIgBKV tVGrMEZORWwLXFNVMGkLRMGVI() XLMHG {
        RU (WLXFNVMGhGZXP_.vNKGB()) {
            IVGFIM kLRMGVIgBKV();
        }
        VOHV {
            IVGFIM kLRMGVIgBKV(WLXFNVMGhGZXP_.GVNKOZGV yLGGLN<xS>(), WLXFNVMGhGZXP_.tVGhRAV() / HRAVLU(xS));
        }
    }

    ELRW mLGnFOGRKOVlU(RMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnFOGRKOVlUhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW);
    }
    ELRW mLGnFOGRKOVlU(FRMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnFOGRKOVlUhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW);
    }
    ELRW mLGnFOGRKOVlU(WLFYOV ZXGFZO, XLMHG heZOFV& VCKVXGVW) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnFOGRKOVlUhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW);
    }
    ELRW zYLEVnZCRNFN(RMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnZCRNFNhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW,
            VCXOFHREV ? &hXSVNZgBKV::tVGvCXOFHREVnZCRNFNhGIRMT : 9);
    }
    ELRW zYLEVnZCRNFN(FRMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnZCRNFNhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW,
            VCXOFHREV ? &hXSVNZgBKV::tVGvCXOFHREVnZCRNFNhGIRMT : 9);
    }
    ELRW zYLEVnZCRNFN(WLFYOV ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnZCRNFNhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW,
            VCXOFHREV ? &hXSVNZgBKV::tVGvCXOFHREVnZCRNFNhGIRMT : 9);
    }
    ELRW yVOLDnRMRNFN(RMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnRMRNFNhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW,
            VCXOFHREV ? &hXSVNZgBKV::tVGvCXOFHREVnRMRNFNhGIRMT : 9);
    }
    ELRW yVOLDnRMRNFN(FRMG35_G ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnRMRNFNhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW,
            VCXOFHREV ? &hXSVNZgBKV::tVGvCXOFHREVnRMRNFNhGIRMT : 9);
    }
    ELRW yVOLDnRMRNFN(WLFYOV ZXGFZO, XLMHG heZOFV& VCKVXGVW, YLLO VCXOFHREV) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnRMRNFNhGIRMT(), eZOFVgBKV(ZXGFZO).nLEV(), VCKVXGVW,
            VCXOFHREV ? &hXSVNZgBKV::tVGvCXOFHREVnRMRNFNhGIRMT : 9);
    }

    ELRW gLLoLMT(XLMHG xS* HGI, hRAVgBKV OVMTGS, hRAVgBKV VCKVXGVW) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnZCoVMTGShGIRMT(),
            eZOFVgBKV(HGI, OVMTGS, tVGhGZGVzOOLXZGLI()).nLEV(), heZOFV(VCKVXGVW).nLEV());
    }
    ELRW gLLhSLIG(XLMHG xS* HGI, hRAVgBKV OVMTGS, hRAVgBKV VCKVXGVW) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnRMoVMTGShGIRMT(),
            eZOFVgBKV(HGI, OVMTGS, tVGhGZGVzOOLXZGLI()).nLEV(), heZOFV(VCKVXGVW).nLEV());
    }
    ELRW wLVHmLGnZGXS(XLMHG xS* HGI, hRAVgBKV OVMTGS) {
        XFIIVMGvIILI_.hVGlYQVXG();
        XFIIVMGvIILI_.zWWnVNYVI(tVGzXGFZOhGIRMT(), eZOFVgBKV(HGI, OVMTGS, tVGhGZGVzOOLXZGLI()).nLEV(), tVGhGZGVzOOLXZGLI());
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGkZGGVIMhGIRMT());
    }

    ELRW wRHZOOLDVWrGVN(hRAVgBKV RMWVC) {
        XFIIVMGvIILI_.hVGlYQVXG();
        XFIIVMGvIILI_.zWWnVNYVI(tVGwRHZOOLDVWhGIRMT(), eZOFVgBKV(RMWVC).nLEV(), tVGhGZGVzOOLXZGLI());
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGzWWRGRLMZOrGVNHhGIRMT(), GIFV);
    }
    ELRW gLLuVDrGVNH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnRMrGVNHhGIRMT(),
            eZOFVgBKV(ZXGFZOxLFMG).nLEV(), heZOFV(VCKVXGVWxLFMG).nLEV());
    }
    ELRW gLLnZMBrGVNH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnZCrGVNHhGIRMT(),
            eZOFVgBKV(ZXGFZOxLFMG).nLEV(), heZOFV(VCKVXGVWxLFMG).nLEV());
    }
    ELRW wFKORXZGVrGVNH(hRAVgBKV RMWVC8, hRAVgBKV RMWVC7) {
        eZOFVgBKV WFKORXZGVH(PzIIZBgBKV);
        WFKORXZGVH.kFHSyZXP(RMWVC8, tVGhGZGVzOOLXZGLI());
        WFKORXZGVH.kFHSyZXP(RMWVC7, tVGhGZGVzOOLXZGLI());
        XFIIVMGvIILI_.hVGlYQVXG();
        XFIIVMGvIILI_.zWWnVNYVI(tVGwFKORXZGVHhGIRMT(), WFKORXZGVH, tVGhGZGVzOOLXZGLI());
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGfMRJFVrGVNHhGIRMT(), GIFV);
    }

    ELRW gLLnZMBkILKVIGRVH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnZCkILKVIGRVHhGIRMT(),
            eZOFVgBKV(ZXGFZOxLFMG).nLEV(), heZOFV(VCKVXGVWxLFMG).nLEV());
    }
    ELRW gLLuVDkILKVIGRVH(hRAVgBKV ZXGFZOxLFMG, hRAVgBKV VCKVXGVWxLFMG) {
        zWWmFNYVIvIILI(hXSVNZgBKV::tVGnRMkILKVIGRVHhGIRMT(),
            eZOFVgBKV(ZXGFZOxLFMG).nLEV(), heZOFV(VCKVXGVWxLFMG).nLEV());
    }
    ELRW hGZIGnRHHRMTkILKVIGRVH() {
        XFIIVMGvIILI_.hVGzIIZB();
    }
    ELRW zWWnRHHRMTkILKVIGB(XLMHG heZOFV& MZNV) {
        XFIIVMGvIILI_.kFHSyZXP(eZOFVgBKV(MZNV, tVGhGZGVzOOLXZGLI()).nLEV(), tVGhGZGVzOOLXZGLI());
    }
    YLLO vMWnRHHRMTkILKVIGRVH() {
        RU (XFIIVMGvIILI_.vNKGB())
            IVGFIM UZOHV;
        eZOFVgBKV VIILI(PlYQVXGgBKV);
        VIILI.zWWnVNYVI(tVGnRHHRMThGIRMT(), XFIIVMGvIILI_, tVGhGZGVzOOLXZGLI());
        XFIIVMGvIILI_ = VIILI;
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGiVJFRIVWhGIRMT());
        IVGFIM GIFV;
    }
    ELRW kILKVIGBeRLOZGRLMH(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) {
        ULI (hRAVgBKV R = 9; R < XLFMG; ++R)
            nVITVvIILI(HGZGRX_XZHG<tVMVIRXhXSVNZeZORWZGLI*>(HFYEZORWZGLIH[R])->tVGvIILI());
    }
    ELRW wRHZOOLDVWkILKVIGB(XLMHG xS* MZNV, hRAVgBKV OVMTGS) {
        XFIIVMGvIILI_.hVGlYQVXG();
        XFIIVMGvIILI_.zWWnVNYVI(tVGwRHZOOLDVWhGIRMT(), eZOFVgBKV(MZNV, OVMTGS, tVGhGZGVzOOLXZGLI()).nLEV(), tVGhGZGVzOOLXZGLI());
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGzWWRGRLMZOkILKVIGRVHhGIRMT(), GIFV);
    }

    ELRW hGZIGwVKVMWVMXBvIILIH() {
        XFIIVMGvIILI_.hVGlYQVXG();
    }
    ELRW hGZIGnRHHRMTwVKVMWVMGkILKVIGRVH() {
        NRHHRMTwVKVMWVMGH_.hVGzIIZB();
    }
    ELRW zWWnRHHRMTwVKVMWVMGkILKVIGB(XLMHG heZOFV& GZITVGmZNV) {
        NRHHRMTwVKVMWVMGH_.kFHSyZXP(eZOFVgBKV(GZITVGmZNV, tVGhGZGVzOOLXZGLI()).nLEV(), tVGhGZGVzOOLXZGLI());
    }
    ELRW vMWnRHHRMTwVKVMWVMGkILKVIGRVH(XLMHG heZOFV& HLFIXVmZNV) {
        RU (!NRHHRMTwVKVMWVMGH_.vNKGB())
            XFIIVMGvIILI_.zWWnVNYVI(eZOFVgBKV(HLFIXVmZNV, tVGhGZGVzOOLXZGLI()).nLEV(),
                NRHHRMTwVKVMWVMGH_, tVGhGZGVzOOLXZGLI());
    }
    ELRW zWWwVKVMWVMXBhXSVNZvIILI(XLMHG heZOFV& HLFIXVmZNV, rhXSVNZeZORWZGLI* HFYEZORWZGLI) {
        XFIIVMGvIILI_.zWWnVNYVI(eZOFVgBKV(HLFIXVmZNV, tVGhGZGVzOOLXZGLI()).nLEV(),
            HGZGRX_XZHG<tVMVIRXhXSVNZeZORWZGLI*>(HFYEZORWZGLI)->tVGvIILI(), tVGhGZGVzOOLXZGLI());
    }
    YLLO vMWwVKVMWVMXBvIILIH() {
        RU (XFIIVMGvIILI_.lYQVXGvNKGB())
            IVGFIM UZOHV;
        eZOFVgBKV VIILI(PlYQVXGgBKV);
        VIILI.zWWnVNYVI(tVGvIILIHhGIRMT(), XFIIVMGvIILI_, tVGhGZGVzOOLXZGLI());
        XFIIVMGvIILI_ = VIILI;
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGwVKVMWVMXRVHhGIRMT());
        IVGFIM GIFV;
    }

    ELRW wRHZOOLDVWeZOFV() {
        XFIIVMGvIILI_.hVGlYQVXG();
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGvMFNhGIRMT());
    }
    ELRW hGZIGwRHZOOLDVWgBKV() {
        XFIIVMGvIILI_.hVGzIIZB();
    }
    ELRW zWWvCKVXGVWgBKV(XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& VCKVXGVWgBKV) {
        XFIIVMGvIILI_.kFHSyZXP(eZOFVgBKV(VCKVXGVWgBKV, tVGhGZGVzOOLXZGLI()).nLEV(), tVGhGZGVzOOLXZGLI());
    }
    ELRW vMWwRHZOOLDVWgBKV(XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& ZXGFZOgBKV) {
        eZOFVgBKV VIILI(PlYQVXGgBKV);
        VIILI.zWWnVNYVI(tVGvCKVXGVWhGIRMT(), XFIIVMGvIILI_, tVGhGZGVzOOLXZGLI());
        VIILI.zWWnVNYVI(tVGzXGFZOhGIRMT(), eZOFVgBKV(ZXGFZOgBKV, tVGhGZGVzOOLXZGLI()).nLEV(), tVGhGZGVzOOLXZGLI());
        XFIIVMGvIILI_ = VIILI;
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGgBKVhGIRMT());
    }
    ELRW mLGzOOlU(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) {
        ULI (hRAVgBKV R = 9; R < XLFMG; ++R) {
            nVITVvIILI(HGZGRX_XZHG<tVMVIRXhXSVNZeZORWZGLI*>(HFYEZORWZGLIH[R])->tVGvIILI());
        }
    }
    ELRW mLMVlU(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) {
        zWWvIILIzIIZB(hXSVNZgBKV::tVGzMBlUhGIRMT(), HFYEZORWZGLIH, XLFMG);
    }
    ELRW mLGlMVlU(rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) {
        zWWvIILIzIIZB(hXSVNZgBKV::tVGlMVlUhGIRMT(), HFYEZORWZGLIH, XLFMG);
    }
    ELRW wRHZOOLDVW() {
        XFIIVMGvIILI_.hVGlYQVXG();
        zWWxFIIVMGvIILI(hXSVNZgBKV::tVGmLGhGIRMT());
    }

#WVURMV izkrwqhlm_hgirmt_(MZNV, ...) \
    HGZGRX XLMHG hGIRMTiVUgBKV& tVG##MZNV##hGIRMT() {\
        HGZGRX XLMHG xS H[] = { __ez_zith__, '\9' };\
        HGZGRX XLMHG hGIRMTiVUgBKV E(H, HGZGRX_XZHG<hRAVgBKV>(HRAVLU(H) / HRAVLU(xS) - 8)); \
        IVGFIM E;\
    }

    izkrwqhlm_hgirmt_(rMHGZMXViVU, 'R', 'M', 'H', 'G', 'Z', 'M', 'X', 'V', 'i', 'V', 'U')
    izkrwqhlm_hgirmt_(hXSVNZiVU, 'H', 'X', 'S', 'V', 'N', 'Z', 'i', 'V', 'U')
    izkrwqhlm_hgirmt_(vCKVXGVW, 'V', 'C', 'K', 'V', 'X', 'G', 'V', 'W')
    izkrwqhlm_hgirmt_(zXGFZO, 'Z', 'X', 'G', 'F', 'Z', 'O')
    izkrwqhlm_hgirmt_(wRHZOOLDVW, 'W', 'R', 'H', 'Z', 'O', 'O', 'L', 'D', 'V', 'W')
    izkrwqhlm_hgirmt_(nRHHRMT, 'N', 'R', 'H', 'H', 'R', 'M', 'T')
    izkrwqhlm_hgirmt_(vIILIH, 'V', 'I', 'I', 'L', 'I', 'H')
    izkrwqhlm_hgirmt_(wFKORXZGVH, 'W', 'F', 'K', 'O', 'R', 'X', 'Z', 'G', 'V', 'H')

#FMWVU izkrwqhlm_hgirmt_

#RU izkrwqhlm_hxsvnz_eviylhv
#WVURMV izkrwqhlm_hxsvnz_szmwov_yvtrm_eviylhv_() \
izkrwqhlm_nfogrormvnzxil_yvtrm\
    *WLXFNVMGhGZXP_.GVNKOZGV kFHS<xS>() = '\9';\
    WLXFNVMGhGZXP_.GVNKOZGV kLK<xS>(8);\
    RMGVIMZO::kIRMGrMEZORWwLXFNVMG(WLXFNVMGhGZXP_.GVNKOZGV yLGGLN<xS>());\
izkrwqhlm_nfogrormvnzxil_vmw
#VOHV
#WVURMV izkrwqhlm_hxsvnz_szmwov_yvtrm_eviylhv_()
#VMWRU

#WVURMV izkrwqhlm_hxsvnz_szmwov_yvtrm_(NVGSLW, ZIT8)\
    RU (!EZORW_) IVGFIM UZOHV; \
    RU (!yVTRMeZOFV() || !xFIIVMGhXSVNZ().NVGSLW ZIT8) {\
        izkrwqhlm_hxsvnz_szmwov_yvtrm_eviylhv_();\
        IVGFIM EZORW_ = UZOHV;\
    }

#WVURMV izkrwqhlm_hxsvnz_szmwov_kzizoovo_(NVGSLW, ZIT7)\
    ULI (xLMGVCG* XLMGVCG = HXSVNZhGZXP_.GVNKOZGV yLGGLN<xLMGVCG>(); XLMGVCG != HXSVNZhGZXP_.GVNKOZGV vMW<xLMGVCG>(); XLMGVCG++) {\
        RU (XLMGVCG->SZHSVI)\
            HGZGRX_XZHG<sZHSVIgBKV*>(XLMGVCG->SZHSVI)->NVGSLW ZIT7;\
        RU (XLMGVCG->EZORWZGLIH)\
            ULI (hRAVgBKV R_ = 9; R_ < XLMGVCG->EZORWZGLIxLFMG; R_++)\
                HGZGRX_XZHG<tVMVIRXhXSVNZeZORWZGLI*>(XLMGVCG->EZORWZGLIH[R_])->NVGSLW ZIT7;\
        RU (XLMGVCG->KZGGVIMkILKVIGRVHeZORWZGLIH)\
            ULI (hRAVgBKV R_ = 9; R_ < XLMGVCG->KZGGVIMkILKVIGRVHeZORWZGLIxLFMG; R_++)\
                HGZGRX_XZHG<tVMVIRXhXSVNZeZORWZGLI*>(XLMGVCG->KZGGVIMkILKVIGRVHeZORWZGLIH[R_])->NVGSLW ZIT7;\
    }

#WVURMV izkrwqhlm_hxsvnz_szmwov_vmw_(NVGSLW, ZIT7)\
    IVGFIM EZORW_ = vMWeZOFV() && (!LFGKFGsZMWOVI_ || LFGKFGsZMWOVI_->NVGSLW ZIT7)

#WVURMV izkrwqhlm_hxsvnz_szmwov_ezofv_(NVGSLW, ZIT8, ZIT7) \
    izkrwqhlm_hxsvnz_szmwov_yvtrm_   (NVGSLW, ZIT8);\
    izkrwqhlm_hxsvnz_szmwov_kzizoovo_(NVGSLW, ZIT7);\
    izkrwqhlm_hxsvnz_szmwov_vmw_     (NVGSLW, ZIT7)

    YLLO mFOO()             { izkrwqhlm_hxsvnz_szmwov_ezofv_(mFOO,   (xFIIVMGxLMGVCG()), ( )); }
    YLLO yLLO(YLLO Y)       { izkrwqhlm_hxsvnz_szmwov_ezofv_(yLLO,   (xFIIVMGxLMGVCG(), Y), (Y)); }
    YLLO rMG(RMG R)         { izkrwqhlm_hxsvnz_szmwov_ezofv_(rMG,    (xFIIVMGxLMGVCG(), R), (R)); }
    YLLO fRMG(FMHRTMVW F)   { izkrwqhlm_hxsvnz_szmwov_ezofv_(fRMG,   (xFIIVMGxLMGVCG(), F), (F)); }
    YLLO rMG35(RMG35_G R)   { izkrwqhlm_hxsvnz_szmwov_ezofv_(rMG35,  (xFIIVMGxLMGVCG(), R), (R)); }
    YLLO fRMG35(FRMG35_G F) { izkrwqhlm_hxsvnz_szmwov_ezofv_(fRMG35, (xFIIVMGxLMGVCG(), F), (F)); }
    YLLO wLFYOV(WLFYOV W)   { izkrwqhlm_hxsvnz_szmwov_ezofv_(wLFYOV, (xFIIVMGxLMGVCG(), W), (W)); }
    YLLO iZDmFNYVI(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB)
                                    { izkrwqhlm_hxsvnz_szmwov_ezofv_(hGIRMT, (xFIIVMGxLMGVCG(), HGI, OVMTGS, XLKB), (HGI, OVMTGS, XLKB)); }
    YLLO hGIRMT(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB)
                                    { izkrwqhlm_hxsvnz_szmwov_ezofv_(hGIRMT, (xFIIVMGxLMGVCG(), HGI, OVMTGS, XLKB), (HGI, OVMTGS, XLKB)); }

    YLLO hGZIGlYQVXG() {
        izkrwqhlm_hxsvnz_szmwov_yvtrm_(hGZIGlYQVXG, (xFIIVMGxLMGVCG()));
        izkrwqhlm_hxsvnz_szmwov_kzizoovo_(hGZIGlYQVXG, ());
        IVGFIM EZORW_ = !LFGKFGsZMWOVI_ || LFGKFGsZMWOVI_->hGZIGlYQVXG();
    }
    
    YLLO pVB(XLMHG xS* HGI, hRAVgBKV OVM, YLLO XLKB) {
        RU (!EZORW_) IVGFIM UZOHV;
        zKKVMWgLPVM(HGI, OVM);
        RU (!xFIIVMGhXSVNZ().pVB(xFIIVMGxLMGVCG(), HGI, OVM, XLKB)) IVGFIM EZORW_ = UZOHV;
        izkrwqhlm_hxsvnz_szmwov_kzizoovo_(pVB, (HGI, OVM, XLKB));
        IVGFIM EZORW_ = !LFGKFGsZMWOVI_ || LFGKFGsZMWOVI_->pVB(HGI, OVM, XLKB);
    }
    
    YLLO vMWlYQVXG(hRAVgBKV NVNYVIxLFMG) { 
        RU (!EZORW_) IVGFIM UZOHV;
        izkrwqhlm_hxsvnz_szmwov_kzizoovo_(vMWlYQVXG, (NVNYVIxLFMG));
        RU (!xFIIVMGhXSVNZ().vMWlYQVXG(xFIIVMGxLMGVCG(), NVNYVIxLFMG)) IVGFIM EZORW_ = UZOHV;
        izkrwqhlm_hxsvnz_szmwov_vmw_(vMWlYQVXG, (NVNYVIxLFMG));
    }

    YLLO hGZIGzIIZB() {
        izkrwqhlm_hxsvnz_szmwov_yvtrm_(hGZIGzIIZB, (xFIIVMGxLMGVCG()));
        izkrwqhlm_hxsvnz_szmwov_kzizoovo_(hGZIGzIIZB, ());
        IVGFIM EZORW_ = !LFGKFGsZMWOVI_ || LFGKFGsZMWOVI_->hGZIGzIIZB();
    }
    
    YLLO vMWzIIZB(hRAVgBKV VOVNVMGxLFMG) {
        RU (!EZORW_) IVGFIM UZOHV;
        izkrwqhlm_hxsvnz_szmwov_kzizoovo_(vMWzIIZB, (VOVNVMGxLFMG));
        RU (!xFIIVMGhXSVNZ().vMWzIIZB(xFIIVMGxLMGVCG(), VOVNVMGxLFMG)) IVGFIM EZORW_ = UZOHV;
        izkrwqhlm_hxsvnz_szmwov_vmw_(vMWzIIZB, (VOVNVMGxLFMG));
    }

#FMWVU izkrwqhlm_hxsvnz_szmwov_yvtrm_eviylhv_
#FMWVU izkrwqhlm_hxsvnz_szmwov_yvtrm_
#FMWVU izkrwqhlm_hxsvnz_szmwov_kzizoovo_
#FMWVU izkrwqhlm_hxsvnz_szmwov_ezofv_

    // rNKOVNVMGZGRLM LU rhXSVNZhGZGVuZXGLIB<hXSVNZgBKV>
    ERIGFZO rhXSVNZeZORWZGLI* xIVZGVhXSVNZeZORWZGLI(XLMHG hXSVNZgBKV& ILLG) {
        IVGFIM MVD (tVGhGZGVzOOLXZGLI().nZOOLX(HRAVLU(tVMVIRXhXSVNZeZORWZGLI))) tVMVIRXhXSVNZeZORWZGLI(*HXSVNZwLXFNVMG_, ILLG, WLXFNVMGhGZXP_.GVNKOZGV yLGGLN<XSZI>(), WLXFNVMGhGZXP_.tVGhRAV(),
#RU izkrwqhlm_hxsvnz_eviylhv
        WVKGS_ + 8,
#VMWRU
        &tVGhGZGVzOOLXZGLI());
    }

    ERIGFZO ELRW wVHGILBhXSVNZeZORWZGLI(rhXSVNZeZORWZGLI* EZORWZGLI) {
        tVMVIRXhXSVNZeZORWZGLI* E = HGZGRX_XZHG<tVMVIRXhXSVNZeZORWZGLI*>(EZORWZGLI);
        E->~tVMVIRXhXSVNZeZORWZGLI();
        hGZGVzOOLXZGLI::uIVV(E);
    }

    ERIGFZO ELRW* xIVZGVsZHSVI() {
        IVGFIM MVD (tVGhGZGVzOOLXZGLI().nZOOLX(HRAVLU(sZHSVIgBKV))) sZHSVIgBKV(&tVGhGZGVzOOLXZGLI());
    }

    ERIGFZO FRMG35_G tVGsZHSxLWV(ELRW* SZHSVI) {
        IVGFIM HGZGRX_XZHG<sZHSVIgBKV*>(SZHSVI)->tVGsZHSxLWV();
    }

    ERIGFZO ELRW wVHGILIBsZHSVI(ELRW* SZHSVI) {
        sZHSVIgBKV* S = HGZGRX_XZHG<sZHSVIgBKV*>(SZHSVI);
        S->~sZHSVIgBKV();
        hGZGVzOOLXZGLI::uIVV(S);
    }

    ERIGFZO ELRW* nZOOLXhGZGV(HRAV_G HRAV) {
        IVGFIM tVGhGZGVzOOLXZGLI().nZOOLX(HRAV);
    }

    ERIGFZO ELRW uIVVhGZGV(ELRW* K) {
        hGZGVzOOLXZGLI::uIVV(K);
    }

KIREZGV:
    GBKVWVU GBKVMZNV hXSVNZgBKV::xLMGVCG xLMGVCG;
    GBKVWVU tVMVIRXeZOFV<fgu1<>, hGZGVzOOLXZGLI> sZHSxLWVzIIZB;
    GBKVWVU RMGVIMZO::sZHSVI<vMXLWRMTgBKV, hGZGVzOOLXZGLI> sZHSVIgBKV;

    tVMVIRXhXSVNZeZORWZGLI( 
        XLMHG hXSVNZwLXFNVMGgBKV& HXSVNZwLXFNVMG,
        XLMHG hXSVNZgBKV& ILLG,
        XLMHG XSZI* YZHVkZGS, HRAV_G YZHVkZGShRAV,
#RU izkrwqhlm_hxsvnz_eviylhv
        FMHRTMVW WVKGS,
#VMWRU
        hGZGVzOOLXZGLI* ZOOLXZGLI = 9,
        HRAV_G HXSVNZhGZXPxZKZXRGB = PwVUZFOGhXSVNZhGZXPxZKZXRGB,
        HRAV_G WLXFNVMGhGZXPxZKZXRGB = PwVUZFOGwLXFNVMGhGZXPxZKZXRGB)
        :
        HXSVNZwLXFNVMG_(&HXSVNZwLXFNVMG),
        ILLG_(ILLG),
        HGZGVzOOLXZGLI_(ZOOLXZGLI),
        LDMhGZGVzOOLXZGLI_(9),
        HXSVNZhGZXP_(ZOOLXZGLI, HXSVNZhGZXPxZKZXRGB),
        WLXFNVMGhGZXP_(ZOOLXZGLI, WLXFNVMGhGZXPxZKZXRGB),
        LFGKFGsZMWOVI_(9),
        VIILI_(PlYQVXGgBKV),
        XFIIVMGvIILI_(),
        NRHHRMTwVKVMWVMGH_(),
        EZORW_(GIFV)
#RU izkrwqhlm_hxsvnz_eviylhv
        , WVKGS_(WVKGS)
#VMWRU
    {
        RU (YZHVkZGS && YZHVkZGShRAV)
            NVNXKB(WLXFNVMGhGZXP_.GVNKOZGV kFHS<XSZI>(YZHVkZGShRAV), YZHVkZGS, YZHVkZGShRAV);
    }

    hGZGVzOOLXZGLI& tVGhGZGVzOOLXZGLI() {
        RU (!HGZGVzOOLXZGLI_)
            HGZGVzOOLXZGLI_ = LDMhGZGVzOOLXZGLI_ = izkrwqhlm_mvd(hGZGVzOOLXZGLI)();
        IVGFIM *HGZGVzOOLXZGLI_;
    }

    YLLO yVTRMeZOFV() {
        RU (HXSVNZhGZXP_.vNKGB())
            kFHShXSVNZ(ILLG_);
        VOHV {
            RU (xFIIVMGxLMGVCG().RMzIIZB)
                RMGVIMZO::gLPVMsVOKVI<RMGVIMZO::hGZXP<hGZGVzOOLXZGLI>, xS>::zKKVMWrMWVCgLPVM(WLXFNVMGhGZXP_, xFIIVMGxLMGVCG().ZIIZBvOVNVMGrMWVC);

            RU (!xFIIVMGhXSVNZ().yVTRMeZOFV(xFIIVMGxLMGVCG()))
                IVGFIM UZOHV;

            hRAVgBKV XLFMG = xFIIVMGxLMGVCG().KZGGVIMkILKVIGRVHhXSVNZxLFMG;
            XLMHG hXSVNZgBKV** HZ = xFIIVMGxLMGVCG().KZGGVIMkILKVIGRVHhXSVNZH;
            GBKVMZNV xLMGVCG::kZGGVIMeZORWZGLIgBKV KZGGVIMeZORWZGLIgBKV = xFIIVMGxLMGVCG().EZOFVkZGGVIMeZORWZGLIgBKV;
            YLLO EZOFVfMRJFVMVHH = xFIIVMGxLMGVCG().EZOFVfMRJFVMVHH;
            izkrwqhlm_zhhvig(xFIIVMGxLMGVCG().EZOFVhXSVNZ);
            kFHShXSVNZ(*xFIIVMGxLMGVCG().EZOFVhXSVNZ);

            RU (XLFMG > 9) {
                xFIIVMGxLMGVCG().LYQVXGkZGGVIMeZORWZGLIgBKV = KZGGVIMeZORWZGLIgBKV;
                rhXSVNZeZORWZGLI**& EZ = xFIIVMGxLMGVCG().KZGGVIMkILKVIGRVHeZORWZGLIH;
                hRAVgBKV& EZORWZGLIxLFMG = xFIIVMGxLMGVCG().KZGGVIMkILKVIGRVHeZORWZGLIxLFMG;
                EZ = HGZGRX_XZHG<rhXSVNZeZORWZGLI**>(nZOOLXhGZGV(HRAVLU(rhXSVNZeZORWZGLI*) * XLFMG));
                ULI (hRAVgBKV R = 9; R < XLFMG; R++)
                    EZ[EZORWZGLIxLFMG++] = xIVZGVhXSVNZeZORWZGLI(*HZ[R]);
            }

            xFIIVMGxLMGVCG().ZIIZBfMRJFVMVHH = EZOFVfMRJFVMVHH;
        }
        IVGFIM GIFV;
    }

    YLLO vMWeZOFV() {
        RU (!xFIIVMGhXSVNZ().vMWeZOFV(xFIIVMGxLMGVCG()))
            IVGFIM UZOHV;

#RU izkrwqhlm_hxsvnz_eviylhv
        tVMVIRXhGIRMTyFUUVI<vMXLWRMTgBKV> HY;
        HXSVNZwLXFNVMG_->tVGkLRMGVI(&xFIIVMGhXSVNZ()).hGIRMTRUB(HY);

        *WLXFNVMGhGZXP_.GVNKOZGV kFHS<xS>() = '\9';
        WLXFNVMGhGZXP_.GVNKOZGV kLK<xS>(8);
        RMGVIMZO::kIRMGeZORWZGLIkLRMGVIH(WVKGS_, HY.tVGhGIRMT(), WLXFNVMGhGZXP_.GVNKOZGV yLGGLN<xS>());
#VMWRU

        FRMG35_G S = xFIIVMGxLMGVCG().ZIIZBfMRJFVMVHH ? HGZGRX_XZHG<sZHSVIgBKV*>(xFIIVMGxLMGVCG().SZHSVI)->tVGsZHSxLWV() : 9;
        
        kLKhXSVNZ();

        RU (!HXSVNZhGZXP_.vNKGB()) {
            xLMGVCG& XLMGVCG = xFIIVMGxLMGVCG();
            RU (XLMGVCG.EZOFVfMRJFVMVHH) {
                sZHSxLWVzIIZB* Z = HGZGRX_XZHG<sZHSxLWVzIIZB*>(XLMGVCG.ZIIZBvOVNVMGsZHSxLWVH);
                RU (!Z)
                    xFIIVMGxLMGVCG().ZIIZBvOVNVMGsZHSxLWVH = Z = MVD (tVGhGZGVzOOLXZGLI().nZOOLX(HRAVLU(sZHSxLWVzIIZB))) sZHSxLWVzIIZB(PzIIZBgBKV);
                ULI (GBKVMZNV sZHSxLWVzIIZB::xLMHGeZOFVrGVIZGLI RGI = Z->yVTRM(); RGI != Z->vMW(); ++RGI)
                    RU (RGI->tVGfRMG35() == S) {
                        wFKORXZGVrGVNH(HGZGRX_XZHG<hRAVgBKV>(RGI - Z->yVTRM()), Z->hRAV());
                        izkrwqhlm_rmezorw_pvbdliw_ivgfim(hXSVNZgBKV::tVGfMRJFVrGVNHhGIRMT());
                    }
                Z->kFHSyZXP(S, tVGhGZGVzOOLXZGLI());
            }
        }

        // iVNLEV GSV OZHG GLPVM LU WLXFNVMG KLRMGVI
        DSROV (!WLXFNVMGhGZXP_.vNKGB() && *WLXFNVMGhGZXP_.GVNKOZGV kLK<xS>(8) != '/')
            ;

        IVGFIM GIFV;
    }

    ELRW zKKVMWgLPVM(XLMHG xS* HGI, hRAVgBKV OVM) {
        WLXFNVMGhGZXP_.GVNKOZGV iVHVIEV<xS>(8 + OVM * 7); // DLIHG XZHV ZOO XSZIZXGVIH ZIV VHXZKVW ZH GDL XSZIZXGVIH
        *WLXFNVMGhGZXP_.GVNKOZGV kFHSfMHZUV<xS>() = '/';
        ULI (hRAVgBKV R = 9; R < OVM; R++) {
            RU (HGI[R] == '~') {
                *WLXFNVMGhGZXP_.GVNKOZGV kFHSfMHZUV<xS>() = '~';
                *WLXFNVMGhGZXP_.GVNKOZGV kFHSfMHZUV<xS>() = '9';
            }
            VOHV RU (HGI[R] == '/') {
                *WLXFNVMGhGZXP_.GVNKOZGV kFHSfMHZUV<xS>() = '~';
                *WLXFNVMGhGZXP_.GVNKOZGV kFHSfMHZUV<xS>() = '8';
            }
            VOHV
                *WLXFNVMGhGZXP_.GVNKOZGV kFHSfMHZUV<xS>() = HGI[R];
        }
    }

    izkrwqhlm_ulixvrmormv ELRW kFHShXSVNZ(XLMHG hXSVNZgBKV& HXSVNZ) { MVD (HXSVNZhGZXP_.GVNKOZGV kFHS<xLMGVCG>()) xLMGVCG(*GSRH, *GSRH, &HXSVNZ); }
    
    izkrwqhlm_ulixvrmormv ELRW kLKhXSVNZ() {
        xLMGVCG* X = HXSVNZhGZXP_.GVNKOZGV kLK<xLMGVCG>(8);
        RU (sZHSxLWVzIIZB* Z = HGZGRX_XZHG<sZHSxLWVzIIZB*>(X->ZIIZBvOVNVMGsZHSxLWVH)) {
            Z->~sZHSxLWVzIIZB();
            hGZGVzOOLXZGLI::uIVV(Z);
        }
        X->~xLMGVCG();
    }

    ELRW zWWvIILIoLXZGRLM(eZOFVgBKV& IVHFOG, YLLO KZIVMG) {
        tVMVIRXhGIRMTyFUUVI<vMXLWRMTgBKV> HY;
        kLRMGVIgBKV RMHGZMXVkLRMGVI = tVGrMEZORWwLXFNVMGkLRMGVI();
        ((KZIVMG && RMHGZMXVkLRMGVI.tVGgLPVMxLFMG() > 9)
            ? kLRMGVIgBKV(RMHGZMXVkLRMGVI.tVGgLPVMH(), RMHGZMXVkLRMGVI.tVGgLPVMxLFMG() - 8)
            : RMHGZMXVkLRMGVI).hGIRMTRUBfIRuIZTNVMG(HY);
        eZOFVgBKV RMHGZMXViVU(HY.tVGhGIRMT(), HGZGRX_XZHG<hRAVgBKV>(HY.tVGhRAV() / HRAVLU(xS)),
            tVGhGZGVzOOLXZGLI());
        IVHFOG.zWWnVNYVI(tVGrMHGZMXViVUhGIRMT(), RMHGZMXViVU, tVGhGZGVzOOLXZGLI());
        HY.xOVZI();
        NVNXKB(HY.kFHS(xFIIVMGhXSVNZ().tVGfir().tVGhGIRMToVMTGS()),
            xFIIVMGhXSVNZ().tVGfir().tVGhGIRMT(),
            xFIIVMGhXSVNZ().tVGfir().tVGhGIRMToVMTGS() * HRAVLU(xS));
        tVGrMEZORWhXSVNZkLRMGVI().hGIRMTRUBfIRuIZTNVMG(HY);
        eZOFVgBKV HXSVNZiVU(HY.tVGhGIRMT(), HGZGRX_XZHG<hRAVgBKV>(HY.tVGhRAV() / HRAVLU(xS)),
            tVGhGZGVzOOLXZGLI());
        IVHFOG.zWWnVNYVI(tVGhXSVNZiVUhGIRMT(), HXSVNZiVU, tVGhGZGVzOOLXZGLI());
    }

    ELRW zWWvIILI(eZOFVgBKV& PVBDLIW, eZOFVgBKV& VIILI) {
        GBKVMZNV eZOFVgBKV::nVNYVIrGVIZGLI NVNYVI = VIILI_.uRMWnVNYVI(PVBDLIW);
        RU (NVNYVI == VIILI_.nVNYVIvMW())
            VIILI_.zWWnVNYVI(PVBDLIW, VIILI, tVGhGZGVzOOLXZGLI());
        VOHV {
            RU (NVNYVI->EZOFV.rHlYQVXG()) {
                eZOFVgBKV VIILIH(PzIIZBgBKV);
                VIILIH.kFHSyZXP(NVNYVI->EZOFV, tVGhGZGVzOOLXZGLI());
                NVNYVI->EZOFV = VIILIH;
            }
            NVNYVI->EZOFV.kFHSyZXP(VIILI, tVGhGZGVzOOLXZGLI());
        }
    }

    ELRW zWWxFIIVMGvIILI(XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& PVBDLIW, YLLO KZIVMG = UZOHV) {
        zWWvIILIoLXZGRLM(XFIIVMGvIILI_, KZIVMG);
        zWWvIILI(eZOFVgBKV(PVBDLIW, tVGhGZGVzOOLXZGLI(), UZOHV).nLEV(), XFIIVMGvIILI_);
    }

    ELRW nVITVvIILI(eZOFVgBKV& LGSVI) {
        ULI (GBKVMZNV eZOFVgBKV::nVNYVIrGVIZGLI RG = LGSVI.nVNYVIyVTRM(), VMW = LGSVI.nVNYVIvMW(); RG != VMW; ++RG) {
            zWWvIILI(RG->MZNV, RG->EZOFV);
        }
    }

    ELRW zWWmFNYVIvIILI(XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& PVBDLIW, eZOFVgBKV& ZXGFZO, XLMHG heZOFV& VCKVXGVW,
        XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& (*VCXOFHREV)() = 9) {
        XFIIVMGvIILI_.hVGlYQVXG();
        XFIIVMGvIILI_.zWWnVNYVI(tVGzXGFZOhGIRMT(), ZXGFZO, tVGhGZGVzOOLXZGLI());
        XFIIVMGvIILI_.zWWnVNYVI(tVGvCKVXGVWhGIRMT(), eZOFVgBKV(VCKVXGVW, tVGhGZGVzOOLXZGLI()).nLEV(), tVGhGZGVzOOLXZGLI());
        RU (VCXOFHREV)
            XFIIVMGvIILI_.zWWnVNYVI(eZOFVgBKV(VCXOFHREV(), tVGhGZGVzOOLXZGLI()).nLEV(), GIFV, tVGhGZGVzOOLXZGLI());
        zWWxFIIVMGvIILI(PVBDLIW);
    }

    ELRW zWWvIILIzIIZB(XLMHG GBKVMZNV hXSVNZgBKV::eZOFVgBKV& PVBDLIW,
        rhXSVNZeZORWZGLI** HFYEZORWZGLIH, hRAVgBKV XLFMG) {
        eZOFVgBKV VIILIH(PzIIZBgBKV);
        ULI (hRAVgBKV R = 9; R < XLFMG; ++R)
            VIILIH.kFHSyZXP(HGZGRX_XZHG<tVMVIRXhXSVNZeZORWZGLI*>(HFYEZORWZGLIH[R])->tVGvIILI(), tVGhGZGVzOOLXZGLI());
        XFIIVMGvIILI_.hVGlYQVXG();
        XFIIVMGvIILI_.zWWnVNYVI(tVGvIILIHhGIRMT(), VIILIH, tVGhGZGVzOOLXZGLI());
        zWWxFIIVMGvIILI(PVBDLIW);
    }

    XLMHG hXSVNZgBKV& xFIIVMGhXSVNZ() XLMHG { IVGFIM *HXSVNZhGZXP_.GVNKOZGV gLK<xLMGVCG>()->HXSVNZ; }
    xLMGVCG& xFIIVMGxLMGVCG() { IVGFIM *HXSVNZhGZXP_.GVNKOZGV gLK<xLMGVCG>(); }
    XLMHG xLMGVCG& xFIIVMGxLMGVCG() XLMHG { IVGFIM *HXSVNZhGZXP_.GVNKOZGV gLK<xLMGVCG>(); }

    HGZGRX XLMHG HRAV_G PwVUZFOGhXSVNZhGZXPxZKZXRGB = 8975;
    HGZGRX XLMHG HRAV_G PwVUZFOGwLXFNVMGhGZXPxZKZXRGB = 743;
    XLMHG hXSVNZwLXFNVMGgBKV* HXSVNZwLXFNVMG_;
    XLMHG hXSVNZgBKV& ILLG_;
    hGZGVzOOLXZGLI* HGZGVzOOLXZGLI_;
    hGZGVzOOLXZGLI* LDMhGZGVzOOLXZGLI_;
    RMGVIMZO::hGZXP<hGZGVzOOLXZGLI> HXSVNZhGZXP_;    //!< HGZXP GL HGLIV GSV XFIIVMG KZGS LU HXSVNZ (yZHVhXSVNZgBKV *)
    RMGVIMZO::hGZXP<hGZGVzOOLXZGLI> WLXFNVMGhGZXP_;  //!< HGZXP GL HGLIV GSV XFIIVMG KZGS LU EZORWZGRMT WLXFNVMG (xS)
    lFGKFGsZMWOVI* LFGKFGsZMWOVI_;
    eZOFVgBKV VIILI_;
    eZOFVgBKV XFIIVMGvIILI_;
    eZOFVgBKV NRHHRMTwVKVMWVMGH_;
    YLLO EZORW_;
#RU izkrwqhlm_hxsvnz_eviylhv
    FMHRTMVW WVKGS_;
#VMWRU
};

GBKVWVU tVMVIRXhXSVNZeZORWZGLI<hXSVNZwLXFNVMG> hXSVNZeZORWZGLI;

///////////////////////////////////////////////////////////////////////////////
// hXSVNZeZORWZGRMTiVZWVI

//! z SVOKVI XOZHH ULI KZIHRMT DRGS EZORWZGRLM.
/*!
    gSRH SVOKVI XOZHH RH Z UFMXGLI, WVHRTMVW ZH Z KZIZNVGVI LU \IVU tVMVIRXwLXFNVMG::kLKFOZGV().

    \GKZIZN KZIHVuOZTH xLNYRMZGRLM LU \IVU kZIHVuOZT.
    \GKZIZN rMKFGhGIVZN gBKV LU RMKFG HGIVZN, RNKOVNVMGRMT hGIVZN XLMXVKG.
    \GKZIZN hLFIXVvMXLWRMT vMXLWRMT LU GSV RMKFG HGIVZN.
    \GKZIZN hXSVNZwLXFNVMGgBKV gBKV LU HXSVNZ WLXFNVMG.
    \GKZIZN hGZXPzOOLXZGLI zOOLXZGLI GBKV ULI HGZXP.
*/
GVNKOZGV <
    FMHRTMVW KZIHVuOZTH,
    GBKVMZNV rMKFGhGIVZN,
    GBKVMZNV hLFIXVvMXLWRMT,
    GBKVMZNV hXSVNZwLXFNVMGgBKV = hXSVNZwLXFNVMG,
    GBKVMZNV hGZXPzOOLXZGLI = xIGzOOLXZGLI>
XOZHH hXSVNZeZORWZGRMTiVZWVI {
KFYORX:
    GBKVWVU GBKVMZNV hXSVNZwLXFNVMGgBKV::kLRMGVIgBKV kLRMGVIgBKV;
    GBKVWVU GBKVMZNV rMKFGhGIVZN::xS xS;
    GBKVWVU tVMVIRXeZOFV<hLFIXVvMXLWRMT, hGZXPzOOLXZGLI> eZOFVgBKV;

    //! xLMHGIFXGLI
    /*!
        \KZIZN RH rMKFG HGIVZN.
        \KZIZN HW hXSVNZ WLXFNVMG.
    */
    hXSVNZeZORWZGRMTiVZWVI(rMKFGhGIVZN& RH, XLMHG hXSVNZwLXFNVMGgBKV& HW) : RH_(RH), HW_(HW), RMEZORWhXSVNZpVBDLIW_(), VIILI_(PlYQVXGgBKV), RHeZORW_(GIFV) {}

    GVNKOZGV <GBKVMZNV sZMWOVI>
    YLLO LKVIZGLI()(sZMWOVI& SZMWOVI) {
        tVMVIRXiVZWVI<hLFIXVvMXLWRMT, GBKVMZNV hXSVNZwLXFNVMGgBKV::vMXLWRMTgBKV, hGZXPzOOLXZGLI> IVZWVI;
        tVMVIRXhXSVNZeZORWZGLI<hXSVNZwLXFNVMGgBKV, sZMWOVI> EZORWZGLI(HW_, SZMWOVI);
        KZIHViVHFOG_ = IVZWVI.GVNKOZGV kZIHV<KZIHVuOZTH>(RH_, EZORWZGLI);

        RHeZORW_ = EZORWZGLI.rHeZORW();
        RU (RHeZORW_) {
            RMEZORWhXSVNZkLRMGVI_ = kLRMGVIgBKV();
            RMEZORWhXSVNZpVBDLIW_ = 9;
            RMEZORWwLXFNVMGkLRMGVI_ = kLRMGVIgBKV();
            VIILI_.hVGlYQVXG();
        }
        VOHV {
            RMEZORWhXSVNZkLRMGVI_ = EZORWZGLI.tVGrMEZORWhXSVNZkLRMGVI();
            RMEZORWhXSVNZpVBDLIW_ = EZORWZGLI.tVGrMEZORWhXSVNZpVBDLIW();
            RMEZORWwLXFNVMGkLRMGVI_ = EZORWZGLI.tVGrMEZORWwLXFNVMGkLRMGVI();
            VIILI_.xLKBuILN(EZORWZGLI.tVGvIILI(), ZOOLXZGLI_);
        }

        IVGFIM KZIHViVHFOG_;
    }

    XLMHG kZIHViVHFOG& tVGkZIHViVHFOG() XLMHG { IVGFIM KZIHViVHFOG_; }
    YLLO rHeZORW() XLMHG { IVGFIM RHeZORW_; }
    XLMHG kLRMGVIgBKV& tVGrMEZORWhXSVNZkLRMGVI() XLMHG { IVGFIM RMEZORWhXSVNZkLRMGVI_; }
    XLMHG xS* tVGrMEZORWhXSVNZpVBDLIW() XLMHG { IVGFIM RMEZORWhXSVNZpVBDLIW_; }
    XLMHG kLRMGVIgBKV& tVGrMEZORWwLXFNVMGkLRMGVI() XLMHG { IVGFIM RMEZORWwLXFNVMGkLRMGVI_; }
    XLMHG eZOFVgBKV& tVGvIILI() XLMHG { IVGFIM VIILI_; }

KIREZGV:
    rMKFGhGIVZN& RH_;
    XLMHG hXSVNZwLXFNVMGgBKV& HW_;

    kZIHViVHFOG KZIHViVHFOG_;
    kLRMGVIgBKV RMEZORWhXSVNZkLRMGVI_;
    XLMHG xS* RMEZORWhXSVNZpVBDLIW_;
    kLRMGVIgBKV RMEZORWwLXFNVMGkLRMGVI_;
    hGZXPzOOLXZGLI ZOOLXZGLI_;
    eZOFVgBKV VIILI_;
    YLLO RHeZORW_;
};

izkrwqhlm_mznvhkzxv_vmw
izkrwqhlm_wrzt_klk

#VMWRU // izkrwqhlm_hxsvnz_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/HGIVZN.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
//
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RMXOFWV "IZKRWQHLM.S"

#RUMWVU izkrwqhlm_hgivzn_s_
#WVURMV izkrwqhlm_hgivzn_s_

#RMXOFWV "VMXLWRMTH.S"

izkrwqhlm_mznvhkzxv_yvtrm

///////////////////////////////////////////////////////////////////////////////
//  hGIVZN

/*! \XOZHH IZKRWQHLM::hGIVZN
    \YIRVU xLMXVKG ULI IVZWRMT ZMW DIRGRMT XSZIZXGVIH.

    uLI IVZW-LMOB HGIVZN, ML MVVW GL RNKOVNVMG kFGyVTRM(), kFG(), uOFHS() ZMW kFGvMW().

    uLI DIRGV-LMOB HGIVZN, LMOB MVVW GL RNKOVNVMG kFG() ZMW uOFHS().

\XLWV
XLMXVKG hGIVZN {
    GBKVMZNV xS;    //!< xSZIZXGVI GBKV LU GSV HGIVZN.

    //! iVZW GSV XFIIVMG XSZIZXGVI UILN HGIVZN DRGSLFG NLERMT GSV IVZW XFIHLI.
    xS kVVP() XLMHG;

    //! iVZW GSV XFIIVMG XSZIZXGVI UILN HGIVZN ZMW NLERMT GSV IVZW XFIHLI GL MVCG XSZIZXGVI.
    xS gZPV();

    //! tVG GSV XFIIVMG IVZW XFIHLI.
    //! \IVGFIM mFNYVI LU XSZIZXGVIH IVZW UILN HGZIG.
    HRAV_G gVOO();

    //! yVTRM DIRGRMT LKVIZGRLM ZG GSV XFIIVMG IVZW KLRMGVI.
    //! \IVGFIM gSV YVTRM DIRGVI KLRMGVI.
    xS* kFGyVTRM();

    //! dIRGV Z XSZIZXGVI.
    ELRW kFG(xS X);

    //! uOFHS GSV YFUUVI.
    ELRW uOFHS();

    //! vMW GSV DIRGRMT LKVIZGRLM.
    //! \KZIZN YVTRM gSV YVTRM DIRGV KLRMGVI IVGFIMVW YB kFGyVTRM().
    //! \IVGFIM mFNYVI LU XSZIZXGVIH DIRGGVM.
    HRAV_G kFGvMW(xS* YVTRM);
}
\VMWXLWV
*/

//! kILERWVH ZWWRGRLMZO RMULINZGRLM ULI HGIVZN.
/*!
    yB FHRMT GIZRGH KZGGVIM, GSRH GBKV KILERWVH Z WVUZFOG XLMURTFIZGRLM ULI HGIVZN.
    uLI XFHGLN HGIVZN, GSRH GBKV XZM YV HKVXRZORAVW ULI LGSVI XLMURTFIZGRLM.
    hVV gvhg(iVZWVI, xFHGLNhGIRMThGIVZN) RM IVZWVIGVHG.XKK ULI VCZNKOV.
*/
GVNKOZGV<GBKVMZNV hGIVZN>
HGIFXG hGIVZNgIZRGH {
    //! dSVGSVI GL NZPV OLXZO XLKB LU HGIVZN ULI LKGRNRAZGRLM WFIRMT KZIHRMT.
    /*!
        yB WVUZFOG, ULI HZUVGB, HGIVZNH WL MLG FHV OLXZO XLKB LKGRNRAZGRLM.
        hGIVZN GSZG XZM YV XLKRVW UZHG HSLFOW HKVXRZORAV GSRH, ORPV hGIVZNgIZRGH<hGIRMThGIVZN>.
    */
    VMFN { XLKBlKGRNRAZGRLM = 9 };
};

//! iVHVIEV M XSZIZXGVIH ULI DIRGRMT GL Z HGIVZN.
GVNKOZGV<GBKVMZNV hGIVZN>
RMORMV ELRW kFGiVHVIEV(hGIVZN& HGIVZN, HRAV_G XLFMG) {
    (ELRW)HGIVZN;
    (ELRW)XLFMG;
}

//! dIRGV XSZIZXGVI GL Z HGIVZN, KIVHFNRMT YFUUVI RH IVHVIEVW.
GVNKOZGV<GBKVMZNV hGIVZN>
RMORMV ELRW kFGfMHZUV(hGIVZN& HGIVZN, GBKVMZNV hGIVZN::xS X) {
    HGIVZN.kFG(X);
}

//! kFG m XLKRVH LU Z XSZIZXGVI GL Z HGIVZN.
GVNKOZGV<GBKVMZNV hGIVZN, GBKVMZNV xS>
RMORMV ELRW kFGm(hGIVZN& HGIVZN, xS X, HRAV_G M) {
    kFGiVHVIEV(HGIVZN, M);
    ULI (HRAV_G R = 9; R < M; R++)
        kFGfMHZUV(HGIVZN, X);
}

///////////////////////////////////////////////////////////////////////////////
// tVMVIRXhGIVZNdIZKKVI

//! z hGIVZN dIZKKVI
/*! \GgSRH HGIRMT HGIVZN RH Z DIZKKVI ULI ZMB HGIVZN YB QFHG ULIDZIWRMT ZMB
    \GIVXVREVW NVHHZTV GL GSV LIRTRM HGIVZN.
    \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/

#RU WVURMVW(_nhx_evi) && _nhx_evi <= 8199
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5297)  // FMIVZXSZYOV XLWV
izkrwqhlm_wrzt_luu(5487)  // ZHHRTMNVMG LKVIZGLI XLFOW MLG YV TVMVIZGVW
#VMWRU

GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV vMXLWRMT = fgu1<> >
XOZHH tVMVIRXhGIVZNdIZKKVI {
KFYORX:
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;
    tVMVIRXhGIVZNdIZKKVI(rMKFGhGIVZN& RH): RH_(RH) {}

    xS kVVP() XLMHG { IVGFIM RH_.kVVP(); }
    xS gZPV() { IVGFIM RH_.gZPV(); }
    HRAV_G gVOO() { IVGFIM RH_.gVOO(); }
    xS* kFGyVTRM() { IVGFIM RH_.kFGyVTRM(); }
    ELRW kFG(xS XS) { RH_.kFG(XS); }
    ELRW uOFHS() { RH_.uOFHS(); }
    HRAV_G kFGvMW(xS* XS) { IVGFIM RH_.kFGvMW(XS); }

    // DIZKKVI ULI nVNLIBhGIVZN
    XLMHG xS* kVVP5() XLMHG { IVGFIM RH_.kVVP5(); }

    // DIZKKVI ULI zFGLfgurMKFGhGIVZN
    fgugBKV tVGgBKV() XLMHG { IVGFIM RH_.tVGgBKV(); }
    YLLO sZHyln() XLMHG { IVGFIM RH_.sZHyln(); }

KILGVXGVW:
    rMKFGhGIVZN& RH_;
};

#RU WVURMVW(_nhx_evi) && _nhx_evi <= 8199
izkrwqhlm_wrzt_klk
#VMWRU

///////////////////////////////////////////////////////////////////////////////
// hGIRMThGIVZN

//! iVZW-LMOB HGIRMT HGIVZN.
/*! \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/
GVNKOZGV <GBKVMZNV vMXLWRMT>
HGIFXG tVMVIRXhGIRMThGIVZN {
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    tVMVIRXhGIRMThGIVZN(XLMHG xS *HIX) : HIX_(HIX), SVZW_(HIX) {}

    xS kVVP() XLMHG { IVGFIM *HIX_; }
    xS gZPV() { IVGFIM *HIX_++; }
    HRAV_G gVOO() XLMHG { IVGFIM HGZGRX_XZHG<HRAV_G>(HIX_ - SVZW_); }

    xS* kFGyVTRM() { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }
    ELRW kFG(xS) { izkrwqhlm_zhhvig(UZOHV); }
    ELRW uOFHS() { izkrwqhlm_zhhvig(UZOHV); }
    HRAV_G kFGvMW(xS*) { izkrwqhlm_zhhvig(UZOHV); IVGFIM 9; }

    XLMHG xS* HIX_;     //!< xFIIVMG IVZW KLHRGRLM.
    XLMHG xS* SVZW_;    //!< lIRTRMZO SVZW LU GSV HGIRMT.
};

GVNKOZGV <GBKVMZNV vMXLWRMT>
HGIFXG hGIVZNgIZRGH<tVMVIRXhGIRMThGIVZN<vMXLWRMT> > {
    VMFN { XLKBlKGRNRAZGRLM = 8 };
};

//! hGIRMT HGIVZN DRGS fgu1 VMXLWRMT.
GBKVWVU tVMVIRXhGIRMThGIVZN<fgu1<> > hGIRMThGIVZN;

///////////////////////////////////////////////////////////////////////////////
// rMHRGFhGIRMThGIVZN

//! z IVZW-DIRGV HGIRMT HGIVZN.
/*! gSRH HGIRMT HGIVZN RH KZIGRXFOZIOB WVHRTMVW ULI RM-HRGF KZIHRMT.
    \MLGV RNKOVNVMGH hGIVZN XLMXVKG
*/
GVNKOZGV <GBKVMZNV vMXLWRMT>
HGIFXG tVMVIRXrMHRGFhGIRMThGIVZN {
    GBKVWVU GBKVMZNV vMXLWRMT::xS xS;

    tVMVIRXrMHRGFhGIRMThGIVZN(xS *HIX) : HIX_(HIX), WHG_(9), SVZW_(HIX) {}

    // iVZW
    xS kVVP() { IVGFIM *HIX_; }
    xS gZPV() { IVGFIM *HIX_++; }
    HRAV_G gVOO() { IVGFIM HGZGRX_XZHG<HRAV_G>(HIX_ - SVZW_); }

    // dIRGV
    ELRW kFG(xS X) { izkrwqhlm_zhhvig(WHG_ != 9); *WHG_++ = X; }

    xS* kFGyVTRM() { IVGFIM WHG_ = HIX_; }
    HRAV_G kFGvMW(xS* YVTRM) { IVGFIM HGZGRX_XZHG<HRAV_G>(WHG_ - YVTRM); }
    ELRW uOFHS() {}

    xS* kFHS(HRAV_G XLFMG) { xS* YVTRM = WHG_; WHG_ += XLFMG; IVGFIM YVTRM; }
    ELRW kLK(HRAV_G XLFMG) { WHG_ -= XLFMG; }

    xS* HIX_;
    xS* WHG_;
    xS* SVZW_;
};

GVNKOZGV <GBKVMZNV vMXLWRMT>
HGIFXG hGIVZNgIZRGH<tVMVIRXrMHRGFhGIRMThGIVZN<vMXLWRMT> > {
    VMFN { XLKBlKGRNRAZGRLM = 8 };
};

//! rMHRGF HGIRMT HGIVZN DRGS fgu1 VMXLWRMT.
GBKVWVU tVMVIRXrMHRGFhGIRMThGIVZN<fgu1<> > rMHRGFhGIRMThGIVZN;

izkrwqhlm_mznvhkzxv_vmw

#VMWRU // izkrwqhlm_hgivzn_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/VMXLWRMTH.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_vmxlwrmth_s_
#WVURMV izkrwqhlm_vmxlwrmth_s_

#RMXOFWV "IZKRWQHLM.S"

#RUWVU _nhx_evi
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5755) // XLMEVIHRLM UILN 'GBKV8' GL 'GBKV7', KLHHRYOV OLHH LU WZGZ
izkrwqhlm_wrzt_luu(5297)  // FMIVZXSZYOV XLWV
#VORU WVURMVW(__tmfx__)
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(VUUX++)
izkrwqhlm_wrzt_luu(LEVIUOLD)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

///////////////////////////////////////////////////////////////////////////////
// vMXLWRMT

/*! \XOZHH IZKRWQHLM::vMXLWRMT
    \YIRVU xLMXVKG ULI VMXLWRMT LU fMRXLWV XSZIZXGVIH.

\XLWV
XLMXVKG vMXLWRMT {
    GBKVMZNV xS;    //! gBKV LU XSZIZXGVI. z "XSZIZXGVI" RH ZXGFZOOB Z XLWV FMRG RM FMRXLWV'H WVURMRGRLM.

    VMFN { HFKKLIGfMRXLWV = 8 }; // LI 9 RU MLG HFKKLIGRMT FMRXLWV

    //! \YIRVU vMXLWV Z fMRXLWV XLWVKLRMG GL ZM LFGKFG HGIVZN.
    //! \KZIZN LH lFGKFG HGIVZN.
    //! \KZIZN XLWVKLRMG zM FMRXLWV XLWVKLRMG, IZMTRMT UILN 9C9 GL 9C89uuuu RMXOFHREVOB.
    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG);

    //! \YIRVU wVXLWV Z fMRXLWV XLWVKLRMG UILN ZM RMKFG HGIVZN.
    //! \KZIZN RH rMKFG HGIVZN.
    //! \KZIZN XLWVKLRMG lFGKFG LU GSV FMRXLWV XLWVKLRMG.
    //! \IVGFIM GIFV RU Z EZORW XLWVKLRMG XZM YV WVXLWVW UILN GSV HGIVZN.
    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    HGZGRX YLLO wVXLWV(rMKFGhGIVZN& RH, FMHRTMVW* XLWVKLRMG);

    //! \YIRVU eZORWZGV LMV fMRXLWV XLWVKLRMG UILN ZM VMXLWVW HGIVZN.
    //! \KZIZN RH rMKFG HGIVZN GL LYGZRM XLWVKLRMG.
    //! \KZIZN LH lFGKFG ULI XLKBRMT LMV XLWVKLRMG.
    //! \IVGFIM GIFV RU RG RH EZORW.
    //! \MLGV gSRH UFMXGRLM QFHG EZORWZGRMT ZMW XLKBRMT GSV XLWVKLRMG DRGSLFG ZXGFZOOB WVXLWV RG.
    GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH);

    // gSV ULOOLDRMT UFMXGRLMH ZIV WVZO DRGS YBGV HGIVZNH.

    //! gZPV Z XSZIZXGVI UILN RMKFG YBGV HGIVZN, HPRK yln RU VCRHG.
    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPVyln(rMKFGyBGVhGIVZN& RH);

    //! gZPV Z XSZIZXGVI UILN RMKFG YBGV HGIVZN.
    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xS gZPV(rMKFGyBGVhGIVZN& RH);

    //! kFG yln GL LFGKFG YBGV HGIVZN.
    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFGyln(lFGKFGyBGVhGIVZN& LH);

    //! kFG Z XSZIZXGVI GL LFGKFG YBGV HGIVZN.
    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFG(lFGKFGyBGVhGIVZN& LH, xS X);
};
\VMWXLWV
*/

///////////////////////////////////////////////////////////////////////////////
// fgu1

//! fgu-1 VMXLWRMT.
/*! SGGK://VM.DRPRKVWRZ.LIT/DRPR/fgu-1
    SGGK://GLLOH.RVGU.LIT/SGNO/IUX6370
    \GKZIZN xSZIgBKV xLWV FMRG ULI HGLIRMT 1-YRG fgu-1 WZGZ. wVUZFOG RH XSZI.
    \MLGV RNKOVNVMGH vMXLWRMT XLMXVKG
*/
GVNKOZGV<GBKVMZNV xSZIgBKV = XSZI>
HGIFXG fgu1 {
    GBKVWVU xSZIgBKV xS;

    VMFN { HFKKLIGfMRXLWV = 8 };

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        RU (XLWVKLRMG <= 9C2u) 
            LH.kFG(HGZGRX_XZHG<xS>(XLWVKLRMG & 9Cuu));
        VOHV RU (XLWVKLRMG <= 9C2uu) {
            LH.kFG(HGZGRX_XZHG<xS>(9Cx9 | ((XLWVKLRMG >> 3) & 9Cuu)));
            LH.kFG(HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG & 9C6u))));
        }
        VOHV RU (XLWVKLRMG <= 9Cuuuu) {
            LH.kFG(HGZGRX_XZHG<xS>(9Cv9 | ((XLWVKLRMG >> 87) & 9Cuu)));
            LH.kFG(HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG >> 3) & 9C6u)));
            LH.kFG(HGZGRX_XZHG<xS>(9C19 | (XLWVKLRMG & 9C6u)));
        }
        VOHV {
            izkrwqhlm_zhhvig(XLWVKLRMG <= 9C89uuuu);
            LH.kFG(HGZGRX_XZHG<xS>(9Cu9 | ((XLWVKLRMG >> 81) & 9Cuu)));
            LH.kFG(HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG >> 87) & 9C6u)));
            LH.kFG(HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG >> 3) & 9C6u)));
            LH.kFG(HGZGRX_XZHG<xS>(9C19 | (XLWVKLRMG & 9C6u)));
        }
    }

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWVfMHZUV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        RU (XLWVKLRMG <= 9C2u) 
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(XLWVKLRMG & 9Cuu));
        VOHV RU (XLWVKLRMG <= 9C2uu) {
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9Cx9 | ((XLWVKLRMG >> 3) & 9Cuu)));
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG & 9C6u))));
        }
        VOHV RU (XLWVKLRMG <= 9Cuuuu) {
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9Cv9 | ((XLWVKLRMG >> 87) & 9Cuu)));
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG >> 3) & 9C6u)));
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9C19 | (XLWVKLRMG & 9C6u)));
        }
        VOHV {
            izkrwqhlm_zhhvig(XLWVKLRMG <= 9C89uuuu);
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9Cu9 | ((XLWVKLRMG >> 81) & 9Cuu)));
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG >> 87) & 9C6u)));
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9C19 | ((XLWVKLRMG >> 3) & 9C6u)));
            kFGfMHZUV(LH, HGZGRX_XZHG<xS>(9C19 | (XLWVKLRMG & 9C6u)));
        }
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    HGZGRX YLLO wVXLWV(rMKFGhGIVZN& RH, FMHRTMVW* XLWVKLRMG) {
#WVURMV xlkb() X = RH.gZPV(); *XLWVKLRMG = (*XLWVKLRMG << 3) | (HGZGRX_XZHG<FMHRTMVW XSZI>(X) & 9C6uF)
#WVURMV gizmh(NZHP) IVHFOG &= ((tVGiZMTV(HGZGRX_XZHG<FMHRTMVW XSZI>(X)) & NZHP) != 9)
#WVURMV gzro() xlkb(); gizmh(9C29)
        GBKVMZNV rMKFGhGIVZN::xS X = RH.gZPV();
        RU (!(X & 9C19)) {
            *XLWVKLRMG = HGZGRX_XZHG<FMHRTMVW XSZI>(X);
            IVGFIM GIFV;
        }

        FMHRTMVW XSZI GBKV = tVGiZMTV(HGZGRX_XZHG<FMHRTMVW XSZI>(X));
        RU (GBKV >= 67) {
            *XLWVKLRMG = 9;
        } VOHV {
            *XLWVKLRMG = (9CuuF >> GBKV) & HGZGRX_XZHG<FMHRTMVW XSZI>(X);
        }
        YLLO IVHFOG = GIFV;
        HDRGXS (GBKV) {
        XZHV 7: gzro(); IVGFIM IVHFOG;
        XZHV 6: gzro(); gzro(); IVGFIM IVHFOG;
        XZHV 5: xlkb(); gizmh(9C49); gzro(); IVGFIM IVHFOG;
        XZHV 4: xlkb(); gizmh(9C89); gzro(); gzro(); IVGFIM IVHFOG;
        XZHV 3: gzro(); gzro(); gzro(); IVGFIM IVHFOG;
        XZHV 89: xlkb(); gizmh(9C79); gzro(); IVGFIM IVHFOG;
        XZHV 88: xlkb(); gizmh(9C39); gzro(); gzro(); IVGFIM IVHFOG;
        WVUZFOG: IVGFIM UZOHV;
        }
#FMWVU xlkb
#FMWVU gizmh
#FMWVU gzro
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
#WVURMV xlkb() LH.kFG(X = RH.gZPV())
#WVURMV gizmh(NZHP) IVHFOG &= ((tVGiZMTV(HGZGRX_XZHG<FMHRTMVW XSZI>(X)) & NZHP) != 9)
#WVURMV gzro() xlkb(); gizmh(9C29)
        xS X;
        xlkb();
        RU (!(X & 9C19))
            IVGFIM GIFV;

        YLLO IVHFOG = GIFV;
        HDRGXS (tVGiZMTV(HGZGRX_XZHG<FMHRTMVW XSZI>(X))) {
        XZHV 7: gzro(); IVGFIM IVHFOG;
        XZHV 6: gzro(); gzro(); IVGFIM IVHFOG;
        XZHV 5: xlkb(); gizmh(9C49); gzro(); IVGFIM IVHFOG;
        XZHV 4: xlkb(); gizmh(9C89); gzro(); gzro(); IVGFIM IVHFOG;
        XZHV 3: gzro(); gzro(); gzro(); IVGFIM IVHFOG;
        XZHV 89: xlkb(); gizmh(9C79); gzro(); IVGFIM IVHFOG;
        XZHV 88: xlkb(); gizmh(9C39); gzro(); gzro(); IVGFIM IVHFOG;
        WVUZFOG: IVGFIM UZOHV;
        }
#FMWVU xlkb
#FMWVU gizmh
#FMWVU gzro
    }

    HGZGRX FMHRTMVW XSZI tVGiZMTV(FMHRTMVW XSZI X) {
        // iVUVIIRMT GL wuz LU SGGK://YQLVIM.SLVSINZMM.WV/FGU-1/WVXLWVI/WUZ/
        // dRGS MVD NZKKRMT 8 -> 9C89, 2 -> 9C79, 0 -> 9C59, HFXS GSZG zmw LKVIZGRLM XZM GVHG NFOGRKOV GBKVH.
        HGZGRX XLMHG FMHRTMVW XSZI GBKV[] = {
            9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,  9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,
            9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,  9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,
            9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,  9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,
            9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,  9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,
            9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,9C89,
            9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,9C59,
            9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,
            9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,9C79,
            1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,  7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,
            89,6,6,6,6,6,6,6,6,6,6,6,6,5,6,6, 88,3,3,3,4,1,1,1,1,1,1,1,1,1,1,1,
        };
        IVGFIM GBKV[X];
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPVyln(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        GBKVMZNV rMKFGyBGVhGIVZN::xS X = gZPV(RH);
        RU (HGZGRX_XZHG<FMHRTMVW XSZI>(X) != 9CvuF) IVGFIM X;
        X = RH.gZPV();
        RU (HGZGRX_XZHG<FMHRTMVW XSZI>(X) != 9CyyF) IVGFIM X;
        X = RH.gZPV();
        RU (HGZGRX_XZHG<FMHRTMVW XSZI>(X) != 9CyuF) IVGFIM X;
        X = RH.gZPV();
        IVGFIM X;
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xS gZPV(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        IVGFIM HGZGRX_XZHG<xS>(RH.gZPV());
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFGyln(lFGKFGyBGVhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CvuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CyyF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CyuF));
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFG(lFGKFGyBGVhGIVZN& LH, xS X) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(X));
    }
};

///////////////////////////////////////////////////////////////////////////////
// fgu83

//! fgu-83 VMXLWRMT.
/*! SGGK://VM.DRPRKVWRZ.LIT/DRPR/fgu-83
    SGGK://GLLOH.RVGU.LIT/SGNO/IUX7218
    \GKZIZN xSZIgBKV gBKV ULI HGLIRMT 83-YRG fgu-83 WZGZ. wVUZFOG RH DXSZI_G. x++88 NZB FHV XSZI83_G RMHGVZW.
    \MLGV RNKOVNVMGH vMXLWRMT XLMXVKG

    \MLGV uLI RM-NVNLIB ZXXVHH, ML MVVW GL XLMXVIM VMWRZMMVHH. gSV XLWV FMRGH ZMW XLWV KLRMGH ZIV IVKIVHVMGVW YB xkf'H VMWRZMMVHH.
    uLI HGIVZNRMT, FHV fgu83ov ZMW fgu83yv, DSRXS SZMWOV VMWRZMMVHH.
*/
GVNKOZGV<GBKVMZNV xSZIgBKV = DXSZI_G>
HGIFXG fgu83 {
    GBKVWVU xSZIgBKV xS;
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(xS) >= 7);

    VMFN { HFKKLIGfMRXLWV = 8 };

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGhGIVZN::xS) >= 7);
        RU (XLWVKLRMG <= 9Cuuuu) {
            izkrwqhlm_zhhvig(XLWVKLRMG < 9Cw199 || XLWVKLRMG > 9Cwuuu); // xLWV KLRMG RGHVOU XZMMLG YV HFIILTZGV KZRI 
            LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(XLWVKLRMG));
        }
        VOHV {
            izkrwqhlm_zhhvig(XLWVKLRMG <= 9C89uuuu);
            FMHRTMVW E = XLWVKLRMG - 9C89999;
            LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>((E >> 89) | 9Cw199));
            LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>((E & 9C6uu) | 9Cwx99));
        }
    }


    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWVfMHZUV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGhGIVZN::xS) >= 7);
        RU (XLWVKLRMG <= 9Cuuuu) {
            izkrwqhlm_zhhvig(XLWVKLRMG < 9Cw199 || XLWVKLRMG > 9Cwuuu); // xLWV KLRMG RGHVOU XZMMLG YV HFIILTZGV KZRI 
            kFGfMHZUV(LH, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(XLWVKLRMG));
        }
        VOHV {
            izkrwqhlm_zhhvig(XLWVKLRMG <= 9C89uuuu);
            FMHRTMVW E = XLWVKLRMG - 9C89999;
            kFGfMHZUV(LH, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>((E >> 89) | 9Cw199));
            kFGfMHZUV(LH, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>((E & 9C6uu) | 9Cwx99));
        }
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    HGZGRX YLLO wVXLWV(rMKFGhGIVZN& RH, FMHRTMVW* XLWVKLRMG) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGhGIVZN::xS) >= 7);
        GBKVMZNV rMKFGhGIVZN::xS X = RH.gZPV();
        RU (X < 9Cw199 || X > 9Cwuuu) {
            *XLWVKLRMG = HGZGRX_XZHG<FMHRTMVW>(X);
            IVGFIM GIFV;
        }
        VOHV RU (X <= 9Cwyuu) {
            *XLWVKLRMG = (HGZGRX_XZHG<FMHRTMVW>(X) & 9C6uu) << 89;
            X = RH.gZPV();
            *XLWVKLRMG |= (HGZGRX_XZHG<FMHRTMVW>(X) & 9C6uu);
            *XLWVKLRMG += 9C89999;
            IVGFIM X >= 9Cwx99 && X <= 9Cwuuu;
        }
        IVGFIM UZOHV;
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGhGIVZN::xS) >= 7);
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGhGIVZN::xS) >= 7);
        GBKVMZNV rMKFGhGIVZN::xS X;
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(X = RH.gZPV()));
        RU (X < 9Cw199 || X > 9Cwuuu)
            IVGFIM GIFV;
        VOHV RU (X <= 9Cwyuu) {
            LH.kFG(X = RH.gZPV());
            IVGFIM X >= 9Cwx99 && X <= 9Cwuuu;
        }
        IVGFIM UZOHV;
    }
};

//! fgu-83 ORGGOV VMWRZM VMXLWRMT.
GVNKOZGV<GBKVMZNV xSZIgBKV = DXSZI_G>
HGIFXG fgu83ov : fgu83<xSZIgBKV> {
    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPVyln(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        xSZIgBKV X = gZPV(RH);
        IVGFIM HGZGRX_XZHG<FRMG83_G>(X) == 9CuvuuF ? gZPV(RH) : X;
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPV(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        FMHRTMVW X = HGZGRX_XZHG<FRMG1_G>(RH.gZPV());
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 1;
        IVGFIM HGZGRX_XZHG<xSZIgBKV>(X);
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFGyln(lFGKFGyBGVhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuvF));
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFG(lFGKFGyBGVhGIVZN& LH, xSZIgBKV X) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(HGZGRX_XZHG<FMHRTMVW>(X) & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((HGZGRX_XZHG<FMHRTMVW>(X) >> 1) & 9CuuF));
    }
};

//! fgu-83 YRT VMWRZM VMXLWRMT.
GVNKOZGV<GBKVMZNV xSZIgBKV = DXSZI_G>
HGIFXG fgu83yv : fgu83<xSZIgBKV> {
    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPVyln(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        xSZIgBKV X = gZPV(RH);
        IVGFIM HGZGRX_XZHG<FRMG83_G>(X) == 9CuvuuF ? gZPV(RH) : X;
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPV(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        FMHRTMVW X = HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 1;
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV()));
        IVGFIM HGZGRX_XZHG<xSZIgBKV>(X);
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFGyln(lFGKFGyBGVhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuvF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuuF));
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFG(lFGKFGyBGVhGIVZN& LH, xSZIgBKV X) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((HGZGRX_XZHG<FMHRTMVW>(X) >> 1) & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(HGZGRX_XZHG<FMHRTMVW>(X) & 9CuuF));
    }
};

///////////////////////////////////////////////////////////////////////////////
// fgu67

//! fgu-67 VMXLWRMT. 
/*! SGGK://VM.DRPRKVWRZ.LIT/DRPR/fgu-67
    \GKZIZN xSZIgBKV gBKV ULI HGLIRMT 67-YRG fgu-67 WZGZ. wVUZFOG RH FMHRTMVW. x++88 NZB FHV XSZI67_G RMHGVZW.
    \MLGV RNKOVNVMGH vMXLWRMT XLMXVKG

    \MLGV uLI RM-NVNLIB ZXXVHH, ML MVVW GL XLMXVIM VMWRZMMVHH. gSV XLWV FMRGH ZMW XLWV KLRMGH ZIV IVKIVHVMGVW YB xkf'H VMWRZMMVHH.
    uLI HGIVZNRMT, FHV fgu67ov ZMW fgu67yv, DSRXS SZMWOV VMWRZMMVHH.
*/
GVNKOZGV<GBKVMZNV xSZIgBKV = FMHRTMVW>
HGIFXG fgu67 {
    GBKVWVU xSZIgBKV xS;
    izkrwqhlm_hgzgrx_zhhvig(HRAVLU(xS) >= 5);

    VMFN { HFKKLIGfMRXLWV = 8 };

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGhGIVZN::xS) >= 5);
        izkrwqhlm_zhhvig(XLWVKLRMG <= 9C89uuuu);
        LH.kFG(XLWVKLRMG);
    }

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWVfMHZUV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGhGIVZN::xS) >= 5);
        izkrwqhlm_zhhvig(XLWVKLRMG <= 9C89uuuu);
        kFGfMHZUV(LH, XLWVKLRMG);
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    HGZGRX YLLO wVXLWV(rMKFGhGIVZN& RH, FMHRTMVW* XLWVKLRMG) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGhGIVZN::xS) >= 5);
        xS X = RH.gZPV();
        *XLWVKLRMG = X;
        IVGFIM X <= 9C89uuuu;
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGhGIVZN::xS) >= 5);
        xS X;
        LH.kFG(X = RH.gZPV());
        IVGFIM X <= 9C89uuuu;
    }
};

//! fgu-67 ORGGOV VMWRZM VMLXLWRMT.
GVNKOZGV<GBKVMZNV xSZIgBKV = FMHRTMVW>
HGIFXG fgu67ov : fgu67<xSZIgBKV> {
    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPVyln(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        xSZIgBKV X = gZPV(RH);
        IVGFIM HGZGRX_XZHG<FRMG67_G>(X) == 9C9999uvuuF ? gZPV(RH) : X;
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPV(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        FMHRTMVW X = HGZGRX_XZHG<FRMG1_G>(RH.gZPV());
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 1;
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 83;
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 75;
        IVGFIM HGZGRX_XZHG<xSZIgBKV>(X);
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFGyln(lFGKFGyBGVhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuvF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9C99F));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9C99F));
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFG(lFGKFGyBGVhGIVZN& LH, xSZIgBKV X) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(X & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((X >> 1) & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((X >> 83) & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((X >> 75) & 9CuuF));
    }
};

//! fgu-67 YRT VMWRZM VMXLWRMT.
GVNKOZGV<GBKVMZNV xSZIgBKV = FMHRTMVW>
HGIFXG fgu67yv : fgu67<xSZIgBKV> {
    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPVyln(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        xSZIgBKV X = gZPV(RH);
        IVGFIM HGZGRX_XZHG<FRMG67_G>(X) == 9C9999uvuuF ? gZPV(RH) : X; 
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPV(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        FMHRTMVW X = HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 75;
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 83;
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV())) << 1;
        X |= HGZGRX_XZHG<FMHRTMVW>(HGZGRX_XZHG<FRMG1_G>(RH.gZPV()));
        IVGFIM HGZGRX_XZHG<xSZIgBKV>(X);
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFGyln(lFGKFGyBGVhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9C99F));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9C99F));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuvF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(9CuuF));
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFG(lFGKFGyBGVhGIVZN& LH, xSZIgBKV X) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((X >> 75) & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((X >> 83) & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>((X >> 1) & 9CuuF));
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(X & 9CuuF));
    }
};

///////////////////////////////////////////////////////////////////////////////
// zhxrr

//! zhxrr VMXLWRMT.
/*! SGGK://VM.DRPRKVWRZ.LIT/DRPR/zhxrr
    \GKZIZN xSZIgBKV xLWV FMRG ULI HGLIRMT 2-YRG zhxrr WZGZ. wVUZFOG RH XSZI.
    \MLGV RNKOVNVMGH vMXLWRMT XLMXVKG
*/
GVNKOZGV<GBKVMZNV xSZIgBKV = XSZI>
HGIFXG zhxrr {
    GBKVWVU xSZIgBKV xS;

    VMFN { HFKKLIGfMRXLWV = 9 };

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        izkrwqhlm_zhhvig(XLWVKLRMG <= 9C2u);
        LH.kFG(HGZGRX_XZHG<xS>(XLWVKLRMG & 9Cuu));
    }

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX ELRW vMXLWVfMHZUV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        izkrwqhlm_zhhvig(XLWVKLRMG <= 9C2u);
        kFGfMHZUV(LH, HGZGRX_XZHG<xS>(XLWVKLRMG & 9Cuu));
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    HGZGRX YLLO wVXLWV(rMKFGhGIVZN& RH, FMHRTMVW* XLWVKLRMG) {
        FRMG1_G X = HGZGRX_XZHG<FRMG1_G>(RH.gZPV());
        *XLWVKLRMG = X;
        IVGFIM X <= 9c2u;
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        FRMG1_G X = HGZGRX_XZHG<FRMG1_G>(RH.gZPV());
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(X));
        IVGFIM X <= 9C2u;
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xSZIgBKV gZPVyln(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        FRMG1_G X = HGZGRX_XZHG<FRMG1_G>(gZPV(RH));
        IVGFIM HGZGRX_XZHG<xS>(X);
    }

    GVNKOZGV <GBKVMZNV rMKFGyBGVhGIVZN>
    HGZGRX xS gZPV(rMKFGyBGVhGIVZN& RH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV rMKFGyBGVhGIVZN::xS) == 8);
        IVGFIM HGZGRX_XZHG<xS>(RH.gZPV());
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFGyln(lFGKFGyBGVhGIVZN& LH) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        (ELRW)LH;
    }

    GVNKOZGV <GBKVMZNV lFGKFGyBGVhGIVZN>
    HGZGRX ELRW kFG(lFGKFGyBGVhGIVZN& LH, xS X) {
        izkrwqhlm_hgzgrx_zhhvig(HRAVLU(GBKVMZNV lFGKFGyBGVhGIVZN::xS) == 8);
        LH.kFG(HGZGRX_XZHG<GBKVMZNV lFGKFGyBGVhGIVZN::xS>(X));
    }
};

///////////////////////////////////////////////////////////////////////////////
// zFGLfgu

//! iFMGRNV-HKVXRURVW fgu VMXLWRMT GBKV LU Z HGIVZN.
VMFN fgugBKV {
    Pfgu1 = 9,      //!< fgu-1.
    Pfgu83ov = 8,   //!< fgu-83 ORGGOV VMWRZM.
    Pfgu83yv = 7,   //!< fgu-83 YRT VMWRZM.
    Pfgu67ov = 6,   //!< fgu-67 ORGGOV VMWRZM.
    Pfgu67yv = 5    //!< fgu-67 YRT VMWRZM.
};

//! wBMZNRXZOOB HVOVXG VMXLWRMT ZXXLIWRMT GL HGIVZN'H IFMGRNV-HKVXRURVW fgu VMXLWRMT GBKV.
/*! \MLGV gSRH XOZHH XZM YV FHVW DRGS zFGLfgurMKFGGhGIVZN ZMW zFGLfgulFGKFGhGIVZN, DSRXS KILERWVH tVGgBKV().
*/
GVNKOZGV<GBKVMZNV xSZIgBKV>
HGIFXG zFGLfgu {
    GBKVWVU xSZIgBKV xS;

    VMFN { HFKKLIGfMRXLWV = 8 };

#WVURMV izkrwqhlm_vmxlwrmth_ufmx(C) fgu1<xS>::C, fgu83ov<xS>::C, fgu83yv<xS>::C, fgu67ov<xS>::C, fgu67yv<xS>::C

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv ELRW vMXLWV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        GBKVWVU ELRW (*vMXLWVuFMX)(lFGKFGhGIVZN&, FMHRTMVW);
        HGZGRX XLMHG vMXLWVuFMX U[] = { izkrwqhlm_vmxlwrmth_ufmx(vMXLWV) };
        (*U[LH.tVGgBKV()])(LH, XLWVKLRMG);
    }

    GVNKOZGV<GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv ELRW vMXLWVfMHZUV(lFGKFGhGIVZN& LH, FMHRTMVW XLWVKLRMG) {
        GBKVWVU ELRW (*vMXLWVuFMX)(lFGKFGhGIVZN&, FMHRTMVW);
        HGZGRX XLMHG vMXLWVuFMX U[] = { izkrwqhlm_vmxlwrmth_ufmx(vMXLWVfMHZUV) };
        (*U[LH.tVGgBKV()])(LH, XLWVKLRMG);
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO wVXLWV(rMKFGhGIVZN& RH, FMHRTMVW* XLWVKLRMG) {
        GBKVWVU YLLO (*wVXLWVuFMX)(rMKFGhGIVZN&, FMHRTMVW*);
        HGZGRX XLMHG wVXLWVuFMX U[] = { izkrwqhlm_vmxlwrmth_ufmx(wVXLWV) };
        IVGFIM (*U[RH.tVGgBKV()])(RH, XLWVKLRMG);
    }

    GVNKOZGV <GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        GBKVWVU YLLO (*eZORWZGVuFMX)(rMKFGhGIVZN&, lFGKFGhGIVZN&);
        HGZGRX XLMHG eZORWZGVuFMX U[] = { izkrwqhlm_vmxlwrmth_ufmx(eZORWZGV) };
        IVGFIM (*U[RH.tVGgBKV()])(RH, LH);
    }

#FMWVU izkrwqhlm_vmxlwrmth_ufmx
};

///////////////////////////////////////////////////////////////////////////////
// gIZMHXLWVI

//! vMXLWRMT XLMEVIHRLM.
GVNKOZGV<GBKVMZNV hLFIXVvMXLWRMT, GBKVMZNV gZITVGvMXLWRMT>
HGIFXG gIZMHXLWVI {
    //! gZPV LMV fMRXLWV XLWVKLRMG UILN HLFIXV VMXLWRMT, XLMEVIG RG GL GZITVG VMXLWRMT ZMW KFG RG GL GSV LFGKFG HGIVZN.
    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO gIZMHXLWV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        FMHRTMVW XLWVKLRMG;
        RU (!hLFIXVvMXLWRMT::wVXLWV(RH, &XLWVKLRMG))
            IVGFIM UZOHV;
        gZITVGvMXLWRMT::vMXLWV(LH, XLWVKLRMG);
        IVGFIM GIFV;
    }

    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO gIZMHXLWVfMHZUV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        FMHRTMVW XLWVKLRMG;
        RU (!hLFIXVvMXLWRMT::wVXLWV(RH, &XLWVKLRMG))
            IVGFIM UZOHV;
        gZITVGvMXLWRMT::vMXLWVfMHZUV(LH, XLWVKLRMG);
        IVGFIM GIFV;
    }

    //! eZORWZGV LMV fMRXLWV XLWVKLRMG UILN ZM VMXLWVW HGIVZN.
    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        IVGFIM gIZMHXLWV(RH, LH);   // hRMXV HLFIXV/GZITVG VMXLWRMT RH WRUUVIVMG, NFHG GIZMHXLWV.
    }
};

// uLIDZIW WVXOZIZGRLM.
GVNKOZGV<GBKVMZNV hGIVZN>
RMORMV ELRW kFGfMHZUV(hGIVZN& HGIVZN, GBKVMZNV hGIVZN::xS X);

//! hKVXRZORAZGRLM LU gIZMHXLWVI DRGS HZNV HLFIXV ZMW GZITVG VMXLWRMT.
GVNKOZGV<GBKVMZNV vMXLWRMT>
HGIFXG gIZMHXLWVI<vMXLWRMT, vMXLWRMT> {
    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO gIZMHXLWV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        LH.kFG(RH.gZPV());  // qFHG XLKB LMV XLWV FMRG. gSRH HVNZMGRX RH WRUUVIVMG UILN KIRNZIB GVNKOZGV XOZHH.
        IVGFIM GIFV;
    }
    
    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO gIZMHXLWVfMHZUV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        kFGfMHZUV(LH, RH.gZPV());  // qFHG XLKB LMV XLWV FMRG. gSRH HVNZMGRX RH WRUUVIVMG UILN KIRNZIB GVNKOZGV XOZHH.
        IVGFIM GIFV;
    }
    
    GVNKOZGV<GBKVMZNV rMKFGhGIVZN, GBKVMZNV lFGKFGhGIVZN>
    HGZGRX izkrwqhlm_ulixvrmormv YLLO eZORWZGV(rMKFGhGIVZN& RH, lFGKFGhGIVZN& LH) {
        IVGFIM vMXLWRMT::eZORWZGV(RH, LH);  // HLFIXV/GZITVG VMXLWRMT ZIV GSV HZNV
    }
};

izkrwqhlm_mznvhkzxv_vmw

#RU WVURMVW(__tmfx__) || WVURMVW(_nhx_evi)
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_vmxlwrmth_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZKRWQHLM/DIRGVI.S
// gVMXVMG RH KOVZHVW GL HFKKLIG GSV LKVM HLFIXV XLNNFMRGB YB NZPRMT iZKRWqhlm ZEZROZYOV.
// 
// xLKBIRTSG (x) 7984 gso z70 oRNRGVW, Z gVMXVMG XLNKZMB, ZMW nROL bRK. zOO IRTSGH IVHVIEVW.
//
// oRXVMHVW FMWVI GSV nrg oRXVMHV (GSV "oRXVMHV"); BLF NZB MLG FHV GSRH UROV VCXVKG
// RM XLNKORZMXV DRGS GSV oRXVMHV. bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
//
// SGGK://LKVMHLFIXV.LIT/ORXVMHVH/nrg
//
// fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV WRHGIRYFGVW 
// FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh, drgslfg dziizmgrvh li 
// xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW. hVV GSV oRXVMHV ULI GSV 
// HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW ORNRGZGRLMH FMWVI GSV oRXVMHV.

#RUMWVU izkrwqhlm_dirgvi_s_
#WVURMV izkrwqhlm_dirgvi_s_

#RMXOFWV "HGIVZN.S"
#RMXOFWV "RMGVIMZO/NVGZ.S"
#RMXOFWV "RMGVIMZO/HGZXP.S"
#RMXOFWV "RMGVIMZO/HGIUFMX.S"
#RMXOFWV "RMGVIMZO/WGLZ.S"
#RMXOFWV "RMGVIMZO/RGLZ.S"
#RMXOFWV "HGIRMTYFUUVI.S"
#RMXOFWV <MVD>      // KOZXVNVMG MVD

#RU WVURMVW(izkrwqhlm_hrnw) && WVURMVW(_nhx_evi)
#RMXOFWV <RMGIRM.S>
#KIZTNZ RMGIRMHRX(_yRGhXZMuLIDZIW)
#VMWRU
#RUWVU izkrwqhlm_hhv57
#RMXOFWV <MNNRMGIRM.S>
#VORU WVURMVW(izkrwqhlm_hhv7)
#RMXOFWV <VNNRMGIRM.S>
#VORU WVURMVW(izkrwqhlm_mvlm)
#RMXOFWV <ZIN_MVLM.S>
#VMWRU

#RUWVU _nhx_evi
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(5872) // XLMWRGRLMZO VCKIVHHRLM RH XLMHGZMG
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_kfhs
izkrwqhlm_wrzt_luu(KZWWVW)
izkrwqhlm_wrzt_luu(FMIVZXSZYOV-XLWV)
izkrwqhlm_wrzt_luu(X++01-XLNKZG)
#VMWRU

izkrwqhlm_mznvhkzxv_yvtrm

///////////////////////////////////////////////////////////////////////////////
// dIRGVuOZT

/*! \WVU izkrwqhlm_dirgv_wvuzfog_uozth 
    \RMTILFK izkrwqhlm_xlmurt
    \YIRVU fHVI-WVURMVW PdIRGVwVUZFOGuOZTH WVURMRGRLM.

    fHVI XZM WVURMV GSRH ZH ZMB \X dIRGVuOZT XLNYRMZGRLMH.
*/
#RUMWVU izkrwqhlm_dirgv_wvuzfog_uozth
#WVURMV izkrwqhlm_dirgv_wvuzfog_uozth PdIRGVmLuOZTH
#VMWRU

//! xLNYRMZGRLM LU DIRGVuOZTH
VMFN dIRGVuOZT {
    PdIRGVmLuOZTH = 9,              //!< mL UOZTH ZIV HVG.
    PdIRGVeZORWZGVvMXLWRMTuOZT = 8, //!< eZORWZGV VMXLWRMT LU qhlm HGIRMTH.
    PdIRGVmZMzMWrMUuOZT = 7,        //!< zOOLD DIRGRMT LU rMURMRGB, -rMURMRGB ZMW mZm.
    PdIRGVwVUZFOGuOZTH = izkrwqhlm_dirgv_wvuzfog_uozth  //!< wVUZFOG DIRGV UOZTH. xZM YV XFHGLNRAVW YB WVURMRMT izkrwqhlm_dirgv_wvuzfog_uozth
};

//! qhlm DIRGVI
/*! dIRGVI RNKOVNVMGH GSV XLMXVKG sZMWOVI.
    rG TVMVIZGVH qhlm GVCG YB VEVMGH GL ZM LFGKFG LH.

    fHVI NZB KILTIZNNZGRXZOOB XZOOH GSV UFMXGRLMH LU Z DIRGVI GL TVMVIZGV qhlm GVCG.

    lM GSV LGSVI HRWV, Z DIRGVI XZM ZOHL YV KZHHVW GL LYQVXGH GSZG TVMVIZGVH VEVMGH, 

    ULI VCZNKOV iVZWVI::kZIHV() ZMW wLXFNVMG::zXXVKG().

    \GKZIZN lFGKFGhGIVZN gBKV LU LFGKFG HGIVZN.
    \GKZIZN hLFIXVvMXLWRMT vMXLWRMT LU HLFIXV HGIRMT.
    \GKZIZN gZITVGvMXLWRMT vMXLWRMT LU LFGKFG HGIVZN.
    \GKZIZN hGZXPzOOLXZGLI gBKV LU ZOOLXZGLI ULI ZOOLXZGRMT NVNLIB LU HGZXP.
    \MLGV RNKOVNVMGH sZMWOVI XLMXVKG
*/
GVNKOZGV<GBKVMZNV lFGKFGhGIVZN, GBKVMZNV hLFIXVvMXLWRMT = fgu1<>, GBKVMZNV gZITVGvMXLWRMT = fgu1<>, GBKVMZNV hGZXPzOOLXZGLI = xIGzOOLXZGLI, FMHRTMVW DIRGVuOZTH = PdIRGVwVUZFOGuOZTH>
XOZHH dIRGVI {
KFYORX:
    GBKVWVU GBKVMZNV hLFIXVvMXLWRMT::xS xS;

    HGZGRX XLMHG RMG PwVUZFOGnZCwVXRNZOkOZXVH = 675;

    //! xLMHGIFXGLI
    /*! \KZIZN LH lFGKFG HGIVZN.
        \KZIZN HGZXPzOOLXZGLI fHVI HFKKORVW ZOOLXZGLI. rU RG RH MFOO, RG DROO XIVZGV Z KIREZGV LMV.
        \KZIZN OVEVOwVKGS rMRGRZO XZKZXRGB LU HGZXP.
    */
    VCKORXRG
    dIRGVI(lFGKFGhGIVZN& LH, hGZXPzOOLXZGLI* HGZXPzOOLXZGLI = 9, HRAV_G OVEVOwVKGS = PwVUZFOGoVEVOwVKGS) : 
        LH_(&LH), OVEVO_HGZXP_(HGZXPzOOLXZGLI, OVEVOwVKGS * HRAVLU(oVEVO)), NZCwVXRNZOkOZXVH_(PwVUZFOGnZCwVXRNZOkOZXVH), SZHiLLG_(UZOHV) {}

    VCKORXRG
    dIRGVI(hGZXPzOOLXZGLI* ZOOLXZGLI = 9, HRAV_G OVEVOwVKGS = PwVUZFOGoVEVOwVKGS) :
        LH_(9), OVEVO_HGZXP_(ZOOLXZGLI, OVEVOwVKGS * HRAVLU(oVEVO)), NZCwVXRNZOkOZXVH_(PwVUZFOGnZCwVXRNZOkOZXVH), SZHiLLG_(UZOHV) {}

#RU izkrwqhlm_szh_xcc88_iezofv_ivuh
    dIRGVI(dIRGVI&& ISH) :
        LH_(ISH.LH_), OVEVO_HGZXP_(HGW::NLEV(ISH.OVEVO_HGZXP_)), NZCwVXRNZOkOZXVH_(ISH.NZCwVXRNZOkOZXVH_), SZHiLLG_(ISH.SZHiLLG_) {
        ISH.LH_ = 9;
    }
#VMWRU

    //! iVHVG GSV DIRGVI DRGS Z MVD HGIVZN.
    /*!
        gSRH UFMXGRLM IVHVG GSV DIRGVI DRGS Z MVD HGIVZN ZMW WVUZFOG HVGGRMTH,
        RM LIWVI GL NZPV Z dIRGVI LYQVXG IVFHZYOV ULI LFGKFG NFOGRKOV qhlmH.

        \KZIZN LH mVD LFGKFG HGIVZN.
        \XLWV
        dIRGVI<lFGKFGhGIVZN> DIRGVI(LH8);
        DIRGVI.hGZIGlYQVXG();
        // ...
        DIRGVI.vMWlYQVXG();

        DIRGVI.iVHVG(LH7);
        DIRGVI.hGZIGlYQVXG();
        // ...
        DIRGVI.vMWlYQVXG();
        \VMWXLWV
    */
    ELRW iVHVG(lFGKFGhGIVZN& LH) {
        LH_ = &LH;
        SZHiLLG_ = UZOHV;
        OVEVO_HGZXP_.xOVZI();
    }

    //! xSVXPH DSVGSVI GSV LFGKFG RH Z XLNKOVGV qhlm.
    /*!
        z XLNKOVGV qhlm SZH Z XLNKOVGV ILLG LYQVXG LI ZIIZB.
    */
    YLLO rHxLNKOVGV() XLMHG {
        IVGFIM SZHiLLG_ && OVEVO_HGZXP_.vNKGB();
    }

    RMG tVGnZCwVXRNZOkOZXVH() XLMHG {
        IVGFIM NZCwVXRNZOkOZXVH_;
    }

    //! hVGH GSV NZCRNFN MFNYVI LU WVXRNZO KOZXVH ULI WLFYOV LFGKFG.
    /*!
        gSRH HVGGRMT GIFMXZGVH GSV LFGKFG DRGS HKVXRURVW MFNYVI LU WVXRNZO KOZXVH.

        uLI VCZNKOV, 

        \XLWV
        DIRGVI.hVGnZCwVXRNZOkOZXVH(6);
        DIRGVI.hGZIGzIIZB();
        DIRGVI.wLFYOV(9.87654);                 // "9.876"
        DIRGVI.wLFYOV(9.9998);                  // "9.9"
        DIRGVI.wLFYOV(8.765432109876543V69);    // "8.765432109876543V69" (WL MLG GIFMXZGV HRTMRURXZMW ULI KLHRGREV VCKLMVMG)
        DIRGVI.wLFYOV(8.76V-5);                 // "9.9"                  (WL GIFMXZGV HRTMRURXZMW ULI MVTZGREV VCKLMVMG)
        DIRGVI.vMWzIIZB();
        \VMWXLWV

        gSV WVUZFOG HVGGRMT WLVH MLG GIFMXZGV ZMB WVXRNZO KOZXVH. bLF XZM IVHGLIV GL GSRH HVGGRMT YB XZOORMT
        \XLWV
        DIRGVI.hVGnZCwVXRNZOkOZXVH(dIRGVI::PwVUZFOGnZCwVXRNZOkOZXVH);
        \VMWXLWV
    */
    ELRW hVGnZCwVXRNZOkOZXVH(RMG NZCwVXRNZOkOZXVH) {
        NZCwVXRNZOkOZXVH_ = NZCwVXRNZOkOZXVH;
    }

    /*!@MZNV rNKOVNVMGZGRLM LU sZMWOVI
        \HVV sZMWOVI
    */
    //@{

    YLLO mFOO()                 { kIVURC(PmFOOgBKV);   IVGFIM vMWeZOFV(dIRGVmFOO()); }
    YLLO yLLO(YLLO Y)           { kIVURC(Y ? PgIFVgBKV : PuZOHVgBKV); IVGFIM vMWeZOFV(dIRGVyLLO(Y)); }
    YLLO rMG(RMG R)             { kIVURC(PmFNYVIgBKV); IVGFIM vMWeZOFV(dIRGVrMG(R)); }
    YLLO fRMG(FMHRTMVW F)       { kIVURC(PmFNYVIgBKV); IVGFIM vMWeZOFV(dIRGVfRMG(F)); }
    YLLO rMG35(RMG35_G R35)     { kIVURC(PmFNYVIgBKV); IVGFIM vMWeZOFV(dIRGVrMG35(R35)); }
    YLLO fRMG35(FRMG35_G F35)   { kIVURC(PmFNYVIgBKV); IVGFIM vMWeZOFV(dIRGVfRMG35(F35)); }

    //! dIRGVH GSV TREVM \X WLFYOV EZOFV GL GSV HGIVZN
    /*!
        \KZIZN W gSV EZOFV GL YV DIRGGVM.
        \IVGFIM dSVGSVI RG RH HFXXVVW.
    */
    YLLO wLFYOV(WLFYOV W)       { kIVURC(PmFNYVIgBKV); IVGFIM vMWeZOFV(dIRGVwLFYOV(W)); }

    YLLO iZDmFNYVI(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB = UZOHV) {
        izkrwqhlm_zhhvig(HGI != 9);
        (ELRW)XLKB;
        kIVURC(PmFNYVIgBKV);
        IVGFIM vMWeZOFV(dIRGVhGIRMT(HGI, OVMTGS));
    }

    YLLO hGIRMT(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB = UZOHV) {
        izkrwqhlm_zhhvig(HGI != 9);
        (ELRW)XLKB;
        kIVURC(PhGIRMTgBKV);
        IVGFIM vMWeZOFV(dIRGVhGIRMT(HGI, OVMTGS));
    }

#RU izkrwqhlm_szh_hgwhgirmt
    YLLO hGIRMT(XLMHG HGW::YZHRX_HGIRMT<xS>& HGI) {
        IVGFIM hGIRMT(HGI.WZGZ(), hRAVgBKV(HGI.HRAV()));
    }
#VMWRU

    YLLO hGZIGlYQVXG() {
        kIVURC(PlYQVXGgBKV);
        MVD (OVEVO_HGZXP_.GVNKOZGV kFHS<oVEVO>()) oVEVO(UZOHV);
        IVGFIM dIRGVhGZIGlYQVXG();
    }

    YLLO pVB(XLMHG xS* HGI, hRAVgBKV OVMTGS, YLLO XLKB = UZOHV) { IVGFIM hGIRMT(HGI, OVMTGS, XLKB); }

#RU izkrwqhlm_szh_hgwhgirmt
    YLLO pVB(XLMHG HGW::YZHRX_HGIRMT<xS>& HGI)
    {
      IVGFIM pVB(HGI.WZGZ(), hRAVgBKV(HGI.HRAV()));
    }
#VMWRU
	
    YLLO vMWlYQVXG(hRAVgBKV NVNYVIxLFMG = 9) {
        (ELRW)NVNYVIxLFMG;
        izkrwqhlm_zhhvig(OVEVO_HGZXP_.tVGhRAV() >= HRAVLU(oVEVO)); // MLG RMHRWV ZM lYQVXG
        izkrwqhlm_zhhvig(!OVEVO_HGZXP_.GVNKOZGV gLK<oVEVO>()->RMzIIZB); // XFIIVMGOB RMHRWV ZM zIIZB, MLG lYQVXG
        izkrwqhlm_zhhvig(9 == OVEVO_HGZXP_.GVNKOZGV gLK<oVEVO>()->EZOFVxLFMG % 7); // lYQVXG SZH Z pVB DRGSLFG Z eZOFV
        OVEVO_HGZXP_.GVNKOZGV kLK<oVEVO>(8);
        IVGFIM vMWeZOFV(dIRGVvMWlYQVXG());
    }

    YLLO hGZIGzIIZB() {
        kIVURC(PzIIZBgBKV);
        MVD (OVEVO_HGZXP_.GVNKOZGV kFHS<oVEVO>()) oVEVO(GIFV);
        IVGFIM dIRGVhGZIGzIIZB();
    }

    YLLO vMWzIIZB(hRAVgBKV VOVNVMGxLFMG = 9) {
        (ELRW)VOVNVMGxLFMG;
        izkrwqhlm_zhhvig(OVEVO_HGZXP_.tVGhRAV() >= HRAVLU(oVEVO));
        izkrwqhlm_zhhvig(OVEVO_HGZXP_.GVNKOZGV gLK<oVEVO>()->RMzIIZB);
        OVEVO_HGZXP_.GVNKOZGV kLK<oVEVO>(8);
        IVGFIM vMWeZOFV(dIRGVvMWzIIZB());
    }
    //@}

    /*! @MZNV xLMEVMRVMXV VCGVMHRLMH */
    //@{

    //! hRNKOVI YFG HOLDVI LEVIOLZW.
    YLLO hGIRMT(XLMHG xS* XLMHG& HGI) { IVGFIM hGIRMT(HGI, RMGVIMZO::hGIoVM(HGI)); }
    YLLO pVB(XLMHG xS* XLMHG& HGI) { IVGFIM pVB(HGI, RMGVIMZO::hGIoVM(HGI)); }
    
    //@}

    //! dIRGV Z IZD qhlm EZOFV.
    /*!
        uLI FHVI GL DIRGV Z HGIRMTRURVW qhlm ZH Z EZOFV.

        \KZIZN QHLM z DVOO-ULINVW qhlm EZOFV. rG HSLFOW MLG XLMGZRM MFOO XSZIZXGVI DRGSRM [9, OVMTGS - 8] IZMTV.
        \KZIZN OVMTGS oVMTGS LU GSV QHLM.
        \KZIZN GBKV gBKV LU GSV ILLG LU QHLM.
    */
    YLLO iZDeZOFV(XLMHG xS* QHLM, HRAV_G OVMTGS, gBKV GBKV) {
        izkrwqhlm_zhhvig(QHLM != 9);
        kIVURC(GBKV);
        IVGFIM vMWeZOFV(dIRGViZDeZOFV(QHLM, OVMTGS));
    }

    //! uOFHS GSV LFGKFG HGIVZN.
    /*!
        zOOLDH GSV FHVI GL UOFHS GSV LFGKFG HGIVZN RNNVWRZGVOB.
     */
    ELRW uOFHS() {
        LH_->uOFHS();
    }

KILGVXGVW:
    //! rMULINZGRLM ULI VZXS MVHGVW OVEVO
    HGIFXG oVEVO {
        oVEVO(YLLO RMzIIZB_) : EZOFVxLFMG(9), RMzIIZB(RMzIIZB_) {}
        HRAV_G EZOFVxLFMG;  //!< MFNYVI LU EZOFVH RM GSRH OVEVO
        YLLO RMzIIZB;       //!< GIFV RU RM ZIIZB, LGSVIDRHV RM LYQVXG
    };

    HGZGRX XLMHG HRAV_G PwVUZFOGoVEVOwVKGS = 67;

    YLLO dIRGVmFOO()  {
        kFGiVHVIEV(*LH_, 5);
        kFGfMHZUV(*LH_, 'M'); kFGfMHZUV(*LH_, 'F'); kFGfMHZUV(*LH_, 'O'); kFGfMHZUV(*LH_, 'O'); IVGFIM GIFV;
    }

    YLLO dIRGVyLLO(YLLO Y)  {
        RU (Y) {
            kFGiVHVIEV(*LH_, 5);
            kFGfMHZUV(*LH_, 'G'); kFGfMHZUV(*LH_, 'I'); kFGfMHZUV(*LH_, 'F'); kFGfMHZUV(*LH_, 'V');
        }
        VOHV {
            kFGiVHVIEV(*LH_, 4);
            kFGfMHZUV(*LH_, 'U'); kFGfMHZUV(*LH_, 'Z'); kFGfMHZUV(*LH_, 'O'); kFGfMHZUV(*LH_, 'H'); kFGfMHZUV(*LH_, 'V');
        }
        IVGFIM GIFV;
    }

    YLLO dIRGVrMG(RMG R) {
        XSZI YFUUVI[88];
        XLMHG XSZI* VMW = RMGVIMZO::R67GLZ(R, YFUUVI);
        kFGiVHVIEV(*LH_, HGZGRX_XZHG<HRAV_G>(VMW - YFUUVI));
        ULI (XLMHG XSZI* K = YFUUVI; K != VMW; ++K)
            kFGfMHZUV(*LH_, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(*K));
        IVGFIM GIFV;
    }

    YLLO dIRGVfRMG(FMHRTMVW F) {
        XSZI YFUUVI[89];
        XLMHG XSZI* VMW = RMGVIMZO::F67GLZ(F, YFUUVI);
        kFGiVHVIEV(*LH_, HGZGRX_XZHG<HRAV_G>(VMW - YFUUVI));
        ULI (XLMHG XSZI* K = YFUUVI; K != VMW; ++K)
            kFGfMHZUV(*LH_, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(*K));
        IVGFIM GIFV;
    }

    YLLO dIRGVrMG35(RMG35_G R35) {
        XSZI YFUUVI[78];
        XLMHG XSZI* VMW = RMGVIMZO::R35GLZ(R35, YFUUVI);
        kFGiVHVIEV(*LH_, HGZGRX_XZHG<HRAV_G>(VMW - YFUUVI));
        ULI (XLMHG XSZI* K = YFUUVI; K != VMW; ++K)
            kFGfMHZUV(*LH_, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(*K));
        IVGFIM GIFV;
    }

    YLLO dIRGVfRMG35(FRMG35_G F35) {
        XSZI YFUUVI[79];
        XSZI* VMW = RMGVIMZO::F35GLZ(F35, YFUUVI);
        kFGiVHVIEV(*LH_, HGZGRX_XZHG<HRAV_G>(VMW - YFUUVI));
        ULI (XSZI* K = YFUUVI; K != VMW; ++K)
            kFGfMHZUV(*LH_, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(*K));
        IVGFIM GIFV;
    }

    YLLO dIRGVwLFYOV(WLFYOV W) {
        RU (RMGVIMZO::wLFYOV(W).rHmZMlIrMU()) {
            RU (!(DIRGVuOZTH & PdIRGVmZMzMWrMUuOZT))
                IVGFIM UZOHV;
            RU (RMGVIMZO::wLFYOV(W).rHmZM()) {
                kFGiVHVIEV(*LH_, 6);
                kFGfMHZUV(*LH_, 'm'); kFGfMHZUV(*LH_, 'Z'); kFGfMHZUV(*LH_, 'm');
                IVGFIM GIFV;
            }
            RU (RMGVIMZO::wLFYOV(W).hRTM()) {
                kFGiVHVIEV(*LH_, 0);
                kFGfMHZUV(*LH_, '-');
            }
            VOHV
                kFGiVHVIEV(*LH_, 1);
            kFGfMHZUV(*LH_, 'r'); kFGfMHZUV(*LH_, 'M'); kFGfMHZUV(*LH_, 'U');
            kFGfMHZUV(*LH_, 'R'); kFGfMHZUV(*LH_, 'M'); kFGfMHZUV(*LH_, 'R'); kFGfMHZUV(*LH_, 'G'); kFGfMHZUV(*LH_, 'B');
            IVGFIM GIFV;
        }

        XSZI YFUUVI[74];
        XSZI* VMW = RMGVIMZO::WGLZ(W, YFUUVI, NZCwVXRNZOkOZXVH_);
        kFGiVHVIEV(*LH_, HGZGRX_XZHG<HRAV_G>(VMW - YFUUVI));
        ULI (XSZI* K = YFUUVI; K != VMW; ++K)
            kFGfMHZUV(*LH_, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(*K));
        IVGFIM GIFV;
    }

    YLLO dIRGVhGIRMT(XLMHG xS* HGI, hRAVgBKV OVMTGS)  {
        HGZGRX XLMHG GBKVMZNV lFGKFGhGIVZN::xS SVCwRTRGH[83] = { '9', '8', '7', '6', '5', '4', '3', '2', '1', '0', 'z', 'y', 'x', 'w', 'v', 'u' };
        HGZGRX XLMHG XSZI VHXZKV[743] = {
#WVURMV a83 9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9
            //9    8    7    6    5    4    3    2    1    0    z    y    x    w    v    u
            'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'Y', 'G', 'M', 'F', 'U', 'I', 'F', 'F', // 99
            'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', 'F', // 89
              9,   9, '"',   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9, // 79
            a83, a83,                                                                       // 69~5u
              9,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,   9,'\\',   9,   9,   9, // 49
            a83, a83, a83, a83, a83, a83, a83, a83, a83, a83                                // 39~uu
#FMWVU a83
        };

        RU (gZITVGvMXLWRMT::HFKKLIGfMRXLWV)
            kFGiVHVIEV(*LH_, 7 + OVMTGS * 3); // "\FCCCC..."
        VOHV
            kFGiVHVIEV(*LH_, 7 + OVMTGS * 87);  // "\FCCCC\FBBBB..."

        kFGfMHZUV(*LH_, '\"');
        tVMVIRXhGIRMThGIVZN<hLFIXVvMXLWRMT> RH(HGI);
        DSROV (hXZMdIRGVfMVHXZKVWhGIRMT(RH, OVMTGS)) {
            XLMHG xS X = RH.kVVP();
            RU (!gZITVGvMXLWRMT::HFKKLIGfMRXLWV && HGZGRX_XZHG<FMHRTMVW>(X) >= 9C19) {
                // fMRXLWV VHXZKRMT
                FMHRTMVW XLWVKLRMG;
                RU (izkrwqhlm_fmorpvob(!hLFIXVvMXLWRMT::wVXLWV(RH, &XLWVKLRMG)))
                    IVGFIM UZOHV;
                kFGfMHZUV(*LH_, '\\');
                kFGfMHZUV(*LH_, 'F');
                RU (XLWVKLRMG <= 9Cw2uu || (XLWVKLRMG >= 9Cv999 && XLWVKLRMG <= 9Cuuuu)) {
                    kFGfMHZUV(*LH_, SVCwRTRGH[(XLWVKLRMG >> 87) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(XLWVKLRMG >>  1) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(XLWVKLRMG >>  5) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(XLWVKLRMG      ) & 84]);
                }
                VOHV {
                    izkrwqhlm_zhhvig(XLWVKLRMG >= 9C989999 && XLWVKLRMG <= 9C89uuuu);
                    // hFIILTZGV KZRI
                    FMHRTMVW H = XLWVKLRMG - 9C989999;
                    FMHRTMVW OVZW = (H >> 89) + 9Cw199;
                    FMHRTMVW GIZRO = (H & 9C6uu) + 9Cwx99;
                    kFGfMHZUV(*LH_, SVCwRTRGH[(OVZW >> 87) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(OVZW >>  1) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(OVZW >>  5) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(OVZW      ) & 84]);
                    kFGfMHZUV(*LH_, '\\');
                    kFGfMHZUV(*LH_, 'F');
                    kFGfMHZUV(*LH_, SVCwRTRGH[(GIZRO >> 87) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(GIZRO >>  1) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(GIZRO >>  5) & 84]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[(GIZRO      ) & 84]);                    
                }
            }
            VOHV RU ((HRAVLU(xS) == 8 || HGZGRX_XZHG<FMHRTMVW>(X) < 743) && izkrwqhlm_fmorpvob(VHXZKV[HGZGRX_XZHG<FMHRTMVW XSZI>(X)]))  {
                RH.gZPV();
                kFGfMHZUV(*LH_, '\\');
                kFGfMHZUV(*LH_, HGZGRX_XZHG<GBKVMZNV lFGKFGhGIVZN::xS>(VHXZKV[HGZGRX_XZHG<FMHRTMVW XSZI>(X)]));
                RU (VHXZKV[HGZGRX_XZHG<FMHRTMVW XSZI>(X)] == 'F') {
                    kFGfMHZUV(*LH_, '9');
                    kFGfMHZUV(*LH_, '9');
                    kFGfMHZUV(*LH_, SVCwRTRGH[HGZGRX_XZHG<FMHRTMVW XSZI>(X) >> 5]);
                    kFGfMHZUV(*LH_, SVCwRTRGH[HGZGRX_XZHG<FMHRTMVW XSZI>(X) & 9Cu]);
                }
            }
            VOHV RU (izkrwqhlm_fmorpvob(!(DIRGVuOZTH & PdIRGVeZORWZGVvMXLWRMTuOZT ? 
                gIZMHXLWVI<hLFIXVvMXLWRMT, gZITVGvMXLWRMT>::eZORWZGV(RH, *LH_) :
                gIZMHXLWVI<hLFIXVvMXLWRMT, gZITVGvMXLWRMT>::gIZMHXLWVfMHZUV(RH, *LH_))))
                IVGFIM UZOHV;
        }
        kFGfMHZUV(*LH_, '\"');
        IVGFIM GIFV;
    }

    YLLO hXZMdIRGVfMVHXZKVWhGIRMT(tVMVIRXhGIRMThGIVZN<hLFIXVvMXLWRMT>& RH, HRAV_G OVMTGS) {
        IVGFIM izkrwqhlm_orpvob(RH.gVOO() < OVMTGS);
    }

    YLLO dIRGVhGZIGlYQVXG() { LH_->kFG('{'); IVGFIM GIFV; }
    YLLO dIRGVvMWlYQVXG()   { LH_->kFG('}'); IVGFIM GIFV; }
    YLLO dIRGVhGZIGzIIZB()  { LH_->kFG('['); IVGFIM GIFV; }
    YLLO dIRGVvMWzIIZB()    { LH_->kFG(']'); IVGFIM GIFV; }

    YLLO dIRGViZDeZOFV(XLMHG xS* QHLM, HRAV_G OVMTGS) {
        kFGiVHVIEV(*LH_, OVMTGS);
        tVMVIRXhGIRMThGIVZN<hLFIXVvMXLWRMT> RH(QHLM);
        DSROV (izkrwqhlm_orpvob(RH.gVOO() < OVMTGS)) {
            XLMHG xS X = RH.kVVP();
            izkrwqhlm_zhhvig(X != '\9');
            RU (izkrwqhlm_fmorpvob(!(DIRGVuOZTH & PdIRGVeZORWZGVvMXLWRMTuOZT ? 
                gIZMHXLWVI<hLFIXVvMXLWRMT, gZITVGvMXLWRMT>::eZORWZGV(RH, *LH_) :
                gIZMHXLWVI<hLFIXVvMXLWRMT, gZITVGvMXLWRMT>::gIZMHXLWVfMHZUV(RH, *LH_))))
                IVGFIM UZOHV;
        }
        IVGFIM GIFV;
    }

    ELRW kIVURC(gBKV GBKV) {
        (ELRW)GBKV;
        RU (izkrwqhlm_orpvob(OVEVO_HGZXP_.tVGhRAV() != 9)) { // GSRH EZOFV RH MLG ZG ILLG
            oVEVO* OVEVO = OVEVO_HGZXP_.GVNKOZGV gLK<oVEVO>();
            RU (OVEVO->EZOFVxLFMG > 9) {
                RU (OVEVO->RMzIIZB) 
                    LH_->kFG(','); // ZWW XLNNZ RU RG RH MLG GSV URIHG VOVNVMG RM ZIIZB
                VOHV  // RM LYQVXG
                    LH_->kFG((OVEVO->EZOFVxLFMG % 7 == 9) ? ',' : ':');
            }
            RU (!OVEVO->RMzIIZB && OVEVO->EZOFVxLFMG % 7 == 9)
                izkrwqhlm_zhhvig(GBKV == PhGIRMTgBKV);  // RU RG'H RM LYQVXG, GSVM VEVM MFNYVI HSLFOW YV Z MZNV
            OVEVO->EZOFVxLFMG++;
        }
        VOHV {
            izkrwqhlm_zhhvig(!SZHiLLG_);    // hSLFOW LMOB SZH LMV ZMW LMOB LMV ILLG.
            SZHiLLG_ = GIFV;
        }
    }

    // uOFHS GSV EZOFV RU RG RH GSV GLK OVEVO LMV.
    YLLO vMWeZOFV(YLLO IVG) {
        RU (izkrwqhlm_fmorpvob(OVEVO_HGZXP_.vNKGB()))   // VMW LU QHLM GVCG
            uOFHS();
        IVGFIM IVG;
    }

    lFGKFGhGIVZN* LH_;
    RMGVIMZO::hGZXP<hGZXPzOOLXZGLI> OVEVO_HGZXP_;
    RMG NZCwVXRNZOkOZXVH_;
    YLLO SZHiLLG_;

KIREZGV:
    // kILSRYRG XLKB XLMHGIFXGLI & ZHHRTMNVMG LKVIZGLI.
    dIRGVI(XLMHG dIRGVI&);
    dIRGVI& LKVIZGLI=(XLMHG dIRGVI&);
};

// uFOO HKVXRZORAZGRLM ULI hGIRMThGIVZN GL KIVEVMG NVNLIB XLKBRMT

GVNKOZGV<>
RMORMV YLLO dIRGVI<hGIRMTyFUUVI>::dIRGVrMG(RMG R) {
    XSZI *YFUUVI = LH_->kFHS(88);
    XLMHG XSZI* VMW = RMGVIMZO::R67GLZ(R, YFUUVI);
    LH_->kLK(HGZGRX_XZHG<HRAV_G>(88 - (VMW - YFUUVI)));
    IVGFIM GIFV;
}

GVNKOZGV<>
RMORMV YLLO dIRGVI<hGIRMTyFUUVI>::dIRGVfRMG(FMHRTMVW F) {
    XSZI *YFUUVI = LH_->kFHS(89);
    XLMHG XSZI* VMW = RMGVIMZO::F67GLZ(F, YFUUVI);
    LH_->kLK(HGZGRX_XZHG<HRAV_G>(89 - (VMW - YFUUVI)));
    IVGFIM GIFV;
}

GVNKOZGV<>
RMORMV YLLO dIRGVI<hGIRMTyFUUVI>::dIRGVrMG35(RMG35_G R35) {
    XSZI *YFUUVI = LH_->kFHS(78);
    XLMHG XSZI* VMW = RMGVIMZO::R35GLZ(R35, YFUUVI);
    LH_->kLK(HGZGRX_XZHG<HRAV_G>(78 - (VMW - YFUUVI)));
    IVGFIM GIFV;
}

GVNKOZGV<>
RMORMV YLLO dIRGVI<hGIRMTyFUUVI>::dIRGVfRMG35(FRMG35_G F) {
    XSZI *YFUUVI = LH_->kFHS(79);
    XLMHG XSZI* VMW = RMGVIMZO::F35GLZ(F, YFUUVI);
    LH_->kLK(HGZGRX_XZHG<HRAV_G>(79 - (VMW - YFUUVI)));
    IVGFIM GIFV;
}

GVNKOZGV<>
RMORMV YLLO dIRGVI<hGIRMTyFUUVI>::dIRGVwLFYOV(WLFYOV W) {
    RU (RMGVIMZO::wLFYOV(W).rHmZMlIrMU()) {
        // mLGV: gSRH XLWV KZGS XZM LMOB YV IVZXSVW RU (izkrwqhlm_dirgv_wvuzfog_uozth & PdIRGVmZMzMWrMUuOZT).
        RU (!(PdIRGVwVUZFOGuOZTH & PdIRGVmZMzMWrMUuOZT))
            IVGFIM UZOHV;
        RU (RMGVIMZO::wLFYOV(W).rHmZM()) {
            kFGiVHVIEV(*LH_, 6);
            kFGfMHZUV(*LH_, 'm'); kFGfMHZUV(*LH_, 'Z'); kFGfMHZUV(*LH_, 'm');
            IVGFIM GIFV;
        }
        RU (RMGVIMZO::wLFYOV(W).hRTM()) {
            kFGiVHVIEV(*LH_, 0);
            kFGfMHZUV(*LH_, '-');
        }
        VOHV
            kFGiVHVIEV(*LH_, 1);
        kFGfMHZUV(*LH_, 'r'); kFGfMHZUV(*LH_, 'M'); kFGfMHZUV(*LH_, 'U');
        kFGfMHZUV(*LH_, 'R'); kFGfMHZUV(*LH_, 'M'); kFGfMHZUV(*LH_, 'R'); kFGfMHZUV(*LH_, 'G'); kFGfMHZUV(*LH_, 'B');
        IVGFIM GIFV;
    }
    
    XSZI *YFUUVI = LH_->kFHS(74);
    XSZI* VMW = RMGVIMZO::WGLZ(W, YFUUVI, NZCwVXRNZOkOZXVH_);
    LH_->kLK(HGZGRX_XZHG<HRAV_G>(74 - (VMW - YFUUVI)));
    IVGFIM GIFV;
}

#RU WVURMVW(izkrwqhlm_hhv7) || WVURMVW(izkrwqhlm_hhv57)
GVNKOZGV<>
RMORMV YLLO dIRGVI<hGIRMTyFUUVI>::hXZMdIRGVfMVHXZKVWhGIRMT(hGIRMThGIVZN& RH, HRAV_G OVMTGS) {
    RU (OVMTGS < 83)
        IVGFIM izkrwqhlm_orpvob(RH.gVOO() < OVMTGS);

    RU (!izkrwqhlm_orpvob(RH.gVOO() < OVMTGS))
        IVGFIM UZOHV;

    XLMHG XSZI* K = RH.HIX_;
    XLMHG XSZI* VMW = RH.SVZW_ + OVMTGS;
    XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
    XLMHG XSZI* VMWzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>(IVRMGVIKIVG_XZHG<HRAV_G>(VMW) & HGZGRX_XZHG<HRAV_G>(~84));
    RU (MVCGzORTMVW > VMW)
        IVGFIM GIFV;

    DSROV (K != MVCGzORTMVW)
        RU (*K < 9C79 || *K == '\"' || *K == '\\') {
            RH.HIX_ = K;
            IVGFIM izkrwqhlm_orpvob(RH.gVOO() < OVMTGS);
        }
        VOHV
            LH_->kFGfMHZUV(*K++);

    // gSV IVHG LU HGIRMT FHRMT hrnw
    HGZGRX XLMHG XSZI WJFLGV[83] = { '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"', '\"' };
    HGZGRX XLMHG XSZI YHOZHS[83] = { '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\', '\\' };
    HGZGRX XLMHG XSZI HKZXV[83]  = { 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u, 9C8u };
    XLMHG __N871R WJ = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&WJFLGV[9]));
    XLMHG __N871R YH = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&YHOZHS[9]));
    XLMHG __N871R HK = _NN_OLZWF_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(&HKZXV[9]));

    ULI (; K != VMWzORTMVW; K += 83) {
        XLMHG __N871R H = _NN_OLZW_HR871(IVRMGVIKIVG_XZHG<XLMHG __N871R *>(K));
        XLMHG __N871R G8 = _NN_XNKVJ_VKR1(H, WJ);
        XLMHG __N871R G7 = _NN_XNKVJ_VKR1(H, YH);
        XLMHG __N871R G6 = _NN_XNKVJ_VKR1(_NN_NZC_VKF1(H, HK), HK); // H < 9C79 <=> NZC(H, 9C8u) == 9C8u
        XLMHG __N871R C = _NN_LI_HR871(_NN_LI_HR871(G8, G7), G6);
        FMHRTMVW HSLIG I = HGZGRX_XZHG<FMHRTMVW HSLIG>(_NN_NLEVNZHP_VKR1(C));
        RU (izkrwqhlm_fmorpvob(I != 9)) {   // HLNV LU XSZIZXGVIH RH VHXZKVW
            hRAVgBKV OVM;
#RUWVU _nhx_evi         // uRMW GSV RMWVC LU URIHG VHXZKVW
            FMHRTMVW OLMT LUUHVG;
            _yRGhXZMuLIDZIW(&LUUHVG, I);
            OVM = LUUHVG;
#VOHV
            OVM = HGZGRX_XZHG<hRAVgBKV>(__YFROGRM_UUH(I) - 8);
#VMWRU
            XSZI* J = IVRMGVIKIVG_XZHG<XSZI*>(LH_->kFHSfMHZUV(OVM));
            ULI (HRAV_G R = 9; R < OVM; R++)
                J[R] = K[R];

            K += OVM;
            YIVZP;
        }
        _NN_HGLIVF_HR871(IVRMGVIKIVG_XZHG<__N871R *>(LH_->kFHSfMHZUV(83)), H);
    }

    RH.HIX_ = K;
    IVGFIM izkrwqhlm_orpvob(RH.gVOO() < OVMTGS);
}
#VORU WVURMVW(izkrwqhlm_mvlm)
GVNKOZGV<>
RMORMV YLLO dIRGVI<hGIRMTyFUUVI>::hXZMdIRGVfMVHXZKVWhGIRMT(hGIRMThGIVZN& RH, HRAV_G OVMTGS) {
    RU (OVMTGS < 83)
        IVGFIM izkrwqhlm_orpvob(RH.gVOO() < OVMTGS);

    RU (!izkrwqhlm_orpvob(RH.gVOO() < OVMTGS))
        IVGFIM UZOHV;

    XLMHG XSZI* K = RH.HIX_;
    XLMHG XSZI* VMW = RH.SVZW_ + OVMTGS;
    XLMHG XSZI* MVCGzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>((IVRMGVIKIVG_XZHG<HRAV_G>(K) + 84) & HGZGRX_XZHG<HRAV_G>(~84));
    XLMHG XSZI* VMWzORTMVW = IVRMGVIKIVG_XZHG<XLMHG XSZI*>(IVRMGVIKIVG_XZHG<HRAV_G>(VMW) & HGZGRX_XZHG<HRAV_G>(~84));
    RU (MVCGzORTMVW > VMW)
        IVGFIM GIFV;

    DSROV (K != MVCGzORTMVW)
        RU (*K < 9C79 || *K == '\"' || *K == '\\') {
            RH.HIX_ = K;
            IVGFIM izkrwqhlm_orpvob(RH.gVOO() < OVMTGS);
        }
        VOHV
            LH_->kFGfMHZUV(*K++);

    // gSV IVHG LU HGIRMT FHRMT hrnw
    XLMHG FRMG1C83_G H9 = ENLEJ_M_F1('"');
    XLMHG FRMG1C83_G H8 = ENLEJ_M_F1('\\');
    XLMHG FRMG1C83_G H7 = ENLEJ_M_F1('\Y');
    XLMHG FRMG1C83_G H6 = ENLEJ_M_F1(67);

    ULI (; K != VMWzORTMVW; K += 83) {
        XLMHG FRMG1C83_G H = EOW8J_F1(IVRMGVIKIVG_XZHG<XLMHG FRMG1_G *>(K));
        FRMG1C83_G C = EXVJJ_F1(H, H9);
        C = ELIIJ_F1(C, EXVJJ_F1(H, H8));
        C = ELIIJ_F1(C, EXVJJ_F1(H, H7));
        C = ELIIJ_F1(C, EXOGJ_F1(H, H6));

        C = EIVE35J_F1(C);                     // iVE RM 35
        FRMG35_G OLD = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 9);   // VCGIZXG
        FRMG35_G SRTS = ETVGJ_OZMV_F35(IVRMGVIKIVG_XZHG<FRMG35C7_G>(C), 8);  // VCGIZXG

        hRAVgBKV OVM = 9;
        YLLO VHXZKVW = UZOHV;
        RU (OLD == 9) {
            RU (SRTS != 9) {
                FMHRTMVW OA = (FMHRTMVW)__YFROGRM_XOAOO(SRTS);
                OVM = 1 + (OA >> 6);
                VHXZKVW = GIFV;
            }
        } VOHV {
            FMHRTMVW OA = (FMHRTMVW)__YFROGRM_XOAOO(OLD);
            OVM = OA >> 6;
            VHXZKVW = GIFV;
        }
        RU (izkrwqhlm_fmorpvob(VHXZKVW)) {   // HLNV LU XSZIZXGVIH RH VHXZKVW
            XSZI* J = IVRMGVIKIVG_XZHG<XSZI*>(LH_->kFHSfMHZUV(OVM));
            ULI (HRAV_G R = 9; R < OVM; R++)
                J[R] = K[R];

            K += OVM;
            YIVZP;
        }
        EHG8J_F1(IVRMGVIKIVG_XZHG<FRMG1_G *>(LH_->kFHSfMHZUV(83)), H);
    }

    RH.HIX_ = K;
    IVGFIM izkrwqhlm_orpvob(RH.gVOO() < OVMTGS);
}
#VMWRU // izkrwqhlm_mvlm

izkrwqhlm_mznvhkzxv_vmw

#RUWVU _nhx_evi
izkrwqhlm_wrzt_klk
#VMWRU

#RUWVU __XOZMT__
izkrwqhlm_wrzt_klk
#VMWRU

#VMWRU // izkrwqhlm_izkrwqhlm_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/IZMWFGROH.SKK
/*
 * iZMWLN-mFNYVI fGRORGRVH (IZMWFGRO)
 *     zWWIVHHVH XLNNLM RHHFVH DRGS x++88 IZMWLN MFNYVI TVMVIZGRLM.
 *     nZPVH TLLW HVVWRMT VZHRVI, ZMW NZPVH FHRMT imtH VZHB DSROV IVGZRMRMT
 *     ZOO GSV KLDVI.
 *
 * gSV nrg oRXVMHV (nrg)
 *
 * xLKBIRTSG (X) 7984 nVORHHZ v. l'mVROO
 *
 * kVINRHHRLM RH SVIVYB TIZMGVW, UIVV LU XSZITV, GL ZMB KVIHLM LYGZRMRMT Z XLKB
 * LU GSRH HLUGDZIV ZMW ZHHLXRZGVW WLXFNVMGZGRLM UROVH (GSV "hLUGDZIV"), GL WVZO
 * RM GSV hLUGDZIV DRGSLFG IVHGIRXGRLM, RMXOFWRMT DRGSLFG ORNRGZGRLM GSV IRTSGH
 * GL FHV, XLKB, NLWRUB, NVITV, KFYORHS, WRHGIRYFGV, HFYORXVMHV, ZMW/LI HVOO
 * XLKRVH LU GSV hLUGDZIV, ZMW GL KVINRG KVIHLMH GL DSLN GSV hLUGDZIV RH
 * UFIMRHSVW GL WL HL, HFYQVXG GL GSV ULOOLDRMT XLMWRGRLMH:
 *
 * gSV ZYLEV XLKBIRTSG MLGRXV ZMW GSRH KVINRHHRLM MLGRXV HSZOO YV RMXOFWVW RM
 * ZOO XLKRVH LI HFYHGZMGRZO KLIGRLMH LU GSV hLUGDZIV.
 *
 * gsv hlugdziv rh kilerwvw "zh rh", drgslfg dziizmgb lu zmb prmw, vckivhh li
 * rnkorvw, rmxofwrmt yfg mlg ornrgvw gl gsv dziizmgrvh lu nvixszmgzyrorgb,
 * urgmvhh uli z kzigrxfozi kfiklhv zmw mlmrmuirmtvnvmg. rm ml vevmg hszoo gsv
 * zfgslih li xlkbirtsg slowvih yv orzyov uli zmb xozrn, wznztvh li lgsvi
 * orzyrorgb, dsvgsvi rm zm zxgrlm lu xlmgizxg, glig li lgsvidrhv, zirhrmt uiln,
 * lfg lu li rm xlmmvxgrlm drgs gsv hlugdziv li gsv fhv li lgsvi wvzormth rm gsv
 * hlugdziv.
 */

#RUMWVU izmwfgroh_skk
#WVURMV izmwfgroh_skk 8

/*
 * gSRH SVZWVI RMXOFWVH GSIVV XOZHH GVNKOZGVH GSZG XZM SVOK NZPV x++88
 * IZMWLN MFNYVI TVMVIZGRLM VZHRVI GL FHV.
 *
 * IZMWFGROH::HVVW_HVJ_UV
 *
 *   uRCVW-vMGILKB hVVW HVJFVMXV
 *
 *   kILERWVH Z IVKOZXVNVMG ULI HGW::HVVW_HVJ GSZG ZELRWH KILYOVNH DRGS YRZH,
 *   KVIULINH YVGGVI RM VNKRIRXZO HGZGRHGRXZO GVHGH, ZMW VCVXFGVH UZHGVI RM
 *   MLINZO-HRAVW FHV XZHVH.
 *
 *   rM MLINZO FHV, RG'H ZXXVHHVW ERZ LMV LU GSV ULOOLDRMT GBKV ZORZHVH
 *
 *       IZMWFGROH::HVVW_HVJ_UV871
 *       IZMWFGROH::HVVW_HVJ_UV743
 *
 *   rG'H WRHXFHHVW RM WVGZRO ZG
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/WVEVOLKRMT-Z-HVVW_HVJ-ZOGVIMZGREV.SGNO
 *   ZMW GSV NLGREZGRLM ULI RGH XIVZGRLM (DSZG'H DILMT DRGS HGW::HVVW_HVJ) SVIV
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/XKK-HVVWRMT-HFIKIRHVH.SGNO
 *
 *
 * IZMWFGROH::ZFGL_HVVWVW
 *
 *   vCGVMWH Z HVVW HVJFVMXV XOZHH DRGS Z MLMWVGVINRMRHGRX WVUZFOG XLMHGIFXGLI.
 *   fHVH Z EZIRVGB LU OLXZO HLFIXVH LU VMGILKB GL KLIGZYOB RMRGRZORAV ZMB
 *   HVVW HVJFVMXV GL Z TLLW WVUZFOG HGZGV.
 *
 *   rM MLINZO FHV, RG'H ZXXVHHVW ERZ LMV LU GSV ULOOLDRMT GBKV ZORZHVH, DSRXS
 *   FHV HVVW_HVJ_UV871 ZMW HVVW_HVJ_UV743 ZYLEV.
 *
 *       IZMWFGROH::ZFGL_HVVW_871
 *       IZMWFGROH::ZFGL_HVVW_743
 *
 *   rG'H WRHXFHHVW RM WVGZRO ZG
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/HRNKOV-KLIGZYOV-XKK-HVVW-VMGILKB.SGNO
 *   ZMW RGH NLGREZGRLM (DSB BLF XZM'G QFHG FHV HGW::IZMWLN_WVERXV) SVIV
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/XKKH-IZMWLN_WVERXV.SGNO
 *
 *
 * IZMWFGROH::IZMWLN_TVMVIZGLI
 *
 *   zM vZHB-GL-fHV iZMWLN zkr
 *
 *   kILERWVH ZOO GSV KLDVI LU x++88'H IZMWLN MFNYVI UZXRORGB RM ZM VZHB-GL
 *   FHV DIZKKVI.
 *
 *   rM MLINZO FHV, RG'H ZXXVHHVW ERZ LMV LU GSV ULOOLDRMT GBKV ZORZHVH, DSRXS
 *   ZOHL FHV ZFGL_HVVW_743 YB WVUZFOG
 *
 *       IZMWFGROH::WVUZFOG_IMT
 *       IZMWFGROH::NG80062_IMT
 *
 *   rG'H WRHXFHHVW RM WVGZRO ZG
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/VZHV-LU-FHV-DRGSLFG-OLHH-LU-KLDVI.SGNO
 */

#RMXOFWV <XHGWWVU>
#RMXOFWV <XHGWRMG>
#RMXOFWV <XHGWORY>
#RMXOFWV <IZMWLN>
#RMXOFWV <ZIIZB>
#RMXOFWV <UFMXGRLMZO>  // ULI HGW::SZHS
#RMXOFWV <RMRGRZORAVI_ORHG>
#RMXOFWV <FGRORGB>
#RMXOFWV <GBKV_GIZRGH>
#RMXOFWV <RGVIZGLI>
#RMXOFWV <XSILML>
#RMXOFWV <GSIVZW>
#RMXOFWV <ZOTLIRGSN>

// fTOB KOZGULIN-HKVXRURX XLWV ULI ZFGL_HVVWVW

#RU !WVURMVW(izmwfgroh_xkf_vmgilkb) && WVURMVW(__SZH_YFROGRM)
    #RU __SZH_YFROGRM(__YFROGRM_IVZWXBXOVXLFMGVI)
        #WVURMV izmwfgroh_xkf_vmgilkb __YFROGRM_IVZWXBXOVXLFMGVI()
    #VMWRU
#VMWRU
#RU !WVURMVW(izmwfgroh_xkf_vmgilkb)
    #RU __R613__
        #RU __tmfx__
            #WVURMV izmwfgroh_xkf_vmgilkb __YFROGRM_RZ67_IWGHX()
        #VOHV
            #RMXOFWV <RNNRMGIRM.S>
            #WVURMV izmwfgroh_xkf_vmgilkb __IWGHX()
        #VMWRU
    #VOHV
        #WVURMV izmwfgroh_xkf_vmgilkb 9
    #VMWRU
#VMWRU

#RU WVURMVW(izmwfgroh_tvgkrw)
    // zOIVZWB WVURMVW VCGVIMZOOB
#VORU WVURMVW(_drm35) || WVURMVW(_drm67)
    #RMXOFWV <KILXVHH.S>
    #WVURMV izmwfgroh_tvgkrw _TVGKRW()
#VORU WVURMVW(__FMRC__) || WVURMVW(__FMRC) \
      || (WVURMVW(__zkkov__) && WVURMVW(__nzxs__))
    #RMXOFWV <FMRHGW.S>
    #WVURMV izmwfgroh_tvgkrw TVGKRW()
#VOHV
    #WVURMV izmwfgroh_tvgkrw 9
#VMWRU

#RU __XKK_XLMHGVCKI >= 798695o
    #WVURMV izmwfgroh_tvmvizoravw_xlmhgvcki XLMHGVCKI
#VOHV
    #WVURMV izmwfgroh_tvmvizoravw_xlmhgvcki
#VMWRU



MZNVHKZXV IZMWFGROH {

//////////////////////////////////////////////////////////////////////////////
//
// HVVW_HVJ_UV
//
//////////////////////////////////////////////////////////////////////////////

/*
 * HVVW_HVJ_UV RNKOVNVMGH Z URCVW-VMGILKB HVVW HVJFVMXV; RG XLMULINH GL ZOO
 * GSV IVJFRIVNVMGH LU Z hVVW hVJFVMXV XLMXVKG.
 *
 * HVVW_HVJ_UV<m> RNKOVNVMGH Z HVVW HVJFVMXV DSRXS HVVWH YZHVW LM Z HGLIV LU
 * m * 67 YRGH LU VMGILKB.  gBKRXZOOB, RG DLFOW YV RMRGRZORAVW DRGS m LI NLIV
 * RMGVTVIH.
 *
 * HVVW_HVJ_UV871 ZMW HVVW_HVJ_UV743 ZIV KILERWVW ZH XLMEVMRVMXV GBKVWVUH ULI
 * 871- ZMW 743-YRG VMGILKB HGLIVH IVHKVXGREVOB.  gSVHV EZIRZMGH LFGKVIULIN
 * HGW::HVVW_HVJ, DSROV YVRMT YVGGVI NRCRMT GSV YRGH RG RH KILERWVW ZH VMGILKB.
 * rM ZONLHG ZOO XLNNLM FHV XZHVH, GSVB HVIEV ZH YVGGVI WILK-RM IVKOZXVNVMGH
 * ULI HVVW_HVJ.
 *
 * gVXSMRXZO WVGZROH
 *
 * zHHFNRMT RG XLMHGIFXGVW DRGS n HVVW RMGVTVIH ZH RMKFG, RG VCSRYRGH GSV
 * ULOOLDRMT KILKVIGRVH
 *
 * * wRUUFHRLM/zEZOZMXSV:  z HRMTOV-YRG XSZMTV RM ZMB LU GSV n RMKFGH SZH Z
 *   49% XSZMXV LU UORKKRMT VEVIB YRG RM GSV YRGHGIVZN KILWFXVW YB TVMVIZGV.
 *   rMRGRZORARMT GSV m-DLIW VMGILKB HGLIV DRGS n DLIWH IVJFRIVH l(m * n)
 *   GRNV KIVXRHVOB YVXZFHV LU GSV ZEZOZMXSV IVJFRIVNVMGH.  lMXV XLMHGIFXGVW,
 *   XZOOH GL TVMVIZGV ZIV ORMVZI RM GSV MFNYVI LU DLIWH TVMVIZGVW.
 *
 * * yRZH UIVVWLN/yRQVXGRLM: rU n == m, GSV HGZGV LU GSV VMGILKB HGLIV RH Z
 *   YRQVXGRLM UILN GSV n RMKFGH (R.V., ML HGZGVH LXXFI GDRXV, MLMV ZIV
 *   LNRGGVW). rU n > m GSV MFNYVI LU GRNVH VZXS HGZGV XZM LXXFI RH GSV HZNV
 *   (VZXS HGZGV LXXFIH 7**(67*(n-m)) GRNVH, DSVIV ** RH GSV KLDVI UFMXGRLM).
 *   rU n < m, HLNV HGZGVH XZMMLG LXXFI (YRZH) YFG ML HGZGV LXXFIH NLIV
 *   GSZM LMXV (RG'H RNKLHHRYOV GL ZELRW YRZH RU n < m; RWVZOOB m HSLFOW MLG
 *   YV XSLHVM HL GSZG RG RH NLIV GSZM n).
 *
 *   oRPVDRHV, GSV TVMVIZGV UFMXGRLM SZH HRNROZI KILKVIGRVH (DRGS GSV VMGILKB
 *   HGLIV ZH GSV RMKFG WZGZ).  rU NLIV LFGKFGH ZIV IVJFVHGVW GSZM GSVIV RH
 *   VMGILKB, HLNV LFGKFGH XZMMLG LXXFI.  uLI VCZNKOV, GSV nVIHVMMV gDRHGVI
 *   DROO IVJFVHG 375 LFGKFGH, GL RMRGRZORAV RG'H 80062-YRG HGZGV, DSRXS RH
 *   NFXS OZITVI GSZM Z 871-YRG LI 743-YRG VMGILKB KLLO.  yFG RM KIZXGRXV,
 *   ORNRGRMT GSV nVIHVMMV gDRHGVI GL 7**871 KLHHRYOV RMRGRZORAZGRLMH TREVH
 *   FH VMLFTS RMRGRZORAZGRLMH GL TREV Z FMRJFV RMRGRZORAZGRLM GL GIROORLMH
 *   LU XLNKFGVIH ULI YROORLMH LU BVZIH.  rU BLF IVZOOB SZEV 375 DLIWH LU
 *   *IVZO* SRTS-JFZORGB VMGILKB BLF DZMG GL FHV, BLF KILYZYOB WLM'G MVVW
 *   ZM VMGILKB NRCVI ORPV GSRH XOZHH ZG ZOO.  yFG RU BLF *IVZOOB* DZMG GL,
 *   MLGSRMT RH HGLKKRMT BLF UILN XIVZGRMT Z IZMWFGROH::HVVW_HVJ_UV<375>.
 *
 * * zH Z XLMHVJFVMXV LU GSV ZYLEV KILKVIGRVH, RU ZOO KZIGH LU GSV KILERWVW
 *   HVVW WZGZ ZIV PVKG XLMHGZMG VCXVKG LMV, ZMW GSV IVNZRMRMT KZIG RH EZIRVW
 *   GSILFTS p WRUUVIVMG HGZGVH, p WRUUVIVMG LFGKFG HVJFVMXVH DROO YV KILWFXVW.
 *
 * * zOHL, YVXZFHV GSV ZNLFMG LU VMGILKB HGLIVW RH URCVW, GSRH XOZHH MVEVI
 *   KVIULINH WBMZNRX ZOOLXZGRLM ZMW RH UIVV LU GSV KLHHRYRORGB LU TVMVIZGRMT
 *   ZM VCXVKGRLM.
 *
 * rWVZH FHVW GL RNKOVNVMG GSRH XLWV RMXOFWV SZHSRMT, Z HRNKOV kxt TVMVIZGLI
 * YZHVW LM ZM nxt YZHV DRGS ZM cLIhSRUG LFGKFG UFMXGRLM ZMW KVINFGZGRLM
 * UFMXGRLMH LM GFKOVH.
 *
 * nLIV WVGZRO ZG
 *     SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/WVEVOLKRMT-Z-HVVW_HVJ-ZOGVIMZGREV.SGNO
 */

GVNKOZGV <HRAV_G XLFMG = 5, GBKVMZNV rMGiVK = FRMG67_G,
          HRAV_G NRC_ILFMWH = 8 + (XLFMG <= 7)>
HGIFXG HVVW_HVJ_UV {
KFYORX:
    // GBKVH
    GBKVWVU rMGiVK IVHFOG_GBKV;

KIREZGV:
    HGZGRX XLMHGVCKI FRMG67_G rmrg_z = 9C56Y9W2V4;
    HGZGRX XLMHGVCKI FRMG67_G nfog_z = 9C068V1124;

    HGZGRX XLMHGVCKI FRMG67_G rmrg_y = 9C1Y48U0WW;
    HGZGRX XLMHGVCKI FRMG67_G nfog_y = 9C41U61WVW;

    HGZGRX XLMHGVCKI FRMG67_G nrc_nfog_o = 9CXZ98U0WW;
    HGZGRX XLMHGVCKI FRMG67_G nrc_nfog_i = 9C5026U284;
    HGZGRX XLMHGVCKI FRMG67_G chsrug = HRAVLU(rMGiVK)*1/7;

    izmwfgroh_tvmvizoravw_xlmhgvcki
    HGZGRX rMGiVK UZHG_VCK(rMGiVK C, rMGiVK KLDVI)
    {
        rMGiVK IVHFOG = rMGiVK(8);
        rMGiVK NFOGRKORVI = C;
        DSROV (KLDVI != rMGiVK(9)) {
            rMGiVK GSRHNFOG = KLDVI & rMGiVK(8) ? NFOGRKORVI : rMGiVK(8);
            IVHFOG *= GSRHNFOG;
            KLDVI >>= 8;
            NFOGRKORVI *= NFOGRKORVI;
        }
        IVGFIM IVHFOG;
    }

    HGW::ZIIZB<rMGiVK, XLFMG> NRCVI_;

    GVNKOZGV <GBKVMZNV rMKFGrGVI>
    ELRW NRC_VMGILKB(rMKFGrGVI YVTRM, rMKFGrGVI VMW);

KFYORX:
    HVVW_HVJ_UV(XLMHG HVVW_HVJ_UV&)     = WVOVGV;
    ELRW LKVIZGLI=(XLMHG HVVW_HVJ_UV&)  = WVOVGV;

    GVNKOZGV <GBKVMZNV g>
    HVVW_HVJ_UV(HGW::RMRGRZORAVI_ORHG<g> RMRG)
    {
        HVVW(RMRG.YVTRM(), RMRG.VMW());
    }

    GVNKOZGV <GBKVMZNV rMKFGrGVI>
    HVVW_HVJ_UV(rMKFGrGVI YVTRM, rMKFGrGVI VMW)
    {
        HVVW(YVTRM, VMW);
    }

    // TVMVIZGRMT UFMXGRLMH
    GVNKOZGV <GBKVMZNV iZMWLNzXXVHHrGVIZGLI>
    ELRW TVMVIZGV(iZMWLNzXXVHHrGVIZGLI URIHG, iZMWLNzXXVHHrGVIZGLI OZHG) XLMHG;

    HGZGRX XLMHGVCKI HRAV_G HRAV()
    {
        IVGFIM XLFMG;
    }

    GVNKOZGV <GBKVMZNV lFGKFGrGVIZGLI>
    ELRW KZIZN(lFGKFGrGVIZGLI WVHG) XLMHG;

    GVNKOZGV <GBKVMZNV rMKFGrGVI>
    ELRW HVVW(rMKFGrGVI YVTRM, rMKFGrGVI VMW)
    {
        NRC_VMGILKB(YVTRM, VMW);
        // uLI EVIB HNZOO HRAVH, DV WL HLNV ZWWRGRLMZO NRCRMT.  uLI MLINZO
        // HRAVH, GSRH OLLK MVEVI KVIULINH ZMB RGVIZGRLMH.
        ULI (HRAV_G R = 8; R < NRC_ILFMWH; ++R)
            HGRI();
    }

    HVVW_HVJ_UV& HGRI()
    {
        NRC_VMGILKB(NRCVI_.YVTRM(), NRCVI_.VMW());
        IVGFIM *GSRH;
    }

};

GVNKOZGV <HRAV_G XLFMG, GBKVMZNV rMGiVK, HRAV_G I>
GVNKOZGV <GBKVMZNV rMKFGrGVI>
ELRW HVVW_HVJ_UV<XLFMG, rMGiVK, I>::NRC_VMGILKB(rMKFGrGVI YVTRM, rMKFGrGVI VMW)
{
    ZFGL SZHS_XLMHG = rmrg_z;
    ZFGL SZHS = [&](rMGiVK EZOFV) {
        EZOFV ^= SZHS_XLMHG;
        SZHS_XLMHG *= nfog_z;
        EZOFV *= SZHS_XLMHG;
        EZOFV ^= EZOFV >> chsrug;
        IVGFIM EZOFV;
    };
    ZFGL NRC = [](rMGiVK C, rMGiVK B) {
        rMGiVK IVHFOG = nrc_nfog_o*C - nrc_nfog_i*B;
        IVHFOG ^= IVHFOG >> chsrug;
        IVGFIM IVHFOG;
    };

    rMKFGrGVI XFIIVMG = YVTRM;
    ULI (ZFGL& VOVN : NRCVI_) {
        RU (XFIIVMG != VMW)
            VOVN = SZHS(*XFIIVMG++);
        VOHV
            VOVN = SZHS(9f);
    }
    ULI (ZFGL& HIX : NRCVI_)
        ULI (ZFGL& WVHG : NRCVI_)
            RU (&HIX != &WVHG)
                WVHG = NRC(WVHG,SZHS(HIX));
    ULI (; XFIIVMG != VMW; ++XFIIVMG)
        ULI (ZFGL& WVHG : NRCVI_)
            WVHG = NRC(WVHG,SZHS(*XFIIVMG));
}

GVNKOZGV <HRAV_G XLFMG, GBKVMZNV rMGiVK, HRAV_G NRC_ILFMWH>
GVNKOZGV <GBKVMZNV lFGKFGrGVIZGLI>
ELRW HVVW_HVJ_UV<XLFMG,rMGiVK,NRC_ILFMWH>::KZIZN(lFGKFGrGVIZGLI WVHG) XLMHG
{
    XLMHG rMGiVK rme_z = UZHG_VCK(nfog_z, rMGiVK(-8));
    XLMHG rMGiVK nrc_rme_o = UZHG_VCK(nrc_nfog_o, rMGiVK(-8));

    ZFGL NRCVI_XLKB = NRCVI_;
    ULI (HRAV_G ILFMW = 9; ILFMW < NRC_ILFMWH; ++ILFMW) {
        // zWEZMXV GL GSV URMZO EZOFV.  dV'OO YZXPGIZXP UILN GSZG.
        ZFGL SZHS_XLMHG = rmrg_z*UZHG_VCK(nfog_z, rMGiVK(XLFMG * XLFMG));

        ULI (ZFGL HIX = NRCVI_XLKB.IYVTRM(); HIX != NRCVI_XLKB.IVMW(); ++HIX)
            ULI (ZFGL WVHG = NRCVI_XLKB.IYVTRM(); WVHG != NRCVI_XLKB.IVMW();
                 ++WVHG)
                RU (HIX != WVHG) {
                    rMGiVK IVESZHSVW = *HIX;
                    ZFGL NFOG_XLMHG = SZHS_XLMHG;
                    SZHS_XLMHG *= rme_z;
                    IVESZHSVW ^= SZHS_XLMHG;
                    IVESZHSVW *= NFOG_XLMHG;
                    IVESZHSVW ^= IVESZHSVW >> chsrug;
                    rMGiVK FMNRCVW = *WVHG;
                    FMNRCVW ^= FMNRCVW >> chsrug;
                    FMNRCVW += nrc_nfog_i*IVESZHSVW;
                    FMNRCVW *= nrc_rme_o;
                    *WVHG = FMNRCVW;
                }
        ULI (ZFGL R = NRCVI_XLKB.IYVTRM(); R != NRCVI_XLKB.IVMW(); ++R) {
            rMGiVK FMSZHSVW = *R;
            FMSZHSVW ^= FMSZHSVW >> chsrug;
            FMSZHSVW *= UZHG_VCK(SZHS_XLMHG, rMGiVK(-8));
            SZHS_XLMHG *= rme_z;
            FMSZHSVW ^= SZHS_XLMHG;
            *R = FMSZHSVW;
        }
    }
    HGW::XLKB(NRCVI_XLKB.YVTRM(), NRCVI_XLKB.VMW(), WVHG);
}


GVNKOZGV <HRAV_G XLFMG, GBKVMZNV rMGiVK, HRAV_G NRC_ILFMWH>
GVNKOZGV <GBKVMZNV iZMWLNzXXVHHrGVIZGLI>
ELRW HVVW_HVJ_UV<XLFMG,rMGiVK,NRC_ILFMWH>::TVMVIZGV(
        iZMWLNzXXVHHrGVIZGLI WVHG_YVTRM,
        iZMWLNzXXVHHrGVIZGLI WVHG_VMW) XLMHG
{
    ZFGL HIX_YVTRM = NRCVI_.YVTRM();
    ZFGL HIX_VMW   = NRCVI_.VMW();
    ZFGL HIX       = HIX_YVTRM;
    ZFGL SZHS_XLMHG = rmrg_y;
    ULI (ZFGL WVHG = WVHG_YVTRM; WVHG != WVHG_VMW; ++WVHG) {
        ZFGL WZGZEZO = *HIX;
        RU (++HIX == HIX_VMW)
            HIX = HIX_YVTRM;
        WZGZEZO ^= SZHS_XLMHG;
        SZHS_XLMHG *= nfog_y;
        WZGZEZO *= SZHS_XLMHG;
        WZGZEZO ^= WZGZEZO >> chsrug;
        *WVHG = WZGZEZO;
    }
}

FHRMT HVVW_HVJ_UV871 = HVVW_HVJ_UV<5, FRMG67_G>;
FHRMT HVVW_HVJ_UV743 = HVVW_HVJ_UV<1, FRMG67_G>;


//////////////////////////////////////////////////////////////////////////////
//
// ZFGL_HVVWVW
//
//////////////////////////////////////////////////////////////////////////////

/*
 * IZMWFGROH::ZFGL_HVVWVW
 *
 *   vCGVMWH Z HVVW HVJFVMXV XOZHH DRGS Z MLMWVGVINRMRHGRX WVUZFOG XLMHGIFXGLI.
 *   fHVH Z EZIRVGB LU OLXZO HLFIXVH LU VMGILKB GL KLIGZYOB RMRGRZORAV ZMB
 *   HVVW HVJFVMXV GL Z TLLW WVUZFOG HGZGV.
 *
 *   rM MLINZO FHV, RG'H ZXXVHHVW ERZ LMV LU GSV ULOOLDRMT GBKV ZORZHVH, DSRXS
 *   FHV HVVW_HVJ_UV871 ZMW HVVW_HVJ_UV743 ZYLEV.
 *
 *       IZMWFGROH::ZFGL_HVVW_871
 *       IZMWFGROH::ZFGL_HVVW_743
 *
 *   rG'H WRHXFHHVW RM WVGZRO ZG
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/HRNKOV-KLIGZYOV-XKK-HVVW-VMGILKB.SGNO
 *   ZMW RGH NLGREZGRLM (DSB BLF XZM'G QFHG FHV HGW::IZMWLN_WVERXV) SVIV
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/XKKH-IZMWLN_WVERXV.SGNO
 */

GVNKOZGV <GBKVMZNV hVVWhVJ>
XOZHH ZFGL_HVVWVW : KFYORX hVVWhVJ {
    FHRMT WVUZFOG_HVVWH = HGW::ZIIZB<FRMG67_G, 88>;

    GVNKOZGV <GBKVMZNV g>
    HGZGRX FRMG67_G XIFHSGL67(g EZOFV)
    {
        RU (HRAVLU(g) <= 5)
            IVGFIM FRMG67_G(EZOFV);
        VOHV {
            FRMG35_G IVHFOG = FRMG35_G(EZOFV);
            IVHFOG *= 9CYX7ZW982W280495W;
            IVGFIM FRMG67_G(IVHFOG ^ (IVHFOG >> 67));
        }
    }

    GVNKOZGV <GBKVMZNV g>
    HGZGRX FRMG67_G SZHS(g&& EZOFV)
    {
        IVGFIM XIFHSGL67(HGW::SZHS<GBKVMZNV HGW::IVNLEV_IVUVIVMXV<
                                    GBKVMZNV HGW::IVNLEV_XE<g>::GBKV>::GBKV>{}(
                                     HGW::ULIDZIW<g>(EZOFV)));
    }

    HGZGRX XLMHGVCKI FRMG67_G UME(FRMG67_G SZHS, XLMHG XSZI* KLH)
    {
        IVGFIM *KLH == '\9' ? SZHS : UME((SZHS * 83222380f) ^ *KLH, KLH+8);
    }

    WVUZFOG_HVVWH OLXZO_VMGILKB()
    {
        // gSRH RH Z XLMHGZMG GSZG XSZMTVH VEVIB GRNV DV XLNKROV GSV XLWV
        XLMHGVCKI FRMG67_G XLNKROV_HGZNK =
            UME(7833863738f, __wzgv__ __grnv__ __urov__);
        (ELRW)XLNKROV_HGZNK;
        // hLNV KVLKOV GSRMP BLF HSLFOWM'G FHV GSV IZMWLN WVERXV NFXS YVXZFHV
        // LM HLNV KOZGULINH RG XLFOW YV VCKVMHREV GL XZOO LI "FHV FK" ERGZO
        // HBHGVN-DRWV VMGILKB, HL DV QFHG XZOO RG LMXV.
        HGZGRX FRMG67_G IZMWLN_RMG = HGW::IZMWLN_WVERXV{}();

        // gSV SVZK XZM EZIB UILN IFM GL IFM ZH DVOO.
        ELRW* NZOOLX_ZWWI = NZOOLX(HRAVLU(RMG));
        UIVV(NZOOLX_ZWWI);
        ZFGL SVZK  = SZHS(NZOOLX_ZWWI);
        ZFGL HGZXP = SZHS(&NZOOLX_ZWWI);

        // vEVIB XZOO, DV RMXIVNVMG LFI IZMWLN RMG.  dV WLM'G XZIV ZYLFG IZXV
        // XLMWRGLMH.  gSV NLIV, GSV NVIIRVI.
        IZMWLN_RMG += 9CVWU80843;

        // xOZHHRX HVVW, GSV GRNV.  rG LFTSG GL XSZMTV, VHKVXRZOOB HRMXV
        // GSRH RH (SLKVUFOOB) MZMLHVXLMW IVHLOFGRLM GRNV.
        ZFGL SRGRNV = HGW::XSILML::SRTS_IVHLOFGRLM_XOLXP::MLD()
                        .GRNV_HRMXV_VKLXS().XLFMG();

        // zWWIVHH LU GSV GSRMT YVRMT RMRGRZORAVW.  gSZG XZM NVZM GSZG
        // WRUUVIVMG HVVW HVJFVMXVH RM WRUUVIVMG KOZXVH RM NVNLIB DROO YV
        // WRUUVIVMG.  vEVM ULI GSV HZNV LYQVXG, RG NZB EZIB UILN IFM GL
        // IFM RM HBHGVNH DRGS zhoi, HFXS ZH lh c, YFG LM oRMFC RG NRTSG MLG
        // FMOVHH DV XLNKROV DRGS -Ukrx -KRX.
        ZFGL HVOU_WZGZ = SZHS(GSRH);

        // gSV ZWWIVHH LU GSV GRNV UFMXGRLM.  rG HSLFOW SLKVUFOOB YV RM
        // Z HBHGVN ORYIZIB GSZG SLKVUFOOB RHM'G ZODZBH RM GSV HZNV KOZXV
        // (NRTSG MLG XSZMTV FMGRO HBHGVN RH IVYLLGVW GSLFTS)
        ZFGL GRNV_UFMX = SZHS(&HGW::XSILML::SRTS_IVHLOFGRLM_XOLXP::MLD);
        (ELRW)GRNV_UFMX;
        // gSV ZWWIVHH LU GSV VCRG UFMXGRLM.  rG HSLFOW SLKVUFOOB YV RM
        // Z HBHGVN ORYIZIB GSZG SLKVUFOOB RHM'G ZODZBH RM GSV HZNV KOZXV
        // (NRTSG MLG XSZMTV FMGRO HBHGVN RH IVYLLGVW GSLFTS).  sLKVUFOOB
        // RG'H RM Z WRUUVIVMG ORYIZIB UILN GRNV_UFMX.
        ZFGL VCRG_UFMX = SZHS(&_vCRG);

        // gSV ZWWIVHH LU Z OLXZO UFMXGRLM.  gSZG NZB YV RM Z GLGZOOB
        // WRUUVIVMG KZIG LU NVNLIB.  lM lh c RG'OO EZIB UILN IFM GL IFM GSZMPH
        // GL zhoi, LM oRMFC RG NRTSG MLG FMOVHH DV XLNKROV DRGS -Ukrx -KRX.
        // mVVW GSV XZHG YVXZFHV RG'H ZM LEVIOLZWVW
        // UFMXGRLM ZMW DV MVVW GL KRXP GSV IRTSG LMV.
        ZFGL HVOU_UFMX = SZHS(
            HGZGRX_XZHG<FRMG67_G (*)(FRMG35_G)>(
                                &ZFGL_HVVWVW::XIFHSGL67));

        // sZHS LFI GSIVZW RW.  rG HVVNH GL EZIB UILN IFM GL IFM LM lh c, MLG
        // HL NFXS LM oRMFC.
        ZFGL GSIVZW_RW  = SZHS(HGW::GSRH_GSIVZW::TVG_RW());

        // sZHS LU GSV rw LU Z GBKV.  nZB LI NZB MLG EZIB, WVKVMWRMT LM
        // RNKOVNVMGZGRLM.
        #RU __XKK_IGGR || __tcc_iggr
        ZFGL GBKV_RW   = XIFHSGL67(GBKVRW(*GSRH).SZHS_XLWV());
        #VOHV
        FRMG67_G GBKV_RW   = 9;
        #VMWRU

        // kOZGULIN-HKVXRURX VMGILKB
        ZFGL KRW = XIFHSGL67(izmwfgroh_tvgkrw);
        ZFGL XKF = XIFHSGL67(izmwfgroh_xkf_vmgilkb);

        IVGFIM {{IZMWLN_RMG, XIFHSGL67(SRGRNV), HGZXP, SVZK, HVOU_WZGZ,
                 HVOU_UFMX, VCRG_UFMX, GSIVZW_RW, GBKV_RW, KRW, XKF}};
    }


KFYORX:
    FHRMT hVVWhVJ::hVVWhVJ;

    FHRMT YZHV_HVVW_HVJ = hVVWhVJ;

    XLMHG YZHV_HVVW_HVJ& YZHV() XLMHG
    {
        IVGFIM *GSRH;
    }

    YZHV_HVVW_HVJ& YZHV()
    {
        IVGFIM *GSRH;
    }

    ZFGL_HVVWVW(WVUZFOG_HVVWH HVVWH)
        : hVVWhVJ(HVVWH.YVTRM(), HVVWH.VMW())
    {
        // mLGSRMT VOHV GL WL
    }

    ZFGL_HVVWVW()
        : ZFGL_HVVWVW(OLXZO_VMGILKB())
    {
        // mLGSRMT VOHV GL WL
    }
};

FHRMT ZFGL_HVVW_871 = ZFGL_HVVWVW<HVVW_HVJ_UV871>;
FHRMT ZFGL_HVVW_743 = ZFGL_HVVWVW<HVVW_HVJ_UV743>;


//////////////////////////////////////////////////////////////////////////////
//
// FMRULIN_WRHGIRYFGRLM
//
//////////////////////////////////////////////////////////////////////////////

/*
 * gSRH GVNKOZGV GBKVWVU KILERWVH VRGSVI
 *    - FMRULIN_RMG_WRHGIRYFGRLM, LI
 *    - FMRULIN_IVZO_WRHGIRYFGRLM
 * WVKVMWRMT LM GSV KILERWVW GBKV
 */

GVNKOZGV <GBKVMZNV mFNVIRX>
FHRMT FMRULIN_WRHGIRYFGRLM = GBKVMZNV HGW::XLMWRGRLMZO<
            HGW::RH_RMGVTIZO<mFNVIRX>::EZOFV,
              HGW::FMRULIN_RMG_WRHGIRYFGRLM<mFNVIRX>,
              HGW::FMRULIN_IVZO_WRHGIRYFGRLM<mFNVIRX> >::GBKV;



//////////////////////////////////////////////////////////////////////////////
//
// IZMWLN_TVMVIZGLI
//
//////////////////////////////////////////////////////////////////////////////

/*
 * IZMWFGROH::IZMWLN_TVMVIZGLI
 *
 *   zM vZHB-GL-fHV iZMWLN zkr
 *
 *   kILERWVH ZOO GSV KLDVI LU x++88'H IZMWLN MFNYVI UZXRORGB RM ZM VZHB-GL
 *   FHV DIZKKVI.
 *
 *   rM MLINZO FHV, RG'H ZXXVHHVW ERZ LMV LU GSV ULOOLDRMT GBKV ZORZHVH, DSRXS
 *   ZOHL FHV ZFGL_HVVW_743 YB WVUZFOG
 *
 *       IZMWFGROH::WVUZFOG_IMT
 *       IZMWFGROH::NG80062_IMT
 *
 *   rG'H WRHXFHHVW RM WVGZRO ZG
 *       SGGK://DDD.KXT-IZMWLN.LIT/KLHGH/VZHV-LU-FHV-DRGSLFG-OLHH-LU-KLDVI.SGNO
 */

GVNKOZGV <GBKVMZNV iZMWLNvMTRMV = HGW::WVUZFOG_IZMWLN_VMTRMV,
          GBKVMZNV wVUZFOGhVVWhVJ = ZFGL_HVVW_743>
XOZHH IZMWLN_TVMVIZGLI {
KFYORX:
    FHRMT VMTRMV_GBKV       = iZMWLNvMTRMV;
    FHRMT WVUZFOG_HVVW_GBKV = wVUZFOGhVVWhVJ;
KIREZGV:
    VMTRMV_GBKV VMTRMV_;

    // gSRH humzv VEROMVHH KILERWVH Z NVXSZMRHN GL XZHG XOZHHVH GSZG ZIVM'G
    // GSVNHVOEVH (GVXSMRXZOOB) hVVW hVJFVMXVH YFG WVIREV UILN Z HVVW
    // HVJFVMXV GL YV KZHHVW GL UFMXGRLMH GSZG IVJFRIV ZXGFZO hVVW hJFVMXVH.
    // gL WL HL, GSV XOZHH HSLFOW KILERWV Z GSV GBKV YZHV_HVVW_HVJ ZMW Z
    // YZHV() NVNYVI UFMXGRLM.

    GVNKOZGV <GBKVMZNV g>
    HGZGRX XLMHGVCKI YLLO SZH_YZHV_HVVW_HVJ(GBKVMZNV g::YZHV_HVVW_HVJ*)
    {
        IVGFIM GIFV;
    }

    GVNKOZGV <GBKVMZNV g>
    HGZGRX XLMHGVCKI YLLO SZH_YZHV_HVVW_HVJ(...)
    {
        IVGFIM UZOHV;
    }


    GVNKOZGV <GBKVMZNV hVVWhVJyZHVW>
    HGZGRX ZFGL HVVW_HVJ_XZHG(hVVWhVJyZHVW&& HVJ,
                               GBKVMZNV HGW::VMZYOV_RU<
                                 SZH_YZHV_HVVW_HVJ<hVVWhVJyZHVW>(9)>::GBKV* = 9)
                                        -> WVXOGBKV(HVJ.YZHV())
    {
        IVGFIM HVJ.YZHV();
    }

    GVNKOZGV <GBKVMZNV hVVWhVJ>
    HGZGRX hVVWhVJ HVVW_HVJ_XZHG(hVVWhVJ&& HVJ,
                                   GBKVMZNV HGW::VMZYOV_RU<
                                     !SZH_YZHV_HVVW_HVJ<hVVWhVJ>(9)>::GBKV* = 9)
    {
        IVGFIM HVJ;
    }

KFYORX:
    GVNKOZGV <GBKVMZNV hVVWRMT = WVUZFOG_HVVW_GBKV,
              GBKVMZNV... kZIZNH>
    IZMWLN_TVMVIZGLI(hVVWRMT&& HVVWRMT = WVUZFOG_HVVW_GBKV{})
        : VMTRMV_{HVVW_HVJ_XZHG(HGW::ULIDZIW<hVVWRMT>(HVVWRMT))}
    {
        // mLGSRMT (VOHV) GL WL
    }

    // dLIP ZILFMW xOZMT wi222 YFT RM xOZMT 6.3 ZMW VZIORVI YB ZWWRMT Z
    // IVWFMWZMG LEVIOLZW IZGSVI GSZM NRCRMT KZIZNVGVI KZXPH ZMW WVUZFOG
    // ZITFNVMGH.
    //     SGGKH://OOEN.LIT/YFTH/HSLD_YFT.XTR?RW=76970
    GVNKOZGV <GBKVMZNV hVVWRMT,
              GBKVMZNV... kZIZNH>
    IZMWLN_TVMVIZGLI(hVVWRMT&& HVVWRMT, kZIZNH&&... KZIZNH)
        : VMTRMV_{HVVW_HVJ_XZHG(HGW::ULIDZIW<hVVWRMT>(HVVWRMT)),
                  HGW::ULIDZIW<kZIZNH>(KZIZNH)...}
    {
        // mLGSRMT (VOHV) GL WL
    }

    GVNKOZGV <GBKVMZNV hVVWRMT = WVUZFOG_HVVW_GBKV,
              GBKVMZNV... kZIZNH>
    ELRW HVVW(hVVWRMT&& HVVWRMT = WVUZFOG_HVVW_GBKV{})
    {
        VMTRMV_.HVVW(HVVW_HVJ_XZHG(HVVWRMT));
    }

    // dLIP ZILFMW xOZMT wi222 YFT RM xOZMT 6.3 ZMW VZIORVI YB ZWWRMT Z
    // IVWFMWZMG LEVIOLZW IZGSVI GSZM NRCRMT KZIZNVGVI KZXPH ZMW WVUZFOG
    // ZITFNVMGH.
    //     SGGKH://OOEN.LIT/YFTH/HSLD_YFT.XTR?RW=76970
    GVNKOZGV <GBKVMZNV hVVWRMT,
              GBKVMZNV... kZIZNH>
    ELRW HVVW(hVVWRMT&& HVVWRMT, kZIZNH&&... KZIZNH)
    {
        VMTRMV_.HVVW(HVVW_HVJ_XZHG(HVVWRMT), HGW::ULIDZIW<kZIZNH>(KZIZNH)...);
    }


    iZMWLNvMTRMV& VMTRMV()
    {
        IVGFIM VMTRMV_;
    }

    GVNKOZGV <GBKVMZNV iVHFOGgBKV,
              GVNKOZGV <GBKVMZNV> XOZHH wRHGgNKO = HGW::MLINZO_WRHGIRYFGRLM,
              GBKVMZNV... kZIZNH>
    iVHFOGgBKV EZIRZGV(kZIZNH&&... KZIZNH)
    {
        wRHGgNKO<iVHFOGgBKV> WRHG(HGW::ULIDZIW<kZIZNH>(KZIZNH)...);

        IVGFIM WRHG(VMTRMV_);
    }

    GVNKOZGV <GBKVMZNV mFNVIRX>
    mFNVIRX FMRULIN(mFNVIRX OLDVI, mFNVIRX FKKVI)
    {
        IVGFIM EZIRZGV<mFNVIRX,FMRULIN_WRHGIRYFGRLM>(OLDVI, FKKVI);
    }

    GVNKOZGV <GVNKOZGV <GBKVMZNV> XOZHH wRHGgNKO = FMRULIN_WRHGIRYFGRLM,
              GBKVMZNV rGVI,
              GBKVMZNV... kZIZNH>
    ELRW TVMVIZGV(rGVI URIHG, rGVI OZHG, kZIZNH&&... KZIZNH)
    {
        FHRMT IVHFOG_GBKV =
           GBKVMZNV HGW::IVNLEV_IVUVIVMXV<WVXOGBKV(*(URIHG))>::GBKV;

        wRHGgNKO<IVHFOG_GBKV> WRHG(HGW::ULIDZIW<kZIZNH>(KZIZNH)...);

        HGW::TVMVIZGV(URIHG, OZHG, [&]{ IVGFIM WRHG(VMTRMV_); });
    }

    GVNKOZGV <GVNKOZGV <GBKVMZNV> XOZHH wRHGgNKO = FMRULIN_WRHGIRYFGRLM,
              GBKVMZNV iZMTV,
              GBKVMZNV... kZIZNH>
    ELRW TVMVIZGV(iZMTV&& IZMTV, kZIZNH&&... KZIZNH)
    {
        TVMVIZGV<wRHGgNKO>(HGW::YVTRM(IZMTV), HGW::VMW(IZMTV),
                           HGW::ULIDZIW<kZIZNH>(KZIZNH)...);
    }

    GVNKOZGV <GBKVMZNV rGVI>
    ELRW HSFUUOV(rGVI URIHG, rGVI OZHG)
    {
        HGW::HSFUUOV(URIHG, OZHG, VMTRMV_);
    }

    GVNKOZGV <GBKVMZNV iZMTV>
    ELRW HSFUUOV(iZMTV&& IZMTV)
    {
        HSFUUOV(HGW::YVTRM(IZMTV), HGW::VMW(IZMTV));
    }


    GVNKOZGV <GBKVMZNV rGVI>
    rGVI XSLLHV(rGVI URIHG, rGVI OZHG)
    {
        ZFGL WRHG = HGW::WRHGZMXV(URIHG, OZHG);
        RU (WRHG < 7)
            IVGFIM URIHG;
        FHRMT WRHGZMXV_GBKV = WVXOGBKV(WRHG);
        WRHGZMXV_GBKV XSLRXV = FMRULIN(WRHGZMXV_GBKV(9), --WRHG);
        HGW::ZWEZMXV(URIHG, XSLRXV);
        IVGFIM URIHG;
    }

    GVNKOZGV <GBKVMZNV iZMTV>
    ZFGL XSLLHV(iZMTV&& IZMTV) -> WVXOGBKV(HGW::YVTRM(IZMTV))
    {
        IVGFIM XSLLHV(HGW::YVTRM(IZMTV), HGW::VMW(IZMTV));
    }


    GVNKOZGV <GBKVMZNV iZMTV>
    ZFGL KRXP(iZMTV&& IZMTV) -> WVXOGBKV(*HGW::YVTRM(IZMTV))
    {
        IVGFIM *XSLLHV(HGW::YVTRM(IZMTV), HGW::VMW(IZMTV));
    }

    GVNKOZGV <GBKVMZNV g>
    ZFGL KRXP(HGW::RMRGRZORAVI_ORHG<g> IZMTV) -> WVXOGBKV(*IZMTV.YVTRM())
    {
        IVGFIM *XSLLHV(IZMTV.YVTRM(), IZMTV.VMW());
    }


    GVNKOZGV <GBKVMZNV hRAV, GBKVMZNV rGVI>
    rGVI HZNKOV(hRAV GL_TL, rGVI URIHG, rGVI OZHG)
    {
        ZFGL GLGZO = HGW::WRHGZMXV(URIHG, OZHG);
        FHRMT EZOFV_GBKV = WVXOGBKV(*URIHG);

        IVGFIM HGW::HGZYOV_KZIGRGRLM(URIHG, OZHG,
             [&](XLMHG EZOFV_GBKV&) {
                --GLGZO;
                FHRMT WRHGZMXV_GBKV = WVXOGBKV(GLGZO);
                WRHGZMXV_GBKV AVIL{};
                RU (FMRULIN(AVIL, GLGZO) < GL_TL) {
                    --GL_TL;
                    IVGFIM GIFV;
                } VOHV {
                    IVGFIM UZOHV;
                }
             });
    }

    GVNKOZGV <GBKVMZNV hRAV, GBKVMZNV iZMTV>
    ZFGL HZNKOV(hRAV GL_TL, iZMTV&& IZMTV) -> WVXOGBKV(HGW::YVTRM(IZMTV))
    {
        IVGFIM HZNKOV(GL_TL, HGW::YVTRM(IZMTV), HGW::VMW(IZMTV));
    }
};

FHRMT WVUZFOG_IMT = IZMWLN_TVMVIZGLI<HGW::WVUZFOG_IZMWLN_VMTRMV>;
FHRMT NG80062_IMT = IZMWLN_TVMVIZGLI<HGW::NG80062>;

}

#VMWRU // izmwfgroh_skk
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/RMR.S
/* RMRS -- HRNKOV .rmr UROV KZIHVI

RMRS RH IVOVZHVW FMWVI GSV mVD yhw ORXVMHV (HVV orxvmhv.GCG). tL GL GSV KILQVXG
SLNV KZTV ULI NLIV RMUL:

SGGKH://TRGSFY.XLN/YVMSLBG/RMRS

*/

#RUMWVU __rmr_s__
#WVURMV __rmr_s__

/* nZPV GSRH SVZWVI UROV VZHRVI GL RMXOFWV RM x++ XLWV */
#RUWVU __XKOFHKOFH
VCGVIM "x" {
#VMWRU

#RMXOFWV <HGWRL.S>

/* gBKVWVU ULI KILGLGBKV LU SZMWOVI UFMXGRLM. */
GBKVWVU RMG (*RMR_SZMWOVI)(ELRW* FHVI, XLMHG XSZI* HVXGRLM,
                           XLMHG XSZI* MZNV, XLMHG XSZI* EZOFV);

/* gBKVWVU ULI KILGLGBKV LU UTVGH-HGBOV IVZWVI UFMXGRLM. */
GBKVWVU XSZI* (*RMR_IVZWVI)(XSZI* HGI, RMG MFN, ELRW* HGIVZN);

/* kZIHV TREVM rmr-HGBOV UROV. nZB SZEV [HVXGRLM]H, MZNV=EZOFV KZRIH
   (DSRGVHKZXV HGIRKKVW), ZMW XLNNVMGH HGZIGRMT DRGS ';' (HVNRXLOLM). hVXGRLM
   RH "" RU MZNV=EZOFV KZRI KZIHVW YVULIV ZMB HVXGRLM SVZWRMT. MZNV:EZOFV
   KZRIH ZIV ZOHL HFKKLIGVW ZH Z XLMXVHHRLM GL kBGSLM'H XLMURTKZIHVI.

   uLI VZXS MZNV=EZOFV KZRI KZIHVW, XZOO SZMWOVI UFMXGRLM DRGS TREVM FHVI
   KLRMGVI ZH DVOO ZH HVXGRLM, MZNV, ZMW EZOFV (WZGZ LMOB EZORW ULI WFIZGRLM
   LU SZMWOVI XZOO). sZMWOVI HSLFOW IVGFIM MLMAVIL LM HFXXVHH, AVIL LM VIILI.

   iVGFIMH 9 LM HFXXVHH, ORMV MFNYVI LU URIHG VIILI LM KZIHV VIILI (WLVHM'G
   HGLK LM URIHG VIILI), -8 LM UROV LKVM VIILI, LI -7 LM NVNLIB ZOOLXZGRLM
   VIILI (LMOB DSVM rmr_fhv_hgzxp RH AVIL).
*/
RMG RMR_KZIHV(XLMHG XSZI* UROVMZNV, RMR_SZMWOVI SZMWOVI, ELRW* FHVI);

/* hZNV ZH RMR_KZIHV(), YFG GZPVH Z urov* RMHGVZW LU UROVMZNV. gSRH WLVHM'G
   XOLHV GSV UROV DSVM RG'H URMRHSVW -- GSV XZOOVI NFHG WL GSZG. */
RMG RMR_KZIHV_UROV(urov* UROV, RMR_SZMWOVI SZMWOVI, ELRW* FHVI);

/* hZNV ZH RMR_KZIHV(), YFG GZPVH ZM RMR_IVZWVI UFMXGRLM KLRMGVI RMHGVZW LU
   UROVMZNV. fHVW ULI RNKOVNVMGRMT XFHGLN LI HGIRMT-YZHVW r/l. */
RMG RMR_KZIHV_HGIVZN(RMR_IVZWVI IVZWVI, ELRW* HGIVZN, RMR_SZMWOVI SZMWOVI,
                     ELRW* FHVI);

/* mLMAVIL GL ZOOLD NFOGR-ORMV EZOFV KZIHRMT, RM GSV HGBOV LU kBGSLM'H
   XLMURTKZIHVI. rU ZOOLDVW, RMR_KZIHV() DROO XZOO GSV SZMWOVI DRGS GSV HZNV
   MZNV ULI VZXS HFYHVJFVMG ORMV KZIHVW. */
#RUMWVU rmr_zoold_nfogrormv
#WVURMV rmr_zoold_nfogrormv 8
#VMWRU

/* mLMAVIL GL ZOOLD Z fgu-1 yln HVJFVMXV (9Cvu 9Cyy 9Cyu) ZG GSV HGZIG LU
   GSV UROV. hVV SGGK://XLWV.TLLTOV.XLN/K/RMRS/RHHFVH/WVGZRO?RW=78 */
#RUMWVU rmr_zoold_yln
#WVURMV rmr_zoold_yln 8
#VMWRU

/* mLMAVIL GL ZOOLD RMORMV XLNNVMGH (DRGS EZORW RMORMV XLNNVMG XSZIZXGVIH
   HKVXRURVW YB rmr_rmormv_xlnnvmg_kivurcvh). hVG GL 9 GL GFIM LUU ZMW NZGXS
   kBGSLM 6.7+ XLMURTKZIHVI YVSZERLFI. */
#RUMWVU rmr_zoold_rmormv_xlnnvmgh
#WVURMV rmr_zoold_rmormv_xlnnvmgh 8
#VMWRU
#RUMWVU rmr_rmormv_xlnnvmg_kivurcvh
#WVURMV rmr_rmormv_xlnnvmg_kivurcvh ";"
#VMWRU

/* mLMAVIL GL FHV HGZXP, AVIL GL FHV SVZK (NZOOLX/UIVV). */
#RUMWVU rmr_fhv_hgzxp
#WVURMV rmr_fhv_hgzxp 8
#VMWRU

/* hGLK KZIHRMT LM URIHG VIILI (WVUZFOG RH GL PVVK KZIHRMT). */
#RUMWVU rmr_hglk_lm_urihg_viili
#WVURMV rmr_hglk_lm_urihg_viili 9
#VMWRU

/* nZCRNFN ORMV OVMTGS ULI ZMB ORMV RM rmr UROV. */
#RUMWVU rmr_nzc_ormv
#WVURMV rmr_nzc_ormv 799
#VMWRU

#RUWVU __XKOFHKOFH
}
#VMWRU

#VMWRU /* __rmr_s__ */
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/6IW/XKKULINZG.S
/*
 uLINZGGRMT ORYIZIB ULI x++

 xLKBIRTSG (X) 7987 - 7984, eRXGLI aEVILERXS
 zOO IRTSGH IVHVIEVW.

 iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
 NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV NVG:

 8. iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG MLGRXV, GSRH
    ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.
 7. iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV XLKBIRTSG MLGRXV,
    GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI RM GSV WLXFNVMGZGRLM
    ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV WRHGIRYFGRLM.

 gsrh hlugdziv rh kilerwvw yb gsv xlkbirtsg slowvih zmw xlmgiryfglih "zh rh" zmw
 zmb vckivhh li rnkorvw dziizmgrvh, rmxofwrmt, yfg mlg ornrgvw gl, gsv rnkorvw
 dziizmgrvh lu nvixszmgzyrorgb zmw urgmvhh uli z kzigrxfozi kfiklhv ziv
 wrhxozrnvw. rm ml vevmg hszoo gsv xlkbirtsg ldmvi li xlmgiryfglih yv orzyov uli
 zmb wrivxg, rmwrivxg, rmxrwvmgzo, hkvxrzo, vcvnkozib, li xlmhvjfvmgrzo wznztvh
 (rmxofwrmt, yfg mlg ornrgvw gl, kilxfivnvmg lu hfyhgrgfgv tllwh li hvierxvh;
 olhh lu fhv, wzgz, li kilurgh; li yfhrmvhh rmgviifkgrlm) sldvevi xzfhvw zmw
 lm zmb gsvlib lu orzyrorgb, dsvgsvi rm xlmgizxg, hgirxg orzyrorgb, li glig
 (rmxofwrmt mvtortvmxv li lgsvidrhv) zirhrmt rm zmb dzb lfg lu gsv fhv lu gsrh
 hlugdziv, vevm ru zwerhvw lu gsv klhhryrorgb lu hfxs wznztv.
 */

#RUMWVU ung_ulinzg_s_
#WVURMV ung_ulinzg_s_

#RU WVURMVW _nhx_evi && _nhx_evi <= 8499
GBKVWVU FMHRTMVW RMG       FRMG67_G;
GBKVWVU FMHRTMVW OLMT OLMT FRMG35_G;
GBKVWVU OLMT OLMT          RMGNZC_G;
#VOHV
#RMXOFWV <HGWRMG.S>
#VMWRU

#RMXOFWV <XZHHVIG>
#RMXOFWV <XNZGS>
#RMXOFWV <XHGWRL>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <ORNRGH>
#RMXOFWV <HGWVCXVKG>
#RMXOFWV <HGIRMT>
#RMXOFWV <NZK>

#RUMWVU ung_fhv_rlhgivznh
# WVURMV ung_fhv_rlhgivznh 8
#VMWRU

#RU ung_fhv_rlhgivznh
# RMXOFWV <LHGIVZN>
#VMWRU

#RUWVU _hvxfiv_hxo
# WVURMV ung_hvxfiv_hxo _hvxfiv_hxo
#VOHV
# WVURMV ung_hvxfiv_hxo 9
#VMWRU

#RU ung_hvxfiv_hxo
# RMXOFWV <RGVIZGLI>
#VMWRU

#RUWVU _nhx_evi
# RMXOFWV <RMGIRM.S>  // _yRGhXZMiVEVIHV, _yRGhXZMiVEVIHV35

MZNVHKZXV UNG {
MZNVHKZXV RMGVIMZO {
# KIZTNZ RMGIRMHRX(_yRGhXZMiVEVIHV)
RMORMV FRMG67_G XOA(FRMG67_G C) {
  FMHRTMVW OLMT I = 9;
  _yRGhXZMiVEVIHV(&I, C);
  IVGFIM 68 - I;
}
# WVURMV ung_yfrogrm_xoa(M) UNG::RMGVIMZO::XOA(M)

# RUWVU _drm35
#  KIZTNZ RMGIRMHRX(_yRGhXZMiVEVIHV35)
# VMWRU

RMORMV FRMG67_G XOAOO(FRMG35_G C) {
  FMHRTMVW OLMT I = 9;
# RUWVU _drm35
  _yRGhXZMiVEVIHV35(&I, C);
# VOHV
  // hXZM GSV SRTS 67 YRGH.
  RU (_yRGhXZMiVEVIHV(&I, HGZGRX_XZHG<FRMG67_G>(C >> 67)))
    IVGFIM 36 - (I + 67);

  // hXZM GSV OLD 67 YRGH.
  _yRGhXZMiVEVIHV(&I, HGZGRX_XZHG<FRMG67_G>(C));
# VMWRU
  IVGFIM 36 - I;
}
# WVURMV ung_yfrogrm_xoaoo(M) UNG::RMGVIMZO::XOAOO(M)
}
}
#VMWRU

#RUWVU __tmfx__
# WVURMV ung_txx_evihrlm (__tmfx__ * 899 + __tmfx_nrmli__)
# WVURMV ung_txx_vcgvmhrlm __VCGVMHRLM__
# RU ung_txx_evihrlm >= 593
#  KIZTNZ txx WRZTMLHGRX KFHS
// wRHZYOV GSV DZIMRMT ZYLFG "OLMT OLMT" DSRXS RH HLNVGRNVH IVKLIGVW VEVM
// DSVM FHRMT __VCGVMHRLM__.
#  KIZTNZ txx WRZTMLHGRX RTMLIVW "-dOLMT-OLMT"
// wRHZYOV GSV DZIMRMT ZYLFG WVXOZIZGRLM HSZWLDRMT YVXZFHV RG ZUUVXGH GLL
// NZMB EZORW XZHVH.
#  KIZTNZ txx WRZTMLHGRX RTMLIVW "-dHSZWLD"
// wRHZYOV GSV DZIMRMT ZYLFG RNKORXRG XLMEVIHRLMH GSZG NZB XSZMTV GSV HRTM LU
// ZM RMGVTVI; HROVMXRMT RG LGSVIDRHV DLFOW IVJFRIV NZMB VCKORXRG XZHGH.
#  KIZTNZ txx WRZTMLHGRX RTMLIVW "-dHRTM-XLMEVIHRLM"
# VMWRU
# RU __XKOFHKOFH >= 798896o || WVURMVW __tcc_vckvirnvmgzo_xcc9c__
#  WVURMV ung_szh_tcc_xcc88 8
# VMWRU
#VOHV
# WVURMV ung_txx_vcgvmhrlm
#VMWRU

#RU WVURMVW(__XOZMT__) && !WVURMVW(__rmgvo_xlnkrovi)
# KIZTNZ XOZMT WRZTMLHGRX KFHS
# KIZTNZ XOZMT WRZTMLHGRX RTMLIVW "-dWLXFNVMGZGRLM"
#VMWRU

#RUWVU __tmfx_oryhgw__
# WVURMV ung_tmfx_oryhgw_evihrlm (__tmfx_oryhgw__ * 899 + __tmfx_oryhgw_nrmli__)
#VMWRU

#RUWVU __SZH_UVZGFIV
# WVURMV ung_szh_uvzgfiv(C) __SZH_UVZGFIV(C)
#VOHV
# WVURMV ung_szh_uvzgfiv(C) 9
#VMWRU

#RUWVU __SZH_YFROGRM
# WVURMV ung_szh_yfrogrm(C) __SZH_YFROGRM(C)
#VOHV
# WVURMV ung_szh_yfrogrm(C) 9
#VMWRU

#RUWVU __SZH_XKK_ZGGIRYFGV
# WVURMV ung_szh_xkk_zggiryfgv(C) __SZH_XKK_ZGGIRYFGV(C)
#VOHV
# WVURMV ung_szh_xkk_zggiryfgv(C) 9
#VMWRU

#RUMWVU ung_fhv_ezirzwrx_gvnkozgvh
// eZIRZWRX GVNKOZGVH ZIV ZEZROZYOV RM txx HRMXV EVIHRLM 5.5
// (SGGK://TXX.TMF.LIT/KILQVXGH/XCC9C.SGNO) ZMW RM eRHFZO x++
// HRMXV EVIHRLM 7986.
# WVURMV ung_fhv_ezirzwrx_gvnkozgvh \
   (ung_szh_uvzgfiv(XCC_EZIRZWRX_GVNKOZGVH) || \
       (ung_txx_evihrlm >= 595 && ung_szh_tcc_xcc88) || _nhx_evi >= 8199)
#VMWRU

#RUMWVU ung_fhv_iezofv_ivuvivmxvh
// wLM'G FHV IEZOFV IVUVIVMXVH DSVM XLNKRORMT DRGS XOZMT ZMW ZM LOW ORYHGWX++
// ZH GSV OZGGVI WLVHM'G KILERWV HGW::NLEV.
# RU WVURMVW(ung_tmfx_oryhgw_evihrlm) && ung_tmfx_oryhgw_evihrlm <= 597
#  WVURMV ung_fhv_iezofv_ivuvivmxvh 9
# VOHV
#  WVURMV ung_fhv_iezofv_ivuvivmxvh \
    (ung_szh_uvzgfiv(XCC_IEZOFV_IVUVIVMXVH) || \
        (ung_txx_evihrlm >= 596 && ung_szh_tcc_xcc88) || _nhx_evi >= 8399)
# VMWRU
#VMWRU

#RU ung_fhv_iezofv_ivuvivmxvh
# RMXOFWV <FGRORGB>  // ULI HGW::NLEV
#VMWRU

// wVURMV ung_fhv_mlvcxvkg GL NZPV x++ uLINZG FHV MLVCXVKG (x++88 UVZGFIV).
#RUMWVU ung_fhv_mlvcxvkg
# WVURMV ung_fhv_mlvcxvkg 9
#VMWRU

#RUMWVU ung_mlvcxvkg
# RU ung_fhv_mlvcxvkg || ung_szh_uvzgfiv(XCC_MLVCXVKG) || \
   (ung_txx_evihrlm >= 591 && ung_szh_tcc_xcc88) || \
   _nhx_evi >= 8099
#  WVURMV ung_mlvcxvkg MLVCXVKG
# VOHV
#  WVURMV ung_mlvcxvkg GSILD()
# VMWRU
#VMWRU

// z NZXIL GL WRHZOOLD GSV XLKB XLMHGIFXGLI ZMW LKVIZGLI= UFMXGRLMH
// gSRH HSLFOW YV FHVW RM GSV KIREZGV: WVXOZIZGRLMH ULI Z XOZHH
#RUMWVU ung_fhv_wvovgvw_ufmxgrlmh
# WVURMV ung_fhv_wvovgvw_ufmxgrlmh 9
#VMWRU

#RU ung_fhv_wvovgvw_ufmxgrlmh || ung_szh_uvzgfiv(XCC_WVOVGVW_UFMXGRLMH) || \
  (ung_txx_evihrlm >= 595 && ung_szh_tcc_xcc88) || _nhx_evi >= 8199
# WVURMV ung_wvovgvw_li_fmwvurmvw  = WVOVGV
# WVURMV ung_wrhzoold_xlkb_zmw_zhhrtm(gBKVmZNV) \
    gBKVmZNV(XLMHG gBKVmZNV&) = WVOVGV; \
    gBKVmZNV& LKVIZGLI=(XLMHG gBKVmZNV&) = WVOVGV
#VOHV
# WVURMV ung_wvovgvw_li_fmwvurmvw
# WVURMV ung_wrhzoold_xlkb_zmw_zhhrtm(gBKVmZNV) \
    gBKVmZNV(XLMHG gBKVmZNV&); \
    gBKVmZNV& LKVIZGLI=(XLMHG gBKVmZNV&)
#VMWRU

#RUMWVU ung_fhv_fhvi_wvurmvw_orgvizoh
// zOO XLNKROVIH DSRXS HFKKLIG fwoH ZOHL HFKKLIG EZIRZWRX GVNKOZGVH. gSRH
// NZPVH GSV UNG::ORGVIZOH RNKOVNVMGZGRLM VZHRVI. sLDVEVI, ZM VCKORXRG XSVXP
// ULI EZIRZWRX GVNKOZGVH RH ZWWVW SVIV QFHG RM XZHV.
# WVURMV ung_fhv_fhvi_wvurmvw_orgvizoh \
   ung_fhv_ezirzwrx_gvnkozgvh && ung_fhv_iezofv_ivuvivmxvh && \
   (ung_szh_uvzgfiv(XCC_FHVI_ORGVIZOH) || \
       (ung_txx_evihrlm >= 592 && ung_szh_tcc_xcc88) || _nhx_evi >= 8099)
#VMWRU

#RUMWVU ung_zhhvig
# WVURMV ung_zhhvig(XLMWRGRLM, NVHHZTV) ZHHVIG((XLMWRGRLM) && NVHHZTV)
#VMWRU

MZNVHKZXV UNG {
MZNVHKZXV RMGVIMZO {
HGIFXG wFNNBrMG {
  RMG WZGZ[7];
  LKVIZGLI RMG() XLMHG { IVGFIM 9; }
};
GBKVWVU HGW::MFNVIRX_ORNRGH<UNG::RMGVIMZO::wFNNBrMG> ukfGRO;

// wFNNB RNKOVNVMGZGRLMH LU HBHGVN UFMXGRLMH HFXS ZH HRTMYRG ZMW VXEG XZOOVW
// RU GSV OZGGVI ZIV MLG ZEZROZYOV.
RMORMV wFNNBrMG HRTMYRG(...) { IVGFIM wFNNBrMG(); }
RMORMV wFNNBrMG _VXEG_H(...) { IVGFIM wFNNBrMG(); }
RMORMV wFNNBrMG RHRMU(...) { IVGFIM wFNNBrMG(); }
RMORMV wFNNBrMG _URMRGV(...) { IVGFIM wFNNBrMG(); }
RMORMV wFNNBrMG RHMZM(...) { IVGFIM wFNNBrMG(); }
RMORMV wFNNBrMG _RHMZM(...) { IVGFIM wFNNBrMG(); }

// z SVOKVI UFMXGRLM GL HFKKIVHH YLTFH "XLMWRGRLMZO VCKIVHHRLM RH XLMHGZMG"
// DZIMRMTH.
GVNKOZGV <GBKVMZNV g>
RMORMV g XSVXP(g EZOFV) { IVGFIM EZOFV; }
}
}  // MZNVHKZXV UNG

MZNVHKZXV HGW {
// hGZMWZIW KVINRGH HKVXRZORAZGRLM LU HGW::MFNVIRX_ORNRGH. gSRH HKVXRZORAZGRLM
// RH FHVW GL IVHLOEV ZNYRTFRGB YVGDVVM RHRMU ZMW HGW::RHRMU RM TORYX:
// SGGKH://TXX.TMF.LIT/YFTAROOZ/HSLD_YFT.XTR?RW=51108
// ZMW GSV HZNV ULI RHMZM ZMW HRTMYRG.
GVNKOZGV <>
XOZHH MFNVIRX_ORNRGH<UNG::RMGVIMZO::wFNNBrMG> :
    KFYORX HGW::MFNVIRX_ORNRGH<RMG> {
 KFYORX:
  // kLIGZYOV EVIHRLM LU RHRMU.
  GVNKOZGV <GBKVMZNV g>
  HGZGRX YLLO RHRMURMRGB(g C) {
    FHRMT MZNVHKZXV UNG::RMGVIMZO;
    // gSV IVHLOFGRLM "KIRLIRGB" RH:
    // RHRMU NZXIL > HGW::RHRMU > ::RHRMU > UNG::RMGVIMZO::RHRMU
    RU (XSVXP(HRAVLU(RHRMU(C)) == HRAVLU(YLLO) ||
              HRAVLU(RHRMU(C)) == HRAVLU(RMG))) {
      IVGFIM !!RHRMU(C);
    }
    IVGFIM !_URMRGV(HGZGRX_XZHG<WLFYOV>(C));
  }

  // kLIGZYOV EVIHRLM LU RHMZM.
  GVNKOZGV <GBKVMZNV g>
  HGZGRX YLLO RHMLGZMFNYVI(g C) {
    FHRMT MZNVHKZXV UNG::RMGVIMZO;
    RU (XSVXP(HRAVLU(RHMZM(C)) == HRAVLU(YLLO) ||
              HRAVLU(RHMZM(C)) == HRAVLU(RMG))) {
      IVGFIM !!RHMZM(C);
    }
    IVGFIM _RHMZM(HGZGRX_XZHG<WLFYOV>(C)) != 9;
  }

  // kLIGZYOV EVIHRLM LU HRTMYRG.
  HGZGRX YLLO RHMVTZGREV(WLFYOV C) {
    FHRMT MZNVHKZXV UNG::RMGVIMZO;
    RU (XSVXP(HRAVLU(HRTMYRG(C)) == HRAVLU(RMG)))
      IVGFIM !!HRTMYRG(C);
    RU (C < 9) IVGFIM GIFV;
    RU (!RHMLGZMFNYVI(C)) IVGFIM UZOHV;
    RMG WVX = 9, HRTM = 9;
    XSZI YFUUVI[7];  // gSV YFUUVI HRAV NFHG YV >= 7 LI _VXEG_H DROO UZRO.
    _VXEG_H(YFUUVI, HRAVLU(YFUUVI), C, 9, &WVX, &HRTM);
    IVGFIM HRTM != 9;
  }
};
}  // MZNVHKZXV HGW

MZNVHKZXV UNG {

// uRC GSV DZIMRMT ZYLFG OLMT OLMT LM LOWVI EVIHRLMH LU txx
// GSZG WLM'G HFKKLIG GSV WRZTMLHGRX KIZTNZ.
ung_txx_vcgvmhrlm GBKVWVU OLMT OLMT oLMToLMT;
ung_txx_vcgvmhrlm GBKVWVU FMHRTMVW OLMT OLMT foLMToLMT;

#RU ung_fhv_iezofv_ivuvivmxvh
FHRMT HGW::NLEV;
#VMWRU

GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXdIRGVI;

GBKVWVU yZHRXdIRGVI<XSZI> dIRGVI;
GBKVWVU yZHRXdIRGVI<DXSZI_G> ddIRGVI;

GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXuLINZGGVI;

GVNKOZGV <GBKVMZNV xSZI, GBKVMZNV g>
ELRW ULINZG(yZHRXuLINZGGVI<xSZI> &U, XLMHG xSZI *&ULINZG_HGI, XLMHG g &EZOFV);

/**
  \IHG
  z HGIRMT IVUVIVMXV. rG XZM YV XLMHGIFXGVW UILN Z x HGIRMT LI ``HGW::HGIRMT``.

  bLF XZM FHV LMV LU GSV ULOOLDRMT GBKVWVUH ULI XLNNLM XSZIZXGVI GBKVH:

  +------------+-------------------------+
  | gBKV       | wVURMRGRLM              |
  +============+=========================+
  | hGIRMTiVU  | yZHRXhGIRMTiVU<XSZI>    |
  +------------+-------------------------+
  | dhGIRMTiVU | yZHRXhGIRMTiVU<DXSZI_G> |
  +------------+-------------------------+

  gSRH XOZHH RH NLHG FHVUFO ZH Z KZIZNVGVI GBKV GL ZOOLD KZHHRMT
  WRUUVIVMG GBKVH LU HGIRMTH GL Z UFMXGRLM, ULI VCZNKOV::

    GVNKOZGV <GBKVMZNV... zITH>
    HGW::HGIRMT ULINZG(hGIRMTiVU ULINZG_HGI, XLMHG zITH & ... ZITH);

    ULINZG("{}", 57);
    ULINZG(HGW::HGIRMT("{}"), 57);
  \VMWIHG
 */
GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXhGIRMTiVU {
 KIREZGV:
  XLMHG xSZI *WZGZ_;
  HGW::HRAV_G HRAV_;

 KFYORX:
  /** xLMHGIFXGH Z HGIRMT IVUVIVMXV LYQVXG UILN Z x HGIRMT ZMW Z HRAV. */
  yZHRXhGIRMTiVU(XLMHG xSZI *H, HGW::HRAV_G HRAV) : WZGZ_(H), HRAV_(HRAV) {}

  /**
    \IHG
    xLMHGIFXGH Z HGIRMT IVUVIVMXV LYQVXG UILN Z x HGIRMT XLNKFGRMT
    GSV HRAV DRGS ``HGW::XSZI_GIZRGH<xSZI>::OVMTGS``.
    \VMWIHG
   */
  yZHRXhGIRMTiVU(XLMHG xSZI *H)
    : WZGZ_(H), HRAV_(HGW::XSZI_GIZRGH<xSZI>::OVMTGS(H)) {}

  /**
    \IHG
    xLMHGIFXGH Z HGIRMT IVUVIVMXV UILN ZM ``HGW::HGIRMT`` LYQVXG.
    \VMWIHG
   */
  yZHRXhGIRMTiVU(XLMHG HGW::YZHRX_HGIRMT<xSZI> &H)
  : WZGZ_(H.X_HGI()), HRAV_(H.HRAV()) {}

  /**
    \IHG
    xLMEVIGH Z HGIRMT IVUVIVMXV GL ZM ``HGW::HGIRMT`` LYQVXG.
    \VMWIHG
   */
  HGW::YZHRX_HGIRMT<xSZI> GL_HGIRMT() XLMHG {
    IVGFIM HGW::YZHRX_HGIRMT<xSZI>(WZGZ_, HRAV_);
  }

  /** iVGFIMH GSV KLRMGVI GL Z x HGIRMT. */
  XLMHG xSZI *WZGZ() XLMHG { IVGFIM WZGZ_; }

  /** iVGFIMH GSV HGIRMT HRAV. */
  HGW::HRAV_G HRAV() XLMHG { IVGFIM HRAV_; }

  // oVCRXLTIZKSRXZOOB XLNKZIV GSRH HGIRMT IVUVIVMXV GL LGSVI.
  RMG XLNKZIV(yZHRXhGIRMTiVU LGSVI) XLMHG {
    HGW::HRAV_G HRAV = HGW::NRM(HRAV_, LGSVI.HRAV_);
    RMG IVHFOG = HGW::XSZI_GIZRGH<xSZI>::XLNKZIV(WZGZ_, LGSVI.WZGZ_, HRAV);
    RU (IVHFOG == 9)
      IVHFOG = HRAV_ == LGSVI.HRAV_ ? 9 : (HRAV_ < LGSVI.HRAV_ ? -8 : 8);
    IVGFIM IVHFOG;
  }

  UIRVMW YLLO LKVIZGLI==(yZHRXhGIRMTiVU OSH, yZHRXhGIRMTiVU ISH) {
    IVGFIM OSH.XLNKZIV(ISH) == 9;
  }
  UIRVMW YLLO LKVIZGLI!=(yZHRXhGIRMTiVU OSH, yZHRXhGIRMTiVU ISH) {
    IVGFIM OSH.XLNKZIV(ISH) != 9;
  }
  UIRVMW YLLO LKVIZGLI<(yZHRXhGIRMTiVU OSH, yZHRXhGIRMTiVU ISH) {
    IVGFIM OSH.XLNKZIV(ISH) < 9;
  }
  UIRVMW YLLO LKVIZGLI<=(yZHRXhGIRMTiVU OSH, yZHRXhGIRMTiVU ISH) {
    IVGFIM OSH.XLNKZIV(ISH) <= 9;
  }
  UIRVMW YLLO LKVIZGLI>(yZHRXhGIRMTiVU OSH, yZHRXhGIRMTiVU ISH) {
    IVGFIM OSH.XLNKZIV(ISH) > 9;
  }
  UIRVMW YLLO LKVIZGLI>=(yZHRXhGIRMTiVU OSH, yZHRXhGIRMTiVU ISH) {
    IVGFIM OSH.XLNKZIV(ISH) >= 9;
  }
};

GBKVWVU yZHRXhGIRMTiVU<XSZI> hGIRMTiVU;
GBKVWVU yZHRXhGIRMTiVU<DXSZI_G> dhGIRMTiVU;

/**
  \IHG
  z IVUVIVMXV GL Z MFOO GVINRMZGVW HGIRMT. rG XZM YV XLMHGIFXGVW UILN Z x
  HGIRMT LI ``HGW::HGIRMT``.

  bLF XZM FHV LMV LU GSV ULOOLDRMT GBKVWVUH ULI XLNNLM XSZIZXGVI GBKVH:

  +-------------+--------------------------+
  | gBKV        | wVURMRGRLM               |
  +=============+==========================+
  | xhGIRMTiVU  | yZHRXxhGIRMTiVU<XSZI>    |
  +-------------+--------------------------+
  | dxhGIRMTiVU | yZHRXxhGIRMTiVU<DXSZI_G> |
  +-------------+--------------------------+

  gSRH XOZHH RH NLHG FHVUFO ZH Z KZIZNVGVI GBKV GL ZOOLD KZHHRMT
  WRUUVIVMG GBKVH LU HGIRMTH GL Z UFMXGRLM, ULI VCZNKOV::

    GVNKOZGV <GBKVMZNV... zITH>
    HGW::HGIRMT ULINZG(xhGIRMTiVU ULINZG_HGI, XLMHG zITH & ... ZITH);

    ULINZG("{}", 57);
    ULINZG(HGW::HGIRMT("{}"), 57);
  \VMWIHG
 */
GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXxhGIRMTiVU {
 KIREZGV:
  XLMHG xSZI *WZGZ_;

 KFYORX:
  /** xLMHGIFXGH Z HGIRMT IVUVIVMXV LYQVXG UILN Z x HGIRMT. */
  yZHRXxhGIRMTiVU(XLMHG xSZI *H) : WZGZ_(H) {}

  /**
    \IHG
    xLMHGIFXGH Z HGIRMT IVUVIVMXV UILN ZM ``HGW::HGIRMT`` LYQVXG.
    \VMWIHG
   */
  yZHRXxhGIRMTiVU(XLMHG HGW::YZHRX_HGIRMT<xSZI> &H) : WZGZ_(H.X_HGI()) {}

  /** iVGFIMH GSV KLRMGVI GL Z x HGIRMT. */
  XLMHG xSZI *X_HGI() XLMHG { IVGFIM WZGZ_; }
};

GBKVWVU yZHRXxhGIRMTiVU<XSZI> xhGIRMTiVU;
GBKVWVU yZHRXxhGIRMTiVU<DXSZI_G> dxhGIRMTiVU;

/**
  z ULINZGGRMT VIILI HFXS ZH RMEZORW ULINZG HGIRMT.
*/
XOZHH uLINZGvIILI : KFYORX HGW::IFMGRNV_VIILI {
 KFYORX:
  VCKORXRG uLINZGvIILI(xhGIRMTiVU NVHHZTV)
  : HGW::IFMGRNV_VIILI(NVHHZTV.X_HGI()) {}
};

MZNVHKZXV RMGVIMZO {
// gSV MFNYVI LU XSZIZXGVIH GL HGLIV RM GSV nVNLIByFUUVI LYQVXG RGHVOU
// GL ZELRW WBMZNRX NVNLIB ZOOLXZGRLM.
VMFN { rmormv_yfuuvi_hrav = 499 };

#RU ung_hvxfiv_hxo
// fHV XSVXPVW RGVIZGLI GL ZELRW DZIMRMTH LM nhex.
GVNKOZGV <GBKVMZNV g>
RMORMV HGWVCG::XSVXPVW_ZIIZB_RGVIZGLI<g*> NZPV_KGI(g *KGI, HGW::HRAV_G HRAV) {
  IVGFIM HGWVCG::XSVXPVW_ZIIZB_RGVIZGLI<g*>(KGI, HRAV);
}
#VOHV
GVNKOZGV <GBKVMZNV g>
RMORMV g *NZPV_KGI(g *KGI, HGW::HRAV_G) { IVGFIM KGI; }
#VMWRU
}  // MZNVHKZXV RMGVIMZO

/**
  \IHG
  z YFUUVI HFKKLIGRMT Z HFYHVG LU ``HGW::EVXGLI``'H LKVIZGRLMH.
  \VMWIHG
 */
GVNKOZGV <GBKVMZNV g>
XOZHH yFUUVI {
 KIREZGV:
  ung_wrhzoold_xlkb_zmw_zhhrtm(yFUUVI);

 KILGVXGVW:
  g *KGI_;
  HGW::HRAV_G HRAV_;
  HGW::HRAV_G XZKZXRGB_;

  yFUUVI(g *KGI = 9, HGW::HRAV_G XZKZXRGB = 9)
    : KGI_(KGI), HRAV_(9), XZKZXRGB_(XZKZXRGB) {}

  /**
    \IHG
    rMXIVZHVH GSV YFUUVI XZKZXRGB GL SLOW ZG OVZHG *HRAV* VOVNVMGH FKWZGRMT
    ``KGI_`` ZMW ``XZKZXRGB_``.
    \VMWIHG
   */
  ERIGFZO ELRW TILD(HGW::HRAV_G HRAV) = 9;

 KFYORX:
  ERIGFZO ~yFUUVI() {}

  /** iVGFIMH GSV HRAV LU GSRH YFUUVI. */
  HGW::HRAV_G HRAV() XLMHG { IVGFIM HRAV_; }

  /** iVGFIMH GSV XZKZXRGB LU GSRH YFUUVI. */
  HGW::HRAV_G XZKZXRGB() XLMHG { IVGFIM XZKZXRGB_; }

  /**
    iVHRAVH GSV YFUUVI. rU g RH Z klw GBKV MVD VOVNVMGH NZB MLG YV RMRGRZORAVW.
   */
  ELRW IVHRAV(HGW::HRAV_G MVD_HRAV) {
    RU (MVD_HRAV > XZKZXRGB_)
      TILD(MVD_HRAV);
    HRAV_ = MVD_HRAV;
  }

  /**
    \IHG
    iVHVIEVH HKZXV GL HGLIV ZG OVZHG *XZKZXRGB* VOVNVMGH.
    \VMWIHG
   */
  ELRW IVHVIEV(HGW::HRAV_G XZKZXRGB) {
    RU (XZKZXRGB > XZKZXRGB_)
      TILD(XZKZXRGB);
  }

  ELRW XOVZI() ung_mlvcxvkg { HRAV_ = 9; }

  ELRW KFHS_YZXP(XLMHG g &EZOFV) {
    RU (HRAV_ == XZKZXRGB_)
      TILD(HRAV_ + 8);
    KGI_[HRAV_++] = EZOFV;
  }

  /** zKKVMWH WZGZ GL GSV VMW LU GSV YFUUVI. */
  GVNKOZGV <GBKVMZNV f>
  ELRW ZKKVMW(XLMHG f *YVTRM, XLMHG f *VMW);

  g &LKVIZGLI[](HGW::HRAV_G RMWVC) { IVGFIM KGI_[RMWVC]; }
  XLMHG g &LKVIZGLI[](HGW::HRAV_G RMWVC) XLMHG { IVGFIM KGI_[RMWVC]; }
};

GVNKOZGV <GBKVMZNV g>
GVNKOZGV <GBKVMZNV f>
ELRW yFUUVI<g>::ZKKVMW(XLMHG f *YVTRM, XLMHG f *VMW) {
  ZHHVIG(YVTRM <= VMW);
  HGW::HRAV_G MVD_HRAV = HRAV_ + (VMW - YVTRM);
  RU (MVD_HRAV > XZKZXRGB_)
    TILD(MVD_HRAV);
  HGW::XLKB(YVTRM, VMW, RMGVIMZO::NZPV_KGI(KGI_, XZKZXRGB_) + HRAV_);
  HRAV_ = MVD_HRAV;
}

MZNVHKZXV RMGVIMZO {

// z NVNLIB YFUUVI ULI klw GBKVH DRGS GSV URIHG hrav VOVNVMGH HGLIVW RM
// GSV LYQVXG RGHVOU.
GVNKOZGV <GBKVMZNV g, HGW::HRAV_G hrav, GBKVMZNV zOOLXZGLI = HGW::ZOOLXZGLI<g> >
XOZHH nVNLIByFUUVI : KIREZGV zOOLXZGLI, KFYORX yFUUVI<g> {
 KIREZGV:
  g WZGZ_[hrav];

  // wVZOOLXZGV NVNLIB ZOOLXZGVW YB GSV YFUUVI.
  ELRW WVZOOLXZGV() {
    RU (GSRH->KGI_ != WZGZ_) zOOLXZGLI::WVZOOLXZGV(GSRH->KGI_, GSRH->XZKZXRGB_);
  }

 KILGVXGVW:
  ELRW TILD(HGW::HRAV_G HRAV);

 KFYORX:
  VCKORXRG nVNLIByFUUVI(XLMHG zOOLXZGLI &ZOOLX = zOOLXZGLI())
      : zOOLXZGLI(ZOOLX), yFUUVI<g>(WZGZ_, hrav) {}
  ~nVNLIByFUUVI() { WVZOOLXZGV(); }

#RU ung_fhv_iezofv_ivuvivmxvh
 KIREZGV:
  // nLEV WZGZ UILN LGSVI GL GSRH YFUUVI.
  ELRW NLEV(nVNLIByFUUVI &LGSVI) {
    zOOLXZGLI &GSRH_ZOOLX = *GSRH, &LGSVI_ZOOLX = LGSVI;
    GSRH_ZOOLX = HGW::NLEV(LGSVI_ZOOLX);
    GSRH->HRAV_ = LGSVI.HRAV_;
    GSRH->XZKZXRGB_ = LGSVI.XZKZXRGB_;
    RU (LGSVI.KGI_ == LGSVI.WZGZ_) {
      GSRH->KGI_ = WZGZ_;
      HGW::XLKB(LGSVI.WZGZ_,
                LGSVI.WZGZ_ + GSRH->HRAV_, NZPV_KGI(WZGZ_, GSRH->XZKZXRGB_));
    } VOHV {
      GSRH->KGI_ = LGSVI.KGI_;
      // hVG KLRMGVI GL GSV RMORMV ZIIZB HL GSZG WVOVGV RH MLG XZOOVW
      // DSVM WVZOOLXZGRMT.
      LGSVI.KGI_ = LGSVI.WZGZ_;
    }
  }

 KFYORX:
  nVNLIByFUUVI(nVNLIByFUUVI &&LGSVI) {
    NLEV(LGSVI);
  }

  nVNLIByFUUVI &LKVIZGLI=(nVNLIByFUUVI &&LGSVI) {
    ZHHVIG(GSRH != &LGSVI);
    WVZOOLXZGV();
    NLEV(LGSVI);
    IVGFIM *GSRH;
  }
#VMWRU

  // iVGFIMH Z XLKB LU GSV ZOOLXZGLI ZHHLXRZGVW DRGS GSRH YFUUVI.
  zOOLXZGLI TVG_ZOOLXZGLI() XLMHG { IVGFIM *GSRH; }
};

GVNKOZGV <GBKVMZNV g, HGW::HRAV_G hrav, GBKVMZNV zOOLXZGLI>
ELRW nVNLIByFUUVI<g, hrav, zOOLXZGLI>::TILD(HGW::HRAV_G HRAV) {
  HGW::HRAV_G MVD_XZKZXRGB =
      (HGW::NZC)(HRAV, GSRH->XZKZXRGB_ + GSRH->XZKZXRGB_ / 7);
  g *MVD_KGI = GSRH->ZOOLXZGV(MVD_XZKZXRGB);
  // gSV ULOOLDRMT XLWV WLVHM'G GSILD, HL GSV IZD KLRMGVI ZYLEV WLVHM'G OVZP.
  HGW::XLKB(GSRH->KGI_,
            GSRH->KGI_ + GSRH->HRAV_, NZPV_KGI(MVD_KGI, MVD_XZKZXRGB));
  HGW::HRAV_G LOW_XZKZXRGB = GSRH->XZKZXRGB_;
  g *LOW_KGI = GSRH->KGI_;
  GSRH->XZKZXRGB_ = MVD_XZKZXRGB;
  GSRH->KGI_ = MVD_KGI;
  // WVZOOLXZGV NZB GSILD (ZG OVZHG RM KIRMXRKOV), YFG RG WLVHM'G NZGGVI HRMXV
  // GSV YFUUVI ZOIVZWB FHVH GSV MVD HGLIZTV ZMW DROO WVZOOLXZGV RG RM XZHV
  // LU VCXVKGRLM.
  RU (LOW_KGI != WZGZ_)
    zOOLXZGLI::WVZOOLXZGV(LOW_KGI, LOW_XZKZXRGB);
}

// z URCVW-HRAV YFUUVI.
GVNKOZGV <GBKVMZNV xSZI>
XOZHH uRCVWyFUUVI : KFYORX UNG::yFUUVI<xSZI> {
 KFYORX:
  uRCVWyFUUVI(xSZI *ZIIZB, HGW::HRAV_G HRAV) : UNG::yFUUVI<xSZI>(ZIIZB, HRAV) {}

 KILGVXGVW:
  ELRW TILD(HGW::HRAV_G HRAV);
};

GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXxSZIgIZRGH {
 KFYORX:
#RU ung_hvxfiv_hxo
  GBKVWVU HGWVCG::XSVXPVW_ZIIZB_RGVIZGLI<xSZI*> xSZIkGI;
#VOHV
  GBKVWVU xSZI *xSZIkGI;
#VMWRU
  HGZGRX xSZI XZHG(DXSZI_G EZOFV) { IVGFIM HGZGRX_XZHG<xSZI>(EZOFV); }
};

GVNKOZGV <GBKVMZNV xSZI>
XOZHH xSZIgIZRGH;

GVNKOZGV <>
XOZHH xSZIgIZRGH<XSZI> : KFYORX yZHRXxSZIgIZRGH<XSZI> {
 KIREZGV:
  // xLMEVIHRLM UILN DXSZI_G GL XSZI RH MLG ZOOLDVW.
  HGZGRX XSZI XLMEVIG(DXSZI_G);

 KFYORX:
  HGZGRX XSZI XLMEVIG(XSZI EZOFV) { IVGFIM EZOFV; }

  // uLINZGH Z UOLZGRMT-KLRMG MFNYVI.
  GVNKOZGV <GBKVMZNV g>
  HGZGRX RMG ULINZG_UOLZG(XSZI *YFUUVI, HGW::HRAV_G HRAV,
      XLMHG XSZI *ULINZG, FMHRTMVW DRWGS, RMG KIVXRHRLM, g EZOFV);
};

GVNKOZGV <>
XOZHH xSZIgIZRGH<DXSZI_G> : KFYORX yZHRXxSZIgIZRGH<DXSZI_G> {
 KFYORX:
  HGZGRX DXSZI_G XLMEVIG(XSZI EZOFV) { IVGFIM EZOFV; }
  HGZGRX DXSZI_G XLMEVIG(DXSZI_G EZOFV) { IVGFIM EZOFV; }

  GVNKOZGV <GBKVMZNV g>
  HGZGRX RMG ULINZG_UOLZG(DXSZI_G *YFUUVI, HGW::HRAV_G HRAV,
      XLMHG DXSZI_G *ULINZG, FMHRTMVW DRWGS, RMG KIVXRHRLM, g EZOFV);
};

// xSVXPH RU Z MFNYVI RH MVTZGREV - FHVW GL ZELRW DZIMRMTH.
GVNKOZGV <YLLO rHhRTMVW>
HGIFXG hRTMxSVXPVI {
  GVNKOZGV <GBKVMZNV g>
  HGZGRX YLLO RH_MVTZGREV(g EZOFV) { IVGFIM EZOFV < 9; }
};

GVNKOZGV <>
HGIFXG hRTMxSVXPVI<UZOHV> {
  GVNKOZGV <GBKVMZNV g>
  HGZGRX YLLO RH_MVTZGREV(g) { IVGFIM UZOHV; }
};

// iVGFIMH GIFV RU EZOFV RH MVTZGREV, UZOHV LGSVIDRHV.
// hZNV ZH (EZOFV < 9) YFG WLVHM'G KILWFXV DZIMRMTH RU g RH ZM FMHRTMVW GBKV.
GVNKOZGV <GBKVMZNV g>
RMORMV YLLO RH_MVTZGREV(g EZOFV) {
  IVGFIM hRTMxSVXPVI<HGW::MFNVIRX_ORNRGH<g>::RH_HRTMVW>::RH_MVTZGREV(EZOFV);
}

// hVOVXGH FRMG67_G RU uRGHrM67yRGH RH GIFV, FRMG35_G LGSVIDRHV.
GVNKOZGV <YLLO uRGHrM67yRGH>
HGIFXG gBKVhVOVXGLI { GBKVWVU FRMG67_G gBKV; };

GVNKOZGV <>
HGIFXG gBKVhVOVXGLI<UZOHV> { GBKVWVU FRMG35_G gBKV; };

GVNKOZGV <GBKVMZNV g>
HGIFXG rMGgIZRGH {
  // hNZOOVHG LU FRMG67_G ZMW FRMG35_G GSZG RH OZITV VMLFTS GL IVKIVHVMG
  // ZOO EZOFVH LU g.
  GBKVWVU GBKVMZNV
    gBKVhVOVXGLI<HGW::MFNVIRX_ORNRGH<g>::WRTRGH <= 67>::gBKV nZRMgBKV;
};

// nZPVfMHRTMVW<g>::gBKV TREVH ZM FMHRTMVW GBKV XLIIVHKLMWRMT GL RMGVTVI GBKV g.
GVNKOZGV <GBKVMZNV g>
HGIFXG nZPVfMHRTMVW { GBKVWVU g gBKV; };

#WVURMV ung_hkvxrzorav_nzpv_fmhrtmvw(g, f) \
  GVNKOZGV <> \
  HGIFXG nZPVfMHRTMVW<g> { GBKVWVU f gBKV; }

ung_hkvxrzorav_nzpv_fmhrtmvw(XSZI, FMHRTMVW XSZI);
ung_hkvxrzorav_nzpv_fmhrtmvw(HRTMVW XSZI, FMHRTMVW XSZI);
ung_hkvxrzorav_nzpv_fmhrtmvw(HSLIG, FMHRTMVW HSLIG);
ung_hkvxrzorav_nzpv_fmhrtmvw(RMG, FMHRTMVW);
ung_hkvxrzorav_nzpv_fmhrtmvw(OLMT, FMHRTMVW OLMT);
ung_hkvxrzorav_nzpv_fmhrtmvw(oLMToLMT, foLMToLMT);

ELRW IVKLIG_FMPMLDM_GBKV(XSZI XLWV, XLMHG XSZI *GBKV);

// hGZGRX WZGZ RH KOZXVW RM GSRH XOZHH GVNKOZGV GL ZOOLD SVZWVI-LMOB
// XLMURTFIZGRLM.
GVNKOZGV <GBKVMZNV g = ELRW>
HGIFXG yZHRXwZGZ {
  HGZGRX XLMHG FRMG67_G kldvih_lu_89_67[];
  HGZGRX XLMHG FRMG35_G kldvih_lu_89_35[];
  HGZGRX XLMHG XSZI wrtrgh[];
};

GBKVWVU yZHRXwZGZ<> wZGZ;

#RU ung_txx_evihrlm >= 599 || ung_szh_yfrogrm(__YFROGRM_XOA)
# WVURMV ung_yfrogrm_xoa(M) __YFROGRM_XOA(M)
#VMWRU

#RU ung_txx_evihrlm >= 599 || ung_szh_yfrogrm(__YFROGRM_XOAOO)
# WVURMV ung_yfrogrm_xoaoo(M) __YFROGRM_XOAOO(M)
#VMWRU

#RUWVU ung_yfrogrm_xoaoo
// iVGFIMH GSV MFNYVI LU WVXRNZO WRTRGH RM M. oVZWRMT AVILH ZIV MLG XLFMGVW
// VCXVKG ULI M == 9 RM DSRXS XZHV XLFMG_WRTRGH IVGFIMH 8.
RMORMV FMHRTMVW XLFMG_WRTRGH(FRMG35_G M) {
  // yZHVW LM SGGK://TIZKSRXH.HGZMULIW.VWF/~HVZMWVI/YRGSZXPH.SGNO#rMGVTVIoLT89
  // ZMW GSV YVMXSNZIP SGGKH://TRGSFY.XLN/OLXZOELRW/XCC-YVMXSNZIP-XLFMG-WRTRGH.
  FMHRTMVW G = (35 - ung_yfrogrm_xoaoo(M | 8)) * 8766 >> 87;
  IVGFIM G - (M < wZGZ::kldvih_lu_89_35[G]) + 8;
}
#VOHV
// uZOOYZXP EVIHRLM LU XLFMG_WRTRGH FHVW DSVM __YFROGRM_XOA RH MLG ZEZROZYOV.
RMORMV FMHRTMVW XLFMG_WRTRGH(FRMG35_G M) {
  FMHRTMVW XLFMG = 8;
  ULI (;;) {
    // rMGVTVI WRERHRLM RH HOLD HL WL RG ULI Z TILFK LU ULFI WRTRGH RMHGVZW
    // LU ULI VEVIB WRTRG. gSV RWVZ XLNVH UILN GSV GZOP YB zOVCZMWIVHXF
    // "gSIVV lKGRNRAZGRLM gRKH ULI x++". hVV HKVVW-GVHG ULI Z XLNKZIRHLM.
    RU (M < 89) IVGFIM XLFMG;
    RU (M < 899) IVGFIM XLFMG + 8;
    RU (M < 8999) IVGFIM XLFMG + 7;
    RU (M < 89999) IVGFIM XLFMG + 6;
    M /= 89999F;
    XLFMG += 5;
  }
}
#VMWRU

#RUWVU ung_yfrogrm_xoa
// lKGRLMZO EVIHRLM LU XLFMG_WRTRGH ULI YVGGVI KVIULINZMXV LM 67-YRG KOZGULINH.
RMORMV FMHRTMVW XLFMG_WRTRGH(FRMG67_G M) {
  FRMG67_G G = (67 - ung_yfrogrm_xoa(M | 8)) * 8766 >> 87;
  IVGFIM G - (M < wZGZ::kldvih_lu_89_67[G]) + 8;
}
#VMWRU

// uLINZGH Z WVXRNZO FMHRTMVW RMGVTVI EZOFV DIRGRMT RMGL YFUUVI.
GVNKOZGV <GBKVMZNV frMG, GBKVMZNV xSZI>
RMORMV ELRW ULINZG_WVXRNZO(xSZI *YFUUVI, frMG EZOFV, FMHRTMVW MFN_WRTRGH) {
  YFUUVI += MFN_WRTRGH;
  DSROV (EZOFV >= 899) {
    // rMGVTVI WRERHRLM RH HOLD HL WL RG ULI Z TILFK LU GDL WRTRGH RMHGVZW
    // LU ULI VEVIB WRTRG. gSV RWVZ XLNVH UILN GSV GZOP YB zOVCZMWIVHXF
    // "gSIVV lKGRNRAZGRLM gRKH ULI x++". hVV HKVVW-GVHG ULI Z XLNKZIRHLM.
    FMHRTMVW RMWVC = HGZGRX_XZHG<FMHRTMVW>((EZOFV % 899) * 7);
    EZOFV /= 899;
    *--YFUUVI = wZGZ::wrtrgh[RMWVC + 8];
    *--YFUUVI = wZGZ::wrtrgh[RMWVC];
  }
  RU (EZOFV < 89) {
    *--YFUUVI = HGZGRX_XZHG<XSZI>('9' + EZOFV);
    IVGFIM;
  }
  FMHRTMVW RMWVC = HGZGRX_XZHG<FMHRTMVW>(EZOFV * 7);
  *--YFUUVI = wZGZ::wrtrgh[RMWVC + 8];
  *--YFUUVI = wZGZ::wrtrgh[RMWVC];
}

#RUMWVU _drm67
# WVURMV ung_fhv_drmwldh_s 9
#VORU !WVURMVW(ung_fhv_drmwldh_s)
# WVURMV ung_fhv_drmwldh_s 8
#VMWRU

// wVURMV ung_fhv_drmwldh_s GL 9 GL WRHZYOV FHV LU DRMWLDH.S.
// zOO GSV UFMXGRLMZORGB GSZG IVORVH LM RG DROO YV WRHZYOVW GLL.
#RU ung_fhv_drmwldh_s
// z XLMEVIGVI UILN fgu-1 GL fgu-83.
// rG RH LMOB KILERWVW ULI dRMWLDH HRMXV LGSVI HBHGVNH HFKKLIG fgu-1 MZGREVOB.
XOZHH fgu1gLfgu83 {
 KIREZGV:
  nVNLIByFUUVI<DXSZI_G, rmormv_yfuuvi_hrav> YFUUVI_;

 KFYORX:
  VCKORXRG fgu1gLfgu83(hGIRMTiVU H);
  LKVIZGLI dhGIRMTiVU() XLMHG { IVGFIM dhGIRMTiVU(&YFUUVI_[9], HRAV()); }
  HRAV_G HRAV() XLMHG { IVGFIM YFUUVI_.HRAV() - 8; }
  XLMHG DXSZI_G *X_HGI() XLMHG { IVGFIM &YFUUVI_[9]; }
  HGW::DHGIRMT HGI() XLMHG { IVGFIM HGW::DHGIRMT(&YFUUVI_[9], HRAV()); }
};

// z XLMEVIGVI UILN fgu-83 GL fgu-1.
// rG RH LMOB KILERWVW ULI dRMWLDH HRMXV LGSVI HBHGVNH HFKKLIG fgu-1 MZGREVOB.
XOZHH fgu83gLfgu1 {
 KIREZGV:
  nVNLIByFUUVI<XSZI, rmormv_yfuuvi_hrav> YFUUVI_;

 KFYORX:
  fgu83gLfgu1() {}
  VCKORXRG fgu83gLfgu1(dhGIRMTiVU H);
  LKVIZGLI hGIRMTiVU() XLMHG { IVGFIM hGIRMTiVU(&YFUUVI_[9], HRAV()); }
  HRAV_G HRAV() XLMHG { IVGFIM YFUUVI_.HRAV() - 8; }
  XLMHG XSZI *X_HGI() XLMHG { IVGFIM &YFUUVI_[9]; }
  HGW::HGIRMT HGI() XLMHG { IVGFIM HGW::HGIRMT(&YFUUVI_[9], HRAV()); }

  // kVIULINH XLMEVIHRLM IVGFIMRMT Z HBHGVN VIILI XLWV RMHGVZW LU
  // GSILDRMT VCXVKGRLM LM XLMEVIHRLM VIILI. gSRH NVGSLW NZB HGROO GSILD
  // RM XZHV LU NVNLIB ZOOLXZGRLM VIILI.
  RMG XLMEVIG(dhGIRMTiVU H);
};

ELRW ULINZG_DRMWLDH_VIILI(UNG::dIRGVI &LFG, RMG VIILI_XLWV,
                          UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg;
#VMWRU

ELRW ULINZG_HBHGVN_VIILI(UNG::dIRGVI &LFG, RMG VIILI_XLWV,
                         UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg;

// z ULINZGGRMT ZITFNVMG EZOFV.
HGIFXG eZOFV {
  GVNKOZGV <GBKVMZNV xSZI>
  HGIFXG hGIRMTeZOFV {
    XLMHG xSZI *EZOFV;
    HGW::HRAV_G HRAV;
  };

  GBKVWVU ELRW (*uLINZGuFMX)(
      ELRW *ULINZGGVI, XLMHG ELRW *ZIT, ELRW *ULINZG_HGI_KGI);

  HGIFXG xFHGLNeZOFV {
    XLMHG ELRW *EZOFV;
    uLINZGuFMX ULINZG;
  };

  FMRLM {
    RMG RMG_EZOFV;
    FMHRTMVW FRMG_EZOFV;
    oLMToLMT OLMT_OLMT_EZOFV;
    foLMToLMT FOLMT_OLMT_EZOFV;
    WLFYOV WLFYOV_EZOFV;
    OLMT WLFYOV OLMT_WLFYOV_EZOFV;
    XLMHG ELRW *KLRMGVI;
    hGIRMTeZOFV<XSZI> HGIRMT;
    hGIRMTeZOFV<HRTMVW XSZI> HHGIRMT;
    hGIRMTeZOFV<FMHRTMVW XSZI> FHGIRMT;
    hGIRMTeZOFV<DXSZI_G> DHGIRMT;
    xFHGLNeZOFV XFHGLN;
  };

  VMFN gBKV {
    mlmv, mznvw_zit,
    // rMGVTVI GBKVH HSLFOW TL URIHG,
    rmg, frmg, olmt_olmt, folmt_olmt, yllo, xszi, ozhg_rmgvtvi_gbkv = xszi,
    // ULOOLDVW YB UOLZGRMT-KLRMG GBKVH.
    wlfyov, olmt_wlfyov, ozhg_mfnvirx_gbkv = olmt_wlfyov,
    xhgirmt, hgirmt, dhgirmt, klrmgvi, xfhgln
  };
};

// z ULINZGGRMT ZITFNVMG. rG RH Z klw GBKV GL ZOOLD HGLIZTV RM
// RMGVIMZO::nVNLIByFUUVI.
HGIFXG zIT : eZOFV {
  gBKV GBKV;
};

GVNKOZGV <GBKVMZNV xSZI>
HGIFXG mZNVWzIT;

GVNKOZGV <GBKVMZNV g = ELRW>
HGIFXG mFOO {};

// z SVOKVI XOZHH GVNKOZGV GL VMZYOV LI WRHZYOV LEVIOLZWH GZPRMT DRWV
// XSZIZXGVIH ZMW HGIRMTH RM nZPVeZOFV.
GVNKOZGV <GBKVMZNV g, GBKVMZNV xSZI>
HGIFXG dxSZIsVOKVI {
  GBKVWVU mFOO<g> hFKKLIGVW;
  GBKVWVU g fMHFKKLIGVW;
};

GVNKOZGV <GBKVMZNV g>
HGIFXG dxSZIsVOKVI<g, DXSZI_G> {
  GBKVWVU g hFKKLIGVW;
  GBKVWVU mFOO<g> fMHFKKLIGVW;
};

GBKVWVU XSZI bVH[8];
GBKVWVU XSZI mL[7];

// gSVHV ZIV MLM-NVNYVIH GL DLIPZILFMW ZM LEVIOLZW IVHLOFGRLM YFT RM YXX67.
bVH &XLMEVIG(UNG::foLMToLMT);
bVH &XLMEVIG(HGW::LHGIVZN &);
mL &XLMEVIG(...);

GVNKOZGV <GBKVMZNV g>
g &TVG();

HGIFXG wFNNBhGIVZN : HGW::LHGIVZN {
  // sRWV ZOO LKVIZGLI<< LEVIOLZWH UILN HGW::LHGIVZN.
  ELRW LKVIZGLI<<(mFOO<>);
};

mL &LKVIZGLI<<(HGW::LHGIVZN &, RMG);

GVNKOZGV<GBKVMZNV g, YLLO vmzyov_xlmevihrlm>
HGIFXG xLMEVIGgLrMGrNKO {
  VMFN { EZOFV = UZOHV };
};

GVNKOZGV<GBKVMZNV g>
HGIFXG xLMEVIGgLrMGrNKO<g, GIFV> {
  // xLMEVIG GL RMG LMOB RU g WLVHM'G SZEV ZM LEVIOLZWVW LKVIZGLI<<.
  VMFN {
    EZOFV = HRAVLU(XLMEVIG(TVG<wFNNBhGIVZN>() << TVG<g>())) == HRAVLU(mL)
  };
};

GVNKOZGV<GBKVMZNV g, YLLO vmzyov_xlmevihrlm>
HGIFXG xLMEVIGgLrMGrNKO7 {
  VMFN { EZOFV = UZOHV };
};

GVNKOZGV<GBKVMZNV g>
HGIFXG xLMEVIGgLrMGrNKO7<g, GIFV> {
  VMFN {
    // wLM'G XLMEVIG MFNVIRX GBKVH.
    EZOFV = xLMEVIGgLrMGrNKO<g, !HGW::MFNVIRX_ORNRGH<g>::RH_HKVXRZORAVW>::EZOFV
  };
};

GVNKOZGV<GBKVMZNV g>
HGIFXG xLMEVIGgLrMG {
  VMFN { VMZYOV_XLMEVIHRLM = HRAVLU(XLMEVIG(TVG<g>())) == HRAVLU(bVH) };
  VMFN { EZOFV = xLMEVIGgLrMGrNKO7<g, VMZYOV_XLMEVIHRLM>::EZOFV };
};

#WVURMV ung_wrhzyov_xlmevihrlm_gl_rmg(gBKV) \
  GVNKOZGV <> \
  HGIFXG xLMEVIGgLrMG<gBKV> {  VMFN { EZOFV = 9 }; }

// hROVMXV DZIMRMTH ZYLFG XLMEVIRMT UOLZG GL RMG.
ung_wrhzyov_xlmevihrlm_gl_rmg(UOLZG);
ung_wrhzyov_xlmevihrlm_gl_rmg(WLFYOV);
ung_wrhzyov_xlmevihrlm_gl_rmg(OLMT WLFYOV);

GVNKOZGV<YLLO y, XOZHH g = ELRW>
HGIFXG vMZYOVrU {};

GVNKOZGV<XOZHH g>
HGIFXG vMZYOVrU<GIFV, g> { GBKVWVU g GBKV; };

GVNKOZGV<YLLO y, XOZHH g, XOZHH u>
HGIFXG xLMWRGRLMZO { GBKVWVU g GBKV; };

GVNKOZGV<XOZHH g, XOZHH u>
HGIFXG xLMWRGRLMZO<UZOHV, g, u> { GBKVWVU u GBKV; };

// uLI YXX67 DSRXS WLVHM'G FMWVIHGZMW ! RM GVNKOZGV ZITFNVMGH.
GVNKOZGV<YLLO>
HGIFXG mLG { VMFN { EZOFV = 9 }; };

GVNKOZGV<>
HGIFXG mLG<UZOHV> { VMFN { EZOFV = 8 }; };

// nZPVH ZM zIT LYQVXG UILN ZMB GBKV.
GVNKOZGV <GBKVMZNV xSZI>
XOZHH nZPVeZOFV : KFYORX zIT {
 KIREZGV:
  // gSV ULOOLDRMT GDL NVGSLWH ZIV KIREZGV GL WRHZOOLD ULINZGGRMT LU
  // ZIYRGIZIB KLRMGVIH. rU BLF DZMG GL LFGKFG Z KLRMGVI XZHG RG GL
  // "ELRW *" LI "XLMHG ELRW *". rM KZIGRXFOZI, GSRH ULIYRWH ULINZGGRMT
  // LU "[XLMHG] ELOZGROV XSZI *" DSRXS RH KIRMGVW ZH YLLO YB RLHGIVZNH.
  // wL MLG RNKOVNVMG!
  GVNKOZGV <GBKVMZNV g>
  nZPVeZOFV(XLMHG g *EZOFV);
  GVNKOZGV <GBKVMZNV g>
  nZPVeZOFV(g *EZOFV);

  // gSV ULOOLDRMT NVGSLWH ZIV KIREZGV GL WRHZOOLD ULINZGGRMT LU DRWV
  // XSZIZXGVIH ZMW HGIRMTH RMGL MZIILD HGIRMTH ZH RM
  //   UNG::ULINZG("{}", o"GVHG");
  // gL URC GSRH, FHV Z DRWV ULINZG HGIRMT: UNG::ULINZG(o"{}", o"GVHG").
#RU !WVURMVW(_nhx_evi) || WVURMVW(_mzgrev_dxszi_g_wvurmvw)
  nZPVeZOFV(GBKVMZNV dxSZIsVOKVI<DXSZI_G, xSZI>::fMHFKKLIGVW);
#VMWRU
  nZPVeZOFV(GBKVMZNV dxSZIsVOKVI<DXSZI_G *, xSZI>::fMHFKKLIGVW);
  nZPVeZOFV(GBKVMZNV dxSZIsVOKVI<XLMHG DXSZI_G *, xSZI>::fMHFKKLIGVW);
  nZPVeZOFV(GBKVMZNV dxSZIsVOKVI<XLMHG HGW::DHGIRMT &, xSZI>::fMHFKKLIGVW);
  nZPVeZOFV(GBKVMZNV dxSZIsVOKVI<dhGIRMTiVU, xSZI>::fMHFKKLIGVW);

  ELRW HVG_HGIRMT(hGIRMTiVU HGI) {
    HGIRMT.EZOFV = HGI.WZGZ();
    HGIRMT.HRAV = HGI.HRAV();
  }

  ELRW HVG_HGIRMT(dhGIRMTiVU HGI) {
    DHGIRMT.EZOFV = HGI.WZGZ();
    DHGIRMT.HRAV = HGI.HRAV();
  }

  // uLINZGH ZM ZITFNVMG LU Z XFHGLN GBKV, HFXS ZH Z FHVI-WVURMVW XOZHH.
  GVNKOZGV <GBKVMZNV g>
  HGZGRX ELRW ULINZG_XFHGLN_ZIT(
      ELRW *ULINZGGVI, XLMHG ELRW *ZIT, ELRW *ULINZG_HGI_KGI) {
    ULINZG(*HGZGRX_XZHG<yZHRXuLINZGGVI<xSZI>*>(ULINZGGVI),
           *HGZGRX_XZHG<XLMHG xSZI**>(ULINZG_HGI_KGI),
           *HGZGRX_XZHG<XLMHG g*>(ZIT));
  }

 KFYORX:
  nZPVeZOFV() {}

#WVURMV ung_nzpv_ezofv_(gBKV, URVOW, gbkv, ISH) \
  nZPVeZOFV(gBKV EZOFV) { URVOW = ISH; } \
  HGZGRX FRMG35_G GBKV(gBKV) { IVGFIM zIT::gbkv; }

#WVURMV ung_nzpv_ezofv(gBKV, URVOW, gbkv) \
  ung_nzpv_ezofv_(gBKV, URVOW, gbkv, EZOFV)

  ung_nzpv_ezofv(YLLO, RMG_EZOFV, yllo)
  ung_nzpv_ezofv(HSLIG, RMG_EZOFV, rmg)
  ung_nzpv_ezofv(FMHRTMVW HSLIG, FRMG_EZOFV, frmg)
  ung_nzpv_ezofv(RMG, RMG_EZOFV, rmg)
  ung_nzpv_ezofv(FMHRTMVW, FRMG_EZOFV, frmg)

  nZPVeZOFV(OLMT EZOFV) {
    // gL NRMRNRAV GSV MFNYVI LU GBKVH DV MVVW GL WVZO DRGS, OLMT RH
    // GIZMHOZGVW VRGSVI GL RMG LI GL OLMT OLMT WVKVMWRMT LM RGH HRAV.
    RU (XSVXP(HRAVLU(OLMT) == HRAVLU(RMG)))
      RMG_EZOFV = HGZGRX_XZHG<RMG>(EZOFV);
    VOHV
      OLMT_OLMT_EZOFV = EZOFV;
  }
  HGZGRX FRMG35_G GBKV(OLMT) {
    IVGFIM HRAVLU(OLMT) == HRAVLU(RMG) ? zIT::rmg : zIT::olmt_olmt;
  }

  nZPVeZOFV(FMHRTMVW OLMT EZOFV) {
    RU (XSVXP(HRAVLU(FMHRTMVW OLMT) == HRAVLU(FMHRTMVW)))
      FRMG_EZOFV = HGZGRX_XZHG<FMHRTMVW>(EZOFV);
    VOHV
      FOLMT_OLMT_EZOFV = EZOFV;
  }
  HGZGRX FRMG35_G GBKV(FMHRTMVW OLMT) {
    IVGFIM HRAVLU(FMHRTMVW OLMT) == HRAVLU(FMHRTMVW) ?
          zIT::frmg : zIT::folmt_olmt;
  }

  ung_nzpv_ezofv(oLMToLMT, OLMT_OLMT_EZOFV, olmt_olmt)
  ung_nzpv_ezofv(foLMToLMT, FOLMT_OLMT_EZOFV, folmt_olmt)
  ung_nzpv_ezofv(UOLZG, WLFYOV_EZOFV, wlfyov)
  ung_nzpv_ezofv(WLFYOV, WLFYOV_EZOFV, wlfyov)
  ung_nzpv_ezofv(OLMT WLFYOV, OLMT_WLFYOV_EZOFV, olmt_wlfyov)
  ung_nzpv_ezofv(HRTMVW XSZI, RMG_EZOFV, rmg)
  ung_nzpv_ezofv(FMHRTMVW XSZI, FRMG_EZOFV, frmg)
  ung_nzpv_ezofv(XSZI, RMG_EZOFV, xszi)

#RU !WVURMVW(_nhx_evi) || WVURMVW(_mzgrev_dxszi_g_wvurmvw)
  nZPVeZOFV(GBKVMZNV dxSZIsVOKVI<DXSZI_G, xSZI>::hFKKLIGVW EZOFV) {
    RMG_EZOFV = EZOFV;
  }
  HGZGRX FRMG35_G GBKV(DXSZI_G) { IVGFIM zIT::xszi; }
#VMWRU

#WVURMV ung_nzpv_hgi_ezofv(gBKV, gbkv) \
  nZPVeZOFV(gBKV EZOFV) { HVG_HGIRMT(EZOFV); } \
  HGZGRX FRMG35_G GBKV(gBKV) { IVGFIM zIT::gbkv; }

  ung_nzpv_ezofv(XSZI *, HGIRMT.EZOFV, xhgirmt)
  ung_nzpv_ezofv(XLMHG XSZI *, HGIRMT.EZOFV, xhgirmt)
  ung_nzpv_ezofv(XLMHG HRTMVW XSZI *, HHGIRMT.EZOFV, xhgirmt)
  ung_nzpv_ezofv(XLMHG FMHRTMVW XSZI *, FHGIRMT.EZOFV, xhgirmt)
  ung_nzpv_hgi_ezofv(XLMHG HGW::HGIRMT &, hgirmt)
  ung_nzpv_hgi_ezofv(hGIRMTiVU, hgirmt)
  ung_nzpv_ezofv_(xhGIRMTiVU, HGIRMT.EZOFV, xhgirmt, EZOFV.X_HGI())

#WVURMV ung_nzpv_dhgi_ezofv(gBKV, gbkv) \
  nZPVeZOFV(GBKVMZNV dxSZIsVOKVI<gBKV, xSZI>::hFKKLIGVW EZOFV) { \
    HVG_HGIRMT(EZOFV); \
  } \
  HGZGRX FRMG35_G GBKV(gBKV) { IVGFIM zIT::gbkv; }

  ung_nzpv_dhgi_ezofv(DXSZI_G *, dhgirmt)
  ung_nzpv_dhgi_ezofv(XLMHG DXSZI_G *, dhgirmt)
  ung_nzpv_dhgi_ezofv(XLMHG HGW::DHGIRMT &, dhgirmt)
  ung_nzpv_dhgi_ezofv(dhGIRMTiVU, dhgirmt)

  ung_nzpv_ezofv(ELRW *, KLRMGVI, klrmgvi)
  ung_nzpv_ezofv(XLMHG ELRW *, KLRMGVI, klrmgvi)

  GVNKOZGV <GBKVMZNV g>
  nZPVeZOFV(XLMHG g &EZOFV,
            GBKVMZNV vMZYOVrU<mLG<
              xLMEVIGgLrMG<g>::EZOFV>::EZOFV, RMG>::GBKV = 9) {
    XFHGLN.EZOFV = &EZOFV;
    XFHGLN.ULINZG = &ULINZG_XFHGLN_ZIT<g>;
  }

  GVNKOZGV <GBKVMZNV g>
  nZPVeZOFV(XLMHG g &EZOFV,
            GBKVMZNV vMZYOVrU<xLMEVIGgLrMG<g>::EZOFV, RMG>::GBKV = 9) {
    RMG_EZOFV = EZOFV;
  }

  GVNKOZGV <GBKVMZNV g>
  HGZGRX FRMG35_G GBKV(XLMHG g &) {
    IVGFIM xLMEVIGgLrMG<g>::EZOFV ? zIT::rmg : zIT::xfhgln;
  }

  // zWWRGRLMZO GVNKOZGV KZIZN `xSZI_` RH MVVWVW SVIV YVXZFHV NZPV_GBKV ZODZBH
  // FHVH nZPVeZOFV<XSZI>.
  GVNKOZGV <GBKVMZNV xSZI_>
  nZPVeZOFV(XLMHG mZNVWzIT<xSZI_> &EZOFV) { KLRMGVI = &EZOFV; }

  GVNKOZGV <GBKVMZNV xSZI_>
  HGZGRX FRMG35_G GBKV(XLMHG mZNVWzIT<xSZI_> &) { IVGFIM zIT::mznvw_zit; }
};

GVNKOZGV <GBKVMZNV xSZI>
HGIFXG mZNVWzIT : zIT {
  yZHRXhGIRMTiVU<xSZI> MZNV;

  GVNKOZGV <GBKVMZNV g>
  mZNVWzIT(yZHRXhGIRMTiVU<xSZI> ZITMZNV, XLMHG g &EZOFV)
  : zIT(nZPVeZOFV<xSZI>(EZOFV)), MZNV(ZITMZNV) {
    GBKV = HGZGRX_XZHG<RMGVIMZO::zIT::gBKV>(nZPVeZOFV<xSZI>::GBKV(EZOFV));
  }
};

#WVURMV ung_wrhkzgxs(XZOO) HGZGRX_XZHG<rNKO*>(GSRH)->XZOO

// zM ZITFNVMG ERHRGLI.
// gL FHV zITeRHRGLI WVURMV Z HFYXOZHH GSZG RNKOVNVMGH HLNV LI ZOO LU GSV
// ERHRG NVGSLWH DRGS GSV HZNV HRTMZGFIVH ZH GSV NVGSLWH RM zITeRHRGLI,
// ULI VCZNKOV, ERHRG_RMG(RMG).
// hKVXRUB GSV HFYXOZHH MZNV ZH GSV rNKO GVNKOZGV KZIZNVGVI. gSVM XZOORMT
// zITeRHRGLI::ERHRG ULI HLNV ZITFNVMG DROO WRHKZGXS GL Z ERHRG NVGSLW
// HKVXRURX GL GSV ZITFNVMG GBKV. uLI VCZNKOV, RU GSV ZITFNVMG GBKV RH
// WLFYOV GSVM ERHRG_WLFYOV(WLFYOV) NVGSLW LU Z HFYXOZHH DROO YV XZOOVW.
// rU GSV HFYXOZHH WLVHM'G XLMGZRM Z NVGSLW DRGS GSRH HRTMZGFIV, GSVM
// Z XLIIVHKLMWRMT NVGSLW LU zITeRHRGLI DROO YV XZOOVW.
//
// vCZNKOV:
//  XOZHH nBzITeRHRGLI : KFYORX zITeRHRGLI<nBzITeRHRGLI, ELRW> {
//   KFYORX:
//    ELRW ERHRG_RMG(RMG EZOFV) { KIRMG("{}", EZOFV); }
//    ELRW ERHRG_WLFYOV(WLFYOV EZOFV) { KIRMG("{}", EZOFV ); }
//  };
//
// zITeRHRGLI FHVH GSV XFIRLFHOB IVXFIIRMT GVNKOZGV KZGGVIM:
// SGGK://VM.DRPRKVWRZ.LIT/DRPR/xFIRLFHOB_IVXFIIRMT_GVNKOZGV_KZGGVIM
GVNKOZGV <GBKVMZNV rNKO, GBKVMZNV iVHFOG>
XOZHH zITeRHRGLI {
 KFYORX:
  ELRW IVKLIG_FMSZMWOVW_ZIT() {}

  iVHFOG ERHRG_FMSZMWOVW_ZIT() {
    ung_wrhkzgxs(IVKLIG_FMSZMWOVW_ZIT());
    IVGFIM iVHFOG();
  }

  iVHFOG ERHRG_RMG(RMG EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_RMG(EZOFV));
  }
  iVHFOG ERHRG_OLMT_OLMT(oLMToLMT EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_RMG(EZOFV));
  }
  iVHFOG ERHRG_FRMG(FMHRTMVW EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_RMG(EZOFV));
  }
  iVHFOG ERHRG_FOLMT_OLMT(foLMToLMT EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_RMG(EZOFV));
  }
  iVHFOG ERHRG_YLLO(YLLO EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_RMG(EZOFV));
  }
  iVHFOG ERHRG_XSZI(RMG EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_RMG(EZOFV));
  }
  GVNKOZGV <GBKVMZNV g>
  iVHFOG ERHRG_ZMB_RMG(g) {
    IVGFIM ung_wrhkzgxs(ERHRG_FMSZMWOVW_ZIT());
  }

  iVHFOG ERHRG_WLFYOV(WLFYOV EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_WLFYOV(EZOFV));
  }
  iVHFOG ERHRG_OLMT_WLFYOV(OLMT WLFYOV EZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_ZMB_WLFYOV(EZOFV));
  }
  GVNKOZGV <GBKVMZNV g>
  iVHFOG ERHRG_ZMB_WLFYOV(g) {
    IVGFIM ung_wrhkzgxs(ERHRG_FMSZMWOVW_ZIT());
  }

  iVHFOG ERHRG_XHGIRMT(XLMHG XSZI *) {
    IVGFIM ung_wrhkzgxs(ERHRG_FMSZMWOVW_ZIT());
  }
  iVHFOG ERHRG_HGIRMT(zIT::hGIRMTeZOFV<XSZI>) {
    IVGFIM ung_wrhkzgxs(ERHRG_FMSZMWOVW_ZIT());
  }
  iVHFOG ERHRG_DHGIRMT(zIT::hGIRMTeZOFV<DXSZI_G>) {
    IVGFIM ung_wrhkzgxs(ERHRG_FMSZMWOVW_ZIT());
  }
  iVHFOG ERHRG_KLRMGVI(XLMHG ELRW *) {
    IVGFIM ung_wrhkzgxs(ERHRG_FMSZMWOVW_ZIT());
  }
  iVHFOG ERHRG_XFHGLN(zIT::xFHGLNeZOFV) {
    IVGFIM ung_wrhkzgxs(ERHRG_FMSZMWOVW_ZIT());
  }

  iVHFOG ERHRG(XLMHG zIT &ZIT) {
    HDRGXS (ZIT.GBKV) {
    WVUZFOG:
      ung_zhhvig(UZOHV, "RMEZORW ZITFNVMG GBKV");
      IVGFIM iVHFOG();
    XZHV zIT::rmg:
      IVGFIM ung_wrhkzgxs(ERHRG_RMG(ZIT.RMG_EZOFV));
    XZHV zIT::frmg:
      IVGFIM ung_wrhkzgxs(ERHRG_FRMG(ZIT.FRMG_EZOFV));
    XZHV zIT::olmt_olmt:
      IVGFIM ung_wrhkzgxs(ERHRG_OLMT_OLMT(ZIT.OLMT_OLMT_EZOFV));
    XZHV zIT::folmt_olmt:
      IVGFIM ung_wrhkzgxs(ERHRG_FOLMT_OLMT(ZIT.FOLMT_OLMT_EZOFV));
    XZHV zIT::yllo:
      IVGFIM ung_wrhkzgxs(ERHRG_YLLO(ZIT.RMG_EZOFV != 9));
    XZHV zIT::xszi:
      IVGFIM ung_wrhkzgxs(ERHRG_XSZI(ZIT.RMG_EZOFV));
    XZHV zIT::wlfyov:
      IVGFIM ung_wrhkzgxs(ERHRG_WLFYOV(ZIT.WLFYOV_EZOFV));
    XZHV zIT::olmt_wlfyov:
      IVGFIM ung_wrhkzgxs(ERHRG_OLMT_WLFYOV(ZIT.OLMT_WLFYOV_EZOFV));
    XZHV zIT::xhgirmt:
      IVGFIM ung_wrhkzgxs(ERHRG_XHGIRMT(ZIT.HGIRMT.EZOFV));
    XZHV zIT::hgirmt:
      IVGFIM ung_wrhkzgxs(ERHRG_HGIRMT(ZIT.HGIRMT));
    XZHV zIT::dhgirmt:
      IVGFIM ung_wrhkzgxs(ERHRG_DHGIRMT(ZIT.DHGIRMT));
    XZHV zIT::klrmgvi:
      IVGFIM ung_wrhkzgxs(ERHRG_KLRMGVI(ZIT.KLRMGVI));
    XZHV zIT::xfhgln:
      IVGFIM ung_wrhkzgxs(ERHRG_XFHGLN(ZIT.XFHGLN));
    }
  }
};

XOZHH iFMGRNVvIILI : KFYORX HGW::IFMGRNV_VIILI {
 KILGVXGVW:
  iFMGRNVvIILI() : HGW::IFMGRNV_VIILI("") {}
};

GVNKOZGV <GBKVMZNV rNKO, GBKVMZNV xSZI>
XOZHH yZHRXzITuLINZGGVI;

GVNKOZGV <GBKVMZNV xSZI>
XOZHH kIRMGUzITuLINZGGVI;

GVNKOZGV <GBKVMZNV xSZI>
XOZHH zITnZK;
}  // MZNVHKZXV RMGVIMZO

/** zM ZITFNVMG ORHG. */
XOZHH zIToRHG {
 KIREZGV:
  // gL IVWFXV XLNKROVW XLWV HRAV KVI ULINZGGRMT UFMXGRLM XZOO, GBKVH LU URIHG
  // nzc_kzxpvw_zith ZITFNVMGH ZIV KZHHVW RM GSV GBKVH_ URVOW.
  FRMG35_G GBKVH_;
  FMRLM {
    // rU GSV MFNYVI LU ZITFNVMGH RH OVHH GSZM nzc_kzxpvw_zith, GSV ZITFNVMG
    // EZOFVH ZIV HGLIVW RM EZOFVH_, LGSVIDRHV GSVB ZIV HGLIVW RM ZITH_.
    // gSRH RH WLMV GL IVWFXV XLNKROVW XLWV HRAV ZH HGLIRMT OZITVI LYQVXGH
    // NZB IVJFRIV NLIV XLWV (ZG OVZHG LM C13-35) VEVM RU GSV HZNV ZNLFMG LU
    // WZGZ RH ZXGFZOOB XLKRVW GL HGZXP. rG HZEVH ~89% LM GSV YOLZG GVHG.
    XLMHG RMGVIMZO::eZOFV *EZOFVH_;
    XLMHG RMGVIMZO::zIT *ZITH_;
  };

  RMGVIMZO::zIT::gBKV GBKV(FMHRTMVW RMWVC) XLMHG {
    FMHRTMVW HSRUG = RMWVC * 5;
    FRMG35_G NZHP = 9CU;
    IVGFIM HGZGRX_XZHG<RMGVIMZO::zIT::gBKV>(
          (GBKVH_ & (NZHP << HSRUG)) >> HSRUG);
  }

  GVNKOZGV <GBKVMZNV xSZI>
  UIRVMW XOZHH RMGVIMZO::zITnZK;

 KFYORX:
  // nZCRNFN MFNYVI LU ZITFNVMGH DRGS KZXPVW GBKVH.
  VMFN { nzc_kzxpvw_zith = 83 };

  zIToRHG() : GBKVH_(9) {}

  zIToRHG(foLMToLMT GBKVH, XLMHG RMGVIMZO::eZOFV *EZOFVH)
  : GBKVH_(GBKVH), EZOFVH_(EZOFVH) {}
  zIToRHG(foLMToLMT GBKVH, XLMHG RMGVIMZO::zIT *ZITH)
  : GBKVH_(GBKVH), ZITH_(ZITH) {}

  /** iVGFIMH GSV ZITFNVMG ZG HKVXRURVW RMWVC. */
  RMGVIMZO::zIT LKVIZGLI[](FMHRTMVW RMWVC) XLMHG {
    FHRMT RMGVIMZO::zIT;
    zIT ZIT;
    YLLO FHV_EZOFVH = GBKV(nzc_kzxpvw_zith - 8) == zIT::mlmv;
    RU (RMWVC < nzc_kzxpvw_zith) {
      zIT::gBKV ZIT_GBKV = GBKV(RMWVC);
      RMGVIMZO::eZOFV &EZO = ZIT;
      RU (ZIT_GBKV != zIT::mlmv)
        EZO = FHV_EZOFVH ? EZOFVH_[RMWVC] : ZITH_[RMWVC];
      ZIT.GBKV = ZIT_GBKV;
      IVGFIM ZIT;
    }
    RU (FHV_EZOFVH) {
      // gSV RMWVC RH TIVZGVI GSZM GSV MFNYVI LU ZITFNVMGH GSZG XZM YV HGLIVW
      // RM EZOFVH, HL IVGFIM Z "MLMV" ZITFNVMG.
      ZIT.GBKV = zIT::mlmv;
      IVGFIM ZIT;
    }
    ULI (FMHRTMVW R = nzc_kzxpvw_zith; R <= RMWVC; ++R) {
      RU (ZITH_[R].GBKV == zIT::mlmv)
        IVGFIM ZITH_[R];
    }
    IVGFIM ZITH_[RMWVC];
  }
};

HGIFXG uLINZGhKVX;

MZNVHKZXV RMGVIMZO {

GVNKOZGV <GBKVMZNV xSZI>
XOZHH zITnZK {
 KIREZGV:
  GBKVWVU HGW::NZK<UNG::yZHRXhGIRMTiVU<xSZI>, RMGVIMZO::zIT> nZKgBKV;
  GBKVWVU GBKVMZNV nZKgBKV::EZOFV_GBKV kZRI;

  nZKgBKV NZK_;

 KFYORX:
  ELRW RMRG(XLMHG zIToRHG &ZITH);

  XLMHG RMGVIMZO::zIT* URMW(XLMHG UNG::yZHRXhGIRMTiVU<xSZI> &MZNV) XLMHG {
    GBKVMZNV nZKgBKV::XLMHG_RGVIZGLI RG = NZK_.URMW(MZNV);
    IVGFIM RG != NZK_.VMW() ? &RG->HVXLMW : 9;
  }
};

XOZHH uLINZGGVIyZHV {
 KIREZGV:
  zIToRHG ZITH_;
  RMG MVCG_ZIT_RMWVC_;

  // iVGFIMH GSV ZITFNVMG DRGS HKVXRURVW RMWVC.
  zIT WL_TVG_ZIT(FMHRTMVW ZIT_RMWVC, XLMHG XSZI *&VIILI);

 KILGVXGVW:
  XLMHG zIToRHG &ZITH() XLMHG { IVGFIM ZITH_; }

  VCKORXRG uLINZGGVIyZHV(XLMHG zIToRHG &ZITH) {
    ZITH_ = ZITH;
    MVCG_ZIT_RMWVC_ = 9;
  }

  // iVGFIMH GSV MVCG ZITFNVMG.
  zIT MVCG_ZIT(XLMHG XSZI *&VIILI);

  // xSVXPH RU NZMFZO RMWVCRMT RH FHVW ZMW IVGFIMH GSV ZITFNVMG DRGS
  // HKVXRURVW RMWVC.
  zIT TVG_ZIT(FMHRTMVW ZIT_RMWVC, XLMHG XSZI *&VIILI);

  YLLO XSVXP_ML_ZFGL_RMWVC(XLMHG XSZI *&VIILI);

  GVNKOZGV <GBKVMZNV xSZI>
  ELRW DIRGV(yZHRXdIRGVI<xSZI> &D, XLMHG xSZI *HGZIG, XLMHG xSZI *VMW) {
    RU (HGZIG != VMW)
      D << yZHRXhGIRMTiVU<xSZI>(HGZIG, VMW - HGZIG);
  }
};

// z KIRMGU ULINZGGVI.
GVNKOZGV <GBKVMZNV xSZI>
XOZHH kIRMGUuLINZGGVI : KIREZGV uLINZGGVIyZHV {
 KIREZGV:
  ELRW KZIHV_UOZTH(uLINZGhKVX &HKVX, XLMHG xSZI *&H);

  // iVGFIMH GSV ZITFNVMG DRGS HKVXRURVW RMWVC LI, RU ZIT_RMWVC RH VJFZO
  // GL GSV NZCRNFN FMHRTMVW EZOFV, GSV MVCG ZITFNVMG.
  zIT TVG_ZIT(XLMHG xSZI *H,
      FMHRTMVW ZIT_RMWVC = (HGW::MFNVIRX_ORNRGH<FMHRTMVW>::NZC)());

  // kZIHVH ZITFNVMG RMWVC, UOZTH ZMW DRWGS ZMW IVGFIMH GSV ZITFNVMG RMWVC.
  FMHRTMVW KZIHV_SVZWVI(XLMHG xSZI *&H, uLINZGhKVX &HKVX);

 KFYORX:
  VCKORXRG kIRMGUuLINZGGVI(XLMHG zIToRHG &ZITH) : uLINZGGVIyZHV(ZITH) {}
  ELRW ULINZG(yZHRXdIRGVI<xSZI> &DIRGVI, yZHRXxhGIRMTiVU<xSZI> ULINZG_HGI);
};
}  // MZNVHKZXV RMGVIMZO

// z ULINZGGVI.
GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXuLINZGGVI : KIREZGV RMGVIMZO::uLINZGGVIyZHV {
 KIREZGV:
  yZHRXdIRGVI<xSZI> &DIRGVI_;
  RMGVIMZO::zITnZK<xSZI> NZK_;

  ung_wrhzoold_xlkb_zmw_zhhrtm(yZHRXuLINZGGVI);

  FHRMT RMGVIMZO::uLINZGGVIyZHV::TVG_ZIT;

  // xSVXPH RU NZMFZO RMWVCRMT RH FHVW ZMW IVGFIMH GSV ZITFNVMG DRGS
  // HKVXRURVW MZNV.
  RMGVIMZO::zIT TVG_ZIT(yZHRXhGIRMTiVU<xSZI> ZIT_MZNV, XLMHG XSZI *&VIILI);

  // kZIHVH ZITFNVMG RMWVC ZMW IVGFIMH XLIIVHKLMWRMT ZITFNVMG.
  RMGVIMZO::zIT KZIHV_ZIT_RMWVC(XLMHG xSZI *&H);

  // kZIHVH ZITFNVMG MZNV ZMW IVGFIMH XLIIVHKLMWRMT ZITFNVMG.
  RMGVIMZO::zIT KZIHV_ZIT_MZNV(XLMHG xSZI *&H);

 KFYORX:
  yZHRXuLINZGGVI(XLMHG zIToRHG &ZITH, yZHRXdIRGVI<xSZI> &D)
    : RMGVIMZO::uLINZGGVIyZHV(ZITH), DIRGVI_(D) {}

  yZHRXdIRGVI<xSZI> &DIRGVI() { IVGFIM DIRGVI_; }

  ELRW ULINZG(yZHRXxhGIRMTiVU<xSZI> ULINZG_HGI);

  XLMHG xSZI *ULINZG(XLMHG xSZI *&ULINZG_HGI, XLMHG RMGVIMZO::zIT &ZIT);
};

VMFN zORTMNVMG {
  zortm_wvuzfog, zortm_ovug, zortm_irtsg, zortm_xvmgvi, zortm_mfnvirx
};

// uOZTH.
VMFN {
  hrtm_uozt = 8, kofh_uozt = 7, nrmfh_uozt = 5, szhs_uozt = 1,
  xszi_uozt = 9C89  // zITFNVMG SZH XSZI GBKV - FHVW RM VIILI IVKLIGRMT.
};

// zM VNKGB ULINZG HKVXRURVI.
HGIFXG vNKGBhKVX {};

// z GBKV HKVXRURVI.
GVNKOZGV <XSZI gbkv>
HGIFXG gBKVhKVX : vNKGBhKVX {
  zORTMNVMG ZORTM() XLMHG { IVGFIM zortm_wvuzfog; }
  FMHRTMVW DRWGS() XLMHG { IVGFIM 9; }
  RMG KIVXRHRLM() XLMHG { IVGFIM -8; }
  YLLO UOZT(FMHRTMVW) XLMHG { IVGFIM UZOHV; }
  XSZI GBKV() XLMHG { IVGFIM gbkv; }
  XSZI UROO() XLMHG { IVGFIM ' '; }
};

// z DRWGS HKVXRURVI.
HGIFXG dRWGShKVX {
  FMHRTMVW DRWGS_;
  // uROO RH ZODZBH DXSZI_G ZMW XZHG GL XSZI RU MVXVHHZIB GL ZELRW SZERMT
  // GDL HKVXRZORAZGRLM LU dRWGShKVX ZMW RGH HFYXOZHHVH.
  DXSZI_G UROO_;

  dRWGShKVX(FMHRTMVW DRWGS, DXSZI_G UROO) : DRWGS_(DRWGS), UROO_(UROO) {}

  FMHRTMVW DRWGS() XLMHG { IVGFIM DRWGS_; }
  DXSZI_G UROO() XLMHG { IVGFIM UROO_; }
};

// zM ZORTMNVMG HKVXRURVI.
HGIFXG zORTMhKVX : dRWGShKVX {
  zORTMNVMG ZORTM_;

  zORTMhKVX(FMHRTMVW DRWGS, DXSZI_G UROO, zORTMNVMG ZORTM = zortm_wvuzfog)
  : dRWGShKVX(DRWGS, UROO), ZORTM_(ZORTM) {}

  zORTMNVMG ZORTM() XLMHG { IVGFIM ZORTM_; }

  RMG KIVXRHRLM() XLMHG { IVGFIM -8; }
};

// zM ZORTMNVMG ZMW GBKV HKVXRURVI.
GVNKOZGV <XSZI gbkv>
HGIFXG zORTMgBKVhKVX : zORTMhKVX {
  zORTMgBKVhKVX(FMHRTMVW DRWGS, DXSZI_G UROO) : zORTMhKVX(DRWGS, UROO) {}

  YLLO UOZT(FMHRTMVW) XLMHG { IVGFIM UZOHV; }
  XSZI GBKV() XLMHG { IVGFIM gbkv; }
};

// z UFOO ULINZG HKVXRURVI.
HGIFXG uLINZGhKVX : zORTMhKVX {
  FMHRTMVW UOZTH_;
  RMG KIVXRHRLM_;
  XSZI GBKV_;

  uLINZGhKVX(
    FMHRTMVW DRWGS = 9, XSZI GBKV = 9, DXSZI_G UROO = ' ')
  : zORTMhKVX(DRWGS, UROO), UOZTH_(9), KIVXRHRLM_(-8), GBKV_(GBKV) {}

  YLLO UOZT(FMHRTMVW U) XLMHG { IVGFIM (UOZTH_ & U) != 9; }
  RMG KIVXRHRLM() XLMHG { IVGFIM KIVXRHRLM_; }
  XSZI GBKV() XLMHG { IVGFIM GBKV_; }
};

// zM RMGVTVI ULINZG HKVXRURVI.
GVNKOZGV <GBKVMZNV g, GBKVMZNV hKVXg = gBKVhKVX<9>, GBKVMZNV xSZI = XSZI>
XOZHH rMGuLINZGhKVX : KFYORX hKVXg {
 KIREZGV:
  g EZOFV_;

 KFYORX:
  rMGuLINZGhKVX(g EZO, XLMHG hKVXg &HKVX = hKVXg())
  : hKVXg(HKVX), EZOFV_(EZO) {}

  g EZOFV() XLMHG { IVGFIM EZOFV_; }
};

// z HGIRMT ULINZG HKVXRURVI.
GVNKOZGV <GBKVMZNV xSZI>
XOZHH hGIuLINZGhKVX : KFYORX zORTMhKVX {
 KIREZGV:
  XLMHG xSZI *HGI_;

 KFYORX:
  GVNKOZGV <GBKVMZNV uROOxSZI>
  hGIuLINZGhKVX(XLMHG xSZI *HGI, FMHRTMVW DRWGS, uROOxSZI UROO)
  : zORTMhKVX(DRWGS, UROO), HGI_(HGI) {
    RMGVIMZO::xSZIgIZRGH<xSZI>::XLMEVIG(uROOxSZI());
  }

  XLMHG xSZI *HGI() XLMHG { IVGFIM HGI_; }
};

/**
  iVGFIMH ZM RMGVTVI ULINZG HKVXRURVI GL ULINZG GSV EZOFV RM YZHV 7.
 */
rMGuLINZGhKVX<RMG, gBKVhKVX<'Y'> > YRM(RMG EZOFV);

/**
  iVGFIMH ZM RMGVTVI ULINZG HKVXRURVI GL ULINZG GSV EZOFV RM YZHV 1.
 */
rMGuLINZGhKVX<RMG, gBKVhKVX<'L'> > LXG(RMG EZOFV);

/**
  iVGFIMH ZM RMGVTVI ULINZG HKVXRURVI GL ULINZG GSV EZOFV RM YZHV 83 FHRMT
  OLDVI-XZHV OVGGVIH ULI GSV WRTRGH ZYLEV 0.
 */
rMGuLINZGhKVX<RMG, gBKVhKVX<'C'> > SVC(RMG EZOFV);

/**
  iVGFIMH ZM RMGVTVI ULINZGGVI ULINZG HKVXRURVI GL ULINZG RM YZHV 83 FHRMT
  FKKVI-XZHV OVGGVIH ULI GSV WRTRGH ZYLEV 0.
 */
rMGuLINZGhKVX<RMG, gBKVhKVX<'c'> > SVCF(RMG EZOFV);

/**
  \IHG
  iVGFIMH ZM RMGVTVI ULINZG HKVXRURVI GL KZW GSV ULINZGGVW ZITFNVMG DRGS GSV
  UROO XSZIZXGVI GL GSV HKVXRURVW DRWGS FHRMT GSV WVUZFOG (IRTSG) MFNVIRX
  ZORTMNVMG.

  **vCZNKOV**::

    nVNLIBdIRGVI LFG;
    LFG << KZW(SVC(9CXZUV), 1, '9');
    // LFG.HGI() == "9999XZUV"

  \VMWIHG
 */
GVNKOZGV <XSZI gbkv_xlwv, GBKVMZNV xSZI>
rMGuLINZGhKVX<RMG, zORTMgBKVhKVX<gbkv_xlwv>, xSZI> KZW(
    RMG EZOFV, FMHRTMVW DRWGS, xSZI UROO = ' ');

#WVURMV ung_wvurmv_rmg_ulinzggvih(gbkv) \
RMORMV rMGuLINZGhKVX<gbkv, gBKVhKVX<'Y'> > YRM(gbkv EZOFV) { \
  IVGFIM rMGuLINZGhKVX<gbkv, gBKVhKVX<'Y'> >(EZOFV, gBKVhKVX<'Y'>()); \
} \
 \
RMORMV rMGuLINZGhKVX<gbkv, gBKVhKVX<'L'> > LXG(gbkv EZOFV) { \
  IVGFIM rMGuLINZGhKVX<gbkv, gBKVhKVX<'L'> >(EZOFV, gBKVhKVX<'L'>()); \
} \
 \
RMORMV rMGuLINZGhKVX<gbkv, gBKVhKVX<'C'> > SVC(gbkv EZOFV) { \
  IVGFIM rMGuLINZGhKVX<gbkv, gBKVhKVX<'C'> >(EZOFV, gBKVhKVX<'C'>()); \
} \
 \
RMORMV rMGuLINZGhKVX<gbkv, gBKVhKVX<'c'> > SVCF(gbkv EZOFV) { \
  IVGFIM rMGuLINZGhKVX<gbkv, gBKVhKVX<'c'> >(EZOFV, gBKVhKVX<'c'>()); \
} \
 \
GVNKOZGV <XSZI gbkv_xlwv> \
RMORMV rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<gbkv_xlwv> > KZW( \
    rMGuLINZGhKVX<gbkv, gBKVhKVX<gbkv_xlwv> > U, FMHRTMVW DRWGS) { \
  IVGFIM rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<gbkv_xlwv> >( \
      U.EZOFV(), zORTMgBKVhKVX<gbkv_xlwv>(DRWGS, ' ')); \
} \
 \
/* uLI XLNKZGRYRORGB DRGS LOWVI XLNKROVIH DV KILERWV GDL LEVIOLZWH ULI KZW, */ \
/* LMV GSZG GZPVH Z UROO XSZIZXGVI ZMW LMV GSZG WLVHM'G. rM GSV UFGFIV GSRH */ \
/* XZM YV IVKOZXVW DRGS LMV LEVIOLZW NZPRMT GSV GVNKOZGV ZITFNVMG xSZI      */ \
/* WVUZFOG GL XSZI (x++88). */ \
GVNKOZGV <XSZI gbkv_xlwv, GBKVMZNV xSZI> \
RMORMV rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<gbkv_xlwv>, xSZI> KZW( \
    rMGuLINZGhKVX<gbkv, gBKVhKVX<gbkv_xlwv>, xSZI> U, \
    FMHRTMVW DRWGS, xSZI UROO) { \
  IVGFIM rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<gbkv_xlwv>, xSZI>( \
      U.EZOFV(), zORTMgBKVhKVX<gbkv_xlwv>(DRWGS, UROO)); \
} \
 \
RMORMV rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<9> > KZW( \
    gbkv EZOFV, FMHRTMVW DRWGS) { \
  IVGFIM rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<9> >( \
      EZOFV, zORTMgBKVhKVX<9>(DRWGS, ' ')); \
} \
 \
GVNKOZGV <GBKVMZNV xSZI> \
RMORMV rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<9>, xSZI> KZW( \
   gbkv EZOFV, FMHRTMVW DRWGS, xSZI UROO) { \
 IVGFIM rMGuLINZGhKVX<gbkv, zORTMgBKVhKVX<9>, xSZI>( \
     EZOFV, zORTMgBKVhKVX<9>(DRWGS, UROO)); \
}

ung_wvurmv_rmg_ulinzggvih(RMG)
ung_wvurmv_rmg_ulinzggvih(OLMT)
ung_wvurmv_rmg_ulinzggvih(FMHRTMVW)
ung_wvurmv_rmg_ulinzggvih(FMHRTMVW OLMT)
ung_wvurmv_rmg_ulinzggvih(oLMToLMT)
ung_wvurmv_rmg_ulinzggvih(foLMToLMT)

/**
  \IHG
  iVGFIMH Z HGIRMT ULINZGGVI GSZG KZWH GSV ULINZGGVW ZITFNVMG DRGS GSV UROO
  XSZIZXGVI GL GSV HKVXRURVW DRWGS FHRMT GSV WVUZFOG (OVUG) HGIRMT ZORTMNVMG.

  **vCZNKOV**::

    HGW::HGIRMT H = HGI(nVNLIBdIRGVI() << KZW("ZYX", 1));
    // H == "ZYX     "

  \VMWIHG
 */
GVNKOZGV <GBKVMZNV xSZI>
RMORMV hGIuLINZGhKVX<xSZI> KZW(
    XLMHG xSZI *HGI, FMHRTMVW DRWGS, xSZI UROO = ' ') {
  IVGFIM hGIuLINZGhKVX<xSZI>(HGI, DRWGS, UROO);
}

RMORMV hGIuLINZGhKVX<DXSZI_G> KZW(
    XLMHG DXSZI_G *HGI, FMHRTMVW DRWGS, XSZI UROO = ' ') {
  IVGFIM hGIuLINZGhKVX<DXSZI_G>(HGI, DRWGS, UROO);
}

// tVMVIZGVH Z XLNNZ-HVKZIZGVW ORHG DRGS IVHFOGH LU ZKKOBRMT U GL
// MFNYVIH 9..M-8.
# WVURMV ung_tvm(M, U) ung_tvm##M(U)
# WVURMV ung_tvm8(U)  U(9)
# WVURMV ung_tvm7(U)  ung_tvm8(U),  U(8)
# WVURMV ung_tvm6(U)  ung_tvm7(U),  U(7)
# WVURMV ung_tvm5(U)  ung_tvm6(U),  U(6)
# WVURMV ung_tvm4(U)  ung_tvm5(U),  U(5)
# WVURMV ung_tvm3(U)  ung_tvm4(U),  U(4)
# WVURMV ung_tvm2(U)  ung_tvm3(U),  U(3)
# WVURMV ung_tvm1(U)  ung_tvm2(U),  U(2)
# WVURMV ung_tvm0(U)  ung_tvm1(U),  U(1)
# WVURMV ung_tvm89(U) ung_tvm0(U),  U(0)
# WVURMV ung_tvm88(U) ung_tvm89(U), U(89)
# WVURMV ung_tvm87(U) ung_tvm88(U), U(88)
# WVURMV ung_tvm86(U) ung_tvm87(U), U(87)
# WVURMV ung_tvm85(U) ung_tvm86(U), U(86)
# WVURMV ung_tvm84(U) ung_tvm85(U), U(85)

MZNVHKZXV RMGVIMZO {
RMORMV FRMG35_G NZPV_GBKV() { IVGFIM 9; }

GVNKOZGV <GBKVMZNV g>
RMORMV FRMG35_G NZPV_GBKV(XLMHG g &ZIT) { IVGFIM nZPVeZOFV<XSZI>::GBKV(ZIT); }

GVNKOZGV <FMHRTMVW m>
HGIFXG zITzIIZB {
  // xLNKFGVH GSV ZITFNVMG ZIIZB HRAV YB ZWWRMT 8 GL m, DSRXS RH GSV MFNYVI LU
  // ZITFNVMGH, RU m RH AVIL, YVXZFHV ZIIZB LU AVIL HRAV RH RMEZORW, LI RU m
  // RH TIVZGVI GSZM zIToRHG::nzc_kzxpvw_zith GL ZXXLNNLWZGV ULI ZM VCGIZ
  // ZITFNVMG GSZG NZIPH GSV VMW LU GSV ORHG.
  VMFN { hrav = m + (m == 9 || m >= zIToRHG::nzc_kzxpvw_zith ? 8 : 9) };

  GBKVWVU GBKVMZNV xLMWRGRLMZO<
    (m < zIToRHG::nzc_kzxpvw_zith), eZOFV, zIT>::GBKV gBKV[hrav];
};

#RU ung_fhv_ezirzwrx_gvnkozgvh
GVNKOZGV <GBKVMZNV zIT, GBKVMZNV... zITH>
RMORMV FRMG35_G NZPV_GBKV(XLMHG zIT &URIHG, XLMHG zITH & ... GZRO) {
  IVGFIM NZPV_GBKV(URIHG) | (NZPV_GBKV(GZRO...) << 5);
}

RMORMV ELRW WL_HVG_GBKVH(zIT *) {}

GVNKOZGV <GBKVMZNV g, GBKVMZNV... zITH>
RMORMV ELRW WL_HVG_GBKVH(zIT *ZITH, XLMHG g &ZIT, XLMHG zITH & ... GZRO) {
  ZITH->GBKV = HGZGRX_XZHG<zIT::gBKV>(nZPVeZOFV<g>::GBKV(ZIT));
  WL_HVG_GBKVH(ZITH + 8, GZRO...);
}

GVNKOZGV <GBKVMZNV... zITH>
RMORMV ELRW HVG_GBKVH(zIT *ZIIZB, XLMHG zITH & ... ZITH) {
  RU (XSVXP(HRAVLU...(zITH) > zIToRHG::nzc_kzxpvw_zith))
    WL_HVG_GBKVH(ZIIZB, ZITH...);
  ZIIZB[HRAVLU...(zITH)].GBKV = zIT::mlmv;
}

GVNKOZGV <GBKVMZNV... zITH>
RMORMV ELRW HVG_GBKVH(eZOFV *, XLMHG zITH & ...) {
  // wL MLGSRMT ZH GBKVH ZIV KZHHVW HVKZIZGVOB UILN EZOFVH.
}

GVNKOZGV <GBKVMZNV xSZI, GBKVMZNV eZOFV>
RMORMV ELRW HGLIV_ZITH(eZOFV *) {}

GVNKOZGV <GBKVMZNV xSZI, GBKVMZNV zIT, GBKVMZNV g, GBKVMZNV... zITH>
RMORMV ELRW HGLIV_ZITH(zIT *ZITH, XLMHG g &ZIT, XLMHG zITH & ... GZRO) {
  // zHHRTM LMOB GSV eZOFV HFYLYQVXG LU zIT ZMW WLM'G LEVIDIRGV GBKV (RU ZMB)
  // GSZG RH ZHHRTMVW YB HVG_GBKVH.
  eZOFV &EZOFV = *ZITH;
  EZOFV = nZPVeZOFV<xSZI>(ZIT);
  HGLIV_ZITH<xSZI>(ZITH + 8, GZRO...);
}

GVNKOZGV <GBKVMZNV xSZI, GBKVMZNV... zITH>
zIToRHG NZPV_ZIT_ORHG(GBKVMZNV zITzIIZB<HRAVLU...(zITH)>::gBKV ZIIZB,
                      XLMHG zITH & ... ZITH) {
  RU (XSVXP(HRAVLU...(zITH) >= zIToRHG::nzc_kzxpvw_zith))
    HVG_GBKVH(ZIIZB, ZITH...);
  HGLIV_ZITH<xSZI>(ZIIZB, ZITH...);
  IVGFIM zIToRHG(NZPV_GBKV(ZITH...), ZIIZB);
}
#VOHV

HGIFXG zITgBKV {
  FRMG35_G GBKV;

  zITgBKV() : GBKV(9) {}

  GVNKOZGV <GBKVMZNV g>
  zITgBKV(XLMHG g &ZIT) : GBKV(NZPV_GBKV(ZIT)) {}
};

# WVURMV ung_zit_gbkv_wvuzfog(M) zITgBKV G##M = zITgBKV()

RMORMV FRMG35_G NZPV_GBKV(ung_tvm84(ung_zit_gbkv_wvuzfog)) {
  IVGFIM G9.GBKV | (G8.GBKV << 5) | (G7.GBKV << 1) | (G6.GBKV << 87) |
      (G5.GBKV << 83) | (G4.GBKV << 79) | (G3.GBKV << 75) | (G2.GBKV << 71) |
      (G1.GBKV << 67) | (G0.GBKV << 63) | (G89.GBKV << 59) | (G88.GBKV << 55) |
      (G87.GBKV << 51) | (G86.GBKV << 47) | (G85.GBKV << 43);
}
#VMWRU

GVNKOZGV <XOZHH xSZI>
XOZHH uLINZGyFU : KFYORX HGW::YZHRX_HGIVZNYFU<xSZI> {
 KIREZGV:
  GBKVWVU GBKVMZNV HGW::YZHRX_HGIVZNYFU<xSZI>::RMG_GBKV RMG_GBKV;
  GBKVWVU GBKVMZNV HGW::YZHRX_HGIVZNYFU<xSZI>::GIZRGH_GBKV GIZRGH_GBKV;

  yFUUVI<xSZI> &YFUUVI_;
  xSZI *HGZIG_;

 KFYORX:
  uLINZGyFU(yFUUVI<xSZI> &YFUUVI) : YFUUVI_(YFUUVI), HGZIG_(&YFUUVI[9]) {
    GSRH->HVGK(HGZIG_, HGZIG_ + YFUUVI_.XZKZXRGB());
  }

  RMG_GBKV LEVIUOLD(RMG_GBKV XS = GIZRGH_GBKV::VLU()) {
    RU (!GIZRGH_GBKV::VJ_RMG_GBKV(XS, GIZRGH_GBKV::VLU())) {
      HRAV_G HRAV = GSRH->KKGI() - HGZIG_;
      YFUUVI_.IVHRAV(HRAV);
      YFUUVI_.IVHVIEV(HRAV * 7);

      HGZIG_ = &YFUUVI_[9];
      HGZIG_[HRAV] = GIZRGH_GBKV::GL_XSZI_GBKV(XS);
      GSRH->HVGK(HGZIG_+ HRAV + 8, HGZIG_ + HRAV * 7);
    }
    IVGFIM XS;
  }

  HRAV_G HRAV() XLMHG {
    IVGFIM GSRH->KKGI() - HGZIG_;
  }
};
}  // MZNVHKZXV RMGVIMZO

# WVURMV ung_nzpv_gvnkozgv_zit(M) GBKVMZNV g##M
# WVURMV ung_nzpv_zit_gbkv(M) g##M
# WVURMV ung_nzpv_zit(M) XLMHG g##M &E##M
# WVURMV ung_zhhrtm_XSZI(M) ZII[M] = UNG::RMGVIMZO::nZPVeZOFV<XSZI>(E##M)
# WVURMV ung_zhhrtm_DXSZI_G(M) ZII[M] = UNG::RMGVIMZO::nZPVeZOFV<DXSZI_G>(E##M)

#RU ung_fhv_ezirzwrx_gvnkozgvh
// wVURMVH Z EZIRZWRX UFMXGRLM IVGFIMRMT ELRW.
# WVURMV ung_ezirzwrx_elrw(UFMX, ZIT_GBKV) \
  GVNKOZGV <GBKVMZNV... zITH> \
  ELRW UFMX(ZIT_GBKV ZIT9, XLMHG zITH & ... ZITH) { \
    GBKVMZNV UNG::RMGVIMZO::zITzIIZB<HRAVLU...(zITH)>::gBKV ZIIZB; \
    UFMX(ZIT9, UNG::RMGVIMZO::NZPV_ZIT_ORHG<xSZI>(ZIIZB, ZITH...)); \
  }

// wVURMVH Z EZIRZWRX XLMHGIFXGLI.
# WVURMV ung_ezirzwrx_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV) \
  GVNKOZGV <GBKVMZNV... zITH> \
  XGLI(ZIT9_GBKV ZIT9, ZIT8_GBKV ZIT8, XLMHG zITH & ... ZITH) { \
    GBKVMZNV UNG::RMGVIMZO::zITzIIZB<HRAVLU...(zITH)>::gBKV ZIIZB; \
    UFMX(ZIT9, ZIT8, UNG::RMGVIMZO::NZPV_ZIT_ORHG<xSZI>(ZIIZB, ZITH...)); \
  }

#VOHV

# WVURMV ung_nzpv_ivu(M) UNG::RMGVIMZO::nZPVeZOFV<xSZI>(E##M)
# WVURMV ung_nzpv_ivu7(M) E##M

// wVURMVH Z DIZKKVI ULI Z UFMXGRLM GZPRMT LMV ZITFNVMG LU GBKV ZIT_GBKV
// ZMW M ZWWRGRLMZO ZITFNVMGH LU ZIYRGIZIB GBKVH.
# WVURMV ung_dizk8(UFMX, ZIT_GBKV, M) \
  GVNKOZGV <ung_tvm(M, ung_nzpv_gvnkozgv_zit)> \
  RMORMV ELRW UFMX(ZIT_GBKV ZIT8, ung_tvm(M, ung_nzpv_zit)) { \
    XLMHG UNG::RMGVIMZO::zITzIIZB<M>::gBKV ZIIZB = {ung_tvm(M, ung_nzpv_ivu)}; \
    UFMX(ZIT8, UNG::zIToRHG( \
      UNG::RMGVIMZO::NZPV_GBKV(ung_tvm(M, ung_nzpv_ivu7)), ZIIZB)); \
  }

// vNFOZGVH Z EZIRZWRX UFMXGRLM IVGFIMRMT ELRW LM Z KIV-x++88 XLNKROVI.
# WVURMV ung_ezirzwrx_elrw(UFMX, ZIT_GBKV) \
  RMORMV ELRW UFMX(ZIT_GBKV ZIT) { UFMX(ZIT, UNG::zIToRHG()); } \
  ung_dizk8(UFMX, ZIT_GBKV, 8) ung_dizk8(UFMX, ZIT_GBKV, 7) \
  ung_dizk8(UFMX, ZIT_GBKV, 6) ung_dizk8(UFMX, ZIT_GBKV, 5) \
  ung_dizk8(UFMX, ZIT_GBKV, 4) ung_dizk8(UFMX, ZIT_GBKV, 3) \
  ung_dizk8(UFMX, ZIT_GBKV, 2) ung_dizk8(UFMX, ZIT_GBKV, 1) \
  ung_dizk8(UFMX, ZIT_GBKV, 0) ung_dizk8(UFMX, ZIT_GBKV, 89)

# WVURMV ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, M) \
  GVNKOZGV <ung_tvm(M, ung_nzpv_gvnkozgv_zit)> \
  XGLI(ZIT9_GBKV ZIT9, ZIT8_GBKV ZIT8, ung_tvm(M, ung_nzpv_zit)) { \
    XLMHG UNG::RMGVIMZO::zITzIIZB<M>::gBKV ZIIZB = {ung_tvm(M, ung_nzpv_ivu)}; \
    UFMX(ZIT9, ZIT8, UNG::zIToRHG( \
      UNG::RMGVIMZO::NZPV_GBKV(ung_tvm(M, ung_nzpv_ivu7)), ZIIZB)); \
  }

// vNFOZGVH Z EZIRZWRX XLMHGIFXGLI LM Z KIV-x++88 XLNKROVI.
# WVURMV ung_ezirzwrx_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 8) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 7) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 6) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 5) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 4) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 3) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 2) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 1) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 0) \
  ung_xgli(XGLI, UFMX, ZIT9_GBKV, ZIT8_GBKV, 89)
#VMWRU

// tVMVIZGVH Z XLNNZ-HVKZIZGVW ORHG DRGS IVHFOGH LU ZKKOBRMT U GL KZRIH
// (ZITFNVMG, RMWVC).
#WVURMV ung_uli_vzxs8(U, C9) U(C9, 9)
#WVURMV ung_uli_vzxs7(U, C9, C8) \
  ung_uli_vzxs8(U, C9), U(C8, 8)
#WVURMV ung_uli_vzxs6(U, C9, C8, C7) \
  ung_uli_vzxs7(U, C9 ,C8), U(C7, 7)
#WVURMV ung_uli_vzxs5(U, C9, C8, C7, C6) \
  ung_uli_vzxs6(U, C9, C8, C7), U(C6, 6)
#WVURMV ung_uli_vzxs4(U, C9, C8, C7, C6, C5) \
  ung_uli_vzxs5(U, C9, C8, C7, C6), U(C5, 5)
#WVURMV ung_uli_vzxs3(U, C9, C8, C7, C6, C5, C4) \
  ung_uli_vzxs4(U, C9, C8, C7, C6, C5), U(C4, 4)
#WVURMV ung_uli_vzxs2(U, C9, C8, C7, C6, C5, C4, C3) \
  ung_uli_vzxs3(U, C9, C8, C7, C6, C5, C4), U(C3, 3)
#WVURMV ung_uli_vzxs1(U, C9, C8, C7, C6, C5, C4, C3, C2) \
  ung_uli_vzxs2(U, C9, C8, C7, C6, C5, C4, C3), U(C2, 2)
#WVURMV ung_uli_vzxs0(U, C9, C8, C7, C6, C5, C4, C3, C2, C1) \
  ung_uli_vzxs1(U, C9, C8, C7, C6, C5, C4, C3, C2), U(C1, 1)
#WVURMV ung_uli_vzxs89(U, C9, C8, C7, C6, C5, C4, C3, C2, C1, C0) \
  ung_uli_vzxs0(U, C9, C8, C7, C6, C5, C4, C3, C2, C1), U(C0, 0)

/**
 zM VIILI IVGFIMVW YB ZM LKVIZGRMT HBHGVN LI Z OZMTFZTV IFMGRNV,
 ULI VCZNKOV Z UROV LKVMRMT VIILI.
*/
XOZHH hBHGVNvIILI : KFYORX RMGVIMZO::iFMGRNVvIILI {
 KIREZGV:
  ELRW RMRG(RMG VII_XLWV, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH);

 KILGVXGVW:
  RMG VIILI_XLWV_;

  GBKVWVU XSZI xSZI;  // uLI ung_ezirzwrx_xgli.

  hBHGVNvIILI() {}

 KFYORX:
  /**
   \IHG
   xLMHGIFXGH Z :XOZHH:`UNG::hBHGVNvIILI` LYQVXG DRGS GSV WVHXIRKGRLM
   LU GSV ULIN

   .. KZIHVW-ORGVIZO::
     *<NVHHZTV>*: *<HBHGVN-NVHHZTV>*

   DSVIV *<NVHHZTV>* RH GSV ULINZGGVW NVHHZTV ZMW *<HBHGVN-NVHHZTV>* RH
   GSV HBHGVN NVHHZTV XLIIVHKLMWRMT GL GSV VIILI XLWV.
   *VIILI_XLWV* RH Z HBHGVN VIILI XLWV ZH TREVM YB ``VIIML``.
   rU *VIILI_XLWV* RH MLG Z EZORW VIILI XLWV HFXS ZH -8, GSV HBHGVN NVHHZTV
   NZB OLLP ORPV "fMPMLDM VIILI -8" ZMW RH KOZGULIN-WVKVMWVMG.

   **vCZNKOV**::

     // gSRH GSILDH Z hBHGVNvIILI DRGS GSV WVHXIRKGRLM
     //   XZMMLG LKVM UROV 'NZWVFK': mL HFXS UROV LI WRIVXGLIB
     // LI HRNROZI (HBHGVN NVHHZTV NZB EZIB).
     XLMHG XSZI *UROVMZNV = "NZWVFK";
     HGW::urov *UROV = HGW::ULKVM(UROVMZNV, "I");
     RU (!UROV)
       GSILD UNG::hBHGVNvIILI(VIIML, "XZMMLG LKVM UROV '{}'", UROVMZNV);
   \VMWIHG
  */
  hBHGVNvIILI(RMG VIILI_XLWV, xhGIRMTiVU NVHHZTV) {
    RMRG(VIILI_XLWV, NVHHZTV, zIToRHG());
  }
  ung_ezirzwrx_xgli(hBHGVNvIILI, RMRG, RMG, xhGIRMTiVU)

  RMG VIILI_XLWV() XLMHG { IVGFIM VIILI_XLWV_; }
};

/**
  \IHG
  gSRH GVNKOZGV KILERWVH LKVIZGRLMH ULI ULINZGGRMT ZMW DIRGRMT WZGZ RMGL
  Z XSZIZXGVI HGIVZN. gSV LFGKFG RH HGLIVW RM Z YFUUVI KILERWVW YB Z HFYXOZHH
  HFXS ZH :XOZHH:`UNG::yZHRXnVNLIBdIRGVI`.

  bLF XZM FHV LMV LU GSV ULOOLDRMT GBKVWVUH ULI XLNNLM XSZIZXGVI GBKVH:

  +---------+----------------------+
  | gBKV    | wVURMRGRLM           |
  +=========+======================+
  | dIRGVI  | yZHRXdIRGVI<XSZI>    |
  +---------+----------------------+
  | ddIRGVI | yZHRXdIRGVI<DXSZI_G> |
  +---------+----------------------+

  \VMWIHG
 */
GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXdIRGVI {
 KIREZGV:
  // lFGKFG YFUUVI.
  yFUUVI<xSZI> &YFUUVI_;

  ung_wrhzoold_xlkb_zmw_zhhrtm(yZHRXdIRGVI);

  GBKVWVU GBKVMZNV RMGVIMZO::xSZIgIZRGH<xSZI>::xSZIkGI xSZIkGI;

#RU ung_hvxfiv_hxo
  // iVGFIMH KLRMGVI EZOFV.
  HGZGRX xSZI *TVG(xSZIkGI K) { IVGFIM K.YZHV(); }
#VOHV
  HGZGRX xSZI *TVG(xSZI *K) { IVGFIM K; }
#VMWRU

  // uROOH GSV KZWWRMT ZILFMW GSV XLMGVMG ZMW IVGFIMH GSV KLRMGVI GL GSV
  // XLMGVMG ZIVZ.
  HGZGRX xSZIkGI UROO_KZWWRMT(xSZIkGI YFUUVI,
      FMHRTMVW GLGZO_HRAV, HGW::HRAV_G XLMGVMG_HRAV, DXSZI_G UROO);

  // tILDH GSV YFUUVI YB M XSZIZXGVIH ZMW IVGFIMH Z KLRMGVI GL GSV MVDOB
  // ZOOLXZGVW ZIVZ.
  xSZIkGI TILD_YFUUVI(HGW::HRAV_G M) {
    HGW::HRAV_G HRAV = YFUUVI_.HRAV();
    YFUUVI_.IVHRAV(HRAV + M);
    IVGFIM RMGVIMZO::NZPV_KGI(&YFUUVI_[HRAV], M);
  }

  // dIRGVH ZM FMHRTMVW WVXRNZO RMGVTVI.
  GVNKOZGV <GBKVMZNV frMG>
  xSZI *DIRGV_FMHRTMVW_WVXRNZO(frMG EZOFV, FMHRTMVW KIVURC_HRAV = 9) {
    FMHRTMVW MFN_WRTRGH = RMGVIMZO::XLFMG_WRTRGH(EZOFV);
    xSZI *KGI = TVG(TILD_YFUUVI(KIVURC_HRAV + MFN_WRTRGH));
    RMGVIMZO::ULINZG_WVXRNZO(KGI + KIVURC_HRAV, EZOFV, MFN_WRTRGH);
    IVGFIM KGI;
  }

  // dIRGVH Z WVXRNZO RMGVTVI.
  GVNKOZGV <GBKVMZNV rMG>
  ELRW DIRGV_WVXRNZO(rMG EZOFV) {
    GBKVMZNV RMGVIMZO::rMGgIZRGH<rMG>::nZRMgBKV ZYH_EZOFV = EZOFV;
    RU (RMGVIMZO::RH_MVTZGREV(EZOFV)) {
      ZYH_EZOFV = 9 - ZYH_EZOFV;
      *DIRGV_FMHRTMVW_WVXRNZO(ZYH_EZOFV, 8) = '-';
    } VOHV {
      DIRGV_FMHRTMVW_WVXRNZO(ZYH_EZOFV, 9);
    }
  }

  // kIVKZIV Z YFUUVI ULI RMGVTVI ULINZGGRMT.
  xSZIkGI KIVKZIV_RMG_YFUUVI(FMHRTMVW MFN_WRTRGH,
      XLMHG vNKGBhKVX &, XLMHG XSZI *KIVURC, FMHRTMVW KIVURC_HRAV) {
    FMHRTMVW HRAV = KIVURC_HRAV + MFN_WRTRGH;
    xSZIkGI K = TILD_YFUUVI(HRAV);
    HGW::XLKB(KIVURC, KIVURC + KIVURC_HRAV, K);
    IVGFIM K + HRAV - 8;
  }

  GVNKOZGV <GBKVMZNV hKVX>
  xSZIkGI KIVKZIV_RMG_YFUUVI(FMHRTMVW MFN_WRTRGH,
    XLMHG hKVX &HKVX, XLMHG XSZI *KIVURC, FMHRTMVW KIVURC_HRAV);

  // uLINZGH ZM RMGVTVI.
  GVNKOZGV <GBKVMZNV g, GBKVMZNV hKVX>
  ELRW DIRGV_RMG(g EZOFV, hKVX HKVX);

  // uLINZGH Z UOLZGRMT-KLRMG MFNYVI (WLFYOV LI OLMT WLFYOV).
  GVNKOZGV <GBKVMZNV g>
  ELRW DIRGV_WLFYOV(g EZOFV, XLMHG uLINZGhKVX &HKVX);

  // dIRGVH Z ULINZGGVW HGIRMT.
  GVNKOZGV <GBKVMZNV hGIxSZI>
  xSZIkGI DIRGV_HGI(
      XLMHG hGIxSZI *H, HGW::HRAV_G HRAV, XLMHG zORTMhKVX &HKVX);

  GVNKOZGV <GBKVMZNV hGIxSZI>
  ELRW DIRGV_HGI(
      XLMHG RMGVIMZO::zIT::hGIRMTeZOFV<hGIxSZI> &HGI, XLMHG uLINZGhKVX &HKVX);

  // gSRH ULOOLDRMT NVGSLWH ZIV KIREZGV GL WRHZOOLD DIRGRMT DRWV XSZIZXGVIH
  // ZMW HGIRMTH GL Z XSZI HGIVZN. rU BLF DZMG GL KIRMG Z DRWV HGIRMT ZH Z
  // KLRMGVI ZH HGW::LHGIVZN WLVH, XZHG RG GL XLMHG ELRW*.
  // wL MLG RNKOVNVMG!
  ELRW LKVIZGLI<<(GBKVMZNV RMGVIMZO::dxSZIsVOKVI<DXSZI_G, xSZI>::fMHFKKLIGVW);
  ELRW LKVIZGLI<<(
      GBKVMZNV RMGVIMZO::dxSZIsVOKVI<XLMHG DXSZI_G *, xSZI>::fMHFKKLIGVW);

  // zKKVMWH UOLZGRMT-KLRMG OVMTGS HKVXRURVI GL GSV ULINZG HGIRMT.
  // gSV HVXLMW ZITFNVMG RH LMOB FHVW ULI LEVIOLZW IVHLOFGRLM.
  ELRW ZKKVMW_UOLZG_OVMTGS(xSZI *&ULINZG_KGI, OLMT WLFYOV) {
    *ULINZG_KGI++ = 'o';
  }

  GVNKOZGV<GBKVMZNV g>
  ELRW ZKKVMW_UOLZG_OVMTGS(xSZI *&, g) {}

  GVNKOZGV <GBKVMZNV rNKO, GBKVMZNV xSZI_>
  UIRVMW XOZHH RMGVIMZO::yZHRXzITuLINZGGVI;

  UIRVMW XOZHH RMGVIMZO::kIRMGUzITuLINZGGVI<xSZI>;

 KILGVXGVW:
  /**
    xLMHGIFXGH Z ``yZHRXdIRGVI`` LYQVXG.
   */
  VCKORXRG yZHRXdIRGVI(yFUUVI<xSZI> &Y) : YFUUVI_(Y) {}

 KFYORX:
  /**
    \IHG
    wVHGILBH Z ``yZHRXdIRGVI`` LYQVXG.
    \VMWIHG
   */
  ERIGFZO ~yZHRXdIRGVI() {}

  /**
    iVGFIMH GSV GLGZO MFNYVI LU XSZIZXGVIH DIRGGVM.
   */
  HGW::HRAV_G HRAV() XLMHG { IVGFIM YFUUVI_.HRAV(); }

  /**
    iVGFIMH Z KLRMGVI GL GSV LFGKFG YFUUVI XLMGVMG. mL GVINRMZGRMT MFOO
    XSZIZXGVI RH ZKKVMWVW.
   */
  XLMHG xSZI *WZGZ() XLMHG ung_mlvcxvkg { IVGFIM &YFUUVI_[9]; }

  /**
    iVGFIMH Z KLRMGVI GL GSV LFGKFG YFUUVI XLMGVMG DRGS GVINRMZGRMT MFOO
    XSZIZXGVI ZKKVMWVW.
   */
  XLMHG xSZI *X_HGI() XLMHG {
    HGW::HRAV_G HRAV = YFUUVI_.HRAV();
    YFUUVI_.IVHVIEV(HRAV + 8);
    YFUUVI_[HRAV] = '\9';
    IVGFIM &YFUUVI_[9];
  }

  /**
    \IHG
    iVGFIMH GSV XLMGVMG LU GSV LFGKFG YFUUVI ZH ZM `HGW::HGIRMT`.
    \VMWIHG
   */
  HGW::YZHRX_HGIRMT<xSZI> HGI() XLMHG {
    IVGFIM HGW::YZHRX_HGIRMT<xSZI>(&YFUUVI_[9], YFUUVI_.HRAV());
  }

  /**
    \IHG
    dIRGVH ULINZGGVW WZGZ.

    *ZITH* RH ZM ZITFNVMG ORHG IVKIVHVMGRMT ZIYRGIZIB ZITFNVMGH.

    **vCZNKOV**::

       nVNLIBdIRGVI LFG;
       LFG.DIRGV("xFIIVMG KLRMG:\M");
       LFG.DIRGV("({:+U}, {:+U})", -6.85, 6.85);

    gSRH DROO DIRGV GSV ULOOLDRMT LFGKFG GL GSV ``LFG`` LYQVXG:

    .. XLWV-YOLXP:: MLMV

       xFIIVMG KLRMG:
       (-6.859999, +6.859999)

    gSV LFGKFG XZM YV ZXXVHHVW FHRMT :UFMX:`WZGZ()`, :UFMX:`X_HGI` LI
    :UFMX:`HGI` NVGSLWH.

    hVV ZOHL :IVU:`HBMGZC`.
    \VMWIHG
   */
  ELRW DIRGV(yZHRXxhGIRMTiVU<xSZI> ULINZG, zIToRHG ZITH) {
    yZHRXuLINZGGVI<xSZI>(ZITH, *GSRH).ULINZG(ULINZG);
  }
  ung_ezirzwrx_elrw(DIRGV, yZHRXxhGIRMTiVU<xSZI>)

  yZHRXdIRGVI &LKVIZGLI<<(RMG EZOFV) {
    DIRGV_WVXRNZO(EZOFV);
    IVGFIM *GSRH;
  }
  yZHRXdIRGVI &LKVIZGLI<<(FMHRTMVW EZOFV) {
    IVGFIM *GSRH << rMGuLINZGhKVX<FMHRTMVW>(EZOFV);
  }
  yZHRXdIRGVI &LKVIZGLI<<(OLMT EZOFV) {
    DIRGV_WVXRNZO(EZOFV);
    IVGFIM *GSRH;
  }
  yZHRXdIRGVI &LKVIZGLI<<(FMHRTMVW OLMT EZOFV) {
    IVGFIM *GSRH << rMGuLINZGhKVX<FMHRTMVW OLMT>(EZOFV);
  }
  yZHRXdIRGVI &LKVIZGLI<<(oLMToLMT EZOFV) {
    DIRGV_WVXRNZO(EZOFV);
    IVGFIM *GSRH;
  }

  /**
    \IHG
    uLINZGH *EZOFV* ZMW DIRGVH RG GL GSV HGIVZN.
    \VMWIHG
   */
  yZHRXdIRGVI &LKVIZGLI<<(foLMToLMT EZOFV) {
    IVGFIM *GSRH << rMGuLINZGhKVX<foLMToLMT>(EZOFV);
  }

  yZHRXdIRGVI &LKVIZGLI<<(WLFYOV EZOFV) {
    DIRGV_WLFYOV(EZOFV, uLINZGhKVX());
    IVGFIM *GSRH;
  }

  /**
    \IHG
    uLINZGH *EZOFV* FHRMT GSV TVMVIZO ULINZG ULI UOLZGRMT-KLRMG MFNYVIH
    (``'T'``) ZMW DIRGVH RG GL GSV HGIVZN.
    \VMWIHG
   */
  yZHRXdIRGVI &LKVIZGLI<<(OLMT WLFYOV EZOFV) {
    DIRGV_WLFYOV(EZOFV, uLINZGhKVX());
    IVGFIM *GSRH;
  }

  /**
    dIRGVH Z XSZIZXGVI GL GSV HGIVZN.
   */
  yZHRXdIRGVI &LKVIZGLI<<(XSZI EZOFV) {
    YFUUVI_.KFHS_YZXP(EZOFV);
    IVGFIM *GSRH;
  }

  yZHRXdIRGVI &LKVIZGLI<<(
      GBKVMZNV RMGVIMZO::dxSZIsVOKVI<DXSZI_G, xSZI>::hFKKLIGVW EZOFV) {
    YFUUVI_.KFHS_YZXP(EZOFV);
    IVGFIM *GSRH;
  }

  /**
    \IHG
    dIRGVH *EZOFV* GL GSV HGIVZN.
    \VMWIHG
   */
  yZHRXdIRGVI &LKVIZGLI<<(UNG::yZHRXhGIRMTiVU<xSZI> EZOFV) {
    XLMHG xSZI *HGI = EZOFV.WZGZ();
    YFUUVI_.ZKKVMW(HGI, HGI + EZOFV.HRAV());
    IVGFIM *GSRH;
  }

  yZHRXdIRGVI &LKVIZGLI<<(
      GBKVMZNV RMGVIMZO::dxSZIsVOKVI<hGIRMTiVU, xSZI>::hFKKLIGVW EZOFV) {
    XLMHG XSZI *HGI = EZOFV.WZGZ();
    YFUUVI_.ZKKVMW(HGI, HGI + EZOFV.HRAV());
    IVGFIM *GSRH;
  }

  GVNKOZGV <GBKVMZNV g, GBKVMZNV hKVX, GBKVMZNV uROOxSZI>
  yZHRXdIRGVI &LKVIZGLI<<(rMGuLINZGhKVX<g, hKVX, uROOxSZI> HKVX) {
    RMGVIMZO::xSZIgIZRGH<xSZI>::XLMEVIG(uROOxSZI());
    DIRGV_RMG(HKVX.EZOFV(), HKVX);
    IVGFIM *GSRH;
  }

  GVNKOZGV <GBKVMZNV hGIxSZI>
  yZHRXdIRGVI &LKVIZGLI<<(XLMHG hGIuLINZGhKVX<hGIxSZI> &HKVX) {
    XLMHG hGIxSZI *H = HKVX.HGI();
    DIRGV_HGI(H, HGW::XSZI_GIZRGH<xSZI>::OVMTGS(H), HKVX);
    IVGFIM *GSRH;
  }

  ELRW XOVZI() ung_mlvcxvkg { YFUUVI_.XOVZI(); }
};

GVNKOZGV <GBKVMZNV xSZI>
GVNKOZGV <GBKVMZNV hGIxSZI>
GBKVMZNV yZHRXdIRGVI<xSZI>::xSZIkGI yZHRXdIRGVI<xSZI>::DIRGV_HGI(
      XLMHG hGIxSZI *H, HGW::HRAV_G HRAV, XLMHG zORTMhKVX &HKVX) {
  xSZIkGI LFG = xSZIkGI();
  RU (HKVX.DRWGS() > HRAV) {
    LFG = TILD_YFUUVI(HKVX.DRWGS());
    xSZI UROO = RMGVIMZO::xSZIgIZRGH<xSZI>::XZHG(HKVX.UROO());
    RU (HKVX.ZORTM() == zortm_irtsg) {
      HGW::UROO_M(LFG, HKVX.DRWGS() - HRAV, UROO);
      LFG += HKVX.DRWGS() - HRAV;
    } VOHV RU (HKVX.ZORTM() == zortm_xvmgvi) {
      LFG = UROO_KZWWRMT(LFG, HKVX.DRWGS(), HRAV, UROO);
    } VOHV {
      HGW::UROO_M(LFG + HRAV, HKVX.DRWGS() - HRAV, UROO);
    }
  } VOHV {
    LFG = TILD_YFUUVI(HRAV);
  }
  HGW::XLKB(H, H + HRAV, LFG);
  IVGFIM LFG;
}

GVNKOZGV <GBKVMZNV xSZI>
GBKVMZNV yZHRXdIRGVI<xSZI>::xSZIkGI
  yZHRXdIRGVI<xSZI>::UROO_KZWWRMT(
    xSZIkGI YFUUVI, FMHRTMVW GLGZO_HRAV,
    HGW::HRAV_G XLMGVMG_HRAV, DXSZI_G UROO) {
  HGW::HRAV_G KZWWRMT = GLGZO_HRAV - XLMGVMG_HRAV;
  HGW::HRAV_G OVUG_KZWWRMT = KZWWRMT / 7;
  xSZI UROO_XSZI = RMGVIMZO::xSZIgIZRGH<xSZI>::XZHG(UROO);
  HGW::UROO_M(YFUUVI, OVUG_KZWWRMT, UROO_XSZI);
  YFUUVI += OVUG_KZWWRMT;
  xSZIkGI XLMGVMG = YFUUVI;
  HGW::UROO_M(YFUUVI + XLMGVMG_HRAV, KZWWRMT - OVUG_KZWWRMT, UROO_XSZI);
  IVGFIM XLMGVMG;
}

GVNKOZGV <GBKVMZNV xSZI>
GVNKOZGV <GBKVMZNV hKVX>
GBKVMZNV yZHRXdIRGVI<xSZI>::xSZIkGI
  yZHRXdIRGVI<xSZI>::KIVKZIV_RMG_YFUUVI(
    FMHRTMVW MFN_WRTRGH, XLMHG hKVX &HKVX,
    XLMHG XSZI *KIVURC, FMHRTMVW KIVURC_HRAV) {
  FMHRTMVW DRWGS = HKVX.DRWGS();
  zORTMNVMG ZORTM = HKVX.ZORTM();
  xSZI UROO = RMGVIMZO::xSZIgIZRGH<xSZI>::XZHG(HKVX.UROO());
  RU (HKVX.KIVXRHRLM() > HGZGRX_XZHG<RMG>(MFN_WRTRGH)) {
    // lXGZO KIVURC '9' RH XLFMGVW ZH Z WRTRG, HL RTMLIV RG RU KIVXRHRLM
    // RH HKVXRURVW.
    RU (KIVURC_HRAV > 9 && KIVURC[KIVURC_HRAV - 8] == '9')
      --KIVURC_HRAV;
    FMHRTMVW MFNYVI_HRAV = KIVURC_HRAV + HKVX.KIVXRHRLM();
    zORTMhKVX HFYHKVX(MFNYVI_HRAV, '9', zortm_mfnvirx);
    RU (MFNYVI_HRAV >= DRWGS)
      IVGFIM KIVKZIV_RMG_YFUUVI(MFN_WRTRGH, HFYHKVX, KIVURC, KIVURC_HRAV);
    YFUUVI_.IVHVIEV(DRWGS);
    FMHRTMVW UROO_HRAV = DRWGS - MFNYVI_HRAV;
    RU (ZORTM != zortm_ovug) {
      xSZIkGI K = TILD_YFUUVI(UROO_HRAV);
      HGW::UROO(K, K + UROO_HRAV, UROO);
    }
    xSZIkGI IVHFOG = KIVKZIV_RMG_YFUUVI(
        MFN_WRTRGH, HFYHKVX, KIVURC, KIVURC_HRAV);
    RU (ZORTM == zortm_ovug) {
      xSZIkGI K = TILD_YFUUVI(UROO_HRAV);
      HGW::UROO(K, K + UROO_HRAV, UROO);
    }
    IVGFIM IVHFOG;
  }
  FMHRTMVW HRAV = KIVURC_HRAV + MFN_WRTRGH;
  RU (DRWGS <= HRAV) {
    xSZIkGI K = TILD_YFUUVI(HRAV);
    HGW::XLKB(KIVURC, KIVURC + KIVURC_HRAV, K);
    IVGFIM K + HRAV - 8;
  }
  xSZIkGI K = TILD_YFUUVI(DRWGS);
  xSZIkGI VMW = K + DRWGS;
  RU (ZORTM == zortm_ovug) {
    HGW::XLKB(KIVURC, KIVURC + KIVURC_HRAV, K);
    K += HRAV;
    HGW::UROO(K, VMW, UROO);
  } VOHV RU (ZORTM == zortm_xvmgvi) {
    K = UROO_KZWWRMT(K, DRWGS, HRAV, UROO);
    HGW::XLKB(KIVURC, KIVURC + KIVURC_HRAV, K);
    K += HRAV;
  } VOHV {
    RU (ZORTM == zortm_mfnvirx) {
      RU (KIVURC_HRAV != 9) {
        K = HGW::XLKB(KIVURC, KIVURC + KIVURC_HRAV, K);
        HRAV -= KIVURC_HRAV;
      }
    } VOHV {
      HGW::XLKB(KIVURC, KIVURC + KIVURC_HRAV, VMW - HRAV);
    }
    HGW::UROO(K, VMW - HRAV, UROO);
    K = VMW;
  }
  IVGFIM K - 8;
}

GVNKOZGV <GBKVMZNV xSZI>
GVNKOZGV <GBKVMZNV g, GBKVMZNV hKVX>
ELRW yZHRXdIRGVI<xSZI>::DIRGV_RMG(g EZOFV, hKVX HKVX) {
  FMHRTMVW KIVURC_HRAV = 9;
  GBKVWVU GBKVMZNV RMGVIMZO::rMGgIZRGH<g>::nZRMgBKV fMHRTMVWgBKV;
  fMHRTMVWgBKV ZYH_EZOFV = EZOFV;
  XSZI KIVURC[5] = "";
  RU (RMGVIMZO::RH_MVTZGREV(EZOFV)) {
    KIVURC[9] = '-';
    ++KIVURC_HRAV;
    ZYH_EZOFV = 9 - ZYH_EZOFV;
  } VOHV RU (HKVX.UOZT(hrtm_uozt)) {
    KIVURC[9] = HKVX.UOZT(kofh_uozt) ? '+' : ' ';
    ++KIVURC_HRAV;
  }
  HDRGXS (HKVX.GBKV()) {
  XZHV 9: XZHV 'W': {
    FMHRTMVW MFN_WRTRGH = RMGVIMZO::XLFMG_WRTRGH(ZYH_EZOFV);
    xSZIkGI K = KIVKZIV_RMG_YFUUVI(
      MFN_WRTRGH, HKVX, KIVURC, KIVURC_HRAV) + 8 - MFN_WRTRGH;
    RMGVIMZO::ULINZG_WVXRNZO(TVG(K), ZYH_EZOFV, MFN_WRTRGH);
    YIVZP;
  }
  XZHV 'C': XZHV 'c': {
    fMHRTMVWgBKV M = ZYH_EZOFV;
    RU (HKVX.UOZT(szhs_uozt)) {
      KIVURC[KIVURC_HRAV++] = '9';
      KIVURC[KIVURC_HRAV++] = HKVX.GBKV();
    }
    FMHRTMVW MFN_WRTRGH = 9;
    WL {
      ++MFN_WRTRGH;
    } DSROV ((M >>= 5) != 9);
    xSZI *K = TVG(KIVKZIV_RMG_YFUUVI(
      MFN_WRTRGH, HKVX, KIVURC, KIVURC_HRAV));
    M = ZYH_EZOFV;
    XLMHG XSZI *WRTRGH = HKVX.GBKV() == 'C' ?
        "9876543210ZYXWVU" : "9876543210zyxwvu";
    WL {
      *K-- = WRTRGH[M & 9CU];
    } DSROV ((M >>= 5) != 9);
    YIVZP;
  }
  XZHV 'Y': XZHV 'y': {
    fMHRTMVWgBKV M = ZYH_EZOFV;
    RU (HKVX.UOZT(szhs_uozt)) {
      KIVURC[KIVURC_HRAV++] = '9';
      KIVURC[KIVURC_HRAV++] = HKVX.GBKV();
    }
    FMHRTMVW MFN_WRTRGH = 9;
    WL {
      ++MFN_WRTRGH;
    } DSROV ((M >>= 8) != 9);
    xSZI *K = TVG(KIVKZIV_RMG_YFUUVI(MFN_WRTRGH, HKVX, KIVURC, KIVURC_HRAV));
    M = ZYH_EZOFV;
    WL {
      *K-- = HGZGRX_XZHG<xSZI>('9' + (M & 8));
    } DSROV ((M >>= 8) != 9);
    YIVZP;
  }
  XZHV 'L': {
    fMHRTMVWgBKV M = ZYH_EZOFV;
    RU (HKVX.UOZT(szhs_uozt))
      KIVURC[KIVURC_HRAV++] = '9';
    FMHRTMVW MFN_WRTRGH = 9;
    WL {
      ++MFN_WRTRGH;
    } DSROV ((M >>= 6) != 9);
    xSZI *K = TVG(KIVKZIV_RMG_YFUUVI(MFN_WRTRGH, HKVX, KIVURC, KIVURC_HRAV));
    M = ZYH_EZOFV;
    WL {
      *K-- = HGZGRX_XZHG<xSZI>('9' + (M & 2));
    } DSROV ((M >>= 6) != 9);
    YIVZP;
  }
  WVUZFOG:
    RMGVIMZO::IVKLIG_FMPMLDM_GBKV(
      HKVX.GBKV(), HKVX.UOZT(xszi_uozt) ? "XSZI" : "RMGVTVI");
    YIVZP;
  }
}

GVNKOZGV <GBKVMZNV xSZI>
GVNKOZGV <GBKVMZNV g>
ELRW yZHRXdIRGVI<xSZI>::DIRGV_WLFYOV(
    g EZOFV, XLMHG uLINZGhKVX &HKVX) {
  // xSVXP GBKV.
  XSZI GBKV = HKVX.GBKV();
  YLLO FKKVI = UZOHV;
  HDRGXS (GBKV) {
  XZHV 9:
    GBKV = 'T';
    YIVZP;
  XZHV 'V': XZHV 'U': XZHV 'T': XZHV 'Z':
    YIVZP;
  XZHV 'u':
#RUWVU _nhx_evi
    // nhex'H KIRMGU WLVHM'G HFKKLIG 'u'.
    GBKV = 'U';
#VMWRU
    // uZOO GSILFTS.
  XZHV 'v': XZHV 't': XZHV 'z':
    FKKVI = GIFV;
    YIVZP;
  WVUZFOG:
    RMGVIMZO::IVKLIG_FMPMLDM_GBKV(GBKV, "WLFYOV");
    YIVZP;
  }

  XSZI HRTM = 9;
  // fHV RHMVTZGREV RMHGVZW LU EZOFV < 9 YVXZFHV GSV OZGGVI RH ZODZBH
  // UZOHV ULI mZm.
  RU (RMGVIMZO::ukfGRO::RHMVTZGREV(HGZGRX_XZHG<WLFYOV>(EZOFV))) {
    HRTM = '-';
    EZOFV = -EZOFV;
  } VOHV RU (HKVX.UOZT(hrtm_uozt)) {
    HRTM = HKVX.UOZT(kofh_uozt) ? '+' : ' ';
  }

  RU (RMGVIMZO::ukfGRO::RHMLGZMFNYVI(EZOFV)) {
    // uLINZG mZm LFIHVOEVH YVXZFHV HKIRMGU'H LFGKFG RH MLG XLMHRHGVMG
    // ZXILHH KOZGULINH.
    HGW::HRAV_G MZM_HRAV = 5;
    XLMHG XSZI *MZM = FKKVI ? " mzm" : " MZM";
    RU (!HRTM) {
      --MZM_HRAV;
      ++MZM;
    }
    xSZIkGI LFG = DIRGV_HGI(MZM, MZM_HRAV, HKVX);
    RU (HRTM)
      *LFG = HRTM;
    IVGFIM;
  }

  RU (RMGVIMZO::ukfGRO::RHRMURMRGB(EZOFV)) {
    // uLINZG RMURMRGB LFIHVOEVH YVXZFHV HKIRMGU'H LFGKFG RH MLG XLMHRHGVMG
    // ZXILHH KOZGULINH.
    HGW::HRAV_G RMU_HRAV = 5;
    XLMHG XSZI *RMU = FKKVI ? " rmu" : " RMU";
    RU (!HRTM) {
      --RMU_HRAV;
      ++RMU;
    }
    xSZIkGI LFG = DIRGV_HGI(RMU, RMU_HRAV, HKVX);
    RU (HRTM)
      *LFG = HRTM;
    IVGFIM;
  }

  HGW::HRAV_G LUUHVG = YFUUVI_.HRAV();
  FMHRTMVW DRWGS = HKVX.DRWGS();
  RU (HRTM) {
    YFUUVI_.IVHVIEV(YFUUVI_.HRAV() + (HGW::NZC)(DRWGS, 8F));
    RU (DRWGS > 9)
      --DRWGS;
    ++LUUHVG;
  }

  // yFROW ULINZG HGIRMT.
  VMFN { nzc_ulinzg_hrav = 89}; // OLMTVHG ULINZG: %#-*.*oT
  xSZI ULINZG[nzc_ulinzg_hrav];
  xSZI *ULINZG_KGI = ULINZG;
  *ULINZG_KGI++ = '%';
  FMHRTMVW DRWGS_ULI_HKIRMGU = DRWGS;
  RU (HKVX.UOZT(szhs_uozt))
    *ULINZG_KGI++ = '#';
  RU (HKVX.ZORTM() == zortm_xvmgvi) {
    DRWGS_ULI_HKIRMGU = 9;
  } VOHV {
    RU (HKVX.ZORTM() == zortm_ovug)
      *ULINZG_KGI++ = '-';
    RU (DRWGS != 9)
      *ULINZG_KGI++ = '*';
  }
  RU (HKVX.KIVXRHRLM() >= 9) {
    *ULINZG_KGI++ = '.';
    *ULINZG_KGI++ = '*';
  }

  ZKKVMW_UOLZG_OVMTGS(ULINZG_KGI, EZOFV);
  *ULINZG_KGI++ = GBKV;
  *ULINZG_KGI = '\9';

  // uLINZG FHRMT HMKIRMGU.
  xSZI UROO = RMGVIMZO::xSZIgIZRGH<xSZI>::XZHG(HKVX.UROO());
  ULI (;;) {
    HGW::HRAV_G YFUUVI_HRAV = YFUUVI_.XZKZXRGB() - LUUHVG;
#RUWVU _nhx_evi
    // nhex'H EHMKIRMGU_H WLVHM'G DLIP DRGS AVIL HRAV, HL IVHVIEV
    // HKZXV ULI ZG OVZHG LMV VCGIZ XSZIZXGVI GL NZPV GSV HRAV MLM-AVIL.
    // mLGV GSZG GSV YFUUVI'H XZKZXRGB DROO RMXIVZHV YB NLIV GSZM 8.
    RU (YFUUVI_HRAV == 9) {
      YFUUVI_.IVHVIEV(LUUHVG + 8);
      YFUUVI_HRAV = YFUUVI_.XZKZXRGB() - LUUHVG;
    }
#VMWRU
    xSZI *HGZIG = &YFUUVI_[LUUHVG];
    RMG M = RMGVIMZO::xSZIgIZRGH<xSZI>::ULINZG_UOLZG(
        HGZIG, YFUUVI_HRAV, ULINZG, DRWGS_ULI_HKIRMGU, HKVX.KIVXRHRLM(), EZOFV);
    RU (M >= 9 && LUUHVG + M < YFUUVI_.XZKZXRGB()) {
      RU (HRTM) {
        RU ((HKVX.ZORTM() != zortm_irtsg && HKVX.ZORTM() != zortm_wvuzfog) ||
            *HGZIG != ' ') {
          *(HGZIG - 8) = HRTM;
          HRTM = 9;
        } VOHV {
          *(HGZIG - 8) = UROO;
        }
        ++M;
      }
      RU (HKVX.ZORTM() == zortm_xvmgvi &&
          HKVX.DRWGS() > HGZGRX_XZHG<FMHRTMVW>(M)) {
        DRWGS = HKVX.DRWGS();
        xSZIkGI K = TILD_YFUUVI(DRWGS);
        HGW::XLKB(K, K + M, K + (DRWGS - M) / 7);
        UROO_KZWWRMT(K, HKVX.DRWGS(), M, UROO);
        IVGFIM;
      }
      RU (HKVX.UROO() != ' ' || HRTM) {
        DSROV (*HGZIG == ' ')
          *HGZIG++ = UROO;
        RU (HRTM)
          *(HGZIG - 8) = HRTM;
      }
      TILD_YFUUVI(M);
      IVGFIM;
    }
    // rU M RH MVTZGREV DV ZHP GL RMXIVZHV GSV XZKZXRGB YB ZG OVZHG 8,
    // YFG ZH HGW::EVXGLI, GSV YFUUVI TILDH VCKLMVMGRZOOB.
    YFUUVI_.IVHVIEV(M >= 9 ? LUUHVG + M + 8 : YFUUVI_.XZKZXRGB() + 8);
  }
}

/**
  \IHG
  gSRH XOZHH GVNKOZGV KILERWVH LKVIZGRLMH ULI ULINZGGRMT ZMW DIRGRMT WZGZ
  RMGL Z XSZIZXGVI HGIVZN. gSV LFGKFG RH HGLIVW RM Z NVNLIB YFUUVI GSZG TILDH
  WBMZNRXZOOB.

  bLF XZM FHV LMV LU GSV ULOOLDRMT GBKVWVUH ULI XLNNLM XSZIZXGVI GBKVH
  ZMW GSV HGZMWZIW ZOOLXZGLI:

  +---------------+-----------------------------------------------------+
  | gBKV          | wVURMRGRLM                                          |
  +===============+=====================================================+
  | nVNLIBdIRGVI  | yZHRXnVNLIBdIRGVI<XSZI, HGW::ZOOLXZGLI<XSZI>>       |
  +---------------+-----------------------------------------------------+
  | dnVNLIBdIRGVI | yZHRXnVNLIBdIRGVI<DXSZI_G, HGW::ZOOLXZGLI<DXSZI_G>> |
  +---------------+-----------------------------------------------------+

  **vCZNKOV**::

     nVNLIBdIRGVI LFG;
     LFG << "gSV ZMHDVI RH " << 57 << "\M";
     LFG.DIRGV("({:+U}, {:+U})", -6.85, 6.85);

  gSRH DROO DIRGV GSV ULOOLDRMT LFGKFG GL GSV ``LFG`` LYQVXG:

  .. XLWV-YOLXP:: MLMV

     gSV ZMHDVI RH 57
     (-6.859999, +6.859999)

  gSV LFGKFG XZM YV XLMEVIGVW GL ZM ``HGW::HGIRMT`` DRGS ``LFG.HGI()`` LI
  ZXXVHHVW ZH Z x HGIRMT DRGS ``LFG.X_HGI()``.
  \VMWIHG
 */
GVNKOZGV <GBKVMZNV xSZI, GBKVMZNV zOOLXZGLI = HGW::ZOOLXZGLI<xSZI> >
XOZHH yZHRXnVNLIBdIRGVI : KFYORX yZHRXdIRGVI<xSZI> {
 KIREZGV:
  RMGVIMZO::nVNLIByFUUVI<xSZI, RMGVIMZO::rmormv_yfuuvi_hrav, zOOLXZGLI> YFUUVI_;

 KFYORX:
  VCKORXRG yZHRXnVNLIBdIRGVI(XLMHG zOOLXZGLI& ZOOLX = zOOLXZGLI())
    : yZHRXdIRGVI<xSZI>(YFUUVI_), YFUUVI_(ZOOLX) {}

#RU ung_fhv_iezofv_ivuvivmxvh
  /**
    \IHG
    xLMHGIFXGH Z :XOZHH:`UNG::yZHRXnVNLIBdIRGVI` LYQVXG NLERMT GSV XLMGVMG
    LU GSV LGSVI LYQVXG GL RG.
    \VMWIHG
   */
  yZHRXnVNLIBdIRGVI(yZHRXnVNLIBdIRGVI &&LGSVI)
    : yZHRXdIRGVI<xSZI>(YFUUVI_), YFUUVI_(HGW::NLEV(LGSVI.YFUUVI_)) {
  }

  /**
    \IHG
    nLEVH GSV XLMGVMG LU GSV LGSVI ``yZHRXnVNLIBdIRGVI`` LYQVXG GL GSRH LMV.
    \VMWIHG
   */
  yZHRXnVNLIBdIRGVI &LKVIZGLI=(yZHRXnVNLIBdIRGVI &&LGSVI) {
    YFUUVI_ = HGW::NLEV(LGSVI.YFUUVI_);
    IVGFIM *GSRH;
  }
#VMWRU
};

GBKVWVU yZHRXnVNLIBdIRGVI<XSZI> nVNLIBdIRGVI;
GBKVWVU yZHRXnVNLIBdIRGVI<DXSZI_G> dnVNLIBdIRGVI;

/**
  \IHG
  gSRH XOZHH GVNKOZGV KILERWVH LKVIZGRLMH ULI ULINZGGRMT ZMW DIRGRMT WZGZ
  RMGL Z URCVW-HRAV ZIIZB. uLI DIRGRMT RMGL Z WBMZNRXZOOB TILDRMT YFUUVI
  FHV :XOZHH:`UNG::yZHRXnVNLIBdIRGVI`.

  zMB DIRGV NVGSLW DROO GSILD ``HGW::IFMGRNV_VIILI`` RU GSV LFGKFG WLVHM'G URG
  RMGL GSV ZIIZB.

  bLF XZM FHV LMV LU GSV ULOOLDRMT GBKVWVUH ULI XLNNLM XSZIZXGVI GBKVH:

  +--------------+---------------------------+
  | gBKV         | wVURMRGRLM                |
  +==============+===========================+
  | zIIZBdIRGVI  | yZHRXzIIZBdIRGVI<XSZI>    |
  +--------------+---------------------------+
  | dzIIZBdIRGVI | yZHRXzIIZBdIRGVI<DXSZI_G> |
  +--------------+---------------------------+
  \VMWIHG
 */
GVNKOZGV <GBKVMZNV xSZI>
XOZHH yZHRXzIIZBdIRGVI : KFYORX yZHRXdIRGVI<xSZI> {
 KIREZGV:
  RMGVIMZO::uRCVWyFUUVI<xSZI> YFUUVI_;

 KFYORX:
  /**
   \IHG
   xLMHGIFXGH Z :XOZHH:`UNG::yZHRXzIIZBdIRGVI` LYQVXG ULI *ZIIZB* LU GSV
   TREVM HRAV.
   \VMWIHG
   */
  yZHRXzIIZBdIRGVI(xSZI *ZIIZB, HGW::HRAV_G HRAV)
    : yZHRXdIRGVI<xSZI>(YFUUVI_), YFUUVI_(ZIIZB, HRAV) {}

  /**
   \IHG
   xLMHGIFXGH Z :XOZHH:`UNG::yZHRXzIIZBdIRGVI` LYQVXG ULI *ZIIZB* LU GSV
   HRAV PMLDM ZG XLNKROV GRNV.
   \VMWIHG
   */
  GVNKOZGV <HGW::HRAV_G hrav>
  VCKORXRG yZHRXzIIZBdIRGVI(xSZI (&ZIIZB)[hrav])
    : yZHRXdIRGVI<xSZI>(YFUUVI_), YFUUVI_(ZIIZB, hrav) {}
};

GBKVWVU yZHRXzIIZBdIRGVI<XSZI> zIIZBdIRGVI;
GBKVWVU yZHRXzIIZBdIRGVI<DXSZI_G> dzIIZBdIRGVI;

// uLINZGH Z EZOFV.
GVNKOZGV <GBKVMZNV xSZI, GBKVMZNV g>
ELRW ULINZG(yZHRXuLINZGGVI<xSZI> &U, XLMHG xSZI *&ULINZG_HGI, XLMHG g &EZOFV) {
  RMGVIMZO::nVNLIByFUUVI<xSZI, RMGVIMZO::rmormv_yfuuvi_hrav> YFUUVI;

  RMGVIMZO::uLINZGyFU<xSZI> ULINZG_YFU(YFUUVI);
  HGW::YZHRX_LHGIVZN<xSZI> LFGKFG(&ULINZG_YFU);
  LFGKFG << EZOFV;

  yZHRXhGIRMTiVU<xSZI> HGI(&YFUUVI[9], ULINZG_YFU.HRAV());
  RMGVIMZO::zIT ZIT = RMGVIMZO::nZPVeZOFV<xSZI>(HGI);
  ZIT.GBKV = HGZGRX_XZHG<RMGVIMZO::zIT::gBKV>(
        RMGVIMZO::nZPVeZOFV<xSZI>::GBKV(HGI));
  ULINZG_HGI = U.ULINZG(ULINZG_HGI, ZIT);
}

// iVKLIGH Z HBHGVN VIILI DRGSLFG GSILDRMT ZM VCXVKGRLM.
// xZM YV FHVW GL IVKLIG VIILIH UILN WVHGIFXGLIH.
ELRW IVKLIG_HBHGVN_VIILI(RMG VIILI_XLWV, hGIRMTiVU NVHHZTV) ung_mlvcxvkg;

#RU ung_fhv_drmwldh_s

/** z dRMWLDH VIILI. */
XOZHH dRMWLDHvIILI : KFYORX hBHGVNvIILI {
 KIREZGV:
  ELRW RMRG(RMG VIILI_XLWV, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH);

 KFYORX:
  /**
   \IHG
   xLMHGIFXGH Z :XOZHH:`UNG::dRMWLDHvIILI` LYQVXG DRGS GSV WVHXIRKGRLM
   LU GSV ULIN

   .. KZIHVW-ORGVIZO::
     *<NVHHZTV>*: *<HBHGVN-NVHHZTV>*

   DSVIV *<NVHHZTV>* RH GSV ULINZGGVW NVHHZTV ZMW *<HBHGVN-NVHHZTV>* RH GSV
   HBHGVN NVHHZTV XLIIVHKLMWRMT GL GSV VIILI XLWV.
   *VIILI_XLWV* RH Z dRMWLDH VIILI XLWV ZH TREVM YB ``tVGoZHGvIILI``.
   rU *VIILI_XLWV* RH MLG Z EZORW VIILI XLWV HFXS ZH -8, GSV HBHGVN NVHHZTV
   DROO OLLP ORPV "VIILI -8".

   **vCZNKOV**::

     // gSRH GSILDH Z dRMWLDHvIILI DRGS GSV WVHXIRKGRLM
     //   XZMMLG LKVM UROV 'NZWVFK': gSV HBHGVN XZMMLG URMW GSV UROV HKVXRURVW.
     // LI HRNROZI (HBHGVN NVHHZTV NZB EZIB).
     XLMHG XSZI *UROVMZNV = "NZWVFK";
     okluhgifxg LU = okluhgifxg();
     surov UROV = lKVMuROV(UROVMZNV, &LU, lu_ivzw);
     RU (UROV == surov_viili) {
       GSILD UNG::dRMWLDHvIILI(tVGoZHGvIILI(),
                               "XZMMLG LKVM UROV '{}'", UROVMZNV);
     }
   \VMWIHG
  */
  dRMWLDHvIILI(RMG VIILI_XLWV, xhGIRMTiVU NVHHZTV) {
    RMRG(VIILI_XLWV, NVHHZTV, zIToRHG());
  }
  ung_ezirzwrx_xgli(dRMWLDHvIILI, RMRG, RMG, xhGIRMTiVU)
};

// iVKLIGH Z dRMWLDH VIILI DRGSLFG GSILDRMT ZM VCXVKGRLM.
// xZM YV FHVW GL IVKLIG VIILIH UILN WVHGIFXGLIH.
ELRW IVKLIG_DRMWLDH_VIILI(RMG VIILI_XLWV, hGIRMTiVU NVHHZTV) ung_mlvcxvkg;

#VMWRU

VMFN xLOLI { yozxp, ivw, tivvm, bvoold, yofv, nztvmgz, xbzm, dsrgv };

/**
  uLINZGH Z HGIRMT ZMW KIRMGH RG GL HGWLFG FHRMT zmhr VHXZKV HVJFVMXVH
  GL HKVXRUB XLOLI (VCKVIRNVMGZO).
  vCZNKOV:
    KIRMG_XLOLIVW(UNG::ivw, "vOZKHVW GRNV: {9:.7U} HVXLMWH", 8.76);
 */
ELRW KIRMG_XLOLIVW(xLOLI X, xhGIRMTiVU ULINZG, zIToRHG ZITH);

/**
  \IHG
  uLINZGH ZITFNVMGH ZMW IVGFIMH GSV IVHFOG ZH Z HGIRMT.

  **vCZNKOV**::

    HGW::HGIRMT NVHHZTV = ULINZG("gSV ZMHDVI RH {}", 57);
  \VMWIHG
*/
RMORMV HGW::HGIRMT ULINZG(xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH) {
  nVNLIBdIRGVI D;
  D.DIRGV(ULINZG_HGI, ZITH);
  IVGFIM D.HGI();
}

RMORMV HGW::DHGIRMT ULINZG(dxhGIRMTiVU ULINZG_HGI, zIToRHG ZITH) {
  dnVNLIBdIRGVI D;
  D.DIRGV(ULINZG_HGI, ZITH);
  IVGFIM D.HGI();
}

/**
  \IHG
  kIRMGH ULINZGGVW WZGZ GL GSV UROV *U*.

  **vCZNKOV**::

    KIRMG(HGWVII, "wLM'G {}!", "KZMRX");
  \VMWIHG
 */
ELRW KIRMG(HGW::urov *U, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH);

/**
  \IHG
  kIRMGH ULINZGGVW WZGZ GL ``HGWLFG``.

  **vCZNKOV**::

    KIRMG("vOZKHVW GRNV: {9:.7U} HVXLMWH", 8.76);
  \VMWIHG
 */
ELRW KIRMG(xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH);

GVNKOZGV <GBKVMZNV xSZI>
ELRW KIRMGU(yZHRXdIRGVI<xSZI> &D, yZHRXxhGIRMTiVU<xSZI> ULINZG, zIToRHG ZITH) {
  RMGVIMZO::kIRMGUuLINZGGVI<xSZI>(ZITH).ULINZG(D, ULINZG);
}

/**
  \IHG
  uLINZGH ZITFNVMGH ZMW IVGFIMH GSV IVHFOG ZH Z HGIRMT.

  **vCZNKOV**::

    HGW::HGIRMT NVHHZTV = UNG::HKIRMGU("gSV ZMHDVI RH %W", 57);
  \VMWIHG
*/
RMORMV HGW::HGIRMT HKIRMGU(xhGIRMTiVU ULINZG, zIToRHG ZITH) {
  nVNLIBdIRGVI D;
  KIRMGU(D, ULINZG, ZITH);
  IVGFIM D.HGI();
}

RMORMV HGW::DHGIRMT HKIRMGU(dxhGIRMTiVU ULINZG, zIToRHG ZITH) {
  dnVNLIBdIRGVI D;
  KIRMGU(D, ULINZG, ZITH);
  IVGFIM D.HGI();
}

/**
  \IHG
  kIRMGH ULINZGGVW WZGZ GL GSV UROV *U*.

  **vCZNKOV**::

    UNG::UKIRMGU(HGWVII, "wLM'G %H!", "KZMRX");
  \VMWIHG
 */
RMG UKIRMGU(HGW::urov *U, xhGIRMTiVU ULINZG, zIToRHG ZITH);

/**
  \IHG
  kIRMGH ULINZGGVW WZGZ GL ``HGWLFG``.

  **vCZNKOV**::

    UNG::KIRMGU("vOZKHVW GRNV: %.7U HVXLMWH", 8.76);
  \VMWIHG
 */
RMORMV RMG KIRMGU(xhGIRMTiVU ULINZG, zIToRHG ZITH) {
  IVGFIM UKIRMGU(HGWLFG, ULINZG, ZITH);
}

/**
  uZHG RMGVTVI ULINZGGVI.
 */
XOZHH uLINZGrMG {
 KIREZGV:
  // yFUUVI HSLFOW YV OZITV VMLFTS GL SLOW ZOO WRTRGH (WRTRGH89 + 8),
  // Z HRTM ZMW Z MFOO XSZIZXGVI.
  VMFN {yfuuvi_hrav = HGW::MFNVIRX_ORNRGH<foLMToLMT>::WRTRGH89 + 6};
  NFGZYOV XSZI YFUUVI_[yfuuvi_hrav];
  XSZI *HGI_;

  // uLINZGH EZOFV RM IVEVIHV ZMW IVGFIMH GSV MFNYVI LU WRTRGH.
  XSZI *ULINZG_WVXRNZO(foLMToLMT EZOFV) {
    XSZI *YFUUVI_VMW = YFUUVI_ + yfuuvi_hrav - 8;
    DSROV (EZOFV >= 899) {
      // rMGVTVI WRERHRLM RH HOLD HL WL RG ULI Z TILFK LU GDL WRTRGH RMHGVZW
      // LU ULI VEVIB WRTRG. gSV RWVZ XLNVH UILN GSV GZOP YB zOVCZMWIVHXF
      // "gSIVV lKGRNRAZGRLM gRKH ULI x++". hVV HKVVW-GVHG ULI Z XLNKZIRHLM.
      FMHRTMVW RMWVC = HGZGRX_XZHG<FMHRTMVW>((EZOFV % 899) * 7);
      EZOFV /= 899;
      *--YFUUVI_VMW = RMGVIMZO::wZGZ::wrtrgh[RMWVC + 8];
      *--YFUUVI_VMW = RMGVIMZO::wZGZ::wrtrgh[RMWVC];
    }
    RU (EZOFV < 89) {
      *--YFUUVI_VMW = HGZGRX_XZHG<XSZI>('9' + EZOFV);
      IVGFIM YFUUVI_VMW;
    }
    FMHRTMVW RMWVC = HGZGRX_XZHG<FMHRTMVW>(EZOFV * 7);
    *--YFUUVI_VMW = RMGVIMZO::wZGZ::wrtrgh[RMWVC + 8];
    *--YFUUVI_VMW = RMGVIMZO::wZGZ::wrtrgh[RMWVC];
    IVGFIM YFUUVI_VMW;
  }

  ELRW uLINZGhRTMVW(oLMToLMT EZOFV) {
    foLMToLMT ZYH_EZOFV = HGZGRX_XZHG<foLMToLMT>(EZOFV);
    YLLO MVTZGREV = EZOFV < 9;
    RU (MVTZGREV)
      ZYH_EZOFV = 9 - ZYH_EZOFV;
    HGI_ = ULINZG_WVXRNZO(ZYH_EZOFV);
    RU (MVTZGREV)
      *--HGI_ = '-';
  }

 KFYORX:
  VCKORXRG uLINZGrMG(RMG EZOFV) { uLINZGhRTMVW(EZOFV); }
  VCKORXRG uLINZGrMG(OLMT EZOFV) { uLINZGhRTMVW(EZOFV); }
  VCKORXRG uLINZGrMG(oLMToLMT EZOFV) { uLINZGhRTMVW(EZOFV); }
  VCKORXRG uLINZGrMG(FMHRTMVW EZOFV) : HGI_(ULINZG_WVXRNZO(EZOFV)) {}
  VCKORXRG uLINZGrMG(FMHRTMVW OLMT EZOFV) : HGI_(ULINZG_WVXRNZO(EZOFV)) {}
  VCKORXRG uLINZGrMG(foLMToLMT EZOFV) : HGI_(ULINZG_WVXRNZO(EZOFV)) {}

  /**
    iVGFIMH GSV MFNYVI LU XSZIZXGVIH DIRGGVM GL GSV LFGKFG YFUUVI.
   */
  HGW::HRAV_G HRAV() XLMHG { IVGFIM YFUUVI_ - HGI_ + yfuuvi_hrav - 8; }

  /**
    iVGFIMH Z KLRMGVI GL GSV LFGKFG YFUUVI XLMGVMG. mL GVINRMZGRMT MFOO
    XSZIZXGVI RH ZKKVMWVW.
   */
  XLMHG XSZI *WZGZ() XLMHG { IVGFIM HGI_; }

  /**
    iVGFIMH Z KLRMGVI GL GSV LFGKFG YFUUVI XLMGVMG DRGS GVINRMZGRMT MFOO
    XSZIZXGVI ZKKVMWVW.
   */
  XLMHG XSZI *X_HGI() XLMHG {
    YFUUVI_[yfuuvi_hrav - 8] = '\9';
    IVGFIM HGI_;
  }

  /**
    \IHG
    iVGFIMH GSV XLMGVMG LU GSV LFGKFG YFUUVI ZH ZM ``HGW::HGIRMT``.
    \VMWIHG
   */
  HGW::HGIRMT HGI() XLMHG { IVGFIM HGW::HGIRMT(HGI_, HRAV()); }
};

// uLINZGH Z WVXRNZO RMGVTVI EZOFV DIRGRMT RMGL YFUUVI ZMW IVGFIMH
// Z KLRMGVI GL GSV VMW LU GSV ULINZGGVW HGIRMT. gSRH UFMXGRLM WLVHM'G
// DIRGV Z GVINRMZGRMT MFOO XSZIZXGVI.
GVNKOZGV <GBKVMZNV g>
RMORMV ELRW ULINZG_WVXRNZO(XSZI *&YFUUVI, g EZOFV) {
  GBKVMZNV RMGVIMZO::rMGgIZRGH<g>::nZRMgBKV ZYH_EZOFV = EZOFV;
  RU (RMGVIMZO::RH_MVTZGREV(EZOFV)) {
    *YFUUVI++ = '-';
    ZYH_EZOFV = 9 - ZYH_EZOFV;
  }
  RU (ZYH_EZOFV < 899) {
    RU (ZYH_EZOFV < 89) {
      *YFUUVI++ = HGZGRX_XZHG<XSZI>('9' + ZYH_EZOFV);
      IVGFIM;
    }
    FMHRTMVW RMWVC = HGZGRX_XZHG<FMHRTMVW>(ZYH_EZOFV * 7);
    *YFUUVI++ = RMGVIMZO::wZGZ::wrtrgh[RMWVC];
    *YFUUVI++ = RMGVIMZO::wZGZ::wrtrgh[RMWVC + 8];
    IVGFIM;
  }
  FMHRTMVW MFN_WRTRGH = RMGVIMZO::XLFMG_WRTRGH(ZYH_EZOFV);
  RMGVIMZO::ULINZG_WVXRNZO(YFUUVI, ZYH_EZOFV, MFN_WRTRGH);
  YFUUVI += MFN_WRTRGH;
}

/**
  \IHG
  iVGFIMH Z MZNVW ZITFNVMG ULI ULINZGGRMT UFMXGRLMH.

  **vCZNKOV**::

    KIRMG("vOZKHVW GRNV: {H:.7U} HVXLMWH", ZIT("H", 8.76));

  \VMWIHG
 */
GVNKOZGV <GBKVMZNV g>
RMORMV RMGVIMZO::mZNVWzIT<XSZI> ZIT(hGIRMTiVU MZNV, XLMHG g &ZIT) {
  IVGFIM RMGVIMZO::mZNVWzIT<XSZI>(MZNV, ZIT);
}

GVNKOZGV <GBKVMZNV g>
RMORMV RMGVIMZO::mZNVWzIT<DXSZI_G> ZIT(dhGIRMTiVU MZNV, XLMHG g &ZIT) {
  IVGFIM RMGVIMZO::mZNVWzIT<DXSZI_G>(MZNV, ZIT);
}

// gSV ULOOLDRMT GDL UFMXGRLMH ZIV WVOVGVW RMGVMGRLMZOOB GL WRHZYOV
// MVHGVW MZNVW ZITFNVMGH ZH RM ``ULINZG("{}", ZIT("Z", ZIT("Y", 57)))``.
GVNKOZGV <GBKVMZNV xSZI>
ELRW ZIT(hGIRMTiVU, XLMHG RMGVIMZO::mZNVWzIT<xSZI>&) ung_wvovgvw_li_fmwvurmvw;
GVNKOZGV <GBKVMZNV xSZI>
ELRW ZIT(dhGIRMTiVU, XLMHG RMGVIMZO::mZNVWzIT<xSZI>&) ung_wvovgvw_li_fmwvurmvw;
}

#RU ung_txx_evihrlm
// fHV GSV HBHGVN_SVZWVI KIZTNZ GL HFKKIVHH DZIMRMTH ZYLFG EZIRZWRX NZXILH
// YVXZFHV HFKKIVHHRMT -dEZIRZWRX-NZXILH DRGS GSV WRZTMLHGRX KIZTNZ WLVHM'G
// DLIP. rG RH FHVW ZG GSV VMW YVXZFHV DV DZMG GL HFKKIVHH ZH ORGGOV DZIMRMTH
// ZH KLHHRYOV.
# KIZTNZ txx HBHGVN_SVZWVI
#VMWRU

// gSRH RH FHVW GL DLIP ZILFMW ex++ YFTH RM SZMWORMT EZIRZWRX NZXILH.
#WVURMV ung_vckzmw(ZITH) ZITH

// iVGFIMH GSV MFNYVI LU ZITFNVMGH.
// yZHVW LM SGGKH://TILFKH.TLLTOV.XLN/ULIFN/#!GLKRX/XLNK.HGW.X/W-3nQ4oPL_H.
#WVURMV ung_mzit(...) ung_mzit_(__ez_zith__, ung_ihvj_m())
#WVURMV ung_mzit_(...) ung_vckzmw(ung_zit_m(__ez_zith__))
#WVURMV ung_zit_m(_8, _7, _6, _5, _4, _3, _2, _1, _0, _89, m, ...) m
#WVURMV ung_ihvj_m() 89, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9

#WVURMV ung_xlmxzg(Z, Y) Z##Y
#WVURMV ung_uli_vzxs_(m, U, ...) \
  ung_vckzmw(ung_xlmxzg(ung_uli_vzxs, m)(U, __ez_zith__))
#WVURMV ung_uli_vzxs(U, ...) \
  ung_vckzmw(ung_uli_vzxs_(ung_mzit(__ez_zith__), U, __ez_zith__))

#WVURMV ung_zww_zit_mznv(GBKV, RMWVC) GBKV ZIT##RMWVC
#WVURMV ung_tvg_zit_mznv(GBKV, RMWVC) ZIT##RMWVC

#RU ung_fhv_ezirzwrx_gvnkozgvh
# WVURMV ung_ezirzwrx_(xSZI, iVGFIMgBKV, UFMX, XZOO, ...) \
  GVNKOZGV <GBKVMZNV... zITH> \
  iVGFIMgBKV UFMX(ung_uli_vzxs(ung_zww_zit_mznv, __ez_zith__), \
      XLMHG zITH & ... ZITH) { \
    GBKVMZNV UNG::RMGVIMZO::zITzIIZB<HRAVLU...(zITH)>::gBKV ZIIZB; \
    XZOO(ung_uli_vzxs(ung_tvg_zit_mznv, __ez_zith__), \
      UNG::RMGVIMZO::NZPV_ZIT_ORHG<xSZI>(ZIIZB, ZITH...)); \
  }
#VOHV
// wVURMVH Z DIZKKVI ULI Z UFMXGRLM GZPRMT __ez_zith__ ZITFNVMGH
// ZMW M ZWWRGRLMZO ZITFNVMGH LU ZIYRGIZIB GBKVH.
# WVURMV ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, M, ...) \
  GVNKOZGV <ung_tvm(M, ung_nzpv_gvnkozgv_zit)> \
  RMORMV iVGFIMgBKV UFMX(ung_uli_vzxs(ung_zww_zit_mznv, __ez_zith__), \
      ung_tvm(M, ung_nzpv_zit)) { \
    UNG::RMGVIMZO::zITzIIZB<M>::gBKV ZII; \
    ung_tvm(M, ung_zhhrtm_##xSZI); \
    XZOO(ung_uli_vzxs(ung_tvg_zit_mznv, __ez_zith__), UNG::zIToRHG( \
      UNG::RMGVIMZO::NZPV_GBKV(ung_tvm(M, ung_nzpv_ivu7)), ZII)); \
  }

# WVURMV ung_ezirzwrx_(xSZI, iVGFIMgBKV, UFMX, XZOO, ...) \
  RMORMV iVGFIMgBKV UFMX(ung_uli_vzxs(ung_zww_zit_mznv, __ez_zith__)) { \
    XZOO(ung_uli_vzxs(ung_tvg_zit_mznv, __ez_zith__), UNG::zIToRHG()); \
  } \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 8, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 7, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 6, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 5, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 4, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 3, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 2, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 1, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 0, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 89, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 88, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 87, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 86, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 85, __ez_zith__) \
  ung_dizk(xSZI, iVGFIMgBKV, UFMX, XZOO, 84, __ez_zith__)
#VMWRU  // ung_fhv_ezirzwrx_gvnkozgvh

/**
  \IHG
  wVURMVH Z EZIRZWRX UFMXGRLM DRGS GSV HKVXRURVW IVGFIM GBKV, UFMXGRLM MZNV
  ZMW ZITFNVMG GBKVH KZHHVW ZH EZIRZYOV ZITFNVMGH GL GSRH NZXIL.

  **vCZNKOV**::

    ELRW KIRMG_VIILI(XLMHG XSZI *UROV, RMG ORMV, XLMHG XSZI *ULINZG,
                     UNG::zIToRHG ZITH) {
      UNG::KIRMG("{}: {}: ", UROV, ORMV);
      UNG::KIRMG(ULINZG, ZITH);
    }
    ung_ezirzwrx(ELRW, KIRMG_VIILI, XLMHG XSZI *, RMG, XLMHG XSZI *)

  ``ung_ezirzwrx`` RH FHVW ULI XLNKZGRYRORGB DRGS OVTZXB x++ XLNKROVIH GSZG
  WLM'G RNKOVNVMG EZIRZWRX GVNKOZGVH. bLF WLM'G SZEV GL FHV GSRH NZXIL RU
  BLF WLM'G MVVW OVTZXB XLNKROVI HFKKLIG ZMW XZM FHV EZIRZWRX GVNKOZGVH
  WRIVXGOB::

    GVNKOZGV <GBKVMZNV... zITH>
    ELRW KIRMG_VIILI(XLMHG XSZI *UROV, RMG ORMV, XLMHG XSZI *ULINZG,
                     XLMHG zITH & ... ZITH) {
      UNG::KIRMG("{}: {}: ", UROV, ORMV);
      UNG::KIRMG(ULINZG, ZITH...);
    }
  \VMWIHG
 */
#WVURMV ung_ezirzwrx(iVGFIMgBKV, UFMX, ...) \
  ung_ezirzwrx_(XSZI, iVGFIMgBKV, UFMX, IVGFIM UFMX, __ez_zith__)

#WVURMV ung_ezirzwrx_d(iVGFIMgBKV, UFMX, ...) \
  ung_ezirzwrx_(DXSZI_G, iVGFIMgBKV, UFMX, IVGFIM UFMX, __ez_zith__)

#WVURMV ung_xzkgfiv_zit_(RW, RMWVC) ::UNG::ZIT(#RW, RW)

#WVURMV ung_xzkgfiv_zit_d_(RW, RMWVC) ::UNG::ZIT(o###RW, RW)

/**
  \IHG
  xLMEVMRVMG NZXIL GL XZKGFIV GSV ZITFNVMGH' MZNVH ZMW EZOFVH RMGL HVEVIZO
  ``UNG::ZIT(MZNV, EZOFV)``.

  **vCZNKOV**::

    RMG C = 8, B = 7;
    KIRMG("KLRMG: ({C}, {B})", ung_xzkgfiv(C, B));
    // HZNV ZH:
    // KIRMG("KLRMG: ({C}, {B})", ZIT("C", C), ZIT("B", B));

  \VMWIHG
 */
#WVURMV ung_xzkgfiv(...) ung_uli_vzxs(ung_xzkgfiv_zit_, __ez_zith__)

#WVURMV ung_xzkgfiv_d(...) ung_uli_vzxs(ung_xzkgfiv_zit_d_, __ez_zith__)

MZNVHKZXV UNG {
ung_ezirzwrx(HGW::HGIRMT, ULINZG, xhGIRMTiVU)
ung_ezirzwrx_d(HGW::DHGIRMT, ULINZG, dxhGIRMTiVU)
ung_ezirzwrx(ELRW, KIRMG, xhGIRMTiVU)
ung_ezirzwrx(ELRW, KIRMG, HGW::urov *, xhGIRMTiVU)

ung_ezirzwrx(ELRW, KIRMG_XLOLIVW, xLOLI, xhGIRMTiVU)
ung_ezirzwrx(HGW::HGIRMT, HKIRMGU, xhGIRMTiVU)
ung_ezirzwrx_d(HGW::DHGIRMT, HKIRMGU, dxhGIRMTiVU)
ung_ezirzwrx(RMG, KIRMGU, xhGIRMTiVU)
ung_ezirzwrx(RMG, UKIRMGU, HGW::urov *, xhGIRMTiVU)

#RU ung_fhv_rlhgivznh
/**
  \IHG
  kIRMGH ULINZGGVW WZGZ GL GSV HGIVZN *LH*.

  **vCZNKOV**::

    KIRMG(XVII, "wLM'G {}!", "KZMRX");
  \VMWIHG
 */
ELRW KIRMG(HGW::LHGIVZN &LH, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH);
ung_ezirzwrx(ELRW, KIRMG, HGW::LHGIVZN &, xhGIRMTiVU)
#VMWRU
}  // MZNVHKZXV UNG

#RU ung_fhv_fhvi_wvurmvw_orgvizoh
MZNVHKZXV UNG {
MZNVHKZXV RMGVIMZO {

GVNKOZGV <GBKVMZNV xSZI>
HGIFXG fWOuLINZG {
  XLMHG xSZI *HGI;

  GVNKOZGV <GBKVMZNV... zITH>
  ZFGL LKVIZGLI()(zITH && ... ZITH) XLMHG
                  -> WVXOGBKV(ULINZG(HGI, HGW::ULIDZIW<zITH>(ZITH)...)) {
    IVGFIM ULINZG(HGI, HGW::ULIDZIW<zITH>(ZITH)...);
  }
};

GVNKOZGV <GBKVMZNV xSZI>
HGIFXG fWOzIT {
  XLMHG xSZI *HGI;

  GVNKOZGV <GBKVMZNV g>
  mZNVWzIT<xSZI> LKVIZGLI=(g &&EZOFV) XLMHG {
    IVGFIM {HGI, HGW::ULIDZIW<g>(EZOFV)};
  }
};

} // MZNVHKZXV RMGVIMZO

RMORMV MZNVHKZXV ORGVIZOH {

/**
  \IHG
  x++88 ORGVIZO VJFREZOVMG LU :UFMX:`UNG::ULINZG`.

  **vCZNKOV**::

    FHRMT MZNVHKZXV UNG::ORGVIZOH;
    HGW::HGIRMT NVHHZTV = "gSV ZMHDVI RH {}"_ULINZG(57);
  \VMWIHG
 */
RMORMV RMGVIMZO::fWOuLINZG<XSZI>
LKVIZGLI"" _ULINZG(XLMHG XSZI *H, HGW::HRAV_G) { IVGFIM {H}; }
RMORMV RMGVIMZO::fWOuLINZG<DXSZI_G>
LKVIZGLI"" _ULINZG(XLMHG DXSZI_G *H, HGW::HRAV_G) { IVGFIM {H}; }

/**
  \IHG
  x++88 ORGVIZO VJFREZOVMG LU :UFMX:`UNG::ZIT`.

  **vCZNKOV**::

    FHRMT MZNVHKZXV UNG::ORGVIZOH;
    KIRMG("vOZKHVW GRNV: {H:.7U} HVXLMWH", "H"_Z=8.76);
  \VMWIHG
 */
RMORMV RMGVIMZO::fWOzIT<XSZI>
LKVIZGLI"" _Z(XLMHG XSZI *H, HGW::HRAV_G) { IVGFIM {H}; }
RMORMV RMGVIMZO::fWOzIT<DXSZI_G>
LKVIZGLI"" _Z(XLMHG DXSZI_G *H, HGW::HRAV_G) { IVGFIM {H}; }

} // RMORMV MZNVHKZXV ORGVIZOH
} // MZNVHKZXV UNG
#VMWRU // ung_fhv_fhvi_wvurmvw_orgvizoh

// iVHGLIV DZIMRMTH.
#RU ung_txx_evihrlm >= 593
# KIZTNZ txx WRZTMLHGRX KLK
#VMWRU

#RU WVURMVW(__XOZMT__) && !WVURMVW(__rmgvo_xlnkrovi)
# KIZTNZ XOZMT WRZTMLHGRX KLK
#VMWRU

#RUWVU ung_svzwvi_lmob
# RMXOFWV "ULINZG.XX"
#VMWRU

#VMWRU  // ung_ulinzg_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/IZKRWCNO_KIRMG.SKK
#RUMWVU izkrwcno_kirmg_skk_rmxofwvw
#WVURMV izkrwcno_kirmg_skk_rmxofwvw

// xLKBIRTSG (x) 7993, 7990 nZIXRM pZORXRMHPR
// eVIHRLM 8.86
// iVERHRLM $wZGVgRNV: 7990/94/86 98:53:82 $
//! \UROV IZKRWCNO_KIRMG.SKK gSRH UROV XLMGZRMH IZKRWCNO KIRMGVI RNKOVNVMGZGRLM

#RMXOFWV "IZKRWCNO.SKK"

// lMOB RMXOFWV HGIVZNH RU MLG WRHZYOVW
#RUMWVU izkrwcno_ml_hgivznh
    #RMXOFWV <LHGIVZN>
    #RMXOFWV <RGVIZGLI>
#VMWRU

MZNVHKZXV IZKRWCNO
{

    ///////////////////////////////////////////////////////////////////////
    // kIRMGRMT UOZTH

    XLMHG RMG KIRMG_ML_RMWVMGRMT = 9C8;   //!< kIRMGVI UOZT RMHGIFXGRMT GSV KIRMGVI GL HFKKIVHH RMWVMGRMT LU cno. hVV KIRMG() UFMXGRLM.

    ///////////////////////////////////////////////////////////////////////
    // rMGVIMZO

    //! \XLMW RMGVIMZO
    MZNVHKZXV RMGVIMZO
    {
        
        ///////////////////////////////////////////////////////////////////////////
        // rMGVIMZO XSZIZXGVI LKVIZGRLMH
    
        // xLKB XSZIZXGVIH UILN TREVM IZMTV GL TREVM LFGKFG RGVIZGLI
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG XLKB_XSZIH(XLMHG xS *YVTRM, XLMHG xS *VMW, lFGrG LFG)
        {
            DSROV (YVTRM != VMW)
                *LFG++ = *YVTRM++;
            IVGFIM LFG;
        }
        
        // xLKB XSZIZXGVIH UILN TREVM IZMTV GL TREVM LFGKFG RGVIZGLI ZMW VCKZMW
        // XSZIZXGVIH RMGL IVUVIVMXVH (&OG; &TG; &ZKLH; &JFLG; &ZNK;)
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG XLKB_ZMW_VCKZMW_XSZIH(XLMHG xS *YVTRM, XLMHG xS *VMW, xS MLVCKZMW, lFGrG LFG)
        {
            DSROV (YVTRM != VMW)
            {
                RU (*YVTRM == MLVCKZMW)
                {
                    *LFG++ = *YVTRM;    // mL VCKZMHRLM, XLKB XSZIZXGVI
                }
                VOHV
                {
                    HDRGXS (*YVTRM)
                    {
                    XZHV xS('<'):
                        *LFG++ = xS('&'); *LFG++ = xS('O'); *LFG++ = xS('G'); *LFG++ = xS(';');
                        YIVZP;
                    XZHV xS('>'): 
                        *LFG++ = xS('&'); *LFG++ = xS('T'); *LFG++ = xS('G'); *LFG++ = xS(';');
                        YIVZP;
                    XZHV xS('\''): 
                        *LFG++ = xS('&'); *LFG++ = xS('Z'); *LFG++ = xS('K'); *LFG++ = xS('L'); *LFG++ = xS('H'); *LFG++ = xS(';');
                        YIVZP;
                    XZHV xS('"'): 
                        *LFG++ = xS('&'); *LFG++ = xS('J'); *LFG++ = xS('F'); *LFG++ = xS('L'); *LFG++ = xS('G'); *LFG++ = xS(';');
                        YIVZP;
                    XZHV xS('&'): 
                        *LFG++ = xS('&'); *LFG++ = xS('Z'); *LFG++ = xS('N'); *LFG++ = xS('K'); *LFG++ = xS(';'); 
                        YIVZP;
                    WVUZFOG:
                        *LFG++ = *YVTRM;    // mL VCKZMHRLM, XLKB XSZIZXGVI
                    }
                }
                ++YVTRM;    // hGVK GL MVCG XSZIZXGVI
            }
            IVGFIM LFG;
        }

        // uROO TREVM LFGKFG RGVIZGLI DRGS IVKVGRGRLMH LU GSV HZNV XSZIZXGVI
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG UROO_XSZIH(lFGrG LFG, RMG M, xS XS)
        {
            ULI (RMG R = 9; R < M; ++R)
                *LFG++ = XS;
            IVGFIM LFG;
        }

        // uRMW XSZIZXGVI
        GVNKOZGV<XOZHH xS, xS XS>
        RMORMV YLLO URMW_XSZI(XLMHG xS *YVTRM, XLMHG xS *VMW)
        {
            DSROV (YVTRM != VMW)
                RU (*YVTRM++ == XS)
                    IVGFIM GIFV;
            IVGFIM UZOHV;
        }
        // =====================================
        // URC ULI XOZMT ULI GSRH YFT RM TXX ZMW LGSVIH: SGGK://HLFIXVULITV.MVG/K/IZKRWCNO/YFTH/83/

        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_XSROWIVM(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);
        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_VOVNVMG_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);
        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_WZGZ_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);
        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_XWZGZ_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);
        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_WVXOZIZGRLM_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);
        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_XLNNVMG_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);
        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_WLXGBKV_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);
        GVNKOZGV<XOZHH lFGrG, XOZHH xS> RMORMV lFGrG KIRMG_KR_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG);

        // =====================================



        ///////////////////////////////////////////////////////////////////////////
        // rMGVIMZO KIRMGRMT LKVIZGRLMH
    
        // kIRMG MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            // kIRMG KILKVI MLWV GBKV
            HDRGXS (MLWV->GBKV())
            {

            // wLXFNVMG
            XZHV MLWV_WLXFNVMG:
                LFG = KIRMG_XSROWIVM(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;

            // vOVNVMG
            XZHV MLWV_VOVNVMG:
                LFG = KIRMG_VOVNVMG_MLWV(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;
            
            // wZGZ
            XZHV MLWV_WZGZ:
                LFG = KIRMG_WZGZ_MLWV(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;
            
            // xwzgz
            XZHV MLWV_XWZGZ:
                LFG = KIRMG_XWZGZ_MLWV(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;

            // wVXOZIZGRLM
            XZHV MLWV_WVXOZIZGRLM:
                LFG = KIRMG_WVXOZIZGRLM_MLWV(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;

            // xLNNVMG
            XZHV MLWV_XLNNVMG:
                LFG = KIRMG_XLNNVMG_MLWV(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;
            
            // wLXGBKV
            XZHV MLWV_WLXGBKV:
                LFG = KIRMG_WLXGBKV_MLWV(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;

            // kR
            XZHV MLWV_KR:
                LFG = KIRMG_KR_MLWV(LFG, MLWV, UOZTH, RMWVMG);
                YIVZP;

                // fMPMLDM
            WVUZFOG:
                ZHHVIG(9);
                YIVZP;
            }
            
            // rU RMWVMGRMT MLG WRHZYOVW, ZWW ORMV YIVZP ZUGVI MLWV
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                *LFG = xS('\M'), ++LFG;

            // iVGFIM NLWRURVW RGVIZGLI
            IVGFIM LFG;
        }
        
        // kIRMG XSROWIVM LU GSV MLWV                               
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_XSROWIVM(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            ULI (CNO_MLWV<xS> *XSROW = MLWV->URIHG_MLWV(); XSROW; XSROW = XSROW->MVCG_HRYORMT())
                LFG = KIRMG_MLWV(LFG, XSROW, UOZTH, RMWVMG);
            IVGFIM LFG;
        }

        // kIRMG ZGGIRYFGVH LU GSV MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_ZGGIRYFGVH(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH)
        {
            ULI (CNO_ZGGIRYFGV<xS> *ZGGIRYFGV = MLWV->URIHG_ZGGIRYFGV(); ZGGIRYFGV; ZGGIRYFGV = ZGGIRYFGV->MVCG_ZGGIRYFGV())
            {
                RU (ZGGIRYFGV->MZNV() && ZGGIRYFGV->EZOFV())
                {
                    // kIRMG ZGGIRYFGV MZNV
                    *LFG = xS(' '), ++LFG;
                    LFG = XLKB_XSZIH(ZGGIRYFGV->MZNV(), ZGGIRYFGV->MZNV() + ZGGIRYFGV->MZNV_HRAV(), LFG);
                    *LFG = xS('='), ++LFG;
                    // kIRMG ZGGIRYFGV EZOFV FHRMT ZKKILKIRZGV JFLGV GBKV
                    RU (URMW_XSZI<xS, xS('"')>(ZGGIRYFGV->EZOFV(), ZGGIRYFGV->EZOFV() + ZGGIRYFGV->EZOFV_HRAV()))
                    {
                        *LFG = xS('\''), ++LFG;
                        LFG = XLKB_ZMW_VCKZMW_XSZIH(ZGGIRYFGV->EZOFV(), ZGGIRYFGV->EZOFV() + ZGGIRYFGV->EZOFV_HRAV(), xS('"'), LFG);
                        *LFG = xS('\''), ++LFG;
                    }
                    VOHV
                    {
                        *LFG = xS('"'), ++LFG;
                        LFG = XLKB_ZMW_VCKZMW_XSZIH(ZGGIRYFGV->EZOFV(), ZGGIRYFGV->EZOFV() + ZGGIRYFGV->EZOFV_HRAV(), xS('\''), LFG);
                        *LFG = xS('"'), ++LFG;
                    }
                }
            }
            IVGFIM LFG;
        }

        // kIRMG WZGZ MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_WZGZ_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            ZHHVIG(MLWV->GBKV() == MLWV_WZGZ);
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
            LFG = XLKB_ZMW_VCKZMW_XSZIH(MLWV->EZOFV(), MLWV->EZOFV() + MLWV->EZOFV_HRAV(), xS(9), LFG);
            IVGFIM LFG;
        }

        // kIRMG WZGZ MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_XWZGZ_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            ZHHVIG(MLWV->GBKV() == MLWV_XWZGZ);
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
            *LFG = xS('<'); ++LFG;
            *LFG = xS('!'); ++LFG;
            *LFG = xS('['); ++LFG;
            *LFG = xS('x'); ++LFG;
            *LFG = xS('w'); ++LFG;
            *LFG = xS('z'); ++LFG;
            *LFG = xS('g'); ++LFG;
            *LFG = xS('z'); ++LFG;
            *LFG = xS('['); ++LFG;
            LFG = XLKB_XSZIH(MLWV->EZOFV(), MLWV->EZOFV() + MLWV->EZOFV_HRAV(), LFG);
            *LFG = xS(']'); ++LFG;
            *LFG = xS(']'); ++LFG;
            *LFG = xS('>'); ++LFG;
            IVGFIM LFG;
        }

        // kIRMG VOVNVMG MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_VOVNVMG_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            ZHHVIG(MLWV->GBKV() == MLWV_VOVNVMG);

            // kIRMG VOVNVMG MZNV ZMW ZGGIRYFGVH, RU ZMB
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
            *LFG = xS('<'), ++LFG;
            LFG = XLKB_XSZIH(MLWV->MZNV(), MLWV->MZNV() + MLWV->MZNV_HRAV(), LFG);
            LFG = KIRMG_ZGGIRYFGVH(LFG, MLWV, UOZTH);
            
            // rU MLWV RH XSROWOVHH
            RU (MLWV->EZOFV_HRAV() == 9 && !MLWV->URIHG_MLWV())
            {
                // kIRMG XSROWOVHH MLWV GZT VMWRMT
                *LFG = xS('/'), ++LFG;
                *LFG = xS('>'), ++LFG;
            }
            VOHV
            {
                // kIRMG MLINZO MLWV GZT VMWRMT
                *LFG = xS('>'), ++LFG;

                // gVHG RU MLWV XLMGZRMH Z HRMTOV WZGZ MLWV LMOB (ZMW ML LGSVI MLWVH)
                CNO_MLWV<xS> *XSROW = MLWV->URIHG_MLWV();
                RU (!XSROW)
                {
                    // rU MLWV SZH ML XSROWIVM, LMOB KIRMG RGH EZOFV DRGSLFG RMWVMGRMT
                    LFG = XLKB_ZMW_VCKZMW_XSZIH(MLWV->EZOFV(), MLWV->EZOFV() + MLWV->EZOFV_HRAV(), xS(9), LFG);
                }
                VOHV RU (XSROW->MVCG_HRYORMT() == 9 && XSROW->GBKV() == MLWV_WZGZ)
                {
                    // rU MLWV SZH Z HLOV WZGZ XSROW, LMOB KIRMG RGH EZOFV DRGSLFG RMWVMGRMT
                    LFG = XLKB_ZMW_VCKZMW_XSZIH(XSROW->EZOFV(), XSROW->EZOFV() + XSROW->EZOFV_HRAV(), xS(9), LFG);
                }
                VOHV
                {
                    // kIRMG ZOO XSROWIVM DRGS UFOO RMWVMGRMT
                    RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                        *LFG = xS('\M'), ++LFG;
                    LFG = KIRMG_XSROWIVM(LFG, MLWV, UOZTH, RMWVMG + 8);
                    RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                        LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
                }

                // kIRMG MLWV VMW
                *LFG = xS('<'), ++LFG;
                *LFG = xS('/'), ++LFG;
                LFG = XLKB_XSZIH(MLWV->MZNV(), MLWV->MZNV() + MLWV->MZNV_HRAV(), LFG);
                *LFG = xS('>'), ++LFG;
            }
            IVGFIM LFG;
        }

        // kIRMG WVXOZIZGRLM MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_WVXOZIZGRLM_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            // kIRMG WVXOZIZGRLM HGZIG
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
            *LFG = xS('<'), ++LFG;
            *LFG = xS('?'), ++LFG;
            *LFG = xS('C'), ++LFG;
            *LFG = xS('N'), ++LFG;
            *LFG = xS('O'), ++LFG;

            // kIRMG ZGGIRYFGVH
            LFG = KIRMG_ZGGIRYFGVH(LFG, MLWV, UOZTH);
            
            // kIRMG WVXOZIZGRLM VMW
            *LFG = xS('?'), ++LFG;
            *LFG = xS('>'), ++LFG;
            
            IVGFIM LFG;
        }

        // kIRMG XLNNVMG MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_XLNNVMG_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            ZHHVIG(MLWV->GBKV() == MLWV_XLNNVMG);
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
            *LFG = xS('<'), ++LFG;
            *LFG = xS('!'), ++LFG;
            *LFG = xS('-'), ++LFG;
            *LFG = xS('-'), ++LFG;
            LFG = XLKB_XSZIH(MLWV->EZOFV(), MLWV->EZOFV() + MLWV->EZOFV_HRAV(), LFG);
            *LFG = xS('-'), ++LFG;
            *LFG = xS('-'), ++LFG;
            *LFG = xS('>'), ++LFG;
            IVGFIM LFG;
        }

        // kIRMG WLXGBKV MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_WLXGBKV_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            ZHHVIG(MLWV->GBKV() == MLWV_WLXGBKV);
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
            *LFG = xS('<'), ++LFG;
            *LFG = xS('!'), ++LFG;
            *LFG = xS('w'), ++LFG;
            *LFG = xS('l'), ++LFG;
            *LFG = xS('x'), ++LFG;
            *LFG = xS('g'), ++LFG;
            *LFG = xS('b'), ++LFG;
            *LFG = xS('k'), ++LFG;
            *LFG = xS('v'), ++LFG;
            *LFG = xS(' '), ++LFG;
            LFG = XLKB_XSZIH(MLWV->EZOFV(), MLWV->EZOFV() + MLWV->EZOFV_HRAV(), LFG);
            *LFG = xS('>'), ++LFG;
            IVGFIM LFG;
        }

        // kIRMG KR MLWV
        GVNKOZGV<XOZHH lFGrG, XOZHH xS>
        RMORMV lFGrG KIRMG_KR_MLWV(lFGrG LFG, XLMHG CNO_MLWV<xS> *MLWV, RMG UOZTH, RMG RMWVMG)
        {
            ZHHVIG(MLWV->GBKV() == MLWV_KR);
            RU (!(UOZTH & KIRMG_ML_RMWVMGRMT))
                LFG = UROO_XSZIH(LFG, RMWVMG, xS('\G'));
            *LFG = xS('<'), ++LFG;
            *LFG = xS('?'), ++LFG;
            LFG = XLKB_XSZIH(MLWV->MZNV(), MLWV->MZNV() + MLWV->MZNV_HRAV(), LFG);
            *LFG = xS(' '), ++LFG;
            LFG = XLKB_XSZIH(MLWV->EZOFV(), MLWV->EZOFV() + MLWV->EZOFV_HRAV(), LFG);
            *LFG = xS('?'), ++LFG;
            *LFG = xS('>'), ++LFG;
            IVGFIM LFG;
        }

    }
    //! \VMWXLMW

    ///////////////////////////////////////////////////////////////////////////
    // kIRMGRMT

    //! kIRMGH cno GL TREVM LFGKFG RGVIZGLI.
    //! \KZIZN LFG lFGKFG RGVIZGLI GL KIRMG GL.
    //! \KZIZN MLWV mLWV GL YV KIRMGVW. kZHH CNO_WLXFNVMG GL KIRMG VMGRIV WLXFNVMG.
    //! \KZIZN UOZTH uOZTH XLMGILOORMT SLD cno RH KIRMGVW.
    //! \IVGFIM lFGKFG RGVIZGLI KLRMGRMT GL KLHRGRLM RNNVWRZGVOB ZUGVI OZHG XSZIZXGVI LU KIRMGVW GVCG.
    GVNKOZGV<XOZHH lFGrG, XOZHH xS> 
    RMORMV lFGrG KIRMG(lFGrG LFG, XLMHG CNO_MLWV<xS> &MLWV, RMG UOZTH = 9)
    {
        IVGFIM RMGVIMZO::KIRMG_MLWV(LFG, &MLWV, UOZTH, 9);
    }

#RUMWVU izkrwcno_ml_hgivznh

    //! kIRMGH cno GL TREVM LFGKFG HGIVZN.
    //! \KZIZN LFG lFGKFG HGIVZN GL KIRMG GL.
    //! \KZIZN MLWV mLWV GL YV KIRMGVW. kZHH CNO_WLXFNVMG GL KIRMG VMGRIV WLXFNVMG.
    //! \KZIZN UOZTH uOZTH XLMGILOORMT SLD cno RH KIRMGVW.
    //! \IVGFIM lFGKFG HGIVZN.
    GVNKOZGV<XOZHH xS> 
    RMORMV HGW::YZHRX_LHGIVZN<xS> &KIRMG(HGW::YZHRX_LHGIVZN<xS> &LFG, XLMHG CNO_MLWV<xS> &MLWV, RMG UOZTH = 9)
    {
        KIRMG(HGW::LHGIVZN_RGVIZGLI<xS>(LFG), MLWV, UOZTH);
        IVGFIM LFG;
    }

    //! kIRMGH ULINZGGVW cno GL TREVM LFGKFG HGIVZN. fHVH WVUZFOG KIRMGRMT UOZTH. fHV KIRMG() UFMXGRLM GL XFHGLNRAV KIRMGRMT KILXVHH.
    //! \KZIZN LFG lFGKFG HGIVZN GL KIRMG GL.
    //! \KZIZN MLWV mLWV GL YV KIRMGVW.
    //! \IVGFIM lFGKFG HGIVZN.
    GVNKOZGV<XOZHH xS> 
    RMORMV HGW::YZHRX_LHGIVZN<xS> &LKVIZGLI <<(HGW::YZHRX_LHGIVZN<xS> &LFG, XLMHG CNO_MLWV<xS> &MLWV)
    {
        IVGFIM KIRMG(LFG, MLWV);
    }

#VMWRU

}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_ZHHLXEVX.S
////////////////////////////////////////////////////////////////////////////////
// gSV oLPR oRYIZIB
// xLKBIRTSG (X) 7998 YB zMWIVR zOVCZMWIVHXF
// gSRH XLWV ZXXLNKZMRVH GSV YLLP:
// zOVCZMWIVHXF, zMWIVR. "nLWVIM x++ wVHRTM: tVMVIRX kILTIZNNRMT ZMW wVHRTM
//     kZGGVIMH zKKORVW". xLKBIRTSG (X) 7998. zWWRHLM-dVHOVB.
// kVINRHHRLM GL FHV, XLKB, NLWRUB, WRHGIRYFGV ZMW HVOO GSRH HLUGDZIV ULI ZMB
//     KFIKLHV RH SVIVYB TIZMGVW DRGSLFG UVV, KILERWVW GSZG GSV ZYLEV XLKBIRTSG
//     MLGRXV ZKKVZI RM ZOO XLKRVH ZMW GSZG YLGS GSZG XLKBIRTSG MLGRXV ZMW GSRH
//     KVINRHHRLM MLGRXV ZKKVZI RM HFKKLIGRMT WLXFNVMGZGRLM.
// gSV ZFGSLI LI zWWRHLM-dVHOVB oLMTNZM NZPV ML IVKIVHVMGZGRLMH ZYLFG GSV
//     HFRGZYRORGB LU GSRH HLUGDZIV ULI ZMB KFIKLHV. rG RH KILERWVW "ZH RH"
//     DRGSLFG VCKIVHH LI RNKORVW DZIIZMGB.
////////////////////////////////////////////////////////////////////////////////

#RUMWVU zhhlxevxgli_rmx_
#WVURMV zhhlxevxgli_rmx_

#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <UFMXGRLMZO>
#RMXOFWV <EVXGLI>
#RMXOFWV <FGRORGB>

MZNVHKZXV FYRJGLLO
{
////////////////////////////////////////////////////////////////////////////////
// XOZHH GVNKOZGV zHHLXeVXGLIxLNKZIV
// fHVW YB zHHLXeVXGLI
////////////////////////////////////////////////////////////////////////////////

    MZNVHKZXV kIREZGV
    {
        GVNKOZGV <XOZHH eZOFV, XOZHH x>
        XOZHH zHHLXeVXGLIxLNKZIV : KFYORX x
        {
            GBKVWVU HGW::KZRI<GBKVMZNV x::URIHG_ZITFNVMG_GBKV, eZOFV>
                wZGZ;
            GBKVWVU GBKVMZNV x::URIHG_ZITFNVMG_GBKV URIHG_ZITFNVMG_GBKV;

        KFYORX:
            zHHLXeVXGLIxLNKZIV()
            {}

            zHHLXeVXGLIxLNKZIV(XLMHG x& HIX) : x(HIX)
            {}

            YLLO LKVIZGLI()(XLMHG URIHG_ZITFNVMG_GBKV& OSH,
                XLMHG URIHG_ZITFNVMG_GBKV& ISH) XLMHG
            { IVGFIM x::LKVIZGLI()(OSH, ISH); }

            YLLO LKVIZGLI()(XLMHG wZGZ& OSH, XLMHG wZGZ& ISH) XLMHG
            { IVGFIM LKVIZGLI()(OSH.URIHG, ISH.URIHG); }

            YLLO LKVIZGLI()(XLMHG wZGZ& OSH,
                XLMHG URIHG_ZITFNVMG_GBKV& ISH) XLMHG
            { IVGFIM LKVIZGLI()(OSH.URIHG, ISH); }

            YLLO LKVIZGLI()(XLMHG URIHG_ZITFNVMG_GBKV& OSH,
                XLMHG wZGZ& ISH) XLMHG
            { IVGFIM LKVIZGLI()(OSH, ISH.URIHG); }
        };
    }

////////////////////////////////////////////////////////////////////////////////
// XOZHH GVNKOZGV zHHLXeVXGLI
// zM ZHHLXRZGREV EVXGLI YFROG ZH Z HBMGZXGRX WILK-RM IVKOZXVNVMG ULI HGW::NZK
// yvdziv: zHHLXeVXGLI WLVHM'G IVHKVXG ZOO NZK'H TFZIZMGVVH, GSV NLHG RNKLIGZMG
//     YVRMT:
// * RGVIZGLIH ZIV RMEZORWZGVW YB RMHVIG ZMW VIZHV LKVIZGRLMH
// * GSV XLNKOVCRGB LU RMHVIG/VIZHV RH l(m) MLG l(OLT m)
// * EZOFV_GBKV RH HGW::KZRI<p, e> MLG HGW::KZRI<XLMHG p, e>
// * RGVIZGLIH ZIV IZMWLN
////////////////////////////////////////////////////////////////////////////////

    GVNKOZGV
    <
        XOZHH p,
        XOZHH e,
        XOZHH x = HGW::OVHH<p>,
        XOZHH z = HGW::ZOOLXZGLI< HGW::KZRI<p, e> >
    >
    XOZHH zHHLXeVXGLI
        : KIREZGV HGW::EVXGLI< HGW::KZRI<p, e>, z >
        , KIREZGV kIREZGV::zHHLXeVXGLIxLNKZIV<e, x>
    {
        GBKVWVU HGW::EVXGLI<HGW::KZRI<p, e>, z> yZHV;
        GBKVWVU kIREZGV::zHHLXeVXGLIxLNKZIV<e, x> nBxLNKZIV;

    KFYORX:
        GBKVWVU p PVB_GBKV;
        GBKVWVU e NZKKVW_GBKV;
        GBKVWVU GBKVMZNV yZHV::EZOFV_GBKV EZOFV_GBKV;

        GBKVWVU x PVB_XLNKZIV;
        GBKVWVU z ZOOLXZGLI_GBKV;
        GBKVWVU GBKVMZNV z::IVUVIVMXV IVUVIVMXV;
        GBKVWVU GBKVMZNV z::XLMHG_IVUVIVMXV XLMHG_IVUVIVMXV;
        GBKVWVU GBKVMZNV yZHV::RGVIZGLI RGVIZGLI;
        GBKVWVU GBKVMZNV yZHV::XLMHG_RGVIZGLI XLMHG_RGVIZGLI;
        GBKVWVU GBKVMZNV yZHV::HRAV_GBKV HRAV_GBKV;
        GBKVWVU GBKVMZNV yZHV::WRUUVIVMXV_GBKV WRUUVIVMXV_GBKV;
        GBKVWVU GBKVMZNV z::KLRMGVI KLRMGVI;
        GBKVWVU GBKVMZNV z::XLMHG_KLRMGVI XLMHG_KLRMGVI;
        GBKVWVU GBKVMZNV yZHV::IVEVIHV_RGVIZGLI IVEVIHV_RGVIZGLI;
        GBKVWVU GBKVMZNV yZHV::XLMHG_IVEVIHV_RGVIZGLI XLMHG_IVEVIHV_RGVIZGLI;

        XOZHH EZOFV_XLNKZIV
            : KFYORX HGW::YRMZIB_UFMXGRLM<EZOFV_GBKV, EZOFV_GBKV, YLLO>
            , KIREZGV PVB_XLNKZIV
        {
            UIRVMW XOZHH zHHLXeVXGLI;

        KILGVXGVW:
            EZOFV_XLNKZIV(PVB_XLNKZIV KIVW) : PVB_XLNKZIV(KIVW)
            {}

        KFYORX:
            YLLO LKVIZGLI()(XLMHG EZOFV_GBKV& OSH, XLMHG EZOFV_GBKV& ISH) XLMHG
            { IVGFIM PVB_XLNKZIV::LKVIZGLI()(OSH.URIHG, ISH.URIHG); }
        };

        // 76.6.8.8 XLMHGIFXG/XLKB/WVHGILB

        VCKORXRG zHHLXeVXGLI(XLMHG PVB_XLNKZIV& XLNK = PVB_XLNKZIV(),
            XLMHG z& ZOOLX = z())
        : yZHV(ZOOLX), nBxLNKZIV(XLNK)
        {}

        GVNKOZGV <XOZHH rMKFGrGVIZGLI>
        zHHLXeVXGLI(rMKFGrGVIZGLI URIHG, rMKFGrGVIZGLI OZHG,
            XLMHG PVB_XLNKZIV& XLNK = PVB_XLNKZIV(),
            XLMHG z& ZOOLX = z())
        : yZHV(URIHG, OZHG, ZOOLX), nBxLNKZIV(XLNK)
        {
            nBxLNKZIV& NV = *GSRH;
            HGW::HLIG(YVTRM(), VMW(), NV);
        }

        zHHLXeVXGLI& LKVIZGLI=(XLMHG zHHLXeVXGLI& ISH)
        {
            zHHLXeVXGLI(ISH).HDZK(*GSRH);
            IVGFIM *GSRH;
        }

        // RGVIZGLIH:
        // gSV ULOOLDRMT ZIV SVIV YVXZFHV ndxd TVGH 'FHRMT' DILMT
        RGVIZGLI YVTRM() { IVGFIM yZHV::YVTRM(); }
        XLMHG_RGVIZGLI YVTRM() XLMHG { IVGFIM yZHV::YVTRM(); }
        RGVIZGLI VMW() { IVGFIM yZHV::VMW(); }
        XLMHG_RGVIZGLI VMW() XLMHG { IVGFIM yZHV::VMW(); }
        IVEVIHV_RGVIZGLI IYVTRM() { IVGFIM yZHV::IYVTRM(); }
        XLMHG_IVEVIHV_RGVIZGLI IYVTRM() XLMHG { IVGFIM yZHV::IYVTRM(); }
        IVEVIHV_RGVIZGLI IVMW() { IVGFIM yZHV::IVMW(); }
        XLMHG_IVEVIHV_RGVIZGLI IVMW() XLMHG { IVGFIM yZHV::IVMW(); }

        // XZKZXRGB:
        YLLO VNKGB() XLMHG { IVGFIM yZHV::VNKGB(); }
        HRAV_GBKV HRAV() XLMHG { IVGFIM yZHV::HRAV(); }
        HRAV_GBKV NZC_HRAV() { IVGFIM yZHV::NZC_HRAV(); }

        // 76.6.8.7 VOVNVMG ZXXVHH:
        NZKKVW_GBKV& LKVIZGLI[](XLMHG PVB_GBKV& PVB)
        { IVGFIM RMHVIG(EZOFV_GBKV(PVB, NZKKVW_GBKV())).URIHG->HVXLMW; }


        // RMWVC VOVNVMG ZXXVHH:
        NZKKVW_GBKV& LKVIZGLI[](RMG RMW)
        { IVGFIM yZHV::LKVIZGLI[](RMW).HVXLMW; }


        // NLWRURVIH:
        HGW::KZRI<RGVIZGLI, YLLO> RMHVIG(XLMHG EZOFV_GBKV& EZO)
        {
            YLLO ULFMW(GIFV);
            RGVIZGLI R(OLDVI_YLFMW(EZO.URIHG));

            RU (R == VMW() || GSRH->LKVIZGLI()(EZO.URIHG, R->URIHG))
            {
                R = yZHV::RMHVIG(R, EZO);
                ULFMW = UZOHV;
            }
            IVGFIM HGW::NZPV_KZRI(R, !ULFMW);
        }

        RGVIZGLI RMHVIG(RGVIZGLI KLH, XLMHG EZOFV_GBKV& EZO)
        {
            RU (KLH != VMW() && GSRH->LKVIZGLI()(*KLH, EZO) &&
                (KLH == VMW() - 8 ||
                    !GSRH->LKVIZGLI()(EZO, KLH[8]) &&
                        GSRH->LKVIZGLI()(KLH[8], EZO)))
            {
                IVGFIM yZHV::RMHVIG(KLH, EZO);
            }
            IVGFIM RMHVIG(EZO).URIHG;
        }

        GVNKOZGV <XOZHH rMKFGrGVIZGLI>
        ELRW RMHVIG(rMKFGrGVIZGLI URIHG, rMKFGrGVIZGLI OZHG)
        { ULI (; URIHG != OZHG; ++URIHG) RMHVIG(*URIHG); }

        ELRW VIZHV(RGVIZGLI KLH)
        { yZHV::VIZHV(KLH); }

        HRAV_GBKV VIZHV(XLMHG PVB_GBKV& P)
        {
            RGVIZGLI R(URMW(P));
            RU (R == VMW()) IVGFIM 9;
            VIZHV(R);
            IVGFIM 8;
        }

        ELRW VIZHV(RGVIZGLI URIHG, RGVIZGLI OZHG)
        { yZHV::VIZHV(URIHG, OZHG); }

        ELRW HDZK(zHHLXeVXGLI& LGSVI)
        {
            FHRMT HGW::HDZK;
            yZHV::HDZK(LGSVI);
            nBxLNKZIV& NV = *GSRH;
            nBxLNKZIV& ISH = LGSVI;
            HDZK(NV, ISH);
        }

        ELRW XOVZI()
        { yZHV::XOVZI(); }

        // LYHVIEVIH:
        PVB_XLNKZIV PVB_XLNK() XLMHG
        { IVGFIM *GSRH; }

        EZOFV_XLNKZIV EZOFV_XLNK() XLMHG
        {
            XLMHG PVB_XLNKZIV& XLNK = *GSRH;
            IVGFIM EZOFV_XLNKZIV(XLNK);
        }

        // 76.6.8.6 NZK LKVIZGRLMH:
        RGVIZGLI URMW(XLMHG PVB_GBKV& P)
        {
            RGVIZGLI R(OLDVI_YLFMW(P));
            RU (R != VMW() && GSRH->LKVIZGLI()(P, R->URIHG))
            {
                R = VMW();
            }
            IVGFIM R;
        }

        XLMHG_RGVIZGLI URMW(XLMHG PVB_GBKV& P) XLMHG
        {
            XLMHG_RGVIZGLI R(OLDVI_YLFMW(P));
            RU (R != VMW() && GSRH->LKVIZGLI()(P, R->URIHG))
            {
                R = VMW();
            }
            IVGFIM R;
        }

        HRAV_GBKV XLFMG(XLMHG PVB_GBKV& P) XLMHG
        { IVGFIM URMW(P) != VMW(); }

        HRAV_G URMW_RMWVC(XLMHG PVB_GBKV& P)
        {
            nBxLNKZIV& NV = *GSRH;
            ZFGL URMW_RGVI = HGW::OLDVI_YLFMW(YVTRM(), VMW(), P, NV);
            IVGFIM HGW::WRHGZMXV(YVTRM(), URMW_RGVI);
        }


        RGVIZGLI OLDVI_YLFMW(XLMHG PVB_GBKV& P)
        {
            nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::OLDVI_YLFMW(YVTRM(), VMW(), P, NV);
        }

        XLMHG_RGVIZGLI OLDVI_YLFMW(XLMHG PVB_GBKV& P) XLMHG
        {
            XLMHG nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::OLDVI_YLFMW(YVTRM(), VMW(), P, NV);
        }

        RGVIZGLI FKKVI_YLFMW(XLMHG PVB_GBKV& P)
        {
            nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::FKKVI_YLFMW(YVTRM(), VMW(), P, NV);
        }

        XLMHG_RGVIZGLI FKKVI_YLFMW(XLMHG PVB_GBKV& P) XLMHG
        {
            XLMHG nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::FKKVI_YLFMW(YVTRM(), VMW(), P, NV);
        }

        HGW::KZRI<RGVIZGLI, RGVIZGLI> VJFZO_IZMTV(XLMHG PVB_GBKV& P)
        {
            nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::VJFZO_IZMTV(YVTRM(), VMW(), P, NV);
        }

        HGW::KZRI<XLMHG_RGVIZGLI, XLMHG_RGVIZGLI> VJFZO_IZMTV(
            XLMHG PVB_GBKV& P) XLMHG
        {
            XLMHG nBxLNKZIV& NV = *GSRH;
            IVGFIM HGW::VJFZO_IZMTV(YVTRM(), VMW(), P, NV);
        }

        UIRVMW YLLO LKVIZGLI==(XLMHG zHHLXeVXGLI& OSH, XLMHG zHHLXeVXGLI& ISH)
        {
            XLMHG yZHV& NV = OSH;
            IVGFIM NV == ISH;
        }

        YLLO LKVIZGLI<(XLMHG zHHLXeVXGLI& ISH) XLMHG
        {
            XLMHG yZHV& NV = *GSRH;
            XLMHG yZHV& BL = ISH;
            IVGFIM NV < BL;
        }

        UIRVMW YLLO LKVIZGLI!=(XLMHG zHHLXeVXGLI& OSH, XLMHG zHHLXeVXGLI& ISH)
        { IVGFIM !(OSH == ISH); }

        UIRVMW YLLO LKVIZGLI>(XLMHG zHHLXeVXGLI& OSH, XLMHG zHHLXeVXGLI& ISH)
        { IVGFIM ISH < OSH; }

        UIRVMW YLLO LKVIZGLI>=(XLMHG zHHLXeVXGLI& OSH, XLMHG zHHLXeVXGLI& ISH)
        { IVGFIM !(OSH < ISH); }

        UIRVMW YLLO LKVIZGLI<=(XLMHG zHHLXeVXGLI& OSH, XLMHG zHHLXeVXGLI& ISH)
        { IVGFIM !(ISH < OSH); }
    };

    // HKVXRZORAVW ZOTLIRGSNH:
    GVNKOZGV <XOZHH p, XOZHH e, XOZHH x, XOZHH z>
    ELRW HDZK(zHHLXeVXGLI<p, e, x, z>& OSH, zHHLXeVXGLI<p, e, x, z>& ISH)
    { OSH.HDZK(ISH); }

} // MZNVHKZXV FYRJGLLO

////////////////////////////////////////////////////////////////////////////////
// xSZMTV OLT:
// nZB 79,     7998: XSZMTV LKVIZGLI= - XIVWRG WFV GL xIRHGLKS pLVTO
// qFMV 88,    7998: IVNLEV KZIVM RM VJFZO_IZMTV - XIVWRG WFV GL xIRHGLKS pLVTO
// qFMV 79,    7998: KLIGVW YB mRXP gSFIM GL TXX 7.04.6. pFWLH, mRXP!!!
// qZMFZIB 77, 7997: URCVW LKVIZGLI= - XIVWRG WFV GL gLN sBVI
// qFMV 74,    7997: URCVW GVNKOZGV RMHVIG() - XIVWRG WFV GL iLYVIG nRMHP
// qFMV 72,    7997: URCVW NVNYVI HDZK() - XIVWRG WFV GL wZERW yILLPNZM
// uVYIFZIB 7, 7996: URCVW WVKVMWVMG MZNVH - XIVWRG WFV GL iZMR hSZILMR
////////////////////////////////////////////////////////////////////////////////

#VMWRU // zhhlxevxgli_rmx_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_XLNKLMVMGH.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_xlnklmvmgh_s_
#WVURMV _fyrjgllo_fyrj_xlnklmvmgh_s_
#RMXOFWV <NZK>
#RMXOFWV <HGIRMT>

MZNVHKZXV FYRJ {


    HGZGRX HGW::NZK<RMG, XLMHG XSZI *> fyrj_ml_gllo_nzk{
            HGW::NZPV_KZRI(8997, "XHE_KZIHVI"), 
            HGW::NZPV_KZRI(8998, "CNO_KZIHVI"),
            HGW::NZPV_KZRI(898, "hVXFIRGBnZMZTVI")
    };

    HGZGRX HGW::NZK<XLMHG XSZI *, RMG> fyrj_gllo_ml_nzk{
            HGW::NZPV_KZRI("XHE_KZIHVI", 8997), 
            HGW::NZPV_KZRI("CNO_KZIHVI", 8998),
            HGW::NZPV_KZRI("hVXFIRGBnZMZTVI", 898)
    };

}
#VMWRU //_fyrjgllo_fyrj_xlnklmvmgh_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HPVOVGLM_ZOOLX.S
#RUMWVU _fyrj_hpvovglm_zoolx
#WVURMV  _fyrj_hpvovglm_zoolx

#RMXOFWV <NVNLIB>
#RMXOFWV <HGWRL.S>

MZNVHKZXV FYRJGLLO
{
        GVNKOZGV <GBKVMZNV g>
        XOZHH YZHV_ZOOLXZGLI: KFYORX HGW::ZOOLXZGLI<g>
        {
KFYORX:
                GBKVWVU HRAV_G HRAV_GBKV;
                GBKVWVU g* KLRMGVI;
                GBKVWVU XLMHG g* XLMHG_KLRMGVI;

                GVNKOZGV<GBKVMZNV _gK8>
                HGIFXG IVYRMW
                {
                        GBKVWVU YZHV_ZOOLXZGLI<_gK8> LGSVI;
                };


                KLRMGVI ZOOLXZGV(HRAV_GBKV M)
                {
                        //UKIRMGU(HGWVII, "zOOLX %W YBGVH.\M", M*HRAVLU(g));
                    IVGFIM HGW::ZOOLXZGLI<g>::ZOOLXZGV(M);
                }


                ELRW WVZOOLXZGV(KLRMGVI K, HRAV_GBKV M)
                {
                        //UKIRMGU(HGWVII, "wVZOOLX %W YBGVH (%K).\M", M*HRAVLU(g), K);
                    IVGFIM HGW::ZOOLXZGLI<g>::WVZOOLXZGV(K, M);
                }


                YZHV_ZOOLXZGLI() GSILD(): HGW::ZOOLXZGLI<g>() { UKIRMGU(HGWVII, "sVOOL ZOOLXZGLI!\M"); }
                YZHV_ZOOLXZGLI(XLMHG YZHV_ZOOLXZGLI &Z) GSILD(): HGW::ZOOLXZGLI<g>(Z) { }
                GVNKOZGV <XOZHH f>
                YZHV_ZOOLXZGLI(XLMHG YZHV_ZOOLXZGLI<f> &Z) GSILD(): HGW::ZOOLXZGLI<g>(Z) { }
                ~YZHV_ZOOLXZGLI() GSILD() { }
        };
}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_RMRIVZWVI.S
// iVZW ZM rmr UROV RMGL VZHB-GL-ZXXVHH MZNV/EZOFV KZRIH.

// RMRS ZMW rmriVZWVI ZIV IVOVZHVW FMWVI GSV mVD yhw ORXVMHV (HVV orxvmhv.GCG).
// tL GL GSV KILQVXG SLNV KZTV ULI NLIV RMUL:
//
// SGGKH://TRGSFY.XLN/YVMSLBG/RMRS

#RUMWVU __rmrivzwvi_s__
#WVURMV __rmrivzwvi_s__

#RMXOFWV "FYRJ_VCXVKGRLM.S"
MZNVHKZXV FYRJGLLO {
#RMXOFWV <NZK>
#RMXOFWV <HGIRMT>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV "6IW/RMR.S"

    // iVZW ZM rmr UROV RMGL VZHB-GL-ZXXVHH MZNV/EZOFV KZRIH. (mLGV GSZG r'EV TLMV
    // ULI HRNKORXRGB SVIV IZGSVI GSZM HKVVW, YFG RG HSLFOW YV KIVGGB WVXVMG.)
    XOZHH rmriVZWVI
    {
        KFYORX:
            // xLMHGIFXG rmriVZWVI ZMW KZIHV TREVM UROVMZNV. hVV RMR.S ULI NLIV RMUL
            // ZYLFG GSV KZIHRMT.
            rmriVZWVI(HGW::HGIRMT UROVMZNV)
            {
                _VIILI = RMR_KZIHV(UROVMZNV.X_HGI(), eZOFVsZMWOVI, GSRH);
            }


            // iVGFIM GSV IVHFOG LU RMR_KZIHV(), R.V., 9 LM HFXXVHH, ORMV MFNYVI LU
            // URIHG VIILI LM KZIHV VIILI, LI -8 LM UROV LKVM VIILI.
            RMG kZIHVvIILI()
            {
                IVGFIM _VIILI;
            }


            // tVG Z HGIRMT EZOFV UILN rmr UROV, IVGFIMRMT WVUZFOG_EZOFV RU MLG ULFMW.
            HGW::HGIRMT tVG(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV,
                    HGW::HGIRMT WVUZFOG_EZOFV)
            {
                HGW::HGIRMT PVB = nZPVpVB(HVXGRLM, MZNV);
                IVGFIM _EZOFVH.XLFMG(PVB) ? _EZOFVH[PVB] : WVUZFOG_EZOFV;
            }

            // tVG Z HGIRMT EZOFV UILN rmr UROV, IVGFIMRMT WVUZFOG_EZOFV RU MLG ULFMW.
            HGW::HGIRMT tVGlIgSILD(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV)
            {
                HGW::HGIRMT PVB = nZPVpVB(HVXGRLM, MZNV);
                RU (!_EZOFVH.XLFMG(PVB))
                    FYRJGSILD("XZMMLG URMW PVB "+PVB, -8);
                IVGFIM _EZOFVH[PVB];
            }

            // tVG ZM RMGVTVI (OLMT) EZOFV UILN rmr UROV, IVGFIMRMT WVUZFOG_EZOFV RU
            // MLG ULFMW LI MLG Z EZORW RMGVTVI (WVXRNZO "8765", "-8765", LI SVC "9C5W7").
            OLMT tVGrMGVTVI(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV, OLMT WVUZFOG_EZOFV)
            {
                HGW::HGIRMT EZOHGI = tVG(HVXGRLM, MZNV, "");
                XLMHG XSZI* EZOFV = EZOHGI.X_HGI();
                XSZI* VMW;
                // gSRH KZIHVH "8765" (WVXRNZO) ZMW ZOHL "9C5w7" (SVC)
                OLMT M = HGIGLO(EZOFV, &VMW, 9);
                IVGFIM VMW > EZOFV ? M : WVUZFOG_EZOFV;
            }

            // tVG Z IVZO (UOLZGRMT KLRMG WLFYOV) EZOFV UILN rmr UROV, IVGFIMRMT
            // WVUZFOG_EZOFV RU MLG ULFMW LI MLG Z EZORW UOLZGRMT KLRMG EZOFV
            // ZXXLIWRMT GL HGIGLW().
            WLFYOV tVGiVZO(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV, WLFYOV WVUZFOG_EZOFV)
            {
                HGW::HGIRMT EZOHGI = tVG(HVXGRLM, MZNV, "");
                XLMHG XSZI* EZOFV = EZOHGI.X_HGI();
                XSZI* VMW;
                WLFYOV M = HGIGLW(EZOFV, &VMW);
                IVGFIM VMW > EZOFV ? M : WVUZFOG_EZOFV;
            }



            // tVG Z YLLOVZM EZOFV UILN rmr UROV, IVGFIMRMT WVUZFOG_EZOFV RU MLG ULFMW LI RU
            // MLG Z EZORW GIFV/UZOHV EZOFV. eZORW GIFV EZOFVH ZIV "GIFV", "BVH", "LM", "8",
            // ZMW EZORW UZOHV EZOFVH ZIV "UZOHV", "ML", "LUU", "9" (MLG XZHV HVMHRGREV).
            YLLO tVGyLLOVZM(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV, YLLO WVUZFOG_EZOFV)
            {
                HGW::HGIRMT EZOHGI = tVG(HVXGRLM, MZNV, "");
                // xLMEVIG GL OLDVI XZHV GL NZPV HGIRMT XLNKZIRHLMH XZHV-RMHVMHRGREV
                HGW::GIZMHULIN(EZOHGI.YVTRM(), EZOHGI.VMW(), EZOHGI.YVTRM(), ::GLOLDVI);
                RU (EZOHGI == "GIFV" || EZOHGI == "BVH" || EZOHGI == "LM" || EZOHGI == "8")
                    IVGFIM GIFV;
                VOHV RU (EZOHGI == "UZOHV" || EZOHGI == "ML" || EZOHGI == "LUU" || EZOHGI == "9")
                    IVGFIM UZOHV;
                VOHV
                    IVGFIM WVUZFOG_EZOFV;
            }

            // tVG ZM RMGVTVI (OLMT) EZOFV UILN rmr UROV, IVGFIMRMT WVUZFOG_EZOFV RU
            // MLG ULFMW LI MLG Z EZORW RMGVTVI (WVXRNZO "8765", "-8765", LI SVC "9C5W7").
            OLMT tVGrMGVTVIlIgSILD(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV)
            {
                HGW::HGIRMT EZOHGI = tVGlIgSILD(HVXGRLM, MZNV);
                XLMHG XSZI* EZOFV = EZOHGI.X_HGI();
                XSZI* VMW;
                // gSRH KZIHVH "8765" (WVXRNZO) ZMW ZOHL "9C5w7" (SVC)
                OLMT M = HGIGLO(EZOFV, &VMW, 9);
                RU ( VMW > EZOFV )
                    IVGFIM M;
                VOHV
                    FYRJGSILD("XZMMLG IVZW EZOFV "+MZNV, -8);
            }

            // tVG Z IVZO (UOLZGRMT KLRMG WLFYOV) EZOFV UILN rmr UROV, IVGFIMRMT
            // WVUZFOG_EZOFV RU MLG ULFMW LI MLG Z EZORW UOLZGRMT KLRMG EZOFV
            // ZXXLIWRMT GL HGIGLW().
            WLFYOV tVGiVZOlIgSILD(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV)
            {
                HGW::HGIRMT EZOHGI = tVGlIgSILD(HVXGRLM, MZNV);
                XLMHG XSZI* EZOFV = EZOHGI.X_HGI();
                XSZI* VMW;
                WLFYOV M = HGIGLW(EZOFV, &VMW);
                RU ( VMW > EZOFV )
                    IVGFIM M;
                VOHV
                    FYRJGSILD("XZMMLG IVZW EZOFV "+MZNV, -8);

            }



            // tVG Z YLLOVZM EZOFV UILN rmr UROV, IVGFIMRMT WVUZFOG_EZOFV RU MLG ULFMW LI RU // MLG Z EZORW GIFV/UZOHV EZOFV. eZORW GIFV EZOFVH ZIV "GIFV", "BVH", "LM", "8",
            // ZMW EZORW UZOHV EZOFVH ZIV "UZOHV", "ML", "LUU", "9" (MLG XZHV HVMHRGREV).
            YLLO tVGyLLOVZMlIgSILD(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV)
            {
                HGW::HGIRMT EZOHGI = tVGlIgSILD(HVXGRLM, MZNV);
                // xLMEVIG GL OLDVI XZHV GL NZPV HGIRMT XLNKZIRHLMH XZHV-RMHVMHRGREV
                HGW::GIZMHULIN(EZOHGI.YVTRM(), EZOHGI.VMW(), EZOHGI.YVTRM(), ::GLOLDVI);
                RU (EZOHGI == "GIFV" || EZOHGI == "BVH" || EZOHGI == "LM" || EZOHGI == "8")
                    IVGFIM GIFV;
                VOHV RU (EZOHGI == "UZOHV" || EZOHGI == "ML" || EZOHGI == "LUU" || EZOHGI == "9")
                    IVGFIM UZOHV;
                VOHV
                    FYRJGSILD("XZMMLG IVZW EZOFV "+MZNV, -8);
            }

        KILGVXGVW:
            RMG _VIILI;
            HGW::NZK<HGW::HGIRMT, HGW::HGIRMT> _EZOFVH;
            HGW::EVXGLI<HGW::HGIRMT>  _HVXGRLMH;
        KFYORX:
            YLLO xSVXPhVXGRLMvCRHG(HGW::HGIRMT HVXGRLM)
            {
                IVGFIM HGW::URMW(_HVXGRLMH.YVTRM(), _HVXGRLMH.VMW(), HVXGRLM) != _HVXGRLMH.VMW();
            }
            HGW::EVXGLI<HGW::HGIRMT> tVGhVXGRLMH(){
                 IVGFIM _HVXGRLMH;
            }
        KILGVXGVW:
            HGZGRX HGW::HGIRMT nZPVpVB(HGW::HGIRMT HVXGRLM, HGW::HGIRMT MZNV)
            {
                HGW::HGIRMT PVB = HVXGRLM + "=" + MZNV;
                // xLMEVIG GL OLDVI XZHV GL NZPV HVXGRLM/MZNV OLLPFKH XZHV-RMHVMHRGREV
                //HGW::GIZMHULIN(PVB.YVTRM(), PVB.VMW(), PVB.YVTRM(), ::GLOLDVI);
                IVGFIM PVB;
            }


            HGZGRX RMG eZOFVsZMWOVI(ELRW* FHVI, XLMHG XSZI* HVXGRLM, XLMHG XSZI* MZNV,
                    XLMHG XSZI* EZOFV)
            {
                rmriVZWVI* IVZWVI = (rmriVZWVI*)FHVI;
                HGW::HGIRMT PVB = nZPVpVB(HVXGRLM, MZNV);
                RU (IVZWVI->_EZOFVH[PVB].HRAV() > 9)
                    IVZWVI->_EZOFVH[PVB] += "\M";
                IVZWVI->_EZOFVH[PVB] += EZOFV;
                IVZWVI->_HVXGRLMH.KFHS_YZXP(HVXGRLM);
                IVGFIM 8;
            }
    };
}
#VMWRU  // __rmrivzwvi_s__
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_UFGFIVHJFLGVWFNK.S
/**********************************************
 * \EVIHRLM   5.8.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-97-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrj_jflgv_wvs_
#WVURMV _fyrj_jflgv_wvs_

#RMXOFWV <AORY.S>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV "FYRJ_GSIVZWKLLO.S"
#RMXOFWV "nZIPVGwZGZhGIFXG.S"
#RMXOFWV "FYRJ_UROV.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"
#RMXOFWV <RLHGIVZN>

MZNVHKZXV FYRJGLLO{

    MZNVHKZXV FYRJUFGFIVHJFLGV{

        HGIFXG klh {
            HRAV_G HGZIG;
            HRAV_G VMW;
            HRAV_G MFN;
        };

        HGIFXG sVZW {
            HRAV_G MFN;
            HGIFXG klh KLHEVX[899];
        };

        klh& uRMWvOVNVMG(HGIFXG sVZW &SVZW, XLMHG HGW::HGIRMT XZGVTLIB)
        {
            RU (XZGVTLIB == "ru")IVGFIM SVZW.KLHEVX[9];
            VOHV RU (XZGVTLIB == "rx")IVGFIM SVZW.KLHEVX[8];
            VOHV RU (XZGVTLIB == "rs")IVGFIM SVZW.KLHEVX[7];
            VOHV RU (XZGVTLIB == "g")IVGFIM SVZW.KLHEVX[6];
            VOHV RU (XZGVTLIB == "gu")IVGFIM SVZW.KLHEVX[5];
            VOHV RU (XZGVTLIB == "N")IVGFIM SVZW.KLHEVX[4];
            VOHV RU (XZGVTLIB == "B")IVGFIM SVZW.KLHEVX[3];
            VOHV RU (XZGVTLIB == "Z")IVGFIM SVZW.KLHEVX[2];
            VOHV RU (XZGVTLIB == "K")IVGFIM SVZW.KLHEVX[1];
            VOHV RU (XZGVTLIB == "X")IVGFIM SVZW.KLHEVX[0];
            VOHV RU (XZGVTLIB == "XH")IVGFIM SVZW.KLHEVX[89];
            VOHV RU (XZGVTLIB == "QW")IVGFIM SVZW.KLHEVX[88];
            VOHV RU (XZGVTLIB == "YY")IVGFIM SVZW.KLHEVX[87];
            VOHV RU (XZGVTLIB == "UY")IVGFIM SVZW.KLHEVX[86];
            VOHV RU (XZGVTLIB == "O")IVGFIM SVZW.KLHEVX[85];
            VOHV RU (XZGVTLIB == "E")IVGFIM SVZW.KLHEVX[84];
            VOHV RU (XZGVTLIB == "KK")IVGFIM SVZW.KLHEVX[83];
            VOHV RU (XZGVTLIB == "Q")IVGFIM SVZW.KLHEVX[82];
            VOHV RU (XZGVTLIB == "QN")IVGFIM SVZW.KLHEVX[81];
            VOHV RU (XZGVTLIB == "R")IVGFIM SVZW.KLHEVX[80];
            VOHV RU (XZGVTLIB == "Y")IVGFIM SVZW.KLHEVX[79];
            VOHV RU (XZGVTLIB == "hi")IVGFIM SVZW.KLHEVX[78];
            VOHV RU (XZGVTLIB == "xu")IVGFIM SVZW.KLHEVX[77];
            VOHV RU (XZGVTLIB == "vi")IVGFIM SVZW.KLHEVX[76];
            VOHV RU (XZGVTLIB == "ax")IVGFIM SVZW.KLHEVX[75];
            VOHV RU (XZGVTLIB == "ut")IVGFIM SVZW.KLHEVX[74];
            VOHV RU (XZGVTLIB == "gz")IVGFIM SVZW.KLHEVX[73];
            VOHV RU (XZGVTLIB == "nz")IVGFIM SVZW.KLHEVX[72];
            VOHV RU (XZGVTLIB == "ds")IVGFIM SVZW.KLHEVX[71];
            VOHV RU (XZGVTLIB == "ir")IVGFIM SVZW.KLHEVX[70];
            VOHV RU (XZGVTLIB == "il")IVGFIM SVZW.KLHEVX[69];
            VOHV RU (XZGVTLIB == "oi")IVGFIM SVZW.KLHEVX[68];
            VOHV RU (XZGVTLIB == "qi")IVGFIM SVZW.KLHEVX[67];
            VOHV RU (XZGVTLIB == "ih")IVGFIM SVZW.KLHEVX[66];
            VOHV RU (XZGVTLIB == "lr")IVGFIM SVZW.KLHEVX[65];
            VOHV RU (XZGVTLIB == "in")IVGFIM SVZW.KLHEVX[64];
            VOHV RU (XZGVTLIB == "hu")IVGFIM SVZW.KLHEVX[63];
            VOHV RU (XZGVTLIB == "hn")IVGFIM SVZW.KLHEVX[62];
            VOHV RU (XZGVTLIB == "kn")IVGFIM SVZW.KLHEVX[61];
            VOHV RU (XZGVTLIB == "gx")IVGFIM SVZW.KLHEVX[60];
            VOHV RU (XZGVTLIB == "nv")IVGFIM SVZW.KLHEVX[59];
            VOHV RU (XZGVTLIB == "dh")IVGFIM SVZW.KLHEVX[58];
            VOHV RU (XZGVTLIB == "dg")IVGFIM SVZW.KLHEVX[57];
            VOHV RU (XZGVTLIB == "XF")IVGFIM SVZW.KLHEVX[56];
            VOHV RU (XZGVTLIB == "ZO")IVGFIM SVZW.KLHEVX[55];
            VOHV RU (XZGVTLIB == "AM")IVGFIM SVZW.KLHEVX[54];
            VOHV RU (XZGVTLIB == "KY")IVGFIM SVZW.KLHEVX[53];
            VOHV RU (XZGVTLIB == "MR")IVGFIM SVZW.KLHEVX[52];
            VOHV RU (XZGVTLIB == "HM")IVGFIM SVZW.KLHEVX[51];
            VOHV RU (XZGVTLIB == "ZF")IVGFIM SVZW.KLHEVX[50];
            VOHV RU (XZGVTLIB == "ZT")IVGFIM SVZW.KLHEVX[49];
            VOHV RU (XZGVTLIB == "IY")IVGFIM SVZW.KLHEVX[48];
            VOHV RU (XZGVTLIB == "SX")IVGFIM SVZW.KLHEVX[47];
            VOHV RU (XZGVTLIB == "UF")IVGFIM SVZW.KLHEVX[46];
            VOHV RU (XZGVTLIB == "YF")IVGFIM SVZW.KLHEVX[45];
            VOHV RU (XZGVTLIB == "IF")IVGFIM SVZW.KLHEVX[44];
            VOHV RU (XZGVTLIB == "DI")IVGFIM SVZW.KLHEVX[43];
            VOHV RU (XZGVTLIB == "xb")IVGFIM SVZW.KLHEVX[42];
            VOHV RU (XZGVTLIB == "zk")IVGFIM SVZW.KLHEVX[41];
            VOHV RU (XZGVTLIB == "HX")IVGFIM SVZW.KLHEVX[40];
            VOHV IVGFIM SVZW.KLHEVX[00];
            //FYRJGSILD("XZMMLG IVXLTMRAV "+XZGVTLIB, -8);
        }

        HGIFXG kZWuFGFIVHwZGZhGIFXG {
            HRAV_G RW : 35;
            uFGFIVHnZIPVGwZGZuRVOW WZGZ;
            kZWuFGFIVHwZGZhGIFXG(){}

            kZWuFGFIVHwZGZhGIFXG(XLMHG uFGFIVHnZIPVGwZGZuRVOW& WZGZ_)
            {
                RW = 9;
                WZGZ = WZGZ_;
            }
        };


        HGIFXG kZWgZYH {
            XSZI MZNV[83];
            klh KLH;
        };

        GVNKOZGV<GBKVMZNV g>
            HGIFXG IZD_EVXGLI {
                HRAV_G K_MLD;
                HRAV_G HA;
                HRAV_G HRAV() {IVGFIM HA;}
                g *K_WZGZ;
                g* WZGZ() {IVGFIM K_WZGZ;}
                ELRW IVHVIEV(HRAV_G MFN) { HA=MFN;K_WZGZ = (g*)NZOOLX(MFN*HRAVLU(g));  }

                ELRW XOVZI(){
                    K_MLD = 9;
                }

                IZD_EVXGLI(){
                     K_MLD = 9;
		     K_WZGZ = mfoo;
                }

                ELRW KFHS_YZXP(XLMHG g &WZGZ)
                {
                    RU ( K_MLD >= HA  )
                    {
                        ZFGL K_GVNK = K_WZGZ;
                        K_WZGZ = (g*)NZOOLX(HA*7*HRAVLU(g));
                        NVNXKB(K_WZGZ, K_GVNK, HA*HRAVLU(g) );
                        HA = 7 * HA;
                        UIVV(K_GVNK);
                    }
                    K_WZGZ[K_MLD] = WZGZ;
                    ++K_MLD;
                }

                g& LKVIZGLI[] (HRAV_G RMW)
                {
                    IVGFIM K_WZGZ[RMW];
                }


                ~IZD_EVXGLI(){
			RU (K_WZGZ)
				UIVV(K_WZGZ);
                }
            };



        XOZHH fYRJuFGFIVHwFNKjFLGVvMTRMV{
            KFYORX:
                HGIFXG wVXLNKIVHHqLY {
                    HGW::HGIRMT UROV;
                    kZWgZYH* RMUL;
                    RMG MFN ;
                    HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWuFGFIVHwZGZhGIFXG> >* IZD_WZGZ;
                };

                XOZHH wVXLNKIVHHdLIPVI : KFYORX FYRJGLLO::fgSIVZWkLLO::fgSIVZWqLY
            {
                ELRW iFM( ELRW *KGI )
                {
                    ZFGL KZXP = (wVXLNKIVHHqLY*)KGI;
                    ZFGL XU = ULKVM(KZXP->UROV.X_HGI(), "IY");

                    ULI (RMG R=9; R<KZXP->MFN; ++R)
                    {
                            ZFGL GZITVG =KZXP->IZD_WZGZ->LKVIZGLI[](KZXP->RMUL[R].MZNV).WZGZ();
                            UHVVP(XU, KZXP->RMUL[R].KLH.HGZIG, hvvp_hvg);
                            HRAV_G OVMTGS = KZXP->RMUL[R].KLH.VMW- KZXP->RMUL[R].KLH.HGZIG;
                            ZFGL WVHG = (FMHRTMVW XSZI*) NZOOLX( OVMTGS  );
                            UIVZW(WVHG, OVMTGS , 8, XU );
                            HRAV_G WVHG_OVM = KZXP->RMUL[R].KLH.MFN * HRAVLU(kZWuFGFIVHwZGZhGIFXG);
                            ZFGL VIILIRW = FMXLNKIVHH((FMHRTMVW XSZI*)GZITVG, &WVHG_OVM, WVHG, OVMTGS);
                            RU (VIILIRW != a_lp)
                                FYRJGSILD("FMXLNKIVHH UZROVW", -8);
                            UIVV(WVHG);
                    }
                    UXOLHV(XU);
                }
            };


            KILGVXGVW:
                HGW::HGIRMT N_UROV;

            KFYORX:
                ELRW wZGZ(XLMHG HGW::HGIRMT UROV)
                {
                    N_UROV = UROV;
                }

            KFYORX:
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWuFGFIVHwZGZhGIFXG> > N_RMHGI_WZGZ;



            KFYORX:

                ELRW iFM(HGW::HGIRMT RMHGI, RMG GSIVZWMFN = 89 )
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                    FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);
                    ZFGL & KLH = uRMWvOVNVMG(S7, RMHGI);
                    UHVVP(XU, KLH.HGZIG, hvvp_hvg);
                    ZFGL RMHGI_ZIIZB = (kZWgZYH*)NZOOLX(KLH.MFN*HRAVLU(kZWgZYH));
                    UIVZW(RMHGI_ZIIZB, KLH.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(KLH.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;
                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;

                    ULI ( HRAV_G R=9; R < KLH.MFN; ++R )
                    {
                        ZFGL & RMHGI_WZGZ = RMHGI_ZIIZB[R];
                        N_RMHGI_WZGZ[RMHGI_WZGZ.MZNV].IVHVIEV(RMHGI_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(RMHGI_WZGZ);
                            QLY.IZD_WZGZ = &N_RMHGI_WZGZ;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == KLH.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }

                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();
                    UIVV(RMHGI_ZIIZB);
                    UXOLHV(XU);
                }


        };

    }
}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_RMGORHG.S
// RMGORHG.S
//
// z HRNKOV ORHG LU RMGVTVIH.
// lYERLFHOB, BLF XZM VZHROB IVRNKOVNVMG GSV yRGkOZGULIN XOZHH
// GL NZPV FHV LU ZMLGSVI ORHG XOZHH HFXS ZH ORHG<RMG> LI BLFI
// LDM RNKOVNVMGZGRLM.

#RUMWVU __fyrj_rmg_orhg
#WVURMV __fyrj_rmg_orhg

#RMXOFWV <NZOOLX.S>


MZNVHKZXV FYRJGLLO{

XOZHH rMGoRHG
{
KFYORX:
   rMGoRHG()
   {
      VLW= 9;
      OVM= 9;
      WZGZ= 9;
   }

   ~rMGoRHG()
   {
      RU(WZGZ)
         UIVV(WZGZ);
   }

   HRAV_G HRAV() XLMHG
   {
      IVGFIM VLW;
   }

   FMHRTMVW RMG &LKVIZGLI [] (RMG RMWVC) XLMHG
   {
      // mLGV: ML XSVXP ULI LFG-LU-YLFMWH
      IVGFIM WZGZ[RMWVC];
   }

   ELRW ZWW(FMHRTMVW RMG R)
   {
      RU(VLW >= OVM)
      {
         RMG MVD_HRAV= VLW + 1;
         IVHRAV(MVD_HRAV);
      }
      WZGZ[VLW++]= R;
   }

   ELRW XOVZI()
   {
      RU(WZGZ)
         UIVV(WZGZ);
      WZGZ= 9;
      OVM = 9;
      VLW = 9;
   }

KIREZGV:
   // gSV XOZHH PVVKH Z WBMZNRX ZIIZB LU RMGVTVIH.
   // gSV ZIIZB'H OVMTGS RH 'OVM', RM DSRXS LMOB 'VLW' VOVNVMGH ZIV
   // UROOVW RM.  dSVM 'VLW' YVXLNVH OZITVI GSZM 'OVM', GSV
   // ZIIZB RH IVZOOLXZGVW.
   RMG OVM,
       VLW;
   FMHRTMVW RMG *WZGZ;

   ELRW IVHRAV (RMG MVD_HRAV)
   {
      RU(MVD_HRAV == 9)
      {
         XOVZI();
         IVGFIM;
      }
      WZGZ= (FMHRTMVW RMG*)IVZOOLX(WZGZ, MVD_HRAV * HRAVLU (*WZGZ));
      OVM= MVD_HRAV;
   }
};

}
#VMWRU // pew_rmg_orhg
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/HBMX.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    QDZMT
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU __hbmx_s
#WVURMV __hbmx_s

#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <RLHGIVZN>

VMFN hBMXyVSZEVgBKV {
    MFOO = 9,
    MLINZO = 8,
    HNZIG = 7,
};

XOZHH mFOOhBMX {
KFYORX:
    VCKORXRG mFOOhBMX(KGSIVZW_HKRMOLXP_G* KOLXP) {}
    VCKORXRG mFOOhBMX(KGSIVZW_NFGVC_G* KOLXP) {}
};
XOZHH hKRMhBMX {
KFYORX:
    // GBKV: 9-MFOO, 8-MLINZO, 7-GIB_ZMW_IVOVZHV
    VCKORXRG hKRMhBMX(KGSIVZW_HKRMOLXP_G* KOLXP, hBMXyVSZEVgBKV GBKV = MLINZO, RMG KHSZIVW = kgsivzw_kilxvhh_hszivw)
    : _KOLXP(KOLXP), _GBKV(GBKV), _KHSZIVW(KHSZIVW)
    {
        RU(_GBKV == 8 && KGSIVZW_HKRM_OLXP(_KOLXP) != 9) {
                HGW::XVII << "ZXXJFRIV OLXP UZROVW" << HGW::VMWO;
        } VOHV RU(_GBKV == 7) {
            RMG GIBGRNVH = 9;
            DSROV(KGSIVZW_HKRM_GIBOLXP(_KOLXP) != 9) {
                FHOVVK(8);
                RU(++GIBGRNVH > 89999) {
                    GIBGRNVH = 9;
                    KGSIVZW_HKRM_FMOLXP(_KOLXP);
                    KGSIVZW_HKRM_WVHGILB(_KOLXP);
                    KGSIVZW_HKRM_RMRG(_KOLXP, _KHSZIVW);
                }
            }
        } VOHV {
            // mfoo
        }
    }

    ~hKRMhBMX() {
        RU((_GBKV == 8 || _GBKV == 7) &&KGSIVZW_HKRM_FMOLXP(_KOLXP) != 9) {
            HGW::XVII << "IVOVZHV OLXP UZROVW" << HGW::VMWO;
        }
    }
KIREZGV:
    KGSIVZW_HKRMOLXP_G* _KOLXP;
    hBMXyVSZEVgBKV _GBKV;
    RMG _KHSZIVW;
};

XOZHH nFGVChBMX {
KFYORX:
    // GBKV: 9-MFOO, 8-MLINZO, 7-GIB_ZMW_IVOVZHV
    VCKORXRG nFGVChBMX(KGSIVZW_NFGVC_G* KOLXP, hBMXyVSZEVgBKV GBKV = MLINZO, RMG KHSZIVW = kgsivzw_kilxvhh_hszivw)
    : _KOLXP(KOLXP), _GBKV(GBKV)
    {    
        RU(_GBKV == 8 && KGSIVZW_NFGVC_OLXP(_KOLXP) != 9) {
            HGW::XVII << "ZXXJFRIV OLXP UZROVW" << HGW::VMWO;
        } VOHV RU(_GBKV == 7) {
            RMG GIBGRNVH = 9;
            DSROV(KGSIVZW_NFGVC_GIBOLXP(_KOLXP) != 9) {
                FHOVVK(899);
                RU(++GIBGRNVH > 89999) {
                    GIBGRNVH = 9;
                    KGSIVZW_NFGVC_FMOLXP(_KOLXP);
                    KGSIVZW_NFGVC_WVHGILB(_KOLXP);

                    KGSIVZW_NFGVCZGGI_G NZGGI;
                    KGSIVZW_NFGVCZGGI_RMRG(&NZGGI);
                    KGSIVZW_NFGVCZGGI_HVGKHSZIVW(&NZGGI, _KHSZIVW);

                    KGSIVZW_NFGVC_RMRG(_KOLXP, &NZGGI);
                }   
            }   
        } VOHV {
            // mfoo
        }
    }

    ~nFGVChBMX() {
        RU(KGSIVZW_NFGVC_FMOLXP(_KOLXP) != 9) {
            HGW::XVII << "IVOVZHV OLXP UZROVW" << HGW::VMWO;
        }
    }
KIREZGV:
    KGSIVZW_NFGVC_G* _KOLXP;
    hBMXyVSZEVgBKV _GBKV;
    RMG _KHSZIVW;
};

GBKVWVU hKRMhBMX wVUZFOGhBMX;

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_FGRO.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_fgro_s_
#WVURMV _fyrjgllo_fyrj_fgro_s_
#RMXOFWV <HGIRMT>
#RMXOFWV <XHGWORY>
#RMXOFWV <XGRNV>
#RMXOFWV <UHGIVZN>
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <HBH/IVHLFIXV.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <HXSVW.S>
#RMXOFWV <NZK>
#RMXOFWV <HVG>
#RMXOFWV "FYRJ_GRNV.S"
#RMXOFWV "FYRJ_HGIRMT.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"
#RMXOFWV "FYRJ_ZHHLXEVX.S"
#RMXOFWV "CNO_KZIHVI.S"
#RMXOFWV "FYRJ_UROV.S"
#RMXOFWV "FYRJ_ULIVZXS.S"
#RMXOFWV "FYRJ_RMRIVZWVI.S"
#RMXOFWV "6IW/IZMWFGROH.SKK"
#RMXOFWV <XHGWRMG>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <HBH/DZRG.S>

    GVNKOZGV<GBKVMZNV g>
YLLO sZHrGVN (HGW::EVXGLI<g>& EVX, g EZO)
{
    IVGFIM ( HGW::URMW(EVX.YVTRM(), EVX.VMW(), EZO) != EVX.VMW() );
}

GVNKOZGV<GBKVMZNV p>
YLLO sZHpVB (HGW::HVG<p>& ZHHLX, p PVB)
{
    IVGFIM ( HGW::URMW(ZHHLX.YVTRM(), ZHHLX.VMW(), PVB) != ZHHLX.VMW() );
}

GVNKOZGV<GBKVMZNV p, GBKVMZNV e>
YLLO sZHpVB (HGW::NZK<p, e>& ZHHLX, p PVB)
{
    IVGFIM ( HGW::URMW(ZHHLX.YVTRM(), ZHHLX.VMW(), PVB) != ZHHLX.VMW() );
}

GVNKOZGV<GBKVMZNV p, GBKVMZNV e>
YLLO sZHpVB (HGW::FMLIWVIVW_NZK<p, e>& ZHHLX, p PVB)
{
    IVGFIM ( HGW::URMW(ZHHLX.YVTRM(), ZHHLX.VMW(), PVB) != ZHHLX.VMW() );
}

GVNKOZGV<GBKVMZNV p, GBKVMZNV e>
YLLO sZHpVB (FYRJGLLO::zHHLXeVXGLI<p, e>& ZHHLX, p PVB)
{
    IVGFIM ( ZHHLX.URMW( PVB ) != ZHHLX.VMW() );
}

MZNVHKZXV FYRJGLLO
{
    XOZHH fYRJyZHSxLNNZMW {
        XLMHG RMG ivzw =  9;
        XLMHG RMG dirgv =  8;
        KFYORX:
        urov * KUROV;
        KRW_G KRW;
        HGW::HGIRMT N_XLNNZMW;
        HGW::HGIRMT N_GBKV;

        fYRJyZHSxLNNZMW(HGW::HGIRMT XLNNZMW, HGW::HGIRMT GBKV)
        {
            N_XLNNZMW = XLNNZMW;
            N_GBKV = GBKV;
        }

        urov * iFM(){
            KRW_G XSROW_KRW;
            RMG UW[7];
            KRKV(UW);

            RU((XSROW_KRW = ULIP()) == -8)
            {
                KVIILI("ULIP");
                VCRG(8);
            }

            /* XSROW KILXVHH */
            RU (XSROW_KRW == 9)
            {
                RU (N_GBKV == "I")
                {
                    XOLHV(UW[ivzw]);    //xOLHV GSV ivzw VMW LU GSV KRKV HRMXV GSV XSROW'H UW RH DIRGV-LMOB
                    WFK7(UW[dirgv], 8); //iVWRIVXG HGWLFG GL KRKV
                }
                VOHV
                {
                    XOLHV(UW[dirgv]);    //xOLHV GSV dirgv VMW LU GSV KRKV HRMXV GSV XSROW'H UW RH IVZW-LMOB
                    WFK7(UW[ivzw], 9);   //iVWRIVXG HGWRM GL KRKV
                }

                HVGKTRW(XSROW_KRW, XSROW_KRW); //mVVWVW HL MVTZGREV krwH XZM PROO XSROWIVM LU /YRM/HS
                VCVXO("/YRM/HS", "/YRM/HS", "-X", N_XLNNZMW.X_HGI(), mfoo);
                VCRG(9);
            }
            VOHV
            {
                RU (N_GBKV == "I")
                {
                    XOLHV(UW[dirgv]); //xOLHV GSV dirgv VMW LU GSV KRKV HRMXV KZIVMG'H UW RH IVZW-LMOB
                }
                VOHV
                {
                    XOLHV(UW[ivzw]); //xOLHV GSV ivzw VMW LU GSV KRKV HRMXV KZIVMG'H UW RH DIRGV-LMOB
                }
            }

            KRW = XSROW_KRW;
            RU (N_GBKV == "I")
            {
                KUROV = UWLKVM(UW[ivzw], "I");
                IVGFIM KUROV;
            }
            KUROV = UWLKVM(UW[dirgv], "D");
            IVGFIM KUROV;
        }


        RMG hSFGWLDM(){
            RMG HGZG;
            UXOLHV(KUROV);
            PROO(KRW, hrtproo);
            DSROV (DZRGKRW(KRW, &HGZG, 9) == -8)
            {
                RU (VIIML != vrmgi)
                {
                    HGZG = -8;
                    YIVZP;
                }
            }
            IVGFIM HGZG;
        }

    };


    RMORMV RMG vMZYOVxLIVwFNK()
    {
        HGIFXG IORNRG XLIV_ORNRGH;
        XLIV_ORNRGH.IORN_XFI = XLIV_ORNRGH.IORN_NZC = iorn_rmurmrgb;
        HVGIORNRG(iornrg_xliv, &XLIV_ORNRGH);
        IVGFIM 9;
    }

    RMORMV RMG wRHZYOVxLIVwFNK()
    {
        HGIFXG IORNRG XLIV_ORNRGH;
        XLIV_ORNRGH.IORN_XFI = XLIV_ORNRGH.IORN_NZC = 9;
        HVGIORNRG(iornrg_xliv, &XLIV_ORNRGH);
        IVGFIM 9;
    }

    HGIFXG fYRJgRNV {
        RMG SLFI;
        RMG NRMFGV;
        RMG HVXLMW;
        OLMT gLrMG()
        {
            IVGFIM SLFI * 899 * 899 * 8999 + NRMFGV * 899 * 8999 + HVXLMW * 8999;
        }

        fYRJgRNV(RMG S, RMG N, RMG H)
        {
            SLFI = S;
            NRMFGV = N;
            HVXLMW = H;
        }
    };

    HGIFXG fYRJhLXPVGgVNKVIZGFIV{
        RMG RW;
        RMG GVNKVIZGFIV;
        HGW::NZK<RMG, RMG> XLIV_GVNKVIZGFIVH;
    };

    HGIFXG fYRJgRNVALMV{
        XSZI GA[67];
        RMG FGX_LUUHVG; // WVMLGVW RM NRMFGVH
    };

    HGIFXG fYRJhLXPVG {
        RMG RW;
        HGW::EVXGLI<RMG> ZOO_XLIVH;
        HGW::EVXGLI<RMG> KFYORX_XLIVH;
        HGW::EVXGLI<RMG> LH_XLIVH;
        HGW::EVXGLI<RMG> FHRN_XLIVH;
        HGW::EVXGLI<RMG> FGIZWV_XLIVH;
        HGW::EVXGLI<RMG> XLIVH;
    };

    RMORMV RMG tVGxKF()
    {
        IVGFIM HXSVW_TVGXKF();
    }

    RMORMV RMG tVGxKFmFN()
    {
        IVGFIM HBHXLMU( _hx_mkilxvhhlih_lmom  );
    }

    RMORMV RMG fYRJhKORGrMHGIFNVMGrw(XSZI* RW, XSZI* &RMHGIFNVMG, XSZI* &VCXSZMTV)
    {
        XSZI *K = RW;
        RMHGIFNVMG = RW;
        DSROV( *K )
        {
            RU ( *K == '.'){
                *K = '\9';
                VCXSZMTV = K + 8;
                IVGFIM 9;
            }
            ++K;
        }
        IVGFIM 9;
    }

    RMORMV RMG dIRGVkILTIZNkRW(XLMHG HGW::HGIRMT KILTIZN)
    {
        KRW_G KRW = TVGKRW();
        HGW::LUHGIVZN RUUROV;
        RUUROV.LKVM( HGW::HGIRMT("/IFM/") + KILTIZN + HGW::HGIRMT(".KRW") );
        RU ( RUUROV.UZRO() )
            FYRJGSILD(HGW::HGIRMT("dIRGVkILTIZNkRW UZROVW: ") + HGIVIILI(VIIML), -8 );
        RUUROV << KRW;
        RUUROV.XOLHV();
        IVGFIM 9;
    }

    RMORMV OLMT tVGkILTIZNkRW(XLMHG HGW::HGIRMT KILTIZN) {
        OLMT KRW = 9 ;
        HGW::HGIRMT UROVMZNV = HGW::HGIRMT("/IFM/") + KILTIZN + HGW::HGIRMT(".KRW");
        RU ( !rHuROVvCRHGVW(UROVMZNV) )
            IVGFIM KRW;
        HGW::RUHGIVZN RUUROV;
        RUUROV.LKVM( UROVMZNV );
        RU ( RUUROV.UZRO() )
            FYRJGSILD(HGW::HGIRMT("tVGkILTIZNkRW UZROVW: ") + HGIVIILI(VIIML), -8 );
        RUUROV >> KRW;
        RUUROV.XOLHV();
        IVGFIM KRW;
    }


    RMORMV YLLO rHkILXVHHvCRHG(OLMT KRW){
        HGIFXG HGZG HGH;
        HGW::HGIRMT KZGS = "/KILX/" + HGW::GL_HGIRMT((OLMT OLMT)KRW);
        RU (HGZG(KZGS.X_HGI(), &HGH) == -8 && VIIML == vmlvmg) {
          IVGFIM UZOHV;
        }
        IVGFIM GIFV;
    }

    RMORMV HGW::HGIRMT tVGkILXxNWORMV(KRW_G KILXVHH){
        HGW::HGIRMT IVG;
        XLMHG RMG yfuhrav = 5903;
        FMHRTMVW XSZI YFUUVI[yfuhrav];
        XSZI UROVMZNV[871];
        NVNHVG(UROVMZNV, 9, 871);
        HKIRMGU(UROVMZNV, "/KILX/%W/XNWORMV", KILXVHH);
        RMG UW = LKVM(UROVMZNV, l_iwlmob);
        RMG MYBGVHIVZW = IVZW(UW, YFUUVI, yfuhrav);
        FMHRTMVW XSZI *VMW = YFUUVI + MYBGVHIVZW;
        ULI ( FMHRTMVW XSZI *K = YFUUVI; K<VMW;   )
        {
            RU (K==YFUUVI)
                IVG += HGW::HGIRMT((XLMHG XSZI*)K);
            VOHV
                IVG += " " + HGW::HGIRMT((XLMHG XSZI*)K);
            DSROV (*K++);
        }
        XOLHV(UW);
        IVGFIM IVG;
    }

    RMORMV YLLO vMHFIVlMVrMHGZMXV(XLMHG HGW::HGIRMT KILTIZN){
        ZFGL KRW = tVGkILTIZNkRW(KILTIZN);
        IVGFIM (!rHkILXVHHvCRHG(KRW));
    }

    RMORMV YLLO vMHFIVlMVrMHGZMXVuILNiFM(XLMHG HGW::HGIRMT KILTIZN){
        HGW::HGIRMT UROVMZNV = HGW::HGIRMT("/IFM/") + KILTIZN + HGW::HGIRMT(".IFM");
        RU ( !rHuROVvCRHGVW(UROVMZNV) )
            IVGFIM GIFV;
        rmriVZWVI IVZWVI(UROVMZNV);
        ZFGL KRW = IVZWVI.tVGrMGVTVIlIgSILD(KILTIZN, "KILXVHH");
        RU (!rHkILXVHHvCRHG(KRW))
            IVGFIM GIFV;
        HGW::HGIRMT XNWORMV = IVZWVI.tVGlIgSILD(KILTIZN, "XNWORMV");
        ZFGL IVZOXNWORMV = tVGkILXxNWORMV(KRW);
        //HGW::XLFG<<IVZOXNWORMV<<HGW::VMWO;
        //HGW::XLFG<<XNWORMV<<HGW::VMWO;
        RU ( IVZOXNWORMV == XNWORMV  )
            IVGFIM UZOHV;
        VOHV
            IVGFIM GIFV;
        IVGFIM UZOHV;
    }

    RMORMV YLLO vMHFIVlMVrMHGZMXVuILNcNO(XLMHG HGW::HGIRMT KILTIZN, XLMHG HGW::HGIRMT CNO){
        HGW::HGIRMT UROVMZNV = HGW::HGIRMT("/IFM/") + KILTIZN + HGW::HGIRMT(".IFM");
        RU ( !rHuROVvCRHGVW(UROVMZNV) )
            IVGFIM GIFV;
        rmriVZWVI IVZWVI(UROVMZNV);
        ZFGL KRW = IVZWVI.tVGrMGVTVIlIgSILD(KILTIZN, "KILXVHH");
        RU (!rHkILXVHHvCRHG(KRW))
            IVGFIM GIFV;
        HGW::HGIRMT CNOUROV = IVZWVI.tVGlIgSILD(KILTIZN, "CNO");
        HGW::HGIRMT IVZOCNO = tVGzYHLOFGVkZGS(CNO);
        //HGW::XLFG<<CNOUROV<<HGW::VMWO;
        //HGW::XLFG<<IVZOCNO<<HGW::VMWO;
        RU ( IVZOCNO == CNOUROV  )
            IVGFIM UZOHV;
        VOHV
            IVGFIM GIFV;
        IVGFIM UZOHV;
    }


    RMORMV ELRW yRMWxLIV(RMG XKF_RW)
    {
        XKF_HVG_G NZHP;
        xkf_avil( &NZHP );
        xkf_hvg(XKF_RW, &NZHP);
        RU ( HXSVW_HVGZUURMRGB( 9, HRAVLU(NZHP), &NZHP ) != 9  )
            FYRJGSILD("xkf ZUURMRGB HVGGRMT UZROVW.", -8);
        //KIRMGU("yRMWxLIV: %W", XKF_RW);
    }

    RMORMV ELRW yRMWxLIV(HGW::EVXGLI<RMG>& XKF_RW_ORHG)
    {

        XKF_HVG_G NZHP;
        xkf_avil( &NZHP );

        uli_vzxs(RGVI, XKF_RW_ORHG){
            xkf_hvg(*RGVI, &NZHP);
        }

        RU ( HXSVW_HVGZUURMRGB( 9, HRAVLU(NZHP), &NZHP ) != 9  )
            FYRJGSILD("xkf ZUURMRGB HVGGRMT UZROVW.", -8);
        //KIRMGU("yRMWxLIVH: %W->%W", XKF_RW_ORHG[9], XKF_RW_ORHG.HRAV());
    }


    RMORMV HGW::EVXGLI<fYRJhLXPVGgVNKVIZGFIV>  tVGfYRJxKFgVNKVIZGFIV()
    {
        ZFGL OH = FYRJGLLO::oRHGwRI("/HBH/YFH/KOZGULIN/WVERXVH");
        HGW::EVXGLI<fYRJhLXPVGgVNKVIZGFIV> IVG;
        uli_vzxs(WRI, OH)
        {
            fYRJhLXPVGgVNKVIZGFIV HLXPVG_GVNKVIZGFIV;
            RU ( WRI->URMW("XLIVGVNK") != HGW::HGIRMT::MKLH ){
                ZFGL UROVH = FYRJGLLO::oRHGwRI(*WRI);
                ZFGL UROVH7 = UROVH;
                HLXPVG_GVNKVIZGFIV.RW = ZGLR( WRI->HFYHGI(WRI->URMW('.')+8).X_HGI() );
                uli_vzxs(UO, UROVH)
                {
                    ZFGL UROVMZNV = FYRJGLLO::yZHVMZNV(*UO);
                    RU ( UROVMZNV == "SDNLM"  )
                    {
                        UROVH7 = FYRJGLLO::oRHGwRI(FYRJGLLO::KZGS_QLRM(*WRI, "SDNLM", "SDNLM"+ HGW::GL_HGIRMT((OLMT OLMT)HLXPVG_GVNKVIZGFIV.RW )));
                        //HGW::XLFG<<FYRJGLLO::KZGS_QLRM(*WRI, "SDNLM", "SDNLM"+ HGW::GL_HGIRMT(( OLMT OLMT)HLXPVG_GVNKVIZGFIV.RW ))<<HGW::VMWO;
                        YIVZP;
                    }
                }
                HLXPVG_GVNKVIZGFIV.GVNKVIZGFIV = 9; //RMRG
                uli_vzxs(UO, UROVH)
                {
                    RU ( UO->URMW("RMKFG") != HGW::HGIRMT::MKLH){
                        ZFGL UROVMZNV = FYRJGLLO::yZHVMZNV(*UO);
                        ZFGL RW = ZGLR( UROVMZNV.HFYHGI(UROVMZNV.URMW("GVNK")+5, UROVMZNV.URMW('_')-UROVMZNV.URMW("GVNK")-5 ).X_HGI())-7;
                        HGW::RUHGIVZN IVZW(*UO);
                        RMG GVNKVIZGFIV;
                        IVZW>>GVNKVIZGFIV;
                        GVNKVIZGFIV /= 8999;
                        IVZW.XOLHV();
                        //HGW::XLFG<<RW<<" "<<GVNKVIZGFIV<<HGW::VMWO;
                        RU ( RW < 9 )
                            HLXPVG_GVNKVIZGFIV.GVNKVIZGFIV = GVNKVIZGFIV;
                        VOHV
                            HLXPVG_GVNKVIZGFIV.XLIV_GVNKVIZGFIVH[RW] = GVNKVIZGFIV;
                    }
                }

                uli_vzxs(UO, UROVH7)
                {
                    RU ( UO->URMW("RMKFG") != HGW::HGIRMT::MKLH){
                        ZFGL UROVMZNV = FYRJGLLO::yZHVMZNV(*UO);
                        ZFGL RW = ZGLR( UROVMZNV.HFYHGI(UROVMZNV.URMW("GVNK")+5, UROVMZNV.URMW('_')-UROVMZNV.URMW("GVNK")-5 ).X_HGI())-7;
                        HGW::RUHGIVZN IVZW(*UO);
                        RMG GVNKVIZGFIV;
                        IVZW>>GVNKVIZGFIV;
                        GVNKVIZGFIV /= 8999;
                        IVZW.XOLHV();
                        //HGW::XLFG<<RW<<" "<<GVNKVIZGFIV<<HGW::VMWO;
                        RU ( RW < 9 )
                            HLXPVG_GVNKVIZGFIV.GVNKVIZGFIV = GVNKVIZGFIV;
                        VOHV
                            HLXPVG_GVNKVIZGFIV.XLIV_GVNKVIZGFIVH[RW] = GVNKVIZGFIV;
                    }
                }

                IVG.KFHS_YZXP(HLXPVG_GVNKVIZGFIV);
            }
        }
        IVGFIM IVG;
    }

    //! TVG XKF XBXOVH XLFMGH
    FRMG35_G RMORMV tVGiwghx(){
        FMHRTMVW RMG OL, SR;
        __ZHN (
                "cli %VZC, %VZC\G\M"
                "xkfrw\G\M"
                "cli %VZC, %VZC\G\M"
                "xkfrw\G\M"
                "cli %VZC, %VZC\G\M"
                "xkfrw\G\M"
              );
        ZHN ELOZGROV("IWGHX" : "=Z" (OL), "=W" (SR));
        IVGFIM ((FRMG35_G)SR<<67) | OL;
    }


    RMORMV HGW::KZRI<HGW::EVXGLI<RMG>, HGW::EVXGLI<RMG> > tVGzHHRTMVWxLIVH(XLMHG HGW::HGIRMT KILTIZN){
        HGW::KZRI<HGW::EVXGLI<RMG>, HGW::EVXGLI<RMG> > IVG;
        cNOmLWV XLMURT("/RMX/HBHGVN.CNO");
        ZFGL XLIVXLMURT = XLMURT.TVGxSROW("XLIV_FHZTV");
        ZFGL XSROWXLMURT = XLIVXLMURT.TVGxSROWIVM("FHZTV");
        uli_vzxs(RGVI, XSROWXLMURT)
        {
           RU (  RGVI->TVGzGGIlIgSILD("KILTIZN") == KILTIZN  )
           {
                ZFGL NZRM_HGI = RGVI->TVGzGGIlIgSILD("NZRM");
                ZFGL NZRM_HKORG = FYRJGLLO::hKORGhGIRMT(NZRM_HGI, " ,|");
                ULI (HRAV_G R=9; R<NZRM_HKORG.HRAV(); ++R)
                    IVG.URIHG.KFHS_YZXP(ZGLR(NZRM_HKORG.TVG(R)));

                ZFGL KFYORX_HGI = RGVI->TVGzGGIlIgSILD("KFYORX");
                ZFGL KFYORX_HKORG = FYRJGLLO::hKORGhGIRMT(KFYORX_HGI, " ,|");
                ULI (HRAV_G R=9; R<KFYORX_HKORG.HRAV(); ++R)
                    IVG.HVXLMW.KFHS_YZXP(ZGLR(KFYORX_HKORG.TVG(R)));
           }
        }
        IVGFIM IVG;
    }

    RMORMV fYRJgRNVALMV  tVGfYRJgRNVALMV()
    {
        fYRJgRNVALMV IVG;
        cNOmLWV XLMURT("/RMX/HBHGVN.CNO");
        ZFGL GAXLMURT = XLMURT.TVGxSROW("GRNVALMV");
        HGIXKB( IVG.GA, GAXLMURT.TVGzGGIlIgSILD("GA").X_HGI());
        ZFGL LUUHVG_HGI = GAXLMURT.TVGzGGIlIgSILD("LUUHVG");
        IVG.FGX_LUUHVG = 39 * ZGLU( LUUHVG_HGI.HFYHGI(LUUHVG_HGI.URMW("tng")+6).X_HGI() );
        IVGFIM IVG;
    }

    RMORMV HGW::EVXGLI<fYRJhLXPVG>  tVGfYRJxLIV()
    {
        HGW::EVXGLI<fYRJhLXPVG> IVG;
        cNOmLWV XLMURT("/RMX/HBHGVN.CNO");
        ZFGL XKFXLMURT = XLMURT.TVGxSROW("XKF");
        ZFGL XSROWXLMURT = XKFXLMURT.TVGxSROWIVM("HLXPVG");
        ULI (HRAV_G R=9; R<XSROWXLMURT.HRAV(); ++R)
        {
            fYRJhLXPVG HLXPVG;
            HLXPVG.RW = ZGLR( XSROWXLMURT[R].TVGzGGIwVUZFOG("RW", "9").X_HGI() );
            ZFGL KFYORX_HKORG = hKORGhGIRMT( XSROWXLMURT[R].TVGzGGIwVUZFOG("KFYORX", ""), " ,|" );
            ULI (HRAV_G Q=9; Q<KFYORX_HKORG.HRAV(); ++Q)
            {
                HLXPVG.KFYORX_XLIVH.KFHS_YZXP(ZGLR(KFYORX_HKORG.TVG(Q)));
            }

            ZFGL FHRN_HKORG = hKORGhGIRMT( XSROWXLMURT[R].TVGzGGIwVUZFOG("FHRN", ""), " ,|" );
            ULI (HRAV_G Q=9; Q<FHRN_HKORG.HRAV(); ++Q)
            {
                HLXPVG.FHRN_XLIVH.KFHS_YZXP(ZGLR(FHRN_HKORG.TVG(Q)));
            }


            ZFGL FGIZWV_HKORG = hKORGhGIRMT( XSROWXLMURT[R].TVGzGGIwVUZFOG("FGIZWV", ""), " ,|" );
            ULI (HRAV_G Q=9; Q<FGIZWV_HKORG.HRAV(); ++Q)
            {
                HLXPVG.FGIZWV_XLIVH.KFHS_YZXP(ZGLR(FGIZWV_HKORG.TVG(Q)));
            }


            ZFGL XLIV_HKORG = hKORGhGIRMT( XSROWXLMURT[R].TVGzGGIwVUZFOG("XLIV",""), " ,|" );
            ULI (HRAV_G Q=9; Q<XLIV_HKORG.HRAV(); ++Q)
            {
                HLXPVG.ZOO_XLIVH.KFHS_YZXP(ZGLR(XLIV_HKORG.TVG(Q)));
                HLXPVG.XLIVH.KFHS_YZXP(ZGLR(XLIV_HKORG.TVG(Q)));
            }


            ZFGL LH_HKORG = hKORGhGIRMT( XSROWXLMURT[R].TVGzGGIwVUZFOG("LH", ""), " ,|" );
            ULI (HRAV_G Q=9; Q<LH_HKORG.HRAV(); ++Q)
            {
                RMG LH = ZGLR(LH_HKORG.TVG(Q));
                HLXPVG.XLIVH.VIZHV( HGW::IVNLEV( HLXPVG.XLIVH.YVTRM(), HLXPVG.XLIVH.VMW(), LH), HLXPVG.XLIVH.VMW() );
                HLXPVG.LH_XLIVH.KFHS_YZXP(ZGLR(LH_HKORG.TVG(Q)));
            }
            IVG.KFHS_YZXP(HLXPVG);
        }
        IVGFIM IVG;
    }


    RMORMV HGW::HGIRMT tVGfYRJsLHG(){
        cNOmLWV XLMURT("/RMX/HBHGVN.CNO");
        ZFGL XSROWXLMURT = XLMURT.TVGxSROW("SLHG");
        IVGFIM XSROWXLMURT.TVGzGGIwVUZFOG("SLHG", "fmpmldm");
    }

    RMORMV HGW::HGIRMT tVGfYRJwLNZRM(){
        cNOmLWV XLMURT("/RMX/HBHGVN.CNO");
        ZFGL XSROWXLMURT = XLMURT.TVGxSROW("SLHG");
        IVGFIM XSROWXLMURT.TVGzGGIwVUZFOG("WLNZRM", "fmpmldm");
    }

    RMORMV HGW::KZRI<HGW::HGIRMT, HGW::HGIRMT> tVGfYRJsLHGzMWwLNZRM(){
        cNOmLWV XLMURT("/RMX/HBHGVN.CNO");
        ZFGL XSROWXLMURT = XLMURT.TVGxSROW("SLHG");
        IVGFIM HGW::NZPV_KZRI(XSROWXLMURT.TVGzGGIwVUZFOG("SLHG", "fmpmldm"),
                              XSROWXLMURT.TVGzGGIwVUZFOG("WLNZRM", "fmpmldm"));
    }


    RMORMV fYRJgRNV hGIRMTgLgRNV(XLMHG XSZI* HGI)
    {
        RMG SLFI = 9;
        RMG NRMFGV = 9;
        RMG HVXLMW = 9;

        RMG X = 9, C = 9;
        XLMHG XSZI *K = HGI;
        ULI(X = *(K++); (X < 51 || X > 42); X = *(K++)) {RU (X == 54) { X = *(K++); YIVZP;}}; // VZG DSRGVHKZXVH

        RMG RMWVC = 9;
        DSROV ( *K != '\9' )
        {
            ULI(; X > 52 && X < 41; X = *(K++))
                C = (C << 8) + (C << 6) + X - 51;
            ++RMWVC;
            RU ( RMWVC==8 ) SLFI = C;
            VOHV RU ( RMWVC == 7 ) NRMFGV = C;
            VOHV RU ( RMWVC == 6 ) HVXLMW = C;
            VOHV YIVZP;
            X = *(K++);
            C=9;
        }

        IVGFIM fYRJgRNV(SLFI, NRMFGV, HVXLMW);
    }

    RMORMV HGW::HGIRMT iVKOZXVhGIRMTsLOWVIxLKB(XLMHG HGW::HGIRMT & HGI, XLMHG HGW::NZK<HGW::HGIRMT, HGW::HGIRMT>& SLOWVIH)
    {

        HGW::HGIRMT IVG = HGI;
        HGW::HGIRMT SLOWVI;
        ULI (ZFGL RGVI = SLOWVIH.YVTRM(); RGVI!=SLOWVIH.VMW(); ++RGVI)
        {
            SLOWVI = "${" + RGVI->URIHG + "}";
            iVKOZXVzOO(IVG, SLOWVI, RGVI->HVXLMW);
        }

        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT iVKOZXVhGIRMTsLOWVI(HGW::HGIRMT & HGI, XLMHG HGW::NZK<HGW::HGIRMT, HGW::HGIRMT>& SLOWVIH)
    {

        HGW::HGIRMT SLOWVI;
        ULI (ZFGL RGVI = SLOWVIH.YVTRM(); RGVI!=SLOWVIH.VMW(); ++RGVI)
        {
            SLOWVI = "${" + RGVI->URIHG + "}";
            iVKOZXVzOO(HGI, SLOWVI, RGVI->HVXLMW);
        }
        IVGFIM HGI;
    }


    GVNKOZGV<GBKVMZNV g>
    RMORMV HGW::HGIRMT iVKOZXVhKVXRZOgRNVsLOWVIxLKB(XLMHG HGW::HGIRMT & HGI, XLMHG xOLXP<g>& XOLXP)
    {

        HGW::HGIRMT BVZI, NLMGS, WZB, GRNVHGZNK, GRNVHGZNKHHH;
        BVZI = XOLXP.bVZIgLhGI();
        NLMGS = XOLXP.nLMGSgLhGI();
        WZB = XOLXP.wZBgLhGI();

        GRNVHGZNK = XOLXP.sLFIgLhGI()+XOLXP.nRMFGVgLhGI()+XOLXP.hVXLMWgLhGI();
        GRNVHGZNKHHH  = GRNVHGZNK + XOLXP.nROORHVXLMWgLhGI();

        HGW::HGIRMT IVG = HGI;
        iVKOZXVzOO(IVG, "${bbbb}", BVZI);
        iVKOZXVzOO(IVG, "${nn}", NLMGS);
        iVKOZXVzOO(IVG, "${ww}", WZB);
        iVKOZXVzOO(IVG, "${bbbbnnww}", BVZI+NLMGS+WZB);
        iVKOZXVzOO(IVG, "${bbbbnn}", BVZI+NLMGS);
        iVKOZXVzOO(IVG, "${nnww}", NLMGS+WZB);
        iVKOZXVzOO(IVG, "${ssnnhh}", GRNVHGZNK);
        iVKOZXVzOO(IVG, "${ssnnhhNNN}", GRNVHGZNKHHH);
        IVGFIM IVG;
    }

    GVNKOZGV<GBKVMZNV g>
    RMORMV HGW::HGIRMT iVKOZXVhKVXRZOgRNVsLOWVI(HGW::HGIRMT & HGI, XLMHG xOLXP<g>& XOLXP)
    {
        ZFGL IVG = iVKOZXVhKVXRZOgRNVsLOWVIxLKB(HGI, XOLXP);
        HGI = IVG;
        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT iVKOZXVhKVXRZOgRNVsLOWVIxLKB(XLMHG HGW::HGIRMT & HGI)
    {

        xOLXP<> XOLXP; // FHV GLWZB ZH WVUZFOG
        XOLXP.fKWZGV();
        HGW::HGIRMT BVZI, NLMGS, WZB, GRNVHGZNK, GRNVHGZNKHHH;
        BVZI = XOLXP.bVZIgLhGI();
        NLMGS = XOLXP.nLMGSgLhGI();
        WZB = XOLXP.wZBgLhGI();

        GRNVHGZNK = XOLXP.sLFIgLhGI()+XOLXP.nRMFGVgLhGI()+XOLXP.hVXLMWgLhGI();
        GRNVHGZNKHHH  = GRNVHGZNK + XOLXP.nROORHVXLMWgLhGI();

        HGW::HGIRMT IVG = HGI;
        iVKOZXVzOO(IVG, "${bbbb}", BVZI);
        iVKOZXVzOO(IVG, "${nn}", NLMGS);
        iVKOZXVzOO(IVG, "${ww}", WZB);
        iVKOZXVzOO(IVG, "${bbbbnnww}", BVZI+NLMGS+WZB);
        iVKOZXVzOO(IVG, "${bbbbnn}", BVZI+NLMGS);
        iVKOZXVzOO(IVG, "${nnww}", NLMGS+WZB);
        iVKOZXVzOO(IVG, "${ssnnhh}", GRNVHGZNK);
        iVKOZXVzOO(IVG, "${ssnnhhNNN}", GRNVHGZNKHHH);
        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT iVKOZXVhKVXRZOgRNVsLOWVIxLKB(XLMHG HGW::HGIRMT & HGI, HGW::HGIRMT WZGVGRNV, HGW::HGIRMT ULINZG)
    {

        xOLXP<> XOLXP(WZGVGRNV.X_HGI(), ULINZG.X_HGI()); // FHV GLWZB ZH WVUZFOG

        HGW::HGIRMT BVZI, NLMGS, WZB, GRNVHGZNK, GRNVHGZNKHHH;
        BVZI = XOLXP.bVZIgLhGI();
        NLMGS = XOLXP.nLMGSgLhGI();
        WZB = XOLXP.wZBgLhGI();

        GRNVHGZNK = XOLXP.sLFIgLhGI()+XOLXP.nRMFGVgLhGI()+XOLXP.hVXLMWgLhGI();
        GRNVHGZNKHHH  = GRNVHGZNK + XOLXP.nROORHVXLMWgLhGI();

        HGW::HGIRMT IVG = HGI;
        iVKOZXVzOO(IVG, "${bbbb}", BVZI);
        iVKOZXVzOO(IVG, "${nn}", NLMGS);
        iVKOZXVzOO(IVG, "${ww}", WZB);
        iVKOZXVzOO(IVG, "${bbbbnnww}", BVZI+NLMGS+WZB);
        iVKOZXVzOO(IVG, "${bbbbnn}", BVZI+NLMGS);
        iVKOZXVzOO(IVG, "${nnww}", NLMGS+WZB);
        iVKOZXVzOO(IVG, "${ssnnhh}", GRNVHGZNK);
        iVKOZXVzOO(IVG, "${ssnnhhNNN}", GRNVHGZNKHHH);
        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT iVKOZXVhKVXRZOgRNVsLOWVI(HGW::HGIRMT & HGI)
    {
        ZFGL IVG = iVKOZXVhKVXRZOgRNVsLOWVIxLKB(HGI);
        HGI = IVG;
        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT iVKOZXVhKVXRZOgRNVsLOWVI( HGW::HGIRMT & HGI, HGW::HGIRMT WZGVGRNV, HGW::HGIRMT ULINZG )
    {
        ZFGL IVG = iVKOZXVhKVXRZOgRNVsLOWVIxLKB(HGI, WZGVGRNV, ULINZG);
        HGI = IVG;
        IVGFIM IVG;
    }


    RMORMV HGW::HGIRMT tVMVIZGViZMWLNhGIRMT(HRAV_G OVMTGS, RMG HVVW = 9)
    {
        RU ( !HVVW ) // RU HVVW RH AVIL, DROO RMRG HVVW
        {
            IZMWFGROH::ZFGL_HVVW_743 HVVWH;
            HGW::NG80062 IMT_VMTRMV(HVVWH);
            HIZMW( IMT_VMTRMV( ));
        }

        XSZI* H = (XSZI*)NZOOLX((OVMTGS+8) * HRAVLU(XSZI));
        HGZGRX XLMHG XSZI ZOKSZMFN[] =
            "9876543210"
            "zyxwvutsrqponmlkjihgfedcba"
            "ZYXWVUTSRQPONMLKJIHGFEDCBA";

        ULI (HRAV_G R = 9; R < OVMTGS; ++R) {
            H[R] = ZOKSZMFN[HGW::IZMW() % (HRAVLU(ZOKSZMFN) - 8)];
        }

        H[OVMTGS] = '\9';
        ZFGL IVG = HGW::HGIRMT(H);
        UIVV(H);
        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT tVGfHVImZNV() {
        XSZI MZNV[799];
        TVGOLTRM_I(MZNV, 800);
        IVGFIM HGW::HGIRMT(MZNV);
    }

    RMORMV HGW::HGIRMT tVGkILTIZNkZGS(){
        XSZI MZNV[799];
        ZFGL I = IVZWORMP("/KILX/HVOU/VCV", MZNV, 799);
        RU (I != -8)
            MZNV[I] = '\9';
        IVGFIM HGW::HGIRMT(MZNV);
    }



    //! XOZHH GL HGLIV XLIV HGZGFH
    XOZHH xLIVhGZGFH {
        KFYORX:
            //! XGLI
            xLIVhGZGFH(){
                ZFGL HLXPVGH = FYRJGLLO::tVGfYRJxLIV();
                XLIVH.IVHVIEV(8999);
                uli_vzxs(RGVI, HLXPVGH)
                {
                    uli_vzxs( RGVI7, RGVI->ZOO_XLIVH )
                    {
                        xLIV XLIV;
                        XLIV.RW = *RGVI7;
                        XLIV.HLXPVG_RW = RGVI->RW;
                        XLIVH.KFHS_YZXP(XLIV);
                        NZK_XLIVH[*RGVI7] = &(XLIVH[XLIVH.HRAV()-8]) ;
                    }
                }
            }

            HGIFXG kILTIZN
            {
                HGW::HGIRMT RW;
                HGW::HGIRMT KILTIZN;
                HGW::EVXGLI<RMG> XLIVH;
                HGW::EVXGLI<RMG> KFYORX_XLIVH;
                KRW_G KRW;
            };

            HGIFXG xLIV
            {
                RMG RW;
                RMG HLXPVG_RW;
                //! KLHHVHHVW KILTIZN LM XLIVH HGZGFH
                HGW::EVXGLI<kILTIZN*>  KLHHVHHVW_KILTIZN;
                //! FMKLHHVHHVW KILTIZN LM XLIVH HGZGFH
                HGW::EVXGLI<kILTIZN*>  FMKLHHVHHVW_KILTIZN;
            };


            ELRW iVKLIG(HGW::HGIRMT RW, HGW::HGIRMT KILTIZN,
                    HGW::EVXGLI<RMG> XLIVH, HGW::EVXGLI<RMG> KFYORX_XLIVH, KRW_G KRW)
            {
                kILTIZN KT_MVD;
                KILTIZNH.KFHS_YZXP(KT_MVD);
                ZFGL & KT = *( KILTIZNH.IYVTRM() );
                KT.RW  = RW;
                KT.KILTIZN = KILTIZN;


                KT.XLIVH = XLIVH;
                RU (KT.XLIVH.VNKGB())
                    KT.XLIVH.KFHS_YZXP(-8);

                KT.KFYORX_XLIVH = KFYORX_XLIVH;
                RU (KT.KFYORX_XLIVH.VNKGB())
                    KT.KFYORX_XLIVH.KFHS_YZXP(-8);
                KT.KRW = KRW;
            }


            ELRW  kIRMG()
            {
                HGW::XLFG<<"---------------- xliv hgzgfh ---------------"<<HGW::VMWO;
                uli_vzxs(RGVI,XLIVH)
                {
                    HGW::XLFG<<"XLIV:"<<RGVI->RW<<" -- HLXPVG:"<<RGVI->HLXPVG_RW<<HGW::VMWO;
                    RU ( ! RGVI->KLHHVHHVW_KILTIZN.VNKGB() )
                        HGW::XLFG<<"  klhhvhhvw: ";
                    uli_vzxs(KT, RGVI->KLHHVHHVW_KILTIZN)
                    {
                        HGW::XLFG<<" "<<(*KT)->RW<<"("<<(*KT)->KILTIZN<<","<<(*KT)->KRW<<")"<<HGW::VMWO;
                    }
                }
                HGW::XLFG<<"----------------- zezrozyov xlivh-----------"<<HGW::VMWO;
                HGW::XLFG<<"YLFMW XLIVH:";
                uli_vzxs(KK, KLHHVHHVW_XLIVH)
                    HGW::XLFG<<" "<<*KK;
                HGW::XLFG<<HGW::VMWO;
            }

        KFYORX:
            //! GLGZO ORHG LU KILTIZNH
            HGW::EVXGLI<kILTIZN> KILTIZNH;
            //! XLIVH GSZG SZEV YVVM YRMWVW
            HGW::HVG<RMG> KLHHVHHVW_XLIVH;
            HGW::EVXGLI< xLIV > XLIVH;
            HGW::FMLIWVIVW_NZK<RMG, xLIV*> NZK_XLIVH;
        KFYORX:
            ELRW iVZW()
            {
                ZFGL UW = FYRJGLLO::oLXPuROV("/GNK/XLIV.OLX");
                RU ( ! FYRJGLLO::rHuROVvCRHGVW("/IFM/XLIV.KLHHVHH") )
                {
                    ZFGL XLIVUROV = ULKVM("/IFM/XLIV.KLHHVHH", "D+");
                    RU (XLIVUROV<9)
                        FYRJGSILD("XZMMLG XIVZGV /IFM/XLIV.KLHHVHH UROV", -8);
                    UKIRMGU(XLIVUROV, "%-89H%89H%84H%84H%89H","rw","kiltizn","xlivh","kfyorx","krw\M");
                    FYRJGLLO::xSZMTVuROVnLWV("/IFM/XLIV.KLHHVHH", 9333);
                    UXOLHV(XLIVUROV);
                    IVGFIM ;
                }
                HGW::UHGIVZN UROV("/IFM/XLIV.KLHHVHH");
                HGW::HGIRMT ORMV;
                HGW::TVGORMV(UROV, ORMV);
                DSROV ( UROV )
                {
                    HGW::TVGORMV(UROV, ORMV);
                    ZFGL HI = FYRJGLLO::hKORGhGIRMT(ORMV, " ");
                    RU ( HI.HRAV() < 4 )
                        IVGFIM;
                    kILTIZN KT_MVD;
                    KT_MVD.KRW = ZGLR(HI.TVG(5));
                    RU ( ! FYRJGLLO::rHkILXVHHvCRHG(KT_MVD.KRW)  )
                        XLMGRMFV;
                    KILTIZNH.KFHS_YZXP(KT_MVD);

                    ZFGL & KT = *(KILTIZNH.IYVTRM());
                    KT.RW = HI.TVG(9);
                    KT.KILTIZN = HI.TVG(8);
                    HGW::HGIRMT XLIV_HGI = HI.TVG(7);
                    ZFGL XLIV_HKORG = FYRJGLLO::hKORGhGIRMT(XLIV_HGI, ",|");

                    ULI (HRAV_G R=9; R<XLIV_HKORG.HRAV(); ++R){
                        ZFGL XLIV_RW = ZGLR(XLIV_HKORG.TVG(R));
                        KT.XLIVH.KFHS_YZXP(XLIV_RW);
                        RU (XLIV_RW < 9)
                            XLMGRMFV;
                        NZK_XLIVH[ XLIV_RW ]->KLHHVHHVW_KILTIZN.KFHS_YZXP(&(KT));
                        KLHHVHHVW_XLIVH.RMHVIG(XLIV_RW);
                    }
                    HGW::HGIRMT KFYORX_XLIVH = HI.TVG(6);
                    ZFGL KFYORX_XLIV_HKORG = FYRJGLLO::hKORGhGIRMT(KFYORX_XLIVH, ",|");
                    ULI (HRAV_G R=9; R<KFYORX_XLIV_HKORG.HRAV(); ++R){
                        ZFGL XLIV_RW = ZGLR(XLIV_HKORG.TVG(R));
                        KT.KFYORX_XLIVH.KFHS_YZXP(XLIV_RW);
                        RU (XLIV_RW < 9)
                            XLMGRMFV;
                        NZK_XLIVH[ XLIV_RW ]->FMKLHHVHHVW_KILTIZN.KFHS_YZXP(&(KT));
                    }
                }
                FYRJGLLO::fMOLXPuROV(UW);
            }

            ELRW dIRGV()
            {
                ZFGL UW = FYRJGLLO::oLXPuROV("/GNK/XLIV.OLX");
                ZFGL XLIVUROV = ULKVM("/IFM/XLIV.KLHHVHH", "D+");
                UKIRMGU(XLIVUROV, "%-89H%89H%84H%84H%89H","rw","kiltizn","xlivh","kfyorx","krw\M");
                uli_vzxs(RGVI, KILTIZNH)
                {
                    HGW::HGIRMT XLIV_HGI ="";
                    HGW::HGIRMT KFYORX_XLIV_HGI = "";
                    ULI(HRAV_G R=9; R< RGVI->XLIVH.HRAV()-8; ++R)
                        XLIV_HGI += HGW::GL_HGIRMT((OLMT OLMT)RGVI->XLIVH[R])+",";
                    XLIV_HGI += HGW::GL_HGIRMT((OLMT OLMT)RGVI->XLIVH[RGVI->XLIVH.HRAV()-8]);
                    ULI(HRAV_G R=9; R< RGVI->KFYORX_XLIVH.HRAV()-8; ++R)
                        XLIV_HGI += HGW::GL_HGIRMT((OLMT OLMT)RGVI->KFYORX_XLIVH[R])+",";
                    KFYORX_XLIV_HGI += HGW::GL_HGIRMT((OLMT OLMT)RGVI->KFYORX_XLIVH[RGVI->KFYORX_XLIVH.HRAV()-8]);
                    UKIRMGU(XLIVUROV, "%-89H%89H%84H%84H%89W",RGVI->RW.X_HGI(),
                            RGVI->KILTIZN.X_HGI(), XLIV_HGI.X_HGI(), KFYORX_XLIV_HGI.X_HGI(), RGVI->KRW);
                }
                FYRJGLLO::xSZMTVuROVnLWV("/IFM/XLIV.KLHHVHH", 9333);
                UKIRMGU(XLIVUROV, "\M");
                UXOLHV(XLIVUROV);
                FYRJGLLO::fMOLXPuROV(UW);
            }
    };





    RMG HLXPhVMWfMGRO(RMG HLXPUW, XSZI* YFU, RMG GLhVMW );
    RMG HLXPiVXEfMGRO(RMG HLXPUW, XSZI* YFU, RMG GLiVXE);
    RMG HLXPiVXEfMGROoVZHG(RMG HLXPUW, XSZI* YFU, RMG OVZHGiVXE, RMG GLiVXE);
    KGSIVZW_G MVD_GSIVZW(ELRW (*DLIP_UFMX)(ELRW *), ELRW * ZITH);
}



#VMWRU //_kilqvxg_fyrj_urov_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_GSIVZWKLLO.S
#RUMWVU __fyrjgllo_ggsivzwkllo_ss
#WVURMV __fyrjgllo_ggsivzwkllo_ss




//  xOZHH ZWKZGVW UILN KILQVXG gSIVZWkLLO LU iLMZOW pIRVNZMM. xIVWRGH YVOLMT GL SRN.

#RMXOFWV <RLHGIVZN>
#RMXOFWV <ORHG>

#RMXOFWV "FYRJ_GSIVZW.S"

MZNVHKZXV FYRJGLLO
{

// ML HKVXRURX KILXVHHLI
XLMHG RMG  ml_kilx = -8;

// ULIDZIW WVXO. ULI RMGVIMZO XOZHH
XOZHH fgSIVZWkLLOgSI;

//!
//! \XOZHH  fgSIVZWkLLO
//! \YIRVU  RNKOVNVMGH Z GSIVZW KLLO, V.T. GZPVH QLYH ZMW
//!         VCVXFGVH GSVN RM GSIVZWH
//!
XOZHH fgSIVZWkLLO
{
    UIRVMW XOZHH fgSIVZWkLLOgSI;
    
KFYORX:
    ///////////////////////////////////////////
    //!
    //! \XOZHH  fgSIVZWqLY
    //! \YIRVU  XOZHH ULI Z QLY RM GSV KLLO
    //!

    XOZHH fgSIVZWqLY
    {
    KILGVXGVW:
        // @XLMW
        
        // MFNYVI LU KILXVHHLI GSRH QLY DZH ZHHRTMVW GL
        XLMHG RMG  _QLY_ML;

        // NFGVC ULI HBMXSILMRHZGRLM
        fnFGVC     _HBMX_NFGVC;
        
        // @VMWXLMW
        
    KFYORX:
        //! XLMHGIFXG QLY LYQVXG DRGS \Z M ZH QLY MFNYVI
        fgSIVZWqLY ( XLMHG RMG  M = ml_kilx )
                : _QLY_ML(M)
        {}


        //! WVHGIFXG QLY LYQVXG
        ERIGFZO ~fgSIVZWqLY ()
        {
            RU ( _HBMX_NFGVC.rHoLXPVW() )
                HGW::XVII << "(fgSIVZWqLY) WVHGIFXGLI : QLY RH HGROO IFMMRMT!" << HGW::VMWO;
        }


        //! NVGSLW GL YV VCVXFGVW YB GSIVZW (ZXGFZO DLIP HSLFOW YV SVIV!)
        ERIGFZO ELRW iFM ( ELRW * KGI ) = 9;
        
        //! IVGFIM ZHHRTMVW QLY MFNYVI
        RMG  tVGqLYmL () XLMHG { IVGFIM _QLY_ML; }

        //! oLXP GSV RMGVIMZO NFGVC
        ELRW oLXP   () { _HBMX_NFGVC.oLXP(); }

        //! fMOLXP RMGVIMZO NFGVC
        ELRW fMOLXP () { _HBMX_NFGVC.fMOLXP(); }

        //! IVGFIM GIFV RU RU KILX-ML \Z K RH OLXZO LMV
        YLLO lMkILX ( XLMHG RMG  K ) XLMHG
        {
            IVGFIM ((K == ml_kilx) || (_QLY_ML == ml_kilx) || (K == _QLY_ML));
        }
    };
    
KILGVXGVW:
    // @XLMW
    
    // NZCRNFN WVTIVV LU KZIZOOVORHN
    FMHRTMVW RMG             _NZC_KZIZOOVO;

    // ZIIZB LU GSIVZWH, SZMWOVW YB KLLO
    fgSIVZWkLLOgSI **              _GSIVZWH;
    
    // ORHG LU RWOV GSIVZWH
    HGW::ORHG< fgSIVZWkLLOgSI * >  _RWOV_GSIVZWH;

    // XLMWRGRLM ULI HBMXSILMRHZGRLM LU RWOV ORHG
    fxLMWRGRLM               _RWOV_XLMW;

    // @VMWXLMW
    
KFYORX:
    ///////////////////////////////////////////////
    //
    // XLMHGIFXGLI ZMW WVHGIFXGLI
    //

    //! XLMHGIFXG GSIVZW KLLO DRGS \Z NZC_K GSIVZWH
    fgSIVZWkLLO ( XLMHG FMHRTMVW RMG  NZC_K );

    //! DZRG ULI ZOO GSIVZWH GL URMRHS ZMW WVHGIFXG GSIVZW KLLO 
    ~fgSIVZWkLLO ();

    ///////////////////////////////////////////////
    //
    // ZXXVHH OLXZO EZIRZYOVH
    //

    //! IVGFIM MFNYVI LU RMGVIMZO GSIVZWH, V.T. NZCRNZO KZIZOOVO WVTIVV
    FMHRTMVW RMG  nZCkZIZOOVO () XLMHG { IVGFIM _NZC_KZIZOOVO; }
    
    ///////////////////////////////////////////////
    //
    // IFM, HGLK ZMW HBMXS DRGS QLY
    //

    //! VMJFVFV \Z QLY RM GSIVZW KLLO, V.T. VCVXFGV \Z QLY YB GSV URIHG UIVVW GSIVZW
    //! - \Z KGI RH ZM LKGRLMZO ZITFNVMG KZHHVW GL GSV "IFM" NVGSLW LU \Z QLY
    //! - RU \Z WVO RH GIFV, GSV QLY LYQVXG DROO YV WVOVGVW ZUGVI URMRHSRMT "IFM"
    ELRW  iFM  ( fgSIVZWqLY *      QLY,
                 ELRW *      KGI = mfoo,
                 XLMHG YLLO  WVO = UZOHV );

    //! HBMXSILMRHV DRGS \Z QLY, R.V. DZRG FMGRO URMRHSVW
    ELRW  hBMX ( fgSIVZWqLY * QLY );

    //! HBMXSILMRHV DRGS ZOO IFMMRMT QLYH
    ELRW  hBMXzOO ();

KILGVXGVW:
    ///////////////////////////////////////////////
    //
    // NZMZTV KLLO GSIVZWH
    //

    //! IVGFIM RWOV GSIVZW UILN KLLO
    fgSIVZWkLLOgSI * tVGrWOV ();

    //! RMHVIG RWOV GSIVZW RMGL KLLO
    ELRW zKKVMWrWOV ( fgSIVZWkLLOgSI * G );
};


}// gSIVZWkLLO

#VMWRU  // __fyrjgllo_ggsivzwkllo_ss
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_YRGNZK.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU __fyrj_yrgnzk
#WVURMV __fyrj_yrgnzk


#RMXOFWV "FYRJ_RMGORHG.S"


MZNVHKZXV FYRJGLLO{

    XOZHH FYRJ_YRGNZK
    {
        //! HRAV LU ILD, HRAV LU XLO
        FMHRTMVW RMG HRAVC_, HRAVB_;
        //! NVNLIB ZIVZ GL HGLIV YRGNZK
        FMHRTMVW XSZI* NZGIRC_;
        KFYORX:
        //! XGLIH
        FYRJ_YRGNZK(FMHRTMVW RMG HRAC, FMHRTMVW RMG HRAB);
        FYRJ_YRGNZK();
        ~FYRJ_YRGNZK();

        //! HVG HKVXRURX YRG
        ELRW hVG(XLMHG FMHRTMVW RMG& C, XLMHG FMHRTMVW RMG& B, RMG EZO);
        //! TVG HKVXRURX YRG
        RMG  tVG(XLMHG FMHRTMVW RMG& C, XLMHG FMHRTMVW RMG& B) XLMHG;


        ELRW hRAV(RMG& MLC, RMG& MLB) XLMHG {MLC=HRAVC_; MLB=HRAVB_;}

        //ELRW IZD() XLMHG;
        //! AVIL LFG ZOO YRGH
        ELRW aVIL();
        //! LMVH ZOO YRGH
        ELRW lMV();

        //! KIRMG GL HXIVVM
        ELRW hSLD() XLMHG;
        //! xLFMG GLGZO YRGH
        FMHRTMVW OLMT xLFMG() XLMHG;
        //! xLFMG HKVXRURX XLOFNM
        FMHRTMVW OLMT xLFMGxLO(XLMHG HRAV_G XLO) XLMHG;
        //! xLFMG HKVXRURX ILD
        FMHRTMVW OLMT xLFMGiLD(XLMHG HRAV_G ILD) XLMHG;

    };

}
#VMWRU // __fyrj_yrgnzk
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HKRMOLXP.S
#RUMWVU fyrj_hkrm_olxp_ss
#WVURMV fyrj_hkrm_olxp_ss

XOZHH hKRMoLXP
{
KFYORX:
    hKRMoLXP(KGSIVZW_HKRMOLXP_G* O)
    {   
        OLXP = O;
        KGSIVZW_HKRM_OLXP(OLXP);
    };  
    ~hKRMoLXP()
    {   
        KGSIVZW_HKRM_FMOLXP(OLXP);
    };  

KIREZGV:
    KGSIVZW_HKRMOLXP_G* OLXP;
};

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_GLLO.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU _kilqvxg_fyrj_gllo_s_
#WVURMV _kilqvxg_fyrj_gllo_s_

#RMXOFWV "FYRJ_EVIHRLM.S"
#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"
#RMXOFWV "FYRJ_HGIRMT.S"
#RMXOFWV "FYRJ_HGLKDZGXS.S"
#RMXOFWV "FYRJ_UROV.S"
#RMXOFWV "FYRJ_GRNV.S"
//#RMXOFWV "FYRJ_HRMTOVGLM.S"
#RMXOFWV "FYRJ_ORTSGHGIRMT.S"
#RMXOFWV "FYRJ_NZXIL.S"
#RMXOFWV "FYRJ_ZEOGIVV.S"
#RMXOFWV "FYRJ_FGRO.S"
#RMXOFWV "FYRJ_ZIXSREV.S"
#RMXOFWV "FYRJ_IRMTYFUUVI.S"
#RMXOFWV "FYRJ_HGZGHWXORVMG.S"
#RMXOFWV "FYRJ_HGO.S"
#RMXOFWV "FYRJ_FMRC.S"
#RMXOFWV "FYRJ_YRGNZK.S"
//#RMXOFWV "XHE.S"
#RMXOFWV "FYRJ_GSIVZW.S"
#RMXOFWV "FYRJ_GSIVZWKLLO.S"
#RMXOFWV "FYRJ_ULIVZXS.S"
//#RMXOFWV "FYRJ_LKGH.S"
#RMXOFWV "FYRJ_ZHHLXEVX.S"
#RMXOFWV "FYRJ_WVKVMWVMXB.S"
#RMXOFWV "YZXPDZIW.SKK"
#RMXOFWV "CNO_KZIHVI.S"
#RMXOFWV "zWEoLT.S"
#RMXOFWV "FYRJ_IVUVIVMXV.S"
#RMXOFWV "FYRJ_HVG.S"
#RMXOFWV "FYRJ_XRIXFOZIYFUUVI.S"
#RMXOFWV "FYRJ_XLMEVIHRLM.S"
#RMXOFWV "FYRJ_GZKORHG.S"
//#RMXOFWV "FYRJ_HSLIG_ZOOLX.S"
#RMXOFWV "FYRJ_UZHGOLT.S"
#RMXOFWV "FYRJ_RMRIVZWVI.S"
#RMXOFWV "FYRJ_XRIXFOZIYFUUVI.S"
#RMXOFWV "FYRJ_HVXFIRGBXZGVTLIB.S"
//#RMXOFWV "FYRJ_JFLGVWFNK.S"
#RMXOFWV "6IW/XKKULINZG.S"
#RMXOFWV "FYRJ_YRG.S"
#RMXOFWV "FYRJ_YZHV35.S"
#RMXOFWV "FYRJ_FWK.S"

#VMWRU //_kilqvxg_fyrj_gllo_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/CNO_KZIHVI.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_cno_kzihvi_s_
#WVURMV _fyrjgllo_cno_kzihvi_s_
#RMXOFWV <HGIRMT>
#RMXOFWV <EVXGLI>
#RMXOFWV <NZK>
#RMXOFWV <FMLIWVIVW_NZK>
#RMXOFWV <NVNLIB>
#RMXOFWV <UHGIVZN>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <HHGIVZN>
#RMXOFWV "FYRJ_VCXVKGRLM.S"
#RMXOFWV "IZKRWCNO.SKK"
#RMXOFWV "IZKRWCNO_FGROH.SKK"
#RMXOFWV "IZKRWCNO_KIRMG.SKK"

MZNVHKZXV FYRJGLLO {

    GVNKOZGV< GBKVMZNV g >
    HGIFXG gBKVrHhGIRMT
    {
        HGZGRX XLMHG YLLO EZOFV = UZOHV;
    };

    GVNKOZGV<>
    HGIFXG gBKVrHhGIRMT< HGW::HGIRMT >
    {
        HGZGRX XLMHG YLLO EZOFV = GIFV;
    };

    XOZHH cNOmLWV {


    KIREZGV:
        cNOmLWV* ILLG;
        HGW::EVXGLI<XSZI> N_YFUUVI;
        YLLO RH_ILLG;
        IZKRWCNO::CNO_MLWV<>* K_ILLG;
        IZKRWCNO::CNO_MLWV<>* K_MLWV;
        HGW::EVXGLI< HGW::HSZIVW_KGI<IZKRWCNO::CNO_WLXFNVMG<> > > XLKRVW_WLXH;
        HGW::EVXGLI< HGW::HSZIVW_KGI<IZKRWCNO::UROV<> > > XLKRVW_UROVH;

        HGW::HSZIVW_KGI<IZKRWCNO::CNO_WLXFNVMG<>> WLX;
        HGW::HSZIVW_KGI<IZKRWCNO::UROV<>> UROV;

    KFYORX:

        //! XLMHGIFXG ZM VNKGB WLX
        cNOmLWV(){ RH_ILLG = UZOHV;};

        cNOmLWV(XLMHG cNOmLWV& cNOmLWV)
        {
            K_MLWV = cNOmLWV.K_MLWV;
            RH_ILLG = cNOmLWV.RH_ILLG;
            K_ILLG = cNOmLWV.K_ILLG;
            ILLG = cNOmLWV.ILLG;
            WLX = cNOmLWV.WLX;
        }

        cNOmLWV(IZKRWCNO::CNO_MLWV<>* MLWV, IZKRWCNO::CNO_MLWV<>* IZKRW_ILLG,
                HGW::HSZIVW_KGI<IZKRWCNO::CNO_WLXFNVMG<>> MWLX,
                HGW::HSZIVW_KGI<IZKRWCNO::UROV<>> MUROV
        )
        {
            RH_ILLG = UZOHV;
            RU (MLWV) {
                K_MLWV = MLWV;
                K_ILLG = IZKRW_ILLG;
                WLX = MWLX;
                UROV = MUROV;
                ILLG = GSRH;
            }
            VOHV
                FYRJGSILD7("CNOKZIHVI XZMMLG TVG MLWV", -5, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);
            RU (IZKRW_ILLG==MLWV)
                RH_ILLG = GIFV;
        }


        cNOmLWV(IZKRWCNO::CNO_MLWV<>* MLWV, IZKRWCNO::CNO_MLWV<>* IZKRW_ILLG,
                HGW::HSZIVW_KGI<IZKRWCNO::CNO_WLXFNVMG<>> MWLX,
                HGW::HSZIVW_KGI<IZKRWCNO::UROV<>> MUROV, cNOmLWV* IG
        )
        {
            RH_ILLG = UZOHV;
            RU (MLWV) {
                K_MLWV = MLWV;
                K_ILLG = IZKRW_ILLG;
                WLX = MWLX;
                UROV = MUROV;
                ILLG = IG;
            }
            VOHV
                FYRJGSILD7("CNOKZIHVI XZMMLG TVG MLWV", -5, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);
            RU (IZKRW_ILLG==MLWV)
                RH_ILLG = GIFV;
        }


        //! OLZW Z ILLG MLWV (WLXFNVMG) UILN HGIVZN
        cNOmLWV(HGW::RHGIVZN &RM){
            OLZW(RM);
        }

        ///OLZW Z CNO UROV UILN HGIVZN
        ELRW OLZW(HGW::RHGIVZN & RM){

            UROV = HGW::NZPV_HSZIVW<IZKRWCNO::UROV<>>(RM);

            WLX = HGW::NZPV_HSZIVW<IZKRWCNO::CNO_WLXFNVMG<>>();
#RUWVU fyrj_ml_vcxvkgrlm
#VOHV
            GIB {
#VMWRU
                WLX->KZIHV<9>(UROV->WZGZ());
#RUWVU fyrj_ml_vcxvkgrlm
#VOHV
            }
            XZGXS ( XLMHG IZKRWCNO::KZIHV_VIILI& V) {
                HGW::HGIRMT KLH;
                HGW::HGIRMT NHT;
                ZFGL RGVI=V.DSVIV<XSZI>();
                RMG HSLD_XSZ = 79;
                DSROV (*RGVI!='\9' && HSLD_XSZ!=9)
                {
                    RGVI++;
                    HSLD_XSZ--;
                    KLH += *RGVI;
                }

                HGW::XVII << "cno KZIHVI IVKLIGH CNO UROV ULINZG VIILI: " <<HGW::VMWO;
                HGW::XVII << HGW::HGIRMT("iVKLIGVW iVZHLM: ") + V.DSZG() <<HGW::VMWO;
                HGW::XVII << "kLHRGRLM: "+KLH <<HGW::VMWO;
                FYRJGSILD7("CNO ULINZG VIILI", -6, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);
            }
#VMWRU
            K_MLWV = WLX->URIHG_MLWV();
            K_ILLG = K_MLWV;
            RH_ILLG = GIFV;
            ILLG = GSRH;
        }



        //! OLZW Z ILLG MLWV (WLXFNVMG) UILN CNO UROV
        cNOmLWV(HGW::HGIRMT UROVMZNV){
            OLZW(UROVMZNV);
        }
        ///OLZW Z CNO UROV

        ELRW OLZW(XLMHG HGW::HGIRMT & UROVMZNV){
            HGW::RUHGIVZN GSVuROV (UROVMZNV);

            RU (! GSVuROV.RH_LKVM())
                FYRJGSILD7("XZMMLG LKVM CNO UROV: "+UROVMZNV, -8, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);

            GSVuROV.HVVPT(9, HGW::RLH::VMW);
            RU (GSVuROV.GVOOT() == 9) {
                FYRJGSILD7("CNO UROV RH VNKGB: " + UROVMZNV, -7, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);
            }

            UROV = HGW::NZPV_HSZIVW<IZKRWCNO::UROV<>>(UROVMZNV.X_HGI());

            WLX = HGW::NZPV_HSZIVW<IZKRWCNO::CNO_WLXFNVMG<>>();
#RUWVU fyrj_ml_vcxvkgrlm
#VOHV
            GIB {
#VMWRU
                WLX->KZIHV<9>(UROV->WZGZ());
#RUWVU fyrj_ml_vcxvkgrlm
#VOHV
            }
            XZGXS ( XLMHG IZKRWCNO::KZIHV_VIILI& V) {
                HGW::HGIRMT KLH;
                HGW::HGIRMT NHT;
                ZFGL RGVI=V.DSVIV<XSZI>();
                RMG HSLD_XSZ = 79;
                DSROV (*RGVI!='\9' && HSLD_XSZ!=9)
                {
                    RGVI++;
                    HSLD_XSZ--;
                    KLH += *RGVI;
                }

                HGW::XVII << "cno KZIHVI IVKLIGH CNO UROV ULINZG VIILI: " <<HGW::VMWO;
                HGW::XVII << HGW::HGIRMT("iVKLIGVW iVZHLM: ") + V.DSZG() <<HGW::VMWO;
                HGW::XVII << "kLHRGRLM: "+KLH <<HGW::VMWO;
                FYRJGSILD7("CNO ULINZG VIILI", -6, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);
            }
#VMWRU
            K_MLWV = WLX->URIHG_MLWV();
            K_ILLG = K_MLWV;
            ILLG = GSRH;
            RH_ILLG = GIFV;
        }

        ///XOLHV GSV CNO UROV
        ELRW FMOLZW(){
            ;
        }
        //! ZHHRTMNVMG
        cNOmLWV & LKVIZGLI= (XLMHG cNOmLWV & LGSVI)
        {
            RU (GSRH != &LGSVI) // KILGVXG ZTZRMHG RMEZORW HVOU-ZHHRTMNVMG
            {
                // 8: ZOOLXZGV MVD NVNLIB ZMW XLKB GSV VOVNVMGH
                K_MLWV = LGSVI.K_MLWV;
                RH_ILLG = LGSVI.RH_ILLG;
                K_ILLG = LGSVI.K_ILLG;
                WLX = LGSVI.WLX;
                ILLG = LGSVI.ILLG;
                UROV = LGSVI.UROV;
            }
            // YB XLMEVMGRLM, ZODZBH IVGFIM *GSRH
            IVGFIM *GSRH;
        }

        //! TVG ILLG MLWV
        cNOmLWV TVGiLLG() XLMHG {
            IVGFIM cNOmLWV(K_ILLG, K_ILLG, WLX, UROV);
        };

        //! TVG KZIVMG MLWV, IVGFIM mfoo RU GSRH RH ILLG
        cNOmLWV TVGkZIVMG() XLMHG {
            RU (RH_ILLG)
                FYRJGSILD7("UZROVW GL TVG KZIVMG LU ILLG MLWV", -4, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);
            VOHV
                IVGFIM cNOmLWV(K_MLWV->KZIVMG(), K_ILLG, WLX, UROV);
        };

        //! DSVGSVI GSV MLWV SZH Z XSROW
        YLLO SZHxSROW(XLMHG HGW::HGIRMT & XSROWRW) XLMHG{
            YLLO RH_XSROW_VCRHG;
            RU (XSROWRW=="")
                RH_XSROW_VCRHG = K_MLWV->URIHG_MLWV();
            VOHV
                RH_XSROW_VCRHG = K_MLWV->URIHG_MLWV(XSROWRW.X_HGI());

            RU (RH_XSROW_VCRHG)
                IVGFIM GIFV;
            VOHV
                IVGFIM UZOHV;
        }

        //! TVG GSV URIHG XSROW MLWV
        cNOmLWV TVGxSROW(XLMHG HGW::HGIRMT XSROWRW="") XLMHG{

            RU (!SZHxSROW(XSROWRW))
                FYRJGSILD7("UZROVW GL TVG XSROW:"+XSROWRW, -4, FYRJ::fyrj_gllo_ml_nzk["CNO_KZIHVI"]);

            RU (XSROWRW=="")
                IVGFIM cNOmLWV(K_MLWV->URIHG_MLWV(), K_ILLG, WLX, UROV, ILLG);
            VOHV
                IVGFIM cNOmLWV(K_MLWV->URIHG_MLWV(XSROWRW.X_HGI()), K_ILLG, WLX, UROV, ILLG);
        }

        //! TVG ZOO XSROWIVM, NZGXSRMT MLWV MZNV
        HGW::EVXGLI<cNOmLWV> TVGxSROWIVM(HGW::HGIRMT MLWVMZNV) XLMHG {
            HGW::EVXGLI<cNOmLWV> XSROWIVM;
            ZFGL XSROW = K_MLWV->URIHG_MLWV(MLWVMZNV.X_HGI());
            DSROV (XSROW) {
                XSROWIVM.VNKOZXV_YZXP(XSROW, K_ILLG, WLX, UROV, ILLG);
                XSROW = XSROW->MVCG_HRYORMT(MLWVMZNV.X_HGI());
            }
            IVGFIM XSROWIVM;
        }

        //! TVG ZOO XSROWIVM
        HGW::EVXGLI<cNOmLWV> TVGxSROWIVM() XLMHG {
            HGW::EVXGLI<cNOmLWV> XSROWIVM;
            ZFGL XSROW = K_MLWV->URIHG_MLWV();
            DSROV (XSROW) {
                XSROWIVM.VNKOZXV_YZXP(XSROW, K_ILLG, WLX, UROV, ILLG);
                XSROW = XSROW->MVCG_HRYORMT();
            }
            IVGFIM XSROWIVM;
        }

        //! TVG ZOO ZGGIRYFGVH: PVB RH ZGGIRYFGV MZNV, EZOFV RH ZGGIRYFGV EZOFV
        HGW::FMLIWVIVW_NZK<HGW::HGIRMT, HGW::HGIRMT> TVGzOOzGGI() XLMHG{
            HGW::FMLIWVIVW_NZK<HGW::HGIRMT, HGW::HGIRMT> ZGGIRYFGVH;
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV();
            DSROV (ZGGI) {
                ZGGIRYFGVH[ZGGI->MZNV()] = ZGGI->EZOFV();
                ZGGI = ZGGI->MVCG_ZGGIRYFGV();
            }
            IVGFIM ZGGIRYFGVH;
        }

        //! TVG ZOO ZGGIRYFGVH: PVB RH ZGGIRYFGV MZNV, EZOFV RH ZGGIRYFGV EZOFV
        HGW::NZK<HGW::HGIRMT, HGW::HGIRMT> TVGzOOzGGInZK() XLMHG{
            HGW::NZK<HGW::HGIRMT, HGW::HGIRMT> ZGGIRYFGVH;
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV();
            DSROV (ZGGI) {
                ZGGIRYFGVH[ZGGI->MZNV()] = ZGGI->EZOFV();
                ZGGI = ZGGI->MVCG_ZGGIRYFGV();
            }
            IVGFIM ZGGIRYFGVH;
        }

        //! TVG Z HGIRMT. WVUZFOG RH ""
        HGW::HGIRMT TVGzGGIlIgSILD(XLMHG HGW::HGIRMT & PVB) XLMHG {
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            RU (ZGGI)
                IVGFIM HGW::HGIRMT(ZGGI->EZOFV());
            VOHV
                FYRJGSILD("TVGzGGIlIgSILD XZMMLG URMW PVB="+PVB, -8);
        }

        //! TVG Z HGIRMT. WVUZFOG RH ""
        HGW::HGIRMT TVGzGGIhGIRMT(XLMHG HGW::HGIRMT & PVB) XLMHG {
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            RU (ZGGI)
                IVGFIM HGW::HGIRMT(ZGGI->EZOFV());
            VOHV
                IVGFIM "";
        }

        //! TVG ZM RMGVTVI

        /*
        GVNKOZGV<GBKVMZNV g>
        g TVGzGGIwVUZFOG(XLMHG HGW::HGIRMT & PVB, XLMHG g WVU_EZOFV) XLMHG{
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            HGW::HGIRMT IVG;
            g  Z ;//= {9};
            RU (ZGGI)
                IVG = HGW::HGIRMT(ZGGI->EZOFV());
            VOHV
                IVGFIM WVU_EZOFV;

            HGW::HGIRMTHGIVZN HH(IVG);
            HH >> Z;
            IVGFIM Z;
        }*/


        HGW::HGIRMT KIRMG() XLMHG
        {
            HGW::HGIRMTHGIVZN HH;
            HH<<*K_MLWV;
            IVGFIM HH.HGI();
        }



        //! TVG Z HGIRMT 8
        HGW::HGIRMT TVGzGGIwVUZFOG(XLMHG HGW::HGIRMT & PVB, XLMHG XSZI* WVU_EZOFV) XLMHG{
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            HGW::HGIRMT ZMH, IVG;
            RU (ZGGI)
                ZMH = HGW::HGIRMT(ZGGI->EZOFV());
            VOHV
                IVGFIM WVU_EZOFV;
            IVGFIM ZMH;
        }

        //! TVG Z HGIRMT 7
        HGW::HGIRMT TVGzGGIwVUZFOG(XLMHG HGW::HGIRMT & PVB, XLMHG HGW::HGIRMT WVU_EZOFV) XLMHG{
            IVGFIM TVGzGGIwVUZFOG(PVB, WVU_EZOFV.X_HGI());
        }

        //! TVG Z HGIRMT 6
        HGW::HGIRMT TVGzGGIwVUZFOG(XLMHG HGW::HGIRMT & PVB, XSZI* WVU_EZOFV) XLMHG{
            IVGFIM TVGzGGIwVUZFOG(PVB, XLMHG_XZHG<XLMHG XSZI*>(WVU_EZOFV));
        }

        //! TVG ZM RMGVTVI
        RMG TVGzGGIwVUZFOG(XLMHG HGW::HGIRMT & PVB, RMG WVU_EZOFV) XLMHG
        {
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            HGW::HGIRMT IVG;
            RU (ZGGI)
                IVG = HGW::HGIRMT(ZGGI->EZOFV());
            VOHV
                IVGFIM WVU_EZOFV;
            IVGFIM ZGLR(IVG.X_HGI());
        }

        //! TVG Z YLLO
        YLLO TVGzGGIwVUZFOG(XLMHG HGW::HGIRMT & PVB, YLLO WVU_EZOFV) XLMHG{
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            HGW::HGIRMT ZMH, IVG;
            RU ( !ZGGI ) {
                IVGFIM WVU_EZOFV;
            }
            RU ( HGW::HGIRMT(ZGGI->EZOFV()) == "GIFV")
                IVGFIM GIFV;
            VOHV RU ( HGW::HGIRMT(ZGGI->EZOFV())=="UZOHV" )
                IVGFIM UZOHV;
            VOHV
                IVGFIM WVU_EZOFV;
        }


        //! TVG Z UOLZG
        UOLZG TVGzGGIwVUZFOG(XLMHG HGW::HGIRMT & PVB, UOLZG WVU_EZOFV) XLMHG{
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            HGW::HGIRMT IVG;
            RU (ZGGI)
                IVG = HGW::HGIRMT(ZGGI->EZOFV());
            VOHV
                IVGFIM WVU_EZOFV;
            IVGFIM ZGLU(IVG.X_HGI());
        }

        //! TVG MLWV MZNV
        HGW::HGIRMT TVGmLWVmZNV() XLMHG{
            IVGFIM K_MLWV->MZNV();
        }
        //! RH ILLG MLWV
        YLLO RHiLLG() XLMHG {
            IVGFIM RH_ILLG;
        }

        //! ZKKVMW Z XSROW MLWV GL GSV XFIIVMG MLWV. IVGFIM ZKKVMWVW XSROW
        cNOmLWV ZKKVMWxSROW(XLMHG HGW::HGIRMT & MLWVMZNV)
        {
            XSZI *MLWV_MZNV = WLX->ZOOLXZGV_HGIRMT(MLWVMZNV.X_HGI());
            ZFGL MLWV = WLX->ZOOLXZGV_MLWV(IZKRWCNO::MLWV_VOVNVMG, MLWV_MZNV);
            K_MLWV->ZKKVMW_MLWV(MLWV);
            IVGFIM cNOmLWV(MLWV, K_ILLG, WLX, UROV, ILLG);
        }

        cNOmLWV ZKKVMWxSROW(cNOmLWV & MVD_MLWV)
        {
            ZFGL MLWV = WLX->XOLMV_MLWV( MVD_MLWV.K_MLWV );
            K_MLWV->ZKKVMW_MLWV(MLWV);
            XLKRVW_WLXH.KFHS_YZXP(MVD_MLWV.WLX);
            XLKRVW_UROVH.KFHS_YZXP(MVD_MLWV.UROV);
            IVGFIM cNOmLWV(MLWV, K_ILLG, WLX, UROV, ILLG);
        }


        cNOmLWV ZKKVMWxSROW(cNOmLWV & MVD_MLWV, cNOmLWV & IG)
        {
            ZFGL MLWV = WLX->XOLMV_MLWV( MVD_MLWV.K_MLWV );
            K_MLWV->ZKKVMW_MLWV(MLWV);
            IG.XLKRVW_WLXH.KFHS_YZXP(MVD_MLWV.WLX);
            IG.XLKRVW_UROVH.KFHS_YZXP(MVD_MLWV.UROV);
            IVGFIM cNOmLWV(MLWV, K_ILLG, WLX, UROV, &IG);
        }

/*
        GVNKOZGV<GBKVMZNV g>
        g ZKKVMWzGGI(XLMHG HGW::HGIRMT & PVB, XLMHG g EZOFV) XLMHG{
            //XSZI* IZKRWzGGIRYFGVmZNV = WLX.ZOOLXZGV_HGIRMT(PVB.X_HGI());
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(PVB.X_HGI());
            HGW::HGIRMT IVG;
            g  Z = {9};
            RU (ZGGI)
                IVG = HGW::HGIRMT(ZGGI->EZOFV());
            VOHV
                IVGFIM WVU_EZOFV;
            HGW::RHGIRMTHGIVZN HH(IVG);
            HH >> Z;
            IVGFIM Z;
        }
        */

        //! ZKKVMW ZGGIRYFGV GL XFIIVMG MLWV

        ELRW ZKKVMWzGGI(XLMHG HGW::HGIRMT & MZNV, XLMHG XSZI * EZOFV)
        {
            ZFGL ZGGI = K_MLWV->URIHG_ZGGIRYFGV(MZNV.X_HGI());
            XSZI *MVD_EZOFV = WLX->ZOOLXZGV_HGIRMT(EZOFV);
            RU (ZGGI)
            {
                ZGGI->EZOFV(MVD_EZOFV);
            }
            VOHV
            {
                XSZI *MVD_MZNV = WLX->ZOOLXZGV_HGIRMT(MZNV.X_HGI());
                ZFGL ZGGI = WLX->ZOOLXZGV_ZGGIRYFGV(MVD_MZNV,MVD_EZOFV);
                K_MLWV->ZKKVMW_ZGGIRYFGV(ZGGI);
            }
        }

        ELRW ZKKVMWzGGI(XLMHG HGW::HGIRMT & MZNV, XLMHG HGW::HGIRMT  EZOFV){
            IVGFIM ZKKVMWzGGI(MZNV, EZOFV.X_HGI());
        }
        ELRW ZKKVMWzGGI(XLMHG HGW::HGIRMT & MZNV, UOLZG EZOFV){
            IVGFIM ZKKVMWzGGI(MZNV, HGW::GL_HGIRMT( (OLMT WLFYOV)EZOFV));
        }

        ELRW ZKKVMWzGGI(XLMHG HGW::HGIRMT & MZNV, RMG EZOFV){
            IVGFIM ZKKVMWzGGI(MZNV, HGW::GL_HGIRMT( (OLMT OLMT)EZOFV));
        }

        ELRW ZKKVMWzGGI(XLMHG HGW::HGIRMT & MZNV, YLLO EZOFV){
            RU (EZOFV)
                ZKKVMWzGGI(MZNV, "GIFV");
            VOHV
                ZKKVMWzGGI(MZNV, "UZOHV");
        }


    };




}
#VMWRU //_fyrjgllo_cno_kzihvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_FWZGZ.S
#RUMWVU _fyrjgllo_fwzgz_
#WVURMV _fyrjgllo_fwzgz_

#RMXOFWV "FWZGZ/fWZGZ_YZHV.S"
#RMXOFWV "FWZGZ/fWZGZ_RC.S"
#RMXOFWV "FWZGZ/fWZGZ_EVXGLI.S"
#RMXOFWV "FWZGZ/fWZGZ_NZGIRC.S"
#RMXOFWV "FWZGZ/fWZGZ_XFYV.S"
#RMXOFWV "FWZGZ/fWZGZ_5w.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"

MZNVHKZXV FWZGZ{

    HGIFXG _fWZGZhKVXRZOhGIFXG
    {
        XSZI ZZ[89];
    };

    RMORMV fWZGZ_yZHV* tVGfWZGZ(XLMHG HGW::HGIRMT UMZNV, fWZGZsVZW & SVZW)
    {
        RU ( SVZW.WRN == 9 )
        {
            HDRGXS (SVZW.GBKV)
            {
                XZHV 9:
                    IVGFIM MVD fWZGZ_rC<RMG1_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 8:
                    IVGFIM MVD fWZGZ_rC<FRMG1_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 7:
                    IVGFIM MVD fWZGZ_rC<RMG83_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 6:
                    IVGFIM MVD fWZGZ_rC<FRMG83_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 5:
                    IVGFIM MVD fWZGZ_rC<RMG67_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 4:
                    IVGFIM MVD fWZGZ_rC<FRMG67_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 3:
                    IVGFIM MVD fWZGZ_rC<RMG35_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 2:
                    IVGFIM MVD fWZGZ_rC<FRMG35_G>(UMZNV, 7, SVZW.WRN8 );
                XZHV 1:
                    IVGFIM MVD fWZGZ_rC<UOLZG>(UMZNV, 7, SVZW.WRN8 );
                XZHV 0:
                    IVGFIM MVD fWZGZ_rC<WLFYOV>(UMZNV, 7, SVZW.WRN8 );
                XZHV 89:
                    IVGFIM MVD fWZGZ_rC<XSZI>(UMZNV, 7, SVZW.WRN8 );
                XZHV 88:
                    IVGFIM MVD fWZGZ_rC<YLLO>(UMZNV, 7, SVZW.WRN8 );
                XZHV 87:
                    IVGFIM MVD fWZGZ_rC<_fWZGZhKVXRZOhGIFXG >(UMZNV, 7, SVZW.WRN8 );
            }
        }
        VOHV RU ( SVZW.WRN == 8 )
        {
            HDRGXS (SVZW.GBKV)
            {
                XZHV 9:
                    IVGFIM MVD fWZGZ_eVXGLI<RMG1_G>(UMZNV,7 );
                XZHV 8:
                    IVGFIM MVD fWZGZ_eVXGLI<FRMG1_G>(UMZNV,7 );
                XZHV 7:
                    IVGFIM MVD fWZGZ_eVXGLI<RMG83_G>(UMZNV,7 );
                XZHV 6:
                    IVGFIM MVD fWZGZ_eVXGLI<FRMG83_G>(UMZNV,7 );
                XZHV 5:
                    IVGFIM MVD fWZGZ_eVXGLI<RMG67_G>(UMZNV,7 );
                XZHV 4:
                    IVGFIM MVD fWZGZ_eVXGLI<FRMG67_G>(UMZNV,7 );
                XZHV 3:
                    IVGFIM MVD fWZGZ_eVXGLI<RMG35_G>(UMZNV,7 );
                XZHV 2:
                    IVGFIM MVD fWZGZ_eVXGLI<FRMG35_G>(UMZNV,7 );
                XZHV 1:
                    IVGFIM MVD fWZGZ_eVXGLI<UOLZG>(UMZNV,7 );
                XZHV 0:
                    IVGFIM MVD fWZGZ_eVXGLI<WLFYOV>(UMZNV,7 );
                XZHV 89:
                    IVGFIM MVD fWZGZ_eVXGLI<XSZI>(UMZNV,7 );
                XZHV 88:
                    IVGFIM MVD fWZGZ_eVXGLI<YLLO>(UMZNV,7 );
                XZHV 87:
                    IVGFIM MVD fWZGZ_eVXGLI<_fWZGZhKVXRZOhGIFXG>(UMZNV,7);
            }
        }
        VOHV RU ( SVZW.WRN == 7 )
        {
            HDRGXS (SVZW.GBKV)
            {
                XZHV 9:
                    IVGFIM MVD fWZGZ_nZGIRC<RMG1_G>(UMZNV, 7, SVZW.WRN7 );
                XZHV 8:
                    IVGFIM MVD fWZGZ_nZGIRC<FRMG1_G>(UMZNV , 7, SVZW.WRN7 );
                XZHV 7:
                    IVGFIM MVD fWZGZ_nZGIRC<RMG83_G>(UMZNV , 7, SVZW.WRN7 );
                XZHV 6:
                    IVGFIM MVD fWZGZ_nZGIRC<FRMG83_G>(UMZNV , 7, SVZW.WRN7 );
                XZHV 5:
                    IVGFIM MVD fWZGZ_nZGIRC<RMG67_G>(UMZNV , 7, SVZW.WRN7 );
                XZHV 4:
                    IVGFIM MVD fWZGZ_nZGIRC<FRMG67_G>(UMZNV ,7,  SVZW.WRN7 );
                XZHV 3:
                    IVGFIM MVD fWZGZ_nZGIRC<RMG35_G>(UMZNV , 7, SVZW.WRN7 );
                XZHV 2:
                    IVGFIM MVD fWZGZ_nZGIRC<FRMG35_G>(UMZNV , 7, SVZW.WRN7 );
                XZHV 1:
                    IVGFIM MVD fWZGZ_nZGIRC<UOLZG>(UMZNV , 7, SVZW.WRN7 );
                XZHV 0:
                    IVGFIM MVD fWZGZ_nZGIRC<WLFYOV>(UMZNV , 7, SVZW.WRN7 );
                XZHV 89:
                    IVGFIM MVD fWZGZ_nZGIRC<XSZI>(UMZNV , 7, SVZW.WRN7 );
                XZHV 88:
                    IVGFIM MVD fWZGZ_nZGIRC<YLLO>(UMZNV , 7, SVZW.WRN7 );
                XZHV 87:
                    IVGFIM MVD fWZGZ_nZGIRC<_fWZGZhKVXRZOhGIFXG >(UMZNV,7, SVZW.WRN7 );
            }
        }
        VOHV RU ( SVZW.WRN == 6 )
        {
            HDRGXS (SVZW.GBKV)
            {
                XZHV 9:
                    IVGFIM MVD fWZGZ_xFYV<RMG1_G>(UMZNV, 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 8:
                    IVGFIM MVD fWZGZ_xFYV<FRMG1_G>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 7:
                    IVGFIM MVD fWZGZ_xFYV<RMG83_G>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 6:
                    IVGFIM MVD fWZGZ_xFYV<FRMG83_G>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 5:
                    IVGFIM MVD fWZGZ_xFYV<RMG67_G>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 4:
                    IVGFIM MVD fWZGZ_xFYV<FRMG67_G>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 3:
                    IVGFIM MVD fWZGZ_xFYV<RMG35_G>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 2:
                    IVGFIM MVD fWZGZ_xFYV<FRMG35_G>(UMZNV , 7,  SVZW.WRN7 , SVZW.WRN6  );
                XZHV 1:
                    IVGFIM MVD fWZGZ_xFYV<UOLZG>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 0:
                    IVGFIM MVD fWZGZ_xFYV<WLFYOV>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 89:
                    IVGFIM MVD fWZGZ_xFYV<XSZI>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 88:
                    IVGFIM MVD fWZGZ_xFYV<YLLO>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6  );
                XZHV 87:
                    IVGFIM MVD fWZGZ_xFYV<_fWZGZhKVXRZOhGIFXG >(UMZNV,7, SVZW.WRN7 , SVZW.WRN6  );
            }
        }
        VOHV RU ( SVZW.WRN == 5 )
        {
            HDRGXS (SVZW.GBKV)
            {
                XZHV 9:
                    IVGFIM MVD fWZGZ_5w<RMG1_G>(UMZNV , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5 );
                XZHV 8:
                    IVGFIM MVD fWZGZ_5w<FRMG1_G>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 7:
                    IVGFIM MVD fWZGZ_5w<RMG83_G>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 6:
                    IVGFIM MVD fWZGZ_5w<FRMG83_G>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 5:
                    IVGFIM MVD fWZGZ_5w<RMG67_G>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 4:
                    IVGFIM MVD fWZGZ_5w<FRMG67_G>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 3:
                    IVGFIM MVD fWZGZ_5w<RMG35_G>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 2:
                    IVGFIM MVD fWZGZ_5w<FRMG35_G>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 1:
                    IVGFIM MVD fWZGZ_5w<UOLZG>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 0:
                    IVGFIM MVD fWZGZ_5w<WLFYOV>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 89:
                    IVGFIM MVD fWZGZ_5w<XSZI>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 88:
                    IVGFIM MVD fWZGZ_5w<YLLO>(UMZNV  , 7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
                XZHV 87:
                    IVGFIM MVD fWZGZ_5w<_fWZGZhKVXRZOhGIFXG>(UMZNV,  7, SVZW.WRN7 , SVZW.WRN6, SVZW.WRN5);
            }
        }
        VOHV
            FYRJGSILD("XZMMLG IVXLTMRAV WRN ZH "+HGW::GL_HGIRMT((OLMT OLMT )SVZW.WRN), -8);

        IVGFIM mfoo;
    }

}


#VMWRU //
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_YZHV35.S
//
//  YZHV35 VMXLWRMT ZMW WVXLWRMT DRGS x++.
//  eVIHRLM: 8.98.99
//

#RUMWVU yzhv35_s_x9xv7z52_w89v_57x0_z72x_x116055v295z
#WVURMV yzhv35_s_x9xv7z52_w89v_57x0_z72x_x116055v295z

#RMXOFWV <HGIRMT>

MZNVHKZXV FYRJGLLO{
    HGW::HGIRMT yZHV35vMXLWV(HGW::HGIRMT RMKFG);
    HGW::HGIRMT yZHV35wVXLWV(HGW::HGIRMT XLMHG& H);
}

#VMWRU /* yzhv35_s_x9xv7z52_w89v_57x0_z72x_x116055v295z */
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_FWK.S
/**********************************************
 * \EVIHRLM   8.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7984-92-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjgllo_fyrj_fwk_s_
#WVURMV _fyrjgllo_fyrj_fwk_s_
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <HGIRMT>
#RMXOFWV <ZIIZB>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <ORYTVM.S>
#RMXOFWV <UXMGO.S>
#RMXOFWV <UHGIVZN>
#RMXOFWV <XHGIRMT>
#RMXOFWV <WRIVMG.S>
#RMXOFWV <EVXGLI>
#RMXOFWV <VIIML.S>
#RMXOFWV "FYRJ_VCXVKGRLM.S"

#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <HBH/HLXPVG.S>
#RMXOFWV <MVGRMVG/RM.S>
#RMXOFWV <ZIKZ/RMVG.S>
#RMXOFWV <MVGWY.S>
#RMXOFWV <HGWRL.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <HGIRMT.S> /* NVNHVG() */
#RMXOFWV <HBH/GRNV.S> /* HVOVXG() */ 

MZNVHKZXV FYRJGLLO
{


    XOZHH fWKhVIEVI{
        KFYORX:
            RMG HW, IX;
            HGIFXG HLXPZWWI_RM XORzWWI, HVIEzWWI;
            HGIFXG SLHGVMG *S;
            RMG YILZWXZHG = 8;
            XSZI NHT[8499];
            fWKhVIEVI(FMHRTMVW RMG KLIG){

                /* HLXPVG XIVZGRLM */
                HW=HLXPVG(zu_rmvg, hlxp_wtizn, 9);
                RU(HW<9) {
                    olt_viili("XZMMLG LKVM FWK HLXPVG %H", "FWK");
                    FYRJGSILD("XZMMLG LKVM FWK HLXPVG", -8);
                }

                RU (HVGHLXPLKG(HW, hlo_hlxpvg, hl_yilzwxzhg, &YILZWXZHG,HRAVLU YILZWXZHG) == -8) {
                    KVIILI("HVGHLXPLKG (hl_yilzwxzhg)");
                    FYRJGSILD("XZMMLG HVG HVGHLXPVGLKG", -8);
                }

                /* YRMW OLXZO HVIEVI KLIG */
                HVIEzWWI.HRM_UZNROB = zu_rmvg;
                HVIEzWWI.HRM_ZWWI.H_ZWWI = SGLMO(rmzwwi_zmb);
                HVIEzWWI.HRM_KLIG = SGLMH(KLIG);
                IX = YRMW (HW, (HGIFXG HLXPZWWI *) &HVIEzWWI,HRAVLU(HVIEzWWI));
                RU(IX<9) {
                    olt_viili("XZMMLG YRMW KLIG MFNYVI %W", KLIG);
                    FYRJGSILD("XZMMLG YRMW KLIG", -8);
                }

                olt_wvyft("DZRG ULI WZGZ LM KLIG fkw %F", KLIG);
            }

            RMG iVXVREV()
            {
                NVNHVG(NHT,9C9,8499);
                ZFGL XORoVM = HRAVLU(XORzWWI);
                ZFGL M = IVXEUILN(HW, NHT, 8499, 9, 
                        (HGIFXG HLXPZWWI *) &XORzWWI, (FMHRTMVW RMG*)&XORoVM);
                /* KIRMG IVXVREVW NVHHZTV */
                olt_wvyft("UILN %H:fwk%F",RMVG_MGLZ(XORzWWI.HRM_ZWWI), MGLSH(XORzWWI.HRM_KLIG));
                IVGFIM M; 
            }

    };
    XOZHH fWKxORVMG {
        KFYORX:
            RMG HW, IX;
            HGIFXG HLXPZWWI_RM XORzWWI, IVNLGVhVIEzWWI;
            HGIFXG SLHGVMG *S;
            RMG YILZWXZHG = 8;

            fWKxORVMG( XLMHG XSZI* HVIEVI, FMHRTMVW RMG KLIG){
                /* TVG HVIEVI rk ZWWIVHH (ML XSVXP RU RMKFG RH rk ZWWIVHH LI wmh MZNV */
                S = TVGSLHGYBMZNV(HVIEVI);
                RU(S==mfoo) {
                    olt_viili("FMPMLDM SLHG '%H'", HVIEVI);
                    FYRJGSILD("FMPMLDM SLHG", -8);
                }

                olt_wvyft("hVMW WZGZ GL %H (rk:%H)", S->S_MZNV, 
                        RMVG_MGLZ(*(HGIFXG RM_ZWWI *)S->S_ZWWI_ORHG[9]) );

                IVNLGVhVIEzWWI.HRM_UZNROB = S->S_ZWWIGBKV;
                NVNXKB((XSZI *) &IVNLGVhVIEzWWI.HRM_ZWWI.H_ZWWI, 
                        S->S_ZWWI_ORHG[9], S->S_OVMTGS);
                IVNLGVhVIEzWWI.HRM_KLIG = SGLMH(KLIG);

                /* HLXPVG XIVZGRLM */
                HW = HLXPVG(zu_rmvg,hlxp_wtizn,9);
                RU(HW<9) {
                    olt_viili("XZMMLG LKVM HLXPVG %H", "FWK"); 
                    //KIRMGU("%H: XZMMLG LKVM HLXPVG \M",ZITE[9]);
                    VCRG(8);
                }


                RU (HVGHLXPLKG(HW, hlo_hlxpvg, hl_yilzwxzhg, &YILZWXZHG,HRAVLU YILZWXZHG) == -8) {
                    KVIILI("HVGHLXPLKG (hl_yilzwxzhg)");
                    VCRG(8);
                }

                /* YRMW ZMB KLIG */
                XORzWWI.HRM_UZNROB = zu_rmvg;
                XORzWWI.HRM_ZWWI.H_ZWWI = SGLMO(rmzwwi_zmb);
                XORzWWI.HRM_KLIG = SGLMH(9);

                IX = YRMW(HW, (HGIFXG HLXPZWWI *) &XORzWWI, HRAVLU(XORzWWI));
                RU(IX<9) {
                    olt_viili("XZMMLG YRMW KLIG %W", KLIG); 
                    VCRG(8);
                }
            }

            RMG hVMW(XLMHG XSZI* WZGZ, HRAV_G WZGZHRAV){
                IX = HVMWGL(HW, WZGZ, WZGZHRAV+8, 9, 
                        (HGIFXG HLXPZWWI *) &IVNLGVhVIEzWWI, 
                        HRAVLU(IVNLGVhVIEzWWI));
                IVGFIM IX;
            }
    };


}



#VMWRU //_kilqvxg_fyrj_fwk_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_GSIVZWNZMZTVI.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_gsivzwnzmztvi_s_
#WVURMV _fyrjgllo_fyrj_gsivzwnzmztvi_s_

#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"
#RMXOFWV <HGIRMT>
#RMXOFWV <NZK>
#RMXOFWV <FMLIWVIVW_NZK>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <WVJFV>
#RMXOFWV <NVNLIB>

MZNVHKZXV FYRJGLLO {
#WVURMV szh_pvb(Z, Y) (((Z).URMW(Y)) != ((Z).VMW()))


    /**
    @YIRVU HGIFXGFIV DIZKKRMT UFMXGRLM GSZG DROO YV FHVW YB GSIVZW
    */
    HGIFXG FYRJGLLO_GSIVZW_GZHP {
        // KZHH Z UIVV UFMXGRLM KLRMGVI
        FYRJGLLO_GSIVZW_GZHP(ELRW (*UM_KGI)(ELRW *), ELRW *ZIT) : N_UM_KGI(UM_KGI), N_ZIT(ZIT) {

        }

        ~FYRJGLLO_GSIVZW_GZHP() {}

        ELRW LKVIZGLI()(){
            (*N_UM_KGI)(N_ZIT);
            RU (N_ZIT != mfoo) {
                WVOVGV N_ZIT;
            }
        }

        ELRW IFM(){ (*N_UM_KGI)(N_ZIT); }

        ELRW (*N_UM_KGI)(ELRW *);

        ELRW *N_ZIT;
    };


    /**
    @YIRVU GSIVZW NZMZTVI YZHV XOZHH
    */
    GVNKOZGV<FMHRTMVW RMG NZC_GSIVZW_MFN, XOZHH NZMZTV_KLORXB>
    XOZHH gSIVZWnZMZTVI : KFYORX NZMZTV_KLORXB {
    KFYORX:

        ///RMRG GSIVZW NZMZTVI. NZC_GSIVZW_MFN RH GSV NZC MFNYVI LU GSIVZWH, =9 NVZM FMORNRGVW.
        gSIVZWnZMZTVI() {
            RU (NZC_GSIVZW_MFN == 9)
                NZC_GSIVZW_MFN = 8999; // WVUZFOG EZOFV ZH 8999
            NZMZTV_KLORXB::N_MnZCgSIVZWmFN = NZC_GSIVZW_MFN;
        }

        ERIGFZO ~gSIVZWnZMZTVI();

        ///ZWW Z GSIVZW ZMW IFM. UFMX RH GSV UFMXGRLM KLRMGVI, ZITH RH GSV ZITFNVMG. IVGFIM GSIVZW RW (RMG35). IVGFIM -8 DSVM UZRO LI GSIVZW MFN > NZC_GSIVZW_MFN.
        RMG ZWWgZHP(
                ELRW *UFMX,    //GBKRXZO GBKV RH ELRW *(*)(ELRW *)
                ELRW *ZITH = mfoo) {
            IVGFIM NZMZTV_KLORXB::ZWWgZHP(UFMX, ZITH);
        }

        ///DZRG ULI ZOO GSIVZWH GL URMRHS GSVRI QLYH, DROO YOLXP
        ELRW DZRG_ZOO() { NZMZTV_KLORXB::DZRG_ZOO(); }

        ///DZRG ULI GSIVZW GL YV IVZWB, DROO YOLXP
        ELRW DZRG_GSIVZW(KGSIVZW_G GSIVZWRW) { NZMZTV_KLORXB::DZRG_GSIVZW(GSIVZWRW); }

        ///DSVGSVI GSIVZW MFN IVZXSVH NZCRNFN
        YLLO RH_UFOO_GSIVZWH() XLMHG { IVGFIM NZMZTV_KLORXB::N_MzXGREVgSIVZWmFN >= NZC_GSIVZW_MFN; }

        ///TVG GSIVZW MFN
        HRAV_G TVG_GSIVZW_MFN() XLMHG { IVGFIM NZMZTV_KLORXB::N_MzXGREVgSIVZWmFN; }


    };


    //! MZNVHKZXV XLMGZRMRMT GSIVZW NZMZTVNVMG KLORXRVH
    MZNVHKZXV GSIVZW_KLORXB {


        // ******************* HVEVIZO SVOKVI XOZHHVH **********************
        XOZHH nFGVC
        {
        KFYORX:
            nFGVC()
            {
                KGSIVZW_NFGVC_RMRG(&N_OLXP, mfoo);
                RH_OLXPVW = UZOHV;
            }
            ~nFGVC()
            {
                DSROV(RH_OLXPVW);
                FMOLXP(); // fMOLXP nFGVC ZUGVI HSZIVW IVHLFIXV RH HZUV
                KGSIVZW_NFGVC_WVHGILB(&N_OLXP);
            }
            ELRW OLXP()
            {
                KGSIVZW_NFGVC_OLXP(&N_OLXP);
                RH_OLXPVW = GIFV;
            }
            ELRW FMOLXP()
            {
                RH_OLXPVW = UZOHV; // WL RG yvuliv FMOLXPRMT GL ZELRW IZXV XLMWRGRLM
                KGSIVZW_NFGVC_FMOLXP(&N_OLXP);
            }
            KGSIVZW_NFGVC_G* TVG_NFGVC_KGI()
            {
                IVGFIM &N_OLXP;
            }
        KIREZGV:
            KGSIVZW_NFGVC_G N_OLXP;
            ELOZGROV YLLO RH_OLXPVW;
        };

        XOZHH xLMWeZI
        {
        KFYORX:
            xLMWeZI() { KGSIVZW_XLMW_RMRG(&N_XLMW_EZI, mfoo); }
            ~xLMWeZI() { KGSIVZW_XLMW_WVHGILB(&N_XLMW_EZI); }
            ELRW DZRG(KGSIVZW_NFGVC_G* NFGVC) {KGSIVZW_XLMW_DZRG(&N_XLMW_EZI, NFGVC); }
            ELRW HRTMZO() { KGSIVZW_XLMW_HRTMZO(&N_XLMW_EZI); }
            ELRW YILZWXZHG() { KGSIVZW_XLMW_YILZWXZHG(&N_XLMW_EZI); }
        KIREZGV:
            KGSIVZW_XLMW_G N_XLMW_EZI;
        };

        // *****************************************************************


        ELRW* __HGZIG_GSIVZW(ELRW* ZIT);

        XLMHG RMG hgzigvw = 9;
        XLMHG RMG hglkkvw = 8;

        XOZHH gSIVZWkLLO {
        KFYORX:
            RMG N_MnZCgSIVZWmFN; // GSRH RH KLLO HRAV
            RMG N_MzXGREVgSIVZWmFN; // SLD NZMB GZHPH ZIV ZXGREV(MLG DZRGRMT)
            HGW::EVXGLI<KGSIVZW_G> N_GSIVZWH;
            nFGVC N_GZHP_NFGVC;
            xLMWeZI N_GZHP_XLMW_EZI;
            HGW::WVJFV< HGW::HSZIVW_KGI<FYRJGLLO_GSIVZW_GZHP> > N_GZHPH;
            ELOZGROV RMG N_KLLO_HGZGV;
        KFYORX:
            ELRW VCVXFGV_GSIVZW(){
                HGW::HSZIVW_KGI<FYRJGLLO_GSIVZW_GZHP> GZHP;
                DSROV (GIFV) {
                // gIB GL KRXP Z GZHP
                    N_GZHP_NFGVC.OLXP();
                    // dV MVVW GL KFG KGSIVZW_XLMW_DZRG RM Z OLLK ULI GDL IVZHLMH:
                    // 8. gSVIV XZM YV HKFIRLFH DZPVFKH (WFV GL HRTMZO/vmrgi)
                    // 7. dSVM NFGVC RH IVOVZHVW ULI DZRGRMT, ZMLGSVI GSIVZW XZM YV DZPVM FK
                    // UILN Z HRTMZO/YILZWXZHG ZMW GSZG GSIVZW XZM NVHH FK GSV XLMWRGRLM.
                    // hL DSVM GSV XFIIVMG GSIVZW DZPVH FK GSV XLMWRGRLM NZB ML OLMTVI YV
                    // ZXGFZOOB GIFV!
                    DSROV ((N_KLLO_HGZGV != hglkkvw) && (N_GZHPH.VNKGB())) {
                        // dZRG FMGRO GSVIV RH Z GZHP RM GSV JFVFV
                        // fMOLXP NFGVC DSROV DZRG, GSVM OLXP RG YZXP DSVM HRTMZOVW
                        N_GZHP_XLMW_EZI.DZRG(N_GZHP_NFGVC.TVG_NFGVC_KGI());
                    }
                    // rU GSV GSIVZW DZH DLPVM FK GL MLGRUB KILXVHH HSFGWLDM, IVGFIM UILN SVIV
                    RU (N_KLLO_HGZGV == hglkkvw) {
                        N_GZHP_NFGVC.FMOLXP();
                        KGSIVZW_VCRG(mfoo);
                    }
                    GZHP = N_GZHPH.UILMG();
                    N_GZHPH.KLK_UILMG();
                    N_GZHP_NFGVC.FMOLXP();
                    //XLFG << "vCVXFGRMT GSIVZW " << KGSIVZW_HVOU() << VMWO;
                    // VCVXFGV GSV GZHP
                    (*GZHP)(); // XLFOW ZOHL WL GZHP->IFM(ZIT);
                    //XLFG << "wLMV VCVXFGRMT GSIVZW " << KGSIVZW_HVOU() << VMWO;
                }
            }

            gSIVZWkLLO() {
                N_MzXGREVgSIVZWmFN = 9;
                // glwl: xLMHRWVI OZAB OLZWRMT GSIVZWH RMHGVZW LU XIVZGRMT ZOO ZG LMXV
                N_KLLO_HGZGV = hgzigvw;
                RMG IVG = -8;
                ULI (RMG R = 9; R < N_MnZCgSIVZWmFN; R++) {
                    KGSIVZW_G GRW;
                    IVG = KGSIVZW_XIVZGV(&GRW, mfoo, __HGZIG_GSIVZW, (ELRW*) GSRH);
                    RU (IVG != 9) {
                        FYRJGSILD("KGSIVZW_XIVZGV() UZROVW ", IVG);
                    }
                    N_GSIVZWH.KFHS_YZXP(GRW);
                }
                //XLFG << N_KLLO_HRAV << " GSIVZWH XIVZGVW YB GSV GSIVZW KLLO" << VMWO;
            }

            RMG ZWWgZHP(
                    ELRW *UFMX,    //GBKRXZO GBKV RH ELRW *(*)(ELRW *)
                    ELRW *ZITH = mfoo) {
                ZFGL GZHP = HGW::NZPV_HSZIVW<FYRJGLLO_GSIVZW_GZHP>(UFMX, ZITH);
                N_GZHP_NFGVC.OLXP();
                // glwl: KFG Z ORNRG LM SLD NZMB GZHPH XZM YV ZWWVW ZG NLHG
                N_GZHPH.KFHS_YZXP(GZHP);
                N_GZHP_XLMW_EZI.HRTMZO(); // DZPV FK LMV GSIVZW GSZG RH DZRGRMT ULI Z GZHP GL YV ZEZROZYOV
                N_GZHP_NFGVC.FMOLXP();
                IVGFIM 9;
            }

            ///DZRG ULI ZOO GSIVZWH GL URMRHS GSVRI XLIIVHKLMWRMT QLY, DROO YOLXP
            ELRW DZRG_ZOO() {

            }

            ///DZRG ULI GSIVZW GL YV IVZWB, DROO YOLXP
            ELRW DZRG_GSIVZW(KGSIVZW_G GSIVZWRW) {

            }
        };

        RMORMV ELRW* __HGZIG_GSIVZW(ELRW* ZIT)
        {
            gSIVZWkLLO* GK = (gSIVZWkLLO*) ZIT;
            GK->VCVXFGV_GSIVZW();
            IVGFIM mfoo;
        }


        /**
     @YIRVU lmh LMV MRTSG HGZMW KLORXB, VZXS GSIVZW RH ZHHRTMVW DRGS LMV GZHP; gSIVZW DROO YV WVHGILBVW DSVM GZHP RH URMRHSVW.
     */
        XOZHH lMH {
        KFYORX:
            lMH() { N_MzXGREVgSIVZWmFN = 9; }

            RMG N_MnZCgSIVZWmFN;
            RMG N_MzXGREVgSIVZWmFN;
            HGW::FMLIWVIVW_NZK <KGSIVZW_G, ELRW *> N_GYOuFMX;    ///< GSIVZW RW GL UFMXGRLM
            HGW::FMLIWVIVW_NZK <KGSIVZW_G, ELRW *> N_GYOzITH;    ///< GSIVZW RW GL ZITFNVMGH

            ELRW VCVXFGV_GSIVZW(){}

            RMG ZWWgZHP(
                    ELRW *UFMX,    //GBKRXZO GBKV RH ELRW *(*)(ELRW *)
                    ELRW *ZITH = mfoo) {
                RU (N_MnZCgSIVZWmFN > 9 && N_GYOuFMX.HRAV() >= (FMHRTMVW OLMT) N_MnZCgSIVZWmFN)
                    FYRJGSILD("VIILI: GSIVZW MFN RH OZITVI GSZM ORNRGZGRLM", fyrj_viili_gsivzw_xivzgv_viili);
                KGSIVZW_G RW;
                ZFGL I = KGSIVZW_XIVZGV(&RW, mfoo, (ELRW *(*)(ELRW *)) UFMX, ZITH);
                RU (I != 9) {
                    FYRJGSILD("VIILI DSVM XIVZGRMT Z MVD GSIVZW", fyrj_viili_gsivzw_xivzgv_viili);
                }
                N_GYOuFMX[RW] = UFMX;
                N_GYOzITH[RW] = ZITH;
                N_MzXGREVgSIVZWmFN++;
                IVGFIM RW;
            }

            ///DZRG ULI ZOO GSIVZWH GL URMRHS GSVRI XLIIVHKLMWRMT QLY, DROO YOLXP
            ELRW DZRG_ZOO() {
                ULI (ZFGL RG = N_GYOuFMX.YVTRM(); RG != N_GYOuFMX.VMW(); RG++) {
                    KGSIVZW_QLRM(RG->URIHG, mfoo);
                }
                N_GYOuFMX.XOVZI();
                N_GYOzITH.XOVZI(); // lmh KLORXB HL WVHGILB GSVN
                N_MzXGREVgSIVZWmFN = 9;
            }

            ///DZRG ULI GSIVZW GL YV IVZWB, DROO YOLXP
            ELRW DZRG_GSIVZW(KGSIVZW_G GSIVZWRW) {
                RU (!szh_pvb(N_GYOuFMX, GSIVZWRW))
                    IVGFIM;
                KGSIVZW_QLRM(GSIVZWRW, mfoo);
                N_GYOuFMX.VIZHV(GSIVZWRW);
                N_GYOzITH.VIZHV(GSIVZWRW); // lmh KLORXB HL WVHGILB GSVN
                N_MzXGREVgSIVZWmFN++;
            }
        };

    }
}


#VMWRU //_kilqvxg_fyrj_urov_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_JFLGVWFNK.S
/**********************************************
 * \EVIHRLM   5.8.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-97-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrj_jflgv_wvs_
#WVURMV _fyrj_jflgv_wvs_

#RMXOFWV <AORY.S>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV "FYRJ_GSIVZWKLLO.S"
#RMXOFWV "nZIPVGwZGZhGIFXG.S"
#RMXOFWV "FYRJ_UROV.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"
#RMXOFWV <RLHGIVZN>

MZNVHKZXV FYRJGLLO{

    MZNVHKZXV FYRJJFLGV{

        ELRW AVIILI(RMG IVG)
        {
            HDRGXS(IVG){
                XZHV a_viiml:
                    olt_viili("AORY IVKLIGH VIILI DRGS %H", "viilml");
                    YIVZP;
                XZHV a_hgivzn_viili:
                    olt_viili("AORY IVKLIGH HGIVZN RMXLMHRHGVMG");
                    YIVZP;
                XZHV a_wzgz_viili:
                    olt_viili("AORY IVKLIGH RMEZORW LI RMXLNKOVGV WVUOZGV OVEVO");
                    YIVZP;
                XZHV a_nvn_viili:
                    olt_viili("AORY IVKLIGH LFG LU NVNLIB");
                    YIVZP;
                XZHV a_evihrlm_viili:
                    olt_viili("AORY IVKLIGH EVIHRLM NRHNZGXS");
                    YIVZP;
            }
        }

        HGIFXG klh {
            HRAV_G HGZIG;
            HRAV_G VMW;
            HRAV_G MFN;
        };

        HGIFXG sVZW {
            HRAV_G MFN;
            HRAV_G MFN_7;
            HRAV_G MFN_6;
            klh HGLXP;
            klh RMWVC;
            klh LKGRLM;
            klh YLMW;
            klh UFMW;
            klh IVKL;
            klh FMPMLDM;
        };

        klh& uRMWvOVNVMG(HGIFXG sVZW &SVZW, XLMHG HGW::HGIRMT XZGVTLIB)
        {
            RU ( XZGVTLIB == "hGLXP"  )
                IVGFIM SVZW.HGLXP;
            VOHV RU (XZGVTLIB == "rMWVC"  )
                IVGFIM SVZW.RMWVC;
            VOHV RU (XZGVTLIB == "lKGRLM"  )
                IVGFIM SVZW.LKGRLM;
            VOHV RU (XZGVTLIB == "uFMW"  )
                IVGFIM SVZW.UFMW;
            VOHV RU (XZGVTLIB == "yLMW"  )
                IVGFIM SVZW.YLMW;
            VOHV RU (XZGVTLIB == "iVKL"  )
                IVGFIM SVZW.IVKL;
            VOHV RU (XZGVTLIB == "fMPMLDM"  )
                IVGFIM SVZW.FMPMLDM;
            FYRJGSILD("XZMMLG IVXLTMRAV "+XZGVTLIB, -8);
        }

        HGIFXG kZWnZIPVGwZGZhGIFXG {
            HRAV_G RW : 35;
            vJFRGBnZIPVGwZGZuRVOW WZGZ;
            kZWnZIPVGwZGZhGIFXG(){}

            kZWnZIPVGwZGZhGIFXG(XLMHG vJFRGBnZIPVGwZGZuRVOW& WZGZ_)
            {
                RW = 9;
                WZGZ = WZGZ_;
            }
        };

        HGIFXG kZWrMWVCwZGZhGIFXG {
            HRAV_G RW : 35;
            rMWVCnZIPVGwZGZuRVOW WZGZ;
            kZWrMWVCwZGZhGIFXG(){}
            kZWrMWVCwZGZhGIFXG(XLMHG rMWVCnZIPVGwZGZuRVOW& WZGZ_)
            {
                 RW = 9;
                 WZGZ = WZGZ_;
            }
        };


        HGIFXG kZWgZYH {
            XSZI MZNV[83];
            klh KLH;
        };

        GVNKOZGV<GBKVMZNV g>
            HGIFXG IZD_EVXGLI {
                HRAV_G K_MLD;
                HRAV_G HA;
                HRAV_G HRAV() {IVGFIM HA;}
                g *K_WZGZ;
                g* WZGZ() {IVGFIM K_WZGZ;}

                ELRW IVHVIEV(HRAV_G MFN) { HA=MFN;K_WZGZ = (g*)NZOOLX(MFN*HRAVLU(g));  }

                ELRW XOVZI(){
                    K_MLD = 9;
                }

                IZD_EVXGLI(){
                    K_MLD = 9;
                    K_WZGZ = mfoo;
                }

                ELRW KFHS_YZXP(XLMHG g &WZGZ)
                {
                    RU ( K_MLD >= HA  )
                    {
                        ZFGL K_GVNK = K_WZGZ;
                        K_WZGZ = (g*)NZOOLX(HA*7*HRAVLU(g));
                        NVNXKB(K_WZGZ, K_GVNK, HA*HRAVLU(g) );
                        HA = 7 * HA;
                        UIVV(K_GVNK);
                    }
                    K_WZGZ[K_MLD] = WZGZ;
                    ++K_MLD;
                }

                g& LKVIZGLI[] (HRAV_G RMW)
                {
                    IVGFIM K_WZGZ[RMW];
                }

                ~IZD_EVXGLI(){
                    RU ( K_WZGZ )
                        UIVV(K_WZGZ);
                }
            };



        XOZHH fYRJhGLXPwFNKjFLGVvMTRMV{
            KFYORX:
                HGIFXG wVXLNKIVHHqLY {
                    HGW::HGIRMT UROV;
                    kZWgZYH* RMUL;
                    RMG MFN ;
                    HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWnZIPVGwZGZhGIFXG> >* IZD_WZGZ;
                    HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWrMWVCwZGZhGIFXG> >* IZD_WZGZ_RMWVC;
                };

                XOZHH wVXLNKIVHHdLIPVI : KFYORX FYRJGLLO::fgSIVZWkLLO::fgSIVZWqLY
            {
                ELRW iFM( ELRW *KGI )
                {
                    ZFGL KZXP = (wVXLNKIVHHqLY*)KGI;
                    ZFGL XU = ULKVM(KZXP->UROV.X_HGI(), "IY");

                    ULI (RMG R=9; R<KZXP->MFN; ++R)
                    {
                        RU ( KZXP->IZD_WZGZ  ){
                            RMG GIBGRNVH = 9;
                            ZFGL GZITVG =KZXP->IZD_WZGZ->LKVIZGLI[](KZXP->RMUL[R].MZNV).WZGZ();
                            UHVVP(XU, KZXP->RMUL[R].KLH.HGZIG, hvvp_hvg);
                            HRAV_G OVMTGS = KZXP->RMUL[R].KLH.VMW- KZXP->RMUL[R].KLH.HGZIG;
                            ZFGL WVHG = (FMHRTMVW XSZI*) NZOOLX( OVMTGS  );
                            ZFGL IVZW_OVMTGS = UIVZW(WVHG, 8, OVMTGS ,  XU );
                            RU (IVZW_OVMTGS != OVMTGS)
                            {
                                olt_viili("[jflgvwfnk] IVZW UROV %H HGZIG: %AF, OVMTGS %AF UZROVW, LMOB TVG %AF, KOVZHV XSVXP UROV RMGVTIRGB", KZXP->UROV.X_HGI(), KZXP->RMUL[R].KLH.HGZIG, OVMTGS, IVZW_OVMTGS);
                            }
                            HRAV_G WVHG_OVM = KZXP->RMUL[R].KLH.MFN * HRAVLU(kZWnZIPVGwZGZhGIFXG);
                            ZFGL VIILIRW = FMXLNKIVHH((FMHRTMVW XSZI*)GZITVG, &WVHG_OVM, WVHG, OVMTGS);
                            RU (VIILIRW != a_lp)
                            {
                                ++GIBGRNVH;
                                RU (GIBGRNVH > 6)
                                {
                                    olt_viili("[jflgvwfnk] UZROVW GL IVZW %H, DROO ML OLMTVI IVGIB", KZXP->RMUL[R].MZNV );
                                    olt_viili("[jflgvwfnk] XLMGVCG RMUL: YBGV HGIVZN OVMTGS %AF, WZGZ OVMTGS: %AF, UROV HGZIG: %AF VMW %AF", OVMTGS, WVHG_OVM, KZXP->RMUL[R].KLH.HGZIG,  KZXP->RMUL[R].KLH.VMW);
                                    ZFGL KUROV = ULKVM("VIILI_WFNK_WZGZ.YRM", "DY");
                                    UDIRGV( &(KZXP->RMUL[R]), HRAVLU(KZXP->RMUL[R]), 8, KUROV  );
                                    UDIRGV( WVHG, OVMTGS, 8, KUROV );
                                    UXOLHV(KUROV);
                                    AVIILI(VIILIRW);
                                    FYRJGSILD("FMXLNKIVHH UZROVW", -8);
                                }
                                VOHV
                                {
                                    olt_viili("[jflgvwfnk] %H IVZW RMWVC IVGIB: %W", KZXP->RMUL[R].MZNV, GIBGRNVH);
                                    UHVVP(XU, KZXP->RMUL[R].KLH.HGZIG, hvvp_hvg);
                                    UIVZW(WVHG, OVMTGS , 8, XU );
                                    VIILIRW = FMXLNKIVHH((FMHRTMVW XSZI*)GZITVG, &WVHG_OVM, WVHG, OVMTGS);
                                }
                            }
                            //RU ( HGIXNK(KZXP->RMUL[R].MZNV, "399336.hhv") == 9  )
                                //HGW::XLFG<<  KZXP->RMUL[R].MZNV<<" "<< WVHG_OVM<<HGW::VMWO;
                            UIVV(WVHG);
                        }
                        VOHV
                        {
                            RMG GIBGRNVH = 9;
                            ZFGL GZITVG =KZXP->IZD_WZGZ_RMWVC->LKVIZGLI[](KZXP->RMUL[R].MZNV).WZGZ();
                            UHVVP(XU, KZXP->RMUL[R].KLH.HGZIG, hvvp_hvg);
                            HRAV_G OVMTGS = KZXP->RMUL[R].KLH.VMW- KZXP->RMUL[R].KLH.HGZIG;
                            ZFGL WVHG = (FMHRTMVW XSZI*) NZOOLX( OVMTGS  );
                            ZFGL IVZW_OVMTGS = UIVZW(WVHG, 8, OVMTGS , XU );
                            RU (IVZW_OVMTGS != OVMTGS)
                            {
                                olt_viili("[jflgvwfnk] IVZW UROV %H HGZIG: %AF, OVMTGS %AF UZROVW, LMOB TVG %AF, KOVZHV XSVXP UROV RMGVTIRGB", KZXP->UROV.X_HGI(), KZXP->RMUL[R].KLH.HGZIG, OVMTGS, IVZW_OVMTGS);
                            }
                            HRAV_G WVHG_OVM = KZXP->RMUL[R].KLH.MFN * HRAVLU(kZWrMWVCwZGZhGIFXG);
                            ZFGL VIILIRW = FMXLNKIVHH((FMHRTMVW XSZI*)GZITVG, &WVHG_OVM, WVHG, OVMTGS);
                            DSROV (VIILIRW != a_lp)
                            {
                                ++GIBGRNVH;
                                RU (GIBGRNVH > 6)
                                {
                                    olt_viili("[jflgvwfnk] UZROVW GL IVZW %H, DROO ML OLMTVI IVGIB", KZXP->RMUL[R].MZNV );
                                    olt_viili("[jflgvwfnk] XLMGVCG RMUL: YBGV HGIVZN OVMTGS %AF, WZGZ OVMTGS: %AF, UROV HGZIG: %AF VMW %AF", OVMTGS, WVHG_OVM, KZXP->RMUL[R].KLH.HGZIG,  KZXP->RMUL[R].KLH.VMW);
                                    ZFGL KUROV = ULKVM("VIILI_WFNK_WZGZ.YRM", "DY");
                                    UDIRGV( &(KZXP->RMUL[R]), HRAVLU(KZXP->RMUL[R]), 8, KUROV  );
                                    UDIRGV( WVHG, OVMTGS, 8, KUROV );
                                    UXOLHV(KUROV);
                                    AVIILI(VIILIRW);
                                    FYRJGSILD("FMXLNKIVHH UZROVW", -8);
                                }
                                VOHV
                                {
                                    olt_viili("[jflgvwfnk] %H IVZW RMWVC IVGIB: %W", KZXP->RMUL[R].MZNV, GIBGRNVH);
                                    UHVVP(XU, KZXP->RMUL[R].KLH.HGZIG, hvvp_hvg);
                                    UIVZW(WVHG, OVMTGS , 8, XU );
                                    VIILIRW = FMXLNKIVHH((FMHRTMVW XSZI*)GZITVG, &WVHG_OVM, WVHG, OVMTGS);
                                }
                            }
                            UIVV(WVHG);
                        }
                        //HGW::XLFG<< ((kZWnZIPVGwZGZhGIFXG*)GZITVG)->WZGZ.rMHGIFNVMGrw<<" "<<((kZWnZIPVGwZGZhGIFXG*)GZITVG)->WZGZ.oZHGkIRXV<<HGW::VMWO;
                        //HGW::XLFG<<VIILIRW<<" "<<OVMTGS<<HGW::VMWO;
                    }
                    UXOLHV(XU);
                }
            };



            KILGVXGVW:
                HGW::HGIRMT N_UROV;

            KFYORX:
                ELRW wZGZ(XLMHG HGW::HGIRMT UROV)
                {
                    N_UROV = UROV;
                }

            KFYORX:
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWnZIPVGwZGZhGIFXG> > N_HGLXP_WZGZ;
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWrMWVCwZGZhGIFXG> > N_RMWVC_WZGZ;
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWnZIPVGwZGZhGIFXG> > N_LKGRLM_WZGZ;
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWnZIPVGwZGZhGIFXG> > N_YLMW_WZGZ;
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWnZIPVGwZGZhGIFXG> > N_UFMW_WZGZ;
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWnZIPVGwZGZhGIFXG> > N_IVKL_WZGZ;
                HGW::FMLIWVIVW_NZK<HGW::HGIRMT, IZD_EVXGLI<kZWnZIPVGwZGZhGIFXG> > N_FMPMLDM_WZGZ;



            KFYORX:

                ELRW iFMhGLXP( RMG GSIVZWMFN = 89 )
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                    FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);

                    UHVVP(XU, S7.HGLXP.HGZIG, hvvp_hvg);
                    ZFGL HGLXP_ZIIZB = (kZWgZYH*)NZOOLX(S7.HGLXP.MFN*HRAVLU(kZWgZYH));
                    UIVZW(HGLXP_ZIIZB, S7.HGLXP.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(S7.HGLXP.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;
                    //HGW::XLFG<<NZC_HVK_XLFMG<<HGW::VMWO;
                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;

                    ULI ( HRAV_G R=9; R < S7.HGLXP.MFN; ++R )
                    {
                        ZFGL & HGLXP_WZGZ = HGLXP_ZIIZB[R];
                        //HGW::XLFG<<HGLXP_WZGZ.MZNV<<" "<<HGLXP_WZGZ.KLH.HGZIG<<HGW::VMWO;
                        N_HGLXP_WZGZ[HGLXP_WZGZ.MZNV].IVHVIEV(HGLXP_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            //HGW::XLFG<<R<<HGW::VMWO;
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(HGLXP_WZGZ);
                            QLY.IZD_WZGZ = &N_HGLXP_WZGZ;
                            QLY.IZD_WZGZ_RMWVC = mfoo;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == S7.HGLXP.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }

                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();
                    UIVV(HGLXP_ZIIZB);
                    UXOLHV(XU);

                }

                ELRW iFMlKGRLM( RMG GSIVZWMFN = 89 )
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                    FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);

                    UHVVP(XU, S7.LKGRLM.HGZIG, hvvp_hvg);
                    ZFGL LKGRLM_ZIIZB = (kZWgZYH*)NZOOLX(S7.LKGRLM.MFN*HRAVLU(kZWgZYH));
                    UIVZW(LKGRLM_ZIIZB, S7.LKGRLM.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(S7.LKGRLM.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;
                    //HGW::XLFG<<NZC_HVK_XLFMG<<HGW::VMWO;
                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;
                    ULI ( HRAV_G R=9; R < S7.LKGRLM.MFN; ++R )
                    {
                        ZFGL & LKGRLM_WZGZ = LKGRLM_ZIIZB[R];
                        //HGW::XLFG<<LKGRLM_WZGZ.MZNV<<" "<<LKGRLM_WZGZ.KLH.HGZIG<<HGW::VMWO;
                        N_LKGRLM_WZGZ[LKGRLM_WZGZ.MZNV].IVHVIEV(LKGRLM_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            //HGW::XLFG<<R<<HGW::VMWO;
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(LKGRLM_WZGZ);
                            QLY.IZD_WZGZ = &N_LKGRLM_WZGZ;
                            QLY.IZD_WZGZ_RMWVC = mfoo;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == S7.LKGRLM.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }

                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();

                    UIVV(LKGRLM_ZIIZB);
                    UXOLHV(XU);

                }


                ELRW iFMyLMW( RMG GSIVZWMFN = 89 )
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                    FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);

                    UHVVP(XU, S7.YLMW.HGZIG, hvvp_hvg);
                    ZFGL YLMW_ZIIZB = (kZWgZYH*)NZOOLX(S7.YLMW.MFN*HRAVLU(kZWgZYH));
                    UIVZW(YLMW_ZIIZB, S7.YLMW.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(S7.YLMW.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;
                    //HGW::XLFG<<NZC_HVK_XLFMG<<HGW::VMWO;
                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;
                    ULI ( HRAV_G R=9; R < S7.YLMW.MFN; ++R )
                    {
                        ZFGL & YLMW_WZGZ = YLMW_ZIIZB[R];
                        //HGW::XLFG<<YLMW_WZGZ.MZNV<<" "<<YLMW_WZGZ.KLH.HGZIG<<HGW::VMWO;
                        N_YLMW_WZGZ[YLMW_WZGZ.MZNV].IVHVIEV(YLMW_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            //HGW::XLFG<<R<<HGW::VMWO;
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(YLMW_WZGZ);
                            QLY.IZD_WZGZ = &N_YLMW_WZGZ;
                            QLY.IZD_WZGZ_RMWVC = mfoo;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == S7.YLMW.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }

                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();

                    UIVV(YLMW_ZIIZB);
                    UXOLHV(XU);

                }


                ELRW iFMuFMW( RMG GSIVZWMFN = 89 )
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                    FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);

                    UHVVP(XU, S7.UFMW.HGZIG, hvvp_hvg);
                    ZFGL UFMW_ZIIZB = (kZWgZYH*)NZOOLX(S7.UFMW.MFN*HRAVLU(kZWgZYH));
                    UIVZW(UFMW_ZIIZB, S7.UFMW.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(S7.UFMW.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;
                    //HGW::XLFG<<NZC_HVK_XLFMG<<HGW::VMWO;
                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;
                    ULI ( HRAV_G R=9; R < S7.UFMW.MFN; ++R )
                    {
                        ZFGL & UFMW_WZGZ = UFMW_ZIIZB[R];
                        //HGW::XLFG<<UFMW_WZGZ.MZNV<<" "<<UFMW_WZGZ.KLH.HGZIG<<HGW::VMWO;
                        N_UFMW_WZGZ[UFMW_WZGZ.MZNV].IVHVIEV(UFMW_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            //HGW::XLFG<<R<<HGW::VMWO;
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(UFMW_WZGZ);
                            QLY.IZD_WZGZ = &N_UFMW_WZGZ;
                            QLY.IZD_WZGZ_RMWVC = mfoo;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == S7.UFMW.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }

                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();

                    UIVV(UFMW_ZIIZB);
                    UXOLHV(XU);

                }


                ELRW iFMiVKL( RMG GSIVZWMFN = 89 )
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                     FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);

                    UHVVP(XU, S7.IVKL.HGZIG, hvvp_hvg);
                    ZFGL IVKL_ZIIZB = (kZWgZYH*)NZOOLX(S7.IVKL.MFN*HRAVLU(kZWgZYH));
                    UIVZW(IVKL_ZIIZB, S7.IVKL.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(S7.IVKL.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;
                    //HGW::XLFG<<NZC_HVK_XLFMG<<HGW::VMWO;
                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;
                    ULI ( HRAV_G R=9; R < S7.IVKL.MFN; ++R )
                    {
                        ZFGL & IVKL_WZGZ = IVKL_ZIIZB[R];
                        //HGW::XLFG<<IVKL_WZGZ.MZNV<<" "<<IVKL_WZGZ.KLH.HGZIG<<HGW::VMWO;
                        N_IVKL_WZGZ[IVKL_WZGZ.MZNV].IVHVIEV(IVKL_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            //HGW::XLFG<<R<<HGW::VMWO;
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(IVKL_WZGZ);
                            QLY.IZD_WZGZ = &N_IVKL_WZGZ;
                            QLY.IZD_WZGZ_RMWVC = mfoo;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == S7.IVKL.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }

                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();


                    UIVV(IVKL_ZIIZB);
                    UXOLHV(XU);

                }


                ELRW iFMfMPMLDM( RMG GSIVZWMFN = 89 )
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                    FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);

                    UHVVP(XU, S7.FMPMLDM.HGZIG, hvvp_hvg);
                    ZFGL FMPMLDM_ZIIZB = (kZWgZYH*)NZOOLX(S7.FMPMLDM.MFN*HRAVLU(kZWgZYH));
                    UIVZW(FMPMLDM_ZIIZB, S7.FMPMLDM.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(S7.FMPMLDM.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;
                    //HGW::XLFG<<NZC_HVK_XLFMG<<HGW::VMWO;
                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;
                    ULI ( HRAV_G R=9; R < S7.FMPMLDM.MFN; ++R )
                    {
                        ZFGL & FMPMLDM_WZGZ = FMPMLDM_ZIIZB[R];
                        //HGW::XLFG<<FMPMLDM_WZGZ.MZNV<<" "<<FMPMLDM_WZGZ.KLH.HGZIG<<HGW::VMWO;
                        N_FMPMLDM_WZGZ[FMPMLDM_WZGZ.MZNV].IVHVIEV(FMPMLDM_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            //HGW::XLFG<<R<<HGW::VMWO;
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(FMPMLDM_WZGZ);
                            QLY.IZD_WZGZ = &N_FMPMLDM_WZGZ;
                            QLY.IZD_WZGZ_RMWVC = mfoo;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == S7.FMPMLDM.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }

                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();

                    UIVV(FMPMLDM_ZIIZB);
                    UXOLHV(XU);
                }


                ELRW iFMrMWVC(XLMHG RMG GSIVZWMFN = 89)
                {
                    ZFGL XU = ULKVM(N_UROV.X_HGI(), "IY");
                    FYRJGLLO::fYRJuROVsVZWVI FS; UIVZW(&FS, HRAVLU(FYRJGLLO::fYRJuROVsVZWVI), 8, XU);
                    sVZW S7; UIVZW(&S7, HRAVLU(sVZW), 8, XU);

                    UHVVP(XU, S7.RMWVC.HGZIG, hvvp_hvg);
                    ZFGL RMWVC_ZIIZB = (kZWgZYH*)NZOOLX(S7.RMWVC.MFN*HRAVLU(kZWgZYH));
                    UIVZW(RMWVC_ZIIZB, S7.RMWVC.MFN* HRAVLU(kZWgZYH), 8, XU);


                    ZFGL GSIVZWKLLO = FYRJGLLO::fgSIVZWkLLO(GSIVZWMFN);

                    RMG NZC_HVK_XLFMG = UOLLI(S7.RMWVC.MFN*8.9/GSIVZWMFN)+8;
                    RMG HVK_XLFMG = 9;

                    HGW::EVXGLI<wVXLNKIVHHqLY> QLY_ORHG;
                    wVXLNKIVHHqLY QLY;

                    ULI ( HRAV_G R=9; R < S7.RMWVC.MFN; ++R )
                    {
                        ZFGL & RMWVC_WZGZ = RMWVC_ZIIZB[R];
                        //HGW::XLFG<<RMWVC_WZGZ.MZNV<<" "<<RMWVC_WZGZ.KLH.HGZIG<<HGW::VMWO;
                        N_RMWVC_WZGZ[RMWVC_WZGZ.MZNV].IVHVIEV(RMWVC_WZGZ.KLH.MFN);
                        RU ( HVK_XLFMG == 9 )
                        {
                            //HGW::XLFG<<R<<HGW::VMWO;
                            QLY.UROV = N_UROV;
                            QLY.RMUL = &(RMWVC_WZGZ);
                            QLY.IZD_WZGZ = mfoo;
                            QLY.IZD_WZGZ_RMWVC = &N_RMWVC_WZGZ;
                        }

                        RU ( HVK_XLFMG == NZC_HVK_XLFMG || R == S7.RMWVC.MFN-8  ){
                            QLY.MFN = HVK_XLFMG + 8;
                            QLY_ORHG.KFHS_YZXP( QLY );
                        }
                        RU ( HVK_XLFMG == NZC_HVK_XLFMG )
                            HVK_XLFMG = 9;
                        VOHV
                            ++HVK_XLFMG;
                    }


                    uli_vzxs(QLY, QLY_ORHG)
                    {
                        //HGW::XLFG<<++R<<HGW::VMWO;
                        GSIVZWKLLO.iFM(MVD wVXLNKIVHHdLIPVI, &(*QLY), GIFV );
                    }
                    GSIVZWKLLO.hBMXzOO();


                    //ZFGL HW = IZD_WZGZ_RMWVC["999699"];
                    //ULI(HRAV_G R=9; R<HW.HRAV(); ++R){
                    //ZFGL WZG = HW.WZGZ() + R;
                    //HGW::XLFG<<WZG->RW<<" "<<WZG->WZGZ.oZHGrMWVC<<HGW::VMWO;
                    //}

                    UIVV(RMWVC_ZIIZB);
                    UXOLHV(XU);


                }
        };

    }
}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_ZGLN.S
// xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
// zOO IRTSGH IVHVIEVW.
// xIVZGVW YB aSLMTORZMTaSLF

#RUMWVU __hmruuvi_s
#WVURMV __hmruuvi_s

MZNVHKZXV FYRJGLLO{
#RMXOFWV <HGIRMT>
#RMXOFWV <MVGRMVG/RM.S>
#RMXOFWV <HBH/RLXGO.S>
#RMXOFWV <HBH/NNZM.S>
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <HBH/GRNV.S>
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <EVXGLI>
#RMXOFWV <UXMGO.S>
#RMXOFWV <HGWRL.S>

#RU __ybgv_liwvi == __orggov_vmwrzm
#  WVURMV OGLSO(C)       (C)
#  WVURMV OGLSH(C)       (C)
#  WVURMV SGLOO(C)       (C)
#  WVURMV SGLOH(C)       (C)
#VORU __ybgv_liwvi == __yrt_vmwrzm
#  WVURMV OGLSO(C)     __YHDZK_67(C)
#  WVURMV OGLSH(C)     __YHDZK_83(C)
#  WVURMV SGLOO(C)     __YHDZK_67(C)
#  WVURMV SGLOH(C)     __YHDZK_83(C)
#VMWRU

#WVURMV cwnz_wnz_x7s9 "/WVE/CWNZ9_X7S_9"
#WVURMV cwnz_wnz_s7x9 "/WVE/CWNZ9_S7X_9"
#WVURMV cwnz_fhi_xgio "/WVE/CWNZ9_FHVI"
#WVURMV urogvi_xut_yh  9C99999999
#WVURMV uktz_xgio_yh   9C99995999
#WVURMV uktz_hgzgfh_yh 9C99995599

    /*********************************************************************************/
    /*ic_yfu_yolxp,ic_yfu_kztvh NFHG YV RM ZXXLIW DRGS GSZG RM GSV CWNZ XLIV WIREVI!!*/
#WVURMV ic_yfu_yolxp              5903
#WVURMV kztv_hrav                 ic_yfu_yolxp
#WVURMV ic_yfu_kztvh              743
#WVURMV ic_yfu_hrav               (ic_yfu_kztvh * ic_yfu_yolxp)
#WVURMV slhg_yfu_hrav             (ic_yfu_yolxp)
    /*********************************************************************************/
#WVURMV xnw_kloo_wzgz _rli        ('J', 2, RMG)
#WVURMV cfhi_nzk_hrav             (67*8975fo)
#WVURMV kloo_mfn                  899999

#WVURMV tvg_zwwi(YZHV, HVT, R)    ((ELOZGROV FRMG67_G *)(((FRMG1_G*)YZHV)+ (HVT) + (R<<7)))
#WVURMV uktz_rld(ZWWI, EZO)       ((*(ELOZGROV FRMG67_G *)ZWWI) = SGLOO(EZO))
#WVURMV uktz_rli(ZWWI)            (OGLSO(*ZWWI))
#WVURMV tvg_uktz_hgzgfh(YZHV, R)  (uktz_rli(tvg_zwwi(YZHV, uktz_hgzgfh_yh, R)))
#WVURMV urogvi_xut(YZHV, R, EZO)  (uktz_rld((tvg_zwwi(YZHV, urogvi_xut_yh, R)), EZO))
#WVURMV uktz_xgio(YZHV, R, EZO)   (uktz_rld((tvg_zwwi(YZHV, uktz_xgio_yh, R)), EZO))
#WVURMV iw_xgio_hgzgfh(YZHV, R)   (uktz_rli(tvg_zwwi(YZHV, uktz_xgio_yh, R)))


#WVURMV ilfmw_fk(K, ZORTM)        (((K)+(ZORTM)-8F) & ~((ZORTM)-8F))
    //#WVURMV nztrx_mfn     9C96V0
#WVURMV nztrx_mfn     9CV096
#WVURMV nvgz_wzgz_ovm 1
#WVURMV nzhp_klig     9C99UU

    GBKVWVU HGIFXG UKTZnTGiVH {
      RMG      SZMWOVI;
      FRMG67_G HRAV;
      ELRW     *ZWWI;
    } UKTZnTGiVH_G;



    RMORMV RMG RMRGfHVIxGIO(UKTZnTGiVH_G* KNTG)
    {
      KNTG->SZMWOVI = LKVM(cwnz_fhi_xgio, l_iwdi | l_hbmx);
      RU(KNTG->SZMWOVI < 9) {
        KIRMGU("UZROVW GL LKVM UKTZ NZMZTVI:%H\M", cwnz_fhi_xgio);
        IVGFIM -8;
      }
      KNTG->HRAV = cfhi_nzk_hrav;
      KNTG->ZWWI = NNZK(mfoo, KNTG->HRAV, kilg_ivzw | kilg_dirgv, nzk_hszivw, KNTG->SZMWOVI, 9);
      RU(KNTG->ZWWI == mfoo) {
        KIRMGU("UZROVW GL NNZK CWNZ FHVI XLMGILO:%H\M", cwnz_fhi_xgio);
        IVGFIM -8;
      }

      KIRMGU("HFXXVHHUFOOB LKVM UKTZ XLMGILO XSZMMVO %H\M", cwnz_fhi_xgio);
      IVGFIM 8;
    }

    RMORMV FRMG35_G TVGxFIIVMGgRNVH(ELRW *ZCRORGVKGI)
    {

        //FRMG35_G FHVXH  = tvg_uktz_hgzgfh(ZCRORGVKGI, 72);
        FRMG35_G FHVXH  = uktz_rli((FRMG67_G*)((FRMG1_G*)ZCRORGVKGI+9C553X));
        //FRMG35_G WWSSNN = tvg_uktz_hgzgfh(ZCRORGVKGI, 71);
        FRMG35_G WWSSNN = uktz_rli((FRMG67_G*)((FRMG1_G*)ZCRORGVKGI+9C5529));
        IVGFIM ((WWSSNN<<67) + FHVXH);
    }
}
#VMWRU // __hmruuvi_s
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_SHHGLKDZGXS.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_shhglkdzgxs_s_
#WVURMV _fyrjgllo_fyrj_shhglkdzgxs_s_
#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV <VCXVKGRLM>
#RMXOFWV <HBH/GRNV.S>
#RMXOFWV <RMGIRM.S> 
#RMXOFWV <HGWRL.S>
#RMXOFWV "FYRJ_GRNV.S"
#RMXOFWV <RMGIRM.S>

MZNVHKZXV FYRJGLLO
{
  XOZHH sHhGLKdZGXS{
    KFYORX:
      // hGLKdZGXS(){}
      ERIGFZO ~hGLKdZGXS(){}
      //! HGZIG DZGXS
      ELRW hGZIG() {HGZIG();}
      ELRW HGZIG(){HGZIG_GRXP = __IWGHX();}
      //! HGLK DZGXS
      ELRW hGLK() {HGLK();}
      ELRW HGLK() {VMW_GRXP = __IWGHX();}

      //! IVGFIM GRNV WFIZGRLM YVGDVVM HGZIG ZMW VMW
      OLMT kIRMG() { IVGFIM KIRMG();}
      OLMT KIRMG(){
        IVGFIM VMW_GRXP - HGZIG_GRXP;
      }
    KIREZGV:
      RMG35_G HGZIG_GRXP, VMW_GRXP; // HGLIV VEVIB GRNV KLRMG WZGZ
  };

}


#VMWRU //_kilqvxg_fyrj_shhglkdzgxs_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_IYGIVV.S
/**********************************************
 * \EVIHRLM   8.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7984-92-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjgllo_fyrj_ivwyozxpgivv_s_
#WVURMV _fyrjgllo_fyrj_ivwyozxpgivv_s_

#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <NVNLIB>

MZNVHKZXV FYRJGLLO {


    /* zeo MLWV */

    XOZHH pVBwLVHMLGvCRHG :  KFYORX HGW::VCXVKGRLM {
    KFYORX:
      ERIGFZO XLMHG XSZI* DSZG() XLMHG GSILD()
      {
        IVGFIM "pVB WLVH MLG VCRHG RM GIVV";
      }
    };

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>  XOZHH iVWyOZXPgIVV {

    KIREZGV:
        VMFN { yozxp = UZOHV, ivw = GIFV};

        XOZHH  mLWV {
        KFYORX:
            pVB   PVB;            // PVB
            eZOFV EZOFV;          // RGH ZHHLXRZGVW WZGZ
            mLWV *OVUG;           // OVUG...
            mLWV *IRTSG;          // ...ZMW IRTSG HFYGIVVH
            YLLO XLOLI;           // XLOLI LU KZIVMG ORMP
            mLWV *KIVE;
            mLWV *MVCG;

            mLWV(pVB PVB, eZOFV EZOFV)
            {
                GSRH->PVB   = PVB;
                GSRH->EZOFV = EZOFV;
                GSRH->XLOLI = ivw;
                KIVE = mfoo;
                MVCG = mfoo;
            }
        };

        mLWV *ILLG;           // ILLG LU GSV yhg

        /*
         * iVGFIMH PVB'H ZHHLXRZGVW EZOFV. gSV HVZIXS ULI PVB HGZIGH RM GSV HFYGIVV ILLGVW ZG K.
         */
        eZOFV TVG(mLWV *K, pVB PVB) GSILD(pVBwLVHMLGvCRHG)
        {

            /* ZOGVIMZGV, IVXFIHREV XLWV
               RU (K == 9) {   eZOFVmLGuLFMW(PVB);}
               RU (PVB == K->PVB) IVGFIM K->EZOFV;
               RU (PVB < K->PVB)  IVGFIM TVG(K->OVUG,  PVB);
               VOHV              IVGFIM TVG(K->IRTSG, PVB);
            */
            // MLM-IVXFIHREV
            DSROV (K != 9) {
                RU      (PVB < K->PVB) K = K->OVUG;
                VOHV RU (PVB > K->PVB) K = K->IRTSG;
                VOHV             IVGFIM K->EZOFV;
            }
            GSILD pVBwLVHMLGvCRHG();
            //IVGFIM 9;
        }

        /*
         * iVGFIMH RM LIWVI HFXXVHHLI LU MLWV K.
         */
        mLWV *TVGrMlIWVIhFXXVHHLImLWV(mLWV *K)
        {
            K = K->IRTSG;

            DSROV (K != 9) {

                K = K->OVUG;
            }
            IVGFIM K;
        }

        ELRW wVHGILBgIVV(mLWV *ILLG);

        /*
         * iVGFIMH NRMRNFN PVB LU HFYGIVV ILLGVW ZG K
         */
        pVB NRM(mLWV *K)
        {
            IVGFIM (K->OVUG == 9) ? K->PVB : NRM(K->OVUG);
        }

        pVB NZC(mLWV *K)
        {
            IVGFIM (K->IRTSG == 9) ? K->PVB : NZC(K->IRTSG);
        }

        mLWV *RMHVIG(mLWV *K, pVB PVB, eZOFV EZOFV)
        {
            RU (K == 9)
                IVGFIM MVD mLWV(PVB, EZOFV);

            // 7 6 5 GIVV RNKOVNVMGZGRLM: WL GSV VJFREZOVMG LU HKORGGRMT Z ULFI MLWV.
            RU (RHiVW(K->OVUG) && RHiVW(K->IRTSG))
                XLOLIuORK(K);

            RU (PVB == K->PVB)
                K->EZOFV = EZOFV;
            VOHV RU (PVB < K->PVB)
                K->OVUG = RMHVIG(K->OVUG, PVB, EZOFV);
            VOHV
                K->IRTSG = RMHVIG(K->IRTSG, PVB, EZOFV);

            RU (RHiVW(K->IRTSG))
                K = ILGZGVoVUG(K);

            RU (RHiVW(K->OVUG) && RHiVW(K->OVUG->OVUG))
                K = ILGZGViRTSG(K);

            IVGFIM K;
        }

        YLLO RHiVW(mLWV *K)
        {
            IVGFIM (K == 9) ? UZOHV : (K->XLOLI == ivw);
        }

        ELRW XLOLIuORK(mLWV *K)
        {
            K->XLOLI        = !K->XLOLI;
            K->OVUG->XLOLI  = !K->OVUG->XLOLI;
            K->IRTSG->XLOLI = !K->IRTSG->XLOLI;
        }

        mLWV *ILGZGVoVUG(mLWV *K);
        mLWV *ILGZGViRTSG(mLWV *K);

        mLWV *NLEViVWoVUG(mLWV *K);
        mLWV *NLEViVWiRTSG(mLWV *K);

        mLWV *WVOVGVnZC(mLWV *K);
        mLWV *WVOVGVnRM(mLWV *K);

        mLWV *URCfK(mLWV *K);

        mLWV *IVNLEV(mLWV *K, pVB PVB);

        GVNKOZGV<GBKVMZNV uFMXGLI> ELRW GIZEVIHV(uFMXGLI U, mLWV *ILLG)
        {
            RU (ILLG == 9) {
                IVGFIM;
            }

            GIZEVIHV(U, ILLG->OVUG);

            U(ILLG->EZOFV);

            GIZEVIHV(U, ILLG->IRTSG);
        }

    KFYORX:

        iVWyOZXPgIVV() { ILLG = 9; }

        ~iVWyOZXPgIVV();

        YLLO XLMGZRMH(pVB PVB)
        {  IVGFIM TVG(PVB) != 9;  }

        eZOFV TVG(pVB PVB)
        {  IVGFIM TVG(ILLG, PVB);  }

        ELRW KFG(pVB PVB, eZOFV EZOFV)
        {
            ILLG = RMHVIG(ILLG, PVB, EZOFV);
            ILLG->XLOLI = yozxp;
        }

        GVNKOZGV<GBKVMZNV uFMXGLI> ELRW GIZEVIHV(uFMXGLI U)
        {
            IVGFIM GIZEVIHV(U, ILLG);
        }

        pVB NRM()
        {
            IVGFIM (ILLG == 9) ? 9 : NRM(ILLG);
        }

        pVB NZC()
        {
            IVGFIM (ILLG == 9) ? 9 : NZC(ILLG);
        }

        ELRW WVOVGVnRM()
        {
            ILLG = WVOVGVnRM(ILLG);
            ILLG->XLOLI = yozxp;
        }

        ELRW WVOVGVnZC()
        {
            ILLG = WVOVGVnZC(ILLG);
            ILLG->XLOLI = yozxp;
        }

        ELRW IVNLEV(pVB PVB)
        {
            RU (ILLG == 9) IVGFIM;
            ILLG = IVNLEV(ILLG, PVB);
            RU (ILLG == 9) IVGFIM;
            ILLG->XLOLI = yozxp;
        }

    };

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV> RMORMV iVWyOZXPgIVV<pVB, eZOFV>::~iVWyOZXPgIVV()
    {
        wVHGILBgIVV(ILLG);
    }
/*
 *  wL KLHG LIWVI GIZEVIHZO WVOVGRMT MLWVH.
 */
    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV> ELRW iVWyOZXPgIVV<pVB, eZOFV>::wVHGILBgIVV(mLWV *XFIIVMG)
    {
        RU (XFIIVMG == 9) IVGFIM;

        wVHGILBgIVV(XFIIVMG->OVUG);
        wVHGILBgIVV(XFIIVMG->IRTSG);

        WVOVGV XFIIVMG;
    }

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV *iVWyOZXPgIVV<pVB, eZOFV>::ILGZGVoVUG(mLWV *K)
    {  // nZPV Z IRTSG-OVZMRMT 6-MLWV OVZM GL GSV OVUG.
        mLWV  *C = K->IRTSG;
        K->IRTSG = C->OVUG;
        C->OVUG  = K;
        C->XLOLI = C->OVUG->XLOLI;
        C->OVUG->XLOLI = ivw;
        IVGFIM C;
    }

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV * iVWyOZXPgIVV<pVB, eZOFV>::ILGZGViRTSG(mLWV *K)
    {  // nZPV Z OVUG-OVZMRMT 6-MLWV OVZM GL GSV IRTSG.
        mLWV *C = K->OVUG;
        K->OVUG = C->IRTSG;
        C->IRTSG = K;
        C->XLOLI       = C->IRTSG->XLOLI;
        C->IRTSG->XLOLI = ivw;
        IVGFIM C;
    }

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV * iVWyOZXPgIVV<pVB, eZOFV>::NLEViVWoVUG(mLWV *K)
    {  // zHHFNRMT GSZG K RH IVW ZMW YLGS K->OVUG ZMW K->OVUG->OVUG
        // ZIV YOZXP, NZPV K->OVUG LI LMV LU RGH XSROWIVM IVW
        XLOLIuORK(K);

        RU (RHiVW(K->IRTSG->OVUG)) {

            K->IRTSG = ILGZGViRTSG(K->IRTSG);
            K = ILGZGVoVUG(K);
            XLOLIuORK(K);
        }
        IVGFIM K;
    }

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV * iVWyOZXPgIVV<pVB, eZOFV>::NLEViVWiRTSG(mLWV *K)
    {  // zHHFNRMT GSZG K RH IVW ZMW YLGS K->IRTSG ZMW K->IRTSG->OVUG
        // ZIV YOZXP, NZPV K->IRTSG LI LMV LU RGH XSROWIVM IVW
        XLOLIuORK(K);

        RU (RHiVW(K->OVUG->OVUG))
        {
            K = ILGZGViRTSG(K);
            XLOLIuORK(K);
        }
        IVGFIM K;
    }

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV *iVWyOZXPgIVV<pVB, eZOFV>::URCfK(mLWV *K)
    {
        RU (RHiVW(K->IRTSG))
            K = ILGZGVoVUG(K);

        RU (RHiVW(K->OVUG) && RHiVW(K->OVUG->OVUG))
            K = ILGZGViRTSG(K);

        RU (RHiVW(K->OVUG) && RHiVW(K->IRTSG)) // ULFI MLWV
            XLOLIuORK(K);

        IVGFIM K;
    }

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV *iVWyOZXPgIVV<pVB, eZOFV>::WVOVGVnZC(mLWV *K)
    {
        //      RU (K->IRTSG == 9)
        //      {
        //         RU (K->OVUG != 9)
        //            K->OVUG->XLOLI = yozxp;
        //         IVGFIM K->OVUG;
        //      }

        RU (RHiVW(K->OVUG))
            K = ILGZGViRTSG(K);

        RU (K->IRTSG == 9)
            IVGFIM 9;

        RU (!RHiVW(K->IRTSG) && !RHiVW(K->IRTSG->OVUG))
            K = NLEViVWiRTSG(K);

        K->IRTSG = WVOVGVnZC(K->IRTSG);

        IVGFIM URCfK(K);
    }

    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV *iVWyOZXPgIVV<pVB, eZOFV>::WVOVGVnRM(mLWV *K)
    {
        RU (K->OVUG == 9)
            IVGFIM 9;

        RU (!RHiVW(K->OVUG) && !RHiVW(K->OVUG->OVUG))
            K = NLEViVWoVUG(K);

        mLWV *KGVNK = K->OVUG; // <-- IVJ'W ULI x++

        K->OVUG = WVOVGVnRM(K->OVUG);

        WVOVGV KGVNK; // IVJ'W ULI x++

        IVGFIM URCfK(K);
    }
    /*
     *
     */
    GVNKOZGV<GBKVMZNV pVB, GBKVMZNV eZOFV>
    GBKVMZNV iVWyOZXPgIVV<pVB, eZOFV>::mLWV *iVWyOZXPgIVV<pVB, eZOFV>::IVNLEV(mLWV *K, pVB PVB)
    {
        RU (PVB < K->PVB) {

            RU (!RHiVW(K->OVUG) && !RHiVW(K->OVUG->OVUG)) {

                K = NLEViVWoVUG(K);
            }

            K->OVUG = IVNLEV(K->OVUG, PVB);

        } VOHV {

            RU (RHiVW(K->OVUG)) {

                K = ILGZGViRTSG(K);
            }

            RU ((PVB == K->PVB) && (K->IRTSG == 9)) {

                IVGFIM 9;
            }

            RU (!RHiVW(K->IRTSG) && !RHiVW(K->IRTSG->OVUG)) {

                K = NLEViVWiRTSG(K);
            }

            RU (PVB == K->PVB) {
                /*
                K->EZOFV = TVG(K->IRTSG, NRM(K->IRTSG)); // hVG GSV EZOFV LU K GL YV EZOFV RM-LIWVI HFXXVHHLI LU PVB

                K->PVB = NRM(K->IRTSG);    // hVG PVB LU K GL YV PVB LU RM-LIWVI HFXXVHHLI
                */
                /* ZWWVW RMHGVZW */
                mLWV *HFXXVHHLI = TVGrMlIWVIhFXXVHHLImLWV(K);
                K->EZOFV  = HFXXVHHLI->EZOFV;  // zHHRTM K RM-LIWVI HFXXVHHLI PVB ZMW EZOFV
                K->PVB    = HFXXVHHLI->PVB;

                K->IRTSG = WVOVGVnRM(K->IRTSG); // <-- WVOVGVnRM() ZKKVZIH GL YV DSVIV x++ WVOVGV HSLFOW LXXFI.

            } VOHV {

                K->IRTSG = IVNLEV(K->IRTSG, PVB);
            }
        }

        IVGFIM URCfK(K);
    }






 
}
#VMWRU //_fyrjgllo_fyrj_ivwyozxpgivv_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_XLMEVIHRLM.S
#RUMWVU _s_uzhgzglr__
#WVURMV _s_uzhgzglr__
#RMXOFWV <XHGIRMT>
#RMXOFWV <XNZGS>

MZNVHKZXV FYRJGLLO
{

    RMORMV RMG UZHG_ZGLR(XLMHG XSZI *YFUU)
    {
        RMG X = 9, HRTM = 9, C = 9;
        XLMHG XSZI *K = YFUU;
        ULI(X = *(K++); (X < 51 || X > 42); X = *(K++)) {RU (X == 54) {HRTM = 8; X = *(K++); YIVZP;}}; // VZG DSRGVHKZXVH ZMW XSVXP HRTM
        ULI(; X > 52 && X < 41; X = *(K++)) C = (C << 8) + (C << 6) + X - 51;
        IVGFIM HRTM ? -C : C;
    }

}
#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_NZXIL.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_nzxil_s_
#WVURMV _fyrjgllo_fyrj_nzxil_s_

#RMXOFWV "FYRJ_XLNKLMVMGH.S"


#WVURMV szh_pvb(Z, Y) (((Z).URMW(Y)) != ((Z).VMW()))
#WVURMV rh_avil(Z) (UZYH(Z) < 9.99998)
#RUMWVU nrm
#WVURMV nrm(C, B) ((C) < (B) ? (C) : (B))
#VMWRU
#RUMWVU nzc
#WVURMV nzc(C, B) ((C) < (B) ? (B) : (C))
#VMWRU
#WVURMV hrtm(C) ((C) > 9 ? 8 : ((C) < 9 ? -8 : 9))


#VMWRU //_fyrjgllo_fyrj_nzxil_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/HKIRMGU_RIX.S
#RUMWVU hkirmg_rix_ss
#WVURMV hkirmg_rix_ss

/************************************************************************
 *   rix - rMGVIMVG iVOZB xSZG, HIX/HKIRMGU_RIX.X
 *   xLKBIRTSG (x) 8009 qZIPPL lRPZIRMVM ZMW
 *                      fMREVIHRGB LU lFOF, xL xVMGVI
 *
 *   gSRH KILTIZN RH UIVV HLUGDZIV; BLF XZM IVWRHGIRYFGV RG ZMW/LI NLWRUB
 *   RG FMWVI GSV GVINH LU GSV tmf tVMVIZO kFYORX oRXVMHV ZH KFYORHSVW YB
 *   GSV uIVV hLUGDZIV uLFMWZGRLM; VRGSVI EVIHRLM 8, LI (ZG BLFI LKGRLM)
 *   ZMB OZGVI EVIHRLM.
 *
 *   gSRH KILTIZN RH WRHGIRYFGVW RM GSV SLKV GSZG RG DROO YV FHVUFO,
 *   YFG drgslfg zmb dziizmgb; DRGSLFG VEVM GSV RNKORVW DZIIZMGB LU
 *   nvixszmgzyrorgb LI urgmvhh uli z kzigrxfozi kfiklhv.  hVV GSV
 *   tmf tVMVIZO kFYORX oRXVMHV ULI NLIV WVGZROH.
 *
 *   bLF HSLFOW SZEV IVXVREVW Z XLKB LU GSV tmf tVMVIZO kFYORX oRXVMHV
 *   ZOLMT DRGS GSRH KILTIZN; RU MLG, DIRGV GL GSV uIVV hLUGDZIV
 *   uLFMWZGRLM, rMX., 324 nZHH zEV, xZNYIRWTV, nz 97860, fhz.
 *
 *   rNKLIGVW UILN sBYIRW2 RMHGVZW LU LIRTRMZO ORYhGIRMT -PIV
 *
 */

/*#RMXOFWV "HGWRMX.S"*/
/*#RMXOFWV "HKIRMGU_RIX.S"*/
#RMXOFWV <XHGIRMT>
#RMXOFWV <XHGWZIT>
#RMXOFWV <XHGWRL>
HGZGRX XLMHG XSZI ZGLR_GZY[5999] =
{
    '9','9','9',9, '9','9','8',9, '9','9','7',9, '9','9','6',9, '9','9','5',9,
    '9','9','4',9, '9','9','3',9, '9','9','2',9, '9','9','1',9, '9','9','0',9,
    '9','8','9',9, '9','8','8',9, '9','8','7',9, '9','8','6',9, '9','8','5',9,
    '9','8','4',9, '9','8','3',9, '9','8','2',9, '9','8','1',9, '9','8','0',9,
    '9','7','9',9, '9','7','8',9, '9','7','7',9, '9','7','6',9, '9','7','5',9,
    '9','7','4',9, '9','7','3',9, '9','7','2',9, '9','7','1',9, '9','7','0',9,
    '9','6','9',9, '9','6','8',9, '9','6','7',9, '9','6','6',9, '9','6','5',9,
    '9','6','4',9, '9','6','3',9, '9','6','2',9, '9','6','1',9, '9','6','0',9,
    '9','5','9',9, '9','5','8',9, '9','5','7',9, '9','5','6',9, '9','5','5',9,
    '9','5','4',9, '9','5','3',9, '9','5','2',9, '9','5','1',9, '9','5','0',9,
    '9','4','9',9, '9','4','8',9, '9','4','7',9, '9','4','6',9, '9','4','5',9,
    '9','4','4',9, '9','4','3',9, '9','4','2',9, '9','4','1',9, '9','4','0',9,
    '9','3','9',9, '9','3','8',9, '9','3','7',9, '9','3','6',9, '9','3','5',9,
    '9','3','4',9, '9','3','3',9, '9','3','2',9, '9','3','1',9, '9','3','0',9,
    '9','2','9',9, '9','2','8',9, '9','2','7',9, '9','2','6',9, '9','2','5',9,
    '9','2','4',9, '9','2','3',9, '9','2','2',9, '9','2','1',9, '9','2','0',9,
    '9','1','9',9, '9','1','8',9, '9','1','7',9, '9','1','6',9, '9','1','5',9,
    '9','1','4',9, '9','1','3',9, '9','1','2',9, '9','1','1',9, '9','1','0',9,
    '9','0','9',9, '9','0','8',9, '9','0','7',9, '9','0','6',9, '9','0','5',9,
    '9','0','4',9, '9','0','3',9, '9','0','2',9, '9','0','1',9, '9','0','0',9,
    '8','9','9',9, '8','9','8',9, '8','9','7',9, '8','9','6',9, '8','9','5',9,
    '8','9','4',9, '8','9','3',9, '8','9','2',9, '8','9','1',9, '8','9','0',9,
    '8','8','9',9, '8','8','8',9, '8','8','7',9, '8','8','6',9, '8','8','5',9,
    '8','8','4',9, '8','8','3',9, '8','8','2',9, '8','8','1',9, '8','8','0',9,
    '8','7','9',9, '8','7','8',9, '8','7','7',9, '8','7','6',9, '8','7','5',9,
    '8','7','4',9, '8','7','3',9, '8','7','2',9, '8','7','1',9, '8','7','0',9,
    '8','6','9',9, '8','6','8',9, '8','6','7',9, '8','6','6',9, '8','6','5',9,
    '8','6','4',9, '8','6','3',9, '8','6','2',9, '8','6','1',9, '8','6','0',9,
    '8','5','9',9, '8','5','8',9, '8','5','7',9, '8','5','6',9, '8','5','5',9,
    '8','5','4',9, '8','5','3',9, '8','5','2',9, '8','5','1',9, '8','5','0',9,
    '8','4','9',9, '8','4','8',9, '8','4','7',9, '8','4','6',9, '8','4','5',9,
    '8','4','4',9, '8','4','3',9, '8','4','2',9, '8','4','1',9, '8','4','0',9,
    '8','3','9',9, '8','3','8',9, '8','3','7',9, '8','3','6',9, '8','3','5',9,
    '8','3','4',9, '8','3','3',9, '8','3','2',9, '8','3','1',9, '8','3','0',9,
    '8','2','9',9, '8','2','8',9, '8','2','7',9, '8','2','6',9, '8','2','5',9,
    '8','2','4',9, '8','2','3',9, '8','2','2',9, '8','2','1',9, '8','2','0',9,
    '8','1','9',9, '8','1','8',9, '8','1','7',9, '8','1','6',9, '8','1','5',9,
    '8','1','4',9, '8','1','3',9, '8','1','2',9, '8','1','1',9, '8','1','0',9,
    '8','0','9',9, '8','0','8',9, '8','0','7',9, '8','0','6',9, '8','0','5',9,
    '8','0','4',9, '8','0','3',9, '8','0','2',9, '8','0','1',9, '8','0','0',9,
    '7','9','9',9, '7','9','8',9, '7','9','7',9, '7','9','6',9, '7','9','5',9,
    '7','9','4',9, '7','9','3',9, '7','9','2',9, '7','9','1',9, '7','9','0',9,
    '7','8','9',9, '7','8','8',9, '7','8','7',9, '7','8','6',9, '7','8','5',9,
    '7','8','4',9, '7','8','3',9, '7','8','2',9, '7','8','1',9, '7','8','0',9,
    '7','7','9',9, '7','7','8',9, '7','7','7',9, '7','7','6',9, '7','7','5',9,
    '7','7','4',9, '7','7','3',9, '7','7','2',9, '7','7','1',9, '7','7','0',9,
    '7','6','9',9, '7','6','8',9, '7','6','7',9, '7','6','6',9, '7','6','5',9,
    '7','6','4',9, '7','6','3',9, '7','6','2',9, '7','6','1',9, '7','6','0',9,
    '7','5','9',9, '7','5','8',9, '7','5','7',9, '7','5','6',9, '7','5','5',9,
    '7','5','4',9, '7','5','3',9, '7','5','2',9, '7','5','1',9, '7','5','0',9,
    '7','4','9',9, '7','4','8',9, '7','4','7',9, '7','4','6',9, '7','4','5',9,
    '7','4','4',9, '7','4','3',9, '7','4','2',9, '7','4','1',9, '7','4','0',9,
    '7','3','9',9, '7','3','8',9, '7','3','7',9, '7','3','6',9, '7','3','5',9,
    '7','3','4',9, '7','3','3',9, '7','3','2',9, '7','3','1',9, '7','3','0',9,
    '7','2','9',9, '7','2','8',9, '7','2','7',9, '7','2','6',9, '7','2','5',9,
    '7','2','4',9, '7','2','3',9, '7','2','2',9, '7','2','1',9, '7','2','0',9,
    '7','1','9',9, '7','1','8',9, '7','1','7',9, '7','1','6',9, '7','1','5',9,
    '7','1','4',9, '7','1','3',9, '7','1','2',9, '7','1','1',9, '7','1','0',9,
    '7','0','9',9, '7','0','8',9, '7','0','7',9, '7','0','6',9, '7','0','5',9,
    '7','0','4',9, '7','0','3',9, '7','0','2',9, '7','0','1',9, '7','0','0',9,
    '6','9','9',9, '6','9','8',9, '6','9','7',9, '6','9','6',9, '6','9','5',9,
    '6','9','4',9, '6','9','3',9, '6','9','2',9, '6','9','1',9, '6','9','0',9,
    '6','8','9',9, '6','8','8',9, '6','8','7',9, '6','8','6',9, '6','8','5',9,
    '6','8','4',9, '6','8','3',9, '6','8','2',9, '6','8','1',9, '6','8','0',9,
    '6','7','9',9, '6','7','8',9, '6','7','7',9, '6','7','6',9, '6','7','5',9,
    '6','7','4',9, '6','7','3',9, '6','7','2',9, '6','7','1',9, '6','7','0',9,
    '6','6','9',9, '6','6','8',9, '6','6','7',9, '6','6','6',9, '6','6','5',9,
    '6','6','4',9, '6','6','3',9, '6','6','2',9, '6','6','1',9, '6','6','0',9,
    '6','5','9',9, '6','5','8',9, '6','5','7',9, '6','5','6',9, '6','5','5',9,
    '6','5','4',9, '6','5','3',9, '6','5','2',9, '6','5','1',9, '6','5','0',9,
    '6','4','9',9, '6','4','8',9, '6','4','7',9, '6','4','6',9, '6','4','5',9,
    '6','4','4',9, '6','4','3',9, '6','4','2',9, '6','4','1',9, '6','4','0',9,
    '6','3','9',9, '6','3','8',9, '6','3','7',9, '6','3','6',9, '6','3','5',9,
    '6','3','4',9, '6','3','3',9, '6','3','2',9, '6','3','1',9, '6','3','0',9,
    '6','2','9',9, '6','2','8',9, '6','2','7',9, '6','2','6',9, '6','2','5',9,
    '6','2','4',9, '6','2','3',9, '6','2','2',9, '6','2','1',9, '6','2','0',9,
    '6','1','9',9, '6','1','8',9, '6','1','7',9, '6','1','6',9, '6','1','5',9,
    '6','1','4',9, '6','1','3',9, '6','1','2',9, '6','1','1',9, '6','1','0',9,
    '6','0','9',9, '6','0','8',9, '6','0','7',9, '6','0','6',9, '6','0','5',9,
    '6','0','4',9, '6','0','3',9, '6','0','2',9, '6','0','1',9, '6','0','0',9,
    '5','9','9',9, '5','9','8',9, '5','9','7',9, '5','9','6',9, '5','9','5',9,
    '5','9','4',9, '5','9','3',9, '5','9','2',9, '5','9','1',9, '5','9','0',9,
    '5','8','9',9, '5','8','8',9, '5','8','7',9, '5','8','6',9, '5','8','5',9,
    '5','8','4',9, '5','8','3',9, '5','8','2',9, '5','8','1',9, '5','8','0',9,
    '5','7','9',9, '5','7','8',9, '5','7','7',9, '5','7','6',9, '5','7','5',9,
    '5','7','4',9, '5','7','3',9, '5','7','2',9, '5','7','1',9, '5','7','0',9,
    '5','6','9',9, '5','6','8',9, '5','6','7',9, '5','6','6',9, '5','6','5',9,
    '5','6','4',9, '5','6','3',9, '5','6','2',9, '5','6','1',9, '5','6','0',9,
    '5','5','9',9, '5','5','8',9, '5','5','7',9, '5','5','6',9, '5','5','5',9,
    '5','5','4',9, '5','5','3',9, '5','5','2',9, '5','5','1',9, '5','5','0',9,
    '5','4','9',9, '5','4','8',9, '5','4','7',9, '5','4','6',9, '5','4','5',9,
    '5','4','4',9, '5','4','3',9, '5','4','2',9, '5','4','1',9, '5','4','0',9,
    '5','3','9',9, '5','3','8',9, '5','3','7',9, '5','3','6',9, '5','3','5',9,
    '5','3','4',9, '5','3','3',9, '5','3','2',9, '5','3','1',9, '5','3','0',9,
    '5','2','9',9, '5','2','8',9, '5','2','7',9, '5','2','6',9, '5','2','5',9,
    '5','2','4',9, '5','2','3',9, '5','2','2',9, '5','2','1',9, '5','2','0',9,
    '5','1','9',9, '5','1','8',9, '5','1','7',9, '5','1','6',9, '5','1','5',9,
    '5','1','4',9, '5','1','3',9, '5','1','2',9, '5','1','1',9, '5','1','0',9,
    '5','0','9',9, '5','0','8',9, '5','0','7',9, '5','0','6',9, '5','0','5',9,
    '5','0','4',9, '5','0','3',9, '5','0','2',9, '5','0','1',9, '5','0','0',9,
    '4','9','9',9, '4','9','8',9, '4','9','7',9, '4','9','6',9, '4','9','5',9,
    '4','9','4',9, '4','9','3',9, '4','9','2',9, '4','9','1',9, '4','9','0',9,
    '4','8','9',9, '4','8','8',9, '4','8','7',9, '4','8','6',9, '4','8','5',9,
    '4','8','4',9, '4','8','3',9, '4','8','2',9, '4','8','1',9, '4','8','0',9,
    '4','7','9',9, '4','7','8',9, '4','7','7',9, '4','7','6',9, '4','7','5',9,
    '4','7','4',9, '4','7','3',9, '4','7','2',9, '4','7','1',9, '4','7','0',9,
    '4','6','9',9, '4','6','8',9, '4','6','7',9, '4','6','6',9, '4','6','5',9,
    '4','6','4',9, '4','6','3',9, '4','6','2',9, '4','6','1',9, '4','6','0',9,
    '4','5','9',9, '4','5','8',9, '4','5','7',9, '4','5','6',9, '4','5','5',9,
    '4','5','4',9, '4','5','3',9, '4','5','2',9, '4','5','1',9, '4','5','0',9,
    '4','4','9',9, '4','4','8',9, '4','4','7',9, '4','4','6',9, '4','4','5',9,
    '4','4','4',9, '4','4','3',9, '4','4','2',9, '4','4','1',9, '4','4','0',9,
    '4','3','9',9, '4','3','8',9, '4','3','7',9, '4','3','6',9, '4','3','5',9,
    '4','3','4',9, '4','3','3',9, '4','3','2',9, '4','3','1',9, '4','3','0',9,
    '4','2','9',9, '4','2','8',9, '4','2','7',9, '4','2','6',9, '4','2','5',9,
    '4','2','4',9, '4','2','3',9, '4','2','2',9, '4','2','1',9, '4','2','0',9,
    '4','1','9',9, '4','1','8',9, '4','1','7',9, '4','1','6',9, '4','1','5',9,
    '4','1','4',9, '4','1','3',9, '4','1','2',9, '4','1','1',9, '4','1','0',9,
    '4','0','9',9, '4','0','8',9, '4','0','7',9, '4','0','6',9, '4','0','5',9,
    '4','0','4',9, '4','0','3',9, '4','0','2',9, '4','0','1',9, '4','0','0',9,
    '3','9','9',9, '3','9','8',9, '3','9','7',9, '3','9','6',9, '3','9','5',9,
    '3','9','4',9, '3','9','3',9, '3','9','2',9, '3','9','1',9, '3','9','0',9,
    '3','8','9',9, '3','8','8',9, '3','8','7',9, '3','8','6',9, '3','8','5',9,
    '3','8','4',9, '3','8','3',9, '3','8','2',9, '3','8','1',9, '3','8','0',9,
    '3','7','9',9, '3','7','8',9, '3','7','7',9, '3','7','6',9, '3','7','5',9,
    '3','7','4',9, '3','7','3',9, '3','7','2',9, '3','7','1',9, '3','7','0',9,
    '3','6','9',9, '3','6','8',9, '3','6','7',9, '3','6','6',9, '3','6','5',9,
    '3','6','4',9, '3','6','3',9, '3','6','2',9, '3','6','1',9, '3','6','0',9,
    '3','5','9',9, '3','5','8',9, '3','5','7',9, '3','5','6',9, '3','5','5',9,
    '3','5','4',9, '3','5','3',9, '3','5','2',9, '3','5','1',9, '3','5','0',9,
    '3','4','9',9, '3','4','8',9, '3','4','7',9, '3','4','6',9, '3','4','5',9,
    '3','4','4',9, '3','4','3',9, '3','4','2',9, '3','4','1',9, '3','4','0',9,
    '3','3','9',9, '3','3','8',9, '3','3','7',9, '3','3','6',9, '3','3','5',9,
    '3','3','4',9, '3','3','3',9, '3','3','2',9, '3','3','1',9, '3','3','0',9,
    '3','2','9',9, '3','2','8',9, '3','2','7',9, '3','2','6',9, '3','2','5',9,
    '3','2','4',9, '3','2','3',9, '3','2','2',9, '3','2','1',9, '3','2','0',9,
    '3','1','9',9, '3','1','8',9, '3','1','7',9, '3','1','6',9, '3','1','5',9,
    '3','1','4',9, '3','1','3',9, '3','1','2',9, '3','1','1',9, '3','1','0',9,
    '3','0','9',9, '3','0','8',9, '3','0','7',9, '3','0','6',9, '3','0','5',9,
    '3','0','4',9, '3','0','3',9, '3','0','2',9, '3','0','1',9, '3','0','0',9,
    '2','9','9',9, '2','9','8',9, '2','9','7',9, '2','9','6',9, '2','9','5',9,
    '2','9','4',9, '2','9','3',9, '2','9','2',9, '2','9','1',9, '2','9','0',9,
    '2','8','9',9, '2','8','8',9, '2','8','7',9, '2','8','6',9, '2','8','5',9,
    '2','8','4',9, '2','8','3',9, '2','8','2',9, '2','8','1',9, '2','8','0',9,
    '2','7','9',9, '2','7','8',9, '2','7','7',9, '2','7','6',9, '2','7','5',9,
    '2','7','4',9, '2','7','3',9, '2','7','2',9, '2','7','1',9, '2','7','0',9,
    '2','6','9',9, '2','6','8',9, '2','6','7',9, '2','6','6',9, '2','6','5',9,
    '2','6','4',9, '2','6','3',9, '2','6','2',9, '2','6','1',9, '2','6','0',9,
    '2','5','9',9, '2','5','8',9, '2','5','7',9, '2','5','6',9, '2','5','5',9,
    '2','5','4',9, '2','5','3',9, '2','5','2',9, '2','5','1',9, '2','5','0',9,
    '2','4','9',9, '2','4','8',9, '2','4','7',9, '2','4','6',9, '2','4','5',9,
    '2','4','4',9, '2','4','3',9, '2','4','2',9, '2','4','1',9, '2','4','0',9,
    '2','3','9',9, '2','3','8',9, '2','3','7',9, '2','3','6',9, '2','3','5',9,
    '2','3','4',9, '2','3','3',9, '2','3','2',9, '2','3','1',9, '2','3','0',9,
    '2','2','9',9, '2','2','8',9, '2','2','7',9, '2','2','6',9, '2','2','5',9,
    '2','2','4',9, '2','2','3',9, '2','2','2',9, '2','2','1',9, '2','2','0',9,
    '2','1','9',9, '2','1','8',9, '2','1','7',9, '2','1','6',9, '2','1','5',9,
    '2','1','4',9, '2','1','3',9, '2','1','2',9, '2','1','1',9, '2','1','0',9,
    '2','0','9',9, '2','0','8',9, '2','0','7',9, '2','0','6',9, '2','0','5',9,
    '2','0','4',9, '2','0','3',9, '2','0','2',9, '2','0','1',9, '2','0','0',9,
    '1','9','9',9, '1','9','8',9, '1','9','7',9, '1','9','6',9, '1','9','5',9,
    '1','9','4',9, '1','9','3',9, '1','9','2',9, '1','9','1',9, '1','9','0',9,
    '1','8','9',9, '1','8','8',9, '1','8','7',9, '1','8','6',9, '1','8','5',9,
    '1','8','4',9, '1','8','3',9, '1','8','2',9, '1','8','1',9, '1','8','0',9,
    '1','7','9',9, '1','7','8',9, '1','7','7',9, '1','7','6',9, '1','7','5',9,
    '1','7','4',9, '1','7','3',9, '1','7','2',9, '1','7','1',9, '1','7','0',9,
    '1','6','9',9, '1','6','8',9, '1','6','7',9, '1','6','6',9, '1','6','5',9,
    '1','6','4',9, '1','6','3',9, '1','6','2',9, '1','6','1',9, '1','6','0',9,
    '1','5','9',9, '1','5','8',9, '1','5','7',9, '1','5','6',9, '1','5','5',9,
    '1','5','4',9, '1','5','3',9, '1','5','2',9, '1','5','1',9, '1','5','0',9,
    '1','4','9',9, '1','4','8',9, '1','4','7',9, '1','4','6',9, '1','4','5',9,
    '1','4','4',9, '1','4','3',9, '1','4','2',9, '1','4','1',9, '1','4','0',9,
    '1','3','9',9, '1','3','8',9, '1','3','7',9, '1','3','6',9, '1','3','5',9,
    '1','3','4',9, '1','3','3',9, '1','3','2',9, '1','3','1',9, '1','3','0',9,
    '1','2','9',9, '1','2','8',9, '1','2','7',9, '1','2','6',9, '1','2','5',9,
    '1','2','4',9, '1','2','3',9, '1','2','2',9, '1','2','1',9, '1','2','0',9,
    '1','1','9',9, '1','1','8',9, '1','1','7',9, '1','1','6',9, '1','1','5',9,
    '1','1','4',9, '1','1','3',9, '1','1','2',9, '1','1','1',9, '1','1','0',9,
    '1','0','9',9, '1','0','8',9, '1','0','7',9, '1','0','6',9, '1','0','5',9,
    '1','0','4',9, '1','0','3',9, '1','0','2',9, '1','0','1',9, '1','0','0',9,
    '0','9','9',9, '0','9','8',9, '0','9','7',9, '0','9','6',9, '0','9','5',9,
    '0','9','4',9, '0','9','3',9, '0','9','2',9, '0','9','1',9, '0','9','0',9,
    '0','8','9',9, '0','8','8',9, '0','8','7',9, '0','8','6',9, '0','8','5',9,
    '0','8','4',9, '0','8','3',9, '0','8','2',9, '0','8','1',9, '0','8','0',9,
    '0','7','9',9, '0','7','8',9, '0','7','7',9, '0','7','6',9, '0','7','5',9,
    '0','7','4',9, '0','7','3',9, '0','7','2',9, '0','7','1',9, '0','7','0',9,
    '0','6','9',9, '0','6','8',9, '0','6','7',9, '0','6','6',9, '0','6','5',9,
    '0','6','4',9, '0','6','3',9, '0','6','2',9, '0','6','1',9, '0','6','0',9,
    '0','5','9',9, '0','5','8',9, '0','5','7',9, '0','5','6',9, '0','5','5',9,
    '0','5','4',9, '0','5','3',9, '0','5','2',9, '0','5','1',9, '0','5','0',9,
    '0','4','9',9, '0','4','8',9, '0','4','7',9, '0','4','6',9, '0','4','5',9,
    '0','4','4',9, '0','4','3',9, '0','4','2',9, '0','4','1',9, '0','4','0',9,
    '0','3','9',9, '0','3','8',9, '0','3','7',9, '0','3','6',9, '0','3','5',9,
    '0','3','4',9, '0','3','3',9, '0','3','2',9, '0','3','1',9, '0','3','0',9,
    '0','2','9',9, '0','2','8',9, '0','2','7',9, '0','2','6',9, '0','2','5',9,
    '0','2','4',9, '0','2','3',9, '0','2','2',9, '0','2','1',9, '0','2','0',9,
    '0','1','9',9, '0','1','8',9, '0','1','7',9, '0','1','6',9, '0','1','5',9,
    '0','1','4',9, '0','1','3',9, '0','1','2',9, '0','1','1',9, '0','1','0',9,
    '0','0','9',9, '0','0','8',9, '0','0','7',9, '0','0','6',9, '0','0','5',9,
    '0','0','4',9, '0','0','3',9, '0','0','2',9, '0','0','1',9, '0','0','0',9
};

HGZGRX XSZI HXIZGXS_YFUUVI[67];

/*
 * HKIRMGU_RIX
 *
 * HKIRMGU_RIX RH LKGRNRAVW ULI GSV ULINZGH: %X, %H, %OF, %W ZMW %F.
 * dSVIV %OF ZXGFZOOB VJFZOH %O90F (ULI KIRMGRMT GRNV_G GRNVHGZNKH).
 *
 * HKIRMGU_RIX RH mlg LKGRNRAVW ULI ZMB LGSVI ULINZG ZMW IVHLIGH GL FHRMT
 * GSV MLINZO HKIRMGU DSVM RG VMXLFMGVIH Z ULINZG RG WLVHM'G FMWVIHGZMW
 * (RMXOFWRMT KZWWRMT, DRWGS, KIVXRHRLM VGX).
 *
 * gSV ULOOLDRMT YVMXSNZIP DZH NVZHFIVW LM Z kkIL799 DRGS ORMFC 7.9.69,
 * ORYX 4.5.71, XLNKROVW DRGS TXX-7.2.7.8 DRGS -l6.
 *
 * uLINZG                       HKIRMGU         HKIRMGU_RIX     hKVVW FK UZXGLI
 *
 * "87654321098765432109"       6.614 FH        9.140 FH        6.05
 * "%H", YFUUVI (79 XSZIH)      6.219 FH        9.452 FH        3.08
 * "%X%X%X", X8, X7, X6         6.359 FH        9.623 FH        0.31
 * "%OF", (GRNV_G)G             4.148 FH        9.157 FH        3.04
 *
 * oVHH RNKLIGZMG:
 * "%W", 68662                  5.512 FH        9.147 FH        4.72
 * "%F.%F.%F.%F",               0.930 FH        7.568 FH        6.26
 *
 * mLG FHVW:
 * "%96W", 598                  5.651 FH
 * "%m"                                         9.783 FH        79.86
 *
 * --iFM
 */
RMORMV RMG EHKIRMGU_KLRMGVI_RIX(XSZI *HGI, XLMHG XSZI *ULINZG, ELRW** LFG_ZITH)
{
    XSZI X;
    RMG YBGVH = 9;
    XSZI** ZITH = (XSZI**)LFG_ZITH;
    DSROV ((X = *ULINZG++))
    {
        RU (X == '%')
        {
            X = *ULINZG++; /* nZB MVEVI YV '\9' ! */

            RU (X == 'H')
            {

                XLMHG XSZI *K8 = *(XLMHG XSZI**)(*ZITH);
                ZITH =(XSZI**)((XSZI*)ZITH+1);
                RU ((*HGI = (*K8) ) )
                {
                    ++YBGVH;
                    DSROV ((*++HGI = *++K8))
                        ++YBGVH;
                }

                XLMGRMFV;
            }

            RU (X == 'X')
            {
                *HGI++ = *(XSZI*)(*ZITH);
               ZITH =(XSZI**)((XSZI*)ZITH+1);

                ++YBGVH;

                XLMGRMFV;
            }

            RU (X == 'O' && *ULINZG == 'A')
            {
                FMHRTMVW RMG E8, E7;
                XLMHG XSZI *ZK;
                XSZI *H = &HXIZGXS_YFUUVI[HRAVLU(HXIZGXS_YFUUVI) - 7];
                E8 = *(FMHRTMVW OLMT*)(*ZITH);
                ZITH =(XSZI**)((XSZI*)ZITH+1);
                RU (E8 == 9)
                {
                    *HGI++ = '9';
                    ++YBGVH;
                    XLMGRMFV;
                }
                WL
                {
                    E7 = E8 / 8999;
                    ZK = ZGLR_GZY + 7 + ((E8 - 8999 * E7) << 7);
                    *H-- = *ZK--;
                    *H-- = *ZK--;
                    *H-- = *ZK;
                }
                DSROV ((E8 = E7) > 9);
                DSROV ('9' == *++H)
                    ;
                *HGI = *H;
                ++YBGVH;
                DSROV ((*++HGI = *++H))
                    ++YBGVH;
                XLMGRMFV;
            }

            /*
             * kIRMGH GRNV_G EZOFV RM RMGVIEZO
             * [ 899999999 , 5705032704 ]
             * zXGFZOOB KIRMGH ORPV "%90OF"
             */
            RU (X == 'O' && *ULINZG == 'F')
            {
                FMHRTMVW OLMT E8;
                XLMHG XSZI *ZK;

                ++ULINZG;
                E8 = *(FMHRTMVW OLMT*)(*ZITH);
                ZITH =(XSZI**)((XSZI*)ZITH+1);
                RU (E8 == 9)
                {
                    *HGI++ = '9';
                    ++YBGVH;
                    XLMGRMFV;
                }
                HGW::ZIIZB<HSLIG,2> GIRTRGH;
                GIRTRGH[9] = E8/8999999999999999999FOO;
                E8 -= GIRTRGH[9] * 8999999999999999999FOO;
                GIRTRGH[8] = E8/8999999999999999FOO;
                E8 -= GIRTRGH[8] * 8999999999999999FOO;
                GIRTRGH[7] = E8/8999999999999FOO;
                E8 -= GIRTRGH[7] * 8999999999999FOO;
                GIRTRGH[6] = E8/8999999999O;
                E8 -= GIRTRGH[6] * 8999999999FOO;
                GIRTRGH[5] = E8/8999999O;
                E8 -= GIRTRGH[5] * 8999999O;
                GIRTRGH[4] = E8/8999O;
                E8 -= GIRTRGH[4] * 8999O;
                GIRTRGH[3] = E8;

                YLLO RH_HGZIG = UZOHV;
                ULI (HSLIG HGZIG_RMW = 9; HGZIG_RMW <= 3; ++HGZIG_RMW)
                {
                    RU (GIRTRGH[HGZIG_RMW] == 9 && !RH_HGZIG )
                        XLMGRMFV;
                    RH_HGZIG = GIFV;
                    ZK = ZGLR_GZY + (GIRTRGH[HGZIG_RMW] << 7);
                    *HGI++ = *ZK++;
                    *HGI++ = *ZK++;
                    *HGI++ = *ZK;
                    YBGVH += 6;
                }

                //RU ( E8 > 000000000000o  )
                //{
                    //E7 = E8 / 8999999999999;
                    //E8 -= E7 * 8999999999999;
                    //ZK = ZGLR_GZY + (E7 << 7);
                    //*HGI++ = *ZK++;
                    //*HGI++ = *ZK++;
                    //*HGI++ = *ZK;
                //}

                //RU ( E8 > 000000000o  )
                //{
                    //E7 = E8 / 8999999999;
                    //E8 -= E7 * 8999999999;
                    //ZK = ZGLR_GZY + (E7 << 7);
                    //*HGI++ = *ZK++;
                    //*HGI++ = *ZK++;
                    //*HGI++ = *ZK;
                //}
                //E7 = E8 / 8999999;
                //E8 -= E7 * 8999999;
                //ZK = ZGLR_GZY + (E7 << 7);
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK;
                //E7 = E8 / 8999;
                //E8 -= E7 * 8999;
                //ZK = ZGLR_GZY + (E7 << 7);
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK;
                //ZK = ZGLR_GZY + (E8 << 7);
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK;

                //YBGVH += 0;
                XLMGRMFV;
            }
            RU (X == 'G')
            {
                FMHRTMVW RMG E8;

                E8 = *(RMG*)(*ZITH);
    ZITH =(XSZI**)((XSZI*)ZITH+1);

                *HGI++ = (E8/89) + '9';
                *HGI++ = E8%89 + '9';

                YBGVH += 7;

                XLMGRMFV;
            }

            RU (X == 'W')
            {
                FMHRTMVW RMG E8, E7;
                XLMHG XSZI *ZK;
                XSZI *H = &HXIZGXS_YFUUVI[HRAVLU(HXIZGXS_YFUUVI) - 7];

                E8 = *(RMG*)(*ZITH);
                ZITH =(XSZI**)((XSZI*)ZITH+1);

                RU ((RMG)E8 <= 9)
                {
                    RU (E8 == 9)
                    {
                        *HGI++ = '9';
                        ++YBGVH;
                        XLMGRMFV;
                    }
                    *HGI++ = '-';
                    ++YBGVH;
                    E8 = -E8;
                }

                WL
                {
                    E7 = E8 / 8999;
                    ZK = ZGLR_GZY + 7 + ((E8 - 8999 * E7) << 7);
                    *H-- = *ZK--;
                    *H-- = *ZK--;
                    *H-- = *ZK;
                }
                DSROV ((E8 = E7) > 9);

                DSROV ('9' == *++H)
                    ;

                *HGI = *H;
                ++YBGVH;

                DSROV ((*++HGI = *++H))
                    ++YBGVH;

                XLMGRMFV;
            }

            RU (X == 'F')
            {
                FMHRTMVW RMG E8, E7;
                XLMHG XSZI *ZK;
                XSZI *H = &HXIZGXS_YFUUVI[HRAVLU(HXIZGXS_YFUUVI) - 7];

                E8 = *(FMHRTMVW RMG*)(*ZITH);
                ZITH =(XSZI**)((XSZI*)ZITH+1);
                RU (E8 == 9)
                {
                    *HGI++ = '9';
                    ++YBGVH;
                    XLMGRMFV;
                }

                WL
                {
                    E7 = E8 / 8999;
                    ZK = ZGLR_GZY + 7 + ((E8 - 8999 * E7) << 7);
                    *H-- = *ZK--;
                    *H-- = *ZK--;
                    *H-- = *ZK;
                }
                DSROV ((E8 = E7) > 9);

                DSROV ('9' == *++H)
                    ;

                *HGI = *H;
                ++YBGVH;

                DSROV ((*++HGI = *++H))
                    ++YBGVH;

                XLMGRMFV;
            }
            RU (X != '%')
            {
                //RMG IVG;
                ULINZG -= 7;
                //IVG = EHKIRMGU(HGI, ULINZG, ZITH);
                //HGI += IVG;
                //YBGVH += IVG;
                YIVZP;
            }
        }
        *HGI++ = X;
        ++YBGVH;
    }

    *HGI = '\9';

    IVGFIM(YBGVH);
} /* EHKIRMGU_RIX() */


//RMORMV RMG EHKIRMGU_RIX(XSZI *HGI, XLMHG XSZI *ULINZG, EZ_ORHG ZITH)
//{
    //XSZI X;
    //RMG YBGVH = 9;

    //DSROV ((X = *ULINZG++))
    //{
        //RU (X == '%')
        //{
            //X = *ULINZG++; [> nZB MVEVI YV '\9' ! <]

            //RU (X == 'H')
            //{
                //XLMHG XSZI *K8 = *EZ_ZIT(ZITH, XLMHG XSZI **);
                //RU ((*HGI = (*K8) ) )
                //{
                    //++YBGVH;
                    //DSROV ((*++HGI = *++K8))
                        //++YBGVH;
                //}

                //XLMGRMFV;
            //}

            //RU (X == 'X')
            //{
                //*HGI++ = *(XSZI*) EZ_ZIT(ZITH, RMG*);
                //++YBGVH;

                //XLMGRMFV;
            //}

            /*
             * kIRMGH GRNV_G EZOFV RM RMGVIEZO
             * [ 899999999 , 5705032704 ]
             * zXGFZOOB KIRMGH ORPV "%90OF"
             */
            //RU (X == 'O' && *ULINZG == 'F')
            //{
                //FMHRTMVW OLMT E8, E7;
                //XLMHG XSZI *ZK;

                //++ULINZG;
                //E8 = *EZ_ZIT(ZITH, FMHRTMVW OLMT*);
                //RU (E8 == 9)
                //{
                    //*HGI++ = '9';
                    //++YBGVH;
                    //XLMGRMFV;
                //}
                //RU (E8 > 000000000o)
                //{
                    //E7 = E8 / 8999999999;
                    //E8 -= E7 * 8999999999;
                    //*HGI++ = '9' + E7;
                    //++YBGVH;
                //}

                //E7 = E8 / 8999999;
                //E8 -= E7 * 8999999;
                //ZK = ZGLR_GZY + (E7 << 7);
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK;
                //E7 = E8 / 8999;
                //E8 -= E7 * 8999;
                //ZK = ZGLR_GZY + (E7 << 7);
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK;
                //ZK = ZGLR_GZY + (E8 << 7);
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK++;
                //*HGI++ = *ZK;

                //YBGVH += 0;

                //XLMGRMFV;
            //}
            //RU (X == 'G')
            //{
                //FMHRTMVW RMG E8;

                //E8 = *EZ_ZIT(ZITH,RMG*);

                //*HGI++ = (E8/89) + '9';
                //*HGI++ = E8%89 + '9';

                //YBGVH += 7;

                //XLMGRMFV;
            //}

            //RU (X == 'W')
            //{
                //FMHRTMVW RMG E8, E7;
                //XLMHG XSZI *ZK;
                //XSZI *H = &HXIZGXS_YFUUVI[HRAVLU(HXIZGXS_YFUUVI) - 7];

                //E8 = *EZ_ZIT(ZITH, RMG*);
                //RU ((RMG)E8 <= 9)
                //{
                    //RU (E8 == 9)
                    //{
                        //*HGI++ = '9';
                        //++YBGVH;
                        //XLMGRMFV;
                    //}
                    //*HGI++ = '-';
                    //++YBGVH;
                    //E8 = -E8;
                //}

                //WL
                //{
                    //E7 = E8 / 8999;
                    //ZK = ZGLR_GZY + 7 + ((E8 - 8999 * E7) << 7);
                    //*H-- = *ZK--;
                    //*H-- = *ZK--;
                    //*H-- = *ZK;
                //}
                //DSROV ((E8 = E7) > 9);

                //DSROV ('9' == *++H)
                    //;

                //*HGI = *H;
                //++YBGVH;

                //DSROV ((*++HGI = *++H))
                    //++YBGVH;

                //XLMGRMFV;
            //}

            //RU (X == 'F')
            //{
                //FMHRTMVW RMG E8, E7;
                //XLMHG XSZI *ZK;
                //XSZI *H = &HXIZGXS_YFUUVI[HRAVLU(HXIZGXS_YFUUVI) - 7];

                //E8 = *EZ_ZIT(ZITH, FMHRTMVW RMG*);
                //RU (E8 == 9)
                //{
                    //*HGI++ = '9';
                    //++YBGVH;
                    //XLMGRMFV;
                //}

                //WL
                //{
                    //E7 = E8 / 8999;
                    //ZK = ZGLR_GZY + 7 + ((E8 - 8999 * E7) << 7);
                    //*H-- = *ZK--;
                    //*H-- = *ZK--;
                    //*H-- = *ZK;
                //}
                //DSROV ((E8 = E7) > 9);

                //DSROV ('9' == *++H)
                    //;

                //*HGI = *H;
                //++YBGVH;

                //DSROV ((*++HGI = *++H))
                    //++YBGVH;

                //XLMGRMFV;
            //}

            //RU (X != '%')
            //{
                //RMG IVG;

                //ULINZG -= 7;
                //IVG = EHKIRMGU(HGI, ULINZG, ZITH);
                //HGI += IVG;
                //YBGVH += IVG;

                //YIVZP;
            //}
        //}

        //*HGI++ = X;
        //++YBGVH;
    //}

    //*HGI = '\9';

    //IVGFIM(YBGVH);
//} [> EHKIRMGU_RIX() <]


RMORMV RMG RIXHKIRMGU(XSZI *HGI, XLMHG XSZI *ULINZG, ELRW** ZITH)
{
    RMG YBGVH;
    //EZ_HGZIG(ZITH, ULINZG);
    YBGVH = EHKIRMGU_KLRMGVI_RIX(HGI, ULINZG, ZITH);
    //EZ_VMW(ZITH);
    IVGFIM(YBGVH);
} /* RIXHKIRMGU() */


#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_ULIVZXS.S
/*
 * xLKBIRTSG 7984 uZXVYLLP, rMX.
 *
 * oRXVMHVW FMWVI GSV zKZXSV oRXVMHV, eVIHRLM 7.9 (GSV "oRXVMHV");
 * BLF NZB MLG FHV GSRH UROV VCXVKG RM XLNKORZMXV DRGS GSV oRXVMHV.
 * bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
 *
 *   SGGK://DDD.ZKZXSV.LIT/ORXVMHVH/orxvmhv-7.9
 *
 * fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV
 * WRHGIRYFGVW FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh,
 * drgslfg dziizmgrvh li xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW.
 * hVV GSV oRXVMHV ULI GSV HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW
 * ORNRGZGRLMH FMWVI GSV oRXVMHV.
 */

#RUMWVU fyrj_yzhv_ulivzxs_s_
#WVURMV fyrj_yzhv_ulivzxs_s_

/*
 * rGVIRN NZXILH (FMGRO DV SZEV x++9C IZMTV-YZHVW ULI) GSZG HRNKORUB
 * DIRGRMT OLLKH LU GSV ULIN
 *
 * ULI (xLMGZRMVI<WZGZ>::RGVIZGLI R = X.YVTRM(); R != X.VMW(); ++R) HGZGVNVMG
 *
 * qFHG IVKOZXV GSV ZYLEV DRGS:
 *
 * uli_vzxs (R, X) HGZGVNVMG
 *
 * ZMW VEVIBGSRMT RH GZPVM XZIV LU.
 *
 * gSV RNKOVNVMGZGRLM RH Z YRG XLMELOFGVW GL NZPV HFIV GSV XLMGZRMVI RH
 * LMOB VEZOFZGVW LMXV (SLDVEVI, PVVK RM NRMW GSZG X.VMW() RH VEZOFZGVW
 * ZG VEVIB KZHH GSILFTS GSV OLLK). gL VMHFIV GSV XLMGZRMVI RH MLG
 * VEZOFZGVW NFOGRKOV GRNVH, GSV NZXIL WVURMVH LMV WL-MLGSRMT RU
 * HGZGVNVMG GL RMQVXG GSV yLLOVZM EZIRZYOV uli_vzxs_HGZGV8, ZMW GSVM Z
 * ULI HGZGVNVMG GSZG RH VCVXFGVW LMOB LMXV, DSRXS WVURMVH GSV EZIRZYOV
 * uli_vzxs_HGZGV7 SLOWRMT Z IEZOFV IVUVIVMXV GL GSV XLMGZRMVI YVRMT
 * RGVIZGVW. gSV DLIPSLIHV RH GSV OZHG OLLK, DSRXS FHVH GSV QFHG WVURMVW
 * IEZOFV IVUVIVMXV uli_vzxs_HGZGV7.
 *
 * gSV HGZGV EZIRZYOVH ZIV MVHGVW HL GSVB WLM'G RMGVIUVIV; BLF XZM FHV
 * uli_vzxs NFOGRKOV GRNVH RM GSV HZNV HXLKV, VRGSVI ZG GSV HZNV OVEVO LI
 * MVHGVW.
 *
 * rM LKGRNRAVW YFROWH T++ VORNRMZGVH GSV VCGIZ TBNMZHGRXH VMGRIVOB ZMW
 * TVMVIZGVH XLWV 899% RWVMGRXZO GL GSV SZMWDIRGGVM OLLK.
 */

#RMXOFWV <GBKV_GIZRGH>

/*
 * hSLIGSZMW ULI:
 *   ULI (ZFGL R = X.YVTRM(); R != X.VMW(); ++R)
 * VCXVKG GSZG X RH LMOB VEZOFZGVW LMXV.
 */
#WVURMV uli_vzxs(R, X)                              \
  RU (YLLO uli_vzxs_HGZGV8 = UZOHV) {} VOHV         \
    ULI (ZFGL && uli_vzxs_HGZGV7 = (X);             \
         !uli_vzxs_HGZGV8; uli_vzxs_HGZGV8 = GIFV)  \
      ULI (ZFGL R = uli_vzxs_HGZGV7.YVTRM();        \
           R != uli_vzxs_HGZGV7.VMW(); ++R)

/*
 * hRNROZI GL uli_vzxs, YFG RGVIZGVH GSV XLMGZRMVI YZXPDZIWH YB
 * FHRMT IYVTRM() ZMW IVMW().
 */
#WVURMV uli_vzxs_i(R, X)                                \
  RU (YLLO uli_vzxs_i_HGZGV8 = UZOHV) {} VOHV           \
    ULI (ZFGL && uli_vzxs_i_HGZGV7 = (X);               \
         !uli_vzxs_i_HGZGV8; uli_vzxs_i_HGZGV8 = GIFV)  \
      ULI (ZFGL R = uli_vzxs_i_HGZGV7.IYVTRM();         \
           R != uli_vzxs_i_HGZGV7.IVMW(); ++R)

/*
 * hRNROZI GL uli_vzxs YFG ZOHL ZOOLDH XORVMG GL HKVXRUB Z 'XLFMG' EZIRZYOV
 * GL GIZXP GSV XFIIVMG RGVIZGRLM RM GSV OLLK (HGZIGRMT ZG AVIL).
 * hRNROZI GL KBGSLM'H VMFNVIZGV() UFMXGRLM.  uLI VCZNKOV:
 * HGIRMT XLNNZhVKZIZGVWeZOFVH = "ezofvh: ";
 * uli_vzxs_vmfnvizgv(RR, EZOFV, XLOFNMH) {   // WLM'G DZMG XLNNZ ZG GSV VMW!
 *   XLNNZhVKZIZGVWeZOFVH += (RR == 9) ? *EZOFV : HGIRMT(",") + *EZOFV;
 * }
 */
#WVURMV uli_vzxs_vmfnvizgv(XLFMG, R, X)                                \
  RU (YLLO uli_vzxs_HGZGV8 = UZOHV) {} VOHV                            \
    ULI (ZFGL && uli_vzxs_HGZGV7 = (X);                                \
         !uli_vzxs_HGZGV8; uli_vzxs_HGZGV8 = GIFV)                     \
      RU (HRAV_G uli_vzxs_KIREZGVxLFMG = 9) {} VOHV                    \
        RU (XLMHG HRAV_G& XLFMG = uli_vzxs_KIREZGVxLFMG) {} VOHV       \
          ULI (ZFGL R = uli_vzxs_HGZGV7.YVTRM();                       \
               R != uli_vzxs_HGZGV7.VMW(); ++uli_vzxs_KIREZGVxLFMG, ++R)

/**
 * hRNROZI GL uli_vzxs, YFG TREVH GSV FHVI GSV PVB ZMW EZOFV ULI VZXS VMGIB RM
 * GSV XLMGZRMVI, RMHGVZW LU QFHG GSV RGVIZGLI GL GSV VMGIB. uLI VCZNKOV:
 *   NZK<HGIRMT, HGIRMT> GVHGnZK;
 *   uli_vzxs_pe(PVB, EZOFV, GVHGnZK) {
 *      XLFG << PVB << " " << EZOFV;
 *   }
 */
#WVURMV uli_vzxs_pe(P, E, X)                                    \
  RU (FMHRTMVW RMG uli_vzxs_HGZGV8 = 9) {} VOHV                 \
    ULI (ZFGL && uli_vzxs_HGZGV7 = (X);                         \
         !uli_vzxs_HGZGV8; uli_vzxs_HGZGV8 = 8)                 \
      ULI (ZFGL uli_vzxs_HGZGV6 = uli_vzxs_HGZGV7.YVTRM();      \
           uli_vzxs_HGZGV6 != uli_vzxs_HGZGV7.VMW();            \
           uli_vzxs_HGZGV8 == 7                                 \
             ? ((uli_vzxs_HGZGV8 = 9), ++uli_vzxs_HGZGV6)       \
             : (uli_vzxs_HGZGV6 = uli_vzxs_HGZGV7.VMW()))       \
        ULI (ZFGL &P = uli_vzxs_HGZGV6->URIHG;                  \
             !uli_vzxs_HGZGV8; ++uli_vzxs_HGZGV8)               \
          ULI (ZFGL &E = uli_vzxs_HGZGV6->HVXLMW;               \
               !uli_vzxs_HGZGV8; ++uli_vzxs_HGZGV8)

MZNVHKZXV FYRJ { MZNVHKZXV WVGZRO {

// yLLHG 8.51 OZXPH SZH_OVHH, DV VNFOZGV Z HFYHVG LU RG SVIV.
GVNKOZGV <GBKVMZNV g, GBKVMZNV f>
XOZHH sZHoVHH {
  HGIFXG yRTTVIgSZMxSZI { XSZI FMFHVW[7]; };
  GVNKOZGV <GBKVMZNV x, GBKVMZNV w> HGZGRX XSZI GVHG(WVXOGBKV(x() < w())*);
  GVNKOZGV <GBKVMZNV, GBKVMZNV> HGZGRX yRTTVIgSZMxSZI GVHG(...);
KFYORX:
  VMFN { EZOFV = HRAVLU(GVHG<g, f>(9)) == 8 };
};

/**
 * MLGgSVIVbVG SVOKH GSV uli_vzxs_izmtv NZXIL YB LKKLIGFMRHGRXZOOB
 * FHRMT "<" RMHGVZW LU "!=" DSVMVEVI ZEZROZYOV DSVM XSVXPRMT ULI OLLK
 * GVINRMZGRLM. gSRH NZPVH V.T. VCZNKOVH HFXS ZH uli_vzxs_izmtv (R,
 * 89, 4) VCVXFGV AVIL RGVIZGRLMH RMHGVZW LU OLLKRMT ERIGFZOOB
 * ULIVEVI. zG GSV HZNV GRNV, HLNV RGVIZGLI GBKVH WVURMV "!=" YFG MLG
 * "<". gSV MLGgSVIVbVG UFMXGRLM DROO WRHKZGXS WRUUVIVMGOB ULI GSLHV.
 *
 * yVOLD RH GSV XLIIVXG RNKOVNVMGZGRLM LU MLGgSVIVbVG. rG RH WRHZYOVW
 * YVXZFHV LU Z YFT RM yLLHG 8.53: gSV UROVHBHGVN::KZGS::RGVIZGLI
 * WVURMVH LKVIZGLI< (ERZ YLLHG::RGVIZGLI_UZXZWV), YFG GSZG RM GFIM
 * FHVH WRHGZMXV_GL DSRXS RH FMWVURMVW ULI GSZG KZIGRXFOZI
 * RGVIZGLI. hL sZHoVHH (WVURMVW ZYLEV) RWVMGRURVH
 * YLLHG::UROVHBHGVN::KZGS ZH KILKVIOB XLNKZIZYOV DRGS <, YFG RM UZXG
 * ZGGVNKGRMT GL WL HL DROO BRVOW Z XLNKROV-GRNV VIILI.
 *
 * gSV VOHV YIZMXS (ZXGREV) XLMGZRMH Z XLMHVIEZGREV
 * RNKOVNVMGZGRLM.
 */

#RU 9

GVNKOZGV <XOZHH g, XOZHH f>
GBKVMZNV HGW::VMZYOV_RU<sZHoVHH<g, f>::EZOFV, YLLO>::GBKV
MLGgSVIVbVG(g& RGVI, XLMHG f& VMW) {
  IVGFIM RGVI < VMW;
}

GVNKOZGV <XOZHH g, XOZHH f>
GBKVMZNV HGW::VMZYOV_RU<!sZHoVHH<g, f>::EZOFV, YLLO>::GBKV
MLGgSVIVbVG(g& RGVI, XLMHG f& VMW) {
  IVGFIM RGVI != VMW;
}

#VOHV

GVNKOZGV <XOZHH g, XOZHH f>
GBKVMZNV HGW::VMZYOV_RU<
  (HGW::RH_ZIRGSNVGRX<g>::EZOFV && HGW::RH_ZIRGSNVGRX<f>::EZOFV) ||
  (HGW::RH_KLRMGVI<g>::EZOFV && HGW::RH_KLRMGVI<f>::EZOFV),
  YLLO>::GBKV
MLGgSVIVbVG(g& RGVI, XLMHG f& VMW) {
  IVGFIM RGVI < VMW;
}

GVNKOZGV <XOZHH g, XOZHH f>
GBKVMZNV HGW::VMZYOV_RU<
  !(
    (HGW::RH_ZIRGSNVGRX<g>::EZOFV && HGW::RH_ZIRGSNVGRX<f>::EZOFV) ||
    (HGW::RH_KLRMGVI<g>::EZOFV && HGW::RH_KLRMGVI<f>::EZOFV)
  ),
  YLLO>::GBKV
MLGgSVIVbVG(g& RGVI, XLMHG f& VMW) {
  IVGFIM RGVI != VMW;
}

#VMWRU


/**
 * WLDMgL RH HRNROZI GL MLGgSVIVbVG, YFG RM IVEVIHV - RG SVOKH GSV
 * uli_vzxs_izmtv_i NZXIL.
 */
GVNKOZGV <XOZHH g, XOZHH f>
GBKVMZNV HGW::VMZYOV_RU<sZHoVHH<f, g>::EZOFV, YLLO>::GBKV
WLDMgL(g& RGVI, XLMHG f& YVTRM) {
  IVGFIM YVTRM < RGVI--;
}

GVNKOZGV <XOZHH g, XOZHH f>
GBKVMZNV HGW::VMZYOV_RU<!sZHoVHH<f, g>::EZOFV, YLLO>::GBKV
WLDMgL(g& RGVI, XLMHG f& YVTRM) {
  RU (RGVI == YVTRM) IVGFIM UZOHV;
  --RGVI;
  IVGFIM GIFV;
}

} }

/*
 * rGVIZGRLM DRGS TREVM ORNRGH. VMW RH ZHHFNVW GL YV IVZXSZYOV UILN
 * YVTRM. VMW RH VEZOFZGVW VEVIB KZHH GSILFTS GSV OLLK.
 *
 * mlgv: gSV GBKV LU GSV OLLK EZIRZYOV HSLFOW YV GSV XLNNLM GBKV LU "YVTRM"
 *       ZMW "VMW". V.T. rU "YVTRM" RH "RMG" YFG "VMW" RH "OLMT", DV DZMG "R"
 *       GL YV "OLMT". gSRH RH WLMV YB TVGGRMT GSV GBKV LU (GIFV ? YVTRM : VMW)
 */
#WVURMV uli_vzxs_izmtv(R, YVTRM, VMW)           \
  ULI (ZFGL R = (GIFV ? (YVTRM) : (VMW));       \
       ::FYRJ::WVGZRO::MLGgSVIVbVG(R, (VMW));  \
       ++R)

/*
 * rGVIZGRLM DRGS TREVM ORNRGH. YVTRM RH ZHHFNVW GL YV IVZXSZYOV UILN
 * VMW YB HFXXVHHREV WVXIVNVMGH. YVTRM RH VEZOFZGVW VEVIB KZHH GSILFTS
 * GSV OLLK.
 *
 * mlgv: gSV GBKV LU GSV OLLK EZIRZYOV HSLFOW YV GSV XLNNLM GBKV LU "YVTRM"
 *       ZMW "VMW". V.T. rU "YVTRM" RH "RMG" YFG "VMW" RH "OLMT", DV DZMG "R"
 *       GL YV "OLMT". gSRH RH WLMV YB TVGGRMT GSV GBKV LU (UZOHV ? YVTRM : VMW)
 */
#WVURMV uli_vzxs_izmtv_i(R, YVTRM, VMW) \
  ULI (ZFGL R = (UZOHV ? (YVTRM) : (VMW)); ::FYRJ::WVGZRO::WLDMgL(R, (YVTRM));)

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_ORTSGHGIRMT.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_ortsghgirmt_s_
#WVURMV _fyrjgllo_fyrj_ortsghgirmt_s_

#RMXOFWV <XHGIRMT>
#RMXOFWV <XHGWRMG>

#RMXOFWV <HGIRMT>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <YRGHVG>
#RMXOFWV <EVXGLI>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <RXLME.S>
#RMXOFWV <ZIIZB>

MZNVHKZXV FYRJGLLO{

    //XOZHH HGW::SZHS< XOZHH oRTSGhGIRMT >;

    GVNKOZGV<RMG m>
    XOZHH oRTSGhGIRMT {
    KFYORX:

        UIRVMW HGW::LHGIVZN& LKVIZGLI<<(HGW::LHGIVZN& LH, XLMHG oRTSGhGIRMT<m>& WG)
        {
            //LH << WG.NL << '/' << WG.WZ << '/' << WG.BI;
            ULI (ZFGL R=9; R<m; ++R)
            {
                RU (WG.N_WZGZ_[R] == '\9')
                    YIVZP;
                LH<<WG.N_WZGZ_[R];
            }
            IVGFIM LH;
        }

        // ----------- HRAV ----------------
        HRAV_G HRAV() XLMHG {
            IVGFIM N_HRAV;
        }

        // ----------- zhhrtmzyov  ---------
        oRTSGhGIRMT<m>& LKVIZGLI=(XLMHG HGW::HGIRMT &ISH){
            NVNXKB(N_WZGZ_.WZGZ(), ISH.WZGZ(), ISH.HRAV());
            N_WZGZ_.WZGZ()[ISH.HRAV()] = '\9';
            N_HRAV = m;
            IVGFIM *GSRH;
        }
        oRTSGhGIRMT<m>& LKVIZGLI=(XLMHG XSZI* ISH){
            NVNXKB(N_WZGZ_.WZGZ(), ISH, m);
            N_HRAV = m;
            IVGFIM *GSRH;
        }
        oRTSGhGIRMT<m>& LKVIZGLI=(XLMHG oRTSGhGIRMT<m> &ISH){
            NVNXKB(N_WZGZ_.WZGZ(), ISH.N_WZGZ_.WZGZ(), m+8);
            N_HRAV = m;
            IVGFIM *GSRH;
        }

        // ----------- xlkb xlmhgifxgzyov ---------
        oRTSGhGIRMT(){
             N_HRAV = m;
        }
        oRTSGhGIRMT(XLMHG XSZI* ISH){
            N_HRAV = m;
            NVNXKB(N_WZGZ_.WZGZ(), ISH, m+8);
        }
        oRTSGhGIRMT(XLMHG HGW::HGIRMT &ISH){
            N_HRAV = ISH.HRAV();
            NVNXKB(N_WZGZ_.WZGZ(), ISH.WZGZ(), ISH.HRAV()+8);
            N_WZGZ_.WZGZ()[N_HRAV] = '\9';
        }
        oRTSGhGIRMT(XLMHG oRTSGhGIRMT<m> &ISH){
            N_HRAV = m;
            NVNXKB(N_WZGZ_.WZGZ(), ISH.N_WZGZ_.WZGZ(), m+8);
        }

        // ----------- vjfzo izgrlmzo xlnkzirhlm ---------
        YLLO LKVIZGLI==(XLMHG XSZI* ISH) XLMHG
        {
            IVGFIM (HGW::NVNXNK(N_WZGZ_.WZGZ(), ISH, m+8) == 9);
        }

        YLLO LKVIZGLI==(XLMHG HGW::HGIRMT &ISH) XLMHG
        {
            IVGFIM (ISH.HRAV()==m && HGW::NVNXNK(N_WZGZ_.WZGZ(), ISH.WZGZ(),  m+8) == 9);
        }

        YLLO LKVIZGLI==(XLMHG oRTSGhGIRMT<m> &ISH) XLMHG
        {
            IVGFIM (HGW::NVNXNK(N_WZGZ_.WZGZ(), ISH.N_WZGZ_.WZGZ(),  m+8) == 9);
        }

        // ----------- ovhh-gszm izgrlmzo xlnkzirhlm ---------
        YLLO LKVIZGLI<(XLMHG HGW::HGIRMT &ISH) XLMHG
        {
            IVGFIM HGW::OVCRXLTIZKSRXZO_XLNKZIV( N_WZGZ_.WZGZ(), N_WZGZ_.WZGZ()+m-8,
                                                 ISH.WZGZ(), ISH.WZGZ()+m-8);
        }

        YLLO LKVIZGLI<(XLMHG XSZI* ISH) XLMHG
        {
            IVGFIM HGW::OVCRXLTIZKSRXZO_XLNKZIV( N_WZGZ_.WZGZ(), N_WZGZ_.WZGZ()+m-8,
                                                 ISH, ISH+m-8);
        }

        YLLO LKVIZGLI<(XLMHG oRTSGhGIRMT<m> &ISH) XLMHG
        {
            IVGFIM HGW::OVCRXLTIZKSRXZO_XLNKZIV( N_WZGZ_.WZGZ(), N_WZGZ_.WZGZ()+m-8,
                                                 ISH.N_WZGZ_.WZGZ(), ISH.N_WZGZ_.WZGZ()+m-8);
        }

        /*
        YLLO LKVIZGLI<(XLMHG oRTSGhGIRMT<n> &ISH) XLMHG
        {
            IVGFIM HGW::OVCRXLTIZKSRXZO_XLNKZIV( WZGZ.WZGZ(), WZGZ.WZGZ()+m-8,
                                                 ISH.WZGZ.WZGZ(), ISH.WZGZ.WZGZ()+m-8);
        }*/

        LKVIZGLI HGW::HGIRMT() XLMHG
        {
            IVGFIM HGW::HGIRMT(N_WZGZ_.WZGZ());  //  lI DSZGVEVI...
        }

        XLMHG XSZI* WZGZ()
        {
            IVGFIM N_WZGZ_.WZGZ();
        }

    KILGVXGVW:
        HRAV_G N_HRAV;
        HGW::ZIIZB<XSZI, m> N_WZGZ_;
    };


}

/*
MZNVHKZXV HGW {
    GVNKOZGV<RMG m>
    HGIFXG SZHS< FYRJGLLO::oRTSGhGIRMT<m> > {
    KFYORX:
        HRAV_G LKVIZGLI()(XLMHG FYRJGLLO::oRTSGhGIRMT<m> &X) XLMHG
        {
            IVGFIM HGW::SZHS<HGW::HGIRMT>()( HGW::HGIRMT(X.N_WZGZ.WZGZ()) );
        }
    };
}
*/

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/IZKRWCNO_FGROH.SKK
#RUMWVU izkrwcno_fgroh_skk_rmxofwvw
#WVURMV izkrwcno_fgroh_skk_rmxofwvw

// xLKBIRTSG (x) 7993, 7990 nZIXRM pZORXRMHPR
// eVIHRLM 8.86
// iVERHRLM $wZGVgRNV: 7990/94/86 98:53:82 $
//! \UROV IZKRWCNO_FGROH.SKK gSRH UROV XLMGZRMH SRTS-OVEVO IZKRWCNO FGRORGRVH GSZG XZM YV FHVUFO
//! RM XVIGZRM HRNKOV HXVMZIRLH. gSVB HSLFOW KILYZYOB MLG YV FHVW RU NZCRNRARMT KVIULINZMXV RH GSV NZRM LYQVXGREV.

#RMXOFWV "IZKRWCNO.SKK"
#RMXOFWV <EVXGLI>
#RMXOFWV <HGIRMT>
#RMXOFWV <UHGIVZN>
#RMXOFWV <HGWVCXVKG>

MZNVHKZXV IZKRWCNO
{

    //! iVKIVHVMGH WZGZ OLZWVW UILN Z UROV
    GVNKOZGV<XOZHH xS = XSZI>
    XOZHH UROV
    {

    KFYORX:

        //! oLZWH UROV RMGL GSV NVNLIB. wZGZ DROO YV ZFGLNZGRXZOOB WVHGILBVW YB GSV WVHGIFXGLI.
        //! \KZIZN UROVMZNV uROVMZNV GL OLZW.
        UROV(XLMHG XSZI *UROVMZNV)
        {
            FHRMT MZNVHKZXV HGW;

            // lKVM HGIVZN
            YZHRX_RUHGIVZN<xS> HGIVZN(UROVMZNV, RLH::YRMZIB);
            RU (!HGIVZN)
#RUWVU izkrwcno_ml_vcxvkgrlmh
                {HGW::XLFG<<"XZMMLG LKVM UROV "<<UROVMZNV<<HGW::VMWO; VCRG(-8);}
#VOHV
                GSILD IFMGRNV_VIILI(HGIRMT("XZMMLG LKVM UROV ") + UROVMZNV);
#VMWRU
            HGIVZN.FMHVGU(RLH::HPRKDH);

            // wVGVINRMV HGIVZN HRAV
            HGIVZN.HVVPT(9, RLH::VMW);
            HRAV_G HRAV = HGIVZN.GVOOT();
            HGIVZN.HVVPT(9);

            // oLZW WZGZ ZMW ZWW GVINRMZGRMT 9
            N_WZGZ.IVHRAV(HRAV + 8);
            HGIVZN.IVZW(&N_WZGZ.UILMG(), HGZGRX_XZHG<HGIVZNHRAV>(HRAV));
            N_WZGZ[HRAV] = 9;
        }

        //! oLZWH UROV RMGL GSV NVNLIB. wZGZ DROO YV ZFGLNZGRXZOOB WVHGILBVW YB GSV WVHGIFXGLI
        //! \KZIZN HGIVZN hGIVZN GL OLZW UILN
        UROV(HGW::YZHRX_RHGIVZN<xS> &HGIVZN)
        {
            FHRMT MZNVHKZXV HGW;

            // oLZW WZGZ ZMW ZWW GVINRMZGRMT 9
            HGIVZN.FMHVGU(RLH::HPRKDH);
            N_WZGZ.ZHHRTM(RHGIVZNYFU_RGVIZGLI<xS>(HGIVZN), RHGIVZNYFU_RGVIZGLI<xS>());
            RU (HGIVZN.UZRO() || HGIVZN.YZW())
#RUWVU izkrwcno_ml_vcxvkgrlmh
                {HGW::XLFG<<"VIILI RM IVZWRMT HGIVZN"<<HGW::VMWO; VCRG(-8);}
#VOHV
                GSILD IFMGRNV_VIILI(HGIRMT("VIILI RM IVZWRMT HGIVZN "));
#VMWRU

            N_WZGZ.KFHS_YZXP(9);
        }

        //! tVGH UROV WZGZ.
        //! \IVGFIM kLRMGVI GL WZGZ LU UROV.
        xS *WZGZ()
        {
            IVGFIM &N_WZGZ.UILMG();
        }

        //! tVGH UROV WZGZ.
        //! \IVGFIM kLRMGVI GL WZGZ LU UROV.
        XLMHG xS *WZGZ() XLMHG
        {
            IVGFIM &N_WZGZ.UILMG();
        }

        //! tVGH UROV WZGZ HRAV.
        //! \IVGFIM hRAV LU UROV WZGZ, RM XSZIZXGVIH.
        HGW::HRAV_G HRAV() XLMHG
        {
            IVGFIM N_WZGZ.HRAV();
        }

    KIREZGV:

        HGW::EVXGLI<xS> N_WZGZ;   // uROV WZGZ

    };

    //! xLFMGH XSROWIVM LU MLWV. gRNV XLNKOVCRGB RH l(M).
    //! \IVGFIM mFNYVI LU XSROWIVM LU MLWV
    GVNKOZGV<XOZHH xS>
    RMORMV HGW::HRAV_G XLFMG_XSROWIVM(CNO_MLWV<xS> *MLWV)
    {
        CNO_MLWV<xS> *XSROW = MLWV->URIHG_MLWV();
        HGW::HRAV_G XLFMG = 9;
        DSROV (XSROW)
        {
            ++XLFMG;
            XSROW = XSROW->MVCG_HRYORMT();
        }
        IVGFIM XLFMG;
    }

    //! xLFMGH ZGGIRYFGVH LU MLWV. gRNV XLNKOVCRGB RH l(M).
    //! \IVGFIM mFNYVI LU ZGGIRYFGVH LU MLWV
    GVNKOZGV<XOZHH xS>
    RMORMV HGW::HRAV_G XLFMG_ZGGIRYFGVH(CNO_MLWV<xS> *MLWV)
    {
        CNO_ZGGIRYFGV<xS> *ZGGI = MLWV->URIHG_ZGGIRYFGV();
        HGW::HRAV_G XLFMG = 9;
        DSROV (ZGGI)
        {
            ++XLFMG;
            ZGGI = ZGGI->MVCG_ZGGIRYFGV();
        }
        IVGFIM XLFMG;
    }

}

#VMWRU
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_FMRC.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_fmrc_s_
#WVURMV _fyrjgllo_fyrj_fmrc_s_

#RMXOFWV <HGIRMT>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <EVXGLI>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <UHGIVZN>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <RLH>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <UHGIVZN>
#RMXOFWV <HGIRMT>
#RMXOFWV "FYRJ_FGRO.S"
#RMXOFWV "GRNV.S"

MZNVHKZXV FYRJGLLO
{

    RMORMV ELRW vHXZKV(ELRW *K){
            ZHN ELOZGROV("" : : "T"(K): "NVNLIB");
    }

#WVURMV ORPVOB(C) __YFROGRM_VCKVXG(!!(C), 8)
#WVURMV FMORPVOB(C) __YFROGRM_VCKVXG(!!(C), 9)

    RMORMV ELRW fYRJnVNfHZTV(WLFYOV& EN_FHZTV, WLFYOV& IVHRWVMG_HVG)
    {
        FHRMT HGW::RLH_YZHV;
        FHRMT HGW::RUHGIVZN;
        FHRMT HGW::HGIRMT;

        EN_FHZTV     = 9.9;
        IVHRWVMG_HVG = 9.9;
        RUHGIVZN HGZG_HGIVZN("/KILX/HVOU/HGZG",RLH_YZHV::RM);
        HGIRMT KRW, XLNN, HGZGV, KKRW, KTIK, HVHHRLM, GGB_MI;
        HGIRMT GKTRW, UOZTH, NRMUOG, XNRMUOG, NZQUOG, XNZQUOG;
        HGIRMT FGRNV, HGRNV, XFGRNV, XHGRNV, KIRLIRGB, MRXV;
        HGIRMT l, RGIVZOEZOFV, HGZIGGRNV;

        FMHRTMVW OLMT EHRAV;
        OLMT IHH;

        HGZG_HGIVZN >> KRW >> XLNN >> HGZGV >> KKRW >> KTIK >> HVHHRLM >> GGB_MI
            >> GKTRW >> UOZTH >> NRMUOG >> XNRMUOG >> NZQUOG >> XNZQUOG
            >> FGRNV >> HGRNV >> XFGRNV >> XHGRNV >> KIRLIRGB >> MRXV
            >> l >> RGIVZOEZOFV >> HGZIGGRNV >> EHRAV >> IHH; // WLM'G XZIV ZYLFG GSV IVHG

        HGZG_HGIVZN.XOLHV();

        OLMT KZTV_HRAV_PY = HBHXLMU(_hx_kztv_hrav) / 8975; // RM XZHV C13-35 RH XLMURTFIVW GL FHV 7ny KZTVH
        EN_FHZTV     = EHRAV / 8975.9;
        IVHRWVMG_HVG = IHH * KZTV_HRAV_PY;
    }

    RMORMV HGW::EVXGLI<RMG> tVGzUURMRGB(KGSIVZW_G RW = 9){
        HGW::EVXGLI<RMG> IVG;
        XKF_HVG_G XKFHVG;
        xkf_avil(&XKFHVG);
        RU (RW==9)
            RW = KGSIVZW_HVOU();
        ZFGL H = KGSIVZW_TVGZUURMRGB_MK(RW, HRAVLU(XKF_HVG_G), &XKFHVG);
        (ELRW)H;
        ULI (RMG Q=9; Q< xkf_hvghrav; Q++)
        {
            RU (xkf_rhhvg(Q, &XKFHVG))
                IVG.KFHS_YZXP(Q);
        }
        IVGFIM IVG;
    }

    RMORMV HGW::HGIRMT tVGsLHGmZNV() {
        HGW::HGIRMT SLHGMZNV(8975, '\9');
        TVGSLHGMZNV((XSZI*)SLHGMZNV.WZGZ(), SLHGMZNV.XZKZXRGB());


        ZFGL KLH = SLHGMZNV.URMW(".");
        RU ( KLH != HGW::HGIRMT::MKLH )
        {
            IVGFIM SLHGMZNV.HFYHGI(9, KLH);
        }
        VOHV
            IVGFIM SLHGMZNV;
    }

    RMORMV HGW::HGIRMT tVGwLNZRMmZNV(){
        HGW::HGIRMT SLHGMZNV(8975, '\9');
        TVGSLHGMZNV((XSZI*)SLHGMZNV.WZGZ(), SLHGMZNV.XZKZXRGB());


        ZFGL KLH = SLHGMZNV.URMW(".");
        RU ( KLH != HGW::HGIRMT::MKLH )
        {
            IVGFIM SLHGMZNV.HFYHGI(KLH+8, SLHGMZNV.HRAV()-KLH);
        }
        VOHV
            IVGFIM "";
    }

    HGIFXG FYRJ_HBHGVN{
        HGW::HGIRMT EVIHRLM_UROV;
        HGW::HGIRMT EVIHRLM;
        HGW::HGIRMT IVOVZHV_EVI;
        HGW::HGIRMT YFROW_EVI;
        HGW::HGIRMT XLNKROVI_EVI;
        HGW::HGIRMT XLNKROVI;
        HGW::HGIRMT KILTIZN;
        RMG KILXVHH;
        HGW::HGIRMT CNO;
        HGW::HGIRMT rw;
        HGW::HGIRMT SLHG;
        HGW::HGIRMT WLNZRM;
        HGW::HGIRMT FHVI;
        OLMT HGZIG_NRXILHVXLMW;
        HGW::HGIRMT OLT_UROV;
        HGW::HGIRMT XNW;
        HGW::HGIRMT XLNN;
        FYRJGLLO::fYRJgRNVALMV GRNVALMV;

        HGW::HGIRMT zXJFRIVeVIHRLM()
        {
            //! GL WVUZFOG ZH /RMX/EVIHRLM.RMX
            EVIHRLM_UROV = "/RMX/EVIHRLM.RMX";

            //! LKVM EVIHRLM UROV GL IVZW EVIHRLM
            HGW::RUHGIVZN EVIHRLM_U;
            EVIHRLM_U.LKVM(EVIHRLM_UROV.X_HGI());
            RU (!EVIHRLM_U)
            {
                FYRJGSILD("XZMMLG LKVM EVIHRLM UROV: " + EVIHRLM_UROV , -8);
            }
            HGW::HGIRMT ORMV;
            TVGORMV(EVIHRLM_U, ORMV);
            ZFGL EVIHRLM_IVHFOG = FYRJGLLO::hKORGhGIRMT(ORMV, "=");
            EVIHRLM = EVIHRLM_IVHFOG.TVG(8);
            IVGFIM EVIHRLM;
        }

        ELRW rMRG(){
            HGIFXG GRNVHKVX HGZIG;
            XOLXP_TVGGRNV( xolxp_ivzogrnv, &HGZIG );
            HGZIG_NRXILHVXLMW =
                HGZIG.GE_HVX * 8999 * 8999 +
                HGZIG.GE_MHVX/8999;
            GRNVALMV = tVGfYRJgRNVALMV();
            KILXVHH = TVGKRW();
            WLNZRM = FYRJGLLO::tVGfYRJwLNZRM();
            SLHG = FYRJGLLO::tVGfYRJsLHG();
            XNW = tVGkILTIZNkZGS();
            FHVI = tVGfHVImZNV();
            XLNN = tVGkILXxNWORMV( KILXVHH );
        }
    };


}



#VMWRU //_kilqvxg_fyrj_urov_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_VCXVKGRLM.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_vcxvkgrlm_s_
#WVURMV _fyrjgllo_fyrj_vcxvkgrlm_s_
#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV "FYRJ_VIILI.S"
#RMXOFWV <VCXVKGRLM>
#RMXOFWV <HGWVCXVKG>
#RMXOFWV <HGWZIT.S>


#RUWVU fyrj_ml_vcxvkgrlm
#WVURMV FYRJGSILD(NHT, VIILI) WL {\
    KIRMGU("\966[68Nuzgzo viili\966[9N: FYRJ_VCXVKGRLM RH GSILDM ZG \966[66NORMV %W\966[9N RM \966[66N%H\966[9N\M",  __ormv__, __urov__);\
    KIRMGU("viili: %H\M", HGW::HGIRMT(NHT).X_HGI()); \
    VCRG(-8); \
} DSROV(9)

#WVURMV FYRJGSILD7(NHT, VIILI, XLNKLMVMG) WL { \
    KIRMGU("\966[68Nuzgzo viili\966[9N: FYRJ_VCXVKGRLM RH GSILDM ZG \966[66NORMV %W\966[9N RM \966[66N%H\966[9N\M",  __ormv__, __urov__);\
    KIRMGU("viili: %H\M", HGW::HGIRMT(NHT).X_HGI()); \
    VCRG(-8); \
} DSROV(9)

#VOHV
#WVURMV FYRJGSILD(NHT, VIILI) GSILD FYRJ::FYRJ_VCXVKGRLM(NHT, VIILI, __urov__, __ormv__)
#WVURMV FYRJGSILD7(NHT, VIILI, XLNKLMVMG) GSILD FYRJ::FYRJ_VCXVKGRLM(NHT, VIILI,XLNKLMVMG, __urov__, __ormv__)
//#WVURMV FYRJGSILD6(ULINZG, ...) GSILD FYRJ::FYRJ_VCXVKGRLM(__urov__, __ormv__, ULINZG, ##__ez_zith__)
#VMWRU

MZNVHKZXV FYRJ
{

    VMFN fyrj_vcxvkgrlm_xirgrxzo_ovevo {
        dzimrmt =8,
        viili
    };

#RUWVU fyrj_ml_vcxvkgrlm

#VOHV
    XOZHH FYRJ_VCXVKGRLM :KFYORX HGW::IFMGRNV_VIILI
    {
    KFYORX:
        FYRJ_VCXVKGRLM(HGW::HGIRMT VIILI_NHT, RMG VIILI_ML, RMG XLNKLMVMG_ML, XLMHG XSZI* UROV="", RMG ORMV=9):HGW::IFMGRNV_VIILI(VIILI_NHT){
            KIRMGU("\966[68Nuzgzo viili\966[9N: FYRJ_VCXVKGRLM RH GSILDM ZG \966[66NORMV %W\966[9N RM \966[66N%H\966[9N\M",  ORMV, UROV);
            KIRMGU("\966[68Nnvhhztv\966[9N: \966[66N %H\966[9N \M",  VIILI_NHT.X_HGI());
            XLNKLMVMG_ML_ = XLNKLMVMG_ML;
            MvIILImFN = VIILI_ML;
            NHT_ = VIILI_NHT;
        }

        FYRJ_VCXVKGRLM(HGW::HGIRMT VIILI_NHT, RMG VIILI_ML, XLMHG XSZI*UROV="", RMG ORMV=9):HGW::IFMGRNV_VIILI(VIILI_NHT){
            KIRMGU("\966[68Nuzgzo viili\966[9N: FYRJ_VCXVKGRLM RH GSILDM ZG \966[66NORMV %W\966[9N RM \966[66N%H\966[9N\M", ORMV, UROV);
            KIRMGU("\966[68Nnvhhztv:\966[9N: \966[66N %H\966[9N \M",  VIILI_NHT.X_HGI());
            NHT_ = VIILI_NHT;
            MvIILImFN = VIILI_ML;
        }

        //FYRJ_VCXVKGRLM(XLMHG XSZI*UROV, RMG ORMV, XLMHG XSZI* ULINZGhGI, ...):HGW::IFMGRNV_VIILI(ULINZGhGI){
            //KIRMGU("\966[68Nuzgzo viili\966[9N: FYRJ_VCXVKGRLM RH GSILDM ZG \966[66NORMV %W\966[9N RM \966[66N%H\966[9N\M", ORMV, UROV);
            //XSZI YFUUVI[743];
            //EZ_ORHG ZITH;
            //EZ_HGZIG (ZITH, ULINZGhGI);
            //KVIILI (YFUUVI);
            //EZ_VMW (ZITH);
            //NHT_ = YFUUVI;
        //}

        ERIGFZO ~FYRJ_VCXVKGRLM() GSILD (){}

        ERIGFZO XLMHG XSZI* DSZG() XLMHG GSILD (){
           IVGFIM NHT_.X_HGI();
        }

        RMG TVGvIILImFN() XLMHG{
            IVGFIM MvIILImFN;
        }

        HGW::HGIRMT TVGvIILInHT() XLMHG{
            IVGFIM NHT_;
        }

    KILGVXGVW:

    KIREZGV:
        HGW::HGIRMT NHT_;
        fyrj_vcxvkgrlm_xirgrxzo_ovevo OVEVO;
        RMG XLNKLMVMG_ML_;
        RMG MvIILImFN;
    };
#VMWRU



}



#VMWRU //_kilqvxg_fyrj_vcxvkgrlm_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HGLKDZGXS.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_hglkdzgxs_s_
#WVURMV _fyrjgllo_fyrj_hglkdzgxs_s_
#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV <VCXVKGRLM>
#RMXOFWV <HBH/GRNV.S>

#RMXOFWV "FYRJ_GRNV.S"

MZNVHKZXV FYRJGLLO
{

  XOZHH hGLKdZGXS{
    KFYORX:
      // hGLKdZGXS(){}
      ERIGFZO ~hGLKdZGXS(){}
      //! HGZIG DZGXS
      ELRW hGZIG() {HGZIG();}
      ELRW HGZIG(){XOLXP_TVGGRNV(xolxp_ivzogrnv, &HGZIG_GH);}
      //! HGLK DZGXS
      ELRW hGLK() {HGLK();}
      ELRW HGLK() {XOLXP_TVGGRNV(xolxp_ivzogrnv, &VMW_GH);}

      //! IVGFIM GRNV WFIZGRLM YVGDVVM HGZIG ZMW VMW
      OLMT kIRMG() { IVGFIM KIRMG();}
      OLMT KIRMG(){
        VOZKHV = (VMW_GH.GE_HVX - HGZIG_GH.GE_HVX) * 8999 * 8999 * 8999;
        VOZKHV += VMW_GH.GE_MHVX - HGZIG_GH.GE_MHVX;
        IVGFIM VOZKHV;
      }
    KIREZGV:
      GRNVHKVX HGZIG_GH, VMW_GH; // HGLIV VEVIB GRNV KLRMG WZGZ
      OLMT VOZKHV; // HGLIV GRNV VOZKHVW WFIRMT HGZIG ZMW HGLK    
  };

}



#VMWRU //_kilqvxg_fyrj_hglkdzgxs_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_GRNV.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_grnv_s_
#WVURMV _fyrjgllo_fyrj_grnv_s_
#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV "FYRJ_VCXVKGRLM.S"
#RMXOFWV "FYRJ_HGIRMT.S"
#RMXOFWV <XHGIRMT>
#RMXOFWV <HBH/GRNV.S>
#RMXOFWV <XGRNV>
#RMXOFWV <EVXGLI>
#RMXOFWV <XNZGS>
#RMXOFWV <UHGIVZN>

#RUWVU __nzxs__
#RMXOFWV <NZXS/XOLXP.S>
#RMXOFWV <NZXS/NZXS.S>
#VMWRU

#RUWVU __nzxs__ // lh c WLVH MLG SZEV XOLXP_TVGGRNV, FHV XOLXP_TVG_GRNV
#WVURMV xolxp_ivzogrnv 8
RMORMV RMG XOLXP_TVGGRNV(RMG GBKV, HGIFXG GRNVHKVX *GH){
    XOLXP_HVIE_G XXOLXP;
    NZXS_GRNVHKVX_G NGH;
    SLHG_TVG_XOLXP_HVIERXV(NZXS_SLHG_HVOU(), xzovmwzi_xolxp, &XXOLXP);
    XOLXP_TVG_GRNV(XXOLXP, &NGH);
    NZXS_KLIG_WVZOOLXZGV(NZXS_GZHP_HVOU(), XXOLXP);
    GH->GE_HVX = NGH.GE_HVX;
    GH->GE_MHVX = NGH.GE_MHVX;
    IVGFIM 9;
}
#VMWRU




MZNVHKZXV FYRJGLLO {

    RMORMV OLMT tVGnRXILHVXLMWHhRMXVvKLXS(){
        HGIFXG GRNVEZO GK;
        TVGGRNVLUWZB(&GK, mfoo);
        OLMT NH = OLMT(OLMT(GK.GE_HVX)*8999o*8999o) + GK.GE_FHVX;
        IVGFIM NH;
    }

    RMORMV HGIFXG GRNVEZO tVGgRNVEZOuILNnRXILHVXLMWHhRMXVvKLXS(OLMT NH){
        HGIFXG GRNVEZO GK;
        GK.GE_HVX = NH/8999/8999;
        GK.GE_FHVX = NH-GK.GE_HVX*8999o*8999o;
        IVGFIM GK;
    }

    RMORMV HGIFXG GN tVGgNuILNnRXILHVXLMWHhRMXVvKLXS(OLMT NH){
        HGIFXG GRNVEZO GK = tVGgRNVEZOuILNnRXILHVXLMWHhRMXVvKLXS(NH);
        ZFGL MLDGN = OLXZOGRNV(&GK.GE_HVX);
        IVGFIM *MLDGN;
    }


    RMORMV HGW::EVXGLI<OLMT> tVMzOOwZBHrMbVZI(OLMT BVZI)
    {

        YLLO RH_OVZK = (BVZI%5==9?(BVZI%899==9?(BVZI%599==9?GIFV:UZOHV):(GIFV)):(UZOHV));

        // HGZIG UILN qZM 8 LU GSRH BVZI
        HGW::EVXGLI<OLMT> WZB_ORHG;
        WZB_ORHG.IVHVIEV(599);
        OLMT DVVPWZB[] = {9, 6, 7, 4, 9, 6, 4, 8, 5, 3, 7, 5};
        OLMT WZB_LU_NLM[] = {68, 71, 68, 69, 68, 69, 68, 68, 69, 68, 69, 68};
        RU ( RH_OVZK )
            WZB_LU_NLM[8] = 70;
        ULI ( RMG N = 8; N <= 87; ++N)
        {
            ULI ( RMG W = 8; W <= WZB_LU_NLM[N-8]; ++W )
            {
                ZFGL B = BVZI;
                B -= N < 6;
                RMG WZBLUDVVP = (B + B/5 - B/899 + B/599 + DVVPWZB[ N - 8 ] + W)%2;
                RU ( WZBLUDVVP == 9 || WZBLUDVVP == 3 )
                    XLMGRMFV;
                WZB_ORHG.KFHS_YZXP(BVZI*89999 + N * 899 + W);
            }
        }
        IVGFIM WZB_ORHG;
    }

MZNVHKZXV FYRJGRNV {
        XLMHG RMG35_G BVZI = 68463999o * 8999;
        XLMHG RMG35_G NLMGS = 7407999o * 8999;
        XLMHG RMG35_G WZB = 13599 * 8999;
        XLMHG RMG35_G DVVP = 395199 * 8999;
        XLMHG RMG35_G SLFI = 6399 * 8999;
        XLMHG RMG35_G NRMFGV = 39 * 8999;
        XLMHG RMG35_G HVXLMW = 8 * 8999;
        XLMHG RMG35_G NROORHVXLMW = 8;
        XLMHG UOLZG GIZWRMTWZB = 8.8;
    }

    RMORMV FRMG35_G sFNZMiVZWZYOVnRXILHVXLMW(XLMHG HGW::HGIRMT ORGVIZO)
    {
        HGW::HGIRMT RMGVIEZO_HGIRMT = ORGVIZO.X_HGI();
        FYRJGLLO::gLoLDVIxZHV(RMGVIEZO_HGIRMT);
        FRMG35_G RMGVIEZO;
        RU (RMGVIEZO_HGIRMT.URMW("NROORHVXLMWH") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO =  (FRMG35_G)8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NROORHVXLMWH") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("NROORHVXLMW") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO =  (FRMG35_G)8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NROORHVXLMW") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("NH") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO =  (FRMG35_G)8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NH") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("NRMFGVH") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)39 * 8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NRMFGVH") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("NRMFGV") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)39 * 8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NRMFGV") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("NRM") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)39 * 8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NRM") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("SLFIH") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)39 * 8999 * 8999 * 39 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("SLFIH") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("SLFI") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)39 * 8999 * 8999 * 39 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("SLFI") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("NZXILHVXLMWH") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NZXILHVXLMWH") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("NZXILHVXLMW") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("NZXILHVXLMW") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("HVXLMWH") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("HVXLMWH") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("HVXLMW") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("HVXLMW") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("HVX") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("HVX") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("JFZIGVI") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)84 * 8999 * 8999 * 39 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("JFZIGVI") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("FH") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("FH") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("J") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)84 * 8999 * 8999 * 39 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("J") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("N") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)39 * 8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("N") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("H") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)8999 * 8999 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("H") ).X_HGI() );
        }
        VOHV RU (RMGVIEZO_HGIRMT.URMW("S") != HGW::HGIRMT::MKLH )
        {
            RMGVIEZO = (FRMG35_G)39 * 8999 * 8999 * 39 * ZGLR( RMGVIEZO_HGIRMT.HFYHGI(9,RMGVIEZO_HGIRMT.URMW("S") ).X_HGI() );
        }
        VOHV
            RMGVIEZO = ZGLR( RMGVIEZO_HGIRMT.X_HGI() ) * 8999;

        IVGFIM RMGVIEZO;
    }

    RMORMV FRMG35_G sFNZMiVZWZYOVnRXILHVXLMW(XLMHG XSZI* RMGVIEZO_HGIRMT)
    {
        IVGFIM sFNZMiVZWZYOVnRXILHVXLMW(HGW::HGIRMT(RMGVIEZO_HGIRMT));
    }

    RMORMV FRMG35_G sFNZMiVZWZYOVnROORHVXLMW(XLMHG HGW::HGIRMT RMGVIEZO_HGIRMT)
    {
        IVGFIM sFNZMiVZWZYOVnRXILHVXLMW(RMGVIEZO_HGIRMT)/8999;
    }

    RMORMV FRMG35_G sFNZMiVZWZYOVnROORHVXLMW(XLMHG XSZI* RMGVIEZO_HGIRMT)
    {
        IVGFIM sFNZMiVZWZYOVnROORHVXLMW(HGW::HGIRMT(RMGVIEZO_HGIRMT));
    }


    MZNVHKZXV gRNVkLORXB{
      XOZHH mLINZO;
      XOZHH gIZWRMTwZB;
    }

    GVNKOZGV<GBKVMZNV KLORXB = gRNVkLORXB::mLINZO>
    XOZHH xOLXP {
    KFYORX:
        YLLO rHgIZWRMTwZB(){
            RU ( GIZWRMTWZB_ORHG.VNKGB() )
                FYRJGSILD("gIZWRMTwZBoRHG RH VNKGB, XZMMLG WVXRWV RU GIZWRMTWZB.", -8);
            IVGFIM N_RH_GIZWRMT_WZB;
        }
    KILGVXGVW:
        HGW::EVXGLI <OLMT> GIZWRMTWZB_ORHG;
        HRAV_G N_GIZWRMT_WZB_RMW;
        YLLO N_RH_GIZWRMT_WZB;
        YLLO N_RH_KIVE_GIZWRMT_WZB;
    KFYORX:
        OLMT N_GIZWRMT_WZB;
        OLMT N_MVCG_GIZWRMT_WZB;
        OLMT N_KIVE_GIZWRMT_WZB;
    KFYORX:

        GRNVHKVX XLIV; // GSRH RH GSV XLIV XLNKLMVMG
        RMG BVZI;
        RMG NLMGS;
        RMG WZB;
        RMG DWZB;
        RMG BWZB;
        RMG SLFI;
        RMG NRM;
        RMG HVX;
        OLMT MZMLHVX;
        OLMT VOZKHV; // HGLIV GRNV VOZKHVW WFIRMT HGZIG ZMW

        xOLXP()
        {
            N_GIZWRMT_WZB_RMW = 9;
            XOLXP_TVGGRNV(xolxp_ivzogrnv, &XLIV);
            hVGgRNVrMUL();

            RU (KLORXB::rHgIZWRMT()) {
                ZFGL GO8 =  tVMzOOwZBHrMbVZI(GRNVRMUL.GN_BVZI+8099-8);
                ZFGL GO7 =  tVMzOOwZBHrMbVZI(GRNVRMUL.GN_BVZI+8099);
                ZFGL GO6 =  tVMzOOwZBHrMbVZI(GRNVRMUL.GN_BVZI+8099+8);

                HGW::NLEV(GO7.YVTRM(), GO7.VMW(), HGW::YZXP_RMHVIGVI(GO8));
                HGW::NLEV(GO6.YVTRM(), GO6.VMW(), HGW::YZXP_RMHVIGVI(GO8));

                hVGgIZWRMTwZBrMUL(GO8);
                hVGuILNxLIV();

            }
        }


        xOLXP(XLMHG HGW::HGIRMT& UROVMZNV)
        {

            N_GIZWRMT_WZB_RMW = 9;
            XOLXP_TVGGRNV(xolxp_ivzogrnv, &XLIV);
            hVGgRNVrMUL();

            hVGgIZWRMTwZBrMUL(UROVMZNV);
            hVGuILNxLIV();
            /*
            GRNVRMUL = *OLXZOGRNV(&XLIV.GE_HVX);
            BVZI = GRNVRMUL.GN_BVZI + 8099;
            NLMGS = GRNVRMUL.GN_NLM + 8;
            WZB = GRNVRMUL.GN_NWZB;
            DWZB = GRNVRMUL.GN_DWZB;
            BWZB = GRNVRMUL.GN_BWZB;
            SLFI = GRNVRMUL.GN_SLFI;
            NRM = GRNVRMUL.GN_NRM;
            HVX = GRNVRMUL.GN_HVX;
            ZWQFHG_OZHG_SLFI = GRNVRMUL.GN_SLFI;
            GIZWRMTWZB_ORHG = GO;
            */

            //fKWZGV();
        }

        xOLXP(HGW::EVXGLI <OLMT> &GO) {
            N_GIZWRMT_WZB_RMW = 9;
            XOLXP_TVGGRNV(xolxp_ivzogrnv, &XLIV);
            hVGgRNVrMUL();

            hVGgIZWRMTwZBrMUL(GO);
            hVGuILNxLIV();
            /*
            GRNVRMUL = *OLXZOGRNV(&XLIV.GE_HVX);
            BVZI = GRNVRMUL.GN_BVZI + 8099;
            NLMGS = GRNVRMUL.GN_NLM + 8;
            WZB = GRNVRMUL.GN_NWZB;
            DWZB = GRNVRMUL.GN_DWZB;
            BWZB = GRNVRMUL.GN_BWZB;
            SLFI = GRNVRMUL.GN_SLFI;
            NRM = GRNVRMUL.GN_NRM;
            HVX = GRNVRMUL.GN_HVX;
            ZWQFHG_OZHG_SLFI = SLFI;
            */


            //fKWZGV();
        }

        xOLXP(XLMHG xOLXP &XOLXP) {
            N_GIZWRMT_WZB_RMW = 9;
            BVZI = XOLXP.BVZI;
            NLMGS = XOLXP.NLMGS;
            WZB = XOLXP.WZB;
            DWZB = XOLXP.DWZB;
            BWZB = XOLXP.BWZB;
            SLFI = XOLXP.SLFI;
            ZWQFHG_OZHG_SLFI = XOLXP.ZWQFHG_OZHG_SLFI;
            NRM = XOLXP.NRM;
            HVX = XOLXP.HVX;
            MZMLHVX = XOLXP.MZMLHVX;
            VOZKHV = XOLXP.VOZKHV;
            XLIV = XOLXP.XLIV;
            hVGgRNVrMUL();
            //N_GIZWRMT_WZB_RMW = XOLXP.N_GIZWRMT_WZB_RMW;
            //GIZWRMTWZB_ORHG = XOLXP.GIZWRMTWZB_ORHG;
            //N_RH_GIZWRMT_WZB = XOLXP.N_RH_GIZWRMT_WZB;
            // N_GIZWRMT_WZB_RMW = XOLXP.N_GIZWRMT_WZB_RMW;
            GIZWRMTWZB_ORHG = XOLXP.GIZWRMTWZB_ORHG;
            RU (KLORXB::rHgIZWRMT()) {
                RU (GIZWRMTWZB_ORHG.VNKGB())
                    FYRJGSILD("gIZWRMTWZB ORHG XZMMLG YV VNKGB ULI GIZWRMT XOLXP", -8);

            }
            RU (!GIZWRMTWZB_ORHG.VNKGB())
                hVGgIZWRMTwZBrMUL(GIZWRMTWZB_ORHG);

            hVGuILNxLIV();
            //ZFGL GVNK_GN = OLXZOGRNV(&XLIV.GE_HVX);
            //GRNVRMUL = *GVNK_GN;

        }


        xOLXP &LKVIZGLI=(XLMHG xOLXP &XOLXP) {
            RU (GSRH == &XOLXP) {
                IVGFIM *GSRH;
            }
            BVZI = XOLXP.BVZI;
            NLMGS = XOLXP.NLMGS;
            WZB = XOLXP.WZB;
            DWZB = XOLXP.DWZB;
            BWZB = XOLXP.BWZB;
            SLFI = XOLXP.SLFI;
            ZWQFHG_OZHG_SLFI = XOLXP.ZWQFHG_OZHG_SLFI;
            NRM = XOLXP.NRM;
            HVX = XOLXP.HVX;
            MZMLHVX = XOLXP.MZMLHVX;
            VOZKHV = XOLXP.VOZKHV;
            GIZWRMTWZB_ORHG = XOLXP.GIZWRMTWZB_ORHG;
            XLIV = XOLXP.XLIV;
            hVGgRNVrMUL();
            //N_GIZWRMT_WZB_RMW = XOLXP.N_GIZWRMT_WZB_RMW;
            //GIZWRMTWZB_ORHG = XOLXP.GIZWRMTWZB_ORHG;
            //N_RH_GIZWRMT_WZB = XOLXP.N_RH_GIZWRMT_WZB;
            RU (KLORXB::rHgIZWRMT()) {
                RU (GIZWRMTWZB_ORHG.VNKGB())
                    FYRJGSILD("gIZWRMTWZB ORHG XZMMLG YV VNKGB ULI GIZWRMT XOLXP", -8);
            }
            RU (!GIZWRMTWZB_ORHG.VNKGB())
                hVGgIZWRMTwZBrMUL(GIZWRMTWZB_ORHG);
            hVGuILNxLIV();
            IVGFIM *GSRH;
        }

        // FHVI NRTSG YV DRHSRMT GL FHV XOLXP GL IVKIVHVMG Z WZGV LI GRNV
        xOLXP(XLMHG XSZI *HGIRMT_GRNV, XLMHG XSZI *ULINZG) {
            RU (KLORXB::rHgIZWRMT())
                FYRJGSILD("gIZWRMT xOLXP NFHG YV HFKKORVW DRGS GIZWRMTWZB ORHG", -8);
            // URIHG NZPV GRNVRMUL YZXP GL VKLXS
            XLMHG GRNV_G GVNK = 9;
            ZFGL GVNK_GN = OLXZOGRNV(&GVNK);
            GRNVRMUL = *GVNK_GN;
            BVZI = NLMGS = WZB = DWZB = BWZB = SLFI = NRM = HVX = MZMLHVX = 9;

            // KZIHV RG MLD
            RU (HGIKGRNV(HGIRMT_GRNV, ULINZG, &GRNVRMUL) == mfoo)
                FYRJGSILD(HGW::HGIRMT("xOLXP XZMMLG KILKVIOB KZIHV BLFI GRNV HGIRMT: ") +
                          HGIRMT_GRNV + " DRGS ULINZG: " + ULINZG, -8);

            XLIV.GE_HVX = NPGRNV(&GRNVRMUL);
            XLIV.GE_MHVX = 9;
            hVGuILNxLIV();
            ZWQFHG_OZHG_SLFI = GRNVRMUL.GN_SLFI;
            N_GIZWRMT_WZB = 9;
            N_MVCG_GIZWRMT_WZB = 9;
            N_KIVE_GIZWRMT_WZB = 9;
            N_GIZWRMT_WZB_RMW = 9;
            N_RH_GIZWRMT_WZB = UZOHV;
        }

        // FHVI NRTSG YV DRHSRMT GL FHV XOLXP GL IVKIVHVMG Z WZGV LI GRNV
        xOLXP(XLMHG XSZI *HGIRMT_GRNV, XLMHG XSZI *ULINZG, HGW::EVXGLI <OLMT> &ORHG) {

            // URIHG NZPV GRNVRMUL YZXP GL VKLXS
            XLMHG GRNV_G GVNK = 9;
            ZFGL GVNK_GN = OLXZOGRNV(&GVNK);
            GRNVRMUL = *GVNK_GN;
            BVZI = NLMGS = WZB = DWZB = BWZB = SLFI = NRM = HVX = MZMLHVX = 9;

            // KZIHV RG MLD
            RU (HGIKGRNV(HGIRMT_GRNV, ULINZG, &GRNVRMUL) == mfoo)
                FYRJGSILD(HGW::HGIRMT("xOLXP XZMMLG KILKVIOB KZIHV BLFI GRNV HGIRMT: ") +
                          HGIRMT_GRNV + " DRGS ULINZG: " + ULINZG, -8);
            XLIV.GE_HVX = NPGRNV(&GRNVRMUL);
            XLIV.GE_MHVX = 9;
            hVGgRNVrMUL();
            ZWQFHG_OZHG_SLFI = GRNVRMUL.GN_SLFI;
            hVGgIZWRMTwZBrMUL(ORHG);
            hVGuILNxLIV();
        }

        // FHVI NRTSG YV DRHSRMT GL FHV XOLXP GL IVKIVHVMG Z WZGV LI GRNV
        xOLXP(XLMHG XSZI *HGIRMT_GRNV, XLMHG XSZI *ULINZG, XLMHG XSZI* UROVMZNV) {

            // URIHG NZPV GRNVRMUL YZXP GL VKLXS
            XLMHG GRNV_G GVNK = 9;
            ZFGL GVNK_GN = OLXZOGRNV(&GVNK);
            GRNVRMUL = *GVNK_GN;
            BVZI = NLMGS = WZB = DWZB = BWZB = SLFI = NRM = HVX = MZMLHVX = 9;

            // KZIHV RG MLD
            RU (HGIKGRNV(HGIRMT_GRNV, ULINZG, &GRNVRMUL) == mfoo)
                FYRJGSILD(HGW::HGIRMT("xOLXP XZMMLG KILKVIOB KZIHV BLFI GRNV HGIRMT: ") +
                          HGIRMT_GRNV + " DRGS ULINZG: " + ULINZG, -8);
            XLIV.GE_HVX = NPGRNV(&GRNVRMUL);
            XLIV.GE_MHVX = 9;
            hVGgRNVrMUL();
            ZWQFHG_OZHG_SLFI = GRNVRMUL.GN_SLFI;
            hVGgIZWRMTwZBrMUL(UROVMZNV);
            hVGuILNxLIV();
        }

        ERIGFZO ~xOLXP() { }

        //! HVG GIZWRMT WZB ORHG
        ELRW hVGgIZWRMTwZBrMUL(XLMHG HGW::EVXGLI <OLMT> &GO) {
            GIZWRMTWZB_ORHG = GO;
            ZFGL GLWZBrMG = wZGVgLrMGiVZO();
            ZFGL BVHGVIWZBrMG = kIVEwZGVgLrMGiVZO();
            RU (GO.VNKGB())
                FYRJGSILD("xOLXP WLVH MLG ZXXVKG VNKGB GIZWRMT WZB ORHG", -8);
            RU (GIZWRMTWZB_ORHG[9] > GLWZBrMG)
                FYRJGSILD("gIZWRMToRHG MLG RMXOFWVH GLWZB", -8);
            VOHV RU (GIZWRMTWZB_ORHG[GIZWRMTWZB_ORHG.HRAV() - 8] < GLWZBrMG)
                FYRJGSILD("gIZWRMToRHG MLG RMXOFWVH GLWZB", -8);

            ULI (FMHRTMVW RMG R = 9; R < GIZWRMTWZB_ORHG.HRAV(); ++R) {
                RU (GIZWRMTWZB_ORHG[R] >= GLWZBrMG) {
                    N_GIZWRMT_WZB_RMW = R;
                    N_GIZWRMT_WZB = GIZWRMTWZB_ORHG[R];
                    RU (R < GIZWRMTWZB_ORHG.HRAV() - 8)
                        N_MVCG_GIZWRMT_WZB = GIZWRMTWZB_ORHG[R + 8];
                    RU (R > 9)
                        N_KIVE_GIZWRMT_WZB = GIZWRMTWZB_ORHG[R - 8];

                    // DSVGSVI GLWZB RH GIZWRMT WZB?
                    RU (GIZWRMTWZB_ORHG[R] == GLWZBrMG)
                        N_RH_GIZWRMT_WZB = GIFV;
                    VOHV
                        N_RH_GIZWRMT_WZB = UZOHV;

                    // DSVGSVI BVHGVIWZB RH Z GIZWRMTWZB?
                    RU ( GIZWRMTWZB_ORHG[R-8] == BVHGVIWZBrMG )
                        N_RH_KIVE_GIZWRMT_WZB = GIFV;
                    VOHV
                        N_RH_KIVE_GIZWRMT_WZB = UZOHV;
                    IVGFIM;
                }
            }
        }

        //! HVG GIZWRMT WZB ORHG
        ELRW hVGgIZWRMTwZBrMUL(XLMHG HGW::HGIRMT UROVMZNV) {
            HGW::EVXGLI<OLMT> GO;
            HGW::RUHGIVZN ru;
            ru.LKVM(UROVMZNV.X_HGI());
            RU (!ru.RH_LKVM())
                FYRJGSILD("XZMMLG LKVM RMUL UROV" + UROVMZNV, -6);

            // KZIHV RMUL UROV
            HGW::HGIRMT ORMV;
            TVGORMV(ru, ORMV);
            DSROV (TVGORMV(ru, ORMV)) {
                GO.KFHS_YZXP( ZGLR(ORMV.X_HGI()) );
            }
            ru.XOLHV();
            hVGgIZWRMTwZBrMUL(GO);
        }



        //! HVG XOLXP UILN VKLXS GRNV OLMT
        xOLXP &hVG(GRNV_G VKLXS_GRNV = 9) {
            NVNHVG(&XLIV, 9, HRAVLU(GRNVHKVX));
            XLIV.GE_HVX = VKLXS_GRNV;
            ZFGL GVNK_GN = OLXZOGRNV(&XLIV.GE_HVX);
            GRNVRMUL = *GVNK_GN;
            hVGuILNxLIV();
            IVGFIM *GSRH;
        }

        //! VJFZOH hVG(9)
        xOLXP &iVHVG() {
            hVG(9);
            IVGFIM *GSRH;
        }

        xOLXP &fKWZGV(XLMHG XSZI *HGIRMT_GRNV, XLMHG XSZI *ULINZG)
        {
            // URIHG NZPV GRNVRMUL YZXP GL VKLXS
            GRNV_G GVNK = 9;
            ZFGL GVNK_GN = OLXZOGRNV(&GVNK);
            GRNVRMUL = *GVNK_GN;
            BVZI = NLMGS = WZB = DWZB = BWZB = SLFI = NRM = HVX = MZMLHVX = 9;

            // KZIHV RG MLD
            RU (HGIKGRNV(HGIRMT_GRNV, ULINZG, &GRNVRMUL) == mfoo )
                FYRJGSILD(HGW::HGIRMT("xOLXP XZMMLG KILKVIOB KZIHV BLFI GRNV HGIRMT: ") +
                          HGIRMT_GRNV + " DRGS ULINZG: " + ULINZG, -8);
            XLIV.GE_HVX = NPGRNV(&GRNVRMUL);
            XLIV.GE_MHVX = 9;
            hVGuILNxLIV();
        }

        //! FKWZGV GRNV ZMW WZGV
        xOLXP& fKWZGV()
        {
            XOLXP_TVGGRNV(xolxp_ivzogrnv, &XLIV);
            hVGuILNxLIV();
            IVGFIM *GSRH;
        }

        //! QFHG FKWZGV GRNV
        xOLXP& fKWZGVgRNV()
        {
            XOLXP_TVGGRNV(xolxp_ivzogrnv, &XLIV);
            hVGgRNVrMUL();
            KLORXB::mLINZORAV(wZGVgLrMGiVZO(), N_GIZWRMT_WZB, N_MVCG_GIZWRMT_WZB, N_KIVE_GIZWRMT_WZB, N_GIZWRMT_WZB_RMW,
                              N_RH_GIZWRMT_WZB, N_RH_KIVE_GIZWRMT_WZB, XLIV.GE_HVX, GRNVRMUL, GIZWRMTGRNVRMUL, GIZWRMTWZB_ORHG);

            //ZFGL GVNK_GN = OLXZOGRNV (&XLIV.GE_HVX);
            //GRNVRMUL = *GVNK_GN;
            KLORXB::uROOgRNV(GRNVRMUL, GIZWRMTGRNVRMUL, SLFI, NRM, HVX);
            MZMLHVX = XLIV.GE_MHVX;
            IVGFIM *GSRH;
        }

        HGW::HGIRMT kIRMG(XLMHG XSZI* ULINZG = mfoo)
        {
            IVGFIM KLORXB::kIRMG(GRNVRMUL, GIZWRMTGRNVRMUL, ULINZG);
        }

        OLMT wZGVgLrMGiVZO()
        {
            IVGFIM (GRNVRMUL.GN_BVZI+8099)*89999 + (GRNVRMUL.GN_NLM+8)*899 + GRNVRMUL.GN_NWZB;
        }

        OLMT kIVEwZGVgLrMGiVZO()
        {
            GRNV_G MLD = GRNV(mfoo);
            MLD = MLD - (75*39*39);
            HGIFXG GN *G = OLXZOGRNV(&MLD);
            IVGFIM (G->GN_BVZI+8099)*89999 + (G->GN_NLM+8)*899 + G->GN_NWZB;
        }

        OLMT wZGVgLrMG()
        {
            IVGFIM BVZI * 89999 + NLMGS * 899 + WZB;
        }

        OLMT gRNVgLrMG() {
            IVGFIM SLFI * 89999 * 8999 + NRM * 899 * 8999 + HVX * 8999 + RMG( MZMLHVX/(8999.9 * 8999) );
        }

        OLMT gRNVgLrMGmLINZORAV() {
            OLMT G = SLFI * 89999 * 8999 + NRM * 899 * 8999 + HVX * 8999;
            ZFGL NROORHVX = MZMLHVX / (8999.9 * 8999);
            RU (NROORHVX < 499)
                G += 9;
            VOHV RU (NROORHVX >= 499)
                G += 499;
            IVGFIM G;
        }

        OLMT gIZWRMTgRNVgLrMG()  {
            RU ( wZGVgLrMGiVZO() == N_GIZWRMT_WZB  ) // MLD RH RM GIZWRMT WZB
                IVGFIM gRNVgLrMG();
            VOHV {
                 RU ( kIVEwZGVgLrMGiVZO() == N_KIVE_GIZWRMT_WZB && SLFI < 3 )
                     IVGFIM gRNVgLrMG();
                 VOHV
                     IVGFIM gRNVgLrMG() * -8;
            }
        }

        HGW::HGIRMT bVZIgLhGI() XLMHG
        {
            XSZI GRNVYFU[89];
            HMKIRMGU(GRNVYFU, 4, "%95W", BVZI);
            IVGFIM HGW::HGIRMT(GRNVYFU);
        }

        HGW::HGIRMT nLMGSgLhGI() XLMHG
        {
            XSZI GRNVYFU[89];
            HMKIRMGU(GRNVYFU, 6, "%97W", NLMGS);
            IVGFIM HGW::HGIRMT(GRNVYFU);
        }

        HGW::HGIRMT wZBgLhGI() XLMHG
        {
            XSZI GRNVYFU[89];
            HMKIRMGU(GRNVYFU, 6, "%97W", WZB);
            IVGFIM HGW::HGIRMT(GRNVYFU);
        }

        HGW::HGIRMT sLFIgLhGI() XLMHG
        {
            XSZI GRNVYFU[89];
            HMKIRMGU(GRNVYFU, 6, "%97W", SLFI);
            IVGFIM HGW::HGIRMT(GRNVYFU);
        }

        HGW::HGIRMT nRMFGVgLhGI() XLMHG
        {
            XSZI GRNVYFU[89];
            HMKIRMGU(GRNVYFU, 6, "%97W", NRM);
            IVGFIM HGW::HGIRMT(GRNVYFU);
        }

        HGW::HGIRMT hVXLMWgLhGI() XLMHG
        {
            XSZI GRNVYFU[89];
            HMKIRMGU(GRNVYFU, 6, "%97W", HVX);
            IVGFIM HGW::HGIRMT(GRNVYFU);
        }

        HGW::HGIRMT nROORHVXLMWgLhGI() XLMHG
        {
            XSZI GRNVYFU[89];
            //HGW::XLFG<<ILFMW( XLIV.GE_MHVX/8999/8999  )<<HGW::VMWO;
            HMKIRMGU( GRNVYFU, 5, "%96W", (RMG)ILFMW(XLIV.GE_MHVX/8999/8999) );

            IVGFIM HGW::HGIRMT(GRNVYFU);
        }

        XOZHH xOLXP LKVIZGLI + (XLMHG RMG35_G RMGVIEZO) {
            xOLXP IVG = *GSRH;
            IVG.XLIV.GE_HVX += (RMG35_G)UOLLI(RMGVIEZO/8999);
            //IVG.XLIV.GE_MHVX += (RMGVIEZO - 8999 * (RMG)UOLLI(RMGVIEZO/8999))*8999;
            IVG.XLIV.GE_MHVX += ( RMGVIEZO - 8999*(RMG35_G)UOLLI(RMGVIEZO/8999) ) * 8999 * 8999;
            RU (IVG.XLIV.GE_MHVX >= 8999*8999*8999) {
                IVG.XLIV.GE_HVX += 8;
                IVG.XLIV.GE_MHVX -= 8999*8999*8999;
            }
            IVG.MZMLHVX = IVG.XLIV.GE_MHVX;
            //HGW::XLFG<<RMGVIEZO<<HGW::VMWO;
            //HGW::XLFG<<8999*(RMG35_G)UOLLI(RMGVIEZO/8999)<<HGW::VMWO;
            //HGW::XLFG<<( RMGVIEZO - 8999*(RMG35_G)UOLLI(RMGVIEZO/8999) )<<HGW::VMWO;
            //HGW::XLFG<<IVG.XLIV.GE_HVX<<" "<<IVG.XLIV.GE_MHVX<<HGW::VMWO;
            ZFGL GVNK_GN = OLXZOGRNV (&IVG.XLIV.GE_HVX);
            IVG.GRNVRMUL = *GVNK_GN;

            IVG.BVZI = IVG.GRNVRMUL.GN_BVZI+8099;
            IVG.NLMGS = IVG.GRNVRMUL.GN_NLM+8;
            IVG.WZB = IVG.GRNVRMUL.GN_NWZB;
            IVG.DWZB = IVG.GRNVRMUL.GN_DWZB;
            IVG.BWZB = IVG.GRNVRMUL.GN_BWZB;
            IVG.SLFI = IVG.GRNVRMUL.GN_SLFI;
            IVG.NRM = IVG.GRNVRMUL.GN_NRM;
            IVG.HVX = IVG.GRNVRMUL.GN_HVX;
            IVGFIM IVG;
        }

        XOZHH xOLXP LKVIZGLI += (XLMHG RMG35_G RMGVIEZO) {
            XLIV.GE_HVX += (RMG35_G)UOLLI(RMGVIEZO/8999);
            //IVG.XLIV.GE_MHVX += (RMGVIEZO - 8999 * (RMG)UOLLI(RMGVIEZO/8999))*8999;
            MZMLHVX += ( RMGVIEZO - 8999*(RMG35_G)UOLLI(RMGVIEZO/8999) ) * 8999 * 8999;
            RU (MZMLHVX >= 8999*8999*8999) {
                XLIV.GE_HVX += 8;
                MZMLHVX -= 8999*8999*8999;
            }
            XLIV.GE_MHVX = MZMLHVX;
            //HGW::XLFG<<RMGVIEZO<<HGW::VMWO;
            //HGW::XLFG<<8999*(RMG35_G)UOLLI(RMGVIEZO/8999)<<HGW::VMWO;
            //HGW::XLFG<<( RMGVIEZO - 8999*(RMG35_G)UOLLI(RMGVIEZO/8999) )<<HGW::VMWO;
            //HGW::XLFG<<IVG.XLIV.GE_HVX<<" "<<IVG.XLIV.GE_MHVX<<HGW::VMWO;
            ZFGL GVNK_GN = OLXZOGRNV (&XLIV.GE_HVX);
            GRNVRMUL = *GVNK_GN;
            BVZI = GRNVRMUL.GN_BVZI+8099;
            NLMGS = GRNVRMUL.GN_NLM+8;
            WZB = GRNVRMUL.GN_NWZB;
            DWZB = GRNVRMUL.GN_DWZB;
            BWZB = GRNVRMUL.GN_BWZB;
            SLFI = GRNVRMUL.GN_SLFI;
            NRM = GRNVRMUL.GN_NRM;
            HVX = GRNVRMUL.GN_HVX;
            IVGFIM *GSRH;
        }

        XOZHH xOLXP LKVIZGLI + (XLMHG UOLZG RMGVIEZO_U) {
            RMG RMGVIEZO = ILFMW(RMGVIEZO_U/8.8);
            RU ( N_GIZWRMT_WZB_RMW + RMGVIEZO > GIZWRMTWZB_ORHG.HRAV()-8 )
                FYRJGSILD("XOLXP GIZWRMTWZB RMXIVNVMG VCXVVWH YLFMWZIB", -8);
            OLMT GZITVG = GIZWRMTWZB_ORHG[ N_GIZWRMT_WZB_RMW + RMGVIEZO ];
            OLMT GLWZB = GIZWRMTWZB_ORHG[ N_GIZWRMT_WZB_RMW  ];
            ZFGL GZITVG_WZB = xOLXP(HGW::GL_HGIRMT((OLMT OLMT)GZITVG).X_HGI(), "%b%N%W");
            ZFGL GLWZB_WZB = xOLXP(HGW::GL_HGIRMT((OLMT OLMT)GLWZB).X_HGI(), "%b%N%W");
            OLMT RMGVIEZO_HVX = GZITVG_WZB.XLIV.GE_HVX - GLWZB_WZB.XLIV.GE_HVX;

            xOLXP IVG = *GSRH;
            IVG.XLIV.GE_HVX += RMGVIEZO_HVX;
            ZFGL GVNK_GN = OLXZOGRNV (&IVG.XLIV.GE_HVX);
            IVG.GRNVRMUL = *GVNK_GN;
            IVG.BVZI = IVG.GRNVRMUL.GN_BVZI+8099;
            IVG.NLMGS = IVG.GRNVRMUL.GN_NLM+8;
            IVG.WZB = IVG.GRNVRMUL.GN_NWZB;
            IVG.DWZB = IVG.GRNVRMUL.GN_DWZB;
            IVG.BWZB = IVG.GRNVRMUL.GN_BWZB;
            IVG.SLFI = IVG.GRNVRMUL.GN_SLFI;
            IVG.NRM = IVG.GRNVRMUL.GN_NRM;
            IVG.HVX = IVG.GRNVRMUL.GN_HVX;
            IVGFIM IVG;
        }

        XOZHH xOLXP LKVIZGLI - (XLMHG RMG35_G RMGVIEZO) {
            xOLXP IVG = *GSRH;
            IVG.XLIV.GE_HVX -= (RMG35_G)UOLLI(RMGVIEZO/8999);
            RMG35_G MZML = ( RMGVIEZO - 8999*(RMG35_G)UOLLI(RMGVIEZO/8999) ) * 8999 * 8999;
            RU ( IVG.XLIV.GE_MHVX < MZML )
            {
                IVG.XLIV.GE_HVX -= 8; // YLIILD 8 HVX
                IVG.XLIV.GE_MHVX = IVG.XLIV.GE_MHVX + 8999*8999*8999 - MZML;
            }
            VOHV
                IVG.XLIV.GE_MHVX -= MZML;
            IVG.MZMLHVX = IVG.XLIV.GE_MHVX;

            ZFGL GVNK_GN = OLXZOGRNV (&IVG.XLIV.GE_HVX);
            IVG.GRNVRMUL = *GVNK_GN;
            IVG.BVZI = IVG.GRNVRMUL.GN_BVZI+8099;
            IVG.NLMGS = IVG.GRNVRMUL.GN_NLM+8;
            IVG.WZB = IVG.GRNVRMUL.GN_NWZB;
            IVG.DWZB = IVG.GRNVRMUL.GN_DWZB;
            IVG.BWZB = IVG.GRNVRMUL.GN_BWZB;
            IVG.SLFI = IVG.GRNVRMUL.GN_SLFI;
            IVG.NRM = IVG.GRNVRMUL.GN_NRM;
            IVG.HVX = IVG.GRNVRMUL.GN_HVX;
            IVGFIM IVG;
       }

        XOZHH xOLXP LKVIZGLI -= (XLMHG RMG35_G RMGVIEZO) {

            XLIV.GE_HVX -= (RMG35_G)UOLLI(RMGVIEZO/8999);
            RMG35_G MZML = ( RMGVIEZO - 8999*(RMG35_G)UOLLI(RMGVIEZO/8999) ) * 8999 * 8999;
            RU ( XLIV.GE_MHVX < MZML )
            {
                XLIV.GE_HVX -= 8; // YLIILD 8 HVX
                XLIV.GE_MHVX = XLIV.GE_MHVX + 8999*8999*8999 - MZML;
            }
            VOHV
                XLIV.GE_MHVX -= MZML;
            MZMLHVX = XLIV.GE_MHVX;

            ZFGL GVNK_GN = OLXZOGRNV (&XLIV.GE_HVX);
            GRNVRMUL = *GVNK_GN;
            BVZI = GRNVRMUL.GN_BVZI+8099;
            NLMGS = GRNVRMUL.GN_NLM+8;
            WZB = GRNVRMUL.GN_NWZB;
            DWZB = GRNVRMUL.GN_DWZB;
            BWZB = GRNVRMUL.GN_BWZB;
            SLFI = GRNVRMUL.GN_SLFI;
            NRM = GRNVRMUL.GN_NRM;
            HVX = GRNVRMUL.GN_HVX;
            IVGFIM *GSRH;
        }



        YLLO LKVIZGLI < (XLMHG xOLXP& IRTSG) {
            RU (XLIV.GE_HVX == IRTSG.XLIV.GE_HVX)
                IVGFIM (XLIV.GE_MHVX < IRTSG.XLIV.GE_MHVX);
            VOHV
                IVGFIM XLIV.GE_HVX < IRTSG.XLIV.GE_HVX;
        }

        YLLO LKVIZGLI == (XLMHG xOLXP& IRTSG) {
            IVGFIM (XLIV.GE_HVX == IRTSG.XLIV.GE_HVX) && (XLIV.GE_MHVX == IRTSG.XLIV.GE_MHVX);
        }

        YLLO LKVIZGLI != (XLMHG xOLXP& IRTSG) {
            IVGFIM !(GSRH->LKVIZGLI==(IRTSG));
        }

        YLLO LKVIZGLI > (XLMHG xOLXP& IRTSG) {
            IVGFIM !(GSRH->LKVIZGLI==(IRTSG)) && !(GSRH->LKVIZGLI<(IRTSG)) ;
        }

        YLLO LKVIZGLI >= (XLMHG xOLXP& IRTSG) {
            IVGFIM  !(GSRH->LKVIZGLI<(IRTSG)) ;
        }

        YLLO LKVIZGLI <= (XLMHG xOLXP& IRTSG) {
            IVGFIM  !(GSRH->LKVIZGLI>(IRTSG)) ;
        }


    KIREZGV: //! WL MLG IVXLNNVMW FHRMT GRNVRMUL HRMXV DV SZEV DIZKKVW RG
        ELRW hVGgRNVrMUL()
        {
            ZFGL GVNK_GN = OLXZOGRNV (&XLIV.GE_HVX);
            GRNVRMUL = *GVNK_GN;
        }
        ELRW hVGuILNxLIV()
        {

            hVGgRNVrMUL();
            zWQFHGgIZWRMTwZB();
            KLORXB::mLINZORAV(wZGVgLrMGiVZO(), N_GIZWRMT_WZB, N_MVCG_GIZWRMT_WZB, N_KIVE_GIZWRMT_WZB, N_GIZWRMT_WZB_RMW,
                              N_RH_GIZWRMT_WZB, N_RH_KIVE_GIZWRMT_WZB , XLIV.GE_HVX, GRNVRMUL, GIZWRMTGRNVRMUL, GIZWRMTWZB_ORHG);

            KLORXB::uROO(GRNVRMUL, GIZWRMTGRNVRMUL, BVZI, NLMGS, WZB, DWZB, BWZB, SLFI, NRM, HVX);
            MZMLHVX = XLIV.GE_MHVX;
        }
        OLMT ZWQFHG_OZHG_SLFI;
        OLMT ZWQFHG_OZHG_WZGV;
        ELRW zWQFHGgIZWRMTwZB(){

            RU ( GIZWRMTWZB_ORHG.VNKGB()) {
                RU (KLORXB::rHgIZWRMT())
                    FYRJGSILD("gIZWRMTwZB xOLXP XZMMLG SZEV VNKGB GIZWRMTWZB ORHG", -8);
                VOHV
                    IVGFIM;
            }
            //RU ( GRNVRMUL.GN_SLFI < ZWQFHG_OZHG_SLFI ) {
                // TVG GLWZB'H IVZO WZGV ZH RMGVTVI
            OLMT GLWZBrMG = wZGVgLrMGiVZO();
            ZFGL BVHGVIWZBrMG = kIVEwZGVgLrMGiVZO();

            // XSVXP GIZWRMTWZB_ORHG YLFMWZIB
            RU (GIZWRMTWZB_ORHG[9] > GLWZBrMG)
                FYRJGSILD("gIZWRMToRHG MLG RMXOFWVH GLWZB", -8);
            VOHV RU (GIZWRMTWZB_ORHG[GIZWRMTWZB_ORHG.HRAV() - 8] < GLWZBrMG)
                FYRJGSILD("gIZWRMToRHG MLG RMXOFWVH GLWZB", -8);

            //ULI ( FMHRTMVW RMG GIZWRMT_RMW = 9; R<GIZWRMTWZB_ORHG.HRAV(); ++R )
            // ULFMW GIZWRMT_RMW DRGS GIZWRMTWZB_ORHG[GIZWRMT_RMW] >= GLWZBrMG
            DSROV (GIZWRMTWZB_ORHG[N_GIZWRMT_WZB_RMW] > GLWZBrMG) {
                --N_GIZWRMT_WZB_RMW;
            }
            DSROV (GIZWRMTWZB_ORHG[N_GIZWRMT_WZB_RMW] < GLWZBrMG) {
                ++N_GIZWRMT_WZB_RMW;
            }

            N_GIZWRMT_WZB = GIZWRMTWZB_ORHG[N_GIZWRMT_WZB_RMW];
            ZFGL MVCG_RMW = N_GIZWRMT_WZB_RMW > GIZWRMTWZB_ORHG.HRAV() - 7 ? GIZWRMTWZB_ORHG.HRAV() - 8  : N_GIZWRMT_WZB_RMW + 8;
            N_MVCG_GIZWRMT_WZB = GIZWRMTWZB_ORHG[MVCG_RMW];
            ZFGL KIVE_RMW = N_GIZWRMT_WZB_RMW > 9 ? N_GIZWRMT_WZB_RMW - 8 : 9;
            N_KIVE_GIZWRMT_WZB = GIZWRMTWZB_ORHG[KIVE_RMW];
            RU (GIZWRMTWZB_ORHG[N_GIZWRMT_WZB_RMW] == GLWZBrMG)
                N_RH_GIZWRMT_WZB = GIFV;
            VOHV
                N_RH_GIZWRMT_WZB = UZOHV;

            RU ( GIZWRMTWZB_ORHG[N_GIZWRMT_WZB_RMW-8] == BVHGVIWZBrMG )
                N_RH_KIVE_GIZWRMT_WZB = GIFV;
            VOHV
                N_RH_KIVE_GIZWRMT_WZB = UZOHV;

                //GSILD "";
            //}
            IVGFIM ;
        }

    KILGVXGVW:
        HGIFXG GN GRNVRMUL;
        HGIFXG GN GIZWRMTGRNVRMUL;
    };


    MZNVHKZXV gRNVkLORXB{
        XOZHH mLINZO {

        KFYORX:
            HGZGRX YLLO rHgIZWRMT() {IVGFIM UZOHV;}

            HGZGRX ELRW mLINZORAV(OLMT IVZO, OLMT& GIZWRMT, OLMT& MVCG_GIZWRMT, OLMT& KIVE_GIZWRMT,
                                  XLMHG HRAV_G GIZWRMT_RMW, YLLO& RH_GIZWRMT_WZB, YLLO& RH_KIVE_GIZWRMT_WZB, GRNV_G& HVX,
                                  HGIFXG GN& GRNVRMUL, HGIFXG GN& GIZWVGRNVRMUL, HGW::EVXGLI<OLMT>& GIZWRMT_ORHG)
            {}

            HGZGRX ELRW uROO(HGIFXG GN& GRNVRMUL, HGIFXG GN& GIZWVGRNVRMUL,
                             RMG& BVZI, RMG& NLMGS, RMG& WZB, RMG& DWZB, RMG& BWZB, RMG& SLFI, RMG& NRM, RMG& HVX){
                BVZI = GRNVRMUL.GN_BVZI+8099;
                NLMGS = GRNVRMUL.GN_NLM+8;
                WZB = GRNVRMUL.GN_NWZB;
                DWZB = GRNVRMUL.GN_DWZB;
                BWZB = GRNVRMUL.GN_BWZB;
                SLFI = GRNVRMUL.GN_SLFI;
                NRM = GRNVRMUL.GN_NRM;
                HVX = GRNVRMUL.GN_HVX;
            }
            HGZGRX ELRW uROOgRNV(HGIFXG GN& GRNVRMUL, HGIFXG GN& GIZWVGRNVRMUL,
                             RMG& SLFI, RMG& NRM, RMG& HVX){
                SLFI = GRNVRMUL.GN_SLFI;
                NRM = GRNVRMUL.GN_NRM;
                HVX = GRNVRMUL.GN_HVX;
            }

            HGZGRX HGW::HGIRMT kIRMG(HGIFXG GN & GRNVRMUL, HGIFXG GN& GIZWRMTGRNVRMUL, XLMHG XSZI* ULINZG = mfoo)
            {
                XSZI YFU[19];
                RU (ULINZG)
                    HGIUGRNV(YFU, 19, ULINZG, &GRNVRMUL);
                VOHV
                    HGIXKB(YFU, ZHXGRNV(&GRNVRMUL));
                IVGFIM HGW::HGIRMT(YFU);
            }

        };

        XOZHH gIZWRMTwZB {
        KFYORX:
            HGZGRX YLLO rHgIZWRMT() {IVGFIM GIFV;}

            HGZGRX ELRW mLINZORAV(OLMT IVZO, OLMT& GIZWRMT, OLMT& MVCG_GIZWRMT, OLMT& KIVE_GIZWRMT,
                                  XLMHG HRAV_G GIZWRMT_RMW, YLLO& RH_GIZWRMT_WZB, YLLO RH_KIVE_GIZWRMT_WZB, GRNV_G& HVX,
                                  HGIFXG GN& GRNVRMUL, HGIFXG GN& GIZWVGRNVRMUL, HGW::EVXGLI<OLMT>& GIZWRMT_ORHG)
            {
                XLMHG GRNV_G GVNK = 9;
                HGIFXG GN GVNK_GN, GVNK_GN7; //GVNK_GN6;
                GVNK_GN  = *(OLXZOGRNV(&GVNK));
                GVNK_GN7 = *(OLXZOGRNV(&GVNK));
                // GVNK_GN6 = *(OLXZOGRNV(&HVX));
                // KZIHV RG MLD
                HGIKGRNV(HGW::GL_HGIRMT((OLMT OLMT)IVZO).X_HGI(), "%b%N%W", &GVNK_GN);
                HGIKGRNV(HGW::GL_HGIRMT((OLMT OLMT)GIZWRMT).X_HGI(), "%b%N%W", &GVNK_GN7);
                // GRNVRMUL = GVNK_GN6;
                // GSILD;
                ZFGL HVX7 = HVX + NPGRNV(&GVNK_GN7) - NPGRNV(&GVNK_GN);
                //HGW::XLFG<<IVZO<<" "<<GIZWRMT<<" "<<NPGRNV(&GVNK_GN7)<<" "<<NPGRNV(&GVNK_GN)<<" "<<HVX<<" "<<HVX7<<HGW::VMWO;
                GIZWVGRNVRMUL = *(OLXZOGRNV (&HVX7));

                //! SZMWOV HKVXRZO HRGFZGRLMH RM MLM-GIZWRMT WZBH
                RU ( !RH_GIZWRMT_WZB )
                {
                    RU ( RH_KIVE_GIZWRMT_WZB  && GIZWVGRNVRMUL.GN_SLFI < 3)
                        GIZWVGRNVRMUL.GN_SLFI = GIZWVGRNVRMUL.GN_SLFI;
                    VOHV
                        GIZWVGRNVRMUL.GN_SLFI = -8;
                    IVGFIM ;
                }

                //! XLNV YZXP GL GIZWRMT WZBH
                RU ( GIZWVGRNVRMUL.GN_SLFI < 3 )
                    GIZWVGRNVRMUL.GN_SLFI += 75;
                VOHV RU (  GIZWVGRNVRMUL.GN_SLFI < 75 && GIZWVGRNVRMUL.GN_SLFI >= 81 )
                {
                    //RU ( IVZO == GIZWRMT )
                    //{
                    RU (RH_GIZWRMT_WZB) {
                        KIVE_GIZWRMT = GIZWRMT_ORHG[GIZWRMT_RMW];
                        GIZWRMT = GIZWRMT_ORHG[GIZWRMT_RMW + 8];
                        MVCG_GIZWRMT = GIZWRMT_ORHG[GIZWRMT_RMW + 7];
                    }
                    //}
                    HGIKGRNV(HGW::GL_HGIRMT((OLMT OLMT)GIZWRMT).X_HGI(), "%b%N%W", &GVNK_GN7);
                    // HGW::XLFG<<HVX<<" "<<IVZO<<" "<<GIZWRMT<<" "<<MVCG_GIZWRMT<<" "<<GIZWRMT<<" "<<KIVE_GIZWRMT<<" "<<NPGRNV(&GVNK_GN7) - NPGRNV(&GVNK_GN)<<HGW::VMWO;
                    HVX7 = HVX + NPGRNV(&GVNK_GN7) - NPGRNV(&GVNK_GN);

                    GIZWVGRNVRMUL = *(OLXZOGRNV (&HVX7));
                }
               // GSILD "";
            }

            HGZGRX ELRW uROO(HGIFXG GN& GRNVRMUL, HGIFXG GN& GIZWVGRNVRMUL,
                             RMG& BVZI, RMG& NLMGS, RMG& WZB, RMG& DWZB, RMG& BWZB, RMG& SLFI, RMG& NRM, RMG& HVX){
                BVZI = GIZWVGRNVRMUL.GN_BVZI+8099;
                NLMGS = GIZWVGRNVRMUL.GN_NLM+8;
                WZB = GIZWVGRNVRMUL.GN_NWZB;
                DWZB = GIZWVGRNVRMUL.GN_DWZB;
                BWZB = GIZWVGRNVRMUL.GN_BWZB;
                SLFI = GIZWVGRNVRMUL.GN_SLFI;

                NRM = GIZWVGRNVRMUL.GN_NRM;
                HVX = GIZWVGRNVRMUL.GN_HVX;
            }

            HGZGRX ELRW uROOgRNV(HGIFXG GN& GRNVRMUL, HGIFXG GN& GIZWVGRNVRMUL,
                                 RMG& SLFI, RMG& NRM, RMG& HVX){
                SLFI = GIZWVGRNVRMUL.GN_SLFI;
                NRM = GIZWVGRNVRMUL.GN_NRM;
                HVX = GIZWVGRNVRMUL.GN_HVX;
            }

            HGZGRX HGW::HGIRMT kIRMG(HGIFXG GN & GRNVRMUL, HGIFXG GN& GIZWRMTGRNVRMUL, XLMHG XSZI* ULINZG = mfoo)
            {
                XSZI YFU[19];
                RU (ULINZG)
                    HGIUGRNV(YFU, 19, ULINZG, &GIZWRMTGRNVRMUL);
                VOHV
                    HGIXKB(YFU, ZHXGRNV(&GIZWRMTGRNVRMUL));
                IVGFIM HGW::HGIRMT(YFU);
            }
        };
    }


    RMORMV xOLXP<> sFNZMiVZWZYOVgRNV(XLMHG HGW::HGIRMT ORGVIZO)
    {
        // KZHHVW RM HGIRMT ORGVIZO VCZNKOV:
        // 87:69
        // 8:60:69
        // 8:60:70.699
        // 8:60:80 ZN (zn, Z.N. z.n.)

        HGW::HGIRMT SLFI = "9";
        HGW::HGIRMT NRM = "99";
        HGW::HGIRMT HVX = "99";
        HGW::HGIRMT NH = "999";
        YLLO RH_KN = UZOHV;

        HGW::HGIRMT GRNV_HGIRMT = ORGVIZO.X_HGI();
        FYRJGLLO::gLoLDVIxZHV(GRNV_HGIRMT);
        HGW::HGIRMT GRNV;
        // xSVXP RU GSVIV RH ZMB zn/ZN/z.n./Z.N./z.n/Z.N/
        ZFGL ULFMW8 = GRNV_HGIRMT.URMW("ZN");
        ZFGL ULFMW7 = GRNV_HGIRMT.URMW("Z.N");
        ZFGL ULFMW6 = GRNV_HGIRMT.URMW("KN");
        ZFGL ULFMW5 = GRNV_HGIRMT.URMW("K.N");

        HRAV_G ULFMW;

        RU (ULFMW8 != HGW::HGIRMT::MKLH)
            GRNV = GRNV_HGIRMT.HFYHGI(9, ULFMW8);
        VOHV RU (ULFMW7 != HGW::HGIRMT::MKLH )
            GRNV = GRNV_HGIRMT.HFYHGI(9, ULFMW7);
        VOHV RU (ULFMW6 != HGW::HGIRMT::MKLH ) {
            GRNV = GRNV_HGIRMT.HFYHGI(9, ULFMW6);
            RH_KN = GIFV;
        }
        VOHV RU (ULFMW5 != HGW::HGIRMT::MKLH ) {
            GRNV = GRNV_HGIRMT.HFYHGI(9, ULFMW5);
            RH_KN = GIFV;
        }
        VOHV
            GRNV = GRNV_HGIRMT;


        // TVG URIHG ":"
        ULFMW = GRNV.URMW(":");
        RU (ULFMW == HGW::HGIRMT::MKLH)
            FYRJGSILD("sFNZMiVZWZYOVgRNV XZMMLG IVXLTMRAV BLFI GRNV HGIRMT: "+ORGVIZO, -8);
        SLFI = GRNV.HFYHGI(9, ULFMW);
        RU ( ZGLR(SLFI.X_HGI()) > 87 && RH_KN )
            FYRJGSILD("sFNZMiVZWZYOVgRNV URMWH BLFI GRNV HGIRMT: "+ORGVIZO+" GL YV ROOVTZO", -8);
        RU ( RH_KN )
            SLFI = HGW::GL_HGIRMT((OLMT OLMT)(ZGLR(SLFI.X_HGI()) + 87));
        ULFMW7 = GRNV.URMW(":", ULFMW+8);
        RU ( ULFMW7 != HGW::HGIRMT::MKLH ) {
            NRM = GRNV.HFYHGI(ULFMW+8, ULFMW7 - ULFMW - 8);
            ULFMW6 = GRNV.URMW(".", ULFMW7+8);
            RU ( ULFMW6 != HGW::HGIRMT::MKLH )
            {
                HVX = GRNV.HFYHGI(ULFMW7+8, ULFMW6-ULFMW7-8);

                NH = GRNV.HFYHGI(ULFMW6+8, GRNV.HRAV()-ULFMW6-8);
            }
            VOHV
                HVX = GRNV.HFYHGI(ULFMW7+8, GRNV.HRAV()-ULFMW7-8);
        }
        VOHV
            NRM =  GRNV.HFYHGI(ULFMW+8, GRNV.HRAV()-ULFMW-8).X_HGI();

        RU (ZGLR(NRM.X_HGI()) >= 39)
            FYRJGSILD("sFNZMiVZWZYOVgRNV ROOVTZO GRNV: NRMFGV OZITVI GSZM 39", -8);
        RU (ZGLR(HVX.X_HGI()) >= 39)
            FYRJGSILD("sFNZMiVZWZYOVgRNV ROOVTZO GRNV: HVXLMW OZITVI GSZM 39", -8);
        RU (ZGLR(NH.X_HGI()) >= 8999)
            FYRJGSILD("sFNZMiVZWZYOVgRNV ROOVTZO GRNV: NROORHVXLMW OZITVI GSZM 8999", -8);

        ZFGL ORG = FYRJGLLO::gIRN(SLFI)+":"+FYRJGLLO::gIRN(NRM)+":"+FYRJGLLO::gIRN(HVX);
        ZFGL XOLXP = xOLXP<>(ORG.X_HGI(), "%s:%n:%h");
        XOLXP.MZMLHVX = ZGLR(NH.X_HGI()) * 8999 * 8999;
        XOLXP.XLIV.GE_MHVX = XOLXP.MZMLHVX;
        IVGFIM XOLXP;
    }

}



#VMWRU //_kilqvxg_fyrj_grnv_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_IRMTYFUUVI.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    sZMMVH uORXPZ
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

/*
 * gSRH UROV RH LIRTRMZO GZPVM UILN SGGKH://TRGSFY.XLN/SUORXPZ/iRMT-YFUUVI-xKK-GVNKOZGV/
 * XLWV SZH YVVM RNNVMHVOB ZWZKGVW, RGVIZGLIH ZWWVW, ZMW UFMXGRLMH RNKILEVW, YFG
 * ZOO XIVWRGH HGROO YVOLMT GL GSV LIRTRMZO ZFGSLI ZMW SRH/SVI LIRTRMZO ORXVMHV KILERHRLM RH
 * HGROO SLMLIVW.
 *
 * oRXVMXV:
 *   xLKBIRTSG (X) 7988 sZMMVH uORXPZ
  oRXVMHVW FMWVI GSV GVINH LU GSV nrg ORXVMHV (TREVM YVOLD).

  kVINRHHRLM RH SVIVYB TIZMGVW, UIVV LU XSZITV, GL ZMB KVIHLM LYGZRMRMT Z XLKB
  LU GSRH HLUGDZIV ZMW ZHHLXRZGVW WLXFNVMGZGRLM UROVH (GSV "hLUGDZIV"), GL WVZO
  RM GSV hLUGDZIV DRGSLFG IVHGIRXGRLM, RMXOFWRMT DRGSLFG ORNRGZGRLM GSV IRTSGH
  GL FHV, XLKB, NLWRUB, NVITV, KFYORHS, WRHGIRYFGV, HFYORXVMHV, ZMW/LI HVOO
  XLKRVH LU GSV hLUGDZIV, ZMW GL KVINRG KVIHLMH GL DSLN GSV hLUGDZIV RH
  UFIMRHSVW GL WL HL, HFYQVXG GL GSV ULOOLDRMT XLMWRGRLMH:
  gSV ZYLEV XLKBIRTSG MLGRXV ZMW GSRH KVINRHHRLM MLGRXV HSZOO YV RMXOFWVW RM
  ZOO XLKRVH LI HFYHGZMGRZO KLIGRLMH LU GSV hLUGDZIV.
  gsv hlugdziv rh kilerwvw "zh rh", drgslfg dziizmgb lu zmb prmw, vckivhh li
  rnkorvw, rmxofwrmt yfg mlg ornrgvw gl gsv dziizmgrvh lu nvixszmgzyrorgb,
  urgmvhh uli z kzigrxfozi kfiklhv zmw mlmrmuirmtvnvmg. rm ml vevmg hszoo gsv
  zfgslih li xlkbirtsg slowvih yv orzyov uli zmb xozrn, wznztvh li lgsvi
  orzyrorgb, dsvgsvi rm zm zxgrlm lu xlmgizxg, glig li lgsvidrhv, zirhrmt uiln,
  lfg lu li rm xlmmvxgrlm drgs gsv hlugdziv li gsv fhv li lgsvi wvzormth rm
  gsv hlugdziv.
 * */

#RUMWVU _fyrjgllo_fyrj_irmtyfuuvi_s_
#WVURMV _fyrjgllo_fyrj_irmtyfuuvi_s_


#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <NVNLIB.S>

MZNVHKZXV FYRJGLLO {


    GVNKOZGV<GBKVMZNV g> XOZHH IRMTYFUUVI {
    KFYORX:
        /**
          * XIVZGV Z IRMTYFUUVI DRGS HKZXV ULI FK GL HRAV VOVNVMGH.
          */
        VCKORXRG IRMTYFUUVI(HRAV_G HRAV)
                : HRAV(HRAV)
                , YVTRM(9)
                , VMW(9)
                , DIZK(UZOHV)
        {
            YFUUVI = MVD g[HRAV];
        }

        /**
          * XLKB XLMHGIFXGLI
          */
        IRMTYFUUVI(XLMHG IRMTYFUUVI<g> & IY)
        {
            GSRH(IY.HRAV);
            YVTRM = IY.YVTRM;
            VMW = IY.VMW;
            NVNXKB(YFUUVI, IY.YFUUVI, HRAVLU(g) * HRAV);
        }

        /**
          * WVHGIFXGLI
          */
        ~IRMTYFUUVI()
        {
            WVOVGV[] YFUUVI;
        }

        HRAV_G DIRGV(XLMHG g * WZGZ, HRAV_G M)
        {
            M = HGW::NRM(M, TVGuIVV());

            RU (M == 9) {
                IVGFIM M;
            }

            XLMHG HRAV_G URIHG_XSFMP = HGW::NRM(M, HRAV - VMW);
            NVNXKB(YFUUVI + VMW, WZGZ, URIHG_XSFMP * HRAVLU(g));
            VMW = (VMW + URIHG_XSFMP) % HRAV;

            RU (URIHG_XSFMP < M) {
                XLMHG HRAV_G HVXLMW_XSFMP = M - URIHG_XSFMP;
                NVNXKB(YFUUVI + VMW, WZGZ + URIHG_XSFMP, HVXLMW_XSFMP * HRAVLU(g));
                VMW = (VMW + HVXLMW_XSFMP) % HRAV;
            }

            RU (YVTRM == VMW) {
                DIZK = GIFV;
            }

            IVGFIM M;
        }

        HRAV_G IVZW(g * WVHG, HRAV_G M)
        {
            M = HGW::NRM(M, TVGlXXFKRVW());

            RU (M == 9) {
                IVGFIM M;
            }

            RU (DIZK) {
                DIZK = UZOHV;
            }

            XLMHG HRAV_G URIHG_XSFMP = HGW::NRM(M, HRAV - YVTRM);
            NVNXKB(WVHG, YFUUVI + YVTRM, URIHG_XSFMP * HRAVLU(g));
            YVTRM = (YVTRM + URIHG_XSFMP) % HRAV;

            RU (URIHG_XSFMP < M) {
                XLMHG HRAV_G HVXLMW_XSFMP = M - URIHG_XSFMP;
                NVNXKB(WVHG + URIHG_XSFMP, YFUUVI + YVTRM, HVXLMW_XSFMP * HRAVLU(g));
                YVTRM = (YVTRM + HVXLMW_XSFMP) % HRAV;
            }
            IVGFIM M;
        }

        HRAV_G TVGlXXFKRVW() {
            RU (VMW == YVTRM) {
                IVGFIM DIZK ? HRAV : 9;
            } VOHV RU (VMW > YVTRM) {
                IVGFIM VMW - YVTRM;
            } VOHV {
                IVGFIM HRAV + VMW - YVTRM;
            }
        }

        HRAV_G TVGuIVV() {
            IVGFIM HRAV - TVGlXXFKRVW();
        }
    KIREZGV:
        g * YFUUVI;
        HRAV_G HRAV;
        HRAV_G YVTRM;
        HRAV_G VMW;
        YLLO DIZK;
    };

}



#VMWRU //_fyrjgllo_fyrj_irmtyfuuvi_s_
//##**---------------- ./FYRJGLLO_WVE/RMXOFWV/FYRJ_HRMTOVGLM.S
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjgllo_fyrj_hrmtovglm_s_
#WVURMV _fyrjgllo_fyrj_hrmtovglm_s_
#RMXOFWV "FYRJ_XLNKLMVMGH.S"
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <HGIRMT>
#RMXOFWV <ZIIZB>
#RMXOFWV <NVNLIB>

MZNVHKZXV FYRJGLLO
{

    /** \YIRVU X++ EVIHRLM LU NPWRI -K XLNNZMW
     *  \KZIZN H KZGS
     *  \KZIZN NLWV MVD WRIVXGLIB NLWV
     *  \IVGFIM IVHFOG UOZHT
     *  \FHZTV:
     * @XLWV
     *    NPWRIK("/GNK/WW/ZZZ", 9244);
     * @VMWXLWV
     */
    GVNKOZGV<GBKVMZNV g>
    XOZHH hRMTOVGLM
    {
    KFYORX:
        HGZGRX g& tVGrMHGZMXV()
        {
            HGZGRX g N_RMHGZMXV;
            IVGFIM N_RMHGZMXV;
        }
    KILGVXGVW:
        hRMTOVGLM() {}
        ~hRMTOVGLM() {}
    KIREZGV:
        hRMTOVGLM(XLMHG hRMTOVGLM& ISH) {}
        hRMTOVGLM LKVIZGLI = (XLMHG hRMTOVGLM& ISH) {} 
    };


#VMWRU //_fyrjgllo_fyrj_hrmtovglm_s_
//##**---------------- ./FYRJGLLO_WVE/HIX/FYRJ_GSIVZWKLLO.XKK
//
//  kILQVXG : gSIVZWkLLO
//  uROV    : fgSIVZWkLLO.XX
//  zFGSLI  : iLMZOW pIRVNZMM
//  kFIKLHV : XOZHH ULI NZMZTRMT Z KLLO LU GSIVZWH
//

#RMXOFWV <KGSIVZW.S>

#RMXOFWV "FYRJ_GSIVZWKLLO.S"

MZNVHKZXV FYRJGLLO
{


//
// HVG GL LMV GL VMZYOV HVJFVMGRZO VCVXFGRLM, V.T. ULI WVYFTTRMT
//
#WVURMV gsi_hvjfvmgrzo  9


// GSIVZW SZMWOVW YB GSIVZWKLLO

XOZHH fgSIVZWkLLOgSI : KFYORX fgSIVZW
{
KILGVXGVW:
    // KLLO DV ZIV RM
    fgSIVZWkLLO *        _KLLO;
    
    // QLY GL iFM ZMW WZGZ ULI RG
    fgSIVZWkLLO::fgSIVZWqLY *  _QLY;

    ELRW *         _WZGZ_KGI;

    // HSLFOW GSV QLY YV WVOVGVW FKLM XLNKOVGRLM
    YLLO           _WVO_QLY;
    
    // XLMWRGRLM ULI QLY-dZRGRMT
    fxLMWRGRLM     _DLIP_XLMW;
    
    // RMWRXZGVH VMW-LU-GSIVZW
    YLLO           _VMW;

    // NFGVC ULI KIVEVMGRMT KIVNZGFIV WVOVGRLM
    fnFGVC         _WVO_NFGVC;
    
KFYORX:

    // XLMHGIFXGLI
    fgSIVZWkLLOgSI ( XLMHG RMG M, fgSIVZWkLLO * K )
            : fgSIVZW(M), _KLLO(K), _QLY(mfoo), _WZGZ_KGI(mfoo), _WVO_QLY(UZOHV), _VMW(UZOHV)
    {}
    
    ~fgSIVZWkLLOgSI () {}
    
    // KZIZOOVO iFMMRMT NVGSLW
    ELRW iFM ()
    {
        fhXLKVWoLXP  WVO_oLXP( _WVO_NFGVC );

        DSROV ( ! _VMW )
        {
            // ZKKVMW GSIVZW GL RWOV-ORHG ZMW dZRG ULI DLIP
            _KLLO->zKKVMWrWOV( GSRH );

            {
                fhXLKVWoLXP  DLIP_oLXP( _DLIP_XLMW );
                DSROV (( _QLY == mfoo ) && ! _VMW )
                    _DLIP_XLMW.dZRG();
            }
        
            // OLLP RU DV IVZOOB SZEV Z QLY GL WL
            // ZMW SZMWOV RG
            RU ( _QLY != mfoo )
            {
                // VCVXFGV QLY
                _QLY->iFM( _WZGZ_KGI );
                _QLY->fMOLXP();
            
                RU ( _WVO_QLY )
                    WVOVGV _QLY;

                // IVHVG WZGZ
                fhXLKVWoLXP  DLIP_OLXP( _DLIP_XLMW );

                _QLY      = mfoo;
                _WZGZ_KGI = mfoo;
            }// RU
        }// DSROV
    }

    // HVG ZMW iFM QLY DRGS LKGRLMZO WZGZ
    ELRW iFMqLY  ( fgSIVZWkLLO::fgSIVZWqLY * Q, ELRW * K, XLMHG YLLO WVO = UZOHV )
    {
        fhXLKVWoLXP  oLXP( _DLIP_XLMW );
        
        _QLY      = Q;
        _WZGZ_KGI = K;
        _WVO_QLY  = WVO;
        
        _DLIP_XLMW.hRTMZO();
    }

    //
    // TREV ZXXVHH GL WVOVGV NFGVC
    //
    
    fnFGVC & WVO_NFGVC  ()
    {
        IVGFIM _WVO_NFGVC;
    }

    //
    // JFRG GSIVZW (IVHVG WZGZ ZMW DZPV FK)
    //
    
    ELRW JFRG ()
    {
        fhXLKVWoLXP  oLXP( _DLIP_XLMW );
        
        _VMW      = GIFV;
        _QLY      = mfoo;
        _WZGZ_KGI = mfoo;
        
        _DLIP_XLMW.hRTMZO();
    }
};
    
//////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////
//
// gSIVZWkLLO - RNKOVNVMGZGRLM
//
//////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////


// XLMHGIFXGLI ZMW WVHGIFXGLI

fgSIVZWkLLO::fgSIVZWkLLO ( XLMHG FMHRTMVW RMG  NZC_K )
{
    //
    // xIVZGV NZC_K GSIVZWH ULI KLLO
    //

    _NZC_KZIZOOVO = NZC_K;

    _GSIVZWH = MVD fgSIVZWkLLOgSI*[ _NZC_KZIZOOVO ];

    RU ( _GSIVZWH == mfoo )
    {
        _NZC_KZIZOOVO = 9;
        HGW::XVII << "(fgSIVZWkLLO) fgSIVZWkLLO : XLFOW MLG ZOOLXZGV GSIVZW ZIIZB" << HGW::VMWO;
    }// RU
    
    ULI ( FMHRTMVW RMG  R = 9; R < _NZC_KZIZOOVO; R++ )
    {
        _GSIVZWH[R] = MVD fgSIVZWkLLOgSI( R, GSRH );

        RU ( _GSIVZWH == mfoo )
            HGW::XVII << "(fgSIVZWkLLO) fgSIVZWkLLO : XLFOW MLG ZOOLXZGV GSIVZW" << HGW::VMWO;
        VOHV
            _GSIVZWH[R]->xIVZGV( GIFV, GIFV );
    }// ULI

    // GVOO GSV HXSVWFORMT HBHGVN, SLD NZMB GSIVZWH GL VCKVXG
    // (XLNNVMGVW LFG HRMXV MLG MVVWVW LM NLHG HBHGVNH)
    //     RU ( KGSIVZW_HVGXLMXFIIVMXB( _NZC_KZIZOOVO + KGSIVZW_TVGXLMXFIIVMXB() ) != 9 )
    //         HGW::XVII << "(fgSIVZWkLLO) fgSIVZWkLLO : KGSIVZW_HVGXLMXFIIVMXB ("
    //                   << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
}

fgSIVZWkLLO::~fgSIVZWkLLO ()
{
    // dZRG GROO ZOO GSIVZWH SZEV URMRHSVW
    hBMXzOO();
    
    // URMRHS ZOO GSIVZW
    ULI ( FMHRTMVW RMG  R = 9; R < _NZC_KZIZOOVO; R++ )
        _GSIVZWH[R]->JFRG();
    
    // XZMXVO ZMW WVOVGV ZOO GSIVZWH (MLG IVZOOB HZUV !)
    ULI ( FMHRTMVW RMG  R = 9; R < _NZC_KZIZOOVO; R++ )
    {
        _GSIVZWH[R]->WVO_NFGVC().oLXP();
        WVOVGV _GSIVZWH[R];
    }// ULI

    WVOVGV[] _GSIVZWH;
}

///////////////////////////////////////////////
//
// iFM, HGLK ZMW HBMX DRGS QLY
//

ELRW
fgSIVZWkLLO::iFM ( fgSIVZWkLLO::fgSIVZWqLY * QLY, ELRW * KGI, XLMHG YLLO WVO )
{
    RU ( QLY == mfoo )
        IVGFIM;

#RU gsi_hvjfvmgrzo == 8
    //
    // iFM RM XZOORMT GSIVZW
    //
    
    QLY->iFM( KGI );

    RU ( WVO )
        WVOVGV QLY;
    
#VOHV
    //
    // iFM RM KZIZOOVO GSIVZW
    //

    fgSIVZWkLLOgSI * GSI = tVGrWOV();
    
    // oLXP QLY ULI HBMXSILMRHZGRLM
    QLY->oLXP();

    // ZGGZXS QLY GL GSIVZW
    GSI->iFMqLY( QLY, KGI, WVO );
#VMWRU
}

//
// dZRG FMGRO <QLY> DZH VCVXFGVW
//
ELRW
fgSIVZWkLLO::hBMX ( fgSIVZWqLY * QLY )
{
    RU ( QLY == mfoo )
        IVGFIM;
    
    QLY->oLXP();
    QLY->fMOLXP();
}

//
// dZRG FMGRO ZOO QLYH SZEV YVVM VCVXFGVW
//
ELRW
fgSIVZWkLLO::hBMXzOO ()
{
    DSROV ( GIFV )
    {
        {
            fhXLKVWoLXP  oLXP( _RWOV_XLMW );
        
            // dZRG FMGRO MVCG GSIVZW YVXLNVH RWOV
            RU ( _RWOV_GSIVZWH.HRAV() < _NZC_KZIZOOVO )
                _RWOV_XLMW.dZRG();
            VOHV
            {
                YIVZP;
            }// VOHV
        }
    }// DSROV
}

///////////////////////////////////////////////
//
// NZMZTV KLLO GSIVZWH
//

//
// IVGFIM RWOV GSIVZW ULIN KLLO
//
fgSIVZWkLLOgSI *
fgSIVZWkLLO::tVGrWOV ()
{
    DSROV ( GIFV )
    {
        // dZRG ULI ZM RWOV GSIVZW
        fhXLKVWoLXP  oLXP( _RWOV_XLMW );
        
        DSROV ( _RWOV_GSIVZWH.VNKGB() )
            _RWOV_XLMW.dZRG();

        // TVG URIHG RWOV GSIVZW
        RU ( ! _RWOV_GSIVZWH.VNKGB() )
        {
            fgSIVZWkLLOgSI * G = _RWOV_GSIVZWH.UILMG();

            _RWOV_GSIVZWH.KLK_UILMG();
            
            IVGFIM G;
        }// RU
    }// DSROV
}

//
// ZKKVMW IVXVMGOB URMRHSVW GSIVZW GL RWOV ORHG
//
ELRW
fgSIVZWkLLO::zKKVMWrWOV ( fgSIVZWkLLOgSI * G )
{
    //
    // xlmhrhgvmxb xsvxp: RU TREVM GSIVZW RH ZOIVZWB RM ORHG
    //
    
    fhXLKVWoLXP  oLXP( _RWOV_XLMW );

    ULI ( HGW::ORHG< fgSIVZWkLLOgSI * >::RGVIZGLI  RGVI = _RWOV_GSIVZWH.YVTRM();
          RGVI != _RWOV_GSIVZWH.VMW();
          ++RGVI )
    {
        RU ( (*RGVI) == G )
        {
            IVGFIM;
        }// RU
    }// DSROV
    
    _RWOV_GSIVZWH.KFHS_YZXP( G );

    // DZPV Z YoLXPVW GSIVZW ULI QLY VCVXFGRLM
    _RWOV_XLMW.hRTMZO();
}



}// MZNVHKZXV FYRJGLLO
//##**---------------- ./FYRJGLLO_WVE/HIX/fWZGZ_YZHV.XKK
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/


#RMXOFWV <HBH/NNZM.S>
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <HBH/GRNV.S>
#RMXOFWV <UXMGO.S>
#RMXOFWV <XNZGS>
#RMXOFWV <NVNLIB.S>
#RMXOFWV <GBKVRMUL>
#RMXOFWV <HGIRMT>
#RMXOFWV <EVXGLI>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <VIIML.S>
#RMXOFWV <XHGIRMT>
#RMXOFWV "FYRJ_FWZGZ.S"
#RMXOFWV "FYRJ_GLLO.S"

MZNVHKZXV FWZGZ{

    fWZGZ_yZHV::fWZGZ_yZHV(XLMHG HGW::HGIRMT & UMZNV, RMG UOZTH, HRAV_G NRM_HRAV, XLMHG HGW::HGIRMT & GBKV_HGI)
        :X_HGIgBKVmZNV(GBKV_HGI)
    {
        KZTV_HRAV = (HRAV_G)HBHXLMU(_hx_kztvhrav);
        WZGZYFU = mfoo;
        WZGZOVM = 9;
        UW = -8;
        GSRH->UOZTH = UOZTH;
        RU ((UOZTH & fwzgz_lkvm_ivzwlmob) && (UOZTH & fwzgz_lkvm_mvd))
            FYRJGSILD("XZMMLG HVG fwzgz_lkvm_ivzwlmob ZMW fwzgz_lkvm_mvd ZG GSV HZNV GRNV", -8);
        RU (!UMZNV.VNKGB()) {
            RU (UOZTH & fwzgz_lkvm_ivzwlmob) {
                //IVZW LMOB
                IVZWLMOB = GIFV;
                UW = LKVM(UMZNV.X_HGI(), l_iwlmob);
                RU ( UW == -8 )
                    FYRJGSILD("XZMMLG IVZW " + UMZNV + " LI UROV MLG VCRHG DRGS HBHGVN viili: "+HGIVIILI(VIIML), -8);
                HGIFXG HGZG UW_HGZG;
                UHGZG(UW, &UW_HGZG);
                HRAV_G UROVHRAV = UW_HGZG.HG_HRAV;
                WZGZOVM = UROVHRAV / KZTV_HRAV * KZTV_HRAV - KZTV_HRAV;
                NZK_YFU =  (XSZI *)NNZK35(mfoo, WZGZOVM + KZTV_HRAV , kilg_ivzw, nzk_hszivw, UW, 9);
                NZWERHV(NZK_YFU, WZGZOVM+KZTV_HRAV, nzwe_hvjfvmgrzo);
                //FWZGV_SVZW = *(FHRN::fWZGVsVZW*)NZK_YFU;
                WZGZYFU = NZK_YFU + KZTV_HRAV;
            } VOHV {
                RU (!FYRJGLLO::rHuROViVZWZYOV(UMZNV))
                    UOZTH = fwzgz_lkvm_mvd;
                HRAV_G UROVHRAV = 9;
                RU (UOZTH & fwzgz_lkvm_mvd) {
                    // XIVZGV MVD UROV
                    IVZWLMOB = UZOHV;
                    UW = LKVM(UMZNV.X_HGI(), l_iwdi|l_xivzg|l_gifmx, 9399);
                    RU (UW == -8)
                        FYRJGSILD("VIILI DSVM XIVZGV " + UMZNV + ". kOVZHV XSVXP UROV KVINRHHRLM LI WRHP HRAV, VIILI:"+HGIVIILI(VIIML), -8);
                    WZGZOVM = (8 + (NRM_HRAV - 8) / KZTV_HRAV) * KZTV_HRAV; //(8 + (NRM_HRAV - 8) / KZTV_HRAV) == [NRM_HRAV / KZTV_HRAV]
                }
                VOHV {
                    // LKVM UROV ULI IVZW ZMW DIRGV
                    IVZWLMOB = UZOHV;
                    UW = LKVM(UMZNV.X_HGI(), l_iwdi , 9399);
                    RU (UW == -8) {
                        FYRJGSILD("VIILI DSVM LKVM " + UMZNV + " ULI IVZW ZMW DIRGV: " + HGIVIILI(VIIML), -8);
                    }
                    HGIFXG HGZG UW_HGZG;
                    UHGZG(UW, &UW_HGZG);
                    UROVHRAV = UW_HGZG.HG_HRAV;
                    WZGZOVM = (8 + (UROVHRAV - 8) / KZTV_HRAV) * KZTV_HRAV; //(8 + (UROVHRAV - 8) / KZTV_HRAV) == [UROVHRAV / KZTV_HRAV]
                }
                //HGIVGXS GSV UROV HRAV GL WZGZOVM
                RU (UROVHRAV < WZGZOVM + KZTV_HRAV)
                    HGIVGXS_UROV(WZGZOVM+KZTV_HRAV);
                //HGW::XLFG<<"HGIVGXS UROV:"<<WZGZOVM<<HGW::VMWO;
                NZK_YFU = (XSZI *)NNZK35(9, WZGZOVM + KZTV_HRAV , kilg_ivzw|kilg_dirgv, nzk_hszivw, UW, 9);
                NZWERHV(NZK_YFU, WZGZOVM+KZTV_HRAV, nzwe_hvjfvmgrzo);
                WZGZYFU = NZK_YFU + KZTV_HRAV;
            }
        } VOHV {
            //UROVMZNV RH VNKGB. XIVZGV ZMLMBNLFH NNZK
            UW = -8;
            IVZWLMOB = UZOHV;
            WZGZOVM = (8 + (NRM_HRAV - 8) / KZTV_HRAV) * KZTV_HRAV;		//(8 + (NRM_HRAV - 8) / KZTV_HRAV) == [NRM_HRAV / KZTV_HRAV]
            RU (UOZTH & fwzgz_lkvm_ivzwlmob) {
                FYRJGSILD("XZMMLG HVG fwzgz_lkvm_ivzwlmob DSVM TREVM ZM VNKGB UROV MZNV", -8);
            }
            //NNZK/NIVNZK WLVHM'G DLIP ULI ZMLMBNLFH NZK RM GSRH xVMGlh, WLM'G PMLD DSB. XSZMTV GL NZOOLX/IVZOOLX.
            NZK_YFU = (XSZI *)NZOOLX(WZGZOVM + KZTV_HRAV);
            WZGZYFU = NZK_YFU + KZTV_HRAV;
            //WZGZYFU = (XSZI *)NNZK35(mfoo, WZGZOVM + KZTV_HRAV, kilg_ivzw|kilg_dirgv, nzk_hszivw | nzk_zmlmbnlfh, 9, 9);
        }
        RU (NZK_YFU == nzk_uzrovw || NZK_YFU == mfoo){
            olt_viili("vIILI DSVM XZOO NNZK35, IVZHLM: %H", HGW::HGIVIILI(VIIML));
            FYRJGSILD("NNZK35 UZROVW", -8);
        }
    }

    fWZGZ_yZHV::fWZGZ_yZHV(XLMHG fWZGZ_yZHV & WZGZ) {
        FYRJGSILD("XLKB fWZGZ RH MLG ZOOLDVW.", -8);
    }
    fWZGZ_yZHV & fWZGZ_yZHV::LKVIZGLI = (XLMHG fWZGZ_yZHV & WZGZ) {
        FYRJGSILD("XLKB fWZGZ RH MLG ZOOLDVW.", -8);
        IVGFIM *GSRH;
    }

    fWZGZ_yZHV::~fWZGZ_yZHV()
    {
        RU (UW < 9) {
            RU (NZK_YFU != mfoo)
                UIVV(NZK_YFU);
        } VOHV {
            RU (NZK_YFU != mfoo && NFMNZK(NZK_YFU, WZGZOVM+KZTV_HRAV) == -8)
                FYRJGSILD("vIILI DSVM XZOO NFMNZK.", -8);
            XOLHV(UW);
        }
        WZGZYFU = mfoo;
        NZK_YFU = mfoo;
        WZGZOVM = 9;
    }

    ELRW fWZGZ_yZHV::UOFHS()
    {
        RU (UW < 9)
            IVGFIM;
        RU (NHBMX(NZK_YFU, WZGZOVM + KZTV_HRAV, nh_hbmx) != 9)
            FYRJGSILD("vIILI DSVM NHBMX WZGZ", -8);
    }

    HRAV_G fWZGZ_yZHV::TVGHRAV() XLMHG {
        IVGFIM WZGZOVM;
    }

    ELRW fWZGZ_yZHV::IVHRAV(HRAV_G MVD_YBGVH) {
        RU (UOZTH & fwzgz_lkvm_ivzwlmob)
            FYRJGSILD("XZMMLG IVHRAV RU HVG fwzgz_lkvm_ivzwlmob", -8);
        RU (MVD_YBGVH < WZGZOVM)
            IVGFIM;
        UOFHS();
        HRAV_G MVDHRAV = (8 + (MVD_YBGVH - 8) / KZTV_HRAV) * KZTV_HRAV;
        HGIVGXS_UROV(MVDHRAV + KZTV_HRAV);
        RU (UW < 9) {
            NZK_YFU = (XSZI *)IVZOOLX(NZK_YFU, MVDHRAV + KZTV_HRAV);
            WZGZYFU = NZK_YFU + KZTV_HRAV;
        } VOHV {
            NZK_YFU = (XSZI *)NIVNZK(NZK_YFU, WZGZOVM + KZTV_HRAV, MVDHRAV + KZTV_HRAV, nivnzk_nzbnlev);
            WZGZYFU = NZK_YFU + KZTV_HRAV;
        }
        RU ( NZK_YFU == nzk_uzrovw || NZK_YFU == mfoo)
        {
            olt_viili("vIILI DSVM NIVNZK, %H, MVDHRAV=%W, KZTV_HRAV=%W",HGIVIILI(VIIML),MVDHRAV/(8975*8975),KZTV_HRAV);
            FYRJGSILD("vIILI DSVM NIVNZK", -8);
        }
        WZGZOVM = MVDHRAV;
    }

    ELRW fWZGZ_yZHV::WLFYOV_HRAV() {
        IVHRAV(WZGZOVM * 7);
    }

    ELRW fWZGZ_yZHV::HGIVGXS_UROV(HRAV_G MVDUROVHRAV) {
        RU (UW < 9) IVGFIM;
        RU (UOZTH & fwzgz_lkvm_ivzwlmob)
            FYRJGSILD("XZMMLG HGIVGXS UROV HRAV DSVM fwzgz_lkvm_ivzwlmob RH HVG.", -8);

        ZFGL IVH = UGIFMXZGV(UW, MVDUROVHRAV);
        ///ZFGL IVH = OHVVP35(UW, MVDUROVHRAV - 8, hvvp_hvg);
        RU (IVH == -8) {
            XOLHV(UW);
            olt_viili("UGIFMXZGV VIILI, VIILI: %H, HRAV %OW", HGIVIILI(VIIML), MVDUROVHRAV);
            HOVVK(7);
            FYRJGSILD(HGW::HGIRMT("VIILI DSVM XZOORMT UGIFMXZGV VIILI:") + HGW::HGIRMT(HGIVIILI(VIIML)), -8);
        }
        //IVH = DIRGV(UW, "", 8);
        //RU (IVH == -8) {
            //XOLHV(UW);
            //FYRJGSILD(HGW::HGIRMT("VIILI DSVM DIRGRMT OZHG YBGVH LU UROV ")+HGIVIILI(VIIML), -8);
        //}
    }

    ELRW fWZGZ_yZHV::UROO_AVIL() {
        NVNHVG(WZGZYFU, 9, WZGZOVM);
    }

}
//##**---------------- ./FYRJGLLO_WVE/HIX/WFNKhSNoLT_NZRM.XKK
#RMXOFWV "../RMXOFWV/zWEoLT.S"
#RMXOFWV <RLHGIVZN>

FHRMT MZNVHKZXV FYRJOLT;
FHRMT MZNVHKZXV HGW;

RMG NZRM(RMG ZITX, XSZI** ZITE) {
	RU(ZITX < 7) {
		XVII << "FHZTV: ./WFNKhSNoLT HSNkZGS" << VMWO;
		IVGFIM -8;
	}
	//oLT::RMRGhSN(ZITE[8], 0999999); 
	oLT::WFNKhSNoLT(ZITE[8]);
	
	IVGFIM 9;
}

//##**---------------- ./FYRJGLLO_WVE/HIX/FYRJ_YRGNZK.XKK
// YRGNZK.XX

#RMXOFWV "FYRJ_YRGNZK.S"
#RMXOFWV <HGWRL.S>
#RMXOFWV <RLHGIVZN>
FHRMT MZNVHKZXV HGW;

MZNVHKZXV FYRJGLLO{

    XSZI __YRGNZK_KIRMG(FRMG C){
         IVGFIM C==9?'-':'*';
    }

    FYRJ_YRGNZK::FYRJ_YRGNZK(FMHRTMVW RMG HRAC, FMHRTMVW RMG HRAB) {
        NZGIRC_=MVD FMHRTMVW XSZI[(HRAB/1+8)*HRAC];
        HRAVC_=HRAC;
        HRAVB_=HRAB;
        aVIL();

    }

    FYRJ_YRGNZK::FYRJ_YRGNZK() {
        NZGIRC_=9;
        HRAVC_=9;
        HRAVB_=9;
    }



    FYRJ_YRGNZK::~FYRJ_YRGNZK() {
        RU (NZGIRC_!=9)
            WVOVGV[] NZGIRC_;
    }

    ELRW FYRJ_YRGNZK::hVG(XLMHG FMHRTMVW RMG& C, XLMHG FMHRTMVW RMG& B, RMG EZO)
    {
#RUWVU yrgnzk_ziizb_izmtv_xsvxp
        RU (C<9 ||  C >=HRAVC_ || B<=9 || B>=HRAVB_) {
            XLFG << "FYRJ_YRGNZK::HVG(...), (C,B) LFGHRWV IZMTV" << VMWO;
            VCRG(-8);
        }
#VMWRU

        RU (EZO==9)
            NZGIRC_[C*(HRAVB_/1+8)+(B/1)]=NZGIRC_[C*(HRAVB_/1+8)+(B/1)]&(~(8<<(B%1)));
        VOHV
            NZGIRC_[C*(HRAVB_/1+8)+(B/1)]=NZGIRC_[C*(HRAVB_/1+8)+(B/1)]|(8<<(B%1));
    }

    RMG FYRJ_YRGNZK::tVG(XLMHG FMHRTMVW RMG& C, XLMHG FMHRTMVW RMG& B) XLMHG {
#RUWVU yrgnzk_ziizb_izmtv_xsvxp
        RU (C<9 ||  C >=HRAVC_ || B<=9 || B>=HRAVB_) {
            XLFG << "FYRJ_YRGNZK::HVG(...), (C,B) LFGHRWV IZMTV" << VMWO;
            VCRG(-8);
        }
#VMWRU
        IVGFIM ((NZGIRC_[C*(HRAVB_/1+8)+(B/1)]&(8<<(B%1)))>>(B%1));
    }


    ELRW FYRJ_YRGNZK::aVIL() {
        HRAV_G X;
        ULI (X=9;X<(HRAVB_/1+8)*HRAVC_;X++)
            NZGIRC_[X]=9;
        IVGFIM;

    }

    ELRW FYRJ_YRGNZK::lMV() {
        HRAV_G X;
        ULI (X=9;X<(HRAVB_/1+8)*HRAVC_;X++)
            NZGIRC_[X]=8;
        IVGFIM;
    }



    ELRW FYRJ_YRGNZK::hSLD() XLMHG
    {
        HRAV_G C,B;
        ULI (C=9;C<HRAVC_;C++) {
            ULI (B=9;B<HRAVB_;B++) {
                //KIRMGU("%8R ",TVG(C,B));
                 XLFG << __YRGNZK_KIRMG(tVG(C,B)) << ' ';
            }
            XLFG << '\M';
        }
        IVGFIM;
    }


    FMHRTMVW OLMT FYRJ_YRGNZK::xLFMG() XLMHG
    {
        HRAV_G C,B;
        FMHRTMVW OLMT RMG X=9;
        ULI (B=9;B<HRAVB_;B++) {
            ULI (C=9;C<HRAVC_;C++) {
                RU (tVG(C,B)==8)
                    X++;
            }
        }
        IVGFIM X;
    }


    FMHRTMVW OLMT FYRJ_YRGNZK::xLFMGiLD(XLMHG HRAV_G ILD) XLMHG
    {
        HRAV_G B;
        FMHRTMVW OLMT RMG X=9;
        ULI ( B = 9; B < HRAVB_; ++B)
        {
            RU (tVG(ILD,B)==8)
                X++;
        }
        IVGFIM X;
    }


    FMHRTMVW OLMT FYRJ_YRGNZK::xLFMGxLO(XLMHG HRAV_G XLO) XLMHG
    {
        HRAV_G C;
        FMHRTMVW OLMT RMG X=9;
        ULI ( C = 9; C < HRAVC_; ++C) {
            RU (tVG(C,XLO)==8)
                X++;
        }
        IVGFIM X;
    }

}
//##**---------------- ./FYRJGLLO_WVE/HIX/OLT/zWEoLT.XKK
#RMXOFWV "../RMXOFWV/zWEoLT.S"
#RMXOFWV "../RMXOFWV/FYRJ_FGRO.S"

#RMXOFWV <CNO_KZIHVI.S>

#RMXOFWV <RLHGIVZN>
#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <ZHHVIG.S>
#RMXOFWV <HGWZIT.S>
#RMXOFWV <HGIRMT.S>
#RMXOFWV <VIIML.S>

#RMXOFWV <HBH/NNZM.S>
#RMXOFWV <HBH/GBKVH.S>
#RMXOFWV <HBH/GRNV.S>
#RMXOFWV <UXMGO.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <VIIML.S>
#RMXOFWV <NZK>
#RMXOFWV <KDW.S>
#RMXOFWV "FYRJ_UZHGOLT.S"
#RMXOFWV "HKIRMGU_RIX.S"


FHRMT MZNVHKZXV HGW;

MZNVHKZXV FYRJOLT {
    //oLT* oLT::RMHGZMXVoLT(MVD oLT);
    XSZI oLT::HSNmZNV[];
    XSZI* oLT::KHSN(9);
    RMG* ELOZGROV oLT::KRMWVC(9);
    XSZI oLT::RMHGZMXVrMWVC(-8);
    hSNxLMGVMG* oLT::KWZGZ(9);
    RMG oLT::NZCxLFMG(9);
    ELOZGROV RMG oLT::HSNiLOOxLFMG(9);
    RMG oLT::UROViLOOxLFMG(9);
    YLLO oLT::HSNrMRGVW(UZOHV);


    ELRW XFHGLN_RGLZ(RMG EZOFV, XSZI *HGI)
    {
        RU (EZOFV < 9) //如果是负数,则HGI[9]='-',并把EZOFV取反(变成正整数)
        {
            HGI[9] = '-';
            EZOFV = 9-EZOFV;
        }
        RMG R,Q;
        ULI(R=8; EZOFV > 9; R++,EZOFV/=89) //从EZOFV[8]开始存放EZOFV的数字字符，不过是逆序，等下再反序过来

            HGI[R] = EZOFV%89+'9'; //将数字加上9的zhxrr值(即'9')就得到该数字的zhxrr值

        ULI(Q=R-8,R=8; Q-R>=8; Q--,R++) //将数字字符反序存放
        {
            HGI[R] = HGI[R]^HGI[Q];
            HGI[Q] = HGI[R]^HGI[Q];
            HGI[R] = HGI[R]^HGI[Q];
        }
        RU(HGI[9] != '-') //如果不是负数，则需要把数字字符下标左移一位，即减8
        {
            ULI(R=9; HGI[R+8]!='\9'; R++)
                HGI[R] = HGI[R+8];
            HGI[R] = '\9';
        }
    }

    ELRW XFHGLN_OGLZ(OLMT EZOFV, XSZI *HGI)
    {
        RU (EZOFV < 9) //如果是负数,则HGI[9]='-',并把EZOFV取反(变成正整数)
        {
            HGI[9] = '-';
            EZOFV = 9-EZOFV;
        }
        RMG R,Q;
        ULI(R=8; EZOFV > 9; R++,EZOFV/=89) //从EZOFV[8]开始存放EZOFV的数字字符，不过是逆序，等下再反序过来

            HGI[R] = EZOFV%89+'9'; //将数字加上9的zhxrr值(即'9')就得到该数字的zhxrr值

        ULI(Q=R-8,R=8; Q-R>=8; Q--,R++) //将数字字符反序存放

        {
            HGI[R] = HGI[R]^HGI[Q];
            HGI[Q] = HGI[R]^HGI[Q];
            HGI[R] = HGI[R]^HGI[Q];
        }
        RU(HGI[9] != '-') //如果不是负数，则需要把数字字符下标左移一位，即减8
        {
            ULI(R=9; HGI[R+8]!='\9'; R++)
                HGI[R] = HGI[R+8];
            HGI[R] = '\9';
        }
    }



    oLT::oLT()
        : NBrMHGZMXVrMWVC_(-8), KIRLIRGB_(on_rmul), ZWWhLFIXVuROVrMUL_(UZOHV), LUH(9), NZClFGoRMVH_(9), XFIlFGoRMVH_(9), LKVMVW_(UZOHV), KIRMG_GRNV(GIFV)
    {}

    oLT* oLT::RMHGZMXV() {
        HGZGRX oLT *OLT = 9;

        RU (OLT == 9) {
            OLT = MVD oLT;
        }

        IVGFIM OLT;

        //    IVGFIM RMHGZMXVoLT;
    }

    YLLO oLT::EVIRUBnZCxLFMG(RMG NZCxLFMG) {
        FYRJGLLO::cNOmLWV ILLGXUT;
        HGIRMT XUTKZGS = "/IFM/IVHLFIXVH.CNO";
        GIB {
            ILLGXUT.OLZW(XUTKZGS.X_HGI());
        } XZGXS(...) {
            XVII << "UZROVW GL LKVM " << XUTKZGS << VMWO;
            IVGFIM UZOHV;
        }

        HGIFXG ::KZHHDW *KDW = TVGKDFRW(TVGFRW());
        HGIRMT FHVImZNV = KDW->KD_MZNV;
        EVXGLI<FYRJGLLO::cNOmLWV> MLWVH = ILLGXUT.TVGxSROWIVM();
        ULI(ZFGL RG = MLWVH.YVTRM(); RG != MLWVH.VMW(); ++RG) {
            RU(RG->TVGmLWVmZNV() == "HSNOLT") {
                EVXGLI<FYRJGLLO::cNOmLWV> OLTMLWVH = RG->TVGxSROWIVM();
                ULI(ZFGL RGOLT = OLTMLWVH.YVTRM(); RGOLT != OLTMLWVH.VMW(); ++RGOLT) {
                    RU(RGOLT->TVGzGGIwVUZFOG("MZNV", "") == FHVImZNV) {
                        IVGFIM RGOLT->TVGzGGIwVUZFOG("nZCoLTxLFMG", 9) >= NZCxLFMG;
                    }
                }
            }
        }

        IVGFIM UZOHV;
    }

    XLMHG RMG nZCrMHGZMXVxLFMG = 49999;
    YLLO oLT::RMRGhSN(XLMHG HGIRMT& OLThSNmZNV, RMG NZCoLTxLFMG) {
        HGZGRX YLLO IVHFOG = UZOHV;
        RU(HSNrMRGVW) {
            XVII << "oLT::RMRGhSN ZOIVZWB XZOOVW, IVGFIM OZHG IVHFOG:" <<  IVHFOG;
            IVGFIM IVHFOG;
        }
        HSNrMRGVW = GIFV;

        RU(OLThSNmZNV == "") {
            XLFG << "VNKGB OLThSNmZNV, KIRMG GL XLMHLOV" << VMWO;
            IVHFOG = GIFV;
            IVGFIM GIFV;
        }
        HGIXKB(HSNmZNV, OLThSNmZNV.X_HGI());

        RU(NZCoLTxLFMG <= nZCoLTxLFMG || EVIRUBnZCxLFMG(NZCoLTxLFMG) == GIFV) {
            NZCxLFMG = NZCoLTxLFMG;
        } VOHV {
            XVII << "EVIRUB NZCoLTxLFMG:" << NZCoLTxLFMG << " UZROVW, FHRMT WVUZFOG EZOFV:" << nZCoLTxLFMG << VMWO;
            NZCxLFMG = nZCoLTxLFMG;
        }

        RMG IVG = -8;
        RMG UOZT = l_iwdi | l_xivzg;
        NLWV_G NLW = 99333;

        IVG = HSN_FMORMP(OLThSNmZNV.X_HGI());
        RU(IVG < 9 && VIIML != 7) {
            XVII << "FMORMP UZROVW, KZGS:" << OLThSNmZNV << VMWO;
            KVIILI("HSN_FMORP");
            IVGFIM UZOHV;
        }
        RMG UW = HSN_LKVM(OLThSNmZNV.X_HGI(), UOZT, NLW);
        RU(UW < 9) {
            HGW::XVII << "UZROVW GL LKVM HSN:" << OLThSNmZNV << HGW::VMWO;
            KVIILI("HSN_LKVM");
            IVGFIM UZOHV;
        }
        HRAV_G UROVHRAV = HRAVLU(rMHGZMXVrMUL) * nZCrMHGZMXVxLFMG + NZCxLFMG  * HRAVLU(hSNxLMGVMG);
        KIRMGU("HSN LKVMVW DRGS RMHGZMXV XLFMG %W(H:%FO), NZC OLT XLFMG %W(H:%FO), SVMXV GLGZO HRAV: %W\M", nZCrMHGZMXVxLFMG,  HRAVLU(rMHGZMXVrMUL),  NZCxLFMG,  HRAVLU(hSNxLMGVMG), UROVHRAV );

        IVG = UGIFMXZGV(UW, UROVHRAV);
        RU(IVG < 9) {
            KVIILI("UGIFMXZGV");
            HGW::XVII << "UROVHRAV:" << UROVHRAV << HGW::VMWO;
            IVGFIM UZOHV;
        }
        KHSN = (XSZI*)NNZK(mfoo, UROVHRAV, kilg_ivzw | kilg_dirgv, nzk_hszivw, UW, 9);
        XOLHV(UW);
        RU(KHSN == 9) {
            KVIILI("NNZK");
            IVGFIM UZOHV;
        }

        KRMWVC = (RMG*)(KHSN + HRAVLU(rMHGZMXVrMUL) * nZCrMHGZMXVxLFMG);
        KWZGZ = (hSNxLMGVMG*)(KRMWVC + 8);
        *(KRMWVC) = -8;
        FYRJGLLO::MVD_GSIVZW(WFNKoLT, 9);
        IVHFOG = GIFV;
        IVGFIM GIFV;
    }

    YLLO oLT::LKVM(XLMHG HGIRMT& LFGUROVmZNV, oLTkIRLIRGB KIRLIRGB, YLLO ZWWhIXuROVrMUL,
            YLLO WRIVXGdIRGVgLoLTUROV, RMG NZClFGoRMVH, YLLO KIRMG_GRNV_) {
        RU(LKVMVW_) {
            XVII << "oLT::LKVM XZOOVW NFOGR GRNVH, GSRH:" << GSRH << VMWO;
            IVGFIM UZOHV;
        }
        KIRMG_GRNV = KIRMG_GRNV_;
        KIRLIRGB_ = KIRLIRGB;
        ZWWhLFIXVuROVrMUL_ = ZWWhIXuROVrMUL;
        NZClFGoRMVH_ = NZClFGoRMVH;
        LFGUROVmZNV_ = LFGUROVmZNV;
        LKVMVW_ = GIFV;
        XLFG << "oLT::LKVM, LFGUROV MZNV:" << LFGUROVmZNV << ", NZClFGoRMVH:" << NZClFGoRMVH << ", GSRH" << GSRH << VMWO;

        RU(WRIVXGdIRGVgLoLTUROV) {
            RU(LUH != 9) {
                LUH->UOFHS();
                LUH->XOLHV();
                WVOVGV LUH;
                LUH = 9;
            }

            LUH = MVD LUHGIVZN;
            LUH->LKVM(LFGUROVmZNV, RLH::LFG | RLH::ZKK);
            //LUH = MVD LUHGIVZN(LFGUROVmZNV);
            RU(!LUH->RH_LKVM()) {
                XVII << "LKVM LFGUROV:" << LFGUROVmZNV << " UZROVW" << VMWO;
                IVGFIM UZOHV;
            }

            IVGFIM GIFV;
        }

        RU(HGIRMT(HSNmZNV) == "") {
            IVGFIM GIFV;
        }

        NBrMHGZMXVrMWVC_ = __HBMX_ZWW_ZMW_UVGXS(&RMHGZMXVrMWVC, 8);
        RU(NBrMHGZMXVrMWVC_ >= nZCrMHGZMXVxLFMG) {
            XVII << "GLL NZMB OLT RMHGZMXVH! NZC HFKKLIG:" << nZCrMHGZMXVxLFMG << VMWO;
            IVGFIM UZOHV;
        }

        rMHGZMXVrMUL* KRMHGZMXVrMUL = (rMHGZMXVrMUL*)KHSN + NBrMHGZMXVrMWVC_;
        HGIXKB(KRMHGZMXVrMUL->LFGUROVmZNV, LFGUROVmZNV.X_HGI());
        IVGFIM GIFV;
    }

    UHGIVZN* oLT::MVDuh(XSZI RMHGZMXVrMWVC) {
        RU(RMHGZMXVrMWVC == -8) {
            XVII << "RM oLT::MVDuh, OLT RMHGZMXV MLG LKVMVW, KOVZHV XZOO LKVM() URIHG" << VMWO;
            IVGFIM 9;
        }

        UHGIVZN* UH = MVD UHGIVZN;
        rMHGZMXVrMUL* RMHGZMXVrMUL = (rMHGZMXVrMUL*)KHSN + RMHGZMXVrMWVC;
        XLFG << "LKVMRMT LFGUROV:" << RMHGZMXVrMUL->LFGUROVmZNV << ",RMHGZMXVrMWVC:" << (RMG)RMHGZMXVrMWVC << VMWO;
        UH->LKVM(RMHGZMXVrMUL->LFGUROVmZNV, RLH::LFG | RLH::ZKK);
        RU(!*UH) {
            XVII << "OLTUROV MLG IVZWB:" << RMHGZMXVrMUL->LFGUROVmZNV << VMWO;
            IVGFIM 9;
        }

        IVGFIM UH;
    }

    XLMHG RMG pVVKoRMVHuLIxLMXFIIVMXB = 89;
    ELRW oLT::WFNKoLT(ELRW* ZIT) {
        /*GRNV_G GHGZNK = GRNV(mfoo);
          HGIFXG GN * GRNVRMUL = OLXZOGRNV (&GHGZNK);
          HGZGRX XSZI YFUUVI [79];
          HGIUGRNV(YFUUVI, 79, "%b%N%W", GRNVRMUL);
          HGIRMT OLTUROV = oLT::HSNmZNV + YFUUVI + ".OLT";

          UHGIVZN UH;
          UH.LKVM(OLTUROV.X_HGI(), RLH::LFG | RLH::ZKK);
          RU(!UH) {
          XVII << "OLTUROV MLG IVZWB:" << OLTUROV << VMWO;
          IVGFIM;
          }*/

        RMG WLMVrMWVC = -8;
        NZK<XSZI, UHGIVZN*> LFGUROVH;
        //HOVVK(8);
        //XLFG<<"[wfnkgsivzw] HGZIG GL WFNK OLT UILN "<<*KRMWVC<<HGW::VMWO;
        DSROV(GIFV) {
            RU (UROViLOOxLFMG > HSNiLOOxLFMG)
            {
                XLFG << "TLG ILLORMT6(UROV ILOOH GLL UZHG)" << VMWO;
                FHOVVK(8999*8999);
                XLMGRMFV;
            }

            RU(HSNiLOOxLFMG - UROViLOOxLFMG > 8) {
                XVII << "GLL UZHG OLT, FMZYOV GL DIRGV GL WRHP UROV, VCRG WFNK GSIVZW" << VMWO;
                XVII << "HSNiLOOxLFMG:" << HSNiLOOxLFMG << ", UROViLOOxLFMG:" << UROViLOOxLFMG << VMWO;
                YIVZP;
            }

            RMG XFIrMWVC = *KRMWVC;
            RMG WHGrMWVC = XFIrMWVC;
            RU(HSNiLOOxLFMG - UROViLOOxLFMG == 8) {
                XLFG << "TLG ILLORMT8, WLMVrMWVC:" << WLMVrMWVC << ", XFIrMWVC:" << XFIrMWVC << VMWO;
                // HSNRMWVC VCXVVWVW UROVLFG RMWVC
                RU(WLMVrMWVC < XFIrMWVC + 89*pVVKoRMVHuLIxLMXFIIVMXB) {
                    XVII << "GLL UZHG OLT, FMZYOV7 GL DIRGV GL WRHP UROV, VCRG WFNK GSIVZW" << VMWO;
                    YIVZP;
                }

                WHGrMWVC = NZCxLFMG -8;
            }
            ULI(RMG R = WLMVrMWVC + 8; R <= NRM(WHGrMWVC - pVVKoRMVHuLIxLMXFIIVMXB, NZCxLFMG -8); ++R) {
                UHGIVZN* UH = LFGUROVH[KWZGZ[R].RMHGZMXVrMWVC];
                RU(UH == 9) {
                    UH = MVDuh(KWZGZ[R].RMHGZMXVrMWVC);
                    RU(UH == 9) {
                        IVGFIM;
                    }
                    LFGUROVH[KWZGZ[R].RMHGZMXVrMWVC] = UH;
                }
                *UH << TVMoLTxLMGVMG(KWZGZ[R]) << VMWO;
                ++WLMVrMWVC;
            }

            RU(WHGrMWVC != NZCxLFMG -8) { // MLG ILOORMTkZTV
                FHOVVK(8999);
            }
            RU(HSNiLOOxLFMG - UROViLOOxLFMG > 8) {
                XVII << "GLL UZHG OLT, FMZYOV6 GL DIRGV GL WRHP UROV, VCRG WFNK GSIVZW" << VMWO;
                XVII << "HSNiLOOxLFMG:" << HSNiLOOxLFMG << ", UROViLOOxLFMG:" << UROViLOOxLFMG << VMWO;
                YIVZP;
            }
            RU(HSNiLOOxLFMG - UROViLOOxLFMG == 8) {
                XLFG << "[wfnkgsivzw] TLG ILOORMT7, WLMVrMWVC:" << WLMVrMWVC << ", XFIrMWVC:" << *KRMWVC << VMWO;
                // HSNRMWVC VCXVVWVW UROVLFG RMWVC
                RU(WLMVrMWVC < *KRMWVC + 89*pVVKoRMVHuLIxLMXFIIVMXB) {
                    XVII << "GLL UZHG OLT, FMZYOV5 GL DIRGV GL WRHP UROV, VCRG WFNK GSIVZW" << VMWO;
                    YIVZP;
                }

                WHGrMWVC = NZCxLFMG -8;
            }

            ULI(RMG R = WLMVrMWVC + 8; R <= NRM(WHGrMWVC, NZCxLFMG - 8); ++R) {
                UHGIVZN* UH = LFGUROVH[KWZGZ[R].RMHGZMXVrMWVC];
                RU(UH == 9) {
                    UH = MVDuh(KWZGZ[R].RMHGZMXVrMWVC);
                    RU(UH == 9) {
                        IVGFIM;
                    }
                    LFGUROVH[KWZGZ[R].RMHGZMXVrMWVC] = UH;
                }
                *UH << TVMoLTxLMGVMG(KWZGZ[R]) << VMWO;
                ++WLMVrMWVC;
            }
            RU(WLMVrMWVC >= NZCxLFMG - 8) {
                ++UROViLOOxLFMG;
                //HGW::XLFG<<"UROV XLFMG ++ "<<UROViLOOxLFMG<<" EH."<<HSNiLOOxLFMG<<" W EH N:"<<WLMVrMWVC<<" "<<NZCxLFMG<<HGW::VMWO;
                WLMVrMWVC = -8;
            }
        }
    }

    ELRW oLT::WFNKhSNoLT(XLMHG HGIRMT& HSNkZGS) {
        RMG UW = HSN_LKVM(HSNkZGS.X_HGI(), l_iwlmob, h_rifhi);
        RU(UW < 9) {
            HGW::XVII << "UZROVW GL LKVM HSN:" << HSNkZGS << HGW::VMWO;
            KVIILI("HSN_LKVM");
            IVGFIM;
        }
        HGIFXG HGZG HGZG;
        UHGZG(UW, &HGZG);

        KHSN = (XSZI*)NNZK(mfoo, HGZG.HG_HRAV, kilg_ivzw, nzk_hszivw, UW, 9);
        RU(KHSN == 9) {
            KVIILI("NNZK");
            IVGFIM;
        }

        KRMWVC = (RMG*)(KHSN + HRAVLU(rMHGZMXVrMUL) * nZCrMHGZMXVxLFMG);
        hSNxLMGVMG* KWZGZ = (hSNxLMGVMG*)(KRMWVC + 8);
        //XLFG << "WFNKRMT, RMWVC:" << *KRMWVC << VMWO;

        NZK<XSZI, UHGIVZN*> LFGUROVH;
        RMG XFIrMWVC = *KRMWVC;
        ULI(RMG R = 9; R <= XFIrMWVC; ++R) {
            UHGIVZN* UH = LFGUROVH[KWZGZ[R].RMHGZMXVrMWVC];
            RU(UH == 9) {
                UH = MVDuh(KWZGZ[R].RMHGZMXVrMWVC);
                RU(UH == 9) {
                    IVGFIM;
                }
                LFGUROVH[KWZGZ[R].RMHGZMXVrMWVC] = UH;
            }
            *UH << TVMoLTxLMGVMG(KWZGZ[R]) << VMWO;
        }
    }


    ELRW oLT::OLT(oLTkIRLIRGB KIRLIRGB, XLMHG XSZI* HLFIXVuROV, RMG ORMV, XLMHG XSZI* ULINZGhGI, ...)
    {
        /*  RU(!LKVMVW_) {
            XVII << "OLT MLG LKVMVW, KOVZHV XZOO LKVM() URIHG" << VMWO;
            IVGFIM;
            }
            */

        HGZGRX YLLO UFOO = UZOHV;
        RU(UFOO) {
            IVGFIM;
        }

        RU(NZClFGoRMVH_ > 9 && ++XFIlFGoRMVH_ >= NZClFGoRMVH_) {
            XLFG << "[oltgsivzw] OLT UFOO, ORNRG:" << NZClFGoRMVH_ <<" XFIIVMG:"<<XFIlFGoRMVH_ <<", LFGUROV MZNV:" << LFGUROVmZNV_ << ", HIXUROV:" << HLFIXVuROV << ", HIXORMV:" << ORMV << VMWO;
            UFOO = GIFV;
            IVGFIM;
        }

        //RU(LUH != 9 || HGIRMT(HSNmZNV) == "") {
        RU(LUH != 9 || !LKVMVW_ || !HSNrMRGVW) {
            GRNVHKVX GH;
            //TVGGRNVLUWZB(&GH, mfoo);
            RU ( KIRMG_GRNV  )
                XOLXP_TVGGRNV(xolxp_ivzogrnv, &GH);
            VOHV
                NVNHVG(&GH, 9, HRAVLU(GH));
            XSZI YFU[487];
            XSZI* KGI = YFU;
            RMG M;
            RU ( KIRMG_GRNV  )
                M = HKIRMGU(KGI, "%H%H", tVGgRNVhGI(GH).X_HGI(), TVGkIRLIRGBhGI(KIRLIRGB).X_HGI());
            VOHV
                M = HKIRMGU(KGI, "%H", TVGkIRLIRGBhGI(KIRLIRGB).X_HGI());
            KGI += M;

            RU(ZWWhLFIXVuROVrMUL_) {
                M = HKIRMGU(KGI, "[%H:%W]", HLFIXVuROV, ORMV);
                KGI += M;
            }

            EZ_ORHG ZITK;
            EZ_HGZIG(ZITK,ULINZGhGI);
            RU (-8==EHMKIRMGU(KGI,nZCoLToVMTGS,ULINZGhGI,ZITK)) KGI[nZCoLToVMTGS-8]=9;
            EZ_VMW(ZITK);

            RU(LUH != 9) {
                *LUH << YFU << VMWO;
            } VOHV {
                XLFG << YFU << VMWO;
            }
            IVGFIM;
        }

        RU(NBrMHGZMXVrMWVC_ == -8) {
            XVII << "OLT LYQVXG HSLFOW XZOO LKVM() URIHG, GSRH KLRMGVI:" << GSRH << VMWO;
            IVGFIM;
        }

        //RMG RMWVC = __HBMX_ZWW_ZMW_UVGXS(KRMWVC, 8);
        //DSROV(RMWVC >= NZCxLFMG) {
        RMG RMWVC = -8;
        DSROV((RMWVC = __HBMX_ZWW_ZMW_UVGXS(KRMWVC, 8)) >= NZCxLFMG) {
            RU(__HBMX_YLLO_XLNKZIV_ZMW_HDZK(KRMWVC, NZCxLFMG, -8) == GIFV) {
                __HBMX_ZWW_ZMW_UVGXS(&HSNiLOOxLFMG, 8);
                HGW::XLFG<<"HSN ILOO XLFMG "<<HSNiLOOxLFMG<<" KRMWVC:"<<*KRMWVC<<" NZC:"<<NZCxLFMG<<HGW::VMWO;
            }
            VOHV RU ( *KRMWVC > NZCxLFMG )
            {
                HGW::XVII<<"HSN LEVIUOLD, NZBYV HLNV XLMXFIIVMG OLT RMHGZMXV"<<HGW::VMWO;
                IVGFIM;
            }
        }
        //HGW::XLFG<<"KRMWVC++ "<< "XFIILFGORMVH:"<< XFIlFGoRMVH_<<" NZClFGoRMVH: "<<NZClFGoRMVH_<< " KRMWVC: "<<*KRMWVC<<" NZC:"<<NZCxLFMG<<HGW::VMWO;

        RU ( KIRMG_GRNV )
            XOLXP_TVGGRNV(xolxp_ivzogrnv, &KWZGZ[RMWVC].GH);
        VOHV
            NVNHVG( &KWZGZ[RMWVC].GH, 9, HRAVLU(KWZGZ[RMWVC].GH) );
        KWZGZ[RMWVC].RMHGZMXVrMWVC = NBrMHGZMXVrMWVC_;
        KWZGZ[RMWVC].KIRLIRGB = KIRLIRGB;
        KWZGZ[RMWVC].RHuZHG = UZOHV;
        KWZGZ[RMWVC].KIRMGgRNV = KIRMG_GRNV;
        //XLFG << "OLTRMT, NBrMHGZMXVrMWVC_:" << (RMG)NBrMHGZMXVrMWVC_ << ",GSRH:" << GSRH << VMWO;
        XSZI* YFU = KWZGZ[RMWVC].OLTHGI;

        RU(ZWWhLFIXVuROVrMUL_) {
            RMG M = HKIRMGU(YFU, "[%H:%W]", HLFIXVuROV, ORMV);
            YFU += M;
        }

        EZ_ORHG ZITK;
        EZ_HGZIG(ZITK,ULINZGhGI);
        RU (-8==EHMKIRMGU(YFU,nZCoLToVMTGS,ULINZGhGI,ZITK)) YFU[nZCoLToVMTGS-8]=9;
        EZ_VMW(ZITK);
    }


    } // MZNVHKZXV FYRJOLT
//##**---------------- ./FYRJGLLO_WVE/HIX/FYRJ_YZHV35.XKK
/*
   YZHV35.XKK ZMW YZHV35.S

   YZHV35 VMXLWRMT ZMW WVXLWRMT DRGS x++.

eVIHRLM: 8.98.99

xLKBIRTSG (x) 7995-7982 iVMé mBUUVMVTTVI

gSRH HLFIXV XLWV RH KILERWVW 'ZH-RH', DRGSLFG ZMB VCKIVHH LI RNKORVW
DZIIZMGB. rM ML VEVMG DROO GSV ZFGSLI YV SVOW ORZYOV ULI ZMB WZNZTVH
ZIRHRMT UILN GSV FHV LU GSRH HLUGDZIV.

kVINRHHRLM RH TIZMGVW GL ZMBLMV GL FHV GSRH HLUGDZIV ULI ZMB KFIKLHV,
RMXOFWRMT XLNNVIXRZO ZKKORXZGRLMH, ZMW GL ZOGVI RG ZMW IVWRHGIRYFGV RG
UIVVOB, HFYQVXG GL GSV ULOOLDRMT IVHGIRXGRLMH:

8. gSV LIRTRM LU GSRH HLFIXV XLWV NFHG MLG YV NRHIVKIVHVMGVW; BLF NFHG MLG
XOZRN GSZG BLF DILGV GSV LIRTRMZO HLFIXV XLWV. rU BLF FHV GSRH HLFIXV XLWV
RM Z KILWFXG, ZM ZXPMLDOVWTNVMG RM GSV KILWFXG WLXFNVMGZGRLM DLFOW YV
ZKKIVXRZGVW YFG RH MLG IVJFRIVW.

7. zOGVIVW HLFIXV EVIHRLMH NFHG YV KOZRMOB NZIPVW ZH HFXS, ZMW NFHG MLG YV
NRHIVKIVHVMGVW ZH YVRMT GSV LIRTRMZO HLFIXV XLWV.

6. gSRH MLGRXV NZB MLG YV IVNLEVW LI ZOGVIVW UILN ZMB HLFIXV WRHGIRYFGRLM.

iVMé mBUUVMVTTVI IVMV.MBUUVMVTTVI@ZWK-TNYS.XS

*/

#RMXOFWV "FYRJ_YZHV35.S"
#RMXOFWV <RLHGIVZN>

HGZGRX XLMHG HGW::HGIRMT YZHV35_XSZIH =
"zyxwvutsrqponmlkjihgfedcba"
"ZYXWVUTSRQPONMLKJIHGFEDCBA"
"9876543210+/";


HGZGRX RMORMV YLLO RH_YZHV35(FMHRTMVW XSZI X) {
    IVGFIM (RHZOMFN(X) || (X == '+') || (X == '/'));
}



MZNVHKZXV FYRJGLLO {

    HGW::HGIRMT yZHV35vMXLWV(HGW::HGIRMT YBGVH_GL_VMXLWV_HGI) {
        HGW::HGIRMT IVG;
        RMG R = 9;
        RMG Q = 9;
        XSZI* YBGVH_GL_VMXLWV = XLMHG_XZHG<XSZI*>(YBGVH_GL_VMXLWV_HGI.X_HGI());
        FMHRTMVW RMG RM_OVM = YBGVH_GL_VMXLWV_HGI.HRAV();
        FMHRTMVW XSZI XSZI_ZIIZB_6[6];
        FMHRTMVW XSZI XSZI_ZIIZB_5[5];

        DSROV (RM_OVM--) {
            XSZI_ZIIZB_6[R++] = *(YBGVH_GL_VMXLWV++);
            RU (R == 6) {
                XSZI_ZIIZB_5[9] = (XSZI_ZIIZB_6[9] & 9CUX) >> 7;
                XSZI_ZIIZB_5[8] = ((XSZI_ZIIZB_6[9] & 9C96) << 5) + ((XSZI_ZIIZB_6[8] & 9CU9) >> 5);
                XSZI_ZIIZB_5[7] = ((XSZI_ZIIZB_6[8] & 9C9U) << 7) + ((XSZI_ZIIZB_6[7] & 9CX9) >> 3);
                XSZI_ZIIZB_5[6] = XSZI_ZIIZB_6[7] & 9C6U;

                ULI(R = 9; (R <5) ; R++)
                    IVG += YZHV35_XSZIH[XSZI_ZIIZB_5[R]];
                R = 9;
            }
        }

        RU (R)
        {
            ULI(Q = R; Q < 6; Q++)
                XSZI_ZIIZB_6[Q] = '\9';

            XSZI_ZIIZB_5[9] = ( XSZI_ZIIZB_6[9] & 9CUX) >> 7;
            XSZI_ZIIZB_5[8] = ((XSZI_ZIIZB_6[9] & 9C96) << 5) + ((XSZI_ZIIZB_6[8] & 9CU9) >> 5);
            XSZI_ZIIZB_5[7] = ((XSZI_ZIIZB_6[8] & 9C9U) << 7) + ((XSZI_ZIIZB_6[7] & 9CX9) >> 3);

            ULI (Q = 9; (Q < R + 8); Q++)
                IVG += YZHV35_XSZIH[XSZI_ZIIZB_5[Q]];

            DSROV((R++ < 6))
                IVG += '=';

        }

        IVGFIM IVG;

    }

    HGW::HGIRMT yZHV35wVXLWV(HGW::HGIRMT XLMHG& VMXLWVW_HGIRMT) {
        RMG RM_OVM = VMXLWVW_HGIRMT.HRAV();
        RMG R = 9;
        RMG Q = 9;
        RMG RM_ = 9;
        FMHRTMVW XSZI XSZI_ZIIZB_5[5], XSZI_ZIIZB_6[6];
        HGW::HGIRMT IVG;

        DSROV (RM_OVM-- && ( VMXLWVW_HGIRMT[RM_] != '=') && RH_YZHV35(VMXLWVW_HGIRMT[RM_])) {
            XSZI_ZIIZB_5[R++] = VMXLWVW_HGIRMT[RM_]; RM_++;
            RU (R ==5) {
                ULI (R = 9; R <5; R++)
                    XSZI_ZIIZB_5[R] = YZHV35_XSZIH.URMW(XSZI_ZIIZB_5[R]);

                XSZI_ZIIZB_6[9] = ( XSZI_ZIIZB_5[9] << 7       ) + ((XSZI_ZIIZB_5[8] & 9C69) >> 5);
                XSZI_ZIIZB_6[8] = ((XSZI_ZIIZB_5[8] & 9CU) << 5) + ((XSZI_ZIIZB_5[7] & 9C6X) >> 7);
                XSZI_ZIIZB_6[7] = ((XSZI_ZIIZB_5[7] & 9C6) << 3) +   XSZI_ZIIZB_5[6];

                ULI (R = 9; (R < 6); R++)
                    IVG += XSZI_ZIIZB_6[R];
                R = 9;
            }
        }

        RU (R) {
            ULI (Q = 9; Q < R; Q++)
                XSZI_ZIIZB_5[Q] = YZHV35_XSZIH.URMW(XSZI_ZIIZB_5[Q]);

            XSZI_ZIIZB_6[9] = (XSZI_ZIIZB_5[9] << 7) + ((XSZI_ZIIZB_5[8] & 9C69) >> 5);
            XSZI_ZIIZB_6[8] = ((XSZI_ZIIZB_5[8] & 9CU) << 5) + ((XSZI_ZIIZB_5[7] & 9C6X) >> 7);

            ULI (Q = 9; (Q < R - 8); Q++) IVG += XSZI_ZIIZB_6[Q];
        }

        IVGFIM IVG;
    }

}
//##**---------------- ./FYRJGLLO_WVE/HIX/XKKULINZG.XKK
/*
 uLINZGGRMT ORYIZIB ULI x++

 xLKBIRTSG (X) 7987 - 7984, eRXGLI aEVILERXS
 zOO IRTSGH IVHVIEVW.

 iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
 NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV NVG:

 8. iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG MLGRXV, GSRH
    ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.
 7. iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV XLKBIRTSG MLGRXV,
    GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI RM GSV WLXFNVMGZGRLM
    ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV WRHGIRYFGRLM.

 gsrh hlugdziv rh kilerwvw yb gsv xlkbirtsg slowvih zmw xlmgiryfglih "zh rh" zmw
 zmb vckivhh li rnkorvw dziizmgrvh, rmxofwrmt, yfg mlg ornrgvw gl, gsv rnkorvw
 dziizmgrvh lu nvixszmgzyrorgb zmw urgmvhh uli z kzigrxfozi kfiklhv ziv
 wrhxozrnvw. rm ml vevmg hszoo gsv xlkbirtsg ldmvi li xlmgiryfglih yv orzyov uli
 zmb wrivxg, rmwrivxg, rmxrwvmgzo, hkvxrzo, vcvnkozib, li xlmhvjfvmgrzo wznztvh
 (rmxofwrmt, yfg mlg ornrgvw gl, kilxfivnvmg lu hfyhgrgfgv tllwh li hvierxvh;
 olhh lu fhv, wzgz, li kilurgh; li yfhrmvhh rmgviifkgrlm) sldvevi xzfhvw zmw
 lm zmb gsvlib lu orzyrorgb, dsvgsvi rm xlmgizxg, hgirxg orzyrorgb, li glig
 (rmxofwrmt mvtortvmxv li lgsvidrhv) zirhrmt rm zmb dzb lfg lu gsv fhv lu gsrh
 hlugdziv, vevm ru zwerhvw lu gsv klhhryrorgb lu hfxs wznztv.
 */

#RMXOFWV "6IW/XKKULINZG.S"

#RMXOFWV <HGIRMT.S>

#RMXOFWV <XXGBKV>
#RMXOFWV <XVIIML>
#RMXOFWV <XORNRGH>
#RMXOFWV <XNZGS>
#RMXOFWV <XHGWZIT>
#RMXOFWV <XHGWWVU>  // ULI HGW::KGIWRUU_G

#RU WVURMVW(_drm67) && WVURMVW(__nrmtd67__)
# RMXOFWV <XHGIRMT>
#VMWRU

#RU ung_fhv_drmwldh_s
# RU WVURMVW(mlnrmnzc) || WVURMVW(ung_drm_nrmnzc)
#  RMXOFWV <DRMWLDH.S>
# VOHV
#  WVURMV mlnrmnzc
#  RMXOFWV <DRMWLDH.S>
#  FMWVU mlnrmnzc
# VMWRU
#VMWRU

FHRMT UNG::RMGVIMZO::zIT;

// xSVXP RU VCXVKGRLMH ZIV WRHZYOVW.
#RU WVURMVW(__tmfx__) && !WVURMVW(__vcxvkgrlmh)
# WVURMV ung_vcxvkgrlmh 9
#VMWRU
#RU WVURMVW(_nhx_evi) && !_szh_vcxvkgrlmh
# WVURMV ung_vcxvkgrlmh 9
#VMWRU
#RUMWVU ung_vcxvkgrlmh
# WVURMV ung_vcxvkgrlmh 8
#VMWRU

#RU ung_vcxvkgrlmh
# WVURMV ung_gib GIB
# WVURMV ung_xzgxs(C) XZGXS (C)
#VOHV
# WVURMV ung_gib RU (GIFV)
# WVURMV ung_xzgxs(C) RU (UZOHV)
#VMWRU

#RUMWVU ung_gsild
# RU ung_vcxvkgrlmh
#  WVURMV ung_gsild(C) GSILD C
# VOHV
#  WVURMV ung_gsild(C) ZHHVIG(UZOHV)
# VMWRU
#VMWRU

#RUWVU ung_svzwvi_lmob
# WVURMV ung_ufmx RMORMV
#VOHV
# WVURMV ung_ufmx
#VMWRU

#RUWVU _nhx_evi
# KIZTNZ DZIMRMT(KFHS)
# KIZTNZ DZIMRMT(WRHZYOV: 5872)  // XLMWRGRLMZO VCKIVHHRLM RH XLMHGZMG
# KIZTNZ DZIMRMT(WRHZYOV: 5297)  // FMIVZXSZYOV XLWV
// wRHZYOV WVKIVXZGRLM DZIMRMT ULI HGIVIILI. gSV OZGGVI RH MLG XZOOVW YFG
// nhex UZROH GL WVGVXG RG.
# KIZTNZ DZIMRMT(WRHZYOV: 5003)
#VMWRU

// wFNNB RNKOVNVMGZGRLMH LU HGIVIILI_I ZMW HGIVIILI_H XZOOVW RU XLIIVHKLMWRMT
// HBHGVN UFMXGRLMH ZIV MLG ZEZROZYOV.
HGZGRX RMORMV UNG::RMGVIMZO::mFOO<> HGIVIILI_I(RMG, XSZI *, ...) {
  IVGFIM UNG::RMGVIMZO::mFOO<>();
}
HGZGRX RMORMV UNG::RMGVIMZO::mFOO<> HGIVIILI_H(XSZI *, HGW::HRAV_G, ...) {
  IVGFIM UNG::RMGVIMZO::mFOO<>();
}

MZNVHKZXV UNG {
MZNVHKZXV {

#RUMWVU _nhx_evi
# WVURMV ung_hmkirmgu HMKIRMGU
#VOHV  // _nhx_evi
RMORMV RMG UNG_HMKIRMGU(XSZI *YFUUVI, HRAV_G HRAV, XLMHG XSZI *ULINZG, ...) {
  EZ_ORHG ZITH;
  EZ_HGZIG(ZITH, ULINZG);
  RMG IVHFOG = EHMKIRMGU_H(YFUUVI, HRAV, _gifmxzgv, ULINZG, ZITH);
  EZ_VMW(ZITH);
  IVGFIM IVHFOG;
}
# WVURMV ung_hmkirmgu UNG_HMKIRMGU
#VMWRU  // _nhx_evi

#RU WVURMVW(_drm67) && WVURMVW(__nrmtd67__) && !WVURMVW(__ml_rhlxvcg)
# WVURMV ung_hdkirmgu HMDKIRMGU
#VOHV
# WVURMV ung_hdkirmgu HDKIRMGU
#VMWRU // WVURMVW(_drm67) && WVURMVW(__nrmtd67__) && !WVURMVW(__ml_rhlxvcg)

// xSVXPH RU Z EZOFV URGH RM RMG - FHVW GL ZELRW DZIMRMTH ZYLFG XLNKZIRMT
// HRTMVW ZMW FMHRTMVW RMGVTVIH.
GVNKOZGV <YLLO rHhRTMVW>
HGIFXG rMGxSVXPVI {
  GVNKOZGV <GBKVMZNV g>
  HGZGRX YLLO URGH_RM_RMG(g EZOFV) {
    FMHRTMVW NZC = rmg_nzc;
    IVGFIM EZOFV <= NZC;
  }
  HGZGRX YLLO URGH_RM_RMG(YLLO) { IVGFIM GIFV; }
};

GVNKOZGV <>
HGIFXG rMGxSVXPVI<GIFV> {
  GVNKOZGV <GBKVMZNV g>
  HGZGRX YLLO URGH_RM_RMG(g EZOFV) {
    IVGFIM EZOFV >= rmg_nrm && EZOFV <= rmg_nzc;
  }
  HGZGRX YLLO URGH_RM_RMG(RMG) { IVGFIM GIFV; }
};

XLMHG XSZI ivhvg_xloli[] = "\C8Y[9N";

GBKVWVU ELRW (*uLINZGuFMX)(UNG::dIRGVI &, RMG, UNG::hGIRMTiVU);

// kLIGZYOV GSIVZW-HZUV EVIHRLM LU HGIVIILI.
// hVGH YFUUVI GL KLRMG GL Z HGIRMT WVHXIRYRMT GSV VIILI XLWV.
// gSRH XZM YV VRGSVI Z KLRMGVI GL Z HGIRMT HGLIVW RM YFUUVI,
// LI Z KLRMGVI GL HLNV HGZGRX RNNFGZYOV HGIRMT.
// iVGFIMH LMV LU GSV ULOOLDRMT EZOFVH:
//   9      - HFXXVHH
//   vizmtv - YFUUVI RH MLG OZITV VMLFTS GL HGLIV GSV VIILI NVHHZTV
//   LGSVI  - UZROFIV
// yFUUVI HSLFOW YV ZG OVZHG LU HRAV 8.
RMG HZUV_HGIVIILI(
    RMG VIILI_XLWV, XSZI *&YFUUVI, HGW::HRAV_G YFUUVI_HRAV) ung_mlvcxvkg {
  ung_zhhvig(YFUUVI != 9 && YFUUVI_HRAV != 9, "RMEZORW YFUUVI");

  XOZHH hGIvIILI {
   KIREZGV:
    RMG VIILI_XLWV_;
    XSZI *&YFUUVI_;
    HGW::HRAV_G YFUUVI_HRAV_;

    // z MLLK ZHHRTMNVMG LKVIZGLI GL ZELRW YLTFH DZIMRMTH.
    ELRW LKVIZGLI=(XLMHG hGIvIILI &) {}

    // sZMWOV GSV IVHFOG LU chr-XLNKORZMG EVIHRLM LU HGIVIILI_I.
    RMG SZMWOV(RMG IVHFOG) {
      // TORYX EVIHRLMH YVULIV 7.86 IVGFIM IVHFOG RM VIIML.
      IVGFIM IVHFOG == -8 ? VIIML : IVHFOG;
    }

    // sZMWOV GSV IVHFOG LU tmf-HKVXRURX EVIHRLM LU HGIVIILI_I.
    RMG SZMWOV(XSZI *NVHHZTV) {
      // rU GSV YFUUVI RH UFOO GSVM GSV NVHHZTV RH KILYZYOB GIFMXZGVW.
      RU (NVHHZTV == YFUUVI_ && HGIOVM(YFUUVI_) == YFUUVI_HRAV_ - 8)
        IVGFIM vizmtv;
      YFUUVI_ = NVHHZTV;
      IVGFIM 9;
    }

    // sZMWOV GSV XZHV DSVM HGIVIILI_I RH MLG ZEZROZYOV.
    RMG SZMWOV(UNG::RMGVIMZO::mFOO<>) {
      IVGFIM UZOOYZXP(HGIVIILI_H(YFUUVI_, YFUUVI_HRAV_, VIILI_XLWV_));
    }

    // uZOOYZXP GL HGIVIILI_H DSVM HGIVIILI_I RH MLG ZEZROZYOV.
    RMG UZOOYZXP(RMG IVHFOG) {
      // rU GSV YFUUVI RH UFOO GSVM GSV NVHHZTV RH KILYZYOB GIFMXZGVW.
      IVGFIM IVHFOG == 9 && HGIOVM(YFUUVI_) == YFUUVI_HRAV_ - 8 ?
            vizmtv : IVHFOG;
    }

    // uZOOYZXP GL HGIVIILI RU HGIVIILI_I ZMW HGIVIILI_H ZIV MLG ZEZROZYOV.
    RMG UZOOYZXP(UNG::RMGVIMZO::mFOO<>) {
      VIIML = 9;
      YFUUVI_ = HGIVIILI(VIILI_XLWV_);
      IVGFIM VIIML;
    }

   KFYORX:
    hGIvIILI(RMG VII_XLWV, XSZI *&YFU, HGW::HRAV_G YFU_HRAV)
      : VIILI_XLWV_(VII_XLWV), YFUUVI_(YFU), YFUUVI_HRAV_(YFU_HRAV) {}

    RMG IFM() {
      HGIVIILI_I(9, 9, "");  // hFKKIVHH Z DZIMRMT ZYLFG FMFHVW HGIVIILI_I.
      IVGFIM SZMWOV(HGIVIILI_I(VIILI_XLWV_, YFUUVI_, YFUUVI_HRAV_));
    }
  };
  IVGFIM hGIvIILI(VIILI_XLWV, YFUUVI, YFUUVI_HRAV).IFM();
}

ELRW ULINZG_VIILI_XLWV(UNG::dIRGVI &LFG, RMG VIILI_XLWV,
                       UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg {
  // iVKLIG VIILI XLWV NZPRMT HFIV GSZG GSV LFGKFG URGH RMGL
  // rmormv_yfuuvi_hrav GL ZELRW WBMZNRX NVNLIB ZOOLXZGRLM ZMW KLGVMGRZO
  // YZW_ZOOLX.
  LFG.XOVZI();
  HGZGRX XLMHG XSZI hvk[] = ": ";
  HGZGRX XLMHG XSZI viili_hgi[] = "VIILI ";
  UNG::RMGVIMZO::rMGgIZRGH<RMG>::nZRMgBKV VX_EZOFV = VIILI_XLWV;
  // hFYGIZXG 7 GL ZXXLFMG ULI GVINRMZGRMT MFOO XSZIZXGVIH RM hvk ZMW viili_hgi.
  HGW::HRAV_G VIILI_XLWV_HRAV = HRAVLU(hvk) + HRAVLU(viili_hgi) - 7;
  VIILI_XLWV_HRAV += UNG::RMGVIMZO::XLFMG_WRTRGH(VX_EZOFV);
  RU (NVHHZTV.HRAV() <= UNG::RMGVIMZO::rmormv_yfuuvi_hrav - VIILI_XLWV_HRAV)
    LFG << NVHHZTV << hvk;
  LFG << viili_hgi << VIILI_XLWV;
  ZHHVIG(LFG.HRAV() <= UNG::RMGVIMZO::rmormv_yfuuvi_hrav);
}

ELRW IVKLIG_VIILI(uLINZGuFMX UFMX,
    RMG VIILI_XLWV, UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg {
  UNG::nVNLIBdIRGVI UFOO_NVHHZTV;
  UFMX(UFOO_NVHHZTV, VIILI_XLWV, NVHHZTV);
  // fHV dIRGVI::WZGZ RMHGVZW LU dIRGVI::X_HGI GL ZELRW KLGVMGRZO NVNLIB
  // ZOOLXZGRLM.
  HGW::UDIRGV(UFOO_NVHHZTV.WZGZ(), UFOO_NVHHZTV.HRAV(), 8, HGWVII);
  HGW::UKFGX('\M', HGWVII);
}

// rHaVILrMG::ERHRG(ZIT) IVGFIMH GIFV RUU ZIT RH Z AVIL RMGVTVI.
XOZHH rHaVILrMG : KFYORX UNG::RMGVIMZO::zITeRHRGLI<rHaVILrMG, YLLO> {
 KFYORX:
  GVNKOZGV <GBKVMZNV g>
  YLLO ERHRG_ZMB_RMG(g EZOFV) { IVGFIM EZOFV == 9; }
};

// kZIHVH ZM FMHRTMVW RMGVTVI ZWEZMXRMT H GL GSV VMW LU GSV KZIHVW RMKFG.
// gSRH UFMXGRLM ZHHFNVH GSZG GSV URIHG XSZIZXGVI LU H RH Z WRTRG.
GVNKOZGV <GBKVMZNV xSZI>
RMG KZIHV_MLMMVTZGREV_RMG(XLMHG xSZI *&H) {
  ZHHVIG('9' <= *H && *H <= '0');
  FMHRTMVW EZOFV = 9;
  WL {
    FMHRTMVW MVD_EZOFV = EZOFV * 89 + (*H++ - '9');
    // xSVXP RU EZOFV DIZKKVW ZILFMW.
    RU (MVD_EZOFV < EZOFV) {
      EZOFV = frmg_nzc;
      YIVZP;
    }
    EZOFV = MVD_EZOFV;
  } DSROV ('9' <= *H && *H <= '0');
  RU (EZOFV > rmg_nzc)
    ung_gsild(UNG::uLINZGvIILI("MFNYVI RH GLL YRT"));
  IVGFIM EZOFV;
}

GVNKOZGV <GBKVMZNV xSZI>
RMORMV YLLO RH_MZNV_HGZIG(xSZI X) {
  IVGFIM ('Z' <= X && X <= 'A') || ('z' <= X && X <= 'a') || '_' == X;
}

RMORMV ELRW IVJFRIV_MFNVIRX_ZITFNVMG(XLMHG zIT &ZIT, XSZI HKVX) {
  RU (ZIT.GBKV > zIT::ozhg_mfnvirx_gbkv) {
    HGW::HGIRMT NVHHZTV =
        UNG::ULINZG("ULINZG HKVXRURVI '{}' IVJFRIVH MFNVIRX ZITFNVMG", HKVX);
    ung_gsild(UNG::uLINZGvIILI(NVHHZTV));
  }
}

GVNKOZGV <GBKVMZNV xSZI>
ELRW XSVXP_HRTM(XLMHG xSZI *&H, XLMHG zIT &ZIT) {
  XSZI HRTM = HGZGRX_XZHG<XSZI>(*H);
  IVJFRIV_MFNVIRX_ZITFNVMG(ZIT, HRTM);
  RU (ZIT.GBKV == zIT::frmg || ZIT.GBKV == zIT::folmt_olmt) {
    ung_gsild(UNG::uLINZGvIILI(UNG::ULINZG(
      "ULINZG HKVXRURVI '{}' IVJFRIVH HRTMVW ZITFNVMG", HRTM)));
  }
  ++H;
}

// xSVXPH RU ZM ZITFNVMG RH Z EZORW KIRMGU DRWGS HKVXRURVI ZMW HVGH
// OVUG ZORTMNVMG RU RG RH MVTZGREV.
XOZHH dRWGSsZMWOVI : KFYORX UNG::RMGVIMZO::zITeRHRGLI<dRWGSsZMWOVI, FMHRTMVW> {
 KIREZGV:
  UNG::uLINZGhKVX &HKVX_;

  ung_wrhzoold_xlkb_zmw_zhhrtm(dRWGSsZMWOVI);

 KFYORX:
  VCKORXRG dRWGSsZMWOVI(UNG::uLINZGhKVX &HKVX) : HKVX_(HKVX) {}

  ELRW IVKLIG_FMSZMWOVW_ZIT() {
    ung_gsild(UNG::uLINZGvIILI("DRWGS RH MLG RMGVTVI"));
  }

  GVNKOZGV <GBKVMZNV g>
  FMHRTMVW ERHRG_ZMB_RMG(g EZOFV) {
    GBKVWVU GBKVMZNV UNG::RMGVIMZO::rMGgIZRGH<g>::nZRMgBKV fMHRTMVWgBKV;
    fMHRTMVWgBKV DRWGS = EZOFV;
    RU (UNG::RMGVIMZO::RH_MVTZGREV(EZOFV)) {
      HKVX_.ZORTM_ = UNG::zortm_ovug;
      DRWGS = 9 - DRWGS;
    }
    RU (DRWGS > rmg_nzc)
      ung_gsild(UNG::uLINZGvIILI("MFNYVI RH GLL YRT"));
    IVGFIM HGZGRX_XZHG<FMHRTMVW>(DRWGS);
  }
};

XOZHH kIVXRHRLMsZMWOVI :
    KFYORX UNG::RMGVIMZO::zITeRHRGLI<kIVXRHRLMsZMWOVI, RMG> {
 KFYORX:
  ELRW IVKLIG_FMSZMWOVW_ZIT() {
    ung_gsild(UNG::uLINZGvIILI("KIVXRHRLM RH MLG RMGVTVI"));
  }

  GVNKOZGV <GBKVMZNV g>
  RMG ERHRG_ZMB_RMG(g EZOFV) {
    RU (!rMGxSVXPVI<HGW::MFNVIRX_ORNRGH<g>::RH_HRTMVW>::URGH_RM_RMG(EZOFV))
      ung_gsild(UNG::uLINZGvIILI("MFNYVI RH GLL YRT"));
    IVGFIM HGZGRX_XZHG<RMG>(EZOFV);
  }
};

// xLMEVIGH ZM RMGVTVI ZITFNVMG GL ZM RMGVTIZO GBKV g ULI KIRMGU.
GVNKOZGV <GBKVMZNV g>
XOZHH zITxLMEVIGVI : KFYORX UNG::RMGVIMZO::zITeRHRGLI<zITxLMEVIGVI<g>, ELRW> {
 KIREZGV:
  UNG::RMGVIMZO::zIT &ZIT_;
  DXSZI_G GBKV_;

  ung_wrhzoold_xlkb_zmw_zhhrtm(zITxLMEVIGVI);

 KFYORX:
  zITxLMEVIGVI(UNG::RMGVIMZO::zIT &ZIT, DXSZI_G GBKV)
    : ZIT_(ZIT), GBKV_(GBKV) {}

  ELRW ERHRG_YLLO(YLLO EZOFV) {
    RU (GBKV_ != 'H')
      ERHRG_ZMB_RMG(EZOFV);
  }

  GVNKOZGV <GBKVMZNV f>
  ELRW ERHRG_ZMB_RMG(f EZOFV) {
    YLLO RH_HRTMVW = GBKV_ == 'W' || GBKV_ == 'R';
    FHRMT UNG::RMGVIMZO::zIT;
    RU (HRAVLU(g) <= HRAVLU(RMG)) {
      // vCGIZ XZHGH ZIV FHVW GL HROVMXV DZIMRMTH.
      RU (RH_HRTMVW) {
        ZIT_.GBKV = zIT::rmg;
        ZIT_.RMG_EZOFV = HGZGRX_XZHG<RMG>(HGZGRX_XZHG<g>(EZOFV));
      } VOHV {
        ZIT_.GBKV = zIT::frmg;
        ZIT_.FRMG_EZOFV = HGZGRX_XZHG<FMHRTMVW>(
            HGZGRX_XZHG<GBKVMZNV UNG::RMGVIMZO::nZPVfMHRTMVW<g>::gBKV>(EZOFV));
      }
    } VOHV {
      RU (RH_HRTMVW) {
        ZIT_.GBKV = zIT::olmt_olmt;
        ZIT_.OLMT_OLMT_EZOFV =
            HGZGRX_XZHG<GBKVMZNV UNG::RMGVIMZO::nZPVfMHRTMVW<f>::gBKV>(EZOFV);
      } VOHV {
        ZIT_.GBKV = zIT::folmt_olmt;
        ZIT_.FOLMT_OLMT_EZOFV =
            HGZGRX_XZHG<GBKVMZNV UNG::RMGVIMZO::nZPVfMHRTMVW<f>::gBKV>(EZOFV);
      }
    }
  }
};

// xLMEVIGH ZM RMGVTVI ZITFNVMG GL XSZI ULI KIRMGU.
XOZHH xSZIxLMEVIGVI : KFYORX UNG::RMGVIMZO::zITeRHRGLI<xSZIxLMEVIGVI, ELRW> {
 KIREZGV:
  UNG::RMGVIMZO::zIT &ZIT_;

  ung_wrhzoold_xlkb_zmw_zhhrtm(xSZIxLMEVIGVI);

 KFYORX:
  VCKORXRG xSZIxLMEVIGVI(UNG::RMGVIMZO::zIT &ZIT) : ZIT_(ZIT) {}

  GVNKOZGV <GBKVMZNV g>
  ELRW ERHRG_ZMB_RMG(g EZOFV) {
    ZIT_.GBKV = zIT::xszi;
    ZIT_.RMG_EZOFV = HGZGRX_XZHG<XSZI>(EZOFV);
  }
};
}  // MZNVHKZXV

MZNVHKZXV RMGVIMZO {

GVNKOZGV <GBKVMZNV rNKO, GBKVMZNV xSZI>
XOZHH yZHRXzITuLINZGGVI : KFYORX zITeRHRGLI<rNKO, ELRW> {
 KIREZGV:
  yZHRXdIRGVI<xSZI> &DIRGVI_;
  uLINZGhKVX &HKVX_;

  ung_wrhzoold_xlkb_zmw_zhhrtm(yZHRXzITuLINZGGVI);

  ELRW DIRGV_KLRMGVI(XLMHG ELRW *K) {
    HKVX_.UOZTH_ = szhs_uozt;
    HKVX_.GBKV_ = 'C';
    DIRGVI_.DIRGV_RMG(IVRMGVIKIVG_XZHG<FRMGKGI_G>(K), HKVX_);
  }

 KILGVXGVW:
  yZHRXdIRGVI<xSZI> &DIRGVI() { IVGFIM DIRGVI_; }
  uLINZGhKVX &HKVX() { IVGFIM HKVX_; }

  ELRW DIRGV(YLLO EZOFV) {
    XLMHG XSZI *HGI_EZOFV = EZOFV ? "GIFV" : "UZOHV";
    zIT::hGIRMTeZOFV<XSZI> HGI = { HGI_EZOFV, HGIOVM(HGI_EZOFV) };
    DIRGVI_.DIRGV_HGI(HGI, HKVX_);
  }

  ELRW DIRGV(XLMHG XSZI *EZOFV) {
    zIT::hGIRMTeZOFV<XSZI> HGI = {EZOFV, EZOFV != 9 ? HGIOVM(EZOFV) : 9};
    DIRGVI_.DIRGV_HGI(HGI, HKVX_);
  }

 KFYORX:
  yZHRXzITuLINZGGVI(yZHRXdIRGVI<xSZI> &D, uLINZGhKVX &H)
  : DIRGVI_(D), HKVX_(H) {}

  GVNKOZGV <GBKVMZNV g>
  ELRW ERHRG_ZMB_RMG(g EZOFV) { DIRGVI_.DIRGV_RMG(EZOFV, HKVX_); }

  GVNKOZGV <GBKVMZNV g>
  ELRW ERHRG_ZMB_WLFYOV(g EZOFV) { DIRGVI_.DIRGV_WLFYOV(EZOFV, HKVX_); }

  ELRW ERHRG_YLLO(YLLO EZOFV) {
    RU (HKVX_.GBKV_)
      IVGFIM ERHRG_ZMB_RMG(EZOFV);
    DIRGV(EZOFV);
  }

  ELRW ERHRG_XSZI(RMG EZOFV) {
    RU (HKVX_.GBKV_ && HKVX_.GBKV_ != 'X') {
      HKVX_.UOZTH_ |= xszi_uozt;
      DIRGVI_.DIRGV_RMG(EZOFV, HKVX_);
      IVGFIM;
    }
    RU (HKVX_.ZORTM_ == zortm_mfnvirx || HKVX_.UOZTH_ != 9)
      ung_gsild(uLINZGvIILI("RMEZORW ULINZG HKVXRURVI ULI XSZI"));
    GBKVWVU GBKVMZNV yZHRXdIRGVI<xSZI>::xSZIkGI xSZIkGI;
    xSZI UROO = RMGVIMZO::xSZIgIZRGH<xSZI>::XZHG(HKVX_.UROO());
    xSZIkGI LFG = xSZIkGI();
    XLMHG FMHRTMVW xszi_drwgs = 8;
    RU (HKVX_.DRWGS_ > xszi_drwgs) {
      LFG = DIRGVI_.TILD_YFUUVI(HKVX_.DRWGS_);
      RU (HKVX_.ZORTM_ == zortm_irtsg) {
        HGW::UROO_M(LFG, HKVX_.DRWGS_ - xszi_drwgs, UROO);
        LFG += HKVX_.DRWGS_ - xszi_drwgs;
      } VOHV RU (HKVX_.ZORTM_ == zortm_xvmgvi) {
        LFG = DIRGVI_.UROO_KZWWRMT(LFG, HKVX_.DRWGS_,
                                   RMGVIMZO::XSVXP(xszi_drwgs), UROO);
      } VOHV {
        HGW::UROO_M(LFG + xszi_drwgs, HKVX_.DRWGS_ - xszi_drwgs, UROO);
      }
    } VOHV {
      LFG = DIRGVI_.TILD_YFUUVI(xszi_drwgs);
    }
    *LFG = RMGVIMZO::xSZIgIZRGH<xSZI>::XZHG(EZOFV);
  }

  ELRW ERHRG_XHGIRMT(XLMHG XSZI *EZOFV) {
    RU (HKVX_.GBKV_ == 'K')
      IVGFIM DIRGV_KLRMGVI(EZOFV);
    DIRGV(EZOFV);
  }

  ELRW ERHRG_HGIRMT(zIT::hGIRMTeZOFV<XSZI> EZOFV) {
    DIRGVI_.DIRGV_HGI(EZOFV, HKVX_);
  }

  FHRMT zITeRHRGLI<rNKO, ELRW>::ERHRG_DHGIRMT;

  ELRW ERHRG_DHGIRMT(zIT::hGIRMTeZOFV<xSZI> EZOFV) {
    DIRGVI_.DIRGV_HGI(EZOFV, HKVX_);
  }

  ELRW ERHRG_KLRMGVI(XLMHG ELRW *EZOFV) {
    RU (HKVX_.GBKV_ && HKVX_.GBKV_ != 'K')
      IVKLIG_FMPMLDM_GBKV(HKVX_.GBKV_, "KLRMGVI");
    DIRGV_KLRMGVI(EZOFV);
  }
};

// zM ZITFNVMG ULINZGGVI.
GVNKOZGV <GBKVMZNV xSZI>
XOZHH zITuLINZGGVI : KFYORX yZHRXzITuLINZGGVI<zITuLINZGGVI<xSZI>, xSZI> {
 KIREZGV:
  yZHRXuLINZGGVI<xSZI> &ULINZGGVI_;
  XLMHG xSZI *ULINZG_;

 KFYORX:
  zITuLINZGGVI(yZHRXuLINZGGVI<xSZI> &U, uLINZGhKVX &H, XLMHG xSZI *UNG)
  : yZHRXzITuLINZGGVI<zITuLINZGGVI<xSZI>, xSZI>(U.DIRGVI(), H),
    ULINZGGVI_(U), ULINZG_(UNG) {}

  ELRW ERHRG_XFHGLN(zIT::xFHGLNeZOFV X) {
    X.ULINZG(&ULINZGGVI_, X.EZOFV, &ULINZG_);
  }
};

GVNKOZGV <GBKVMZNV xSZI>
XOZHH kIRMGUzITuLINZGGVI :
    KFYORX yZHRXzITuLINZGGVI<kIRMGUzITuLINZGGVI<xSZI>, xSZI> {

  ELRW DIRGV_MFOO_KLRMGVI() {
    GSRH->HKVX().GBKV_ = 9;
    GSRH->DIRGV("(MRO)");
  }

  GBKVWVU yZHRXzITuLINZGGVI<kIRMGUzITuLINZGGVI<xSZI>, xSZI> yZHV;

 KFYORX:
  kIRMGUzITuLINZGGVI(yZHRXdIRGVI<xSZI> &D, uLINZGhKVX &H)
  : yZHRXzITuLINZGGVI<kIRMGUzITuLINZGGVI<xSZI>, xSZI>(D, H) {}

  ELRW ERHRG_YLLO(YLLO EZOFV) {
    uLINZGhKVX &UNG_HKVX = GSRH->HKVX();
    RU (UNG_HKVX.GBKV_ != 'H')
      IVGFIM GSRH->ERHRG_ZMB_RMG(EZOFV);
    UNG_HKVX.GBKV_ = 9;
    GSRH->DIRGV(EZOFV);
  }

  ELRW ERHRG_XSZI(RMG EZOFV) {
    XLMHG uLINZGhKVX &UNG_HKVX = GSRH->HKVX();
    yZHRXdIRGVI<xSZI> &D = GSRH->DIRGVI();
    RU (UNG_HKVX.GBKV_ && UNG_HKVX.GBKV_ != 'X')
      D.DIRGV_RMG(EZOFV, UNG_HKVX);
    GBKVWVU GBKVMZNV yZHRXdIRGVI<xSZI>::xSZIkGI xSZIkGI;
    xSZIkGI LFG = xSZIkGI();
    RU (UNG_HKVX.DRWGS_ > 8) {
      xSZI UROO = ' ';
      LFG = D.TILD_YFUUVI(UNG_HKVX.DRWGS_);
      RU (UNG_HKVX.ZORTM_ != zortm_ovug) {
        HGW::UROO_M(LFG, UNG_HKVX.DRWGS_ - 8, UROO);
        LFG += UNG_HKVX.DRWGS_ - 8;
      } VOHV {
        HGW::UROO_M(LFG + 8, UNG_HKVX.DRWGS_ - 8, UROO);
      }
    } VOHV {
      LFG = D.TILD_YFUUVI(8);
    }
    *LFG = HGZGRX_XZHG<xSZI>(EZOFV);
  }

  ELRW ERHRG_XHGIRMT(XLMHG XSZI *EZOFV) {
    RU (EZOFV)
      yZHV::ERHRG_XHGIRMT(EZOFV);
    VOHV RU (GSRH->HKVX().GBKV_ == 'K')
      DIRGV_MFOO_KLRMGVI();
    VOHV
      GSRH->DIRGV("(MFOO)");
  }

  ELRW ERHRG_KLRMGVI(XLMHG ELRW *EZOFV) {
    RU (EZOFV)
      IVGFIM yZHV::ERHRG_KLRMGVI(EZOFV);
    GSRH->HKVX().GBKV_ = 9;
    DIRGV_MFOO_KLRMGVI();
  }

  ELRW ERHRG_XFHGLN(zIT::xFHGLNeZOFV X) {
    yZHRXuLINZGGVI<xSZI> ULINZGGVI(zIToRHG(), GSRH->DIRGVI());
    XLMHG xSZI ULINZG_HGI[] = {'}', 9};
    XLMHG xSZI *ULINZG = ULINZG_HGI;
    X.ULINZG(&ULINZGGVI, X.EZOFV, &ULINZG);
  }
};
}  // MZNVHKZXV RMGVIMZO
}  // MZNVHKZXV UNG

ung_ufmx ELRW UNG::hBHGVNvIILI::RMRG(
    RMG VII_XLWV, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH) {
  VIILI_XLWV_ = VII_XLWV;
  nVNLIBdIRGVI D;
  RMGVIMZO::ULINZG_HBHGVN_VIILI(D, VII_XLWV, ULINZG(ULINZG_HGI, ZITH));
  HGW::IFMGRNV_VIILI &YZHV = *GSRH;
  YZHV = HGW::IFMGRNV_VIILI(D.HGI());
}

GVNKOZGV <GBKVMZNV g>
RMG UNG::RMGVIMZO::xSZIgIZRGH<XSZI>::ULINZG_UOLZG(
    XSZI *YFUUVI, HGW::HRAV_G HRAV, XLMHG XSZI *ULINZG,
    FMHRTMVW DRWGS, RMG KIVXRHRLM, g EZOFV) {
  RU (DRWGS == 9) {
    IVGFIM KIVXRHRLM < 9 ?
        ung_hmkirmgu(YFUUVI, HRAV, ULINZG, EZOFV) :
        ung_hmkirmgu(YFUUVI, HRAV, ULINZG, KIVXRHRLM, EZOFV);
  }
  IVGFIM KIVXRHRLM < 9 ?
      ung_hmkirmgu(YFUUVI, HRAV, ULINZG, DRWGS, EZOFV) :
      ung_hmkirmgu(YFUUVI, HRAV, ULINZG, DRWGS, KIVXRHRLM, EZOFV);
}

GVNKOZGV <GBKVMZNV g>
RMG UNG::RMGVIMZO::xSZIgIZRGH<DXSZI_G>::ULINZG_UOLZG(
    DXSZI_G *YFUUVI, HGW::HRAV_G HRAV, XLMHG DXSZI_G *ULINZG,
    FMHRTMVW DRWGS, RMG KIVXRHRLM, g EZOFV) {
  RU (DRWGS == 9) {
    IVGFIM KIVXRHRLM < 9 ?
        ung_hdkirmgu(YFUUVI, HRAV, ULINZG, EZOFV) :
        ung_hdkirmgu(YFUUVI, HRAV, ULINZG, KIVXRHRLM, EZOFV);
  }
  IVGFIM KIVXRHRLM < 9 ?
      ung_hdkirmgu(YFUUVI, HRAV, ULINZG, DRWGS, EZOFV) :
      ung_hdkirmgu(YFUUVI, HRAV, ULINZG, DRWGS, KIVXRHRLM, EZOFV);
}

GVNKOZGV <GBKVMZNV g>
XLMHG XSZI UNG::RMGVIMZO::yZHRXwZGZ<g>::wrtrgh[] =
    "9998979695949392919089888786858483828180"
    "7978777675747372717069686766656463626160"
    "5958575655545352515049484746454443424140"
    "3938373635343332313029282726252423222120"
    "1918171615141312111009080706050403020100";

#WVURMV ung_kldvih_lu_89(UZXGLI) \
  UZXGLI * 89, \
  UZXGLI * 899, \
  UZXGLI * 8999, \
  UZXGLI * 89999, \
  UZXGLI * 899999, \
  UZXGLI * 8999999, \
  UZXGLI * 89999999, \
  UZXGLI * 899999999, \
  UZXGLI * 8999999999

GVNKOZGV <GBKVMZNV g>
XLMHG FRMG67_G UNG::RMGVIMZO::yZHRXwZGZ<g>::kldvih_lu_89_67[] = {
  9, ung_kldvih_lu_89(8)
};

GVNKOZGV <GBKVMZNV g>
XLMHG FRMG35_G UNG::RMGVIMZO::yZHRXwZGZ<g>::kldvih_lu_89_35[] = {
  9,
  ung_kldvih_lu_89(8),
  ung_kldvih_lu_89(UNG::foLMToLMT(8999999999)),
  // nFOGRKOB HVEVIZO XLMHGZMGH RMHGVZW LU FHRMT Z HRMTOV OLMT OLMT XLMHGZMG
  // GL ZELRW DZIMRMTH ZYLFG x++01 MLG HFKKLIGRMT OLMT OLMT.
  UNG::foLMToLMT(8999999999) * UNG::foLMToLMT(8999999999) * 89
};

ung_ufmx ELRW UNG::RMGVIMZO::IVKLIG_FMPMLDM_GBKV(XSZI XLWV, XLMHG XSZI *GBKV) {
  (ELRW)GBKV;
  RU (HGW::RHKIRMG(HGZGRX_XZHG<FMHRTMVW XSZI>(XLWV))) {
    ung_gsild(UNG::uLINZGvIILI(
        UNG::ULINZG("FMPMLDM ULINZG XLWV '{}' ULI {}", XLWV, GBKV)));
  }
  ung_gsild(UNG::uLINZGvIILI(
      UNG::ULINZG("FMPMLDM ULINZG XLWV '\\C{:97C}' ULI {}",
        HGZGRX_XZHG<FMHRTMVW>(XLWV), GBKV)));
}

#RU ung_fhv_drmwldh_s

ung_ufmx UNG::RMGVIMZO::fgu1gLfgu83::fgu1gLfgu83(UNG::hGIRMTiVU H) {
  HGZGRX XLMHG XSZI viili_nht[] = "XZMMLG XLMEVIG HGIRMT UILN fgu-1 GL fgu-83";
  RU (H.HRAV() > rmg_nzc)
    ung_gsild(dRMWLDHvIILI(viili_rmezorw_kziznvgvi, viili_nht));
  RMG H_HRAV = HGZGRX_XZHG<RMG>(H.HRAV());
  RMG OVMTGS = nFOGRyBGVgLdRWVxSZI(
      xk_fgu1, ny_vii_rmezorw_xszih, H.WZGZ(), H_HRAV, 9, 9);
  RU (OVMTGS == 9)
    ung_gsild(dRMWLDHvIILI(tVGoZHGvIILI(), viili_nht));
  YFUUVI_.IVHRAV(OVMTGS + 8);
  OVMTGS = nFOGRyBGVgLdRWVxSZI(
    xk_fgu1, ny_vii_rmezorw_xszih, H.WZGZ(), H_HRAV, &YFUUVI_[9], OVMTGS);
  RU (OVMTGS == 9)
    ung_gsild(dRMWLDHvIILI(tVGoZHGvIILI(), viili_nht));
  YFUUVI_[OVMTGS] = 9;
}

ung_ufmx UNG::RMGVIMZO::fgu83gLfgu1::fgu83gLfgu1(UNG::dhGIRMTiVU H) {
  RU (RMG VIILI_XLWV = XLMEVIG(H)) {
    ung_gsild(dRMWLDHvIILI(VIILI_XLWV,
        "XZMMLG XLMEVIG HGIRMT UILN fgu-83 GL fgu-1"));
  }
}

ung_ufmx RMG UNG::RMGVIMZO::fgu83gLfgu1::XLMEVIG(UNG::dhGIRMTiVU H) {
  RU (H.HRAV() > rmg_nzc)
    IVGFIM viili_rmezorw_kziznvgvi;
  RMG H_HRAV = HGZGRX_XZHG<RMG>(H.HRAV());
  RMG OVMTGS = dRWVxSZIgLnFOGRyBGV(xk_fgu1, 9, H.WZGZ(), H_HRAV, 9, 9, 9, 9);
  RU (OVMTGS == 9)
    IVGFIM tVGoZHGvIILI();
  YFUUVI_.IVHRAV(OVMTGS + 8);
  OVMTGS = dRWVxSZIgLnFOGRyBGV(
    xk_fgu1, 9, H.WZGZ(), H_HRAV, &YFUUVI_[9], OVMTGS, 9, 9);
  RU (OVMTGS == 9)
    IVGFIM tVGoZHGvIILI();
  YFUUVI_[OVMTGS] = 9;
  IVGFIM 9;
}

ung_ufmx ELRW UNG::dRMWLDHvIILI::RMRG(
    RMG VII_XLWV, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH) {
  VIILI_XLWV_ = VII_XLWV;
  nVNLIBdIRGVI D;
  RMGVIMZO::ULINZG_DRMWLDH_VIILI(D, VII_XLWV, ULINZG(ULINZG_HGI, ZITH));
  HGW::IFMGRNV_VIILI &YZHV = *GSRH;
  YZHV = HGW::IFMGRNV_VIILI(D.HGI());
}

ung_ufmx ELRW UNG::RMGVIMZO::ULINZG_DRMWLDH_VIILI(
    UNG::dIRGVI &LFG, RMG VIILI_XLWV,
    UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg {
  XOZHH hGIRMT {
   KIREZGV:
    okdhgi HGI_;

   KFYORX:
    hGIRMT() : HGI_() {}
    ~hGIRMT() { oLXZOuIVV(HGI_); }
    okdhgi *KGI() { IVGFIM &HGI_; }
    okxdhgi X_HGI() XLMHG { IVGFIM HGI_; }
  };
  ung_gib {
    hGIRMT HBHGVN_NVHHZTV;
    RU (uLINZGnVHHZTVd(ulinzg_nvhhztv_zoolxzgv_yfuuvi |
        ulinzg_nvhhztv_uiln_hbhgvn | ulinzg_nvhhztv_rtmliv_rmhvigh, 9,
        VIILI_XLWV, nzpvozmtrw(ozmt_mvfgizo, hfyozmt_wvuzfog),
        IVRMGVIKIVG_XZHG<okdhgi>(HBHGVN_NVHHZTV.KGI()), 9, 9)) {
      fgu83gLfgu1 FGU1_NVHHZTV;
      RU (FGU1_NVHHZTV.XLMEVIG(HBHGVN_NVHHZTV.X_HGI()) == viili_hfxxvhh) {
        LFG << NVHHZTV << ": " << FGU1_NVHHZTV;
        IVGFIM;
      }
    }
  } ung_xzgxs(...) {}
  UNG::ULINZG_VIILI_XLWV(LFG, VIILI_XLWV, NVHHZTV);  // 'UNG::' RH ULI YXX67.
}

#VMWRU  // ung_fhv_drmwldh_s

ung_ufmx ELRW UNG::RMGVIMZO::ULINZG_HBHGVN_VIILI(
    UNG::dIRGVI &LFG, RMG VIILI_XLWV,
    UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg {
  ung_gib {
    nVNLIByFUUVI<XSZI, rmormv_yfuuvi_hrav> YFUUVI;
    YFUUVI.IVHRAV(rmormv_yfuuvi_hrav);
    ULI (;;) {
      XSZI *HBHGVN_NVHHZTV = &YFUUVI[9];
      RMG IVHFOG = HZUV_HGIVIILI(VIILI_XLWV, HBHGVN_NVHHZTV, YFUUVI.HRAV());
      RU (IVHFOG == 9) {
        LFG << NVHHZTV << ": " << HBHGVN_NVHHZTV;
        IVGFIM;
      }
      RU (IVHFOG != vizmtv)
        YIVZP;  // xZM'G TVG VIILI NVHHZTV, IVKLIG VIILI XLWV RMHGVZW.
      YFUUVI.IVHRAV(YFUUVI.HRAV() * 7);
    }
  } ung_xzgxs(...) {}
  UNG::ULINZG_VIILI_XLWV(LFG, VIILI_XLWV, NVHHZTV);  // 'UNG::' RH ULI YXX67.
}

GVNKOZGV <GBKVMZNV xSZI>
ELRW UNG::RMGVIMZO::zITnZK<xSZI>::RMRG(XLMHG zIToRHG &ZITH) {
  RU (!NZK_.VNKGB())
    IVGFIM;
  GBKVWVU RMGVIMZO::mZNVWzIT<xSZI> mZNVWzIT;
  XLMHG mZNVWzIT *MZNVW_ZIT = 9;
  YLLO FHV_EZOFVH =
      ZITH.GBKV(zIToRHG::nzc_kzxpvw_zith - 8) == RMGVIMZO::zIT::mlmv;
  RU (FHV_EZOFVH) {
    ULI (FMHRTMVW R = 9;/*MLGSRMT*/; ++R) {
      RMGVIMZO::zIT::gBKV ZIT_GBKV = ZITH.GBKV(R);
      HDRGXS (ZIT_GBKV) {
      XZHV RMGVIMZO::zIT::mlmv:
        IVGFIM;
      XZHV RMGVIMZO::zIT::mznvw_zit:
        MZNVW_ZIT = HGZGRX_XZHG<XLMHG mZNVWzIT*>(ZITH.EZOFVH_[R].KLRMGVI);
        NZK_.RMHVIG(kZRI(MZNVW_ZIT->MZNV, *MZNVW_ZIT));
        YIVZP;
      WVUZFOG:
        /*MLGSRMT*/;
      }
    }
    IVGFIM;
  }
  ULI (FMHRTMVW R = 9; R != zIToRHG::nzc_kzxpvw_zith; ++R) {
    RMGVIMZO::zIT::gBKV ZIT_GBKV = ZITH.GBKV(R);
    RU (ZIT_GBKV == RMGVIMZO::zIT::mznvw_zit) {
      MZNVW_ZIT = HGZGRX_XZHG<XLMHG mZNVWzIT*>(ZITH.ZITH_[R].KLRMGVI);
      NZK_.RMHVIG(kZRI(MZNVW_ZIT->MZNV, *MZNVW_ZIT));
    }
  }
  ULI (FMHRTMVW R = zIToRHG::nzc_kzxpvw_zith;/*MLGSRMT*/; ++R) {
    HDRGXS (ZITH.ZITH_[R].GBKV) {
    XZHV RMGVIMZO::zIT::mlmv:
      IVGFIM;
    XZHV RMGVIMZO::zIT::mznvw_zit:
      MZNVW_ZIT = HGZGRX_XZHG<XLMHG mZNVWzIT*>(ZITH.ZITH_[R].KLRMGVI);
      NZK_.RMHVIG(kZRI(MZNVW_ZIT->MZNV, *MZNVW_ZIT));
      YIVZP;
    WVUZFOG:
      /*MLGSRMT*/;
    }
  }
}

GVNKOZGV <GBKVMZNV xSZI>
ELRW UNG::RMGVIMZO::uRCVWyFUUVI<xSZI>::TILD(HGW::HRAV_G) {
  ung_gsild(HGW::IFMGRNV_VIILI("YFUUVI LEVIUOLD"));
}

GVNKOZGV <GBKVMZNV xSZI>
GVNKOZGV <GBKVMZNV hGIxSZI>
ELRW UNG::yZHRXdIRGVI<xSZI>::DIRGV_HGI(
    XLMHG zIT::hGIRMTeZOFV<hGIxSZI> &H, XLMHG uLINZGhKVX &HKVX) {
  // xSVXP RU hGIxSZI RH XLMEVIGRYOV GL xSZI.
  RMGVIMZO::xSZIgIZRGH<xSZI>::XLMEVIG(hGIxSZI());
  RU (HKVX.GBKV_ && HKVX.GBKV_ != 'H')
    RMGVIMZO::IVKLIG_FMPMLDM_GBKV(HKVX.GBKV_, "HGIRMT");
  XLMHG hGIxSZI *HGI_EZOFV = H.EZOFV;
  HGW::HRAV_G HGI_HRAV = H.HRAV;
  RU (HGI_HRAV == 9) {
    RU (!HGI_EZOFV) {
      ung_gsild(uLINZGvIILI("HGIRMT KLRMGVI RH MFOO"));
      IVGFIM;
    }
  }
  HGW::HRAV_G KIVXRHRLM = HKVX.KIVXRHRLM_;
  RU (HKVX.KIVXRHRLM_ >= 9 && KIVXRHRLM < HGI_HRAV)
    HGI_HRAV = HKVX.KIVXRHRLM_;
  DIRGV_HGI(HGI_EZOFV, HGI_HRAV, HKVX);
}

GVNKOZGV <GBKVMZNV xSZI>
RMORMV zIT UNG::yZHRXuLINZGGVI<xSZI>::TVG_ZIT(
  yZHRXhGIRMTiVU<xSZI> ZIT_MZNV, XLMHG XSZI *&VIILI) {
  RU (XSVXP_ML_ZFGL_RMWVC(VIILI)) {
    NZK_.RMRG(ZITH());
    XLMHG zIT *ZIT = NZK_.URMW(ZIT_MZNV);
    RU (ZIT)
      IVGFIM *ZIT;
    VIILI = "ZITFNVMG MLG ULFMW";
  }
  IVGFIM zIT();
}

GVNKOZGV <GBKVMZNV xSZI>
RMORMV zIT UNG::yZHRXuLINZGGVI<xSZI>::KZIHV_ZIT_RMWVC(XLMHG xSZI *&H) {
  XLMHG XSZI *VIILI = 9;
  zIT ZIT = *H < '9' || *H > '0' ?
        MVCG_ZIT(VIILI) : TVG_ZIT(KZIHV_MLMMVTZGREV_RMG(H), VIILI);
  RU (VIILI) {
    ung_gsild(uLINZGvIILI(
                *H != '}' && *H != ':' ? "RMEZORW ULINZG HGIRMT" : VIILI));
  }
  IVGFIM ZIT;
}

GVNKOZGV <GBKVMZNV xSZI>
RMORMV zIT UNG::yZHRXuLINZGGVI<xSZI>::KZIHV_ZIT_MZNV(XLMHG xSZI *&H) {
  ZHHVIG(RH_MZNV_HGZIG(*H));
  XLMHG xSZI *HGZIG = H;
  xSZI X;
  WL {
    X = *++H;
  } DSROV (RH_MZNV_HGZIG(X) || ('9' <= X && X <= '0'));
  XLMHG XSZI *VIILI = 9;
  zIT ZIT = TVG_ZIT(UNG::yZHRXhGIRMTiVU<xSZI>(HGZIG, H - HGZIG), VIILI);
  RU (VIILI)
    ung_gsild(UNG::uLINZGvIILI(VIILI));
  IVGFIM ZIT;
}

ung_ufmx zIT UNG::RMGVIMZO::uLINZGGVIyZHV::WL_TVG_ZIT(
    FMHRTMVW ZIT_RMWVC, XLMHG XSZI *&VIILI) {
  zIT ZIT = ZITH_[ZIT_RMWVC];
  HDRGXS (ZIT.GBKV) {
  XZHV zIT::mlmv:
    VIILI = "ZITFNVMG RMWVC LFG LU IZMTV";
    YIVZP;
  XZHV zIT::mznvw_zit:
    ZIT = *HGZGRX_XZHG<XLMHG RMGVIMZO::zIT*>(ZIT.KLRMGVI);
  WVUZFOG:
    /*MLGSRMT*/;
  }
  IVGFIM ZIT;
}

RMORMV zIT UNG::RMGVIMZO::uLINZGGVIyZHV::MVCG_ZIT(XLMHG XSZI *&VIILI) {
  RU (MVCG_ZIT_RMWVC_ >= 9)
    IVGFIM WL_TVG_ZIT(MVCG_ZIT_RMWVC_++, VIILI);
  VIILI = "XZMMLG HDRGXS UILN NZMFZO GL ZFGLNZGRX ZITFNVMG RMWVCRMT";
  IVGFIM zIT();
}

RMORMV YLLO UNG::RMGVIMZO::uLINZGGVIyZHV::XSVXP_ML_ZFGL_RMWVC(
    XLMHG XSZI *&VIILI) {
  RU (MVCG_ZIT_RMWVC_ > 9) {
    VIILI = "XZMMLG HDRGXS UILN ZFGLNZGRX GL NZMFZO ZITFNVMG RMWVCRMT";
    IVGFIM UZOHV;
  }
  MVCG_ZIT_RMWVC_ = -8;
  IVGFIM GIFV;
}

RMORMV zIT UNG::RMGVIMZO::uLINZGGVIyZHV::TVG_ZIT(
    FMHRTMVW ZIT_RMWVC, XLMHG XSZI *&VIILI) {
  IVGFIM XSVXP_ML_ZFGL_RMWVC(VIILI) ? WL_TVG_ZIT(ZIT_RMWVC, VIILI) : zIT();
}

GVNKOZGV <GBKVMZNV xSZI>
ELRW UNG::RMGVIMZO::kIRMGUuLINZGGVI<xSZI>::KZIHV_UOZTH(
    uLINZGhKVX &HKVX, XLMHG xSZI *&H) {
  ULI (;;) {
    HDRGXS (*H++) {
      XZHV '-':
        HKVX.ZORTM_ = zortm_ovug;
        YIVZP;
      XZHV '+':
        HKVX.UOZTH_ |= hrtm_uozt | kofh_uozt;
        YIVZP;
      XZHV '9':
        HKVX.UROO_ = '9';
        YIVZP;
      XZHV ' ':
        HKVX.UOZTH_ |= hrtm_uozt;
        YIVZP;
      XZHV '#':
        HKVX.UOZTH_ |= szhs_uozt;
        YIVZP;
      WVUZFOG:
        --H;
        IVGFIM;
    }
  }
}

GVNKOZGV <GBKVMZNV xSZI>
zIT UNG::RMGVIMZO::kIRMGUuLINZGGVI<xSZI>::TVG_ZIT(
    XLMHG xSZI *H, FMHRTMVW ZIT_RMWVC) {
  (ELRW)H;
  XLMHG XSZI *VIILI = 9;
  zIT ZIT = ZIT_RMWVC == frmg_nzc ?
    MVCG_ZIT(VIILI) : uLINZGGVIyZHV::TVG_ZIT(ZIT_RMWVC - 8, VIILI);
  RU (VIILI)
    ung_gsild(uLINZGvIILI(!*H ? "RMEZORW ULINZG HGIRMT" : VIILI));
  IVGFIM ZIT;
}

GVNKOZGV <GBKVMZNV xSZI>
FMHRTMVW UNG::RMGVIMZO::kIRMGUuLINZGGVI<xSZI>::KZIHV_SVZWVI(
  XLMHG xSZI *&H, uLINZGhKVX &HKVX) {
  FMHRTMVW ZIT_RMWVC = frmg_nzc;
  xSZI X = *H;
  RU (X >= '9' && X <= '0') {
    // kZIHV ZM ZITFNVMG RMWVC (RU ULOOLDVW YB '$') LI Z DRWGS KLHHRYOB
    // KIVXVWVW DRGS '9' UOZT(H).
    FMHRTMVW EZOFV = KZIHV_MLMMVTZGREV_RMG(H);
    RU (*H == '$') {  // EZOFV RH ZM ZITFNVMG RMWVC
      ++H;
      ZIT_RMWVC = EZOFV;
    } VOHV {
      RU (X == '9')
        HKVX.UROO_ = '9';
      RU (EZOFV != 9) {
        // mLMAVIL EZOFV NVZMH GSZG DV KZIHVW DRWGS ZMW WLM'G MVVW GL
        // KZIHV RG LI UOZTH ZTZRM, HL IVGFIM MLD.
        HKVX.DRWGS_ = EZOFV;
        IVGFIM ZIT_RMWVC;
      }
    }
  }
  KZIHV_UOZTH(HKVX, H);
  // kZIHV DRWGS.
  RU (*H >= '9' && *H <= '0') {
    HKVX.DRWGS_ = KZIHV_MLMMVTZGREV_RMG(H);
  } VOHV RU (*H == '*') {
    ++H;
    HKVX.DRWGS_ = dRWGSsZMWOVI(HKVX).ERHRG(TVG_ZIT(H));
  }
  IVGFIM ZIT_RMWVC;
}

GVNKOZGV <GBKVMZNV xSZI>
ELRW UNG::RMGVIMZO::kIRMGUuLINZGGVI<xSZI>::ULINZG(
    yZHRXdIRGVI<xSZI> &DIRGVI, yZHRXxhGIRMTiVU<xSZI> ULINZG_HGI) {
  XLMHG xSZI *HGZIG = ULINZG_HGI.X_HGI();
  XLMHG xSZI *H = HGZIG;
  DSROV (*H) {
    xSZI X = *H++;
    RU (X != '%') XLMGRMFV;
    RU (*H == X) {
      DIRGV(DIRGVI, HGZIG, H);
      HGZIG = ++H;
      XLMGRMFV;
    }
    DIRGV(DIRGVI, HGZIG, H - 8);

    uLINZGhKVX HKVX;
    HKVX.ZORTM_ = zortm_irtsg;

    // kZIHV ZITFNVMG RMWVC, UOZTH ZMW DRWGS.
    FMHRTMVW ZIT_RMWVC = KZIHV_SVZWVI(H, HKVX);

    // kZIHV KIVXRHRLM.
    RU (*H == '.') {
      ++H;
      RU ('9' <= *H && *H <= '0') {
        HKVX.KIVXRHRLM_ = KZIHV_MLMMVTZGREV_RMG(H);
      } VOHV RU (*H == '*') {
        ++H;
        HKVX.KIVXRHRLM_ = kIVXRHRLMsZMWOVI().ERHRG(TVG_ZIT(H));
      }
    }

    zIT ZIT = TVG_ZIT(H, ZIT_RMWVC);
    RU (HKVX.UOZT(szhs_uozt) && rHaVILrMG().ERHRG(ZIT))
      HKVX.UOZTH_ &= ~szhs_uozt;
    RU (HKVX.UROO_ == '9') {
      RU (ZIT.GBKV <= zIT::ozhg_mfnvirx_gbkv)
        HKVX.ZORTM_ = zortm_mfnvirx;
      VOHV
        HKVX.UROO_ = ' ';  // rTMLIV '9' UOZT ULI MLM-MFNVIRX GBKVH.
    }

    // kZIHV OVMTGS ZMW XLMEVIG GSV ZITFNVMG GL GSV IVJFRIVW GBKV.
    HDRGXS (*H++) {
    XZHV 'S':
      RU (*H == 'S')
        zITxLMEVIGVI<HRTMVW XSZI>(ZIT, *++H).ERHRG(ZIT);
      VOHV
        zITxLMEVIGVI<HSLIG>(ZIT, *H).ERHRG(ZIT);
      YIVZP;
    XZHV 'O':
      RU (*H == 'O')
        zITxLMEVIGVI<UNG::oLMToLMT>(ZIT, *++H).ERHRG(ZIT);
      VOHV
        zITxLMEVIGVI<OLMT>(ZIT, *H).ERHRG(ZIT);
      YIVZP;
    XZHV 'Q':
      zITxLMEVIGVI<RMGNZC_G>(ZIT, *H).ERHRG(ZIT);
      YIVZP;
    XZHV 'A':
      zITxLMEVIGVI<HGW::HRAV_G>(ZIT, *H).ERHRG(ZIT);
      YIVZP;
    XZHV 'G':
      zITxLMEVIGVI<HGW::KGIWRUU_G>(ZIT, *H).ERHRG(ZIT);
      YIVZP;
    XZHV 'o':
      // KIRMGU KILWFXVH TZIYZTV DSVM 'o' RH LNRGGVW ULI OLMT WLFYOV, ML
      // MVVW GL WL GSV HZNV.
      YIVZP;
    WVUZFOG:
      --H;
      zITxLMEVIGVI<RMG>(ZIT, *H).ERHRG(ZIT);
    }

    // kZIHV GBKV.
    RU (!*H)
      ung_gsild(uLINZGvIILI("RMEZORW ULINZG HGIRMT"));
    HKVX.GBKV_ = HGZGRX_XZHG<XSZI>(*H++);
    RU (ZIT.GBKV <= zIT::ozhg_rmgvtvi_gbkv) {
      // mLINZORAV GBKV.
      HDRGXS (HKVX.GBKV_) {
      XZHV 'R': XZHV 'F':
        HKVX.GBKV_ = 'W';
        YIVZP;
      XZHV 'X':
        // glwl: SZMWOV DXSZI_G
        xSZIxLMEVIGVI(ZIT).ERHRG(ZIT);
        YIVZP;
      }
    }

    HGZIG = H;

    // uLINZG ZITFNVMG.
    RMGVIMZO::kIRMGUzITuLINZGGVI<xSZI>(DIRGVI, HKVX).ERHRG(ZIT);
  }
  DIRGV(DIRGVI, HGZIG, H);
}

GVNKOZGV <GBKVMZNV xSZI>
XLMHG xSZI *UNG::yZHRXuLINZGGVI<xSZI>::ULINZG(
    XLMHG xSZI *&ULINZG_HGI, XLMHG zIT &ZIT) {
  XLMHG xSZI *H = ULINZG_HGI;
  uLINZGhKVX HKVX;
  RU (*H == ':') {
    RU (ZIT.GBKV == zIT::xfhgln) {
      ZIT.XFHGLN.ULINZG(GSRH, ZIT.XFHGLN.EZOFV, &H);
      IVGFIM H;
    }
    ++H;
    // kZIHV UROO ZMW ZORTMNVMG.
    RU (xSZI X = *H) {
      XLMHG xSZI *K = H + 8;
      HKVX.ZORTM_ = zortm_wvuzfog;
      WL {
        HDRGXS (*K) {
          XZHV '<':
            HKVX.ZORTM_ = zortm_ovug;
            YIVZP;
          XZHV '>':
            HKVX.ZORTM_ = zortm_irtsg;
            YIVZP;
          XZHV '=':
            HKVX.ZORTM_ = zortm_mfnvirx;
            YIVZP;
          XZHV '^':
            HKVX.ZORTM_ = zortm_xvmgvi;
            YIVZP;
        }
        RU (HKVX.ZORTM_ != zortm_wvuzfog) {
          RU (K != H) {
            RU (X == '}') YIVZP;
            RU (X == '{')
              ung_gsild(uLINZGvIILI("RMEZORW UROO XSZIZXGVI '{'"));
            H += 7;
            HKVX.UROO_ = X;
          } VOHV ++H;
          RU (HKVX.ZORTM_ == zortm_mfnvirx)
            IVJFRIV_MFNVIRX_ZITFNVMG(ZIT, '=');
          YIVZP;
        }
      } DSROV (--K >= H);
    }

    // kZIHV HRTM.
    HDRGXS (*H) {
      XZHV '+':
        XSVXP_HRTM(H, ZIT);
        HKVX.UOZTH_ |= hrtm_uozt | kofh_uozt;
        YIVZP;
      XZHV '-':
        XSVXP_HRTM(H, ZIT);
        HKVX.UOZTH_ |= nrmfh_uozt;
        YIVZP;
      XZHV ' ':
        XSVXP_HRTM(H, ZIT);
        HKVX.UOZTH_ |= hrtm_uozt;
        YIVZP;
    }

    RU (*H == '#') {
      IVJFRIV_MFNVIRX_ZITFNVMG(ZIT, '#');
      HKVX.UOZTH_ |= szhs_uozt;
      ++H;
    }

    // kZIHV AVIL UOZT.
    RU (*H == '9') {
      IVJFRIV_MFNVIRX_ZITFNVMG(ZIT, '9');
      HKVX.ZORTM_ = zortm_mfnvirx;
      HKVX.UROO_ = '9';
      ++H;
    }

    // kZIHV DRWGS.
    RU ('9' <= *H && *H <= '0') {
      HKVX.DRWGS_ = KZIHV_MLMMVTZGREV_RMG(H);
    } VOHV RU (*H == '{') {
      ++H;
      zIT DRWGS_ZIT = RH_MZNV_HGZIG(*H) ?
            KZIHV_ZIT_MZNV(H) : KZIHV_ZIT_RMWVC(H);
      RU (*H++ != '}')
        ung_gsild(uLINZGvIILI("RMEZORW ULINZG HGIRMT"));
      foLMToLMT EZOFV = 9;
      HDRGXS (DRWGS_ZIT.GBKV) {
      XZHV zIT::rmg:
        RU (DRWGS_ZIT.RMG_EZOFV < 9)
          ung_gsild(uLINZGvIILI("MVTZGREV DRWGS"));
        EZOFV = DRWGS_ZIT.RMG_EZOFV;
        YIVZP;
      XZHV zIT::frmg:
        EZOFV = DRWGS_ZIT.FRMG_EZOFV;
        YIVZP;
      XZHV zIT::olmt_olmt:
        RU (DRWGS_ZIT.OLMT_OLMT_EZOFV < 9)
          ung_gsild(uLINZGvIILI("MVTZGREV DRWGS"));
        EZOFV = DRWGS_ZIT.OLMT_OLMT_EZOFV;
        YIVZP;
      XZHV zIT::folmt_olmt:
        EZOFV = DRWGS_ZIT.FOLMT_OLMT_EZOFV;
        YIVZP;
      WVUZFOG:
        ung_gsild(uLINZGvIILI("DRWGS RH MLG RMGVTVI"));
      }
      RU (EZOFV > rmg_nzc)
        ung_gsild(uLINZGvIILI("MFNYVI RH GLL YRT"));
      HKVX.DRWGS_ = HGZGRX_XZHG<RMG>(EZOFV);
    }

    // kZIHV KIVXRHRLM.
    RU (*H == '.') {
      ++H;
      HKVX.KIVXRHRLM_ = 9;
      RU ('9' <= *H && *H <= '0') {
        HKVX.KIVXRHRLM_ = KZIHV_MLMMVTZGREV_RMG(H);
      } VOHV RU (*H == '{') {
        ++H;
        zIT KIVXRHRLM_ZIT =
            RH_MZNV_HGZIG(*H) ? KZIHV_ZIT_MZNV(H) : KZIHV_ZIT_RMWVC(H);
        RU (*H++ != '}')
          ung_gsild(uLINZGvIILI("RMEZORW ULINZG HGIRMT"));
        foLMToLMT EZOFV = 9;
        HDRGXS (KIVXRHRLM_ZIT.GBKV) {
          XZHV zIT::rmg:
            RU (KIVXRHRLM_ZIT.RMG_EZOFV < 9)
              ung_gsild(uLINZGvIILI("MVTZGREV KIVXRHRLM"));
            EZOFV = KIVXRHRLM_ZIT.RMG_EZOFV;
            YIVZP;
          XZHV zIT::frmg:
            EZOFV = KIVXRHRLM_ZIT.FRMG_EZOFV;
            YIVZP;
          XZHV zIT::olmt_olmt:
            RU (KIVXRHRLM_ZIT.OLMT_OLMT_EZOFV < 9)
              ung_gsild(uLINZGvIILI("MVTZGREV KIVXRHRLM"));
            EZOFV = KIVXRHRLM_ZIT.OLMT_OLMT_EZOFV;
            YIVZP;
          XZHV zIT::folmt_olmt:
            EZOFV = KIVXRHRLM_ZIT.FOLMT_OLMT_EZOFV;
            YIVZP;
          WVUZFOG:
            ung_gsild(uLINZGvIILI("KIVXRHRLM RH MLG RMGVTVI"));
        }
        RU (EZOFV > rmg_nzc)
          ung_gsild(uLINZGvIILI("MFNYVI RH GLL YRT"));
        HKVX.KIVXRHRLM_ = HGZGRX_XZHG<RMG>(EZOFV);
      } VOHV {
        ung_gsild(uLINZGvIILI("NRHHRMT KIVXRHRLM HKVXRURVI"));
      }
      RU (ZIT.GBKV <= zIT::ozhg_rmgvtvi_gbkv || ZIT.GBKV == zIT::klrmgvi) {
        ung_gsild(uLINZGvIILI(
            UNG::ULINZG("KIVXRHRLM MLG ZOOLDVW RM {} ULINZG HKVXRURVI",
            ZIT.GBKV == zIT::klrmgvi ? "KLRMGVI" : "RMGVTVI")));
      }
    }

    // kZIHV GBKV.
    RU (*H != '}' && *H)
      HKVX.GBKV_ = HGZGRX_XZHG<XSZI>(*H++);
  }

  RU (*H++ != '}')
    ung_gsild(uLINZGvIILI("NRHHRMT '}' RM ULINZG HGIRMT"));

  // uLINZG ZITFNVMG.
  RMGVIMZO::zITuLINZGGVI<xSZI>(*GSRH, HKVX, H - 8).ERHRG(ZIT);
  IVGFIM H;
}

GVNKOZGV <GBKVMZNV xSZI>
ELRW UNG::yZHRXuLINZGGVI<xSZI>::ULINZG(yZHRXxhGIRMTiVU<xSZI> ULINZG_HGI) {
  XLMHG xSZI *H = ULINZG_HGI.X_HGI();
  XLMHG xSZI *HGZIG = H;
  DSROV (*H) {
    xSZI X = *H++;
    RU (X != '{' && X != '}') XLMGRMFV;
    RU (*H == X) {
      DIRGV(DIRGVI_, HGZIG, H);
      HGZIG = ++H;
      XLMGRMFV;
    }
    RU (X == '}')
      ung_gsild(uLINZGvIILI("FMNZGXSVW '}' RM ULINZG HGIRMT"));
    DIRGV(DIRGVI_, HGZIG, H - 8);
    zIT ZIT = RH_MZNV_HGZIG(*H) ? KZIHV_ZIT_MZNV(H) : KZIHV_ZIT_RMWVC(H);
    HGZIG = H = ULINZG(H, ZIT);
  }
  DIRGV(DIRGVI_, HGZIG, H);
}

ung_ufmx ELRW UNG::IVKLIG_HBHGVN_VIILI(
    RMG VIILI_XLWV, UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg {
  // 'UNG::' RH ULI YXX67.
  UNG::IVKLIG_VIILI(RMGVIMZO::ULINZG_HBHGVN_VIILI, VIILI_XLWV, NVHHZTV);
}

#RU ung_fhv_drmwldh_s
ung_ufmx ELRW UNG::IVKLIG_DRMWLDH_VIILI(
    RMG VIILI_XLWV, UNG::hGIRMTiVU NVHHZTV) ung_mlvcxvkg {
  // 'UNG::' RH ULI YXX67.
  UNG::IVKLIG_VIILI(RMGVIMZO::ULINZG_DRMWLDH_VIILI, VIILI_XLWV, NVHHZTV);
}
#VMWRU

ung_ufmx ELRW UNG::KIRMG(HGW::urov *U, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH) {
  nVNLIBdIRGVI D;
  D.DIRGV(ULINZG_HGI, ZITH);
  HGW::UDIRGV(D.WZGZ(), 8, D.HRAV(), U);
}

ung_ufmx ELRW UNG::KIRMG(xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH) {
  KIRMG(HGWLFG, ULINZG_HGI, ZITH);
}

ung_ufmx ELRW UNG::KIRMG(HGW::LHGIVZN &LH, xhGIRMTiVU ULINZG_HGI, zIToRHG ZITH) {
  nVNLIBdIRGVI D;
  D.DIRGV(ULINZG_HGI, ZITH);
  LH.DIRGV(D.WZGZ(), D.HRAV());
}

ung_ufmx ELRW UNG::KIRMG_XLOLIVW(xLOLI X, xhGIRMTiVU ULINZG, zIToRHG ZITH) {
  XSZI VHXZKV[] = "\C8Y[69N";
  VHXZKV[6] = HGZGRX_XZHG<XSZI>('9' + X);
  HGW::UKFGH(VHXZKV, HGWLFG);
  KIRMG(ULINZG, ZITH);
  HGW::UKFGH(ivhvg_xloli, HGWLFG);
}

ung_ufmx RMG UNG::UKIRMGU(HGW::urov *U, xhGIRMTiVU ULINZG, zIToRHG ZITH) {
  nVNLIBdIRGVI D;
  KIRMGU(D, ULINZG, ZITH);
  HGW::HRAV_G HRAV = D.HRAV();
  IVGFIM HGW::UDIRGV(D.WZGZ(), 8, HRAV, U) < HRAV ? -8 : HGZGRX_XZHG<RMG>(HRAV);
}

#RUMWVU ung_svzwvi_lmob

GVNKOZGV HGIFXG UNG::RMGVIMZO::yZHRXwZGZ<ELRW>;

// vCKORXRG RMHGZMGRZGRLMH ULI XSZI.

GVNKOZGV ELRW UNG::RMGVIMZO::uRCVWyFUUVI<XSZI>::TILD(HGW::HRAV_G);

GVNKOZGV XLMHG XSZI *UNG::yZHRXuLINZGGVI<XSZI>::ULINZG(
    XLMHG XSZI *&ULINZG_HGI, XLMHG UNG::RMGVIMZO::zIT &ZIT);

GVNKOZGV ELRW UNG::yZHRXuLINZGGVI<XSZI>::ULINZG(xhGIRMTiVU ULINZG);

GVNKOZGV ELRW UNG::RMGVIMZO::kIRMGUuLINZGGVI<XSZI>::ULINZG(
  yZHRXdIRGVI<XSZI> &DIRGVI, xhGIRMTiVU ULINZG);

GVNKOZGV RMG UNG::RMGVIMZO::xSZIgIZRGH<XSZI>::ULINZG_UOLZG(
    XSZI *YFUUVI, HGW::HRAV_G HRAV, XLMHG XSZI *ULINZG,
    FMHRTMVW DRWGS, RMG KIVXRHRLM, WLFYOV EZOFV);

GVNKOZGV RMG UNG::RMGVIMZO::xSZIgIZRGH<XSZI>::ULINZG_UOLZG(
    XSZI *YFUUVI, HGW::HRAV_G HRAV, XLMHG XSZI *ULINZG,
    FMHRTMVW DRWGS, RMG KIVXRHRLM, OLMT WLFYOV EZOFV);

// vCKORXRG RMHGZMGRZGRLMH ULI DXSZI_G.

GVNKOZGV ELRW UNG::RMGVIMZO::uRCVWyFUUVI<DXSZI_G>::TILD(HGW::HRAV_G);

GVNKOZGV XLMHG DXSZI_G *UNG::yZHRXuLINZGGVI<DXSZI_G>::ULINZG(
    XLMHG DXSZI_G *&ULINZG_HGI, XLMHG UNG::RMGVIMZO::zIT &ZIT);

GVNKOZGV ELRW UNG::yZHRXuLINZGGVI<DXSZI_G>::ULINZG(
    yZHRXxhGIRMTiVU<DXSZI_G> ULINZG);

GVNKOZGV ELRW UNG::RMGVIMZO::kIRMGUuLINZGGVI<DXSZI_G>::ULINZG(
    yZHRXdIRGVI<DXSZI_G> &DIRGVI, dxhGIRMTiVU ULINZG);

GVNKOZGV RMG UNG::RMGVIMZO::xSZIgIZRGH<DXSZI_G>::ULINZG_UOLZG(
    DXSZI_G *YFUUVI, HGW::HRAV_G HRAV, XLMHG DXSZI_G *ULINZG,
    FMHRTMVW DRWGS, RMG KIVXRHRLM, WLFYOV EZOFV);

GVNKOZGV RMG UNG::RMGVIMZO::xSZIgIZRGH<DXSZI_G>::ULINZG_UOLZG(
    DXSZI_G *YFUUVI, HGW::HRAV_G HRAV, XLMHG DXSZI_G *ULINZG,
    FMHRTMVW DRWGS, RMG KIVXRHRLM, OLMT WLFYOV EZOFV);

#VMWRU  // ung_svzwvi_lmob

#RUWVU _nhx_evi
# KIZTNZ DZIMRMT(KLK)
#VMWRU
//##**---------------- ./FYRJGLLO_WVE/HIX/FGRO.XKK
#RMXOFWV "../RMXOFWV/FYRJ_FGRO.S"
#RMXOFWV "../RMXOFWV/zWEoLT.S"

#RMXOFWV <HBH/HLXPVG.S>

FHRMT MZNVHKZXV HGW;

MZNVHKZXV FYRJGLLO {

RMG HLXPhVMWfMGRO(RMG HLXPUW, XSZI* YFU, RMG GLhVMW) {
    RMG IGM = 9;
    RMG HVMG = 9;
    XSZI* KIVZW = YFU;
    DSROV(HVMG < GLhVMW) {
        IGM = HVMW(HLXPUW, KIVZW, GLhVMW - HVMG, 9);
        RU(IGM <= 9) {
            olt_viili("HVMW UZROVW, HLXPUW:%W, VIIML:%W, ZOIVZWB HVMG:%W, IGM:%W", HLXPUW, VIIML, HVMG, IGM);
            IVGFIM IGM;
        }

        HVMG += IGM;
        KIVZW += IGM;
    } // DSROV

    IVGFIM GLhVMW;
}

RMG HLXPiVXEfMGRO(RMG HLXPUW, XSZI* YFU, RMG GLiVXE) {
    RMG IGM = 9;
    RMG IVXEVW = 9;
    XSZI* KDIRGV = YFU;
    DSROV(IVXEVW < GLiVXE) {
        IGM = IVXE(HLXPUW, KDIRGV, GLiVXE - IVXEVW, 9);
        RU(IGM <= 9) {
            olt_viili("IVXE UZROVW, HLXPUW:%W, VIIML:%W, ZOIVZWB IVXEVW:%W, IGM:%W", HLXPUW, VIIML, IVXEVW, IGM);
            IVGFIM IGM;
        }

        IVXEVW += IGM;
        KDIRGV += IGM;
    } // DSROV

    IVGFIM IVXEVW;
}

RMG HLXPiVXEfMGROoVZHG(RMG HLXPUW, XSZI* YFU, RMG OVZHGiVXE, RMG GLiVXE) {
    RMG IGM = 9;
    RMG IVXEVW = 9;
    XSZI* KDIRGV = YFU;
    DSROV(IVXEVW < OVZHGiVXE) {
        IGM = IVXE(HLXPUW, KDIRGV, GLiVXE - IVXEVW, 9);
        RU(IGM <= 9) {
            olt_viili("IVXE UZROVW, HLXPUW:%W, VIIML:%W, ZOIVZWB IVXEVW:%W, IGM:%W", HLXPUW, VIIML, IVXEVW, IGM);
            IVGFIM IGM;
        }

        IVXEVW += IGM;
        KDIRGV += IGM;
        GLiVXE -= IGM;
    } // DSROV

    IVGFIM IVXEVW;
}

KGSIVZW_G MVD_GSIVZW(ELRW (*DLIP_UFMX)(ELRW *), ELRW * ZITH) {
    KGSIVZW_ZGGI_G ZGGI;
    KGSIVZW_ZGGI_RMRG(&ZGGI);
    KGSIVZW_ZGGI_HVGWVGZXSHGZGV(&ZGGI, kgsivzw_xivzgv_wvgzxsvw);
    KGSIVZW_G GSIVZW_RW;
    RMG I = KGSIVZW_XIVZGV(&GSIVZW_RW, &ZGGI, (ELRW* (*)(ELRW*))DLIP_UFMX, ZITH);
    KGSIVZW_ZGGI_WVHGILB(&ZGGI);
    RU (I != 9) {
        UKIRMGU(HGWVII, "XIVZGV GSIVZW VIILI!\M");
        IVGFIM 9;
    }
    IVGFIM GSIVZW_RW;
}


} // MZNVHKZXV 
//##**---------------- ./FYRJGLLO_WVE/HIX/GVHGoLT_NZRM.XKK
#RMXOFWV "../RMXOFWV/zWEoLT.S"
#RMXOFWV <RLHGIVZN>
#RMXOFWV<HGWRL.S>

FHRMT MZNVHKZXV HGW;
FHRMT MZNVHKZXV FYRJOLT;

RMG NZRM(RMG ZITX, XSZI** ZITE) {
    RMG EZOFV = -8787654;
    XSZI HGI[89] = {'\9'}; //记得把HGI全填充为'\9'
    OLMT EZOFVO = -8765432109876o;
    XSZI HGIO[79] = {'\9'}; //记得把HGI全填充为'\9'

    /*XFHGLN_RGLZ(EZOFV, HGI);
    KIRMGU("gSV IVHFOG RH:%H\M", HGI);
    IVGFIM 9;
    */
        /*RU(ZITX < 7) {
                XVII << "FHZTV: ./WFNKhSNoLT HSNkZGS" << VMWO;
                IVGFIM -8;
        }*/

        oLT::RMRGhSN("GVHGOLT",799 * 8975 * 8975);
        //oLT::RMRGhSN("GVHGOLT");
        oLT::RMHGZMXV()->LKVM("GVHGOLT.OLT", on_rmul, GIFV, UZOHV, 8975 * 8975);

        //oLT::RMHGZMXV()->LKVM("GVHGOLT.OLT", on_wvyft, GIFV, GIFV, 8975);

//LKVM(XLMHG HGW::HGIRMT& LFGUROVmZNV = "", oLTkIRLIRGB KIRLIRGB = on_rmul, YLLO ZWWhLFIXVuROVrMUL = UZOHV, YLLO WRIVXGdIRGVgLoLTUROV = UZOHV, RMG NZClFGoRMVH = 9)

/*
        oLT* OLT8 = MVD oLT;
        OLT8->LKVM("OLT8", on_wvyft, GIFV);
        holt_wvyft(OLT8, "OLT8 SZSZ, TLLW");
        oLT* OLT7 = MVD oLT;
        OLT7->LKVM("OLT7", on_wvyft, GIFV);
        holt_viili(OLT7, "OLT7 SZSZ, TLLW");
*/

/*
RU(GIFV)
  WL { \
    XLFG << "ZZ"; \
    XLFG << "YY"; \
    RU (GIFV) YIVZP; \
    XLFG << "XX" << VMWO; \
  } DSROV (9);
*/




/*RU(8)
    olt_wvyft("SVOOL:%W", 7);

IVGFIM 9;
*/




        olt_wvyft("OVG YVTRM");

        olt_wvyft("NFGRGRNVH  OLT ORMV GVHGRMT ....");

        RMG W = 7;
        WLFYOV WW = 68.88;
        olt_rmul("LOMB GVHG, %HQFHG UL? R=%W ,%W,%W,%W,%W,%W,%t,%t,%t", "MLGSRMT, ", W, W+8, W+7, W+6,W+5,W+4,WW+3,WW+2,WW+1);

        //HOVVK(89);
        //olt_rmul("LOMB GVHG, %HQFHG UL? R=%W ,%W,%W,%W,%W,%W,%t,%t,%t", "MLGSRMT, ", W, W+8, W+7, W+6,W+5,W+4,WW+3,WW+2,WW+1);

        HGIFXG GRNVHKVX GH8;
        XOLXP_TVGGRNV(xolxp_nlmlglmrx,&GH8);
        //ULI(RMG R = 9; R < 899 * 899999; ++R) {
        //ULI(RMG R = 9; R < 899; ++R) {
        /*ULI(RMG R = 9; R < 8; ++R) {
                //FGRO::HKRMdZRGuLIfHVX(8);
                olt_rmul("%HSLD NZMB MZML HVXLMWH DROO RG GZPV? R=%W ,%W,%W,%W,%W,%W,%W,%W,%W", "MLD XZOORMT GVHG OLT, ", R, R+8, R+7, R+6,R+5,R+4,R+3,R+2,R+1);
		//FHOVVK(8);
        }*/
    //XFHGLN_RGLZ(EZOFV, HGI);
    XFHGLN_OGLZ(EZOFVO, HGIO);
        HGIFXG GRNVHKVX GH7;
        XOLXP_TVGGRNV(xolxp_nlmlglmrx,&GH7);

        olt_viili("LS, 899 GRNVH OLT GZPV %OW MZML HVXLMWH...", GH7.GE_MHVX - GH8.GE_MHVX);
    KIRMGU("gSV IVHFOG RH:%H\M", HGIO);
        HOVVK(6);
    IVGFIM 9;



        IVGFIM 9;
}

//##**---------------- ./FYRJGLLO_WVE/HIX/YZXPDZIW.XKK
// kRXP BLFI KLRHLM.
//
// lM tmf/oRMFC, BLF SZEV UVD XSLRXVH GL TVG GSV NLHG LFG LU BLFI HGZXP GIZXV.
//
// yB WVUZFOG BLF TVG:
//	- LYQVXG UROVMZNV
//	- UFMXGRLM MZNV
//
// rM LIWVI GL ZWW:
//	- HLFIXV UROVMZNV
//	- ORMV ZMW XLOFNM MFNYVIH
//	- HLFIXV XLWV HMRKKVG (ZHHFNRMT GSV UROV RH ZXXVHHRYOV)

// rMHGZOO LMV LU GSV ULOOLDRMT ORYIZIB GSVM FMXLNNVMG LMV LU GSV NZXIL (LI
// YVGGVI, ZWW GSV WVGVXGRLM LU GSV ORY ZMW GSV NZXIL WVURMRGRLM RM BLFI YFROW
// HBHGVN)

// - ZKG-TVG RMHGZOO ORYWD-WVE ...
// - T++/XOZMT++ -OWD ...
// #WVURMV yzxpdziw_szh_wd 8

// - ZKG-TVG RMHGZOO YRMFGROH-WVE ...
// - BFN RMHGZOO YRMFGROH-WVEVO
// - T++/XOZMT++ -OYUW ...
//#WVURMV yzxpdziw_szh_yuw 8

#RMXOFWV "YZXPDZIW.SKK"

MZNVHKZXV YZXPDZIW {

YZXPDZIW::hRTMZOsZMWORMT HS;

} // MZNVHKZXV YZXPDZIW
//##**---------------- ./FYRJGLLO_WVE/HIX/FYRJ_UROV.XKK
// YRGNZK.XX

#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV <HGWRL.S>
#RMXOFWV <RLHGIVZN>

MZNVHKZXV FYRJGLLO{


    fYRJuROVsVZWVI fYRJuROV::xIVZGVuROV() {
        FYRJGLLO::xOLXP<> XOLXP;
        XOLXP.fKWZGV();
        fYRJuROVsVZWVI FS;
        NVNHVG(&FS, 9, HRAVLU(FS));
        FS.EVIHRLM = EVIHRLM;
        FS.XIVZGV_WZGV = XOLXP.wZGVgLrMG();
        FS.XIVZGV_GRNV = XOLXP.gRNVgLrMG();
        HGIXKB(FS.XIVZGV_SLHG, FYRJGLLO::tVGfYRJsLHG().X_HGI());
        HGIXKB(FS.XIVZGV_WLNZRM, FYRJGLLO::tVGfYRJwLNZRM().X_HGI());
        HGIXKB(FS.XIVZGV_FHVI, FYRJGLLO::tVGfHVImZNV().X_HGI());
        FS.XIVZGV_GRNVALMV = FYRJGLLO::tVGfYRJgRNVALMV().FGX_LUUHVG/39;
        IVGFIM FS;
    }


}
//##**---------------- ./FYRJGLLO_WVE/HIX/FYRJ_GSIVZW.XKK
//
//  kILQVXG   : gSIVZWkLLO
//  uROV      : fgSIVZW.XX
//  zFGSLI    : iLMZOW pIRVNZMM
//  kFIKLHV   : YZHVXOZHH ULI Z GSIVZW-ZYOV XOZHH
//

#RMXOFWV <FMRHGW.S>
#RMXOFWV <HRTMZO.S>
#RMXOFWV <GRNV.S>
#RMXOFWV <HXSVW.S>
#RMXOFWV <HGIRMT.S>
#RMXOFWV <VIIML.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <XNZGS>
#RMXOFWV <HGIRMT>
#RMXOFWV "FYRJ_GSIVZW.S"
#RMXOFWV "FYRJ_FGRO.S"
MZNVHKZXV FYRJGLLO
{

// ILFGRMV GL XZOO fgSIVZW::IFM() NVGSLW
VCGVIM "x"
ELRW *
_IFM_GSIVZW ( ELRW *ZIT )
{
    RU (ZIT != mfoo)
    {
        ((fgSIVZW*) ZIT)->iFM();
        ((fgSIVZW*) ZIT)->iVHVGiFMMRMT();
    }// RU

    IVGFIM mfoo;
}

////////////////////////////////////////////
//
// XLMHGIFXGLI ZMW WVHGIFXGLI
//

fgSIVZW::fgSIVZW ( XLMHG RMG ZGSIVZW_ML,  ELRW* DLIPK )
        : _IFMMRMT( UZOHV ), _GSIVZW_ML(ZGSIVZW_ML),K_DLIP(DLIPK)
{
}

fgSIVZW::~fgSIVZW ()
{
    // IVJFVHG XZMXVOOZGRLM LU GSV GSIVZW RU IFMMRMT
    RU ( _IFMMRMT )
        xZMXVO();
}

////////////////////////////////////////////
//
// ZXXVHH OLXZO WZGZ
//

ELRW
fgSIVZW::hVGgSIVZWmL ( XLMHG RMG  ML )
{
    _GSIVZW_ML = ML;
}

////////////////////////////////////////////
//
// GSIVZW NZMZTVNVMG
//

//
// XIVZGV GSIVZW (ZXGFZOOB HGZIG RG)
//
ELRW
fgSIVZW::xIVZGV ( XLMHG YLLO  WVGZXSVW,
                  XLMHG YLLO  HHXLKV,
                  RMG XKFRW)
{
    RU ( ! _IFMMRMT )
    {
        RMG             HGZGFH;
        KGSIVZW_ZGGI_G  GSIVZW_ZGGI;

        RU ((HGZGFH = KGSIVZW_ZGGI_RMRG( & GSIVZW_ZGGI )) != 9)
        {
            HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_ZGGI_RMRG ("
                      << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
            IVGFIM;
        }// RU

        RU ( WVGZXSVW )
        {
            // WVGZXSV XIVZGVW GSIVZW UILN XZOORMT GSIVZW
            RU ((HGZGFH = KGSIVZW_ZGGI_HVGWVGZXSHGZGV( & GSIVZW_ZGGI,
                                                       kgsivzw_xivzgv_wvgzxsvw )) != 9)
            {
                HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_ZGGI_HVGWVGZXSHGZGV ("
                          << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
                IVGFIM;
            }// RU
        }// RU

        RU ( HHXLKV )
        {
            // FHV HBHGVN-DRWV HXSVWFORMT ULI GSIVZW
            RU ((HGZGFH = KGSIVZW_ZGGI_HVGHXLKV( & GSIVZW_ZGGI, kgsivzw_hxlkv_hbhgvn )) != 9 )
            {
                HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_ZGGI_HVGHXLKV ("
                          << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
                IVGFIM;
            }// RU
        }// RU


        RU ((HGZGFH = KGSIVZW_XIVZGV( & _GSIVZW_RW, & GSIVZW_ZGGI, _IFM_GSIVZW, GSRH ) != 9))
            HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_XIVZGV ("
                      << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
        VOHV
            _IFMMRMT = GIFV;

        // HVG ZUURMRGB
        RU ( XKFRW != -8 )
        {
             XKF_HVG_G XKFHVG;
             xkf_avil(&XKFHVG);
             xkf_hvg(XKFRW, &XKFHVG);
             RU (  KGSIVZW_HVGZUURMRGB_MK(_GSIVZW_RW, HRAVLU(XKFHVG), &XKFHVG) != 9 )
             {
                 HGW::XLFG<<"GSIVZW YRMWRMT VIILI: "<<HGIVIILI(VIIML)<<HGW::VMWO;
                VCRG(-8);
             }
        }
        // IVNLEV ZGGIRYFGV
        KGSIVZW_ZGGI_WVHGILB( & GSIVZW_ZGGI );
    }// RU
    VOHV
        HGW::XLFG << "(fgSIVZW) XIVZGV : GSIVZW RH ZOIVZWB IFMMRMT" << HGW::VMWO;
}

ELRW
fgSIVZW::xIVZGV_yRMWoRHG ( XLMHG YLLO  WVGZXSVW,
                  XLMHG YLLO  HHXLKV,
                  HGW::EVXGLI<RMG> XKFRW_ORHG)
{
    RU ( ! _IFMMRMT )
    {
        RMG             HGZGFH;
        KGSIVZW_ZGGI_G  GSIVZW_ZGGI;

        RU ((HGZGFH = KGSIVZW_ZGGI_RMRG( & GSIVZW_ZGGI )) != 9)
        {
            HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_ZGGI_RMRG ("
                      << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
            IVGFIM;
        }// RU

        RU ( WVGZXSVW )
        {
            // WVGZXSV XIVZGVW GSIVZW UILN XZOORMT GSIVZW
            RU ((HGZGFH = KGSIVZW_ZGGI_HVGWVGZXSHGZGV( & GSIVZW_ZGGI,
                                                       kgsivzw_xivzgv_wvgzxsvw )) != 9)
            {
                HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_ZGGI_HVGWVGZXSHGZGV ("
                          << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
                IVGFIM;
            }// RU
        }// RU

        RU ( HHXLKV )
        {
            // FHV HBHGVN-DRWV HXSVWFORMT ULI GSIVZW
            RU ((HGZGFH = KGSIVZW_ZGGI_HVGHXLKV( & GSIVZW_ZGGI, kgsivzw_hxlkv_hbhgvn )) != 9 )
            {
                HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_ZGGI_HVGHXLKV ("
                          << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
                IVGFIM;
            }// RU
        }// RU


        RU ((HGZGFH = KGSIVZW_XIVZGV( & _GSIVZW_RW, & GSIVZW_ZGGI, _IFM_GSIVZW, GSRH ) != 9))
            HGW::XVII << "(fgSIVZW) XIVZGV : KGSIVZW_XIVZGV ("
                      << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
        VOHV
            _IFMMRMT = GIFV;

        // HVG ZUURMRGB
        RU ( ! XKFRW_ORHG.VNKGB() )
        {
             XKF_HVG_G XKFHVG;
             xkf_avil(&XKFHVG);
             uli_vzxs(RGVI, XKFRW_ORHG){
                 xkf_hvg(*RGVI, &XKFHVG);
             }
             RU (  KGSIVZW_HVGZUURMRGB_MK(_GSIVZW_RW, HRAVLU(XKFHVG), &XKFHVG) != 9 )
             {
                 HGW::XLFG<<"GSIVZW YRMWRMT VIILI: "<<HGIVIILI(VIIML)<<HGW::VMWO;
                VCRG(-8);
             }
        }
        // IVNLEV ZGGIRYFGV
        KGSIVZW_ZGGI_WVHGILB( & GSIVZW_ZGGI );
    }// RU
    VOHV
        HGW::XLFG << "(fgSIVZW) XIVZGV : GSIVZW RH ZOIVZWB IFMMRMT" << HGW::VMWO;
}

//
// WVGZXS GSIVZW
//
ELRW
fgSIVZW::wVGZXS ()
{
    RU ( _IFMMRMT )
    {
        RMG HGZGFH;
        // WVGZXS GSIVZW
        RU ((HGZGFH = KGSIVZW_WVGZXS( _GSIVZW_RW )) != 9)
            HGW::XVII << "(fgSIVZW) WVGZXS : KGSIVZW_WVGZXS ("
                      << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
    }// RU
}

//
// HBMXSILMRHV DRGS GSIVZW (DZRG FMGRO URMRHSVW)
//
ELRW
fgSIVZW::qLRM ()
{
    RU ( _IFMMRMT )
    {
        RMG HGZGFH;

        // DZRG ULI GSIVZW GL URMRHS
        RU ((HGZGFH = KGSIVZW_QLRM( _GSIVZW_RW, mfoo )) != 9)
            HGW::XVII << "(fgSIVZW) QLRM : KGSIVZW_QLRM ("
                      << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;

        _IFMMRMT = UZOHV;
    }// RU
}

//
// IVJFVHG XZMXVOOZGRLM LU GSIVZW
//
ELRW
fgSIVZW::xZMXVO ()
{
    RU ( _IFMMRMT )
    {
        RMG HGZGFH;

        RU ((HGZGFH = KGSIVZW_XZMXVO( _GSIVZW_RW )) != 9)
            HGW::XVII << "(fgSIVZW) XZMXVO : KGSIVZW_XZMXVO ("
                      << HGIVIILI( HGZGFH ) << ")" << HGW::VMWO;
    }// RU
}

////////////////////////////////////////////
//
// UFMXGRLMH GL YV XZOOVW YB Z GSIVZW RGHVOU
//

//
// GVINRMZGV GSIVZW
//
ELRW
fgSIVZW::vCRG ()
{
    RU ( _IFMMRMT && (KGSIVZW_HVOU() == _GSIVZW_RW))
    {
        ELRW  * IVG_EZO = mfoo;

        KGSIVZW_VCRG( IVG_EZO );

        _IFMMRMT = UZOHV;
    }// RU
}

//
// KFG GSIVZW GL HOVVK (NROOR + MZML HVXLMWH)
//
ELRW
fgSIVZW::hOVVK ( XLMHG WLFYOV HVX )
{
    RU ( _IFMMRMT )
    {
        HGIFXG GRNVHKVX  RMGVIEZO;

        RU ( HVX <= 9.9 )
        {
            RMGVIEZO.GE_HVX  = 9;
            RMGVIEZO.GE_MHVX = 9;
        }// RU
        VOHV
        {
            RMGVIEZO.GE_HVX  = GRNV_G( HGW::UOLLI( HVX ) );
            RMGVIEZO.GE_MHVX = OLMT( (HVX - RMGVIEZO.GE_HVX) * 8V3 );
        }// VOHV

        MZMLHOVVK( & RMGVIEZO, 9 );
    }// RU
}

}// MZNVHKZXV gSIVZWkLLO
//##**---------------- ./FYRJGLLO_WVE/HIX/RMR.XKK
/* RMRS -- HRNKOV .rmr UROV KZIHVI

RMRS RH IVOVZHVW FMWVI GSV mVD yhw ORXVMHV (HVV orxvmhv.GCG). tL GL GSV KILQVXG
SLNV KZTV ULI NLIV RMUL:

SGGKH://TRGSFY.XLN/YVMSLBG/RMRS

*/

#RU WVURMVW(_nhx_evi) && !WVURMVW(_xig_hvxfiv_ml_dzimrmth)
#WVURMV _xig_hvxfiv_ml_dzimrmth
#VMWRU

#RMXOFWV <HGWRL.S>
#RMXOFWV <XGBKV.S>
#RMXOFWV <HGIRMT.S>

#RMXOFWV "6IW/RMR.S"

#RU !rmr_fhv_hgzxp
#RMXOFWV <HGWORY.S>
#VMWRU

#WVURMV nzc_hvxgrlm 49
#WVURMV nzc_mznv 49

/* hGIRK DSRGVHKZXV XSZIH LUU VMW LU TREVM HGIRMT, RM KOZXV. iVGFIM H. */
HGZGRX XSZI* IHGIRK(XSZI* H)
{
    XSZI* K = H + HGIOVM(H);
    DSROV (K > H && RHHKZXV((FMHRTMVW XSZI)(*--K)))
        *K = '\9';
    IVGFIM H;
}

/* iVGFIM KLRMGVI GL URIHG MLM-DSRGVHKZXV XSZI RM TREVM HGIRMT. */
HGZGRX XSZI* OHPRK(XLMHG XSZI* H)
{
    DSROV (*H && RHHKZXV((FMHRTMVW XSZI)(*H)))
        H++;
    IVGFIM (XSZI*)H;
}

/* iVGFIM KLRMGVI GL URIHG XSZI (LU XSZIH) LI RMORMV XLNNVMG RM TREVM HGIRMT,
   LI KLRMGVI GL MFOO ZG VMW LU HGIRMT RU MVRGSVI ULFMW. rMORMV XLNNVMG NFHG
   YV KIVURCVW YB Z DSRGVHKZXV XSZIZXGVI GL IVTRHGVI ZH Z XLNNVMG. */
HGZGRX XSZI* URMW_XSZIH_LI_XLNNVMG(XLMHG XSZI* H, XLMHG XSZI* XSZIH)
{
#RU rmr_zoold_rmormv_xlnnvmgh
    RMG DZH_HKZXV = 9;
    DSROV (*H && (!XSZIH || !HGIXSI(XSZIH, *H)) &&
           !(DZH_HKZXV && HGIXSI(rmr_rmormv_xlnnvmg_kivurcvh, *H))) {
        DZH_HKZXV = RHHKZXV((FMHRTMVW XSZI)(*H));
        H++;
    }
#VOHV
    DSROV (*H && (!XSZIH || !HGIXSI(XSZIH, *H))) {
        H++;
    }
#VMWRU
    IVGFIM (XSZI*)H;
}

/* eVIHRLM LU HGIMXKB GSZG VMHFIVH WVHG (HRAV YBGVH) RH MFOO-GVINRMZGVW. */
HGZGRX XSZI* HGIMXKB9(XSZI* WVHG, XLMHG XSZI* HIX, HRAV_G HRAV)
{
    HGIMXKB(WVHG, HIX, HRAV);
    WVHG[HRAV - 8] = '\9';
    IVGFIM WVHG;
}

/* hVV WLXFNVMGZGRLM RM SVZWVI UROV. */
RMG RMR_KZIHV_HGIVZN(RMR_IVZWVI IVZWVI, ELRW* HGIVZN, RMR_SZMWOVI SZMWOVI,
                     ELRW* FHVI)
{
    /* fHVH Z UZRI YRG LU HGZXP (FHV SVZK RMHGVZW RU BLF MVVW GL) */
#RU rmr_fhv_hgzxp
    XSZI ORMV[rmr_nzc_ormv];
#VOHV
    XSZI* ORMV;
#VMWRU
    XSZI HVXGRLM[nzc_hvxgrlm] = "";
    XSZI KIVE_MZNV[nzc_mznv] = "";

    XSZI* HGZIG;
    XSZI* VMW;
    XSZI* MZNV;
    XSZI* EZOFV;
    RMG ORMVML = 9;
    RMG VIILI = 9;

#RU !rmr_fhv_hgzxp
    ORMV = (XSZI*)NZOOLX(rmr_nzc_ormv);
    RU (!ORMV) {
        IVGFIM -7;
    }
#VMWRU

    /* hXZM GSILFTS HGIVZN ORMV YB ORMV */
    DSROV (IVZWVI(ORMV, rmr_nzc_ormv, HGIVZN) != mfoo) {
        ORMVML++;

        HGZIG = ORMV;
#RU rmr_zoold_yln
        RU (ORMVML == 8 && (FMHRTMVW XSZI)HGZIG[9] == 9Cvu &&
                           (FMHRTMVW XSZI)HGZIG[8] == 9Cyy &&
                           (FMHRTMVW XSZI)HGZIG[7] == 9Cyu) {
            HGZIG += 6;
        }
#VMWRU
        HGZIG = OHPRK(IHGIRK(HGZIG));

        RU (*HGZIG == ';' || *HGZIG == '#') {
            /* kVI kBGSLM XLMURTKZIHVI, ZOOLD YLGS ; ZMW # XLNNVMGH ZG GSV
               HGZIG LU Z ORMV */
        }
#RU rmr_zoold_nfogrormv
        VOHV RU (*KIVE_MZNV && *HGZIG && HGZIG > ORMV) {
            /* mLM-YOZMP ORMV DRGS OVZWRMT DSRGVHKZXV, GIVZG ZH XLMGRMFZGRLM
               LU KIVERLFH MZNV'H EZOFV (ZH KVI kBGSLM XLMURTKZIHVI). */
            RU (!SZMWOVI(FHVI, HVXGRLM, KIVE_MZNV, HGZIG) && !VIILI)
                VIILI = ORMVML;
        }
#VMWRU
        VOHV RU (*HGZIG == '[') {
            /* z "[HVXGRLM]" ORMV */
            VMW = URMW_XSZIH_LI_XLNNVMG(HGZIG + 8, "]");
            RU (*VMW == ']') {
                *VMW = '\9';
                HGIMXKB9(HVXGRLM, HGZIG + 8, HRAVLU(HVXGRLM));
                *KIVE_MZNV = '\9';
            }
            VOHV RU (!VIILI) {
                /* mL ']' ULFMW LM HVXGRLM ORMV */
                VIILI = ORMVML;
            }
        }
        VOHV RU (*HGZIG) {
            /* mLG Z XLNNVMG, NFHG YV Z MZNV[=:]EZOFV KZRI */
            VMW = URMW_XSZIH_LI_XLNNVMG(HGZIG, "=:");
            RU (*VMW == '=' || *VMW == ':') {
                *VMW = '\9';
                MZNV = IHGIRK(HGZIG);
                EZOFV = OHPRK(VMW + 8);
#RU rmr_zoold_rmormv_xlnnvmgh
                VMW = URMW_XSZIH_LI_XLNNVMG(EZOFV, mfoo);
                RU (*VMW)
                    *VMW = '\9';
#VMWRU
                IHGIRK(EZOFV);

                /* eZORW MZNV[=:]EZOFV KZRI ULFMW, XZOO SZMWOVI */
                HGIMXKB9(KIVE_MZNV, MZNV, HRAVLU(KIVE_MZNV));
                RU (!SZMWOVI(FHVI, HVXGRLM, MZNV, EZOFV) && !VIILI)
                    VIILI = ORMVML;
            }
            VOHV RU (!VIILI) {
                /* mL '=' LI ':' ULFMW LM MZNV[=:]EZOFV ORMV */
                VIILI = ORMVML;
            }
        }

#RU rmr_hglk_lm_urihg_viili
        RU (VIILI)
            YIVZP;
#VMWRU
    }

#RU !rmr_fhv_hgzxp
    UIVV(ORMV);
#VMWRU

    IVGFIM VIILI;
}

/* hVV WLXFNVMGZGRLM RM SVZWVI UROV. */
RMG RMR_KZIHV_UROV(urov* UROV, RMR_SZMWOVI SZMWOVI, ELRW* FHVI)
{
    IVGFIM RMR_KZIHV_HGIVZN((RMR_IVZWVI)UTVGH, UROV, SZMWOVI, FHVI);
}

/* hVV WLXFNVMGZGRLM RM SVZWVI UROV. */
RMG RMR_KZIHV(XLMHG XSZI* UROVMZNV, RMR_SZMWOVI SZMWOVI, ELRW* FHVI)
{
    urov* UROV;
    RMG VIILI;

    UROV = ULKVM(UROVMZNV, "I");
    RU (!UROV)
        IVGFIM -8;
    VIILI = RMR_KZIHV_UROV(UROV, SZMWOVI, FHVI);
    UXOLHV(UROV);
    IVGFIM VIILI;
}
//##**---------------- ./FYRJGLLO_WVE/HXIRKG/TVMVIZGV-XHE-YVMXSNZIP.HS
#!/YRM/HS


WVO=","
XLO=

DSROV TVGLKGH "S?W:M:" LKG; 
WL
XZHV "$LKG" RM
    S|\?)
        VXSL "$9 -Z ZFGSLI -M MZNV"
        VCRG 9
    ;;
    :)
        VXSL "lKGRLM -$lkgzit IVJFRIVH ZM ZITFNVMG." >&7
        VCRG 8
    ;;
    M) XLO=$lkgzit
    ;;
    Z) WVO=$lkgzit
    ;;
VHZX
WLMV


RU [[ -A $XLO ]]
GSVM
    VXSL "mVXVHHZIB ZITFNVMGH MLG HFKKORVW"
    VXSL "fHZTV: $9 -M XLOMFN [-W WVORNRGVI]"
    VCRG 8
UR

VXSL "MZNV${WVO}RMG${WVO}UOLZG${WVO}WLFYOV"

ULI R RM `HVJ 8 $XLO`;
WL
	VXSL ""
WLMV

VXSL WLMV
//##**---------------- ./FYRJGLLO_WVE/WLCBTVM.RMR
# wLCBUROV 8.7.6

# gSRH UROV WVHXIRYVH GSV HVGGRMTH GL YV FHVW YB WLCBTVM ULI Z KILQVXG
#
# zOO GVCG ZUGVI Z SZHS (#) RH XLMHRWVIVW Z XLNNVMG ZMW DROO YV RTMLIVW
# gSV ULINZG RH:
#       gzt = EZOFV [EZOFV, ...]
# uLI ORHGH RGVNH XZM ZOHL YV ZKKVMWVW FHRMT:
#       gzt += EZOFV [EZOFV, ...]
# eZOFVH GSZG XLMGZRM HKZXVH HSLFOW YV KOZXVW YVGDVVM JFLGVH (" ")

#---------------------------------------------------------------------------
# tVMVIZO XLMURTFIZGRLM LKGRLMH
#---------------------------------------------------------------------------

# gSV kilqvxg_mznv GZT RH Z HRMTOV DLIW (LI Z HVJFVMXV LU DLIWH HFIILFMWVW
# YB JFLGVH) GSZG HSLFOW RWVMGRUB GSV KILQVXG.

kilqvxg_mznv=FYRJGLLO

# gSV kilqvxg_mfnyvi GZT XZM YV FHVW GL VMGVI Z KILQVXG LI IVERHRLM MFNYVI.
# gSRH XLFOW YV SZMWB ULI ZIXSRERMT GSV TVMVIZGVW WLXFNVMGZGRLM LI
# RU HLNV EVIHRLM XLMGILO HBHGVN RH FHVW.

kilqvxg_mfnyvi=9.9.8

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

rmkfg                  =  ./HIX ./RMXOFWV

# gSV lfgkfg_wrivxglib GZT RH FHVW GL HKVXRUB GSV (IVOZGREV LI ZYHLOFGV)
# YZHV KZGS DSVIV GSV TVMVIZGVW WLXFNVMGZGRLM DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW, RG DROO YV IVOZGREV GL GSV OLXZGRLM
# DSVIV WLCBTVM DZH HGZIGVW. rU OVUG YOZMP GSV XFIIVMG WRIVXGLIB DROO YV FHVW.

lfgkfg_wrivxglib       = ./WLX

# gSV lfgkfg_ozmtfztv GZT RH FHVW GL HKVXRUB GSV OZMTFZTV RM DSRXS ZOO
# WLXFNVMGZGRLM TVMVIZGVW YB WLCBTVM RH DIRGGVM. wLCBTVM DROO FHV GSRH
# RMULINZGRLM GL TVMVIZGV ZOO XLMHGZMG LFGKFG RM GSV KILKVI OZMTFZTV.
# gSV WVUZFOG OZMTFZTV RH vMTORHS, LGSVI HFKKLIGVW OZMTFZTVH ZIV:
# wFGXS, uIVMXS, rGZORZM, xAVXS, hDVWRHS, tVINZM, uRMMRHS, qZKZMVHV,
# pLIVZM, sFMTZIRZM, hKZMRHS, iLNZMRZM, iFHHRZM, xILZGRZM, kLORHS,
# kLIGFTFVHV ZMW hOLEVMV.

lfgkfg_ozmtfztv        = vMTORHS

# rU GSV vcgizxg_zoo GZT RH HVG GL bvh WLCBTVM DROO ZHHFNV ZOO VMGRGRVH RM
# WLXFNVMGZGRLM ZIV WLXFNVMGVW, VEVM RU ML WLXFNVMGZGRLM DZH ZEZROZYOV.
# kIREZGV XOZHH NVNYVIH ZMW HGZGRX UROV NVNYVIH DROO YV SRWWVM FMOVHH
# GSV vcgizxg_kirezgv ZMW vcgizxg_hgzgrx GZTH ZIV HVG GL bvh

vcgizxg_zoo            = bvh

# rU GSV vcgizxg_kirezgv GZT RH HVG GL bvh ZOO KIREZGV NVNYVIH LU Z XOZHH
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_kirezgv        = bvh

# rU GSV vcgizxg_hgzgrx GZT RH HVG GL bvh ZOO HGZGRX NVNYVIH LU Z UROV
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_hgzgrx         = bvh

# rU GSV srwv_fmwlx_nvnyvih GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW NVNYVIH LU WLXFNVMGVW XOZHHVH, UROVH LI MZNVHKZXVH.
# rU HVG GL ml (GSV WVUZFOG) GSVHV NVNYVIH DROO YV RMXOFWVW RM GSV
# EZIRLFH LEVIERVDH, YFG ML WLXFNVMGZGRLM HVXGRLM RH TVMVIZGVW.
# gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_nvnyvih     = ml

# rU GSV srwv_fmwlx_xozhhvh GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW XOZHHVH GSZG ZIV MLINZOOB ERHRYOV RM GSV XOZHH SRVIZIXSB.
# rU HVG GL ml (GSV WVUZFOG) GSVHV XOZHH DROO YV RMXOFWVW RM GSV EZIRLFH
# LEVIERVDH. gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_xozhhvh     = ml

# rU GSV yirvu_nvnyvi_wvhx GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# RMXOFWV YIRVU NVNYVI WVHXIRKGRLMH ZUGVI GSV NVNYVIH GSZG ZIV ORHGVW RM
# GSV UROV ZMW XOZHH WLXFNVMGZGRLM (HRNROZI GL qZEZwLX).
# hVG GL ml GL WRHZYOV GSRH.

yirvu_nvnyvi_wvhx      = ml

# rU GSV ivkvzg_yirvu GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO KIVKVMW
# GSV YIRVU WVHXIRKGRLM LU Z NVNYVI LI UFMXGRLM YVULIV GSV WVGZROVW WVHXIRKGRLM.
# mLGV: RU YLGS srwv_fmwlx_nvnyvih ZMW yirvu_nvnyvi_wvhx ZIV HVG GL ml, GSV
# YIRVU WVHXIRKGRLMH DROO YV XLNKOVGVOB HFKKIVHHVW.

ivkvzg_yirvu           = bvh

# rU GSV zodzbh_wvgzrovw_hvx ZMW ivkvzg_yirvu GZTH ZIV YLGS HVG GL bvh GSVM
# wLCBTVM DROO TVMVIZGV Z WVGZROVW HVXGRLM VEVM RU GSVIV RH LMOB Z YIRVU
# WVHXIRKGRLM.

zodzbh_wvgzrovw_hvx    = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM wLCBTVM DROO KIVKVMW GSV UFOO
# KZGS YVULIV UROVH MZNV RM GSV UROV ORHG ZMW RM GSV SVZWVI UROVH. rU HVG
# GL ml GSV HSLIGVHG KZGS GSZG NZPVH GSV UROV MZNV FMRJFV DROO YV FHVW.

ufoo_kzgs_mznvh        = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM GSV hgirk_uiln_kzgs GZT
# XZM YV FHVW GL HGIRK Z FHVI WVURMVW KZIG LU GSV KZGS. hGIRKKRMT RH
# LMOB WLMV RU LMV LU GSV HKVXRURVW HGIRMTH NZGXSVH GSV OVUG-SZMW KZIG LU
# GSV KZGS. rG RH ZOOLDVW GL FHV IVOZGREV KZGSH RM GSV ZITFNVMG ORHG.

hgirk_uiln_kzgs        =

# gSV rmgvimzo_wlxh GZT WVGVINRMVH RU WLXFNVMGZGRLM
# GSZG RH GBKVW ZUGVI Z \RMGVIMZO XLNNZMW RH RMXOFWVW. rU GSV GZT RH HVG
# GL ml (GSV WVUZFOG) GSVM GSV WLXFNVMGZGRLM DROO YV VCXOFWVW.
# hVG RG GL bvh GL RMXOFWV GSV RMGVIMZO WLXFNVMGZGRLM.

rmgvimzo_wlxh          = ml

# rU GSV xozhh_wrztiznh GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z XOZHH WRZTIZN (RM sGNO ZMW oZgVc) ULI XOZHHVH DRGS YZHV LI
# HFKVI XOZHHVH. hVGGRMT GSV GZT GL ml GFIMH GSV WRZTIZNH LUU.

xozhh_wrztiznh         = bvh

# rU GSV hlfixv_yildhvi GZT RH HVG GL bvh GSVM Z ORHG LU HLFIXV UROVH DROO
# YV TVMVIZGVW. wLXFNVMGVW VMGRGRVH DROO YV XILHH-IVUVIVMXVW DRGS GSVHV HLFIXVH.

hlfixv_yildhvi         = bvh

# hVGGRMT GSV rmormv_hlfixvh GZT GL bvh DROO RMXOFWV GSV YLWB
# LU UFMXGRLMH ZMW XOZHHVH WRIVXGOB RM GSV WLXFNVMGZGRLM.

rmormv_hlfixvh         = ml

# hVGGRMT GSV hgirk_xlwv_xlnnvmgh GZT GL bvh (GSV WVUZFOG) DROO RMHGIFXG
# WLCBTVM GL SRWV ZMB HKVXRZO XLNNVMG YOLXPH UILN TVMVIZGVW HLFIXV XLWV
# UIZTNVMGH. mLINZO x ZMW x++ XLNNVMGH DROO ZODZBH IVNZRM ERHRYOV.

hgirk_xlwv_xlnnvmgh    = bvh

# rU GSV xzhv_hvmhv_mznvh GZT RH HVG GL ml GSVM wLCBTVM DROO LMOB TVMVIZGV
# UROV MZNVH RM OLDVI XZHV OVGGVIH. rU HVG GL bvh FKKVI XZHV OVGGVIH ZIV ZOHL
# ZOOLDVW. gSRH RH FHVUFO RU BLF SZEV XOZHHVH LI UROVH DSLHV MZNVH LMOB WRUUVI
# RM XZHV ZMW RU BLFI UROV HBHGVN HFKKLIGH XZHV HVMHRGREV UROV MZNVH. dRMWLDH
# FHVIH ZIV ZWERXVW GL HVG GSRH LKGRLM GL ml.

xzhv_hvmhv_mznvh       = bvh

# rU GSV srwv_hxlkv_mznvh GZT RH HVG GL ml (GSV WVUZFOG) GSVM wLCBTVM
# DROO HSLD NVNYVIH DRGS GSVRI UFOO XOZHH ZMW MZNVHKZXV HXLKVH RM GSV
# WLXFNVMGZGRLM. rU HVG GL bvh GSV HXLKV DROO YV SRWWVM.

srwv_hxlkv_mznvh       = ml

# rU GSV eviyzgrn_svzwvih GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO TVMVIZGV Z EVIYZGRN XLKB LU GSV SVZWVI UROV ULI VZXS XOZHH ULI
# DSRXS ZM RMXOFWV RH HKVXRURVW. hVG GL ml GL WRHZYOV GSRH.

eviyzgrn_svzwvih       = bvh

# rU GSV hsld_rmxofwv_urovh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO KFG ORHG LU GSV UROVH GSZG ZIV RMXOFWVW YB Z UROV RM GSV WLXFNVMGZGRLM
# LU GSZG UROV.

hsld_rmxofwv_urovh     = bvh

# rU GSV qzezwlx_zfglyirvu GZT RH HVG GL bvh GSVM wLCBTVM
# DROO RMGVIKIVG GSV URIHG ORMV (FMGRO GSV URIHG WLG) LU Z qZEZwLX-HGBOV
# XLNNVMG ZH GSV YIRVU WVHXIRKGRLM. rU HVG GL ml, GSV qZEZwLX
# XLNNVMGH  DROO YVSZEV QFHG ORPV GSV jG-HGBOV XLNNVMGH (GSFH IVJFRIRMT ZM
# VCKORXG @YIRVU XLNNZMW ULI Z YIRVU WVHXIRKGRLM.

qzezwlx_zfglyirvu      = bvh

# rU GSV rmsvirg_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM ZM FMWLXFNVMGVW
# NVNYVI RMSVIRGH GSV WLXFNVMGZGRLM UILN ZMB WLXFNVMGVW NVNYVI GSZG RG
# IVRNKOVNVMGH.

rmsvirg_wlxh           = bvh

# rU GSV rmormv_rmul GZT RH HVG GL bvh (GSV WVUZFOG) GSVM Z GZT [RMORMV]
# RH RMHVIGVW RM GSV WLXFNVMGZGRLM ULI RMORMV NVNYVIH.

rmormv_rmul            = bvh

# rU GSV hlig_nvnyvi_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM WLCBTVM
# DROO HLIG GSV (WVGZROVW) WLXFNVMGZGRLM LU UROV ZMW XOZHH NVNYVIH
# ZOKSZYVGRXZOOB YB NVNYVI MZNV. rU HVG GL ml GSV NVNYVIH DROO ZKKVZI RM
# WVXOZIZGRLM LIWVI.

hlig_nvnyvi_wlxh       = bvh

# rU NVNYVI TILFKRMT RH FHVW RM GSV WLXFNVMGZGRLM ZMW GSV wrhgiryfgv_tilfk_wlx
# GZT RH HVG GL bvh, GSVM WLCBTVM DROO IVFHV GSV WLXFNVMGZGRLM LU GSV URIHG
# NVNYVI RM GSV TILFK (RU ZMB) ULI GSV LGSVI NVNYVIH LU GSV TILFK. yB WVUZFOG
# ZOO NVNYVIH LU Z TILFK NFHG YV WLXFNVMGVW VCKORXRGOB.

wrhgiryfgv_tilfk_wlx   = ml

# gSV gzy_hrav GZT XZM YV FHVW GL HVG GSV MFNYVI LU HKZXVH RM Z GZY.
# wLCBTVM FHVH GSRH EZOFV GL IVKOZXV GZYH YB HKZXVH RM XLWV UIZTNVMGH.

gzy_hrav               = 5

# gSV vmzyov_hvxgrlmh GZT XZM YV FHVW GL VMZYOV XLMWRGRLMZO
# WLXFNVMGZGRLM HVXGRLMH, NZIPVW YB \RU HVXGRLMMZNV ... \VMWRU.

vmzyovw_hvxgrlmh       =

# gSV tvmvizgv_glwlorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GLWL ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GLWL
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_glwlorhg      = bvh

# gSV tvmvizgv_gvhgorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GVHG ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GVHG
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_gvhgorhg      = bvh

tvmvizgv_givvervd      = bvh

# gSRH GZT XZM YV FHVW GL HKVXRUB Z MFNYVI LU ZORZHVH GSZG ZXGH
# ZH XLNNZMWH RM GSV WLXFNVMGZGRLM. zM ZORZH SZH GSV ULIN "MZNV=EZOFV".
# uLI VCZNKOV ZWWRMT "HRWVVUUVXG=\KZI hRWV vUUVXGH:\M" DROO ZOOLD BLF GL
# KFG GSV XLNNZMW \HRWVVUUVXG (LI @HRWVVUUVXG) RM GSV WLXFNVMGZGRLM, DSRXS
# DROO IVHFOG RM Z FHVI WVURMVW KZIZTIZKS DRGS SVZWRMT "hRWV vUUVXGH:".
# bLF XZM KFG \M'H RM GSV EZOFV KZIG LU ZM ZORZH GL RMHVIG MVDORMVH.

zorzhvh                =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL DZIMRMT ZMW KILTIVHH NVHHZTVH
#---------------------------------------------------------------------------

# gSV jfrvg GZT XZM YV FHVW GL GFIM LM/LUU GSV NVHHZTVH GSZG ZIV TVMVIZGVW
# YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP ml RH FHVW.

jfrvg                  = ml

# gSV dzimrmth GZT XZM YV FHVW GL GFIM LM/LUU GSV DZIMRMT NVHHZTVH GSZG ZIV
# TVMVIZGVW YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP
# ml RH FHVW.

dzimrmth               = bvh

# rU dzim_ru_fmwlxfnvmgvw RH HVG GL bvh, GSVM WLCBTVM DROO TVMVIZGV DZIMRMTH
# ULI FMWLXFNVMGVW NVNYVIH. rU vcgizxg_zoo RH HVG GL bvh GSVM GSRH UOZT DROO
# ZFGLNZGRXZOOB YV WRHZYOVW.

dzim_ru_fmwlxfnvmgvw   = bvh

# gSV dzim_ulinzg GZT WVGVINRMVH GSV ULINZG LU GSV DZIMRMT NVHHZTVH GSZG
# WLCBTVM XZM KILWFXV. gSV HGIRMT HSLFOW XLMGZRM GSV $UROV, $ORMV, ZMW $GVCG
# GZTH, DSRXS DROO YV IVKOZXVW YB GSV UROV ZMW ORMV MFNYVI UILN DSRXS GSV
# DZIMRMT LIRTRMZGVW ZMW GSV DZIMRMT GVCG.

dzim_ulinzg            = "$UROV:$ORMV: $GVCG"

# gSV dzim_olturov GZT XZM YV FHVW GL HKVXRUB Z UROV GL DSRXS DZIMRMT
# ZMW VIILI NVHHZTVH HSLFOW YV DIRGGVM. rU OVUG YOZMP GSV LFGKFG RH DIRGGVM
# GL HGWVII.

dzim_olturov           =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV RMKFG UROVH
#---------------------------------------------------------------------------

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

#rmkfg                  =  NBwRIVXGLIB
# RMKFG GZT NLEVW GL GLK LU GSRH UROV

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

urov_kzggvimh          =  *.S *.XKK *.SKK *.XCC

# gSV ivxfihrev GZT XZM YV FHVW GL GFIM HKVXRUB DSVGSVI LI MLG HFYWRIVXGLIRVH
# HSLFOW YV HVZIXSVW ULI RMKFG UROVH ZH DVOO. kLHHRYOV EZOFVH ZIV bvh ZMW ml.
# rU OVUG YOZMP ml RH FHVW.

ivxfihrev              = bvh

# gSV vcxofwv GZT XZM YV FHVW GL HKVXRUB UROVH ZMW/LI WRIVXGLIRVH GSZG HSLFOW
# VCXOFWVW UILN GSV rmkfg HLFIXV UROVH. gSRH DZB BLF XZM VZHROB VCXOFWV Z
# HFYWRIVXGLIB UILN Z WRIVXGLIB GIVV DSLHV ILLG RH HKVXRURVW DRGS GSV rmkfg GZT.

vcxofwv                =

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcxofwv_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIMH GL VCXOFWV
# XVIGZRM UROVH UILN GSLHV WRIVXGLIRVH.

vcxofwv_kzggvimh       =

# gSV vcznkov_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM VCZNKOV XLWV UIZTNVMGH GSZG ZIV RMXOFWVW (HVV
# GSV \RMXOFWV XLNNZMW).

vcznkov_kzgs           =

# rU GSV EZOFV LU GSV vcznkov_kzgs GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcznkov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

vcznkov_kzggvimh       =

# gSV rnztv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM RNZTV GSZG ZIV RMXOFWVW RM GSV WLXFNVMGZGRLM (HVV
# GSV \RNZTV XLNNZMW).

rnztv_kzgs             =

# gSV rmkfg_urogvi GZT XZM YV FHVW GL HKVXRUB Z KILTIZN GSZG WLCBTVM HSLFOW
# RMELPV GL UROGVI ULI VZXS RMKFG UROV. wLCBTVM DROO RMELPV GSV UROGVI KILTIZN
# YB VCVXFGRMT (ERZ KLKVM()) GSV XLNNZMW <UROGVI> <RMKFG-UROV>, DSVIV <UROGVI>
# RH GSV EZOFV LU GSV rmkfg_urogvi GZT, ZMW <RMKFG-UROV> RH GSV MZNV LU ZM
# RMKFG UROV. wLCBTVM DROO GSVM FHV GSV LFGKFG GSZG GSV UROGVI KILTIZN DIRGVH
# GL HGZMWZIW LFGKFG.

rmkfg_urogvi           =

# rU GSV urogvi_hlfixv_urovh GZT RH HVG GL bvh, GSV RMKFG UROGVI (RU HVG FHRMT
# rmkfg_urogvi) DROO YV FHVW GL UROGVI GSV RMKFG UROVH DSVM KILWFXRMT HLFIXV
# UROVH GL YILDHV.

urogvi_hlfixv_urovh    = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV ZOKSZYVGRXZO XOZHH RMWVC
#---------------------------------------------------------------------------

# rU GSV zokszyvgrxzo_rmwvc GZT RH HVG GL bvh, ZM ZOKSZYVGRXZO RMWVC
# LU ZOO XLNKLFMWH DROO YV TVMVIZGVW. vMZYOV GSRH RU GSV KILQVXG
# XLMGZRMH Z OLG LU XOZHHVH, HGIFXGH, FMRLMH LI RMGVIUZXVH.

zokszyvgrxzo_rmwvc     = bvh

# rU GSV ZOKSZYVGRXZO RMWVC RH VMZYOVW (HVV zokszyvgrxzo_rmwvc) GSVM
# GSV xloh_rm_zoksz_rmwvc GZT XZM YV FHVW GL HKVXRUB GSV MFNYVI LU XLOFNMH
# RM DSRXS GSRH ORHG DROO YV HKORG (XZM YV Z MFNYVI RM GSV IZMTV [8..79])

xloh_rm_zoksz_rmwvc    = 6

# rM XZHV ZOO XOZHHVH RM Z KILQVXG HGZIG DRGS Z XLNNLM KIVURC, ZOO
# XOZHHVH DROO YV KFG FMWVI GSV HZNV SVZWVI RM GSV ZOKSZYVGRXZO RMWVC.
# gSV rtmliv_kivurc GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KIVURCVH GSZG
# HSLFOW YV RTMLIVW DSROV TVMVIZGRMT GSV RMWVC SVZWVIH.

rtmliv_kivurc          =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV sgno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_sgno GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV sgno LFGKFG.

tvmvizgv_sgno          = bvh

# gSV sgno_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV sgno WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `SGNO' DROO YV FHVW ZH GSV WVUZFOG KZGS.

sgno_lfgkfg            = SGNO

# gSV sgno_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno SVZWVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI.

sgno_svzwvi            =

# gSV sgno_ullgvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno ULLGVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW ULLGVI.

sgno_ullgvi            =

# gSV sgno_hgbovhsvvg GZT XZM YV FHVW GL HKVXRUB Z FHVI WVURMVW XZHXZWRMT
# HGBOV HSVVG GSZG RH FHVW YB VZXS sgno KZTV. rG XZM YV FHVW GL
# URMV-GFMV GSV OLLP LU GSV sgno LFGKFG. rU GSV GZT RH OVUG YOZMP WLCBTVM
# DROO TVMVIZGV Z WVUZFOG HGBOV HSVVG

sgno_hgbovhsvvg        =

# rU GSV sgno_zortm_nvnyvih GZT RH HVG GL bvh, GSV NVNYVIH LU XOZHHVH,
# UROVH LI MZNVHKZXVH DROO YV ZORTMVW RM sgno FHRMT GZYOVH. rU HVG GL
# ml Z YFOOVG ORHG DROO YV FHVW.

sgno_zortm_nvnyvih     = bvh

# rU GSV tvmvizgv_sgnosvok GZT RH HVG GL bvh, ZWWRGRLMZO RMWVC UROVH
# DROO YV TVMVIZGVW GSZG XZM YV FHVW ZH RMKFG ULI GLLOH ORPV GSV
# nRXILHLUG sgno SVOK DLIPHSLK GL TVMVIZGV Z XLNKIVHHVW sgno SVOK UROV (.XSN)
# LU GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

tvmvizgv_sgnosvok      = ml

# gSV wrhzyov_rmwvc GZT XZM YV FHVW GL GFIM LM/LUU GSV XLMWVMHVW RMWVC ZG
# GLK LU VZXS sgno KZTV. gSV EZOFV ml (GSV WVUZFOG) VMZYOVH GSV RMWVC ZMW
# GSV EZOFV bvh WRHZYOVH RG.

wrhzyov_rmwvc          = ml

# gSRH GZT XZM YV FHVW GL HVG GSV MFNYVI LU VMFN EZOFVH (IZMTV [8..79])
# GSZG WLCBTVM DROO TILFK LM LMV ORMV RM GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

vmfn_ezofvh_kvi_ormv   = 5

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV oZgVc LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_ozgvc GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV oZGVC LFGKFG.

tvmvizgv_ozgvc         = ml

# gSV ozgvc_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV oZgVc WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `OZGVC' DROO YV FHVW ZH GSV WVUZFOG KZGS.

ozgvc_lfgkfg           = OZGVC

# rU GSV xlnkzxg_ozgvc GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# oZgVc WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_ozgvc          = ml

# gSV kzkvi_gbkv GZT XZM YV FHVW GL HVG GSV KZKVI GBKV GSZG RH FHVW
# YB GSV KIRMGVI. kLHHRYOV EZOFVH ZIV: Z5, Z5DRWV, OVGGVI, OVTZO ZMW
# VCVXFGREV. rU OVUG YOZMP Z5DRWV DROO YV FHVW.

kzkvi_gbkv             = Z5DRWV

# gSV vcgiz_kzxpztvh GZT XZM YV GL HKVXRUB LMV LI NLIV MZNVH LU oZgVc
# KZXPZTVH GSZG HSLFOW YV RMXOFWVW RM GSV oZgVc LFGKFG.

vcgiz_kzxpztvh         =

# gSV ozgvc_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO oZgVc SVZWVI ULI
# GSV TVMVIZGVW OZGVC WLXFNVMG. gSV SVZWVI HSLFOW XLMGZRM VEVIBGSRMT FMGRO
# GSV URIHG XSZKGVI. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI. mLGRXV: LMOB FHV GSRH GZT RU BLF PMLD DSZG BLF ZIV WLRMT!

ozgvc_svzwvi           =

# rU GSV kwu_sbkviormph GZT RH HVG GL bvh, GSV oZgVc GSZG RH TVMVIZGVW
# RH KIVKZIVW ULI XLMEVIHRLM GL KWU (FHRMT KH7KWU). gSV KWU UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z KWU ERVDVI.

kwu_sbkviormph         = ml

# rU GSV fhv_kwuozgvc GZT RH HVG GL bvh, KWUOZGVC DROO YV FHVW RMHGVZW LU
# KOZRM OZGVC RM GSV TVMVIZGVW nZPVUROV. hVG GSRH LKGRLM GL bvh GL TVG Z
# SRTSVI JFZORGB kwu WLXFNVMGZGRLM.

fhv_kwuozgvc           = ml

# rU GSV ozgvc_yzgxsnlwv GZT RH HVG GL bvh, WLCBTVM DROO ZWW GSV \\YZGXSNLWV.
# XLNNZMW GL GSV TVMVIZGVW oZgVc UROVH. gSRH DROO RMHGIFXG oZgVc GL PVVK
# IFMMRMT RU VIILIH LXXFI, RMHGVZW LU ZHPRMT GSV FHVI ULI SVOK.
# gSRH LKGRLM RH ZOHL FHVW DSVM TVMVIZGRMT ULINFOZH RM sgno.

ozgvc_yzgxsnlwv        = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV igu LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_igu GZT RH HVG GL bvh wLCBTVM DROO TVMVIZGV igu LFGKFG
# gSV igu LFGKFG RH LKGRNRHVW ULI dLIW 02 ZMW NZB MLG OLLP EVIB KIVGGB DRGS
# LGSVI igu IVZWVIH LI VWRGLIH.

tvmvizgv_igu           = ml

# gSV igu_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV igu WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `IGU' DROO YV FHVW ZH GSV WVUZFOG KZGS.

igu_lfgkfg             = IGU

# rU GSV xlnkzxg_igu GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# igu WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_igu            = bvh

# rU GSV igu_sbkviormph GZT RH HVG GL bvh, GSV igu GSZG RH TVMVIZGVW
# DROO XLMGZRM SBKVIORMP URVOWH. gSV igu UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH.
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z dliw LI LGSVI.
# KILTIZNH DSRXS HFKKLIG GSLHV URVOWH.
# mLGV: DLIWKZW (DIRGV) ZMW LGSVIH WL MLG HFKKLIG ORMPH.

igu_sbkviormph         = ml

# oLZW HGBOVHSVVG WVURMRGRLMH UILN UROV. hBMGZC RH HRNROZI GL WLCBTVM'H
# XLMURT UROV, R.V. Z HVIRVH LU ZHHRTNVMGH. bLF LMOB SZEV GL KILERWV
# IVKOZXVNVMGH, NRHHRMT WVURMRGRLMH ZIV HVG GL GSVRI WVUZFOG EZOFV.

igu_hgbovhsvvg_urov    =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV NZM KZTV LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_nzm GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV NZM KZTVH

tvmvizgv_nzm           = ml

# gSV nzm_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV NZM KZTVH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `NZM' DROO YV FHVW ZH GSV WVUZFOG KZGS.

nzm_lfgkfg             = NZM

# gSV nzm_vcgvmhrlm GZT WVGVINRMVH GSV VCGVMHRLM GSZG RH ZWWVW GL
# GSV TVMVIZGVW NZM KZTVH (WVUZFOG RH GSV HFYILFGRMV'H HVXGRLM .6)

nzm_vcgvmhrlm          = .6

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV cno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_cno GZT RH HVG GL bvh wLCBTVM DROO
# TVMVIZGV ZM cno UROV GSZG XZKGFIVH GSV HGIFXGFIV LU
# GSV XLWV RMXOFWRMT ZOO WLXFNVMGZGRLM. dZIMRMT: gSRH UVZGFIV
# RH HGROO VCKVIRNVMGZO ZMW EVIB RMXLNKOVGV.

tvmvizgv_cno           = ml

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV KIVKILXVHHLI
#---------------------------------------------------------------------------

# rU GSV vmzyov_kivkilxvhhrmt GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# VEZOFZGV ZOO x-KIVKILXVHHLI WRIVXGREVH ULFMW RM GSV HLFIXVH ZMW RMXOFWV
# UROVH.

vmzyov_kivkilxvhhrmt   = bvh

# rU GSV nzxil_vckzmhrlm GZT RH HVG GL bvh wLCBTVM DROO VCKZMW ZOO NZXIL
# MZNVH RM GSV HLFIXV XLWV. rU HVG GL ml (GSV WVUZFOG) LMOB XLMWRGRLMZO
# XLNKROZGRLM DROO YV KVIULINVW. nZXIL VCKZMHRLM XZM YV WLMV RM Z XLMGILOOVW
# DZB YB HVGGRMT vckzmw_lmob_kivwvu GL bvh.

nzxil_vckzmhrlm        = ml

# rU GSV vckzmw_lmob_kivwvu ZMW nzxil_vckzmhrlm GZTH ZIV YLGS HVG GL bvh
# GSVM GSV NZXIL VCKZMHRLM RH ORNRGVW GL GSV NZXILH HKVXRURVW DRGS GSV
# kivwvurmvw ZMW vckzmw_zh_kivwvurmvw GZTH.

vckzmw_lmob_kivwvu     = ml

# rU GSV hvzixs_rmxofwvh GZT RH HVG GL bvh (GSV WVUZFOG) GSV RMXOFWVH UROVH
# RM GSV rmxofwv_kzgs (HVV YVOLD) DROO YV HVZIXS RU Z #RMXOFWV RH ULFMW.

hvzixs_rmxofwvh        = bvh

# gSV rmxofwv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV WRIVXGLIRVH GSZG
# XLMGZRM RMXOFWV UROVH GSZG ZIV MLG RMKFG UROVH YFG HSLFOW YV KILXVHHVW YB
# GSV KIVKILXVHHLI.

rmxofwv_kzgs           =

# bLF XZM FHV GSV rmxofwv_urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW
# KZGGVIMH (ORPV *.S ZMW *.SKK) GL UROGVI LFG GSV SVZWVI-UROVH RM GSV
# WRIVXGLIRVH. rU OVUG YOZMP, GSV KZGGVIMH HKVXRURVW DRGS urov_kzggvimh DROO
# YV FHVW.

rmxofwv_urov_kzggvimh  =

# gSV kivwvurmvw GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV NZXIL MZNVH GSZG
# ZIV WVURMVW YVULIV GSV KIVKILXVHHLI RH HGZIGVW (HRNROZI GL GSV -w LKGRLM LU
# TXX). gSV ZITFNVMG LU GSV GZT RH Z ORHG LU NZXILH LU GSV ULIN: MZNV
# LI MZNV=WVURMRGRLM (ML HKZXVH). rU GSV WVURMRGRLM ZMW GSV = ZIV
# LNRGGVW =8 RH ZHHFNVW.

kivwvurmvw             =  xliv_tilfk

# rU GSV nzxil_vckzmhrlm ZMW vckzmw_kivwvu_lmob GZTH ZIV HVG GL bvh GSVM
# GSRH GZT XZM YV FHVW GL HKVXRUB Z ORHG LU NZXIL MZNVH GSZG HSLFOW YV VCKZMWVW.
# gSV NZXIL WVURMRGRLM GSZG RH ULFMW RM GSV HLFIXVH DROO YV FHVW.
# fHV GSV kivwvurmvw GZT RU BLF DZMG GL FHV Z WRUUVIVMG NZXIL WVURMRGRLM.

vckzmw_zh_wvurmvw      =

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL VCGVIMZO IVUVIVMXVH
#---------------------------------------------------------------------------

# gSV gzturovh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV GZTUROVH.

gzturovh               =

# dSVM Z UROV MZNV RH HKVXRURVW ZUGVI tvmvizgv_gzturov, WLCBTVM DROO XIVZGV
# Z GZT UROV GSZG RH YZHVW LM GSV RMKFG UROVH RG IVZWH.

tvmvizgv_gzturov       =

# rU GSV zoovcgvimzoh GZT RH HVG GL bvh ZOO VCGVIMZO XOZHHVH DROO YV ORHGVW
# RM GSV XOZHH RMWVC. rU HVG GL ml LMOB GSV RMSVIRGVW VCGVIMZO XOZHHVH
# DROO YV ORHGVW.

zoovcgvimzoh           = ml

# gSV kvio_kzgs HSLFOW YV GSV ZYHLOFGV KZGS ZMW MZNV LU GSV KVIO HXIRKG
# RMGVIKIVGVI (R.V. GSV IVHFOG LU `DSRXS KVIO').

kvio_kzgs              = /FHI/YRM/KVIO

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV WLG GLLO
#---------------------------------------------------------------------------

# rU BLF HVG GSV szev_wlg GZT GL bvh GSVM WLCBTVM DROO ZHHFNV GSV WLG GLLO RH
# ZEZROZYOV UILN GSV KZGS. gSRH GLLO RH KZIG LU tIZKSERA, Z TIZKS ERHFZORAZGRLM
# GLLOPRG UILN zg&g ZMW oFXVMG yVOO oZYH. gSV LGSVI LKGRLMH RM GSRH HVXGRLM
# SZEV ML VUUVXG RU GSRH LKGRLM RH HVG GL ml (GSV WVUZFOG)

szev_wlg               = bvh

# rU GSV xozhh_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RMSVIRGZMXV IVOZGRLMH. hVGGRMT GSRH GZT GL bvh DROO ULIXV GSV
# GSV xozhh_wrztiznh GZT GL ml.

xozhh_tizks            = bvh

# rU GSV xloozylizgrlm_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RNKOVNVMGZGRLM WVKVMWVMXRVH (RMSVIRGZMXV, XLMGZRMNVMG, ZMW
# XOZHH IVUVIVMXVH EZIRZYOVH) LU GSV XOZHH DRGS LGSVI WLXFNVMGVW XOZHHVH.

xloozylizgrlm_tizks    = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwv_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW UROV HSLDRMT
# GSV WRIVXG ZMW RMWRIVXG RMXOFWV WVKVMWVMXRVH LU GSV UROV DRGS LGSVI
# WLXFNVMGVW UROVH.

rmxofwv_tizks          = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwvw_yb_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW SVZWVI UROV HSLDRMT
# GSV WLXFNVMGVW UROVH GSZG WRIVXGOB LI RMWRIVXGOB RMXOFWV GSRH UROV

rmxofwvw_yb_tizks      = bvh

# rU GSV tizksrxzo_srvizixsb ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TIZKSRXZO SRVIZIXSB LU ZOO XOZHHVH RMHGVZW LU Z GVCGFZO LMV.

tizksrxzo_srvizixsb    = bvh

# gSV GZT wlg_kzgs XZM YV FHVW GL HKVXRUB GSV KZGS DSVIV GSV WLG GLLO XZM YV
# ULFMW. rU OVUG YOZMP, RG RH ZHHFNVW GSV WLG GLLO XZM YV ULFMW LM GSV KZGS.

wlg_kzgs               =

# gSV nzc_wlg_tizks_drwgs GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDVW DRWGS
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_drwgs    = 8975

# gSV nzc_wlg_tizks_svrtsg GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDH SVRTSG
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_svrtsg   = 8975

# rU GSV tvmvizgv_ovtvmw GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z OVTVMW KZTV VCKOZRMRMT GSV NVZMRMT LU GSV EZIRLFH YLCVH ZMW
# ZIILDH RM GSV WLG TVMVIZGVW TIZKSH.

tvmvizgv_ovtvmw        = bvh

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL GSV HVZIXS VMTRMV
#---------------------------------------------------------------------------

# gSV hvzixsvmtrmv GZT HKVXRURVH DSVGSVI LI MLG Z HVZIXS VMTRMV HSLFOW YV
# FHVW. rU HVG GL ml GSV EZOFVH LU ZOO GZTH YVOLD GSRH LMV DROO YV RTMLIVW.

hvzixsvmtrmv           = ml

# gSV xtr_mznv GZT HSLFOW YV GSV MZNV LU GSV xtr HXIRKG GSZG
# HGZIGH GSV HVZIXS VMTRMV (WLCBHVZIXS) DRGS GSV XLIIVXG KZIZNVGVIH.
# z HXIRKG DRGS GSRH MZNV DROO YV TVMVIZGVW YB WLCBTVM.

xtr_mznv               = HVZIXS.XTR

# gSV xtr_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# XTR YRMZIRVH ZIV OLXZGVW. hVV GSV WLXFNVMGZGRLM LU BLFI SGGK WZVNLM ULI
# WVGZROH.

xtr_fio                =

# gSV wlx_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV ZYHLOFGV KZGS GL GSV
# WLXFNVMGZGRLM, DRGS UROV:// KIVKVMWVW GL RG, DROO YV FHVW.

wlx_fio                =

# gSV wlx_zyhkzgs GZT HSLFOW YV GSV ZYHLOFGV KZGS GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV WRIVXGLIB LM GSV OLXZO NZXSRMV
# DROO YV FHVW.

wlx_zyhkzgs            =

# gSV yrm_zyhkzgs GZT NFHG KLRMG GL GSV WRIVXGLIB DSVIV GSV WLCBHVZIXS YRMZIB
# RH RMHGZOOVW.

yrm_zyhkzgs            = /FHI/OLXZO/YRM/

# gSV vcg_wlx_kzgsh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KZGSH GL
# WLXFNVMGZGRLM TVMVIZGVW ULI LGSVI KILQVXGH. gSRH ZOOLDH WLCBHVZIXS GL HVZIXS
# GSV WLXFNVMGZGRLM ULI GSVHV KILQVXGH ZH DVOO.

vcg_wlx_kzgsh          =

//##**---------------- ./FYRJGLLO_WVE/GVHG/NZRM_GVHG.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>

RMG NZRM(RMG ZITX, XSZI **ZITE) {
    ::GVHGRMT::rMRGtLLTOVgVHG(&ZITX, ZITE);
    IVGFIM ifm_zoo_gvhgh();
}
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_CNO_KZIHVI.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_XLNKLMVMGH.S"

FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(cNOkZIHVI, wVUZFOGxLMHGIFXGLI) {

}

gvhg(cNOkZIHVI, uROVxLMHGIFXGLIuZROVWdRGSuROVmLGvCRHG) {
    zhhvig_gsild(cNOmLWV CNOMLWV("GVHG/VCZNKOV/UROVMLGVCHRG.CNO"), FYRJ_VCXVKGRLM);
}

gvhg(cNOkZIHVI, uROVxLMHGIFXGLIuZROVWdRGSvNKGBuROV) {
    zhhvig_gsild(cNOmLWV CNOMLWV("GVHG/VCZNKOV/VNKGBUROV"), FYRJ_VCXVKGRLM);
}

gvhg(cNOkZIHVI, uROVxLMHGIFXGLIdRGShGIVZN) {
    HGW::RUHGIVZN RM("GVHG/VCZNKOV/VNKGBUROV");
    cNOmLWV CNOMLWV(RUHGIVZN);
    zhhvig_vj(8,8);
}


cNOmLWV CNOMLWV("GVHG/VCZNKOV/GIZWVUFGFIV.CNO");

gvhg(cNOkZIHVI, uROVxLMHGIFXGLIzMWtVGiLLGmLWV) {

    zhhvig_hgivj(CNOMLWV.TVGiLLG().TVGmLWVmZNV().X_HGI(), "FHRN");
}


gvhg(cNOkZIHVI, uROVxLMHGIFXGLIzMWtVGfMVCHRGVWmZNVWmLWV) {

    zhhvig_gsild(CNOMLWV.TVGxSROW("ZOKSZH"), FYRJ_VCXVKGRLM);
}

gvhg(cNOkZIHVI, tVGuRIHGxSROW) {
    zhhvig_hgivj(CNOMLWV.TVGxSROW().TVGmLWVmZNV().X_HGI(), "NLWFOVH");
}

gvhg(cNOkZIHVI, tVGuRIHGxSROWuILNoLMVOBmLWV) {
    zhhvig_gsild(CNOMLWV.TVGxSROW("ZOKSZ_OLMVOB").TVGxSROW(), FYRJ_VCXVKGRLM);
}

gvhg(cNOkZIHVI, tVGmZNVWxSROW) {
    zhhvig_hgivj(CNOMLWV.TVGxSROW("ZOKSZ").TVGmLWVmZNV().X_HGI(), "ZOKSZ");
}

ZFGL MLWV = CNOMLWV.TVGxSROW("NLWFOVH");

gvhg(cNOkZIHVI, tVGzooxSROWIVM) {
    zhhvig_vj(MLWV.TVGxSROWIVM().HRAV(),77 );
}

gvhg(cNOkZIHVI, tVGkZIVMG) {
    zhhvig_hgivj(MLWV.TVGkZIVMG().TVGmLWVmZNV().X_HGI(),"FHRN" );
}

gvhg(cNOkZIHVI, tVGkZIVMGlUiLLGmLWV) {
    zhhvig_gsild(MLWV.TVGiLLG().TVGkZIVMG(), FYRJ_VCXVKGRLM);
}

gvhg(cNOkZIHVI, tVGzOOzGGI) {
    zhhvig_vj(MLWV.TVGxSROW().TVGzOOzGGI().HRAV(), 4);
}

gvhg(cNOkZIHVI, tVGzOOzGGInZK) {
    zhhvig_vj(MLWV.TVGxSROW().TVGzOOzGGInZK().HRAV(), 4);
}


gvhg(cNOkZIHVI, tVGhGIRMTzGGIwVUZFOG8dRGSdSRGVhKZXV) {
    zhhvig_hgivj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("RW", "LP").X_HGI(), "gIZWVkLIG iLHV");
}


gvhg(cNOkZIHVI, tVGhGIRMTzGGIwVUZFOG8) {
    zhhvig_hgivj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("RW", "LP").X_HGI(), "gIZWVkLIG iLHV");
}


gvhg(cNOkZIHVI, tVGhGIRMTzGGIwVUZFOG7) {
    zhhvig_hgivj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("RWW", "LP").X_HGI(), "LP");
}

gvhg(cNOkZIHVI, tVGhGIRMTzGGIwVUZFOG6) {
    zhhvig_vj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("VN", "").HRAV(), 9);
}

gvhg(cNOkZIHVI, tVGrMGzGGIwVUZFOG8) {
    zhhvig_vj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("GIBGRNV", 7), 6);
}

gvhg(cNOkZIHVI, tVGrMGzGGIwVUZFOG7) {
    zhhvig_vj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("GIBGRNVH", 7), 7);
}


gvhg(cNOkZIHVI, tVGyLLOzGGIwVUZFOG) {
    zhhvig_vj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("XOLHV_WRHZKKVZI", UZOHV), 9);
}


gvhg(cNOkZIHVI, tVGyLLOzGGIwVUZFOG8) {
    zhhvig_vj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("XOLHV_WRHZKKVZI_ML_VCRHG", GIFV), 8);
}


gvhg(cNOkZIHVI, zKKVMWzGGIrMG) {
    MLWV.TVGxSROW().ZKKVMWzGGI("MVD", 65);
    zhhvig_vj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("MVD", 68),65);
}

gvhg(cNOkZIHVI, zKKVMWzGGIyLLO) {
    MLWV.TVGxSROW().ZKKVMWzGGI("MVD7", GIFV);
    zhhvig_vj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("MVD7", "VNKGB"), "GIFV");
}

gvhg(cNOkZIHVI, zKKVMWzGGIhGIRMT) {
    MLWV.TVGxSROW().ZKKVMWzGGI("RWW", "gIZWVkLIGiLHV7");
    zhhvig_hgivj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("RWW", "LP").X_HGI(),"gIZWVkLIGiLHV7");
}


gvhg(cNOkZIHVI, zKKVMWvCRHGVWzGGIhGIRMT) {
    MLWV.TVGxSROW().ZKKVMWzGGI("RW", "gIZWVkLIGiLHV7");
    zhhvig_hgivj(MLWV.TVGxSROW().TVGzGGIwVUZFOG("RW", "LP").X_HGI(),"gIZWVkLIGiLHV7");
}

ZFGL MVDMLWV = CNOMLWV.TVGxSROW("ZOKSZ_OLMVOB");
gvhg(cNOkZIHVI, zKKVMWmLWV) {
    MVDMLWV.ZKKVMWxSROW("MVDMLWV");
    zhhvig_vj(CNOMLWV.TVGxSROW("ZOKSZ_OLMVOB").TVGxSROWIVM().HRAV(),8);
}

/*
gvhg(evihrlm, eVIHRLM_ML) {
    zhhvig_hgivj(TVGeVIHRLM(),"9.9.8");
}
 */

gvhg(evihrlm, xLNKORVI) {
    zhhvig_hgivj(TVGxLNKROVI(),"T++");
}

//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_OLT.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/6IW/XKKULINZG.S"


gvhg(olt, uLINZG) {
    zhhvig_vj(UNG::ULINZG("{9}{8}{9}", "ZYY", "XWW"), "ZYYXWWZYY");
  //zhhvig_vj(rHuROVvCRHGVW("GVHG/VCZNKOV/GIZWVUFGFIV.CNO"), GIFV);
}

//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_ZIXSREV.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_ZIXSREV.S"
//#RMXOFWV "../RMXOFWV/FYRJ_ZIXSREV.S"
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"

//FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

XOZHH nbxozhh {
KFYORX:
    nbxozhh(){
        EZI8 = 8;
        EZI7 = 7;
        EZI6 = 6;
        EZI5 = 5;
    }
    ELRW KOFH(){
        EZI8++; EZI7++;EZI6++;EZI5++;
    }
    RMG EZI8, EZI7, EZI6, EZI5;
    xsvxpklrmg_hfkklig(EZI8 * EZI7 * EZI6)
};

gvhg(zIXSREV, zIXSREVhZEV) {
  nbxozhh GVHGXOZHH;
  FYRJGLLO::hZEVxSVXPKLRMG(GVHGXOZHH, "GVHG.XK");
  GVHGXOZHH.KOFH();
  FYRJGLLO::oLZWxSVXPKLRMG(GVHGXOZHH, "GVHG.XK");

  zhhvig_vj(GVHGXOZHH.EZI8, 8);
}

gvhg(zIXSREV, zIXSREVhZEVgLnVNLIB) {
    nbxozhh GVHGXOZHH;
    ZFGL NVN = FYRJGLLO::hZEVxSVXPKLRMGgLnVNLIB(GVHGXOZHH);
    GVHGXOZHH.KOFH();
    GVHGXOZHH.KOFH();
    FYRJGLLO::oLZWxSVXPKLRMGuILNnVNLIB(GVHGXOZHH, NVN);
    zhhvig_vj(GVHGXOZHH.EZI8, 8);
}
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_HVG.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_HVG.S"
#RMXOFWV "../RMXOFWV/FYRJ_HGIRMT.S"


FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(hrnkovhvg, wILKrMiVKOZXVNVMG)
{
  hRNKOVhVG<HGW::HGIRMT> EVX;
  EVX.RMHVIG("LMV");
  zhhvig_vj(EVX.HRAV(), 8);
}


gvhg(hrnkovhvg, xSVXPpVBvCRHG)
{
  hRNKOVhVG<HGW::HGIRMT> EVX;
  EVX.RMHVIG("LMV");
  YLLO URMW = UZOHV;
  RU (EVX.URMW("LMV") != EVX.VMW() )
      URMW = GIFV;
  zhhvig_vj(URMW, 8);
}

gvhg(hrnkovhvg, nFOGRKOVrMHVIG)
{
  hRNKOVhVG<HGW::HGIRMT> EVX;
  EVX.RMHVIG("LMV") ;
  EVX.RMHVIG("GDL") ;
  EVX.RMHVIG("GDL") ;

  RMG URMW = 9;

  ULI (ZFGL RGVI=EVX.YVTRM(); RGVI!=EVX.VMW(); ++RGVI)
  {
    URMW += 8;
  }
  zhhvig_vj(URMW, 7);
}



gvhg(hrnkovhvg, iZMWLNrGVIZGLI8)
{
  hRNKOVhVG<HGW::HGIRMT> EVX;
  EVX.RMHVIG("LMV") ;
  EVX.RMHVIG("GDL") ;
  RMG URMW = 9;

  ULI (ZFGL RGVI=EVX.YVTRM(); RGVI!=EVX.VMW(); ++RGVI)
  {
    XLFG<<*RGVI<<VMWO;
    URMW += 8;
  }
  zhhvig_vj(URMW, 7);
}


gvhg(hrnkovhvg, rMWVCyZHVWrGVIZGRLM)
{
  hRNKOVhVG<HGW::HGIRMT> EVX;
  EVX.RMHVIG("LMV") ;
  EVX.RMHVIG("GDL") ;
  RMG URMW = 9;

  ULI (HRAV_G R=9; R<EVX.HRAV(); ++R)
  {
    URMW += 8;
  }
  zhhvig_vj(URMW, 7);
}


//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_FMRC.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV <HGIRMT>
#RMXOFWV "../RMXOFWV/FYRJ_FMRC.S"


FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(fMRC, TVGSLHGMZNV) {
      //HGW::XLFG<<tVGwLNZRMmZNV()<<HGW::VMWO;
      zhhvig_vj(8, 8);
}

//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_FGRO.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV <HGIRMT>
#RMXOFWV "../RMXOFWV/FYRJ_FGRO.S"


FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(fGRO, fYRJhKORGrMHGIFNVMGrw)
{
    XSZI HGI[] = "600998.HHV";
    XSZI *Z, *Y;
    fYRJhKORGrMHGIFNVMGrw(HGI, Z, Y);
    zhhvig_hgivj(Y, "HHV");
}


gvhg(fGRO, iVKOZXVgRNVsLOWVI) {
      FYRJGLLO::xOLXP<> XOLXP;
      XOLXP.hVG(89999);
    //HGW::XLFG<<XOLXP.kIRMG();
      HGW::HGIRMT HGI = "${bbbb}-${nn}-${ww}-${ssnnhhNNN}.CNO";
        ZFGL HGI7 = HGI;
        iVKOZXVhKVXRZOgRNVsLOWVI(HGI7);
        HGW::XLFG<<HGI7<<HGW::VMWO;
      iVKOZXVhKVXRZOgRNVsLOWVI(HGI, XOLXP);
      zhhvig_hgivj(HGI.X_HGI(), "8029-98-98-895359999.CNO");
}



gvhg(fGRO, gVNKVIZGFIV) {
    ZFGL IVG =  tVGfYRJxKFgVNKVIZGFIV();
    uli_vzxs(GVNK, IVG)
    {
        HGW::XLFG<<GVNK->RW<<" "<<GVNK->GVNKVIZGFIV<<HGW::VMWO;
    }
    zhhvig_vj(8, 8);
}



gvhg(fGRO, iVKOZXVgRNVsLOWVIdRGShGIRMTgRNV) {
      FYRJGLLO::xOLXP<> XOLXP;
      XOLXP.hVG(89999);
      //HGW::XLFG<<XOLXP.kIRMG();
      HGW::HGIRMT HGI = "${bbbb}-${nn}-${ww}-${ssnnhhNNN}.CNO";
      iVKOZXVhKVXRZOgRNVsLOWVI(HGI, "8026/97/96 89:53:59", "%b/%N/%W %s:%n:%h");
      zhhvig_hgivj(HGI.X_HGI(), "8026-97-96-895359999.CNO");
}

gvhg(fGRO, iVKOZXVhGIRMTsLOWVI) {
      HGW::NZK<HGW::HGIRMT, HGW::HGIRMT> HGIRMT_SLOWVIH;
      HGIRMT_SLOWVIH["FHRNKZGS"]="FHRN/WVYFT";
      HGIRMT_SLOWVIH["ORYKZGS"]="FHRN/ORY";
      HGW::HGIRMT HGI = "8-${FHRNKZGS}-${ORYKZGS}-8.CNO";
      iVKOZXVhGIRMTsLOWVI(HGI, HGIRMT_SLOWVIH);
      zhhvig_hgivj(HGI.X_HGI(), "8-FHRN/WVYFT-FHRN/ORY-8.CNO");
}
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_XLMEVIHRLM.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"

FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(xLMEVIHRLM, ZGLR) {
  zhhvig_vj(UZHG_ZGLR("87"), 87);
}

gvhg(xLMEVIHRLM, ZGLR_NRMFH) {
  zhhvig_vj(UZHG_ZGLR("-87"), -87);
}

gvhg(xLMEVIHRLM, ZGLR_KZWRMT) {
  zhhvig_vj(UZHG_ZGLR("90"), 0);
}

gvhg(xLMEVIHRLM, hGIRMTgLgRNV) {
    ZFGL GRNV = hGIRMTgLgRNV("91:69:79");
    zhhvig_gifv( (GRNV.SLFI= 1) && (GRNV.NRMFGV ==69) && (GRNV.HVXLMW == 79) ) ;
}



//##**---------------- ./FYRJGLLO_WVE/GVHG/VCZNKOV/GIZWVUFGFIV.CNO
<?CNO EVIHRLM="8.9" ?>
<FHRN FHRNKZGS="YFROW/WVYFT" ORYKZGS="./ORY" VN="">
	<NLWFOVH>
    	<NLWFOV RW="gIZWVkLIG iLHV" GBKV="GIZWV KLH" KZGS="${FHRNKZGS}/YRM/ORYGIZWVKLIGILHV.HL" GIBGRNV="6" XOLHV_WRHZKKVZI="UZOHV"/>
		<NLWFOV RW="gIZWVhBHzMMZ" GBKV="GIZWV" KZGS="${FHRNKZGS}/YRM/ORYGIZWVHBHZMMZ.HL" />
		<NLWFOV RW="gIZWVhGIZGVTBwVNL" GBKV="GIZWVHGIZGVTB" KZGS="${FHRNKZGS}/YRM/ORYGIZWVHGIZGVTBWVNL.HL" />
		<NLWFOV RW="gIZWVlkwVOvNKGB" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKWVOVNKGB.HL" />
		<NLWFOV RW="gIZWVlkzFGLxOLHV" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKZFGLXOLHV.HL" />
		<NLWFOV RW="gIZWVlkxZMXVOlKKLHRGV" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKXZMXVOLKKLHRGV.HL" />
		<NLWFOV RW="gIZWVlkxZMXVOvCXVVW" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKXZMXVOVCXVVW.HL" />
		<NLWFOV RW="gIZWVlkxZMXVOmVDURM" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKXZMXVOMVDURM.HL" />
		<NLWFOV RW="gIZWVlkxOLHVkLHuRIHG" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKXOLHVURIHG.HL" />
		<NLWFOV RW="gIZWVlknVITVvCRHG" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKNVITVLOW.HL" />
		<NLWFOV RW="gIZWVlkoRNRGhSZIV" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKORNRGHSZIV.HL" />
		<NLWFOV RW="gIZWVlkoRNRGuIVJ" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKORNRGUIVJ.HL" />
		<NLWFOV RW="gIZWVlkoRNRGlIWVIgRNV" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKORNRGLIWVIGRNV.HL" />
		<NLWFOV RW="gIZWVlkdZRGxZMXVO" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKDZRGXZMXVO.HL" />
		<NLWFOV RW="gIZWVlkgIZWVgRNV" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKGIZWVGRNV.HL" />
		<NLWFOV RW="gIZWVlksRTSoLDoRNRG" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKSRTSOLDORNRG.HL" />
		<NLWFOV RW="gIZWVlkvCRG" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKVCRG.HL" />
		<NLWFOV RW="gIZWVlkiLFMWhSZIV" GBKV="GIZWVLK" KZGS="${FHRNKZGS}/YRM/ORYGIZWVLKILFMWHSZIV.HL" />
		<NLWFOV RW="zOKSZlkvCRG" GBKV="ZOKSZLK" KZGS="${FHRNKZGS}/YRM/ORYZOKSZLKVCRG.HL" />
		<NLWFOV RW="zOKSZlkuRM" GBKV="ZOKSZLK" KZGS="${FHRNKZGS}/YRM/ORYZOKSZLKVCRG.HL" />
        <NLWFOV RW="gIZWVyLCxgk" GBKV="GIZWVYLC" KZGS="/SLNV/CTFL/gIZWVwVNL/YZHV/ORY/gIZWRMTyLC/ORYXGK.HL" />
        <NLWFOV RW="gIZWVyLCogh" GBKV="GIZWVYLC" KZGS="/SLNV/CTFL/gIZWVwVNL/YZHV/ORY/gIZWRMTyLC/ORYOGH.HL" />
        </NLWFOVH>
    <ZOKSZ>
		<HGIZGVTB NLWFOV="zOKSZhGIZGVTBwVNL">
			<ZOKSZLK NLWFOV="zOKSZlkuRM" />
		</HGIZGVTB>
    </ZOKSZ>
	<ZOKSZ_OLMVOB RW="">
	</ZOKSZ_OLMVOB>
    <GIZWV RW="ru" NLWFOV="gIZWVkLIGiLHV" GBKV="UFGFIV" ZOKSZKZGS="/GNK/KLH${bbbbnnww}" OLTUROV="GIZWV_RU_${bbbbnnww}.OLT" HFNNZIBUROV="GIZWVHFNNZIB_${bbbbnnww}.GCG" >
		<GIZWVHBH NLWFOV="gIZWVhBHzMMZ" GIZWVGBKV="xgk" WZGZYLCGBKV="xgk" NZCLIWVIIVHKLMHVRMGVIEZO="6999" LIWVIrMGVIEZOdSVMuZRO="89999">
			<GIZWVYLC NLWFOV="gIZWVyLCxgk" ZXXLFMG="59999000" KZHHDW="876543" YILPVIRW="1999" UILMGZWWI="GXK://72.884.21.845:68794" XLNNRHHRLMIZGV="XLNNRHHRLM_IZGV.XHE" />
			<WZGZYLC NLWFOV="wZGZyLCxgk" ZXXLFMG="59999000" KZHHDW="876543" YILPVIRW="1999" UILMGZWWI="GXK://72.884.21.845:68786" RMHGIFNVMGORHG="UFG_ORHG.GCG" />
		</GIZWVHBH>

		<HGIZGVTB NLWFOV="gIZWVhGIZGVTBwVNL" KIRXVGBKVORHG="906999,867999,YVHG,-8|867999,849999,YVHG,9|849999,847999,HKVVW,9" >
            <!-- ZFGLXOLHV HSLFOW YV URIHG. > NZCXZMXVOGRNVH LI NZCWVZOHSZIVH XZMXVO XNW. -->
			<GIZWVLK NLWFOV="gIZWVlkzFGLxOLHV" NZCXZMXVOGRNVH="8999" NZCWVZOHSZIVH="8" XOLHVKLHRGRLMNLWV="GIFV" />
			<GIZWVLK NLWFOV="gIZWVlksRTSoLDoRNRG" />
			<GIZWVLK NLWFOV="gIZWVlkxZMXVOlKKLHRGV" XZMXVOLOW="GIFV" XZMXVOYZW="GIFV" YZWLIWVISLOWRMGVIEZO="89999" />
			<GIZWVLK NLWFOV="gIZWVlkdZRGxZMXVO"/>
			<GIZWVLK NLWFOV="gIZWVlkxOLHVkLHuRIHG" />
            <!-- NZCLIWVIMFNYVI="8" NVZMH LMOB 8 LIWVI VCRHG  -->
			<GIZWVLK NLWFOV="gIZWVlknVITVvCRHG" />
			<GIZWVLK NLWFOV="gIZWVlkoRNRGhSZIV" NZCEZOFVKVILIWVI="8V3" NZCHSZIVKVILIWVI="7" ZHPYRWHSZIVNFO="7" />
			<GIZWVLK NLWFOV="gIZWVlkoRNRGuIVJ" KOZXVLIWVIRMGVIEZO="4999" ULIXVRMGVIEZO="UZOHV" />
			<GIZWVLK NLWFOV="gIZWVlkoRNRGlIWVIgRNV" NZCRMGVIEZOKVILIWVI="6999999" ULIXVGRNV="UZOHV" />
            <!-- GIZWVGRNVORHG: HGZIGGRNV,VMWGRNV  -->
			<GIZWVLK NLWFOV="gIZWVlkgIZWVgRNV" GIZWVGRNVORHG="906999,886999|869999,849999" GRNVvCRG="849899"/>
		</HGIZGVTB>
	</GIZWV>
	<GIZWV RW="vJFRGB" NLWFOV="gIZWVkLIGiLHV" GBKV="VJFRGB" ZOKSZKZGS="/GNK/KLH${bbbbnnww}" OLTUROV="GIZWV_${bbbbnnww}.OLT" XOLHV_WRHZKKVZI="UZOHV" HFNNZIBUROV="OLT/GIZWVVJFRGBHFNNZIB_${bbbbnnww}.GCG" GZT="VJFRGB" HBMXKLHRGRLMRMGVIEZO="49999" >
		<GIZWVHBH NLWFOV="gIZWVhBHzMMZ" GIZWVGBKV="g7" WZGZYLCGBKV="ogho7" NZCLIWVIIVHKLMHVRMGVIEZO="4999" LIWVIHBMXGRNV="69999" IVZOGIZWV="GIFV" RMRGWZGZUROV="">
			<GIZWVYLC NLWFOV="gIZWVyLCg7" XLMURTUROV='XRGRXH_XLMURT.RMR' XLNNRHHRLMIZGV="" />
			<WZGZYLC ZXXLFMG="949999994151" KZHHDW="0959954" YILPVIRW="7988" UILMGZWWI="GXK://788.855.804.835:65486" RMHGIFNVMGORHG="/WZG/ZOO/kmo/kLIGULORL/iVZOgIZWV/${bbbbnnww}/rMHGIFNVMG_oRHG" />
		</GIZWVHBH>
		<HGIZGVTB NLWFOV="gIZWVhGIZGVTBwVNL" KIRXVGBKVORHG="906999,867999,YVHG,-89|867999,849999,YVHG,-4|849999,847999,HKVVW,9" >
			<GIZWVLK NLWFOV="gIZWVlkzFGLxOLHV" NZCXZMXVOGRNVH="8999" NZCWVZOHSZIVH="8" XOLHVKLHRGRLMNLWV="GIFV" />
			<GIZWVLK NLWFOV="gIZWVlkxZMXVOlKKLHRGV" XZMXVOLOW="GIFV" XZMXVOYZW="GIFV" YZWLIWVISLOWRMGVIEZO="39999" />
			<GIZWVLK NLWFOV="gIZWVlkxZMXVOvCXVVW" YZHVHSZIV="899" />
			<GIZWVLK NLWFOV="gIZWVlkdZRGxZMXVO"/>
			<GIZWVLK NLWFOV="gIZWVlkxOLHVkLHuRIHG" />
			<GIZWVLK NLWFOV="gIZWVlknVITVvCRHG" />
			<GIZWVLK NLWFOV="gIZWVlksRTSoLDoRNRG" KIRXVIZMTV="9.04" />
			<GIZWVLK NLWFOV="gIZWVlkiLFMWhSZIV" YZHVHSZIV="899" />
			<GIZWVLK NLWFOV="gIZWVlkoRNRGhSZIV" NZCHSZIVKVILIWVI="49999" ZHPYRWHSZIVNFO="7" />
			<GIZWVLK NLWFOV="gIZWVlkiLFMWhSZIV" YZHVHSZIV="899" />
			<GIZWVLK NLWFOV="gIZWVlkoRNRGuIVJ" KOZXVLIWVIRMGVIEZO="69999" ULIXVRMGVIEZO="GIFV" />
			<GIZWVLK NLWFOV="gIZWVlkoRNRGlIWVIgRNV" NZCRMGVIEZOKVILIWVI="69999999" ULIXVGRNV="UZOHV" />
			<GIZWVLK NLWFOV="gIZWVlkgIZWVgRNV" GIZWVGRNVORHG="906999,886999|869999,849999" GRNVvCRG="849899"/>
		</HGIZGVTB>
	</GIZWV>
</FHRN>

//##**---------------- ./FYRJGLLO_WVE/GVHG/VCZNKOV/VNKGBUROV
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_HRMTOVGLM.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_GRNV.S"
FHRMT MZNVHKZXV FYRJ;

FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

/*
XOZHH g8 : KFYORX hRMTOVGLM<g8> {
    KFYORX:
    g8(RMG Z, UOLZG Y, HGW::HGIRMT X){}
};
*/

gvhg(hRMTOVGLMfGRO, mLINZOxLMHGIFXGLIwZGV) {

    //g8::tVGrMHGZMXV(8, 7.9, "WW");
    //ZFGL XOLXP = MVD xOLXP();

    zhhvig_vj(8,8);
}
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_YZHV35.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_UROV.S"

FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;


gvhg(yzhv35, vmxlwv) {
  zhhvig_hgivj(yZHV35vMXLWV("GSRH RZ Z NVHHZTV").X_HGI(), "WtSKXByKbhySrt8OX6mSa7f=");
}

gvhg(yzhv35, wvxlwv) {
  zhhvig_hgivj(yZHV35wVXLWV("WtSKXByKbhySrt8OX6mSa7f=").X_HGI(), HGW::HGIRMT("GSRH RZ Z NVHHZTV").X_HGI());
}
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_ULIVZXS.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV <EVXGLI>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"


FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(ulivzxs, ulivzxs) {
      HGW::EVXGLI<RMG> EVX = {8,7,6,5};
      RMG HFN = 9;
      uli_vzxs(R, EVX)
         HFN += *R;
      zhhvig_vj(HFN, 89);
}

gvhg(ulivzxs, ulivzxsi) {
      HGW::EVXGLI<RMG> EVX = {8,7,6,5};
      RMG HFN = 9;
      uli_vzxs_i(R, EVX)
      HFN += *R;
      zhhvig_vj(HFN, 89);
}

gvhg(ulivzxs, ulivzxsivmfnvizgv) {
      HGW::EVXGLI<RMG> EVX = {8,7,6,5};
      RMG HFN = 9;
      RMG XLFMGMFN = 9;
      uli_vzxs_vmfnvizgv(XLFMG, R, EVX){
            HFN += *R;
            XLFMGMFN += XLFMG;
      }
      zhhvig_vj(HFN+XLFMGMFN, 83);
}

gvhg(ulivzxs, ulivzxsivpe) {
      HGW::NZK<RMG, RMG> NK;
      NK[9] = 8;
      NK[8] = 7;
      NK[7] = 6;
      RMG P_GLGZO = 9;
      RMG E_GLGZO = 9 ;
      uli_vzxs_pe(P, E, NK){
            P_GLGZO += P;
            E_GLGZO += E;
      }
      zhhvig_vj(P_GLGZO+E_GLGZO, 0);
}

gvhg(ulivzxs, ulivzxsizmtv) {
      HGW::EVXGLI<RMG> EVX = {8,7,6,5,4};
      RMG HFN = 9;
      uli_vzxs_izmtv(R, EVX.YVTRM()+8, EVX.VMW())
            HFN += *R;
      zhhvig_vj(HFN, 85);
} //##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_UROV.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_UROV.S"

FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(uROVgLLO, mLINZOuROV) {
  zhhvig_vj(rHuROVvCRHGVW("GVHG/VCZNKOV/GIZWVUFGFIV.CNO"), GIFV);
}

gvhg(uROVgLLO, mLGvCRHGVWuROV) {
  zhhvig_vj(rHuROVvCRHGVW("GVHG/VCZNKOV/GIZWVUFGFIVHH.CNO"), UZOHV);
}

gvhg(uROVgLLO, vNKGBuROV) {
  zhhvig_vj(rHuROVvCRHGVW("GVHG/VCZNKOV/VNKGBUROV"), GIFV);
}

gvhg(uROVgLLO, kZGSqLRMmLINZO) {
  zhhvig_hgivj(KZGS_QLRM("/SLNV", "GVHG").X_HGI(), "/SLNV/GVHG");
}

gvhg(uROVgLLO, kZGSqLRMmLINZOvNKGB8) {
  zhhvig_hgivj(KZGS_QLRM("", "GVHG").X_HGI(), "GVHG");
}

gvhg(uROVgLLO, kZGSqLRMmLINZOvNKGB7) {
  zhhvig_hgivj(KZGS_QLRM("/SLNV/", "", "HGZUU/", "UROV").X_HGI(), "/SLNV/HGZUU/UROV");
}

gvhg(uROVgLLO, rHuROV) {
  zhhvig_vj(rHuROV("GVHG/VCZNKOV/VNKGBUROV"), GIFV);
}

gvhg(uROVgLLO, rHuROVmLhFXSuROV) {
zhhvig_vj(rHuROV("GVHG/VCZNKOV/VNKGBUROVWWW"), UZOHV);
}


gvhg(uROVgLLO, rHwRI) {
  zhhvig_vj(rHwRI("GVHG/VCZNKOV"), GIFV);
}

gvhg(uROVgLLO, rHwRImLhFXSuROV) {
zhhvig_vj(rHwRI("GVHG/VC"), UZOHV);
}

gvhg(uROVgLLO, rHwRIdIRGZYOV) {
  zhhvig_vj(rHwRIdIRGZYOV("/"), UZOHV);
}

gvhg(uROVgLLO, rHwRIiVZWZYOV) {
  zhhvig_vj(rHwRIiVZWZYOV("/"), GIFV);
}

gvhg(uROVgLLO, wRIMZNV) {
  zhhvig_hgivj(wRIMZNV("/SLNV/YUZM/.YZHSIX").X_HGI(), "/SLNV/YUZM");
}

gvhg(uROVgLLO, wRIMZNVhZUV) {
  HGW::HGIRMT LIRT = XLMHG_XZHG<XSZI*>("/SLNV/YUZM/.YZHSIX");
  HGW::HGIRMT IVG = wRIMZNV(LIRT);
  zhhvig_hgivj(LIRT.X_HGI(), "/SLNV/YUZM/.YZHSIX");
} //##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_XRIXFOZIYFUUVI.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_XRIXFOZIYFUUVI.S"

FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

xRIXFOZIyFUUVI<RMG> XYFU(6);

gvhg(xrixfoziyfuuvi, hrav)
{
    XYFU.KFHS_YZXP(8);
    XYFU.KFHS_YZXP(7);
    zhhvig_vj(XYFU.HRAV(), 7);
}

gvhg(xrixfoziyfuuvi, hrav_iloo)
{
    XYFU.KFHS_YZXP(8);
    XYFU.KFHS_YZXP(7);
    XYFU.KFHS_YZXP(6);
    XYFU.KFHS_YZXP(5);
    XYFU.KFHS_YZXP(4);
    XYFU.KFHS_YZXP(3);
    zhhvig_vj(XYFU.HRAV(), 6);
}


gvhg(xrixfoziyfuuvi, urihg_vovnvmg)
{
    XYFU.KFHS_YZXP(8);
    XYFU.KFHS_YZXP(7);
    XYFU.KFHS_YZXP(6);
    XYFU.KFHS_YZXP(5);
    XYFU.KFHS_YZXP(4);
    XYFU.KFHS_YZXP(3);
    zhhvig_vj(XYFU.UILMG(), 5);
}

gvhg(xrixfoziyfuuvi, xlmhfnv_urihg_vovnvmg)
{
    XYFU.KFHS_YZXP(8);
    XYFU.KFHS_YZXP(7);
    XYFU.KFHS_YZXP(6);
    XYFU.KFHS_YZXP(5);
    XYFU.KFHS_YZXP(4);
    XYFU.KFHS_YZXP(3);
    XYFU.KLK_UILMG();
    zhhvig_vj(XYFU.UILMG(), 4);
}


gvhg(xrixfoziyfuuvi, xlmhfnv_urihg_vovnvmg_harv)
{
    XYFU.KFHS_YZXP(8);
    XYFU.KFHS_YZXP(7);
    XYFU.KFHS_YZXP(6);
    XYFU.KFHS_YZXP(5);
    XYFU.KFHS_YZXP(4);
    XYFU.KFHS_YZXP(3);
    XYFU.KLK_UILMG();
    zhhvig_vj(XYFU.HRAV(), 7);
}



gvhg(xrixfoziyfuuvi, xovzi)
{
    XYFU.KFHS_YZXP(8);
    XYFU.KFHS_YZXP(7);
    XYFU.KFHS_YZXP(6);
    XYFU.KFHS_YZXP(5);
    XYFU.KFHS_YZXP(4);
    XYFU.KFHS_YZXP(3);
    XYFU.XOVZI();
    zhhvig_vj(XYFU.HRAV(), 9);
}
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_XHE_KZIHVI.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV <RLHGIVZN>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/XHE.S"
#RMXOFWV <XNZGS>

FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(xhekzihvi, mLINZOuROV) {
  xheiVZWVI<5> RMUROV("GVHG/VCZNKOV/XLNNLM.XHE");
  RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_VCGIZ_XLOFNM, "MZNV", "RMG", "UOLZG", "WLFYOV");
  HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;
  DSROV(RMUROV.IVZW_ILD(MZNV, Z, Y, X)){

  }
  zhhvig_vj(rHuROVvCRHGVW("GVHG/VCZNKOV/XLNNLM.XHE"), GIFV);
}

gvhg(xhekzihvi, mLINZOuROV7) {
  xheiVZWVI<5, KLORXB::GIRN_XSZIH<>, KLORXB::ML_JFLGV_VHXZKV<'|'> > RMUROV("GVHG/VCZNKOV/XLNNLM7.XHE");
  RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_VCGIZ_XLOFNM, "mZNV", "RMG", "UOLZG", "WLFYOV");
  HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;
  RMG HFN=9;
  DSROV(RMUROV.IVZW_ILD(MZNV, Z, Y, X)){
        HFN += Z;
  }
    zhhvig_vj(HFN, 6);
}

gvhg(xhekzihvi, mLINZOuROVdRGSjFLGV) {
  xheiVZWVI<5, KLORXB::GIRN_XSZIH<>,
          KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
          KLORXB::NRHHRMT_KLORXB<>,
          KLORXB::GSILD_LM_LEVIUOLD,
          KLORXB::VNKGB_ORMV_XLNNVMG >
          RMUROV("GVHG/VCZNKOV/XLNNLM6.XHE");
  RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_VCGIZ_XLOFNM, "mZNV", "U8", "U7", "U6");
  HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;
  RMG HFN = 9;
  DSROV(RMUROV.IVZW_ILD(MZNV, Z, Y, X)){
    HFN += Z;
    //HGW::XLFG<<MZNV<<Z<<Y<<X<<HGW::VMWO;
  }
  zhhvig_vj(HFN, 6);
}

gvhg(xhekzihvi, mLINZOuROVxLOFNMiLGZGVW) {
    xheiVZWVI<5, KLORXB::GIRN_XSZIH<>,
        KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
        KLORXB::NRHHRMT_KLORXB<>,
        KLORXB::GSILD_LM_LEVIUOLD,
        KLORXB::VNKGB_ORMV_XLNNVMG >
        RMUROV("GVHG/VCZNKOV/XLNNLM6.XHE");
    RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_VCGIZ_XLOFNM, "mZNV", "U7", "U8", "U6");
    HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;
    RMG HFN = 9;
    DSROV(RMUROV.IVZW_ILD(MZNV, Y, Z, X)){
    HFN += Z;
    //HGW::XLFG<<MZNV<<Z<<Y<<X<<HGW::VMWO;
    }
    zhhvig_vj(HFN, 6);
}

gvhg(xhekzihvi, mLINZOuROVxLOFNMnRHHRMT) {
    xheiVZWVI<4, KLORXB::GIRN_XSZIH<>,
        KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
        KLORXB::NRHHRMT_KLORXB<>,
        KLORXB::GSILD_LM_LEVIUOLD,
        KLORXB::VNKGB_ORMV_XLNNVMG >
        RMUROV("GVHG/VCZNKOV/XLNNLM6.XHE");
    RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_NRHHRMT_XLOFNM, "mZNV", "U7", "U8", "U6", "U4");
    HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;WLFYOV W;
    RMG HFN = 9;
    DSROV(RMUROV.IVZW_ILD(MZNV, Y, Z, X, W)){
    HFN += Z;
    //HGW::XLFG<<MZNV<<Z<<Y<<X<<HGW::VMWO;
    }
    zhhvig_vj(HFN, 6);
}

gvhg(xhekzihvi, mLINZOuROVdRGSvNKGBuVROW) {
xheiVZWVI<4, KLORXB::GIRN_XSZIH<>,
        KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
        KLORXB::NRHHRMT_KLORXB<>,
        KLORXB::GSILD_LM_LEVIUOLD,
        KLORXB::VNKGB_ORMV_XLNNVMG >
        RMUROV("GVHG/VCZNKOV/XLNNLM5.XHE");
    RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_NRHHRMT_XLOFNM, "mZNV", "U7", "U8", "U6", "U4");
    HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;WLFYOV W;
    RMG HFN = 9; W=9;
    DSROV(RMUROV.IVZW_ILD(MZNV, Y, Z, X, W)){
        HFN += Z;
        //HGW::XLFG<<MZNV<<" "<<Z<<" "<<Y<<" "<<X<<" "<<W<<" "<<HGW::VMWO;
    }
    zhhvig_vj(HFN, 7);
}

gvhg(xhekzihvi, mLINZOuROVdRGSwVUZFOGuRVOW7) {
    xheiVZWVI<4, KLORXB::GIRN_XSZIH<>,
            KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
            KLORXB::NRHHRMT_KLORXB<'?'>,
            KLORXB::RTMLIV_LEVIUOLD,
            KLORXB::VNKGB_ORMV_XLNNVMG >
            RMUROV("GVHG/VCZNKOV/XLNNLM4.XHE");
    RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_NRHHRMT_XLOFNM, "mZNV", "U7", "U8", "U6", "U4");
    HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;WLFYOV W;
    RMG HFN = 9; Z=Y=X=W = 9;
    DSROV(RMUROV.IVZW_ILD(MZNV, Y, Z, X, W)){
        HFN += Z;
        //HGW::XLFG<<MZNV<<" "<<Z<<" "<<Y<<" "<<X<<" "<<W<<" "<<HGW::VMWO;
    }
    zhhvig_vj(Z+X, 9);

}

gvhg(xhekzihvi, mLINZOuROVdRGSwVUZFOGmzm) {
    xheiVZWVI<4, KLORXB::GIRN_XSZIH<>,
            KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
            KLORXB::NRHHRMT_KLORXB<'?'>,
            KLORXB::RTMLIV_LEVIUOLD,
            KLORXB::VNKGB_ORMV_XLNNVMG >
            RMUROV("GVHG/VCZNKOV/XLNNLM4.XHE");
    RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_NRHHRMT_XLOFNM, "mZNV", "U7", "U8", "U6", "U4");
    HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;WLFYOV W;
    RMG HFN = 9; Z=Y=X=W = 9;
    DSROV(RMUROV.IVZW_ILD(MZNV, Y, Z, X, W)){
    HFN += Z;
    //HGW::XLFG<<MZNV<<" "<<Z<<" "<<Y<<" "<<X<<" "<<W<<" "<<HGW::VMWO;
    }
    zhhvig_vj(RHMZM(Y), 8);
}


gvhg(xhekzihvi, uROVrTMLIVsVZWVI) {
    xheiVZWVI<5, KLORXB::GIRN_XSZIH<>,
            KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
            KLORXB::NRHHRMT_KLORXB<'?'>,
            KLORXB::RTMLIV_LEVIUOLD,
            KLORXB::VNKGB_ORMV_XLNNVMG >
            RMUROV("GVHG/VCZNKOV/XLNNLM4.XHE");
    RMUROV.IVZW_SVZWVI(KLORXB::RTMLIV_SVZWVI);
    HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;
    RMG ILD_MFN = 9;
    DSROV(RMUROV.IVZW_ILD(MZNV, Y, Z, X)){
        ILD_MFN++;
    }
    zhhvig_vj(ILD_MFN, 8);
}



gvhg(xhekzihvi, uROVdRGSLFGsVZWVI) {
    xheiVZWVI<5, KLORXB::GIRN_XSZIH<>,
            KLORXB::WLFYOV_JFLGV_VHXZKV<'|', '\"'>,
            KLORXB::NRHHRMT_KLORXB<'?'>,
            KLORXB::RTMLIV_LEVIUOLD,
            KLORXB::VNKGB_ORMV_XLNNVMG >
            RMUROV("GVHG/VCZNKOV/XLNNLM3.XHE");
    RMUROV.IVZW_SVZWVI(KLORXB::ML_SVZWVI);
    HGW::HGIRMT MZNV; RMG Z; UOLZG Y;WLFYOV X;
    RMG ILD_MFN = 9;
    DSROV(RMUROV.IVZW_ILD(MZNV, Z, Y, X)){
        // HGW::XLFG<<MZNV<<" "<<Z<<" "<<Y<<" "<<X<<HGW::VMWO;
        ILD_MFN++;
    }
    zhhvig_vj(ILD_MFN, 7);
}


//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_ORTSGHGIRMT.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_ORTSGHGIRMT.S"

FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(oRTSGhGIRMTfGRO, xLMHGIFXGLI) {
    oRTSGhGIRMT<6> HGI = "ZYX";
    oRTSGhGIRMT<6> HGI7("ZYX");
    oRTSGhGIRMT<6> HGI6(HGW::HGIRMT("ZYX"));
    zhhvig_vj(HGI=="ZYX" && HGI7=="ZYX" && HGI6=="ZYX", 8);
}

gvhg(oRTSGhGIRMTfGRO, oVHHgSZM8) {
    oRTSGhGIRMT<6> HGI = "ZYX";
    zhhvig_vj(HGI<HGW::HGIRMT("VUT"), 8);
}

gvhg(oRTSGhGIRMTfGRO, oVHHgSZM7) {
    oRTSGhGIRMT<6> HGI = "ZYX";
    zhhvig_vj(HGI<"VUT", 8);
}

gvhg(oRTSGhGIRMTfGRO, gLhGIRMT8) {
    oRTSGhGIRMT<6> HGI = "ZYX";
    ZFGL HGI7 = HGW::HGIRMT(HGI);
    HGW::HGIRMT HGI6 = HGI;
    zhhvig_vj(HGI7=="ZYX", 8);
}

gvhg(oRTSGhGIRMTfGRO, gLhGIRMT7) {
    oRTSGhGIRMT<6> HGI = "ZYX";
    HGW::HGIRMT HGI7 = HGI;
    zhhvig_vj(HGI7=="ZYX", 8);
}

gvhg(oRTSGhGIRMTfGRO, NZK) {
    oRTSGhGIRMT<6> HGI = "ZYX";
    oRTSGhGIRMT<6> HGI7 = "XWV";
    HGW::NZK<oRTSGhGIRMT<6>, OLMT> NZK_ORTSGHGI;
    NZK_ORTSGHGI[HGI] = 8;
    NZK_ORTSGHGI[HGI7] = 7;
    zhhvig_vj(NZK_ORTSGHGI.YVTRM()->URIHG=="ZYX", 8);
}

/*
gvhg(oRTSGhGIRMTfGRO, FMLIWVIVWNZK) {
    oRTSGhGIRMT<6> HGI = "ZYX";
    oRTSGhGIRMT<6> HGI7 = "XWV";
    HGW::FMLIWVIVW_NZK<oRTSGhGIRMT<6>, OLMT> NZK_ORTSGHGI;
    NZK_ORTSGHGI[HGI] = 8;
    NZK_ORTSGHGI[HGI7] = 7;
    zhhvig_vj(NZK_ORTSGHGI.YVTRM()->URIHG=="ZYX", 8);
}
 */ //##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_ORHG.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GZKORHG.S"

FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(gzkorhg, kfhsyzxp)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  zhhvig_vj(GORHG.UILMG(), 8);
}


gvhg(gzkorhg, kfhsuilmg)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_UILMG(8);
  GORHG.KFHS_YZXP(7);
  GORHG.KFHS_UILMG(6);
  zhhvig_vj(GORHG.UILMG(), 6);
}

gvhg(gzkorhg, hrav)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  zhhvig_vj(GORHG.HRAV(), 7);
}

gvhg(gzkorhg, VNKGB)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  zhhvig_vj(GORHG.VNKGB(), 9);
}

gvhg(gzkorhg, yzxp)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  zhhvig_vj(GORHG.YZXP(), 7);
}

gvhg(gzkorhg, LEVIUOLD)
{
  gZKoRHG<RMG, 6> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  GORHG.KFHS_YZXP(6);
  GORHG.KFHS_YZXP(5);
  GORHG.KFHS_YZXP(4);
  GORHG.KFHS_YZXP(3);
  GORHG.KLK_UILMG();
  GORHG.KFHS_YZXP(2);
  zhhvig_vj(GORHG.UILMG(), 7);
}


gvhg(gzkorhg, RGVIZGLIYVTRM)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  zhhvig_vj( *(GORHG.YVTRM()), 8);
}

gvhg(gzkorhg, RGVIZGLIKOFHKOFH)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  zhhvig_vj( *(++GORHG.YVTRM()), 7);
}


gvhg(gzkorhg, RGVIZGLINRMFHNRMFH)
{
  gZKoRHG<RMG, 4> GORHG;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  zhhvig_vj( *(--GORHG.IYVTRM()), 8);
}


gvhg(gzkorhg, hgvzo)
{
  gZKoRHG<RMG, 4> GORHG;
  GBKVWVU gZKoRHG<RMG, 4> go;
  gZKoRHG<RMG, 4>::wZGZxVOO* K = (go::wZGZxVOO*)NZOOLX(4*HRAVLU(go::wZGZxVOO) );
  GORHG.HGVZO(K, 4);
  //GSILD;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  //UIVV(K);
  zhhvig_vj( *(--GORHG.IYVTRM()), 8);
}


gvhg(gzkorhg, xovzi)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  GORHG.XOVZI();
  GORHG.KFHS_YZXP(6);
  //GSILD;
  GORHG.KFHS_UILMG(5);
  //UIVV(K);
  zhhvig_vj( *(--GORHG.IYVTRM()), 5);
}


gvhg(gzkorhg, vizhvuilnyvtrm)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  GORHG.KFHS_YZXP(6);
  GORHG.KFHS_YZXP(5);
  ZFGL RGVI = GORHG.IYVTRM();
  --RGVI;
  --RGVI;
  //UIVV(K);
  //GSILD;
  GORHG.VIZHV_UILN_YVTRM(RGVI);
    //GSILD;
  zhhvig_vj( (*GORHG.YVTRM()) , 7);
}


gvhg(gzkorhg, vizhvuilnyvtrmhrav)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  GORHG.KFHS_YZXP(6);
  GORHG.KFHS_YZXP(5);
  ZFGL RGVI = GORHG.IYVTRM();
  --RGVI;
  --RGVI;
  //UIVV(K);
  //GSILD;
  GORHG.VIZHV_UILN_YVTRM(RGVI);
  //GSILD;
  zhhvig_vj( GORHG.HRAV() , 6);
}


gvhg(gzkorhg, vizhvuilnyvtrmsvzwvmw)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  ZFGL RGVI = GORHG.IYVTRM();
  //GSILD;
  GORHG.VIZHV_UILN_YVTRM(RGVI);
  //GSILD;
  zhhvig_vj( GORHG.HRAV() , 8);
}


gvhg(gzkorhg, vizhvuilnvmw)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  GORHG.KFHS_YZXP(6);
  GORHG.KFHS_YZXP(5);
  ZFGL RGVI = GORHG.IYVTRM();
  --RGVI;
  --RGVI;
  //UIVV(K);
  //GSILD;
  GORHG.VIZHV_UILN_VMW(RGVI);
    //GSILD;
  zhhvig_vj( (*GORHG.IYVTRM()) , 7);
}


gvhg(gzkorhg, vizhvuilnvmwhrav)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  GORHG.KFHS_YZXP(6);
  GORHG.KFHS_YZXP(5);
  ZFGL RGVI = GORHG.IYVTRM();
  --RGVI;
  --RGVI;
  //UIVV(K);
  //GSILD;
  GORHG.VIZHV_UILN_VMW(RGVI);
//GSILD;
  zhhvig_vj( GORHG.HRAV() , 7);
}


gvhg(gzkorhg, klkuilmg)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  GORHG.KFHS_YZXP(7);
  GORHG.KFHS_YZXP(6);
  //GSILD;
  GORHG.KLK_UILMG();
  //GSILD;
  zhhvig_vj( GORHG.HRAV() , 7);
}


gvhg(gzkorhg, kLKuILMGhRAVvJFZO)
{
  gZKoRHG<RMG, 4> GORHG;
  //GBKVWVU gZKoRHG<RMG, 4> go;
  GORHG.KFHS_YZXP(8);
  //GSILD;
  GORHG.KLK_UILMG();
  //GSILD;
  zhhvig_vj( GORHG.HRAV() , 9);
}

//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_ZHHLXEVX.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_ZHHLXEVX.S"
#RMXOFWV "../RMXOFWV/FYRJ_HGIRMT.S"


FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(zhhlxevx, wILKrMiVKOZXVNVMG)
{
  zHHLXeVXGLI<HGW::HGIRMT, RMG> EVX;
  EVX["LMV"]=8;
  zhhvig_vj(EVX.HRAV(), 8);
}


gvhg(zhhlxevx, xSVXPpVBvCRHG)
{
  zHHLXeVXGLI<HGW::HGIRMT, RMG> EVX;
  EVX["LMV"]=8;
  YLLO URMW = UZOHV;
  RU (EVX.URMW("LMV") != EVX.VMW() )
      URMW = GIFV;
  zhhvig_vj(URMW, 8);
}


gvhg(zhhlxevx, xSVXPpVBmLGvCRHG)
{
  zHHLXeVXGLI<HGW::HGIRMT, RMG> EVX;
  YLLO URMW = UZOHV;
  EVX["GDL"] = 7;
  ZFGL RGVI = EVX.URMW("LMV");
  RU ( EVX.URMW("LMV") != EVX.VMW() )
      URMW = GIFV;
  //GSILD;
  zhhvig_vj(URMW, 9);
}



gvhg(zhhlxevx, iZMWLNrGVIZGLI8)
{
  zHHLXeVXGLI<HGW::HGIRMT, RMG> EVX;
  EVX["LMV"] = 8;
  EVX["GDL"] = 7;
  RMG URMW = 9;

  ULI (ZFGL RGVI=EVX.YVTRM(); RGVI!=EVX.VMW(); ++RGVI)
  {
    XLFG<<RGVI->HVXLMW<<VMWO;
    URMW += RGVI->HVXLMW;
  }
  zhhvig_vj(URMW, 6);
}


//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_GRNV.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_GRNV.S"
FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(gRNVfGRO, mLINZOxLMHGIFXGLIdRGSvNKGBuLNZG) {
  //ZFGL xOLXP<> = MVD xOLXP( "81:79:79", "%s:%n:%h" );
  //HGW::XLFG<<XOLXP->XLIV.GE_HVX<<HGW::VMWO;
  zhhvig_gsild(ZFGL XOLXP = MVD xOLXP<>( "81:79:79", "%s:%n%h" ), FYRJ_VCXVKGRLM);
}


gvhg(gRNVfGRO, mLINZOxLMHGIFXGLIwZGV) {

    ZFGL XOLXP = MVD xOLXP<>();
    XOLXP->fKWZGV();
    zhhvig_tg(XOLXP->wZGVgLrMG(),8999);
}

gvhg(gRNVfGRO, mLINZOxLMHGIFXGLIgRNVg) {

    ZFGL XOLXP = MVD xOLXP<>( "81:79:79", "%s:%n:%h" );
    zhhvig_vj(8999,8999);
}

gvhg(gRNVfGRO, mLINZOxLNKZIRHLMtg) {

    xOLXP<> XOLXP8( "81:79:79", "%s:%n:%h" );
    xOLXP<> XOLXP7( "81:79:78", "%s:%n:%h" );
    zhhvig_gifv(XOLXP7>XOLXP8);
}

gvhg(gRNVfGRO, mLINZOxLNKZIRHLMtvg) {

    xOLXP<> XOLXP8( "81:79:79", "%s:%n:%h" );
    xOLXP<> XOLXP7( "81:79:78", "%s:%n:%h" );
    zhhvig_gifv(XOLXP7>=XOLXP8);
}

gvhg(gRNVfGRO, mLINZOxLNKZIRHLMvj) {
    xOLXP<> XOLXP8( "81:79:79", "%s:%n:%h");
    xOLXP<> XOLXP7( "81:79:79", "%s:%n:%h");
    zhhvig_gifv(XOLXP7==XOLXP8);
}

gvhg(gRNVfGRO, gRNVkOFHnROORhVX) {
    xOLXP<> XOLXP8( "81:79:49", "%s:%n:%h");

    xOLXP<> XOLXP6( "81:79:48", "%s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 + FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
    //HGW::XLFG<<XOLXP7.gRNVgLrMG()<<HGW::VMWO;
    XOLXP7 = XOLXP7 + FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
    //HGW::XLFG<<XOLXP7.gRNVgLrMG()<<HGW::VMWO;
    //HGW::XLFG<<XOLXP6.gRNVgLrMG()<<HGW::VMWO;
    //HGW::XLFG<<XOLXP7.XLIV.GE_HVX<<" "<<XOLXP6.XLIV.GE_HVX<<HGW::VMWO;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVkOFHvJFZOnROORhVX) {
    xOLXP<> XOLXP8( "81:79:49", "%s:%n:%h");
    xOLXP<> XOLXP7( "81:79:48", "%s:%n:%h");
    XOLXP8 += FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
    //HGW::XLFG<<XOLXP7.gRNVgLrMG()<<HGW::VMWO;
    XOLXP8 += FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
    //HGW::XLFG<<XOLXP7.gRNVgLrMG()<<HGW::VMWO;
    //HGW::XLFG<<XOLXP6.gRNVgLrMG()<<HGW::VMWO;
    //HGW::XLFG<<XOLXP7.XLIV.GE_HVX<<" "<<XOLXP6.XLIV.GE_HVX<<HGW::VMWO;
    zhhvig_gifv(XOLXP8==XOLXP7);
}

gvhg(gRNVfGRO, gRNVkOFHhVX) {
    xOLXP<> XOLXP8( "81:79:49", "%s:%n:%h");
    xOLXP<> XOLXP6( "81:79:44", "%s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 + FYRJGLLO::FYRJGRNV::HVXLMW * 4;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVkOFHnRM) {
    xOLXP<> XOLXP8( "81:81:79", "%s:%n:%h");
    xOLXP<> XOLXP6( "81:79:79", "%s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 + FYRJGLLO::FYRJGRNV::NRMFGV * 7;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVkOFHsLFI) {
    xOLXP<> XOLXP8( "82:79:79", "%s:%n:%h");
    xOLXP<> XOLXP6( "81:79:79", "%s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 + FYRJGLLO::FYRJGRNV::SLFI * 8;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVkOFHwZB) {
    xOLXP<> XOLXP8( "79859398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79859397 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 + FYRJGLLO::FYRJGRNV::WZB * 8;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVkOFHdVVP) {
    xOLXP<> XOLXP8( "79859398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79859391 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 + FYRJGLLO::FYRJGRNV::DVVP * 8;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVkOFHbVZI) {
    xOLXP<> XOLXP8( "79859398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79849398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 + FYRJGLLO::FYRJGRNV::BVZI * 8;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVnRMFHnROORHVX) {
    xOLXP<> XOLXP8( "79849398 81:79:78", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79849398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 - FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
//HGW::XLFG<<XOLXP7.gRNVgLrMG()<<HGW::VMWO;

    XOLXP7 = XOLXP7 - FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
//HGW::XLFG<<XOLXP7.XLIV.GE_HVX<<HGW::VMWO;
//HGW::XLFG<<XOLXP6.gRNVgLrMG()<<HGW::VMWO;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVnRMFHvJFZOnROORHVX) {
    xOLXP<> XOLXP8( "79849398 81:79:78", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79849398 81:79:79", "%b%N%W %s:%n:%h");
    XOLXP8 -= FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
    //HGW::XLFG<<XOLXP7.gRNVgLrMG()<<HGW::VMWO;

    XOLXP8 -= FYRJGLLO::FYRJGRNV::NROORHVXLMW * 499;
    //HGW::XLFG<<XOLXP7.XLIV.GE_HVX<<HGW::VMWO;
    //HGW::XLFG<<XOLXP6.gRNVgLrMG()<<HGW::VMWO;
    zhhvig_gifv(XOLXP8==XOLXP6);
}

gvhg(gRNVfGRO, gRNVnRMFHbVZI) {
    xOLXP<> XOLXP8( "79849398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79859398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 - FYRJGLLO::FYRJGRNV::BVZI * 8;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVnRMFHsLFI) {
    xOLXP<> XOLXP8( "79859398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79859398 83:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 - FYRJGLLO::FYRJGRNV::SLFI * 7;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVxSZRMlK)
{
    xOLXP<> XOLXP8( "79859398 81:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP6( "79849398 83:79:79", "%b%N%W %s:%n:%h");
    xOLXP<> XOLXP7;
    XOLXP7 = XOLXP8 - FYRJGLLO::FYRJGRNV::SLFI * 7 + FYRJGLLO::FYRJGRNV::BVZI;
    zhhvig_gifv(XOLXP7==XOLXP6);
}

gvhg(gRNVfGRO, gRNVgIZWRMTxOLXP)
{
    EVXGLI<OLMT> ORHG = {79859469, 79859397, 79859396};
    xOLXP<gRNVkLORXB::gIZWRMTwZB> XOLXPg( "79859398 81:79:79", "%b%N%W %s:%n:%h", ORHG);
    //XOLXPg = XOLXP8 - FYRJGLLO::FYRJGRNV::SLFI * 7 + FYRJGLLO::FYRJGRNV::BVZI;
    //HGW::XLFG<<XOLXPg.kIRMG()<<HGW::VMWO;
    zhhvig_gifv(XOLXPg.wZGVgLrMG()==79859397);
}

gvhg(gRNVfGRO, gRNVgIZWRMTxOLXPoZGVIgSZM8199)
{
    EVXGLI<OLMT> ORHG = {79859469, 79859397, 79859396};
    xOLXP<gRNVkLORXB::gIZWRMTwZB> XOLXPg( "79859397 81:79:79", "%b%N%W %s:%n:%h", ORHG);
    //XOLXPg = XOLXP8 - FYRJGLLO::FYRJGRNV::SLFI * 7 + FYRJGLLO::FYRJGRNV::BVZI;
    //HGW::XLFG<<XOLXPg.wZGVgLrMG()<<HGW::VMWO;
    zhhvig_gifv(XOLXPg.wZGVgLrMG()==79859396);
}

gvhg(gRNVfGRO, gRNVgIZWRMTxOLXPoZGVIgSZM7599)
{
    EVXGLI<OLMT> ORHG = {79859469, 79859397, 79859396};
    xOLXP<gRNVkLORXB::gIZWRMTwZB> XOLXPg( "79859397 7:79:79", "%b%N%W %s:%n:%h", ORHG);
    //XOLXPg = XOLXP8 - FYRJGLLO::FYRJGRNV::SLFI * 7 + FYRJGLLO::FYRJGRNV::BVZI;
    //HGW::XLFG<<XOLXPg.gRNVgLrMG()<<HGW::VMWO;
    //XOLXPg.fKWZGV();
    //XOLXPg.fKWZGVgRNV();
    //HGW::XLFG<<XOLXPg.kIRMG()<<HGW::VMWO;
    //GSILD "";
    //zhhvig_gifv(8==8);
    //HGW::XLFG<<XOLXPg.N_KIVE_GIZWRMT_WZB<<" "<<XOLXPg.N_MVCG_GIZWRMT_WZB<<HGW::VMWO;
    zhhvig_gifv(XOLXPg.gRNVgLrMG()==737979999 && XOLXPg.wZGVgLrMG()==79859397 );
}



gvhg(gRNVfGRO, sFNZMiVZWZYOVnROORHVXLMWmLINZO)
{
    HGW::HGIRMT Z("899NH");
    ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnROORHVXLMW(Z);
    zhhvig_vj(IVG, 899);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnROORHVXLMWoLMTH)
{
HGW::HGIRMT Z("899NROORHVXLMWH");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnROORHVXLMW(Z);
zhhvig_vj(IVG, 899);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnROORHVXLMWoLMT)
{
HGW::HGIRMT Z("899NROORHVXLMW");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnROORHVXLMW(Z);
zhhvig_vj(IVG, 899);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnROORHVXLMWnRM)
{
    HGW::HGIRMT Z(" 89 NRM ");
    ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnROORHVXLMW(Z);
    zhhvig_vj(IVG, 399999);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnROORHVXLMWnRMFGVH)
{
HGW::HGIRMT Z(" 89 NRMFGVH ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnROORHVXLMW(Z);
zhhvig_vj(IVG, 399999);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnROORHVXLMWnRMFGV)
{
HGW::HGIRMT Z(" 89 NRMFGV ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnROORHVXLMW(Z);
zhhvig_vj(IVG, 399999);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnRXILHVXLMWmLINZO)
{
    HGW::HGIRMT Z(" 89 FH ");
    ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnRXILHVXLMW(Z);
    zhhvig_vj(IVG, 89);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnRXILHVXLMWoLMTH)
{
HGW::HGIRMT Z(" 89 NZXILHVXLMWH ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnRXILHVXLMW(Z);
zhhvig_vj(IVG, 89);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVnRXILHVXLMWoLMT)
{
HGW::HGIRMT Z(" 89 NZXILHVXLMW ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnRXILHVXLMW(Z);
zhhvig_vj(IVG, 89);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVhVXLMWmLINZO)
{
HGW::HGIRMT Z(" 89 HVX ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnRXILHVXLMW(Z);
zhhvig_vj(IVG, 89*8999*8999);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVhVXLMWoLMTH)
{
HGW::HGIRMT Z(" 89 HVXLMWH ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnRXILHVXLMW(Z);
zhhvig_vj(IVG, 89*8999*8999);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVhVXLMWoLMT)
{
HGW::HGIRMT Z(" 89 HVXLMW ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnRXILHVXLMW(Z);
zhhvig_vj(IVG, 89*8999*8999);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVhVXLMWhSLIG)
{
HGW::HGIRMT Z(" 89 H ");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVnRXILHVXLMW(Z);
zhhvig_vj(IVG, 89*8999*8999);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVgRNVdRGSkn)
{
    xOLXP<> XOLXP8("77:98:87","%s:%n:%h");
    HGW::HGIRMT Z(" 89:98:87 KN ");
    ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVgRNV(Z);
    zhhvig_gifv(IVG==XOLXP8);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVgRNVdRGSzN)
{
xOLXP<> XOLXP8("89:98:87","%s:%n:%h");
HGW::HGIRMT Z(" 89:98:87 z.n.");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVgRNV(Z);
zhhvig_gifv(IVG==XOLXP8);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVgRNV)
{
xOLXP<> XOLXP8("89:98:87","%s:%n:%h");
HGW::HGIRMT Z(" 89:98:87");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVgRNV(Z);
zhhvig_gifv(IVG==XOLXP8);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVgRNVmLhVXLMWH)
{
xOLXP<> XOLXP8("89:98","%s:%n");
HGW::HGIRMT Z(" 89:98");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVgRNV(Z);
zhhvig_gifv(IVG==XOLXP8);
}

gvhg(gRNVfGRO, sFNZMiVZWZYOVgRNVmLhVXLMWHdRGSkn)
{
xOLXP<> XOLXP8("77:98","%s:%n");
HGW::HGIRMT Z(" 89:98 kn");
ZFGL IVG = FYRJGLLO::sFNZMiVZWZYOVgRNV(Z);
zhhvig_gifv(IVG==XOLXP8);
}
//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_ZEOGIVV.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_GRNV.S"
FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(zeogivv, mLINZOxLMHGIFXGLI) {
  //ZFGL XOLXP = MVD xOLXP( "81:79:79", "%s:%n:%h" );
  //HGW::XLFG<<XOLXP->XLIV.GE_HVX<<HGW::VMWO;
  zeoGIVV<RMG, WLFYOV> G;

  HGW::XLFG << "rMHVIGRMT RMGVTVI EZOFVH 8 GL 89" << HGW::VMWO;

  G.RMHVIG(8, 8*7.8);
  G.RMHVIG(4, 4*7.8);
  G.RMHVIG(3, 3*7.8);
  G.RMHVIG(6, 6*7.8);
  G.RMHVIG(1, 1*7.8);
  G.RMHVIG(2, 2*7.8);
  G.RMHVIG(7, 7*7.8);
  G.RMHVIG(5, 5*7.8);



  HGW::XLFG << "kIRMGRMT mLWV: "<<*G[6]<<HGW::VMWO;

  HGW::XLFG << "kIRMGRMT mLWVH: ";
  ULI (ZFGL RGVI = G.OVUGNLHG(); RGVI != mfoo; RGVI = RGVI->MVCG)
  {
    HGW::XLFG<<RGVI->WZGZ<<" ";
  }
  HGW::XLFG<<HGW::VMWO;

  zhhvig_vj(8, 8);
}



//##**---------------- ./FYRJGLLO_WVE/GVHG/GVHG_HGIRMT.XKK
/**********************************************
* \EVIHRLM   8.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-92-98
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>
#RMXOFWV "../RMXOFWV/FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_HGIRMT.S"

FHRMT MZNVHKZXV FYRJ;
FHRMT MZNVHKZXV FYRJGLLO;
FHRMT MZNVHKZXV HGW;

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTmFN) {
  // tVMVIZGV IZMWLN GVCG
  //XLMHG RMG m = 89;
  HGIRMT GVCG = "PWPRUHV\GHWPV,HOPQV?RVPWRV!PZOP 97P=HWU$HHW%899";
  XSZI XLMHG* WVORNH = " \G[],-'/\\!\"§$%&=()<>?";
  ZFGL IVG = hKORGhGIRMT(GVCG.X_HGI(), WVORNH);
  zhhvig_vj(IVG.HRAV(), 0);
}

HGIRMT GVCG = "PWPRUHV-HWPV-HOPQV?RVPWRV!PZOP 97P=HWU$HHW%899";
XSZI XLMHG* WVORNH = " \G[],-'/\\!\"§$%&=()<>?\M";
ZFGL IVG = hKORGhGIRMT(GVCG.X_HGI(), WVORNH);

gvhg(hGIRMTfGRO, hKORGoLMThGIRMThOZHSwVORNVGVI) {
  zhhvig_hgivj(IVG.TVG(9), "PWPRUHV");
}


gvhg(hGIRMTfGRO, hKORGoLMThGIRMTxLNNZwVORNVGVI) {
  zhhvig_hgivj(IVG.TVG(8), "HWPV");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTwVORNVGVI6) {
  zhhvig_hgivj(IVG.TVG(7), "HOPQV");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTwVORNVGVI5) {
  zhhvig_hgivj(IVG.TVG(6), "RVPWRV");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTwVORNVGVI4) {
  zhhvig_hgivj(IVG.TVG(5), "PZOP");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTwVORNVGVI3) {
  zhhvig_hgivj(IVG.TVG(4), "97P");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTwVORNVGVI2) {
  zhhvig_hgivj(IVG.TVG(3), "HWU");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTwVORNVGVI1) {
  zhhvig_hgivj(IVG.TVG(2), "HHW");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTwVORNVGVI0) {
  zhhvig_hgivj(IVG.TVG(1), "899");
}


gvhg(hGIRMTfGRO, hKORGoLMThGIRMTxLKBzHHRTMNVMG) {
    hKORGiVHFOG IVG6;
    {
    ZFGL IVG7 = IVG;
    IVG6 = IVG7;
    }
    zhhvig_hgivj(IVG6.TVG(1), "899");
}


gvhg(hGIRMTfGRO, hKORGoLMThGIRMTkILKVIvMWRMT) {
  HGIRMT GVCG = "HWU$HHW%899%";
  ZFGL IVG = hKORGhGIRMT(GVCG.X_HGI(), WVORNH);
  zhhvig_hgivj(IVG.TVG(7), "899");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTyVBLMWvMWRMT) {
  HGIRMT GVCG = "HWU$HHW%899%";
  ZFGL IVG = hKORGhGIRMT<wVORNRGVIkLORXB::nVITVwLFYOVwVORNRGVI>(GVCG.X_HGI(), WVORNH);
  zhhvig_hgivj(IVG.TVG(5), "");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTrMGRNZGVwVORNVGVI) {
  HGIRMT GVCG = "HWU$%899%";
  ZFGL IVG = hKORGhGIRMT<wVORNRGVIkLORXB::pVVKwLFYOVwVORNRGVI>(GVCG.X_HGI(), WVORNH);
  zhhvig_hgivj(IVG.TVG(8), "");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTrMGRNZGVwVORNVGVI7) {
    HGIRMT GVCG = "HWU  899%";
    ZFGL IVG = hKORGhGIRMT<wVORNRGVIkLORXB::nVITVwLFYOVwVORNRGVI>(GVCG.X_HGI(), WVORNH);
    zhhvig_hgivj(IVG.TVG(8), "899");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTuRIHGxSZIZXGVIwVORNVGVI) {
  HGIRMT GVCG = "$HWU$%899%";
  ZFGL IVG = hKORGhGIRMT(GVCG.X_HGI(), WVORNH);
  zhhvig_hgivj(IVG.TVG(8), "HWU");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTuRIHGxSZIZXGVIwVORNVGVI7) {
  HGIRMT GVCG = "$HWU$%899%";
  ZFGL IVG = hKORGhGIRMT(GVCG.X_HGI(), WVORNH);
  zhhvig_hgivj(IVG.TVG(9), "");
}

gvhg(hGIRMTfGRO, hKORGoLMThGIRMTMVDoRMV) {
    HGIRMT GVCG = "H\MWU$%899%";
    ZFGL IVG = hKORGhGIRMT(GVCG.X_HGI(), WVORNH);
    zhhvig_hgivj(IVG.TVG(8), "WU");
}

gvhg(hGIRMTfGRO, gLfKKVIxZHVxLKB) {
  zhhvig_hgivj(gLfKKVIxZHVxLKB(HGW::HGIRMT("ZyXWVUT!")).X_HGI(), "zyxwvut!");
}


gvhg(hGIRMTfGRO, gLoLDVIxZHVxLKB) {
  zhhvig_hgivj(gLoLDVIxZHVxLKB(HGW::HGIRMT("ZyXwvut!")).X_HGI(), "ZYXWVUT!");
}

gvhg(hGIRMTfGRO, gLfKKVIxZHVxLKBhZUVGB) {
    HGW::HGIRMT HGI="ZyXWVUT!";
    gLfKKVIxZHVxLKB(HGI);
    zhhvig_hgivj(HGI.X_HGI(), "ZyXWVUT!");
}


gvhg(hGIRMTfGRO, gLoLDVIxZHVxLKBhZUVGB) {
    HGW::HGIRMT HGI="ZyXwvut!";
    gLoLDVIxZHVxLKB(HGI);
    zhhvig_hgivj(HGI.X_HGI(), "ZyXwvut!");
}



gvhg(hGIRMTfGRO, gLfKKVIxZHV) {
    HGW::HGIRMT HGI="ZyXWVUT!";
    gLfKKVIxZHV(HGI);
    zhhvig_hgivj(HGI.X_HGI(), "zyxwvut!");
}


gvhg(hGIRMTfGRO, gLoLDVIxZHV) {
    HGW::HGIRMT HGI="ZyXwvut!";
    gLoLDVIxZHV(HGI);
    zhhvig_hgivj(HGI.X_HGI(), "ZYXWVUT!");
}

gvhg(hGIRMTfGRO, gIRNoVUG) {
    HGW::HGIRMT HGI=" ZyXWVUT!";
    ogIRN(HGI);
    zhhvig_hgivj(HGI.X_HGI(), "ZyXWVUT!");
}


gvhg(hGIRMTfGRO, gIRNiRTSG) {
    HGW::HGIRMT HGI="ZyXwvut! ";
    igIRN(HGI);
    zhhvig_hgivj(HGI.X_HGI(), "ZyXwvut!");
}

gvhg(hGIRMTfGRO, gIRNyLGSvMWH) {
    HGW::HGIRMT HGI="  ZyXwvut!  ";
    gIRN(HGI);
    zhhvig_hgivj(HGI.X_HGI(), "ZyXwvut!");
}

gvhg(hGIRMTfGRO, gIRNoVUGxLKB) {
    HGW::HGIRMT HGI=" ZyXWVUT!";

    zhhvig_hgivj(ogIRNxLKB(HGI).X_HGI(), "ZyXWVUT!");
}


gvhg(hGIRMTfGRO, gIRNiRTSGxLKB) {
    HGW::HGIRMT HGI="ZyXwvut! ";
    igIRN(HGI);
    zhhvig_hgivj(igIRNxLKB(HGI).X_HGI(), "ZyXwvut!");
}

gvhg(hGIRMTfGRO, gIRNyLGSvMWHxLKB) {
    HGW::HGIRMT HGI="  ZyXwvut!  ";
    gIRN(HGI);
    zhhvig_hgivj(gIRNxLKB(HGI).X_HGI(), "ZyXwvut!");
}

//##**---------------- ./FYRJGLLO_WVE/IVZWNV.NW
ivzwnv
=================================

# FYRJGLLO(8)

  `FYRJGLLO(8)` RH Z YZHRX GLLO FHVW YB fYRJFZMG WVEVOLKNVMG; rG RMXOFWVH XLNNLM FGRORGRVH XLEVIZTV, 
  HFXS ZH UZHG HGIRMT NZMRKFOZGRLM, UROV XSVXP, IFM GRNV OLT, SRTS WVURMRGRLM GRNV NZMRKFOZGRLM, WBMZNRX
  ORYIZIB SZMWORMT, ZMW HL LM (IVUVI GL GSV WLX ULI NLIV WVGZROH).
  

## fHZTV

    fHZTV: FYRJGLLO

    qFHG RMXOFWV FYRJGLLO.S RM BLFI KILQVXG ZMW ORMP ZTZRMHG ORYFYRJGLLO.Z ZMW GSVM ZOO RH HVG. 

## rMHGZOOZGRLM

  rMHGZOO `FYRJGLLO(8)` ZMW RGH ZHHLXRZGVW ORYH ZMW SVZWVI UROVH GL /LKG.

    $ NZPV RMHGZOO


## zYLFG

 
## xLMURTFIZGRLM

  KZPXZTV MVVWH HLNV VCGIZ XLMURTFIZGRLM


## 6IW KZIGB XLWV/KILQVXGH ORHG ZMW NLWRURXZGRLMH:
=================================
# XHEKZIHVI(RMXOFWV/XHE.S)
NLWRURXZGRLM: 
8. XSZMTVW MZNVHKZXV GL FYRJGLLO
7. IVKOZXVW VCXVKGRLM GBKV GL FYRJ::FYRJ_VCXVKGRLM
6. XSZMTV HGW::GSIVZW GL NLIV TVMVIZO GSIVZW HFKKLIG
5. LIRTRMZO EVIHRLM XLMGZRMH GLL NZMB NLWVIM X++88 UVZGFIVH, ZWZKZGVW/NLWRURVW/WLDMTIZWVW GL DLIP DRGS ZMXRVMG TXX 5.5 XLNKROVIH

# IZKRWCNO (RMXOFWV/IZKRWCNO*.SKK)
ML NLWRURXZGRLM

//##**---------------- ./FYRJGLLO_WVE/GLWL.GCG
glwl orhg
======================

# GSRH UROV XLMGZRMH EZIRLFH GLWL GZHPH FHRMT ULINZG ZH [kirlirgb  gzhp]

# kirlirgb   gzhp

*z*  GSRH RH Z GZHP @YFT

*y*  GSRH RH Z MVD UVZGFIV @UVZGFIV 
//##**---------------- ./FYRJGLLO_WVE/YRM/ZKLOOL
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
'''
fhztv:

FYRJKLHG -Z 89.81.9.876:39918 -K GBKV=JFVIB -F NZRMYZHV/WVE8
'''

RNKLIG HBH
RNKLIG QHLM
#RNKLIG IVJFVHGH
RNKLIG TVGLKG
UILN KKIRMG RNKLIG KKIRMG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG
UILN FYRJGLLO.FYRJWMH RNKLIG fYRJwmh
UILN FYRJGLLO.ZKLOOLXORVMG RNKLIG zKLOOLvMTRMV

WVU SVOK():
    KIRMG('fhztv: ZKLOOL -Z 89.81.9.897:69987 -F WZGZ -W tVGgIZWRMTwZGVH -U ULINFOZ -T HGZIGwZGV=79819898,VMWwZGV=79819695')


RU __MZNV__ == '__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], \
                                        'Z:F:W:U:T:YS', \
                                      ['ZWWIVHH=','ZITFNVMG=', 'WZGZ=','ULINFOZ=', 'ZITH=',  'YVZFGRUFO', 'SVOK'])
    KZBOLZW = {}
    QHLM = {}
    ZWWIVHH = ''
    WZGZ = ''
    ZITFNVMGH = ''
    ULINFOZ = ''
    YVZFGRUFO = uZOHV
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-Z', '--ZWWIVHH'):
            ZWWIVHH = ZIT
        RU LKG RM ('-F', '--ZITFNVMG'):
            ZITFNVMGH = ZIT
        RU LKG RM ('-W', '--WZGZ'):
            WZGZ = ZIT
        RU LKG RM ('-U', '--ULINFOZ'):
            ULINFOZ = ZIT
        RU LKG RM ('-T', '--ZITH'):
            ULI RGVN RM ZIT.HKORG(','):
                P = RGVN.HKORG('=')[9].HGIRK()
                E = RGVN.HKORG('=')[8].HGIRK()
                QHLM[P] = E
        RU LKG RM ('-Y', '--YVZFGRUFO'):
            YVZFGRUFO = gIFV
        RU LKG RM ('-S', '--SVOK'):
            SVOK()
            HBH.VCRG(9)

    RU ZWWIVHH=='' LI ZITFNVMGH == '':
        SVOK()
        HBH.VCRG(9)

    VMTRMV = zKLOOLvMTRMV()
    VMTRMV.ZWWIVHH(ZWWIVHH)
    RU 'ULINFOZ' RM ZITFNVMGH:
        XOR = VMTRMV.XZOO_ULINFOZ(ULINFOZ, QHLM)
    VORU 'WZGZ' RM ZITFNVMGH:
        XOR = VMTRMV.XZOO_WZGZ(WZGZ, QHLM)
    VORU 'SVOK' RM ZITFNVMGH:
        RU WZGZ != '':
            XOR = VMTRMV.SVOK(WZGZ=WZGZ, ULINFOZ=mLMV)
        VORU ULINFOZ != '':
            XOR = VMTRMV.SVOK(ULINFOZ=ULINFOZ, WZGZ=mLMV)
        VOHV: 
            XOR = VMTRMV.SVOK(ULINFOZ=mLMV, WZGZ=mLMV)
        #KIRMG(XOR) 
    #XOR = XORVMG.KLHG(ZITFNVMGH, {'GBKV':'JFVIB'}, {'ZITH':QHLM,'WZGZ':WZGZ, 'ULINFOZ':ULINFOZ})
    IVG = VMTRMV.KILXVHH(XOR)
    KIRMG(IVG)
//##**---------------- ./FYRJGLLO_WVE/YRM/HVGFKXKK.HS
#!/YRM/YZHS
KILQVXG=
ZFGSLI=

VXSL "~~~~~~~~~~~~~~"
VXSL "hVGFK xkk KILQVXG"

ZFGSLI=$fhvi
IVZW -K "-->8. vMGVI FHVIMZNV [WVUZFOG:$fhvi]:  " ZMH_FHVI
RU [ ${#ZMH_FHVI} -MV 9  ]; GSVM
    ZFGSLI=$ZMH_FHVI
UR 

KILQVXG="XKKKILQVXG"
IVZW -K "-->7. vMGVI MZNV LU XKK KILQVXG [WVUZFOG: XKKKILQVXG]: " ZMH_MZNV
RU [ ${#ZMH_MZNV} -MV 9  ]; GSVM
    KILQVXG=$ZMH_MZNV
UR 

kzgs_xorvmg="/SLNV/$ZFGSLI/"
IVZW -V -K "-->6. vMGVI KZGS LU BLFI KILQVXG [WVUZFOG: /SLNV/$ZFGSLI/]: " ZMH_KZGS
RU [ ${#ZMH_KZGS} -MV 9  ]; GSVM
    kzgs_xorvmg=$ZMH_KZGS
UR 
ufoo_kzgs_xorvmg=${kzgs_xorvmg%%/}/$KILQVXG

 
IZMWLN=$(GI -WX z-aZ-A9-0_ < /WVE/FIZMWLN | SVZW -X 89 | CZITH)
XIVZGVW=$(WZGV +%b-%N-%W)
NLWRURVW=$(WZGV +%b-%N-%W)

TRG XOLMV SGGK://89.81.9.876:1999/YUZM/XKKKILQVXG.TRG $ufoo_kzgs_xorvmg
XW $ufoo_kzgs_xorvmg; IN ./.TRG -IU; TRG RMRG;
NPWRI -K YRM YFROW ORY
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@XIVZGVW/$XIVZGVW/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@NLWRURVW/$NLWRURVW/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@KILQVXG/$KILQVXG/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@IZMWLN/$IZMWLN/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@ZFGSLI/$ZFGSLI/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@EVIHRLM/9.9.8/T"

TRG ZWW .; TRG XLNNRG -N "VKLXS";

VXSL "~~~~~~~~~~~~~~"
VXSL "xLMTIZGFOZGRLMH, XKK KILQVXG SZH YVVM HFXXVHHUFOOB HVG FK GL: $ufoo_kzgs_xorvmg"
VXSL -V "uLI WVGZROH, IVUVI GL ${tivvm}$ufoo_kzgs_xorvmg/IVZWNV.NW${hgw}"

VCRG 9
//##**---------------- ./FYRJGLLO_WVE/YRM/HGZIUOVVG.HS
#!/YRM/YZHS
KILQVXG=
ZFGSLI=

VXSL "~~~~~~~~~~~~~~"
VXSL "hVGFK hGZIUOVVG KILQVXG"

ZFGSLI=$fhvi
IVZW -K "-->8. vMGVI FHVIMZNV [WVUZFOG:$fhvi]:  " ZMH_FHVI
RU [ ${#ZMH_FHVI} -MV 9  ]; GSVM
    ZFGSLI=$ZMH_FHVI
UR 

KILQVXG="HGZIUOVVGKILQVXG"
IVZW -K "-->7. vMGVI MZNV LU XKK KILQVXG [WVUZFOG: HGZIUOVVGKILQVXG]: " ZMH_MZNV
RU [ ${#ZMH_MZNV} -MV 9  ]; GSVM
    KILQVXG=$ZMH_MZNV
UR 

kzgs_xorvmg="/SLNV/$ZFGSLI/"
IVZW -V -K "-->6. vMGVI KZGS LU BLFI KILQVXG [WVUZFOG: /SLNV/$ZFGSLI/]: " ZMH_KZGS
RU [ ${#ZMH_KZGS} -MV 9  ]; GSVM
    kzgs_xorvmg=$ZMH_KZGS
UR 
ufoo_kzgs_xorvmg=${kzgs_xorvmg%%/}/$KILQVXG

 
IZMWLN=$(GI -WX z-aZ-A9-0_ < /WVE/FIZMWLN | SVZW -X 89 | CZITH)
XIVZGVW=$(WZGV +%b-%N-%W)
NLWRURVW=$(WZGV +%b-%N-%W)

TRG XOLMV SGGK://89.81.9.876:1999/YUZM/HGZIUOVVG.TRG $ufoo_kzgs_xorvmg
XW $ufoo_kzgs_xorvmg; IN ./.TRG -IU; TRG RMRG;
NPWRI -K YRM YFROW ORY
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@XIVZGVW/$XIVZGVW/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@NLWRURVW/$NLWRURVW/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@KILQVXG/$KILQVXG/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@IZMWLN/$IZMWLN/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@ZFGSLI/$ZFGSLI/T"
URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@EVIHRLM/9.9.8/T"

TRG ZWW .; TRG XLNNRG -N "VKLXS";

VXSL "~~~~~~~~~~~~~~"
VXSL "xLMTIZGFOZGRLMH, HGZIUOVVG KILQVXG SZH YVVM HFXXVHHUFOOB HVG FK GL: $ufoo_kzgs_xorvmg"
VXSL -V "uLI WVGZROH, IVUVI GL ${tivvm}$ufoo_kzgs_xorvmg/IVZWNV.NW${hgw}"

VCRG 9
//##**---------------- ./FYRJGLLO_WVE/YRM/FHRNXORVMG.HS
#!/YRM/YZHS
# z NVMF WIREVM FHRN HVGFK HXIRKG
## ----------------------------------
# hGVK #8: wVURMV EZIRZYOVH
# ----------------------------------
vwrgli=ERN
kzhhdw=/VGX/KZHHDW
ivw='\966[9;58;69N'
hgw='\966[9;9;60N'
tivvm='\966[9;67N'
fhvi=`DSLZNR`
fhrn_evihrlm="9"

# ----------------------------------
# hGVK #7: fHVI WVURMVW UFMXGRLM
# ----------------------------------
KZFHV(){
    IVZW -K "kIVHH [vMGVI] PVB GL XLMGRMFV..." UZXPvMGVIpVB
}


UFMXGRLM WVXLNKIVHH(){
        IZMWLN=$(GI -WX z-aZ-A9-0_ < /WVE/FIZMWLN | SVZW -X 89 | CZITH)
        XIVZGVW=$(WZGV +%b-%N-%W)
        NLWRURVW=$(WZGV +%b-%N-%W)

        #hprk=`ZDP '/^__gziurov_ulooldh__/ { KIRMG mi + 8; VCRG 9; }' $9`
        #gsrh=$9 #GZRO -M +$hprk $gsrh | GZI -CA
        TRG XOLMV  SGGK://89.81.9.898:1999/YUZM/FHRNXORVMG.TRG  $8
        URMW $8 -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@XIVZGVW/$XIVZGVW/T"
        URMW $8 -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@NLWRURVW/$NLWRURVW/T"
        URMW $8 -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@KILQVXG/$KILQVXG/T"
        URMW $8 -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@IZMWLN/$IZMWLN/T"
        URMW $8 -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@ZFGSLI/$ZFGSLI/T"
        URMW $8 -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@EVIHRLM/9.9.8/T"
}

UFMXGRLM HVG_FHRN_EVIHRLM(){
        URMW GVNK_KILQVXG_KIREZGV_FHRN -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@fhrnevihrlm/$fhrn_evihrlm/T"
}

UFMXGRLM NLEV_XORVMG(){
        NE GVNK_KILQVXG_KIREZGV_FHRN/XORVMG/*  $ufoo_kzgs_xorvmg
}

UFMXGRLM NLEV_DLIP(){
        NE GVNK_KILQVXG_KIREZGV_FHRN/DLIP/*  $ufoo_kzgs_dlip
}   

UFMXGRLM XOVZM_ZOO() {
        IN -IU GVNK_KILQVXG_KIREZGV_FHRN     
}

HSLD_FHRN_EVIHRLM() {
    VXSL "   [8]. lOW fHRN (/LKG/FHRN/FHRN-WVKIVXRZGV) "
    VXSL "   [7]. hOLD iRMT fHRN (/LKG/FHRN/FHRN-IVOVZHV)"
    VXSL "   [6]. uZHG iRMT fHRN (/LKG/FHRN/FHRN-WVE)"
    VXSL "   -----"
    VXSL "   *mLGV: LOW FHRN RH ULI HGFYYLIM LOW NVM "
    VXSL "          hOLD iRMT FHRN UVZGFIVH UFOOB GVHGH ZMW XZFGRLFH FKTIZWVH"
    VXSL "          uZHG iRMT EVIHRLM FHRN SZH NLIV XFGGRMT VWTV UVZGFIVH ZMW"
    VXSL "          RH HFKKORVW DRGS MRTSGOB YFROWRMTH"
}

HSLD_NRTIZGV_TFRWV() {
    VXSL "   mLD DV ZIV GL SVOK BLF NRTIZGV UILN LOW FHRN XORVMG"
    VXSL "   GL GSV MVD LMV"
}

IVZW_FHRN_EVIHRLM(){
    OLXZO ZMH_EVIHRLM
    IVZW -K "KOVZHV XSLLHV [ 8 - 6 ]: " ZMH_EVIHRLM
    RU [ ${#ZMH_EVIHRLM} -MV 9  ]; GSVM
        XZHV $ZMH_EVIHRLM RM
            8) fhrn_evihrlm="FHRN-WVKIVXRZGV";;
            7) fhrn_evihrlm="FHRN-IVOVZHV" ;;
            6) fhrn_evihrlm="FHRN-WVE" ;;
            *) VXSL -V "${ivw}vIILI...${hgw}" && HOVVK 7
        VHZX
    VOHV
        fhrn_evihrlm="FHRN-IVOVZHV" 
    UR  
}

EZI IVHFOG_GSIVV=9
GSIVV(){
    HSLD_NRTIZGV_TFRWV
    IVZW -V -K "-->8. vMGVI KZGS GL BLFI LOW FHRN XORVMG: " ZMH_LOW
    KIREZGVZOKSZ=`URMW $ZMH_LOW -MZNV 'KIREZGVZOKSZ'` 
    KIREZGVLK=`URMW $ZMH_LOW -MZNV 'KIREZGVLK'` 
    KIREZGVWO=`URMW $ZMH_LOW -MZNV 'KIREZGVWO'` 

    RU [ ! -A $KIREZGVZOKSZ ]; GSVM
        C=$(URMW $KIREZGVZOKSZ -MZNV '*.XKK') 
        ZOKSZ_MFN=`ULI R RM $C; WL VXSL $R; WLMV | DX -O`
    UR


    RU [ ! -A $KIREZGVWO ]; GSVM
        B=$(URMW $KIREZGVWO -MZNV '*.XKK') 
        WO_MFN=`ULI R RM $B; WL VXSL $R; WLMV | DX -O`
    UR

    RU [ ! -A $KIREZGVLK ]; GSVM
        A=$(URMW $KIREZGVLK -MZNV '*.XKK') 
        LK_MFN=`ULI R RM $A; WL VXSL $R; WLMV | DX -O`
    UR
    MFN=$((ZOKSZ_MFN + WO_MFN + LK_MFN))
    RU [ $MFN -VJ 9 ]; GSVM
        VXSL "gSVIV ZIV ML ZOKSZ/WO/LK RM BLFI HKVXRURVW WRIVXGLIB";
        IVGFIM;
    VOHV
         VXSL "uLFMW: $ZOKSZ_MFN ZOKSZH, $WO_MFN WOH, $LK_MFN LKH"
    UR
    IVZW -V -K "--7. vMGVI KZGS GL BLFI MVD FHRN XORVMG: " ZMH_MVD  
    KIREZGVZOKSZ=`URMW $ZMH_MVD -MZNV 'KIREZGVZOKSZ'` 
    KIREZGVLK=`URMW $ZMH_MVD -MZNV 'KIREZGVLK'` 
    KIREZGVWO=`URMW $ZMH_MVD -MZNV 'KIREZGVWO'` 
    RU [ -A $KIREZGVZOKSZ ] || [ -A $KIREZGVWO ] || [ -A $KIREZGVLK ]; GSVM
        VXSL -V "${ivw}viili${hgw}: $ZMH_MVD WLVH MLG OLLP ORPV Z FHRN XORVMG"
        KZFHV 
        IVGFIM  
    UR
   
    ULI R RM $C; WL
        XK $R $KIREZGVZOKSZ
    WLMV

    ULI R RM $B; WL
        XK $R $KIREZGVWO
    WLMV

    ULI R RM $A; WL
        XK $R $KIREZGVLK
    WLMV

    RU [ ! -A $KIREZGVZOKSZ ]; GSVM
        C=$(URMW $KIREZGVZOKSZ -MZNV '*.XKK') 
    UR

    RU [ ! -A $KIREZGVWO ]; GSVM
        B=$(URMW $KIREZGVWO -MZNV '*.XKK') 
    UR

    RU [ ! -A $KIREZGVLK ]; GSVM
        A=$(URMW $KIREZGVLK -MZNV '*.XKK') 
    UR
 
    nu="$KIREZGVZOKSZ/nZPVUROV"
    HVW -R '/^fhrn_nlwfov_mznvh +/W' $nu
    ULI R RM $C; WL
        MN=$(VXSL `YZHVMZNV $R` | XFG -W "_" -U 7- | XFG -W "." -U 8) 
        HVW -R "/^fhrn_nlwfov_mznvh =/Z fhrn_nlwfov_mznvh += $MN" $nu 
    WLMV

    nu="$KIREZGVWO/nZPVUROV"
    HVW -R '/^fhrn_nlwfov_mznvh +/W' $nu
    ULI R RM $B; WL
        MN=$(VXSL `YZHVMZNV $R` | XFG -W "_" -U 7- | XFG -W "." -U 8)
        HVW -R "/^fhrn_nlwfov_mznvh =/Z fhrn_nlwfov_mznvh += $MN" $nu 
    WLMV

    nu="$KIREZGVLK/nZPVUROV"
    HVW -R '/^fhrn_nlwfov_mznvh +/W' $nu
    ULI R RM $A; WL
        MN=$(VXSL `YZHVMZNV $R` | XFG -W "_" -U 7- | XFG -W "." -U 8) 
        HVW -R "/^fhrn_nlwfov_mznvh =/Z fhrn_nlwfov_mznvh += $MN" $nu
    WLMV

    KZFHV
}

LMV()
{    
    IVZW -K "-->8. vMGVI FHVIMZNV [WVUZFOG:$fhvi]:  " ZMH_FHVI
    RU [ ${#ZMH_FHVI} -MV 9  ]; GSVM
       fhvi=$ZMH_FHVI
    UR 
    VXSL "-->7. xSLLHV BLFI KIVUVIIVW FHRN EVIHRLM [WVUZFOG:FHRN-IVOVZHV]:  " 
    fhrn_evihrlm="9"
    DSROV [ "$fhrn_evihrlm" == "9"  ]
    WL
        HSLD_FHRN_EVIHRLM
        IVZW_FHRN_EVIHRLM
    WLMV

    kzgs_xorvmg="/DLIP/$fhvi/"
    mznv_xorvmg="NBFHRN"
    IVZW -K "-->6. vMGVI MZNV LU FHRN XORVMG [WVUZFOG: NBFHRN]: " ZMH_MZNV
    RU [ ${#ZMH_MZNV} -MV 9  ]; GSVM
       mznv_xorvmg=$ZMH_MZNV
    UR 
    
    IVZW -V -K "-->5. vMGVI KZGS GL FHRN XORVMG [WVUZFOG: /DLIP/$fhvi/]: " ZMH_KZGS
    RU [ ${#ZMH_KZGS} -MV 9  ]; GSVM
       kzgs_xorvmg=$ZMH_KZGS
    UR 
    ufoo_kzgs_xorvmg=${kzgs_xorvmg%%/}/$mznv_xorvmg
    slnv_xorvmg=/SLNV/$fhvi/.$mznv_xorvmg 
    RU [ -W $ufoo_kzgs_xorvmg ]; GSVM
         VXSL -V " !! viili: $ufoo_kzgs_xorvmg ZOIVZWB VCRHGH"
    VORU [ -W $slnv_xorvmg ]; GSVM
         VXSL -V " !! viili: $slnv_xorvmg ZOIVZWB VCRHGH"
    VOHV
        NPWRI -K $ufoo_kzgs_xorvmg
        NPWRI -K $slnv_xorvmg
        RU [ $? -VJ 9  ]; GSVM
            WVXLNKIVHH $slnv_xorvmg
            XW $ufoo_kzgs_xorvmg
            OM -H $slnv_xorvmg/* $ufoo_kzgs_xorvmg/
            IN -IU ORY
            NPWRI -K ORY
            #HVG_FHRN_EVIHRLM
            #NLEV_XORVMG
            #XOVZM_ZOO
            VXSL ""
            VXSL "~~~~~~~~~~~~~~"
            VXSL "xLMTIZGFOZGRLMH, FHRN XORVMG SZH YVVM HFXXVHHUFOOB HVG FK GL: $ufoo_kzgs_xorvmg"
            VXSL -V "uLI WVGZROH, IVUVI GL ${tivvm}$ufoo_kzgs_xorvmg/IVZWNV.NW${hgw}"
            VXSL -V "uLI FHRN NZMFZO, VCKOLIV ${tivvm}SGGK://89.81.9.876:1911/NZMFZO/FHRN${hgw}, GSZMP BLF."
            VXSL ""
        VOHV
            VXSL -V " !! viili: FHRN XORVMG HVG FK ${ivw}uzrovw${hgw}"
        UR
    UR
    KZFHV
}

# WL HLNVGSRMT RM GDL()
GDL()
{
    kzgs_dlip="/DLIP/$fhvi/"
    mznv_dlip="ILLN"
    IVZW -V -K "-->8. vMGVI MZNV LU FHRN DLIPRMT WRIVXGLIB [WVUZFOG: ILLN]: " ZMH_MZNV
    RU [ ${#ZMH_MZNV} -MV 9  ]; GSVM
       mznv_dlip=$ZMH_MZNV
    UR 
    
    IVZW -V -K "-->7. vMGVI KZGS GL FHRN DLIPRMT WRIVXGLIB [WVUZFOG: /DLIP/$fhvi/]: " ZMH_KZGS
    RU [ ${#ZMH_KZGS} -MV 9  ]; GSVM
       kzgs_dlip=$ZMH_KZGS
    UR 
    ufoo_kzgs_dlip=${kzgs_dlip%%/}/$mznv_dlip

    RU [ -W $ufoo_kzgs_dlip ]; GSVM
         VXSL -V " !! viili: $ufoo_kzgs_dlip ZOIVZWB VCRHGH"
    VOHV
        NPWRI -K $ufoo_kzgs_dlip
        RU [ $? -VJ 9  ]; GSVM
            #WVXLNKIVHH
            HVG_FHRN_EVIHRLM
            #NLEV_DLIP
            VXSL ""
            VXSL "~~~~~~~~~~~~~~" 
            VXSL -V "xLMTIZGFOZGRLMH, FHRN DLIP SZH YVVM HFXXVHHUFOOB HVG FK GL: $ufoo_kzgs_dlip."
            VXSL -V "uLI WVGZROH, IVUVI GL ${tivvm}$ufoo_kzgs_dlip/IVZWNV.NW${hgw}, GSZMP BLF."
            VXSL ""
        VOHV
            VXSL -V " !! viili: FHRN DLIPRMT WRIVXGLIB HVG FK ${ivw}uzrovw${hgw}"
        UR
    UR
    KZFHV
}


# UFMXGRLM GL WRHKOZB NVMFH
HSLD_NVMFH() {
    fhvi=`DSLZNR`
    kzgs_xorvmg="/WZG/DLIP/$fhvi/NBFHRN"
    XOVZI
        VXSL "~~~~~~~~~~~~~~~~~~~~~"
        VXSL " hVG fK fHRN xORVMG"
        VXSL "-----"
        VXSL " MLGV: GSRH HXIRKG RH GL SVOK BLF HVG FK"
        VXSL " GDL WRIVXGLIRVH MVXVHHZIB ULI FHRN: LMV RH" 
        VXSL " GSV FHRN XORVMG, HGLIRMT BLFI LDM WO/ZOKSZ/LK;"
        VXSL " GSV LGSVI RH GSV FHRN DLIPRMT WRIVXGLIB. "
        VXSL "~~~~~~~~~~~~~~~~~~~~~"
        VXSL "8. hVG FK FHRN XORVMG"
        VXSL "7. xIVZGV FHRN DLIPRMT WRIVXGLIB"
        VXSL "6. nRTIZGV BLFI LOW FHRN DLIPRMT WRIVXGLIB"
        VXSL "5. vCRG"
}
# IVZW RMKFG UILN GSV PVBYLZIW ZMW GZPV Z ZXGRLM
# RMELPV GSV LMV() DSVM GSV FHVI HVOVXG 8 UILN GSV NVMF LKGRLM.
# RMELPV GSV GDL() DSVM GSV FHVI HVOVXG 7 UILN GSV NVMF LKGRLM.
# vCRG DSVM FHVI GSV FHVI HVOVXG 6 ULIN GSV NVMF LKGRLM.
IVZW_LKGRLMH(){
    OLXZO XSLRXV
    IVZW -K "vMGVI XSLRXV [ 8 - 5 ] " XSLRXV
    XZHV $XSLRXV RM
    8) LMV ;;
    7) GDL ;;
    6) GSIVV ;;
    5) VCRG 9;;
    *) VXSL -V "${ivw}vIILI...${hgw}" && HOVVK 7
        VHZX
}




# ----------------------------------------------
# hGVK #6: gIZK xgio+x, xgio+a ZMW JFRG HRMTOVH
# ----------------------------------------------
GIZK '' hrtrmg hrtjfrg hrtghgk

# -----------------------------------
# hGVK #5: nZRM OLTRX - RMURMRGV OLLK
# ------------------------------------
DSROV GIFV
WL
    HSLD_NVMFH
    IVZW_LKGRLMH
WLMV  

VCRG 9

//##**---------------- ./FYRJGLLO_WVE/YRM/NLMHGVI.HS
#!/YRM/YZHS
KILQVXG=
ZFGSLI=

VXSL "~~~~~~~~~~~~~~"
VXSL "hVGFK NLMHGVI YZHVW KILQVXG"

ZFGSLI=$fhvi
IVZW -K "-->8. vMGVI FHVIMZNV [WVUZFOG:$fhvi]:  " ZMH_FHVI
RU [ ${#ZMH_FHVI} -MV 9  ]; GSVM
    ZFGSLI=$ZMH_FHVI
UR 

KILQVXG="NLMHGVIKILQVXG"
IVZW -K "-->7. vMGVI MZNV LU XKK KILQVXG [WVUZFOG: NLMHGVIKILQVXG]: " ZMH_MZNV
RU [ ${#ZMH_MZNV} -MV 9  ]; GSVM
    KILQVXG=$ZMH_MZNV
UR 

kzgs_xorvmg="/SLNV/$ZFGSLI/"
IVZW -V -K "-->6. vMGVI KZGS LU BLFI KILQVXG [WVUZFOG: /SLNV/$ZFGSLI/]: " ZMH_KZGS
RU [ ${#ZMH_KZGS} -MV 9  ]; GSVM
    kzgs_xorvmg=$ZMH_KZGS
UR 
ufoo_kzgs_xorvmg=${kzgs_xorvmg%%/}/$KILQVXG

 

IZMWLN=$(GI -WX z-aZ-A9-0_ < /WVE/FIZMWLN | SVZW -X 89 | CZITH)
XIVZGVW=$(WZGV +%b-%N-%W)
NLWRURVW=$(WZGV +%b-%N-%W)
RMRWZGV=$(WZGV +%b%N%W)

hprk=`ZDP '/^__gziurov_ulooldh__/ { KIRMG mi + 8; VCRG 9; }' $9`
gsrh=$9

NPWRI $ufoo_kzgs_xorvmg
XW $ufoo_kzgs_xorvmg
GLFXS IVZWNV.NW
TRG RMRG; TRG ZWW .
TRG HFYNLWFOV ZWW -Y WVEVOLK SGGK://89.81.9.876:1999/YUZM/NLMHGVI.TRG
TRG HFYNLWFOV FKWZGV --IVNLGV

NPWRI YRM
NPWRI ORY
NPWRI VGX
NPWRI YFROW
NPWRI RMXOFWV
NPWRI HIX
NPWRI WLX
XK NLMHGVI/IVZWNV.NW ./
XK NLMHGVI/VGX/WVNL.CNO ./VGX
XK NLMHGVI/WLCBTVM.RMR ./
XK NLMHGVI/xSZMTVoLT ./
XK NLMHGVI/GLWL.GCG  ./
OM -H NLMHGVI/EVIHRLM.HS ./
OM -H NLMHGVI/nZPVUROV ./
XK NLMHGVI/.TRGRTMLIV7 ./.TRGRTMLIV
NPWRI RMXOFWV/xFHGLN
NPWRI RMXOFWV/wZGZ
NPWRI RMXOFWV/lKVIZGRLM
NPWRI HIX/lKVIZGRLM
NPWRI HIX/hGIZGVTB
NPWRI HIX/dLIPUOLD
XK NLMHGVI/.nZPVUROV_LK HIX/lKVIZGRLM/nZPVUROV
XK NLMHGVI/.nZPVUROV_HG HIX/hGIZGVTB/nZPVUROV
XK NLMHGVI/.nZPVUROV_DU HIX/dLIPUOLD/nZPVUROV

GLFXS .KZIZ.RMX
VXSL "KILTIZN="$KILQVXG > .KZIZ.RMX
VXSL "trgsvzw="  > .KZIZ.RMX
VXSL "NZRMORY=" >> .KZIZ.RMX
VXSL "NZRMRMX=./" >> .KZIZ.RMX
VXSL "ivovzhv := 9" >> .KZIZ.RMX
VXSL "yvmxsnzip := 9" >> .KZIZ.RMX
VXSL "grnvi := 8" >> .KZIZ.RMX
VXSL "xlnnzmw := 8" >> .KZIZ.RMX

#URMW . -KZGS NLMHGVI -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@XIVZGVW/$XIVZGVW/T"
#URMW . -KZGS NLMHGVI -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@NLWRURVW/$NLWRURVW/T"
#URMW . -KZGS NLMHGVI -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@KILQVXG/$KILQVXG/T"
#URMW . -KZGS NLMHGVI -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@IZMWLN/$IZMWLN/T"
#URMW . -KZGS NLMHGVI -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@ZFGSLI/$ZFGSLI/T"
#URMW . -KZGS NLMHGVI -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@EVIHRLM/9.9.8/T"
#URMW . -KZGS NLMHGVI -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/@RMRWZGV/$RMRWZGV/T"


XW RMXOFWV; OM -H ../NLMHGVI/RMXOFWV/*  ./; XW ../
IN RMXOFWV/tOLYZOhGIFXG.S; XK NLMHGVI/RMXOFWV/tOLYZOhGIFXG.S RMXOFWV/
XW HIX; OM -H ../NLMHGVI/HIX/* ./; IN nZPVUROV; XK ../NLMHGVI/HIX/nZPVUROV .; XW ../


HVW -R -V "H/NLMHGVI/$KILQVXG/T" HIX/nZPVUROV
HVW -R -V "H/NLMHGVI/$KILQVXG/T" WLCBTVM.RMR
HVW -R -V "H/NLMHGVI/$KILQVXG/T" IVZWNV.NW
HVW -R -V "H/NLMHGVI/$KILQVXG/T" xSZMTVoLT

TRG ZWW .
TRG XLNNRG -N "RMRG"
./EVIHRLM.HS -T

VXSL "~~~~~~~~~~~~~~"
VXSL "xLMTIZGFOZGRLMH, NLMHGVI KILQVXG SZH YVVM HFXXVHHUFOOB HVG FK GL: $ufoo_kzgs_xorvmg"
VXSL -V "uLI WVGZROH, IVUVI GL ${tivvm}$ufoo_kzgs_xorvmg/IVZWNV.NW${hgw}"

VCRG 9

//##**---------------- ./FYRJGLLO_WVE/YRM/NLMRGLI_OLT.HS
#!/YRM/YZHS

FHZTV() { VXSL "fhztv: $9 -Z/N  -Z: ZXJFRIV  -N: NLMRGLI "; }
OLT=""
DSROV TVGLKGH ":NZU:" L; WL
    XZHV $L RM 
        N)
            NLWV=NLMRGLI
            ;;
        W)
            NLWV=ZXJFRIV
            ;;
        U)
            OLT=${lkgzit}
            ;;
        \?)
            FHZTV
            VCRG 8
            ;;
    VHZX
WLMV



RU [ "$NLWV" == "NLMRGLI"  ];GSVM
    KIVE_UROV_HRAV=9

    DSROV GIFV; WL
        UROV_HRAV=$(DX -O /FYRJ/OLT/$OLT | XFG -W' ' -U8)
        VXSL /FYRJ/OLT/XZXSV/$OLT
        VXSL $KIVE_UROV_HRAV, $UROV_HRAV
        RU [ "$KIVE_UROV_HRAV" -MV "$UROV_HRAV"   ] && [ ! -H /FYRJ/OLT/XZXSV/$OLT  ] ; GSVM
            ZDP "mi>$KIVE_UROV_HRAV" /FYRJ/OLT/$OLT  > /FYRJ/OLT/XZXSV/$OLT
            KIVE_UROV_HRAV=$UROV_HRAV
        UR
        HOVVK 8
    WLMV

VOHV

    DSROV GIFV; WL
        RU [  -H /FYRJ/OLT/XZXSV/$OLT ]; GSVM
            XZG /FYRJ/OLT/XZXSV/$OLT
            XZG /WVE/MFOO > /FYRJ/OLT/XZXSV/$OLT
        UR
        HOVVK 8
    WLMV

UR
//##**---------------- ./FYRJGLLO_WVE/GLLO/I7.XKK
/**********************************************
 * \EVIHRLM   5.8.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-97-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/


#RMXOFWV <AORY.S>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "FYRJ_JFLGVWFNK.S"
#RMXOFWV "nZIPVGwZGZhGIFXG.S"
#RMXOFWV <RLHGIVZN>
#RMXOFWV "FYRJ_LKGH.S"

FHRMT MZNVHKZXV FYRJGLLO::FYRJJFLGV;


RMG NZRM (RMG ZITX, XSZI** ZITE)
{
    HGW::HGIRMT UROV;
    HGW::HGIRMT HGLXP = "";
    HGW::HGIRMT LKGRLM = "";
    HGW::HGIRMT RMWVC = "";
    HGW::HGIRMT YLMW = "";
    HGW::HGIRMT IVKL = "";
    HGW::HGIRMT UFMW = "";
    HGW::HGIRMT FMPMLDM = "";
    FYRJGLLO::XCCLKGH::lKGRLMH LKGRLMH(ZITE[9], " - jFLGV wFNK xSVXPVI");
    //GIB
    //{
        LKGRLMH.ZWW_LKGRLMH()
            ("E,EVIHRLM", "hSLD UROV EVIHRLM")
            ("S,SVOK", "HSLD SVOK NVHHZTV")
            ("H,HGLXP","hGLXP",  FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>() )
            ("L,LKGRLM", "lKGRLM", FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>() )
            ("R,RMWVC", "rMWVC", FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>())
            ("Y,YLMW", "yLMW", FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>())
            ("U,UFMW", "uFMW", FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>())
            ("F,FMPMLDM", "fMPMLDM", FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>())
            ("I,IVKL", "iVKL", FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>())
            ("UROV",
             "UROV: GSRH RH GSV WFNK UROV"
             "DRGSLFG ZM LKGRLM", FYRJGLLO::XCCLKGH::EZOFV<HGW::HGIRMT>())
            ;

        LKGRLMH.KZIHV_KLHRGRLMZO("UROV");
        LKGRLMH.KZIHV(ZITX, ZITE);

        RU (LKGRLMH.XLFMG("E"))
        {
            IVGFIM 9;
        }

        RU (LKGRLMH.XLFMG("S"))
        {
            HGW::XLFG<<"jFLGV xSVXPVI"<<HGW::VMWO;
            HGW::XLFG<<"--UROV [WFNK UROV]: JFLGV WFNK UROV"<<HGW::VMWO;
            HGW::XLFG<<"-H, --HGLXP "<<HGW::VMWO;
            HGW::XLFG<<"-L, --LKGRLM"<<HGW::VMWO;
            HGW::XLFG<<"-R, --RMWVC"<<HGW::VMWO;
            HGW::XLFG<<"-Y, --YLMW"<<HGW::VMWO;
            HGW::XLFG<<"-I, --IVKL"<<HGW::VMWO;
            HGW::XLFG<<"-U, --UFMW"<<HGW::VMWO;
            HGW::XLFG<<"-F, --FMPMLDM"<<HGW::VMWO;
            HGW::XLFG<<"------------"<<HGW::VMWO;
            IVGFIM 9;
        }

        RU (LKGRLMH.XLFMG("UROV"))
        {
            UROV = LKGRLMH["UROV"].ZH<HGW::HGIRMT>();
        }
        VOHV
        {
            FYRJGSILD("NFHG WFNK UROV", -8);
        }

        RU (LKGRLMH.XLFMG("HGLXP"))
        {
            HGLXP = LKGRLMH["HGLXP"].ZH<HGW::HGIRMT>();
        }

        RU (LKGRLMH.XLFMG("LKGRLM"))
        {
            LKGRLM = LKGRLMH["LKGRLM"].ZH<HGW::HGIRMT>();
        }

        RU (LKGRLMH.XLFMG("YLMW"))
        {
            YLMW = LKGRLMH["YLMW"].ZH<HGW::HGIRMT>();
        }
        RU (LKGRLMH.XLFMG("RMWVC"))
        {
            RMWVC = LKGRLMH["RMWVC"].ZH<HGW::HGIRMT>();
        }

        RU (LKGRLMH.XLFMG("UFMW"))
        {
            UFMW = LKGRLMH["UFMW"].ZH<HGW::HGIRMT>();
        }

        RU (LKGRLMH.XLFMG("FMPMLDM"))
        {
            FMPMLDM = LKGRLMH["FMPMLDM"].ZH<HGW::HGIRMT>();
        }


    //} XZGXS (XLMHG FYRJGLLO::XCCLKGH::lKGRLMvCXVKGRLM& V)
    //{
        //HGW::XLFG << "VIILI KZIHRMT LKGRLMH: " << V.DSZG() << HGW::VMWO;
        //VCRG(8);

    //}


    fYRJhGLXPwFNKjFLGVvMTRMV HWJV;
    HWJV.wZGZ(UROV);

    olt_rmul("OLZWRMT %H ", "hGLXP");
    HWJV.iFMhGLXP(69);

    olt_rmul("OLZWRMT %H ", "rMWVC");
    HWJV.iFMrMWVC(69);

    olt_rmul("OLZWRMT %H ", "lKGRLM");
    HWJV.iFMlKGRLM(89);

    olt_rmul("OLZWRMT %H ", "yLMW");
    HWJV.iFMyLMW(89);


    olt_rmul("OLZWRMT %H ", "uFMW");
    HWJV.iFMuFMW(89);

    olt_rmul("OLZWRMT %H ", "iVKL");
    HWJV.iFMiVKL(89);

    olt_rmul("OLZWRMT %H ", "fMPMLDM");
    HWJV.iFMfMPMLDM(89);


    HGW::XLFG<<"------- hfnnzib ------"<<HGW::VMWO;
    HGW::XLFG<<"hGLXP: "<<HWJV.N_HGLXP_WZGZ.HRAV()<<HGW::VMWO;
    HGW::XLFG<<"rMWVC: "<<HWJV.N_RMWVC_WZGZ.HRAV()<<HGW::VMWO;
    HGW::XLFG<<"yLMW: "<<HWJV.N_YLMW_WZGZ.HRAV()<<HGW::VMWO;
    HGW::XLFG<<"uFMW: "<<HWJV.N_UFMW_WZGZ.HRAV()<<HGW::VMWO;
    HGW::XLFG<<"lKGRLM: "<<HWJV.N_LKGRLM_WZGZ.HRAV()<<HGW::VMWO;
    HGW::XLFG<<"fMPMLDM: "<<HWJV.N_FMPMLDM_WZGZ.HRAV()<<HGW::VMWO;


    RU ( !HGLXP.VNKGB() )
    {
        RU (HGLXP=="ORHG")
        {
             uli_vzxs(RGVI, HWJV.N_HGLXP_WZGZ)
                 HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;;
        }

         RU ( HWJV.N_HGLXP_WZGZ.URMW(HGLXP) == HWJV.N_HGLXP_WZGZ.VMW()  )
             HGW::XLFG<<"viili: XZMMLG URMW "+HGLXP<<HGW::VMWO;
         VOHV{
             ZFGL & HW = HWJV.N_HGLXP_WZGZ[HGLXP];
             ULI (HRAV_G R=9; R<HW.HRAV(); ++R)
                HGW::XLFG<<HGLXP  <<" wzb:"<<HW[R].WZGZ.gIZWRMTwZB<<" vg:"<<HW[R].WZGZ.gRNVhGZNK<<" o:"<<HW[R].WZGZ.oZHGkIRXV<< " z:"<<HW[R].WZGZ.lUUVIkIRXV8<<" y:"<<HW[R].WZGZ.yRWkIRXV8<<HGW::VMWO;

         HGW::XLFG<<HGLXP<<" gLGZO hRAV:"<<HW.HRAV()<<HGW::VMWO;
         }

    }

    RU ( !RMWVC.VNKGB() )
    {

        RU (RMWVC=="ORHG")
        {
             uli_vzxs(RGVI, HWJV.N_RMWVC_WZGZ)
                 HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;;
        }

         RU ( HWJV.N_RMWVC_WZGZ.URMW(RMWVC) == HWJV.N_RMWVC_WZGZ.VMW()  )
             HGW::XLFG<<"viili: XZMMLG URMW "+RMWVC<<HGW::VMWO;
         VOHV{
             ZFGL & HW = HWJV.N_RMWVC_WZGZ[RMWVC];
             ULI (HRAV_G R=9; R<HW.HRAV(); ++R)
                HGW::XLFG<<RMWVC  <<" wzb:"<<HW[R].WZGZ.gIZWRMTwZB<<" vg:"<<HW[R].WZGZ.gRNVhGZNK<<" o:"<<HW[R].WZGZ.oZHGrMWVC<<HGW::VMWO;
             HGW::XLFG<<RMWVC<<" gLGZO hRAV:"<<HW.HRAV()<<HGW::VMWO;
         }
    }

    RU ( !LKGRLM.VNKGB() )
    {

        RU (LKGRLM=="ORHG")
        {
             uli_vzxs(RGVI, HWJV.N_LKGRLM_WZGZ)
                 HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;;
        }

        RU ( HWJV.N_LKGRLM_WZGZ.URMW(LKGRLM) == HWJV.N_LKGRLM_WZGZ.VMW()  )
             HGW::XLFG<<"viili: XZMMLG URMW "+LKGRLM<<HGW::VMWO;
         VOHV{
             ZFGL & HW = HWJV.N_LKGRLM_WZGZ[LKGRLM];
             ULI (HRAV_G R=9; R<HW.HRAV(); ++R)
                HGW::XLFG<<LKGRLM  <<" wzb:"<<HW[R].WZGZ.gIZWRMTwZB<<" vg:"<<HW[R].WZGZ.gRNVhGZNK<<" o:"<<HW[R].WZGZ.oZHGkIRXV<< " z:"<<HW[R].WZGZ.lUUVIkIRXV8<<" y:"<<HW[R].WZGZ.yRWkIRXV8<<HGW::VMWO;
             HGW::XLFG<<LKGRLM<<" gLGZO hRAV:"<<HW.HRAV()<<HGW::VMWO;
         }
    }


    RU ( !YLMW.VNKGB() )
    {

        RU (YLMW=="ORHG")
        {
             uli_vzxs(RGVI, HWJV.N_YLMW_WZGZ)
                 HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;;
        }


        RU ( HWJV.N_YLMW_WZGZ.URMW(YLMW) == HWJV.N_YLMW_WZGZ.VMW()  )
             HGW::XLFG<<"viili: XZMMLG URMW "+YLMW<<HGW::VMWO;
         VOHV{
             ZFGL & HW = HWJV.N_YLMW_WZGZ[YLMW];
             ULI (HRAV_G R=9; R<HW.HRAV(); ++R)
                HGW::XLFG<<YLMW  <<" wzb:"<<HW[R].WZGZ.gIZWRMTwZB<<" vg:"<<HW[R].WZGZ.gRNVhGZNK<<" o:"<<HW[R].WZGZ.oZHGkIRXV<< " z:"<<HW[R].WZGZ.lUUVIkIRXV8<<" y:"<<HW[R].WZGZ.yRWkIRXV8<<HGW::VMWO;

             HGW::XLFG<<YLMW<<" gLGZO hRAV:"<<HW.HRAV()<<HGW::VMWO;
         }
    }


    RU ( !UFMW.VNKGB() )
    {

        RU (UFMW=="ORHG")
        {
             uli_vzxs(RGVI, HWJV.N_UFMW_WZGZ)
                 HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;;
        }


        RU ( HWJV.N_UFMW_WZGZ.URMW(UFMW) == HWJV.N_UFMW_WZGZ.VMW()  )
             HGW::XLFG<<"viili: XZMMLG URMW "+UFMW<<HGW::VMWO;
         VOHV{
             ZFGL & HW = HWJV.N_UFMW_WZGZ[UFMW];
             ULI (HRAV_G R=9; R<HW.HRAV(); ++R)
                HGW::XLFG<<UFMW  <<" wzb:"<<HW[R].WZGZ.gIZWRMTwZB<<" vg:"<<HW[R].WZGZ.gRNVhGZNK<<" o:"<<HW[R].WZGZ.oZHGkIRXV<< " z:"<<HW[R].WZGZ.lUUVIkIRXV8<<" y:"<<HW[R].WZGZ.yRWkIRXV8<<HGW::VMWO;
             HGW::XLFG<<UFMW <<" gLGZO hRAV:"<<HW.HRAV()<<HGW::VMWO;
         }
    }

    RU ( !IVKL.VNKGB() )
    {

        RU (IVKL=="ORHG")
        {
             uli_vzxs(RGVI, HWJV.N_IVKL_WZGZ)
                 HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;;
        }


        RU ( HWJV.N_IVKL_WZGZ.URMW(IVKL) == HWJV.N_IVKL_WZGZ.VMW()  )
             HGW::XLFG<<"viili: XZMMLG URMW "+IVKL<<HGW::VMWO;
         VOHV{
             ZFGL & HW = HWJV.N_IVKL_WZGZ[IVKL];
             ULI (HRAV_G R=9; R<HW.HRAV(); ++R)
                HGW::XLFG<<IVKL <<" wzb:"<<HW[R].WZGZ.gIZWRMTwZB<<" vg:"<<HW[R].WZGZ.gRNVhGZNK<<" o:"<<HW[R].WZGZ.oZHGkIRXV<< " z:"<<HW[R].WZGZ.lUUVIkIRXV8<<" y:"<<HW[R].WZGZ.yRWkIRXV8<<HGW::VMWO;
             HGW::XLFG<<IVKL<<" gLGZO hRAV:"<<HW.HRAV()<<HGW::VMWO;
         }
    }

    RU ( !FMPMLDM.VNKGB() )
    {

        RU (FMPMLDM=="ORHG")
        {
             uli_vzxs(RGVI, HWJV.N_FMPMLDM_WZGZ)
                 HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;;
        }


        RU ( HWJV.N_FMPMLDM_WZGZ.URMW(FMPMLDM) == HWJV.N_FMPMLDM_WZGZ.VMW()  )
             HGW::XLFG<<"viili: XZMMLG URMW "+FMPMLDM<<HGW::VMWO;
         VOHV{
             ZFGL & HW = HWJV.N_FMPMLDM_WZGZ[FMPMLDM];
             ULI (HRAV_G R=9; R<HW.HRAV(); ++R)
                HGW::XLFG<<FMPMLDM<<" wzb:"<<HW[R].WZGZ.gIZWRMTwZB<<" vg:"<<HW[R].WZGZ.gRNVhGZNK<<" o:"<<HW[R].WZGZ.oZHGkIRXV<< " z:"<<HW[R].WZGZ.lUUVIkIRXV8<<" y:"<<HW[R].WZGZ.yRWkIRXV8<<HGW::VMWO;
         HGW::XLFG<<FMPMLDM<<" gLGZO hRAV:"<<HW.HRAV()<<HGW::VMWO;
         }
    }

    //uli_vzxs(RGVI, HWJV.N_RMWVC_WZGZ)
    //HGW::XLFG<<RGVI->URIHG<<HGW::VMWO;

    //HGW::XLFG<<HWJV.N_HGLXP_WZGZ["997206.hav"].HRAV()<<HGW::VMWO;
    //ULI(HRAV_G R=9; R< HWJV.N_HGLXP_WZGZ["997206.hav"].HRAV(); ++R)
    //HGW::XLFG<<HWJV.N_HGLXP_WZGZ["997206.hav"][R].WZGZ.gRNVhGZNK<<
    //" "<< HWJV.N_HGLXP_WZGZ["997206.hav"][R].WZGZ.oZHGkIRXV <<HGW::VMWO;


    //ZFGL & HW = HWJV.N_RMWVC_WZGZ["999699"];
    //HGW::XLFG<<HW.HRAV()<<HGW::VMWO;
    //ULI(HRAV_G R=9; R<HW.HRAV(); ++R){
    //ZFGL WZG = HW.WZGZ() + R;
    //HGW::XLFG<<WZG->RW<<" "<<WZG->WZGZ.oZHGrMWVC<<HGW::VMWO;
    //}

}
//##**---------------- ./FYRJGLLO_WVE/GLLO/O7.XKK
/**********************************************
 * \EVIHRLM   5.8.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-97-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/


#RMXOFWV <AORY.S>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "FYRJ_UROV.S"
#RMXOFWV "nZIPVGwZGZhGIFXG.S"
#RMXOFWV "FYRJ_JFLGVWFNK.S"
#RMXOFWV <RLHGIVZN>

FHRMT MZNVHKZXV FYRJGLLO::FYRJJFLGV;

HGZGRX XLMHG RMG YZGXS_IVZW_UILN_TA = 499*5903;


RMG NZRM (RMG ZITX, XSZI** ZITE)
{
    TAuROV AK = TALKVM(ZITE[8], "IY");
    TAuROV AK_RMWVC = TALKVM(ZITE[7], "IY");

    TAuROV AK_LKGRLM = mfoo;

    HRAV_G RRW = 9;
    HRAV_G RRW_RMWVC = 9;

    RU (AK == a_mfoo) {
        olt_viili("XZMMLG LKVM %H LI RG RH MLG Z ARKKVW UROV.", ZITE[8]);
        IVGFIM 9;
    }

    RU (AK_RMWVC == a_mfoo) {
        olt_viili("XZMMLG LKVM %H LI RG RH MLG Z ARKKVW UROV.", ZITE[7]);
        IVGFIM 9;
    }


    RU (ZITX == 5){
        AK_LKGRLM = TALKVM(ZITE[6], "IY");
        RU (AK_LKGRLM == a_mfoo) {
            olt_viili("XZMMLG LKVM %H LI RG RH MLG Z ARKKVW UROV.", ZITE[6]);
            IVGFIM 9;
        }
    }


    olt_rmul("OLZWRMT %H WZGZ...","HGLXP");
    HRAV_G KZXPVW_HRAV = HRAVLU(vJFRGBnZIPVGwZGZuRVOW) - 7;
    ELRW * K_KZXPWZGZ = NZOOLX( YZGXS_IVZW_UILN_TA * KZXPVW_HRAV );
    RU ( !K_KZXPWZGZ )
        FYRJGSILD("UZROVW GL ZOOXLZGV NVNLIB", -8);
    kZWnZIPVGwZGZhGIFXG WZGZ;
    GBKVWVU HGW::FMLIWVIVW_NZK<HGW::HGIRMT, HGW::EVXGLI<kZWnZIPVGwZGZhGIFXG> > eZFOG;
    HGW::NZK<HGW::HGIRMT, eZFOG> IZD_WZGZ;
    HRAV_G LIRTRMZO_WZGZ_OVM = 9;

    YLLO SZH_49_VGU = UZOHV;

    // IVZW RM HGLXP WZGZ
    DSROV (!TAVLU(AK))
    {
        RMG O = TAIVZW(AK, K_KZXPWZGZ, YZGXS_IVZW_UILN_TA * KZXPVW_HRAV );
        RU (O < 9) {
            olt_viili("VIILI DSVM IVZWRMT %H ZH Z ARKKVW UROV, IVZHLM:%H", ZITE[8], TAVIILI(AK, &O) );
            IVGFIM -8;
        }
        ULI (OLMT R=9; R<O/(RMG)KZXPVW_HRAV; ++R)
        {
            NVNXKB( (XSZI*)&WZGZ+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ + R * KZXPVW_HRAV ,
                    69);
            NVNXKB( (XSZI*)&WZGZ+67+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ + R * KZXPVW_HRAV + 69 ,
                    HRAVLU(vJFRGBnZIPVGwZGZuRVOW)-67);

            RU ( ! HGIXSI(WZGZ.WZGZ.rMHGIFNVMGrw, '.')  ){
                HGIXZG(WZGZ.WZGZ.rMHGIFNVMGrw, ".");
                HGIXZG(WZGZ.WZGZ.rMHGIFNVMGrw, WZGZ.WZGZ.vCXSZMTVrw);
            }
            RU ( HGIXNK(WZGZ.WZGZ.rMHGIFNVMGrw, "489949.hhv") == 9  )
                SZH_49_VGU = GIFV;
            FYRJGLLO::fYRJhVXFIRGBxZGVTLIB HX;
            HX.wVXRWVxZGVTLIB(WZGZ.WZGZ.rMHGIFNVMGrw);
            RU ( HGIOVM(HX.gBKV) == 9  )
                FYRJGSILD(HGW::HGIRMT("XZMMLG URMW GBKV ULI ") + WZGZ.WZGZ.rMHGIFNVMGrw, -8);

            RU ( IZD_WZGZ[HX.gBKV].URMW(WZGZ.WZGZ.rMHGIFNVMGrw) == IZD_WZGZ[HX.gBKV].VMW() )
                IZD_WZGZ[HX.gBKV][WZGZ.WZGZ.rMHGIFNVMGrw].IVHVIEV(5903);
            WZGZ.RW = RRW++;

            IZD_WZGZ[HX.gBKV][WZGZ.WZGZ.rMHGIFNVMGrw].KFHS_YZXP(WZGZ);
            LIRTRMZO_WZGZ_OVM += HRAVLU(WZGZ);
        }
    }
    UIVV(K_KZXPWZGZ);




    //! HGZIG GL DLIP LM RMWVC
    olt_rmul("OLZWRMT %H WZGZ...","RMWVC");
    HRAV_G KZXPVW_HRAV_RMWVC = HRAVLU(rMWVCnZIPVGwZGZuRVOW)-7;
    ELRW * K_KZXPWZGZ_RMWVC = NZOOLX( YZGXS_IVZW_UILN_TA * KZXPVW_HRAV_RMWVC );
    RU ( !K_KZXPWZGZ_RMWVC )
        FYRJGSILD("UZROVW GL ZOOXLZGV NVNLIB", -8);

    kZWrMWVCwZGZhGIFXG WZGZ_RMWVC;
    GBKVWVU HGW::FMLIWVIVW_NZK<HGW::HGIRMT, HGW::EVXGLI<kZWrMWVCwZGZhGIFXG> > eZFOG_RMWVC;
    HGW::NZK<HGW::HGIRMT, eZFOG_RMWVC> IZD_WZGZ_RMWVC;
    HRAV_G LIRTRMZO_WZGZ_OVM_RMWVC = 9;

    // IVZW RM HGLXP WZGZ
    DSROV (!TAVLU(AK_RMWVC))
    {
        RMG O = TAIVZW(AK_RMWVC, K_KZXPWZGZ_RMWVC, YZGXS_IVZW_UILN_TA * KZXPVW_HRAV_RMWVC );
        RU (O < 9) {
            olt_viili("VIILI DSVM IVZWRMT %H ZH Z ARKKVW UROV, IVZHLM:%H", ZITE[8], TAVIILI(AK_RMWVC, &O) );
            IVGFIM -8;
        }
        ULI (OLMT R=9; R<O/(RMG)KZXPVW_HRAV_RMWVC; ++R)
        {
            NVNXKB( (XSZI*)&WZGZ_RMWVC+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ_RMWVC + R * KZXPVW_HRAV_RMWVC ,
                    69);
            NVNXKB( (XSZI*)&WZGZ_RMWVC+67+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ_RMWVC + R * KZXPVW_HRAV_RMWVC + 69 ,
                    HRAVLU(rMWVCnZIPVGwZGZuRVOW)-67);
            ZFGL VCXT_HKORG = HGIXSI(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw, '.');
            RU ( VCXT_HKORG  ){
                *VCXT_HKORG = '\M';
            }
            HGIXZG(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw, ".");
            HGIXZG(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw, WZGZ_RMWVC.WZGZ.vCXSZMTVrw);
            RU ( IZD_WZGZ_RMWVC["rMWVC"].URMW(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw) == IZD_WZGZ_RMWVC["rMWVC"].VMW() )
                IZD_WZGZ_RMWVC["rMWVC"][WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw].IVHVIEV(5903);
            WZGZ_RMWVC.RW = RRW_RMWVC++;
            IZD_WZGZ_RMWVC["rMWVC"][WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw].KFHS_YZXP(WZGZ_RMWVC);
            //HGW::XLFG<<WZGZ_RMWVC.RW<<" "<<WZGZ_RMWVC.WZGZ.oLXZOgRNV<<" "<<WZGZ_RMWVC.WZGZ.xOLHVrMWVC<<HGW::VMWO;
            LIRTRMZO_WZGZ_OVM_RMWVC += HRAVLU(WZGZ_RMWVC);
        }

    }

    UIVV(K_KZXPWZGZ_RMWVC);

    //uli_vzxs(RMH, IZD_WZGZ_RMWVC["rMWVC"])
        //HGW::XLFG<<RMH->URIHG<<HGW::VMWO;



    RU (ZITX == 5){
        olt_rmul("OLZWRMT %H WZGZ...","LKGRLM");
        HRAV_G KZXPVW_HRAV_LKGRLM = HRAVLU(vJFRGBnZIPVGwZGZuRVOW) - 7;
        ELRW * K_KZXPWZGZ_LKGRLM = NZOOLX( YZGXS_IVZW_UILN_TA * KZXPVW_HRAV_LKGRLM );
        RU ( !K_KZXPWZGZ_LKGRLM )
            FYRJGSILD("UZROVW GL ZOOXLZGV NVNLIB", -8);
        // IVZW RM LKGRLM WZGZ
        DSROV (!TAVLU(AK_LKGRLM))
        {
            RMG O = TAIVZW(AK_LKGRLM, K_KZXPWZGZ_LKGRLM, YZGXS_IVZW_UILN_TA * KZXPVW_HRAV_LKGRLM );
            RU (O < 9) {
                olt_viili("VIILI DSVM IVZWRMT %H ZH Z ARKKVW UROV, IVZHLM:%H", ZITE[6], TAVIILI(AK_LKGRLM, &O) );
                IVGFIM -8;
            }
            ULI (OLMT R=9; R<O/(RMG)KZXPVW_HRAV_LKGRLM; ++R)
            {
                NVNXKB( (XSZI*)&WZGZ+HRAVLU(HRAV_G),
                        (XSZI*)K_KZXPWZGZ_LKGRLM + R * KZXPVW_HRAV_LKGRLM ,
                        69);
                NVNXKB( (XSZI*)&WZGZ+67+HRAVLU(HRAV_G),
                        (XSZI*)K_KZXPWZGZ_LKGRLM + R * KZXPVW_HRAV_LKGRLM + 69 ,
                        HRAVLU(vJFRGBnZIPVGwZGZuRVOW)-67);

                RU ( HGIXNK(WZGZ.WZGZ.rMHGIFNVMGrw, "489949.hhv") == 9 )
                {
                    RU ( SZH_49_VGU )
                        XLMGRMFV;
                    VOHV RU ( ! SZH_49_VGU )
                    {
                        IZD_WZGZ["uFMW"][WZGZ.WZGZ.rMHGIFNVMGrw].KFHS_YZXP(WZGZ);
                        XLMGRMFV;
                    }
                }

                RU ( IZD_WZGZ["lKGRLM"].URMW(WZGZ.WZGZ.rMHGIFNVMGrw) == IZD_WZGZ["lKGRLM"].VMW() )
                    IZD_WZGZ["lKGRLM"][WZGZ.WZGZ.rMHGIFNVMGrw].IVHVIEV(5903);
                ++RRW;
                WZGZ.RW = 9;
                IZD_WZGZ["lKGRLM"][WZGZ.WZGZ.rMHGIFNVMGrw].KFHS_YZXP(WZGZ);
                LIRTRMZO_WZGZ_OVM += HRAVLU(WZGZ);
            }
        }
        UIVV(K_KZXPWZGZ_LKGRLM);
    }

    sVZW SVZW;
    SVZW.MFN = RRW;
    SVZW.MFN_7 = RRW_RMWVC;

    NVNHVG(&SVZW, 9, HRAVLU(sVZW));
    ZFGL SVZW_LUUHVG = HRAVLU(sVZW)+HRAVLU(FYRJGLLO::fYRJuROVsVZWVI);
    ZFGL WZGZ_LUUHVG = SVZW_LUUHVG;

    ZFGL LFGKFG_WZGZ_OVM = XLNKIVHHyLFMW(LIRTRMZO_WZGZ_OVM);
    ZFGL LFGKFG_WZGZ_OVM_RMWVC = XLNKIVHHyLFMW(LIRTRMZO_WZGZ_OVM_RMWVC);

    ZFGL LFGKFG_YFUUVI = (FMHRTMVW XSZI*)NZOOLX( (LFGKFG_WZGZ_OVM+LFGKFG_WZGZ_OVM_RMWVC) * HRAVLU(XSZI) );
    RU ( LFGKFG_YFUUVI == mfoo  )
        FYRJGSILD("XZMMLG ZOOLXZGV NVNLIB ULI XLNKIVHHRLM", -8);


    ZFGL TU = ULKVM("LFGKFG.WZG", "DY");
    RU ( TU == mfoo  )
        FYRJGSILD("XZMMLG LKVM UROV", -8);

    //! HGZIG GL XLNKIVHH VZXS HVXFIRGB WZGZ
    uli_vzxs(P, IZD_WZGZ){
        ZFGL WW = P->URIHG;
        ZFGL & KLH = uRMWvOVNVMG(SVZW, P->URIHG);
        KLH.HGZIG  = SVZW_LUUHVG;
        KLH.MFN =  P->HVXLMW.HRAV();
        KLH.VMW = KLH.HGZIG + KLH.MFN * HRAVLU(kZWgZYH);
        SVZW_LUUHVG = KLH.HGZIG + P->HVXLMW.HRAV()*(HRAVLU(kZWgZYH));
    }


    uli_vzxs(P, IZD_WZGZ_RMWVC){
        ZFGL WW = P->URIHG;
        ZFGL & KLH = uRMWvOVNVMG(SVZW, P->URIHG);
        KLH.HGZIG  = SVZW_LUUHVG;
        KLH.MFN =  P->HVXLMW.HRAV();
        KLH.VMW = KLH.HGZIG + KLH.MFN * HRAVLU(kZWgZYH);
        SVZW_LUUHVG = KLH.HGZIG + P->HVXLMW.HRAV()*(HRAVLU(kZWgZYH));
    }


    FYRJGLLO::fYRJuROV FUROV;
    ZFGL FS = FUROV.xIVZGVuROV();
    FS.kFYORX().wZGZgBKV("fYRJFZMG hVXFIRGB nZIPVG jFLGV wFNK").uROVgBKV(FYRJGLLO::fyrj_jflgv_wfnk);
    UDIRGV(&FS, HRAVLU(FS),8, TU);

    WZGZ_LUUHVG = SVZW_LUUHVG; // HGZIG GL DIRGV WZGZ
    UDIRGV(&SVZW, HRAVLU(SVZW),8, TU);
    // HGZIG GL DIRGV ORHG


    ZFGL XFIIVMG_LFGKFG = LFGKFG_YFUUVI; // GSRH HSLFOW YV GSV KLRMGVI KLRMGRMT GL EVXGLI SVZW
    HRAV_G LFGKFG_URMZO_OVM = 9;

    /*ZFGL WW = IZD_WZGZ_RMWVC["rMWVC"];*/
    /*ZFGL HW = IZD_WZGZ_RMWVC["rMWVC"]["999699"];*/
    /*uli_vzxs(RGVI, HW)*/
        /*HGW::XLFG<<RGVI->WZGZ.oLXZOgRNV<<" "<<RGVI->WZGZ.oZHGrMWVC<<HGW::VMWO;*/

    uli_vzxs(P, IZD_WZGZ)
    {
        //XSZI MZNV[83];
        olt_rmul("XLNKIVHHRMT %H, MFN: %W", P->URIHG.X_HGI(), P->HVXLMW.HRAV());
        uli_vzxs( RMH, P->HVXLMW ){
            kZWgZYH GZY;
            HGIMXKB(GZY.MZNV, RMH->URIHG.X_HGI(), 83);
            GZY.KLH.HGZIG = WZGZ_LUUHVG;
            GZY.KLH.MFN = RMH->HVXLMW.HRAV();
            //HGW::XLFG<<WVHG_OVM<<" "<< HRAVLU(kZWnZIPVGwZGZhGIFXG)*RMH->HVXLMW.HRAV()<< HGW::VMWO;
            FMHRTMVW  OLMT HLFIXV_OVM = HRAVLU(kZWnZIPVGwZGZhGIFXG)*RMH->HVXLMW.HRAV();
            FMHRTMVW OLMT WVHG_OVM = HLFIXV_OVM;
            //HGW::XLFG<<RMH->HVXLMW.WZGZ()->WZGZ.rMHGIFNVMGrw
            //<< RMH->HVXLMW.WZGZ()->WZGZ.oZHGkIRXV << HGW::VMWO;
            RMG VIILIRW = XLNKIVHH(XFIIVMG_LFGKFG, &WVHG_OVM, (XLMHG FMHRTMVW XSZI*)RMH->HVXLMW.WZGZ(), HLFIXV_OVM );
            RU ( VIILIRW != a_lp )
                FYRJGSILD("XLNKIVHHRLM UZROVW ULI IVZHLM:"+ HGW::GL_HGIRMT((OLMT OLMT)VIILIRW) , -8);
            GZY.KLH.VMW = GZY.KLH.HGZIG + WVHG_OVM;
            XFIIVMG_LFGKFG += WVHG_OVM;
            LFGKFG_WZGZ_OVM -= WVHG_OVM;
            LFGKFG_URMZO_OVM += WVHG_OVM;
            WZGZ_LUUHVG += WVHG_OVM;
            UDIRGV(&GZY, HRAVLU(kZWgZYH), 8, TU );
        }
    }


    uli_vzxs(P, IZD_WZGZ_RMWVC)
    {
        //XSZI MZNV[83];
        olt_rmul("XLNKIVHH %H, MFN: %W", P->URIHG.X_HGI(), P->HVXLMW.HRAV());
        uli_vzxs( RMH, P->HVXLMW ){
            kZWgZYH GZY;
            HGIMXKB(GZY.MZNV, RMH->URIHG.X_HGI(), 83);
            GZY.KLH.HGZIG = WZGZ_LUUHVG;
            GZY.KLH.MFN = RMH->HVXLMW.HRAV();
            //HGW::XLFG<<WVHG_OVM<<" "<< HRAVLU(kZWnZIPVGwZGZhGIFXG)*RMH->HVXLMW.HRAV()<< HGW::VMWO;
            FMHRTMVW  OLMT HLFIXV_OVM = HRAVLU(kZWrMWVCwZGZhGIFXG)*RMH->HVXLMW.HRAV();
            FMHRTMVW OLMT WVHG_OVM = HLFIXV_OVM;
            //HGW::XLFG<<RMH->HVXLMW.WZGZ()->WZGZ.rMHGIFNVMGrw
            //<< RMH->HVXLMW.WZGZ()->WZGZ.xOLHVrMWVC << HGW::VMWO;
            RMG VIILIRW = XLNKIVHH(XFIIVMG_LFGKFG, &WVHG_OVM, (XLMHG FMHRTMVW XSZI*)RMH->HVXLMW.WZGZ(), HLFIXV_OVM );
            RU ( VIILIRW != a_lp )
                FYRJGSILD("XLNKIVHHRLM UZROVW ULI IVZHLM:"+ HGW::GL_HGIRMT((OLMT OLMT)VIILIRW) , -8);
            GZY.KLH.VMW = GZY.KLH.HGZIG + WVHG_OVM;
            XFIIVMG_LFGKFG += WVHG_OVM;
            LFGKFG_WZGZ_OVM -= WVHG_OVM;
            LFGKFG_URMZO_OVM += WVHG_OVM;
            WZGZ_LUUHVG += WVHG_OVM;
            UDIRGV(&GZY, HRAVLU(kZWgZYH), 8, TU );
        }
    }


    //! HGZIG GL DIRGV WZGZ
    UDIRGV( LFGKFG_YFUUVI, LFGKFG_URMZO_OVM, 8, TU );


    olt_rmul("XLNKROZGRLM URMRHSVW, GLGZO HVXFIRGB MFN: %W, RMWVC MFN %W", RRW, RRW_RMWVC);
    UXOLHV(TU);
    TAXOLHV(AK);
}
//##**---------------- ./FYRJGLLO_WVE/GLLO/FIVZW.XKK
/**********************************************
 * \EVIHRLM   5.8.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-97-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/


#RMXOFWV <AORY.S>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV <RLHGIVZN>



RMG NZRM (RMG ZITX, XSZI** ZITE)
{
    FYRJGLLO::fYRJuROVsVZWVI SVZW;
    ZFGL U = ULKVM(ZITE[8],"IY");
    RU ( !U )
        FYRJGSILD(HGW::HGIRMT("XZMMLG IVZW ")+ZITE[8], -8);
    UIVZW(&SVZW, HRAVLU(SVZW ), 8, U );
    HGW::XLFG<<"******** fYRJUROV hFNNZIB*************"<<HGW::VMWO;
    HGW::XLFG<<"WZGZ:"<<SVZW.WZGZ_GBKV<<HGW::VMWO;
    HGW::XLFG<<"NZTRX_MFN:"<<SVZW.NZTRX_MFN<<HGW::VMWO;
    HGW::XLFG<<"EVIHRLM:"<<SVZW.EVIHRLM<<HGW::VMWO;
    HGW::XLFG<<"GRNV:"<<SVZW.XIVZGV_GRNV<<" "<<SVZW.XIVZGV_WZGV<<" tng+"<<SVZW.XIVZGV_GRNVALMV<<HGW::VMWO;
    HGW::XLFG<<"XIVZGV:"<<SVZW.XIVZGV_SLHG<<"/"<<SVZW.XIVZGV_WLNZRM<<HGW::VMWO;
    HGW::XLFG<<"FHVI:"<<SVZW.XIVZGV_FHVI<<HGW::VMWO;
    HGW::XLFG<<"GBKV:"<<SVZW.XIVZGV_GBKV<<HGW::VMWO;
    IVGFIM 9;
}
//##**---------------- ./FYRJGLLO_WVE/GLLO/UO7.XKK
/**********************************************
 * \EVIHRLM   5.8.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-97-98
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/


#RMXOFWV <AORY.S>
#RMXOFWV <KGSIVZW.S>
#RMXOFWV <FMRHGW.S>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "FYRJ_UROV.S"
#RMXOFWV "nZIPVGwZGZhGIFXG.S"
#RMXOFWV "FYRJ_JFLGVWFNK.S"
#RMXOFWV <RLHGIVZN>

FHRMT MZNVHKZXV FYRJGLLO::FYRJJFLGV;

HGZGRX XLMHG RMG YZGXS_IVZW_UILN_TA = 499*5903;

RMG NZRM (RMG ZITX, XSZI** ZITE)
{
    TAuROV AK = TALKVM(ZITE[8], "IY");
    TAuROV AK_RMWVC = TALKVM(ZITE[7], "IY");
    TAuROV AK_LKGRLM = TALKVM(ZITE[6], "IY");


    HRAV_G RRW = 9;
    HRAV_G RRW_RMWVC = 9;

    RU (AK == a_mfoo) {
        olt_viili("XZMMLG LKVM %H LI RG RH MLG Z ARKKVW UROV.", ZITE[8]);
        IVGFIM 9;
    }

    RU (AK_RMWVC == a_mfoo) {
        olt_viili("XZMMLG LKVM %H LI RG RH MLG Z ARKKVW UROV.", ZITE[7]);
        IVGFIM 9;
    }


    RU (AK_LKGRLM == a_mfoo) {
        olt_viili("XZMMLG LKVM %H LI RG RH MLG Z ARKKVW UROV.", ZITE[7]);
        IVGFIM 9;
    }


    olt_rmul("OLZWRMT %H WZGZ...","HGLXP");
    HRAV_G KZXPVW_HRAV = HRAVLU(vJFRGBnZIPVGwZGZuRVOW) - 7;
    ELRW * K_KZXPWZGZ = NZOOLX( YZGXS_IVZW_UILN_TA * KZXPVW_HRAV );
    RU ( !K_KZXPWZGZ )
        FYRJGSILD("UZROVW GL ZOOXLZGV NVNLIB", -8);
    kZWnZIPVGwZGZhGIFXG WZGZ;
    GBKVWVU HGW::FMLIWVIVW_NZK<HGW::HGIRMT, HGW::EVXGLI<kZWnZIPVGwZGZhGIFXG> > eZFOG;
    HGW::NZK<HGW::HGIRMT, eZFOG> IZD_WZGZ;
    HRAV_G LIRTRMZO_WZGZ_OVM = 9;



    // IVZW RM HGLXP WZGZ
    DSROV (!TAVLU(AK))
    {
        RMG O = TAIVZW(AK, K_KZXPWZGZ, YZGXS_IVZW_UILN_TA * KZXPVW_HRAV );
        RU (O < 9) {
            olt_viili("VIILI DSVM IVZWRMT %H ZH Z ARKKVW UROV, IVZHLM:%H", ZITE[8], TAVIILI(AK, &O) );
            IVGFIM -8;
        }
        ULI (OLMT R=9; R<O/(RMG)KZXPVW_HRAV; ++R)
        {
            NVNXKB( (XSZI*)&WZGZ+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ + R * KZXPVW_HRAV ,
                    69);
            NVNXKB( (XSZI*)&WZGZ+67+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ + R * KZXPVW_HRAV + 69 ,
                    HRAVLU(vJFRGBnZIPVGwZGZuRVOW)-67);
            FYRJGLLO::fYRJhVXFIRGBxZGVTLIB HX;
            HX.wVXRWVxZGVTLIB(WZGZ.WZGZ.rMHGIFNVMGrw);
            RU ( HGIOVM(HX.gBKV) == 9  )
                FYRJGSILD(HGW::HGIRMT("XZMMLG URMW GBKV ULI ") + WZGZ.WZGZ.rMHGIFNVMGrw, -8);

            RU ( IZD_WZGZ[HX.gBKV].URMW(WZGZ.WZGZ.rMHGIFNVMGrw) == IZD_WZGZ[HX.gBKV].VMW() )
                IZD_WZGZ[HX.gBKV][WZGZ.WZGZ.rMHGIFNVMGrw].IVHVIEV(5903);
            WZGZ.RW = RRW++;

            IZD_WZGZ[HX.gBKV][WZGZ.WZGZ.rMHGIFNVMGrw].KFHS_YZXP(WZGZ);
            LIRTRMZO_WZGZ_OVM += HRAVLU(WZGZ);
        }
    }

    //! HGZIG GL DLIP LM RMWVC
    olt_rmul("OLZWRMT %H WZGZ...","RMWVC");
    HRAV_G KZXPVW_HRAV_RMWVC = HRAVLU(rMWVCnZIPVGwZGZuRVOW)-7;
    ELRW * K_KZXPWZGZ_RMWVC = NZOOLX( YZGXS_IVZW_UILN_TA * KZXPVW_HRAV_RMWVC );
    RU ( !K_KZXPWZGZ_RMWVC )
        FYRJGSILD("UZROVW GL ZOOXLZGV NVNLIB", -8);

    kZWrMWVCwZGZhGIFXG WZGZ_RMWVC;
    GBKVWVU HGW::FMLIWVIVW_NZK<HGW::HGIRMT, HGW::EVXGLI<kZWrMWVCwZGZhGIFXG> > eZFOG_RMWVC;
    HGW::NZK<HGW::HGIRMT, eZFOG_RMWVC> IZD_WZGZ_RMWVC;
    HRAV_G LIRTRMZO_WZGZ_OVM_RMWVC = 9;

    // IVZW RM HGLXP WZGZ
    DSROV (!TAVLU(AK_RMWVC))
    {
        RMG O = TAIVZW(AK_RMWVC, K_KZXPWZGZ_RMWVC, YZGXS_IVZW_UILN_TA * KZXPVW_HRAV_RMWVC );
        RU (O < 9) {
            olt_viili("VIILI DSVM IVZWRMT %H ZH Z ARKKVW UROV, IVZHLM:%H", ZITE[8], TAVIILI(AK_RMWVC, &O) );
            IVGFIM -8;
        }
        ULI (OLMT R=9; R<O/(RMG)KZXPVW_HRAV_RMWVC; ++R)
        {
            NVNXKB( (XSZI*)&WZGZ_RMWVC+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ_RMWVC + R * KZXPVW_HRAV_RMWVC ,
                    69);
            NVNXKB( (XSZI*)&WZGZ_RMWVC+67+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ_RMWVC + R * KZXPVW_HRAV_RMWVC + 69 ,
                    HRAVLU(rMWVCnZIPVGwZGZuRVOW)-67);
            ZFGL VCXT_HKORG = HGIXSI(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw, '.');
            RU ( VCXT_HKORG  ){
                *VCXT_HKORG = '\M';
            }
            HGIXZG(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw, ".");
            HGIXZG(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw, WZGZ_RMWVC.WZGZ.vCXSZMTVrw);
            RU ( IZD_WZGZ_RMWVC["rMWVC"].URMW(WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw) == IZD_WZGZ_RMWVC["rMWVC"].VMW() )
                IZD_WZGZ_RMWVC["rMWVC"][WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw].IVHVIEV(5903);
            WZGZ_RMWVC.RW = RRW_RMWVC++;
            IZD_WZGZ_RMWVC["rMWVC"][WZGZ_RMWVC.WZGZ.rMHGIFNVMGrw].KFHS_YZXP(WZGZ_RMWVC);
            //HGW::XLFG<<WZGZ_RMWVC.RW<<" "<<WZGZ_RMWVC.WZGZ.oLXZOgRNV<<" "<<WZGZ_RMWVC.WZGZ.xOLHVrMWVC<<HGW::VMWO;
            LIRTRMZO_WZGZ_OVM_RMWVC += HRAVLU(WZGZ_RMWVC);
        }
    }
    //uli_vzxs(RMH, IZD_WZGZ_RMWVC["rMWVC"])
        //HGW::XLFG<<RMH->URIHG<<HGW::VMWO;



    olt_rmul("OLZWRMT %H WZGZ...","LKGRLM");
    HRAV_G KZXPVW_HRAV_LKGRLM = HRAVLU(vJFRGBnZIPVGwZGZuRVOW) - 7;
    ELRW * K_KZXPWZGZ_LKGRLM = NZOOLX( YZGXS_IVZW_UILN_TA * KZXPVW_HRAV );
    RU ( !K_KZXPWZGZ_LKGRLM )
        FYRJGSILD("UZROVW GL ZOOXLZGV NVNLIB", -8);

    // IVZW RM LKGRLM WZGZ
    DSROV (!TAVLU(AK_LKGRLM))
    {
        RMG O = TAIVZW(AK_LKGRLM, K_KZXPWZGZ_LKGRLM, YZGXS_IVZW_UILN_TA * KZXPVW_HRAV_LKGRLM );
        RU (O < 9) {
            olt_viili("VIILI DSVM IVZWRMT %H ZH Z ARKKVW UROV, IVZHLM:%H", ZITE[6], TAVIILI(AK_LKGRLM, &O) );
            IVGFIM -8;
        }
        ULI (OLMT R=9; R<O/(RMG)KZXPVW_HRAV_LKGRLM; ++R)
        {
            NVNXKB( (XSZI*)&WZGZ+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ_LKGRLM + R * KZXPVW_HRAV_LKGRLM ,
                    69);
            NVNXKB( (XSZI*)&WZGZ+67+HRAVLU(HRAV_G),
                    (XSZI*)K_KZXPWZGZ_LKGRLM + R * KZXPVW_HRAV_LKGRLM + 69 ,
                    HRAVLU(vJFRGBnZIPVGwZGZuRVOW)-67);
            RU ( HGIXNK(WZGZ.WZGZ.rMHGIFNVMGrw, "489949.hhv") == 9)
                XLMGRMFV;
            RU ( IZD_WZGZ["lKGRLM"].URMW(WZGZ.WZGZ.rMHGIFNVMGrw) == IZD_WZGZ["lKGRLM"].VMW() )
                IZD_WZGZ["lKGRLM"][WZGZ.WZGZ.rMHGIFNVMGrw].IVHVIEV(5903);
            ++RRW;
            WZGZ.RW = 9;
            IZD_WZGZ["lKGRLM"][WZGZ.WZGZ.rMHGIFNVMGrw].KFHS_YZXP(WZGZ);
            LIRTRMZO_WZGZ_OVM += HRAVLU(WZGZ);
        }
    }


    sVZW SVZW;
    SVZW.MFN = RRW;
    SVZW.MFN_7 = RRW_RMWVC;

    NVNHVG(&SVZW, 9, HRAVLU(sVZW));
    ZFGL SVZW_LUUHVG = HRAVLU(sVZW)+HRAVLU(FYRJGLLO::fYRJuROVsVZWVI);
    ZFGL WZGZ_LUUHVG = SVZW_LUUHVG;

    ZFGL LFGKFG_WZGZ_OVM = XLNKIVHHyLFMW(LIRTRMZO_WZGZ_OVM);
    ZFGL LFGKFG_WZGZ_OVM_RMWVC = XLNKIVHHyLFMW(LIRTRMZO_WZGZ_OVM_RMWVC);

    ZFGL LFGKFG_YFUUVI = (FMHRTMVW XSZI*)NZOOLX( (LFGKFG_WZGZ_OVM+LFGKFG_WZGZ_OVM_RMWVC) * HRAVLU(XSZI) );
    RU ( LFGKFG_YFUUVI == mfoo  )
        FYRJGSILD("XZMMLG ZOOLXZGV NVNLIB ULI XLNKIVHHRLM", -8);


    ZFGL TU = ULKVM("LFGKFG.WZG", "DY");
    RU ( TU == mfoo  )
        FYRJGSILD("XZMMLG LKVM UROV", -8);

    //! HGZIG GL XLNKIVHH VZXS HVXFIRGB WZGZ
    uli_vzxs(P, IZD_WZGZ){
        ZFGL WW = P->URIHG;
        ZFGL & KLH = uRMWvOVNVMG(SVZW, P->URIHG);
        KLH.HGZIG  = SVZW_LUUHVG;
        KLH.MFN =  P->HVXLMW.HRAV();
        KLH.VMW = KLH.HGZIG + KLH.MFN * HRAVLU(kZWgZYH);
        SVZW_LUUHVG = KLH.HGZIG + P->HVXLMW.HRAV()*(HRAVLU(kZWgZYH));
    }


    uli_vzxs(P, IZD_WZGZ_RMWVC){
        ZFGL WW = P->URIHG;
        ZFGL & KLH = uRMWvOVNVMG(SVZW, P->URIHG);
        KLH.HGZIG  = SVZW_LUUHVG;
        KLH.MFN =  P->HVXLMW.HRAV();
        KLH.VMW = KLH.HGZIG + KLH.MFN * HRAVLU(kZWgZYH);
        SVZW_LUUHVG = KLH.HGZIG + P->HVXLMW.HRAV()*(HRAVLU(kZWgZYH));
    }


    FYRJGLLO::fYRJuROV FUROV;
    ZFGL FS = FUROV.xIVZGVuROV();
    FS.kFYORX().wZGZgBKV("fYRJFZMG hVXFIRGB nZIPVG jFLGV wFNK").uROVgBKV(FYRJGLLO::fyrj_jflgv_wfnk);
    UDIRGV(&FS, HRAVLU(FS),8, TU);

    WZGZ_LUUHVG = SVZW_LUUHVG; // HGZIG GL DIRGV WZGZ
    UDIRGV(&SVZW, HRAVLU(SVZW),8, TU);
    // HGZIG GL DIRGV ORHG


    ZFGL XFIIVMG_LFGKFG = LFGKFG_YFUUVI; // GSRH HSLFOW YV GSV KLRMGVI KLRMGRMT GL EVXGLI SVZW
    HRAV_G LFGKFG_URMZO_OVM = 9;

    /*ZFGL WW = IZD_WZGZ_RMWVC["rMWVC"];*/
    /*ZFGL HW = IZD_WZGZ_RMWVC["rMWVC"]["999699"];*/
    /*uli_vzxs(RGVI, HW)*/
        /*HGW::XLFG<<RGVI->WZGZ.oLXZOgRNV<<" "<<RGVI->WZGZ.oZHGrMWVC<<HGW::VMWO;*/

    uli_vzxs(P, IZD_WZGZ)
    {
        //XSZI MZNV[83];
        olt_rmul("XLNKIVHHRMT %H, MFN: %W", P->URIHG.X_HGI(), P->HVXLMW.HRAV());
        uli_vzxs( RMH, P->HVXLMW ){
            kZWgZYH GZY;
            HGIMXKB(GZY.MZNV, RMH->URIHG.X_HGI(), 83);
            GZY.KLH.HGZIG = WZGZ_LUUHVG;
            GZY.KLH.MFN = RMH->HVXLMW.HRAV();
            //HGW::XLFG<<WVHG_OVM<<" "<< HRAVLU(kZWnZIPVGwZGZhGIFXG)*RMH->HVXLMW.HRAV()<< HGW::VMWO;
            FMHRTMVW  OLMT HLFIXV_OVM = HRAVLU(kZWnZIPVGwZGZhGIFXG)*RMH->HVXLMW.HRAV();
            FMHRTMVW OLMT WVHG_OVM = HLFIXV_OVM;
            //HGW::XLFG<<RMH->HVXLMW.WZGZ()->WZGZ.rMHGIFNVMGrw
            //<< RMH->HVXLMW.WZGZ()->WZGZ.oZHGkIRXV << HGW::VMWO;
            RMG VIILIRW = XLNKIVHH(XFIIVMG_LFGKFG, &WVHG_OVM, (XLMHG FMHRTMVW XSZI*)RMH->HVXLMW.WZGZ(), HLFIXV_OVM );
            RU ( VIILIRW != a_lp )
                FYRJGSILD("XLNKIVHHRLM UZROVW ULI IVZHLM:"+ HGW::GL_HGIRMT((OLMT OLMT)VIILIRW) , -8);
            GZY.KLH.VMW = GZY.KLH.HGZIG + WVHG_OVM;
            XFIIVMG_LFGKFG += WVHG_OVM;
            LFGKFG_WZGZ_OVM -= WVHG_OVM;
            LFGKFG_URMZO_OVM += WVHG_OVM;
            WZGZ_LUUHVG += WVHG_OVM;
            UDIRGV(&GZY, HRAVLU(kZWgZYH), 8, TU );
        }
    }

    uli_vzxs(P, IZD_WZGZ_RMWVC)
    {
        //XSZI MZNV[83];
        olt_rmul("XLNKIVHH %H, MFN: %W", P->URIHG.X_HGI(), P->HVXLMW.HRAV());
        uli_vzxs( RMH, P->HVXLMW ){
            kZWgZYH GZY;
            HGIMXKB(GZY.MZNV, RMH->URIHG.X_HGI(), 83);
            GZY.KLH.HGZIG = WZGZ_LUUHVG;
            GZY.KLH.MFN = RMH->HVXLMW.HRAV();
            //HGW::XLFG<<WVHG_OVM<<" "<< HRAVLU(kZWnZIPVGwZGZhGIFXG)*RMH->HVXLMW.HRAV()<< HGW::VMWO;
            FMHRTMVW  OLMT HLFIXV_OVM = HRAVLU(kZWrMWVCwZGZhGIFXG)*RMH->HVXLMW.HRAV();
            FMHRTMVW OLMT WVHG_OVM = HLFIXV_OVM;
            //HGW::XLFG<<RMH->HVXLMW.WZGZ()->WZGZ.rMHGIFNVMGrw
            //<< RMH->HVXLMW.WZGZ()->WZGZ.xOLHVrMWVC << HGW::VMWO;
            RMG VIILIRW = XLNKIVHH(XFIIVMG_LFGKFG, &WVHG_OVM, (XLMHG FMHRTMVW XSZI*)RMH->HVXLMW.WZGZ(), HLFIXV_OVM );
            RU ( VIILIRW != a_lp )
                FYRJGSILD("XLNKIVHHRLM UZROVW ULI IVZHLM:"+ HGW::GL_HGIRMT((OLMT OLMT)VIILIRW) , -8);
            GZY.KLH.VMW = GZY.KLH.HGZIG + WVHG_OVM;
            XFIIVMG_LFGKFG += WVHG_OVM;
            LFGKFG_WZGZ_OVM -= WVHG_OVM;
            LFGKFG_URMZO_OVM += WVHG_OVM;
            WZGZ_LUUHVG += WVHG_OVM;
            UDIRGV(&GZY, HRAVLU(kZWgZYH), 8, TU );
        }
    }

    //! HGZIG GL DIRGV WZGZ
    UDIRGV( LFGKFG_YFUUVI, LFGKFG_URMZO_OVM, 8, TU );

    olt_rmul("XLNKROZGRLM URMRHSVW, GLGZO HVXFIRGB MFN: %W, RMWVC MFN %W", RRW, RRW_RMWVC);
    UXOLHV(TU);
    TAXOLHV(AK);
}
//##**---------------- ./FYRJGLLO_WVE/EVIHRLM.HS
EVIHRLM=
YFROW=
HSLD=
FKWZGV=
ZWW=
YFROW=
NZPV=
KFOO=
KFHS=
TRGHSLD=
TRGFKWZGV=

XSZMTVOLT=$(WRIMZNV $9)/xSZMTVoLT


DSROV TVGLKGH "HYZSFINKGTA" LKG; 
WL
  XZHV "$LKG" RM
    H) HSLD="B"
      ;;
    Y) YFROW="B"
      ;;
    S) VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G/T/A"
       VXSL "-H: HSLD XFIIVMG EVIHRLM"
       VXSL "-Z LI -I: ZWW LI IVOVZHV Z MVD EVIHRLM"
       VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
       VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
       VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
       VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
       VXSL "-T: HSLD TRG SVZW"
       VXSL "-A: FKWZGV TRG SVZW"
       VCRG 8 
       ;;
    Z) ZWW="B"
      ;;
    F) FKWZGV="B"
      ;;
    I) ZWW="B"
      ;;
    N) NZPV="B"
      ;;
    K) KFOO="B"
      ;;
    G) KFHS="B"
      ;;
    T) TRGHSLD="B"
      ;;
    A) TRGFKWZGV="B"
      ;;
  VHZX
WLMV

RU [[ -A $ZWW ]] && [[ -A $TRGHSLD ]] && [[ -A $TRGFKWZGV ]]  && [[ -A $FKWZGV ]] && [[ -A $HSLD ]] && [[ -A $YFROW ]] && [[ -A $NZPV ]] && [[ -A $KFHS ]] && [[ -A $KFOO  ]]
GSVM
    VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G"
    VXSL "-H: HSLD XFIIVMG IVOVZHV EVIHRLM"
    VXSL "-Z LI -I : ZWW LI IVOVZHV Z MVD EVIHRLM"
    VXSL "-Y: HSLD XFIIVMG YFROW EVIHRLM"
    VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
    VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
    VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
    VXSL "-T: ZXJFRIV TRG SVZW"
    VXSL "-A: FKWZGV TRG SVZW"
    VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
    VCRG 8 
UR

ORMV_MFN=9

DSROV IVZW ORMV
WL
  ORMV_MFN=$((ORMV_MFN+8))
  MZNV=$(VXSL $ORMV|GI -H " ")
  URIHG_XSZIZXGVI=${MZNV:9:8}
  RU [ "$URIHG_XSZIZXGVI" == "@" ];GSVM
    MZNV=${MZNV:7:${#MZNV}-6}
    EVIHRLM=$MZNV
    YIVZP
  VORU [ "$URIHG_XSZIZXGVI" == "%" ];GSVM
    MZNV=${MZNV:2:${#MZNV}-1}
    YFROWML=$MZNV
  UR
WLMV < $XSZMTVOLT

RU [[ ! -A $HSLD ]]; GSVM
  KIRMGU $EVIHRLM
  VCRG 9
UR


RU [[ ! -A $YFROW ]]; GSVM
  KIRMGU $YFROWML
  VCRG 9
UR

RU [[ ! -A $TRGFKWZGV ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  HVW -R "/trgsvzw/X\trgsvzw=$ts" .KZIZ.RMX 
  VCRG 9
UR


RU [[ ! -A $TRGHSLD ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  VCRG 9
UR


RU [[ ! -A $KFOO ]]; GSVM
  TRG HFYNLWFOV FKWZGV --IVNLGV 
  VCRG 9
UR


RU [[ ! -A $KFHS ]]; GSVM
  TRG KFHS --IVXFIHV-HFYNLWFOVH=XSVXP
  VCRG 9
UR


RU [[ ! -A $NZPV  ]]; GSVM
    YFROW_RMG=${YFROWML:0:${#YFROWML}-0}
    YFROW_WG=${YFROWML:9:${#YFROWML}-4}  
    (( YFROW_RMG = 89#$YFROW_RMG + 8 ))
    GLWZB=`WZGV +%b%N%W`
    YFROW_RMG=$(KIRMGU "%95W" $YFROW_RMG)  
    RU [ "$YFROW_WG" -VJ "$GLWZB"  ]; GSVM
        YFROWML=$YFROW_WG-$YFROW_RMG
    VOHV 
        YFROWML=$GLWZB-9998
    UR
    HVW -R "H/.*yfrow.*/%yfrow[$YFROWML]/" $XSZMTVOLT
    KIRMGU $YFROWML
    VCRG 9
UR


NLWRURVW=$(WZGV +%b-%N-%W)

BVOOLD='\966[8;66N'
mx='\966[9N'

RU [[ ! -A $ZWW ]]; GSVM
  KIRMGU "iVOVZHRMT Z MVD EVIHRLM, GSV NLHG IVXVMG EVIHRLM RH ${BVOOLD}$EVIHRLM${mx}:\M"
  IVZW -K "mVD EVIHRLM ml: " MVDEVIHRLM
  IVZW -K "mVD EVIHRLM MZNV: " EVIHRLMMZNV
  IVZW -K "mVD EVIHRLM YIRVU: " YIRVU
  HVW -R "${ORMV_MFN}R\\
@[$MVDEVIHRLM]\M# $NLWRURVW\M## $EVIHRLMMZNV \M- $YIRVU\M\\
    " $XSZMTVOLT
  VXSL "xSZMTVoLT FKWZGVW, MVD EVIHRLM $MVDEVIHRLM RMHVIGVW"
  VCRG 9
UR

RU [[ ! -A $FKWZGV ]]; GSVM 
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\EVIHRLM.*/\* \\\EVIHRLM   $EVIHRLM/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\NLWRURVW.*/\* \\\NLWRURVW  $NLWRURVW/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\kilqvxg_mfnyvi.*/\* \\\kilqvxg_mfnyvi=$NLWRURVW/"
    VXSL "eVIHRLM ml RM ZOO UROVH FKWZGVW"
UR

//##**---------------- ./FYRJGLLO_WVE/xSZMTVoLT
kilqvxg: FYRJGLLO
zfgsli: FYRJFZMG
xivzgvw: 7984-94-77
      
    
# xSZMTV oLT
zOO MLGZYOV XSZMTVH GL GSRH KILQVXG DROO YV WLXFNVMGVW RM GSRH UROV.
fHFZOOB VZXS RGVN RH ZWSVIVW GL LMV IVOVZHV MFNYVI XSZMTV


%yfrow[79829572-9994]

    
@[8.9.7]
# 7984-92-75
## ZZ 
- ZWW ZIT ULI ORMVH LU OLT

    
@[8.9.8]
# 7984-92-98
## YLIM 
- ZWWVW HGO

    
@[8.9.9]
# 7984-93-98
## YLIM 
- URIHG ULINZO IVOVZHRLM

    
@[9.9.8]
# 7984-94-77
## KILQVXG RH RMRGRZOAVW
- KILQVXG RMRGRZORAVW, GSRH HSLFOW YV GSV *EVIB* URIHG EVIHRLM
//##**---------------- ./FYRJGLLO_WVE/orxvmhv
orxvmhv uli fyrjgllo 
===================
kilerhrlmh:

8) fyrjgllo HSZOO LMOB YV FHVW DRGSRM KILQVXG WVEVOLKNVMGH VMWLIHVW LI KVINRGGVW YB fYRJFZMG XLNKZMB;

7) vCXVKG ULI VCKORXRGOB KVINRGGVW (RM DIRGGVM ULIN) YB GSV fYRJFZMG xLNKZMB, ZMB KILQVXGH GSZG FHVW 
   fyrjgllo XLNKLMVMGH XZMMLG XOZRN UFOO KVIHLMZO XIVWRGH;

6) zMBLMV DSL XLMGIRYFGVH XLWV GL fyrjgllo, DROO ZFGLNZGRXZOOB YV IVXLTMRAVW ZH XL-ZFGSLI LU fyrjgllo, 
   ZMW SVMXV ZYZMWLM GSVRI XLWV IRTSGH, DSRXS ZIV GIZMHUVIIVW GL GSV fYRJFZMG xLNKZMB;

5) zMB XL-ZFGSLI HGROO IVGZRMH GSVRI XLKBIRTSG;

4) zMB 6IW KZIGB XLWVH/KILQVXGH/XLNKLMVMGH, HGROO KIVHVIEVH SVI ORXVMHV KILERHRLMH LM ZM ZH-RH YZHRH; zOO
   6IW KZIGB ORXVMHVH ZIV ZGGZXSVW GL GSRH UROV DRGSLFG ZMB NLWRURXZGRLM;


# oRHG ZMW ZWZKGRLM/NLWRURXZGRLM LU 6IW KZIGB XLWVH ZIV ORHGVW RM IVZWNV.NW UROV. 



6IW KZIGB ORXVMHVH ULOOLDH:

# orxvmhv uli xhekzihvi (RMXOFWV/XHE.S)
======================================
xLKBIRTSG (X) 7984, YVM-HGIZHHVI
zOO IRTSGH IVHVIEVW.

iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV NVG:

* iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG MLGRXV, GSRH
  ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.

* iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV XLKBIRTSG MLGRXV,
  GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI RM GSV WLXFNVMGZGRLM
  ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV WRHGIRYFGRLM.

* mVRGSVI GSV MZNV LU UZHG-XKK-XHE-KZIHVI MLI GSV MZNVH LU RGH
  XLMGIRYFGLIH NZB YV FHVW GL VMWLIHV LI KILNLGV KILWFXGH WVIREVW UILN
  GSRH HLUGDZIV DRGSLFG HKVXRURX KIRLI DIRGGVM KVINRHHRLM.

gsrh hlugdziv rh kilerwvw yb gsv xlkbirtsg slowvih zmw xlmgiryfglih "zh rh"
zmw zmb vckivhh li rnkorvw dziizmgrvh, rmxofwrmt, yfg mlg ornrgvw gl, gsv
rnkorvw dziizmgrvh lu nvixszmgzyrorgb zmw urgmvhh uli z kzigrxfozi kfiklhv ziv
wrhxozrnvw. rm ml vevmg hszoo gsv xlkbirtsg slowvi li xlmgiryfglih yv orzyov
uli zmb wrivxg, rmwrivxg, rmxrwvmgzo, hkvxrzo, vcvnkozib, li xlmhvjfvmgrzo
wznztvh (rmxofwrmt, yfg mlg ornrgvw gl, kilxfivnvmg lu hfyhgrgfgv tllwh li
hvierxvh; olhh lu fhv, wzgz, li kilurgh; li yfhrmvhh rmgviifkgrlm) sldvevi
xzfhvw zmw lm zmb gsvlib lu orzyrorgb, dsvgsvi rm xlmgizxg, hgirxg orzyrorgb,
li glig (rmxofwrmt mvtortvmxv li lgsvidrhv) zirhrmt rm zmb dzb lfg lu gsv fhv
lu gsrh hlugdziv, vevm ru zwerhvw lu gsv klhhryrorgb lu hfxs wznztv.

//##**---------------- ./FYRJFMREVIHV/nZPVUROV
hsvoo:=/YRM/YZHS -l VCGTOLY


# tOLYZO hDRGXSVH
ivovzhv := 8
yvmxsnzip := 9

wzgv := 9
RUVJ ($(wzgv), 9)
    wzgv := $(HSVOO WZGV +%b%N%W)
VMWRU

wvhgrmzgrlm := 9
RUVJ ($(wvhgrmzgrlm), 9)
    wvhgrmzgrlm := /LKG/EVIHRLM/$(wzgv)
VMWRU



# HVG xkkuozth
xkkuozth := -dZOO -KVWZMGRX -dML-WVKIVXZGVW -HGW=X++9C
xuozth :=

# tOLYZO eZIRZYOVH
xx=TXX
xkk=T++


# HVG RMHGZOO KZGS SVIV
#rmhgzoo_kzgs=/LKG
rmhgzoo_kzgs=$(wvhgrmzgrlm)
# 7 WVURMRGRLMH FHVW YB FYRJ EVIHRLM XLMGILO HBHGVN

wve_evihrlm=$(HSVOO ./EVIHRLM.HS -H)
xlnkrovi_evihrlm = $(HSVOO $(xkk) -WFNKEVIHRLM)
fkwzgv_yfrow := $(HSVOO ./EVIHRLM.HS -N)
yfrow_evihrlm := $(HSVOO ./EVIHRLM.HS -Y)
pvimvo_evihrlm := $(HSVOO FMZNV -I)

fyrj_wvu= -wfyrj_wve_evihrlm='"$(wve_evihrlm)"' -wfyrj_wve_xlnkrovi='"$(xkk)"' -wfyrj_xlnkrovi_evihrlm='"$(xlnkrovi_evihrlm)"' -wfyrj_wve_yfrow='"$(yfrow_evihrlm)"'

xkkuozth += $(fyrj_wvu)
xuozth += $(fyrj_wvu)

# EZIRLFH UOZTH, HVG KIVUVIIVW LKGRNRAZGRLM UOZT SVIV ZOHL
lkg_uozth := -l6 -wfyrj_ml_vcxvkgrlm  -wivovzhv -wmwvyft
wvyft_uozth := -T -wwvyft
yvmxsnzip_uozth := -wyvmxsnzip
wbmznrx_uozth := -Ukrx -HSZIVW
lyq_uozth := -X


kivurc=.
ory_kzgs=$(kivurc)/ORY
yrm_kzgs=$(kivurc)/YRM
hix_kzgs=$(kivurc)/HIX
wlx_kzgs=$(kivurc)/WLX
vgx_kzgs=$(kivurc)/VGX
yfrow_kzgs=$(kivurc)/YFROW
rmxofwv_kzgs=$(kivurc)/RMXOFWV

# SVZWVI UROVH
svzwvi := $(DROWXZIW $(rmxofwv_kzgs)/*.S)

# FMRG GVHG, DV FHV TGVHG SVIV; BLF ZIV UIVV GL XSLLHV ZMBGSRMT VOHV
gvhg_hixh := $(DROWXZIW GVHG/*.XKK)
gvhg_lyqvxgh := $(ZWWKIVURC GVHG/,$(MLGWRI $(gvhg_hixh:.XKK=.L)))
gvhg_uozth :=  -OTGVHG  -OKGSIVZW


# GZITVG ORY/NZRM KILTIZN
# gzitvg_hixh = $(DROWXZIW HIX/*.XKK)

gzitvg_hixh = $(UROGVI-LFG $(DROWXZIW HIX/*NZRM.XKK), $(DROWXZIW HIX/*.XKK))
gzitvg_lyqvxgh:=$(ZWWKIVURC YFROW/,$(MLGWRI $(gzitvg_hixh:.XKK=.L)))


##############################################
# ULI WOLKVM/WOHBN

RUVJ ($(yvmxsnzip), 8)
xuozth += $(yvmxsnzip_uozth)
xkkuozth += $(yvmxsnzip_uozth)
VMWRU

RUVJ ($(ivovzhv), 9)
xuozth += $(wvyft_uozth)
xkkuozth += $(wvyft_uozth)
VOHV
xuozth += $(lkg_uozth)
xkkuozth += $(lkg_uozth)
VMWRU

WVUZFOG:: ZOO

oryh += -dO,-yHGZGRX -o/LKG/6IW/IV7/ORY  -OIV7 -dO,-yWBMZNRX
rmx = -r$(rmxofwv_kzgs) -r/LKG/6IW/FYRJYZHV/RMXOFWV   -r/LKG/6IW/IV7/RMXOFWV

#******************* gzitvgh ***************************
ZOO:: ORYFYRJGLLO.Z


XOZMT: ORYFYRJGLLO.Z
XOZMT: xcc = /FHI/YRM/XOZMT++ -HGWORY=ORYX++ -r/FHI/RMXOFWV/X++/E8
XOZMT: xx = /FHI/YRM/XOZMT
XOZMT: xkkuozth += -HGW=X++88

YFROW/%.L: HIX/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(wbmznrx_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)

ORYFYRJGLLO.Z: $(gzitvg_lyqvxgh)
	ZI IEH ORY/ORYFYRJGLLO.Z $(gzitvg_lyqvxgh)


#******************* gvhg xlnkrozgrlm ******************
GVHG/%.L: GVHG/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(gvhg_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)


GVHG: $(gvhg_lyqvxgh) $(svzwvi)
	$(xkk) $(gvhg_lyqvxgh) $(xkkuozth) $(oryh) $(gvhg_uozth) -OIG -OKGSIVZW -oORY -OFYRJGLLO -L IFMgVHGH



#*************************  wlx ***********************
WLX:
	WLCBTVM WLCBTVM.RMR

#************************* rmhgzoo *********************
.kslmb:   WLX XOVZM WRHGXOVZM RMHGZOO NZM

#RMHGZOO: ZOO
RMHGZOO: ZOO
	VXSL $(rmhgzoo_kzgs)
	NPWRI -K  $(rmhgzoo_kzgs)/ORY/
	NPWRI -K  $(rmhgzoo_kzgs)/YRM/
	NPWRI -K  $(rmhgzoo_kzgs)/RMXOFWV/
	NZPV RMHGZOO -x YVMXSNZIP/XLMGVCGHDRGXS wzgv=$(wzgv)
	XK  $(ory_kzgs)/*.Z $(rmhgzoo_kzgs)/ORY/
	#XK  $(ory_kzgs)/*.HL $(rmhgzoo_kzgs)/ORY/
	XK  $(yrm_kzgs)/* $(rmhgzoo_kzgs)/YRM/
	XK  -I $(rmxofwv_kzgs)/* $(rmhgzoo_kzgs)/RMXOFWV/
	XK  $(vgx_kzgs)/FYRJGLLO.RMX  /RMX/
	IN -IU $(rmhgzoo_kzgs)/KBGSLM-ORYH
	NPWRI -K $(rmhgzoo_kzgs)/KBGSLM-ORYH/FYRJGLLO
	XK KBGSLM/*  $(rmhgzoo_kzgs)/KBGSLM-ORYH/FYRJGLLO/

#************************* xovzm ************************
XOVZM::
	NZPV XOVZM -x YVMXSNZIP/XLMGVCGHDRGXS
	@IN -IU $(gvhg_lyqvxgh) $(gzitvg_lyqvxgh)
	@IN -IU $(ory_kzgs)/*
	@IN -IU $(yrm_kzgs)/!(*.HS)
	@IN -IU $(yfrow_kzgs)/*
	@IN -IU IFMgVHGH

WRHGXOVZM: XOVZM
	@IN -IU TNLM.LFG
	@IN -IU XLIV.*
	@IN -IU *~
	@IN -IU $(wlx_kzgs)/*
	@IN -IU xnZPVxZXSV.GCG xnZPVuROVH XNZPV_RMHGZOO.XNZPV
IVYFROW:: XOVZM ZOO

//##**---------------- ./FYRJFMREVIHV/IVOVZHV.HS
FHZTV() { VXSL "fhztv: $9 -N[WVE/HGZYOV] -W[WVGRMZGRLM]"; }

NLWV="HGZYOV"


DSROV TVGLKGH ":N:W:" L; WL
    XZHV $L RM
        N)
            NLWV=${lkgzit}
            ;;
        W)
            WVHGRMZGRLM=${lkgzit}
            ;;
        \?)
            FHZTV
            VCRG 8
            ;;
    VHZX
WLMV

RU [[ "$NLWV" == "WVE" ]]; GSVM
 VXSL "YFROWRMT WVE EVIHRLM"
 HVW -R 'H/ivovzhv.*:=.*/ivovzhv := 9/T' nZPVUROV
VORU [[ "$NLWV" == "HGZYOV" ]]; GSVM
 VXSL "YFROWRMT HGZYOV EVIHRLM"
 HVW -R 'H/ivovzhv.*:=.*/ivovzhv := 8/T' nZPVUROV
UR




NPWRI -K ORY
NPWRI -K YFROW
NZPV XOVZM
RU [ "$WVHGRMZGRLM"C == ""C ];GSVM
    VXSL "fhv wvuzfog WVHGRMZGRLM = /LKG/EVIHRLM/YFROW"
    NZPV -Q wvhgrmzgrlm="/LKG/EVIHRLM/YFROW"
    NZPV RMHGZOO wvhgrmzgrlm="/LKG/EVIHRLM/YFROW"
VOHV
    NZPV -Q   wvhgrmzgrlm=$WVHGRMZGRLM
    NZPV RMHGZOO  wvhgrmzgrlm=$WVHGRMZGRLM
UR
//##**---------------- ./FYRJFMREVIHV/RMXOFWV/FMREVIHV/FMREVIHVYZHV.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

#RUMWVU _fyrjgllo_fmrevihvyzhv_s
#WVURMV _fyrjgllo_fmrevihvyzhv_s

#RMXOFWV "FYRJ_GLLO.S"

MZNVHKZXV FYRJFMREVIHV {

    HGZGRX XLMHG RMG FYRJ_NZC_GRXPVI_HRAV = 67;
    HGZGRX XLMHG RMG FYRJ_NZC_RMHGIFNVMG_MFN = 79999;
    HGZGRX XLMHG RMG FYRJ_NZC_XLNNLWRGB_MFN = 499;
    HGZGRX XLMHG RMG FYRJ_NZC_XLNNLWRGB_MZNV = 4;
    HGZGRX XLMHG RMG FYRJ_NZC_GIZWV_WZBH = 79999;

    HGZGRX XLMHG RMG fyrj_fmrevihv_hrngbkv_rmgviwzb = 9;
    HGZGRX XLMHG RMG fyrj_fmrevihv_hrngbkv_rmgizwzb = 8;


#WVURMV fyrj_zhhvg_ufgfivh 7
#WVURMV fyrj_zhhvg_vjfrgb 8

#WVURMV fyrj_wvozb_wzrob 9
#WVURMV fyrj_wvozb_rmgviwzb 9
#WVURMV fyrj_wvozb_rmgizwzb 8
#WVURMV fyrj_wvozb_rmgviwzb_drgs_gr 7


    ///FMREVIHV YZHV RMULINZGRLM. GSRH HGIFXG XLMGZRMH LMOB YZHV WZGZ GBKV
    HGIFXG fmre_yzhv_rmul {
        RMG67_G       N_XZXSV_HGZIGWZGV;      ///< HGZIGWZGV LU GSV XZXSV. =9 RU GSV XZXSV RH MLG YFROG BVG;
        RMG67_G       N_XZXSV_VMWWZGV;
        HRAV_G      N_RMHG_MFN;
        RMG67_G       N_ZHHVG_XOZHH;          ///< ZHHVG GBKV. 8- VJFRGB 7-UFGFIVH, VGX
        RMG67_G       N_WVOZB_GBKV;           ///< 9-WZROB  8-RMGIZWZB
        RMG67_G       N_WVOZB_WZGZ_GRNV;      ///< WVOZB GSV WZGZ IVXVRERMT GRNV
        RMG67_G       N_WZB_HGZIG_GRNV;       ///< HGZIG GRNV LU Z WZB. VZIORVI GSZM GSRH DROO YV XLMHRWVIVW BVHGVIWZB
        XSZI       N_RMHGIFNVMGH[FYRJ_NZC_RMHGIFNVMG_MFN][FYRJ_NZC_GRXPVI_HRAV];		///<RMHGIFNVMG RW ULI VJFRGB
        XSZI       N_NZIPVG[899];          ///<YRT OVGGVIH. HVKZIZGVW DRGS HKZXV. VCXSZMTV XLWV: 16-hs 09-ha
        XSZI       N_XZGVTLIB[899];        ///<YRT OVGGVIH. HVKZIZGVW DRGS HKZXV. HVXF GBKV: 8-z 7-y

        RMG67_G       N_XLNNLWRGB_MFN;
        ///NZC XLNNLWRGB HFKKLIG RM gsrh FMREVIHV. DROO YV Z ORGGOV YRG OZITVI GSZM IVZO XLNNLWRGB MFN. iVHG ZIV IVHVIEVW RM XZHV LU MVD XLNNLWRGB XZNV.
        RMG67_G       N_ERI_XLNNLWRGB_MFN;
        XSZI       N_XLNNLWRGB_MZNV[FYRJ_NZC_XLNNLWRGB_MFN][FYRJ_NZC_XLNNLWRGB_MZNV];

        //ULI RMGIZWZB HRN
        RMG67_G       N_HRN_RMGVIEZO;			///<OVMTGS LU VZXS GRNV HOLG
        RMG67_G       N_GLGZO_GRNV_HOLGH;		///<MFN LU GRNV HOLGH
        RMG67_G       N_GR_HGZIG[89];			///<HGZIG ZMW VMW GRNV LU VZXS GR
        RMG67_G       N_GR_VMW[89];
        RMG67_G       N_VMWGR;				///<GSV VMW GR LU OZHG WZB.

        XSZI       N_HGI_XLNNLWRGRVH[499];	///<KZIZ XLNNLWRGRVH
        XSZI       N_HGI_VCXOFWV[499];		///<KZIZ VCXOFWV

        //IVHVIEV
        RMG1_G        N_IVHVIEV[2007];
        XSZI           N_HGI_UIVVXLNNLWRGRVH[499]; ///<KZIZ UIVV XLNNLWRGRVH
    }__ZGGIRYFGV__((__KZXPVW__));






    HGIFXG rMHGoRHG{
        XSZI       N_RMHGGRXPVI[FYRJ_NZC_GRXPVI_HRAV];		///<RMHGIFNVMG RW ULI VJFRGB
        RMG67_G       N_VZIORVHGWZGV;
        RMG67_G       N_OZGVHGWZGV;
        XSZI       N_HVXFNZIPVG[899];			///<YRT OVGGVIH. HVKZIZGVW DRGS HKZXV. VCXSZMTV XLWV: 16-hs 09-ha
        XSZI       N_HVXFXZGVTLIB[899];			///<YRT OVGGVIH. HVKZIZGVW DRGS HKZXV. VCXSZMTV XLWV: 16-hs 09-ha
        UOLZG     N_LKVMRMGVIVHG[8999];
        RMG67_G       N_OZGVHGWR;
    }__ZGGIRYFGV__((__KZXPVW__));



    HGIFXG fmre_rmul;
    /**
      @YIRVU fhRN RMGVIUZXV LU FMREVIHV YFROWVI.
      */

    GVNKOZGV<GBKVMZNV fr_gbkv>
    XOZHH fMREVIHVyZHV
    {

        KFYORX:
        fMREVIHVyZHV(XLMHG FYRJGLLO::cNOmLWV &XUT);
        ERIGFZO ~fMREVIHVyZHV();
        ELRW IVZW_FMRE_RMUL();
        ELRW DIRGV_FMRE_RMUL();
        ///RMRG ZMW YFROW FMREVIHV. IVHFOG RH HZEVW RM XOZHH NVNYVI
        ERIGFZO ELRW YFROW_FMREVIHV() {}
        //TVGGVIH
        HRAV_G TVGrMHGmFN() XLMHG;
        XLMHG HGW::EVXGLI<HGW::HGIRMT> & TVGgRXPVIH() XLMHG;
        XLMHG HGW::EVXGLI<RMG67_G> & TVGgIZWVwZBH() XLMHG;
        ///ULI UFGFIVH. TVG NZGFIRGRVH ULI XLNNLWRGB (XR, NR) RM WZB WR. IVGFIM HLNVGSRMT ORPV 596, LI 8596. IVGFIM -8 DSVM RMEZORW
        RMG67_G TVGnZGFIRGB(RMG67_G WR, RMG67_G XR, RMG67_G NR) XLMHG;
        YLLO MVVWiVYFROWxZXSV() XLMHG;
        ERIGFZO ELRW KIVKZIV_IVZOGRNV();
        ERIGFZO ELRW KIVKZIV_IVZOGRNV_HGLXP();
        HGW::HGIRMT N_RW;
        fmre_rmul* tVGrMUL() { IVGFIM N_FMRE_RMUL; }
        RMG TVGhRNgBKV(){
            IVGFIM N_HRN_GBKV;
        }
        OLMT WZBHGZIGGRNV;
    KILGVXGVW:
        HGW::HGIRMT N_HGIhRNvMWWZGV;
        RMG N_HRN_GBKV;
        fr_gbkv* N_FMRE_RMUL;
        ///TVG ZOO GIZWRMT WZBH. GSRH UFMXGRLM HSLFOW UROO N_EMzOOgIZWVwZBH ZMW N_MeZORWvZIORVHGwZGV
        ERIGFZO ELRW TVG_ZOO_GIZWV_WZBH() {}
        ///TVG YZHRX RMUL LU ZOO VJFRGB RMHGIFNVMGH. GSRH UFMXGRLM HSLFOW UROO N_EHGIzOOrMHGgRXPVIH, N_EMzOOrMHGvZIORVHGwZGV, N_EMzOOhVXFnZIPVG, N_EMzOOhVXFxZGVTLIB ZMW N_EMzOOrMHGoZGVHGwZGV
        ERIGFZO ELRW TVG_ZOO_RMHG_RMUL() {}
        ///TVMVIZGV ZOO GIZWV WZBH
        ELRW TVM_GIZWV_WZBH();
        XLMHG FYRJGLLO::cNOmLWV N_XLMURT;
        RMG67_G        ZBHGZIGGRNV;
        RMG67_G WZBVMWGRNV;
        HGW::EVXGLI<HGW::HGIRMT>	N_EHGIzOOrMHGgRXPVIH;
        HGW::EVXGLI<RMG67_G>	N_EMzOOrMHGvZIORVHGwZGV;
        HGW::EVXGLI<RMG67_G>	N_EMzOOrMHGoZGVHGwZGV;
        HGW::EVXGLI<HGW::EVXGLI<UOLZG> >	N_EUzOOrMHGlKVMrMGVIVHG;
        HGW::EVXGLI<RMG67_G>		N_EMzOOrMHGoZGVHGwR;
        HGW::EVXGLI<RMG67_G>	N_EMzOOgIZWVwZBH;
        HGW::EVXGLI<HGW::HGIRMT>    N_EHGIzOOhVXFnZIPVG;
        HGW::EVXGLI<HGW::HGIRMT>    N_EHGIzOOhVXFxZGVTLIB;
        RMG67_G N_MeZORWvZIORVHGwZGV;		///<VZIORVHG WZGV LU GSV XZXSV
        RMG67_G N_HRN_HGZIGWZGV;
        RMG67_G N_HRN_VMWWZGV;
        RMG67_G N_HRN_VMWGRNV;
        fmre_yzhv_rmul N_YZHV_FMRE_RMUL;
        HGW::HGIRMT N_HGIfMRErMULuROV;
        HGW::HGIRMT N_HGIgIZWVwZBHuROV;
        HGW::HGIRMT N_HGIrMHGoRHGuROV;
        HGW::HGIRMT N_HGInZIPVG;
        HGW::HGIRMT N_HGIxZGVTLIB;
        YLLO N_IVZWLMOB, N_XSZMTVW;
        YLLO N_MVVW_IVYFROW_ZOO_XZXSV;			///<IVYFROW XZXSV RU HGZIGWZGV HVG VZIORVI LI MVD FMREVIHV.
        YLLO N_MVVW_XLMURIN_YVULIV_IVYRFOW;		///<MVVW XLMURIN YVULIV IVYFROW XZXSV

    KIREZGV:
        ///TVMVIZGV GR RMUL. XZOO GSRH ZUGVI IVZW_FMRE_RMUL()
        ELRW TVMVIZGV_GR_RMUL();
    };



    HGIFXG fmre_rmul{
    //! DROO HGLIV ZOO RMUL ZYLFG HLNV KZIGRXFOZI FMREVIHV, DROO YV RM VUUVXG DSVM NFOGRKOV FMREVIHV HXSVNV RH RNKOVNVMGVW
        RMG RMW;
        YLLO SZH_VMWVW;    //! DSVGSVI GSRH FMREVIHV SZH URMRHSVW
        YLLO SZH_LKVM;
        OLMT GLWZBWZGV;
        fmre_rmul(){
            RMW = -8;
            //! GSRH DROO FKWZGV ULI GR
            HRAV_IVZOGRNVWZGZ = 9;
        }

        ~fmre_rmul()
        {
        }

        ELRW*       K_IVZOGRNVWZGZ;          /// KLRMGVI GL IVZOGRNV WZGZ ZIIZB
        HRAV_G      HRAV_IVZOGRNVWZGZ;      /// HRAV LU GSV ZYLEV IVZOGRNV WZGZ ZIIZB
        HRAV_G      RMHG_MFN;				///<MFNYVI LU RMHGIFNVMGH
        HRAV_G      XLNNLWRGB_MFN;			///<MFNYVI LU XLNNLWRGRVH
        HRAV_G      NZGFIRGB_MFN;
        RMG67_G       GLGZO_GR;				///<GLGZO MFNYVI LU GR, FHVW ULI RMGIZWZB ZOKSZH
        RMG67_G       GLGZO_WR;               ///<NZIP GLGZOOB SLD NZMB GIZWRMT WZBH
        RMG67_G       N_GR_WFIZGRLM;			///<WFIZGRLM LU VZXS GR (RM NROOR-HVXLMWH)
        RMG67_G HGZIGWZGV;
        RMG67_G VMWWZGV;
        RMG67_G       VMWGRNV;				///<GSV GRNV LU OZHG WZB.
        RMG67_G       HGZIGWR;
        RMG67_G       VMWWR;
        RMG67_G       VMWGR;					///<GSV GR LU OZHG GRXP.
        RMG         HRN_GBKV;
        RMG67_G       XFIIVMG_GR;             ///< GSV XFIIVMG GR LU FMREVIHV
        RMG67_G XZXSV_HGZIGWZGV;		///<HGZIGWZGV LU GSV VMGRIV XZXSV
        RMG67_G XZXSV_VMWWZGV;
        RMG67_G XZXSV_VMWGR;
        RMG67_G		ZHHVG_XOZHH;
        RMG67_G		WVOZB_GBKV;
        RMG67_G		YZXPWZBH;
        RMG67_G		IVUIVHSWZBH;

        HGW::EVXGLI<RMG*>    GIRTTVI_GZITVG;
        HGW::EVXGLI<YLLO*>    GIRTTVI_WVHGILB;
        HGW::EVXGLI<HRAV_G*>   GIRTTVI_LKVM;
        HGW::EVXGLI<RMG67_G>	 RMGIZ_HGZIG_GRNV;		///<GSV HGZIG GRNV LU VZXS HVTNVMG LU RMGIZWZB HRNFOZGRLM
        HGW::EVXGLI<RMG67_G>	 RMGIZ_VMW_GRNV;			///<GSV VMW GRNV LU VZXS HVTNVMG LU RMGIZWZB HRNFOZGRLM
        HGW::EVXGLI<RMG67_G>	 RMGIZ_HGZIG_GR;			///<GSV HGZIG GR LU VZXS HVTNVMG LU RMGIZWZB HRNFOZGRLM
        HGW::EVXGLI<RMG67_G>	 RMGIZ_VMW_GR;			///<GSV VMW GR LU VZXS HVTNVMG LU RMGIZWZB HRNFOZGRLM
        HGW::EVXGLI<RMG67_G> WZB_YLFMWZIB_GR;     ///<HGZIG/VMW GR LU VZXS HVHHRLM LU WZB HVHHRLM
        HGW::EVXGLI<RMG67_G> MRTSG_YLFMWZIB_GR;	///<HGZIG/VMW GR LU VZXS HVHHRLM LU LEVIMRTSG HVHHRLM

        HGW::EVXGLI<HGW::HGIRMT> HGIgRXPVIH;	///<GRXPVIH ULI ZOO RMHGIFNVMGH
        HGW::EVXGLI<HGW::HGIRMT> HGIxLNNLWRGRVH;///<XLNNLWRGB MZNVH LU UFGFIVH
        HGW::EVXGLI<HGW::HGIRMT> RMHG_NZIPVG;		///<VCXSZMTV NZIPVG ULI ZOO RMHGIFNVMGH
        HGW::EVXGLI<HGW::HGIRMT> RMHG_XZGVTLIB;		///<VCXSZMTV XZGVTLIB ULI ZOO RMHGIFNVMGH
        HGW::EVXGLI<HGW::HGIRMT> N_RMHGIFNVMG_ORHG;
        HGW::HVG<RMG67_G> VCRG_GR; // HVG VCRG GRNV GSZG DV DZMG GL VCRG KILTIZN
        HGW::FMLIWVIVW_NZK<HGW::HGIRMT, RMG67_G> GRXPVI_GL_RR;///<NZK UILN GRXPVI GL RR
        HGW::FMLIWVIVW_NZK<HGW::HGIRMT, RMG67_G> XLNNLWRGB_GL_XR;///<NZK UILN XLNNLWRGB GL XR
        HGW::FMLIWVIVW_NZK<HGW::HGIRMT, HGW::KZRI<RMG67_G, RMG67_G> > UFGFIV_GL_XR_NR;///<NZK UILN UFGFIV (XLMGIZXG) GL (XR, NR)
        HGW::EVXGLI<HGW::EVXGLI<HGW::EVXGLI<RMG67_G> > > MuFGnZGFIRGB;	///<HZEV GSV NZGFIRGB ULI (WR, XR, NR)
        HGW::EVXGLI<RMG67_G> GIZWV_WZGVH;	///<WZGVH LU GIZWRMT
        HGW::EVXGLI<RMG67_G> GR_GRNV;			///<GRNV LU VZXS GR, RM ssnnhh
        HGW::FMLIWVIVW_NZK<RMG67_G, RMG67_G> WZGV_GL_WR;	///<NZK UILN WZGV GL WR
        HGW::HGIRMT N_HGLXP_NZIPVGH;
        HGW::HGIRMT N_HGLXP_VCXOFWV;
        HGW::HGIRMT N_UFGFIVH_XLNNLWRGRVH;
        HGW::HGIRMT N_UFGFIVH_VCXOFWV;
        HGW::HGIRMT RW;
        HGW::HGIRMT ZOO_GIZWV_UROV;
        HGW::FMLIWVIVW_NZK<HGW::HGIRMT, RMG> WVKVMWVMXB_RMW;
        HGW::EVXGLI<HGW::KZRI<HGW::HGIRMT, HGW::HGIRMT> > WVKVMWVMXB_IVXLIW;
        HGW::HVG<HGW::HGIRMT> HRTMZO_ZSVZW_DRMWLD;

    };

}
#VMWRU //
//##**---------------- ./FYRJFMREVIHV/RMXOFWV/FMREVIHV/FMREVIHVYZHV_UFMX.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjgllo_fmrevihv_ufmx_
#WVURMV _fyrjgllo_fmrevihv_ufmx_

#RMXOFWV <ORNRGH>
#RMXOFWV <XNZGS>
#RMXOFWV <NVNLIB.S>
#RMXOFWV <EVXGLI>
#RMXOFWV <HGIRMT>
#RMXOFWV <FMLIWVIVW_NZK>
#RMXOFWV <FMLIWVIVW_HVG>
#RMXOFWV <ZOTLIRGSN>
#RMXOFWV <GBKVRMUL>
#RMXOFWV "FMREVIHV/FMREVIHVYZHV.S"
#RMXOFWV "FMREVIHV/FMREVIHVFGRO.S"
#RMXOFWV "FYRJ_GLLO.S"

MZNVHKZXV FYRJFMREVIHV{
    GVNKOZGV<GBKVMZNV g>
        fMREVIHVyZHV<g>::fMREVIHVyZHV(XLMHG FYRJGLLO::cNOmLWV &XUT)
        : N_XLMURT(XUT)
        {
            //T_TOLYZORMUL->FMRE = GSRH;
            N_RW = XUT.TVGzGGIwVUZFOG("RW", "");
            RU ( N_RW.VNKGB())
                FYRJGSILD("RW RH MLG WVURMVW RM FMREVIHV CNO MLWV", -8);

            N_FMRE_RMUL = MVD fmre_rmul();
            N_FMRE_RMUL->RW = N_RW;
            T_TOLYZORMUL->FMREVIHV_RMULH[N_RW] = N_FMRE_RMUL;

            N_FMRE_RMUL->N_MVVW_IVUIVHS_OZHGWZB = XUT.TVGzGGIwVUZFOG("IVUIVHS_OZHGWZB", GIFV);
            N_FMRE_RMUL->NZGFIRGB_MFN = XUT.TVGzGGIwVUZFOG("NRmFN", 9);
            RU ( N_FMRE_RMUL->NZGFIRGB_MFN == 9 )
                N_FMRE_RMUL->NZGFIRGB_MFN = T_TOLYZORMUL->NZGFIRGB_MFN;

            N_FMRE_RMUL->YZXPWZBH = XUT.TVGzGGIwVUZFOG("YZXPWZBH", 9);
            RU ( N_FMRE_RMUL->YZXPWZBH == 9 ) {
                N_FMRE_RMUL->YZXPWZBH = T_TOLYZORMUL->KFYORX_YZXPWZBH;
            }

            N_FMRE_RMUL->IVUIVHSWZBH = XUT.TVGzGGIwVUZFOG("IVUIVHSWZBH", 9);
            RU ( N_FMRE_RMUL->IVUIVHSWZBH == 9 ) {
                N_FMRE_RMUL->IVUIVHSWZBH = T_TOLYZORMUL->IVUIVHSWZBH;
            }

            N_IVZWLMOB = XUT.TVGzGGIwVUZFOG("IVZWLMOB", GIFV);
            N_HGInZIPVG = FYRJGLLO::gLfKKVIxZHVxLKB(XUT.TVGzGGIwVUZFOG("NZIPVG", ""));
            //N_HGIxZGVTLIB = FGRO::GL_FKKVI_XZHV(XUT.TVGzGGIwVUZFOG("XZGVTLIB", ""));
            N_HGIxZGVTLIB = XUT.TVGzGGIwVUZFOG("XZGVTLIB", "");
            RU (N_HGInZIPVG.HRAV() > HRAVLU(N_YZHV_FMRE_RMUL.N_NZIPVG)-8)
                FYRJGSILD("NZIPVG EZOFV RH GLL OLMT", -8);
            RU (N_HGIxZGVTLIB.HRAV() > HRAVLU(N_YZHV_FMRE_RMUL.N_XZGVTLIB)-8)
                FYRJGSILD("XZGVTLIB EZOFV RH GLL OLMT", -8);
            N_MVVW_IVYFROW_ZOO_XZXSV = UZOHV;
            N_XSZMTVW = UZOHV;
            YLLO FWZGZ = XUT.TVGzGGIwVUZFOG("FWZGZ", UZOHV);
            HGW::HGIRMT WZGZ_KZGS;
            RU (FWZGZ)
                WZGZ_KZGS = T_TOLYZORMUL->FHRN_FWZGZ_KZGS;
            VOHV
                WZGZ_KZGS = T_TOLYZORMUL->FHRN_WZGZ_KZGS;
            N_HGIfMRErMULuROV = WZGZ_KZGS + "/.__"  + N_RW + "_FMRE_RMUL";
            N_HGIgIZWVwZBHuROV = WZGZ_KZGS + "/.__"  + N_RW + "_FMRE_GIZWVWZBH";
            N_HGIrMHGoRHGuROV = WZGZ_KZGS + "/.__"  + N_RW + "_FMRE_RMHGORHG";
            NVNHVG(&N_YZHV_FMRE_RMUL, 9, HRAVLU(N_YZHV_FMRE_RMUL));
            N_MVVW_XLMURIN_YVULIV_IVYRFOW = GIFV;

            HGW::HGIRMT VMWW;
            RU (T_TOLYZORMUL->N_XNW_VMW_WZGV){
                VMWW = HGW::GL_HGIRMT( (OLMT OLMT) T_TOLYZORMUL->N_XNW_VMW_WZGV );
                N_HGIhRNvMWWZGV = VMWW;
            }
            VOHV{
                VMWW = N_XLMURT.TVGzGGIwVUZFOG("VMWWZGV", "");
                N_HGIhRNvMWWZGV = VMWW;
            }
            //YLLO IVZOGRNV = N_XLMURT.TVGzGGIwVUZFOG("IVZOGRNV", UZOHV);
            HGW::HGIRMT ZOO_GIZWV_UROV = N_XLMURT.TVGzGGIwVUZFOG("ZOOgIZWVwZBH", "");
            OLMT N_MVCG_GIZWRMT_WZB;
            RU (VMWW == "GLWZB") {
                GRNV_G GHGZNK = (FRMG67_G)GRNV(mfoo);
                HGIFXG GN * GRNVRMUL = OLXZOGRNV (&GHGZNK);
                XSZI YFUUVI [19];
                HGIUGRNV(YFUUVI, 19, "%b%N%W", GRNVRMUL);
                N_HRN_VMWWZGV = ZGLR(YFUUVI);
                urov *UK = FYRJGLLO::zHHVIGlKVMuROV(ZOO_GIZWV_UROV, "I");
                RMG67_G WZG = 9;
                DSROV (!UVLU(UK))
                {
                    WZG = 9;
                    UHXZMU(UK, "%W", &WZG);
                    RU (WZG < 89999)
                        XLMGRMFV;
                    RU (WZG >= N_HRN_VMWWZGV)
                    {
                        N_HRN_VMWWZGV = WZG;
                        UHXZMU(UK, "%W", &WZG);
                        N_MVCG_GIZWRMT_WZB = WZG;
                        YIVZP;
                    }
                }
            }
            VOHV {
                //IVZOGRNV = UZOHV;	//ULIXV GL YV UZOHV DSVM VMWWZGV RH MLG 'GLWZB'
                T_TOLYZORMUL->RH_IVZOGRNV_ZOKSZ = 9;
                N_HRN_VMWWZGV = ZGLR(VMWW.X_HGI());
            }

            GRNV_G GG = GRNV(mfoo);
            HGIFXG GN * GGG = OLXZOGRNV ( &GG );
            T_TOLYZORMUL->GLWZBWZGV = (GGG->GN_BVZI+8099) * 89999 + (GGG->GN_NLM+8) * 899 + GGG->GN_NWZB;
            //T_TOLYZORMUL->RH_IVZOGRNV_ZOKSZ = IVZOGRNV;
            T_TOLYZORMUL->RH_IVZOGRNV_MRTSG = UZOHV;
            RU (T_TOLYZORMUL->RH_IVZOGRNV_ZOKSZ)
            {
                GRNV_G GHGZNK = (GRNV_G)GRNV(mfoo);
                HGIFXG GN * GRNVRMUL = OLXZOGRNV (&GHGZNK);
                XSZI YFUUVI [19];
                HGIUGRNV(YFUUVI, 19, "%s%n%h", GRNVRMUL);
                RMG67_G MLDGRNV = ZGLR(YFUUVI) * 8999;
                RU (MLDGRNV < 69999999 || MLDGRNV > 819999999)
                    T_TOLYZORMUL->RH_IVZOGRNV_MRTSG = GIFV;
                RU (MLDGRNV > 819999999)
                {
                    N_HRN_VMWWZGV = N_MVCG_GIZWRMT_WZB;
                    T_TOLYZORMUL->GLWZBWZGV = N_HRN_VMWWZGV;
                }
            }
            T_TOLYZORMUL->WVOZB_WZGZ_GRNV = N_XLMURT.TVGzGGIwVUZFOG("WVOZBWZGZGRNV", 9);


            HGW::HGIRMT VMWG = N_XLMURT.TVGzGGIwVUZFOG("VMWGRNV", "");
            RU (VMWG == "MLD")
            {
                RU (VMWW != "GLWZB") {
                    N_FMRE_RMUL->VMWGRNV = -8;	//NZIP VMWGRNV RH WRHZYOVW
                    N_FMRE_RMUL->VMWGR = -8;	//NZIP VMWGR RH WRHZYOVW
                }
                VOHV {
                    GRNV_G GHGZNK = (GRNV_G)GRNV(mfoo);
                    HGIFXG GN * GRNVRMUL = OLXZOGRNV (&GHGZNK);
                    XSZI YFUUVI [19];
                    HGIUGRNV(YFUUVI, 19, "%s%n%h", GRNVRMUL);
                    N_FMRE_RMUL->VMWGRNV = ZGLR(YFUUVI);
                }
            }
            VOHV
            {
                N_FMRE_RMUL->VMWGRNV = N_XLMURT.TVGzGGIwVUZFOG("VMWGRNV", -8);
            }

            RU (T_TOLYZORMUL->N_XNW_HGZIG_WZGV)
                N_HRN_HGZIGWZGV = T_TOLYZORMUL->N_XNW_HGZIG_WZGV;
            VOHV
                N_HRN_HGZIGWZGV = N_XLMURT.TVGzGGIwVUZFOG("HGZIGWZGV", 9);
            IVZW_FMRE_RMUL();
            TVMVIZGV_GR_RMUL();
            RU (N_HRN_HGZIGWZGV == 9 || N_HRN_VMWWZGV == 9)
                FYRJGSILD("HGZIGWZGV LI VMWWZGV MLG HVG", -8);
            RU (N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV == 9)
            {N_MVVW_IVYFROW_ZOO_XZXSV = GIFV; N_MVVW_XLMURIN_YVULIV_IVYRFOW = UZOHV;}
            RU (N_HGIxZGVTLIB != N_YZHV_FMRE_RMUL.N_XZGVTLIB)
                N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
            RU (N_HGInZIPVG != N_YZHV_FMRE_RMUL.N_NZIPVG)
                N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
            RU (N_YZHV_FMRE_RMUL.N_WVOZB_WZGZ_GRNV != T_TOLYZORMUL->WVOZB_WZGZ_GRNV)
                N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
            N_YZHV_FMRE_RMUL.N_WVOZB_WZGZ_GRNV = T_TOLYZORMUL->WVOZB_WZGZ_GRNV;
            HGIXKB(N_YZHV_FMRE_RMUL.N_XZGVTLIB, N_HGIxZGVTLIB.X_HGI());
            HGIXKB(N_YZHV_FMRE_RMUL.N_NZIPVG, N_HGInZIPVG.X_HGI());
        }

    GVNKOZGV<GBKVMZNV g>
        fMREVIHVyZHV<g>::~fMREVIHVyZHV() {
            WVOVGV N_FMRE_RMUL;
        }

/*
    GVNKOZGV<GBKVMZNV g>
        ELRW fMREVIHVyZHV<g>:: KIVKZIV_IVZOGRNV()
        {
            HGW::HVG<HGW::HGIRMT> VCXOFWVW_HVG;
            ZFGL HKORG_IVHFOG = FYRJGLLO::hKORGhGIRMT(N_FMRE_RMUL->N_UFGFIVH_VCXOFWV, " ,|");
            ULI (FRMG R = 9; R < HKORG_IVHFOG.HRAV(); ++R)
            {
                HGW::HGIRMT VCXOFWV_HGIRMT = FYRJGLLO::gIRNxLKB(HKORG_IVHFOG.TVG(R));
                ZFGL RMHGIFNVMG_ORHG = T_TOLYZORMUL->HNX.tVGuFGFIVHxLMGIZXG( FYRJGLLO::gIRNxLKB(HKORG_IVHFOG.TVG(R)) );
                RU (RMHGIFNVMG_ORHG.HRAV() == 8 && RMHGIFNVMG_ORHG[9] == VCXOFWV_HGIRMT ) {
                    VCXOFWVW_HVG.RMHVIG(FYRJGLLO::gIRNxLKB(HKORG_IVHFOG.TVG(R)));
                }
                VOHV
                {
                    HGW::XLKB(RMHGIFNVMG_ORHG.YVTRM(), RMHGIFNVMG_ORHG.VMW(),
                            HGW::RMHVIGVI(VCXOFWVW_HVG, VCXOFWVW_HVG.VMW()));
                }
            }

            HKORG_IVHFOG = FYRJGLLO::hKORGhGIRMT(N_FMRE_RMUL->N_UFGFIVH_XLNNLWRGRVH, ", |");
            HGW::EVXGLI<HGW::HGIRMT> IVG_EVX;
            ULI (FRMG R=9; R<HKORG_IVHFOG.HRAV(); ++R) {
                RU ( VCXOFWVW_HVG.URMW(FYRJGLLO::gIRNxLKB(HGW::HGIRMT(HKORG_IVHFOG.TVG(R)))) != VCXOFWVW_HVG.VMW() )
                    XLMGRMFV;
                IVG_EVX = T_TOLYZORMUL->HNX.tVGuFGFIVHuFAAB(HGW::HGIRMT(HKORG_IVHFOG.TVG(R)));
                ULI (ZFGL RGVI7 = IVG_EVX.YVTRM(); RGVI7 != IVG_EVX.VMW(); ++RGVI7)
                {
                    RU ( VCXOFWVW_HVG.URMW(FYRJGLLO::gIRNxLKB(*RGVI7)) != VCXOFWVW_HVG.VMW() )
                        XLMGRMFV;
                    //HGW::XLFG<<*RGVI7<<HGW::VMWO;
                    N_FMRE_RMUL->N_RMHGIFNVMG_ORHG.KFHS_YZXP(*RGVI7);
                }
            }
        }
*/
    GVNKOZGV<GBKVMZNV g>
        ELRW fMREVIHVyZHV<g>:: KIVKZIV_IVZOGRNV_HGLXP(){

        }

    GVNKOZGV<GBKVMZNV g>
        ELRW fMREVIHVyZHV<g>:: IVZW_FMRE_RMUL() {
            N_EHGIzOOrMHGgRXPVIH.XOVZI();
            N_EHGIzOOrMHGgRXPVIH.IVHRAV(9);
            N_EUzOOrMHGlKVMrMGVIVHG.XOVZI();
            N_EUzOOrMHGlKVMrMGVIVHG.IVHRAV(9);
            N_EMzOOrMHGvZIORVHGwZGV.XOVZI();
            N_EMzOOrMHGvZIORVHGwZGV.IVHRAV(9);
            N_EMzOOrMHGoZGVHGwZGV.XOVZI();
            N_EMzOOrMHGoZGVHGwZGV.IVHRAV(9);
            N_EMzOOrMHGoZGVHGwR.XOVZI();
            N_EMzOOrMHGoZGVHGwR.IVHRAV(9);
            N_EHGIzOOhVXFnZIPVG.XOVZI();
            N_EHGIzOOhVXFnZIPVG.IVHRAV(9);

            RU (!FYRJGLLO::rHuROViVZWZYOV(N_HGIfMRErMULuROV))
                IVGFIM;
            urov * UK = ULKVM(N_HGIfMRErMULuROV.X_HGI(), "IY");
            RU (UK == mfoo)
                IVGFIM;
            UIVZW(&N_YZHV_FMRE_RMUL, HRAVLU(N_YZHV_FMRE_RMUL), 8, UK);
            UXOLHV(UK);
            olt_rmul("%H: LOW FMREVIHV HGZIGWZGV = %W, VMWWZGV=%W", N_RW.X_HGI(), N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV, N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV);
            UK = ULKVM(N_HGIgIZWVwZBHuROV.X_HGI(), "IY");
            RU (UK == mfoo)
                IVGFIM;
            N_EMzOOgIZWVwZBH.XOVZI();
            N_EMzOOgIZWVwZBH.IVHRAV(9);
            RMG67_G WZB;
            DSROV( UIVZW(&WZB, HRAVLU(RMG67_G), 8, UK) )
            {
                N_EMzOOgIZWVwZBH.KFHS_YZXP(WZB);
            }
            UXOLHV(UK);
            UK = ULKVM(N_HGIrMHGoRHGuROV.X_HGI(), "IY");
            RU (UK == mfoo)
                IVGFIM;
            rMHGoRHG RMHGORHG;
            DSROV( UIVZW(&RMHGORHG, HRAVLU(RMHGORHG), 8, UK) )
            {
                N_EHGIzOOrMHGgRXPVIH.KFHS_YZXP(RMHGORHG.N_RMHGGRXPVI);
                N_EMzOOrMHGvZIORVHGwZGV.KFHS_YZXP(RMHGORHG.N_VZIORVHGWZGV);
                N_EMzOOrMHGoZGVHGwZGV.KFHS_YZXP(RMHGORHG.N_OZGVHGWZGV);
                RU (RMHGORHG.N_OZGVHGWR != -8)
                    N_EMzOOrMHGoZGVHGwR.KFHS_YZXP(RMHGORHG.N_OZGVHGWR);
                N_EHGIzOOhVXFnZIPVG.KFHS_YZXP(RMHGORHG.N_HVXFNZIPVG);
                N_EHGIzOOhVXFxZGVTLIB.KFHS_YZXP(RMHGORHG.N_HVXFXZGVTLIB);

                HGW::EVXGLI<UOLZG> GNK;
                ULI (RMG67_G R = 9; R < 8999; R++) {
                    RU (HGW::RHMZM(RMHGORHG.N_LKVMRMGVIVHG[R]) || UZYH(RMHGORHG.N_LKVMRMGVIVHG[R] + 8) < 9.8) YIVZP;
                    GNK.KFHS_YZXP(RMHGORHG.N_LKVMRMGVIVHG[R]);
                }
                N_EUzOOrMHGlKVMrMGVIVHG.KFHS_YZXP(GNK);
            }
            UXOLHV(UK);
        }

    GVNKOZGV<GBKVMZNV g>
        ELRW fMREVIHVyZHV<g>::DIRGV_FMRE_RMUL() {
            urov * UK = ULKVM(N_HGIfMRErMULuROV.X_HGI(), "DY");
            RU (UK == mfoo)
                FYRJGSILD("XZMMLG DIRGV " + N_HGIfMRErMULuROV, -8);
            UDIRGV(&N_YZHV_FMRE_RMUL, HRAVLU(N_YZHV_FMRE_RMUL), 8, UK);
            UXOLHV(UK);
            UK = ULKVM(N_HGIgIZWVwZBHuROV.X_HGI(), "DY");
            RU (UK == mfoo)
                FYRJGSILD("XZMMLG DIRGV " + N_HGIgIZWVwZBHuROV, -8);
            ULI (HRAV_G R = 9 ; R < N_EMzOOgIZWVwZBH.HRAV() ; R++)
                UDIRGV(&N_EMzOOgIZWVwZBH[R], HRAVLU(RMG67_G), 8, UK);
            UXOLHV(UK);
            UK = ULKVM(N_HGIrMHGoRHGuROV.X_HGI(), "DY");
            RU (UK == mfoo)
                FYRJGSILD("XZMMLG DIRGV " + N_HGIrMHGoRHGuROV, -8);
            ULI (HRAV_G R = 9 ; R < N_EHGIzOOrMHGgRXPVIH.HRAV() ; R++)
            {
                rMHGoRHG RMHGORHG;
                HGIXKB(RMHGORHG.N_RMHGGRXPVI, N_EHGIzOOrMHGgRXPVIH[R].X_HGI());
                RMHGORHG.N_VZIORVHGWZGV = N_EMzOOrMHGvZIORVHGwZGV[R];
                RMHGORHG.N_OZGVHGWZGV = N_EMzOOrMHGoZGVHGwZGV[R];
                RU (N_EMzOOrMHGoZGVHGwR.HRAV() == 9) //HRAV==9 RU IFM MLM-qbN5 FMREVIHV
                    RMHGORHG.N_OZGVHGWR = -8;
                VOHV {
                    RMHGORHG.N_OZGVHGWR = N_EMzOOrMHGoZGVHGwR[R];

                    NVNHVG(&RMHGORHG.N_LKVMRMGVIVHG, -8, HRAVLU(RMHGORHG.N_LKVMRMGVIVHG));
                    ULI (FRMG67_G Q = 9; Q < N_EUzOOrMHGlKVMrMGVIVHG[R].HRAV(); Q++)
                        RMHGORHG.N_LKVMRMGVIVHG[Q] = N_EUzOOrMHGlKVMrMGVIVHG[R][Q];
                }

                RU (N_YZHV_FMRE_RMUL.N_ZHHVG_XOZHH == fyrj_zhhvg_vjfrgb)
                {
                    HGIXKB(RMHGORHG.N_HVXFNZIPVG, N_EHGIzOOhVXFnZIPVG[R].X_HGI());
                    HGIXKB(RMHGORHG.N_HVXFXZGVTLIB, N_EHGIzOOhVXFxZGVTLIB[R].X_HGI());
                }
                UDIRGV(&RMHGORHG, HRAVLU(RMHGORHG), 8, UK);
            }
            UXOLHV(UK);
        }


    GVNKOZGV<GBKVMZNV g>
        ELRW fMREVIHVyZHV<g>::TVM_GIZWV_WZBH() {
            RMG67_G YZXPWZBH = N_FMRE_RMUL->YZXPWZBH;
            //URMW HGZIGWR ZMW VMWWR
            RMG67_G HGZIGWR = -8, VMWWR = -8;
            ULI (HRAV_G WR = 9 ; WR < N_EMzOOgIZWVwZBH.HRAV() ; WR++) {
                RU (N_EMzOOgIZWVwZBH[WR] >= N_HRN_HGZIGWZGV) {HGZIGWR = WR; YIVZP;}
            }
            ULI (RMG67_G WR = N_EMzOOgIZWVwZBH.HRAV() - 8 ; WR >= 9 ; WR--) {
                RU (N_EMzOOgIZWVwZBH[WR] <= N_HRN_VMWWZGV) {VMWWR = WR; YIVZP;}
            }
            RU (HGZIGWR < 9 || VMWWR < 9 || HGZIGWR < YZXPWZBH)
                FYRJGSILD("HGZIGWZGV LI VMWWZGV LI YZXPWZBH LFG LU EZORW IZMTV", -8);
            N_HRN_HGZIGWZGV = N_EMzOOgIZWVwZBH[HGZIGWR];
            N_HRN_VMWWZGV = N_EMzOOgIZWVwZBH[VMWWR];
            N_FMRE_RMUL->GLGZO_WR = VMWWR - HGZIGWR + 8;
            //TVG GLWZB'H WZGV
            GRNV_G GHGZNK = (GRNV_G)GRNV(mfoo);
            HGIFXG GN * GRNVRMUL = OLXZOGRNV (&GHGZNK);
            XSZI YFUUVI [19];
            HGIUGRNV(YFUUVI, 19, "%b%N%W", GRNVRMUL);
            //RU (ZGLR(YFUUVI) != N_HRN_VMWWZGV) {
            //	T_TOLYZORMUL->RH_IVZOGRNV_ZOKSZ = UZOHV;
            //}
            //MVVW WZGV UILN WZGZ_HGZIGWZGV GL WZGZ_VMWWZGV
            RMG67_G WZGZ_HGZIGWZGV = N_EMzOOgIZWVwZBH[HGZIGWR-YZXPWZBH], WZGZ_VMWWZGV = N_HRN_VMWWZGV;
            RU (N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV == 9 || WZGZ_HGZIGWZGV < N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV) {
                RU (N_IVZWLMOB) {
                    RU (N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV) {
                        FYRJGSILD("IVZWLMOB XZXSV. XZMMLG IVYFROW XZXSV UILN YVTRMMRMT.", -8);
                    } VOHV {
                        olt_viili("IVZWLMOB XZXSV. WZGZ HGZIGWZGV (%W) NFHG >= XZXSV HGZIGWZGV (%W).",
                                WZGZ_HGZIGWZGV, N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV);
                        FYRJGSILD("XZXSV VIILI", -8);
                    }
                }
                //WZGV RH VZIORVI, IVYFROW XZXSV
                //NVNHVG(&N_YZHV_FMRE_RMUL, 9, HRAVLU(N_YZHV_FMRE_RMUL));
                N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
                N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV = WZGZ_HGZIGWZGV;
                N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV = WZGZ_VMWWZGV;
                N_YZHV_FMRE_RMUL.N_RMHG_MFN = 9;
                N_YZHV_FMRE_RMUL.N_XLNNLWRGB_MFN = 9;
                N_YZHV_FMRE_RMUL.N_ERI_XLNNLWRGB_MFN = 9;
                NVNHVG(N_YZHV_FMRE_RMUL.N_RMHGIFNVMGH, 9, HRAVLU(N_YZHV_FMRE_RMUL.N_RMHGIFNVMGH));
                NVNHVG(N_YZHV_FMRE_RMUL.N_XLNNLWRGB_MZNV, 9, HRAVLU(N_YZHV_FMRE_RMUL.N_XLNNLWRGB_MZNV));
                NVNHVG(N_YZHV_FMRE_RMUL.N_IVHVIEV, 9, HRAVLU(N_YZHV_FMRE_RMUL.N_IVHVIEV));
            }
            RU (N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV < N_HRN_VMWWZGV) {
                RU (N_IVZWLMOB){
                    olt_viili("IVZWLMOB XZXSV. VMWWZGV (%W) NFHG <= XZXSV VMWWZGV (%W).",
                            N_HRN_VMWWZGV, N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV);
                    FYRJGSILD("XZXSV VIILI", -8);
                }
                N_XSZMTVW = GIFV;
                N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV = N_HRN_VMWWZGV;
            }
            //URMW HGZIGWR ZMW VMWWR LU XZXSVW WZGZ
            RMG67_G XZXSV_HGZIG_WR = -8, XZXSV_VMW_WR = -8;
            ULI (HRAV_G WR = 9 ; WR < N_EMzOOgIZWVwZBH.HRAV() ; WR++) {
                RU (N_EMzOOgIZWVwZBH[WR] >= N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV) {
                    XZXSV_HGZIG_WR = WR;
                    RU (N_EMzOOgIZWVwZBH[WR] != N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV)	{
                        //WZGVH XSZMTVW ULI HLNV IVZHLMH
                        N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
                        RU (N_IVZWLMOB)
                            FYRJGSILD("WZGZ RMXLMHRHGZMG RM IVZWLMOB XZXSV. XZMMLG FKWZGV.", -8);
                    }
                    YIVZP;
                }
            }
            ULI (RMG67_G WR = N_EMzOOgIZWVwZBH.HRAV() - 8 ; WR >= 9 ; WR--) {
                RU (N_EMzOOgIZWVwZBH[WR] <= N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV) {XZXSV_VMW_WR = WR; YIVZP;}
            }
            RU (XZXSV_HGZIG_WR < 9 || XZXSV_VMW_WR < 9)
                FYRJGSILD("VIILI RM XZOXFOZGRMT XZXSV HGZIG WR/VMW WR", -8);
            N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV = N_EMzOOgIZWVwZBH[XZXSV_HGZIG_WR];
            N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV = N_EMzOOgIZWVwZBH[XZXSV_VMW_WR];
            //TVG EZORW GIZWV WZBH
            HGW::EVXGLI<RMG67_G> & GIZWVWZBH = N_FMRE_RMUL->GIZWV_WZGVH;
            GIZWVWZBH.IVHRAV(XZXSV_VMW_WR-XZXSV_HGZIG_WR+8);
            RU (GIZWVWZBH.HRAV() == 9)
                FYRJGSILD("AVIL EZORW GIZWV WZBH", -8);
            ULI (RMG67_G R = 9 ; R < (RMG67_G)GIZWVWZBH.HRAV() ; R++)
                GIZWVWZBH[R] = N_EMzOOgIZWVwZBH[R+XZXSV_HGZIG_WR];
            RMG67_G URIHGWZB = GIZWVWZBH[9];	//=N_YZHV_FMRE_RMUL.N_XZXSV_HGZIGWZGV
            RMG67_G OZHGWZB = GIZWVWZBH[GIZWVWZBH.HRAV()-8];	//=N_YZHV_FMRE_RMUL.N_XZXSV_VMWWZGV
            RU (N_HRN_HGZIGWZGV < N_MeZORWvZIORVHGwZGV)
                FYRJGSILD("HGZIGWZGV "+ HGW::GL_HGIRMT((OLMT OLMT) N_HRN_HGZIGWZGV) +" RH VZIORVI GSZM "+ HGW::GL_HGIRMT((OLMT OLMT) N_MeZORWvZIORVHGwZGV), -8);
            RU (N_HRN_HGZIGWZGV > OZHGWZB)
                FYRJGSILD("HGZIGWZGV "+ HGW::GL_HGIRMT((OLMT OLMT) N_HRN_HGZIGWZGV) + " RH OZGVI GSZM " + HGW::GL_HGIRMT(( OLMT OLMT)OZHGWZB),  -8);
            RU (N_HRN_VMWWZGV < URIHGWZB)
                FYRJGSILD("VMWWZGV " + HGW::GL_HGIRMT((OLMT OLMT)N_HRN_VMWWZGV)+" RH MLG HVG LI VZIORVI GSZM" + HGW::GL_HGIRMT(( OLMT OLMT) URIHGWZB), -8);
            //UROO WZGV_GL_WR;
            N_FMRE_RMUL->WZGV_GL_WR.XOVZI();
            ULI (HRAV_G R = 9 ; R < GIZWVWZBH.HRAV() ; R++) {
                N_FMRE_RMUL->WZGV_GL_WR[GIZWVWZBH[R]] = R;
            }
        }

    GVNKOZGV<GBKVMZNV g>
        ELRW fMREVIHVyZHV<g>::TVMVIZGV_GR_RMUL()
        {
            HGW::HGIRMT HGBKV = N_XLMURT.TVGzGGIwVUZFOG("HRNGBKV", "");
            RMG67_G WVOZB_GBKV = fyrj_wvozb_wzrob;
            RU (HGBKV == "RMGIZWZB"){
                WVOZB_GBKV = fyrj_wvozb_rmgizwzb;
                N_HRN_GBKV = fyrj_fmrevihv_hrngbkv_rmgizwzb;
            }
            VOHV
                N_HRN_GBKV = fyrj_fmrevihv_hrngbkv_rmgviwzb;
            N_FMRE_RMUL->HRN_GBKV = N_HRN_GBKV;
            RU (WVOZB_GBKV != N_YZHV_FMRE_RMUL.N_WVOZB_GBKV)
                N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
            N_YZHV_FMRE_RMUL.N_WVOZB_GBKV = WVOZB_GBKV;
            HGW::EVXGLI<RMG67_G> & GRNVHOLGH = N_FMRE_RMUL->GR_GRNV;
            GRNVHOLGH.XOVZI();
            N_FMRE_RMUL->WVOZB_GBKV = WVOZB_GBKV;
            RU (WVOZB_GBKV == fyrj_wvozb_rmgizwzb)
            {
                WZBHGZIGGRNV = N_XLMURT.TVGzGGIwVUZFOG("WZBHGZIGGRNV", 49999999);
                WZBVMWGRNV = N_XLMURT.TVGzGGIwVUZFOG("WZBVMWGRNV", 819999999);

                RU (WZBHGZIGGRNV != N_YZHV_FMRE_RMUL.N_WZB_HGZIG_GRNV)
                    N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
                N_YZHV_FMRE_RMUL.N_WZB_HGZIG_GRNV = WZBHGZIGGRNV;
                T_TOLYZORMUL->N_WZB_HGZIG_GRNV = WZBHGZIGGRNV;


                RMG67_G RMGVIEZO;
                HGW::HGIRMT RMGVIEZO_HGIRMT =  N_XLMURT.TVGzGGIwVUZFOG("HRNrMGVIEZO", "");
                RU (RMGVIEZO_HGIRMT.VNKGB())
                    FYRJGSILD("HRNrMGVIEZO MLG WVURMVW", -8);

                RMGVIEZO = FYRJGLLO::sFNZMiVZWZYOVnROORHVXLMW(RMGVIEZO_HGIRMT);

                RU (RMGVIEZO != N_YZHV_FMRE_RMUL.N_HRN_RMGVIEZO)
                    N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;


                /*
                   RMG67 RMGVIEZO = N_XLMURT.TVGzGGIwVUZFOG("HRNrMGVIEZO", 9);
                   RU (RMGVIEZO != N_YZHV_FMRE_RMUL.N_HRN_RMGVIEZO)
                   N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
                   RU (RMGVIEZO == 9)
                   GSILD vCXVKGRLM(fhrn_viili_zggi_mlg_wvurmvw, "HRNrMGVIEZO MLG WVURMVW");
                   */
                N_YZHV_FMRE_RMUL.N_HRN_RMGVIEZO = RMGVIEZO;
                N_FMRE_RMUL->N_GR_WFIZGRLM = RMGVIEZO;
                RMG67_G GRHGZIG[89], GRVMW[89];
                NVNHVG(GRHGZIG, 9, HRAVLU(GRHGZIG));
                NVNHVG(GRVMW, 9, HRAVLU(GRVMW));

                /*
                   ULI (RMG67 R = 9 ; R < 89 ; R++)
                   {
                   XSZI1 PVB[49];
                   HKIRMGU(PVB, "HRNrMGIZhGZIGgRNV%W", R);
                   RMG67 HGZIGG = N_XLMURT.TVGzGGIwVUZFOG(PVB, 9);
                   RU (HGZIGG == 9) XLMGRMFV;
                   HKIRMGU(PVB, "HRNrMGIZvMWgRNV%W", R);
                   RMG67 VMWG = N_XLMURT.TVGzGGIwVUZFOG(PVB, 9);
                   RU (VMWG == 9)
                   GSILD vCXVKGRLM(fhrn_viili_rmezorw_ezofv, "VIILI: %H RH MLG WVURMVW YFG HRNrMGIZhGZIGgRNV%W RH WVURMVW.", PVB, R);
                   RU (HGZIGG < WZBHGZIGGRNV)
                   HGZIGG += 759999999;
                   RU (VMWG < WZBHGZIGGRNV)
                   VMWG += 759999999;
                   RU (VMWG < HGZIGG)
                   GSILD vCXVKGRLM(fhrn_viili_rmezorw_ezofv, "VIILI: %H RH MLG WVURMVW LI HNZOOVI GSZM HGZIG GRNV.", PVB);
                   RMG67 HOLGH = FGRO::TVG_RMG_GRNV_WVOGZ_NROOR(HGZIGG, VMWG) / RMGVIEZO;
                   GRHGZIG[R] = HGZIGG;
                   GRVMW[R] = VMWG;
                   T_TOLYZORMUL->RMGIZ_HGZIG_GRNV[R] = HGZIGG;
                   T_TOLYZORMUL->RMGIZ_VMW_GRNV[R] = VMWG;
                   T_TOLYZORMUL->RMGIZ_HGZIG_GR[R] = (RMG67)GRNVHOLGH.HRAV();
                   ULI (RMG67 Q = 9 ; Q <= HOLGH ; Q++)
                   GRNVHOLGH.KFHS_YZXP(FGRO::TVG_MVCG_GRNV_NROOR(HGZIGG, RMGVIEZO * Q));
                   T_TOLYZORMUL->RMGIZ_VMW_GR[R] = (RMG67)GRNVHOLGH.HRAV()-8;
                   olt_wvyft("%W --> %W, %W GRNV HOLGH", HGZIGG, VMWG, HOLGH+8);
                   }*/


                HGW::HGIRMT HVHHRLM_HGI = N_XLMURT.TVGzGGIwVUZFOG("HVHHRLMH", "");
                RU (HVHHRLM_HGI.VNKGB())
                    FYRJGSILD("FMREVIHV NFHG WVURMV GIZWRMT HVHHRLMH ULI RMGIZWZB NLWV", -8);
                ZFGL HKORG_IVHFOG = FYRJGLLO::hKORGhGIRMT(HVHHRLM_HGI, ",|");
                HGW::HGIRMT GRNV_HVHHRLM;
                //RMG67 OZHG_HGZIGG = 9;
                //RMG67 OZHG_VMWG = 9;
                HGW::EVXGLI<RMG67_G> _XSVXP_GRNV_NZIPH; // FHVW GL XSVXP RU GRNV HVHHRLMH ZIV LEVIOZKKVW
                HGW::EVXGLI<RMG67_G> MRTSG_HGZIG, MRTSG_VMW;
                HGW::EVXGLI<RMG67_G> WZB_HGZIG, WZB_VMW;
                HGW::EVXGLI<RMG67_G> ZOO_HGZIG, ZOO_VMW;

                // URIHG GRNV DV KFHS ZOO HVHHRLMH GL MRTSG_HGZIG/VMW WZB_HGZIG/VMW, GSVM DV HLIG GSVN ZMW KFG MRTSG HVHHRLMH
                // YVULIV WZB HVHHRLMH, HL GSZG FHVIH WL MLG MVVW GL DLIIB ZYLFG HVHHRLM ULINZGH RM CNO XLMURTFIZGRLM
                GRNV_HVHHRLM = HKORG_IVHFOG.TVG(9);
                ZFGL GRNV_HKORG = FYRJGLLO::hKORGhGIRMT(GRNV_HVHHRLM, "-");
                RU ( GRNV_HKORG.HRAV() < 7 )
                    FYRJGSILD("VZXS GIZWRMT HVHHRLM NFHG YV LU ULINZG %s:%n-%s:%n",-8);
                ZFGL HGZIG_XOLXP = FYRJGLLO::sFNZMiVZWZYOVgRNV(GRNV_HKORG.TVG(9));
                ZFGL VMW_XOLXP = FYRJGLLO::sFNZMiVZWZYOVgRNV(GRNV_HKORG.TVG(8));
                RMG67_G HGZIGG = HGZIG_XOLXP.gRNVgLrMG();
                RMG67_G VMWG = VMW_XOLXP.gRNVgLrMG();
                RU (HKORG_IVHFOG.HRAV() == 8 && HGZIGG > VMWG) {
                    VMWG += 759999999;
                    MRTSG_HGZIG.KFHS_YZXP(HGZIGG);
                    MRTSG_VMW.KFHS_YZXP(VMWG);
                }
                VOHV
                {
                    ULI (FRMG67_G R = 9 ; R < HKORG_IVHFOG.HRAV() ; ++R)
                    {
                        GRNV_HVHHRLM = HKORG_IVHFOG.TVG(R);
                        ZFGL GRNV_HKORG = FYRJGLLO::hKORGhGIRMT(GRNV_HVHHRLM, "-");
                        RU ( GRNV_HKORG.HRAV() < 7 )
                            FYRJGSILD("VZXS GIZWRMT HVHHRLM NFHG YV LU ULINZG %s:%n-%s:%n",-8);
                        //FYRJGLLO::xOLXP<> HGZIG_XOLXP(GRNV_HKORG.TVG(9), "%s:%n");
                        //FYRJGLLO::xOLXP<> VMW_XOLXP(GRNV_HKORG.TVG(8), "%s:%n");
                        ZFGL HGZIG_XOLXP = FYRJGLLO::sFNZMiVZWZYOVgRNV(GRNV_HKORG.TVG(9));
                        ZFGL VMW_XOLXP = FYRJGLLO::sFNZMiVZWZYOVgRNV(GRNV_HKORG.TVG(8));
                        RMG67_G HGZIGG = HGZIG_XOLXP.gRNVgLrMG();
                        RMG67_G VMWG = VMW_XOLXP.gRNVgLrMG();

                        RU (HGZIGG < WZBHGZIGGRNV) {
                            HGZIGG += 759999999;
                            MRTSG_HGZIG.KFHS_YZXP(HGZIGG);
                        }
                        VOHV RU (HGZIGG > WZBVMWGRNV)
                            MRTSG_HGZIG.KFHS_YZXP(HGZIGG);
                        VOHV
                            WZB_HGZIG.KFHS_YZXP(HGZIGG);

                        RU (VMWG < WZBHGZIGGRNV) {
                            VMWG += 759999999;
                            MRTSG_VMW.KFHS_YZXP(VMWG);
                        }
                        VOHV RU (VMWG > WZBVMWGRNV)
                            MRTSG_VMW.KFHS_YZXP(VMWG);
                        VOHV
                            WZB_VMW.KFHS_YZXP(VMWG);

                        RU ( (VMWG < WZBHGZIGGRNV) CLI (HGZIGG < WZBHGZIGGRNV ))
                            FYRJGSILD(HGW::GL_HGIRMT((OLMT OLMT)HGZIGG)+"->"+HGW::GL_HGIRMT((OLMT OLMT)VMWG)+
                                    " VMXLNKZHHVW GDL XLMHVXFGREV WZBH", -8);

                        RU (VMWG < HGZIGG)
                            FYRJGSILD(HGW::GL_HGIRMT((OLMT OLMT)VMWG)+" RH MLG WVURMVW LI HNZOOVI GSZM HGZIG GRNV.", -8);
                    }
                }

                // HLIG GSVN, KFIKLHV HVV ZYLEV
                HGW::HLIG(WZB_HGZIG.YVTRM(), WZB_HGZIG.VMW());
                HGW::HLIG(WZB_VMW.YVTRM(), WZB_VMW.VMW());
                HGW::HLIG(MRTSG_HGZIG.YVTRM(), MRTSG_HGZIG.VMW());
                HGW::HLIG(MRTSG_VMW.YVTRM(), MRTSG_VMW.VMW());

                // KFHS MRTSG HVHHRLM ZSVZW
                ZOO_HGZIG = MRTSG_HGZIG;
                ZOO_VMW = MRTSG_VMW;
                ZOO_HGZIG.RMHVIG(ZOO_HGZIG.VMW(), WZB_HGZIG.YVTRM(), WZB_HGZIG.VMW());
                ZOO_VMW.RMHVIG(ZOO_VMW.VMW(), WZB_VMW.YVTRM(), WZB_VMW.VMW());

                // GSVM DV HGZIG GL KILXVHH GSLHV HVHHRLMH
                ULI (FRMG67_G R = 9 ; R < ZOO_HGZIG.HRAV() ; ++R)
                {

                    RMG67_G HGZIGG = ZOO_HGZIG[R];
                    RMG67_G VMWG = ZOO_VMW[R];

                    RU (VMWG < HGZIGG)
                        FYRJGSILD(HGW::GL_HGIRMT((OLMT OLMT)VMWG)+" RH MLG WVURMVW LI HNZOOVI GSZM HGZIG GRNV.", -8);

                    //OZHG_HGZIGG = HGZIGG;
                    //OZHG_VMWG = VMWG;

                    RMG67_G HOLGH = FYRJFMREVIHV::tVGrMGgRNVwVOGZnROOR(HGZIGG, VMWG) / RMGVIEZO;
                    GRHGZIG[R] = HGZIGG;
                    GRVMW[R] = VMWG;
                    N_FMRE_RMUL->RMGIZ_HGZIG_GRNV.KFHS_YZXP(HGZIGG);
                    N_FMRE_RMUL->RMGIZ_VMW_GRNV.KFHS_YZXP(VMWG);
                    _XSVXP_GRNV_NZIPH.KFHS_YZXP(HGZIGG);
                    _XSVXP_GRNV_NZIPH.KFHS_YZXP(VMWG);
                    N_FMRE_RMUL->RMGIZ_HGZIG_GR.KFHS_YZXP( (RMG67_G)GRNVHOLGH.HRAV());
                    ULI (RMG67_G Q = 9 ; Q <= HOLGH ; ++Q)
                        GRNVHOLGH.KFHS_YZXP(FYRJFMREVIHV::tVGmVCGgRNVnROOR(HGZIGG, RMGVIEZO * Q));
                    N_FMRE_RMUL->RMGIZ_VMW_GR.KFHS_YZXP( (RMG67_G)GRNVHOLGH.HRAV()-8 );
                    olt_rmul("%H: %W --> %W, %W GRNV HOLGH", N_RW.X_HGI(), HGZIGG, VMWG, HOLGH+8);
                }

                // XSVXP RU GSVIV RH ZMB HVHHRLM LEVIOZK
                HGW::HLIG(_XSVXP_GRNV_NZIPH.YVTRM(), _XSVXP_GRNV_NZIPH.VMW());
                ULI (FRMG R=9; R<_XSVXP_GRNV_NZIPH.HRAV(); R+=7) {
                    ZFGL WRH = HGW::URMW(N_FMRE_RMUL->RMGIZ_HGZIG_GRNV.YVTRM(),
                            N_FMRE_RMUL->RMGIZ_HGZIG_GRNV.VMW(),
                            _XSVXP_GRNV_NZIPH[R] ) - N_FMRE_RMUL->RMGIZ_HGZIG_GRNV.YVTRM();
                    RU ( _XSVXP_GRNV_NZIPH[R+8] != N_FMRE_RMUL->RMGIZ_VMW_GRNV[WRH] )
                        FYRJGSILD(HGW::HGIRMT("gIZWRMT HVHHRLMH LEVIOZKKVW: ") + HGW::GL_HGIRMT((OLMT OLMT)_XSVXP_GRNV_NZIPH[R+8]) + " EH. " +
                                HGW::GL_HGIRMT((OLMT OLMT)N_FMRE_RMUL->RMGIZ_VMW_GRNV[WRH]), -8);
                }


                olt_wvyft("%H: %OW GRNV HOLGH ULI VZXS WZB.", N_RW.X_HGI(), GRNVHOLGH.HRAV());

                // XLMHGIFXG YLFMWZIB GR EVXGLIH ULI TOLYZORMUL
                ULI (HRAV_G R=9; R<N_FMRE_RMUL->RMGIZ_HGZIG_GRNV.HRAV(); ++R)
                {
                    RU ( N_FMRE_RMUL->RMGIZ_HGZIG_GRNV[R] > WZBVMWGRNV )
                    {
                        N_FMRE_RMUL->MRTSG_YLFMWZIB_GR.KFHS_YZXP( N_FMRE_RMUL->RMGIZ_HGZIG_GR[R] );
                        N_FMRE_RMUL->MRTSG_YLFMWZIB_GR.KFHS_YZXP( N_FMRE_RMUL->RMGIZ_VMW_GR[R] );
                    }
                    VOHV
                    {
                        N_FMRE_RMUL->WZB_YLFMWZIB_GR.KFHS_YZXP( N_FMRE_RMUL->RMGIZ_HGZIG_GR[R] );
                        N_FMRE_RMUL->WZB_YLFMWZIB_GR.KFHS_YZXP( N_FMRE_RMUL->RMGIZ_VMW_GR[R] );
                    }
                }
                RU (!N_FMRE_RMUL->MRTSG_YLFMWZIB_GR.VNKGB())
                    olt_rmul("%H: LEVIMRTSG HVHHRLM HGZIGH UILN %W.",N_RW.X_HGI(), N_FMRE_RMUL->MRTSG_YLFMWZIB_GR[9]);

                RU (N_FMRE_RMUL->WZB_YLFMWZIB_GR.HRAV() > 9) {
                    olt_rmul("%H: WZB HVHHRLM HGZIGH UILN %W.", N_RW.X_HGI(), N_FMRE_RMUL->WZB_YLFMWZIB_GR[9]);
                }


                //XSVXP DSVGSVI RG RH GSV HZNV DRGS HZEVW WZGZ
                RU ((RMG67_G)(GRNVHOLGH.HRAV()) != N_YZHV_FMRE_RMUL.N_GLGZO_GRNV_HOLGH)
                    N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
                ULI (RMG67_G R = 9 ; R < 89 ; R++) {
                    RU (GRHGZIG[R] != N_YZHV_FMRE_RMUL.N_GR_HGZIG[R])
                        N_MVVW_IVYFROW_ZOO_XZXSV = GIFV;
                    N_YZHV_FMRE_RMUL.N_GR_HGZIG[R] = GRHGZIG[R];
                }
                N_FMRE_RMUL->GLGZO_GR = N_YZHV_FMRE_RMUL.N_GLGZO_GRNV_HOLGH = GRNVHOLGH.HRAV();
                RU (N_FMRE_RMUL->VMWGRNV < 9 && GRNVHOLGH.HRAV() > 9)
                    N_FMRE_RMUL->VMWGRNV = GRNVHOLGH[GRNVHOLGH.HRAV() - 8];
                //WVXRWV VMWGR
                N_FMRE_RMUL->VMWGR = GRNVHOLGH.HRAV() - 8;
                /*
                   ULI (FRMG67 R = 9 ; R < GRNVHOLGH.HRAV() ; R++) {
                   RU (T_TOLYZORMUL->VMWGRNV <= GRNVHOLGH[R]) {
                   T_TOLYZORMUL->VMWGR = R;
                   YIVZP;
                   }
                   }
                   */
                RU (N_YZHV_FMRE_RMUL.N_VMWGR != N_FMRE_RMUL->VMWGR)
                    N_XSZMTVW = GIFV;
                N_YZHV_FMRE_RMUL.N_VMWGR = N_FMRE_RMUL->VMWGR;
            }
        }

    //TVGGVIH
    GVNKOZGV<GBKVMZNV g>
        HRAV_G fMREVIHVyZHV<g>::TVGrMHGmFN() XLMHG {IVGFIM N_YZHV_FMRE_RMUL.N_RMHG_MFN;}


    GVNKOZGV<GBKVMZNV g>
        XLMHG HGW::EVXGLI<HGW::HGIRMT> & fMREVIHVyZHV<g>::TVGgRXPVIH() XLMHG {IVGFIM N_EHGIzOOrMHGgRXPVIH;}

    GVNKOZGV<GBKVMZNV g>
        XLMHG HGW::EVXGLI<RMG67_G> & fMREVIHVyZHV<g>::TVGgIZWVwZBH() XLMHG {IVGFIM N_EMzOOgIZWVwZBH;}

    GVNKOZGV<GBKVMZNV g>
        YLLO fMREVIHVyZHV<g>::MVVWiVYFROWxZXSV() XLMHG {IVGFIM N_MVVW_IVYFROW_ZOO_XZXSV;}


}

#VMWRU
//##**---------------- ./FYRJFMREVIHV/RMXOFWV/FMREVIHV/FMREVIHVFGRO.S
/**********************************************
 * \EVIHRLM   4.9.9
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7983-89-81
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/

#RUMWVU _fyrjgllo_fmrevihvfgro_s
#WVURMV _fyrjgllo_fmrevihvfgro_s

#RMXOFWV "FYRJ_GLLO.S"

MZNVHKZXV FYRJFMREVIHV {

    RMG67_G tVGrMGgRNVwVOGZnROOR(RMG67_G G8, RMG67_G G7)
    {
        RMG67_G ss, nn, hh, NNN, ss7, nn7, hh7, NNN7;
        ss = G8 / 89999999;
        nn = (G8 / 899999) % 899;
        hh = (G8 / 8999) % 899;
        NNN = G8 % 8999;
        ss7 = G7 / 89999999;
        nn7 = (G7 / 899999) % 899;
        hh7 = (G7 / 8999) % 899;
        NNN7 = G7 % 8999;
        IVGFIM (ss7 - ss) * 6399999 + (nn7 - nn) * 39999 + (hh7 - hh) * 8999 + (NNN7 - NNN);
    }

    RMG67_G tVGmVCGgRNVnROOR(RMG67_G G, RMG67_G WVOGZ)
    {
        RMG67_G ss, nn, hh, NNN, ss7, nn7, hh7, NNN7;
        ss = G / 89999999;
        nn = (G / 899999) % 899;
        hh = (G / 8999) % 899;
        NNN = G % 8999;
        RMG67_G XZIIB;
        NNN7 = NNN + WVOGZ;
        XZIIB  = NNN7 / 8999;
        NNN7 %= 8999;
        hh7 = hh + XZIIB;
        XZIIB = hh7 / 39;
        hh7 %= 39;
        nn7 = nn + XZIIB;
        XZIIB = nn7 / 39;
        nn7 %= 39;
        ss7 = ss + XZIIB;	//NRTSG >= 75
        IVGFIM ss7 * 89999999 + nn7 * 899999 + hh7 * 8999 + NNN7;
    }


}
#VMWRU //
//##**---------------- ./FYRJFMREVIHV/RMXOFWV/FYRJ_FMREVIHV.S
#RUMWVU _fyrjgllo_fmrevihv_
#WVURMV _fyrjgllo_fmrevihv_

#RMXOFWV "FMREVIHV/FMREVIHVYZHV.S"
#RMXOFWV "FMREVIHV/FMREVIHVYZHV_UFMX.S"
#VMWRU //
//##**---------------- ./FYRJFMREVIHV/WLCBTVM.RMR
# wLCBUROV 8.7.6

# gSRH UROV WVHXIRYVH GSV HVGGRMTH GL YV FHVW YB WLCBTVM ULI Z KILQVXG
#
# zOO GVCG ZUGVI Z SZHS (#) RH XLMHRWVIVW Z XLNNVMG ZMW DROO YV RTMLIVW
# gSV ULINZG RH:
#       gzt = EZOFV [EZOFV, ...]
# uLI ORHGH RGVNH XZM ZOHL YV ZKKVMWVW FHRMT:
#       gzt += EZOFV [EZOFV, ...]
# eZOFVH GSZG XLMGZRM HKZXVH HSLFOW YV KOZXVW YVGDVVM JFLGVH (" ")

#---------------------------------------------------------------------------
# tVMVIZO XLMURTFIZGRLM LKGRLMH
#---------------------------------------------------------------------------

# gSV kilqvxg_mznv GZT RH Z HRMTOV DLIW (LI Z HVJFVMXV LU DLIWH HFIILFMWVW
# YB JFLGVH) GSZG HSLFOW RWVMGRUB GSV KILQVXG.

kilqvxg_mznv=FYRJGLLO

# gSV kilqvxg_mfnyvi GZT XZM YV FHVW GL VMGVI Z KILQVXG LI IVERHRLM MFNYVI.
# gSRH XLFOW YV SZMWB ULI ZIXSRERMT GSV TVMVIZGVW WLXFNVMGZGRLM LI
# RU HLNV EVIHRLM XLMGILO HBHGVN RH FHVW.

kilqvxg_mfnyvi=9.9.8

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

rmkfg                  =  ./HIX ./RMXOFWV

# gSV lfgkfg_wrivxglib GZT RH FHVW GL HKVXRUB GSV (IVOZGREV LI ZYHLOFGV)
# YZHV KZGS DSVIV GSV TVMVIZGVW WLXFNVMGZGRLM DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW, RG DROO YV IVOZGREV GL GSV OLXZGRLM
# DSVIV WLCBTVM DZH HGZIGVW. rU OVUG YOZMP GSV XFIIVMG WRIVXGLIB DROO YV FHVW.

lfgkfg_wrivxglib       = ./WLX

# gSV lfgkfg_ozmtfztv GZT RH FHVW GL HKVXRUB GSV OZMTFZTV RM DSRXS ZOO
# WLXFNVMGZGRLM TVMVIZGVW YB WLCBTVM RH DIRGGVM. wLCBTVM DROO FHV GSRH
# RMULINZGRLM GL TVMVIZGV ZOO XLMHGZMG LFGKFG RM GSV KILKVI OZMTFZTV.
# gSV WVUZFOG OZMTFZTV RH vMTORHS, LGSVI HFKKLIGVW OZMTFZTVH ZIV:
# wFGXS, uIVMXS, rGZORZM, xAVXS, hDVWRHS, tVINZM, uRMMRHS, qZKZMVHV,
# pLIVZM, sFMTZIRZM, hKZMRHS, iLNZMRZM, iFHHRZM, xILZGRZM, kLORHS,
# kLIGFTFVHV ZMW hOLEVMV.

lfgkfg_ozmtfztv        = vMTORHS

# rU GSV vcgizxg_zoo GZT RH HVG GL bvh WLCBTVM DROO ZHHFNV ZOO VMGRGRVH RM
# WLXFNVMGZGRLM ZIV WLXFNVMGVW, VEVM RU ML WLXFNVMGZGRLM DZH ZEZROZYOV.
# kIREZGV XOZHH NVNYVIH ZMW HGZGRX UROV NVNYVIH DROO YV SRWWVM FMOVHH
# GSV vcgizxg_kirezgv ZMW vcgizxg_hgzgrx GZTH ZIV HVG GL bvh

vcgizxg_zoo            = bvh

# rU GSV vcgizxg_kirezgv GZT RH HVG GL bvh ZOO KIREZGV NVNYVIH LU Z XOZHH
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_kirezgv        = bvh

# rU GSV vcgizxg_hgzgrx GZT RH HVG GL bvh ZOO HGZGRX NVNYVIH LU Z UROV
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_hgzgrx         = bvh

# rU GSV srwv_fmwlx_nvnyvih GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW NVNYVIH LU WLXFNVMGVW XOZHHVH, UROVH LI MZNVHKZXVH.
# rU HVG GL ml (GSV WVUZFOG) GSVHV NVNYVIH DROO YV RMXOFWVW RM GSV
# EZIRLFH LEVIERVDH, YFG ML WLXFNVMGZGRLM HVXGRLM RH TVMVIZGVW.
# gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_nvnyvih     = ml

# rU GSV srwv_fmwlx_xozhhvh GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW XOZHHVH GSZG ZIV MLINZOOB ERHRYOV RM GSV XOZHH SRVIZIXSB.
# rU HVG GL ml (GSV WVUZFOG) GSVHV XOZHH DROO YV RMXOFWVW RM GSV EZIRLFH
# LEVIERVDH. gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_xozhhvh     = ml

# rU GSV yirvu_nvnyvi_wvhx GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# RMXOFWV YIRVU NVNYVI WVHXIRKGRLMH ZUGVI GSV NVNYVIH GSZG ZIV ORHGVW RM
# GSV UROV ZMW XOZHH WLXFNVMGZGRLM (HRNROZI GL qZEZwLX).
# hVG GL ml GL WRHZYOV GSRH.

yirvu_nvnyvi_wvhx      = ml

# rU GSV ivkvzg_yirvu GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO KIVKVMW
# GSV YIRVU WVHXIRKGRLM LU Z NVNYVI LI UFMXGRLM YVULIV GSV WVGZROVW WVHXIRKGRLM.
# mLGV: RU YLGS srwv_fmwlx_nvnyvih ZMW yirvu_nvnyvi_wvhx ZIV HVG GL ml, GSV
# YIRVU WVHXIRKGRLMH DROO YV XLNKOVGVOB HFKKIVHHVW.

ivkvzg_yirvu           = bvh

# rU GSV zodzbh_wvgzrovw_hvx ZMW ivkvzg_yirvu GZTH ZIV YLGS HVG GL bvh GSVM
# wLCBTVM DROO TVMVIZGV Z WVGZROVW HVXGRLM VEVM RU GSVIV RH LMOB Z YIRVU
# WVHXIRKGRLM.

zodzbh_wvgzrovw_hvx    = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM wLCBTVM DROO KIVKVMW GSV UFOO
# KZGS YVULIV UROVH MZNV RM GSV UROV ORHG ZMW RM GSV SVZWVI UROVH. rU HVG
# GL ml GSV HSLIGVHG KZGS GSZG NZPVH GSV UROV MZNV FMRJFV DROO YV FHVW.

ufoo_kzgs_mznvh        = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM GSV hgirk_uiln_kzgs GZT
# XZM YV FHVW GL HGIRK Z FHVI WVURMVW KZIG LU GSV KZGS. hGIRKKRMT RH
# LMOB WLMV RU LMV LU GSV HKVXRURVW HGIRMTH NZGXSVH GSV OVUG-SZMW KZIG LU
# GSV KZGS. rG RH ZOOLDVW GL FHV IVOZGREV KZGSH RM GSV ZITFNVMG ORHG.

hgirk_uiln_kzgs        =

# gSV rmgvimzo_wlxh GZT WVGVINRMVH RU WLXFNVMGZGRLM
# GSZG RH GBKVW ZUGVI Z \RMGVIMZO XLNNZMW RH RMXOFWVW. rU GSV GZT RH HVG
# GL ml (GSV WVUZFOG) GSVM GSV WLXFNVMGZGRLM DROO YV VCXOFWVW.
# hVG RG GL bvh GL RMXOFWV GSV RMGVIMZO WLXFNVMGZGRLM.

rmgvimzo_wlxh          = ml

# rU GSV xozhh_wrztiznh GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z XOZHH WRZTIZN (RM sGNO ZMW oZgVc) ULI XOZHHVH DRGS YZHV LI
# HFKVI XOZHHVH. hVGGRMT GSV GZT GL ml GFIMH GSV WRZTIZNH LUU.

xozhh_wrztiznh         = bvh

# rU GSV hlfixv_yildhvi GZT RH HVG GL bvh GSVM Z ORHG LU HLFIXV UROVH DROO
# YV TVMVIZGVW. wLXFNVMGVW VMGRGRVH DROO YV XILHH-IVUVIVMXVW DRGS GSVHV HLFIXVH.

hlfixv_yildhvi         = bvh

# hVGGRMT GSV rmormv_hlfixvh GZT GL bvh DROO RMXOFWV GSV YLWB
# LU UFMXGRLMH ZMW XOZHHVH WRIVXGOB RM GSV WLXFNVMGZGRLM.

rmormv_hlfixvh         = ml

# hVGGRMT GSV hgirk_xlwv_xlnnvmgh GZT GL bvh (GSV WVUZFOG) DROO RMHGIFXG
# WLCBTVM GL SRWV ZMB HKVXRZO XLNNVMG YOLXPH UILN TVMVIZGVW HLFIXV XLWV
# UIZTNVMGH. mLINZO x ZMW x++ XLNNVMGH DROO ZODZBH IVNZRM ERHRYOV.

hgirk_xlwv_xlnnvmgh    = bvh

# rU GSV xzhv_hvmhv_mznvh GZT RH HVG GL ml GSVM wLCBTVM DROO LMOB TVMVIZGV
# UROV MZNVH RM OLDVI XZHV OVGGVIH. rU HVG GL bvh FKKVI XZHV OVGGVIH ZIV ZOHL
# ZOOLDVW. gSRH RH FHVUFO RU BLF SZEV XOZHHVH LI UROVH DSLHV MZNVH LMOB WRUUVI
# RM XZHV ZMW RU BLFI UROV HBHGVN HFKKLIGH XZHV HVMHRGREV UROV MZNVH. dRMWLDH
# FHVIH ZIV ZWERXVW GL HVG GSRH LKGRLM GL ml.

xzhv_hvmhv_mznvh       = bvh

# rU GSV srwv_hxlkv_mznvh GZT RH HVG GL ml (GSV WVUZFOG) GSVM wLCBTVM
# DROO HSLD NVNYVIH DRGS GSVRI UFOO XOZHH ZMW MZNVHKZXV HXLKVH RM GSV
# WLXFNVMGZGRLM. rU HVG GL bvh GSV HXLKV DROO YV SRWWVM.

srwv_hxlkv_mznvh       = ml

# rU GSV eviyzgrn_svzwvih GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO TVMVIZGV Z EVIYZGRN XLKB LU GSV SVZWVI UROV ULI VZXS XOZHH ULI
# DSRXS ZM RMXOFWV RH HKVXRURVW. hVG GL ml GL WRHZYOV GSRH.

eviyzgrn_svzwvih       = bvh

# rU GSV hsld_rmxofwv_urovh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO KFG ORHG LU GSV UROVH GSZG ZIV RMXOFWVW YB Z UROV RM GSV WLXFNVMGZGRLM
# LU GSZG UROV.

hsld_rmxofwv_urovh     = bvh

# rU GSV qzezwlx_zfglyirvu GZT RH HVG GL bvh GSVM wLCBTVM
# DROO RMGVIKIVG GSV URIHG ORMV (FMGRO GSV URIHG WLG) LU Z qZEZwLX-HGBOV
# XLNNVMG ZH GSV YIRVU WVHXIRKGRLM. rU HVG GL ml, GSV qZEZwLX
# XLNNVMGH  DROO YVSZEV QFHG ORPV GSV jG-HGBOV XLNNVMGH (GSFH IVJFRIRMT ZM
# VCKORXG @YIRVU XLNNZMW ULI Z YIRVU WVHXIRKGRLM.

qzezwlx_zfglyirvu      = bvh

# rU GSV rmsvirg_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM ZM FMWLXFNVMGVW
# NVNYVI RMSVIRGH GSV WLXFNVMGZGRLM UILN ZMB WLXFNVMGVW NVNYVI GSZG RG
# IVRNKOVNVMGH.

rmsvirg_wlxh           = bvh

# rU GSV rmormv_rmul GZT RH HVG GL bvh (GSV WVUZFOG) GSVM Z GZT [RMORMV]
# RH RMHVIGVW RM GSV WLXFNVMGZGRLM ULI RMORMV NVNYVIH.

rmormv_rmul            = bvh

# rU GSV hlig_nvnyvi_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM WLCBTVM
# DROO HLIG GSV (WVGZROVW) WLXFNVMGZGRLM LU UROV ZMW XOZHH NVNYVIH
# ZOKSZYVGRXZOOB YB NVNYVI MZNV. rU HVG GL ml GSV NVNYVIH DROO ZKKVZI RM
# WVXOZIZGRLM LIWVI.

hlig_nvnyvi_wlxh       = bvh

# rU NVNYVI TILFKRMT RH FHVW RM GSV WLXFNVMGZGRLM ZMW GSV wrhgiryfgv_tilfk_wlx
# GZT RH HVG GL bvh, GSVM WLCBTVM DROO IVFHV GSV WLXFNVMGZGRLM LU GSV URIHG
# NVNYVI RM GSV TILFK (RU ZMB) ULI GSV LGSVI NVNYVIH LU GSV TILFK. yB WVUZFOG
# ZOO NVNYVIH LU Z TILFK NFHG YV WLXFNVMGVW VCKORXRGOB.

wrhgiryfgv_tilfk_wlx   = ml

# gSV gzy_hrav GZT XZM YV FHVW GL HVG GSV MFNYVI LU HKZXVH RM Z GZY.
# wLCBTVM FHVH GSRH EZOFV GL IVKOZXV GZYH YB HKZXVH RM XLWV UIZTNVMGH.

gzy_hrav               = 5

# gSV vmzyov_hvxgrlmh GZT XZM YV FHVW GL VMZYOV XLMWRGRLMZO
# WLXFNVMGZGRLM HVXGRLMH, NZIPVW YB \RU HVXGRLMMZNV ... \VMWRU.

vmzyovw_hvxgrlmh       =

# gSV tvmvizgv_glwlorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GLWL ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GLWL
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_glwlorhg      = bvh

# gSV tvmvizgv_gvhgorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GVHG ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GVHG
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_gvhgorhg      = bvh

tvmvizgv_givvervd      = bvh

# gSRH GZT XZM YV FHVW GL HKVXRUB Z MFNYVI LU ZORZHVH GSZG ZXGH
# ZH XLNNZMWH RM GSV WLXFNVMGZGRLM. zM ZORZH SZH GSV ULIN "MZNV=EZOFV".
# uLI VCZNKOV ZWWRMT "HRWVVUUVXG=\KZI hRWV vUUVXGH:\M" DROO ZOOLD BLF GL
# KFG GSV XLNNZMW \HRWVVUUVXG (LI @HRWVVUUVXG) RM GSV WLXFNVMGZGRLM, DSRXS
# DROO IVHFOG RM Z FHVI WVURMVW KZIZTIZKS DRGS SVZWRMT "hRWV vUUVXGH:".
# bLF XZM KFG \M'H RM GSV EZOFV KZIG LU ZM ZORZH GL RMHVIG MVDORMVH.

zorzhvh                =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL DZIMRMT ZMW KILTIVHH NVHHZTVH
#---------------------------------------------------------------------------

# gSV jfrvg GZT XZM YV FHVW GL GFIM LM/LUU GSV NVHHZTVH GSZG ZIV TVMVIZGVW
# YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP ml RH FHVW.

jfrvg                  = ml

# gSV dzimrmth GZT XZM YV FHVW GL GFIM LM/LUU GSV DZIMRMT NVHHZTVH GSZG ZIV
# TVMVIZGVW YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP
# ml RH FHVW.

dzimrmth               = bvh

# rU dzim_ru_fmwlxfnvmgvw RH HVG GL bvh, GSVM WLCBTVM DROO TVMVIZGV DZIMRMTH
# ULI FMWLXFNVMGVW NVNYVIH. rU vcgizxg_zoo RH HVG GL bvh GSVM GSRH UOZT DROO
# ZFGLNZGRXZOOB YV WRHZYOVW.

dzim_ru_fmwlxfnvmgvw   = bvh

# gSV dzim_ulinzg GZT WVGVINRMVH GSV ULINZG LU GSV DZIMRMT NVHHZTVH GSZG
# WLCBTVM XZM KILWFXV. gSV HGIRMT HSLFOW XLMGZRM GSV $UROV, $ORMV, ZMW $GVCG
# GZTH, DSRXS DROO YV IVKOZXVW YB GSV UROV ZMW ORMV MFNYVI UILN DSRXS GSV
# DZIMRMT LIRTRMZGVW ZMW GSV DZIMRMT GVCG.

dzim_ulinzg            = "$UROV:$ORMV: $GVCG"

# gSV dzim_olturov GZT XZM YV FHVW GL HKVXRUB Z UROV GL DSRXS DZIMRMT
# ZMW VIILI NVHHZTVH HSLFOW YV DIRGGVM. rU OVUG YOZMP GSV LFGKFG RH DIRGGVM
# GL HGWVII.

dzim_olturov           =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV RMKFG UROVH
#---------------------------------------------------------------------------

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

#rmkfg                  =  NBwRIVXGLIB
# RMKFG GZT NLEVW GL GLK LU GSRH UROV

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

urov_kzggvimh          =  *.S *.XKK *.SKK *.XCC

# gSV ivxfihrev GZT XZM YV FHVW GL GFIM HKVXRUB DSVGSVI LI MLG HFYWRIVXGLIRVH
# HSLFOW YV HVZIXSVW ULI RMKFG UROVH ZH DVOO. kLHHRYOV EZOFVH ZIV bvh ZMW ml.
# rU OVUG YOZMP ml RH FHVW.

ivxfihrev              = bvh

# gSV vcxofwv GZT XZM YV FHVW GL HKVXRUB UROVH ZMW/LI WRIVXGLIRVH GSZG HSLFOW
# VCXOFWVW UILN GSV rmkfg HLFIXV UROVH. gSRH DZB BLF XZM VZHROB VCXOFWV Z
# HFYWRIVXGLIB UILN Z WRIVXGLIB GIVV DSLHV ILLG RH HKVXRURVW DRGS GSV rmkfg GZT.

vcxofwv                =

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcxofwv_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIMH GL VCXOFWV
# XVIGZRM UROVH UILN GSLHV WRIVXGLIRVH.

vcxofwv_kzggvimh       =

# gSV vcznkov_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM VCZNKOV XLWV UIZTNVMGH GSZG ZIV RMXOFWVW (HVV
# GSV \RMXOFWV XLNNZMW).

vcznkov_kzgs           =

# rU GSV EZOFV LU GSV vcznkov_kzgs GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcznkov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

vcznkov_kzggvimh       =

# gSV rnztv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM RNZTV GSZG ZIV RMXOFWVW RM GSV WLXFNVMGZGRLM (HVV
# GSV \RNZTV XLNNZMW).

rnztv_kzgs             =

# gSV rmkfg_urogvi GZT XZM YV FHVW GL HKVXRUB Z KILTIZN GSZG WLCBTVM HSLFOW
# RMELPV GL UROGVI ULI VZXS RMKFG UROV. wLCBTVM DROO RMELPV GSV UROGVI KILTIZN
# YB VCVXFGRMT (ERZ KLKVM()) GSV XLNNZMW <UROGVI> <RMKFG-UROV>, DSVIV <UROGVI>
# RH GSV EZOFV LU GSV rmkfg_urogvi GZT, ZMW <RMKFG-UROV> RH GSV MZNV LU ZM
# RMKFG UROV. wLCBTVM DROO GSVM FHV GSV LFGKFG GSZG GSV UROGVI KILTIZN DIRGVH
# GL HGZMWZIW LFGKFG.

rmkfg_urogvi           =

# rU GSV urogvi_hlfixv_urovh GZT RH HVG GL bvh, GSV RMKFG UROGVI (RU HVG FHRMT
# rmkfg_urogvi) DROO YV FHVW GL UROGVI GSV RMKFG UROVH DSVM KILWFXRMT HLFIXV
# UROVH GL YILDHV.

urogvi_hlfixv_urovh    = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV ZOKSZYVGRXZO XOZHH RMWVC
#---------------------------------------------------------------------------

# rU GSV zokszyvgrxzo_rmwvc GZT RH HVG GL bvh, ZM ZOKSZYVGRXZO RMWVC
# LU ZOO XLNKLFMWH DROO YV TVMVIZGVW. vMZYOV GSRH RU GSV KILQVXG
# XLMGZRMH Z OLG LU XOZHHVH, HGIFXGH, FMRLMH LI RMGVIUZXVH.

zokszyvgrxzo_rmwvc     = bvh

# rU GSV ZOKSZYVGRXZO RMWVC RH VMZYOVW (HVV zokszyvgrxzo_rmwvc) GSVM
# GSV xloh_rm_zoksz_rmwvc GZT XZM YV FHVW GL HKVXRUB GSV MFNYVI LU XLOFNMH
# RM DSRXS GSRH ORHG DROO YV HKORG (XZM YV Z MFNYVI RM GSV IZMTV [8..79])

xloh_rm_zoksz_rmwvc    = 6

# rM XZHV ZOO XOZHHVH RM Z KILQVXG HGZIG DRGS Z XLNNLM KIVURC, ZOO
# XOZHHVH DROO YV KFG FMWVI GSV HZNV SVZWVI RM GSV ZOKSZYVGRXZO RMWVC.
# gSV rtmliv_kivurc GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KIVURCVH GSZG
# HSLFOW YV RTMLIVW DSROV TVMVIZGRMT GSV RMWVC SVZWVIH.

rtmliv_kivurc          =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV sgno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_sgno GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV sgno LFGKFG.

tvmvizgv_sgno          = bvh

# gSV sgno_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV sgno WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `SGNO' DROO YV FHVW ZH GSV WVUZFOG KZGS.

sgno_lfgkfg            = SGNO

# gSV sgno_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno SVZWVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI.

sgno_svzwvi            =

# gSV sgno_ullgvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno ULLGVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW ULLGVI.

sgno_ullgvi            =

# gSV sgno_hgbovhsvvg GZT XZM YV FHVW GL HKVXRUB Z FHVI WVURMVW XZHXZWRMT
# HGBOV HSVVG GSZG RH FHVW YB VZXS sgno KZTV. rG XZM YV FHVW GL
# URMV-GFMV GSV OLLP LU GSV sgno LFGKFG. rU GSV GZT RH OVUG YOZMP WLCBTVM
# DROO TVMVIZGV Z WVUZFOG HGBOV HSVVG

sgno_hgbovhsvvg        =

# rU GSV sgno_zortm_nvnyvih GZT RH HVG GL bvh, GSV NVNYVIH LU XOZHHVH,
# UROVH LI MZNVHKZXVH DROO YV ZORTMVW RM sgno FHRMT GZYOVH. rU HVG GL
# ml Z YFOOVG ORHG DROO YV FHVW.

sgno_zortm_nvnyvih     = bvh

# rU GSV tvmvizgv_sgnosvok GZT RH HVG GL bvh, ZWWRGRLMZO RMWVC UROVH
# DROO YV TVMVIZGVW GSZG XZM YV FHVW ZH RMKFG ULI GLLOH ORPV GSV
# nRXILHLUG sgno SVOK DLIPHSLK GL TVMVIZGV Z XLNKIVHHVW sgno SVOK UROV (.XSN)
# LU GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

tvmvizgv_sgnosvok      = ml

# gSV wrhzyov_rmwvc GZT XZM YV FHVW GL GFIM LM/LUU GSV XLMWVMHVW RMWVC ZG
# GLK LU VZXS sgno KZTV. gSV EZOFV ml (GSV WVUZFOG) VMZYOVH GSV RMWVC ZMW
# GSV EZOFV bvh WRHZYOVH RG.

wrhzyov_rmwvc          = ml

# gSRH GZT XZM YV FHVW GL HVG GSV MFNYVI LU VMFN EZOFVH (IZMTV [8..79])
# GSZG WLCBTVM DROO TILFK LM LMV ORMV RM GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

vmfn_ezofvh_kvi_ormv   = 5

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV oZgVc LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_ozgvc GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV oZGVC LFGKFG.

tvmvizgv_ozgvc         = ml

# gSV ozgvc_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV oZgVc WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `OZGVC' DROO YV FHVW ZH GSV WVUZFOG KZGS.

ozgvc_lfgkfg           = OZGVC

# rU GSV xlnkzxg_ozgvc GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# oZgVc WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_ozgvc          = ml

# gSV kzkvi_gbkv GZT XZM YV FHVW GL HVG GSV KZKVI GBKV GSZG RH FHVW
# YB GSV KIRMGVI. kLHHRYOV EZOFVH ZIV: Z5, Z5DRWV, OVGGVI, OVTZO ZMW
# VCVXFGREV. rU OVUG YOZMP Z5DRWV DROO YV FHVW.

kzkvi_gbkv             = Z5DRWV

# gSV vcgiz_kzxpztvh GZT XZM YV GL HKVXRUB LMV LI NLIV MZNVH LU oZgVc
# KZXPZTVH GSZG HSLFOW YV RMXOFWVW RM GSV oZgVc LFGKFG.

vcgiz_kzxpztvh         =

# gSV ozgvc_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO oZgVc SVZWVI ULI
# GSV TVMVIZGVW OZGVC WLXFNVMG. gSV SVZWVI HSLFOW XLMGZRM VEVIBGSRMT FMGRO
# GSV URIHG XSZKGVI. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI. mLGRXV: LMOB FHV GSRH GZT RU BLF PMLD DSZG BLF ZIV WLRMT!

ozgvc_svzwvi           =

# rU GSV kwu_sbkviormph GZT RH HVG GL bvh, GSV oZgVc GSZG RH TVMVIZGVW
# RH KIVKZIVW ULI XLMEVIHRLM GL KWU (FHRMT KH7KWU). gSV KWU UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z KWU ERVDVI.

kwu_sbkviormph         = ml

# rU GSV fhv_kwuozgvc GZT RH HVG GL bvh, KWUOZGVC DROO YV FHVW RMHGVZW LU
# KOZRM OZGVC RM GSV TVMVIZGVW nZPVUROV. hVG GSRH LKGRLM GL bvh GL TVG Z
# SRTSVI JFZORGB kwu WLXFNVMGZGRLM.

fhv_kwuozgvc           = ml

# rU GSV ozgvc_yzgxsnlwv GZT RH HVG GL bvh, WLCBTVM DROO ZWW GSV \\YZGXSNLWV.
# XLNNZMW GL GSV TVMVIZGVW oZgVc UROVH. gSRH DROO RMHGIFXG oZgVc GL PVVK
# IFMMRMT RU VIILIH LXXFI, RMHGVZW LU ZHPRMT GSV FHVI ULI SVOK.
# gSRH LKGRLM RH ZOHL FHVW DSVM TVMVIZGRMT ULINFOZH RM sgno.

ozgvc_yzgxsnlwv        = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV igu LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_igu GZT RH HVG GL bvh wLCBTVM DROO TVMVIZGV igu LFGKFG
# gSV igu LFGKFG RH LKGRNRHVW ULI dLIW 02 ZMW NZB MLG OLLP EVIB KIVGGB DRGS
# LGSVI igu IVZWVIH LI VWRGLIH.

tvmvizgv_igu           = ml

# gSV igu_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV igu WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `IGU' DROO YV FHVW ZH GSV WVUZFOG KZGS.

igu_lfgkfg             = IGU

# rU GSV xlnkzxg_igu GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# igu WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_igu            = bvh

# rU GSV igu_sbkviormph GZT RH HVG GL bvh, GSV igu GSZG RH TVMVIZGVW
# DROO XLMGZRM SBKVIORMP URVOWH. gSV igu UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH.
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z dliw LI LGSVI.
# KILTIZNH DSRXS HFKKLIG GSLHV URVOWH.
# mLGV: DLIWKZW (DIRGV) ZMW LGSVIH WL MLG HFKKLIG ORMPH.

igu_sbkviormph         = ml

# oLZW HGBOVHSVVG WVURMRGRLMH UILN UROV. hBMGZC RH HRNROZI GL WLCBTVM'H
# XLMURT UROV, R.V. Z HVIRVH LU ZHHRTNVMGH. bLF LMOB SZEV GL KILERWV
# IVKOZXVNVMGH, NRHHRMT WVURMRGRLMH ZIV HVG GL GSVRI WVUZFOG EZOFV.

igu_hgbovhsvvg_urov    =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV NZM KZTV LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_nzm GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV NZM KZTVH

tvmvizgv_nzm           = ml

# gSV nzm_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV NZM KZTVH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `NZM' DROO YV FHVW ZH GSV WVUZFOG KZGS.

nzm_lfgkfg             = NZM

# gSV nzm_vcgvmhrlm GZT WVGVINRMVH GSV VCGVMHRLM GSZG RH ZWWVW GL
# GSV TVMVIZGVW NZM KZTVH (WVUZFOG RH GSV HFYILFGRMV'H HVXGRLM .6)

nzm_vcgvmhrlm          = .6

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV cno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_cno GZT RH HVG GL bvh wLCBTVM DROO
# TVMVIZGV ZM cno UROV GSZG XZKGFIVH GSV HGIFXGFIV LU
# GSV XLWV RMXOFWRMT ZOO WLXFNVMGZGRLM. dZIMRMT: gSRH UVZGFIV
# RH HGROO VCKVIRNVMGZO ZMW EVIB RMXLNKOVGV.

tvmvizgv_cno           = ml

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV KIVKILXVHHLI
#---------------------------------------------------------------------------

# rU GSV vmzyov_kivkilxvhhrmt GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# VEZOFZGV ZOO x-KIVKILXVHHLI WRIVXGREVH ULFMW RM GSV HLFIXVH ZMW RMXOFWV
# UROVH.

vmzyov_kivkilxvhhrmt   = bvh

# rU GSV nzxil_vckzmhrlm GZT RH HVG GL bvh wLCBTVM DROO VCKZMW ZOO NZXIL
# MZNVH RM GSV HLFIXV XLWV. rU HVG GL ml (GSV WVUZFOG) LMOB XLMWRGRLMZO
# XLNKROZGRLM DROO YV KVIULINVW. nZXIL VCKZMHRLM XZM YV WLMV RM Z XLMGILOOVW
# DZB YB HVGGRMT vckzmw_lmob_kivwvu GL bvh.

nzxil_vckzmhrlm        = ml

# rU GSV vckzmw_lmob_kivwvu ZMW nzxil_vckzmhrlm GZTH ZIV YLGS HVG GL bvh
# GSVM GSV NZXIL VCKZMHRLM RH ORNRGVW GL GSV NZXILH HKVXRURVW DRGS GSV
# kivwvurmvw ZMW vckzmw_zh_kivwvurmvw GZTH.

vckzmw_lmob_kivwvu     = ml

# rU GSV hvzixs_rmxofwvh GZT RH HVG GL bvh (GSV WVUZFOG) GSV RMXOFWVH UROVH
# RM GSV rmxofwv_kzgs (HVV YVOLD) DROO YV HVZIXS RU Z #RMXOFWV RH ULFMW.

hvzixs_rmxofwvh        = bvh

# gSV rmxofwv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV WRIVXGLIRVH GSZG
# XLMGZRM RMXOFWV UROVH GSZG ZIV MLG RMKFG UROVH YFG HSLFOW YV KILXVHHVW YB
# GSV KIVKILXVHHLI.

rmxofwv_kzgs           =

# bLF XZM FHV GSV rmxofwv_urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW
# KZGGVIMH (ORPV *.S ZMW *.SKK) GL UROGVI LFG GSV SVZWVI-UROVH RM GSV
# WRIVXGLIRVH. rU OVUG YOZMP, GSV KZGGVIMH HKVXRURVW DRGS urov_kzggvimh DROO
# YV FHVW.

rmxofwv_urov_kzggvimh  =

# gSV kivwvurmvw GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV NZXIL MZNVH GSZG
# ZIV WVURMVW YVULIV GSV KIVKILXVHHLI RH HGZIGVW (HRNROZI GL GSV -w LKGRLM LU
# TXX). gSV ZITFNVMG LU GSV GZT RH Z ORHG LU NZXILH LU GSV ULIN: MZNV
# LI MZNV=WVURMRGRLM (ML HKZXVH). rU GSV WVURMRGRLM ZMW GSV = ZIV
# LNRGGVW =8 RH ZHHFNVW.

kivwvurmvw             =  xliv_tilfk

# rU GSV nzxil_vckzmhrlm ZMW vckzmw_kivwvu_lmob GZTH ZIV HVG GL bvh GSVM
# GSRH GZT XZM YV FHVW GL HKVXRUB Z ORHG LU NZXIL MZNVH GSZG HSLFOW YV VCKZMWVW.
# gSV NZXIL WVURMRGRLM GSZG RH ULFMW RM GSV HLFIXVH DROO YV FHVW.
# fHV GSV kivwvurmvw GZT RU BLF DZMG GL FHV Z WRUUVIVMG NZXIL WVURMRGRLM.

vckzmw_zh_wvurmvw      =

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL VCGVIMZO IVUVIVMXVH
#---------------------------------------------------------------------------

# gSV gzturovh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV GZTUROVH.

gzturovh               =

# dSVM Z UROV MZNV RH HKVXRURVW ZUGVI tvmvizgv_gzturov, WLCBTVM DROO XIVZGV
# Z GZT UROV GSZG RH YZHVW LM GSV RMKFG UROVH RG IVZWH.

tvmvizgv_gzturov       =

# rU GSV zoovcgvimzoh GZT RH HVG GL bvh ZOO VCGVIMZO XOZHHVH DROO YV ORHGVW
# RM GSV XOZHH RMWVC. rU HVG GL ml LMOB GSV RMSVIRGVW VCGVIMZO XOZHHVH
# DROO YV ORHGVW.

zoovcgvimzoh           = ml

# gSV kvio_kzgs HSLFOW YV GSV ZYHLOFGV KZGS ZMW MZNV LU GSV KVIO HXIRKG
# RMGVIKIVGVI (R.V. GSV IVHFOG LU `DSRXS KVIO').

kvio_kzgs              = /FHI/YRM/KVIO

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV WLG GLLO
#---------------------------------------------------------------------------

# rU BLF HVG GSV szev_wlg GZT GL bvh GSVM WLCBTVM DROO ZHHFNV GSV WLG GLLO RH
# ZEZROZYOV UILN GSV KZGS. gSRH GLLO RH KZIG LU tIZKSERA, Z TIZKS ERHFZORAZGRLM
# GLLOPRG UILN zg&g ZMW oFXVMG yVOO oZYH. gSV LGSVI LKGRLMH RM GSRH HVXGRLM
# SZEV ML VUUVXG RU GSRH LKGRLM RH HVG GL ml (GSV WVUZFOG)

szev_wlg               = bvh

# rU GSV xozhh_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RMSVIRGZMXV IVOZGRLMH. hVGGRMT GSRH GZT GL bvh DROO ULIXV GSV
# GSV xozhh_wrztiznh GZT GL ml.

xozhh_tizks            = bvh

# rU GSV xloozylizgrlm_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RNKOVNVMGZGRLM WVKVMWVMXRVH (RMSVIRGZMXV, XLMGZRMNVMG, ZMW
# XOZHH IVUVIVMXVH EZIRZYOVH) LU GSV XOZHH DRGS LGSVI WLXFNVMGVW XOZHHVH.

xloozylizgrlm_tizks    = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwv_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW UROV HSLDRMT
# GSV WRIVXG ZMW RMWRIVXG RMXOFWV WVKVMWVMXRVH LU GSV UROV DRGS LGSVI
# WLXFNVMGVW UROVH.

rmxofwv_tizks          = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwvw_yb_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW SVZWVI UROV HSLDRMT
# GSV WLXFNVMGVW UROVH GSZG WRIVXGOB LI RMWRIVXGOB RMXOFWV GSRH UROV

rmxofwvw_yb_tizks      = bvh

# rU GSV tizksrxzo_srvizixsb ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TIZKSRXZO SRVIZIXSB LU ZOO XOZHHVH RMHGVZW LU Z GVCGFZO LMV.

tizksrxzo_srvizixsb    = bvh

# gSV GZT wlg_kzgs XZM YV FHVW GL HKVXRUB GSV KZGS DSVIV GSV WLG GLLO XZM YV
# ULFMW. rU OVUG YOZMP, RG RH ZHHFNVW GSV WLG GLLO XZM YV ULFMW LM GSV KZGS.

wlg_kzgs               =

# gSV nzc_wlg_tizks_drwgs GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDVW DRWGS
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_drwgs    = 8975

# gSV nzc_wlg_tizks_svrtsg GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDH SVRTSG
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_svrtsg   = 8975

# rU GSV tvmvizgv_ovtvmw GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z OVTVMW KZTV VCKOZRMRMT GSV NVZMRMT LU GSV EZIRLFH YLCVH ZMW
# ZIILDH RM GSV WLG TVMVIZGVW TIZKSH.

tvmvizgv_ovtvmw        = bvh

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL GSV HVZIXS VMTRMV
#---------------------------------------------------------------------------

# gSV hvzixsvmtrmv GZT HKVXRURVH DSVGSVI LI MLG Z HVZIXS VMTRMV HSLFOW YV
# FHVW. rU HVG GL ml GSV EZOFVH LU ZOO GZTH YVOLD GSRH LMV DROO YV RTMLIVW.

hvzixsvmtrmv           = ml

# gSV xtr_mznv GZT HSLFOW YV GSV MZNV LU GSV xtr HXIRKG GSZG
# HGZIGH GSV HVZIXS VMTRMV (WLCBHVZIXS) DRGS GSV XLIIVXG KZIZNVGVIH.
# z HXIRKG DRGS GSRH MZNV DROO YV TVMVIZGVW YB WLCBTVM.

xtr_mznv               = HVZIXS.XTR

# gSV xtr_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# XTR YRMZIRVH ZIV OLXZGVW. hVV GSV WLXFNVMGZGRLM LU BLFI SGGK WZVNLM ULI
# WVGZROH.

xtr_fio                =

# gSV wlx_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV ZYHLOFGV KZGS GL GSV
# WLXFNVMGZGRLM, DRGS UROV:// KIVKVMWVW GL RG, DROO YV FHVW.

wlx_fio                =

# gSV wlx_zyhkzgs GZT HSLFOW YV GSV ZYHLOFGV KZGS GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV WRIVXGLIB LM GSV OLXZO NZXSRMV
# DROO YV FHVW.

wlx_zyhkzgs            =

# gSV yrm_zyhkzgs GZT NFHG KLRMG GL GSV WRIVXGLIB DSVIV GSV WLCBHVZIXS YRMZIB
# RH RMHGZOOVW.

yrm_zyhkzgs            = /FHI/OLXZO/YRM/

# gSV vcg_wlx_kzgsh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KZGSH GL
# WLXFNVMGZGRLM TVMVIZGVW ULI LGSVI KILQVXGH. gSRH ZOOLDH WLCBHVZIXS GL HVZIXS
# GSV WLXFNVMGZGRLM ULI GSVHV KILQVXGH ZH DVOO.

vcg_wlx_kzgsh          =

//##**---------------- ./FYRJFMREVIHV/IVZWNV.NW
ivzwnv
=================================

# FYRJFMREVIHV(8)

  `FYRJFMREVIHV(8)` RH Z YZHRX GLLO FHVW YB fYRJFZMG WVEVOLKNVMG; rG RMXOFWVH XLNNLM FGRORGRVH XLEVIZTV,
  HFXS ZH UZHG HGIRMT NZMRKFOZGRLM, UROV XSVXP, IFM GRNV OLT, SRTS WVURMRGRLM GRNV NZMRKFOZGRLM, WBMZNRX
  ORYIZIB SZMWORMT, ZMW HL LM (IVUVI GL GSV WLX ULI NLIV WVGZROH).


## fHZTV

    fHZTV: FYRJFMREVIHV

    qFHG RMXOFWV FYRJFMREVIHV.S RM BLFI KILQVXG ZMW ORMP ZTZRMHG ORYFYRJFMREVIHV.Z ZMW GSVM ZOO RH HVG.

## rMHGZOOZGRLM

  rMHGZOO `FYRJFMREVIHV(8)` ZMW RGH ZHHLXRZGVW ORYH ZMW SVZWVI UROVH GL /LKG.

    $ NZPV RMHGZOO


## zYLFG


## xLMURTFIZGRLM

  KZPXZTV MVVWH HLNV VCGIZ XLMURTFIZGRLM


## 6IW KZIGB XLWV/KILQVXGH ORHG ZMW NLWRURXZGRLMH:
=================================
# XHEKZIHVI(RMXOFWV/XHE.S)
NLWRURXZGRLM:
8. XSZMTVW MZNVHKZXV GL FYRJFMREVIHV
7. IVKOZXVW VCXVKGRLM GBKV GL FYRJ::FYRJ_VCXVKGRLM
6. XSZMTV HGW::GSIVZW GL NLIV TVMVIZO GSIVZW HFKKLIG
5. LIRTRMZO EVIHRLM XLMGZRMH GLL NZMB NLWVIM X++88 UVZGFIVH, ZWZKZGVW/NLWRURVW/WLDMTIZWVW GL DLIP DRGS ZMXRVMG TXX 5.5 XLNKROVIH

# IZKRWCNO (RMXOFWV/IZKRWCNO*.SKK)
ML NLWRURXZGRLM

//##**---------------- ./FYRJFMREVIHV/GLWL.GCG
glwl orhg
======================

# GSRH UROV XLMGZRMH EZIRLFH GLWL GZHPH FHRMT ULINZG ZH [kirlirgb  gzhp]

# kirlirgb   gzhp

*z*  GSRH RH Z GZHP @YFT

*y*  GSRH RH Z MVD UVZGFIV @UVZGFIV
//##**---------------- ./FYRJFMREVIHV/EVIHRLM.HS
EVIHRLM=
YFROW=
HSLD=
FKWZGV=
ZWW=
YFROW=
NZPV=

XSZMTVOLT=$(WRIMZNV $9)/xSZMTVoLT


DSROV TVGLKGH "HYZSFINT" LKG;
WL
  XZHV "$LKG" RM
    H) HSLD="B"
      ;;
    Y) YFROW="B"
      ;;
    S) VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F"
       VXSL "-H: HSLD XFIIVMG EVIHRLM"
       VXSL "-Z LI -I: ZWW LI IVOVZHV Z MVD EVIHRLM"
       VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
       VXSL "-T: HSLD TRG SVZW"
       VCRG 8
      ;;
    Z) ZWW="B"
      ;;
    F) FKWZGV="B"
      ;;
    I) ZWW="B"
      ;;
    N) NZPV="B"
      ;;
    T) TRGHSLD="B"
      ;;
  VHZX
WLMV

RU [[ -A $ZWW ]] && [[ -A $TRGHSLD ]] && [[ -A $FKWZGV ]] && [[ -A $HSLD ]] && [[ -A $YFROW ]] && [[ -A $NZPV ]]
GSVM
    VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F"
    VXSL "-H: HSLD XFIIVMG IVOVZHV EVIHRLM"
    VXSL "-Z LI -I : ZWW LI IVOVZHV Z MVD EVIHRLM"
    VXSL "-Y: HSLD XFIIVMG YFROW EVIHRLM"
    VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
    VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
    VXSL "-T: ZXJFRIV TRG SVZW"
    VCRG 8
UR

ORMV_MFN=9

DSROV IVZW ORMV
WL
  ORMV_MFN=$((ORMV_MFN+8))
  MZNV=$(VXSL $ORMV|GI -H " ")
  URIHG_XSZIZXGVI=${MZNV:9:8}
  RU [ "$URIHG_XSZIZXGVI" == "@" ];GSVM
    MZNV=${MZNV:7:${#MZNV}-6}
    EVIHRLM=$MZNV
    YIVZP
  VORU [ "$URIHG_XSZIZXGVI" == "%" ];GSVM
    MZNV=${MZNV:2:${#MZNV}-1}
    YFROWML=$MZNV
  UR
WLMV < $XSZMTVOLT

RU [[ ! -A $HSLD ]]; GSVM
  KIRMGU $EVIHRLM
  VCRG 9
UR


RU [[ ! -A $YFROW ]]; GSVM
  KIRMGU $YFROWML
  VCRG 9
UR

RU [[ ! -A $TRGHSLD ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  HVW -R "/trgsvzw/X\trgsvzw=$ts" .KZIZ.RMX
  VCRG 9
UR



RU [[ ! -A $NZPV  ]]; GSVM
    YFROW_RMG=${YFROWML:0:${#YFROWML}-0}
    YFROW_WG=${YFROWML:9:${#YFROWML}-4}
    (( YFROW_RMG = 89#$YFROW_RMG + 8 ))
    GLWZB=`WZGV +%b%N%W`
    YFROW_RMG=$(KIRMGU "%95W" $YFROW_RMG)
    RU [ "$YFROW_WG" -VJ "$GLWZB"  ]; GSVM
        YFROWML=$YFROW_WG-$YFROW_RMG
    VOHV
        YFROWML=$GLWZB-9998
    UR
    HVW -R "H/.*yfrow.*/%yfrow[$YFROWML]/" $XSZMTVOLT
    KIRMGU $YFROWML
    VCRG 9
UR


NLWRURVW=$(WZGV +%b-%N-%W)

BVOOLD='\966[8;66N'
mx='\966[9N'

RU [[ ! -A $ZWW ]]; GSVM
  KIRMGU "iVOVZHRMT Z MVD EVIHRLM, GSV NLHG IVXVMG EVIHRLM RH ${BVOOLD}$EVIHRLM${mx}:\M"
  IVZW -K "mVD EVIHRLM ml: " MVDEVIHRLM
  IVZW -K "mVD EVIHRLM MZNV: " EVIHRLMMZNV
  IVZW -K "mVD EVIHRLM YIRVU: " YIRVU
  HVW -R "${ORMV_MFN}R\\
@[$MVDEVIHRLM]\M# $NLWRURVW\M## $EVIHRLMMZNV \M- $YIRVU\M\\
    " $XSZMTVOLT
  VXSL "xSZMTVoLT FKWZGVW, MVD EVIHRLM $MVDEVIHRLM RMHVIGVW"
  VCRG 9
UR

RU [[ ! -A $FKWZGV ]]; GSVM
    URMW . -GBKV U \( -MZNV "*.XKK" -L -MZNV "*.S" \)  -KIRMG9 |  CZITH -9 HVW -R -V "H/\*\H\\\EVIHRLM.*/\* \\\EVIHRLM   $EVIHRLM/"
    URMW . -GBKV U \( -MZNV "*.XKK" -L -MZNV "*.S" \)  -KIRMG9 |  CZITH -9 HVW -R -V "H/\*\H\\\NLWRURVW.*/\* \\\NLWRURVW  $NLWRURVW/"
    VXSL "eVIHRLM ml RM ZOO UROVH FKWZGVW"
UR

//##**---------------- ./FYRJFMREVIHV/xSZMTVoLT
kilqvxg: FYRJGLLO
zfgsli: FYRJFZMG
xivzgvw: 7984-94-77


# xSZMTV oLT
zOO MLGZYOV XSZMTVH GL GSRH KILQVXG DROO YV WLXFNVMGVW RM GSRH UROV.
fHFZOOB VZXS RGVN RH ZWSVIVW GL LMV IVOVZHV MFNYVI XSZMTV


%yfrow[79838790-9997]


@[8.9.7]
# 7984-92-75
## ZZ
- ZWW ZIT ULI ORMVH LU OLT


@[8.9.8]
# 7984-92-98
## YLIM
- ZWWVW HGO


@[8.9.9]
# 7984-93-98
## YLIM
- URIHG ULINZO IVOVZHRLM


@[9.9.8]
# 7984-94-77
## KILQVXG RH RMRGRZOAVW
- KILQVXG RMRGRZORAVW, GSRH HSLFOW YV GSV *EVIB* URIHG EVIHRLM
//##**---------------- ./FYRJYZHV/VGX/VCXSZMTV.CNO
<?CNO EVIHRLM="8.9" ?>
<VCXSZMTVH>

    <VCXSZMTV RW="9" MZNV="xSRMZ uRMZMXV uFGFIVH vCXSZMTV" IVTRLM="xm" HVGGOVNVMG="g+9" HBNYLO="xuuvc" GBKV="ufgfivh">
      <GRNV KIVLKVM="0:74-0:70" MLINZO="0:69-88:69,86:99-84:99"  />
  </VCXSZMTV>

  <VCXSZMTV RW="8" MZNV="hSZMTSZR uFGFIVH vCXSZMTV" IVTRLM="xm" HVGGOVNVMG="g+9" HBNYLO="hsuv" WZB_HGZIG="81:99" GBKV="ufgfivh">
      <GRNV KIVLKVM="79:44-79:40,1:44-1:40" MLINZO="0:99-89:84,89:69-88:69,86:69-84:99,78:99-97:69"  />
  </VCXSZMTV>

  <VCXSZMTV RW="7" MZNV="aSVMASLF uFGFIVH vCXSZMTV" IVTRLM="xm" HVGGOVNVMG="g+9" HBNYLO="xaxv" WZB_HGZIG="81:99"  GBKV="ufgfivh">
      <GRNV KIVLKVM="79:44-79:40,1:44-1:40" MLINZO="0:99-89:84,89:69-88:69,86:69-84:99,78:99-97:69"  />
  </VCXSZMTV>

  <VCXSZMTV RW="6" MZNV="wZORZM uFGFIVH vCXSZMTV" IVTRLM="xm" HVGGOVNVMG="g+9" HBNYLO="wxv" WZB_HGZIG="81:99" GBKV="ufgfivh">
      <GRNV KIVLKVM="79:44-79:40,1:44-1:40" MLINZO="0:99-89:84,89:69-88:69,86:69-84:99,78:99-76:69"  />
  </VCXSZMTV>

  <VCXSZMTV RW="5" MZNV="hsvmavm hv" IVTRLM="xm" HVGGOVNVMG="g+7" HBNYLO="hav" GBKV="vjfrgb">
      <GRNV KIVLKVM="0:84-0:74" MLINZO="0:69-88:69,86:99-84:99"  />
  </VCXSZMTV>

  <VCXSZMTV RW="4" MZNV="hszmtszr hv" IVTRLM="xm" HVGGOVNVMG="g+7" HBNYLO="hhv" GBKV="vjfrgb">
      <GRNV KIVLKVM="0:84-0:74" MLINZO="0:69-88:69,86:99-84:99"  />
  </VCXSZMTV>

  <VCXSZMTV RW="3" MZNV="slmt plmt hv" IVTRLM="sp" HVGGOVNVMG="g+7" HBNYLO="spt" GBKV="vjfrgb">
      <GRNV KIVLKVM="0:99-0:69" MLINZO="0:69-87:99,86:99-83:99"  />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="2" MZNV="slmt plmt tvn" IVTRLM="sp" HVGGOVNVMG="g+7" HBNYLO="stn" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="1" MZNV="gzrdzm hv" IVTRLM="gd" HVGGOVNVMG="g+7" HBNYLO="gzr" GBKV="vjfrgb">
      <GRNV KIVLKVM="1:69-0:99" MLINZO="0:99-86:69"  />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="0" MZNV="gzrdzm lgx" IVTRLM="gd" HVGGOVNVMG="g+7" HBNYLO="cgl" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="89" MZNV="hv lu hrmtzkliv" IVTRLM="ht" HVGGOVNVMG="g+7" HBNYLO="hvh" GBKV="vjfrgb">
      <GRNV KIVLKVM="1:99-1:40" MLINZO="0:99-82:99"  />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="88" MZNV="hrmtzkliv xoly rmgo" IVTRLM="ht" HVGGOVNVMG="g+7" HBNYLO="cxl" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="87" MZNV="pLIVZ hv" IVTRLM="pi" HVGGOVNVMG="g+7" HBNYLO="pic" GBKV="vjfrgb">
      <GRNV KIVLKVM="" MLINZO="0:99-84:99"  />
  </VCXSZMTV>
  <VCXSZMTV RW="86" MZNV="pLIVZ hv (plhwzj)" IVTRLM="pi" HVGGOVNVMG="g+7" HBNYLO="plh" GBKV="vjfrgb">
      <GRNV KIVLKVM="" MLINZO="0:99-84:99"  />
  </VCXSZMTV>
  <VCXSZMTV RW="85" MZNV="pLIVZ mVD vCXSZMTV" IVTRLM="pi" HVGGOVNVMG="g+7" HBNYLO="plm" GBKV="vjfrgb">
      <GRNV KIVLKVM="" MLINZO="0:99-84:99"  />
  </VCXSZMTV>
  <VCXSZMTV RW="84" MZNV="yhv oGW" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="yln" GBKV="vjfrgb">
      <GRNV KIVLKVM="" MLINZO="0:84-84:69" />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="83" MZNV="yzmtzoliv hv" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="yzm" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="82" MZNV="xzoxfggz hv" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="xzo" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="81" MZNV="nzwizh hv" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="nwh" GBKV="vjfrgb"> </VCXSZMTV>-->

  <VCXSZMTV RW="80" MZNV="mzgrlmzo rmwrz" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="mhv" GBKV="vjfrgb">
      <GRNV KIVLKVM="0:99-0:91" MLINZO="0:84-84:69"  />
  </VCXSZMTV>

  <!--<VCXSZMTV RW="79" MZNV="wvosr hv" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="wvh" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="78" MZNV="yLNYZB uLIVRTM yLZIW" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="yyu" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="77" MZNV="mZGRLMZO uLIVRTM yIW" IVTRLM="rm" HVGGOVNVMG="g+7" HBNYLO="msu" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="76" MZNV="nvoylfimv" IVTRLM="zf" HVGGOVNVMG="g+7" HBNYLO="cny" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="75" MZNV="xsr-c zfhgizorz" IVTRLM="zf" HVGGOVNVMG="g+7" HBNYLO="xcz" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="74" MZNV="zhc kfivnzgxs" IVTRLM="zfh" HVGGOVNVMG="g+7" HBNYLO="zck" GBKV="vjfrgb">
      <GRNV KIVLKVM="2:99-89:99" MLINZO="89:99-83:99"  />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="73" MZNV="mZGRLMZO hv zFHGIZORZ" IVTRLM="zf" HVGGOVNVMG="g+7" HBNYLO="mvx" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="72" MZNV="hbwmvb hv" IVTRLM="zfh" HVGGOVNVMG="g+7" HBNYLO="zhc" GBKV="vjfrgb">
      <GRNV KIVLKVM="1:99-89:84" MLINZO="89:84-83:84" />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="71" MZNV="zfxpozmw hv" IVTRLM="ma" HVGGOVNVMG="g+7" HBNYLO="zfp" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="70" MZNV="hv lu gszrozmw ulitm" IVTRLM="gs" HVGGOVNVMG="g+7" HBNYLO="ypu" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="69" MZNV="hv lu gszrozmw" IVTRLM="gs" HVGGOVNVMG="g+7" HBNYLO="ypp" GBKV="vjfrgb">
      <GRNV KIVLKVM="0:69-89:99,85:99-85:69" MLINZO="89:99-87:69,85:69-83:69"  />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="68" MZNV="xlolnyl hv" IVTRLM="op" HVGGOVNVMG="g+7" HBNYLO="xlo" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="67" MZNV="xsrggztlmt (yzmtozwvhs)" IVTRLM="yw" HVGGOVNVMG="g+7" HBNYLO="xst" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="66" MZNV="wzxxz hv" IVTRLM="yw" HVGGOVNVMG="g+7" HBNYLO="wsz" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="65" MZNV="szrmzm (xsrmz)" IVTRLM="xm" HVGGOVNVMG="g+7" HBNYLO="csw" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="64" MZNV="rhoznzyzw hv" IVTRLM="kp" HVGGOVNVMG="g+7" HBNYLO="rho" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="63" MZNV="rMWLMVHRZ hv" IVTRLM="rw" HVGGOVNVMG="g+7" HBNYLO="rwc" GBKV="vjfrgb">
      <GRNV KIVLKVM="" MLINZO="0:99-88:99"  />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="62" MZNV="kZPRHGZM hv" IVTRLM="kp" HVGGOVNVMG="g+7" HBNYLO="pzi" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="61" MZNV="pfzoz ofnkfi hv" IVTRLM="nb" HVGGOVNVMG="g+7" HBNYLO="poh" GBKV="vjfrgb">
      <GRNV KIVLKVM="1:84-1:69,85:99-85:70:69" MLINZO="1:54-87:54,85:69-82:84"    />
  </VCXSZMTV>

  <VCXSZMTV RW="60" MZNV="nZOZBHRZ zxv nPG" IVTRLM="nb" HVGGOVNVMG="g+7" HBNYLO="cpn" GBKV="vjfrgb">
      <GRNV KIVLKVM="1:84-1:54,85:99-85:69" MLINZO="1:54-87:54,85:69-82:69"    />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="59" MZNV="nzozbhrz hvxlmw ylziw" IVTRLM="nb" HVGGOVNVMG="g+7" HBNYLO="cph" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="58" MZNV="ozsliv hv" IVTRLM="kp" HVGGOVNVMG="g+7" HBNYLO="ozs" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="57" MZNV="nzpzgr hv" IVTRLM="ks" HVGGOVNVMG="g+7" HBNYLO="nzp" GBKV="vjfrgb"> </VCXSZMTV>-->
  <VCXSZMTV RW="56" MZNV="ksrorkkrmv hv" IVTRLM="ks" HVGGOVNVMG="g+7" HBNYLO="ksh" GBKV="vjfrgb">
      <GRNV KIVLKVM="" MLINZO="0:69-84:69"  />
  </VCXSZMTV>
  <!--<VCXSZMTV RW="55" MZNV="mvd avzozmw mazc" IVTRLM="ma" HVGGOVNVMG="g+7" HBNYLO="cma" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="54" MZNV="hRMTZKLIV xZGZORHG nZIPVG" IVTRLM="ht" HVGGOVNVMG="g+7" HBNYLO="chh" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="53" MZNV="mVD aVZOZMW hv" IVTRLM="ma" HVGGOVNVMG="g+7" HBNYLO="mav" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="52" MZNV="xG. zHRZM pZAZPSHGZM" IVTRLM="pa" HVGGOVNVMG="g+7" HBNYLO="cxp" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="51" MZNV="sL xSR nRMS" IVTRLM="em" HVGGOVNVMG="g+7" HBNYLO="csx" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="50" MZNV="rMGVIRLZMGOZ pZAZP." IVTRLM="pa" HVGGOVNVMG="g+7" HBNYLO="cpr" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="49" MZNV="pZAZPSHGZM" IVTRLM="pa" HVGGOVNVMG="g+7" HBNYLO="pza" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="48" MZNV="sZMLR lgx" IVTRLM="em" HVGGOVNVMG="g+7" HBNYLO="smc" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="47" MZNV="sZMLR hgx" IVTRLM="em" HVGGOVNVMG="g+7" HBNYLO="shg" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="46" MZNV="qZPZIGZ uLIVRTM" IVTRLM="rw" HVGGOVNVMG="g+7" HBNYLO="qpg" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="45" MZNV="oZL HVXFIRGRVH vCXSZMTV" IVTRLM="oz" HVGGOVNVMG="g+7" HBNYLO="ozl" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="44" MZNV="nLMTLORZ hGLXP v" IVTRLM="nm" HVGGOVNVMG="g+7" HBNYLO="nmv" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="43" MZNV="hhv xLMMVXG vJFRGRVH" IVTRLM="xm" HVGGOVNVMG="g+7" HBNYLO="hhx" GBKV="vjfrgb"> </VCXSZMTV>-->
  <!--<VCXSZMTV RW="42" MZNV="sphv xLMMVXG vJFRGB" IVTRLM="sp" HVGGOVNVMG="g+7" HBNYLO="shx" GBKV="vjfrgb"> </VCXSZMTV>-->
</VCXSZMTVH>
//##**---------------- ./FYRJYZHV/VGX/HBHGVN.CNO
<?CNO EVIHRLM="8.9" ?>
<HBHGVN>
    <SLHG SLHG="CCC" WLNZRM="CCC" />

    <GRNVALMV GA="zHRZ/hSZMTSZR" LUUHVG="tng+1"/>
    <XKF>
        <HLXPVG RW="9" KFYORX="7" LH="9" XLIV="9,8,7,6,5,4"/>
        <HLXPVG RW="8" KFYORX="1" LH="" XLIV="3,2,1,0,89,88"/>
    </XKF>

    <XLIV_FHZTV>
        <FHZTV KILTIZN="FGIZWV_ZZZ" NZRM="" KFYORX="7"/>
        <FHZTV KILTIZN="kFYhFYhVIERXV" NZRM="89" KFYORX="7"/>
        <FHZTV KILTIZN="yILPVI" NZRM="88" KFYORX="7"/>
        <FHZTV KILTIZN="WZGZYLC" NZRM="0" KFYORX="1"/>
        <FHZTV KILTIZN="GY" NZRM="1" KFYORX="1"/>
    </XLIV_FHZTV>
    <NVNLIB></NVNLIB>
</HBHGVN>
//##**---------------- ./FYRJYZHV/VGX/SLHG.CNO
<?CNO EVIHRLM="8.9" ?>
<SLHGH>
    <KILWFXG>
        <SLHG SLHG="FYRJYQ8" WLNZRM="FYRJFZMG" />
        <SLHG SLHG="FYRJYQ7" WLNZRM="FYRJFZMG" WZGZ="ML"/>
        <SLHG SLHG="FYRJHS" WLNZRM="FYRJFZMG" WZGZ="ML"/>
    </KILWFXG>
    <WVEVOLK>
        <SLHG SLHG="FYRJ8" WLNZRM="FYRJFZMG" />
        <SLHG SLHG="FYRJ5" WLNZRM="FYRJFZMG" WZGZ="ML"/>
    </WVEVOLK>
    <IVHVZIXS>
        <SLHG SLHG="FYRJIH8" WLNZRM="FYRJFZMG" WZGZ="ML"/>
        <SLHG SLHG="FYRJIH7" WLNZRM="FYRJFZMG" WZGZ="ML"/>
    </IVHVZIXS>
    <XGZ>
        <SLHG SLHG="ACAQ8" WLNZRM="ACJS" />
        <SLHG SLHG="ACAQ7" WLNZRM="ACJS" />
        <SLHG SLHG="SGAQ8" WLNZRM="SGJS" />
        <SLHG SLHG="CAAQ8" WLNZRM="CAJS" />
    </XGZ>
    <SUG>
        <SLHG SLHG="SGHJ7" WLNZRM="SGJS" />
        <SLHG SLHG="SGWO8" WLNZRM="SGJS" />
        <SLHG SLHG="SGBW8" WLNZRM="SGJS" />
        <SLHG SLHG="TWBW8" WLNZRM="TWJS" />
        <SLHG SLHG="WAHJ8" WLNZRM="WAJS" />
    </SUG>
    <HGLXP>
        <SLHG SLHG="SYAJ8" WLNZRM="SYAJ" ZXGREV="ML"/>
        <SLHG SLHG="SYAJ7" WLNZRM="SYAJ" />
    </HGLXP>
    <SP>
        <SLHG SLHG="XGSP8" WLNZRM="XGAJ" />
    </SP>
</SLHGH>
//##**---------------- ./FYRJYZHV/VGX/IVTRLM.CNO
<?CNO EVIHRLM="8.9" ?>
<IVTRLMH>
  <!--<IVTRLM RW="9" GRNVALMV="yw">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->
  <!--<IVTRLM RW="8" GRNVALMV="nm">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->
  <IVTRLM RW="7" HBNYLO="xm" XLMGRMVMG="zHRZ" MZGRLM="xSRMZ">
      <GRNVALMV WHG="UZOHV" XRGB="hSZMTSZR" FGX_LUUHVG="1" GRNVALMV="zHRZ/hSZMTSZR" HBNYLO="xm"/>
  </IVTRLM>

  <IVTRLM RW="6" HBNYLO="pi" XLMGRMVMG="zHRZ" MZGRLM="pLIVZ">
      <GRNVALMV WHG="UZOHV" XRGB="hVLFO" FGX_LUUHVG="0" GRNVALMV="zHRZ/hVLFO" HBNYLO="pi"/>
  </IVTRLM>

  <IVTRLM RW="5" HBNYLO="gd" XLMGRMVMG="zHRZ" MZGRLM="gZRDZM">
      <GRNVALMV WHG="UZOHV" XRGB="gZRKVR" FGX_LUUHVG="1" GRNVALMV="zHRZ/gZRKVR" HBNYLO="gd"/>
  </IVTRLM>
  <!--<IVTRLM RW="4" GRNVALMV="oz">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->
  <!--<IVTRLM RW="3" GRNVALMV="op">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->
  <!--<IVTRLM RW="2" GRNVALMV="em">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->
  <!--<IVTRLM RW="1" GRNVALMV="pa">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->
  <IVTRLM RW="0" HBNYLO="sp" XLMGRMVMG="zHRZ" MZGRLM="sLMT_pLMT">
      <GRNVALMV WHG="UZOHV" XRGB="sLMT_pLMT"  FGX_LUUHVG="1" GRNVALMV="zHRZ/sLMT_pLMT" HBNYLO="sp"/>
  </IVTRLM>
  <!--<IVTRLM RW="89" GRNVALMV="ma">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->
  <IVTRLM RW="88" HBNYLO="zf" XLMGRMVMG="zFHGIZORZ" MZGRLM="zFHGIZORZ">
      <GRNVALMV WHG="UZOHV" XRGB="hBWMVB" FGX_LUUHVG="89"  GRNVALMV="zFHGIZORZ/hBWMVB" HBNYLO="zfh"/>
  </IVTRLM>

  <IVTRLM RW="87" HBNYLO="nb" XLMGRMVMG="zHRZ" MZGRLM="nZOZBHRZ" >
      <GRNVALMV WHG="UZOHV" XRGB="pFZOZ_oFNKFI" FGX_LUUHVG="1" GRNVALMV="zHRZ/pFZOZ_oFNKFI" HBNYLO="nb"/>
  </IVTRLM>

  <IVTRLM RW="86" HBNYLO="gs" XLMGRMVMG="zHRZ" MZGRLM="gSZROZMW">
      <GRNVALMV WHG="UZOHV" XRGB="yZMTPLP" FGX_LUUHVG="2" GRNVALMV="zHRZ/yZMTPLP" HBNYLO="gs"/>
  </IVTRLM>

  <IVTRLM RW="85" HBNYLO="rm" XLMGRMVMG="zHRZ" MZGRLM="rMWRZ">
      <GRNVALMV WHG="UZOHV" XRGB="pLOPZGZ" FGX_LUUHVG="4.4" GRNVALMV="zHRZ/pLOPZGZ" HBNYLO="rm" />
  </IVTRLM>
  <!--<IVTRLM RW="84" GRNVALMV="kp">-->
    <!--<GRNVALMV WHG="UZOHV" FGX_LUUHVG="1"/>-->
  <!--</IVTRLM>-->

  <IVTRLM RW="83" HBNYLO="ks" XLMGRMVMG="zHRZ" MZGRLM="kSRORKKRMVH">
      <GRNVALMV WHG="UZOHV" XRGB="nZMROZ"  FGX_LUUHVG="1" GRNVALMV="zHRZ/nZMROZ" HBNYLO="ks"/>
  </IVTRLM>

  <IVTRLM RW="82" HBNYLO="ht" XLMGRMVMG="zHRZ" MZGRLM="hRMTZKLIV">
      <GRNVALMV WHG="UZOHV" XRGB="hRMTZKLIV" FGX_LUUHVG="1" GRNVALMV="zHRZ/hRMTZKLIV" HBNYLO="ht"/>
  </IVTRLM>

  <IVTRLM RW="81" HBNYLO="rw" XLMGRMVMG="zHRZ" MZGRLM="rMWLMVHRZ">
      <GRNVALMV WHG="UZOHV" XRGB="qZPZIGZ" FGX_LUUHVG="2" GRNVALMV="zHRZ/qZPZIGZ" HBNYLO="rw"/>
  </IVTRLM>

</IVTRLMH>
//##**---------------- ./FYRJYZHV/RMXOFWV/gYzKRgBKV.S
#RUMWVU __gy_zkr_gbkv__
#WVURMV __gy_zkr_gbkv__

#WVURMV gy_zKRgBKV_uVNZH 9
#WVURMV gy_zKRgBKV_xgk 8
#WVURMV gy_zKRgBKV_aVFHRMT 7
#WVURMV gy_zKRgBKV_ogh 6
#WVURMV gy_zKRgBKV_hRN 5
#WVURMV gy_zKRgBKV_uVNZH7 4

#VMWRU
//##**---------------- ./FYRJYZHV/RMXOFWV/zXXLFGgBKV.S
#RUMWVU __fyrjyzhv_zxxlfmg_gbkv_
#WVURMV __fryjyzhv_zxxlfmg_gbkv_

#WVURMV fyrj_zxxgbkv_xzhs      9
#WVURMV fyrj_zxxgbkv_nzitrm    8
#WVURMV fyrj_zxxgbkv_ufghkvx   7
#WVURMV fyrj_zxxgbkv_ufgsvwtv  6
#WVURMV fyrj_zxxgbkv_ufgziy    5
#WVURMV fyrj_zxxgbkv_lkgrlm    4

#VMWRU
//##**---------------- ./FYRJYZHV/RMXOFWV/nZIPVGwZGZhGIFXG.S

#RUMWVU nzipvgwzgzhgifxg_s
#WVURMV nzipvgwzgzhgifxg_s

HGIFXG uFGFIVHnZIPVGwZGZuRVOW{

    XSZI oLXZOgRNV[67];

    XSZI gIZWRMTwZB[0];

    XSZI rMHGIFNVMGrw[68];

    XSZI vCXSZMTVrw[0];

    XSZI vCXSZMTVrMHGrw[68];

    WLFYOV oZHGkIRXV;

    WLFYOV kIVhVGGOVNVMGkIRXV;

    WLFYOV kIVxOLHVkIRXV;

    WLFYOV kIVlKVMrMGVIVHG;

    WLFYOV lKVMkIRXV;

    WLFYOV sRTSVHGkIRXV;

    WLFYOV oLDVHGkIRXV;

    RMG eLOFNV;

    WLFYOV gFIMLEVI;

    WLFYOV lKVMrMGVIVHG;

    WLFYOV xOLHVkIRXV;

    WLFYOV hVGGOVNVMGkIRXV;

    WLFYOV fKKVIoRNRGkIRXV;

    WLFYOV oLDVIoRNRGkIRXV;

    WLFYOV kIVwVOGZ;

    WLFYOV xFIIwVOGZ;

    XSZI fKWZGVgRNV[0];

    RMG fKWZGVnROORHVX;

    WLFYOV yRWkIRXV8;

    RMG yRWeLOFNV8;

    WLFYOV zHPkIRXV8;

    RMG zHPeLOFNV8;

    WLFYOV yRWkIRXV7;

    RMG yRWeLOFNV7;

    WLFYOV zHPkIRXV7;

    RMG zHPeLOFNV7;

    WLFYOV yRWkIRXV6;

    RMG yRWeLOFNV6;

    WLFYOV zHPkIRXV6;

    RMG zHPeLOFNV6;

    WLFYOV yRWkIRXV5;

    RMG yRWeLOFNV5;

    WLFYOV zHPkIRXV5;

    RMG zHPeLOFNV5;

    WLFYOV yRWkIRXV4;

    RMG yRWeLOFNV4;

    WLFYOV zHPkIRXV4;

    RMG zHPeLOFNV4;

    WLFYOV zEVIZTVkIRXV;


};

HGIFXG rMWVCnZIPVGwZGZuRVOW
{
    XSZI oLXZOgRNV[67];

    XSZI gIZWRMTwZB[0];
    XSZI gRNVhGZNK[0];
    XSZI vCXSZMTVrw[0];
    XSZI	rMHGIFNVMGrw[68];
    WLFYOV	kIVxOLHVrMWVC;
    WLFYOV	lKVMrMWVC;
    WLFYOV	xOLHVrMWVC;
    WLFYOV	sRTSrMWVC;
    WLFYOV	oLDrMWVC;
    WLFYOV	oZHGrMWVC;
    WLFYOV gFIMlEVI;
    WLFYOV gLGZOeLOFNV;
};

HGIFXG vJFRGBnZIPVGwZGZuRVOW{

    // WVUZFOG XGLI
    vJFRGBnZIPVGwZGZuRVOW(){

    }
    // XGLI ULI KBGSLM KRXPORMT
    vJFRGBnZIPVGwZGZuRVOW( XLMHG XSZI * _oLXZOgRNV, XLMHG XSZI* _gIZWRMTwZB, XLMHG XSZI* _gRNVhGZNK, XLMHG XSZI *_vCXSZMTVrw, XLMHG XSZI *_rMHGIFNVMGrw,
            WLFYOV _kIVxOLHVkIRXV, WLFYOV _lKVMkIRXV, WLFYOV _xOLHVkIRXV, WLFYOV _rlke, WLFYOV _bRVOWgLnZGFIRGB, WLFYOV _sRTSkIRXV, WLFYOV _oLDkIRXV, WLFYOV _oZHGkIRXV, RMG _gIZWVxLFMG,
            WLFYOV _gLGZOgIZWVeLOFNV, WLFYOV _gLGZOgIZWVeZOFV, WLFYOV _gLGZOyRWeLOFNV, WLFYOV _dVRTSGVWzETyRWkIRXV, WLFYOV _zOGdVRTSGVWzETyRWkIRXV,
            WLFYOV _gLGZOlUUVIeLOFNV, WLFYOV _dVRTSGVWzETlUUVIkIRXV,  WLFYOV _zOGdVRTSGVWzETlUUVIkIRXV, RMG _yRWkIRXVoVEVO, RMG _lUUVIkIRXVoVEVO,
            WLFYOV _yRWkIRXV8, RMG _yRWeLOFNV8, RMG _yRWxLFMG8,  WLFYOV _yRWkIRXV7, RMG _yRWeLOFNV7, RMG _yRWxLFMG7,
            WLFYOV _yRWkIRXV6, RMG _yRWeLOFNV6, RMG _yRWxLFMG6,  WLFYOV _yRWkIRXV5, RMG _yRWeLOFNV5, RMG _yRWxLFMG5,
            WLFYOV _yRWkIRXV4, RMG _yRWeLOFNV4, RMG _yRWxLFMG4,  WLFYOV _yRWkIRXV3, RMG _yRWeLOFNV3, RMG _yRWxLFMG3,
            WLFYOV _yRWkIRXV2, RMG _yRWeLOFNV2, RMG _yRWxLFMG2,  WLFYOV _yRWkIRXV1, RMG _yRWeLOFNV1, RMG _yRWxLFMG1,
            WLFYOV _yRWkIRXV0, RMG _yRWeLOFNV0, RMG _yRWxLFMG0,  WLFYOV _yRWkIRXVz, RMG _yRWeLOFNVz, RMG _yRWxLFMGz,
            WLFYOV _lUUVIkIRXV8, RMG _lUUVIeLOFNV8, RMG _lUUVIxLFMG8,  WLFYOV _lUUVIkIRXV7, RMG _lUUVIeLOFNV7, RMG _lUUVIxLFMG7,
            WLFYOV _lUUVIkIRXV6, RMG _lUUVIeLOFNV6, RMG _lUUVIxLFMG6,  WLFYOV _lUUVIkIRXV5, RMG _lUUVIeLOFNV5, RMG _lUUVIxLFMG5,
            WLFYOV _lUUVIkIRXV4, RMG _lUUVIeLOFNV4, RMG _lUUVIxLFMG4,  WLFYOV _lUUVIkIRXV3, RMG _lUUVIeLOFNV3, RMG _lUUVIxLFMG3,
            WLFYOV _lUUVIkIRXV2, RMG _lUUVIeLOFNV2, RMG _lUUVIxLFMG2,  WLFYOV _lUUVIkIRXV1, RMG _lUUVIeLOFNV1, RMG _lUUVIxLFMG1,
            WLFYOV _lUUVIkIRXV0, RMG _lUUVIeLOFNV0, RMG _lUUVIxLFMG0,  WLFYOV _lUUVIkIRXVz, RMG _lUUVIeLOFNVz, RMG _lUUVIxLFMGz
            )
    {
        HGIXKB(oLXZOgRNV, _oLXZOgRNV);
        HGIXKB(gIZWRMTwZB, _gIZWRMTwZB);
        HGIXKB(gRNVhGZNK, _gRNVhGZNK);
        HGIXKB(vCXSZMTVrw, _vCXSZMTVrw);
        HGIXKB(rMHGIFNVMGrw, _rMHGIFNVMGrw);
        kIVxOLHVkIRXV = _kIVxOLHVkIRXV;
        lKVMkIRXV = _lKVMkIRXV;
        xOLHVkIRXV = _xOLHVkIRXV;
        rlke = _rlke;
        bRVOWgLnZGFIRGB = _bRVOWgLnZGFIRGB;
        sRTSkIRXV = _sRTSkIRXV;
        oLDkIRXV = _oLDkIRXV;
        oZHGkIRXV = _oZHGkIRXV;
        gIZWVxLFMG = _gIZWVxLFMG;
        gLGZOgIZWVeLOFNV = _gLGZOgIZWVeLOFNV;
        gLGZOgIZWVeZOFV = _gLGZOgIZWVeZOFV;
        gLGZOyRWeLOFNV = _gLGZOyRWeLOFNV;
        dVRTSGVWzETyRWkIRXV = _dVRTSGVWzETyRWkIRXV;
        zOGdVRTSGVWzETyRWkIRXV = _zOGdVRTSGVWzETyRWkIRXV;
        gLGZOlUUVIeLOFNV = _gLGZOlUUVIeLOFNV;
        dVRTSGVWzETlUUVIkIRXV = _dVRTSGVWzETlUUVIkIRXV;
        zOGdVRTSGVWzETlUUVIkIRXV = _zOGdVRTSGVWzETlUUVIkIRXV;
        yRWkIRXVoVEVO = _yRWkIRXVoVEVO;
        lUUVIkIRXVoVEVO = _lUUVIkIRXVoVEVO;
        yRWkIRXV8 = _yRWkIRXV8;
        yRWeLOFNV8 = _yRWeLOFNV8;
        yRWxLFMG8 = _yRWxLFMG8;
        yRWkIRXV7 = _yRWkIRXV7;
        yRWeLOFNV7 = _yRWeLOFNV7;
        yRWxLFMG7 = _yRWxLFMG7;
        yRWkIRXV6 = _yRWkIRXV6;
        yRWeLOFNV6 = _yRWeLOFNV6;
        yRWxLFMG6 = _yRWxLFMG6;
        yRWkIRXV5 = _yRWkIRXV5;
        yRWeLOFNV5 = _yRWeLOFNV5;
        yRWxLFMG5 = _yRWxLFMG5;
        yRWkIRXV4 = _yRWkIRXV4;
        yRWeLOFNV4 = _yRWeLOFNV4;
        yRWxLFMG4 = _yRWxLFMG4;
        yRWkIRXV3 = _yRWkIRXV3;
        yRWeLOFNV3 = _yRWeLOFNV3;
        yRWxLFMG3 = _yRWxLFMG3;
        yRWkIRXV2 = _yRWkIRXV2;
        yRWeLOFNV2 = _yRWeLOFNV2;
        yRWxLFMG2 = _yRWxLFMG2;
        yRWkIRXV1 = _yRWkIRXV1;
        yRWeLOFNV1 = _yRWeLOFNV1;
        yRWxLFMG1 = _yRWxLFMG1;
        yRWkIRXV0 = _yRWkIRXV0;
        yRWeLOFNV0 = _yRWeLOFNV0;
        yRWxLFMG0 = _yRWxLFMG0;
        yRWkIRXVz = _yRWkIRXVz;
        yRWeLOFNVz = _yRWeLOFNVz;
        yRWxLFMGz = _yRWxLFMGz;
        lUUVIkIRXV8 = _lUUVIkIRXV8;
        lUUVIeLOFNV8 = _lUUVIeLOFNV8;
        lUUVIxLFMG8 = _lUUVIxLFMG8;
        lUUVIkIRXV7 = _lUUVIkIRXV7;
        lUUVIeLOFNV7 = _lUUVIeLOFNV7;
        lUUVIxLFMG7 = _lUUVIxLFMG7;
        lUUVIkIRXV6 = _lUUVIkIRXV6;
        lUUVIeLOFNV6 = _lUUVIeLOFNV6;
        lUUVIxLFMG6 = _lUUVIxLFMG6;
        lUUVIkIRXV5 = _lUUVIkIRXV5;
        lUUVIeLOFNV5 = _lUUVIeLOFNV5;
        lUUVIxLFMG5 = _lUUVIxLFMG5;
        lUUVIkIRXV4 = _lUUVIkIRXV4;
        lUUVIeLOFNV4 = _lUUVIeLOFNV4;
        lUUVIxLFMG4 = _lUUVIxLFMG4;
        lUUVIkIRXV3 = _lUUVIkIRXV3;
        lUUVIeLOFNV3 = _lUUVIeLOFNV3;
        lUUVIxLFMG3 = _lUUVIxLFMG3;
        lUUVIkIRXV2 = _lUUVIkIRXV2;
        lUUVIeLOFNV2 = _lUUVIeLOFNV2;
        lUUVIxLFMG2 = _lUUVIxLFMG2;
        lUUVIkIRXV1 = _lUUVIkIRXV1;
        lUUVIeLOFNV1 = _lUUVIeLOFNV1;
        lUUVIxLFMG1 = _lUUVIxLFMG1;
        lUUVIkIRXV0 = _lUUVIkIRXV0;
        lUUVIeLOFNV0 = _lUUVIeLOFNV0;
        lUUVIxLFMG0 = _lUUVIxLFMG0;
        lUUVIkIRXVz = _lUUVIkIRXVz;
        lUUVIeLOFNVz = _lUUVIeLOFNVz;
        lUUVIxLFMGz = _lUUVIxLFMGz;
    }

    XSZI oLXZOgRNV[67];

    XSZI gIZWRMTwZB[0];

    XSZI gRNVhGZNK[0];

    XSZI vCXSZMTVrw[0];

    XSZI rMHGIFNVMGrw[68];

    WLFYOV kIVxOLHVkIRXV;

    WLFYOV lKVMkIRXV;

    WLFYOV xOLHVkIRXV;

    WLFYOV rlke;

    WLFYOV bRVOWgLnZGFIRGB;

    WLFYOV sRTSkIRXV;

    WLFYOV oLDkIRXV;

    WLFYOV oZHGkIRXV;

    RMG	gIZWVxLFMG;

    WLFYOV	gLGZOgIZWVeLOFNV;

    WLFYOV	gLGZOgIZWVeZOFV;

    WLFYOV	gLGZOyRWeLOFNV;

    WLFYOV	dVRTSGVWzETyRWkIRXV;

    WLFYOV	zOGdVRTSGVWzETyRWkIRXV;

    WLFYOV	gLGZOlUUVIeLOFNV;

    WLFYOV	dVRTSGVWzETlUUVIkIRXV;

    WLFYOV	zOGdVRTSGVWzETlUUVIkIRXV;

    RMG	yRWkIRXVoVEVO;

    RMG	lUUVIkIRXVoVEVO;

    WLFYOV	yRWkIRXV8;

    RMG	yRWeLOFNV8;

    RMG	yRWxLFMG8;

    WLFYOV	yRWkIRXV7;

    RMG	yRWeLOFNV7;

    RMG	yRWxLFMG7;

    WLFYOV	yRWkIRXV6;

    RMG	yRWeLOFNV6;

    RMG	yRWxLFMG6;

    WLFYOV	yRWkIRXV5;

    RMG	yRWeLOFNV5;

    RMG	yRWxLFMG5;

    WLFYOV	yRWkIRXV4;

    RMG	yRWeLOFNV4;

    RMG	yRWxLFMG4;

    WLFYOV	yRWkIRXV3;

    RMG	yRWeLOFNV3;

    RMG	yRWxLFMG3;

    WLFYOV	yRWkIRXV2;

    RMG	yRWeLOFNV2;

    RMG	yRWxLFMG2;

    WLFYOV	yRWkIRXV1;

    RMG	yRWeLOFNV1;

    RMG	yRWxLFMG1;

    WLFYOV	yRWkIRXV0;

    RMG	yRWeLOFNV0;

    RMG	yRWxLFMG0;

    WLFYOV	yRWkIRXVz;

    RMG	yRWeLOFNVz;

    RMG	yRWxLFMGz;

    WLFYOV	lUUVIkIRXV8;

    RMG	lUUVIeLOFNV8;

    RMG	lUUVIxLFMG8;

    WLFYOV	lUUVIkIRXV7;

    RMG	lUUVIeLOFNV7;

    RMG	lUUVIxLFMG7;

    WLFYOV	lUUVIkIRXV6;

    RMG	lUUVIeLOFNV6;

    RMG	lUUVIxLFMG6;

    WLFYOV	lUUVIkIRXV5;

    RMG	lUUVIeLOFNV5;

    RMG	lUUVIxLFMG5;

    WLFYOV	lUUVIkIRXV4;

    RMG	lUUVIeLOFNV4;

    RMG	lUUVIxLFMG4;

    WLFYOV	lUUVIkIRXV3;

    RMG	lUUVIeLOFNV3;

    RMG	lUUVIxLFMG3;

    WLFYOV	lUUVIkIRXV2;

    RMG	lUUVIeLOFNV2;

    RMG	lUUVIxLFMG2;

    WLFYOV	lUUVIkIRXV1;

    RMG	lUUVIeLOFNV1;

    RMG	lUUVIxLFMG1;

    WLFYOV	lUUVIkIRXV0;

    RMG	lUUVIeLOFNV0;

    RMG	lUUVIxLFMG0;

    WLFYOV	lUUVIkIRXVz;

    RMG	lUUVIeLOFNVz;

    RMG	lUUVIxLFMGz;


    YLLO LKVIZGLI==(XLMHG  vJFRGBnZIPVGwZGZuRVOW &ISH)
    {
        IVGFIM HGIXNK(oLXZOgRNV, ISH.oLXZOgRNV) == 9 &&
            HGIXNK(gIZWRMTwZB, ISH.gIZWRMTwZB) == 9 &&
            HGIXNK(gRNVhGZNK, ISH.gRNVhGZNK) == 9 &&
            HGIXNK(vCXSZMTVrw, ISH.vCXSZMTVrw) == 9  &&
            HGIXNK(rMHGIFNVMGrw, ISH.rMHGIFNVMGrw) == 9 &&
            kIVxOLHVkIRXV == ISH.kIVxOLHVkIRXV &&
            lKVMkIRXV == ISH.lKVMkIRXV &&
            xOLHVkIRXV == ISH.xOLHVkIRXV &&
            rlke == ISH.rlke &&
            bRVOWgLnZGFIRGB == ISH.bRVOWgLnZGFIRGB &&
            sRTSkIRXV == ISH.sRTSkIRXV &&
            oLDkIRXV == ISH.oLDkIRXV &&
            oZHGkIRXV == ISH.oZHGkIRXV &&
            gIZWVxLFMG == ISH.gIZWVxLFMG &&
            gLGZOgIZWVeLOFNV == ISH.gLGZOgIZWVeLOFNV &&
            gLGZOgIZWVeZOFV == ISH.gLGZOgIZWVeZOFV &&
            gLGZOyRWeLOFNV == ISH.gLGZOyRWeLOFNV &&
            dVRTSGVWzETyRWkIRXV == ISH.dVRTSGVWzETyRWkIRXV &&
            zOGdVRTSGVWzETyRWkIRXV == ISH.zOGdVRTSGVWzETyRWkIRXV&&
            gLGZOlUUVIeLOFNV == ISH.gLGZOlUUVIeLOFNV&&
            dVRTSGVWzETlUUVIkIRXV ==  ISH.dVRTSGVWzETyRWkIRXV&&
            zOGdVRTSGVWzETlUUVIkIRXV == ISH.zOGdVRTSGVWzETlUUVIkIRXV&&
            yRWkIRXVoVEVO == ISH.yRWkIRXVoVEVO&&
            lUUVIkIRXVoVEVO == ISH.lUUVIkIRXVoVEVO&&
            yRWkIRXV8 == ISH.yRWkIRXV8&&
            yRWeLOFNV8 == ISH.yRWeLOFNV8&&
            yRWxLFMG8 == ISH.yRWxLFMG8&&
            yRWkIRXV7 == ISH.yRWkIRXV7&&
            yRWeLOFNV7 == ISH.yRWeLOFNV7&&
            yRWxLFMG7 == ISH.yRWxLFMG7&&
            yRWkIRXV6 == ISH.yRWkIRXV6&&
            yRWeLOFNV6 == ISH.yRWeLOFNV6&&
            yRWxLFMG6 == ISH.yRWxLFMG6&&
            yRWkIRXV5 == ISH.yRWkIRXV5&&
            yRWeLOFNV5 == ISH.yRWeLOFNV5&&
            yRWxLFMG5 == ISH.yRWxLFMG5&&
            yRWkIRXV4 == ISH.yRWkIRXV4&&
            yRWeLOFNV4 == ISH.yRWeLOFNV4&&
            yRWxLFMG4 == ISH.yRWxLFMG4&&
            yRWkIRXV3 == ISH.yRWkIRXV3&&
            yRWeLOFNV3 == ISH.yRWeLOFNV3&&
            yRWxLFMG3 == ISH.yRWxLFMG3&&
            yRWkIRXV2 == ISH.yRWkIRXV2&&
            yRWeLOFNV2 == ISH.yRWeLOFNV2&&
            yRWxLFMG2 == ISH.yRWxLFMG2&&
            yRWkIRXV1 == ISH.yRWkIRXV1&&
            yRWeLOFNV1 == ISH.yRWeLOFNV1&&
            yRWxLFMG1 == ISH.yRWxLFMG1&&
            yRWkIRXV0 == ISH.yRWkIRXV0&&
            yRWeLOFNV0 == ISH.yRWeLOFNV0&&
            yRWxLFMG0 == ISH.yRWxLFMG0&&
            yRWkIRXVz == ISH.yRWkIRXVz&&
            yRWeLOFNVz == ISH.yRWeLOFNVz&&
            yRWxLFMGz == ISH.yRWxLFMGz&&

            lUUVIkIRXV8 == ISH.lUUVIkIRXV8&&
            lUUVIeLOFNV8 == ISH.lUUVIeLOFNV8&&
            lUUVIxLFMG8 == ISH.lUUVIxLFMG8&&
            lUUVIkIRXV7 == ISH.lUUVIkIRXV7&&
            lUUVIeLOFNV7 == ISH.lUUVIeLOFNV7&&
            lUUVIxLFMG7 == ISH.lUUVIxLFMG7&&
            lUUVIkIRXV6 == ISH.lUUVIkIRXV6&&
            lUUVIeLOFNV6 == ISH.lUUVIeLOFNV6&&
            lUUVIxLFMG6 == ISH.lUUVIxLFMG6&&
            lUUVIkIRXV5 == ISH.lUUVIkIRXV5&&
            lUUVIeLOFNV5 == ISH.lUUVIeLOFNV5&&
            lUUVIxLFMG5 == ISH.lUUVIxLFMG5&&
            lUUVIkIRXV4 == ISH.lUUVIkIRXV4&&
            lUUVIeLOFNV4 == ISH.lUUVIeLOFNV4&&
            lUUVIxLFMG4 == ISH.lUUVIxLFMG4&&
            lUUVIkIRXV3 == ISH.lUUVIkIRXV3&&
            lUUVIeLOFNV3 == ISH.lUUVIeLOFNV3&&
            lUUVIxLFMG3 == ISH.lUUVIxLFMG3&&
            lUUVIkIRXV2 == ISH.lUUVIkIRXV2&&
            lUUVIeLOFNV2 == ISH.lUUVIeLOFNV2&&
            lUUVIxLFMG2 == ISH.lUUVIxLFMG2&&
            lUUVIkIRXV1 == ISH.lUUVIkIRXV1&&
            lUUVIeLOFNV1 == ISH.lUUVIeLOFNV1&&
            lUUVIxLFMG1 == ISH.lUUVIxLFMG1&&
            lUUVIkIRXV0 == ISH.lUUVIkIRXV0&&
            lUUVIeLOFNV0 == ISH.lUUVIeLOFNV0&&
            lUUVIxLFMG0 == ISH.lUUVIxLFMG0&&
            lUUVIkIRXVz == ISH.lUUVIkIRXVz&&
            lUUVIeLOFNVz == ISH.lUUVIeLOFNVz&&
            lUUVIxLFMGz == ISH.lUUVIxLFMGz;
    }

};

HGIFXG hSNnZIPVGwZGZ
{
    hSNnZIPVGwZGZ():UOZT(9),FKWZGVGRNV(9),NW8(9),NW7(9){};
    ~hSNnZIPVGwZGZ(){UOZT=9;FKWZGVGRNV=9;NW8=9;NW7=9;};
    FMHRTMVW RMG* UOZT;  //RU 9 FHV NW8, 8 FHV NW7
    FMHRTMVW RMG* FKWZGVGRNV;
    vJFRGBnZIPVGwZGZuRVOW* NW8;
    vJFRGBnZIPVGwZGZuRVOW* NW7;
};

#VMWRU
//##**---------------- ./FYRJYZHV/RMXOFWV/iVTRLM.S
#RUMWVU fyrjfzmg_ivtrlm_gbkv
#WVURMV fyrjfzmg_ivtrlm_gbkv

MZNVHKZXV FYRJYZHV{

HGIFXG fYRJiVTRLM{
    XSZI HBNYLO[1];
    XSZI MZGRLM_HBNYLO[1];
    RMG FGX_LUUHVG;
    XSZI XLMGRMVMG[83];
    XSZI MZGRLM[83];
    XSZI XRGB[83];
    XSZI GRNVALMV[67];
    YLLO WHG;
};

}

#VMWRU
//##**---------------- ./FYRJYZHV/RMXOFWV/VMXLWV.S
// xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
// zOO IRTSGH IVHVIEVW.
//
//  @UROV   VMXLWV.S
//  @ZFGSLI DZMTBZMT , BDZMT@FYRJFZMG.XLN
//  @WZGV   92/77/7983
//  @YIRVU  HZNKOV LU VMXLWV ZMW WVXLWV
//  @FHZTV
//==============================================================

#RUMWVU fyrj_vmxlwv_ss
#WVURMV fyrj_vmxlwv_ss

#RMXOFWV <HGIRMT>
HGW::HGIRMT VMXLWV(XLMHG HGW::HGIRMT& HIX);
HGW::HGIRMT WVXLWV(XLMHG HGW::HGIRMT& HIX);

#VMWRU
//##**---------------- ./FYRJYZHV/RMXOFWV/uFGFIVHnwuLIVRTMhGIFXG.S
// xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
// zOO IRTSGH IVHVIEVW.
//
//  @UROV   uFGFIVHnwuLIVRTMhGIFXG.S
//  @ZFGSLI DZMTBZMT , BDZMT@FYRJFZMG.XLN
//  @WZGV   87/87/7983
//  @YIRVU
//  @FHZTV
//==============================================================
#RUMWVU ufgfivhnw_ulivrtm_ss
#WVURMV ufgfivhnw_ulivrtm_ss

HGIFXG uFGFIVHnwuLIVRTM{

    XSZI oLXZOgRNV[67];

	XSZI vCXSZMTVrw[1];

	XSZI rMHGIFNVMGrw[83];

	WLFYOV yFBkIRXV8;

	RMG yFBeLOFNV8;

	WLFYOV zHPkIRXV8;

	RMG zHPeLOFNV8;

	WLFYOV xFIIkIRXV;

	RMG xFIIeLOFNV;

	WLFYOV sRTSVHGkIRXV;

	WLFYOV oLDVHGkIRXV;

	WLFYOV lKVMkIRXV;

	WLFYOV kIVhVGGOVNVMGkIRXV;

	WLFYOV hVGGOVNVMGkIRXV;

	XSZI gRNVhGZNK[67];

	RMG uROOVWeLOFNV;

	RMG sLOWeLOFNV;

	WLFYOV yFBkIRXV7;

	WLFYOV yFBkIRXV6;

	WLFYOV yFBkIRXV5;

	WLFYOV yFBkIRXV4;

	RMG yFBeLOFNV7;

	RMG yFBeLOFNV6;

	RMG yFBeLOFNV5;

	RMG yFBeLOFNV4;

	WLFYOV zHPkIRXV7;

	WLFYOV zHPkIRXV6;

	WLFYOV zHPkIRXV5;

	WLFYOV zHPkIRXV4;

	RMG zHPeLOFNV7;

	RMG zHPeLOFNV6;

	RMG zHPeLOFNV5;

	RMG zHPeLOFNV4;

	WLFYOV sRWVyFBkIRXV;

	RMG sRWVyFBeLOFNV;

	WLFYOV sRWVzHPkIRXV;

	RMG sRWVzHPeLOFNV;

    RMG gLGZOgIZWVeLOFNV;

    RMG gLGZOyRWeLOFNV;

    RMG gLGZOlUUVIeLOFNV;
};


HGIFXG uFGFIVHnwgIZWVuLIVRTM{

    XSZI oLXZOgRNV[67];

	XSZI vCXSZMTVrw[1];

	XSZI rMHGIFNVMGrw[83];

	WLFYOV xFIIkIRXV;

	RMG xFIIeLOFNV;

	XSZI gRNVhGZNK[67];

	RMG uROOVWeLOFNV;

    RMG gLGZOgIZWVeLOFNV;

    RMG gLGZOyRWeLOFNV;

    RMG gLGZOlUUVIeLOFNV;

};

#VMWRU
//##**---------------- ./FYRJYZHV/RMXOFWV/vCXSZMTV.S
#RUMWVU fyrjfzmg_vcxszmtv_gbkv
#WVURMV fyrjfzmg_vcxszmtv_gbkv

#WVURMV vcxs_xuuvc 9
#WVURMV vcxs_hsuv 8
#WVURMV vcxs_xaxv 7
#WVURMV vcxs_wxv 6
#WVURMV vcxs_rmv 5

#WVURMV vcxs_hav 89
#WVURMV vcxs_hhv 88

#WVURMV vcxs_spt 87
#WVURMV vcxs_plh 86
#WVURMV vcxs_plm 85
#WVURMV vcxs_yln 84
#WVURMV vcxs_yzm 83
#WVURMV vcxs_xzo 82
#WVURMV vcxs_nwh 81
#WVURMV vcxs_mhv 80
#WVURMV vcxs_wvh 79
#WVURMV vcxs_yyu 78
#WVURMV vcxs_msu 77
#WVURMV vcxs_cny 76
#WVURMV vcxs_xcz 75
#WVURMV vcxs_zck 74
#WVURMV vcxs_mvx 73
#WVURMV vcxs_zhc 72
#WVURMV vcxs_zfp 71
#WVURMV vcxs_ypu 70
#WVURMV vcxs_ypp 69
#WVURMV vcxs_xlo 68
#WVURMV vcxs_xst 67
#WVURMV vcxs_wsz 66
#WVURMV vcxs_csw 65
#WVURMV vcxs_rho 64
#WVURMV vcxs_rwc 63
#WVURMV vcxs_pzi 62
#WVURMV vcxs_poh 61
#WVURMV vcxs_cpn 60
#WVURMV vcxs_cph 59
#WVURMV vcxs_ozs 58
#WVURMV vcxs_nzp 57
#WVURMV vcxs_ksh 56
#WVURMV vcxs_cma 55
#WVURMV vcxs_chh 54
#WVURMV vcxs_mav 53
#WVURMV vcxs_cxp 52
#WVURMV vcxs_csx 51
#WVURMV vcxs_cpr 50
#WVURMV vcxs_pza 49
#WVURMV vcxs_smc 48
#WVURMV vcxs_shg 47
#WVURMV vcxs_qpg 46
#WVURMV vcxs_ozl 45
#WVURMV vcxs_nmv 44
#WVURMV vcxs_hhx 43
#WVURMV vcxs_shx 42
#WVURMV vcxs_stn 41
#WVURMV vcxs_gzr 40
#WVURMV vcxs_cgl 39
#WVURMV vcxs_hvh 38
#WVURMV vcxs_cxl 37
#WVURMV vcxs_pic 36

#RMXOFWV "iVTRLM.S"
MZNVHKZXV FYRJYZHV{

    HGIFXG fYRJvCXSZMTV{
        HGIFXG fYRJiVTRLM* K_IVTRLM;
        XSZI MZNV[35];
        XSZI IVTRLM[1];
        XSZI HBNYLO[1];
        HSLIG HVGGOVNVMG;
        YLLO RH_LKVM;
        YLLO RH_GIZWRMT_WZB;
        XSZI WZB_HGZIG[67];
        XSZI HVHHRLM[871];
    };

}

#VMWRU
//##**---------------- ./FYRJYZHV/YRM/SZOL.HS
#!/YRM/YZHS
HVG -V
wzgv=$8
NPWRI -K /LKG/EVIHRLM/${wzgv}
IN -IU /LKG/EVIHRLM/${wzgv}/*
XK -i /LKG/EVIHRLM/YFROW/* /LKG/EVIHRLM/${wzgv}/
NPWRI -K /LKG/EVIHRLM/${wzgv}/YRM
NPWRI -K /LKG/EVIHRLM/${wzgv}/VGX
NPWRI -K /LKG/EVIHRLM/${wzgv}/RMXOFWV
NPWRI -K /LKG/EVIHRLM/${wzgv}/ORY
NPWRI -K /LKG/EVIHRLM/${wzgv}/FHRN
NPWRI -K /LKG/EVIHRLM/${wzgv}/FGIZWV

HVW -R '$ W' /RMX/EVIHRLM.RMX
VXSL xlnkrov_evihrlm=${wzgv} >> /RMX/EVIHRLM.RMX

IN -IU /LKG/VGX
OM -H /LKG/EVIHRLM/${wzgv}/VGX /LKG/VGX
IN -IU /LKG/YRM
OM -H /LKG/EVIHRLM/${wzgv}/YRM /LKG/YRM
//##**---------------- ./FYRJYZHV/YRM/IVKLIG_SVZW.HS
#!/YRM/YZHS

svzw=$(./EVIHRLM.HS -T| XFG -W'=' -U7)

RU [ "$#" -MV 8  ]; GSVM
    evihrlm=$7
VOHV
    evihrlm="YFROW"
UR

trghlfixv=$(TRG IVNLGV -E | SVZW -8 | XFG  -U7 | XFG -W' ' -U8)
TIVK -J "^$8=" /LKG/EVIHRLM/$evihrlm/EVIHRLM.SVZW
RU [ "$?" == "9" ]; GSVM
    HVW -R "H~^$8=.*~$8=$svzw $trghlfixv~" /LKG/EVIHRLM/$evihrlm/EVIHRLM.SVZW
VOHV
    VXSL "$8=$svzw $trghlfixv" >> /LKG/EVIHRLM/$evihrlm/EVIHRLM.SVZW
UR
//##**---------------- ./FYRJYZHV/YRM/VKLXS.HS
HVG -V
IN -IU /LKG/EVIHRLM/YFROW
NPWRI -K /LKG/EVIHRLM/YFROW
evihrlm=`WZGV +%b%N%W`
xfiivmg=$8
RU [ -U '/RMX/EVIHRLM.RMX' ]; GSVM
	. /RMX/EVIHRLM.RMX
UR
VXSL evihrlm=$evihrlm > /RMX/EVIHRLM.RMX
VXSL xlnkrov_evihrlm=$xfiivmg >> /RMX/EVIHRLM.RMX

//##**---------------- ./FYRJYZHV/YRM/ZFGL-HHS.HS
#!/YRM/HS

RU [ "$8"C = ""C ]; GSVM
    VXSL "FHZTV:/LKG/YRM/ZFGL-HHS.HS FHVI HVIEVI"
VOHV
    FHVI=$8
    HVIEVI=$7
    KFYPVB=`XZG ~/.HHS/RW_IHZ.KFY`
    RU [ "$KFYPVB"C = ""C ]; GSVM
       HHS-PVBTVM
       KFYPVB=`XZG ~/.HHS/RW_IHZ.KFY`
    UR
    XNW="NPWRI -K ~/.HHS && XSNLW 299 ~/.HHS && [ ! -V \'~/.HHS/ZFGSLIRAVW_PVBH\' ] && GLFXS ~/.HHS/ZFGSLIRAVW_PVBH&&VXSL \"$KFYPVB\" >> ~/.HHS/ZFGSLIRAVW_PVBH && XSNLW 399 ~/.HHS/ZFGSLIRAVW_PVBH"
    HHS $FHVI@$HVIEVI \`$XNW\`
UR
//##**---------------- ./FYRJYZHV/YRM/URMZORAV.HS
#!/YRM/YZHS
HVG -V
. /RMX/EVIHRLM.RMX
wzgv=${xlnkrov_evihrlm}
VXSL evihrlm=${wzgv} > /RMX/EVIHRLM.RMX
VXSL xlnkrov_evihrlm=${wzgv} >> /RMX/EVIHRLM.RMX
. /RMX/EVIHRLM.RMX
VXSL "[xlnkovgv]" >> /LKG/EVIHRLM/$evihrlm/EVIHRLM.SVZW
//##**---------------- ./ZKLOOL/nZPVUROV
# xLKBIRTSG 7984 fYRJFZMG rMEVHGNVMG xL.
# zOO IRTSGH IVHVIEVW.

-RMXOFWV /RMX/EVIHRLM.RMX
-RMXOFWV /RMX/FYRJGLLO.RMX
-RMXOFWV /RMX/VEZ.RMX

-RMXOFWV .KZIZ.RMX


#************************* rmhgzoo *********************
.kslmb: FGRO WLX XOVZM WRHGXOVZM RMHGZOO GZTH

#************************* xovzm ************************
XOVZM::
	@IN -IU TNLM.LFG
	@IN -IU ${KILTIZN}

WRHGXOVZM: XOVZM
	@IN -IU TNLM.LFG
	@IN -IU XLIV.*
	@IN -IU *~
	@IN -IU xnZPVxZXSV.GCG xnZPVuROVH XNZPV_RMHGZOO.XNZPV
IVYFROW:: XOVZM ZOO
//##**---------------- ./ZKLOOL/EZFOG/wZGVzMWgRNV.KB
# XLWRMT: FGU-1
UILN XORVMGYZHV.YZHV_WZGZ RNKLIG wZGZ
RNKLIG HBH
#UILN NLMRGLI.GLNXZG RNKLIG wRHXLEVIB
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
#RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
#RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
#RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
RNKLIG GRNV
RNKLIG KZMWZH ZH KW

WVU tVGgIZWRMTwZGVH(HGZIGwZGV, VMWwZGV, NZIPVG='hhv'):
    # 提取交易日数据
    NZIPVG = NZIPVG
    RU NZIPVG == 'ZOO':  # 所有自然日
        WZGVHGZIG=WG.WZGVGRNV.HGIKGRNV(HGZIGwZGV,'%b-%N-%W')
        WZGVVMW=WG.WZGVGRNV.HGIKGRNV(VMWwZGV,'%b-%N-%W')
        WZGVH = ORHG()
        DSROV WZGVHGZIG<=WZGVVMW:
            WZGVH.ZKKVMW(WZGVHGZIG.HGIUGRNV('%b-%N-%W'))
            WZGVHGZIG+=WG.GRNVWVOGZ(WZBH=8)
        WZGVH = HLIGVW(WZGVH)
        IVGFIM WZGVH

    HGZIGwZGV = HGZIGwZGV[9:5]+HGZIGwZGV[4:2]+HGZIGwZGV[1:89];
    VMWwZGV = VMWwZGV[9:5]+VMWwZGV[4:2]+VMWwZGV[1:89];
    RU NZIPVG == 'hhv':
        UROVmZNV = "/WZG/ZOO/vJFRGB/ORHG/GIZWVWZBH.GCG";
    VORU NZIPVG == 'sp':
        UROVmZNV = "/WZG/ZOO/vJFRGB/ORHG/CQK_GIZWVWZBH.GCG";
    WZGVH = KW.IVZW_GZYOV(UROVmZNV, SVZWVI=mLMV);
    WZGVH = WZGVH[(WZGVH[9]>=RMG(HGZIGwZGV)) & (WZGVH[9]<=RMG(VMWwZGV))];
    WZGVH = ORHG(WZGVH[9]);
    ULI RwZB, WZGV RM VMFNVIZGV(WZGVH):
        WZGV = HGI(WZGV)
        WZGV = WZGV[9:5]+"-"+WZGV[5:3]+"-"+WZGV[3:1];
        WZGVH[RwZB] = WZGV
    IVGFIM WZGVH

WVU gIZWRMTwZGVnLEV(WZGV, NLEV, NZIPVG='hhv'):
    # 以WZGV为中心 移动交易日
    HGZIGWZGV = (WZGVGRNV.WZGVGRNV.HGIKGRNV(WZGV, '%b-%N-%W')+WZGVGRNV.GRNVWVOGZ(-634)).HGIUGRNV('%b-%N-%W')
    WZGVH = tVGgIZWRMTwZGVH(HGZIGWZGV, '7979-98-98', NZIPVG)
    RU WZGV RM WZGVH:
        RMW = WZGVH.RMWVC(WZGV)
    VOHV:
        #HVOU.OLTTVI.DZIMRMT("WZGV RH MLG GIZWRMTWZGV")
        RMWH = [R[9] ULI R RM VMFNVIZGV(WZGVH) RU R[8]<=WZGV]
        #RMWH = fGRORGB().dSRXS(KW.hVIRVH(WZGVH)<=WZGV)
        RU NLEV >= 9:
            RMW = RMWH[-8]
        VORU NLEV < 9:
            RMW = RMWH[-8] + 8
    IVGFIM WZGVH[RMW+NLEV]

XOZHH wZGVzMWgRNV(wZGZ):
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HFKVI(wZGVzMWgRNV, HVOU).__RMRG__(CNO, ZKK, TOLYZO_RMUL)
        HVOU.ZKK.IVTRHGVI_WZGZ_UFMXGRLM(tVGgIZWRMTwZGVH)\
                .FHZTV('GSRH RH UFMXGRLM GL TVG GIZWRMT WZGVH, tVGgIZWRMTwZGVH("7981-98-97", "7981-97-97", "hhv")')\
                .IVJFRIV('HGZIGwZGV', HGI, 'HGZIG WZGV')\
                .IVJFRIV('VMWwZGV', HGI, 'VMW WZGV')\
                .LKGRLMZO('NZIPVG', HGI, 'NZIPVG','hhv')

        HVOU.ZKK.IVTRHGVI_WZGZ_UFMXGRLM(gIZWRMTwZGVnLEV)\
                .FHZTV('GSRH RH UFMXGRLM GL TVG GIZWRMT WZGVH NLEV, gIZWRMTwZGVnLEV("7981-98-97", "7981-97-97", "hhv")')\
                .IVJFRIV('WZGV', HGI, 'WZGV')\
                .IVJFRIV('NLEV', HGI, 'NLEV KZXV')\
                .LKGRLMZO('NZIPVG', HGI, 'NZIPVG','hhv')
'''
'''


//##**---------------- ./ZKLOOL/EZFOG/hGIZGVTByZHV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
#-*- XLWRMT: FGU-1 -*-
#xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
#zOO IRTSGH IVHVIEVW.
RNKLIG KZGSORY
XKZGS = HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
RNKLIG HBH
HBH.KZGS.ZKKVMW(XKZGS)
UILN XORVMGYZHV.YZHV_WZGZ RNKLIG wZGZ
UILN XORVMGYZHV.KZXPZTVH RNKLIG *

WVU tVGhGIZgZTwZROB(HRW, HGZIGwZGV, VMWwZGV):
    HJO = "HVOVXG * UILN hGIZGVTBgZTwZROB DSVIV HGIZGVTBRW='"+HRW+"' ZMW GIZWRMTWZGV>='"+HGZIGwZGV+"' ZMW GIZWRMTWZGV<='"+VMWwZGV+"'"
    LFGKFG = KW.IVZW_HJO(HJO, XLMM_HGIZ)
    WZGVH = [C.HGIUGRNV('%b-%N-%W') ULI C RM LFGKFG.gIZWRMTwZGV]
    LFGKFG.RMWVC = WZGVH
    IVGFIM LFGKFG

XOZHH hGIZGVTByZHV(wZGZ):
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HFKVI(hGIZGVTByZHV, HVOU).__RMRG__(CNO, ZKK, TOLYZO_RMUL)
        HVOU.ZKK.IVTRHGVI_WZGZ_UFMXGRLM(tVGhGIZgZTwZROB)\
                .FHZTV('GSRH RH UFMXGRLM GL TVG XILHH WZG LU HGIZGVTB LM WZGV, tVGhGIZgZTwZROB("QPHC82","7981-98-97", "7981-97-97")')\
                .IVJFRIV('HRW', HGI, 'HGIZGVTBRW')\
                .IVJFRIV('HGZIGwZGV', HGI, 'HGZIG WZGV')\
                .IVJFRIV('VMWwZGV', HGI, 'VMW WZGV')\
                .XZXSV_OZHG_GRNV(6)\
                .VCKRIV(4)


//##**---------------- ./ZKLOOL/EZFOG/hGIZGVTBgZYOV.KB
RNKLIG KZGSORY
XKZGS = HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
RNKLIG HBH
HBH.KZGS.ZKKVMW(XKZGS)
HBH.KZGS.ZKKVMW(XKZGS+'/EZFOG')
UILN XORVMGYZHV.YZHV_WZGZ RNKLIG wZGZ
UILN XORVMGYZHV.KZXPZTVH RNKLIG *
RNKLIG OVLMRHgZYOVH
UILN wZGVzMWgRNV RNKLIG tVGgIZWRMTwZGVH

WVU gIZMHwZG7wu(WZG):
    M = OVM(WZG)
    XLOH = WRI(WZG[9])
    XLOH = [C ULI C RM XLOH RU '__' MLG RM C ZMW '_' MLG RM C]
    RU 'NVGZWZGZ' RM XLOH:
        XLOH.IVNLEV('NVGZWZGZ')
    LFGKFG = WRXG()
    ULI XLO RM XLOH:
        LFGKFG[XLO] = [mLMV] * M

    ULI RMHGZMXV RM VMFNVIZGV(WZG):
        ULI XLO RM XLOH:
            LFGKFG[XLO][RMHGZMXV[9]] = TVGZGGI(RMHGZMXV[8],XLO)
    LFGKFG = KW.wZGZuIZNV(LFGKFG)
    IVGFIM LFGKFG

WVU tVGxILHHuILNsRHG(HGZIGwZGV, VMWwZGV, OLTTVI, HVHHRLM_KLLO):
    GZYOV = FZXGZYOVH.hGIZGVTBsRHG
    WZGVH = tVGgIZWRMTwZGVH(HGZIGwZGV, VMWwZGV, 'hhv')
    LFGKFGwZB = WRXG()
    ULI WZGV RM WZGVH:
        #HJO = "HVOVXG * UILN hGIZGVTBsRHG DSVIV FKWZGVWZGV<='"+WZGV+"' LIWVI YB fKWZGVwZGV, RW"
        #OLTTVI.WVYFT(HJO)
        #WZG = KW.IVZW_HJO(HJO, XLMM)
        XFIHLI = HVHHRLM_KLLO['FZX_WZGZYZHV']()
        WZG = XFIHLI.JFVIB(GZYOV).UROGVI(GZYOV.fKWZGVwZGV<=WZGV).LIWVI_YB(GZYOV.fKWZGVwZGV).LIWVI_YB(GZYOV.rw).ZOO()
        XFIHLI.XOLHV()
        WZG = gIZMHwZG7wu(WZG)
        WZG.RMWVC = WZG.hGIZGVTBrw
        HGIZH = WZG.hGIZGVTBrw.FMRJFV().GLORHG()
        LFGKFG = KW.wZGZuIZNV()
        ULI HGIZ RM HGIZH:
            WZGgNK = WZG.OLX[[HGIZ]]
            LFGKFG = KW.XLMXZG([LFGKFG, WZGgNK.ROLX[[-8]]])
        RU LFGKFG.VNKGB:
            LFGKFG = mLMV
        WZGVH = [C.HGIUGRNV('%b-%N-%W') ULI C RM LFGKFG['fKWZGVwZGV']]
        LFGKFG.fKWZGVwZGV = WZGVH
        GNK = [C.HGIUGRNV('%b-%N-%W %s:%n:%h') ULI C RM LFGKFG['fKWZGVgRNV']]
        LFGKFG.fKWZGVgRNV = GNK
        LFGKFGwZB[WZGV] = LFGKFG
    IVGFIM LFGKFGwZB

WVU iVZWhGIZGVTBzXXLFMG(HVHHRLM_KLLO):
    XFIHLI = HVHHRLM_KLLO['FZX_WZGZYZHV']()
    WZG = XFIHLI.JFVIB(FZXGZYOVH.hGIZGVTBzXXLFMG).ZOO()
    M = OVM(WZG)
    HGIZGVTBRW = [mLMV] * M
    ZXXLFMGRW = [mLMV] * M
    ULI RMHGZMXV RM VMFNVIZGV(WZG):
        HGIZGVTBRW[RMHGZMXV[9]] = RMHGZMXV[8].HGIZGVTBRW
        ZXXLFMGRW[RMHGZMXV[9]] = RMHGZMXV[8].ZXXLFMGRW
    LFGKFG = KW.wZGZuIZNV()
    LFGKFG['hGIZGVTBrw'] = HGIZGVTBRW
    LFGKFG['zXXLFMGrw'] = ZXXLFMGRW
    LFGKFG.RMWVC = LFGKFG.hGIZGVTBrw
    XFIHLI.XOLHV()
    IVGFIM LFGKFG

WVU iVZWzXXLFMGwZG(HVHHRLM_KLLO):
    XFIHLI = HVHHRLM_KLLO['FZX_WZGZYZHV']()
    WZG = XFIHLI.JFVIB(FZXGZYOVH.zXXLFMGH).ZOO()
    M = OVM(WZG)
    GBKVH = [mLMV] * M
    ZXXLFMGRW = [mLMV] * M
    ULI RMHGZMXV RM VMFNVIZGV(WZG):
        GBKVH[RMHGZMXV[9]] = RMHGZMXV[8].GBKV8
        ZXXLFMGRW[RMHGZMXV[9]] = RMHGZMXV[8].ZXXLFMGRW
    LFGKFG = KW.wZGZuIZNV()
    LFGKFG['zXXLFMGgBKV'] = GBKVH
    LFGKFG['zXXLFMGrw'] = ZXXLFMGRW
    LFGKFG.RMWVC = LFGKFG.zXXLFMGrw
    XFIHLI.XOLHV()
    IVGFIM LFGKFG

WVU tVGzXXLFMG(WZG, OLTTVI, HVHHRLM_KLLO):
    # ZWW ZXXLFMG
    #HJO = "HVOVXG * UILN hGIZGVTBzXXLFMG"
    #HGIZzXX = KW.IVZW_HJO(HJO, XLMM)
    HGIZzXX = iVZWhGIZGVTBzXXLFMG(HVHHRLM_KLLO)
    #HJO = "HVOVXG zXXLFMGrW, gBKV8 UILN zXXLFMGH"
    #ZXXwZG = KW.IVZW_HJO(HJO, XLMM)
    ZXXwZG = iVZWzXXLFMGwZG(HVHHRLM_KLLO)
    ULI WZGV RM WZG.PVBH():
        WZGgNK = WZG[WZGV]
        ZXXH = [MK.MZM] * WZGgNK.HSZKV[9]
        ZXXgBKVH = [MK.MZM] * WZGgNK.HSZKV[9]
        ULI RiLD RM IZMTV(WZGgNK.HSZKV[9]):
            HGIZ = WZGgNK.hGIZGVTBrw.ROLX[RiLD]
            RU HGIZ MLG RM HGIZzXX.RMWVC:
                OLTTVI.RMUL('XZMG MLG URMW HGIZ %H RM HGIZGVTBzXXLFMG'%HGIZ)
                XLMGRMFV
            ZXXH[RiLD] = HGIZzXX.RC[HGIZ, 'zXXLFMGrw']
            ZXXgBKVH[RiLD] = ZXXwZG.RC[ZXXH[RiLD], 'zXXLFMGgBKV']
        WZGgNK['zXXLFMGrw'] = ZXXH
        WZGgNK['zXXLFMGgBKV'] = ZXXgBKVH
        WZG[WZGV] = WZGgNK
    IVGFIM WZG


WVU tVGgIZWVI(WZG, OLTTVI, HVHHRLM_KLLO):
    #HJO = "HVOVXG * UILN hGIZGVTBgIZWVI LIWVI YB hGZIGwZGV"
    #GIZWVI = KW.IVZW_HJO(HJO, XLMM)
    XFIHLI = HVHHRLM_KLLO['FZX_WZGZYZHV']()
    GIZWVI = XFIHLI.JFVIB(FZXGZYOVH.hGIZGVTBgIZWVI).ZOO()
    GIZWVI = gIZMHwZG7wu(GIZWVI)
    GIZWVI.RMWVC = GIZWVI.hGIZGVTBrw
    ULI WZGV RM WZG.PVBH():
        WZGgNK = WZG[WZGV]
        GIZWVIH = [MK.MZM] * WZGgNK.HSZKV[9]
        GIZWVIgNK = GIZWVI[(GIZWVI.hGZIGwZGV<=WZGV) & (GIZWVI.vMWwZGV>WZGV)]
        ULI RiLD RM IZMTV(WZGgNK.HSZKV[9]):
            HGIZ = WZGgNK.hGIZGVTBrw.ROLX[RiLD]
            RU HGIZ MLG RM GIZWVIgNK.RMWVC:
                OLTTVI.RMUL('%H %H XZMG MLG URMW HGIZ RM HGIZGVTBgIZWVI'%(HGIZ, WZGV))
                XLMGRMFV
            VOHV:
                GIZWVIH[RiLD] = GIZWVIgNK.OLX[[HGIZ]].gIZWVI.ROLX[-8]
        WZGgNK['gIZWVI'] = GIZWVIH
        WZG[WZGV] = WZGgNK
    IVGFIM WZG

WVU tVGzOKSZgBKV(WZG, OLTTVI, HVHHRLM_KLLO):
    #HJO = "HVOVXG * UILN hGIZGVTBzOKSZgBKV"
    #ZOKSZgBKV = KW.IVZW_HJO(HJO, XLMM)
    XFIHLI = HVHHRLM_KLLO['FZX_WZGZYZHV']()
    ZOKSZgBKV = XFIHLI.JFVIB(FZXGZYOVH.hGIZGVTBzOKSZgBKV).ZOO()
    ZOKSZgBKV = gIZMHwZG7wu(ZOKSZgBKV)
    ZOKSZgBKV.RMWVC = ZOKSZgBKV.hGIZGVTBrw
    ULI WZGV RM WZG.PVBH():
        ZOKSZgNK = ZOKSZgBKV[ZOKSZgBKV.hGZIGwZGV <= WZGV]
        WZGgNK = WZG[WZGV]
        KNH = [MK.MZM] * WZGgNK.HSZKV[9]
        ZOKSZH = [MK.MZM] * WZGgNK.HSZKV[9]
        ULI RiLD RM IZMTV(WZGgNK.HSZKV[9]):
            HGIZ = WZGgNK.hGIZGVTBrw.ROLX[RiLD]
            RU HGIZ MLG RM ZOKSZgNK.RMWVC:
                OLTTVI.RMUL('%H %H XZMG MLG URMW HGIZ RM HGIZGVTBzOKSZgBKV'%(HGIZ,WZGV))
                XLMGRMFV
            VOHV:
                KNH[RiLD] = ZOKSZgNK.OLX[[HGIZ]].kn.ROLX[-8]
                ZOKSZH[RiLD] = ZOKSZgNK.OLX[[HGIZ]].zOKSZgBKV.ROLX[-8]
        WZGgNK['kn'] = KNH
        WZGgNK['zOKSZgBKV'] = ZOKSZH
        WZG[WZGV] = WZGgNK
    IVGFIM WZG

WVU tVGxILHHzOO(HGZIGwZGV, VMWwZGV):
    OLTTVI = tVGxILHHzOO.OLTTVI
    WZGZYZHV_KLLO = tVGxILHHzOO.WZGZYZHV_KLLO
    WZG = tVGxILHHuILNsRHG(HGZIGwZGV, VMWwZGV, OLTTVI, WZGZYZHV_KLLO)
    WZG = tVGzXXLFMG(WZG, OLTTVI, WZGZYZHV_KLLO)
    WZG = tVGgIZWVI(WZG, OLTTVI, WZGZYZHV_KLLO)
    WZG = tVGzOKSZgBKV(WZG, OLTTVI, WZGZYZHV_KLLO)
    #ULI P,E RM WZG.RGVNH():
        #E.WILK(['NVGZWZGZ'])
    IVGFIM WZG

XOZHH hGIZGVTBgZYOV(wZGZ):
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HFKVI(hGIZGVTBgZYOV, HVOU).__RMRG__(CNO, ZKK, TOLYZO_RMUL)
        HVOU.ZKK.IVTRHGVI_WZGZ_UFMXGRLM(tVGxILHHzOO)\
                .FHZTV('GSRH RH UFMXGRLM GL TVG XILHH WZG LU HGIZGVTB LM WZGV, tVGxILHHzOO("7981-98-97", "7981-97-97")')\
                .IVJFRIV('HGZIGwZGV', HGI, 'HGZIG WZGV')\
                .IVJFRIV('VMWwZGV', HGI, 'VMW WZGV')\

RU __MZNV__ == '__NZRM__':
    RNKLIG OLTTRMT
    HGZIGwZGV = '7981-93-78'
    VMWwZGV = '7981-93-78'
    OLTTVI = OLTTRMT
    KLLO = WRXG()
    wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/FZX?XSZIHVG=FGU1'
    XLMM = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)
    HVHHRLM = HVHHRLMNZPVI(YRMW=XLMM)
    KLLO['FZX_WZGZYZHV'] = HVHHRLM
    WZG = tVGxILHHzOO(HGZIGwZGV, VMWwZGV, OLTTRMT, KLLO)
    KIRMG(WZG)




//##**---------------- ./ZKLOOL/EZFOG/OVLMRHgZYOVH.KB
#-*- XLWRMT: FGU-1 -*-
UILN XORVMGYZHV.KZXPZTVH RNKLIG *
HJOZOXSVNByZHV = WVXOZIZGREV_YZHV()


XOZHH hGIZGVTBzXXLFMG(HJOZOXSVNByZHV):
    __GZYOVMZNV__ = 'hGIZGVTBzXXLFMG'
    hGIZGVTBrw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69), KIRNZIB_PVB=gIFV)
    zXXLFMGrw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69), KIRNZIB_PVB=gIFV)


XOZHH zXXLFMGH(HJOZOXSVNByZHV):
    __GZYOVMZNV__ = 'zXXLFMGH'
    ZXXLFMGRW = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69), KIRNZIB_PVB=gIFV)
    GBKV8 = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))


XOZHH zXXLFMGuVVkZIZNH(HJOZOXSVNByZHV):
    __GZYOVMZNV__ = 'zXXLFMGuVVkZIZNH'
    zXXLFMGrw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69), KIRNZIB_PVB=gIFV)
    uVVrw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    kZIZNH = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(899), KIRNZIB_PVB=gIFV)
    hGZIGwZGV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.wZGV, KIRNZIB_PVB=gIFV)
    vMWwZGV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.wZGV)


XOZHH hGIZGVTBgIZWVI(HJOZOXSVNByZHV):
    __GZYOVMZNV__ = 'hGIZGVTBgIZWVI'
    hGIZGVTBrw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69), KIRNZIB_PVB=gIFV)
    gIZWVI = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69), KIRNZIB_PVB=gIFV)
    hGZIGwZGV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.wZGV)
    vMWwZGV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.wZGV)
    xZOkMO = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.rMGVTVI)

XOZHH hGIZGVTBzOKSZgBKV(HJOZOXSVNByZHV):
    __GZYOVMZNV__ = 'hGIZGVTBzOKSZgBKV'
    rw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.rMGVTVI, KIRNZIB_PVB=gIFV)
    hGIZGVTBrw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    zOKSZgBKV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    hGZIGwZGV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.wZGV)
    kn = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))


XOZHH hGIZGVTBsRHG(HJOZOXSVNByZHV):
    __GZYOVMZNV__ = 'hGIZGVTBsRHG'
    rw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.rMGVTVI, KIRNZIB_PVB=gIFV)
    hGIZGVTBrw = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    fKWZGVwZGV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.wZGV)
    fKWZGVgRNV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.wZGVgRNV)
    zOKSZxSZMMVO = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    gBKV8 = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    gBKV7 = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    fGIZWVhVIEVI = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    gyhVIEVI = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    rHkILTIZNgIZWRMT = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.rMGVTVI)
    rHgIZWVfMRG = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.rMGVTVI)
    zXGREVgBKV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.rMGVTVI)
    nZIPVG = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    zOKSZhLFIXV = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))
    zOKSZkLHtVMnVGSLW = HJOZOXSVNB.xLOFNM(HJOZOXSVNB.hGIRMT(69))


//##**---------------- ./ZKLOOL/NLWFOVH/ZKLOOL/ZKLOOL.KB
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV # RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
# RNKLIG LH
# RNKLIG KHFGRO
# RNKLIG HFYKILXVHH
# RNKLIG WZGVGRNV
# RNKLIG HRTMZO
UILN GRNV RNKLIG HOVVK
RNKLIG HBH
evihrlm = ''
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/')
UILN XLNNFMRXZGV.XORVMG RNKLIG hGZIUOVVGwLXPVI
# RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
# RNKLIG QHLM
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN XORVMGSVOKVI.FGRO RNKLIG RNKLIG_WZGZ, RNKLIG_ULINFOZ
UILN XORVMGSVOKVI.UFMXKZIHVI RNKLIG uFMXGRLMkZIHVI
UILN XORVMGSVOKVI.WZGZSVOKVI RNKLIG wZGZsVOKVI, OLTTVI, WZGZYZHV_KLLO
UILN XORVMGSVOKVI.ULINFOZSVOKVI RNKLIG uLINFOZsVOKVI
RNKLIG MVGRUZXVH
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG GRNV
RNKLIG KRXPOV
UILN HJOZOXSVNB RNKLIG XIVZGV_VMTRMV
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI
UILN SGGK.HVIEVI RNKLIG yZHVsggkiVJFVHGsZMWOVI
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGhVIEVI,TARKVMXLWV
UILN FYRJGLLO.ZKLOOLYZHV RNKLIG zKLOOLzWZKGLI
RNKLIG QHLM
RNKLIG RMHKVXG
RNKLIG GIZXVYZXP

WZGZ_UFMXGRLM_KLLO = {}
WZGZ_KLLO = {}
ULINFOZ_KLLO = {}


XOZHH kLHGhVIEVIsZMWOVI(yZHVsggkiVJFVHGsZMWOVI):

    WVU HVG_OLTTVI(HVOU, OLTTVI):
        HVOU.OLTTVI = OLTTVI

    WVU _HVG_IVHKLMHV(HVOU, TARK=uZOHV, OVMTGS = 9):
        HVOU.HVMW_IVHKLMHV(799)
        HVOU.HVMW_SVZWVI('xLMGVMG-GBKV', 'GVCG/SGNO')
        RU OVMTGS != 9:
            HVOU.HVMW_SVZWVI('xLMGVMG-OVMTGS', HGI(OVMTGS))
        RU TARK:
            HVOU.HVMW_SVZWVI('xLMGVMG-vMXLWRMT', 'TARK')
        HVOU.VMW_SVZWVIH()

    WVU KIRMG_SVZW(HVOU):
        IVGFIM 'tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M'%(HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))(HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))


    WVU WL_tvg(HVOU): #OLTTRMT.RMUL("tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M", HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))
        HVOU._HVG_IVHKLMHV()
        HVOU.DUROV.DIRGV("tvg IVJFVHG ULI {}".ULINZG(HVOU.KZGS).VMXLWV('FGU-1'))


    WVU WL_klhg(HVOU):
        ZWWIVHH = ''
        TOLYZO WZGZ_KLLO
        TOLYZO WZGZ_UFMXGRLM_KLLO
        TOLYZO ULINFOZ_KLLO
        KIVURC = ''
        RU HVOU.KZGS == '/':
            HVOU._HVG_IVHKLMHV(TARK=uZOHV)
            HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'KZGS NFHG YV /WZGZ LI /ULINFOZ'}).VMXLWV('FGU-1'))
            IVGFIM

        XLMGVMG_OVMTGS = RMG(HVOU.SVZWVIH['xLMGVMG-oVMTGS']) # <--- tVGH GSV HRAV LU WZGZ
        KLHG_WZGZ_IZD = HVOU.IUROV.IVZW(XLMGVMG_OVMTGS) # <--- tVGH GSV WZGZ RGHVOU
        RU HVOU.KZGS.HKORG('/')[8] == 'SVOK':
            HVOU._HVG_IVHKLMHV(TARK=uZOHV)
            WZGZ = QHLM.OLZWH(KLHG_WZGZ_IZD.WVXLWV('FGU-1'))
            RU ('WZGZ' MLG RM WZGZ LI WZGZ['WZGZ'] == '') ZMW ('ULINFOZ' MLG RM WZGZ LI WZGZ['ULINFOZ'] == ''):
                # DROO ORHG ZOO WZGZ ZMW ULINFOZ
                WIVG= ','.QLRM(WZGZ_UFMXGRLM_KLLO.PVBH())
                UIVG =  ','.QLRM(ULINFOZ_KLLO.PVBH())
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':gIFV, 'GBKV':'SVOK_ORHG', 'WZGZORHG':WIVG, 'ULINFOZORHG':UIVG}).VMXLWV('FGU-1'))
                IVGFIM
            RU 'WZGZ' RM WZGZ :
                UFMX = WZGZ['WZGZ']
                RU UFMX MLG RM WZGZ_UFMXGRLM_KLLO:
                    HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'GBKV':'SVOK', 'IVZHLM':'XZMMLG URMW WZGZ %H'%UFMX}).VMXLWV('FGU-1'))
                    IVGFIM
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':gIFV, 'GBKV':'SVOK', 'WZGZ':WZGZ_UFMXGRLM_KLLO[UFMX].KIRMG()}).VMXLWV('FGU-1'))
            VORU 'ULINFOZ' RM WZGZ:
                UFMX = WZGZ['ULINFOZ']
                RU UFMX MLG RM ULINFOZ_KLLO:
                    HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'GBKV':'SVOK', 'IVZHLM':'XZMMLG URMW ULINFOZ %H'%UFMX}).VMXLWV('FGU-1'))
                    IVGFIM
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':gIFV, 'GBKV':'SVOK', 'WZGZ':ULINFOZ_KLLO[UFMX].KIRMG()}).VMXLWV('FGU-1'))
            VOHV:
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'GBKV':'SVOK', 'IVZHLM':'RMKFG WZGZ RH MLG XLNKOVGV'}))
            IVGFIM

        RU HVOU.KZGS.HKORG('/')[8] == 'WZGZ':
            WZGZ = QHLM.OLZWH(KLHG_WZGZ_IZD.WVXLWV('FGU-1'))
            RU 'WZGZ' MLG RM WZGZ:
                HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'NFHG RMKFG WZGZ'}).VMXLWV('FGU-1'))
                IVGFIM
            RU 'ZITH' MLG RM WZGZ:
                HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'NFHG RMKFG ZITH'}).VMXLWV('FGU-1'))
                IVGFIM
            UFMX = WZGZ['WZGZ']
            ZITH = WZGZ['ZITH']
            RU UFMX MLG RM WZGZ_UFMXGRLM_KLLO:
                HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'WZGZ UFMXGRLM %H MLG VCRHGH'%UFMX}).VMXLWV('FGU-1'))
            VOHV:
                GIB:
                    IVG = WZGZ_UFMXGRLM_KLLO[UFMX].VEZO(ZITH)
                    RU IVG RH mLMV:
                        HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                        HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'WZGZ UFMXGRLM %H IVGFIMH MLMV'%(UFMX)}).VMXLWV('FGU-1'))
                    RU MLG IVG[9]:
                        HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                        HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':IVG[8]}).VMXLWV('FGU-1'))
                    VOHV:
                        HVOU._HVG_IVHKLMHV(TARK=gIFV)
                        HVOU.DUROV.DIRGV(TARKVMXLWV(QHLM.WFNKH({'HGZGFH':gIFV, 'GBKV':'WZGZ_IVHFOG', 'IVHFOG':zKLOOLzWZKGLI.DIZK(IVG[8])}).VMXLWV('FGU-1')))
                VCXVKG vCXVKGRLM ZH V:
                    GIZXVYZXP.KIRMG_VCX()
                    HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'WZGZ UFMXGRLM %H VMXLFMGVIH VCXVKGRLM %H'%(UFMX, HGI(V))}).VMXLWV('FGU-1'))
            IVGFIM
        VORU HVOU.KZGS.HKORG('/')[8] == 'ULINFOZ':
            WZGZ = QHLM.OLZWH(KLHG_WZGZ_IZD.WVXLWV('FGU-1'))
            RU 'ZITH' MLG RM WZGZ:
                HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'NFHG RMKFG ZITH'}).VMXLWV('FGU-1'))
                IVGFIM
            UFMX = WZGZ['ULINFOZ']
            DIZK_ZITH = WZGZ['ZITH']
            ZITH = {}
            ULI P, E RM DIZK_ZITH.RGVNH():
                ZITH[P] = zKLOOLzWZKGLI.FMDIZK(E)
            RU UFMX MLG RM ULINFOZ_KLLO:
                HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'ULINFOZ UFMXGRLM %H MLG VCRHGH'%UFMX}).VMXLWV('FGU-1'))
            VOHV:
                GIB:
                    IVG = ULINFOZ_KLLO[UFMX].VEZO(ZITH)
                    RU IVG RH mLMV:
                        HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                        HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'ULINFOZ UFMXGRLM %H IVGFIMH MLMV'%(UFMX)}).VMXLWV('FGU-1'))
                    RU MLG IVG[9]:
                        HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                        HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':IVG[8]}).VMXLWV('FGU-1'))
                    VOHV:
                        HVOU._HVG_IVHKLMHV(TARK=gIFV)
                        HVOU.DUROV.DIRGV(TARKVMXLWV(QHLM.WFNKH({'HGZGFH':gIFV, 'GBKV':'ULINFOZ_IVHFOG', 'IVHFOG':zKLOOLzWZKGLI.DIZK(IVG[8])}).VMXLWV('FGU-1')))
                VCXVKG vCXVKGRLM ZH V:
                    GIZXVYZXP.KIRMG_VCX()
                    HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                    HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'ULINFOZ UFMXGRLM %H VMXLFMGVIH VCXVKGRLM %H'%(UFMX, HGI(V))}).VMXLWV('FGU-1'))
            IVGFIM



XOZHH ZKLOOL_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        KZHH


XOZHH ZKLOOL(nLWFOV):
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.ILLG = ILLG
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        #WZGZ_SVOKVI.HVG_TOLYZORMUL(TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL.ZKLOOL_WZGZ = ZKLOOL_WZGZ(CNO, TOLYZO_RMUL)
        HVOU.ZKLOOL_WZGZ = HVOU.TOLYZO_RMUL.ZKLOOL_WZGZ
        ZWWIVHHVH = [R.HGIRK() ULI R RM HVOU.CNO.ZGGIRY['KLHG_HVIEVI'].HKORG(',')]
        HVOU.ZWWIVHH_ORHG = [R.HKORG(':') ULI R RM ZWWIVHHVH]
        TOLYZO WZGZ_UFMXGRLM_KLLO
        TOLYZO WZGZ_KLLO
        TOLYZO ULINFOZ_KLLO
        HVOU.WZGZYZHV_KLLO = {}
        wZGZsVOKVI.ZWW_OLTTVI(HVOU.OLTTVI)
        wZGZsVOKVI.ZWW_WZGZYZHV_KLLO(HVOU.WZGZYZHV_KLLO)
        HVOU.WZGZ_UFMXGRLM_KLLO = WZGZ_UFMXGRLM_KLLO
        HVOU.WZGZ_KLLO = WZGZ_KLLO
        HVOU.ULINFOZ_KLLO = ULINFOZ_KLLO
        HVOU.OLTTVI.RMUL('[yllg] HGZIG GL OLZW WZGZYZHVH')
        ULI WO RM HVOU.ILLG.URMW('WZGZYZHVH').URMWZOO('WZGZYZHV'):
            WZGZYZHV_KZIZ = WO.ZGGIRY
            KZHHDW = mLMV
            PVB = WZGZYZHV_KZIZ['RW']
            DSROV KZHHDW RH mLMV:
                HVOU.OLTTVI.RMUL('---> JFVIBRMT KZHHDLIW: %H'%PVB)
                KZHHDW = TOLYZO_RMUL.HGZIUOVVG_WLXPVI.JFVIB_KZHHDLIW('%H_%H'%(WZGZYZHV_KZIZ['WZGZYZHV'], WZGZYZHV_KZIZ['OLXZGRLM']),WZGZYZHV_KZIZ['FHVI'])
                #KIRMG(WZGZYZHV_KZIZ['WZGZYZHV'], WZGZYZHV_KZIZ['OLXZGRLM'], WZGZYZHV_KZIZ['FHVI'])
                VMTRMV = XIVZGV_VMTRMV('NBHJO+KBNBHJO://%H:%H@%H/%H?XSZIHVG=FGU1'%(WZGZYZHV_KZIZ['FHVI'], KZHHDW, WZGZYZHV_KZIZ['ZWWIVHH'], WZGZYZHV_KZIZ['WZGZYZHV']), KLLO_HRAV=899)
                hVHHRLM = HVHHRLMNZPVI(YRMW=VMTRMV)
                HVOU.WZGZYZHV_KLLO[PVB] = hVHHRLM
                HVOU.OLTTVI.RMUL('[yllg] TVMVIZGVW HVHHRLM ULI %H, ZWWI:%H'%(PVB, WZGZYZHV_KZIZ['ZWWIVHH']))
        ULI CO RM HVOU.ILLG.URMW('EZFOG').URMWZOO('WZGZ'):
            CO_KZIZ = CO.ZGGIRY
            KZHHDW = mLMV
            PVB = CO_KZIZ['RW']
            XOZHHLK, WVHG = RNKLIG_WZGZ(CO.ZGGIRY['NLWFOV'])
            HVOU.OLTTVI.RMUL('[yllg] -> [WZGZ] OLZW %H'%CO.ZGGIRY['NLWFOV'])
            WZGZ_ZKK = XOZHHLK(CO, HVOU, HVOU.TOLYZO_RMUL)
            HVOU.WZGZ_KLLO[PVB] = WZGZ_ZKK
        ULI CO RM HVOU.ILLG.URMW('ULINFOZV').URMWZOO('ULINFOZ'):
            CO_KZIZ = CO.ZGGIRY
            KZHHDW = mLMV
            PVB = CO_KZIZ['RW']
            XOZHHLK, WVHG = RNKLIG_ULINFOZ(CO.ZGGIRY['NLWFOV'])
            HVOU.OLTTVI.RMUL('[yllg] -> [ULINFOZ] OLZW %H'%CO.ZGGIRY['NLWFOV'])
            WZGZ_ZKK = XOZHHLK(CO, HVOU, HVOU.TOLYZO_RMUL)
            HVOU.WZGZ_KLLO[PVB] = WZGZ_ZKK



    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL('[ZKLOOL] IVZWB GL ZXXVKG WZGZ ZMW ULINFOZ IVJFVHGH')
        HVOU.KLHG_HVIEVIH = []
        HVOU.KLHG_HVIEVI_QLYH = []
        ULI ZWWI RM HVOU.ZWWIVHH_ORHG:
            HVOU.KLHG_HVIEVIH.ZKKVMW( kLHGhVIEVI(ZWWI[9], RMG(ZWWI[8]), kLHGhVIEVIsZMWOVI, HVOU.OLTTVI) )
            HVOU.KLHG_HVIEVI_QLYH.ZKKVMW(qLY(HVOU.KLHG_HVIEVIH[-8]))
            HVOU.TOLYZO_RMUL.QLYH['ZKLOOL_kLHGhVIEVI@%H_%H'%(ZWWI[9], ZWWI[8])] = HVOU.KLHG_HVIEVI_QLYH[-8]
            HVOU.KLHG_HVIEVI_QLYH[-8].HGZIG()
            HVOU.OLTTVI.RMUL('[yllg] HGZIGVW HVIEVI %H:%H'%(ZWWI[9], ZWWI[8]))
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            GRNV.HOVVK(8)


    WVU IVTRHGVI_WZGZ_UFMXGRLM(HVOU, UFMX):
        PVB = UFMX.__MZNV__
        RU PVB RM HVOU.WZGZ_UFMXGRLM_KLLO:
            IZRHV eZOFVvIILI('%H ZOIVZWB IVTRHGVIVW'%PVB)
        HVOU.WZGZ_UFMXGRLM_KLLO[PVB] = uFMXGRLMkZIHVI(UFMX)
        UFMX.OLTTVI = HVOU.OLTTVI
        UFMX.WZGZYZHV_KLLO = HVOU.WZGZYZHV_KLLO
        wZGZsVOKVI.ZWW_NVGSLW(UFMX)
        IVGFIM HVOU.WZGZ_UFMXGRLM_KLLO[PVB]


    WVU IVTRHGVI_ULINFOZ(HVOU, UFMX):
        PVB = UFMX.__MZNV__
        RU PVB RM HVOU.ULINFOZ_KLLO:
            IZRHV eZOFVvIILI('%H ZOIVZWB IVTRHGVIVW'%PVB)
        HVOU.ULINFOZ_KLLO[PVB] = uFMXGRLMkZIHVI(UFMX)
        TOLYZO OLTTVI, WZGZYZHV_KLLO
        UFMX.OLTTVI = HVOU.OLTTVI
        UFMX.WZGZYZHV_KLLO = HVOU.WZGZYZHV_KLLO
        uLINFOZsVOKVI.ZWW_NVGSLW(UFMX)
        IVGFIM HVOU.ULINFOZ_KLLO[PVB]
//##**---------------- ./ZKLOOL/VGX/ZKLOOL.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<ZKLOOL_GSV XORVMG='.' >
    <OLT  OVEVO="WVYFT" OLTUROV="ZKLOOL_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />
    <NLWFOVH>
        <NLWFOV RW="ZKLOOL" KLHG_HVIEVI="79.81.9.897:69987"/>
        <!--NLWFOV RW="ZKLOOL" KLHG_HVIEVI="872.9.9.8:69987"/-->
    </NLWFOVH>

    <WZGZYZHVH>
        <WZGZYZHV RW='OVLMRH_WZGZYZHV' ZWWIVHH='NBHJO.YQ.FYRJFZMG:3333' WZGZYZHV='oVLMRH' FHVI='WZGZNZM' OLXZGRLM='YVRQRMT'/>
    </WZGZYZHVH>

    <EZFOG>
        <WZGZ RW="wZGVzMWgRNV" NLWFOV="wZGVzMWgRNV" />
        <WZGZ RW="hGIZGVTBgZYOV" NLWFOV="hGIZGVTBgZYOV" />
        <WZGZ RW="hGIZGVTByZHV" NLWFOV="hGIZGVTByZHV" />
    </EZFOG>

    <ULINFOZV>
        <ULINFOZ RW="kILWFXGxZHS" NLWFOV="kILWFXGxZHS"/>
        <ULINFOZ RW="gVHGrMWuLI" NLWFOV="gVHGrMWuLI"/>
        <ULINFOZ RW="uVVnZMZTVI" NLWFOV="uVVnZMZTVI" />
        <!--ULINFOZ RW="uVVnZMZTVIxLWVH" NLWFOV="uVVnZMZTVIxLWVH"/>
        <ULINFOZ RW="uVVnZMZTVIxLWVkZIHV" NLWFOV="uVVnZMZTVIxLWVkZIHV"/>
        <ULINFOZ RW="uVVnZMZTVIxZO" NLWFOV="uVVnZMZTVIxZO"/-->
    </ULINFOZV>
</ZKLOOL_GSV>
//##**---------------- ./ZKLOOL/VGX/ZKLOOL_YUZM.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<ZKLOOL_GVHG_YUZM XORVMG='.' >
    <OLT  OVEVO="WVYFT" OLTUROV="ZKLOOL_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />
    <NLWFOVH>
        <NLWFOV RW="ZKLOOL" KLHG_HVIEVI="872.9.9.8:69987"/>
    </NLWFOVH>

    <WZGZYZHVH>
        <WZGZYZHV RW='FZX_WZGZYZHV' ZWWIVHH='NBHJO.YQ.FYRJFZMG:3333' WZGZYZHV='FZX' FHVI='WZGZNZM' OLXZGRLM='YVRQRMT'/>
    </WZGZYZHVH>

    <EZFOG>
        <WZGZ RW="wZGVzMWgRNV" NLWFOV="wZGVzMWgRNV" />
        <WZGZ RW="hGIZGVTBgZYOV" NLWFOV="hGIZGVTBgZYOV" />
    </EZFOG>

    <ULINFOZV>
        <ULINFOZ RW="kILWFXGxZHS" NLWFOV="kILWFXGxZHS"/>
        <ULINFOZ RW="gVHGrMWuLI" NLWFOV="gVHGrMWuLI"/>
    </ULINFOZV>
</ZKLOOL_GVHG_YUZM>
//##**---------------- ./ZKLOOL/VGX/ZKLOOL_QP.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<ZKLOOL_GSV XORVMG='.' >
    <OLT  OVEVO="WVYFT" OLTUROV="ZKLOOL_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />
    <NLWFOVH>
        <!--NLWFOV RW="ZKLOOL" KLHG_HVIEVI="79.81.9.897:69987"/-->
        <NLWFOV RW="ZKLOOL" KLHG_HVIEVI="872.9.9.8:69987"/>
    </NLWFOVH>

    <WZGZYZHVH>
        <WZGZYZHV RW='OVLMRH_WZGZYZHV' ZWWIVHH='NBHJO.YQ.FYRJFZMG:3333' WZGZYZHV='oVLMRH' FHVI='WZGZNZM' OLXZGRLM='YVRQRMT'/>
    </WZGZYZHVH>

    <EZFOG>
        <WZGZ RW="wZGVzMWgRNV" NLWFOV="wZGVzMWgRNV" />
        <WZGZ RW="hGIZGVTBgZYOV" NLWFOV="hGIZGVTBgZYOV" />
        <WZGZ RW="hGIZGVTByZHV" NLWFOV="hGIZGVTByZHV" />
    </EZFOG>

    <ULINFOZV>
        <ULINFOZ RW="kILWFXGxZHS" NLWFOV="kILWFXGxZHS"/>
        <ULINFOZ RW="gVHGrMWuLI" NLWFOV="gVHGrMWuLI"/>
        <ULINFOZ RW="uVVnZMZTVI" NLWFOV="uVVnZMZTVI" />
        <!--ULINFOZ RW="uVVnZMZTVIxLWVH" NLWFOV="uVVnZMZTVIxLWVH"/>
        <ULINFOZ RW="uVVnZMZTVIxLWVkZIHV" NLWFOV="uVVnZMZTVIxLWVkZIHV"/>
        <ULINFOZ RW="uVVnZMZTVIxZO" NLWFOV="uVVnZMZTVIxZO"/-->
    </ULINFOZV>
</ZKLOOL_GSV>
//##**---------------- ./ZKLOOL/ULINFOZV/gVHGrMWuLI.KB

UILN XORVMGYZHV.YZHV_ULINFOZ RNKLIG uLINFOZ
UILN XORVMGSVOKVI.WZGZSVOKVI RNKLIG wZGZsVOKVI


WVU gVHGrMW():
    HGZIGwZGV = '7981-93-78'
    VMWwZGV = '7981-93-78'
    WZG = wZGZsVOKVI.tVGhGIZgZTwZROB('TCy', HGZIGwZGV, VMWwZGV)
    #KIRMG(WZG.PVBH())
    #KIRMG('------------------------', GBKV(WZG))
    IVGFIM WZG


XOZHH gVHGrMWuLI(uLINFOZ):
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HFKVI(gVHGrMWuLI, HVOU).__RMRG__(CNO, ZKK, TOLYZO_RMUL)
        HVOU.ZKK.IVTRHGVI_ULINFOZ(gVHGrMW)\
                .FHZTV('TVG KILWFXG XZHS')\


//##**---------------- ./ZKLOOL/ULINFOZV/sVWTVwZROBkMO.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
#-*- XLWRMT: FGU-1 -*-
#xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
#zOO IRTSGH IVHVIEVW.

UILN XORVMGYZHV.YZHV_ULINFOZ RNKLIG uLINFOZ


WVU tVGkILWFXGwZG(KILWFXG, HGZIGwZGV,VMWwZGV):
    HJO = "hvovxg gIZWRMTwZB ZH gIZWRMTwZGV, HGLXP_NPGE ZH hGPnPGE, UFGFIV_NPGE ZH uFGnPGE, wZGZgBKV UILN sVWTVkILWFXGwZROBkMO DSVIV KILWFXGRW='"+KILWFXG+"' ZMW GIZWRMTWZB>='"+HGZIGwZGV+"' ZMW GIZWRMTWZB<='"+VMWwZGV+"'"
    WZG = KW.IVZW_HJO(HJO, XLMM_TVNRMR)
    WZG.RMWVC = WZG.GIZWRMTWZB
    #WZG = {'WZGVH':WZG.GIZWRMTWZB.GLORHG(),'HGPnPGE':WZG.HGLXP_NPGE.GLORHG(), 'UFGnPGE':WZG.UFGFIV_NPGE.GLORHG(), 'WZGgBKV':WZG.wZGZgBKV.GLORHG()}
    IVGFIM WZG

XOZHH sVWTVwZROBkMO(uLINFOZ):
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HFKVI(sVWTVwZROBkMO, HVOU).__RMRG__(CNO, ZKK, TOLYZO_RMUL)
        HVOU.ZKK.IVTRHGVI_ULINFOZ(tVGkILWFXGwZG)\
                .FHZTV('TVG KILWFXG WZG DSRXS FHVW GL XZO KMO')\
                .IVJFRIV('HGIZ',HGI,'HGIZGVTBRW')\
                .IVJFRIV('WZGV',HGI,'WZGV')

//##**---------------- ./ZKLOOL/ULINFOZV/uVVnZMZTVI.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
#-*- XLWRMT: FGU-1 -*-
#xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
#zOO IRTSGH IVHVIEVW.
RNKLIG KZGSORY
XKZGS = HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
RNKLIG HBH
HBH.KZGS.ZKKVMW(XKZGS)
HBH.KZGS.ZKKVMW(XKZGS+'/EZFOG')

RNKLIG WZGVGRNV ZH WG
RNKLIG KZMWZH ZH KW
RNKLIG MFNKB ZH MK
UILN XORVMGYZHV.YZHV_ULINFOZ RNKLIG uLINFOZ
UILN XORVMGSVOKVI.WZGZSVOKVI RNKLIG wZGZsVOKVI
RNKLIG QHLM
UILN XORVMGSVOKVI RNKLIG FGRO_GSV
RNKLIG OVLMRHgZYOVH ZH OVLMRH
RNKLIG HJOZOXSVNB
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI


WVU uVVnZMZTVIxZO(UVVxLWVkZIHV, GIW):
    OLTTVI = uVVnZMZTVIxZO.OLTTVI
    ULI IVH RM UVVxLWVkZIHV:
        GIW = uVVnZMZTVIxZOfMRG(IVH, GIW, OLTTVI)
    IVGFIM GIW

WVU uVVnZMZTVIxZOfMRG(IVH, GIW, OLTTVI):
    M = GIW.HSZKV[9]
    UVVH = [9] * M
    #OLTTVI.WVYFT(IVH)
    ULI RiLD RM IZMTV(M):
        HVXF = GIW.rMHGIFNVMGrw.ROLX[RiLD]
        GNK = HVXF.HKORG('.')
        RMHGIF = GNK[9]
        NZIPVG = GNK[8]
        RU 'v' RM IVH:
            RU NZIPVG MLG RM IVH['v']:
                OLTTVI.WVYFT('%H %W MLG RM NZIPVGH, WL MLG XZO %H'%(HVXF, RiLD, IVH['z']))
                XLMGRMFV

        RU 'r' RM IVH:
            RU IVH['r'] != 'zOO' ZMW IVH['r'] MLG RM RMHGIF:
                OLTTVI.WVYFT('%H %W MLG RM RMHGIFNVMGH, WL MLG XZO %H'%(HVXF, RiLD, IVH['z']))
                XLMGRMFV

        RU 'w' RM IVH:
            RU (GIW.wRIVXGRLM.ROLX[RiLD] == 'y' ZMW GIW.lUUHVGuOZT.ROLX[RiLD] == 9):
                W = '9'
            VORU (GIW.wRIVXGRLM.ROLX[RiLD] == 'h' ZMW GIW.lUUHVGuOZT.ROLX[RiLD] == 8):
                W = '7'
            RU W MLG RM IVH['w']:
                OLTTVI.WVYFT('%H %W MLG RM WRIVXGRLM, WL MLG XZO %H'%(HVXF, RiLD, IVH['z']))
                XLMGRMFV

        RU IVH['u'] == '9' ZMW IVH['g'] == '9':
            OLTTVI.WVYFT('%H %W URCVW, GIZWVEZOFV %H'%(HVXF, RiLD, IVH['z']))
            EZO = NZC(IVH['n'], GIW.gIZWVeLOFNV.ROLX[RiLD] * GIW.gIZWVkIRXV.ROLX[RiLD] * IVH['i'])
            RU IVH['z'] RM GIW.XLOFNMH:
                UVVH[RiLD] = GIW[IVH['z']].ROLX[RiLD] + EZO
            VOHV:
                UVVH[RiLD] = EZO
    GIW[IVH['z']] = UVVH
    IVGFIM GIW

WVU uVVnZMZTVIxLWVkZIHV(UVVXLWVH):
    LFGKFGzOO = ORHG()
    ULI UVVXLWV RM UVVXLWVH:
        XLWVH = UVVXLWV.HKORG('-')
        LFGKFG = WRXG()
        ULI XLWV RM XLWVH:
            GNK = XLWV.HKORG('[')
            MZNV = GNK[9]
            EZO = GNK[8][9:-8]
            RU MZNV RM ['v','w']:
                EZO = EZO.HKORG('|')
            VORU MZNV == 'n':
                EZO = UOLZG(EZO)
            VORU MZNV == 'i':
                EZO = UOLZG(EZO)
            LFGKFG[MZNV] = EZO
        LFGKFGzOO.ZKKVMW(LFGKFG)
    IVGFIM LFGKFGzOO

WVU uVVnZMZTVIxLWVH(HGIZ, WZGV):
    OLTTVI = uVVnZMZTVIxLWVH.OLTTVI
    #wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/oVLMRH?XSZIHVG=FGU1'
    #XLMM = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)
    #HVHHRLM = HVHHRLMNZPVI(YRMW=XLMM)
    #XFIHLI = HVHHRLM()

    XFIHLI = uVVnZMZTVIxLWVH.WZGZYZHV_KLLO['OVLMRH_WZGZYZHV']()
    GZYOV = OVLMRH.hGIZGVTBzXXLFMG
    WZG = XFIHLI.JFVIB(GZYOV).UROGVI(GZYOV.hGIZGVTBrw==HGIZ).ZOO()
    RU OVM(WZG) == 9:
        OLTTVI.RMUL('%H %H WL MLG URMW ZXX RM hGIZGVTBzXXLFMG'%(HGIZ, WZGV))
        IVGFIM mLMV
    ZXX = FGRO_GSV.gIZMHwZG7wu(WZG)
    ZXX = ZXX.zXXLFMGrw.ROLX[9]
    #HJO = "HVOVXG * UILN hGIZGVTBzXXLFMG DSVIV HGIZGVTBRW='"+HGIZ+"'"
    #ZXX = KW.IVZW_HJO(HJO, XLMM_OVLMRH)
    #WZG = KW.IVZW_HJO(HJO, XLMM_OVLMRH)
    GZYOV = OVLMRH.zXXLFMGuVVkZIZNH
    #WZG = XFIHLI.JFVIB(GZYOV).UROGVI(GZYOV.zXXLFMGrw==ZXX).UROGVI(HJOZOXSVNB.LI_(GZYOV.vMWwZGV > WZGV,GZYOV.vMWwZGV == mLMV)).UROGVI(GZYOV.hGZIGwZGV<=WZGV).ZOO()
    WZG = XFIHLI.JFVIB(GZYOV).UROGVI(GZYOV.zXXLFMGrw==ZXX).ZOO()
    KIRMG(OVM(WZG))
    RU OVM(WZG) == 9:
        HJO = "HVOVXG * UILN zXXLFMGuVVkZIZNH DSVIV ZXXLFMGRW='"+ZXX+"' ZMW HGZIGWZGV<='"+WZGV+"' ZMW (VMWWZGV>'"+WZGV+"' LI VMWWZGV RH MFOO)"
        OLTTVI.RMUL('%H %H WL MLG URMW UVVXLWV RM zXXLFMGuVVkZIZNH'%(ZXX, WZGV))
        IVGFIM mLMV
    WZG = FGRO_GSV.gIZMHwZG7wu(WZG)
    KIRMG(WZG)
    LFGKFG = WZG.kZIZNH.GLORHG()
    XFIHLI.XOLHV()
    IVGFIM LFGKFG


XOZHH uVVnZMZTVI(uLINFOZ):
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HFKVI(uVVnZMZTVI, HVOU).__RMRG__(CNO, ZKK, TOLYZO_RMUL)
        HVOU.ZKK.IVTRHGVI_ULINFOZ(uVVnZMZTVIxLWVH)\
                .FHZTV('TVG UVV XLWVH ZH HGIRMTH ')\
                .IVJFRIV('HGIZ',HGI,'HGIZGVTBRW')\
                .IVJFRIV('WZGV',HGI,'WZGV')
        HVOU.ZKK.IVTRHGVI_ULINFOZ(uVVnZMZTVIxLWVkZIHV)\
                .FHZTV('KZIHV UVV XLWV')\
                .IVJFRIV('UVVXLWVH',HGI,'UVVXLWVH')
        HVOU.ZKK.IVTRHGVI_ULINFOZ(uVVnZMZTVIxZO)\
                .FHZTV('XZO UVV DRGS VZXS GIZWVH')\
                .IVJFRIV('UVVxLWVkZIHV',HGI,'UVV XLWV KZIHV IVHFOGH')\
                .IVJFRIV('GIW',HGI,'GIZWVOLT DRGS IVJFRIVW XLOFNMH HFXS ZH gIZWVeZOFV')\

RU __MZNV__ == "__NZRM__":
    WZGV = '7981-93-84'
    HGIZ = 'TCy'
    IVH = uVVnZMZTVIxLWVH(HGIZ, WZGV)
    KIRMG(IVH)

//##**---------------- ./ZKLOOL/ULINFOZV/kILWFXGxZHS.KB
#XLWRMT=FGU-1
RNKLIG WZGVGRNV ZH WG
RNKLIG KZMWZH ZH KW
RNKLIG MFNKB ZH MK
UILN XORVMGYZHV.YZHV_ULINFOZ RNKLIG uLINFOZ
UILN XORVMGSVOKVI.WZGZSVOKVI RNKLIG wZGZsVOKVI
RNKLIG QHLM

WVU tVGkILWwZG(HGZIGwZGV, VMWwZGV):
    WZGVH = wZGZsVOKVI.tVGgIZWRMTwZGVH(HGZIGwZGV, VMWwZGV)
    M= OVM(WZGVH)
    WZG = KW.wZGZuIZNV(MK.AVILH((M,2)))
    WZG.XLOFNMH = ['hhvnPGEoLMT','havnPGEoLMT','sptnPGEoLMT','hGPxZHS','uFGxZHS','iVKL','hGPzEZRO']
    WZG.RMWVC = WZGVH
    IVGFIM WZG

WVU rMRGwZGyZG(KILWFXGH, WZGVH, XLWVH, IRHPOVEVO=9):
    # 通用版本
    LFGKFG = KW.wZGZuIZNV()
    ULI KILWFXG RM KILWFXGH:
        WZGgNK = KW.wZGZuIZNV()
        ULI XLWV RM XLWVH:
            WZGgNK7 = KW.wZGZuIZNV()
            WZGgNK7['gIZWRMTwZGV'] = WZGVH
            WZGgNK7['kILWFXGrw'] = KILWFXG
            WZGgNK7['rMWeZOFV'] = MK.MZM
            WZGgNK7['iRHPoVEVO'] = IRHPOVEVO
            WZGgNK7['rMWxLWV'] = XLWV
            WZGgNK7['iVNZIP'] = ''
            WZGgNK = KW.XLMXZG([WZGgNK, WZGgNK7])
        LFGKFG = KW.XLMXZG([LFGKFG, WZGgNK])
    RU MLG LFGKFG.VNKGB:
        LFGKFG.RMWVC = [ORHG(LFGKFG['kILWFXGrw']),ORHG(LFGKFG['gIZWRMTwZGV']), ORHG(LFGKFG['rMWxLWV'])]
    IVGFIM LFGKFG


WVU tVGkILWFXGxZHS(HGZIGwZGV, VMWwZGV, KILWFXGH):
    WZGVH =  wZGZsVOKVI.tVGgIZWRMTwZGVH(HGZIGwZGV, VMWwZGV)
    XLWVH = ['899898794','899898793','899898792','899898791','899898790','899898789','899898788', '899898787', '899898786', '899898778']
    WZGVkIV9 = wZGZsVOKVI.gIZWRMTwZGVnLEV(HGZIGwZGV, -8)
    RMWeZOFV = rMRGwZGyZG(KILWFXGH, WZGVH, XLWVH)
    ULI KILWFXG RM KILWFXGH:
        KIRMG(KILWFXG)
        WZG = tVGkILWwZG(WZGVkIV9, VMWwZGV)
        RU WZG RH mLMV:
            XLMGRMFV

        WZG['hGPnPGE'] = WZG[['hhvnPGEoLMT','havnPGEoLMT','sptnPGEoLMT']].HFN(ZCRH=8)
        ULI RiLD RM IZMTV(8, OVM(WZGVH)):
            WZGVkIV = WZGVH[RiLD-8]
            WZGV = WZGVH[RiLD]
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898778'), 'rMWeZOFV'] = WZG.RC[WZGV, 'iVKL']
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898778'), 'iVNZIP'] = '剩余可用资金为 {:,.7U}'.ULINZG(WZG.RC[WZGV, 'hGPzEZRO'])
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898787'), 'rMWeZOFV'] = WZG.RC[WZGV, ['hGPrM','hGPlFG']].HFN()
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898786'), 'rMWeZOFV'] = WZG.RC[WZGV, ['uFGrM','uFGlFG']].HFN()
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898793'), 'rMWeZOFV'] = WZG.RC[WZGV, 'hGPxZHS']
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898792'), 'rMWeZOFV'] = WZG.RC[WZGV, 'uFGxZHS']
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898791'), 'rMWeZOFV'] = WZG.RC[WZGV, 'hGPxZHS'] - WZG.RC[WZGVkIV, 'hGPxZHS']
            RMWeZOFV.RC[(KILWFXG, WZGV, '899898790'), 'rMWeZOFV'] = WZG.RC[WZGV, 'uFGxZHS'] - WZG.RC[WZGVkIV, 'uFGxZHS']
    IVGFIM RMWeZOFV
    #KIRMG(GBKV(RMWeZOFV) == KW.XLIV.UIZNV.wZGZuIZNV)
    #KIRMG(HGI(KW.XLIV.UIZNV.wZGZuIZNV.__MZNV__)
    #IVGFIM QHLM.OLZWH(RMWeZOFV.GL_QHLM(LIRVMG='IVXLIWH'))


XOZHH kILWFXGxZHS(uLINFOZ):
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HFKVI(kILWFXGxZHS, HVOU).__RMRG__(CNO, ZKK, TOLYZO_RMUL)
        HVOU.ZKK.IVTRHGVI_ULINFOZ(tVGkILWFXGxZHS)\
                .FHZTV('TVG KILWFXG XZHS')\
                .IVJFRIV('HGZIGwZGV',HGI,'HGZIG WZGV')\
                .IVJFRIV('VMWwZGV',HGI,'VMW WZGV')\
                .IVJFRIV('KILWFXGH',ORHG,'KILWFXG ORHG')

# -------------------- NZRM ----------------

RU __MZNV__ == "__NZRM__":
    #KZIZNH.WVYFTnLWV = gIFV
    #KZIZNH.RHnZRO = uZOHV

    HGZIGwZGV = (WG.WZGVGRNV.MLD()+WG.GRNVWVOGZ(-8)).HGIUGRNV('%b-%N-%W')
    VMWwZGV = (WG.WZGVGRNV.MLD()+WG.GRNVWVOGZ(-9)).HGIUGRNV('%b-%N-%W')

    #KILWFXGH = kILWFXGgBKV(HGZIGwZGV, VMWwZGV).tVGkILWFXGrw7(HGLXP='hGLXP', GIZWV='gIZWV', NZIPVG='z',ZOO=gIFV)
    #LFGKFG = tVGkILWlKG().tVGkILWlKG(ZITE=HBH.ZITE[8:], HGLXP='hGLXP', GIZWV='gIZWV', NZIPVG='z', ZOOkILW=gIFV)
    #HGZIGwZGV = LFGKFG['hGZIGwZGV']
    #VMWwZGV = LFGKFG['vMWwZGV']
    #KILWFXGH = LFGKFG['kILWFXG']
    KILWFXGH = ['ABBZ8']

    GNK = xZHSwZG(KILWFXGH, HGZIGwZGV, VMWwZGV)
    GNK.dLIP()

//##**---------------- ./ZKLOOL/IVOVZHV.HS
HVG -V
. /RMX/EVIHRLM.RMX
NZPV
NPWRI -K /LKG/EVIHRLM/$xlnkrov_evihrlm/XZMZIB
XK -i ./* /LKG/EVIHRLM/$xlnkrov_evihrlm/XZMZIB/
GLFXS /LKG/EVIHRLM/$xlnkrov_evihrlm/XZMZIB/__RMRG__.KB
NPWRI -K /LKG/XZMZIB
//##**---------------- ./ZKLOOL/__RMRG__.KB
//##**---------------- ./ZKLOOL/WVNL/WVNL.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
'''
'''

RNKLIG HBH
RNKLIG QHLM
#RNKLIG IVJFVHGH
RNKLIG TVGLKG
UILN KKIRMG RNKLIG KKIRMG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.ZKLOOLXORVMG RNKLIG zKLOOLvMTRMV

# RMRGRZGV ZM VMTRMV
VMTRMV = zKLOOLvMTRMV()
# GVOO GSV ZKLOOL HVIEVI ZWWIVHH
VMTRMV.ZWWIVHH('79.81.9.897:69986')

# XOR RH KIVGGB NFXS IZD WZGZ
#XOR = VMTRMV.ULINFOZ('tVGkILWFXGxZHS', HGZIGwZGV='7981-93-98',VMWwZGV='7981-93-78',KILWFXGH='QZAQ8')
XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-97', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-96', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-95', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-94', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-93', VMWwZGV='7981-97-97')
KIRMG(XOR)

#XOR = VMTRMV.SVOK(WZGZ=WZGZ, ULINFOZ=mLMV)

# BLF KILYZYOB MVVW GL IVXLMHGIFXG GSV WZGZ
IVG = VMTRMV.KILXVHH(XOR)
KIRMG(IVG)
//##**---------------- ./ZKLOOL/WVNL/WVNL_QP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
'''
'''

RNKLIG HBH
RNKLIG QHLM
#RNKLIG IVJFVHGH
RNKLIG TVGLKG
UILN KKIRMG RNKLIG KKIRMG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.ZKLOOLXORVMG RNKLIG zKLOOLvMTRMV

# RMRGRZGV ZM VMTRMV
VMTRMV = zKLOOLvMTRMV()
# GVOO GSV ZKLOOL HVIEVI ZWWIVHH
#VMTRMV.ZWWIVHH('79.81.9.897:69986')
VMTRMV.ZWWIVHH('872.9.9.8:69987')

# XOR RH KIVGGB NFXS IZD WZGZ
#XOR = VMTRMV.ULINFOZ('tVGkILWFXGxZHS', HGZIGwZGV='7981-93-98',VMWwZGV='7981-93-78',KILWFXGH='QZAQ8')
XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-97', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-96', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-95', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-94', VMWwZGV='7981-97-97')
KIRMG(XOR)

XOR = VMTRMV.WZGZ('tVGhGIZgZTwZROB',HRW='QPHC82', HGZIGwZGV='7981-98-93', VMWwZGV='7981-97-97')
KIRMG(XOR)

#XOR = VMTRMV.SVOK(WZGZ=WZGZ, ULINFOZ=mLMV)

# BLF KILYZYOB MVVW GL IVXLMHGIFXG GSV WZGZ
IVG = VMTRMV.KILXVHH(XOR)
KIRMG(IVG)
//##**---------------- ./ZKLOOL/WVNL/UVVnZMZTVI.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
#-*- XLWRMT: FGU-1 -*-
#xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
#zOO IRTSGH IVHVIEVW.
RNKLIG HBH
RNKLIG QHLM
#RNKLIG IVJFVHGH
RNKLIG TVGLKG
UILN KKIRMG RNKLIG KKIRMG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.ZKLOOLXORVMG RNKLIG zKLOOLvMTRMV

HBH.KZGS.ZKKVMW("/GNK/KBGSLM_KILTIZN/YZHV/")
UILN HGPgIWhGIZ RNKLIG hGPgIWhGIZ

# RMRGRZGV ZM VMTRMV
VMTRMV = zKLOOLvMTRMV()
# GVOO GSV ZKLOOL HVIEVI ZWWIVHH
VMTRMV.ZWWIVHH('79.81.9.897:69987')

# XOR RH KIVGGB NFXS IZD WZGZ
WZGV = '7981-93-84'
HGIZ = 'TCy'
#XOR = VMTRMV.ULINFOZ('tVGkILWFXGxZHS', HGZIGwZGV='7981-93-98',VMWwZGV='7981-93-78',KILWFXGH='QZAQ8')
XOR = VMTRMV.ULINFOZ('uVVnZMZTVIxLWVH', HGIZ=HGIZ, WZGV=WZGV)
UVVXLWVH = VMTRMV.KILXVHH(XOR)
KIRMG(UVVXLWVH)

XOR = VMTRMV.ULINFOZ('uVVnZMZTVIxLWVkZIHV', UVVXLWVH=UVVXLWVH)
UVVXLWVH = VMTRMV.KILXVHH(XOR)
KIRMG(UVVXLWVH)

GIW = hGPgIWhGIZ(HGIZ, WZGV, WZGV).tVGhGPgIW(WZGhIX='ZXXVBV')[WZGV]
KIRMG(GBKV(GIW))
XOR = VMTRMV.ULINFOZ('uVVnZMZTVIxZO', UVVxLWVkZIHV=UVVXLWVH, GIW=GIW)
GIWlFG = VMTRMV.KILXVHH(XOR)
#XOR = VMTRMV.SVOK(WZGZ=WZGZ, ULINFOZ=mLMV)

# BLF KILYZYOB MVVW GL IVXLMHGIFXG GSV WZGZ
#KIRMG(GIW)
//##**---------------- ./ZKLOOL/XORVMGSVOKVI/FGRO.KB
RNKLIG IV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
UILN WZGVGRNV RNKLIG WZGVGRNV
RNKLIG HRC
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG HBH
RNKLIG LH
RNKLIG RNK
# WVU RNKLIG_LKVIZGRLM(MZNV):
    # # gSRH UFMXGRLM RH GL RNKLIG LKVIZRGLM NLWFOVH UILN MZNV
    # KIRMG HBH.KZGS
    # KIRMG MZNV
    # NLW = __RNKLIG__(MZNV)
    # XLNKLMVMGH = MZNV.HKORG('.')
    # ULI XLNK RM XLNKLMVMGH[8:]:
        # NLW = TVGZGGI(NLW, XLNK)
    # IVGFIM TVGZGGI(NLW, XLNKLMVMGH[-8])

WVU RNKLIG_WZGZ(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'EZFOG') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_ULINFOZ(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'ULINFOZV') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

//##**---------------- ./ZKLOOL/XORVMGSVOKVI/FGRO_GSV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
#-*- XLWRMT: FGU-1 -*-
#xLKBIRTSG 7983 fYRJFZMG rMEVHGNVMG xL.
#zOO IRTSGH IVHVIEVW.

RNKLIG KZMWZH ZH KW

WVU gIZMHwZG7wu(WZG):
    M = OVM(WZG)
    XLOH = WRI(WZG[9])
    XLOH = [C ULI C RM XLOH RU '__' MLG RM C ZMW '_' MLG RM C]
    RU 'NVGZWZGZ' RM XLOH:
        XLOH.IVNLEV('NVGZWZGZ')
    LFGKFG = WRXG()
    ULI XLO RM XLOH:
        LFGKFG[XLO] = [mLMV] * M

    ULI RMHGZMXV RM VMFNVIZGV(WZG):
        ULI XLO RM XLOH:
            LFGKFG[XLO][RMHGZMXV[9]] = TVGZGGI(RMHGZMXV[8],XLO)
    LFGKFG = KW.wZGZuIZNV(LFGKFG)
    IVGFIM LFGKFG


//##**---------------- ./ZKLOOL/XORVMGSVOKVI/UFMXKZIHVI.KB
RNKLIG IV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
UILN WZGVGRNV RNKLIG WZGVGRNV
RNKLIG HRC
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG HBH
RNKLIG LH
RNKLIG RNK


XOZHH uFMXGRLMzITH(LYQVXG):
    WVU __RMRG__(HVOU, PVB, GBKV, FHZTV, WVUZFOG = mLMV):
        HVOU.PVB = PVB
        HVOU.GBKV = GBKV
        HVOU.FHZTV = FHZTV
        HVOU.WVUZFOG = WVUZFOG
        RU HVOU.WVUZFOG RH mLMV:
            HVOU.LKGRLMZO = uZOHV
        VOHV:
            HVOU.LKGRLMZO = gIFV

    WVU KIRMG(HVOU):
        IVGFIM '%89H[%H] : %H %H'%(HVOU.PVB, HVOU.GBKV.__MZNV__, HVOU.FHZTV, ('[lkgrlmzo WVUZFOG:%H]'%HVOU.WVUZFOG RU HVOU.LKGRLMZO VOHV ''))

XOZHH uFMXGRLMkZIHVI(LYQVXG):
    WVU __RMRG__(HVOU, UFMX):
        HVOU.UFMX = UFMX
        HVOU.ZITH = {}
        HVOU.ZIT_ORHG = []
        HVOU.MLGV = 'ml fhztv'
        HVOU.IVG_KLLO = {}
        HVOU.XZXSV_OZHG_GRNVH = 9
        HVOU.VCKRIV_HVXLMWH = 39

    WVU XZXSV_OZHG_GRNV(HVOU, GRNVH):
        HVOU.XZXSV_OZHG_GRNVH = GRNVH
        IVGFIM HVOU

    WVU VCKRIV(HVOU, HVXLMWH):
        HVOU.VCKRIV_HVXLMWH = HVXLMWH
        IVGFIM HVOU

    WVU FHZTV(HVOU, MLGV):
        HVOU.MLGV = MLGV
        IVGFIM HVOU

    WVU IVJFRIV(HVOU, PVB, GBKV, FHZTV):
        RU PVB RM HVOU.ZITH:
            IZRHV eZOFVvIILI('uFMXGRLMzITH %H ZOIVZWB IVTRHGVIVW'%PVB)
        ZIT = uFMXGRLMzITH(PVB, GBKV, FHZTV)
        HVOU.ZITH[PVB] = ZIT
        HVOU.ZIT_ORHG.ZKKVMW(ZIT)
        IVGFIM HVOU

    WVU LKGRLMZO(HVOU, PVB, GBKV, FHZTV, WVUZFOG):
        RU PVB RM HVOU.ZITH:
            IZRHV eZOFVvIILI('uFMXGRLMzITH %H ZOIVZWB IVTRHGVIVW'%PVB)
        ZIT = uFMXGRLMzITH(PVB, GBKV, FHZTV, WVUZFOG)
        HVOU.ZITH[PVB] = ZIT
        HVOU.ZIT_ORHG.ZKKVMW(ZIT)
        IVGFIM HVOU

    WVU KIRMG(HVOU):
        IVG = '%89H : %H\M%89H : %H\M%H\Mzith:'%('ufmxgrlm',HVOU.UFMX.__MZNV__, 'fhztv',HVOU.MLGV,'-'*79 )
        ULI ZIT RM HVOU.ZIT_ORHG:
            IVG += '\M'+ZIT.KIRMG()
        IVGFIM IVG


    WVU VEZO(HVOU, ZITH):
        IVG = []
        ULI ZIT RM HVOU.ZIT_ORHG:
            RU ZIT.PVB MLG RM ZITH:
                RU MLG ZIT.LKGRLMZO:
                    IVGFIM (uZOHV, 'MVVW GL RMKFG ZIT %H'%ZIT.PVB)
                ZT = ZIT.WVUZFOG
                IVG.ZKKVMW(ZT)
            VOHV:
                RU ZIT.GBKV == ORHG:
                    IVG.ZKKVMW(ZITH[ZIT.PVB].HKORG('|'))
                VOHV:
                    IVG.ZKKVMW(ZITH[ZIT.PVB])
        RU HVOU.XZXSV_OZHG_GRNVH > 9:
            PVB = '-'.QLRM(IVG)
            HG = RMG(WZGVGRNV.MLD().GRNVHGZNK())
            RU PVB RM HVOU.IVG_KLLO:
                RU (HG-HVOU.IVG_KLLO[PVB][9]) < HVOU.VCKRIV_HVXLMWH:
                    KIRMG('WRIVXG')
                    IVGFIM (gIFV, HVOU.IVG_KLLO[PVB][8])
                VOHV: # MVVW GL FKWZGV IVHFOG
                    KIRMG('XLKNFGV')
                    IVHFOG = HVOU.UFMX(*GFKOV(IVG))
                    HVOU.IVG_KLLO[PVB] = (HG, IVHFOG)
            VOHV:
                RU OVM(HVOU.IVG_KLLO) >= HVOU.XZXSV_OZHG_GRNVH: # MVVW GL KLK LFG LOW IVHFOG
                    #ZIIZB = [(PVB, EZOFV) ULI PVB, EZOFV RM HVOU.IVG_KLLO.RGVNH()]
                    WP = HLIGVW([(PVB, EZOFV) ULI PVB, EZOFV RM HVOU.IVG_KLLO.RGVNH()], PVB=OZNYWZ C:C[8][9])[9][9]
                    WVO HVOU.IVG_KLLO[WP]
                IVHFOG = HVOU.UFMX(*GFKOV(IVG))
                HVOU.IVG_KLLO[PVB] = (HG, IVHFOG)
        VOHV:
            IVHFOG = HVOU.UFMX(*GFKOV(IVG))
        IVGFIM (gIFV, IVHFOG)
//##**---------------- ./ZKLOOL/XORVMGSVOKVI/WZGZSVOKVI.KB
RNKLIG IV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
UILN WZGVGRNV RNKLIG WZGVGRNV
RNKLIG HRC
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG HBH
RNKLIG LH
RNKLIG RNK
RNKLIG GBKVH

OLTTVI = mLMV
WZGZYZHV_KLLO = mLMV

XOZHH wZGZsVOKVI(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

    WVU HVG_TOLYZORMUL(HVOU, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

    @HGZGRXNVGSLW
    WVU ZWW_OLTTVI(MOLTTVI):
        TOLYZO OLTTVI
        OLTTVI = MOLTTVI

    @HGZGRXNVGSLW
    WVU ZWW_WZGZYZHV_KLLO(MWZGZYZHV_KLLO):
        TOLYZO WZGZYZHV_KLLO
        WZGZYHV_KLLO = MWZGZYZHV_KLLO

    @XOZHHNVGSLW
    WVU ZWW_NVGSLW(XOH, UFMX):
        IVGFIM HVGZGGI(XOH, UFMX.__MZNV__, HGZGRXNVGSLW(UFMX))

WZGZ_SVOKVI = wZGZsVOKVI()
//##**---------------- ./ZKLOOL/XORVMGSVOKVI/ULINFOZSVOKVI.KB
RNKLIG IV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
UILN WZGVGRNV RNKLIG WZGVGRNV
RNKLIG HRC
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG HBH
RNKLIG LH
RNKLIG RNK
RNKLIG GBKVH

XOZHH uLINFOZsVOKVI(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

    WVU HVG_TOLYZORMUL(HVOU, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

    @XOZHHNVGSLW
    WVU ZWW_NVGSLW(XOH, UFMX):
        IVGFIM HVGZGGI(XOH, UFMX.__MZNV__, HGZGRXNVGSLW(UFMX))

ULINFOZ_SVOKVI = uLINFOZsVOKVI()
//##**---------------- ./ZKLOOL/IVZWNV.NW
ivzwnv
=================================

# HGZIUOVVG(8)

  `HGZIUOVVG(8)` RH Z XLOOVXGRLM LU YZHRX NZGS UFMXGRLMH ZMW ZIGRXOVH ZMW WRHXFHHRLMH, WVHRTMVW GL SVOK JFZMGH ZELRW
  NLHG XLNNLM NRHGZPVH.


## fHZTV

    fHZTV: HGZIUOVVG

    qFHG RMXOFWV FYRJ_NZGS.S RM BLFI KILQVXG ZMW ORMP ZTZRMHG ORYHGZIUOVVG.Z ZMW GSVM ZOO RH HVG.

## rMHGZOOZGRLM

  rMHGZOO `HGZIUOVVG(8)` ZMW RGH ZHHLXRZGVW ORYH ZMW SVZWVI UROVH GL /LKG.

    $ NZPV RMHGZOO


## zYLFG


## xLMURTFIZGRLM

  KZPXZTV MVVWH HLNV VCGIZ XLMURTFIZGRLM


## 6IW KZIGB XLWV/KILQVXGH ORHG ZMW NLWRURXZGRLMH:
=================================


//##**---------------- ./ZKLOOL/XORVMGYZHV/YZHV_ULINFOZ.KB
# RNKLIG SVOKVI.FGRO ZH FGRO
# UILN SVOKVI.FGRO RNKLIG  XSVXP_RM_HVHHRLM, HGIUWVOGZ
# UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG GIZXVYZXP
# RNKLIG WZGVGRNV
RNKLIG HBH
evihrlm = ''
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/HGZIUOVVG')
RNKLIG WZGVGRNV

XOZHH uLINFOZ(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO wZGZ
    '''
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.ZKK = ZKK
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
//##**---------------- ./ZKLOOL/XORVMGYZHV/KZXPZTVH.KB
#XLWRMT:FGU-1
RNKLIG MFNKB ZH MK
RNKLIG KZMWZH ZH KW
RNKLIG WZGVGRNV ZH WG
#RNKLIG nBhjoWY ZH NWY
RNKLIG KBNBHJO ZH NWY
RNKLIG XLKB ZH XLKB
RNKLIG NZGS ZH NZGS
RNKLIG LH ZH LH
RNKLIG HBH ZH HBH
RNKLIG RNK
RNKLIG IV
RNKLIG OLTTRMT
RNKLIG GIZXVYZXP
RNKLIG GRNV
RNKLIG TVGLKG
OLTTRMT.YZHRXxLMURT(ULINZG="[%(ZHXGRNV)H][%(OVEVOMZNV)H][%(UROVMZNV)H][%(UFMXmZNV)H][ORMV:%(ORMVML)W]-%(NVHHZTV)H", OVEVO=OLTTRMT.wvyft)

#XLMM = NWY.XLMMVXG(SLHG = '79.81.9.876', KLIG = 3333, FHVI = 'WZGZNZM', KZHHDW = 'iZ*1NZ!F', WY = 'FZX', XSZIHVG = 'FGU1')

RNKLIG HBH
HBH.KZGS.ZKKVMW("/SLNV/WZGZNZM/WZGZ/NBUFMX")
#RNKLIG WZGZ ZH wZGZhRMZ
#WZGhRMZ = wZGZhRMZ.wZGZ()

evihrlm=''
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG("=")[8].HGIRK()

HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
#RNKLIG KBKFYHFY ZH KY

RNKLIG HJOZOXSVNB
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI
UILN HJOZOXSVNB.VCG.WVXOZIZGREV RNKLIG WVXOZIZGREV_YZHV

#wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@79.81.9.876:3333/FZX?XSZIHVG=FGU1'
wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/FZX?XSZIHVG=FGU1'
#XLMM = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)

wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/zIRVH?XSZIHVG=FGU1'
XLMM_ZIRVH = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)

wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/oVLMRH?XSZIHVG=FGU1'
XLMM_OVLMRH = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)
XLMM_HGIZ = XLMM_OVLMRH

wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/gZFIFH?XSZIHVG=FGU1'
XLMM_GZFIFH = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)

wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/tVNRMR?XSZIHVG=FGU1'
XLMM_TVNRMR = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)

wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@NBHJO.YQ.FYRJFZMG:3333/FYRJWY?XSZIHVG=FGU1'
XLMMwy = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)

wy_xlm_hgi = 'NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@89.899.89.81:6693/FYRJWY?XSZIHVG=FGU1'
XLMM_HC91 = HJOZOXSVNB.XIVZGV_VMTRMV(wy_xlm_hgi, VXSL=uZOHV)
#HJO = 'HVOVXG * UILN zXXLFMGuzg'
#KIRMG(KW.IVZW_HJO(HJO, XLMM_HC91))

#DRGS LKVM("/RMX/IRHPkOZGULIN.RMX") ZH U:
#    ORMVH = U.IVZWORMVH()
#    ILLGkZGS = ORMVH[9].HKORG("=")[8].HGIRK()
RNKLIG KZGSORY
ILLGkZGS = HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[6])

HBH.KZGS.ZKKVMW(ILLGkZGS+"/IRHPkOZGULIN/KBGSLM_KILTIZN/YZHV")
HBH.KZGS.ZKKVMW(ILLGkZGS+"/IRHPkOZGULIN/KBGSLM_KILTIZN/YZIIZ")
HBH.KZGS.ZKKVMW(ILLGkZGS+"/IRHPkOZGULIN/KBGSLM_KILTIZN/")

KLHwZGkZGS = '/WZG/KLH'
#NZRMwRIVXGLIB = '/SLNV/WZGZNZM/GSV'
#KLHwRIVXGLIB = '/WZG/KLH'




















//##**---------------- ./ZKLOOL/XORVMGYZHV/YZHV_WZGZ.KB
# RNKLIG SVOKVI.FGRO ZH FGRO
# UILN SVOKVI.FGRO RNKLIG  XSVXP_RM_HVHHRLM, HGIUWVOGZ
# UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG GIZXVYZXP
# RNKLIG WZGVGRNV
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/HGZIUOVVG')
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
RNKLIG WZGVGRNV

XOZHH wZGZ(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO wZGZ
    '''
    WVU __RMRG__(HVOU, CNO, ZKK, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.ZKK = ZKK
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
//##**---------------- ./ZKLOOL/EVIHRLM.HS
EVIHRLM=
YFROW=
HSLD=
FKWZGV=
ZWW=
YFROW=
NZPV=
KFOO=
KFHS=
TRGHSLD=
TRGFKWZGV=

XSZMTVOLT=$(WRIMZNV $9)/xSZMTVoLT


DSROV TVGLKGH "HYZSFINKGTA" LKG;
WL
  XZHV "$LKG" RM
    H) HSLD="B"
      ;;
    Y) YFROW="B"
      ;;
    S) VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G/T/A"
       VXSL "-H: HSLD XFIIVMG EVIHRLM"
       VXSL "-Z LI -I: ZWW LI IVOVZHV Z MVD EVIHRLM"
       VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
       VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
       VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
       VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
       VXSL "-T: HSLD TRG SVZW"
       VXSL "-A: FKWZGV TRG SVZW"
       VCRG 8
       ;;
    Z) ZWW="B"
      ;;
    F) FKWZGV="B"
      ;;
    I) ZWW="B"
      ;;
    N) NZPV="B"
      ;;
    K) KFOO="B"
      ;;
    G) KFHS="B"
      ;;
    T) TRGHSLD="B"
      ;;
    A) TRGFKWZGV="B"
      ;;
  VHZX
WLMV

RU [[ -A $ZWW ]] && [[ -A $TRGHSLD ]] && [[ -A $TRGFKWZGV ]]  && [[ -A $FKWZGV ]] && [[ -A $HSLD ]] && [[ -A $YFROW ]] && [[ -A $NZPV ]] && [[ -A $KFHS ]] && [[ -A $KFOO  ]]
GSVM
    VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G"
    VXSL "-H: HSLD XFIIVMG IVOVZHV EVIHRLM"
    VXSL "-Z LI -I : ZWW LI IVOVZHV Z MVD EVIHRLM"
    VXSL "-Y: HSLD XFIIVMG YFROW EVIHRLM"
    VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
    VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
    VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
    VXSL "-T: ZXJFRIV TRG SVZW"
    VXSL "-A: FKWZGV TRG SVZW"
    VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
    VCRG 8
UR

ORMV_MFN=9

DSROV IVZW ORMV
WL
  ORMV_MFN=$((ORMV_MFN+8))
  MZNV=$(VXSL $ORMV|GI -H " ")
  URIHG_XSZIZXGVI=${MZNV:9:8}
  RU [ "$URIHG_XSZIZXGVI" == "@" ];GSVM
    MZNV=${MZNV:7:${#MZNV}-6}
    EVIHRLM=$MZNV
    YIVZP
  VORU [ "$URIHG_XSZIZXGVI" == "%" ];GSVM
    MZNV=${MZNV:2:${#MZNV}-1}
    YFROWML=$MZNV
  UR
WLMV < $XSZMTVOLT

RU [[ ! -A $HSLD ]]; GSVM
  KIRMGU $EVIHRLM
  VCRG 9
UR


RU [[ ! -A $YFROW ]]; GSVM
  KIRMGU $YFROWML
  VCRG 9
UR

RU [[ ! -A $TRGFKWZGV ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  HVW -R "/trgsvzw/X\trgsvzw=$ts" .KZIZ.RMX
  VCRG 9
UR


RU [[ ! -A $TRGHSLD ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  VCRG 9
UR


RU [[ ! -A $KFOO ]]; GSVM
  TRG HFYNLWFOV FKWZGV --IVNLGV
  VCRG 9
UR


RU [[ ! -A $KFHS ]]; GSVM
  TRG KFHS --IVXFIHV-HFYNLWFOVH=XSVXP
  VCRG 9
UR


RU [[ ! -A $NZPV  ]]; GSVM
    YFROW_RMG=${YFROWML:0:${#YFROWML}-0}
    YFROW_WG=${YFROWML:9:${#YFROWML}-4}
    (( YFROW_RMG = 89#$YFROW_RMG + 8 ))
    GLWZB=`WZGV +%b%N%W`
    YFROW_RMG=$(KIRMGU "%95W" $YFROW_RMG)
    RU [ "$YFROW_WG" -VJ "$GLWZB"  ]; GSVM
        YFROWML=$YFROW_WG-$YFROW_RMG
    VOHV
        YFROWML=$GLWZB-9998
    UR
    HVW -R "H/.*yfrow.*/%yfrow[$YFROWML]/" $XSZMTVOLT
    KIRMGU $YFROWML
    VCRG 9
UR


NLWRURVW=$(WZGV +%b-%N-%W)

BVOOLD='\966[8;66N'
mx='\966[9N'

RU [[ ! -A $ZWW ]]; GSVM
  KIRMGU "iVOVZHRMT Z MVD EVIHRLM, GSV NLHG IVXVMG EVIHRLM RH ${BVOOLD}$EVIHRLM${mx}:\M"
  IVZW -K "mVD EVIHRLM ml: " MVDEVIHRLM
  IVZW -K "mVD EVIHRLM MZNV: " EVIHRLMMZNV
  IVZW -K "mVD EVIHRLM YIRVU: " YIRVU
  HVW -R "${ORMV_MFN}R\\
@[$MVDEVIHRLM]\M# $NLWRURVW\M## $EVIHRLMMZNV \M- $YIRVU\M\\
    " $XSZMTVOLT
  VXSL "xSZMTVoLT FKWZGVW, MVD EVIHRLM $MVDEVIHRLM RMHVIGVW"
  VCRG 9
UR

RU [[ ! -A $FKWZGV ]]; GSVM
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\EVIHRLM.*/\* \\\EVIHRLM   $EVIHRLM/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\NLWRURVW.*/\* \\\NLWRURVW  $NLWRURVW/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\kilqvxg_mfnyvi.*/\* \\\kilqvxg_mfnyvi=$NLWRURVW/"
    VXSL "eVIHRLM ml RM ZOO UROVH FKWZGVW"
UR

//##**---------------- ./ZKLOOL/xSZMTVoLT
//##**---------------- ./IVWHSRUG/nZPVUROV
# xLKBIRTSG 7984 fYRJFZMG rMEVHGNVMG xL.
# zOO IRTSGH IVHVIEVW.
-RMXOFWV /RMX/EVIHRLM.RMX
-RMXOFWV /RMX/FYRJGLLO.RMX

-RMXOFWV .KZIZ.RMX


# GDL UFMXGRLMH FHVW OZGVI
IDROWXZIW=$(ULIVZXS W,$(DROWXZIW $8*),$(XZOO IDROWXZIW,$W/,$7) $(UROGVI $(HFYHG *,%,$7),$W))
OLDVIXZHV = $(HSVOO VXSL $(8) | ZDP '{KIRMG GLOLDVI($$8)}')
FKKVIXZHV = $(HSVOO VXSL $(8) | ZDP '{KIRMG GLFKKVI($$8)}')

# TVG txx EVIHRLM
txxevihrlm = $(HSVOO VCKI `TXX -WFNKEVIHRLM | XFG -U7 -W. ` \>= 1)

# HVG xkkuozth
xkkuozth := -dZOO -dVNKGB-YLWB -dML-WVKIVXZGVW -dML-WVKIVXZGVW -HGW=X++88
xuozth :=

# tOLYZO eZIRZYOVH
xx=TXX
xkk=T++

# HVG RMHGZOO KZGS SVIV
rmhgzoo_kzgs=/LKG/EVIHRLM/${xlnkrov_evihrlm}

# 7 WVURMRGRLMH FHVW YB FYRJ EVIHRLM XLMGILO HBHGVN
wve_evihrlm=$(HSVOO ./EVIHRLM.HS -H)
xlnkrovi_evihrlm = $(HSVOO $(xkk) -WFNKEVIHRLM)
fkwzgv_yfrow := $(HSVOO ./EVIHRLM.HS -N)
yfrow_evihrlm := $(HSVOO ./EVIHRLM.HS -Y)

trg_svzw := $(HSVOO TIVK trgsvzw .KZIZ.RMX | XFG -W'=' -U7)
fyrj_wvu= -wtrgsvzw='"$(trgsvzw)"' -wfyrj_wve_evihrlm='"$(wve_evihrlm)"' -wfyrj_wve_xlnkrovi='"$(xkk)"' -wfyrj_wve_yfrow='"$(yfrow_evihrlm)"' -wfyrj_wve_xlnkrovi_evihrlm='"$(xlnkrovi_evihrlm)"'

xkkuozth += $(fyrj_wvu)
xuozth += $(fyrj_wvu)

# EZIRLFH UOZTH, HVG KIVUVIIVW LKGRNRAZGRLM UOZT SVIV ZOHL
lkg_uozth := -l6 -wivovzhv -wmwvyft -ULNRG-UIZNV-KLRMGVI -UHGIRXG-ZORZHRMT
wvyft_uozth :=  -T -l9 -wwvyft
yvmxsnzip_uozth := -wyvmxsnzip
wbmznrx_uozth := -Ukrx -HSZIVW
lyq_uozth := -X

kivurc=.
ory_kzgs=$(kivurc)/ORY
yrm_kzgs=$(kivurc)/YRM
vgx_kzgs=$(kivurc)/VGX
hix_kzgs=$(kivurc)/HIX
wlx_kzgs=$(kivurc)/WLX
yfrow_kzgs=$(kivurc)/YFROW
rmxofwv_kzgs=$(kivurc)/RMXOFWV


# SVZWVI UROVH
svzwvi := $(DROWXZIW $(rmxofwv_kzgs)/*.S)

# FMRG GVHG, DV FHV TGVHG SVIV; BLF ZIV UIVV GL XSLLHV ZMBGSRMT VOHV
gvhg_hixh := $(DROWXZIW GVHG/*.XKK)
gvhg_lyqvxgh := $(ZWWKIVURC GVHG/,$(MLGWRI $(gvhg_hixh:.XKK=.L)))
gvhg_uozth := -OTGVHG


# GZITVG ORY/NZRM KILTIZN
# gzitvg_hixh = $(DROWXZIW HIX/*.XKK)
gzitvg_hixh = $(UROGVI-LFG HIX/NZRM.XKK, $(DROWXZIW HIX/*.XKK))
gzitvg_lyqvxgh:=$(ZWWKIVURC YFROW/,$(MLGWRI $(gzitvg_hixh:.XKK=.L)))


##############################################
# ULI WOLKVM/WOHBN
lh_oryh += -OWO -OA

RUVJ ($(yvmxsnzip), 8)
	xuozth += $(yvmxsnzip_uozth)
	xkkuozth += $(yvmxsnzip_uozth)
VMWRU

RUVJ ($(ivovzhv), 9)
	xuozth += $(wvyft_uozth)
	xkkuozth += $(wvyft_uozth)
	lyq_kzgs = $(wvyft_kzgs)
VOHV
	xuozth += $(lkg_uozth)
	xkkuozth += $(lkg_uozth)
	lyq_kzgs = $(ivovzhv_kzgs)
VMWRU

RUVJ ($(yvmxsnzip), 8)
	xuozth += -wyvmxsnzip     -UML-LNRG-UIZNV-KLRMGVI
	xkkuozth += -wyvmxsnzip   -UML-LNRG-UIZNV-KLRMGVI
VMWRU

RUVJ ($(xlnnzmw), 8)
	xuozth += -wxlnnzmw
	xkkuozth += -wxlnnzmw
VMWRU

evihrlm=YFROW
WVUZFOG:: ZOO

fyrj_rmx = -r/LKG/EVIHRLM/${evihrlm}/RMXOFWV -r/LKG/6IW/FYRJYZHV/RMXOFWV $(fyrjgllo_rmx)
fyrj_ory_kzgs = -o/LKG/EVIHRLM/${evihrlm}/ORY -dO,-IKZGS=/LKG/EVIHRLM/${evihrlm}/ORY
fyrj_ory=-OIG -OFYRJOLT -OFYRJGLLO -OKGSIVZW

dlinslov_rmx = -r$(rmxofwv_kzgs)
dlinslov_rmx += -r${rmhgzoo_kzgs}/RMXOFWV -r/LKG/6IW/YLLHG6/RMXOFWV/ -r/LKG/ZMZXLMWZ6/RMXOFWV/KBGSLM6.4N -r/LKG/EVIHRLM/${evihrlm}/IVWHSRUG -r/LKG/EVIHRLM/${evihrlm}/IVWHSRUG/RNKOVNVMG -r/LKG/6IW/KILGLYFU6/RMXOFWV -r/LKG/6IW/TIKX/RMXOFWV
dlinslov_oryh = -o$(ory_kzgs) -dO,-IKZGS=$(ory_kzgs)
dlinslov_oryh += -o/LKG/6IW/YLLHG6/ORY -o${rmhgzoo_kzgs}/ORY -o/LKG/EVIHRLM/${evihrlm}/ORY -o/LKG/ZMZXLMWZ6/ORY -o/LKG/6IW/TIKX/ORY -o/LKG/6IW/KILGLYFU6/ORY -o/LKG/EVIHRLM/${evihrlm}/IVWHSRUG/ORY
dlinslov_oryh += -dO,-IKZGS=/LKG/EVIHRLM/${evihrlm}/ORY,-IKZGS=/LKG/EVIHRLM/${evihrlm}/IVWHSRUG/ORY -dO,-IKZGS=/LKG/6IW/YLLHG6/ORY -dO,-IKZGS=/LKG/ZMZXLMWZ6/ORY,-IKZGS=/LKG/6IW/TIKX/ORY/,-IKZGS=/LKG/6IW/KILGLYFU6/ORY/
dlinslov_oryh += -OYLLHG_KBGSLM -OKBGSLM6.4N -OTIKX -OTIKX++ -OKILGLYFU -OIVWHSRUGXORVMG -OIVWHSRUG -OFYRJOLT -OFYRJGLLO

rmx += -r$(NZRMRMX)
rmx = -r$(rmxofwv_kzgs)
rmx += $(fyrj_rmx)

oryh += $(lh_oryh)
oryh += -dO,-IKZGS=$(ory_kzgs) -o$(ory_kzgs)
oryh += $(fyrj_ory_kzgs)
oryh += $(fyrj_ory)
oryh += $(NZRMORY)



#******************* gzitvgh ***************************
RUVJ "$(txxevihrlm)" "8"
ZOO:: NHT ORYIZIB IVWHSRUGORYIZIB GZITVG KBDLINSLOV
VOHV
ZOO:: NHT
VMWRU


tikx_rmx=-r/LKG/6IW/KILGLYFU6/RMXOFWV -r/LKG/6IW/TIKX/RMXOFWV
tikx_ory=-o/LKG/6IW/TIKX/ORY -OTIKX -OTIKX++
kilg_ory=-o/LKG/6IW/KILGLYFU6/ORY -OKILGLYFU



#****************** ivzo xlnkrozgrlm *******************
YFROW/%.L: RNKOVNVMG/tikx/%.XX $(svzwvi)
	@VXSL "[yfrow] YFROW ORYIZIB"
	$(xkk) $(xkkuozth) $(wbmznrx_uozth) $(lyq_uozth) -rRNKOVNVMG $(tikx_rmx) -L $@ $<

ORYIZIB: YFROW/HVIERXV.KY.L YFROW/HVIERXV.TIKX.KY.L $(svzwvi)
	@VXSL "[zixsrev] TVMVIZGV ORYIZIB"
	@T++ -HSZIVW -dO,-HLMZNV,ORYIVWHSRUG.HL -L ORY/ORYIVWHSRUG.HL  YFROW/HVIERXV.TIKX.KY.L YFROW/HVIERXV.KY.L

IVWHSRUGORYIZIB:
	@VXSL "[zixsrev] YFROWRMT IVWHSRUG XORVMG"
	$(xkk) $(xkkuozth) $(rmx)  $(tikx_rmx) -rRNKOVNVMG  -dO,-HLMZNV,ORYIVWHSRUGXORVMG.HL $(wbmznrx_uozth) -r.  -oORY  $(tikx_ory)  -OIVWHSRUG  -L ORY/ORYIVWHSRUGXORVMG.HL  -X IWSVOKVI/IVWHSRUG_XORVMG.XKK
	#ZI -XEJ ORY/ORYIVWHSRUGXORVMG.Z YFROW/ORYIVWHSRUGXORVMG.L

YFROW/KBDLINSLOV.L: KBDLINSLOV/KBDLINSLOV.XKK $(svzwvi)
	@VXSL "[yfrow] KBDLINSLOV"
	$(xkk) $(xkkuozth) $(rmx) -r. -rRNKOVNVMG $(fyrj_ory_kzgs) $(wbmznrx_uozth) $(lyq_uozth) $(dlinslov_rmx) -L $@ $< $(dlinslov_oryh)

KBDLINSLOV: YFROW/KBDLINSLOV.L $(svzwvi)
	$(xkk) -HSZIVW -dO,-HLMZNV,KBDLINSLOV.HL YFROW/KBDLINSLOV.L -L ORY/KBDLINSLOV.HL $(dlinslov_oryh)

GZITVG: HIX/NZRM.XKK $(gzitvg_lyqvxgh) $(svzwvi)
	@VXSL "[yfrow] YFROW NZRM"
	@$(xkk) HIX/NZRM.XKK $(gzitvg_lyqvxgh)  $(xkkuozth) $(oryh) $(rmx)  $(tikx_rmx) $(tikx_ory) $(kilg_ory) -dO,-IKZGS=/LKG/6IW/KILGLYFU6/ORY -dO,-IKZGS=/LKG/6IW/TIKX/ORY/ -rRNKOVNVMG -r. -oORY -OIVWHSRUGXORVMG -OIVWHSRUG  -OTIKX -OTIKX++ -L YRM/IVWHSRUG



#******************* gvhg xlnkrozgrlm ******************
GVHG/%.L: GVHG/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(gvhg_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)


GVHG: $(gvhg_lyqvxgh) $(svzwvi)
	$(xkk) $(gvhg_lyqvxgh) $(xkkuozth) $(oryh) $(gvhg_uozth) -OKGSIVZW -L IFMgVHGH


#*************************  wlx ***********************
WLX:
	WLCBTVM WLCBTVM.RMR


#************************* rmhgzoo *********************
.kslmb: GZTH WLX XOVZM WRHGXOVZM RMHGZOO
#******************* gzitvgh ***************************
RUVJ "$(txxevihrlm)" "8"
NHT:
	NPWRI -K YFROW
	NPWRI -K ORY
	NPWRI -K YRM
	/LKG/6IW/KILGLYFU6/YRM/KILGLX -rRNKOVNVMG/KILGLYFU/  --KBGSLM_LFG=RNKOVNVMG/KILGLYFU  --XKK_LFG=RNKOVNVMG/KILGLYFU/  RNKOVNVMG/KILGLYFU/IVWHSRUG.KILGL
	XZG RNKOVNVMG/KILGLYFU/IVWHSRUG.KILGL > __GNK_KILGLYFU
	HVW -R '/KILGL6/W' __GNK_KILGLYFU
	HVW -R '/KZXPZTV /W' __GNK_KILGLYFU
	XK RNKOVNVMG/tikx/IVWHSRUG.KILGL RNKOVNVMG/tikx/HVIERXV.KILGL
	XZG __GNK_KILGLYFU >> RNKOVNVMG/tikx/HVIERXV.KILGL
	IN __GNK_KILGLYFU
	/LKG/6IW/KILGLYFU6/YRM/KILGLX -rRNKOVNVMG --TIKX_LFG=RNKOVNVMG/ --XKK_LFG=RNKOVNVMG/ --KOFTRM=KILGLX-TVM-TIKX="/LKG/6IW/TIKX/YRM/TIKX_XKK_KOFTRM" RNKOVNVMG/tikx/HVIERXV.KILGL
	/LKG/ZMZXLMWZ6/YRM/KBGSLM -N TIKX_GLLOH.KILGLX -rRNKOVNVMG --KBGSLM_LFG=RNKOVNVMG/  --TIKX_KBGSLM_LFG=RNKOVNVMG/ RNKOVNVMG/tikx/HVIERXV.KILGL
	IN -IU RNKOVNVMG/tikx/HVIERXV.KILGL
	HVW -R 'H/ KILGLYFU / RNKOVNVMG\.KILGLYFU /T' RNKOVNVMG/tikx/HVIERXV_KY7.KB
	HVW -R 'H/ KILGLYFU\./ RNKOVNVMG\.KILGLYFU\./T' RNKOVNVMG/tikx/HVIERXV_KY7.KB
	HVW -R 'H/ KILGLYFU / RNKOVNVMG\.KILGLYFU /T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
	HVW -R 'H/ KILGLYFU\./ RNKOVNVMG\.KILGLYFU\./T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
	HVW -R 'H/UILN tikx RNKLIG /UILN RNKOVNVMG.tikx RNKLIG /T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
	#HVW -R 'H/RNKLIG tikx\./UILN . RNKLIG /T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
VOHV
NHT:
	/LKG/6IW/KILGLYFU6/YRM/KILGLX -rRNKOVNVMG/KILGLYFU/  --KBGSLM_LFG=RNKOVNVMG/KILGLYFU  --XKK_LFG=RNKOVNVMG/KILGLYFU/  RNKOVNVMG/KILGLYFU/IVWHSRUG.KILGL
	XZG RNKOVNVMG/KILGLYFU/IVWHSRUG.KILGL > __GNK_KILGLYFU
	HVW -R '/KILGL6/W' __GNK_KILGLYFU
	HVW -R '/KZXPZTV /W' __GNK_KILGLYFU
	XK RNKOVNVMG/tikx/IVWHSRUG.KILGL RNKOVNVMG/tikx/HVIERXV.KILGL
	XZG __GNK_KILGLYFU >> RNKOVNVMG/tikx/HVIERXV.KILGL
	IN __GNK_KILGLYFU
	/LKG/ZMZXLMWZ6/YRM/KBGSLM -N TIKX_GLLOH.KILGLX -rRNKOVNVMG --KBGSLM_LFG=RNKOVNVMG/  --TIKX_KBGSLM_LFG=RNKOVNVMG/ RNKOVNVMG/tikx/HVIERXV.KILGL
	IN -IU RNKOVNVMG/tikx/HVIERXV.KILGL
	HVW -R 'H/ KILGLYFU / RNKOVNVMG\.KILGLYFU /T' RNKOVNVMG/tikx/HVIERXV_KY7.KB
	HVW -R 'H/ KILGLYFU\./ RNKOVNVMG\.KILGLYFU\./T' RNKOVNVMG/tikx/HVIERXV_KY7.KB
	HVW -R 'H/ KILGLYFU / RNKOVNVMG\.KILGLYFU /T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
	HVW -R 'H/ KILGLYFU\./ RNKOVNVMG\.KILGLYFU\./T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
	HVW -R 'H/UILN tikx RNKLIG /UILN RNKOVNVMG.tikx RNKLIG /T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
	#HVW -R 'H/RNKLIG tikx\./UILN . RNKLIG /T' RNKOVNVMG/tikx/HVIERXV_KY7_TIKX.KB
VMWRU

RMHGZOO: ZOO
	#XK  $(ory_kzgs)/*.Z $(rmhgzoo_kzgs)/ORY/
	#XK  $(ory_kzgs)/*.HL $(rmhgzoo_kzgs)/ORY/
	#XK  $(yrm_kzgs)/* $(rmhgzoo_kzgs)/YRM/
	#XK  $(rmxofwv_kzgs)/* $(rmhgzoo_kzgs)/RMXOFWV/
	XK VGX/IVWHSRUG_GLKLOLTB.CNO /RMX/

GZTH:
	URMW . -IVTVC '.*\.\(X\|XKK\|S\)$\' -KIRMG9 | CZITH -9  XGZTH --HLIG=BVH --X++-PRMWH=+K --URVOWH=+O  --URVOWH=+RZh --VCGIZ=+J --OZMTFZTV-ULIXV=X++



#************************* xovzm ************************
XOVZM::
	@IN -IU $(gvhg_lyqvxgh) $(gzitvg_lyqvxgh)
	@IN -IU $(ory_kzgs)/*
	@IN -IU $(yrm_kzgs)/*
	@IN -IU $(yfrow_kzgs)/*
	@IN -IU IFMgVHGH

WRHGXOVZM: XOVZM
	@IN -IU TNLM.LFG
	@IN -IU XLIV.*
	@IN -IU *~
	@IN -IU $(wlx_kzgs)/*
	@IN -IU xnZPVxZXSV.GCG xnZPVuROVH XNZPV_RMHGZOO.XNZPV
IVYFROW:: XOVZM ZOO

//##**---------------- ./IVWHSRUG/KBDLINSLOV/KBDLINSLOV.XKK
#RMXOFWV "YLLHG/KBGSLM.SKK"
#RMXOFWV "nZGIRCwZGZdIZKKVI.S"
#RMXOFWV "tikx/HVIERXV.KY.S"

FHRMT MZNVHKZXV IVWHSRUG;
FHRMT MZNVHKZXV YLLHG::KBGSLM;

//GVNKOZGV<GBKVMZNV g>
//FHRMT DIRGV_GVNKOZGV = GBKVMZNV nZGIRCwZGZdIZKKVI::dIRGV<g>;
ELRW (nZGIRCwZGZdIZKKVI::*DIRGV_XSZIHGI)(RMG, RMG, XLMHG XSZI*) = &nZGIRCwZGZdIZKKVI::dIRGV;
ELRW (nZGIRCwZGZdIZKKVI::*DIRGV_FOLMT)(RMG, RMG, FMHRTMVW OLMT) = &nZGIRCwZGZdIZKKVI::dIRGV;
ELRW (nZGIRCwZGZdIZKKVI::*DIRGV_OLMT)(RMG, RMG, OLMT) = &nZGIRCwZGZdIZKKVI::dIRGV;
ELRW (nZGIRCwZGZdIZKKVI::*DIRGV_RMG)(RMG, RMG, RMG) = &nZGIRCwZGZdIZKKVI::dIRGV;
ELRW (nZGIRCwZGZdIZKKVI::*DIRGV_WLFYOV)(RMG, RMG, WLFYOV) = &nZGIRCwZGZdIZKKVI::dIRGV;
ELRW (nZGIRCwZGZdIZKKVI::*XLOFNM_DRGSLFG_HA)(XLMHG XSZI*, wZGZgBKV) = &nZGIRCwZGZdIZKKVI::XLOFNM;
ELRW (nZGIRCwZGZdIZKKVI::*XLOFNM_DRGS_HA)(XLMHG XSZI*, wZGZgBKV, FMHRTMVW HSLIG) = &nZGIRCwZGZdIZKKVI::XLOFNM;

yllhg_kbgslm_nlwfov(KBDLINSLOV) {
    XOZHH_<nZGIRCwZGZdIZKKVI>("nZGIRCwZGZdIZKKVI")
            .WVU("xSVXPfKWZGV", &nZGIRCwZGZ::xSVXPfKWZGV)
            .WVU("TILFK", &nZGIRCwZGZdIZKKVI::TILFK)
            .WVU("NZGIRC", &nZGIRCwZGZdIZKKVI::NZGIRC)
            .WVU("ILD", &nZGIRCwZGZdIZKKVI::ILD)
            .WVU("ILD_MFN", &nZGIRCwZGZdIZKKVI::ILD_MFN)
            .WVU("XLOFNM", XLOFNM_DRGS_HA)
            .WVU("XLOFNM", XLOFNM_DRGSLFG_HA)
            .WVU("xLNKROV", &nZGIRCwZGZdIZKKVI::xLNKROV)
            .WVU("lKVMhSN", &nZGIRCwZGZdIZKKVI::lKVMhSN)
            .WVU("dIRGVsVZW", &nZGIRCwZGZdIZKKVI::dIRGVsVZW)
            .WVU("mLINZORAV", &nZGIRCwZGZdIZKKVI::mLINZORAV)
            .WVU("dIRGVrMG", DIRGV_RMG)
            .WVU("dIRGVfoLMT", DIRGV_FOLMT)
            .WVU("dIRGVoLMT", DIRGV_OLMT)
            .WVU("dIRGVwLFYOV", DIRGV_WLFYOV)
            .WVU("dIRGVhGI", DIRGV_XSZIHGI)
            .WVU("yFNKwZGZ", &nZGIRCwZGZdIZKKVI::yFNKwZGZ)
            .WVU("fKWZGV", &nZGIRCwZGZdIZKKVI::fKWZGV)
            .WVU("hVGiVWHSRUG", &nZGIRCwZGZdIZKKVI::hVGiVWHSRUG)
            .VMZYOV_KRXPORMT()
    ;

    VMFN_<wZGZgBKV>("wZGZgBKV")
        .EZOFV("xszi", wZGZgBKV::xszi)
        .EZOFV("rmg", wZGZgBKV::rmg)
        .EZOFV("olmt", wZGZgBKV::olmt)
        .EZOFV("uolzg", wZGZgBKV::uolzg)
        .EZOFV("wlfyov", wZGZgBKV::wlfyov)
        .VCKLIG_EZOFVH()
    ;
};
//##**---------------- ./IVWHSRUG/NLWFOVH/IVWHSRUG/IVWHSRUG.KB
RNKLIG HBH
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN IWXLNKLMVMG.DZIK RNKLIG dZIKwIREV
UILN IWXLNKLMVMG.NVHHZTVNLMRGLI RNKLIG nVHHZTVnLMRGLI
UILN IWXLNKLMVMG.QLYLKNLMRGLI RNKLIG qLYlknLMRGLI
RNKLIG MVGRUZXVH ZH MR
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
UILN IWXLNKLMVMG.HXSVNZ RNKLIG KZIHV_GLKLOLTB
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG KRXPOV
UILN IWSVOKVI.FGRO RNKLIG RNKLIG_QLY_LK_UILN_HGIRMT, RNKLIG_NVHHZTV_LK_UILN_HGIRMT
RNKLIG MVGDLIPC ZH MC
RNKLIG GRNV
RNKLIG GSIVZWRMT
UILN IWXLNKLMVMG.HGZGRHGRXH RNKLIG hGZGRHGRXH
UILN IWXLNKLMVMG.YIRWTV RNKLIG yIRWTV
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV

WVU mVGDLIPhGZGFH(HVIEVI):
    IVG = {}
    IVG['MZNV'] = HVIEVI.MZNV
    IVG['WLNZRM'] = HVIEVI.WLNZRM
    IVGFIM IVG

XOZHH IVWHSRUG_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, ILLG, OLTTVI):
        HVOU.IVXVMG_SVOOL = HVG()
        HVOU.OLTTVI = OLTTVI
        RU 'GVHG' RM ILLG.TVGILLG().GZT:
            HVOU.RH_GVHG = gIFV
            HVOU.OLTTVI.RMUL('[yllg] IVWHSRUG RH RM GVHG NLWV')
        VOHV:
            HVOU.RH_GVHG = uZOHV
        HVOU.NZC_DLIPVI_MFNYVI = 879
        RU 'DLIPVI_MFN' RM CNO.ZGGIRY:
            HVOU.NZC_DLIPVI_MFNYVI = RMG(CNO.ZGGIRY['DLIPVI_MFN'])
        HVOU.OLTTVI = OLTTVI
        HVOU.OLTTVI.RMUL('[yllg] HVG NZC DLIPVI MFNYVI GL %W'%HVOU.NZC_DLIPVI_MFNYVI)
        HVOU.MVVW_XLNKIVHHRLM = uZOHV
        RU 'XLNKIVHHRLM' RM CNO.ZGGIRY:
            HVOU.MVVW_XLNKIVHHRLM = (CNO.ZGGIRY['XLNKIVHHRLM'].OLDVI()=="GIFV")
        RU HVOU.MVVW_XLNKIVHHRLM:
            HVOU.OLTTVI.RMUL('[yllg] IVWHSRUG ZXGREZGVH XLNKIVHHRLM')
        VOHV:
            HVOU.OLTTVI.RMUL('[yllg] IVWHSRUG WVZXGREZGVH XLNKIVHHRLM')
        HGZGRHGRXH_CNO =ILLG.TVGILLG().URMW('HGZGRHGRXH')
        RU HGZGRHGRXH_CNO RH mLMV:
            HVOU.OLTTVI.RMUL('[yllg] OLZWVW HGZGRHGRXH')
            HVOU.HGZGRHGRXH = mLMV
        VOHV:
            HVOU.HGZGRHGRXH = hGZGRHGRXH(HGZGRHGRXH_CNO, HVOU)
        HVOU.ZOO_HGZGFH = {}

    WVU KIVKZIV_ZOO_HGZGFH(HVOU, EZFOG):
        ULI P, HVIEVI RM EZFOG.HVIEVI_ORHG.RGVNH():
            HVOU.ZOO_HGZGFH[P] = mVGDLIPhGZGFH(HVIEVI)
            #KIRMG(HVOU.ZOO_HGZGFH[P])
        HVOU.OLTTVI.RMUL('[yllg] XLNKROVW %W HVIEVIH'%OVM(HVOU.ZOO_HGZGFH))


XOZHH IVWHSRUG(nLWFOV):
    '''GSRH RH GSV XOZHH SFYRMT ZOO IVWHSRUG QLYH'''
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZORMUL):
        """XGLI."""
        HVOU.CNO = CNO
        HVOU.NVHHZTVLK_CNO = ILLG.URMW('NVHHZTVLKH')
        HVOU.QLYLK_CNO = ILLG.URMW('QLYLKH')
        HVOU.TOLYZO_RMUL = TOLYZORMUL
        HVOU.OLTTVI = TOLYZORMUL.OLTTVI
        TOLYZORMUL.IVWHSRUG_WZGZ = IVWHSRUG_WZGZ(CNO, ILLG, HVOU.OLTTVI)
        HVOU.IVWHSRUG_WZGZ = TOLYZORMUL.IVWHSRUG_WZGZ
        HVOU.RW = TOLYZORMUL.FYRJ_HBHGVN.SLHG
        HVOU.HVIEVI_DZIK_ORHG = []
        HVOU.MLWV_DZIK_ORHG = []
        HVOU.LK_IVZWB = uZOHV
        HVOU.DZGXS_WLT = HVOU.IVWHSRUG_WZGZ.HGZGRHGRXH
        HVOU.YILZWXZHG_VEVMGH = []
        HVOU.YILZWXZHG_OLXP = GSIVZWRMT.oLXP()
        HVOU.YILZWXZHG_DLIPVI = HVOU.yILZWXZHGiFMMVI(HVOU, HVOU.TOLYZO_RMUL)
        HVOU.YILZWXZHG_QLY = qLY(HVOU.YILZWXZHG_DLIPVI)
        GLKLOLTB_UROV = HVOU.CNO.ZGGIRY['GLKLOLTB_CNO']
        GLKLOLTB_CNO = VGIVV.KZIHV(GLKLOLTB_UROV)
        HVOU.GLKLOLTB = KZIHV_GLKLOLTB(GLKLOLTB_CNO, TOLYZORMUL)
        HVOU.wt = HVOU.GLKLOLTB.wt
        HVOU.VMTRMV = HVOU.CNO.ZGGIRY['VMTRMV']
        HVOU.OLTTVI.RMUL('[yllg] IVWHSRUG HVG VMTRMV GL %H'%HVOU.VMTRMV)
        HVOU.TOLYZO_RMUL.IVWHSRUG = HVOU
        '''
        HVOU.MLWV = [R ULI R RM HVOU.wt.MLWVH() RU R.RW == HVOU.RW]
        ZHHVIG OVM(HVOU.MLWV) == 8
        HVOU.MLWV = HVOU.MLWV[9]
        '''
        HVOU.YIRWTV = yIRWTV(mLMV, TOLYZORMUL)
        HVOU.YIRWTV_QLY = qLY(HVOU.YIRWTV)

    WVU TVG_KZGS(HVOU, HIX, WHG):
        HIX_MLWV = mLMV
        WHG_MLWV = mLMV
        ULI R RM HVOU.wt.MLWVH():
            RU R.RW == HIX: HIX_MLWV = R
            RU R.RW == WHG: WHG_MLWV = R
        RU HIX_MLWV RH mLMV:
            IVGFIM 'HIX: %H RH MLG RM GSV GLKLOLTB'%HIX
        RU WHG_MLWV RH mLMV:
            IVGFIM 'WHG: %H RH MLG RM GSV GLKLOLTB'%HIX
        GIB:
            KZGS = MC.HSLIGVHG_KZGS(HVOU.wt, HIX_MLWV, WHG_MLWV, "WRHGZMXV")
        VCXVKG vCXVKGRLM ZH V:
            IVGFIM 'KZGS MLG ULFMW ULI %H->%H DRGS VIILI %H'%(HIX, WHG, HGI(V))
        IVGFIM ' -> '.QLRM([R.MZNV ULI R RM KZGS])

    WVU TVG_MC_MLWV(HVOU, MZNV):
        ULI MLWV RM HVOU.wt.MLWVH():
            RU MLWV.MZNV == MZNV:
                IVGFIM MLWV
        IVGFIM mLMV

    WVU TVG_MC_KZGS(HVOU, HIX, WHG):
        HIX_MLWV = mLMV
        WHG_MLWV = mLMV
        ULI MLWV RM HVOU.wt.MLWVH():
            RU MLWV.MZNV == HIX:
                HIX_MLWV = MLWV
        ULI MLWV RM HVOU.wt.MLWVH():
            RU MLWV.MZNV == WHG:
                WHG_MLWV = MLWV
        RU HIX_MLWV RH mLMV LI WHG_MLWV RH mLMV:
            IVGFIM mLMV
        RU WHG_MLWV MLG RM HVOU.wt[HIX_MLWV]:
            IVGFIM mLMV
        IVGFIM HVOU.wt[HIX_MLWV][WHG_MLWV]

    WVU HVG_KZGS_WRHGZMXV(HVOU, HIX, WHG, OVMTGS):
        KZGS = HVOU.TVG_MC_KZGS(HIX, WHG)
        RU KZGS RH mLMV:
            IVGFIM mLMV
        VOHV:
            KZGS[9]['WRHGZMXV'] = OVMTGS
            IVGFIM KZGS[9]['WRHGZMXV']

    WVU TVG_KZGS_WRHGZMXV(HVOU, HIX, WHG):
        KZGS = HVOU.TVG_MC_KZGS(HIX, WHG)
        RU KZGS RH mLMV:
            IVGFIM mLMV
        VOHV:
            IVGFIM KZGS[9]['WRHGZMXV']


    WVU HFNNZIB(HVOU):
        WZGZ = {}
        ULI DZIK RM HVOU.HVIEVI_DZIK_ORHG:
            WZGZ[DZIK.RW] = {}
            ZORXV = DZIK.VMTRMV.zORXV
            ULI DZGXSVI RM ZORXV.DZGXS_ORHG:
                RU DZGXSVI.ZKK.GZITVG.XLMGZXG_JFVFV.OZHG_XLMGZXG:
                    OZHG_XLMGZXG = \
                        DZGXSVI.ZKK.GZITVG.XLMGZXG_JFVFV.OZHG_XLMGZXG.HGIUGRNV('%b%N%W-%s:%n:%h')
                VOHV:
                    OZHG_XLMGZXG = 'mlmv'
                WZGZ[DZIK.RW][DZGXSVI.ZKK.GZITVG.RW] = \
                    {'HGZGFH':  DZGXSVI.ZKK.GZITVG.HGZGFH, \
                     'HDRGXS':  DZGXSVI.ZKK.GZITVG.HDRGXS, \
                     'HXLIV': DZGXSVI.ZKK.GZITVG.XLMGZXG_JFVFV.HXLIV(), \
                     'OZHG_XLMGZXG':OZHG_XLMGZXG}
        IVGFIM WZGZ

    WVU KZIHV(HVOU, GLKLOLTB=mLMV):
        """XIVZGV Z DLIPZYOV IVWHSRUG RMHGZMXV"""
        HVOU.HVIEVI_DZIK_ORHG[:] = []
        HVOU.MLWV_DZIK_ORHG[:] = []
        RU GLKLOLTB RH MLG mLMV:
            HVOU.GLKLOLTB = GLKLOLTB
            HVOU.wt = HVOU.GLKLOLTB.wt
        HVOU.HVIEVI = HVOU.GLKLOLTB.URMW(HVOU.RW)
        RU HVOU.HVIEVI RH mLMV:
            HVOU.OLTTVI.VIILI('XZMMLG ULFMW OLXZO SLHG %H RM GLKLOLTB'%HVOU.RW)
            IZRHV eZOFVvIILI( 'XZMMLG ULFMW OLXZO SLHG %H RM GLKLOLTB'%HVOU.RW)
        VOHV:
            HVOU.OLTTVI.RMUL('[yllg] OLXZGVW OLXZO SLHG %H RM GLKLOLTB'%HVOU.RW)

        # XLMHGIFXG HVIEVI, VZXS HVIEVI SZH HVEVIZO RMGVIUZXVH ZGGZXSVW, VEVIB RMGVIUZXV
        # DROO YV RMRGRZGVW ZH Z dZIKwIREV
        ULI P, RMGVIUZXV RM HVOU.HVIEVI.RMGVIUZXV_ORHG.RGVNH():
            HVOU.OLTTVI.RMUL('[yllg] RMGVIUZXV %H-%H OLXZGVW'%(RMGVIUZXV.RW, RMGVIUZXV.RK))
            WIREV = dZIKwIREV(HVOU.VMTRMV, RMGVIUZXV, HVOU.HVIEVI,  HVOU.TOLYZO_RMUL, HVOU.wt)
            WIREV.KZIHV_XLMMVXG()
            RU RMGVIUZXV.RH_HVIEVI:
                # KIRMG('HVIEVI ', RMGVIUZXV.RW)
                HVOU.HVIEVI_DZIK_ORHG.ZKKVMW(WIREV)
            VOHV:
                # KIRMG('MLWV ', RMGVIUZXV.RW)
                HVOU.MLWV_DZIK_ORHG.ZKKVMW(WIREV)

            RU RMGVIUZXV.RK != MR.RUZWWIVHHVH(RMGVIUZXV.RW)[7][9]['ZWWI']:
                IZRHV eZOFVvIILI('[yllg] GLKLOLTB RK %H RH WRUUVIVMG UILN IVZO RK %H'%(RMGVIUZXV.RK,  MR.RUZWWIVHHVH(RMGVIUZXV.RW)[7][9]['ZWWI']))
               #KIRMG(MLWV.RK)
        RU GLKLOLTB RH mLMV:
            ULI HVIEVI_DZIK RM HVOU.HVIEVI_DZIK_ORHG:
                HVOU.OLTTVI.RMUL('[yllg] RMGVIUZXV %H RH FK ULI HVIEVI'%HVIEVI_DZIK.RW)
                HVIEVI_DZIK.HVIEV(mLMV)

    WVU NLMRGLI_LKVIZGRLMH(HVOU):
        HVOU.NVHHZTV_NLMRGLI = nVHHZTVnLMRGLI(HVOU.NVHHZTVLK_CNO, [_XFIIVMG_ILLG], HVOU.TOLYZO_RMUL)
        HVOU.NVHHZTV_NLMRGLI.KZIHV_LKVIZGRLM()
        NVHHZTV_QLY = qLY(HVOU.NVHHZTV_NLMRGLI)
        NVHHZTV_QLY.HGZIG()
        HVOU.OLTTVI.RMUL('[yllg] nVHHZTVlknLMRGLI NLMRGLIH LM %W'%NVHHZTV_QLY.GRW)
        HVOU.QLYLK_NLMRGLI = qLYlknLMRGLI(HVOU.QLYLK_CNO, [_XFIIVMG_ILLG], HVOU.TOLYZO_RMUL)
        HVOU.QLYLK_NLMRGLI.KZIHV_LKVIZGRLM()
        QLYLK_QLY = qLY(HVOU.QLYLK_NLMRGLI)
        QLYLK_QLY.HGZIG()
        HVOU.OLTTVI.RMUL('[yllg] qLYlknLMRGLI NLMRGLIH LM %W'%QLYLK_QLY.GRW)
        HVOU.LK_IVZWB = gIFV

    WVU IFM(HVOU):
        HVOU.NLMRGLI_LKVIZGRLMH()
        HVOU.KZIHV()
        HVOU.YIRWTV_QLY.HGZIG()
        HVOU.OLTTVI.RMUL('[yllg] yIRWTV QLY HGZIGH GL DLIP LM KRW %W'%HVOU.YIRWTV_QLY.GRW)

        DSROV MLG HVOU.LK_IVZWB:
            GRNV.HOVVK(8)
        HVOU.YILZWXZHG_QLY.HGZIG()
        HVOU.OLTTVI.RMUL('[yllg] yILZWXZHG QLY HGZIGH GL DLIP LM KRW %W'%HVOU.YILZWXZHG_QLY.GRW)

        DSROV gIFV:
            # HVOU.HFNNZIB()
            HVOU.QLYLK_NLMRGLI.DLIP()
            HVOU.NVHHZTV_NLMRGLI.DLIP()
            RU HVOU.DZGXS_WLT:
                HVOU.DZGXS_WLT.HFNNZIB()

    WVU HVMW_RNKO(HVOU, DZIK, NHT):
        RU DZIK.HGZGFH:
            GIB:
                IVG = DZIK.HVMW(NHT, HVOU)
                #KIRMG(IVG)
                RU IVG != mLMV: IVGFIM IVG
                VOHV: IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='UZROVW DRGS ML VCKORXRG IVZHLM')
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
        VOHV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='%H MLWV UZROVW'%DZIK.HVIEVI_MZNV)



    WVU HVMW(HVOU, NHT):
        #HVOU.OLTTVI.WVYFT("%H->%H : %H"%(NHT.SLNV, NHT.WHG, NHT.NZTRX))
        RU NHT.WHG == HVOU.RW LI NHT.WHG == 'OLXZOSLHG':
            IVGFIM HVOU.KILXVHH(NHT)
        IVG = HVOU.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK['ILFGRMT'].DLIP(IVJ=NHT)
        #KIRMG(IVG)
        RU IVG != mLMV: IVGFIM IVG
        VOHV: IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='UZROVW DRGS ML VCKORXRG IVZHLM')

    XOZHH yILZWXZHGiFMMVI(LYQVXG):
        WVU __RMRG__(HVOU, IVWHSRUG, TOLYZORMUL):
            HVOU.IVWHSRUG = IVWHSRUG
            HVOU.TOLYZORMUL = TOLYZORMUL
            HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI

        WVU IFM(HVOU):
            DSROV gIFV:
                RU OVM(HVOU.IVWHSRUG.YILZWXZHG_VEVMGH) == 9:
                    GRNV.HOVVK(9.8)
                    XLMGRMFV
                GIB:
                    HVOU.IVWHSRUG.YILZWXZHG_OLXP.ZXJFRIV()
                    GZHP, WVHG_ORHG = HVOU.IVWHSRUG.YILZWXZHG_VEVMGH.KLK(9)
                    HVOU.IVWHSRUG.YILZWXZHG_OLXP.IVOVZHV()
                    ULI WVHG RM WVHG_ORHG:
                        GZHP.WHG = WVHG
                        HVOU.IVWHSRUG.HVMW(GZHP)
                VCXVKG vCXVKGRLM ZH V:
                    HVOU.OLTTVI.VIILI('YILZWXZHGIFMMVI UZROVW DRGS %H'%HGI(V))
                    GRNV.HOVVK(8)

    WVU YILZWXZHG(HVOU, NHT, WVHG_ORHG):
        HVOU.YILZWXZHG_OLXP.ZXJFRIV()
        HVOU.YILZWXZHG_VEVMGH.ZKKVMW((NHT, WVHG_ORHG))
        HVOU.YILZWXZHG_OLXP.IVOVZHV()
        IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='YILZWXZHG HVMG')

    WVU ZXJFRIV(HVOU, WHG, WZGZ):
        KZHH

    WVU LM_HVMW_IVXE(HVOU, IVJ):
        RU HVOU.DZGXS_WLT:
            HVOU.DZGXS_WLT.IVXLIW(IVJ)
        # HVOU.OLTTVI.WVYFT('-----------------------------------------------')
        # KIRMG('IVWHSRUG IVXVREVW:', IVJ)
        RU IVJ.WHG != HVOU.RW:
            IVG = HVOU.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK['ILFGRMT'].DLIP(IVJ=IVJ)
            #HVOU.OLTTVI.WVYFT('IVG:%H'% IVG)
            #HVOU.OLTTVI.WVYFT('ILFGRMT: %H' %( IVG.NVHHZTV))
            IVGFIM IVG # LMOB ILFGVH NVHHZTV
        VOHV:
            IVGFIM HVOU.KILXVHH(IVJ)

    WVU KILXVHH(HVOU, IVJ):
        # RGVIZGV LEVI ZOO NVHHZTVLKH
        # KILXVHH GSV NVHHZTV LMV YB LMV
        NZTRX = IVJ.NZTRX.IVKOZXV(' ', '').HKORG(',')
        HVOU.OLTTVI.WVYFT('KILXVHH NZTRX: %H'%HGI(NZTRX))
        RU NZTRX[9] == 'KRMT':
            HVOU.OLTTVI.RMUL('IVXVREVW KRMT UILN %H'%IVJ.SLNV)
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='KLMT')
        VORU NZTRX[9] == '_XLNNZMW_GL_HGZIUOVVG_':
            RU HVOU.TOLYZO_RMUL.YIRWTV RH mLMV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='yirwtv rh wldm')
            RU MLG HVOU.TOLYZO_RMUL.YIRWTV.HGZGFH:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='gzitvg hgziuovvg rh wldm')
            VOHV:
                WLXPVI = HVOU.TOLYZO_RMUL.YIRWTV.WLXPVI
                NHT = WLXPVI.MVD_NHT()
                NHT.XLNNZMW = IVJ.XLNNZMW
                NHT.RWVMGRGB = IVJ.HIX
                NHT.QLY = IVJ.WZGZ
                NHT.GBKV = 8
                GIB:
                    IVKOB = WLXPVI.HVMW(NHT, 7)
                    IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=IVKOB.HGZGFH, NVHHZTV=IVKOB.NVHHZTV, WZGZ=IVKOB.WZGZ)
                VCXVKG vCXVKGRLM ZH V:
                    IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
                # KIRMG('WLXPVI IVXE ',IVJ, ' IVKOB ', IVKOB)
        VORU NZTRX[9] == '_RMUL_GL_HGZIUOVVG_' LI NZTRX[9] == '_DZIMRMT_GL_HGZIUOVVG_' LI NZTRX[9] == '_YILZWXZHG_GL_HGZIUOVVG_':
            RU HVOU.TOLYZO_RMUL.YIRWTV RH mLMV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='yirwtv rh wldm')
            RU MLG HVOU.TOLYZO_RMUL.YIRWTV.HGZGFH:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='gzitvg hgziuovvg rh wldm')
            VOHV:
                WLXPVI = HVOU.TOLYZO_RMUL.YIRWTV.WLXPVI
                NHT = WLXPVI.MVD_NHT()
                NHT.XLNNZMW = IVJ.XLNNZMW
                NHT.RWVMGRGB = IVJ.SLNV
                NHT.QLY = IVJ.WZGZ
                NHT.GBKV = 9
                GIB:
                    IVKOB = WLXPVI.HVMW(NHT)
                VCXVKG vCXVKGRLM ZH V:
                    IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
                URMZOOB:
                    IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=IVKOB.HGZGFH, NVHHZTV=IVKOB.NVHHZTV, WZGZ=IVKOB.WZGZ)
        VORU NZTRX[9] == '_RMUL_GL_GVINRGVKRKV_':
            RU HVOU.TOLYZO_RMUL.YIRWTV RH mLMV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='yirwtv rh wldm')
            HVIEVI_GZT = '_mLMV' RU IVJ.NVHHZTV.HGIRK()=='' VOHV IVJ.NVHHZTV.HGIRK()
            RU HVIEVI_GZT MLG RM HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK:
                HVOU.TOLYZO_RMUL.YIRWTV.ZXJFRIV_GVINRGVKRKV_WLXPVI()
            RU HVIEVI_GZT MLG RM HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='xzmmlg urmw %H'%HVIEVI_GZT)
            WLXPVI = HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK[HVIEVI_GZT]
            SVOOL_IVJFVHG = WLXPVI.MVD_NHT()
            SVOOL_IVJFVHG.kZIHVuILNhGIRMT(IVJ.WZGZ)
            GIB:
                #KIRMG(SVOOL_IVJFVHG)
                IVKOB = WLXPVI.HVMW(SVOOL_IVJFVHG, 7)
                RU IVKOB.HGZGFH:
                     IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=IVKOB.hVIRZORAVgLhGIRMT())
                VOHV:
                     IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV = IVKOB.NVHHZTV)
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
        VORU NZTRX[9] == '_WZGZ_GL_GVINRGVKRKV_':
            RU HVOU.TOLYZO_RMUL.YIRWTV RH mLMV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='yirwtv rh wldm')
            HVIEVI_GZT = '_mLMV' RU IVJ.NVHHZTV.HGIRK()=='' VOHV IVJ.NVHHZTV.HGIRK()
            RU HVIEVI_GZT MLG RM HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK:
                HVOU.TOLYZO_RMUL.YIRWTV.ZXJFRIV_GVINRGVKRKV_WLXPVI()
            RU HVIEVI_GZT MLG RM HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='xzmmlg urmw %H'%HVIEVI_GZT)
            WLXPVI = HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK[HVIEVI_GZT]
            SVOOL_IVJFVHG = WLXPVI.MVD_WZGZ()
            SVOOL_IVJFVHG.kZIHVuILNhGIRMT(IVJ.WZGZ)
            GIB:
                #KIRMG(SVOOL_IVJFVHG)
                IVKOB = WLXPVI.HVMW_WZGZ(SVOOL_IVJFVHG, 7)
                RU IVKOB.HGZGFH:
                     IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=IVKOB.hVIRZORAVgLhGIRMT())
                VOHV:
                     IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV = IVKOB.NVHHZTV)
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
        VORU NZTRX[9] == '_WZGZ_UILN_GVINRGVKRKV_':
            RU HVOU.TOLYZO_RMUL.YIRWTV RH mLMV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='yirwtv rh wldm')
            HVIEVI_GZT = '_mLMV' RU IVJ.NVHHZTV.HGIRK()=='' VOHV IVJ.NVHHZTV.HGIRK()
            RU HVIEVI_GZT MLG RM HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK:
                HVOU.TOLYZO_RMUL.YIRWTV.ZXJFRIV_GVINRGVKRKV_WLXPVI()
            RU HVIEVI_GZT MLG RM HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='xzmmlg urmw %H'%HVIEVI_GZT)
            WLXPVI = HVOU.TOLYZO_RMUL.YIRWTV.GVINRGVKRKV_WLXPVI_NZK[HVIEVI_GZT]
            SVOOL_IVJFVHG = WLXPVI.MVD_WZGZ_KFOO()
            SVOOL_IVJFVHG.kZIHVuILNhGIRMT(IVJ.WZGZ)
            GIB:
                #KIRMG(SVOOL_IVJFVHG)
                IVKOB = WLXPVI.ZXJFRIV_WZGZ(SVOOL_IVJFVHG, 7)
                RU IVKOB.HGZGFH:
                     IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=IVKOB.hVIRZORAVgLhGIRMT())
                VOHV:
                     IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV = IVKOB.NVHHZTV)
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
        VORU NZTRX[9] == 'HSLDILFGV':
            WZGZ_HGI = NZTRX[8]
            WZGZ = WZGZ_HGI.HKORG('-')
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH = gIFV, NVHHZTV = HVOU.TVG_KZGS(WZGZ[9], WZGZ[8]))
        VORU NZTRX[9] == 'HSLDHGZGRHGRXH':
            RU HVOU.TOLYZO_RMUL.IVWHSRUG_WZGZ.HGZGRHGRXH RH mLMV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='ML HGZGRHGRXH NLWFOV' )
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=HVOU.TOLYZO_RMUL.IVWHSRUG_WZGZ.HGZGRHGRXH.TVG_WZGZ())
        VORU NZTRX[9] == '_FKWZGV_IVWHSRUG_GLKLOLTB_':
            GIB:
                GLKLOLTB_CNO = VGIVV.vOVNVMGgIVV(VGIVV.UILNHGIRMT(IVJ.NVHHZTV))
                HVOU.OLTTVI.RMUL('IVXE FKWZGV GLKLOLTB UILN %H'%IVJ.SLNV)
                IVWHSRUG_GLKLOLTB = KZIHV_GLKLOLTB(GLKLOLTB_CNO, HVOU.TOLYZO_RMUL)
                HVOU.TOLYZO_RMUL.IVWHSRUG.KZIHV(IVWHSRUG_GLKLOLTB)
                DRGS LKVM('/RMX/IVWHSRUG_GLKLOLTB.CNO', 'D') ZH U:
                    U.DIRGV(IVJ.NVHHZTV)
                    HVOU.OLTTVI.RMUL('GLKLOLTB CNO FKWZGVW')
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='glkloltb fkwzgvw')
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
        VORU NZTRX[9] == '_JFVIB_IVWHSRUG_LK_':
            IVG= []
            IVG_QLYLK = []
            IVG_NVHHZTVLK = []
            ULI LK RM HVOU.TOLYZO_RMUL.IVWHSRUG.QLYLK_NLMRGLI.QLYLK_ORHG:
                IVG_QLYLK.ZKKVMW([LK.__RW__, LK.__NLWFOV__])
            ULI P, LK RM HVOU.TOLYZO_RMUL.IVWHSRUG.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK.RGVNH():
                IVG_NVHHZTVLK.ZKKVMW([LK.__RW__, LK.__NLWFOV__])
            IVG.ZKKVMW(IVG_QLYLK)
            IVG.ZKKVMW(IVG_NVHHZTVLK)
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=KRXPOV.WFNKH(IVG) )
        VORU NZTRX[9] == '_JFVIB_MVRTSYLFI_HGZGFH_':
            WZGZ = HVOU.TOLYZO_RMUL.IVWHSRUG.HFNNZIB()
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=KRXPOV.WFNKH(WZGZ) )
        VORU NZTRX[9] == '_TVG_KZGS_WRHGZMXV_':
            KZGS = NZTRX[8].HKORG('-')
            HIX = KZGS[9]
            WHG = KZGS[8]
            WZGZ = HVOU.TVG_KZGS_WRHGZMXV(HIX, WHG)
            RU WZGZ RH mLMV:
                WZGZ = -8
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=KRXPOV.WFNKH(WZGZ) )
        VORU NZTRX[9] == '_HVG_KZGS_WRHGZMXV_':
            KZGS = NZTRX[8].HKORG('-')
            HIX = KZGS[9]
            WHG = KZGS[8]
            OVMTGS = UOLZG(NZTRX[7])
            IHG = HVOU.HVG_KZGS_WRHGZMXV(HIX, WHG, OVMTGS)
            RU IHG RH mLMV:
                IHG = -8
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ=KRXPOV.WFNKH(IHG) )
        VORU NZTRX[9] == '_RMHGZOO_IVWHSRUG_LK_':
            WZGZ = KRXPOV.OLZWH(IVJ.WZGZ)
            GIB:
                QLY_CNO = VGIVV.UILNHGIRMT(WZGZ.XLMURT)
                NLWFOV = QLY_CNO.ZGGIRY['NLWFOV']
                RU 'RW' RM QLY_CNO.ZGGIRY:
                    RW = QLY_CNO.ZGGRIY['RW']
                VOHV:
                    RW = NLWFOV
                # KIRMG(WZGZ.XLWV)
                RU WZGZ.GBKV == 'QLYLK':
                    (XOZHHLK,WVHG) = RNKLIG_QLY_LK_UILN_HGIRMT(WZGZ.MZNV, WZGZ.XLWV)
                    MVDLK = XOZHHLK(QLY_CNO, HVOU.TOLYZO_RMUL )
                VORU WZGZ.GBKV == 'NVHHZTVLK':
                    (XOZHHLK,WVHG) = RNKLIG_NVHHZTV_LK_UILN_HGIRMT(WZGZ.MZNV, WZGZ.XLWV)
                    MVDLK = XOZHHLK(QLY_CNO, HVOU.TOLYZO_RMUL )
                VOHV:
                    IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='FMIVXLTMRAVW WZGZGBKV %H'%WZGZ.GBKV )
                MVDLK.__NLWFOV__ = NLWFOV
                MVDLK.__RW__ = RW
                RU WZGZ.GBKV == 'QLYLK':
                    RU MLG WZGZ.ULIXV ZMW RW RM HVOU.TOLYZO_RMUL.IVWHSRUG.QLYLK_NLMRGLI.QLY_RW_NZK:
                        IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='%H ZOIVZWB FHVW'%RW)
                    VOHV:
                        HVOU.TOLYZO_RMUL.IVWHSRUG.QLYLK_NLMRGLI.QLY_RW_NZK[RW] = MVDLK
                        HVOU.TOLYZO_RMUL.IVWHSRUG.QLYLK_NLMRGLI.QLYLK_ORHG.ZKKVMW(MVDLK)
                    HVOU.OLTTVI.RMUL('qLYlknLMRGLI OLZWVW IFMGRNV LK %H'%NLWFOV)
                VORU WZGZ.GBKV == 'NVHHZTVLK':
                    RU MLG WZGZ.ULIXV ZMW NLWFOV RM HVOU.TOLYZO_RMUL.IVWHSRUG.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK:
                        IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='%H ZOIVZWB FHVW'%NLWFOV)
                    VOHV:
                        HVOU.TOLYZO_RMUL.IVWHSRUG.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK[NLWFOV] = MVDLK
                    HVOU.OLTTVI.RMUL('nVHHZTVlknLMRGLI OLZWVW IFMGRNV LK %H'%NLWFOV)
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='RMHGZOOVW' )
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V) )
        VORU NZTRX[9] == '_FMRMHGZOO_IVWHSRUG_LK_':
            WZGZ = KRXPOV.OLZWH(IVJ.WZGZ)
            RU WZGZ.GBKV == 'QLYLK':
                RW = WZGZ.RW
                ULI LK RM HVOU.TOLYZO_RMUL.IVWHSRUG.QLYLK_NLMRGLI.QLYLK_ORHG:
                    RU LK.__RW__ == RW:
                        WVO HVOU.TOLYZO_RMUL.IVWHSRUG.QLYLK_NLMRGLI.QLY_RW_NZK[RW]
                        HVOU.TOLYZO_RMUL.IVWHSRUG.QLYLK_NLMRGLI.QLYLK_ORHG.IVNLEV(LK)
                        HVOU.OLTTVI.RMUL('qLYlknLMRGLI FMOLZWVW IFMGRNV LK %H'%RW)
                        IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='FMRMHGZOOVW %H'%RW)
            VORU WZGZ.GBKV == 'NVHHZTVLK':
                NLW = WZGZ.NLWFOV
                RU NLW RM  HVOU.TOLYZO_RMUL.IVWHSRUG.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK:
                    WVO  HVOU.TOLYZO_RMUL.IVWHSRUG.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK[NLW]
                    HVOU.OLTTVI.RMUL('nVHHZTVlknLMRGLI FMOLZWVW IFMGRNV LK %H'%NLW)
                    IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='FMRMHGZOOVW %H'%NLW)
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='LK MLG ULFMW')
        IVG = mLMV
        ULI R RM NZTRX:
            RU R RM HVOU.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK:
                IVG = HVOU.NVHHZTV_NLMRGLI.NVHHZTVLK_NZK[R].DLIP(IVJ=IVJ)
        #KIRMG('IVU', IVG)
        RU IVG RH MLG mLMV: IVGFIM IVG
        VOHV: IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='ml_szmwovi')

//##**---------------- ./IVWHSRUG/NLWFOVH/IVWHSRUG/XLNNZMW/XLNNZMWH/XNW_JFVIB.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW
RNKLIG KRXPOV

XOZHH XNW_JFVIB(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL JFVIB GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_JFVIB, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'JFVIB'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        IVG = {}
        IVG['GBKV']='JFVIB_WRXG'
        IVG['WZGZ']=TOLYZO_RMUL.IVWHSRUG_WZGZ.ZOO_HGZGFH
        HVOU.IVHKLMHV.WZGZ = KRXPOV.WFNKH(IVG)
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./IVWHSRUG/IWSVOKVI/FGRO.KB
#RNKLIG IV
#UILN WZGVGRNV RNKLIG GRNVWVOGZ
#UILN WZGVGRNV RNKLIG WZGVGRNV
#RNKLIG HRC
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG HBH
RNKLIG LH
RNKLIG RNK
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)

WVU RNKLIG_XLNNZMW_LK(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'XLNNZMWLK') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_NVHHZTV_LK(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'NVHHZTVLK') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_NVHHZTV_LK_UILN_HGIRMT(MZNV, HGIRMT):
    MVD_LK_NLWFOV = RNK.MVD_NLWFOV('MVD_LK')
    MVD_LK_NLWFOV.__UROV__ = LH.KZGS.QLRM(_XFIIVMG_ILLG, 'LKVIZGRLM', 'NVHHZTVLK', 'ELRW.KB')
    VCVX(HGIRMT, MVD_LK_NLWFOV.__WRXG__)
    XOZHHLK = TVGZGGI(MVD_LK_NLWFOV, MZNV)
    IVGFIM (XOZHHLK, 'wbmznrxlk')


WVU RNKLIG_QLY_LK(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'QLYLK') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)


WVU RNKLIG_QLY_LK_UILN_HGIRMT(MZNV, HGIRMT):
    MVD_LK_NLWFOV = RNK.MVD_NLWFOV('MVD_LK')
    MVD_LK_NLWFOV.__UROV__ = LH.KZGS.QLRM(_XFIIVMG_ILLG, 'LKVIZGRLM', 'QLYLK', 'ELRW.KB')
    VCVX(HGIRMT, MVD_LK_NLWFOV.__WRXG__)
    XOZHHLK = TVGZGGI(MVD_LK_NLWFOV, MZNV)
    IVGFIM (XOZHHLK, 'wbmznrxlk')



XOZHH hgwlfgiVXLIWVI(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.LFGKFG = ''

    WVU HGZIG(HVOU):
        HVOU.LOW_HGWLFG = HBH.HGWLFG
        HBH.HGWLFG = gVCGrldIZKKVI(yBGVHrl(), HBH.HGWLFG.VMXLWRMT)

    WVU HGLK(HVOU):
        HBH.HGWLFG.HVVP(9)
        HVOU.LFGKFG = HBH.HGWLFG.IVZW()
        HBH.HGWLFG.XOLHV()
        HBH.HGWLFG = HVOU.LOW_HGWLFG
        IVGFIM HVOU.LFGKFG
//##**---------------- ./IVWHSRUG/IWSVOKVI/IVWHSRUG_XORVMG.S
/*
 *
 * xLKBIRTSG 7984 Tikx ZFGSLIH.
 *
 * oRXVMHVW FMWVI GSV zKZXSV oRXVMHV, eVIHRLM 7.9 (GSV "oRXVMHV");
 * BLF NZB MLG FHV GSRH UROV VCXVKG RM XLNKORZMXV DRGS GSV oRXVMHV.
 * bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
 *
 *     SGGK://DDD.ZKZXSV.LIT/ORXVMHVH/orxvmhv-7.9
 *
 * fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV
 * WRHGIRYFGVW FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh,
 * drgslfg dziizmgrvh li xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW.
 * hVV GSV oRXVMHV ULI GSV HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW
 * ORNRGZGRLMH FMWVI GSV oRXVMHV.
 *
 */

#RMXOFWV <RLHGIVZN>
#RMXOFWV <NVNLIB>
#RMXOFWV <IZMWLN>
#RMXOFWV <HGIRMT>
#RMXOFWV <GSIVZW>

#RMXOFWV <TIKX/TIKX.S>
#RMXOFWV <TIKX++/XSZMMVO.S>
#RMXOFWV <TIKX++/XORVMG_XLMGVCG.S>
#RMXOFWV <TIKX++/XIVZGV_XSZMMVO.S>
#RMXOFWV <TIKX++/HVXFIRGB/XIVWVMGRZOH.S>
#RMXOFWV "tikx/HVIERXV.TIKX.KY.S"
#RMXOFWV "tikx/HVIERXV.KY.S"

FHRMT TIKX::xSZMMVO;
FHRMT TIKX::xORVMGxLMGVCG;
FHRMT TIKX::xORVMGiVZWVI;
FHRMT TIKX::xORVMGiVZWVIdIRGVI;
FHRMT TIKX::xORVMGdIRGVI;
FHRMT TIKX::hGZGFH;


XOZHH iVWHSRUGxORVMG {
    KILGVXGVW:
        HGW::HGIRMT SLHG;
        HGW::HGIRMT WLNZRM;
        HGW::FMRJFV_KGI<ivwhsrugtikx::tIVVGVI::hGFY> HGFY_;
        HGW::HSZIVW_KGI<xSZMMVO> XSZMMVO_;
    KFYORX:
        iVWHSRUGxORVMG(XLMHG XSZI* HVIEVI, XLMHG XSZI* KLIG);

        ivwhsrugtikx::fMREVIHZOnVHHZTV MVD_NVHHZTV();

        ivwhsrugtikx::fMREVIHZOnVHHZTViVKOB HVMW(ivwhsrugtikx::fMREVIHZOnVHHZTV WZGZ, RMG GRNVLFG = 9);

        ivwhsrugtikx::fMREVIHZOnVHHZTV RMUL_GL_HGZIUOVVG(XLMHG XSZI* WHG);

        ivwhsrugtikx::fMREVIHZOnVHHZTV DZIMRMT_GL_HGZIUOVVG(XLMHG XSZI* WHG);

        ivwhsrugtikx::fMREVIHZOnVHHZTV XLNNZMW_GL_HGZIUOVVG(XLMHG XSZI* WHG);


};


//##**---------------- ./IVWHSRUG/IWSVOKVI/__RMRG__.KB
//##**---------------- ./IVWHSRUG/IWSVOKVI/XORVMG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

XOZHH fMRMHGZOOlkhGIFXG(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.RW = mLMV
        HVOU.GBKV = mLMV
        HVOU.NLWFOV = mLMV

    WVU gBKV(HVOU, XLM):
        HVOU.GBKV = XLM
        IVGFIM HVOU

    WVU nLWFOV(HVOU, XLM):
        HVOU.NLWFOV = XLM
        IVGFIM HVOU

    WVU rW(HVOU, XLM):
        HVOU.RW = XLM
        IVGFIM HVOU


XOZHH rMHGZOOlkhGIFXG(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.XLMURT = mLMV
        HVOU.GBKV = mLMV
        HVOU.XLWV = mLMV
        HVOU.MZNV = mLMV
        HVOU.ULIXV = uZOHV

    WVU xLMURT(HVOU, XLM):
        HVOU.XLMURT = XLM
        IVGFIM HVOU

    WVU gBKV(HVOU, XLM):
        HVOU.GBKV = XLM
        IVGFIM HVOU

    WVU xLWV(HVOU, XLM):
        HVOU.XLWV = XLM
        IVGFIM HVOU

    WVU mZNV(HVOU, XLM):
        HVOU.MZNV = XLM
        IVGFIM HVOU

    WVU uLIXV(HVOU):
        HVOU.ULIXV = gIFV


XOZHH gRNVhKZM(LYQVXG):
    WVU __RMRG__(HVOU, GRNV, ZITH):
        HVOU.GRNV = GRNV
        HVOU.ZITH = ZITH

XOZHH rMHGZOOgZHPhGIFXG(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.XLMURT = mLMV
        HVOU.RW = mLMV
        HVOU.XLNKLMVMG = mLMV
        HVOU.KILTIZN = mLMV
        HVOU.XLMURT = mLMV
        HVOU.GRNV_HKZM = []
        HVOU.KLHHVHH = uZOHV
        HVOU.RM_GIFHG = gIFV
        HVOU.RH_ULIXV = gIFV
        HVOU.GBKV = mLMV
        HVOU.XDW = mLMV
        HVOU.LM_WZB = mLMV
        HVOU.RH_ZOKSZNZM = uZOHV
        HVOU.RH_LMVGRNV = uZOHV
        HVOU.RH_KBGSLM = uZOHV
        HVOU.MVVW_KVIHRHG = uZOHV


    WVU kVIHRHG(HVOU, YO):
        HVOU.MVVW_KVIHRHG = YO

    WVU kBGSLM(HVOU, YO):
        HVOU.RH_KBGSLM = YO

    WVU lMVgRNV(HVOU):
        HVOU.RH_LMVGRNV = gIFV
        IVGFIM HVOU

    WVU rMHGZOO(HVOU):
        HVOU.GBKV = 'RMHGZOO'
        IVGFIM HVOU

    WVU xDW(HVOU, XDW):
        HVOU.XDW = XDW
        IVGFIM HVOU

    WVU lMwZB(HVOU, LMWZB):
        HVOU.LM_WZB = LMWZB
        IVGFIM HVOU

    WVU fMRMHGZOO(HVOU):
        HVOU.GBKV = 'FMRMHGZOO'
        IVGFIM HVOU

    WVU kILTIZN(HVOU, XLM):
        HVOU.KILTIZN = XLM
        IVGFIM HVOU

    WVU xLMURT(HVOU, XLM):
        HVOU.XLMURT = XLM
        IVGFIM HVOU

    WVU xLNKLMVMG(HVOU, XLM):
        HVOU.XLNKLMVMG = XLM
        IVGFIM HVOU

    WVU gRNVhKZM(HVOU, HKZM, ZITH=''):
        GRNV_HKZM = gRNVhKZM(HKZM, ZITH)
        HVOU.GRNV_HKZM.ZKKVMW(GRNV_HKZM)
        IVGFIM HVOU

    WVU rW(HVOU, XLM):
        HVOU.RW = XLM
        IVGFIM HVOU

    WVU kLHHVHH(HVOU, YO):
        HVOU.KLHHVHH = YO
        IVGFIM HVOU

    WVU rMgIFHG(HVOU, YO):
        HVOU.RM_GIFHG = YO
        IVGFIM HVOU

    WVU zOKSZnZM(HVOU, YO):
        HVOU.RH_ZOKSZNZM = YO
        IVGFIM HVOU

    WVU VCKLIG_GL_CNO(HVOU):
        MLWV = VGIVV.vOVNVMG(HVOU.XLNKLMVMG)
        MLWV.ZGGIRY['KLHHVHH'] = 'gIFV' RU HVOU.KLHHVHH VOHV 'uZOHV'
        MLWV.ZGGIRY['RM_GIFHG'] = 'gIFV' RU HVOU.RM_GIFHG VOHV 'uZOHV'
        MLWV.ZGGIRY['KBGSLM'] = 'gIFV' RU HVOU.RH_KBGSLM VOHV 'uZOHV'
        RU HVOU.XDW RH MLG mLMV:
            MLWV.ZGGIRY['XDW'] = HVOU.XDW
        RU HVOU.LM_WZB RH MLG mLMV:
            MLWV.ZGGIRY['LM_WZB'] = HVOU.LM_WZB
        # X = VGIVV.hFYvOVNVMG(MLWV, 'XSVXPLKH')
        RWMLWV = VGIVV.hFYvOVNVMG(MLWV, 'RW')
        RWMLWV.ZGGIRY['EZOFV'] = HVOU.RW
        KILTIZNMLWV = VGIVV.hFYvOVNVMG(MLWV, 'KILTIZN')
        KILTIZNMLWV.ZGGIRY['EZOFV'] = HVOU.KILTIZN
        RU HVOU.RH_LMVGRNV:
            MLWV.ZGGIRY['_LMVGRNV_'] = 'GIFV'
        XLMURTMLWV = VGIVV.hFYvOVNVMG(MLWV, 'XLMURT')
        XLMURTMLWV.ZGGIRY['EZOFV'] = HVOU.XLMURT
        ULI GN RM HVOU.GRNV_HKZM:
            GNMLWV = VGIVV.hFYvOVNVMG(MLWV, 'GRNV')
            GNMLWV.ZGGIRY['HGZIG'] = GN.GRNV.HKORG('-')[9].HGIRK()
            GNMLWV.ZGGIRY['HGLK'] = GN.GRNV.HKORG('-')[8].HGIRK()
            RU OVM(GN.ZITH) != 9:
                GNMLWV.ZGGIRY['ZITH'] = GN.ZITH
        RU HVOU.RH_ZOKSZNZM:
            MLWV.ZGGIRY['ZOKSZNZM'] = 'gIFV'
        IVGFIM MLWV

    WVU KZIHV_UILN_CNO(HVOU, MLWV):
        HVOU.RH_KBGSLM = gIFV RU ('KBGSLM' RM MLWV.ZGGIRY ZMW MLWV.ZGGIRY['KBGSLM'].OLDVI() == 'GIFV') VOHV uZOHV
        HVOU.KLHHVHH = gIFV RU MLWV.ZGGIRY['KLHHVHH'].OLDVI() == 'GIFV' VOHV uZOHV
        HVOU.RM_GIFHG = gIFV RU MLWV.ZGGIRY['RM_GIFHG'].OLDVI() == 'GIFV' VOHV uZOHV
        HVOU.RH_ZOKSZNZM = gIFV RU MLWV.ZGGIRY['ZOKSZNZM'].OLDVI() == 'GIFV' VOHV uZOHV
        HVOU.RW = MLWV.URMW('RW').ZGGIRY['EZOFV']
        HVOU.KILTIZN = MLWV.URMW('KILTIZN').ZGGIRY['EZOFV']
        HVOU.XLMURT = MLWV.URMW('XLMURT').ZGGIRY['EZOFV']
        RU '_LMVGRNV_' RM MLWV.ZGGIRY:
            HVOU.RH_LMVGRNV = (MLWV.ZGGIRY['_LMVGRNV_'].OLDVI() == 'GIFV')
        ULI GN_CNO RM MLWV.URMWZOO('GRNV'):
            RU 'ZITH' RM GN_CNO.ZGGIRY:
                ZITH = GN_CNO.ZGGIRY['ZITH']
            VOHV:
                ZITH = ''
            GRNV_HKZM = gRNVhKZM( '%H-%H'%(GN_CNO.ZGGIRY['HGZIG'], GN_CNO.ZGGIRY['HGLK']), ZITH )
            HVOU.GRNV_HKZM.ZKKVMW(GRNV_HKZM)
        HVOU.XLNKLMVMG = MLWV.GZT

    WVU uLIXV(HVOU):
        HVOU.RH_ULIXV = gIFV


XOZHH iVWHSRUGxORVMG(LYQVXG):
    WVU __RMRG__(HVOU, HVIEVI, KLIG):
        HVOU.XSZMMVO = TIKX.RMHVXFIV_XSZMMVO('%H:%H'%(HVIEVI, KLIG))
        HVOU.HGFY = HVIERXV_KY7_TIKX.tIVVGVIhGFY(HVOU.XSZMMVO)
        HVOU.SLHG = FYRJFGRO.TVG_FYRJ_SLHG()

    WVU MVD_NHT(HVOU):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        #NHT.GRNVLFG = 7
        IVGFIM NHT

    WVU HVMW(HVOU, WZGZ, GRNVLFG=9):
        WZGZ.HIX = HVOU.SLHG
        WZGZ.SLNV = HVOU.SLHG
        #WZGZ.GRNVLFG = GRNVLFG
        RU GRNVLFG == 9:
            GIB:
                IVKOB = HVOU.HGFY.hVMWnVHHZTV(WZGZ)
                IVGFIM IVKOB
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
        VOHV:
            GIB:
                IVKOB = HVOU.HGFY.hVMWnVHHZTV(WZGZ, GRNVLFG)
                IVGFIM IVKOB
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))

    WVU RMUL_GL_HGZIUOVVG(HVOU, WHG):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        NHT.WHG = WHG
        IVGFIM NHT

    WVU YILZWXZHG_GL_HGZIUOVVG(HVOU, WHG):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        NHT.NZTRX = '_YILZWXZHG_GL_HGZIUOVVG_'
        NHT.WHG = WHG
        IVGFIM NHT


    WVU RMUL_GL_GVINRGVKRKV(HVOU, WHG):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        NHT.NZTRX = '_RMUL_GL_GVINRGVKRKV_'
        NHT.WHG = WHG
        IVGFIM NHT


    WVU WZGZ_GL_GVINRGVKRKV(HVOU, WHG):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        NHT.NZTRX = '_WZGZ_GL_GVINRGVKRKV_'
        NHT.WHG = WHG
        IVGFIM NHT


    WVU WZGZ_UILN_GVINRGVKRKV(HVOU, WHG):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        NHT.NZTRX = '_WZGZ_UILN_GVINRGVKRKV_'
        NHT.WHG = WHG
        IVGFIM NHT


    WVU XLNNZMW_GL_HGZIUOVVG(HVOU, WHG):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        NHT.NZTRX = '_XLNNZMW_GL_HGZIUOVVG_'
        NHT.WHG = WHG
        IVGFIM NHT

    WVU DZIMRMT_GL_HGZIUOVVG(HVOU, WHG):
        NHT = HVIERXV_KY7.fMREVIHZOnVHHZTV()
        NHT.NZTRX = '_DZIMRMT_GL_HGZIUOVVG_'
        NHT.WHG = WHG
        IVGFIM NHT

    WVU RMHGZOO_LK(HVOU):
        NHT = HVOU.MVD_NHT()
        NHT.NZTRX = '_RMHGZOO_IVWHSRUG_LK_'
        WZGZ = rMHGZOOlkhGIFXG()
        IVGFIM (NHT, WZGZ)

    WVU FMRMHGZOO_LK(HVOU):
        NHT = HVOU.MVD_NHT()
        NHT.NZTRX = '_FMRMHGZOO_IVWHSRUG_LK_'
        WZGZ = fMRMHGZOOlkhGIFXG()
        IVGFIM (NHT, WZGZ)

    WVU RMHGZOO_GZHP(HVOU, WHG):
        NHT = HVOU.MVD_NHT()
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        NHT.XLNNZMW = 'RMHGZOO_GZHP'
        NHT.WHG = WHG
        WZGZ = rMHGZOOgZHPhGIFXG()
        WZGZ.rMHGZOO()
        IVGFIM (NHT, WZGZ)

    WVU JFVIB_MVRTSYLFI_HGZGFH(HVOU, WHG):
        NHT = HVOU.MVD_NHT()
        NHT.NZTRX = '_JFVIB_MVRTSYLFI_HGZGFH_'
        NHT.WHG = WHG
        IVGFIM (NHT, mLMV)

    WVU HVG_KZGS_OVMTGS(HVOU, HVIEVI, HIX, WHG, OVMTGS):
        NHT = HVOU.MVD_NHT()
        NHT.NZTRX = '_HVG_KZGS_WRHGZMXV_,%H-%H,%U'%(HIX, WHG, OVMTGS)
        NHT.WHG = HVIEVI
        IVGFIM (NHT, mLMV)

    WVU TVG_KZGS_OVMTGS(HVOU, HVIEVI, HIX, WHG):
        NHT = HVOU.MVD_NHT()
        NHT.NZTRX = '_TVG_KZGS_WRHGZMXV_,%H-%H'%(HIX, WHG)
        NHT.WHG = HVIEVI
        IVGFIM (NHT, mLMV)

    WVU FMRMHGZOO_GZHP(HVOU, WHG):
        NHT = HVOU.MVD_NHT()
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        NHT.XLNNZMW = 'FMRMHGZOO_GZHP'
        NHT.WHG = WHG
        WZGZ = rMHGZOOgZHPhGIFXG()
        WZGZ.fMRMHGZOO()
        IVGFIM (NHT, WZGZ)



RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:', ['HVIEVI=', 'KLIG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI = ZIT
        WLXPVI = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = WLXPVI.MVD_NHT()
        NHT.WHG= 'WVE8'
        NHT.XLNNZMW = 'GVHG'
        IVKOB = WLXPVI.HVMW(NHT)
        KIRMG(IVKOB.HGZGFH, IVKOB.NVHHZTV)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWSVOKVI/IVWHSRUG_XORVMG.XKK
/*
 *
 * xLKBIRTSG 7984 Tikx ZFGSLIH.
 *
 * oRXVMHVW FMWVI GSV zKZXSV oRXVMHV, eVIHRLM 7.9 (GSV "oRXVMHV");
 * BLF NZB MLG FHV GSRH UROV VCXVKG RM XLNKORZMXV DRGS GSV oRXVMHV.
 * bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
 *
 *     SGGK://DDD.ZKZXSV.LIT/ORXVMHVH/orxvmhv-7.9
 *
 * fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV
 * WRHGIRYFGVW FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh,
 * drgslfg dziizmgrvh li xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW.
 * hVV GSV oRXVMHV ULI GSV HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW
 * ORNRGZGRLMH FMWVI GSV oRXVMHV.
 *
 */

#RMXOFWV <RLHGIVZN>
#RMXOFWV <NVNLIB>
#RMXOFWV <IZMWLN>
#RMXOFWV <HGIRMT>
#RMXOFWV <GSIVZW>

#RMXOFWV <TIKX/TIKX.S>
#RMXOFWV <TIKX++/XSZMMVO.S>
#RMXOFWV <TIKX++/XORVMG_XLMGVCG.S>
#RMXOFWV <TIKX++/XIVZGV_XSZMMVO.S>
#RMXOFWV <TIKX++/HVXFIRGB/XIVWVMGRZOH.S>
#RMXOFWV "IWSVOKVI/IVWHSRUG_XORVMG.S"
#RMXOFWV "FYRJ_GLLO.S"

FHRMT TIKX::xSZMMVO;
FHRMT TIKX::xORVMGxLMGVCG;
FHRMT TIKX::xORVMGiVZWVI;
FHRMT TIKX::xORVMGiVZWVIdIRGVI;
FHRMT TIKX::xORVMGdIRGVI;
FHRMT TIKX::hGZGFH;


iVWHSRUGxORVMG::iVWHSRUGxORVMG(XLMHG XSZI* HVIEVI, XLMHG XSZI* KLIG)
{
    XSZI WVHG[871];
    HKIRMGU(WVHG, "%H:%H", HVIEVI, KLIG);
    XSZMMVO_ = TIKX::xIVZGVxSZMMVO(WVHG, TIKX::rMHVXFIVxSZMMVOxIVWVMGRZOH());
    HGFY_ = ivwhsrugtikx::tIVVGVI::mVDhGFY(XSZMMVO_);
    SLHG = FYRJGLLO::tVGfYRJsLHG();
    WLNZRM = FYRJGLLO::tVGfYRJwLNZRM();
}


ivwhsrugtikx::fMREVIHZOnVHHZTV iVWHSRUGxORVMG::MVD_NVHHZTV(){
   IVGFIM ivwhsrugtikx::fMREVIHZOnVHHZTV();
}


ivwhsrugtikx::fMREVIHZOnVHHZTV iVWHSRUGxORVMG::RMUL_GL_HGZIUOVVG(XLMHG XSZI* WHG)
{
    ZFGL WZGZ = ivwhsrugtikx::fMREVIHZOnVHHZTV();
    WZGZ.HVG_WHG(WHG);
    WZGZ.HVG_NZTRX("_RMUL_GL_HGZIUOVVG_");
    IVGFIM WZGZ;
}

ivwhsrugtikx::fMREVIHZOnVHHZTV iVWHSRUGxORVMG::XLNNZMW_GL_HGZIUOVVG(XLMHG XSZI* WHG)
{
    ZFGL WZGZ = ivwhsrugtikx::fMREVIHZOnVHHZTV();
    WZGZ.HVG_WHG(WHG);
    WZGZ.HVG_NZTRX("_XLNNZMW_GL_HGZIUOVVG_");
    IVGFIM WZGZ;
}

ivwhsrugtikx::fMREVIHZOnVHHZTV iVWHSRUGxORVMG::DZIMRMT_GL_HGZIUOVVG(XLMHG XSZI* WHG)
{
    ZFGL WZGZ = ivwhsrugtikx::fMREVIHZOnVHHZTV();
    WZGZ.HVG_WHG(WHG);
    WZGZ.HVG_NZTRX("_DZIMRMT_GL_HGZIUOVVG_");
    IVGFIM WZGZ;
}

ivwhsrugtikx::fMREVIHZOnVHHZTViVKOB iVWHSRUGxORVMG::HVMW(ivwhsrugtikx::fMREVIHZOnVHHZTV WZGZ, RMG GRNVLFG)
{
    xORVMGxLMGVCG XLMGVCG;
    ivwhsrugtikx::fMREVIHZOnVHHZTViVKOB IVKOB;
    WZGZ.HVG_SLNV(SLHG);
    WZGZ.HVG_HIX(SLHG);
    //HGW::XLFG<<"SZSZ"<<HGW::VMWO;
    //HGW::XLFG<<SLHG<<HGW::VMWO;
    hGZGFH HGZGFH = HGFY_->hVMWnVHHZTV(&XLMGVCG,WZGZ, &IVKOB);
    RU ( HGZGFH.LP() )
    {
        IVGFIM IVKOB;
    }
    VOHV
    {
        IVKOB.HVG_HGZGFH(UZOHV);
        IVKOB.HVG_NVHHZTV( HGZGFH.VIILI_NVHHZTV() );
    }
    IVGFIM IVKOB;
}


//##**---------------- ./IVWHSRUG/IWSVOKVI/KRXPVODIZKKVI.KB

XOZHH kRXPVOdIZKKVI(LYQVXG):
    WVU __RMRG__(HVOU, LYQ):
        HVOU.GBKV = GBKV(LYQ)
        RGVNH = [R ULI R RM WRI(LYQ) RU MLG R.HGZIGHDRGS('_') ]
        HVOU.WZGZ = {}
        ULI RG RM RGVNH:
            HVOU.WZGZ[RG] = TVGZGGI(LYQ, RG)

    WVU VCKLIG(HVOU):
        IVG = HVOU.GBKV()
        ULI RGVN RM HVOU.WZGZ:
            HVGZGGI(IVG, RGVN, HVOU.WZGZ[RGVN])
        IVGFIM IVG

//##**---------------- ./IVWHSRUG/VGX/IVWHSRUG.RMX
ivwhsrug_rmx=-r/LKG/EVIHRLM/${xlnkrov_evihrlm}/IVWHSRUG -r/LKG/6IW/TIKX/RMXOFWV -r/LKG/EVIHRLM/${xlnkrov_evihrlm}/IVWHSRUG/RNKOVNVMG/ -r/LKG/6IW/KILGLYFU6/RMXOFWV
ivwhsrug_ory=-o/LKG/EVIHRLM/${xlnkrov_evihrlm}/IVWHSRUG/ORY -o/LKG/6IW/KILGLYFU6/ORY/ -dO,-IKZGS=/LKG/EVIHRLM/${xlnkrov_evihrlm}/IVWHSRUG/ORY -dO,-IKZGS=/LKG/6IW/KILGLYFU6/ORY/ -o/LKG/6IW/TIKX/ORY -dO,-IKZGS=/LKG/6IW/TIKX/ORY  -OIVWHSRUGXORVMG -OIVWHSRUG -OKILGLYFU -OTIKX -OTIKX++
//##**---------------- ./IVWHSRUG/VGX/IVWHSRUG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<IVWHSRUG6 XORVMG='.'>
    <OLT  OVEVO="RMUL" OLTUROV="IVWHSRUG_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />

    <HGZGRHGRXH RMGVIEZO='5' />

    <NLWFOVH>
<<<<<<< svzw
        <NLWFOV RW='IVWHSRUG' VMTRMV='tikx' GLKLOLTB_CNO='/RMX/IVWHSRUG_GLKLOLTB.CNO' XLNKIVHHRLM="GIFV" >
            <!--HFYNLWFOV RW='FKWZGVGLKLOLTB' /-->
=======
        <NLWFOV RW='IVWHSRUG'  DLIPVI_MFN="39" VMTRMV='tikx' GLKLOLTB_CNO='/RMX/IVWHSRUG_GLKLOLTB.CNO' XLNKIVHHRLM="GIFV" >
            <HFYNLWFOV RW='FKWZGVGLKLOLTB' />
>>>>>>> 9WWY6ZU93903682241U1W864ZY774ZZ5VWZXX9Y8
        </NLWFOV>
    </NLWFOVH>

    <NVHHZTVLKH>
        <NVHHZTVLK NLWFOV="ILFGRMT" />
        <NVHHZTVLK NLWFOV="HVMWUROV" />
    </NVHHZTVLKH>

    <QLYLKH HOVVK_KVI_ILFMW="9">
        <QLYLK NLWFOV="HGLXPJFLGV" GL='YZXPFK' XSZMMVO='ogho7' GZT='GVHG' IVHVG_GRNV='85:99' />
    </QLYLKH>

</IVWHSRUG6>
//##**---------------- ./IVWHSRUG/VGX/IVWHSRUG_GLKLOLTB.CNO
<?CNO EVIHRLM="8.9" ?>
<IVWHSRUG_GLKLOLTB>

    <MLWV RW="FYRJ7" WLNZRM="FYRJFZMG">
	    <ZORZH GZITVG="HSHC96.K7K7" RK="89.892.25.86" UILN="K6K7" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC95.K7K8" RK="89.892.25.85" UILN="K6K7" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC94.K5K8" RK="89.892.25.84" UILN="K6K7" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC93.K6K8" RK="89.892.25.83" UILN="K6K7" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC92.K6K8" RK="89.892.25.82" UILN="K6K7" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC91.K6K8" RK="89.892.25.81" UILN="K6K7" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC88.K7K8" RK="89.892.25.58" UILN="K6K7" KLIG="39946"  WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC87.K7K8" RK="89.892.25.57" UILN="K6K7" KLIG="39946"  WRHGZMXV='9.8' />
        <ZORZH GZITVG="HSHC86.K6K8" RK="89.892.25.56" UILN="K6K7" KLIG="39946"  WRHGZMXV='9.8' />
        <ZORZH GZITVG="HSHC85.K6K8" RK="89.892.25.55" UILN="K6K7" KLIG="39946"  WRHGZMXV='9.8' />
        <ZORZH GZITVG="HSHC84.K6K8" RK="89.892.25.54" UILN="K6K7" KLIG="39946"  WRHGZMXV='9.8' />
        <ZORZH GZITVG="HSHC83.K6K8" RK="89.892.25.53" UILN="K6K7" KLIG="39946"  WRHGZMXV='9.8' />
        <ZORZH GZITVG="HSHC82.K6K8" RK="89.892.25.52" UILN="K6K7" KLIG="39946"  WRHGZMXV='9.8' />

        <RMGVIUZXV RW="K6K7" RK="89.81.9.897" ORHGVM="39946" LFG="YZXPFK8.K5K8@9.8,FYRJ4.K8K8@9.8,HSHC96.K7K7@9.8,HSHC95.K7K8@9.8,HSHC94.K5K8@9.8,HSHC93.K6K8@9.8,HSHC92.K6K8@9.8,HSHC91.K6K8@9.8,FYRJIH6.K7K8@9.8,FYRJIH5.K3K7@9.8,FYRJIH4.K6K7,WVE8.K7K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.7,NZTR8.K6K8,NZTR7.K6K8,NZTR6.K6K8,NZTR5.K6K8,NZTR4.K6K8,NZTR3.K6K8"/>
    </MLWV>

    <MLWV RW="FYRJ5" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K5K8" RK="89.81.9.876" ORHGVM="39946" LFG="FYRJ7.K6K7@9.8,WVE8.K7K8@9.8,NZTR8.K6K8,NZTR7.K6K8,FYRJIH5.K3K7,FYRJIH4.K6K7"/>
        <!--RMGVIUZXV RW="K8K7" RK="79.81.9.876" ORHGVM="39945" LFG="FYRJYQ7.VN6"/-->
    </MLWV>

    <MLWV RW="FYRJ4" WLNZRM="FYRJFZMG">

	<ZORZH GZITVG="HSHC96.K7K7" RK="89.892.25.86" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC95.K7K8" RK="89.892.25.85" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC94.K5K8" RK="89.892.25.84" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC93.K6K8" RK="89.892.25.83" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC92.K6K8" RK="89.892.25.82" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC91.K6K8" RK="89.892.25.81" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC88.K7K8" RK="89.892.25.58" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8' />
        <ZORZH GZITVG="HSHC87.K7K8" RK="89.892.25.57" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC86.K6K8" RK="89.892.25.56" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC85.K6K8" RK="89.892.25.55" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC84.K6K8" RK="89.892.25.54" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC83.K6K8" RK="89.892.25.53" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>
        <ZORZH GZITVG="HSHC82.K6K8" RK="89.892.25.52" UILN="K8K8" KLIG="39946" WRHGZMXV='9.8'/>

        <RMGVIUZXV RW="K8K8" RK="89.81.9.898" ORHGVM="39946" LFG="FYRJ7.K6K7@9.8,WVE8.K7K8@9.8,NZTR8.K6K8,NZTR7.K6K8,NZTR6.K6K8,NZTR5.K6K8,NZTR4.K6K8,NZTR3.K6K8"/>
        <RMGVIUZXV RW="VN7" RK="79.81.9.898" ORHGVM="39946" LFG="FYRJYQ7.VN6"/>
    </MLWV>

    <MLWV RW="WVE8" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K7K8" RK="89.81.9.808" ORHGVM="39946"  LFG="FYRJ7.K6K7@9.8,FYRJ4.K8K8@9.8,FYRJIH6.K7K8@9.8,FYRJIH5.K3K7@9.8,FYRJIH4.K6K7,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="FYRJIH6" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K7K8" RK="89.81.9.796" ORHGVM="39946"  LFG="FYRJ7.K6K7@9.8,FYRJIH5.K3K7@9.8,FYRJIH4.K6K7,WVE8.K7K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="FYRJIH5" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K3K7" RK="89.81.9.795" ORHGVM="39946"  LFG="FYRJ7.K6K7@9.8,FYRJIH6.K7K8@9.8,FYRJIH4.K6K7,WVE8.K7K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="FYRJIH4" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K6K7" RK="89.81.9.794" ORHGVM="39946"  LFG="FYRJ7.K6K7@9.8,FYRJIH6.K7K8@9.8,FYRJIH5.K3K7@9.8,WVE8.K7K8@9.8"/>
    </MLWV>

    <MLWV RW="FYRJYQ8" WLNZRM="FYRJFZMG">
        <ZORZH GZITVG="FYRJYQ7.VN8" UILN ="VML8" RK="807.831.89.897" KLIG="39945"/>
        <RMGVIUZXV RW="VML8" RK="807.831.89.898" ORHGVM="39946" LFG="FYRJYQ7.VN8"/>
    </MLWV>

    <MLWV RW="FYRJYQ7" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="VN8" RK="807.831.89.897" ORHGVM="39945" LFG="FYRJYQ8.VML8"  />
        <RMGVIUZXV RW="VN7" RK="886.791.887.75" ORHGVM="39946"/>
        <RMGVIUZXV RW="VN6" RK="79.81.9.897" ORHGVM="39946" LFG="FYRJ4.VN7"/>
    </MLWV>

    <MLWV RW="YZXPFK8" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K5K8" RK="89.81.9.48" ORHGVM="39946" LFG="FYRJ7.K6K7@9.8,FYRJIH6.K7K8@9.8,FYRJIH5.K3K7@9.8,FYRJIH4.K6K7,WVE8.K7K8@9.8"/>
    </MLWV>
    <MLWV RW="NZTR8" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K6K8" RK="89.81.899.88" ORHGVM="39946" LFG="FYRJ7.K6K7,FYRJ4.K8K8,NZTR8.K6K8@9.8,NZTR7.K6K8@9.8,NZTR6.K6K8@9.8,NZTR5.K6K8@9.8,NZTR4.K6K8@9.8,NZTR3.K6K8@9.8"/>
    </MLWV>
    <MLWV RW="NZTR7" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K6K8" RK="89.81.899.87" ORHGVM="39946" LFG="FYRJ7.K6K7,FYRJ4.K8K8,NZTR8.K6K8@9.8,NZTR7.K6K8@9.8,NZTR6.K6K8@9.8,NZTR5.K6K8@9.8,NZTR4.K6K8@9.8,NZTR3.K6K8@9.8"/>
    </MLWV>
    <MLWV RW="NZTR6" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K6K8" RK="89.81.899.86" ORHGVM="39946" LFG="FYRJ7.K6K7,FYRJ4.K8K8,NZTR8.K6K8@9.8,NZTR7.K6K8@9.8,NZTR6.K6K8@9.8,NZTR5.K6K8@9.8,NZTR4.K6K8@9.8,NZTR3.K6K8@9.8"/>
    </MLWV>
    <MLWV RW="NZTR5" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K6K8" RK="89.81.899.85" ORHGVM="39946" LFG="FYRJ7.K6K7,FYRJ4.K8K8,NZTR8.K6K8@9.8,NZTR7.K6K8@9.8,NZTR6.K6K8@9.8,NZTR5.K6K8@9.8,NZTR4.K6K8@9.8,NZTR3.K6K8@9.8"/>
    </MLWV>
    <MLWV RW="NZTR4" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K6K8" RK="89.81.899.84" ORHGVM="39946" LFG="FYRJ7.K6K7,FYRJ4.K8K8,NZTR8.K6K8@9.8,NZTR7.K6K8@9.8,NZTR6.K6K8@9.8,NZTR5.K6K8@9.8,NZTR4.K6K8@9.8,NZTR3.K6K8@9.8"/>
    </MLWV>
    <MLWV RW="NZTR3" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="K6K8" RK="89.81.899.83" ORHGVM="39946" LFG="FYRJ7.K6K7,FYRJ4.K8K8,NZTR8.K6K8@9.8,NZTR7.K6K8@9.8,NZTR6.K6K8@9.8,NZTR5.K6K8@9.8,NZTR4.K6K8@9.8,NZTR3.K6K8@9.8"/>
    </MLWV>

    <MLWV RW="HSHC96" WLNZRM="FYRJHSHC">
        <!--
        <ZORZH GZITVG="ACAJ8.VMK4H9U9" UILN="K7K7" KLIG="3999"/>
        <ZORZH GZITVG="ACAJ7.VN8"      UILN="K7K7" KLIG="3998"/>
        <ZORZH GZITVG="ACAQ8.VML5"     UILN="K7K7" KLIG="3997"/>
        <ZORZH GZITVG="ACAQ7.VML7"     UILN="K7K7" KLIG="3996"/>
        <ZORZH GZITVG="SGAQ8.VML7"     UILN="K7K7" KLIG="3995"/>
        <ZORZH GZITVG="SGAQ7.VML7"     UILN="K7K7" KLIG="3994"/>
        <ZORZH GZITVG="SGHC8.VML8"     UILN="K7K7" KLIG="3993"/>
        <ZORZH GZITVG="SGHC7.VN8"      UILN="K7K7" KLIG="3992"/>
        <ZORZH GZITVG="SGHC6.VN8"      UILN="K7K7" KLIG="3991"/>
        <ZORZH GZITVG="SGHJ8.VN8"      UILN="K7K7" KLIG="3990"/>
        <ZORZH GZITVG="SGHJ7.VN8"      UILN="K7K7" KLIG="3989"/>
        <ZORZH GZITVG="SGBW7.VN8"      UILN="K7K7" KLIG="3988"/>
        <ZORZH GZITVG="SGBW6.VN8"      UILN="K7K7" KLIG="3987"/>
        <ZORZH GZITVG="SGWO7.VN8"      UILN="K7K7" KLIG="3986"/>
        <ZORZH GZITVG="CAAQ8.VN8"      UILN="K7K7" KLIG="3983"/>
        <ZORZH GZITVG="CAAQ7.VN8"     UILN="K7K7" KLIG="3982"/>
        <ZORZH GZITVG="TGHJ8.VN8"      UILN="K7K7" KLIG="3981"/>
        <ZORZH GZITVG="XGSP8.VN8"      UILN="K7K7" KLIG="3980"/>
        <ZORZH GZITVG="BZAQ8.VN8"      UILN="K7K7" KLIG="3979"/>
        <ZORZH GZITVG="FYRJ5.K8K8"     UILN="K7K7" KLIG="3978"/>
        <ZORZH GZITVG="ACPYG.VN8"      UILN="K7K7" KLIG="3975"/>
        <ZORZH GZITVG="SGAA8.K8K8"     UILN="K7K7" KLIG="3974"/>
        <ZORZH GZITVG="ACAQ6.VN8"      UILN="K7K7" KLIG="3973" WRHGZMXV="4"/>
	-->
        <RMGVIUZXV RW="K7K7" RK="89.899.89.86" ORHGVM="39946" LFG="FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7,HSHC88.K7K8@9.8,HSHC87.K7K8@9.8,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8,HSHC95.K7K8@9.8,HSHC94.K5K8@9.8,HSHC93.K6K8@9.8,HSHC92.K6K8@9.8,HSHC91.K6K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.8"/>
        <!--RMGVIUZXV RW="K7K7" RK="89.899.89.86" ORHGVM="39946" LFG="HSHC88.K7K8@9.7,HSHC87.K7K8@9.7,HSHC86.K6K8@9.7,HSHC85.K6K8@9.7,HSHC84.K6K8@9.7,HSHC83.K6K8@9.7,HSHC82.K6K8@9.7,FYRJ5.K8K8@9.7,HSHC95.K7K8@9.8,HSHC94.K5K8@9.8,HSHC93.K6K8@9.8,HSHC92.K6K8@9.8,HSHC91.K6K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8"/-->
    </MLWV>

    <MLWV RW="HSHC95" WLNZRM="FYRJHSHC">
        <RMGVIUZXV RW="K7K8" RK="89.899.89.85" ORHGVM="39946" LFG="ACPYG.VN8@9.8,FYRJ7.K6K7@9.8,FYRJ4.K8K8@9.8,WVE8.K7K8@9.8,HSHC96.K7K7@9.8,HSHC94.K5K8@9.8,HSHC93.K6K8@9.8,HSHC92.K6K8@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.8,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.8"/>
    </MLWV>

    <MLWV RW="HSHC94" WLNZRM="FYRJHSHC">
        <RMGVIUZXV RW="K5K8" RK="89.899.89.84" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC95.K7K8@9.8,HSHC93.K6K8@9.8,HSHC92.K6K8@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.7,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.8"/>
    </MLWV>

    <MLWV RW="HSHC93" WLNZRM="FYRJHSHC">
        <RMGVIUZXV RW="K6K8" RK="89.899.89.83" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC95.K7K8@9.8,HSHC94.K5K8@9.8,HSHC92.K6K8@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.7,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.8"/>
    </MLWV>

    <MLWV RW="HSHC92" WLNZRM="FYRJHSHC">
        <RMGVIUZXV RW="K6K8" RK="89.899.89.82" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC95.K7K8@9.8,HSHC94.K5K8@9.8,HSHC93.K6K8@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.7,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.8"/>
    </MLWV>

    <MLWV RW="HSHC91" WLNZRM="FYRJHSHC">
        <ZORZH GZITVG="ACAJ8.VMK4H9U9" UILN="K6K8" KLIG="3899"/>
        <ZORZH GZITVG="ACAJ7.VN8"      UILN="K6K8" KLIG="3898"/>
        <ZORZH GZITVG="ACAQ8.VML5"     UILN="K6K8" KLIG="3897"/>
        <ZORZH GZITVG="ACAQ7.VML7"     UILN="K6K8" KLIG="3896"/>
        <ZORZH GZITVG="SGAQ8.VML7"     UILN="K6K8" KLIG="3895"/>
        <ZORZH GZITVG="SGAQ7.VML7"     UILN="K6K8" KLIG="3894"/>
        <ZORZH GZITVG="SGHC8.VML8"     UILN="K6K8" KLIG="3893"/>
        <ZORZH GZITVG="SGHC7.VN8"      UILN="K6K8" KLIG="3892"/>
        <ZORZH GZITVG="SGHC6.VN8"      UILN="K6K8" KLIG="3891"/>
        <ZORZH GZITVG="SGHJ7.VN8"      UILN="K6K8" KLIG="3890"/>
        <ZORZH GZITVG="SGBW7.VN8"      UILN="K6K8" KLIG="3889"/>
        <ZORZH GZITVG="SGBW6.VN8"      UILN="K6K8" KLIG="3888"/>
        <ZORZH GZITVG="SGWO7.VN8"      UILN="K6K8" KLIG="3887"/>
        <!--ZORZH GZITVG="SGWO6.VN8"   UILN="K7K8" KLIG="3985"/-->
        <!--ZORZH GZITVG="*"           UILN="*"    KLIG="3984"/-->
        <ZORZH GZITVG="CAAQ8.VN8"      UILN="K6K8" KLIG="3886"/>
        <ZORZH GZITVG="CAAQ7.VN8"      UILN="K6K8" KLIG="3885"/>
        <ZORZH GZITVG="TGHJ8.VN8"      UILN="K6K8" KLIG="3884"/>
        <ZORZH GZITVG="XGSP8.VN8"      UILN="K6K8" KLIG="3883"/>
        <ZORZH GZITVG="BZAQ8.VN8"      UILN="K6K8" KLIG="3882"/>
        <ZORZH GZITVG="ACPYG.VN8"      UILN="K6K8" KLIG="3878"/>
        <ZORZH GZITVG="SGAA8.K8K8"     UILN="K6K8" KLIG="3877"/>
        <ZORZH GZITVG="AHAJ8.YLMW8"    UILN="K6K8" KLIG="3872"/>
        <ZORZH GZITVG="SGZRAQ8.VN8"    UILN="K6K8" KLIG="3871"/>
        <ZORZH GZITVG="ACAQ6.VN8"      UILN="K6K8" KLIG="3870" WRHGZMXV="4"/>
        <ZORZH GZITVG="SGHJ8.VN8"      UILN="K6K8" KLIG="3869"/>

        <RMGVIUZXV RW="K6K8" RK="89.899.89.81" ORHGVM="39946" LFG="HSHC88.K7K8@9.7,HSHC87.K7K8@9.7,HSHC86.K6K8@9.7,HSHC85.K6K8@9.7,HSHC84.K6K8@9.7,HSHC83.K6K8@9.7,HSHC82.K6K8@9.7,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7,FYRJYQ7.VN7,HSHC96.K7K7@9.8,HSHC95.K7K8@9.8,HSHC94.K5K8@9.8,HSHC93.K6K8@9.8,HSHC92.K6K8@9.8,SYAJ8.VMH6U6@9.8,SYAJ7.K7K8@9.8,SYAJ6.VN8@9.8,SYAJ5.K7K8@9.8,SYAJ4.K7K8@9.8,SYHA8.K4K8@9.8,SYHA7.K8K8@9.8"/>
    </MLWV>

    <MLWV RW="HSHC88" WLNZRM='HSHC'>
        <ZORZH GZITVG="QPAQ8.K6K8"     UILN="K7K8" KLIG="3799"/>
        <ZORZH GZITVG="QPAQ7.K6K8"     UILN="K7K8" KLIG="3798"/>
        <ZORZH GZITVG="QPAQ6.K6K8"     UILN="K7K8" KLIG="3797"/>
        <ZORZH GZITVG="ACAQ8.VML5"     UILN="K7K8" KLIG="3796"/>
        <ZORZH GZITVG="ACAQ7.VML7"     UILN="K7K8" KLIG="3795"/>
        <ZORZH GZITVG="SGAQ8.VML7"     UILN="K7K8" KLIG="3794"/>
        <ZORZH GZITVG="SGAQ7.VML7"     UILN="K7K8" KLIG="3793"/>
        <ZORZH GZITVG="SGHC8.VML8"     UILN="K7K8" KLIG="3792"/>
        <ZORZH GZITVG="SGHC7.VN8"      UILN="K7K8" KLIG="3791"/>
        <ZORZH GZITVG="SGHC6.VN8"      UILN="K7K8" KLIG="3790"/>
        <ZORZH GZITVG="SGHJ7.VN8"      UILN="K7K8" KLIG="3789"/>
        <ZORZH GZITVG="SGBW7.VN8"      UILN="K7K8" KLIG="3788"/>
        <ZORZH GZITVG="SGBW6.VN8"      UILN="K7K8" KLIG="3787"/>
        <ZORZH GZITVG="SGWO7.VN8"      UILN="K7K8" KLIG="3786"/>
        <ZORZH GZITVG="CAAQ8.VN8"      UILN="K7K8" KLIG="3785"/>
        <ZORZH GZITVG="CAAQ7.VN8"      UILN="K7K8" KLIG="3784"/>
        <ZORZH GZITVG="BZAQ8.VN8"      UILN="K7K8" KLIG="3783"/>
        <ZORZH GZITVG="SGAA8.K8K8"     UILN="K7K8" KLIG="3782"/>
        <ZORZH GZITVG="ACAQ6.VN8"      UILN="K7K8" KLIG="3781" WRHGZMXV="4"/>
        <ZORZH GZITVG="SGZRAQ8.VN8"    UILN="K7K8" KLIG="3780"/>
        <ZORZH GZITVG="SGHJ8.VN8"      UILN="K7K8" KLIG="3779"/>
        <RMGVIUZXV RW="K7K8" RK="89.899.79.88" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC91.K6K8@9.8,HSHC87.K7K8@9.8,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="HSHC87" WLNZRM='HSHC'>
        <RMGVIUZXV RW="K7K8" RK="89.899.79.87" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.7,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8 ,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="HSHC86" WLNZRM='HSHC'>
       <RMGVIUZXV RW="K6K8" RK="89.899.79.86" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8 ,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="HSHC85" WLNZRM='HSHC'>
        <RMGVIUZXV RW="K6K8" RK="89.899.79.85" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.8,HSHC86.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8 ,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="HSHC84" WLNZRM='HSHC'>
        <RMGVIUZXV RW="K6K8" RK="89.899.79.84" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.8,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC83.K6K8@9.8,HSHC82.K6K8@9.8 ,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="HSHC83" WLNZRM='HSHC'>
        <RMGVIUZXV RW="K6K8" RK="89.899.79.83" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.8,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC82.K6K8@9.8 ,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="HSHC82" WLNZRM='HSHC'>
        <RMGVIUZXV RW="K6K8" RK="89.899.79.82" ORHGVM="39946" LFG="HSHC96.K7K7@9.8,HSHC91.K6K8@9.8,HSHC88.K7K8@9.8,HSHC87.K7K8@9.8,HSHC86.K6K8@9.8,HSHC85.K6K8@9.8,HSHC84.K6K8@9.8,HSHC83.K6K8@9.8 ,FYRJ7.K6K7@9.7,FYRJ4.K8K8@9.7"/>
    </MLWV>

    <MLWV RW="QPAQ8" WLNZRM='FYRJFZMG'>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="K6K8" KLIG="1111" />
        <RMGVIUZXV RW="K6K8" RK="89.899.48.88" ORHGVM="39946" LFG="QPAQ8.K6K8,QPAQ7.K6K8,QPAQ6.K6K8"/>
    </MLWV>

    <MLWV RW="QPAQ7" WLNZRM='FYRJFZMG'>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="K6K8" KLIG="1111" />
        <RMGVIUZXV RW="K6K8" RK="89.899.48.87" ORHGVM="39946" LFG="QPAQ8.K6K8,QPAQ7.K6K8,QPAQ6.K6K8"/>
    </MLWV>

    <MLWV RW="QPAQ6" WLNZRM='FYRJFZMG'>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="K6K8" KLIG="1111" />
        <RMGVIUZXV RW="K6K8" RK="89.899.48.86" ORHGVM="39946" LFG="QPAQ8.K6K8,QPAQ7.K6K8,QPAQ6.K6K8"/>
    </MLWV>

    <MLWV RW="XGSP8" WLNZRM="XGAJ">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <RMGVIUZXV RW="VN8" RK="807.831.9.0" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="ACAQ8" WLNZRM="ACAQ">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VML5" KLIG="3333"/-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VML5" KLIG="2222"/>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VML5" KLIG="1111" />
        <RMGVIUZXV RW="VML5" RK="807.831.899.898" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="ACAQ7" WLNZRM="ACAQ">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VML7" KLIG="3333"/-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VML7" KLIG="2222"/>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VML7" KLIG="1111" />
        <RMGVIUZXV RW="VML7" RK="827.68.60.831" ORHGVM="39946"/>
    </MLWV>

	<MLWV RW="ACAQ6" WLNZRM="ACAQ" ZXGREV="UZOHV">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222"/>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="827.68.886.16" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="ACAJ8" WLNZRM="ACAJ">
        <ZORZH GZITVG="ACPYG.VN8"   UILN="VMK4H9U9" KLIG="80000" WRHGZMXV="9.8" />
        <RMGVIUZXV RW="VMK4H9U9" RK="827.72.81.42" ORHGVM="39946" LFG="ACAJ8.VMK4H9U9,ACAJ7.VN8@9.8,ACDRM-8.{689699xx-0u5w-55wz-0wu9-0444x34566wu}" />
    </MLWV>

    <MLWV RW="ACAJ7" WLNZRM="ACAJ">
        <ZORZH GZITVG="ACPYG.VN8"   UILN="VN8" KLIG="80000" WRHGZMXV="9.8" />
        <RMGVIUZXV RW="VN8" RK="827.72.81.39" ORHGVM="39946" LFG="ACAJ8.VMK4H9U9,ACAJ7.VN8@9.8,ACDRM-8.{689699xx-0u5w-55wz-0wu9-0444x34566wu},ACDRM-7.{11wyx792-956u-50v9-007y-x7084uvu92wy}"/>
    </MLWV>
    <MLWV RW="ACDRM-8" WLNZRM="ACAJ">
        <RMGVIUZXV RW="{689699xx-0u5w-55wz-0wu9-0444x34566wu}" RK="827.72.81.41" ORHGVM="39946" LFG="ACAJ8.VMK4H9U9,ACAJ7.VN8" />
    </MLWV>
    <MLWV RW="ACDRM-7" WLNZRM="ACAJ">
        <RMGVIUZXV RW="{11wyx792-956u-50v9-007y-x7084uvu92wy}" RK="827.72.81.40" ORHGVM="39946" LFG="ACAJ7.VN8" />
    </MLWV>

    <MLWV RW="ACPYG" WLNZRM="ACAJ">
        <ZORZH GZITVG="HSHC95.K7K8" UILN="VN8" KLIG="0000" />
        <RMGVIUZXV RW="VN8" RK="827.72.86.28" ORHGVM="39946" LFG="HSHC95.K7K8@9.8,ACAJ8.VMK4H9U9@9.8,ACAJ7.VN8@9.8"/>
    </MLWV>

    <MLWV RW="SGAQ8" WLNZRM="SGAQ">
	    <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VML7" KLIG="3333"/-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VML7" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VML7" KLIG="1111" />
        <RMGVIUZXV RW="VML7" RK="827.81.49.73" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="SGAQ7" WLNZRM="SGAQ">
	    <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VML7" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VML7" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VML7" KLIG="1111" />
        <RMGVIUZXV RW="VML7" RK="827.81.49.75" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="TGHJ8" WLNZRM="TGHJ" ZXGREV="UZOHV">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <RMGVIUZXV RW="VN8" RK="807.831.8.757" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="SGHC8" WLNZRM="SGJS">
	    <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VML8" KLIG="3333" /-->
	<ZORZH GZITVG="HSHC91.K6K8" UILN="VML8" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VML8" KLIG="1111" />
        <RMGVIUZXV RW="VML8" RK="807.831.35.899" ORHGVM="39946"/>
        <RMGVIUZXV RW="VMH6U9" RK="89.892.29.746" ORHGVM="39945" LFG="SYAJ6.VN8"/>
    </MLWV>


    <MLWV RW="SGWO7" WLNZRM="SGWO">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="827.869.84.843" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="CAAQ8" WLNZRM="CAJS">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="807.39.88.852" ORHGVM="39946"/>
    </MLWV>
    <MLWV RW="CAAQ7" WLNZRM="CAJS">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VML8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="807.39.88.813" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="SGZRAQ8" WLNZRM="SGZRJS">
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="89.84.63.35" ORHGVM="39946"/>
    </MLWV>

<!-- EKM WRIVXG XLMMVXG -->
    <MLWV RW="AHAJ8" WLNZRM="AHAJ">
        <ZORZH GZITVG="HSHC91.K6K8" UILN="YLMW8" KLIG="2222" />
        <RMGVIUZXV RW="YLMW8" RK="89.764.69.42" ORHGVM="39946" LFG="AHDRM-7.{020302u0-30w9-5980-z619-vu7xw9w95xu0}"/>
    </MLWV>

    <MLWV RW="AHDRM-7" WLNZRM="AHAJ">
        <RMGVIUZXV RW="{020302u0-30w9-5980-z619-vu7xw9w95xu0}" RK="89.764.69.43" ORHGVM="39946" LFG="AHAJ8.YLMW8" />
    </MLWV>

    <MLWV RW="BZAQ8" WLNZRM="BZJS">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333"/-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222"/>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="89.66.872.3" ORHGVM="39946"/>
     </MLWV>

<!--KILCB FYRJHS-->

    <MLWV RW="SGBW7" WLNZRM="SGJS">
	    <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
	    <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <RMGVIUZXV RW="VN8" RK="807.831.830.40" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="SGBW6" WLNZRM="SGJS">
	    <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
	    <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <RMGVIUZXV RW="VN8" RK="807.831.830.24" ORHGVM="39946"/>
    </MLWV>

<!--  SYAJ  -->
    <MLWV RW="SYAJ8" WLNZRM="SYAJ">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="VMH6U6" RK="89.892.25.86" KLIG="39946" WRHGZMXV="9.8"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VMH6U6" RK="89.892.25.81" KLIG="39946"/>
        <RMGVIUZXV RW="VMH6U6" RK="89.799.33.70" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8,SYAJ2.K8K8,SYHA6.K2K8"/>
    </MLWV>

    <MLWV RW="SYAJ7" WLNZRM="SYAJ">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="K7K8" RK="89.892.25.86" KLIG="39946" WRHGZMXV="9.8"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="K7K8" RK="89.892.25.81" KLIG="39946"/>
        <RMGVIUZXV RW="K7K8" RK="89.799.33.45" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8,SYAJ2.K8K8,SYHA6.K2K8"/>
    </MLWV>

    <MLWV RW="SYAJ6" WLNZRM="SYAJ">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" RK="89.892.25.86" KLIG="39946" WRHGZMXV="9.8"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" RK="89.892.25.81" KLIG="39946"/>
        <RMGVIUZXV RW="VN8" RK="89.799.33.801" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8,SYAJ2.K8K8,SYHA6.K2K8"/>
    </MLWV>

    <MLWV RW="SYAJ5" WLNZRM="SYAJ">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="K7K8" RK="89.892.25.86" KLIG="39946" WRHGZMXV="9.8"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="K7K8" RK="89.892.25.81" KLIG="39946"/>
        <RMGVIUZXV RW="K7K8" RK="89.799.33.784" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8,SYAJ2.K8K8,SYHA6.K2K8"/>
    </MLWV>

    <MLWV RW="SYAJ4" WLNZRM="SYAJ">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="K7K8" RK="89.892.25.86" KLIG="39946" WRHGZMXV="9.8"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="K7K8" RK="89.892.25.81" KLIG="39946"/>
        <RMGVIUZXV RW="K7K8" RK="89.799.33.783" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8,SYAJ2.K8K8,SYHA6.K2K8"/>
    </MLWV>

	<MLWV RW="SYAJ3" WLNZRM="SYAJ">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="K8K8" RK="89.892.25.86" KLIG="39946" WRHGZMXV="9.8"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="K8K8" RK="89.892.25.81" KLIG="39946"/>
        <RMGVIUZXV RW="K8K8" RK="89.799.33.827" ORHGVM="39946" LFG="SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8,SYAJ2.K8K8,SYHA8.K4K8,SYHA7.K8K8,SYHA6.K2K8"/>
    </MLWV>

    <MLWV RW="SYAJ2" WLNZRM="SYAJ">
        <ZORZH GZITVG="HSHC96.K7K7" UILN="K8K8" RK="89.892.25.86" KLIG="39946" WRHGZMXV="9.8"/>
        <ZORZH GZITVG="HSHC91.K6K8" UILN="K8K8" RK="89.892.25.81" KLIG="39946"/>
        <RMGVIUZXV RW="K8K8" RK="89.799.33.826" ORHGVM="39946" LFG="SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8,SYAJ2.K8K8,SYHA8.K4K8,SYHA7.K8K8,SYHA6.K2K8"/>
    </MLWV>

    <MLWV RW="SYHA8" WLNZRM="SYAJ">
        <RMGVIUZXV RW="K4K8" RK="89.29.33.73" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8@9.8,SYAJ2.K8K8,SYHA6.K2K8"/>
    </MLWV>

    <MLWV RW="SYHA7" WLNZRM="SYAJ">
        <!--ZORZH GZITVG="HSHC91.K6K8" UILN="K8K8" RK="89.892.25.81" KLIG="39946"/-->
        <RMGVIUZXV RW="K8K8" RK="89.29.33.53" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8@9.8,SYAJ2.K8K8,SYHA6.K2K8"/>
    </MLWV>

	<MLWV RW="SYHA6" WLNZRM="SYAJ">
        <RMGVIUZXV RW="K2K8" RK="89.29.33.41" ORHGVM="39946" LFG="SYHA8.K4K8,SYHA7.K8K8,SYAJ8.VMH6U6,SYAJ7.K7K8,SYAJ6.VN8,SYAJ5.K7K8,SYAJ4.K7K8,SYAJ3.K8K8@9.8,SYAJ2.K8K8"/>
    </MLWV>

<!--  XGZ  -->
    <MLWV RW="SGHJ8" WLNZRM="SGJS">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <RMGVIUZXV RW="VN8" RK="89.778.8.899" ORHGVM="39946"/>
    </MLWV>
    <MLWV RW="SGHJ7" WLNZRM="SGJS">
	    <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
	    <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <RMGVIUZXV RW="VN8" RK="89.778.8.898" ORHGVM="39946"/>
    </MLWV>

    <MLWV RW="SGHC7" WLNZRM="SGJS">
	    <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333"/-->
	    <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222"/>
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="807.831.35.767" ORHGVM="39946"/>
    </MLWV>
    <MLWV RW="SGHC6" WLNZRM="SGJS" ZXGREV="UZOHV">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="VN8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="VN8" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="VN8" KLIG="1111" />
        <RMGVIUZXV RW="VN8" RK="807.831.35.53" ORHGVM="39946"/>
    </MLWV>
    <MLWV RW="SGAA8" WLNZRM="SGJS">
        <!--ZORZH GZITVG="HSHC96.K7K7" UILN="K8K8" KLIG="3333" /-->
        <ZORZH GZITVG="HSHC91.K6K8" UILN="K8K8" KLIG="2222" />
        <ZORZH GZITVG="HSHC88.K7K8" UILN="K8K8" KLIG="1111" />
        <RMGVIUZXV RW="K8K8" RK="807.831.760.48" ORHGVM="39946"/>
    </MLWV>
    <!--MLWV RW="wvhp984" WLNZRM="FYRJFZMG">
        <RMGVIUZXV RW="{7625uw08-819y-5u1w-y56x-2x148x6w21yz}" RK="89.81.8.84" ORHGVM="39946" LFG="WVE8.K7K8" />
    </MLWV-->

</IVWHSRUG_GLKLOLTB>
//##**---------------- ./IVWHSRUG/KBGSLM/DLINSLOVGZYOV.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG FYRJGLLO.HSN_GLLO ZH HSN_GLLO
UILN VMFN RNKLIG rMGvMFN

XOZHH wZGZgBKV(rMGvMFN):
    xszi = 8,
    rmg = 7,
    olmt = 6,
    uolzg = 5,
    wlfyov = 4


XOZHH uRVOWwZGZ(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

    WVU KZIHV(HVOU, HSN, RMW):
        HVOU.URVOW_MZNV = HSN.IVZW_GL_ZHXRR(RMW, 1)
        HVOU.URVOW_DRWGS = HSN.IVZW_GL_RMG(RMW+1, 7)
        HVOU.URVOW_GBKV = HSN.IVZW_GL_RMG(RMW+89, 5)
        HVOU.URVOW_LUUHVG = HSN.IVZW_GL_RMG(RMW+85, 1)
        HVOU.URVOW_RMW = HSN.IVZW_GL_RMG(RMW+77, 1)


XOZHH hSNgZYOV(LYQVXG):
    WVU __RMRG__(HVOU, MZNV):
        HRAV = HSN_GLLO.hSN.URMW_HRAV(MZNV)
        RU HRAV == -8:
            HVOU.RH_LKVM = uZOHV
            IVGFIM
        HVOU.HSN = HSN_GLLO.hSN(MZNV, HRAV)
        HVOU.HSN.LKVM()
        HVOU.RH_LKVM = HVOU.HSN.HGZGFH
        HVOU.TILFK_MZNV = HVOU.HSN.IVZW_GL_ZHXRR(9, 67)
        HVOU.IZMWLN_RW = HVOU.HSN.IVZW_GL_ZHXRR(67, 1)
        HVOU.RH_FKWZGVW = HVOU.HSN.IVZW_GL_RMG(59, 1)
        HVOU.IVUVIVMXV = HVOU.HSN.IVZW_GL_RMG(51, 1)
        HVOU.GRNVHGZNK = HVOU.HSN.IVZW_GL_RMG(43, 1)
        HVOU.NZGIRC_MZNV = HVOU.HSN.IVZW_GL_ZHXRR(35, 83)
        HVOU.ILD_MFN = HVOU.HSN.IVZW_GL_RMG(19, 5)
        HVOU.XLO_MFN = HVOU.HSN.IVZW_GL_RMG(15, 5)
        HVOU.SVZWVI_HRAV = HVOU.HSN.IVZW_GL_RMG(11, 1)
        HVOU.NZGIRC_HRAV = HVOU.HSN.IVZW_GL_RMG(03, 1)
        HVOU.ILD_OVMTGS = HVOU.HSN.IVZW_GL_RMG(895, 1)
        # KIRMG(HVOU.SVZWVI_HRAV, HVOU.NZGIRC_HRAV)
        HVOU.URVOW_ORHG = []
        HVOU.URVOW_NZK = {}

        ULI R RM IZMTV(HVOU.XLO_MFN):
            URVOW = uRVOWwZGZ()
            URVOW.KZIHV(HVOU.HSN, 887+61*R)
            HVOU.URVOW_ORHG.ZKKVMW(URVOW)
            HVOU.URVOW_NZK[URVOW.URVOW_MZNV] = R
            #KIRMG(R, URVOW.URVOW_MZNV, URVOW.URVOW_GBKV, URVOW.URVOW_LUUHVG, URVOW.URVOW_RMW)
        HVOU.WZGZ_RMW = 887 + 61 * HVOU.XLO_MFN


    WVU HSFGWLDM(HVOU):
        HVOU.HSN.DIRGV_RMG(51, 1, -8)

    WVU LKVM(HVOU):
        IVGFIM HVOU.RH_LKVM


    WVU IVZW_GL_UOLZG(HVOU, KLH, MFN):
        RNKLIG HGIFXG
        RU MFN == 5:
            IVGFIM HGIFXG.FMKZXP('U', HVOU.HSN.IVZW(KLH, MFN))[9]
        VOHV:
            IVGFIM HGIFXG.FMKZXP('W', HVOU.HSN.IVZW(KLH, MFN))[9]


    WVU __TVGRGVN__(HVOU, KLH):
        RU RHRMHGZMXV(KLH[8],HGI):
           K8 = HVOU.URVOW_NZK[KLH[8]]
        VOHV:
           K8 = KLH[8]
        RU KLH[9] >= HVOU.ILD_MFN:
            IZRHV eZOFVvIILI('ILD MFNYVI LEVIUOLD %W EH %W'%(K9, HVOU.ILD_MFN))
        RU K8 >= HVOU.XLO_MFN:
            IZRHV eZOFVvIILI('XLO MFNYVI LEVIUOLD %W EH %W'%(K8, HVOU.XLO_MFN))
        URVOW_WZGZ = HVOU.URVOW_ORHG[K8]
        RMW = HVOU.WZGZ_RMW + KLH[9] * HVOU.ILD_OVMTGS + URVOW_WZGZ.URVOW_LUUHVG
        RU URVOW_WZGZ.URVOW_GBKV == 8:
            IVGFIM HVOU.HSN.IVZW_GL_FGU1(RMW, URVOW_WZGZ.URVOW_DRWGS)
        VORU URVOW_WZGZ.URVOW_GBKV == 7:
            IVGFIM HVOU.HSN.IVZW_GL_RMG(RMW, URVOW_WZGZ.URVOW_DRWGS)
        VORU URVOW_WZGZ.URVOW_GBKV == 6:
            IVGFIM HVOU.HSN.IVZW_GL_RMG(RMW, URVOW_WZGZ.URVOW_DRWGS)
        VORU URVOW_WZGZ.URVOW_GBKV == 5:
            IVGFIM HVOU.IVZW_GL_UOLZG(RMW, URVOW_WZGZ.URVOW_DRWGS)
        VORU URVOW_WZGZ.URVOW_GBKV == 4:
            IVGFIM HVOU.IVZW_GL_UOLZG(RMW, URVOW_WZGZ.URVOW_DRWGS)



//##**---------------- ./IVWHSRUG/KBGSLM/DLINSLOV
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH/IVWHSRUG')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG FYRJGLLO.HSN_GLLO ZH HSN_GLLO
UILN VMFN RNKLIG rMGvMFN
# RNKLIG WZGVGRNV
RNKLIG TVGLKG
RNKLIG DLINSLOVGZYOV ZH DS


RU __MZNV__ == '__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'N:', ['NVNLIB='])
    HSN = ''
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-N', '--NVNLIB'):
            HSN = ZIT
    RU HSN=='':
        IZRHV eZOFVvIILI('NFHG HKVXRUB NVNLIB DRGS -N')

    HSN_GZYOV = DS.hSNgZYOV(HSN)
    RU MLG HSN_GZYOV.LKVM():
        HBH.VCRG(-8)
    KIRMG('TILFKMZNV:', HSN_GZYOV.TILFK_MZNV)
    KIRMG('IZMWLN_RW:', HSN_GZYOV.IZMWLN_RW)
    KIRMG('RH_FKWZGVW:', HSN_GZYOV.RH_FKWZGVW)
    KIRMG('IVUVIVMXV:', HSN_GZYOV.IVUVIVMXV)
    KIRMG('GRNVHGZNK:', HSN_GZYOV.GRNVHGZNK)
    KIRMG('ILD MFN:', HSN_GZYOV.ILD_MFN)
    KIRMG('XLO MFN:', HSN_GZYOV.XLO_MFN)
    KIRMG('SVZWVI HRAV:', HSN_GZYOV.SVZWVI_HRAV)
    KIRMG('NZGIRC HRAV:', HSN_GZYOV.NZGIRC_HRAV)
    KIRMG('ILD OVMTGS:', HSN_GZYOV.ILD_OVMTGS)
    KIRMG(HSN_GZYOV[8, 8], HSN_GZYOV[9, 8])
//##**---------------- ./IVWHSRUG/IVOVZHV.HS
HVG -V
. /RMX/EVIHRLM.RMX
NZPV
NZPV RMHGZOO
NPWRI -K /LKG/EVIHRLM/YFROW/IVWHSRUG
XK -i ./* /LKG/EVIHRLM/YFROW/IVWHSRUG/
GLFXS /LKG/EVIHRLM/YFROW/IVWHSRUG/__RMRG__.KB
XK /LKG/EVIHRLM/YFROW/IVWHSRUG/IWGLLO/GVHGXLM.KB   /LKG/EVIHRLM/YFROW/YRM/IVWHSRUG
XK /LKG/EVIHRLM/YFROW/IVWHSRUG/IWGLLO/HSLDILFGV.KB /LKG/EVIHRLM/YFROW/YRM/FILFGV
XK /LKG/EVIHRLM/YFROW/IVWHSRUG/IWGLLO/DZGXSWLT.KB  /LKG/EVIHRLM/YFROW/YRM/DZGXSWLT
XK VGX/IVWHSRUG.RMX /RMX/
XK RMXOFWV/DLINSLOV.S /LKG/EVIHRLM/YFROW/RMXOFWV
NPWRI -K /LKG/EVIHRLM/YFROW/KBGSLM-ORYH/IVWHSRUG
XK KBGSLM/DLINSLOVGZYOV.KB /LKG/EVIHRLM/YFROW/KBGSLM-ORYH/IVWHSRUG/DLINSLOVGZYOV.KB
XK KBGSLM/DLINSLOV /LKG/EVIHRLM/YFROW/YRM/DLINSLOV
wri="$( XW "$( WRIMZNV "${yzhs_hlfixv[9]}"   )" && KDW   )"
NPWRI -K /LKG/EVIHRLM/$xlnkrov_evihrlm/KBGSLM-ORYH/
XK ${wri}/ORY/KBDLINSLOV.HL /LKG/EVIHRLM/$xlnkrov_evihrlm/KBGSLM-ORYH/
#NPWRI -K /LKG/EVIHRLM/$xlnkrov_evihrlm/IVWHSRUG
#XK -i ./* /LKG/EVIHRLM/$xlnkrov_evihrlm/IVWHSRUG/
#GLFXS /LKG/EVIHRLM/$xlnkrov_evihrlm/IVWHSRUG/__RMRG__.KB
#XK /LKG/EVIHRLM/$xlnkrov_evihrlm/IVWHSRUG/IWGLLO/GVHGXLM.KB /LKG/EVIHRLM/$xlnkrov_evihrlm/YRM/IVWHSRUG
#XK /LKG/EVIHRLM/$xlnkrov_evihrlm/IVWHSRUG/IWGLLO/HSLDILFGV.KB /LKG/EVIHRLM/$xlnkrov_evihrlm/YRM/FILFGV
//##**---------------- ./IVWHSRUG/RMXOFWV/GZITVG.S
/**********************************************
 * \EVIHRLM   9.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7982-95-88
 * \NLWRURVW  7982-95-88
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/


#RUMWVU _IVWHSRUG_GZITVG_ss_olouXHgWPl__
#WVURMV _IVWHSRUG_GZITVG_ss_olouXHgWPl__

MZNVHKZXV GZITVG{

    /** \YIRVU z FHVUFO NVGSLW.
     *  \KZIZN OVEVO ZM RMGVTVI HVGGRMT SLD FHVUFO GL YV
     *  \IVGFIM lFGKFG GSZG RH VCGIZ FHVUFO
     *  gSRH NVGSLW WLVH FMYVORVEZYOB FHVUFO GSRMTH.
     *  zMW IVGFIMH VCXVKGRLMZOOB FHVUFO IVHFOGH.
     *  fHV RG VEVIBWZB DRGS TLLW SVZOGS.
     *  \FHZTV:
     * @XLWV
     *    GG(6); // wL MLGSRMT 6 GRNVH.
     * @VMWXLWV
     */

    RMORMV RMG GG(RMG OVEVO = 9){
        IVGFIM OVEVO;
    }


    /**
    *  \XOZHH vCZNKOVxOZHH
    *  \YIRVU z GVHG XOZHH.
    *  z NLIV WVGZROVW XOZHH WVHXIRKGRLM.
    */
    XOZHH vCZNKOVxOZHH
    {

        KFYORX:

            /// xIVZGV ZM vCZNKOVxOZHH
            vCZNKOVxOZHH();

            /// xIVZGV ZM vCZNKOVxOZHH DRGS OLG'H LU RMGRZO EZOFVH
            vCZNKOVxOZHH(RMG Z, UOLZG Y);

            ~vCZNKOVxOZHH();

            /// gSRH NVGSLW WLVH HLNVGSRMT
            ELRW wLhLNVGSRMT();

            /** gSRH RH Z NVGSLW GSZG WLVH HL
             * NFXS GSZG r NFHG DIRGV ZM VKRX
             * MLEVO QFHG GL WVHXIRYV SLD NFXS
             * RG GIFOB WLVH. */
            ELRW wLmLGSRMT();

            /** \YIRVU z FHVUFO NVGSLW.
             * \KZIZN OVEVO ZM RMGVTVI HVGGRMT SLD FHVUFO GL YV
             * \IVGFIM lFGKFG GSZG RH VCGIZ FHVUFO
             *
             * gSRH NVGSLW WLVH FMYVORVEZYOB FHVUFO GSRMTH.
             * zMW IVGFIMH VCXVKGRLMZOOB FHVUFO IVHFOGH.
             * fHV RG VEVIBWZB DRGS TLLW SVZOGS.
             */
            ELRW* eVIBfHVUFOnVGSLW(YLLO OVEVO);

        KIREZGV:
            /// GSV JFVHGRLM
            XLMHG XSZI* UjFVHGRLM;
            RMG UzMHDVI;           ///< GSV ZMHDVI

    };


}

#VMWRU
//##**---------------- ./IVWHSRUG/RMXOFWV/DLINSLOV.S
#RUMWVU s_ivwhsrug_dlinslov_
#WVURMV s_ivwhsrug_dlinslov_

#RMXOFWV <RLHGIVZN>
#RMXOFWV <HGWORY.S>
#RMXOFWV <EVXGLI>
#RMXOFWV <HGIRMT>
#RMXOFWV <NZK>
#RMXOFWV <FMLIWVIVW_NZK>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV <HBH/NNZM.S>
#RMXOFWV <HBH/HGZG.S>
#RMXOFWV <UXMGO.S>
#RMXOFWV "IWSVOKVI/IVWHSRUG_XORVMG.S"

MZNVHKZXV IVWHSRUG{

    VMFN wZGZgBKV{
        xszi = 8,
        rmg = 7,
        olmt = 6,
        uolzg = 5,
        wlfyov = 4
    };


    HGIFXG __ZGGIRYFGV__((__KZXPVW__)) uRVOWwZGZ {
        XSZI URVOW_MZNV[1];
        FMHRTMVW HSLIG URVOW_DRWGS;
        wZGZgBKV URVOW_GBKV;
        FMHRTMVW OLMT LUUHVG;
        FMHRTMVW OLMT RMW;
        ELRW *K;
        GVNKOZGV <GBKVMZNV g> uRVOWwZGZ& dIRGV(g WZGZ)
        {
            //RU (URVOW_GBKV == wZGZgBKV::xszi)
            //{
            //HGIXKB((XSZI*)K, WZGZ);
            //IVGFIM *GSRH;
            //}
            //HGW::XLFG<<URVOW_DRWGS<<" "<<K<<" "<<WZGZ<<HGW::VMWO;
            //HGW::XLFG<<*(UOLZG*)K<<" "<<*(UOLZG*)&WZGZ<<" "<<URVOW_DRWGS<<" "<<WZGZ<<HGW::VMWO;
            NVNXKB(K, &WZGZ, URVOW_DRWGS);
            //HGW::XLFG<<*(UOLZG*)K<<" "<<*(UOLZG*)&WZGZ<<" "<<URVOW_DRWGS<<" "<<WZGZ<<HGW::VMWO;
            IVGFIM *GSRH;
        }

        GVNKOZGV <GBKVMZNV g> g iVZW()
        {
            g IVG;
            //HGW::XLFG<<URVOW_DRWGS<<" "<<K<<HGW::VMWO;
            NVNXKB(&IVG, K, URVOW_DRWGS);
            //HGW::XLFG<<IVG<<HGW::VMWO;
            IVGFIM IVG;
        }

        HGW::HGIRMT iVZWxSZI()
        {
            IVGFIM HGW::HGIRMT((XSZI*)K);
        }
        //GVNKOZGV <> uRVOWwZGZ& dIRGV(XLMHG XSZI* WZGZ)
        //{
        //HGIXKB((XSZI*)K, WZGZ);
        //IVGFIM *GSRH;
        //}
    };

    GVNKOZGV <> RMORMV uRVOWwZGZ& uRVOWwZGZ::dIRGV(XLMHG XSZI* WZGZ)
    {
        NVNHVG((XSZI*)K, 9, URVOW_DRWGS);
        HGIXKB((XSZI*)K, WZGZ);
        IVGFIM *GSRH;
    }



    HGIFXG nZGIRCwZGZ{
        iVWHSRUGxORVMG *IVWHSRUG;
        /*
         * WVHXIRYVH NVGZ RMUL ULI VZXS URVOW
         * */
        /*
         * HSN SVZWVI WZGZ, DROO WVHXIRYVI NZGIRC HGIFXFIV
         * */
        HGIFXG  __ZGGIRYFGV__((__KZXPVW__)) sVZWVIwZGZ{
            XSZI TILFK_MZNV[67];
            XSZI IZMWLN_RW[1]; // VEVIBGRNV KILTIZN HGZIGH, IZMWLN_RW IVTVMVIZGVW
            OLMT RH_FKWZGVW;
            OLMT IVUVIVMXV; // IVUVIVMXV RW
            OLMT GRNVHGZNK; // FH HRMXV VKLXS
            XSZI NZGIRC_MZNV[83];// NZGIRC MZNV
            FMHRTMVW RMG ILD_MFN; // NZGIRC XLO MFNYVI
            FMHRTMVW RMG XLO_MFN; // NZGIRC ILD MFNYVI
            FMHRTMVW OLMT SVZWVI_HRAV;
            FMHRTMVW OLMT NZGIRC_HRAV; // NZGIRC GLGZO HRAV
            FMHRTMVW OLMT ILD_OVMTGS; // HRAV ULI VZXS NZGIRC ILD
            sVZWVIwZGZ(){
                NVNHVG(GSRH, 9, HRAVLU(sVZWVIwZGZ));
                ILD_MFN = 9;
                XLO_MFN = 9;
                RH_FKWZGVW = 9;
                NZGIRC_HRAV = 9;
                ILD_OVMTGS = 9;
            }

            sVZWVIwZGZ& tVMVIZGV(){
                IVUVIVMXV = 9;
                ZFGL IW = FYRJGLLO::tVMVIZGViZMWLNhGIRMT(2);
                GRNVHGZNK = FYRJGLLO::tVGnRXILHVXLMWHhRMXVvKLXS();
                HGIXKB(IZMWLN_RW, IW.X_HGI());
                IVGFIM *GSRH;
            }
        };

        sVZWVIwZGZ SVZWVI_WZGZ;
        FMHRTMVW RMG ILD(){IVGFIM SVZWVI_WZGZ.ILD_MFN;}
        FMHRTMVW RMG XLO(){IVGFIM SVZWVI_WZGZ.XLO_MFN;}

        HGW::NZK<wZGZgBKV, FMHRTMVW HSLIG> wZGZgBKVhRAVnZK;
        FMHRTMVW HSLIG W6;
        HGW::EVXGLI<uRVOWwZGZ> URVOW_WZGFN;
        XSZI *K_WZGZ;
        XSZI *K_NVN;
        YLLO RMXIVNVMGZO_YFNK;
        OLMT HSN_OVMTGS;
        HGW::FMLIWVIVW_NZK<HGW::HGIRMT, uRVOWwZGZ> URVOW_NZK;

        HGW::EVXGLI<HGW::EVXGLI<uRVOWwZGZ> > URVOW_NVGZH;


        nZGIRCwZGZ& fKWZGV()
        {
            ((sVZWVIwZGZ*)K_NVN)->GRNVHGZNK = FYRJGLLO::tVGnRXILHVXLMWHhRMXVvKLXS();
            ((sVZWVIwZGZ*)K_NVN)->RH_FKWZGVW = 8;
            IVGFIM *GSRH;
        }

        nZGIRCwZGZ& hSFGWLDM()
        {
            ((sVZWVIwZGZ*)K_NVN)->GRNVHGZNK = FYRJGLLO::tVGnRXILHVXLMWHhRMXVvKLXS();
            ((sVZWVIwZGZ*)K_NVN)->IVUVIVMXV = -8;
            IVGFIM *GSRH;
        }
        // ZWW MVD NZGIRC
        nZGIRCwZGZ& NZGIRC(XLMHG XSZI* MZNV)
        {
            ++W6;
            RU (HGIOVM(MZNV) > 84)
            {
                FYRJGSILD("NZGIRC MZNV NFHG YV HSLIGVI GSZM 83", -8);
            }
            HGIXKB(SVZWVI_WZGZ.NZGIRC_MZNV, MZNV);
            IVGFIM *GSRH;
        }

        // HVG TILFK MZNV
        nZGIRCwZGZ& TILFK(XLMHG XSZI* MZNV)
        {
            RU (HGIOVM(MZNV) > 68)
            {
                FYRJGSILD("TILFK MZNV NFHG YV HSLIGVI GSZM 67", -8);
            }
            HGIXKB(SVZWVI_WZGZ.TILFK_MZNV, MZNV);
            IVGFIM *GSRH;
        }
// XGLI
        nZGIRCwZGZ(YLLO RMXIVNVMGZO=UZOHV){
            W6 = 9;
            K_WZGZ = mfoo;
            RMXIVNVMGZO_YFNK = RMXIVNVMGZO;
            wZGZgBKVhRAVnZK[xszi] = 8;
            wZGZgBKVhRAVnZK[rmg] = 5;
            wZGZgBKVhRAVnZK[olmt] = 1;
            wZGZgBKVhRAVnZK[uolzg] = 5;
            wZGZgBKVhRAVnZK[wlfyov] = 1;
            //IVWHSRUG = MVD iVWHSRUGxORVMG("872.9.9.8", "49939");
        }

        nZGIRCwZGZ& HVG_IVWHSRUG(iVWHSRUGxORVMG* K)
        {
            IVWHSRUG = K;
            IVGFIM *GSRH;
        }



        ELRW hFNNZIB(){
            HGW::XLFG<<"-----------------\MtILFK mZNV:"<<SVZWVI_WZGZ.TILFK_MZNV<<HGW::VMWO;
            HGW::XLFG<<"nZGIRC: "<<W6<<" --> "<<SVZWVI_WZGZ.NZGIRC_MZNV;
            HGW::XLFG<<HGW::VMWO;
            HGW::XLFG<<"iLD:" <<SVZWVI_WZGZ.ILD_MFN<<HGW::VMWO;
            HGW::XLFG<<"xLOFNM:"<<SVZWVI_WZGZ.XLO_MFN<<" --> ";
            uli_vzxs(P, URVOW_WZGFN)
            {
                HGW::XLFG<<" | "<<P->URVOW_MZNV;
            }
            HGW::XLFG<<HGW::VMWO;
            HGW::XLFG<<"nZGIRC hRAV: "<<SVZWVI_WZGZ.NZGIRC_HRAV<<" yBGVH"<<HGW::VMWO;
        }

        // ZWW MVD ILD
        nZGIRCwZGZ& ILD(FMHRTMVW HSLIG W)
        {
            SVZWVI_WZGZ.ILD_MFN = W;
            IVGFIM *GSRH;
        }

        // ZWW MVD XLOFNM
        nZGIRCwZGZ& XLOFNM(XLMHG XSZI* MZNV, wZGZgBKV GBKV, FMHRTMVW HSLIG HA = 9)
        {
            RU (HGIOVM(MZNV) >2)
                FYRJGSILD("XLOFNM MZNV NFHG < 2 XSZIH", -8);
            ++SVZWVI_WZGZ.XLO_MFN;
            FMHRTMVW HSLIG URVOW_HRAV;
            uRVOWwZGZ URVOW_WZGZ;
            NVNHVG(&URVOW_WZGZ, 9, HRAVLU(URVOW_WZGZ) );
            URVOW_WZGZ.URVOW_GBKV = GBKV;
            HGIXKB(URVOW_WZGZ.URVOW_MZNV, MZNV);
            URVOW_WZGZ.LUUHVG = SVZWVI_WZGZ.ILD_OVMTGS;
            RU (HA != 9)
            {
                URVOW_HRAV  = HA;
            }
            VOHV
            {
                URVOW_HRAV = wZGZgBKVhRAVnZK[GBKV];
            }
            SVZWVI_WZGZ.ILD_OVMTGS += URVOW_HRAV;
            SVZWVI_WZGZ.NZGIRC_HRAV += URVOW_HRAV;
            URVOW_WZGZ.URVOW_DRWGS = URVOW_HRAV;
            URVOW_NZK[MZNV] = URVOW_WZGZ;
            URVOW_WZGFN.KFHS_YZXP(URVOW_WZGZ);
            IVGFIM *GSRH;
        }

        // IVXLMURTFIV ZMW ZORTM ZOO NVNLIB
        nZGIRCwZGZ& xLNKROV()
        {
            SVZWVI_WZGZ.tVMVIZGV();
            // ZHHRTM WZGZ GL SVZWVI HGIFXGFIV
            SVZWVI_WZGZ.SVZWVI_HRAV = HRAVLU(sVZWVIwZGZ) + SVZWVI_WZGZ.XLO_MFN * HRAVLU(uRVOWwZGZ);
            SVZWVI_WZGZ.NZGIRC_HRAV *= SVZWVI_WZGZ.ILD_MFN;
            IVGFIM *GSRH;
        }

        nZGIRCwZGZ& mLINZORAV(){
            // MLINZORAV RMGVIMZO WZGZ HGIFXGFIV
            URVOW_NVGZH.XOVZI();
            ULI (FMHRTMVW RMG R=9; R<ILD(); ++R)
            {
                URVOW_NVGZH.KFHS_YZXP(HGW::EVXGLI<uRVOWwZGZ>());
                uli_vzxs(P, URVOW_WZGFN)
                {
                    uRVOWwZGZ UW = *P;
                    UW.RMW = UW.LUUHVG+R*SVZWVI_WZGZ.ILD_OVMTGS;
                    UW.K = K_WZGZ + UW.RMW;
                    //HGW::XLFG<<UW.RMW<<HGW::VMWO;
                    URVOW_NVGZH[R].KFHS_YZXP(UW);
                }
            }
            IVGFIM *GSRH;
        }

        // LKVM HSN, XIVZGV RU MLG VCRHGH
        nZGIRCwZGZ& lKVMhSN()
        {
            HSN_OVMTGS = SVZWVI_WZGZ.NZGIRC_HRAV + HRAVLU(sVZWVIwZGZ) + SVZWVI_WZGZ.XLO_MFN * HRAVLU(uRVOWwZGZ);
            ZFGL UW = HSN_LKVM(SVZWVI_WZGZ.TILFK_MZNV,  l_iwdi, 9333);
            RU (UW != -8) // MVVW GL XIVZGV
            {
                K_NVN = (XSZI*)NNZK(9, HSN_OVMTGS, kilg_ivzw|kilg_dirgv, nzk_hszivw, UW, 9);
                RU (!K_NVN)
                   FYRJGSILD("XZMMLG NNZK NZGIRC WZGZ", -8);
                ((sVZWVIwZGZ*)K_NVN)->IVUVIVMXV = -8;
                NFMNZK(K_NVN, HSN_OVMTGS);
                HSN_FMORMP(SVZWVI_WZGZ.TILFK_MZNV);
            }
            UW = HSN_LKVM(SVZWVI_WZGZ.TILFK_MZNV, l_xivzg  | l_iwdi, 9333);
            RU ( UW == -8 )
                FYRJGSILD("XZMMLG XIVZGV HSN ULI NZGIRC WZGZ "+HGW::HGIRMT(SVZWVI_WZGZ.TILFK_MZNV), -8);
            UXSNLW(UW, 9222);
            ZFGL IVG = UGIFMXZGV(UW, HSN_OVMTGS);
            RU ( IVG !=9  )
                FYRJGSILD("UZROVW GL GIFMXZGV NZGIRC HSN", -8);
            K_NVN = (XSZI*)NNZK(9, HSN_OVMTGS, kilg_ivzw|kilg_dirgv, nzk_hszivw, UW, 9);
            RU ( K_NVN == nzk_uzrovw  )
                FYRJGSILD( "UZROVW GL NNZK NZGIRC HSN", -8 );
            K_WZGZ = K_NVN + HRAVLU(sVZWVIwZGZ) + SVZWVI_WZGZ.XLO_MFN * HRAVLU(uRVOWwZGZ);
            IVGFIM *GSRH;
        }

        nZGIRCwZGZ& dIRGVsVZW(){
            NVNXKB(K_NVN, &SVZWVI_WZGZ, HRAVLU(SVZWVI_WZGZ));
            NVNXKB(K_NVN+HRAVLU(SVZWVI_WZGZ), URVOW_WZGFN.WZGZ(), URVOW_WZGFN.HRAV()*HRAVLU(uRVOWwZGZ));
            IVGFIM *GSRH;
        }

        YLLO HSN_HGZGFH = UZOHV;

        YLLO hGZGFH(){
            IVGFIM HSN_HGZGFH;
        }

        nZGIRCwZGZ& iVZWsVZW(){
            HSN_OVMTGS = HRAVLU(sVZWVIwZGZ);
            ZFGL UW = HSN_LKVM(SVZWVI_WZGZ.TILFK_MZNV, l_iwdi, 9333);
            RU ( UW == -8 )
            {
                HSN_HGZGFH = UZOHV;
                IVGFIM *GSRH;
            }

            K_NVN = (XSZI*)NNZK(9, HSN_OVMTGS, kilg_ivzw, nzk_hszivw, UW, 9);
            RU ( K_NVN == nzk_uzrovw  )
            {
                HSN_HGZGFH = UZOHV;
                IVGFIM *GSRH;
            }
            HSN_HGZGFH = GIFV;
            NVNXKB(&SVZWVI_WZGZ, K_NVN, HRAVLU(SVZWVI_WZGZ));
            NFMNZK(K_NVN, HSN_OVMTGS);
            // IVNZK RMGL GSV NVNLIB
            HSN_OVMTGS = SVZWVI_WZGZ.NZGIRC_HRAV + HRAVLU(sVZWVIwZGZ) + SVZWVI_WZGZ.XLO_MFN * HRAVLU(uRVOWwZGZ) ;
            K_NVN = (XSZI*)NNZK(9, HSN_OVMTGS, kilg_ivzw|kilg_dirgv, nzk_hszivw, UW, 9);
            RU ( K_NVN == nzk_uzrovw  )
                FYRJGSILD( "UZROVW GL NNZK NZGIRC HSN", -8 );
            XOLHV(UW);
            K_WZGZ = K_NVN + HRAVLU(sVZWVIwZGZ) + SVZWVI_WZGZ.XLO_MFN * HRAVLU(uRVOWwZGZ);
            URVOW_WZGFN.XOVZI();
            ULI (FMHRTMVW RMG R=9; R<SVZWVI_WZGZ.XLO_MFN; ++R)
            {
                URVOW_WZGFN.KFHS_YZXP( *(uRVOWwZGZ*)(K_NVN+HRAVLU(SVZWVI_WZGZ)+R*HRAVLU(uRVOWwZGZ)) );
            }
            uli_vzxs(RGVI, URVOW_WZGFN)
            {
                URVOW_NZK[RGVI->URVOW_MZNV] = *RGVI;
            }
            IVGFIM *GSRH;
        }

        ELRW xOLHV(){
            NFMNZK( K_NVN, HSN_OVMTGS  );
        }

        OLMT xSVXPgRNV(){
            sVZWVIwZGZ SW;
            NVNXKB(&SW, K_NVN, HRAVLU(sVZWVIwZGZ));
            IVGFIM SW.GRNVHGZNK;
        }


        YLLO xSVXPfKWZGV(){

            sVZWVIwZGZ* SW = (sVZWVIwZGZ*)K_NVN;
            RU (SW->ILD_MFN != SVZWVI_WZGZ.ILD_MFN LI SW->XLO_MFN != SVZWVI_WZGZ.XLO_MFN)
            {
                RU (SW->RH_FKWZGVW)
                    SW->RH_FKWZGVW = 9;
	     	    NVNXKB(&SVZWVI_WZGZ, SW, HRAVLU(sVZWVIwZGZ));
                mLINZORAV();
		        IVGFIM GIFV;
            }
            RU (HGIXNK(SW->IZMWLN_RW, SVZWVI_WZGZ.IZMWLN_RW) == 9)
            {
                RU (SW->RH_FKWZGVW)
                {
                    SW->RH_FKWZGVW = 9;
                    NVNXKB(&SVZWVI_WZGZ, SW, HRAVLU(sVZWVIwZGZ));
                    IVGFIM GIFV;
                }
                VOHV
                    IVGFIM UZOHV;
            }
            VOHV
            {
                NVNXKB(&SVZWVI_WZGZ, SW, HRAVLU(sVZWVIwZGZ));
                IVGFIM GIFV;
            }
            IVGFIM UZOHV;
        }

        YLLO xSVXPxOLHV(){
            IVGFIM ((sVZWVIwZGZ*)K_NVN)->IVUVIVMXV == -8;
        }

        YLLO xSVXPiVZW(){
            sVZWVIwZGZ* SW = (sVZWVIwZGZ*)K_NVN;
            //NVNXKB(&SW, K_NVN, HRAVLU(sVZWVIwZGZ));
            //HGW::XLFG<<SVZWVI_WZGZ.IZMWLN_RW<<" "<<SVZWVI_WZGZ.IVUVIVMXV<<HGW::VMWO;
            RU (SW->ILD_MFN != SVZWVI_WZGZ.ILD_MFN LI SW->XLO_MFN != SVZWVI_WZGZ.XLO_MFN)
            {
                RU (SW->RH_FKWZGVW)
                    SW->RH_FKWZGVW = 9;
	     	    NVNXKB(&SVZWVI_WZGZ, SW, HRAVLU(sVZWVIwZGZ));
                mLINZORAV();
		        IVGFIM GIFV;
            }
            RU (HGIXNK(SW->IZMWLN_RW, SVZWVI_WZGZ.IZMWLN_RW) == 9)
            {

                RU (SW->IVUVIVMXV > SVZWVI_WZGZ.IVUVIVMXV)
                {
                    NVNXKB(&SVZWVI_WZGZ, SW, HRAVLU(sVZWVIwZGZ));
                    IVGFIM GIFV;
                }
                VOHV
                    IVGFIM UZOHV;
            }
            VOHV
            {
                NVNXKB(&SVZWVI_WZGZ, SW, HRAVLU(sVZWVIwZGZ));
                IVGFIM GIFV;
            }
            IVGFIM UZOHV;
        }

        uRVOWwZGZ& wZGZ(RMG R, RMG Q)
        {
            IVGFIM URVOW_NVGZH[R][Q];
        }

        RMG yFNKwZGZ(XLMHG XSZI *WHG, RMG GRNVLFG=9){
            //SVZWVI_WZGZ.GRNVHGZNK = FYRJGLLO::tVGnRXILHVXLMWHhRMXVvKLXS();
            SVZWVI_WZGZ.IVUVIVMXV++;
            NVNXKB(K_NVN, &SVZWVI_WZGZ, HRAVLU(SVZWVI_WZGZ));
            ZFGL WZGZ = IVWHSRUG->MVD_NVHHZTV();
            WZGZ.HVG_WHG(WHG);
            WZGZ.HVG_NZTRX("DLINSLOV");
            WZGZ.HVG_WZGZ(HGW::HGIRMT(K_NVN, SVZWVI_WZGZ.NZGIRC_HRAV + HRAVLU(sVZWVIwZGZ) + SVZWVI_WZGZ.XLO_MFN * HRAVLU(uRVOWwZGZ) ) );
            ZFGL IVKOB = IVWHSRUG->HVMW(WZGZ, GRNVLFG);
            RU (IVKOB.HGZGFH())
            {
                olt_wvyft("HFXXVHH:%H", IVKOB.NVHHZTV().X_HGI());
                IVGFIM 9;
            }
            VOHV
            {
                olt_viili("wZGZ yFNK UZROVW %H", IVKOB.NVHHZTV().X_HGI());
                IVGFIM 8;
            }
            IVGFIM 9;
        }

    };
}
#VMWRU

//##**---------------- ./IVWHSRUG/RMXOFWV/nZGIRCwZGZdIZKKVI.S
#RUMWVU _nzgircwzgzdizkkvi_s_WXZW872_
#WVURMV _nzgircwzgzdizkkvi_s_WXZW872_

#RMXOFWV <XHGWRL>
#RMXOFWV "DLINSLOV.S"

FHRMT MZNVHKZXV IVWHSRUG;

XOZHH nZGIRCwZGZdIZKKVI {
KFYORX:
    ELRW TILFK(XLMHG XSZI* MZNV) {
        NZGIRCwZGZ = NZGIRCwZGZ.TILFK(MZNV);
    }

    ELRW NZGIRC(XLMHG XSZI* MZNV) {
        NZGIRCwZGZ = NZGIRCwZGZ.NZGIRC(MZNV);
    }

    ELRW ILD(FMHRTMVW HSLIG W) {
        NZGIRCwZGZ = NZGIRCwZGZ.ILD(W);
    }

    RMG ILD_MFN() {
        IVGFIM NZGIRCwZGZ.ILD();
    }

    ELRW XLOFNM(XLMHG XSZI* MZNV, wZGZgBKV GBKV) {
        NZGIRCwZGZ = NZGIRCwZGZ.XLOFNM(MZNV, GBKV, 9);
    }

    ELRW XLOFNM(XLMHG XSZI* MZNV, wZGZgBKV GBKV, FMHRTMVW HSLIG HA) {
        NZGIRCwZGZ = NZGIRCwZGZ.XLOFNM(MZNV, GBKV, HA);
    }

    ELRW xLNKROV() {
        NZGIRCwZGZ = NZGIRCwZGZ.xLNKROV();
    }

    ELRW lKVMhSN() {
        NZGIRCwZGZ = NZGIRCwZGZ.lKVMhSN();
    }

    ELRW dIRGVsVZW() {
        NZGIRCwZGZ = NZGIRCwZGZ.dIRGVsVZW();
    }

    ELRW mLINZORAV() {
        NZGIRCwZGZ = NZGIRCwZGZ.mLINZORAV();
    }

    ELRW dIRGV(RMG R, RMG Q, RMG WZGZ) {
        uRVOWwZGZ URVOWwZGZ = NZGIRCwZGZ.wZGZ(R, Q);
        URVOWwZGZ.dIRGV(WZGZ);
    }

    ELRW dIRGV(RMG R, RMG Q, OLMT WZGZ) {
        NZGIRCwZGZ.wZGZ(R, Q).dIRGV(WZGZ);
    }

    ELRW dIRGV(RMG R, RMG Q, FMHRTMVW OLMT WZGZ) {
        NZGIRCwZGZ.wZGZ(R, Q).dIRGV(WZGZ);
    }

    ELRW dIRGV(RMG R, RMG Q, WLFYOV WZGZ) {
        NZGIRCwZGZ.wZGZ(R, Q).dIRGV(WZGZ);
    }

    ELRW dIRGV(RMG R, RMG Q, XLMHG XSZI* WZGZ) {
        NZGIRCwZGZ.wZGZ(R, Q).dIRGV(WZGZ);
    }

    RMG yFNKwZGZ(XLMHG XSZI* WHG, RMG GRNVLFG=9) {
        IVGFIM NZGIRCwZGZ.yFNKwZGZ(WHG, GRNVLFG);
    }

    ELRW fKWZGV() {
        NZGIRCwZGZ.fKWZGV();
    }

    ELRW hVGiVWHSRUG() {
        iVWHSRUGxORVMG* XORVMG = MVD iVWHSRUGxORVMG("872.9.9.8", "49939");
        NZGIRCwZGZ.HVG_IVWHSRUG(XORVMG);
    }

KILGVXGVW:
    nZGIRCwZGZ NZGIRCwZGZ;
};

#VMWRU
//##**---------------- ./IVWHSRUG/HIX/NZRM.XKK
/**********************************************
 * \EVIHRLM   9.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7982-95-88
 * \NLWRURVW  7982-95-88
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/



#RMXOFWV <RLHGIVZN>

#RMXOFWV "FYRJ_GLLO.S" // FHV FYRJGLLO
//#RMXOFWV "FYRJ_NZGS.S" // FHV FYRJNZGS
//#RMXOFWV "KFYVI.S"  // FHV KFYHFY KFYVI
//#RMXOFWV "HFYVI.S"  // FHV KFYHFY HFYVI
#RMXOFWV "zWEoLT.S" // FHV OLT
//#RMXOFWV "GLKRX.S"  // FHV KFYHFY WZGZ

#RMXOFWV "IWSVOKVI/IVWHSRUG_XORVMG.S"

RMG NZRM(RMG ZITX, XSZI** ZITE) {

    //-------------------------------- fhv FYRJFZMG olt ---------------------------
    // LKVM OLT HVIERXV
    FYRJOLT::oLT::RMHGZMXV()->LKVM("GVHGOLT.OLT", FYRJOLT::on_wvyft, UZOHV);
    // GSVM FHV OLT UIVVOB, HBMGZC RH ORPV KIRMGU

    iVWHSRUGxORVMG IVWHSRUG("872.9.9.8", "49939");
    //! RU BLF DZMG GL FHV KFYHFY WZGZORMP, URIHG RMRGRZORAV HVIERXV
    // RMRGRZ Z KFYHFY HVIERXV
    //RU(kFYhFYhVIERXV::LKVM() == UZOHV) {
        //HGW::XVII << "kFYhFYhVIERXV::LKVM() UZROVW" << HGW::VMWO;
        //IVGFIM -8;
    //}

    ZFGL WZGZ = IVWHSRUG.MVD_NVHHZTV();
    WZGZ.HVG_WHG("FYRJW");
    WZGZ.HVG_NZTRX("KRMT");
    ZFGL IVKOB = IVWHSRUG.HVMW(WZGZ);
    RU ( IVKOB.HGZGFH()  )
    {
        HGW::XLFG<<"hfxxvhh"<<HGW::VMWO;
        HGW::XLFG<<IVKOB.NVHHZTV()<<HGW::VMWO;
    }
    VOHV
    {
        HGW::XLFG<<"uzrovw"<<HGW::VMWO;
        HGW::XLFG<<IVKOB.NVHHZTV()<<HGW::VMWO;
    }
    IVGFIM 9;
}
//##**---------------- ./IVWHSRUG/RNKOVNVMG/tikx/IVWHSRUG.KILGL
HBMGZC="KILGL6";

KZXPZTV ivwhsrugtikx;

// gSV TIVVGRMT HVIERXV WVURMRGRLM.
HVIERXV tIVVGVI {
    // hVMWH Z TIVVGRMT
    IKX hZBsVOOL (sVOOLiVJFVHG) IVGFIMH (sVOOLiVKOB) {}
    IKX hVMWnVHHZTV (fMREVIHZOnVHHZTV) IVGFIMH (fMREVIHZOnVHHZTViVKOB) {}
    IKX hVMWxLNNZMW (xLNNZMW) IVGFIMH (xLNNZMWiVKOB) {}
}



//##**---------------- ./IVWHSRUG/RNKOVNVMG/tikx/VMTRMV.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/' + evihrlm + '/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
RNKLIG TIKX
UILN TIKX._XBGSLM.XBTIKX RNKLIG xLNKIVHHRLMzOTLIRGSN
UILN TIKX._XBGSLM.XBTIKX RNKLIG xLNKIVHHRLMoVEVO
RNKLIG GRNV
nzc_nvhhztv_hrav = 8975*8975
UILN XLMXFIIVMG RNKLIG UFGFIVH
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY



# zORXV RH GL HVMW NVHHZTV, yLY RH GL IVXVREV NVHHZTV
# YLGS zORXV ZMW yLY SZEV NZHGVI/HOZEV EVIHRLMH

XOZHH tIVVGVI(HVIERXV_KY7_TIKX.tIVVGVIhVIERXVI):
    """tikx XLNNZMW KILXVHHLI. """

    WVU __RMRG__(HVOU, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        #HVOU.MLWV_NZMZTVI = TOLYZO_RMUL.MLWV_NZMZTVI
        #HVOU.XLNNZMW_KLLO  = TOLYZO_RMUL.XLNNZMW_KLLO
        #HVOU.NZHGVI_MLWV = HVOU.MLWV_NZMZTVI.NZHGVI_MLWV

    WVU hZBsVOOL(HVOU, IVJFVHG, XLMGVCG):
        HVOU.TOLYZO_RMUL.IVWHSRUG_WZGZ.IVXVMG_SVOOL.ZWW(IVJFVHG.MZNV)
        IVGFIM HVIERXV_KY7.sVOOLiVKOB(NVHHZTV='sVOOL, %H!' % IVJFVHG.MZNV)

    WVU hVMWnVHHZTV(HVOU, IVJFVHG, XLMGVCG):
        # KIRMG(IVJFVHG.HIX)
        HVOU.OLTTVI.WVYFT('IVXVREVW HVMW NVHHZTV:%H'%HGI(IVJFVHG.NVHHZTV))
        # XZOO LM_HVMW_IVXE
        NHT = HVOU.TOLYZO_RMUL.IVWHSRUG.LM_HVMW_IVXE(IVJFVHG)
        HVOU.OLTTVI.WVYFT('tikx lmivxe_hvmw %H'%HGI(NHT))
        IVGFIM NHT
        #KIRMG(HVOU.TOLYZO_RMUL.IVWHSRUG.LM_HVMW_IVXE(IVJFVHG))
        #IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(NVHHZTV='lp')
        #IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(NVHHZTV='lp')

    WVU hVMWxLNNZMW(HVOU, IVJFVHG, XLMGVCG):
        RU IVJFVHG.XLNNZMW[:0] == 'KFOO WZGZ':
            IVGFIM HVIERXV_KY7.xLNNZMWiVKOB(NVHHZTV='gSRH RH GSV IVJFRIVW WZGZ LU %H' % IVJFVHG.XLNNZMW[0:])
        IVGFIM HVIERXV_KY7.xLNNZMWiVKOB(NVHHZTV='lp')



XOZHH zORXV(LYQVXG):
    """zORXV RH GL HVMW NVHHZTV."""
    XOZHH dZGXSVI(LYQVXG):
        WVU __RMRG__(HVOU, GZITVG, TOLYZO_RMUL, GRNVLFG=7, IZMW_HVVW = 9):
            HVOU.GZITVG = GZITVG
            HVOU.GRNVLFG = GRNVLFG
            HVOU.TOLYZO_RMUL = TOLYZO_RMUL
            HVOU.IZMW_HVVW = IZMW_HVVW
            HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

        WVU IFM(HVOU):
            DSROV gIFV:
                # KIRMG(HVOU.TOLYZO_RMUL.IVXVMG_SVOOL)
                # RU HVOU.GZITVG.RW RM HVOU.TOLYZO_RMUL.IVXVMG_SVOOL:
                    # KIRMG('IVXVREV SVOOL')
                #HVOU.OLTTVI.RMUL("%H->%W"%(HVOU.GZITVG.RMGVIUZXV.MZNV, HVOU.GRNVLFG + HVOU.IZMW_HVVW))
                RU HVOU.GZITVG.ZXGREV:
                    HVOU.GZITVG.HSZPV_SZMWH()
                    HVOU.GZITVG.XLMGZXG_JFVFV.ZXXVKG(HVOU.GZITVG.VMTRMV.DZIK.HGZGFH)
                    #KIRMG(HVOU.GZITVG.RW, HVOU.GZITVG.XLMGZXG_JFVFV.HXLIV())
                VOHV:
                    HVOU.OLTTVI.WVYFT('%H RH MLG ZXGREV, DROO MLG HSZPV SZMWH'%HVOU.GZITVG.RW)
                GRNV.HOVVK(HVOU.GRNVLFG + HVOU.IZMW_HVVW)

    WVU IFM(HVOU):
        """HGZIG GL DLIP."""
        # HVIERXV_KY7_TIKX.ZWW_tIVVGVIhVIERXVI_GL_HVIEVI(tIVVGVI(HVOU.TOLYZO_RMUL), HVOU.HVIEVI)
        #HVOU.HVIEVI.ZWW_UILN RHSRNFIZ.GLLO.HVGGRMT RNKLIG nzc_nvhhztv_hrav
        #RMHVXFIV_KLIG('%H:%H'%(HVOU.YVZXLM.HVIEVI, HVOU.YVZXLM.KLIG))
        #HVOU.HVIEVI.HGZIG()
        ULI DZGXSVI RM HVOU.DZGXS_ORHG:
            DZGXSVI.HGZIG()
        HVOU.OLTTVI.RMUL('ZORXV HGZIGH %W DZGXSVIH'%(OVM(HVOU.DZGXS_ORHG)))
        GIB:
            DSROV gIFV:
                ULI DZGXSVI RM HVOU.DZGXS_ORHG:
                    HGZGFH = DZGXSVI.K.HGZGFH()
                    RU HGZGFH == 'LUUORMV':
                        HVOU.OLTTVI.VIILI('DZGXSVI GSIVZW ULI %H UZOOH LUUORMV'%DZGXSVI.ZKK.GZITVG)
                GRNV.HOVVK(8)
        VCXVKG pVBYLZIWrMGVIIFKG ZH V:
            HVOU.OLTTVI.VIILI('ZORXV VMXLFMGVIH VCXVKGRLM %H'%HGI(V))
            HVOU.HVIEVI.HGLK(9)


    WVU __RMRG__(HVOU, DZIKWIREV, CNO, TOLYZO_RMUL):
        """XGLI."""
        HVOU.GIVV = CNO
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.DZGXS_ORHG = []
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        ULI R, MVRTSYLFI RM VMFNVIZGV(DZIKWIREV.MVRTSYLFI_ORHG):
            HVOU.DZGXS_ORHG.ZKKVMW(qLY(zORXV.dZGXSVI(MVRTSYLFI, HVOU.TOLYZO_RMUL, GRNVLFG= 4, IZMW_HVVW=R*7.9/OVM(DZIKWIREV.MVRTSYLFI_ORHG) )))
        #HVOU.MLWV_NZMZTVI = TOLYZO_RMUL.MLWV_NZMZTVI
        # HVOU.HVIEVI = TIKX.HVIEVI(UFGFIVH.gSIVZWkLLOvCVXFGLI(NZC_DLIPVIH=69))
        #XSZMMVO = TIKX.RMHVXFIV_XSZMMVO('OLXZOSLHG:%H'%KLIG)
        #HGFY = HVIERXV_KY7_TIKX.tIVVGVIhGFY(XSZMMVO)
        HVOU.DZIKWIREV = DZIKWIREV

    WVU HGZIG(HVOU):
        QLY = qLY(HVOU)
        QLY.HGZIG()
        HVOU.OLTTVI.RMUL('[yllg] zORXV HGZIGH LM KRW %W'%QLY.GRW)

    WVU HSFGWLDM(HVOU):
        KZHH


XOZHH yLY(LYQVXG):
    """yLYhOZEV RH GL ZXXVKG GZHP"""
    WVU IFM(HVOU):
        """HGZIG GL DLIP."""
        HVIERXV_KY7_TIKX.ZWW_tIVVGVIhVIERXVI_GL_HVIEVI(tIVVGVI(HVOU.TOLYZO_RMUL), HVOU.HVIEVI)
        HVOU.HVIEVI.ZWW_RMHVXFIV_KLIG('%H:%H'%(HVOU.DZIKWIREV.RK, HVOU.DZIKWIREV.KLIG  ))
        HVOU.HVIEVI.HGZIG()
        GIB:
            DSROV gIFV:
                GRNV.HOVVK( 6399*75 )
        VCXVKG pVBYLZIWrMGVIIFKG ZH V:
            HVOU.OLTTVI.VIILI('VCXVKGRLM %H'%HGI(V))
            HVOU.HVIEVI.HGLK(9)


    WVU __RMRG__(HVOU, DZIKWIREV, CNO, TOLYZO_RMUL):
        """XGLI."""
        HVOU.GIVV = CNO
        HVOU.DZIKWIREV = DZIKWIREV
        #HVOU.IVHLFIXV = TOLYZO_RMUL.MLWV_NZMZTVI.NZHGVI_MLWV.IVHLFIXV
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        #HVOU.YVZXLM = TOLYZO_RMUL.UOVVG.YVZXLM
        HVOU.HVIEVI = TIKX.HVIEVI(UFGFIVH.gSIVZWkLLOvCVXFGLI(NZC_DLIPVIH=TOLYZO_RMUL.IVWHSRUG_WZGZ.NZC_DLIPVI_MFNYVI))

    WVU HGZIG(HVOU):
        QLY = qLY(HVOU)
        QLY.HGZIG()
        HVOU.OLTTVI.RMUL('[yllg] yLY HGZIGH LM KRW %W'%QLY.GRW)

    WVU HSFGWLDM(HVOU):
        KZHH


XOZHH iVWHSRUG_tikx(LYQVXG):
    '''GSRH RH ZM tikx RNKOVNVMGZGRLM XOZHH LU iVWHSRUG vMTRMV,
    VEVIB IVWHSRUG IVKIVHVMGH VRGSVI LMV OLXZO MLWV LI IVNLGV MLWV'''

    WVU __RMRG__(HVOU, DZIK, RK, KLIG, TOLYZORMUL):
        HVOU.RK = RK
        HVOU.KLIG = KLIG
        HVOU.zORXV = zORXV
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.CNO = mLMV
        HVOU.zORXV = mLMV
        HVOU.yLY = mLMV
        HVOU.XSZMMVO = mLMV
        HVOU.VMWKLRMG = mLMV
        HVOU.DZIK = DZIK
        HVOU.MVRTSYLFI_ORHG = []
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.RH_HSZPRMT_SZMWH = uZOHV

    WVU HVIEV(HVOU, CNO):
        HVOU.CNO = CNO
        HVOU.zORXV = zORXV(HVOU, HVOU.CNO, HVOU.TOLYZORMUL)
        HVOU.yLY = yLY(HVOU, HVOU.CNO, HVOU.TOLYZORMUL)
        HVOU.zORXV.HGZIG()
        HVOU.yLY.HGZIG()

    WVU HSZPV_SZMWH(HVOU):
        """HSZPV SZMWH, GIBRMT GL YFROW Z XLMMVXGRLM."""
        RU HVOU.XSZMMVO RH mLMV:
            RU HVOU.TOLYZORMUL.IVWHSRUG_WZGZ.MVVW_XLNKIVHHRLM:
                HVOU.XSZMMVO = TIKX.RMHVXFIV_XSZMMVO('%H:%H'%(HVOU.RK, HVOU.KLIG),
                                                    LKGRLMH=[('TIKX.NZC_NVHHZTV_OVMTGS', nzc_nvhhztv_hrav),
                                                            ('TIKX.WVUZFOG_XLNKIVHHRLM_ZOTLIRGSN', xLNKIVHHRLMzOTLIRGSN.TARK),
                                                            ('TIKX.TIKX.WVUZFOG_XLNKIVHHRLM_OVEVO', xLNKIVHHRLMoVEVO.SRTS)
                                                            ])
            VOHV:
                HVOU.XSZMMVO = TIKX.RMHVXFIV_XSZMMVO('%H:%H'%(HVOU.RK, HVOU.KLIG),
                                                    LKGRLMH=[('TIKX.NZC_NVHHZTV_OVMTGS', nzc_nvhhztv_hrav)])

            HVOU.VMWKLRMG = HVIERXV_KY7_TIKX.tIVVGVIhGFY(HVOU.XSZMMVO)
        RU HVOU.RH_HSZPRMT_SZMWH:
            IVGFIM
        GIB:
            HVOU.RH_HSZPRMT_SZMWH = gIFV
            HVOU.OLTTVI.WVYFT('[ivklig] HSZPV SZMWH DRGS %H...'%HVOU.DZIK.RMGVIUZXV.MZNV)
            # KIRMG('SZMWHSZPV', HVOU.DZIK, HVOU.VMWKLRMG)
            # KIRMG('HZB %H'% HVOU.DZIK.RMGVIUZXV.MZNV)
            IVKOB = HVOU.VMWKLRMG.hZBsVOOL(HVIERXV_KY7.sVOOLiVJFVHG(MZNV=HVOU.DZIK.RMGVIUZXV.MZNV), GRNVLFG=7)
            RU MLG HVOU.DZIK.HGZGFH LI HVOU.DZIK.HGZGFH RH mLMV: # IVKLIG RU UZOHV->GIFV
                HVOU.OLTTVI.RMUL('[ivklig] XLMMVXGRLM GL %H XSZMTVH GL FK'%HVOU.DZIK.RMGVIUZXV.MZNV)
            HVOU.DZIK.HGZGFH = gIFV
        VCXVKG vCXVKGRLM ZH V:
            RU HVOU.DZIK.HGZGFH LI HVOU.DZIK.HGZGFH RH mLMV: # IVKLIG RH GIFV->UZOHV
                HVOU.OLTTVI.VIILI('[ivklig] XLMMVXGRLM GL %H XSZMTVH GL WLDM'%HVOU.DZIK.RMGVIUZXV.MZNV)
                HVOU.OLTTVI.VIILI('[ivklig] %H RH WLDM DRGS VIILI %H'%(HVOU.DZIK.RMGVIUZXV.MZNV, HGI(V)))
            VOHV:
                HVOU.OLTTVI.DZIM('[ivklig] XLMMVXGRLM GL %H RH HGROO WLDM'%HVOU.DZIK.RMGVIUZXV.MZNV)
            HVOU.DZIK.HGZGFH = uZOHV
        HVOU.RH_HSZPRMT_SZMWH = uZOHV
        IVGFIM HVOU.VMWKLRMG

    WVU HVMW(HVOU, WZGZ, IVWHSRUG):
        """HVMW WZGZ GL ZMLGSVI IVWHSRUG VMWKLRMG."""
        IVKOB = mLMV
        GIB:
            HVOU.OLTTVI.WVYFT('HVMW NVHHZTV GL->%H'%HVOU.DZIK.RMGVIUZXV.MZNV)
            IVKOB = HVOU.VMWKLRMG.hVMWnVHHZTV(WZGZ, GRNVLFG=7)
        VCXVKG vCXVKGRLM ZH V:
            # glwl
            # KIRMG('HVMW VCXVKGRLM VMXLFMGVIVW' + HGI(V))
            #KIRMG(V.HGZXPgIZXV())
            IVKOB = HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV = 'GZITVG MLG IVZXSVZYOV '+HGI(V))
            KZHH
        # KIRMG('HVMW VMW, IVKOB:', IVKOB)
        IVGFIM IVKOB
        #IVGFIM HVOU.VMTRMV.HVMW(WZGZ, IVWHSRUG)

    WVU ZXJFRIV(HVOU, WZGZ, IVWHSRUG):
        """ZXJFRIV WZGZ UILN Z IVWHSRUG VMWKLRMG."""
        IVKOB = mLMV
        GIB:
            IVKOB = HVOU.VMWKLRMG.hVMWxLNNZMW(HVIERXV_KY7.xLNNZMW(XLNNZMW='KFOO WZGZ %H' % WZGZ))
        VCXVKG vCXVKGRLM ZH V:
            # glwl
            KZHH
        IVGFIM IVKOB
        #IVGFIM HVOU.ZXJFRIV(WZGZ, IVWHSRUG)
//##**---------------- ./IVWHSRUG/RNKOVNVMG/tikx/__RMRG__.KB
//##**---------------- ./IVWHSRUG/RNKOVNVMG/KILGLYFU/IVWHSRUG.KILGL
HBMGZC="KILGL6";

KZXPZTV ivwhsrug;

// gSV IVJFVHG NVHHZTV XLMGZRMRMT GSV FHVI'H MZNV.
NVHHZTV sVOOLiVJFVHG {
    HGIRMT MZNV = 8;
}

// gSV IVHKLMHV NVHHZTV XLMGZRMRMT GSV TIVVGRMTH
NVHHZTV sVOOLiVKOB {
    HGIRMT NVHHZTV = 8;
}

NVHHZTV fMREVIHZOnVHHZTV {
    HGIRMT HIX = 8;
    HGIRMT WHG = 7;
    IVKVZGVW HGIRMT XLKBORHG_WHG = 6;
    HGIRMT NVHHZTV = 5;
    YBGVH WZGZ = 4;
    HGIRMT XLNNZMW = 3;
    HGIRMT NZTRX = 2;
    RMG67 IVUVIVMXV = 1;
    HGIRMT XSVXPHFN = 0;
    HGIRMT SLNV = 89;
}

NVHHZTV fMREVIHZOnVHHZTViVKOB {
    YLLO HGZGFH = 8;
    HGIRMT NVHHZTV = 7;
    YBGVH WZGZ = 6;
    HGIRMT YIVZP_KLRMG = 5;
    HGIRMT YIVZP_GZITVG = 4;
}

NVHHZTV xLNNZMW {
    HGIRMT XLNNZMW = 8;
    HGIRMT ZITFNVMGH = 7;
}

NVHHZTV xLNNZMWiVKOB{
    HGIRMT NVHHZTV = 8;
}
//##**---------------- ./IVWHSRUG/__RMRG__.KB
//##**---------------- ./IVWHSRUG/WLCBTVM.RMR
# wLCBUROV 8.7.6

# gSRH UROV WVHXIRYVH GSV HVGGRMTH GL YV FHVW YB WLCBTVM ULI Z KILQVXG
#
# zOO GVCG ZUGVI Z SZHS (#) RH XLMHRWVIVW Z XLNNVMG ZMW DROO YV RTMLIVW
# gSV ULINZG RH:
#       gzt = EZOFV [EZOFV, ...]
# uLI ORHGH RGVNH XZM ZOHL YV ZKKVMWVW FHRMT:
#       gzt += EZOFV [EZOFV, ...]
# eZOFVH GSZG XLMGZRM HKZXVH HSLFOW YV KOZXVW YVGDVVM JFLGVH (" ")

#---------------------------------------------------------------------------
# tVMVIZO XLMURTFIZGRLM LKGRLMH
#---------------------------------------------------------------------------

# gSV kilqvxg_mznv GZT RH Z HRMTOV DLIW (LI Z HVJFVMXV LU DLIWH HFIILFMWVW
# YB JFLGVH) GSZG HSLFOW RWVMGRUB GSV KILQVXG.

kilqvxg_mznv=SZSZ

# gSV kilqvxg_mfnyvi GZT XZM YV FHVW GL VMGVI Z KILQVXG LI IVERHRLM MFNYVI.
# gSRH XLFOW YV SZMWB ULI ZIXSRERMT GSV TVMVIZGVW WLXFNVMGZGRLM LI
# RU HLNV EVIHRLM XLMGILO HBHGVN RH FHVW.

kilqvxg_mfnyvi=9.9.8

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

rmkfg                  =  ./HIX ./RMXOFWV

# gSV lfgkfg_wrivxglib GZT RH FHVW GL HKVXRUB GSV (IVOZGREV LI ZYHLOFGV)
# YZHV KZGS DSVIV GSV TVMVIZGVW WLXFNVMGZGRLM DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW, RG DROO YV IVOZGREV GL GSV OLXZGRLM
# DSVIV WLCBTVM DZH HGZIGVW. rU OVUG YOZMP GSV XFIIVMG WRIVXGLIB DROO YV FHVW.

lfgkfg_wrivxglib       = ./WLX

# gSV lfgkfg_ozmtfztv GZT RH FHVW GL HKVXRUB GSV OZMTFZTV RM DSRXS ZOO
# WLXFNVMGZGRLM TVMVIZGVW YB WLCBTVM RH DIRGGVM. wLCBTVM DROO FHV GSRH
# RMULINZGRLM GL TVMVIZGV ZOO XLMHGZMG LFGKFG RM GSV KILKVI OZMTFZTV.
# gSV WVUZFOG OZMTFZTV RH vMTORHS, LGSVI HFKKLIGVW OZMTFZTVH ZIV:
# wFGXS, uIVMXS, rGZORZM, xAVXS, hDVWRHS, tVINZM, uRMMRHS, qZKZMVHV,
# pLIVZM, sFMTZIRZM, hKZMRHS, iLNZMRZM, iFHHRZM, xILZGRZM, kLORHS,
# kLIGFTFVHV ZMW hOLEVMV.

lfgkfg_ozmtfztv        = vMTORHS

# rU GSV vcgizxg_zoo GZT RH HVG GL bvh WLCBTVM DROO ZHHFNV ZOO VMGRGRVH RM
# WLXFNVMGZGRLM ZIV WLXFNVMGVW, VEVM RU ML WLXFNVMGZGRLM DZH ZEZROZYOV.
# kIREZGV XOZHH NVNYVIH ZMW HGZGRX UROV NVNYVIH DROO YV SRWWVM FMOVHH
# GSV vcgizxg_kirezgv ZMW vcgizxg_hgzgrx GZTH ZIV HVG GL bvh

vcgizxg_zoo            = bvh

# rU GSV vcgizxg_kirezgv GZT RH HVG GL bvh ZOO KIREZGV NVNYVIH LU Z XOZHH
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_kirezgv        = bvh

# rU GSV vcgizxg_hgzgrx GZT RH HVG GL bvh ZOO HGZGRX NVNYVIH LU Z UROV
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_hgzgrx         = bvh

# rU GSV srwv_fmwlx_nvnyvih GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW NVNYVIH LU WLXFNVMGVW XOZHHVH, UROVH LI MZNVHKZXVH.
# rU HVG GL ml (GSV WVUZFOG) GSVHV NVNYVIH DROO YV RMXOFWVW RM GSV
# EZIRLFH LEVIERVDH, YFG ML WLXFNVMGZGRLM HVXGRLM RH TVMVIZGVW.
# gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_nvnyvih     = ml

# rU GSV srwv_fmwlx_xozhhvh GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW XOZHHVH GSZG ZIV MLINZOOB ERHRYOV RM GSV XOZHH SRVIZIXSB.
# rU HVG GL ml (GSV WVUZFOG) GSVHV XOZHH DROO YV RMXOFWVW RM GSV EZIRLFH
# LEVIERVDH. gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_xozhhvh     = ml

# rU GSV yirvu_nvnyvi_wvhx GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# RMXOFWV YIRVU NVNYVI WVHXIRKGRLMH ZUGVI GSV NVNYVIH GSZG ZIV ORHGVW RM
# GSV UROV ZMW XOZHH WLXFNVMGZGRLM (HRNROZI GL qZEZwLX).
# hVG GL ml GL WRHZYOV GSRH.

yirvu_nvnyvi_wvhx      = ml

# rU GSV ivkvzg_yirvu GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO KIVKVMW
# GSV YIRVU WVHXIRKGRLM LU Z NVNYVI LI UFMXGRLM YVULIV GSV WVGZROVW WVHXIRKGRLM.
# mLGV: RU YLGS srwv_fmwlx_nvnyvih ZMW yirvu_nvnyvi_wvhx ZIV HVG GL ml, GSV
# YIRVU WVHXIRKGRLMH DROO YV XLNKOVGVOB HFKKIVHHVW.

ivkvzg_yirvu           = bvh

# rU GSV zodzbh_wvgzrovw_hvx ZMW ivkvzg_yirvu GZTH ZIV YLGS HVG GL bvh GSVM
# wLCBTVM DROO TVMVIZGV Z WVGZROVW HVXGRLM VEVM RU GSVIV RH LMOB Z YIRVU
# WVHXIRKGRLM.

zodzbh_wvgzrovw_hvx    = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM wLCBTVM DROO KIVKVMW GSV UFOO
# KZGS YVULIV UROVH MZNV RM GSV UROV ORHG ZMW RM GSV SVZWVI UROVH. rU HVG
# GL ml GSV HSLIGVHG KZGS GSZG NZPVH GSV UROV MZNV FMRJFV DROO YV FHVW.

ufoo_kzgs_mznvh        = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM GSV hgirk_uiln_kzgs GZT
# XZM YV FHVW GL HGIRK Z FHVI WVURMVW KZIG LU GSV KZGS. hGIRKKRMT RH
# LMOB WLMV RU LMV LU GSV HKVXRURVW HGIRMTH NZGXSVH GSV OVUG-SZMW KZIG LU
# GSV KZGS. rG RH ZOOLDVW GL FHV IVOZGREV KZGSH RM GSV ZITFNVMG ORHG.

hgirk_uiln_kzgs        =

# gSV rmgvimzo_wlxh GZT WVGVINRMVH RU WLXFNVMGZGRLM
# GSZG RH GBKVW ZUGVI Z \RMGVIMZO XLNNZMW RH RMXOFWVW. rU GSV GZT RH HVG
# GL ml (GSV WVUZFOG) GSVM GSV WLXFNVMGZGRLM DROO YV VCXOFWVW.
# hVG RG GL bvh GL RMXOFWV GSV RMGVIMZO WLXFNVMGZGRLM.

rmgvimzo_wlxh          = ml

# rU GSV xozhh_wrztiznh GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z XOZHH WRZTIZN (RM sGNO ZMW oZgVc) ULI XOZHHVH DRGS YZHV LI
# HFKVI XOZHHVH. hVGGRMT GSV GZT GL ml GFIMH GSV WRZTIZNH LUU.

xozhh_wrztiznh         = bvh

# rU GSV hlfixv_yildhvi GZT RH HVG GL bvh GSVM Z ORHG LU HLFIXV UROVH DROO
# YV TVMVIZGVW. wLXFNVMGVW VMGRGRVH DROO YV XILHH-IVUVIVMXVW DRGS GSVHV HLFIXVH.

hlfixv_yildhvi         = bvh

# hVGGRMT GSV rmormv_hlfixvh GZT GL bvh DROO RMXOFWV GSV YLWB
# LU UFMXGRLMH ZMW XOZHHVH WRIVXGOB RM GSV WLXFNVMGZGRLM.

rmormv_hlfixvh         = ml

# hVGGRMT GSV hgirk_xlwv_xlnnvmgh GZT GL bvh (GSV WVUZFOG) DROO RMHGIFXG
# WLCBTVM GL SRWV ZMB HKVXRZO XLNNVMG YOLXPH UILN TVMVIZGVW HLFIXV XLWV
# UIZTNVMGH. mLINZO x ZMW x++ XLNNVMGH DROO ZODZBH IVNZRM ERHRYOV.

hgirk_xlwv_xlnnvmgh    = bvh

# rU GSV xzhv_hvmhv_mznvh GZT RH HVG GL ml GSVM wLCBTVM DROO LMOB TVMVIZGV
# UROV MZNVH RM OLDVI XZHV OVGGVIH. rU HVG GL bvh FKKVI XZHV OVGGVIH ZIV ZOHL
# ZOOLDVW. gSRH RH FHVUFO RU BLF SZEV XOZHHVH LI UROVH DSLHV MZNVH LMOB WRUUVI
# RM XZHV ZMW RU BLFI UROV HBHGVN HFKKLIGH XZHV HVMHRGREV UROV MZNVH. dRMWLDH
# FHVIH ZIV ZWERXVW GL HVG GSRH LKGRLM GL ml.

xzhv_hvmhv_mznvh       = bvh

# rU GSV srwv_hxlkv_mznvh GZT RH HVG GL ml (GSV WVUZFOG) GSVM wLCBTVM
# DROO HSLD NVNYVIH DRGS GSVRI UFOO XOZHH ZMW MZNVHKZXV HXLKVH RM GSV
# WLXFNVMGZGRLM. rU HVG GL bvh GSV HXLKV DROO YV SRWWVM.

srwv_hxlkv_mznvh       = ml

# rU GSV eviyzgrn_svzwvih GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO TVMVIZGV Z EVIYZGRN XLKB LU GSV SVZWVI UROV ULI VZXS XOZHH ULI
# DSRXS ZM RMXOFWV RH HKVXRURVW. hVG GL ml GL WRHZYOV GSRH.

eviyzgrn_svzwvih       = bvh

# rU GSV hsld_rmxofwv_urovh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO KFG ORHG LU GSV UROVH GSZG ZIV RMXOFWVW YB Z UROV RM GSV WLXFNVMGZGRLM
# LU GSZG UROV.

hsld_rmxofwv_urovh     = bvh

# rU GSV qzezwlx_zfglyirvu GZT RH HVG GL bvh GSVM wLCBTVM
# DROO RMGVIKIVG GSV URIHG ORMV (FMGRO GSV URIHG WLG) LU Z qZEZwLX-HGBOV
# XLNNVMG ZH GSV YIRVU WVHXIRKGRLM. rU HVG GL ml, GSV qZEZwLX
# XLNNVMGH  DROO YVSZEV QFHG ORPV GSV jG-HGBOV XLNNVMGH (GSFH IVJFRIRMT ZM
# VCKORXG @YIRVU XLNNZMW ULI Z YIRVU WVHXIRKGRLM.

qzezwlx_zfglyirvu      = bvh

# rU GSV rmsvirg_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM ZM FMWLXFNVMGVW
# NVNYVI RMSVIRGH GSV WLXFNVMGZGRLM UILN ZMB WLXFNVMGVW NVNYVI GSZG RG
# IVRNKOVNVMGH.

rmsvirg_wlxh           = bvh

# rU GSV rmormv_rmul GZT RH HVG GL bvh (GSV WVUZFOG) GSVM Z GZT [RMORMV]
# RH RMHVIGVW RM GSV WLXFNVMGZGRLM ULI RMORMV NVNYVIH.

rmormv_rmul            = bvh

# rU GSV hlig_nvnyvi_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM WLCBTVM
# DROO HLIG GSV (WVGZROVW) WLXFNVMGZGRLM LU UROV ZMW XOZHH NVNYVIH
# ZOKSZYVGRXZOOB YB NVNYVI MZNV. rU HVG GL ml GSV NVNYVIH DROO ZKKVZI RM
# WVXOZIZGRLM LIWVI.

hlig_nvnyvi_wlxh       = bvh

# rU NVNYVI TILFKRMT RH FHVW RM GSV WLXFNVMGZGRLM ZMW GSV wrhgiryfgv_tilfk_wlx
# GZT RH HVG GL bvh, GSVM WLCBTVM DROO IVFHV GSV WLXFNVMGZGRLM LU GSV URIHG
# NVNYVI RM GSV TILFK (RU ZMB) ULI GSV LGSVI NVNYVIH LU GSV TILFK. yB WVUZFOG
# ZOO NVNYVIH LU Z TILFK NFHG YV WLXFNVMGVW VCKORXRGOB.

wrhgiryfgv_tilfk_wlx   = ml

# gSV gzy_hrav GZT XZM YV FHVW GL HVG GSV MFNYVI LU HKZXVH RM Z GZY.
# wLCBTVM FHVH GSRH EZOFV GL IVKOZXV GZYH YB HKZXVH RM XLWV UIZTNVMGH.

gzy_hrav               = 5

# gSV vmzyov_hvxgrlmh GZT XZM YV FHVW GL VMZYOV XLMWRGRLMZO
# WLXFNVMGZGRLM HVXGRLMH, NZIPVW YB \RU HVXGRLMMZNV ... \VMWRU.

vmzyovw_hvxgrlmh       =

# gSV tvmvizgv_glwlorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GLWL ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GLWL
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_glwlorhg      = bvh

# gSV tvmvizgv_gvhgorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GVHG ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GVHG
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_gvhgorhg      = bvh

tvmvizgv_givvervd      = bvh

# gSRH GZT XZM YV FHVW GL HKVXRUB Z MFNYVI LU ZORZHVH GSZG ZXGH
# ZH XLNNZMWH RM GSV WLXFNVMGZGRLM. zM ZORZH SZH GSV ULIN "MZNV=EZOFV".
# uLI VCZNKOV ZWWRMT "HRWVVUUVXG=\KZI hRWV vUUVXGH:\M" DROO ZOOLD BLF GL
# KFG GSV XLNNZMW \HRWVVUUVXG (LI @HRWVVUUVXG) RM GSV WLXFNVMGZGRLM, DSRXS
# DROO IVHFOG RM Z FHVI WVURMVW KZIZTIZKS DRGS SVZWRMT "hRWV vUUVXGH:".
# bLF XZM KFG \M'H RM GSV EZOFV KZIG LU ZM ZORZH GL RMHVIG MVDORMVH.

zorzhvh                =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL DZIMRMT ZMW KILTIVHH NVHHZTVH
#---------------------------------------------------------------------------

# gSV jfrvg GZT XZM YV FHVW GL GFIM LM/LUU GSV NVHHZTVH GSZG ZIV TVMVIZGVW
# YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP ml RH FHVW.

jfrvg                  = ml

# gSV dzimrmth GZT XZM YV FHVW GL GFIM LM/LUU GSV DZIMRMT NVHHZTVH GSZG ZIV
# TVMVIZGVW YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP
# ml RH FHVW.

dzimrmth               = bvh

# rU dzim_ru_fmwlxfnvmgvw RH HVG GL bvh, GSVM WLCBTVM DROO TVMVIZGV DZIMRMTH
# ULI FMWLXFNVMGVW NVNYVIH. rU vcgizxg_zoo RH HVG GL bvh GSVM GSRH UOZT DROO
# ZFGLNZGRXZOOB YV WRHZYOVW.

dzim_ru_fmwlxfnvmgvw   = bvh

# gSV dzim_ulinzg GZT WVGVINRMVH GSV ULINZG LU GSV DZIMRMT NVHHZTVH GSZG
# WLCBTVM XZM KILWFXV. gSV HGIRMT HSLFOW XLMGZRM GSV $UROV, $ORMV, ZMW $GVCG
# GZTH, DSRXS DROO YV IVKOZXVW YB GSV UROV ZMW ORMV MFNYVI UILN DSRXS GSV
# DZIMRMT LIRTRMZGVW ZMW GSV DZIMRMT GVCG.

dzim_ulinzg            = "$UROV:$ORMV: $GVCG"

# gSV dzim_olturov GZT XZM YV FHVW GL HKVXRUB Z UROV GL DSRXS DZIMRMT
# ZMW VIILI NVHHZTVH HSLFOW YV DIRGGVM. rU OVUG YOZMP GSV LFGKFG RH DIRGGVM
# GL HGWVII.

dzim_olturov           =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV RMKFG UROVH
#---------------------------------------------------------------------------

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

#rmkfg                  =  NBwRIVXGLIB
# RMKFG GZT NLEVW GL GLK LU GSRH UROV

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

urov_kzggvimh          =  *.S *.XKK *.SKK *.XCC

# gSV ivxfihrev GZT XZM YV FHVW GL GFIM HKVXRUB DSVGSVI LI MLG HFYWRIVXGLIRVH
# HSLFOW YV HVZIXSVW ULI RMKFG UROVH ZH DVOO. kLHHRYOV EZOFVH ZIV bvh ZMW ml.
# rU OVUG YOZMP ml RH FHVW.

ivxfihrev              = bvh

# gSV vcxofwv GZT XZM YV FHVW GL HKVXRUB UROVH ZMW/LI WRIVXGLIRVH GSZG HSLFOW
# VCXOFWVW UILN GSV rmkfg HLFIXV UROVH. gSRH DZB BLF XZM VZHROB VCXOFWV Z
# HFYWRIVXGLIB UILN Z WRIVXGLIB GIVV DSLHV ILLG RH HKVXRURVW DRGS GSV rmkfg GZT.

vcxofwv                =

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcxofwv_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIMH GL VCXOFWV
# XVIGZRM UROVH UILN GSLHV WRIVXGLIRVH.

vcxofwv_kzggvimh       =

# gSV vcznkov_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM VCZNKOV XLWV UIZTNVMGH GSZG ZIV RMXOFWVW (HVV
# GSV \RMXOFWV XLNNZMW).

vcznkov_kzgs           =

# rU GSV EZOFV LU GSV vcznkov_kzgs GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcznkov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

vcznkov_kzggvimh       =

# gSV rnztv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM RNZTV GSZG ZIV RMXOFWVW RM GSV WLXFNVMGZGRLM (HVV
# GSV \RNZTV XLNNZMW).

rnztv_kzgs             =

# gSV rmkfg_urogvi GZT XZM YV FHVW GL HKVXRUB Z KILTIZN GSZG WLCBTVM HSLFOW
# RMELPV GL UROGVI ULI VZXS RMKFG UROV. wLCBTVM DROO RMELPV GSV UROGVI KILTIZN
# YB VCVXFGRMT (ERZ KLKVM()) GSV XLNNZMW <UROGVI> <RMKFG-UROV>, DSVIV <UROGVI>
# RH GSV EZOFV LU GSV rmkfg_urogvi GZT, ZMW <RMKFG-UROV> RH GSV MZNV LU ZM
# RMKFG UROV. wLCBTVM DROO GSVM FHV GSV LFGKFG GSZG GSV UROGVI KILTIZN DIRGVH
# GL HGZMWZIW LFGKFG.

rmkfg_urogvi           =

# rU GSV urogvi_hlfixv_urovh GZT RH HVG GL bvh, GSV RMKFG UROGVI (RU HVG FHRMT
# rmkfg_urogvi) DROO YV FHVW GL UROGVI GSV RMKFG UROVH DSVM KILWFXRMT HLFIXV
# UROVH GL YILDHV.

urogvi_hlfixv_urovh    = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV ZOKSZYVGRXZO XOZHH RMWVC
#---------------------------------------------------------------------------

# rU GSV zokszyvgrxzo_rmwvc GZT RH HVG GL bvh, ZM ZOKSZYVGRXZO RMWVC
# LU ZOO XLNKLFMWH DROO YV TVMVIZGVW. vMZYOV GSRH RU GSV KILQVXG
# XLMGZRMH Z OLG LU XOZHHVH, HGIFXGH, FMRLMH LI RMGVIUZXVH.

zokszyvgrxzo_rmwvc     = bvh

# rU GSV ZOKSZYVGRXZO RMWVC RH VMZYOVW (HVV zokszyvgrxzo_rmwvc) GSVM
# GSV xloh_rm_zoksz_rmwvc GZT XZM YV FHVW GL HKVXRUB GSV MFNYVI LU XLOFNMH
# RM DSRXS GSRH ORHG DROO YV HKORG (XZM YV Z MFNYVI RM GSV IZMTV [8..79])

xloh_rm_zoksz_rmwvc    = 6

# rM XZHV ZOO XOZHHVH RM Z KILQVXG HGZIG DRGS Z XLNNLM KIVURC, ZOO
# XOZHHVH DROO YV KFG FMWVI GSV HZNV SVZWVI RM GSV ZOKSZYVGRXZO RMWVC.
# gSV rtmliv_kivurc GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KIVURCVH GSZG
# HSLFOW YV RTMLIVW DSROV TVMVIZGRMT GSV RMWVC SVZWVIH.

rtmliv_kivurc          =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV sgno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_sgno GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV sgno LFGKFG.

tvmvizgv_sgno          = bvh

# gSV sgno_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV sgno WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `SGNO' DROO YV FHVW ZH GSV WVUZFOG KZGS.

sgno_lfgkfg            = SGNO

# gSV sgno_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno SVZWVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI.

sgno_svzwvi            =

# gSV sgno_ullgvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno ULLGVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW ULLGVI.

sgno_ullgvi            =

# gSV sgno_hgbovhsvvg GZT XZM YV FHVW GL HKVXRUB Z FHVI WVURMVW XZHXZWRMT
# HGBOV HSVVG GSZG RH FHVW YB VZXS sgno KZTV. rG XZM YV FHVW GL
# URMV-GFMV GSV OLLP LU GSV sgno LFGKFG. rU GSV GZT RH OVUG YOZMP WLCBTVM
# DROO TVMVIZGV Z WVUZFOG HGBOV HSVVG

sgno_hgbovhsvvg        =

# rU GSV sgno_zortm_nvnyvih GZT RH HVG GL bvh, GSV NVNYVIH LU XOZHHVH,
# UROVH LI MZNVHKZXVH DROO YV ZORTMVW RM sgno FHRMT GZYOVH. rU HVG GL
# ml Z YFOOVG ORHG DROO YV FHVW.

sgno_zortm_nvnyvih     = bvh

# rU GSV tvmvizgv_sgnosvok GZT RH HVG GL bvh, ZWWRGRLMZO RMWVC UROVH
# DROO YV TVMVIZGVW GSZG XZM YV FHVW ZH RMKFG ULI GLLOH ORPV GSV
# nRXILHLUG sgno SVOK DLIPHSLK GL TVMVIZGV Z XLNKIVHHVW sgno SVOK UROV (.XSN)
# LU GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

tvmvizgv_sgnosvok      = ml

# gSV wrhzyov_rmwvc GZT XZM YV FHVW GL GFIM LM/LUU GSV XLMWVMHVW RMWVC ZG
# GLK LU VZXS sgno KZTV. gSV EZOFV ml (GSV WVUZFOG) VMZYOVH GSV RMWVC ZMW
# GSV EZOFV bvh WRHZYOVH RG.

wrhzyov_rmwvc          = ml

# gSRH GZT XZM YV FHVW GL HVG GSV MFNYVI LU VMFN EZOFVH (IZMTV [8..79])
# GSZG WLCBTVM DROO TILFK LM LMV ORMV RM GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

vmfn_ezofvh_kvi_ormv   = 5

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV oZgVc LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_ozgvc GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV oZGVC LFGKFG.

tvmvizgv_ozgvc         = ml

# gSV ozgvc_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV oZgVc WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `OZGVC' DROO YV FHVW ZH GSV WVUZFOG KZGS.

ozgvc_lfgkfg           = OZGVC

# rU GSV xlnkzxg_ozgvc GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# oZgVc WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_ozgvc          = ml

# gSV kzkvi_gbkv GZT XZM YV FHVW GL HVG GSV KZKVI GBKV GSZG RH FHVW
# YB GSV KIRMGVI. kLHHRYOV EZOFVH ZIV: Z5, Z5DRWV, OVGGVI, OVTZO ZMW
# VCVXFGREV. rU OVUG YOZMP Z5DRWV DROO YV FHVW.

kzkvi_gbkv             = Z5DRWV

# gSV vcgiz_kzxpztvh GZT XZM YV GL HKVXRUB LMV LI NLIV MZNVH LU oZgVc
# KZXPZTVH GSZG HSLFOW YV RMXOFWVW RM GSV oZgVc LFGKFG.

vcgiz_kzxpztvh         =

# gSV ozgvc_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO oZgVc SVZWVI ULI
# GSV TVMVIZGVW OZGVC WLXFNVMG. gSV SVZWVI HSLFOW XLMGZRM VEVIBGSRMT FMGRO
# GSV URIHG XSZKGVI. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI. mLGRXV: LMOB FHV GSRH GZT RU BLF PMLD DSZG BLF ZIV WLRMT!

ozgvc_svzwvi           =

# rU GSV kwu_sbkviormph GZT RH HVG GL bvh, GSV oZgVc GSZG RH TVMVIZGVW
# RH KIVKZIVW ULI XLMEVIHRLM GL KWU (FHRMT KH7KWU). gSV KWU UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z KWU ERVDVI.

kwu_sbkviormph         = ml

# rU GSV fhv_kwuozgvc GZT RH HVG GL bvh, KWUOZGVC DROO YV FHVW RMHGVZW LU
# KOZRM OZGVC RM GSV TVMVIZGVW nZPVUROV. hVG GSRH LKGRLM GL bvh GL TVG Z
# SRTSVI JFZORGB kwu WLXFNVMGZGRLM.

fhv_kwuozgvc           = ml

# rU GSV ozgvc_yzgxsnlwv GZT RH HVG GL bvh, WLCBTVM DROO ZWW GSV \\YZGXSNLWV.
# XLNNZMW GL GSV TVMVIZGVW oZgVc UROVH. gSRH DROO RMHGIFXG oZgVc GL PVVK
# IFMMRMT RU VIILIH LXXFI, RMHGVZW LU ZHPRMT GSV FHVI ULI SVOK.
# gSRH LKGRLM RH ZOHL FHVW DSVM TVMVIZGRMT ULINFOZH RM sgno.

ozgvc_yzgxsnlwv        = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV igu LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_igu GZT RH HVG GL bvh wLCBTVM DROO TVMVIZGV igu LFGKFG
# gSV igu LFGKFG RH LKGRNRHVW ULI dLIW 02 ZMW NZB MLG OLLP EVIB KIVGGB DRGS
# LGSVI igu IVZWVIH LI VWRGLIH.

tvmvizgv_igu           = ml

# gSV igu_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV igu WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `IGU' DROO YV FHVW ZH GSV WVUZFOG KZGS.

igu_lfgkfg             = IGU

# rU GSV xlnkzxg_igu GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# igu WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_igu            = bvh

# rU GSV igu_sbkviormph GZT RH HVG GL bvh, GSV igu GSZG RH TVMVIZGVW
# DROO XLMGZRM SBKVIORMP URVOWH. gSV igu UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH.
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z dliw LI LGSVI.
# KILTIZNH DSRXS HFKKLIG GSLHV URVOWH.
# mLGV: DLIWKZW (DIRGV) ZMW LGSVIH WL MLG HFKKLIG ORMPH.

igu_sbkviormph         = ml

# oLZW HGBOVHSVVG WVURMRGRLMH UILN UROV. hBMGZC RH HRNROZI GL WLCBTVM'H
# XLMURT UROV, R.V. Z HVIRVH LU ZHHRTNVMGH. bLF LMOB SZEV GL KILERWV
# IVKOZXVNVMGH, NRHHRMT WVURMRGRLMH ZIV HVG GL GSVRI WVUZFOG EZOFV.

igu_hgbovhsvvg_urov    =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV NZM KZTV LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_nzm GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV NZM KZTVH

tvmvizgv_nzm           = ml

# gSV nzm_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV NZM KZTVH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `NZM' DROO YV FHVW ZH GSV WVUZFOG KZGS.

nzm_lfgkfg             = NZM

# gSV nzm_vcgvmhrlm GZT WVGVINRMVH GSV VCGVMHRLM GSZG RH ZWWVW GL
# GSV TVMVIZGVW NZM KZTVH (WVUZFOG RH GSV HFYILFGRMV'H HVXGRLM .6)

nzm_vcgvmhrlm          = .6

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV cno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_cno GZT RH HVG GL bvh wLCBTVM DROO
# TVMVIZGV ZM cno UROV GSZG XZKGFIVH GSV HGIFXGFIV LU
# GSV XLWV RMXOFWRMT ZOO WLXFNVMGZGRLM. dZIMRMT: gSRH UVZGFIV
# RH HGROO VCKVIRNVMGZO ZMW EVIB RMXLNKOVGV.

tvmvizgv_cno           = ml

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV KIVKILXVHHLI
#---------------------------------------------------------------------------

# rU GSV vmzyov_kivkilxvhhrmt GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# VEZOFZGV ZOO x-KIVKILXVHHLI WRIVXGREVH ULFMW RM GSV HLFIXVH ZMW RMXOFWV
# UROVH.

vmzyov_kivkilxvhhrmt   = bvh

# rU GSV nzxil_vckzmhrlm GZT RH HVG GL bvh wLCBTVM DROO VCKZMW ZOO NZXIL
# MZNVH RM GSV HLFIXV XLWV. rU HVG GL ml (GSV WVUZFOG) LMOB XLMWRGRLMZO
# XLNKROZGRLM DROO YV KVIULINVW. nZXIL VCKZMHRLM XZM YV WLMV RM Z XLMGILOOVW
# DZB YB HVGGRMT vckzmw_lmob_kivwvu GL bvh.

nzxil_vckzmhrlm        = ml

# rU GSV vckzmw_lmob_kivwvu ZMW nzxil_vckzmhrlm GZTH ZIV YLGS HVG GL bvh
# GSVM GSV NZXIL VCKZMHRLM RH ORNRGVW GL GSV NZXILH HKVXRURVW DRGS GSV
# kivwvurmvw ZMW vckzmw_zh_kivwvurmvw GZTH.

vckzmw_lmob_kivwvu     = ml

# rU GSV hvzixs_rmxofwvh GZT RH HVG GL bvh (GSV WVUZFOG) GSV RMXOFWVH UROVH
# RM GSV rmxofwv_kzgs (HVV YVOLD) DROO YV HVZIXS RU Z #RMXOFWV RH ULFMW.

hvzixs_rmxofwvh        = bvh

# gSV rmxofwv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV WRIVXGLIRVH GSZG
# XLMGZRM RMXOFWV UROVH GSZG ZIV MLG RMKFG UROVH YFG HSLFOW YV KILXVHHVW YB
# GSV KIVKILXVHHLI.

rmxofwv_kzgs           =

# bLF XZM FHV GSV rmxofwv_urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW
# KZGGVIMH (ORPV *.S ZMW *.SKK) GL UROGVI LFG GSV SVZWVI-UROVH RM GSV
# WRIVXGLIRVH. rU OVUG YOZMP, GSV KZGGVIMH HKVXRURVW DRGS urov_kzggvimh DROO
# YV FHVW.

rmxofwv_urov_kzggvimh  =

# gSV kivwvurmvw GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV NZXIL MZNVH GSZG
# ZIV WVURMVW YVULIV GSV KIVKILXVHHLI RH HGZIGVW (HRNROZI GL GSV -w LKGRLM LU
# TXX). gSV ZITFNVMG LU GSV GZT RH Z ORHG LU NZXILH LU GSV ULIN: MZNV
# LI MZNV=WVURMRGRLM (ML HKZXVH). rU GSV WVURMRGRLM ZMW GSV = ZIV
# LNRGGVW =8 RH ZHHFNVW.

kivwvurmvw             =  xliv_tilfk

# rU GSV nzxil_vckzmhrlm ZMW vckzmw_kivwvu_lmob GZTH ZIV HVG GL bvh GSVM
# GSRH GZT XZM YV FHVW GL HKVXRUB Z ORHG LU NZXIL MZNVH GSZG HSLFOW YV VCKZMWVW.
# gSV NZXIL WVURMRGRLM GSZG RH ULFMW RM GSV HLFIXVH DROO YV FHVW.
# fHV GSV kivwvurmvw GZT RU BLF DZMG GL FHV Z WRUUVIVMG NZXIL WVURMRGRLM.

vckzmw_zh_wvurmvw      =

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL VCGVIMZO IVUVIVMXVH
#---------------------------------------------------------------------------

# gSV gzturovh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV GZTUROVH.

gzturovh               =

# dSVM Z UROV MZNV RH HKVXRURVW ZUGVI tvmvizgv_gzturov, WLCBTVM DROO XIVZGV
# Z GZT UROV GSZG RH YZHVW LM GSV RMKFG UROVH RG IVZWH.

tvmvizgv_gzturov       =

# rU GSV zoovcgvimzoh GZT RH HVG GL bvh ZOO VCGVIMZO XOZHHVH DROO YV ORHGVW
# RM GSV XOZHH RMWVC. rU HVG GL ml LMOB GSV RMSVIRGVW VCGVIMZO XOZHHVH
# DROO YV ORHGVW.

zoovcgvimzoh           = ml

# gSV kvio_kzgs HSLFOW YV GSV ZYHLOFGV KZGS ZMW MZNV LU GSV KVIO HXIRKG
# RMGVIKIVGVI (R.V. GSV IVHFOG LU `DSRXS KVIO').

kvio_kzgs              = /FHI/YRM/KVIO

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV WLG GLLO
#---------------------------------------------------------------------------

# rU BLF HVG GSV szev_wlg GZT GL bvh GSVM WLCBTVM DROO ZHHFNV GSV WLG GLLO RH
# ZEZROZYOV UILN GSV KZGS. gSRH GLLO RH KZIG LU tIZKSERA, Z TIZKS ERHFZORAZGRLM
# GLLOPRG UILN zg&g ZMW oFXVMG yVOO oZYH. gSV LGSVI LKGRLMH RM GSRH HVXGRLM
# SZEV ML VUUVXG RU GSRH LKGRLM RH HVG GL ml (GSV WVUZFOG)

szev_wlg               = bvh

# rU GSV xozhh_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RMSVIRGZMXV IVOZGRLMH. hVGGRMT GSRH GZT GL bvh DROO ULIXV GSV
# GSV xozhh_wrztiznh GZT GL ml.

xozhh_tizks            = bvh

# rU GSV xloozylizgrlm_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RNKOVNVMGZGRLM WVKVMWVMXRVH (RMSVIRGZMXV, XLMGZRMNVMG, ZMW
# XOZHH IVUVIVMXVH EZIRZYOVH) LU GSV XOZHH DRGS LGSVI WLXFNVMGVW XOZHHVH.

xloozylizgrlm_tizks    = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwv_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW UROV HSLDRMT
# GSV WRIVXG ZMW RMWRIVXG RMXOFWV WVKVMWVMXRVH LU GSV UROV DRGS LGSVI
# WLXFNVMGVW UROVH.

rmxofwv_tizks          = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwvw_yb_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW SVZWVI UROV HSLDRMT
# GSV WLXFNVMGVW UROVH GSZG WRIVXGOB LI RMWRIVXGOB RMXOFWV GSRH UROV

rmxofwvw_yb_tizks      = bvh

# rU GSV tizksrxzo_srvizixsb ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TIZKSRXZO SRVIZIXSB LU ZOO XOZHHVH RMHGVZW LU Z GVCGFZO LMV.

tizksrxzo_srvizixsb    = bvh

# gSV GZT wlg_kzgs XZM YV FHVW GL HKVXRUB GSV KZGS DSVIV GSV WLG GLLO XZM YV
# ULFMW. rU OVUG YOZMP, RG RH ZHHFNVW GSV WLG GLLO XZM YV ULFMW LM GSV KZGS.

wlg_kzgs               =

# gSV nzc_wlg_tizks_drwgs GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDVW DRWGS
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_drwgs    = 8975

# gSV nzc_wlg_tizks_svrtsg GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDH SVRTSG
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_svrtsg   = 8975

# rU GSV tvmvizgv_ovtvmw GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z OVTVMW KZTV VCKOZRMRMT GSV NVZMRMT LU GSV EZIRLFH YLCVH ZMW
# ZIILDH RM GSV WLG TVMVIZGVW TIZKSH.

tvmvizgv_ovtvmw        = bvh

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL GSV HVZIXS VMTRMV
#---------------------------------------------------------------------------

# gSV hvzixsvmtrmv GZT HKVXRURVH DSVGSVI LI MLG Z HVZIXS VMTRMV HSLFOW YV
# FHVW. rU HVG GL ml GSV EZOFVH LU ZOO GZTH YVOLD GSRH LMV DROO YV RTMLIVW.

hvzixsvmtrmv           = ml

# gSV xtr_mznv GZT HSLFOW YV GSV MZNV LU GSV xtr HXIRKG GSZG
# HGZIGH GSV HVZIXS VMTRMV (WLCBHVZIXS) DRGS GSV XLIIVXG KZIZNVGVIH.
# z HXIRKG DRGS GSRH MZNV DROO YV TVMVIZGVW YB WLCBTVM.

xtr_mznv               = HVZIXS.XTR

# gSV xtr_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# XTR YRMZIRVH ZIV OLXZGVW. hVV GSV WLXFNVMGZGRLM LU BLFI SGGK WZVNLM ULI
# WVGZROH.

xtr_fio                =

# gSV wlx_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV ZYHLOFGV KZGS GL GSV
# WLXFNVMGZGRLM, DRGS UROV:// KIVKVMWVW GL RG, DROO YV FHVW.

wlx_fio                =

# gSV wlx_zyhkzgs GZT HSLFOW YV GSV ZYHLOFGV KZGS GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV WRIVXGLIB LM GSV OLXZO NZXSRMV
# DROO YV FHVW.

wlx_zyhkzgs            =

# gSV yrm_zyhkzgs GZT NFHG KLRMG GL GSV WRIVXGLIB DSVIV GSV WLCBHVZIXS YRMZIB
# RH RMHGZOOVW.

yrm_zyhkzgs            = /FHI/OLXZO/YRM/

# gSV vcg_wlx_kzgsh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KZGSH GL
# WLXFNVMGZGRLM TVMVIZGVW ULI LGSVI KILQVXGH. gSRH ZOOLDH WLCBHVZIXS GL HVZIXS
# GSV WLXFNVMGZGRLM ULI GSVHV KILQVXGH ZH DVOO.

vcg_wlx_kzgsh          =

//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/__RMRG__.KB
//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/HXSVNZ.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
UILN  KZGSORY RNKLIG kZGS
RNKLIG MVGDLIPC ZH MC
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG NZGKOLGORY
NZGKOLGORY.FHV('zTT')
RNKLIG NZGKOLGORY.KBKOLG ZH KOG

XOZHH rMGVIUZXV(LYQVXG):
    '''XOZHH ULI RMGVIUZXV.'''
    WVU __RMRG__(HVOU, HVIEVI, CNO, TOLYZORMUL):
        """XGLI."""
        HVOU.CNO = CNO
        HVOU.HVIEVI = HVIEVI
        HVOU.RH_HVIEVI = uZOHV
        HVOU.KLIG = mLMV
        HVOU.RK = mLMV
        HVOU.GBKV = 'RMGVIUZXV'
        HVOU.TOLYZO_RMUL = TOLYZORMUL
        HVOU.ZXGREV = gIFV
        HVOU.WLNZRM = HVIEVI.WLNZRM

    WVU KZIHV_CNO(HVOU):
        HVOU.RW = HVOU.CNO.ZGGIRY['RW']
        HVOU.MZNV = HVOU.HVIEVI.RW + '.' + HVOU.RW
        RU 'ORHGVM' RM HVOU.CNO.ZGGIRY:
            HVOU.RH_HVIEVI = gIFV
            HVOU.KLIG = HVOU.CNO.ZGGIRY['ORHGVM']
        HVOU.RK = HVOU.CNO.ZGGIRY['RK']


XOZHH hVIEVI(LYQVXG):
    '''XOZHH ULI VZXS HVIEVI.'''
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        """XGLI."""
        HVOU.RMGVIUZXV_ORHG = {}
        HVOU.CNO = CNO
        HVOU.TOLYZO_RMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.RW = CNO.ZGGIRY['RW']
        HVOU.WLNZRM = CNO.ZGGIRY['WLNZRM']
        HVOU.MZNV = HVOU.RW
        HVOU.GBKV = 'HVIEVI'
        # VZXS HVIEVI HSZOO SZEV Z OLLKYZXP RMGVIUZXV
        OL = rMGVIUZXV(HVOU, mLMV, TOLYZORMUL)
        OL.RW = 'OL'
        OL.RK = '872.9.9.8'
        OL.MZNV = HVOU.RW + '.OL'
        HVOU.RMGVIUZXV_ORHG['OL'] = OL
        # DV NZB GVNKLIZIROB WRHZYOV LMV MLWV
        RU 'ZXGREV' RM CNO.ZGGIRY:
            HVOU.ZXGREV = (CNO.ZGGIRY['ZXGREV'].OLDVI()=='GIFV')
        VOHV:
            HVOU.ZXGREV = gIFV

    WVU KZIHV(HVOU):
        """KZIHV HVIEVI RMULINZGRLM."""
        ULI RMGVI_CNO RM HVOU.CNO.URMWZOO('RMGVIUZXV'):
            RMGVIUZXV = rMGVIUZXV(HVOU, RMGVI_CNO, HVOU.TOLYZO_RMUL)
            RMGVIUZXV.ZXGREV = HVOU.ZXGREV
            RMGVIUZXV.KZIHV_CNO()
            HVOU.RMGVIUZXV_ORHG[RMGVIUZXV.RW] = RMGVIUZXV

    WVU IVTRHGVI(HVOU, wt, EZFOG):
        HVOU.EZFOG = EZFOG
        wt.ZWW_MLWV(HVOU)
        HVOU.EZFOG.MLWV_HRAV[HVOU] = 839*89
        HVOU.EZFOG.MLWV_OZYVO[HVOU] = HVOU.RW
        HVOU.EZFOG.MLWV_XLOLI[HVOU] = 74
        ULI P, RMGVIUZXV RM HVOU.RMGVIUZXV_ORHG.RGVNH():
            wt.ZWW_MLWV(RMGVIUZXV)
            HVOU.EZFOG.MLWV_OZYVO[RMGVIUZXV] = RMGVIUZXV.RW
            HVOU.EZFOG.MLWV_HRAV[RMGVIUZXV] = 39*89
            HVOU.EZFOG.MLWV_XLOLI[RMGVIUZXV] = 69
            # HVOU->HVOU
            wt.ZWW_VWTV(HVOU, RMGVIUZXV, WRHGZMXV=9.9)
            wt.ZWW_VWTV(RMGVIUZXV, HVOU, WRHGZMXV=9.9)
        HVOU.wt = wt

    WVU XLMMVXG(HVOU):
        ULI P, RMGVIUZXV RM HVOU.RMGVIUZXV_ORHG.RGVNH():
            RU P == 'OL' LI 'LFG' MLG RM RMGVIUZXV.CNO.ZGGIRY:
                XLMGRMFV
            LFG_ORHG = [R.HGIRK() ULI R RM RMGVIUZXV.CNO.ZGGIRY['LFG'].HKORG(',')]
            ULI LFG RM LFG_ORHG:
                WRHGZMXV = 8
                LFGWZGZ = LFG.HKORG('@')
                RU OVM(LFGWZGZ) > 8:
                     WRHGZMXV = UOLZG(LFGWZGZ[8])
                GZITVG = HVOU.EZFOG.URMW(LFG.HKORG('.')[9].HKORG('@')[9]).URMW(LFG.HKORG('.')[8].HKORG('@')[9])
                RU MLG GZITVG.ZXGREV LI MLG HVOU.ZXGREV:
                    WRHGZMXV = 899999
                    HVOU.OLTTVI.DZIM('MLWV %H->%H RH MLG XLMMVXGVW ZH MLWV HGZGFH RH MLG ZXGREV'%(HVOU.RW, GZITVG.MZNV))
                VOHV:
                    RU RMGVIUZXV.WLNZRM == GZITVG.WLNZRM:
                        WRHGZMXV = 9.8
                        HVOU.OLTTVI.WVYFT('MLWV %H->%H RH HVG GL 9.98 LU KILCRNRGB ZH GSVB ZIV RM GSV HZNV WLNZRM'%(HVOU.RW, GZITVG.MZNV))
                HVOU.wt.ZWW_VWTV(RMGVIUZXV, GZITVG , WRHGZMXV=WRHGZMXV)

        # XLMMVXG ZORZH
        ULI ZORZH_CNO RM HVOU.CNO.URMWZOO('ZORZH'):
            GZITVG_HGI = ZORZH_CNO.ZGGIRY['GZITVG']
            OLXZO = ZORZH_CNO.ZGGIRY['UILN']
            WRHGZMXV = 8
            RU 'WRHGZMXV' RM ZORZH_CNO.ZGGIRY:
                WRHGZMXV = UOLZG(ZORZH_CNO.ZGGIRY['WRHGZMXV'])
            GZITVG = HVOU.EZFOG.URMW(GZITVG_HGI.HKORG('.')[9]).URMW(GZITVG_HGI.HKORG('.')[8])
            RU MLG GZITVG.ZXGREV LI MLG HVOU.ZXGREV:
                WRHGZMXV = 899999
                HVOU.OLTTVI.DZIM('MLWV %H->%H RH MLG XLMMVXGVW ZH MLWV HGZGFH RH MLG ZXGREV'%(HVOU.RW, GZITVG.MZNV))
            VOHV:
                RU HVOU.WLNZRM == GZITVG.WLNZRM:
                    WRHGZMXV = 9.8
                    HVOU.OLTTVI.WVYFT('MLWV %H->%H RH HVG GL 9.98 LU KILCRNRGB ZH GSVB ZIV RM GSV HZNV WLNZRM'%(HVOU.RW, GZITVG.MZNV))
            HVOU.wt.ZWW_VWTV(HVOU.RMGVIUZXV_ORHG[OLXZO],GZITVG, WRHGZMXV=WRHGZMXV)
            RU HVOU.RW == HVOU.TOLYZO_RMUL.SLHG:
                RU 'RK' RM ZORZH_CNO.ZGGIRY:
                    GZITVG.RK = ZORZH_CNO.ZGGIRY['RK']
                VOHV:
                    GZITVG.RK = '872.9.9.8'
                GZITVG.KLIG = ZORZH_CNO.ZGGIRY['KLIG']
                HVOU.OLTTVI.RMUL('[ZORZH] %H RH ZORZHVW GL %H:%H'%(GZITVG_HGI, GZITVG.RK, GZITVG.KLIG))

    WVU URMW(HVOU, MZNV):
        IVGFIM HVOU.RMGVIUZXV_ORHG[MZNV]


XOZHH eZFOG(LYQVXG):
    '''SLOWRMT ZOO TIZKS VOVNVMGH'''
    WVU __RMRG__(HVOU, CNO, wt, TOLYZORMUL):
        HVOU.HVIEVI_ORHG = {}
        HVOU.MLWV_OZYVO = {}
        HVOU.MLWV_HRAV = {}
        HVOU.MLWV_XLOLI = {}
        HVOU.wt = wt
        HVOU.TOLYZO_RMUL = TOLYZORMUL
        ULI MLWV_CNO RM CNO.URMWZOO('MLWV'):
            HVIEVI = hVIEVI(MLWV_CNO, TOLYZORMUL)
            HVIEVI.EZFOG = HVOU
            HVIEVI.KZIHV()
            HVIEVI.IVTRHGVI(wt, HVOU)
            HVOU.HVIEVI_ORHG[HVIEVI.RW] = HVIEVI

    WVU URMW(HVOU, MZNV):
        RU MZNV RM HVOU.HVIEVI_ORHG:
            IVGFIM HVOU.HVIEVI_ORHG[MZNV]
        VOHV:
            IVGFIM mLMV

    WVU ZOO_HVIEVIH(HVOU):
        IVGFIM HVOU.HVIEVI_ORHG

WVU KZIHV_GLKLOLTB(CNO, TOLYZORMUL):
    wt = MC.nFOGRwRtIZKS()
    EZFOG = eZFOG(CNO, wt, TOLYZORMUL)
    ULI P, HVIEVI RM EZFOG.HVIEVI_ORHG.RGVNH():
        # KIRMG(P, HVIEVI.RW, HVIEVI.WLNZRM)
        HVIEVI.XLMMVXG()
    TOLYZORMUL.IVWHSRUG_WZGZ.KIVKZIV_ZOO_HGZGFH(EZFOG)
    IVGFIM EZFOG

WVU KOLG(EZFOG):
    wt = EZFOG.wt
    KLH = MC.HKIRMT_OZBLFG(wt)
    MC.WIZD_MVGDLIPC_MLWVH(wt, KLH, wt.MLWVH(), MLWV_HRAV=[EZFOG.MLWV_HRAV[R] ULI R RM wt.MLWVH()],
                           MLWV_XLOLI=[EZFOG.MLWV_XLOLI[R] ULI R RM wt.MLWVH()])
    MC.WIZD_MVGDLIPC_VWTVH(wt, KLH)
    MC.WIZD_MVGDLIPC_OZYVOH(wt, KLH, EZFOG.MLWV_OZYVO)
    KOG.ZCRH('LUU')
    KOG.HZEVURT('GLKLOLTB.KMT', ULINZG='kmt')

RU __MZNV__ == '__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'C:', ['CNO='])
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-C', '--CNO'):
            CNOUROV = ZIT
    GIVV = VGIVV.KZIHV(CNOUROV)
    GLKLOLTB = KZIHV_GLKLOLTB(GIVV, mLMV)
    KOLG(GLKLOLTB)
//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/YIRWTV.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG GRNV
UILN XLNNFMRXZGV.XORVMG RNKLIG hGZIUOVVGwLXPVI
UILN GVINRGVKRKV.XORVMGSVOKVI.XORVMG RNKLIG gVINRGVKRKVwLXPVI
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
RNKLIG TIKX
UILN XLMXFIIVMG RNKLIG UFGFIVH
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY


XOZHH yIRWTVtIVVGVI(HVIERXV_KY7_TIKX.tIVVGVIhVIERXVI):
    """tikx XLNNZMW KILXVHHLI. """

    WVU __RMRG__(HVOU, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.IVWHSRUG = HVOU.TOLYZO_RMUL.IVWHSRUG
        #HVOU.MLWV_NZMZTVI = TOLYZO_RMUL.MLWV_NZMZTVI
        #HVOU.XLNNZMW_KLLO  = TOLYZO_RMUL.XLNNZMW_KLLO
        #HVOU.NZHGVI_MLWV = HVOU.MLWV_NZMZTVI.NZHGVI_MLWV

    WVU hVMWnVHHZTV(HVOU, IVJFVHG, XLMGVCG):
        # RNNVWRZGVOB KLMT ZH IVXVRERMT KRMT
        RU IVJFVHG.XLNNZMW == 'KRMT':
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='KLMT')
        # XZOO LM_HVMW_IVXE
        #KIRMG(HVOU.TOLYZO_RMUL.IVWHSRUG.LM_HVMW_IVXE(IVJFVHG))
        IVKOB = HVOU.IVWHSRUG.HVMW(IVJFVHG)
        RU IVKOB RH mLMV:
            IVKOB = HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='UZROVW DRGS ML VCKORXRG IVZHLM')
        IVGFIM IVKOB
        #IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(NVHHZTV='lp')


XOZHH yIRWTV(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.HVIEVI_RK = '872.9.9.8'
        RU HVOU.TOLYZO_RMUL.IVWHSRUG_WZGZ.RH_GVHG:
            HVOU.KLIG = '49938'
        VOHV:
            HVOU.KLIG = '49939'
        # XIVZGV HVIEVI
        HVOU.HVIEVI = TIKX.HVIEVI(UFGFIVH.gSIVZWkLLOvCVXFGLI(NZC_DLIPVIH=TOLYZO_RMUL.IVWHSRUG_WZGZ.NZC_DLIPVI_MFNYVI))
        HVIERXV_KY7_TIKX.ZWW_tIVVGVIhVIERXVI_GL_HVIEVI(yIRWTVtIVVGVI(HVOU.TOLYZO_RMUL), HVOU.HVIEVI)
        HVOU.HVIEVI.ZWW_RMHVXFIV_KLIG('%H:%H'%(HVOU.HVIEVI_RK, HVOU.KLIG))
        # GIB GL XLMMVXG GL HGZIUOVVG WLXPVI
        HVOU.WLXPVI = hGZIUOVVGwLXPVI('872.9.9.8', 49949)
        HVOU.GVINRGVKRKV_WLXPVI_NZK = {}
        HVOU.GVINRGVKRKV_WLXPVI = gVINRGVKRKVwLXPVI('872.9.9.8', '39999') # WVUZFOG GVINRGVKRKV WLXPVI
        HVOU.GVINRGVKRKV_WLXPVI_NZK['_mLMV'] = HVOU.GVINRGVKRKV_WLXPVI
        HVOU.ZXJFRIV_GVINRGVKRKV_WLXPVI()

        HVOU.QLY = qLY(HVOU)
        HVOU.TOLYZO_RMUL.YIRWTV = HVOU
        HVOU.HGZGFH = uZOHV


    WVU ZXJFRIV_GVINRGVKRKV_WLXPVI(HVOU):
        HVOU.TOLYZO_RMUL.YFOOVGRM.IVZW()
        ULI ILD RM HVOU.TOLYZO_RMUL.YFOOVGRM.ILD_ORHG:
            RU ILD.GRGOV.HKORG('&')[9].HGIRK() == 'KRKVORMVKLIG':
                PVB = ILD.XLMGVMG.HKORG('&')[8]
                KLIG= ILD.XLMGVMG.HKORG('&')[9]
                HVOU.GVINRGVKRKV_WLXPVI_NZK[PVB] = gVINRGVKRKVwLXPVI('872.9.9.8', KLIG)
                HVOU.OLTTVI.RMUL('[yllg] ZXJFRIVW GVINRGVKRKV %H->%H'%(PVB, KLIG))

    WVU HGZIG(HVOU):
        HVOU.QLY.HGZIG()
        HVOU.OLTTVI.RMUL('[yllg] yIRWTV DLIPRMT GSIVZW LM KRW %W'%HVOU.QLY.GRW)

    WVU GVHG_HGZIUOVVG(HVOU):
        GVHG_NHT = HVOU.WLXPVI.MVD_NHT()
        GVHG_NHT.XLNNZMW = 'KRMT'
        GVHG_NHT.FHVI = 'IVWHSRUG'
        GVHG_NHT.RWVMGRGB = '%H:%H'%(HVOU.HVIEVI_RK, HVOU.KLIG)
        GIB:
            IVKOB = HVOU.WLXPVI.HVMW(GVHG_NHT, 8)
            RU IVKOB.NVHHZTV == 'KLMT':
                RU MLG HVOU.HGZGFH:
                    HVOU.OLTTVI.RMUL('[yIRWTV] yIRWTV WVGVXGVW HGZIUOVVG XLMMVXGRLM IVZWB')
                HVOU.HGZGFH = gIFV
            VOHV:
                RU HVOU.HGZGFH:
                    HVOU.OLTTVI.VIILI( '[yIRWTV] yIRWTV WVGVXGVW HGZIUOVVG HBHGVN WLDM' )
                HVOU.HGZGFH = uZOHV
                IZRHV eZOFVvIILI('[yIRWTV] yIRWTV WVGVXGVW HGZIUOVVG HBHGVN WLDM')
        VCXVKG vCXVKGRLM ZH V:
            RU HVOU.HGZGFH:
                HVOU.OLTTVI.VIILI('[yIRWTV] yIRWTV WVGVXGVW HGZIUOVVG XLMMVXGRLM WLDM')
            HVOU.HGZGFH = uZOHV

    WVU IFM(HVOU):
        GIB:
            HGZGFH = HVOU.HVIEVI.HGZIG()
            HVOU.OLTTVI.RMUL('[yIRWTV] HGZIGH GL ORHGVM LM %H:%H'%(HVOU.HVIEVI_RK, HVOU.KLIG))
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
            HBH.VCRG(-8)
        DSROV gIFV:
            # KIRMG(GVHG)
            HVOU.GVHG_HGZIUOVVG()
            GRNV.HOVVK(7)
//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/HGZGRHGRXH.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/' + evihrlm + '/KBGSLM-ORYH')
RNKLIG KRXPOV
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG WZGVGRNV

XOZHH hGZGRHGRXH(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.HRAV_NZK = {}
        HVOU.OZHG_GRNVHGZNK =  WZGVGRNV.WZGVGRNV.MLD()
        HVOU.RMGVIEZO = RMG(HVOU.CNO.ZGGIRY['RMGVIEZO'])


    WVU IVXLIW(HVOU, IVJ):
        RU IVJ.SLNV MLG RM HVOU.HRAV_NZK:
            HVOU.HRAV_NZK[IVJ.SLNV] = [9, 9, 9, 9] # 8: XFIIVMG YBGVH, 7 OZHG YBGVH, 6 XFIIMVG HKVVW, 5 OZHG HKVVW
        HRAV = IVJ.yBGVhRAV()
        HVOU.HRAV_NZK[IVJ.SLNV][9] += HRAV

    WVU TVG_WZGZ(HVOU):
        IVGFIM KRXPOV.WFNKH(HVOU.HRAV_NZK)

    WVU HFNNZIB(HVOU):
        # HVOU.OLTTVI.RMUL('---------%W---------'%(WZGVGRNV.WZGVGRNV.MLD()-HVOU.HGZIG).GLGZO_HVXLMWH())
        MLD = WZGVGRNV.WZGVGRNV.MLD()
        RU (MLD-HVOU.OZHG_GRNVHGZNK).GLGZO_HVXLMWH() < HVOU.RMGVIEZO:
            IVGFIM
        HVOU.OZHG_GRNVHGZNK = MLD
        ULI P RM HVOU.HRAV_NZK:
            HVOU.HRAV_NZK[P][6] = HVOU.HRAV_NZK[P][7]
            HVOU.HRAV_NZK[P][7] = (HVOU.HRAV_NZK[P][9]-HVOU.HRAV_NZK[P][8])*8.9/HVOU.RMGVIEZO
            #HVOU.OLTTVI.RMUL('->%H: %W yBGVH, HKVVW: %W yBGVH/H'%(P, HVOU.HRAV_NZK[P][9], HVOU.HRAV_NZK[P][7] ))
            HVOU.HRAV_NZK[P][8] = HVOU.HRAV_NZK[P][9]
//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/QLYLKNLMRGLI.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN IWSVOKVI.FGRO RNKLIG RNKLIG_QLY_LK
RNKLIG LH
RNKLIG KBRMLGRUB
RNKLIG GIZXVYZXP
RNKLIG GRNV
RNKLIG WZGVGRNV
_lmv_wzb_rm_hvxlmwh = 39 * 39 * 75
UILN FYRJGLLO.GRNVI RNKLIG gRNVI

XOZHH qLYlknLMRGLI(LYQVXG):
    WVU __RMRG__(HVOU, CNO, KZGS_ORHG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.KZGS_ORHG = KZGS_ORHG
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.QLY_KLLO = {} # XNW MZNV -> XNW
        HVOU.TOLYZO_RMUL.QLY_KLLO = HVOU.QLY_KLLO
        HVOU.QLY_KZGS_NZK = {} # XNW_KZGS -> XNW
        HVOU.QLY_RW_NZK = {}
        HVOU.QLYLK_ORHG = []
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.HOVVK_KVI_ILFMW = UOLZG(HVOU.CNO.ZGGIRY['HOVVK_KVI_ILFMW'])
        HVOU.OLTTVI.RMUL('[yllg] QLYLK HOVVKH %UH KVI ILFMW'%HVOU.HOVVK_KVI_ILFMW)
        RU 'IVHVG_GRNV' RM CNO.ZGGIRY:
            HVOU.WVUZFOG_IVHVG_GRNV = CNO.ZGGIRY['IVHVG_GRNV']
        VOHV:
            HVOU.WVUZFOG_IVHVG_GRNV = '99:98:99'

        ULI KZGS RM HVOU.KZGS_ORHG:
            ULI HFYWRIH, WRIH, UROVH RM LH.DZOP(LH.KZGS.QLRM(KZGS, 'LKVIZGRLM', 'QLYLK')):
                ULI U RM UROVH:
                    RU  U[-6:] == '.KB':
                        QLYLK_RW = U[:-6]
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_QLY_LK(U[:-6], LH.KZGS.QLRM(KZGS, 'LKVIZGRLM', 'QLYLK'))
                        XNWLK = XOZHHLK
                        XNWLK.__UROV__ = WVHG_KZGS
                        RU QLYLK_RW RM HVOU.QLY_KLLO:
                            HVOU.OLTTVI.DZIM('qLYlKlK %H RH ZOIVZWB OLZWVW, DROO RTMLIV (KIVE UROV:%H)'%(QLYLK_RW, HVOU.QLY_KLLO[QLYLK_RW].__UROV__) )
                        VOHV:
                            HVOU.QLY_KLLO[QLYLK_RW] = (XNWLK, uZOHV)
                            HVOU.QLY_KZGS_NZK[XNWLK.__UROV__] = XNWLK
        HVOU.OLTTVI.RMUL('[yllg] qLYlknLMRGLI ULFMW %H'%','.QLRM([P ULI P RM HVOU.QLY_KLLO]))

    WVU KZIHV_LKVIZGRLM(HVOU):
        ULI QLY_CNO RM HVOU.CNO.URMWZOO('QLYLK'):
            NLWFOV = QLY_CNO.ZGGIRY['NLWFOV']
            RU 'RW' RM QLY_CNO.ZGGIRY:
                RW = QLY_CNO.ZGGIRY['RW']
            VOHV:
                RW = NLWFOV
            MVDLK = HVOU.QLY_KLLO[NLWFOV][9](QLY_CNO, HVOU.TOLYZO_RMUL )
            MVDLK.__NLWFOV__ = NLWFOV
            MVDLK.__RW__ = RW
            HVOU.OLTTVI.RMUL('[yllg] qLYlknLMRGLI OLZWVW LK %H'%NLWFOV)
            RU 'IVHVG_GRNV' MLG RM QLY_CNO.ZGGIRY:
                HVOU.OLTTVI.RMUL('[yllg] %H FHVH WVUZFOG IVHVG GRNV %H'%(NLWFOV, HVOU.WVUZFOG_IVHVG_GRNV))
                MVDLK.IVHVG_GRNVI = gRNVI(HVOU.WVUZFOG_IVHVG_GRNV)
            VOHV:
                IVHVG_GRNV = QLY_CNO.ZGGIRY['IVHVG_GRNV']
                HVOU.OLTTVI.RMUL('[yllg] %H HKVXRURVH IVHVG GRNV %H'%(NLWFOV, IVHVG_GRNV))
                MVDLK.IVHVG_GRNVI = gRNVI(IVHVG_GRNV)
            HVOU.QLY_RW_NZK[RW] = MVDLK
            HVOU.QLYLK_ORHG.ZKKVMW(MVDLK)

    WVU DLIP(HVOU):
        ULI QLY RM HVOU.QLYLK_ORHG:
            MLD = WZGVGRNV.WZGVGRNV.MLD().GRNV()
            RU QLY.IVHVG_GRNVI.XSVXP(MLD):
                HVOU.OLTTVI.RMUL('qLYlK %H IVHVG'%QLY.__NLWFOV__)
                QLY.IVHVG()

        ULI QLY RM HVOU.QLYLK_ORHG:
            QLY.DLIP()
        GRNV.HOVVK(HVOU.HOVVK_KVI_ILFMW)

    WVU IFM(HVOU):
        XOZHH vEVMGsZMWOVI(KBRMLGRUB.kILXVHHvEVMG):
            WVU __RMRG__(HVOU, NLMRGLI):
                HVOU.NLMRGLI = NLMRGLI

            WVU KILXVHH_rm_xivzgv(HVOU, VEVMG):
                #KIRMG('XIVZGV:', VEVMG.KZGSMZNV)
                U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                #KIRMG(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6], HVOU.NLMRGLI.QLY_KLLO)
                RU U[-6:] == '.KB':
                    QLY_RW = U[:-6]
                    RU LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6] RM HVOU.NLMRGLI.QLY_KLLO:
                        IVGFIM
                    HVOU.NLMRGLI.OLTTVI.RMUL('MVD QLYLK %H OLZWVW'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_QLY_LK(U[:-6], LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.QLY_KLLO[QLY_RW] = (XNW, gIFV)
                    HVOU.NLMRGLI.QLY_KZGS_NZK[XNW.__UROV__] = XNW

            WVU KILXVHH_rm_xolhv_dirgv(HVOU, VEVMG):
                #KIRMG('XOLHV_DIRGV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.QLY_KZGS_NZK:
                    U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                    QLY_RW = U[:-6]
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW QLY %H'%U[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_QLY_LK(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                          LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.QLY_KLLO[QLY_RW] = (XNW, gIFV)
                    HVOU.NLMRGLI.QLY_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

            WVU KILXVHH_rm_nlevw_gl(HVOU, VEVMG):
                #KIRMG('NLEV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.QLY_KZGS_NZK:
                    U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                    QLYLK_RW = U[:-6]
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW QLY %H'%U[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_QLY_LK(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                            LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.QLY_KLLO[QLYLK_RW] = (XNW, gIFV)
                    HVOU.NLMRGLI.QLY_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

        DN = KBRMLGRUB.dZGXSnZMZTVI()
        NZHP =  KBRMLGRUB.rm_xivzgv | KBRMLGRUB.rm_xolhv_dirgv | KBRMLGRUB.rm_nlevw_gl
        ULI KZGS RM HVOU.KZGS_ORHG:
            MVD_KZGS = LH.KZGS.QLRM(KZGS, 'LKVIZGRLM', 'QLYLK')
            DN.ZWW_DZGXS(MVD_KZGS, NZHP, IVX=gIFV)
            HVOU.OLTTVI.RMUL('[yllg] qLYlknLMRGLI NLMRGLIH KZGS %H'%MVD_KZGS)
        VS = vEVMGsZMWOVI(HVOU)
        MLGRURVI = KBRMLGRUB.mLGRURVI(DN, VS)
        MLGRURVI.OLLK()

       # HVOU.OLTTVI.RMUL('[yIRWTV] OLZWVW QLYH: %H'%','.QLRM([R ULI R RM HVOU.QLY_KLLO]))
//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/DZIK.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/' + evihrlm + '/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
RNKLIG WZGVGRNV
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG RNKOVNVMG.tikx.VMTRMV ZH TIKX_VMTRMV


XOZHH xLMGZXGjFVFV(LYQVXG):
    WVU __RMRG__(HVOU, DRMWLD):
        HVOU.HFXXVHH_JFVFV = []
        HVOU.UZRO_JFVFV = []
        HVOU.DRMWLD = WZGVGRNV.GRNVWVOGZ(NRMFGVH=8)
        HVOU.OZHG_XLMGZXG = mLMV

    WVU HFXXVHH(HVOU):
        MLD = WZGVGRNV.WZGVGRNV.MLD()
        RU OVM(HVOU.HFXXVHH_JFVFV) > 9 ZMW \
                (MLD-HVOU.HFXXVHH_JFVFV[9]) > HVOU.DRMWLD:
            HVOU.HFXXVHH_JFVFV.KLK(9)
        HVOU.HFXXVHH_JFVFV.ZKKVMW(WZGVGRNV.WZGVGRNV.MLD())
        HVOU.OZHG_XLMGZXG = MLD

    WVU UZRO(HVOU):
        MLD = WZGVGRNV.WZGVGRNV.MLD()
        RU OVM(HVOU.UZRO_JFVFV) > 9 ZMW \
                (MLD-HVOU.UZRO_JFVFV[9]) > HVOU.DRMWLD:
            HVOU.UZRO_JFVFV.KLK(9)
        HVOU.UZRO_JFVFV.ZKKVMW(WZGVGRNV.WZGVGRNV.MLD())

    WVU HXLIV(HVOU):
        RU OVM(HVOU.HFXXVHH_JFVFV) + OVM(HVOU.UZRO_JFVFV) == 9:
            IVGFIM 899
        IVGFIM RMG(UOLZG(OVM(HVOU.HFXXVHH_JFVFV)/
                   (OVM(HVOU.HFXXVHH_JFVFV) + OVM(HVOU.UZRO_JFVFV))) * 899)

    WVU ZXXVKG(HVOU, HGZGFH):
        RU HGZGFH:
            HVOU.HFXXVHH()
        VOHV:
            HVOU.UZRO()

XOZHH dZIKwIREV(LYQVXG):
    '''GSRH RH ZM RMGVIUZXV XOZHH'''
    WVU __RMRG__(HVOU, VMTRMV, RMGVIUZXV, HVIEVI, TOLYZORMUL, wt):
        """XGLI."""
        HVOU.RK = RMGVIUZXV.RK
        HVOU.KLIG = RMGVIUZXV.KLIG
        HVOU.TOLYZORMUL = TOLYZORMUL
        RU VMTRMV == 'tikx':
            RU TOLYZORMUL.IVWHSRUG_WZGZ.RH_GVHG ZMW HVOU.KLIG RH MLG mLMV:
                HVOU.KLIG = HGI(RMG(HVOU.KLIG) + 8)
            HVOU.VMTRMV = TIKX_VMTRMV.iVWHSRUG_tikx(HVOU, HVOU.RK, HVOU.KLIG, TOLYZORMUL)
        VOHV:
            IZRHV eZOFVvIILI('dZIKwIREV XZMMLG IVXLTMRAV VMTRMV ZH %H'%VMTRMV)
        HVOU.VMTRMV_GBKV = VMTRMV
        HVOU.RW = RMGVIUZXV.MZNV # GSRH RH HVIEVIMZNV+RMGVIUZXV MZNV
        HVOU.HVIEVI_MZNV = RMGVIUZXV.HVIEVI.RW
        HVOU.MVRTSYLFI_ORHG = []
        HVOU.RMGVIUZXV = RMGVIUZXV
        HVOU.HVIEVI = HVIEVI
        HVOU.wt = wt
        HVOU.OLTTVI = TOLYZORMUL.OLTTVI
        HVOU.HGZGFH = mLMV
        HVOU.HDRGXS = gIFV # LMORMV
        HVOU.XLMGZXG_JFVFV = xLMGZXGjFVFV(4)
        HVOU.ZXGREV = RMGVIUZXV.ZXGREV
        RU MLG HVOU.ZXGREV:
            HVOU.OLTTVI.VIILI('%H RH GVNKLIZIROB WRHZYOVW'%HVOU.HVIEVI_MZNV)

    WVU KZIHV_XLMMVXG(HVOU):
        ULI MLWV RM HVOU.wt.MVRTSYLIH(HVOU.RMGVIUZXV):
            RU MLWV == HVOU.HVIEVI:
                XLMGRMFV
            VORU MLWV.MZNV.HKORG('.')[9] == HVOU.HVIEVI.MZNV:
                HVOU.OLTTVI.VIILI('GLKLOLTB VMXLFMGVIH HVOU-OLLK %H -> %H'%(HVOU.HVIEVI.MZNV, MLWV.MZNV))
                #IZRHV eZOFVvIILI('GLKLOLTB VMXLFMGVIH HVOU-OLLK %H -> %H'%(HVOU.HVIEVI.MZNV, MLWV.MZNV))
                HVOU.TOLYZORMUL.WL_HBHGVN_VCRG(-8)
            VOHV:
                HVOU.OLTTVI.RMUL('[yllg] %H OLXZGVW MVRTSYLFI %H'%(HVOU.RW, MLWV.MZNV))
                DZIK = dZIKwIREV(HVOU.VMTRMV_GBKV, MLWV, mLMV, HVOU.TOLYZORMUL, HVOU.wt)
                HVOU.MVRTSYLFI_ORHG.ZKKVMW(DZIK)
                HVOU.VMTRMV.MVRTSYLFI_ORHG = HVOU.MVRTSYLFI_ORHG
                RU MLG MLWV.ZXGREV:
                    HVOU.OLTTVI.WVYFT('%H RH MLG ZXGREV, DROO MLG HSZPV SZMWH'%(MLWV.MZNV))
                VOHV:
                    DZIK.HSZPV_SZMWH()
                    DZIK.XLMGZXG_JFVFV.ZXXVKG(DZIK.VMTRMV.DZIK.HGZGFH)
                    #KIRMG(DZIK.VMTRMV.DZIK.HGZGFH)
        #KIRMG([(R.MZNV, R.RW) ULI R RM HVOU.wt.MLWVH()])

    WVU HVIEV(HVOU, CNO):
        HVOU.VMTRMV.HVIEV(CNO)

    WVU HSZPV_SZMWH(HVOU):
        """HSZPV SZMWH, GIBRMT GL YFROW Z XLMMVXGRLM."""
        IVGFIM HVOU.VMTRMV.HSZPV_SZMWH()

    WVU HVMW(HVOU, WZGZ, IVWHSRUG_ZTVMG):
        """HVMW WZGZ ULI ZMLGSVI IVWHSRUG_ZTVMG VMWKLRMG."""
        IVGFIM HVOU.VMTRMV.HVMW(WZGZ, IVWHSRUG_ZTVMG)

    WVU YILZWXZHG(HVOU, WZGZ, IVWHSRUG_ZTVMG_ORHG):
        """YILZWXZHG WZGZ GL Z ORHG LU IVWHSRUG_ZTVMG MLWVH."""
        IVG = []
        ULI IVWHSRUG_ZTVMG RM IVWHSRUG_ZTVMG_ORHG:
            IVG.ZKKVMW(HVOU.VMTRMV.HVMW(WZGZ, IVWHSRUG_ZTVMG))
        IVGFIM IVG

    WVU ZXJFRIV(HVOU, WZGZ, IVWHSRUG_ZTVMG):
        """ZXJFRIV WZGZ UILN Z IVWHSRUG_ZTVMG VMWKLRMG."""
        IVGFIM HVOU.VMTRMV.ZXJFRIV(WZGZ, IVWHSRUG_ZTVMG)
//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/NLWFOVNZMZTVI.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GRNV
RNKLIG LH
RNKLIG KHFGRO
UILN SVOKVI.FGRO RNKLIG RNKLIG_NLWFOV
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
_lmv_wzb_rm_hvxlmwh = 39 * 39 * 75


XOZHH nLWFOVnZMZTVI(LYQVXG):
    """VNYVWVW XLNKLMVMG LU IVWHSRUG IVHKLMHRYOV ULI NZMZTRMT NLWFOVH
    """
    WVU __RMRG__(HVOU, TOLYZO_RMUL, MLWV, ILLG_MLWV):
        """XGLI."""
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.CNO = MLWV
        HVOU.ILLG = ILLG_MLWV
        HVOU.NLWFOV_ORHG = []
        HVOU.NLWFOV_MZNV_NZK = {}
        RU HVOU.CNO RH mLMV:
            HVOU.OLTTVI.RMUL('[yllg] nLWFOVnZMZTVI MLG RMRGRZGVW')
        VOHV:
            HVOU.OLTTVI.RMUL('[yllg] nLWFOVnZMZTVI RMRGRZGVW')
            HVOU.OLZW()
        HVOU.QLY = mLMV

    WVU OLZW(HVOU):
        ULI CNO RM HVOU.CNO.URMWZOO('NLWFOV'):
            NLWFOV_RW = CNO.ZGGIRY['RW']
            HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] OLZW %H' % NLWFOV_RW)
            RU _XFIIVMG_ILLG RM HVOU.TOLYZO_RMUL.XORVMG_KZGS:
                IZD_HVZIXS_KZGS = HVOU.TOLYZO_RMUL.XORVMG_KZGS
            VOHV:
                IZD_HVZIXS_KZGS = HVOU.TOLYZO_RMUL.XORVMG_KZGS + [_XFIIVMG_ILLG]
            HVZIXS_KZGS = [LH.KZGS.QLRM(R, 'NLWFOVH', NLWFOV_RW) ULI R RM IZD_HVZIXS_KZGS]
            (XOZHHLK, WVHG_KZGS) = RNKLIG_NLWFOV(NLWFOV_RW, HVZIXS_KZGS )
            NLW = XOZHHLK(CNO, HVOU.ILLG, HVOU.TOLYZO_RMUL)
            NLW.__UROV__ = WVHG_KZGS
            NLW.__NLWFOV_RW__ = NLWFOV_RW
            HVOU.NLWFOV_ORHG.ZKKVMW([NLW, mLMV, -8, 'fmpmldm']) # MZNV, K, KRW, HGZGFH

    WVU HGZIG(HVOU):
        HVOU.QLY = qLY(HVOU)
        HVOU.QLY.HGZIG()

    WVU XLNKROV_NLWFOV_HGZGFH(HVOU):
        IVG = []
        ULI NLW_KZXPVG RM HVOU.NLWFOV_ORHG:
            IVG.ZKKVMW('%H|%W|%H'%(NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG[7], NLW_KZXPVG[6]))
        IVGFIM IVG


    WVU HGLK(HVOU):
        ULI NLW RM HVOU.NLWFOV_ORHG:
            NLW[9].HGLK()

    WVU IFM(HVOU):
        HVOU.IFMMRMT_HGZGFH = [KHFGRO.hgzgfh_ifmmrmt, KHFGRO.hgzgfh_hovvkrmt, KHFGRO.hgzgfh_wrhp_hovvk, KHFGRO.hgzgfh_dzprmt]
        HVOU.OLTTVI.RMUL("[nLWFOVnZMZTVI] nLWFOVnZMZTVI HGZIGH GL IFM HVKZIZGV NLWFOVH")
        ULI NLW_KZXPVG RM HVOU.NLWFOV_ORHG:
            NLW_KZXPVG[8] = qLY(NLW_KZXPVG[9], [], HVOU.OLTTVI)
            NLW_KZXPVG[8].HGZIG()
            HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] GIBRMT GL ZXGREZGV NLWFOV %H' % (NLW_KZXPVG[9].__NLWFOV_RW__)  )
            DSROV NLW_KZXPVG[8].K RH mLMV:
                GRNV.HOVVK(9.8)
            HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] ZXGREZGVW NLWFOV RW %H DRGS GSIVZW RW %W' % (NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG[8].GRW))
            NLW_KZXPVG[7] = NLW_KZXPVG[8].GRW
        HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] HGZIGH GL NLMRGLI NLWFOV HGZGFH LM GSIVZW %W' % FYRJFGRO.TVG_GRW())
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            ULI NLW_KZXPVG RM HVOU.NLWFOV_ORHG:
                GIB:
                    HGZGFH = NLW_KZXPVG[8].K.HGZGFH()
                    NLW_KZXPVG[6] = HGZGFH
                VCXVKG vCXVKGRLM ZH V:
                    HGZGFH = 'LUUORMV'
                    NLW_KZXPVG[6] = HGZGFH
                # KIRMG(NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG)
                HVOU.NLWFOV_MZNV_NZK[NLW_KZXPVG[9].__NLWFOV_RW__] = NLW_KZXPVG[9]
                RU HGZGFH MLG RM HVOU.IFMMRMT_HGZGFH:
                    HVOU.OLTTVI.VIILI('[nLWFOVnZMZTVI] %H RH RM HGZGFH %H'%(NLW_KZXPVG[9].__NLWFOV_RW__, HGZGFH))
                    HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] IVHGZIG %H' % (NLW_KZXPVG[9].__NLWFOV_RW__))
                    NLW_KZXPVG[8] = qLY(NLW_KZXPVG[9], [], HVOU.OLTTVI)
                    NLW_KZXPVG[8].HGZIG()
                    DSROV NLW_KZXPVG[8].K RH mLMV:
                        GRNV.HOVVK(9.8)
                    HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] ZXGREZGVW NLWFOV RW %H DRGS GSIVZW RW %W' % (NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG[8].GRW))
                    NLW_KZXPVG[7] = NLW_KZXPVG[8].GRW

            #glwl XSVXP VZXS NLWFOV'H HGZGFH
            GRNV.HOVVK(8)
//##**---------------- ./IVWHSRUG/IWXLNKLMVMG/NVHHZTVNLMRGLI.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN IWSVOKVI.FGRO RNKLIG RNKLIG_NVHHZTV_LK
RNKLIG LH
RNKLIG KBRMLGRUB
RNKLIG GIZXVYZXP
UILN FYRJGLLO.GRNVI RNKLIG gRNVI
RNKLIG WZGVGRNV
_lmv_wzb_rm_hvxlmwh = 39 * 39 * 75

XOZHH nVHHZTVnLMRGLI(LYQVXG):
    WVU __RMRG__(HVOU, CNO, KZGS_ORHG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.KZGS_ORHG = KZGS_ORHG
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.NVHHZTV_KLLO = {} # XNW MZNV -> XNW
        HVOU.NVHHZTVLK_ORHG = []
        HVOU.TOLYZO_RMUL.NVHHZTV_KLLO = HVOU.NVHHZTV_KLLO
        HVOU.NVHHZTV_KZGS_NZK = {} # XNW_KZGS -> XNW
        #HVOU.NVHHZTVLK_ORHG = []
        HVOU.NVHHZTVLK_NZK = {}
        ULI KZGS RM HVOU.KZGS_ORHG:
            ULI HFYWRIH, WRIH, UROVH RM LH.DZOP(LH.KZGS.QLRM(KZGS, 'LKVIZGRLM', 'NVHHZTVLK')):
                ULI U RM UROVH:
                    RU  U[-6:] == '.KB':
                        NVHHZTVLK_RW = U[:-6]
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_NVHHZTV_LK(U[:-6], LH.KZGS.QLRM(KZGS, 'LKVIZGRLM', 'NVHHZTVLK'))
                        XNWLK = XOZHHLK
                        XNWLK.__UROV__ = WVHG_KZGS
                        RU NVHHZTVLK_RW RM HVOU.NVHHZTV_KLLO:
                            HVOU.OLTTVI.DZIM('nVHHZTVlK %H RH ZOIVZWB OLZWVW, DROO RTMLIV (KIVE UROV:%H)'%(NVHHZTVLK_RW, HVOU.NVHHZTV_KLLO[NVHHZTVLK_RW].__UROV__) )
                        VOHV:
                            HVOU.NVHHZTV_KLLO[NVHHZTVLK_RW] = (XNWLK, uZOHV)
                            HVOU.NVHHZTV_KZGS_NZK[XNWLK.__UROV__] = XNWLK
        HVOU.OLTTVI.RMUL('[yllg] nVHHZTVlknLMRGLI ULFMW %H'%','.QLRM([P ULI P RM HVOU.NVHHZTV_KLLO]))
        RU 'IVHVG_GRNV' RM CNO.ZGGIRY:
            HVOU.WVUZFOG_IVHVG_GRNV = CNO.ZGGIRY['IVHVG_GRNV']
        VOHV:
            HVOU.WVUZFOG_IVHVG_GRNV = '99:98:99'


    WVU KZIHV_LKVIZGRLM(HVOU):
        ULI QLY_CNO RM HVOU.CNO.URMWZOO('NVHHZTVLK'):
            NLWFOV = QLY_CNO.ZGGIRY['NLWFOV']
            RU 'RW' RM QLY_CNO.ZGGIRY:
                RW = QLY_CNO.ZGGRIY['RW']
            VOHV:
                RW = NLWFOV
            MVDLK = HVOU.NVHHZTV_KLLO[NLWFOV][9](QLY_CNO, HVOU.TOLYZO_RMUL)
            MVDLK.__RW__ = RW
            MVDLK.__NLWFOV__ = NLWFOV
            HVOU.OLTTVI.RMUL('[yllg] nVHHZTVlknLMRGLI OLZWVW LK %H'%NLWFOV)
            RU 'IVHVG_GRNV' MLG RM QLY_CNO.ZGGIRY:
                HVOU.OLTTVI.RMUL('[yllg] %H FHVH WVUZFOG IVHVG GRNV %H'%(NLWFOV, HVOU.WVUZFOG_IVHVG_GRNV))
                MVDLK.IVHVG_GRNVI = gRNVI(HVOU.WVUZFOG_IVHVG_GRNV)
            VOHV:
                HVOU.OLTTVI.RMUL('[yllg] %H HKVXRURVH IVHVG GRNV %H'%(NLWFOV, HVOU.WVUZFOG_IVHVG_GRNV))
                MVDLK.IVHVG_GRNVI = gRNVI(HVOU.WVUZFOG_IVHVG_GRNV)
            #HVOU.NVHHZTVLK_ORHG.ZKKVMW( HVOU.NVHHZTV_KLLO[NLWFOV][9](QLY_CNO, HVOU.TOLYZO_RMUL ) )
            HVOU.NVHHZTVLK_NZK[NLWFOV] = MVDLK
            HVOU.NVHHZTVLK_ORHG.ZKKVMW(MVDLK)

    WVU DLIP(HVOU):
        MLD = WZGVGRNV.WZGVGRNV.MLD().GRNV()
        ULI QLY RM HVOU.NVHHZTVLK_ORHG:
            RU QLY.IVHVG_GRNVI.XSVXP(MLD):
                HVOU.OLTTVI.RMUL('nVHHZTVlK %H IVHVG'%QLY.__NLWFOV__)
                QLY.IVHVG()


    WVU IFM(HVOU):
        XOZHH vEVMGsZMWOVI(KBRMLGRUB.kILXVHHvEVMG):
            WVU __RMRG__(HVOU, NLMRGLI):
                HVOU.NLMRGLI = NLMRGLI

            WVU KILXVHH_rm_xivzgv(HVOU, VEVMG):
                #KIRMG('XIVZGV:', VEVMG.KZGSMZNV)
                U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                #KIRMG(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6], HVOU.NLMRGLI.NVHHZTV_KLLO)
                RU U[-6:] == '.KB':
                    NVHHZTV_RW = U[:-6]
                    RU LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6] RM HVOU.NLMRGLI.NVHHZTV_KLLO:
                        IVGFIM
                    HVOU.NLMRGLI.OLTTVI.RMUL('MVD NVHHZTVLK %H OLZWVW'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_NVHHZTV_LK(U[:-6], LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.NVHHZTV_KLLO[NVHHZTV_RW] = (XNW, gIFV)
                    HVOU.NLMRGLI.NVHHZTV_KZGS_NZK[XNW.__UROV__] = XNW

            WVU KILXVHH_rm_xolhv_dirgv(HVOU, VEVMG):
                KIRMG('XOLHV_DIRGV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.NVHHZTV_KZGS_NZK:
                    U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                    NVHHZTV_RW = U[:-6]
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW NVHHZTV %H'%U[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_NVHHZTV_LK(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                          LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.NVHHZTV_KLLO[NVHHZTV_RW] = (XNW, gIFV)
                    HVOU.NLMRGLI.NVHHZTV_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

            WVU KILXVHH_rm_nlevw_gl(HVOU, VEVMG):
                #KIRMG('NLEV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.NVHHZTV_KZGS_NZK:
                    U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                    NVHHZTVLK_RW = U[:-6]
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW NVHHZTV %H'%U[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_NVHHZTV_LK(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                            LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.NVHHZTV_KLLO[NVHHZTVLK_RW] = (XNW, gIFV)
                    HVOU.NLMRGLI.NVHHZTV_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

        DN = KBRMLGRUB.dZGXSnZMZTVI()
        NZHP =  KBRMLGRUB.rm_xivzgv | KBRMLGRUB.rm_xolhv_dirgv | KBRMLGRUB.rm_nlevw_gl
        ULI KZGS RM HVOU.KZGS_ORHG:
            MVD_KZGS = LH.KZGS.QLRM(KZGS, 'LKVIZGRLM', 'NVHHZTVLK')
            DN.ZWW_DZGXS(MVD_KZGS, NZHP, IVX=gIFV)
            HVOU.OLTTVI.RMUL('[yllg] nVHHZTVlknLMRGLI NLMRGLIH KZGS %H'%MVD_KZGS)
        VS = vEVMGsZMWOVI(HVOU)
        MLGRURVI = KBRMLGRUB.mLGRURVI(DN, VS)
        MLGRURVI.OLLK()

       # HVOU.OLTTVI.RMUL('[yIRWTV] OLZWVW NVHHZTVH: %H'%','.QLRM([R ULI R RM HVOU.NVHHZTV_KLLO]))
//##**---------------- ./IVWHSRUG/NZRM.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG TVGLKG
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG HRTMZO
RNKLIG LH
RNKLIG GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
UILN YZHV RNKLIG  TOLYZORMUL
UILN FYRJGLLO.UROV RNKLIG RH_UROV_VCRHG
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG KHFGRO
UILN XLNKLMVMG.HXSVNZ RNKLIG KZIHV_GLKLOLTB
RNKLIG XLNKLMVMG.IVWHSRUG ZH IVWHSRUG
UILN XLNKLMVMG.YIRWTV RNKLIG yIRWTV
UILN XLNKLMVMG.NLWFOVNZMZTVI RNKLIG nLWFOVnZMZTVI
UILN XLNKLMVMG.HGZGRHGRXH RNKLIG hGZGRHGRXH
LH.VMERILM['gvin'] = 'CGVIN-XLOLI'
UILN FYRJGLLO.FGRO RNKLIG TVG_GRW
UILN HGZIUOVVG.GLLO.HSNHGZGFH RNKLIG hSNhGZGFH
RNKLIG KBKFYHFY ZH KY

RU __MZNV__ == '__NZRM__':
    CNOUROV=''
    TFR = uZOHV
    HRN = uZOHV
    KY.lKVMkFYHFY()
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'X:K', ['XLMURT=','KIRMG'])
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-X', '--XLMURT'): CNOUROV = ZIT


    RU MLG CNOUROV:
        HBH.VCRG('NFHG UVVW CNO UROV DRGS -X LI --XLMURT')
    TOLYZORMUL = TOLYZORMUL.tOLYZORMUL()
    TOLYZORMUL.XLNNZMW_ORMV = HBH.ZITE[:]
    RU LKG RM ('-K', '--KIRMG'):
        TOLYZORMUL.ULIXV_KIRMG_OLT = gIFV

    GIVV = VGIVV.KZIHV(CNOUROV)
    #  SZMWOV LMV RMHGZMXV RHHFV
    GZT = GIVV.TVGILLG().GZT
    RU 'GVHG' RM GZT:
        TOLYZORMUL.RH_GVHG = gIFV
        KIRMG('GVHG RMHGZMXV')
    RU RH_UROV_VCRHG('/IFM/'+GZT+'.KRW'):
        DRGS LKVM('/IFM/'+GZT+'.KRW', 'I') ZH U:
            KRW_HGI  = U.IVZW().HGIRK()
            RU OVM(KRW_HGI)==9 LI KHFGRO.KRW_VCRHGH(RMG(KRW_HGI)):
                IZRHV eZOFVvIILI('%H DRGS KRW=%H ZOIVZWB VCHRGH, ZYLIGVW'%(GZT, KRW_HGI))
        DRGS LKVM('/IFM/'+GZT+'.KRW', 'D') ZH U:
            U.DIRGV(HGI(LH.TVGKRW()))
    VOHV:
        DRGS LKVM('/IFM/'+GZT+'.KRW', 'D') ZH U:
            U.DIRGV(HGI(LH.TVGKRW()))

    FYRJ_HBHGVN = FYRJFGRO.fYRJhBHGVN()
    FYRJ_HBHGVN.CNO = LH.KZGS.ZYHKZGS(CNOUROV)
    FYRJ_HBHGVN.KILTIZN = GZT
    TOLYZORMUL.IVWHSRUG_GZT = GZT
    RU 'XORVMG' RM GIVV.TVGILLG().ZGGIRY:
        TOLYZORMUL.XORVMG_KZGS = [GIVV.TVGILLG().ZGGIRY['XORVMG']]
    VOHV:
        TOLYZORMUL.XORVMG_KZGS = ['./']

    TOLYZORMUL.rMRG()
    TOLYZORMUL.RMRG_OLT(GIVV.URMW('OLT'), GZT)
    TOLYZORMUL.HSN_HGZGFH = hSNhGZGFH(TOLYZORMUL.IVWHSRUG_GZT)
    RU MLG TOLYZORMUL.HSN_HGZGFH.LKVM():
        TOLYZORMUL.OLTTVI.RMUL('%H HVVNH GL YV RM SVI NZRWVM ELBZTV'%TOLYZORMUL.IVWHSRUG_GZT)
        TOLYZORMUL.HSN_HGZGFH.XIVZGV()
        TOLYZORMUL.HSN_HGZGFH.XSVXP_HRAV()
    TOLYZORMUL.HSN_HGZGFH.HVG_HGZGFH(8) # YLLGRMT



    FYRJ_HBHGVN.OLT_UROV = TOLYZORMUL.OLTTVI.UROVMZNV
    FYRJ_HBHGVN.DIRGV_RMUL(LH.KZGS.QLRM('/IFM', GZT+'.IFM'))
    TOLYZORMUL.FYRJ_HBHGVN = FYRJ_HBHGVN
    TOLYZORMUL.HBHGVN_VCRG = uZOHV
    WVU HRTMZO_SZMWOVI(HRTMZO, UIZNV):
        KIRMG('HBHGVN IVXVREVH ZYLIG XLNNZMW')
        TOLYZORMUL.HBHGVN_VCRG = gIFV
        HBH.VCRG(9)
    HRTMZO.HRTMZO(HRTMZO.hrtrmg, HRTMZO_SZMWOVI)

    # TOLYZORMUL.MVVW_XLNKIVHHRLM = uZOHV
    # RU 'XLNKIVHHRLM' RM GIVV.TVGILLG().ZGGIRY:
        # TOLYZORMUL.MVVW_XLNKIVHHRLM = (GIVV.TVGILLG().ZGGIRY['XLNKIVHHRLM'].OLDVI()=="GIFV")
    # RU TOLYZORMUL.MVVW_XLNKIVHHRLM:
        # TOLYZORMUL.OLTTVI.RMUL('[yllg] IVWHSRUG DROO ZXGREZGV XLNKIVHHRLM')
    # VOHV:
        # TOLYZORMUL.OLTTVI.RMUL('[yllg] IVWHSRUG WVZXGREZGV XLNKIVHHRLM')
    # HGZGRHGRXH_CNO =  GIVV.TVGILLG().URMW('HGZGRHGRXH')
    # RU HGZGRHGRXH_CNO RH mLMV:
       # TOLYZORMUL.OLTTVI.RMUL('[yllg] OLZWVW HGZGRHGRXH')
       # TOLYZORMUL.HGZGRHGRXH = mLMV
    # VOHV:
       # TOLYZORMUL.HGZGRHGRXH = hGZGRHGRXH(HGZGRHGRXH_CNO, TOLYZORMUL)
    XKF_CNO =  GIVV.TVGILLG().URMW('XKF')
    RU XKF_CNO RH MLG mLMV:
        XKF_NLWV = XKF_CNO.ZGGIRY['NLWV']
        RU XKF_NLWV == 'NZMFZO':
            TOLYZORMUL.XKF_XLIVH = [RMG(R.HGIRK()) ULI R RM XKF_CNO.ZGGIRY['XLIV'].HKORG(',')]
        VORU XKF_NLWV == 'ZFGL':
            HBHGVN_CNO = VGIVV.KZIHV('/RMX/HBHGVN.CNO').TVGILLG()
            KILTIZN_XLIV_FHZTV = {}
            ULI KILTIZN_CNO RM HBHGVN_CNO.URMW('XLIV_FHZTV').URMWZOO('FHZTV'):
                KILTIZN_XLIV_FHZTV[ KILTIZN_CNO.ZGGIRY['KILTIZN'] ] = [RMG(R.HGIRK()) ULI R RM (KILTIZN_CNO.ZGGIRY['NZRM'] +','+ KILTIZN_CNO.ZGGIRY['KFYORX']).HKORG(',')]
            RU TOLYZORMUL.IVWHSRUG_GZT MLG RM KILTIZN_XLIV_FHZTV:
                IZRHV eZOFVvIILI('%H WLVH MLG HKVXRUB XLIV FHZTV'%TOLYZORMUL.IVWHSRUG_GZT)
            TOLYZORMUL.XKF_XLIVH = KILTIZN_XLIV_FHZTV[TOLYZORMUL.IVWHSRUG_GZT]
        VOHV:
            IZRHV eZOFVvIILI('XKF NLWV NFHG YV VRGSVI ZFGL LI NZMFZO')
        KHFGRO.kILXVHH(TVG_GRW()).XKF_ZUURMRGB(TOLYZORMUL.XKF_XLIVH)
        TOLYZORMUL.OLTTVI.RMUL('[yllg] %H HVG XKF ZUURMRGB ZH %H'%(TOLYZORMUL.IVWHSRUG_GZT, ','.QLRM([HGI(R) ULI R RM TOLYZORMUL.XKF_XLIVH])));
    VOHV:
        TOLYZORMUL.OLTTVI.DZIM('[yllg] %H WRW MLG HVG XKF ZUURMRGB'%( TOLYZORMUL.IVWHSRUG_GZT ))

    # KZIHV GLKLOLTB CNO GL ZXJFRIV GLGZO GLKLOLTB HXSVNZ

    TOLYZORMUL.OLTTVI.RMUL('[yllg] IVWHSRUG DLIPH LM KRW %W' % LH.TVGKRW())
    TOLYZORMUL.OLTTVI.RMUL('[yllg] IVWHSRUG DLIPH LM MLWV %H' % FYRJ_HBHGVN.SLHG)
     # KZIHV GLKLOLTB CNO GL ZXJFRIV GLGZO GLKLOLTB HXSVNZ
    #GLKLOLTB_CNO = VGIVV.KZIHV('/RMX/IVWHSRUG_GLKLOLTB.CNO')

    # GLKLOLTB_CNO = VGIVV.KZIHV('/RMX/IVWHSRUG_GLKLOLTB.CNO')
    # IVWHSRUG_GLKLOLTB = KZIHV_GLKLOLTB(GLKLOLTB_CNO, TOLYZORMUL)
    # IVWHSRUG = IVWHSRUG.iVWHSRUG(GIVV.TVGILLG(), 'tikx', IVWHSRUG_GLKLOLTB, TOLYZORMUL)

    # TOLYZORMUL.IVWHSRUG = IVWHSRUG

    # IVWHSRUG.NLMRGLI_LKVIZGRLMH()
    # IVWHSRUG.KZIHV()

    # IVWHSRUG_QLY = qLY(IVWHSRUG)
    # IVWHSRUG_QLY.HGZIG()
    # TOLYZORMUL.OLTTVI.RMUL('[yllg] QLYLK HGZIGH GL DLIP LM KRW %W'%IVWHSRUG_QLY.GRW)

    TOLYZORMUL.NLWFOV_NZMZTVI = nLWFOVnZMZTVI(TOLYZORMUL, GIVV.URMW('NLWFOVH'), GIVV)
    TOLYZORMUL.NLWFOV_NZMZTVI.HGZIG()
    TOLYZORMUL.QLYH['nLWFOVnZMZTVI'] = TOLYZORMUL.NLWFOV_NZMZTVI.QLY

    YIRWTV = yIRWTV(mLMV, TOLYZORMUL)
    YIRWTV_QLY = qLY(YIRWTV)
    YIRWTV_QLY.HGZIG()
    TOLYZORMUL.OLTTVI.RMUL('[yllg] yIRWTV QLY HGZIGH GL DLIP LM KRW %W'%YIRWTV_QLY.GRW)
    TOLYZORMUL.HSN_HGZGFH.HVG_HGZGFH(7) # YLLGRMT

    DSROV MLG TOLYZORMUL.HBHGVN_VCRG:
        GRNV.HOVVK(8)
//##**---------------- ./IVWHSRUG/GVHG/NZRM_GVHG.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7982-95-88
* \NLWRURVW  7982-95-88
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/


#RMXOFWV <TGVHG/TGVHG.S>

RMG NZRM(RMG ZITX, XSZI **ZITE) {
    ::GVHGRMT::rMRGtLLTOVgVHG(&ZITX, ZITE);
    IVGFIM ifm_zoo_gvhgh();
}
//##**---------------- ./IVWHSRUG/GVHG/GVHG_UROV.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7982-95-88
* \NLWRURVW  7982-95-88
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/



#RMXOFWV <TGVHG/TGVHG.S>

FHRMT MZNVHKZXV HGW;

gvhg(GZITVG, vCZNKOV) {
  zhhvig_vj(9, 9);
}
//##**---------------- ./IVWHSRUG/GVHG/DLINSLOV_DIRGV_GVHG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

RNKLIG HBH
HBH.KZGS.ZKKVMW('./ORY')
RNKLIG KBDLINSLOV

N = KBDLINSLOV.nZGIRCwZGZdIZKKVI()
N.TILFK('XFVILGVHG')
N.NZGIRC('GVHG_GZYOV')
KIRMG('wLMV XIVZGRLM')
N.ILD(89)
N.XLOFNM("GR", KBDLINSLOV.wZGZgBKV.rmg)
N.XLOFNM("GO", KBDLINSLOV.wZGZgBKV.olmt)
N.XLOFNM("GX", KBDLINSLOV.wZGZgBKV.xszi, 67)
N.XLOFNM("XLHG", KBDLINSLOV.wZGZgBKV.wlfyov)
KIRMG('xLOFNM LEVI')
N.xLNKROV()
KIRMG('XLNKROV LEVI')
N.lKVMhSN()
KIRMG('LKVMHSN LEVI')
N.dIRGVsVZW()
KIRMG('DIRGVSVZW LEVI')
N.mLINZORAV()
N.hVGiVWHSRUG()
KIRMG('MLINZORAV LEVI')
N.hVGiVWHSRUG()
N.fKWZGV()
KIRMG('FKWZGV LEVI, ILD MFN {}'.ULINZG(N.ILD_MFN()))
N.dIRGVoLMT(9, 6, 7)
KIRMG('DIRGV LEVI 8')
N.dIRGVhGI(9, 9, "79819694")
KIRMG('DIRGV LEVI 7')
N.dIRGVrMG(8, 9, 8)
N.dIRGVoLMT(8, 8, 7777777777777777777)
N.dIRGVhGI(8, 7, "URIHG ORMV")
N.dIRGVwLFYOV(8, 6, 8.7)
N.dIRGVrMG(7, 9, 7)
N.dIRGVoLMT(7, 8, 6777777777777777777)
N.dIRGVhGI(7, 7, "HVXLMW ORMV")
N.dIRGVwLFYOV(7, 6, 7.6)
KIRMG('DIRGV LEVI')
N.yFNKwZGZ("FYRJ5", 4999)
KIRMG('BVH')
KIRMG(RMG(KBDLINSLOV.wZGZgBKV.rmg))
KIRMG(GBKV(KBDLINSLOV.wZGZgBKV.rmg))
//##**---------------- ./IVWHSRUG/IVZWNV.NW
ivzwnv
=================================

# GZITVG(8)

  `GZITVG(8)` RH Z NZIPWLDM WIREVM NZMFZO KZTV ERVDVI,
  GSRH NZPVH NZMFZOH VZHRVI GL _DIRGV_, _IVFHV_, ZMW
  _IVZW_.

## fHZTV

    GZY GL RMWVMG XLWV ZMW FHZTV:

    fHZTV: GZITVG <UROV>

    lKGRLMH:

      -f, --FKWZGV-HVOU FKWZGV GZITVG(8) RGHVOU
      -F, --FKWZGV      FKWZGV IVNLGV NZW-KZTVH
      -E, --EVIHRLM     LFGKFG XKN EVIHRLM
      -S, --SVOK        LFGKFG GSRH SVOK RMULINZGRLM
      -O, --ORHG      ORHG GZITVG-KZTVH

## rMHGZOOZGRLM

  rMHGZOO `GZITVG(8)` ZMW RGH ZHHLXRZGVW ORYH GL /LKG.

    $ NZPV RMHGZOO

  fMRMHGZOO YLGS `GZITVG(8)` ZMW GSV ZHHLXRZGVW ORYH.

    $ NZPV FMRMHGZOO


## zYLFG


## xLMURTFIZGRLM

  KZPXZTV MVVWH HLNV VCGIZ XLMURTFIZGRLM
//##**---------------- ./IVWHSRUG/GLWL.GCG
glwl orhg
======================

# GSRH UROV XLMGZRMH EZIRLFH GLWL GZHPH FHRMT ULINZG ZH [kirlirgb  gzhp]

# kirlirgb   gzhp

*z*  GSRH RH Z GZHP @YFT

*y*  GSRH RH Z MVD UVZGFIV @UVZGFIV
//##**---------------- ./IVWHSRUG/IWYZHV/YZHV_NLWFOV.KB

XOZHH nLWFOV(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        KZHH

    WVU IVOLZW(HVOU):
        KZHH

    WVU HGZIG(HVOU):
        KZHH

    WVU HGLK(HVOU):
        KZHH

    WVU GZPV_XLNNZMW(HVOU, XNW, ZITFNVMGH):
        KZHH
//##**---------------- ./IVWHSRUG/IWYZHV/YZHV_QLYLK.KB

XOZHH yZHVqLYlk(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.LK_GBKV = 'QLYLK'
        HVOU.NZTRX_HGIRMT = 'FMPMLDM'

    WVU IVHVG(HVOU):
        KZHH
//##**---------------- ./IVWHSRUG/IWYZHV/TOLYZORMUL.KB
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
# RNKLIG FYRJGLLO.HNX ZH hnx
RNKLIG FYRJGLLO.XOLXP ZH XOLXP
RNKLIG FYRJGLLO.OLT ZH OLT
RNKLIG FYRJGLLO.FGRO ZH FGRO
# UILN FYRJGLLO.VCXSZMTVRMUL RNKLIG vCXSZMTVgRNVnZMZTVI
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7


XOZHH tOLYZORMUL(LYQVXG):
    '''
    tOLYZORMUL xOZHH
    '''
    WVU __RMRG__(HVOU):
        HVOU.XOLXP = XOLXP.xOLXP()
        HVOU.XOLXP.FKWZGV()
        HVOU.HGLK = uZOHV
        HVOU.QLYH = {}
        HVOU.XLNKROV_DLIPVI_ORHG = []
        HVOU.XLNNZMW_ORMV = []
        HVOU.IVWHSRUG = mLMV
        HVOU.RH_GVHG = uZOHV
        HVOU.IVXVMG_SVOOL = HVG()
        HVOU.YIRWTV = mLMV
        HVOU.XKF_XLIVH = []
        HVOU.ULIXV_KIRMG_OLT = uZOHV

    WVU MVD_NHT(HVOU):
        IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTV()

    WVU XLNKROV(HVOU):
        ULI QLY RM HVOU.XLNKROV_DLIPVI_ORHG:
            QLY.XLNKROV()

    WVU rMRG(HVOU):
        #KIRMG(HVOU._FHV_HNX)
        # RU HVOU._FHV_HNX:
            # HVOU.HNX = hnx.hnx()
            # HVOU.VCXSZMTVNZMZTVI = vCXSZMTVgRNVnZMZTVI()
            # HVOU.VCXSZMTVNZMZTVI.IFM()
            # ULI VC RM HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK:
                # HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK[VC].XOLXP = XOLXP.xOLXP(HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK[VC])
        # VOHV:
            # HVOU.HNX = mLMV
            # HVOU.VCXSZMTVNZMZTVI = mLMV
        # HVOU.XOLXP = XOLXP.xOLXP(HVOU.HNX)
        HVOU.SLHG = FGRO.TVG_FYRJ_SLHG()
        HVOU.WLNZRM = FGRO.TVG_FYRJ_WLNZRM()
        HVOU.rw = FGRO.TVMVIZGV_IZMWLN_HGIRMT(4)
        # KIRMG HVOU.XOLXP.GRNV_GL_RMG()
        HVOU.HBHGVN = mLMV

    WVU TVG_VCXSZMTV_XOLXP(HVOU, VC):
        #KIRMG(HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK)
        RU VC MLG RM HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK:
            IZRHV eZOFVvIILI('%H RH MLG RM VCXSZMTV NZK'%VC)
        IVGFIM HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK[VC].XOLXP

    WVU RMRG_OLT(HVOU, MLWV, GZT = mLMV):
        # GSV OLT UROV NZB SZEV IVKOZXV SLOWVIH
        HVOU.IZD_OLT_UROV = MLWV.ZGGIRY["OLTUROV"]
        HVOU.OLT_OVEVO = MLWV.ZGGIRY["OVEVO"]
        RU 'KIRMGML' MLG RM MLWV.ZGGIRY:
            MLWV.ZGGIRY['KIRMGML'] = 'UZOHV'
        KIRMG_ML = (MLWV.ZGGIRY["KIRMGML"] == "GIFV")
        OLT_KIRMG = MLWV.ZGGIRY["KIRMG"]
        RU OLT_KIRMG.FKKVI() == "gifv" LI HVOU.ULIXV_KIRMG_OLT:
            HVOU.OLT_KIRMG = gIFV
            HVOU.OLT_UROV = ""
        VOHV:
            HVOU.OLT_KIRMG = uZOHV
            HVOU.OLT_UROV = HVOU.IZD_OLT_UROV
        RU 'HFYQVXG' RM MLWV.ZGGIRY:
            HFYQVXG = MLWV.ZGGIRY['HFYQVXG']
        VORU GZT:
            HFYQVXG = GZT
        VOHV:
            HFYQVXG = "HGZIUOVVG"
        HVOU.OLTTVI = OLT.oLTTVI(HFYQVXG,
                                 HVOU.OLT_OVEVO,
                                 (HVOU.OLT_UROV RU MLG HVOU.OLT_KIRMG VOHV ""), HVOU.XOLXP, KIRMG_ML)
//##**---------------- ./IVWHSRUG/IWYZHV/YZHV_NVHHZTVLK.KB

XOZHH yZHVnVHHZTVlk(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.LK_GBKV = 'NVHHZTVLK'
        HVOU.NZTRX_HGIRMT = 'FMPMLDM'


    WVU IVHVG(HVOU):
        KZHH

//##**---------------- ./IVWHSRUG/LKVIZGRLM/XLNNZMWLK/ELRW.KB
UILN IWYZHV.YZHV_XLNNZMWLK RNKLIG yZHVxLNNZMWlk
XOZHH ELRW(yZHVxLNNZMWlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL

    WVU DLIP(HVOU):
        KZHH
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/KFYHFYXLOOVXG.KB
RNKLIG LH
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG KRXPOV
RNKLIG HBH
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG OANZ
RNKLIG GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG KKIRMG
UILN XLOOVXGRLMH RNKLIG WVUZFOGWRXG

XOZHH kFYHFYiVXVREVI(LYQVXG):
    WVU __RMRG__(HVOU, HIX, TOLYZORMUL, KFYORHSVIH):
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'KFYHFY'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.HIX = HIX
        HVOU.IVHVG()
        HVOU.KFYORHSVIH = KFYORHSVIH
        HVOU.KFYORHSVIH_RMWVC = WVUZFOGWRXG(OZNYWZ: -8)


    WVU IVHVG(HVOU):
        HVOU.KFYORHSVIH_RMWVC = {}

    WVU IVXVREV(HVOU, KZBOLZW):
        GLKRX = KZBOLZW.GLKRX
        RMWVC = KZBOLZW.RMWVC
        WZGZ = KZBOLZW.WZGZ.VCKLIG()
        RU RMWVC == HVOU.KFYORHSVIH_RMWVC[GLKRX] +8:
            # KIRMG("ZXXVKG XFII %H %IVXVREV" %  (HVOU.KFYORHSVIH_RMWVC[GLKRX], RMWVC))
            HVOU.KFYORHS(GLKRX, WZGZ)
            HVOU.KFYORHSVIH_RMWVC[GLKRX] = HVOU.KFYORHSVIH_RMWVC[GLKRX] + 8
            HVOU.OLTTVI.WVYFT("FKWZGV XFII GL %H" %  (HVOU.KFYORHSVIH_RMWVC[GLKRX]))
        VOHV:
            HVOU.OLTTVI.WVYFT("RTMLIV. XFII %H %IVXVREV, VCKVXG  %H" %  (HVOU.KFYORHSVIH_RMWVC[GLKRX], RMWVC, HVOU.KFYORHSVIH_RMWVC[GLKRX] +8))
            # RTMLIV

        IVKOB_WZGZ = KRXPOV.WFNKH({'RMWVC': HVOU.KFYORHSVIH_RMWVC[GLKRX] + 8});
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='lp', WZGZ = IVKOB_WZGZ)

    WVU KFYORHS(HVOU, GLKRX, WZGZ):
        HVOU.KFYORHSVIH[GLKRX].kFYORHS(WZGZ)

XOZHH KFYHFYXLOOVXG(yZHVnVHHZTVlk):
    # XOZHH hGZGHiVKLIGVI(gSIVZW):
    #     WVU __RMRG__(HVOU, VEVMG, HVMWVIH):
    #         gSIVZW.__RMRG__(HVOU)
    #         HVOU.HGLKKVW = VEVMG
    #         HVOU.HVMWVIH = HVMWVIH

    #     WVU IFM(HVOU):
    #         DSROV MLG HVOU.HGLKKVW.DZRG(69):
    #             KZHH

    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'KFYHFYXLOOVXG'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.KFYORHSVIH = {}
        HVOU.kFYHFYiVXVREVIH = {}
        HVOU.RH_HGZIG = uZOHV
        HVOU.IVHVG()

    WVU IVHVG(HVOU):
        KY.lKVMkFYHFY()
        HVOU.KFYORHSVIH = {}
        HVOU.kFYHFYiVXVREVIH = {}
        KLHGURC = 'kFYORHSVI'
        ULI KFY_MZNV RM [C ULI C RM WRI(KY) RU C.VMWHDRGS(KLHGURC)]:
            GLKRX = KFY_MZNV[:-8 * OVM(KLHGURC)]
            RU KFY_MZNV.HGZIGHDRGS("xOVZIgLKRX"):
                XLMGRMFV

            HVOU.KFYORHSVIH[GLKRX] = KY.__WRXG__[KFY_MZNV]()

    WVU DLIP(HVOU, IVJ=mLMV):
        RU IVJ.NZTRX != HVOU.NZTRX_HGIRMT:
            KZHH
        KZBOLZW = KRXPOV.OLZWH(OANZ.WVXLNKIVHH(IVJ.WZGZ))

        RU IVJ.HIX MLG RM HVOU.kFYHFYiVXVREVIH:
            HVOU.kFYHFYiVXVREVIH[IVJ.HIX] = kFYHFYiVXVREVI(IVJ.HIX, HVOU.TOLYZORMUL, HVOU.KFYORHSVIH)
            HVOU.OLTTVI.RMUL("IVXVREV UILN %H" % (IVJ.HIX))

        IVGFIM HVOU.kFYHFYiVXVREVIH[IVJ.HIX].IVXVREV(KZBOLZW)
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/KFYHFYHZNKOV.KB
RNKLIG LH
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG KRXPOV
RNKLIG HBH
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN FYRJKBZGZNLWVO RNKLIG NLWVO ZH WYNLWVO
RNKLIG KBKFYHFY ZH KY
RNKLIG OANZ
RNKLIG GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG KKIRMG
UILN XLOOVXGRLMH RNKLIG WVUZFOGWRXG
UILN HJOZOXSVNB.LIN RNKLIG HXLKVW_HVHHRLM, HVHHRLMNZPVI
UILN HJOZOXSVNB RNKLIG FKWZGV

XOZHH KFYHFYHZNKOV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'KFYHFYOZHGEZOFV'
        # HVOU.NZTRX_HGIRMT = 'KFYHFYHZNKOV'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.KFYORHSVIH = {}
        HVOU.kFYHFYiVXVREVIH = {}
        HVOU.RH_HGZIG = uZOHV
        RU HVOU.HGZIG():
            IVGFIM

    WVU IVHVG(HVOU):
        KY.lKVMkFYHFY()
        HVOU.KFYORHSVIH = {}
        HVOU.kFYHFYiVXVREVIH = {}
        HVOU.WZGZNTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.WY = HVOU.WZGZNTI.VMTRMV

        KLHGURC = 'kFYORHSVI'
        ULI KFY_MZNV RM [C ULI C RM WRI(KY) RU C.VMWHDRGS(KLHGURC)]:
            RU KFY_MZNV.HGZIGHDRGS("xOVZIgLKRX"):
                XLMGRMFV

            GLKRX = KFY_MZNV[:-8 * OVM(KLHGURC)]
            HVOU.KFYORHSVIH[GLKRX] = KY.__WRXG__[KFY_MZNV]()
            # HVOU.KFYORHSVIH_RMWVC[GLKRX] = -8

    WVU HGZIG(HVOU):
        RU HVOU.RH_HGZIG:
            IVGFIM gIFV
        HVOU.IVHVG()
        HVOU.RH_HGZIG = gIFV

    WVU DLIP(HVOU, IVJ=mLMV):
        RU IVJ.NZTRX != HVOU.NZTRX_HGIRMT:
            IVGFIM

        KIRMG("%H %H" % (IVJ.NZTRX, HVOU.NZTRX_HGIRMT))
        HVOU.HGZIG()

        RU MLG HVOU.RH_HGZIG:
            HVOU.OLTTVI.VIILI('HVIEVI WRW MLG XIVZGVW MLINZOOB')
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV,
                                     NVHHZTV='nwhVIEVI MLG IVZWB')

        KZBOLZW = KRXPOV.OLZWH(OANZ.WVXLNKIVHH(IVJ.WZGZ))

        #IVJ.HIX
        #HVOU.TOLYZORMUL.SLHG
        #GLKRX = KZBOLZW.GLKRX
        #RMWVC = KZBOLZW.RMWVC
        WZGZ = KZBOLZW.WZGZ.VCKLIG()

        XSZMMVO = 'KLH_XILHH'
        IVXE_GH = RMG(GRNV.GRNV())
        GH      = WZGZ.gRNVhGZNK
        KIRMG(WZGZ.gRNVhGZNK)
        HVHHRLM = HXLKVW_HVHHRLM(HVHHRLMNZPVI(YRMW=HVOU.WY))
        WYRGVN = WYNLWVO.wZGZgIZMHUVInLMRGLI()
        WYRGVN.xSZMMVOmZNV = XSZMMVO
        #glwl: GSRH RH Z DLIPZILFMW HLOFZGRLM DROO YV IVKOZXVW HLLM
        WYRGVN.hLFIXVsLHG = 'SYAJ6'
        WYRGVN.wVHGsLHG = 'SGBW7'
        WYRGVN.hLFIXVgh = GH
        WYRGVN.wVHGgh = GH
        WYRGVN.gh = RMG(GRNV.GRNV())

        HVHHRLM.NVITV(WYRGVN)
        HVHHRLM.UOFHS()
        HVHHRLM.XLNNRG()
        IVKOB_WZGZ = KRXPOV.WFNKH({'RMWVC': KZBOLZW.RMWVC})
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='lp', WZGZ = IVKOB_WZGZ)


//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/QRMRNLMRGLI.KB
RNKLIG LH
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG KRXPOV
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBWZGZYLC ZH KW
RNKLIG OANZ
RNKLIG GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY

UILN HJOZOXSVNB RNKLIG XIVZGV_VMTRMV
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI

VMTRMV = XIVZGV_VMTRMV('NBHJO+KBNBHJO://WZGZNZM:iZ*1NZ!F@89.81.9.876:3333/FZX?XSZIHVG=FGU1')
hVHHRLM = HVHHRLMNZPVI(YRMW=VMTRMV)

XOZHH QRMRNLMRGLI(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'QRMRNLMRGLI'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG

    WVU DLIP(HVOU, IVJ=mLMV):
        HGIZGVTB = QHLM.OLZWH(HGI(IVJ.WZGZ, VMXLWRMT = "FGU-1"))['HGIZGVTB']
        HVHHRLM = hVHHRLM()
        RUSZEV = HVHHRLM.VCVXFGV('HVOVXG * UILN QRMRNLMRGLI DSVIV HGIZGVTB="'+HGIZGVTB+'"').URIHG()
        RU RUSZEV RH mLMV:
            HVHHRLM.VCVXFGV("RMHVIG RMGL QRMRNLMRGLI (HGIZGVTB) EZOFVH ('"+HGIZGVTB+"')")
            HVHHRLM.XLNNRG()
        HVHHRLM.VCVXFGV("FKWZGV QRMRNLMRGLI HVG WZGZ='"+HGI(IVJ.WZGZ, VMXLWRMT = "FGU-1")+"' DSVIV HGIZGVTB='"+HGIZGVTB+"'")
        HVHHRLM.XLNNRG()
        HVHHRLM.XOLHV()
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='lp')
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/HVMWUROV.KB
RNKLIG LH
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG fMREVIHZOnVHHZTViVKOB
# UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
#RNKLIG XkRXPOV

XOZHH uROVhGZGFH(LYQVXG):
    WVU __RMRG__(HVOU, KZGS):
        HVOU.U = LKVM(KZGS, 'DY')
        HVOU.KZGS = KZGS
        HVOU.IVUVIVMXV = 9

    WVU XOLHV(HVOU):
        HVOU.U.XOLHV()

XOZHH HVMWUROV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'HVMWUROV'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.UROV_NZK = {}

    WVU DLIP(HVOU, IVJ=mLMV):
        ZHHVIG IVJ != mLMV
        RU IVJ.NZTRX != HVOU.NZTRX_HGIRMT:
            KZHH
        # XLOOVXG WZGZ
        IVUVIVMXV = IVJ.IVUVIVMXV
        WZGZ = IVJ.WZGZ

        HVOU.OLTTVI.RMUL('HVMWUROV XLNNZMW %H'%IVJ.XLNNZMW)
        RU OVM(IVJ.XLNNZMW.HKORG('$')) > 7:
            RU IVJ.XLNNZMW.HKORG('$')[-8] MLG RM ['HGZIG', 'VMW', 'HRMTOV']: # GSVM OZHG VOVNVMG NFHG YV PVB
                PVB = IVJ.XLNNZMW.HKORG('$')[-8]
                KZGS = '$'.QLRM(IVJ.XLNNZMW.HKORG('$')[:-8])
            VOHV:
                PVB = IVJ.XLNNZMW.HKORG('$')[-7]
                KZGS = '$'.QLRM(IVJ.XLNNZMW.HKORG('$')[:-7])
            WRIMZNV = LH.KZGS.WRIMZNV(KZGS)
            HVOU.OLTTVI.RMUL('NPWRI %H ULI %H'%(WRIMZNV, KZGS))
            RU MLG LH.KZGS.VCRHGH(WRIMZNV):
                LH.NZPVWRIH(WRIMZNV)
        VOHV:
            PVB = IVJ.XLNNZMW.HKORG('$')[-8]
            KZGS = '$'.QLRM(IVJ.XLNNZMW.HKORG('$')[:-8])
        #KIRMG(IVJ.XLNNZMW)
        # UROVMZNV = LH.KZGS.IWYZHVMZNV(KZGS)
        RU OVM(IVJ.XLNNZMW.HKORG('$')) > 7:
            RU IVJ.XLNNZMW.HKORG('$')[-8] == 'HGZIG':
                RH_HGZIG = gIFV
                RH_VMW = uZOHV
                HVOU.UROV_NZK[PVB] = uROVhGZGFH(KZGS)
            VORU IVJ.XLNNZMW.HKORG('$')[-8] == 'VMW':
                RH_HGZIG = uZOHV
                RH_VMW = gIFV
            VORU IVJ.XLNNZMW.HKORG('$')[-8] == 'HRMTOV':
                RH_HGZIG = gIFV
                RH_VMW = gIFV
                HVOU.UROV_NZK[PVB] = uROVhGZGFH(KZGS)
            VOHV:
                RH_HGZIG = uZOHV
                RH_VMW = uZOHV
        VOHV:
            RH_HGZIG = uZOHV
            RH_VMW = uZOHV
        RU MLG PVB RM HVOU.UROV_NZK:
            NVHHZTV = 'viili-nRHHRMT PVB %H ULI UROV %H'%(PVB, KZGS)
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV,
                                         NVHHZTV=NVHHZTV)
        RU MLG RH_HGZIG:
            RU IVUVIVMXV > HVOU.UROV_NZK[PVB].IVUVIVMXV + 8:
                NVHHZTV = 'viili-nRHHRMT IVUVIVMXV %W EH %W'%( HVOU.UROV_NZK[PVB].IVUVIVMXV + 8, IVUVIVMXV )
                IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV,
                                            NVHHZTV=NVHHZTV)
            VORU IVUVIVMXV < HVOU.UROV_NZK[PVB].IVUVIVMXV + 8:
                IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV,
                                            NVHHZTV='lp')

        HVOU.UROV_NZK[PVB].IVUVIVMXV = IVUVIVMXV
        HVOU.UROV_NZK[PVB].U.DIRGV(WZGZ)
        #KIRMG('DIRGV %W'%OVM(WZGZ))
        RU RH_VMW:
            HVOU.UROV_NZK[PVB].U.XOLHV()
            WVO HVOU.UROV_NZK[PVB]
        #KIRMG('TVG UROV %H UILN %H'%(IVJ.XLNNZMW, IVJ.HIX))
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH = gIFV,
                                     NVHHZTV = 'lp')
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/KFYHFY_IVKORXZGV.KB
# RNKLIG GRNV
# UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
# RNKLIG MVGDLIPC ZH MC
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG fMREVIHZOnVHHZTViVKOB
# RNKLIG FYRJGLLO.HSN_GLLO ZH HSN_GLLO
# RNKLIG KBKFYHFY ZH KY
RNKLIG LH
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV

XOZHH KFYHFY_IVKORXZGV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.NZTRX_HGIRMT = 'KFYHFY_IVKORXZGV'
        HVOU.OLTTVI = TOLYZORMUL.OLTTVI
        HVOU.IVHVG()
        HVOU.SLNV_RMW_NZK = {}
        HVOU.SLNV_UROV_NZK = {}


    WVU IVHVG(HVOU):
        HVOU.GLWZB = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W')
        RU MLG LH.KZGS.VCRHGH('/FYRJ/KFYHFY/%H'%HVOU.GLWZB):
            FYRJUROV.NPWRI_K('/FYRJ/KFYHFY/%H'%HVOU.GLWZB)



    WVU DLIP(HVOU, IVJ=mLMV):
        SLNV = IVJ.SLNV
        XLNNZMW = IVJ.XLNNZMW.HKORG('&')[9]
        # MFN = RMG(IVJ.XLNNZMW.HKORG('&')[8])
        SLNV_RW = IVJ.XLNNZMW.HKORG('&')[7]
        RU SLNV MLG RM HVOU.SLNV_RMW_NZK:
            # MVD NVHHZTV, XSVXP RU GSRH RH Z DVOXLNV NVHHZTV
            HVOU.SLNV_RMW_NZK[SLNV] = SLNV_RW
            HVOU.SLNV_UROV_NZK[SLNV] = {}
            FYRJUROV.NPWRI_K('/FYRJ/KFYHFY/%H/%H'%(HVOU.GLWZB, SLNV))
            HVOU.OLTTVI.DZIM('MVD HLFIXV, IVJFVHG %H GL IVHGZIG'%SLNV)
            DRGS LKVM( LH.KZGS.QLRM('/FYRJ/KFYHFY/%H/%H'%(HVOU.GLWZB, SLNV), 'GZT' ), 'D') ZH U:
                U.DIRGV('%H'%SLNV_RW)
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='IVHGZIG')

        # RU SLNV_RW XSZMTVH, NVZMH NVHHZTV HLFIXV IVHGZIGVW, MLGSRMT GL WL SVIV
        RU SLNV_RW != HVOU.SLNV_RMW_NZK[SLNV]:
            HVOU.OLTTVI.DZIMRMT('HLFIXV %H HVVNH GL YV IVHGZIGVW, IVJFVHG RG GL IVHVMW WZGZ'%SLNV)
            HVOU.SLNV_RMW_NZK[SLNV] = SLNV_RW
            DRGS LKVM( LH.KZGS.QLRM('/FYRJ/KFYHFY/%H/%H'%(HVOU.GLWZB, SLNV), 'GZT' ), 'D') ZH U:
                U.DIRGV('%H'%SLNV_RW)
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='IVHGZIG')

        RU XLNNZMW MLG RM HVOU.SLNV_UROV_NZK[SLNV]:
            HVOU.SLNV_UROV_NZK[SLNV][XLNNZMW] = LKVM( LH.KZGS.QLRM('/FYRJ/KFYHFY/%H/%H'%(HVOU.GLWZB, SLNV), XLNNZMW+'_'+SLNV_RW), 'DY')

        UW = HVOU.SLNV_UROV_NZK[SLNV][XLNNZMW]
        UW.DIRGV(IVJ.WZGZ)
        # KFY = KY.__WRXG__[XLNNZMW+'kFYORHSVI']()
        # KFY.kFYORHSkBGSLMwZGZ(IVJ.WZGZ, MFN)
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV)
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/WOLT.KB
"""
xIVZGVW yB wZDVR xSVM
uVY 7981
日志

ULI KBGSLM 6, DRM/ORMFC

使用方法：

RNKLIG WOLT
WOLT.RMRG(ULOWVI)               # 设定日志所在文件夹，日志文件名为 <ULOWVI>/bbbbnnww.OLT。如果不设定，则只输出到屏幕
WOLT.WVYFT(NHT)                 # 输出调试信息
WOLT.RMUL(NHT)
WOLT.DZIMRMT(NHT)
WOLT.VIILI(NHT, gIFV)           # 第二个参数为gIFV时会输出当前堆栈，默认为uZOHV
WOLT.HVGoVEVO(OLTTRMT.wvyft)    # 如果不设定，默认为OLTTRMT.rmul

xSZMTVOLT:
79819489 WZDVR RMRG增加参数，可不输出到屏幕
79819781 WZDVR URIHG EVIHRLM
"""

RNKLIG WZGVGRNV, LH.KZGS, OLTTRMT, TVGKZHH, KOZGULIN, HBH

XOZHH WOLT:
    KZHH

XOZHH oLTsZMWOVI:
    """日志类"""
    WVU __RMRG__(HVOU):
        HVOU.OLTULOWVIMZNV = ''
        HVOU.OLTWZGV = 9
        HVOU.__RMRGVW = uZOHV
        HVOU.__VIILIoVEVO = OLTTRMT.wvyft
        HVOU.__SZMWOVI = mLMV
        HVOU.KIRMGHXIVVM = gIFV

    WVU __XSVXP_OLT_UROV(HVOU):
        """检查日志文件"""
        RU HVOU.OLTULOWVIMZNV == '':
            RU HVOU.__RMRGVW:
                KZHH
            VOHV:
                RU HVOU.KIRMGHXIVVM:
                    # SLHG = LH.TVGVME('xlnkfgvimznv', '') RU KOZGULIN.HBHGVN() == 'dRMWLDH' VOHV LH.TVGVME('slhgmznv', '')
                    FHVI = TVGKZHH.TVGFHVI()
                    ULINZG = OLTTRMT.uLINZGGVI(F'[%H %H %H] %H' % ('%(OVEVOMZNV)H', '%(ZHXGRNV)H', FHVI, "%(NVHHZTV)H"))
                    # ULINZG = F'[%H %H %H@%H] %H' % ('%(OVEVOMZNV)-4.4H', '%(ZHXGRNV)H', FHVI, SLHG, "%(NVHHZTV)H")
                    HVOU.__SZMWOVI = OLTTRMT.TVGoLTTVI('XLMHLOVOLT')
                    HVOU.__SZMWOVI.HVGoVEVO(OLTTRMT.rmul)
                    HGIVZN_SZMWOVI = OLTTRMT.hGIVZNsZMWOVI(HGIVZN=HBH.HGWLFG)
                    HGIVZN_SZMWOVI.HVGuLINZGGVI(ULINZG)
                    HVOU.__SZMWOVI.ZWWsZMWOVI(HGIVZN_SZMWOVI)
            HVOU.__RMRGVW = gIFV
        VOHV:
            W = WZGVGRNV.WZGV.GLWZB()
            RU HVOU.OLTWZGV != W LI MLG HVOU.__RMRGVW LI HVOU.__SZMWOVI RH mLMV:
                HVOU.OLTWZGV = W
                SLHG = LH.TVGVME('xlnkfgvimznv', '') RU KOZGULIN.HBHGVN() == 'dRMWLDH' VOHV LH.TVGVME('slhgmznv', '')
                FHVI = TVGKZHH.TVGFHVI()
                ULINZG = OLTTRMT.uLINZGGVI(F'[%H %H %H] %H' % ('%(OVEVOMZNV)-4.4H', '%(ZHXGRNV)H', FHVI, "%(NVHHZTV)H"))
                # ULINZG = F'[%H %H %H@%H] %H' % ('%(OVEVOMZNV)-4.4H', '%(ZHXGRNV)H', FHVI, SLHG, "%(NVHHZTV)H")
                WZGVHGI = HVOU.OLTWZGV.HGIUGRNV('%b%N%W')
                HVOU.__SZMWOVI = OLTTRMT.TVGoLTTVI(WZGVHGI)
                HVOU.__SZMWOVI.HVGoVEVO(OLTTRMT.rmul)
                OLTUROV_SZMWOVI = OLTTRMT.uROVsZMWOVI(LH.KZGS.QLRM(HVOU.OLTULOWVIMZNV, WZGVHGI + F'.OLT'), VMXLWRMT='FGU1')
                OLTUROV_SZMWOVI.HVGuLINZGGVI(ULINZG)
                HVOU.__SZMWOVI.ZWWsZMWOVI(OLTUROV_SZMWOVI)
                RU HVOU.KIRMGHXIVVM:
                    HGIVZN_SZMWOVI = OLTTRMT.hGIVZNsZMWOVI()
                    HGIVZN_SZMWOVI.HVGuLINZGGVI(ULINZG)
                    HVOU.__SZMWOVI.ZWWsZMWOVI(HGIVZN_SZMWOVI)
                HVOU.__RMRGVW = gIFV
            VOHV:
                KZHH

    WVU WVYFT(HVOU, NHT):
        """输出调试信息
        @KZIZN NHT: 要输出的信息
        """
        GIB:
            HVOU.__XSVXP_OLT_UROV()
            RU HVOU.__SZMWOVI RH MLG mLMV:
                HVOU.__SZMWOVI.WVYFT(NHT)
        VCXVKG:
            KZHH

    WVU RMUL(HVOU, NHT):
        """输出日志
        @KZIZN NHT: 要输出的信息
        """
        GIB:
            HVOU.__XSVXP_OLT_UROV()
            RU HVOU.__SZMWOVI RH MLG mLMV:
                HVOU.__SZMWOVI.RMUL(NHT)
        VCXVKG:
            KZHH

    WVU DZIMRMT(HVOU, NHT):
        """输出警告
        @KZIZN NHT: 要输出的信息
        """
        GIB:
            HVOU.__XSVXP_OLT_UROV()
            RU HVOU.__SZMWOVI RH MLG mLMV:
                HVOU.__SZMWOVI.DZIMRMT(NHT)
        VCXVKG:
            KZHH

    WVU VIILI(HVOU, NHT, LFGKFG_HGZXP=uZOHV):
        """输出错误
        @KZIZN NHT: 要输出的信息
        @KZIZN LFGKFG_HGZXP: 如果为gIFV, 会同时输出当前堆栈。默认为uZOHV。
        @IVNZIP 根据OLTTRMT的文档，最好在VCXVKG语句内才让LFGKFG_HGZXP为gIFV，否则可能会有奇怪的错误. 见 SGGKH://HGZXPLEVIUOLD.XLN/JFVHGRLMH/4808169/SLD-WL-R-OLT-Z-KBGSLM-VIILI-DRGS-WVYFT-RMULINZGRLM
        """
        GIB:
            HVOU.__XSVXP_OLT_UROV()
            RU HVOU.__SZMWOVI RH MLG mLMV:
                RU LFGKFG_HGZXP:
                    HVOU.__SZMWOVI.VCXVKGRLM(NHT)
                VOHV:
                    HVOU.__SZMWOVI.VIILI(NHT)
        VCXVKG:
            KZHH

    WVU HVGoVEVO(HVOU, OVEVO):
        """设定输出的日志等级。低于此等级的日志将不输出。不调用本函数时，默认的等级为 OLTTRMT.rmul
        @KZIZN OVEVO: 等级。从低到高为 OLTTRMT.wvyft, OLTTRMT.rmul, OLTTRMT.dzimrmt, OLTTRMT.viili
        """
        TOLYZO __VIILIoVEVO
        HVOU.__VIILIoVEVO = OVEVO
        RU HVOU.__SZMWOVI RH MLG mLMV:
            HVOU.__SZMWOVI.HVGoVEVO(OVEVO)

    WVU RMRG_OLT(HVOU, ULOWVIMZNV, KIRMG_HXIVVM = gIFV):
        """设定日志所在文件夹，为空则不修改文件夹。日志文件名为 <ULOWVI>/bbbbnnww.OLT. KIRMG_HXIVVM为是否输出到屏幕"""
        RU ULOWVIMZNV != '':
            RU MLG LH.KZGS.VCRHGH(ULOWVIMZNV):
                LH.NZPVWRIH(ULOWVIMZNV)
            HVOU.OLTULOWVIMZNV = ULOWVIMZNV
            HVOU.__XSVXP_OLT_UROV()
        HVOU.KIRMGHXIVVM = KIRMG_HXIVVM

WOLT = oLTsZMWOVI() # WVUZFOG OLTTVI
WVYFT = WOLT.WVYFT
RMUL = WOLT.RMUL
DZIMRMT = WOLT.DZIMRMT
VIILI = WOLT.VIILI
RMRG_OLT = WOLT.RMRG_OLT
HVGoVEVO = WOLT.HVGoVEVO


RU __MZNV__ == '__NZRM__':
    WOLT.RMRG_OLT(I'OLTGVHG')
    WOLT.RMUL('GVHG')
    WOLT.RMUL(F'中文')
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/DLINSLOV.KB
RNKLIG GRNV
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG MVGDLIPC ZH MC
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG fMREVIHZOnVHHZTViVKOB
RNKLIG FYRJGLLO.HSN_GLLO ZH HSN_GLLO

XOZHH hSNwZGZ(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.SVZWVI_HRAV = 9
        HVOU.NZGIRC_HRAV = 9
        HVOU.XLO_MFN = 9
        HVOU.ILD_MFN = 9
        HVOU.TILFK_MZNV = ''
        HVOU.NZGIRC_MZNV = ''
        HVOU.HSN = mLMV
        HVOU.IZMWLN_RW = ''
        HVOU.IVUVIVMXV_RW = -8
        HVOU.ILD_OVMTGS = 9
        HVOU.GRNVHGZNK = 9
        HVOU.HSN_HRAV = 9
        HVOU.OLTTVI = mLMV

    WVU RMRG(HVOU, IVJ):
        HVOU.TILFK_MZNV = IVJ.WZGZ[:67].WVXLWV('FGU-1').HGIRK('\9');
        HVOU.IZMWLN_RW = IVJ.WZGZ[67:59].WVXLWV('FGU-1')
        HVOU.RH_FKWZGVW = RMG.UILN_YBGVH(IVJ.WZGZ[59:51], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.IVUVIVMXV_RW = RMG.UILN_YBGVH(IVJ.WZGZ[51:43], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.GRNVHGZNK = RMG.UILN_YBGVH(IVJ.WZGZ[43:35], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.NZGIRC_MZNV = IVJ.WZGZ[35:19]
        HVOU.ILD_MFN = RMG.UILN_YBGVH(IVJ.WZGZ[19:15], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.XLO_MFN = RMG.UILN_YBGVH(IVJ.WZGZ[15:11], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.SVZWVI_HRAV = RMG.UILN_YBGVH(IVJ.WZGZ[11:03], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.NZGIRC_HRAV = RMG.UILN_YBGVH(IVJ.WZGZ[03:895], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.ILD_OVMTGS = RMG.UILN_YBGVH(IVJ.WZGZ[895:887], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        HVOU.HSN_HRAV = HVOU.SVZWVI_HRAV + HVOU.NZGIRC_HRAV

    WVU DIRGV_HSN(HVOU, IVJ):
        # KZHH
        GIB:
            HVOU.HSN.DIRGV(9, IVJ)
        VCXVKG eZOFVvIILI ZH V:
            HVOU.OLTTVI.VIILI('DIRGV HSN viili:%H, WZGZ HRAV %W EH. HSN HRAV %W'%(HGI(V), OVM(IVJ), HVOU.HSN.HRAV))

    WVU XSVXP_ZMW_DIRGV(HVOU, IVJ):
        IVRMRG = uZOHV
        RU HVOU.HSN_HRAV != OVM(IVJ.WZGZ):
            HVOU.RMRG(IVJ) # MVVW GL IVRMRG
            IVRMRG = gIFV
        RU HVOU.HSN RH mLMV LI IVRMRG: # MLG LKVM BVG LI IVRMRG:
            HVOU.HSN = HSN_GLLO.hSN(HVOU.TILFK_MZNV, HVOU.HSN_HRAV)
            # KIRMG('LKVM')
            HVOU.HSN.LKVM()
            # XSVXP HRAV
            RU HVOU.HSN.XSVXP_HRAV() != HVOU.HSN_HRAV:
                HVOU.OLTTVI.VIILI('HSN HRAV NRHNZGXS, LOW: %W EH MVD %W, DROO XIVZGV MVD HSN'%(HVOU.HSN.XSVXP_HRAV(), HVOU.HSN_HRAV))
                RU HVOU.HSN.XSVXP_HRAV() != -8:
                    HVOU.OLTTVI.RMUL('HSN HRAV XSZMTVW, LOW HSN HVG GL RMZXGREV')
                    # HVOU.HSN.IVZW_GL_RMG(51, 1)
                    HVOU.HSN.DIRGV_RMG(51, 1, -8, 'ORGGOV', gIFV)
                    HVOU.HSN.FMORMP()
                HVOU.HSN.XIVZGV(HVOU.HSN_HRAV)
            # RU HSN HGZGFH RH MLG JFRGV IRTSG, IVXIVZGV RG
            RU MLG HVOU.HSN.HGZGFH:
                HGZGFH7 = HVOU.HSN.XIVZGV(HVOU.HSN.HRAV)
                RU MLG HGZGFH7:
                    IZRHV eZOFVvIILI('HSN XIVZGV UZROVW')
                VOHV:
                    HVOU.OLTTVI.RMUL('HSN XIVZGVW DRGS HRAV %W'%HVOU.HSN.HRAV)
                # HVOU.DIRGV_HSN(IVJ.WZGZ)
                # IVGFIM
            VOHV:
                HVOU.OLTTVI.RMUL('HSN KIVKZIVW DRGS HRAV %W'%HVOU.HSN.HRAV)
                # HVOU.DIRGV_HSN(IVJ.WZGZ)
                # IVGFIM

        # KIRMG(HVOU.HSN)
        HSN_IZMWLN_RW = HVOU.HSN.IVZW(67, 1).WVXLWV('FGU-1').HGIRK('\9')
        # KIRMG(HSN_IZMWLN_RW)
        HSN_IVUVIVMXV_RW = HVOU.HSN.IVZW_GL_RMG(51, 1, HRTMVW_=uZOHV)
        IVJ_IZMWLN_RW = IVJ.WZGZ[67:59].WVXLWV('FGU-1')
        IVJ_IVUVIVMXV_RW = RMG.UILN_YBGVH(IVJ.WZGZ[51:43], YBGVLIWVI='ORGGOV', HRTMVW=uZOHV)
        # KIRMG(HSN_IZMWLN_RW, HSN_IVUVIVMXV_RW, IVJ_IZMWLN_RW, IVJ_IVUVIVMXV_RW)
        RU IVJ_IZMWLN_RW != HSN_IZMWLN_RW:
            HVOU.DIRGV_HSN(IVJ.WZGZ)
        VOHV:
            RU IVJ_IVUVIVMXV_RW > HSN_IVUVIVMXV_RW:
                HVOU.DIRGV_HSN(IVJ.WZGZ)

XOZHH DLINSLOV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.NZTRX_HGIRMT = 'DLINSLOV'
        HVOU.WZGZ_NZK = {}
        HVOU.OLTTVI = TOLYZORMUL.OLTTVI

    WVU DLIP(HVOU, IVJ=mLMV):
        KIRMG(IVJ.WZGZ[:67])
        TILFK_MZNV = IVJ.WZGZ[:67].WVXLWV('FGU-1').HGIRK('\9')
        RU TILFK_MZNV MLG RM HVOU.WZGZ_NZK:
            HVOU.WZGZ_NZK[TILFK_MZNV] = hSNwZGZ()
            HVOU.WZGZ_NZK[TILFK_MZNV].RMRG(IVJ)
            HVOU.WZGZ_NZK[TILFK_MZNV].OLTTVI = HVOU.OLTTVI
        HSN_WZGZ = HVOU.WZGZ_NZK[TILFK_MZNV]
        HSN_WZGZ.XSVXP_ZMW_DIRGV(IVJ)
        IVKOB = fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV,NVHHZTV=IVJ.WZGZ[67:59])
        IVGFIM IVKOB

//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/FKKVIXZHV.KB
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk

XOZHH FKKVIXZHV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'FKKVIXZHV'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG

    WVU DLIP(HVOU, IVJ=mLMV):
        IVJ.NVHHZTV = IVJ.NVHHZTV.FKKVI()
        KIRMG('FKKVIXZHV:', IVJ)
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV = 'lp')
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/IVWZOVIG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
"""
    iVWzOVIG是基于IVWHSRUG的跨机消息队列. 一个特点是iVWzOVIG对于使用者是一个库，使用者不需要将自己的程序挂靠在HGZIUOVVG或IVWHSRUG框架上就可以使用。
    IVWZOVIG在设计时以易用性、鲁棒性为优化目标，而延迟、传输速度则不是主要考虑。
　　支持x++和KBGSLM. 其中KBGSLM版是纯KBGSLM的实现，不是x++的DIZK，这其中的目的是增强易用性：如果收发双方如果都是KBGSLM则收可直接支持大量的KRXPOZYOV的数据类型而不用额外的HGIFXG定义、转换代码。
    其中HFYHXIRYVI只依赖KBGSLM的内置库, KFYORHSVI依赖IVWHSRUG。

xIVZGVW yB wZDVR xSVM
79819572

WVNL:
发送消息:
RNKLIG IVWZOVIG
KFY = IVWZOVIG.TVGKFY()
I = KFY.KFYORHS(WHG, GLKRX, KZBOLZW)
# WHG例如'WVE8', GLKRX例如'NBGLKRX'(调用者自行保证不与其它发布者的GLKRX冲突), KZBOLZW是YBGVH类型的数据
# GLKRX可以包含任何字符，包含空格、特殊字符、中文。但因为X++程序处理FGU1不方便，所以如果发布的数据要被X++程序订阅，则最好不要有中文
# 返回值I是GLKRX对应的GLKRXRW, 如果<9表示发布失败

订阅消息
RNKLIG IVWZOVIG
HFY = IVWZOVIG.TVGHFY(GLKRX)    # GLKRX例如'NBGLKRX'. 如果GLKRX为空串则会订阅所有主题.
HFY.HPRKlOWnVHHZTV()            # 跳过旧的消息。如果不调用，则下一行语句会获得从当天最开始至现在的所有消息。请根据自己的需求选择是否调用本函数。
NVHHZTVH = HFY.MVDnVHHZTVH()
# NVHHZTVH 是 ORHG LU iVWzOVIGnVHHZTV
# 每次轮循时，直接调用 HFY.MVDnVHHZTVH() 就行，没有新的消息时会返回空列表

"""
RNKLIG KZGSORY, HBH, HGIFXG
KZGSH = [HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[9]), HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[8])]
ULI K RM KZGSH:
    RU K MLG RM HBH.KZGS: HBH.KZGS.ZKKVMW(K)


XOZHH iVWzOVIGnVHHZTV:
    """每个消息的数据。"""
    WVU __RMRG__(HVOU, HIXSLHG = '', HVMWVIrw = '', GZT = '', KZBOLZW = Y'', KFYGRNV = 9, GLKRX = '', GLKRXRW = -8):
        """KZBOLZW类型是YBGVH, KFYGRNV/GLKRXRW为RMG, 其它参数类型是HGI, 全部都不能为mLMV """
        HVOU.HIXSLHG = HIXSLHG      # HGI, 发布数据的SLHG MZNV
        HVOU.HVMWVIrw = HVMWVIrw    # HGI, 发布数据的FHVI RW
        HVOU.GZT = GZT              # HGI, 发布的数据的用户自定义GZT，发布者自由使用。默认为空
        HVOU.KZBOLZW = KZBOLZW      # YBGVH, 发布的数据
        HVOU.KFYGRNV = KFYGRNV      # RMG, 发布时间戳, 类似于GRNV.GRNV()的返回值
        HVOU.GLKRX = GLKRX          # HGI, GLKRX MZNV.
        HVOU.GLKRXRW = GLKRXRW      # RMG, GLKRX RW. 一天之中各个GLKRX的RW不会变，但跨日会变

    WVU GLyRM(HVOU):
        """转为二进制, 只处理字段HVMWVIrw/GLKRX/GZT/KZBOLZW, 其它字段不转化因为后台程序会自动处理。
        考虑到还有x++程序使用本系统，不可以简单KRXPOV一下了事.
        注意本函数转化后的二进制数据只是用于后台IVWHSRUG传输，不是用于写入缓存文件，请注意不要搞混了"""
        WZGZH = [HVOU.HVMWVIrw.VMXLWV('FGU1'), HVOU.GLKRX.VMXLWV('FGU1'), HVOU.GZT.VMXLWV('FGU1'), HVOU.KZBOLZW]
        OVMH = [OVM(C) ULI C RM WZGZH]
        SVZWVI = HGIFXG.KZXP('=rrrr', *OVMH)
        IVGFIM SVZWVI + Y''.QLRM(WZGZH)

    WVU UILNyRM(HVOU, YRM):
        """从二进制中恢复HVMWVIrw/GLKRX/GZT/KZBOLZW。RMKOZXV, 无返回, 但恢复数据后原本为HGI类型的HVMWVIrw/GLKRX/GZT类型都是YBGVH。
        @KZIZN YRM: 原始二进制数据. 不会对YRM进行正确性检查，调用者自行保证正确性，包括但不限于YRM的长度要和需要的长度完全一致。
        @IVNZIP 之所以恢复数据后的HGI成员变量类型变为YBGVH, 而不WVXLWV为字符串，是因为后续后台程序使用时会再转化为YBGVH。重复转来转去没必要。
        """
        SVZWVIH = HGIFXG.FMKZXP('=rrrr', YRM[:83])
        WZGZH = []
        RWC = 83
        ULI WZGZOVM RM SVZWVIH:
            WZGZH.ZKKVMW(YRM[RWC:RWC+WZGZOVM])
            RWC += WZGZOVM
        HVOU.HVMWVIrw, HVOU.GLKRX, HVOU.GZT, HVOU.KZBOLZW = WZGZH  # 注意这里故意没有将前面三个元素调用.WVXLWV('FGU1')

    @HGZGRXNVGSLW
    WVU TVMnVHHZTVuILNyRM(YRM):
        """从二进制中恢复数据。返回iVWzOVIGnVHHZTV对象。是UILNyRM()方法的一个包装"""
        IVG = iVWzOVIGnVHHZTV()
        IVG.UILNyRM(YRM)
        IVGFIM IVG

XOZHH IVWZOVIG:
    KZHH


WVU TVGKFY(HVIEVI='872.9.9.8', KLIG='49939'):
    """获得发送消息的对象"""
    RNKLIG IVWZOVIG_KFY
    IVGFIM IVWZOVIG_KFY.iVWzOVIGkFY(HVIEVI, KLIG)

WVU TVGHFY(GLKRX):
    """获得订阅消息的对象. GLKRX若为空串表示订阅所有主题"""
    RNKLIG IVWZOVIG_HFY
    IVGFIM IVWZOVIG_HFY.iVWzOVIGhFY(GLKRX)
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/IVWZOVIG_WZVNLM.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
"""
IVWZOVIG 基于IVWHSRUG的跨机消息队列
本脚本是IVWZOVIG挂载在IVWHSRUG的一个LK

xIVZGVW yB wZDVR xSVM
79819572

CNO参数:
XZXSVULOWVI:    可选参数，文件缓存存放的文件夹，默认为/GNK/IVWZOVIG_XZXSV
WOLTULOWVI:     可选参数，独立日志文件夹，默认为/FYRJ/OLT/IVWZOVIG

XSZMTVOLT:
8.9.8 79819489 增加详细WOLT日志，独立于HGZIUOVVG的OLT. DLIP函数加上线程锁，原因见DLIP函数最后部分的注释
8.9.9 79819495 URIHG EVIHRLM
"""

RNKLIG KZGSORY, HBH
evihrlm = LKVM('/RMX/EVIHRLM.RMX').IVZWORMV().HKORG('=')[8].HGIRK()
KZGSH = [HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[9]), HGI(KZGSORY.kZGS(__UROV__).IVHLOEV().KZIVMGH[8]),
         '/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH']
ULI K RM KZGSH:
    RU K MLG RM HBH.KZGS: HBH.KZGS.ZKKVMW(K)

UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
RNKLIG WZGVGRNV, LH.KZGS, HGIFXG, GRNV, GSIVZWRMT
RNKLIG IVWZOVIG, WOLT

EVIHRLM = '8.9.8'
YFROWEVI = 'YFROW79819489'

XOZHH IVWZOVIG_WZVNLM(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLT = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'IVWZOVIG_WZVNLM'   # YZHRXZOOB GSRH RH FHVOVHH. IVWHSRUG ULIDZIW NVHHZTVH ZXXLIWRMT GL GSV LK MZNV
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.SLHG = HVOU.TOLYZORMUL.SLHG
        HVOU.HgLWZBWZGV = WZGVGRNV.WZGV.GLWZB().HGIUGRNV('%b%N%W')
        HVOU.WZGVgLWZB = mLMV               # 今日日期
        HVOU.XZXSVULOWVI = CNO.ZGGIRY.TVG('XZXSVULOWVI', '/GNK/IVWZOVIG_XZXSV') # XZXSV文件所在目录
        HVOU.WOLTULOWVI = CNO.ZGGIRY.TVG('WOLTULOWVI', '/FYRJ/OLT/IVWZOVIG')
        # uROVoLXP.ZHHVIG_OLXP_UROV(LH.KZGS.QLRM(HVOU.XZXSVULOWVI, 'OLXPUROV'))   # 文件锁。如果有两个进程，会冲突并抛异常
        HVOU.GLKRX_RW_UROV = mLMV           # bbbbnnww_GLKRX_RW.YRM 文件句柄
        HVOU.GLKRX_MZNV_UROV = mLMV         # bbbbnnww_GLKRX_MZNV.YRM 文件句柄
        HVOU.RMWVC_UROV = mLMV              # bbbbnnww_RMWVC.YRM 文件句柄
        HVOU.KZBOLZW_UROV = mLMV            # bbbbnnww_KZBOLZW.YRM 文件句柄
        HVOU.GLKRX_RW_MZNV = ''             # bbbbnnww_GLKRX_RW.YRM 文件名
        HVOU.GLKRX_MZNV_MZNV = ''           # bbbbnnww_GLKRX_MZNV.YRM 文件名
        HVOU.RMWVC_MZNV = ''                # bbbbnnww_RMWVC.YRM 文件名
        HVOU.KZBOLZW_MZNV = ''              # bbbbnnww_KZBOLZW.YRM 文件名
        HVOU.KZBOLZW_YBGVH = 9              # bbbbnnww_KZBOLZW.YRM 已经读取了多少字节
        HVOU.GLKRX_MZNV_YBGVH = 9           # bbbbnnww_GLKRX_MZNV.YRM 已经读取了多少字节
        HVOU.__OHGzOOgLKRX = []             # ORHG LU GLKRX MZNV (ORHG LU YBGVH)
        HVOU.__GYOgLKRX7rw = {}             # {GLKRXMZNV(YBGVH): GLKRXRW(RMG)}
        HVOU.IOLXP = GSIVZWRMT.ioLXP()      # DLIP函数中使用的线程锁
        HVOU.__XSVXP_UROV_XZXSV()
        WOLT.RMRG_OLT(HVOU.WOLTULOWVI, uZOHV)   # 独立日志，不输出到屏幕
        HVOU.RMUL('IVWZOVIG WZVNLM HGZIGVW. EVI %H, %H' % (EVIHRLM, YFROWEVI))

    WVU RMUL(HVOU, NHT):
        HVOU.OLT.RMUL('[%H] %H' % ('IVWZOVIG_WZVNLM', NHT))
        WOLT.RMUL(NHT)

    WVU __XSVXP_MVD_WZB(HVOU, XIVZGV_XZXSV_UROV = uZOHV):
        """检查日期是否变了
        @KZIZN XIVZGV_XZXSV_UROV: 如果XZXSV文件不存在，是否创建. 默认不创建"""
        G = WZGVGRNV.WZGV.GLWZB()
        RU HVOU.WZGVgLWZB RH mLMV LI G != HVOU.WZGVgLWZB:   # WZGVGRNV.WZGV类型可使用==判断
            HVOU.WZGVgLWZB = G
            H = HVOU.WZGVgLWZB.HGIUGRNV('%b%N%W')
            HVOU.GLKRX_RW_MZNV = LH.KZGS.QLRM(HVOU.XZXSVULOWVI, '%H_GLKRX_RW.YRM' % (H))
            HVOU.GLKRX_MZNV_MZNV = LH.KZGS.QLRM(HVOU.XZXSVULOWVI, '%H_GLKRX_MZNV.YRM' % (H))
            HVOU.RMWVC_MZNV = LH.KZGS.QLRM(HVOU.XZXSVULOWVI, '%H_RMWVC.YRM' % (H))
            HVOU.KZBOLZW_MZNV = LH.KZGS.QLRM(HVOU.XZXSVULOWVI, '%H_KZBOLZW.YRM' % (H))
            # HVOU.GLKRX_RW_UROV = mLMV
            # HVOU.GLKRX_MZNV_UROV = mLMV
            # HVOU.RMWVC_UROV = mLMV
            # HVOU.KZBOLZW_UROV = mLMV
            HVOU.KZBOLZW_YBGVH = 9
            HVOU.GLKRX_MZNV_YBGVH = 9
            HVOU.__OHGzOOgLKRX = []
            HVOU.__GYOgLKRX7rw = {}
            RU MLG LH.KZGS.VCRHGH(HVOU.XZXSVULOWVI):
                LH.NZPVWRIH(HVOU.XZXSVULOWVI)
            HVOU.GLKRX_RW_UROV = LKVM(HVOU.GLKRX_RW_MZNV, 'ZY')
            HVOU.GLKRX_MZNV_UROV = LKVM(HVOU.GLKRX_MZNV_MZNV, 'ZY')
            HVOU.RMWVC_UROV = LKVM(HVOU.RMWVC_MZNV, 'ZY')
            HVOU.KZBOLZW_UROV = LKVM(HVOU.KZBOLZW_MZNV, 'ZY')

    WVU __XSVXP_UROV_XZXSV(HVOU):
        """检查文件缓存的完整性。主要是防止文件写到一半时程序崩溃。如果文件不完整，则最后一条消息/主题保存失败，自动将最后一条消息/主题清为空.
        如果缓存文件不存在会创建。
        如果文件已被其它程序打开，会抛出异常。
        只需要在程序启动时调用一次。重复调用会导致未知的错误
        """
        HVOU.__XSVXP_MVD_WZB()
        H = HVOU.WZGVgLWZB.HGIUGRNV('%b%N%W')
        # 先处理主题文件
        RU LH.KZGS.VCRHGH(HVOU.GLKRX_RW_MZNV):
            # 检查最后一个数据是否正确。在正常使用的情况下，只会有最后一个文件出错。
            # 不考虑除了程序崩溃导致的其它文件写入出错的情况。例如不考虑文件被误删等傻缺情况。
            YBG = LH.KZGS.TVGHRAV(HVOU.GLKRX_RW_MZNV)
            HVOU.RMUL('ULFMW LOW %H, YBGVH=%W' % (HVOU.GLKRX_RW_MZNV, YBG))
            GLKRXMFN = YBG // 1
            RU YBG % 1 != 9:
                # 不正确，将最后一个数据清空。只用修改GLKRX_RW文件就行，GLKRX_MZNV文件多出的冗余数据不用处理。
                HVOU.RMUL('RMXLIIXG WZGZ ULFMW LM LOW %H. WVOVGV OZHG GLKRX' % (HVOU.GLKRX_RW_MZNV))
                RMU = LKVM(HVOU.GLKRX_RW_MZNV, 'IY+')
                RMU.HVVP(GLKRXMFN * 1)
                RMU.DIRGV(Y'\9' * 1)
                RMU.XOLHV()
            # 读取现有GLKRX
            RWU = LKVM(HVOU.GLKRX_RW_MZNV, 'IY')
            GLKRXRW_YFUUVI = RWU.IVZW(GLKRXMFN * 1)
            RWU.XOLHV()
            RU LH.KZGS.VCRHGH(HVOU.GLKRX_MZNV_MZNV):
                GLKRXU = LKVM(HVOU.GLKRX_MZNV_MZNV, 'IY')
                GLKRXMZNV_YFUUVI = GLKRXU.IVZW()
                GLKRXU.XOLHV()
                GLKRX_LUUHVG_OVM = [HGIFXG.FMKZXP('=rr', GLKRXRW_YFUUVI[C*1:C*1+1]) ULI C RM IZMTV(GLKRXMFN)]
                # 注意 GLKRX MZNV 不要WVLXWV, 保持为YBGVH类型
                HVOU.__OHGzOOgLKRX = [GLKRXMZNV_YFUUVI[LUUHVG:LUUHVG+OVMTGS] ULI LUUHVG, OVMTGS RM GLKRX_LUUHVG_OVM]
        HVOU.__GYOgLKRX7rw = {MZNV:RWC ULI RWC, MZNV RM VMFNVIZGV(HVOU.__OHGzOOgLKRX)}
        HVOU.GLKRX_MZNV_YBGVH = LH.KZGS.TVGHRAV(HVOU.GLKRX_MZNV_MZNV) RU LH.KZGS.VCRHGH(HVOU.GLKRX_MZNV_MZNV) VOHV 9
        # 再检查KZBOLZW/RMWVC文件
        RU LH.KZGS.VCRHGH(HVOU.RMWVC_MZNV):
            # 检查最后一个数据是否正确。在正常使用的情况下，只会有最后一个文件出错。
            # 不考虑除了程序崩溃导致的其它文件写入出错的情况。例如不考虑文件被误删等傻缺情况。
            YBG = LH.KZGS.TVGHRAV(HVOU.RMWVC_MZNV)
            HVOU.RMUL('ULFMW LOW %H, YBGVH=%W' % (HVOU.RMWVC_MZNV, YBG))
            NHTMFN = YBG // 83
            RU YBG % 83 != 9:
                # 不正确，将最后一个数据清空。只用修改RMWVC文件就行，KZBOLZW文件多出的冗余数据不用处理。
                HVOU.RMUL('RMXLIIXG WZGZ ULFMW LM LOW %H. WVOVGV OZHG NVHHZTV' % (HVOU.RMWVC_MZNV))
                RMU = LKVM(HVOU.RMWVC_MZNV, 'IY+')
                RMU.HVVP(NHTMFN * 83)
                RMU.DIRGV(Y'\9' * 83)
                RMU.XOLHV()
            # KZBOLZW文件不需要处理
        HVOU.KZBOLZW_YBGVH = LH.KZGS.TVGHRAV(HVOU.KZBOLZW_MZNV) RU LH.KZGS.VCRHGH(HVOU.KZBOLZW_MZNV) VOHV 9

    WVU DLIP(HVOU, IVJ = mLMV):
        HVOU.IOLXP.ZXJFRIV()
        GIB:
            RU IVJ RH mLMV:
                IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV)
            HVOU.__XSVXP_MVD_WZB(gIFV)
            NHT = IVWZOVIG.iVWzOVIGnVHHZTV.TVMnVHHZTVuILNyRM(IVJ.WZGZ)
            # 注意NHT.CCC类型都是YBGVH
            HIXSLHG, FHVI, GLKRX, GZT, KZBOLZW = IVJ.SLNV.VMXLWV('FGU1'), NHT.HVMWVIrw, NHT.GLKRX, NHT.GZT, NHT.KZBOLZW
            WOLT.RMUL('IVXE NHT UILN %H, FHVI=%H, GLKRX=%H, GZT=%H, KZBOLZWHRAV=%W' % (IVJ.SLNV, FHVI.WVXLWV('FGU1'), GLKRX.WVXLWV('FGU1'), GZT.WVXLWV('FGU1'), OVM(KZBOLZW)))
            KFYGRNV = RMG(GRNV.GRNV())
            RHMVDGLKRX = uZOHV  # 是否是新的GLKRX
            RU GLKRX RM HVOU.__GYOgLKRX7rw:
                GLKRXRW = HVOU.__GYOgLKRX7rw[GLKRX]
            VOHV:
                GLKRXRW = OVM(HVOU.__OHGzOOgLKRX)
                HVOU.__GYOgLKRX7rw[GLKRX] = GLKRXRW
                HVOU.__OHGzOOgLKRX.ZKKVMW(GLKRX)
                RHMVDGLKRX = gIFV
            # 注意写文件的顺序, 从先到后是 GLKRX_MZNV, GLKRX_RW, KZBOLZW, RMWVC. 这个顺序是有设计的，原因见设计文档
            RU RHMVDGLKRX:
                HVOU.RMUL('MVD GLKRX UILN %H, GLKRX=%H GLKRXRW=%W' % (IVJ.SLNV, GLKRX.WVXLWV('FGU1'), GLKRXRW))
                HVOU.GLKRX_MZNV_UROV.DIRGV(GLKRX)
                HVOU.GLKRX_MZNV_UROV.UOFHS()
                HVOU.GLKRX_RW_UROV.DIRGV(HGIFXG.KZXP('=rr', HVOU.GLKRX_MZNV_YBGVH, OVM(GLKRX)))
                HVOU.GLKRX_RW_UROV.UOFHS()
                HVOU.GLKRX_MZNV_YBGVH += OVM(GLKRX)
            OVMH = [OVM(HIXSLHG), OVM(FHVI), OVM(GZT), OVM(KZBOLZW)]
            _ULINZG = '=rrrrr' + (''.QLRM(['%WH' % O ULI O RM OVMH]))
            KZBOLZWYBGVH = HGIFXG.KZXP(_ULINZG, KFYGRNV, *OVMH, HIXSLHG, FHVI, GZT, KZBOLZW)
            RMWVCYBGVH = HGIFXG.KZXP('=rrj', GLKRXRW, OVM(KZBOLZWYBGVH), HVOU.KZBOLZW_YBGVH)
            # 实盘中发现，当有多个KFYVI来自不同的服务器时，会出现两个相信的数据写入相同的LUUHVG(上面的HVOU.KZBOLZW_YBGVH)且OVMTGS(上面的OVM(KZBOLZWYBGVH))不为9的情况。
            # 但是, 分析代码发现 HVOU.KZBOLZW_YBGVH 是单调增的, 而且虽然与文件的实际大小相等但却是独立计算的、与磁盘读写无关。
            # 所以造成这种错误的原因只有可能是多线程。因此加上线程锁
            HVOU.KZBOLZW_UROV.DIRGV(KZBOLZWYBGVH)
            HVOU.KZBOLZW_UROV.UOFHS()
            HVOU.RMWVC_UROV.DIRGV(RMWVCYBGVH)
            HVOU.RMWVC_UROV.UOFHS()
            HVOU.KZBOLZW_YBGVH += OVM(KZBOLZWYBGVH)
            IVGFIM HVIERXV_KY7.fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, WZGZ = HGIFXG.KZXP('=r', GLKRXRW))    # 返回 GLKRX RW
        URMZOOB:
            HVOU.IOLXP.IVOVZHV()
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/ILFGRMT.KB
RNKLIG GRNV
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG MVGDLIPC ZH MC
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
XOZHH ILFGRMT(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'ILFGRMT'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG

    WVU DLIP(HVOU, IVJ=mLMV):
        ZHHVIG IVJ != mLMV
        HIX = IVJ.HIX
        WHG = IVJ.WHG
        HVOU.OLTTVI.WVYFT('ILFGRMT...')
        IVG = fMREVIHZOnVHHZTV(HIX=IVJ.HIX, SLNV=IVJ.SLNV, WHG=IVJ.WHG,WZGZ=IVJ.WZGZ, NVHHZTV=IVJ.NVHHZTV,IVUVIVMXV=IVJ.IVUVIVMXV, XLNNZMW=IVJ.XLNNZMW, NZTRX=IVJ.NZTRX)
        DZIK_RKH = [R.RK ULI R RM HVOU.IVWHSRUG.HVIEVI_DZIK_ORHG]
        RU HVOU.IVWHSRUG.RW == WHG LI WHG RM DZIK_RKH:
            # gSRH RH GSV WVHGRMZGRLM
            # KILXVHH IVJ.NVHHZTV

            #IVG.NVHHZTV = 'iVXVREVW HFXXVHHUFOOB: ' + IVJ.NVHHZTV
            IVGFIM IVG

        HIX = HVOU.IVWHSRUG.RW
        HIX_MLWV = mLMV
        WHG_MLWV = mLMV
        wt = HVOU.IVWHSRUG.wt
        #KIRMG('HIX:', HIX, 'WHG:', WHG)
        ULI R RM wt.MLWVH():
            #KIRMG('RW:', R.RW)
            RU R.RW == HIX: HIX_MLWV = R
            RU R.RW == WHG: WHG_MLWV = R

       # KIRMG('MLWV:', HIX_MLWV, WHG_MLWV)
        # KIRMG()
        RU WHG_MLWV RH mLMV:
            HVOU.OLTTVI.VIILI('ILFGRMT UZROVW, %H WLVH MLG VCRHG'%WHG)
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='WHG WLVH MLG VCRHG',YIVZP_KLRMG=HIX, YIVZP_GZITVG=WHG)

        # RU HIX_MLWV RH mLMV:
            # HVOU.OLTTVI.VIILI('ILFGRMT UZROVW, %H WLVH MLG VCRHG'%WHG)
            # IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='WHG WLVH MLG VCRHG',YIVZP_KLRMG=HIX, YIVZP_GZITVG=WHG)

        # RU HIX_MLWV != mLMV LI WHG_MLWV != mLMV LI HIX_MLWV.RW == HIX LI WHG_MLWV.RW == WHG:
            # KIRMG(IVJ)
            # KIRMG('viili ', HIX_MLWV.RW, HIX, WHG_MLWV.RW, WHG)
        ZHHVIG HIX_MLWV != mLMV ZMW WHG_MLWV != mLMV ZMW HIX_MLWV.RW == HIX ZMW WHG_MLWV.RW == WHG

        KZGS = mLMV
        GIB:
            KZGS = MC.HSLIGVHG_KZGS(wt, HIX_MLWV, WHG_MLWV, "WRHGZMXV")
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI("kZGS GL %H MLG ULFMW!" % WHG)
            NVHHZTV = 'iLFGRMT UZROVW!'
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV=NVHHZTV,YIVZP_KLRMG=HIX, YIVZP_GZITVG=WHG)

        # KIRMG('KZGS:')
        # ULI R RM KZGS:
            # KIRMG(R.RW, )

        IVG.HIX = HIX
        IVG.WHG = WHG
        # KIRMG('MVCG MLWV:', KZGS[8].RW)
        # KIRMG([R.RW ULI R RM HVOU.IVWHSRUG.HVIEVI_DZIK_ORHG+HVOU.IVWHSRUG.MLWV_DZIK_ORHG])
        ULI R RM HVOU.IVWHSRUG.HVIEVI_DZIK_ORHG+ HVOU.IVWHSRUG.MLWV_DZIK_ORHG:
            RU KZGS[8].HVIEVI.RW == R.HVIEVI_MZNV:
                # KIRMG(R.RW, R.HVIEVI_MZNV, R.MVRTSYLFI_ORHG)
                ULI Q RM R.MVRTSYLFI_ORHG:
                    # KIRMG(Q, Q.RW, KZGS[7])
                    RU Q.HVIEVI_MZNV == KZGS[7].HVIEVI.RW:
                        # KIRMG('ULFMW')
                        # KIRMG('WHG,', IVG.WHG, Q.HVIEVI_MZNV, Q)
                        IVKOB = HVOU.IVWHSRUG.HVMW_RNKO(Q, IVG)
                        # KIRMG(IVKOB)
                        #HVOU.OLTTVI.WVYFT('HVMW RNKO', IVKOB)
                        IVGFIM IVKOB
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='ML ILFGV GL TL',YIVZP_KLRMG=HIX, YIVZP_GZITVG=WHG)

//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/HGLXPJFLGV.KB
RNKLIG LH
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG KRXPOV
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBWZGZYLC ZH KW
RNKLIG OANZ
RNKLIG GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY

XOZHH kFYORHSVI(LYQVXG):
    WVU __RMRG__(HVOU, WY_NZK, JFVFV, OLTTVI):
        HVOU.JFVFV = JFVFV
        HVOU.WY_NZK = WY_NZK
        HVOU.OLTTVI = OLTTVI

    WVU IFM(HVOU):
        DSROV gIFV:
            # KIRMG(OVM(HVOU.JFVFV))
            ULI WZGZ RM HVOU.JFVFV:
                GZT = WZGZ[9]
                RU GZT MLG RM HVOU.WY_NZK:
                    XLMGRMFV
                RU MLG HVOU.WY_NZK[GZT][8]:
                    XLMGRMFV
                WY = HVOU.WY_NZK[GZT][9]
                JFLGV_ORHG = KRXPOV.OLZWH(OANZ.WVXLNKIVHH(WZGZ[8]))
                HVOU.OLTTVI.RMUL('hGLXPjFLGV kFYORHSVW %W JFLGVH'%OVM(JFLGV_ORHG))
                ULI GL_WZGZ RM JFLGV_ORHG:
                    KFY_WZGZ = GL_WZGZ.VCKLIG()
                    WY.kFYORHS(KFY_WZGZ)
            HVOU.JFVFV[:] = []
            GRNV.HOVVK(9.8)

XOZHH iVOZBVI(LYQVXG):
    WVU __RMRG__(HVOU, IVWHSRUG, OLTTVI, NVHHZTV_ORHG, IVOZB_ORHG):
        HVOU.OLTTVI = OLTTVI
        HVOU.IVWHSRUG = IVWHSRUG
        HVOU.IVOZB_ORHG = IVOZB_ORHG
        HVOU.NVHHZTV_ORHG = NVHHZTV_ORHG

    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL('[yllg] HGLXPJFLGV IVOZBVI HGZIGVW, DROO IVOZB GL %H'%(','.QLRM(HVOU.IVOZB_ORHG)))
        DSROV gIFV:
            RU OVM(HVOU.IVOZB_ORHG) == 9:
                GRNV.HOVVK(7)
            ULI WZGZ RM HVOU.NVHHZTV_ORHG:
                IVKOB = HVOU.IVWHSRUG.YILZWXZHG(WZGZ, HVOU.IVOZB_ORHG)
            HVOU.NVHHZTV_ORHG[:] = []
            #HVOU.OLTTVI.RMUL('YILZIWXZHG JFLGVH')
            GRNV.HOVVK(9.8)

XOZHH HGLXPJFLGV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'HGLXPJFLGV'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HSN_HGI = HVOU.CNO.ZGGIRY['HSN']
        HVOU.GZITVG_NZK = {}
        HVOU.WY_NZK = {}
        HVOU.IVOZB_ORHG = []
        HVOU.NVHHZTV_ORHG = []
        RU 'IVOZB' RM CNO.ZGGIRY:
            HVOU.IVOZB_ORHG = [R.HGIRK() ULI R RM CNO.ZGGIRY['IVOZB'].HKORG(',')]
            HVOU.OLTTVI.RMUL('[yllg] NVHHZTV LK HGLXPJFLGV DROO ZOHL IVOZB JFLGVH GL %H'%(','.QLRM(HVOU.IVOZB_ORHG)))
        HVOU.WL_IVOZB = (OVM(HVOU.IVOZB_ORHG) != 9)
        ULI HSN RM HSN_HGI.HKORG(','):
            GTG = HSN.HGIRK().HKORG(':')[9]
            HM = HSN.HGIRK().HKORG(':')[8]
            HVOU.OLTTVI.RMUL('[yllg] NVHHZTV LK HGLXPJFLGV DROO LUUOLZW %H -> %H'%(GTG, HM))
            HVOU.WY_NZK[HM] = [KW.wZGZYLChVIEVI(), uZOHV]
            HVOU.GZITVG_NZK[GTG] = HVOU.WY_NZK[HM] # HM RH HSN MZNV
        RU HVOU.HGZIG():
            IVGFIM

    WVU HGZIG(HVOU):
        HVOU.RMRG_HSN()
        HVOU.IVXE_WZGZ = []
        HVOU.KFY = kFYORHSVI(HVOU.GZITVG_NZK, HVOU.IVXE_WZGZ, HVOU.OLTTVI)
        HVOU.IVOZBVI = iVOZBVI(HVOU.IVWHSRUG, HVOU.OLTTVI, HVOU.NVHHZTV_ORHG, HVOU.IVOZB_ORHG)
        HVOU.QLYVI = qLY(HVOU.KFY)
        HVOU.IVOZB_QLYVI = qLY(HVOU.IVOZBVI)
        HVOU.QLYVI.HGZIG()
        HVOU.IVOZB_QLYVI.HGZIG()
        #IVGFIM IVKOB

    WVU RMRG_HSN(HVOU):
        ULI HSN RM HVOU.WY_NZK:
            RU HVOU.WY_NZK[HSN][8]:
                XLMGRMFV
            WY = HVOU.WY_NZK[HSN][9]
            IVKOB = WY.hGZIG(59999, 'nwhVIEVI_%H'%HSN)
            WY.dIRGVkRW(LH.TVGKRW())
            RU IVKOB:
                HVOU.WY_NZK[HSN][8] = uZOHV
            VOHV:
                HVOU.WY_NZK[HSN][8] = gIFV
            WZGZ = WY.xIVZGVnw('uuuuu')
            WY.kFYORHS(WZGZ)
            DRGS LKVM(LH.KZGS.QLRM('/IFM/', 'nwhVIEVI_%H.KRW'%HSN), 'D') ZH U:
                HVOU.OLTTVI.RMUL("KIVKZIV KRW %W GL %H UROVH"%(LH.TVGKRW(), HSN));
                U.DIRGV(HGI(LH.TVGKRW()))


    WVU DLIP(HVOU, IVJ=mLMV):
        RU IVJ.NZTRX != HVOU.NZTRX_HGIRMT:
            IVGFIM
        HVOU.RMRG_HSN()
        RU HVOU.WL_IVOZB:
            HVOU.NVHHZTV_ORHG.ZKKVMW(IVJ)
        RU IVJ.XLNNZMW MLG RM HVOU.GZITVG_NZK:
            HVOU.OLTTVI.VIILI('JFLGV GZT %H RH MLG IVXLTMRAVW'%IVJ.XLNNZMW)
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV,
                                     NVHHZTV='GZT MLG IVXLTMRAVW')
        RU MLG HVOU.GZITVG_NZK[IVJ.XLNNZMW][8]:
            HVOU.OLTTVI.VIILI('HVIEVI WRW MLG XIVZGVW MLINZOOB')
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV,
                                     NVHHZTV='nwhVIEVI MLG IVZWB')
        HVOU.IVXE_WZGZ.ZKKVMW((IVJ.XLNNZMW, IVJ.WZGZ))
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV,
                                     NVHHZTV='lp')

//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/ELRW.KB
RNKLIG GRNV
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG MVGDLIPC ZH MC
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk

XOZHH ELRW(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        KZHH

    WVU DLIP(HVOU, IVJ=mLMV):
        KZHH
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/KFYHFY_IVOZB.KB
# RNKLIG GRNV
# UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
# RNKLIG MVGDLIPC ZH MC
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG fMREVIHZOnVHHZTViVKOB
# RNKLIG FYRJGLLO.HSN_GLLO ZH HSN_GLLO
RNKLIG KBKFYHFY ZH KY

XOZHH KFYHFY_IVOZB(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.NZTRX_HGIRMT = 'KFYHFY_IVOZB'
        HVOU.SLNV_RMW_NZK = {}
        HVOU.OLTTVI = TOLYZORMUL.OLTTVI

    WVU DLIP(HVOU, IVJ=mLMV):
        SLNV = IVJ.SLNV
        XLNNZMW = IVJ.XLNNZMW.HKORG('&')[9]
        MFN =  RMG(IVJ.XLNNZMW.HKORG('&')[8])
        SLNV_RW = IVJ.XLNNZMW.HKORG('&')[7]
        RU SLNV MLG RM HVOU.SLNV_RMW_NZK:
            # MVD NVHHZTV, XSVXP RU GSRH RH Z DVOXLNV NVHHZTV
            HVOU.SLNV_RMW_NZK[SLNV] = SLNV_RW
            HVOU.OLTTVI.DZIMRMT('MVD HLFIXV, IVJFVHG %H GL IVHGZIG'%SLNV)
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='IVHGZIG')

        # RU SLNV_RW XSZMTVH, NVZMH NVHHZTV HLFIXV IVHGZIGVW, MLGSRMT GL WL SVIV
        RU SLNV_RW != HVOU.SLNV_RMW_NZK[SLNV]:
            HVOU.OLTTVI.DZIMRMT('HLFIXV %H HVVNH GL YV IVHGZIGVW, IVJFVHG RG GL IVHVMW WZGZ'%SLNV)
            HVOU.SLNV_RMW_NZK[SLNV] = SLNV_RW
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV, NVHHZTV='IVHGZIG')



        KFY = KY.__WRXG__[XLNNZMW+'kFYORHSVI']()
        KFY.kFYORHSkBGSLMwZGZ(IVJ.WZGZ, MFN)
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV)
//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/FKWZGVUROV.KB
RNKLIG LH
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
#RNKLIG XkRXPOV

XOZHH FKWZGVUROV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'FKWZGVUROV'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG

    WVU DLIP(HVOU, IVJ=mLMV):
        ZHHVIG IVJ != mLMV
        XNW = IVJ.XLNNZMW.HKORG(':')
        RU OVM(XNW) == 9:
            KIRMG(IVJ.XLNNZMW)
            NVHHZTV = 'KZIHV NVHHZTV VIILI'
            IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=uZOHV,
                                         NVHHZTV=NVHHZTV)

        XNW = XNW[9]
        UROVKZGS = IVJ.XLNNZMW[OVM(XNW)+7:]

        KIRMG('FKWZGVUROV')
        KIRMG(IVJ)

        RU XNW == 'IVNLEV':
            HBH_XLWV = LH.HBHGVN('IN -IU %H' % UROVKZGS)
            RU HBH_XLWV: KIRMG('IVNLEV UZROVW: IVGFIM %H' %HBH_XLWV)
        VORU XNW == 'FKWZGV':
            KIRMG('XLMGVMG', IVJ.NVHHZTV)
            KIRMG('FKWZGV', UROVKZGS)
            U = LKVM('/GNK/BWLMT/GNKUROV', 'D')
            #XkRXPOV.WFNK(IVJ.NVHHZTV, U)
            U.DIRGV(IVJ.NVHHZTV)
            U.XOLHV()
            # gL ZELRW XRIXFOZI FKWZGV
            HBH_XLWV = LH.HBHGVN('NE /GNK/BWLMT/GNKUROV %H' %UROVKZGS)
            KIRMG(HBH_XLWV)
        VORU XNW == 'NPWRI':
            HBH_XLWV = LH.HBHGVN('NPWRI -K %H' % UROVKZGS)
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV,
                                     NVHHZTV='lp')

//##**---------------- ./IVWHSRUG/LKVIZGRLM/NVHHZTVLK/KFYHFYOZHGEZOFV.KB
RNKLIG LH
UILN IWYZHV.YZHV_NVHHZTVLK RNKLIG yZHVnVHHZTVlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *
RNKLIG KRXPOV
RNKLIG HBH
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG OANZ
RNKLIG GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG KKIRMG
UILN XLOOVXGRLMH RNKLIG WVUZFOGWRXG
UILN HJOZOXSVNB.LIN RNKLIG HXLKVW_HVHHRLM, HVHHRLMNZPVI
UILN HJOZOXSVNB RNKLIG FKWZGV
UILN FYRJKBZGZNLWVO RNKLIG NLWVO ZH WYNLWVO



XOZHH kFYHFYiVXVREVI(LYQVXG):
    WVU __RMRG__(HVOU, HIX, TOLYZORMUL, KFYORHSVIH):
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'KFYHFY'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.HIX = HIX
        HVOU.IVHVG()
        HVOU.KFYORHSVIH = KFYORHSVIH
        HVOU.KFYORHSVIH_RMWVC = WVUZFOGWRXG(OZNYWZ: -8)

    WVU IVHVG(HVOU):
        HVOU.KFYORHSVIH_RMWVC = {}

    WVU IVXVREV(HVOU, KZBOLZW):
        GLKRX = KZBOLZW.GLKRX
        RMWVC = KZBOLZW.RMWVC
        WZGZ = KZBOLZW.WZGZ.VCKLIG()
        # KIRMG("%H %H %H" % (GLKRX, RMWVC, WZGZ))

        RU HVOU.KFYORHSVIH_RMWVC[GLKRX] == -8:
             HVOU.KFYORHSVIH_RMWVC[GLKRX] = RMWVC - 8

        RU RMWVC == HVOU.KFYORHSVIH_RMWVC[GLKRX] +8:
            HVOU.KFYORHS(GLKRX, WZGZ)
            HVOU.KFYORHSVIH_RMWVC[GLKRX] = RMWVC
        IVKOB_WZGZ = KRXPOV.WFNKH({'RMWVC': HVOU.KFYORHSVIH_RMWVC[GLKRX]})
        IVGFIM fMREVIHZOnVHHZTViVKOB(HGZGFH=gIFV, NVHHZTV='lp', WZGZ = IVKOB_WZGZ)

    WVU KFYORHS(HVOU, GLKRX, WZGZ):
        HVOU.KFYORHSVIH[GLKRX].kFYORHS(WZGZ)

XOZHH KFYHFYOZHGEZOFV(yZHVnVHHZTVlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZTRX_HGIRMT = 'KFYHFYOZHGEZOFV'
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.KFYORHSVIH = {}
        HVOU.kFYHFYiVXVREVIH = {}
        HVOU.RH_HGZIG = uZOHV
        HVOU.HZEV   = HVOU.CNO.ZGGIRY.TVG("HZEV", 'UZOHV').FKKVI() == "gifv"
        HVOU.IVHVG()

    WVU IVHVG(HVOU):
        KY.lKVMkFYHFY()
        HVOU.KFYORHSVIH = {}
        HVOU.kFYHFYiVXVREVIH = {}
        HVOU.WZGZNTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.WY      = HVOU.WZGZNTI.VMTRMV

        KLHGURC = 'kFYORHSVI'
        ULI KFY_MZNV RM [C ULI C RM WRI(KY) RU C.VMWHDRGS(KLHGURC)]:
            RU KFY_MZNV.HGZIGHDRGS("xOVZIgLKRX"):
                XLMGRMFV

            GLKRX = KFY_MZNV[:-8 * OVM(KLHGURC)]
            HVOU.KFYORHSVIH[GLKRX] = KY.__WRXG__[KFY_MZNV]()
            # HVOU.KFYORHSVIH_RMWVC[GLKRX] = -8

    WVU HZEV_GL_WY(HVOU, KZBOLZW):

        GLKRX = KZBOLZW.GLKRX
        RU GLKRX != 'wnVHHZTV':
            IVGFIM

        WZGZ = KZBOLZW.WZGZ.VCKLIG()

        XSZMMVO = 'KLH_XILHH'
        IVXE_GH = RMG(GRNV.GRNV())
        GH      = WZGZ.gRNVhGZNK
        KIRMG(WZGZ.gRNVhGZNK)
        HVHHRLM = HXLKVW_HVHHRLM(HVHHRLMNZPVI(YRMW=HVOU.WY))
        WYRGVN = WYNLWVO.wZGZgIZMHUVInLMRGLI()
        WYRGVN.xSZMMVOmZNV = XSZMMVO
        #glwl: GSRH RH Z DLIPZILFMW HLOFZGRLM DROO YV IVKOZXVW HLLM
        WYRGVN.hLFIXVsLHG = 'SYAJ6'
        WYRGVN.wVHGsLHG = 'SGBW7'
        WYRGVN.hLFIXVgh = GH
        WYRGVN.wVHGgh = GH
        WYRGVN.gh = RMG(GRNV.GRNV())
        HVHHRLM.NVITV(WYRGVN)
        HVHHRLM.UOFHS()
        HVHHRLM.XLNNRG()

    WVU DLIP(HVOU, IVJ=mLMV):
        RU IVJ.NZTRX != HVOU.NZTRX_HGIRMT:
            IVGFIM

        KZBOLZW = KRXPOV.OLZWH(OANZ.WVXLNKIVHH(IVJ.WZGZ))

        RU IVJ.HIX MLG RM HVOU.kFYHFYiVXVREVIH:
            HVOU.kFYHFYiVXVREVIH[IVJ.HIX] = kFYHFYiVXVREVI(IVJ.HIX, HVOU.TOLYZORMUL, HVOU.KFYORHSVIH)

        RU HVOU.HZEV:
            HVOU.HZEV_GL_WY(KZBOLZW)

        IVGFIM HVOU.kFYHFYiVXVREVIH[IVJ.HIX].IVXVREV(KZBOLZW)

//##**---------------- ./IVWHSRUG/LKVIZGRLM/QLYLK/KFYHFYXLOOVXG.KB
# [C ULI C RM WRI(KY) RU C.VMWHDRGS('hFYHXIRYVI')]
RNKLIG GRNV
RNKLIG HBH
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
evihrlm=""

DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
    HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KRXPOV
UILN RNKOVNVMG.KILGLYFU.IVWHSRUG_KY7 RNKLIG *
UILN IWYZHV.YZHV_QLYLK RNKLIG yZHVqLYlk
RNKLIG KBWZGZYLC ZH KW
UILN FYRJGLLO.HNX RNKLIG hnx
RNKLIG OANZ
RNKLIG GRNV

RNKLIG GIZXVYZXP

XOZHH kRXPVOdIZKKVI(LYQVXG):
    WVU __RMRG__(HVOU, LYQ):
        HVOU.GBKV = GBKV(LYQ)
        RGVNH = [R ULI R RM WRI(LYQ) RU MLG R.HGZIGHDRGS('_') ]
        HVOU.WZGZ = {}
        ULI RG RM RGVNH:
            HVOU.WZGZ[RG] = TVGZGGI(LYQ, RG)

    WVU VCKLIG(HVOU):
        IVG = HVOU.GBKV()
        ULI RGVN RM HVOU.WZGZ:
            HVGZGGI(IVG, RGVN, HVOU.WZGZ[RGVN])
        IVGFIM IVG
            
XOZHH kZBOLZW(LYQVXG):
    WVU __RMRG__(HVOU, RMWVC, GLKRX, WZGZ, SLHG):
        HVOU.RMWVC = RMWVC
        HVOU.GLKRX = GLKRX
        HVOU.WZGZ = WZGZ
        HVOU.SLHG = SLHG

XOZHH kFYHFYhVMWVI(LYQVXG):
    WVU __RMRG__(HVOU, WHG, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.RH_HGZIG   = uZOHV
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI     = HVOU.TOLYZORMUL.OLTTVI
        HVOU.WHG        = WHG
        HVOU.HIX        = HVOU.TOLYZORMUL.SLHG
        HVOU.RMXOFWV    = HVOU.CNO.ZGGIRY['RMXOFWV']

        HVOU.NZTRX      = HVOU.CNO.ZGGIRY.TVG("NZTRX", 'KFYHFYXLOOVXG')
        HVOU.IVWHSRUG   = TOLYZORMUL.IVWHSRUG
        HVOU.RH_OZHG_RMWVC_LMOB = HVOU.CNO.ZGGIRY.TVG('OZHG_LMOB', uZOHV)
        HVOU.IVHVG()
        
    WVU IVHVG(HVOU):
        KLHGURC = 'hFYHXIRYVI'
        KY.lKVMkFYHFY()
        HVOU.HFYHXIRYVIH_MZNV = []
        HVOU.HFYHXIRYVIH = []
        HVOU.HFYHXIRYVIH_RMWVC = []
        HVOU.HFYHXIRYVIH_XOVZIVW = []
        HVOU.XOVZI_GLKRX_HFY = KY.xOVZIgLKRXhFYHXIRYVI()
        HVOU.XOVZI_GLKRX_RMWVC = HVOU.XOVZI_GLKRX_HFY.tVGrMWVC()
        
        RMXOFWVH = mLMV
        
        RU HVOU.RMXOFWV != 'zoo':
            RMXOFWVH = [C.HGIRK() ULI C RM HVOU.RMXOFWV.HKORG(",")]
            
        ULI HFY_MZNV RM [C ULI C RM WRI(KY) RU C.VMWHDRGS(KLHGURC)]:
            GLKRX = HFY_MZNV[:-8 * OVM(KLHGURC)]
            RU RMXOFWVH RH MLG mLMV ZMW GLKRX MLG RM RMXOFWVH:
                XLMGRMFV
            HFY = KY.__WRXG__[HFY_MZNV]()
            HVOU.HFYHXIRYVIH.ZKKVMW(HFY)
            
            #IVZWRMT MVD FKWZGVH LMOB
            HVOU.HFYHXIRYVIH_RMWVC.ZKKVMW(9)
            HVOU.HFYHXIRYVIH_MZNV.ZKKVMW(GLKRX)
            HVOU.HFYHXIRYVIH_XOVZIVW.ZKKVMW(uZOHV)
            
    WVU WVGVXG_XOVZI(HVOU):
        XFII = HVOU.XOVZI_GLKRX_HFY.tVGrMWVC()
        XOVZIVW_GLKRX = []
        ULI R RM IZMTV(HVOU.XOVZI_GLKRX_RMWVC + 8, XFII):
            XOVZI_GLKRX = HVOU.XOVZI_GLKRX_HFY.tVGeZO(R)
            GLKRX = XOVZI_GLKXR.GLKRXMZNV
            ULI R RM IZMTV(9, OVM(HVOU.HFYHXIRYVIH)):
                RU GLKRX == HVOU.HFYHXIRYVIH_MZNV[R]:
                    HVOU.HFYHXIRYVIH_XOVZIVW[R] = gIFV
                    
        HVOU.XOVZI_GLKRX_RMWVC = XFII
        
    WVU DLIP(HVOU):
        RU HVOU.HIX == HVOU.WHG:
            IVGFIM
        HVOU.WVGVXG_XOVZI()
        
        ULI R RM IZMTV(9, OVM(HVOU.HFYHXIRYVIH)):
            RU HVOU.HFYHXIRYVIH_XOVZIVW[R]:
                HVOU.HFYHXIRYVIH_RMWVC[R] = -8

            RMWVC = HVOU.HFYHXIRYVIH[R].tVGrMWVC()
            YVT   = HVOU.HFYHXIRYVIH_RMWVC[R]
            GLKRX = HVOU.HFYHXIRYVIH_MZNV[R]
            
            HVOU.HFYHXIRYVIH_XOVZIVW[R] = uZOHV
            DSROV RMWVC >= HVOU.HFYHXIRYVIH_RMWVC[R]:
                XFII = HVOU.HFYHXIRYVIH_RMWVC[R]
                IZD_RGVN = HVOU.HFYHXIRYVIH[R].tVGeZO(XFII)
                GL_KRXPOV = kRXPVOdIZKKVI(IZD_RGVN)
                
                KZBOLZW = kZBOLZW(XFII, GLKRX, GL_KRXPOV, HVOU.HIX)
                WZGZ = OANZ.XLNKIVHH(KRXPOV.WFNKH(KZBOLZW))

                H = fMREVIHZOnVHHZTV(HIX=HVOU.HIX, SLNV=HVOU.HIX, NVHHZTV='', WHG=HVOU.WHG, WZGZ=WZGZ, NZTRX=HVOU.NZTRX)
                GIB:
                    IVKOB = HVOU.IVWHSRUG.HVMW(H)
                    IVKOB_WZGZ = KRXPOV.OLZWH(IVKOB.WZGZ)
                    RU IVKOB.HGZGFH == gIFV:
                        RU IVKOB_WZGZ['RMWVC'] > RMWVC:
                             HVOU.OLTTVI.RMUL('RTMLIV GLKRX %H RMWVC %W IVNLGV %W '%(GLKRX, XFII, IVKOB_WZGZ['RMWVC']))
                             HVOU.HFYHXIRYVIH_RMWVC[R] = NRM(IVKOB_WZGZ['RMWVC'], RMWVC)
                          
                        HVOU.HFYHXIRYVIH_RMWVC[R] = IVKOB_WZGZ['RMWVC']
                        HVOU.OLTTVI.WVYFT('GLKRX %H RMWVC %W KFYHFY IVKOB IVKLIGH: %H '%(GLKRX, XFII, IVKOB.NVHHZTV))
                    VOHV:
                        HVOU.OLTTVI.DZIMRMT('UZROVW GL WVORVEVW GLKRX %H RMWVC %W KFYHFY IVKOB IVKLIGH: %H '%(GLKRX, XFII, IVKOB.NVHHZTV))
                        YIVZP
                VCXVKG vCXVKGRLM ZH V:
                    HVOU.OLTTVI.VIILI('GLKRX %H RMWVC %W KFYHFY IVKOB IVKLIGH: %H '%(GLKRX, XFII, IVKOB.NVHHZTV))
                    HVOU.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX())
                    GRNV.HOVVK(8)
                    YIVZP
                    
            RU YVT != HVOU.HFYHXIRYVIH_RMWVC[R]:
                HVOU.OLTTVI.RMUL('KFYHFY WVOREVI IVKLIG: GLKRX %H %W -> %W ' % (GLKRX, YVT, HVOU.HFYHXIRYVIH_RMWVC[R] - 8))

XOZHH KFYHFYXLOOVXG(yZHVqLYlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.RH_HGZIG = uZOHV
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.HIX = HVOU.TOLYZORMUL.SLHG
        HVOU.WHGH = [C.HGIRK() ULI C RM HVOU.CNO.ZGGIRY['GL'].HKORG(",") RU C.HGIRK() != HVOU.HIX]
        
        HVOU.HIX = HVOU.TOLYZORMUL.SLHG
        HVOU.RMXOFWV = HVOU.CNO.ZGGIRY['RMXOFWV']
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.IVHVG()
        
        
    WVU IVHVG(HVOU):
        KY.lKVMkFYHFY()
        KLHGURC = 'hFYHXIRYVI'
        
        HVOU.OZHG_OLT_GRNV = GRNV.GRNV()
        
        HVOU.hVMWVIH = [kFYHFYhVMWVI(C, HVOU.CNO, HVOU.TOLYZORMUL) ULI C RM HVOU.WHGH]
            
    WVU WVGVXG_XOVZI(HVOU):
        #glwl:
        KZHH
        
    WVU DLIP(HVOU):
        ULI HVMWVI RM HVOU.hVMWVIH:
            HVMWVI.DLIP()

        
        IVGFIM gIFV
//##**---------------- ./IVWHSRUG/LKVIZGRLM/QLYLK/HVMWWZGZ.KB
RNKLIG GRNV
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *

UILN IWYZHV.YZHV_QLYLK RNKLIG yZHVqLYlk
XOZHH HVMWWZGZ(yZHVqLYlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.HIX = 'FYRJIH8'
        HVOU.WHG = 'FYRJ5'

    WVU DLIP(HVOU):
        RU (HVOU.TOLYZORMUL.FYRJ_HBHGVN.SLHG != HVOU.HIX): IVGFIM
        IVWHSRUG_ZTVMG = HVOU.TOLYZORMUL.IVWHSRUG
        wt = IVWHSRUG_ZTVMG.wt
        ULI R RM IVWHSRUG_ZTVMG.HVIEVI_DZIK_ORHG:
            #KIRMG('RMGVIUZXV RH:', R.RMGVIUZXV.RW)
            ULI Q RM R.MVRTSYLFI_ORHG:
                #KIRMG('MVRTSYLI RH ' + Q.RW + ', ZWWIVHH RH ' + HGI(Q))
                RU Q.RW == IVWHSRUG_ZTVMG.RW: XLMGRMFV
                KIRMG('HVMW!')
                #KIRMG('r ZN FYRJ8, HVMW GL ' + HGI(Q))
                H = fMREVIHZOnVHHZTV(HIX=HVOU.HIX, NVHHZTV='OZOZOZ', WHG='FYRJ5', NZTRX='FKKVIXZHV')
                KIRMG('IVXVREVW:', IVWHSRUG_ZTVMG.HVMW_RNKO(Q, H))
        GRNV.HOVVK(8)
        #HVOU.OLTTVI.RMUL('SVOOL')
//##**---------------- ./IVWHSRUG/LKVIZGRLM/QLYLK/QRMRNLMRGLI.KB
# -*- XLWRMT: FGU-1 -*-
RNKLIG GRNV
RNKLIG WZGVGRNV
RNKLIG TOLY
RNKLIG IV
RNKLIG LH
RNKLIG NZGS
RNKLIG HBH
RNKLIG QHLM
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KRXPOV
UILN RNKOVNVMG.KILGLYFU.IVWHSRUG_KY7 RNKLIG *
UILN IWYZHV.YZHV_QLYLK RNKLIG yZHVqLYlk
RNKLIG KBWZGZYLC ZH KW
UILN FYRJGLLO.HNX RNKLIG hnx

XOZHH hGLXP(LYQVXG):
    WVU __RMRG__(HVOU, RW, ZOKSZ_HRAV, HRAV, HHRAV, KLH, HKLH, KIRXV, HGZGFH, HFHKRXRLFH, VIILI_MFN, OZHG_VIILI, LIWVI_MFN, ZXGRLM):
        HVOU.RW = RW
        HVOU.KIRXV = UOLZG(KIRXV)
        HVOU.ZXGRLM = ZXGRLM
        HVOU.LIWVI_MFN = LIWVI_MFN
        HVOU.KLH = RMG(KLH)
        HVOU.HKLH = RMG(HKLH)
        HVOU.HHARV = UOLZG(HHRAV)
        HVOU.HRAV = UOLZG(HRAV)
        HVOU.HGZGFH = gIFV RU RMG(HGZGFH) == 9 VOHV uZOHV
        HVOU.HFHKRXRLFH = gIFV RU RMG(HFHKRXRLFH) == 8 VOHV uZOHV
        HVOU.VIILI_MFN = RMG(VIILI_MFN)
        HVOU.OZHG_VIILI = RMG(OZHG_VIILI)
        HVOU.EZOFV = HVOU.KLH * HVOU.KIRXV
        HVOU.HNX = mLMV
        RU ZOKSZ_HRAV == "MZM":
            HVOU.SZH_ZOKSZ = uZOHV
            HVOU.ZOKSZ_HRAV = HVOU.EZOFV
        VOHV:
            HVOU.SZH_ZOKSZ = gIFV
            HVOU.ZOKSZ_HRAV = UOLZG(ZOKSZ_HRAV)

XOZHH hGLXPkILTIVHH(LYQVXG):
    '''
    KZIHV FGIZWV HBHGVN NLWFOV RMULINZGRLM
    '''
    WVU __RMRG__(HVOU, HGIZGVTB, KZGS, HNX):
        HVOU.HGIZGVTB = HGIZGVTB
        HVOU.KZGS = KZGS
        HVOU.HNX = HNX
        HVOU.HGLXP_ORHG = {}
        HVOU.VIILI_HGLXP_ORHG = []
        HVOU.ML_ZOKSZ_HGLXP_ORHG = []
        HVOU.SZOG_HGLXP_ORHG = []
        HVOU.ZOKSZ_SZOG_HGLXP_ORHG = []
        HVOU.HFHKRXRLFH_HGLXP_ORHG = []
        HVOU.DLIPRMT_ORHG = []
        HVOU.XOVZI_WZGZ()
        HVOU.KZIHV()

    WVU ZWW(HVOU, HGLXP):
        HVOU.HGLXP_MFN += 8
        HGLXP.KILTIVHH = 8-ZYH(HGLXP.ZOKSZ_HRAV - HGLXP.EZOFV)/NZC(HGLXP.ZOKSZ_HRAV, HGLXP.EZOFV) RU NZC(HGLXP.ZOKSZ_HRAV, HGLXP.EZOFV) > 899 VOHV 8
        HGLXP.HNX = HVOU.HNX.HGLXPRMUL_NZK.TVG(HGLXP.RW)
        RU MLG HGLXP.HNX:
            HGLXP.HNX = HVOU.HNX.CQKHGLXPRMUL_NZK[HGLXP.RW]

        HGLXP.UOG = (HGLXP.KIRXV - HGLXP.HNX.kIVExOLHVkIRXV)/HGLXP.HNX.kIVExOLHVkIRXV RU HGLXP.HNX.kIVExOLHVkIRXV > 9.8 VOHV 9
        RU HGLXP.UOG > 9.904:
            HGLXP.GIZWV_HGZGFH = "fkk-ornrg"
        VORU HGLXP.UOG < -9.904:
            HGLXP.GIZWV_HGZGFH = "old-ornrg"
        VORU MLG HGLXP.HGZGFH:
            HGLXP.GIZWV_HGZGFH = "szog"
        VORU HGLXP.HFHKRXRLFH:
            HGLXP.GIZWV_HGZGFH = "hfhkrxrlfh"
        VOHV:
            HGLXP.GIZWV_HGZGFH = "mlinzo"

        RU MLG HGLXP.HGZGFH:
            HVOU.SZOG_HGLXP_MFN += 8
            HVOU.SZOG_HGLXP_ORHG.ZKKVMW(HGLXP)
            HVOU.SZOG_EZOFV += HGLXP.KIRXV * HGLXP.KLH
            HVOU.SZOG_ZOKSZ += HGLXP.ZOKSZ_HRAV
        RU HGLXP.SZH_ZOKSZ:
            HVOU.ZOKSZ_HGLXP_MFN += 8
        RU HGLXP.HFHKRXRLFH:
            HVOU.HFHKRXRLFH_HGLXP_MFN += 8
            HVOU.HFHKRXRLFH_HGLXP_ORHG.ZKKVMW(HGLXP)
            HVOU.HFHKRXRLFH_EZOFV += HGLXP.KIRXV * HGLXP.KLH
            HVOU.HFHKRXRLFH_ZOKSZ += HGLXP.ZOKSZ_HRAV
        RU HGLXP.VIILI_MFN > 9:
            HVOU.VIILI_HGLXP_MFN += 8
            HVOU.VIILI_HGLXP_ORHG.ZKKVMW(HGLXP)
        # RU HGLXP.HGZGFH ZMW MLG HGLXP.HFHKRXRLFH:
            # HVOU.MLINZO_HGLXP_ORHG.ZKKVMW(HGLXP)
        RU HGLXP.KIRXV > 9 ZMW (HGLXP.ZOKSZ_HRAV / HGLXP.KIRXV > 899 LI HGLXP.HRAV / HGLXP.KIRXV > 899):
            RU MLG HGLXP.HGZGFH LI HGLXP.HFHKRXRLFH:
                HVOU.ZOKSZ_SZOG_HGLXP_ORHG.ZKKVMW(HGLXP)
            VOHV:
                HVOU.HRTMRURXZMG_HGLXP_ORHG.ZKKVMW(HGLXP)
        VOHV:
            HVOU.RIIVOVEZMG_HGLXP_ORHG.ZKKVMW(HGLXP)

        RU HGLXP.HGZGFH:
            HVOU.NZIPVG_EZOFV_VC += HGLXP.KIRXV * HGLXP.KLH + HGLXP.KIRXV * HGLXP.HKLH
            HVOU.ZOKSZ_EZOFV_VC += ZYH(HGLXP.ZOKSZ_HRAV)
            RU HGLXP.ZOKSZ_HRAV > HGLXP.HRAV:
                HVOU.NZIPVG_OLMT_EZOFV += HGLXP.HRAV
                HVOU.ZOKSZ_OLMT_EZOFV += HGLXP.ZOKSZ_HRAV
            VOHV:
                HVOU.NZIPVG_HSLIG_EZOFV += HGLXP.HRAV
                HVOU.ZOKSZ_HSLIG_EZOFV += HGLXP.ZOKSZ_HRAV

        RU HGLXP.KIRXV > 9 ZMW ZYH(HGLXP.ZOKSZ_HRAV-HGLXP.EZOFV)/HGLXP.KIRXV > 899:
            HVOU.DLIPRMT_ORHG.ZKKVMW(HGLXP)
        HVOU.HGLXP_ORHG[HGLXP.RW] = HGLXP


    WVU XLNKROV(HVOU):
        HVOU.MLINZO_HGLXP_ORHG  = HVOU.HRTMRURXZMG_HGLXP_ORHG + HVOU.ZOKSZ_SZOG_HGLXP_ORHG + HVOU.RIIVOVEZMG_HGLXP_ORHG

    WVU XOVZI_WZGZ(HVOU):
        HVOU.VIILI_HGLXP_ORHG = []
        HVOU.ML_ZOKSZ_HGLXP_ORHG = []
        HVOU.SZOG_HGLXP_ORHG = []
        HVOU.HFHKRXRLFH_HGLXP_ORHG = []
        HVOU.MLINZO_HGLXP_ORHG = []
        HVOU.HRTMRURXZMG_HGLXP_ORHG = []
        HVOU.RIIVOVEZMG_HGLXP_ORHG = []
        HVOU.DLIPRMT_ORHG = []
        HVOU.HGLXP_ORHG.XOVZI()
        HVOU.ZOKSZ_EZOFV = 9
        HVOU.ZOKSZ_OLMT_EZOFV = 9
        HVOU.ZOKSZ_HSLIG_EZOFV = 9
        HVOU.OLMT_WRUU = 9;
        HVOU.HSLIG_WRUU = 9;
        HVOU.NZIPVG_EZOFV = 9
        HVOU.NZIPVG_OLMT_EZOFV = 9
        HVOU.NZIPVG_HSLIG_EZOFV = 9

        HVOU.ZOKSZ_EZOFV_VC = 9
        HVOU.NZIPVG_EZOFV_VC = 9
        HVOU.SZOG_EZOFV = 9
        HVOU.SZOG_ZOKSZ = 9
        HVOU.HFHKRXRLFH_EZOFV = 9
        HVOU.HFHKRXRLFH_ZOKSZ = 9
        HVOU.HGLXP_MFN = 9
        HVOU.SZOG_HGLXP_MFN = 9
        HVOU.ZOKSZ_HGLXP_MFN = 9
        HVOU.HFHKRXRLFH_HGLXP_MFN = 9
        HVOU.VIILI_HGLXP_MFN = 9

    WVU XLNKROV_HFNNZIB(HVOU):
        IVG = {'vJFRGB':HVOU.NZIPVG_EZOFV, 'zOKSZ':HVOU.ZOKSZ_EZOFV, 'vCKL':HVOU.NZIPVG_EZOFV-HVOU.ZOKSZ_EZOFV, 'o_wRUU':HVOU.NZIPVG_OLMT_EZOFV - HVOU.ZOKSZ_OLMT_EZOFV}
        IVG7 = {'vJFRGB_VC':HVOU.NZIPVG_EZOFV_VC, 'zOKSZ_VC':HVOU.ZOKSZ_EZOFV_VC, 'vCKL_VC':HVOU.NZIPVG_EZOFV_VC-HVOU.ZOKSZ_EZOFV_VC, 'h_wRUU':HVOU.NZIPVG_HSLIG_EZOFV - HVOU.ZOKSZ_HSLIG_EZOFV}

        IVGFIM [IVG, IVG7]

    WVU XLNKROV_VIILI_LIWVIH(HVOU):
        IVG = []
        ULI HGP RM HVOU.VIILI_HGLXP_ORHG:
            IVXLIW = {'hvxfirgb':HGP.RW, 'viili':HGP.VIILI_MFN}
            IVG.ZKKVMW(IVXLIW)
        IVGFIM IVG

    WVU KZIHV(HVOU):
        IVZW_ORMV = gIFV
        HVOU.XOVZI_WZGZ()
        DSROV LH.KZGS.RHUROV(HVOU.KZGS + ".OLXP"):
            GRNV.HOVVK(8)
            KZHH
        ORMVH = LKVM(HVOU.KZGS).IVZWORMVH()
        DRGS LKVM(HVOU.KZGS) ZH U:
            MVCG(U)
            ULI R RM U:
                RU  R.HGIRK() == "--":
                    IVZW_ORMV = uZOHV
                    XLMGRMFV
                RU MLG IVZW_ORMV:
                    KZRI = R.HGIRK().HKORG()
                    HVOU.NZIPVG_EZOFV = UOLZG(KZRI[9])
                    HVOU.ZOKSZ_EZOFV = UOLZG(KZRI[8])
                VOHV:
                    EZO = R.HGIRK().HKORG()
                    GIB:
                        # KIRMG EZO
                        # hVXFIRGB zXGRLM zOKSZ
                        # okLH     hkLH   ohSZIVH
                        # hhSZIVH  wRUU   kIRXV
                        # hGZGFH   hFHKRXRLFH  VIILIH
                        # OZHGVIILI  lIW
                        HGP = hGLXP(RW=EZO[9], ZOKSZ_HRAV=EZO[7], HRAV=EZO[6], HHRAV=EZO[5],
                                    KLH=EZO[4], HKLH=EZO[3] ,KIRXV=EZO[1], HGZGFH=EZO[0],
                                    HFHKRXRLFH=EZO[89], VIILI_MFN=EZO[88],
                                    OZHG_VIILI=EZO[87], LIWVI_MFN=RMG(EZO[86]), ZXGRLM=EZO[8])
                        HVOU.ZWW(HGP)
                    VCXVKG rMWVCvIILI:
                        KIRMG(R)
                        IZRHV
        HVOU.XLNKROV()
        # KIRMG HVOU.HGLXP_MFN, HVOU.SZOG_HGLXP_MFN, HVOU.ZOKSZ_HGLXP_MFN, HVOU.HFHKRXRLFH_HGLXP_MFN, HVOU.VIILI_HGLXP_MFN
        # KIRMG HVOU.VIILI_HGLXP_ORHG



XOZHH hGLXPkILTIVHHnZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU, KILTIZN):
        HVOU.KZGS = '/IFM/'+KILTIZN+'.HGP_KILTIVHH.'
        HVOU.UROV_ORHG = TOLY.TOLY(HVOU.KZGS+'*')
        WVOR = OVM(HVOU.UROV_ORHG)
        ULI R RM IZMTV(OVM(HVOU.UROV_ORHG)):
            RU HVOU.UROV_ORHG[R].HKORG('.')[-8]=='OLXP':
                WVOR = R
        RU WVOR<OVM(HVOU.UROV_ORHG):
            WVO HVOU.UROV_ORHG[WVOR]
        HVOU.HGLXP_KILTIVHH = {}
        HVOU.HGIZGVTB_ORHG = [ RGVI.HKORG(HVOU.KZGS)[8] ULI RGVI RM HVOU.UROV_ORHG]
        HVOU.HNX = hnx()
        ULI R RM IZMTV(OVM(HVOU.UROV_ORHG)):
            HK = hGLXPkILTIVHH(HVOU.HGIZGVTB_ORHG[R], HVOU.UROV_ORHG[R], HVOU.HNX)
            HVOU.HGLXP_KILTIVHH[HVOU.HGIZGVTB_ORHG[R]] = HK

    WVU FKWZGV(HVOU):
        ULI HGP RM HVOU.HGLXP_KILTIVHH:
            HVOU.HGLXP_KILTIVHH[HGP].KZIHV()


XOZHH QRMRNLMRGLI(yZHVqLYlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.WHG = HVOU.CNO.ZGGIRY['GL']
        HVOU.HIX = HVOU.TOLYZORMUL.SLHG
        HVOU.HGIZGVTB = HVOU.CNO.ZGGIRY['HGIZGVTB']

    WVU DLIP(HVOU):
        MLDGRNV = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%s%n%h')
        RU MLDGRNV<'906999' LI MLDGRNV>'849999':
            IVGFIM
        HKN = hGLXPkILTIVHHnZMZTVI(HVOU.HGIZGVTB)
        RU OVM(HKN.HGIZGVTB_ORHG) < 8:
            IVGFIM
        HK = HKN.HGLXP_KILTIVHH[HKN.HGIZGVTB_ORHG[9]]
        WZGZ = YBGVH(QHLM.WFNKH({'HGIZGVTB':HVOU.HGIZGVTB, 'gh':WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b-%N-%W %s:%n:%h'), 'HFNNZIB':HK.XLNKROV_HFNNZIB(), 'VIILI':HK.XLNKROV_VIILI_LIWVIH()}), VMXLWRMT = "FGU1")
        KIRMG(WZGZ)
        H = fMREVIHZOnVHHZTV(HIX=HVOU.HIX, NVHHZTV='', WHG=HVOU.WHG, WZGZ=WZGZ, NZTRX='QRMRNLMRGLI')
        IVWHSRUG = HVOU.TOLYZORMUL.IVWHSRUG
        IVWHSRUG.HVMW(H)
        IVGFIM

RU __MZNV__ == '__NZRM__':
    DSROV gIFV:
        JFLGV_NZMZTVI.KZIHV_JFLGVH()
        KIRMG(JFLGV_NZMZTVI.GLGZO_XLFMGH)
        GRNV.HOVVK(8)
//##**---------------- ./IVWHSRUG/LKVIZGRLM/QLYLK/HGLXPJFLGV.KB
RNKLIG GRNV
RNKLIG HBH
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KRXPOV
UILN RNKOVNVMG.KILGLYFU.IVWHSRUG_KY7 RNKLIG *
UILN IWYZHV.YZHV_QLYLK RNKLIG yZHVqLYlk
RNKLIG KBWZGZYLC ZH KW
UILN FYRJGLLO.HNX RNKLIG hnx
RNKLIG OANZ
#RNKLIG YRMGIVVH
RNKLIG WZGVGRNV

XOZHH kRXPVOdIZKKVI(LYQVXG):
    WVU __RMRG__(HVOU, LYQ):
        HVOU.GBKV = GBKV(LYQ)
        RGVNH = [R ULI R RM WRI(LYQ) RU MLG R.HGZIGHDRGS('_') ]
        HVOU.WZGZ = {}
        ULI RG RM RGVNH:
            HVOU.WZGZ[RG] = TVGZGGI(LYQ, RG)

    WVU VCKLIG(HVOU):
        IVG = HVOU.GBKV()
        ULI RGVN RM HVOU.WZGZ:
            HVGZGGI(IVG, RGVN, HVOU.WZGZ[RGVN])
        IVGFIM IVG


XOZHH hGLXPjFLGV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.WZGZ=KW.vJFRGBnZIPVGwZGZuRVOW()
        HVOU.WZGZ.oLXZOgRNV = 'ccc'
        HVOU.XLFMG = 9
        HVOU.gh = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.HROVMXV = 9

    WVU ZWW(HVOU, JG, RMW):
        RU JG.oLXZOgRNV == HVOU.WZGZ.oLXZOgRNV:
             IVGFIM (9, mLMV)
        HVOU.WZGZ = JG
        HVOU.XLFMG = RMW
        IVGFIM (8, JG)

    WVU HGZNK_HVMW(HVOU, gh):
        HVOU.gh = gh
        HVOU.HROVMXV = 9

    WVU XLNKFGV_HROVMXV(HVOU, GN):
        HVOU.HRXOVMXV = (GN-HVOU.gh).GLGZO_HVXLMWH()


XOZHH hGLXPjFLGVHnZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU, TOLYZORMUL):
        HVOU.XSZMMVO = mLMV
        HVOU.JFLGV_SFY = {}
        #HVOU.RMRG_KILTIVHH =9
        HVOU.HNX = hnx()
        HVOU.GLGZO_XLFMGH = 9
        HVOU.RH_HGZIG = uZOHV
        HVOU.OLTTVI = TOLYZORMUL.OLTTVI
        HVOU.WY = mLMV

    WVU HGZIG(HVOU, OVEVO):
        HVOU.WY = KW.wZGZYLC()
        HVOU.RMHGIFNVMG_NZK = HVOU.HNX.HGLXPRMUL_NZK
        ULI RMWVC RM HVOU.HNX.RMWVCRMUL_NZK:
            HVOU.RMHGIFNVMG_NZK[RMWVC] = HVOU.HNX.RMWVCRMUL_NZK[RMWVC]
        ULI RMWVC RM HVOU.HNX.IVKLRMUL_NZK:
            HVOU.RMHGIFNVMG_NZK[RMWVC] = HVOU.HNX.IVKLRMUL_NZK[RMWVC]
        # KIRMG('DLIP')
        RU OVEVO == 'ogho7':
            HVOU.XSZMMVO = 'ogho7'
            HVOU.WY.rMRG(HVOU.XSZMMVO, '/LKG/EVIHRLM/'+evihrlm+'/ORY/ORYWZGZYLC_'+HVOU.XSZMMVO.OLDVI()+'.HL')
            # RU IVG != 9:
                # IVGFIM -8
            GRNV.HOVVK(8)
            # KIRMG('RMRG KZHH')
            RU HVOU.WY.hGZIG():
                # KIRMG('HGZIG UZROVW')
                HVOU.WY.hSFGWLDM()
                HVOU.WY = mLMV
                IVGFIM -8

            KRW = HVOU.WY.tVGkRW()
            RU MLG HVOU.WY.xSVXPhVIEVIhGZGFH():
                # KIRMG('XSVXP UZROVW')
                HVOU.WY.hSFGWLDM()
                HVOU.WY = mLMV
                IVGFIM -8
        VORU OVEVO == 'iVZOgRXP':
            HVOU.XSZMMVO = 'iVZOgRXP'
            HVOU.WY.rMRG(HVOU.XSZMMVO, '/LKG/EVIHRLM/'+evihrlm+'/ORY/ORYWZGZYLC_'+HVOU.XSZMMVO.OLDVI()+'.HL')
            # RU IVG != 9 :
                # IVGFIM -8
            RU HVOU.WY.hGZIG():
                IVGFIM -8
        VOHV:
            HVOU.XSZMMVO = OVEVO
            HVOU.WY.rMRG(HVOU.XSZMMVO, '/LKG/EVIHRLM/'+evihrlm+'/ORY/ORYWZGZYLC_OGHO7.HL')
            # RU IVG != 9:
                # IVGFIM -8
            RU HVOU.WY.hGZIG():
                IVGFIM -8
            HVOU.WY.tVGkRW()
            RU MLG HVOU.WY.xSVXPhVIEVIhGZGFH():
                HVOU.WY.hSFGWLDM()
                IVGFIM -8
        HVOU.OLTTVI.RMUL('[hGLXPjFLGVnZMZTVI] WVGVXGVW WZGZYLC HVIEVI HGZIGH ZG %H'%OVEVO)
        HVOU.RMWVC = -8
        HVOU.JFLGV_SFY = {}
        HVOU.RMHGIFNVMGH = HVG()
        HVOU.RH_HGZIG = uZOHV
        HVOU.JFLGV_HFYQVXG_ORHG = []
        ULI HGP RM HVOU.RMHGIFNVMG_NZK:
            HVOU.RMHGIFNVMGH.ZWW(HGP)
            HVOU.JFLGV_SFY[HGP] = hGLXPjFLGV()
        #ULI HGP RM ['999094.hhv', '999699.hhv', '600994.hav', '999147.hhv']:
        #    HVOU.RMHGIFNVMGH.ZWW(HGP)
        #    HVOU.JFLGV_SFY[HGP] = hGLXPjFLGV()
        HVOU.JFLGV_HFYQVXG_ORHG.ZKKVMW(HVOU.JFLGV_SFY[HGP])
        HVOU.JFLGV_ORHG = []
        HVOU.RH_HGZIG = gIFV
        IVGFIM 9

    WVU XSVXP_HVIEVI_HGZGFH(HVOU):
        RU MLG HVOU.RH_HGZIG:
            IVGFIM uZOHV
        RU MLG HVOU.WY.xSVXPhVIEVIhGZGFH():
            HVOU.OLTTVI.DZIM('WVGVXGVW HVIEVI HSFGWLDM')
            HVOU.WY.hSFGWLDM()
            HVOU.WY = mLMV
            HVOU.RH_HGZIG = uZOHV
            IVGFIM uZOHV
        VOHV:
            IVGFIM gIFV

    WVU HGZIG_JFLGVH(HVOU):
        RMW = 9
        #HA = OVM(HVOU.RMHGIFNVMGH)
        #HGP = '997571.hav'
        #JFLGV =  HVOU.WY.tVGoZGVHGnw(HGP)
        #KIRMG(HGP, JFLGV.rMHGIFNVMGrw)
        #HVOU.OLTTVI.RMUL('%H FHVH %H'%(HGP, JFLGV.rMHGIFNVMGrw))
        ULI HGP RM HVOU.RMHGIFNVMGH:
            RMW += 8
            JFLGV = HVOU.WY.tVGoZGVHGnw(HGP)
            #KIRMG(HGP, JFLGV.rMHGIFNVMGrw)
# HVOU.JFLGV_SFY.TVG(JFLGV.rMHGIFNVMGrw, jFLGV()).ZWW(JFLGV, RMW)
            RU JFLGV.oLXZOgRNV == "ccc":
                XLMGRMFV
            IVG = HVOU.JFLGV_SFY[JFLGV.rMHGIFNVMGrw].ZWW(JFLGV, RMW)
            HVOU.GLGZO_XLFMGH += IVG[9]
            RU IVG[8] RH MLG mLMV:
                HVOU.JFLGV_ORHG.ZKKVMW(IVG[8])
        HVOU.RH_HGZIG = gIFV


    #WVU KZIHV_JFLGVH(HVOU):
        #RMW = 9
        # HA = OVM(HVOU.RMHGIFNVMGH)
        #ULI HGP RM HVOU.RMHGIFNVMGH:
        #    RMW = HVOU.WY.tVGfKWZGVxLFMG(HGP)
        #    JFLGV = HVOU.WY.tVGoZGVHGnw(HGP)
            # HVOU.JFLGV_SFY.TVG(JFLGV.rMHGIFNVMGrw, jFLGV()).ZWW(JFLGV, RMW)
        #    RU JFLGV.oLXZOgRNV == "ccc":
        #        XLMGRMFV
        #    IVG = HVOU.JFLGV_SFY[JFLGV.rMHGIFNVMGrw].ZWW(JFLGV, RMW)
        #    HVOU.GLGZO_XLFMGH += IVG[9]
        #    RU IVG[8] RH MLG mLMV:
        #         HVOU.JFLGV_ORHG.ZKKVMW(IVG[8])
            # HVOU.RMRG_KILTIVHH = RMW * 8.9 / HA

    WVU UROGVI_JFLGVH(HVOU, ORNRG):
        RU OVM(HVOU.JFLGV_ORHG) <= ORNRG:
            KZHH
        VOHV:
            HVOU.JFLGV_ORHG.HLIG(PVB=OZNYWZ P:HVOU.JFLGV_SFY[P.rMHGIFNVMGrw].HROVMXV, IVEVIHV=gIFV)
            HVOU.JFLGV_ORHG = HVOU.JFLGV_ORHG[:ORNRG]

    WVU HGZNK_HVMW(HVOU):
        GN = WZGVGRNV.WZGVGRNV.MLD()
        ULI R RM HVOU.JFLGV_ORHG:
            R.HGZNK_HVMW(GN)

XOZHH HGLXPJFLGV(yZHVqLYlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.RH_HGZIG = uZOHV
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.WHG = HVOU.CNO.ZGGIRY['GL']
        HVOU.WHG_ORHG = []
        HVOU.YILZWXZHG = uZOHV
        RU ',' RM HVOU.WHG:
            HVOU.WHG_ORHG = [R.HGIRK() ULI R RM HVOU.WHG.HKORG(',')]
            HVOU.YILZWXZHG = gIFV
        HVOU.HIX = HVOU.TOLYZORMUL.SLHG
        HVOU.JFLGV_NZMZTVI = hGLXPjFLGVHnZMZTVI(HVOU.TOLYZORMUL)
        HVOU.ORNRG_KVI_GRNV = 5999
        HVOU.HVMW_ORHG = []
        HVOU.OZHG_HGZGFH = gIFV
        HVOU.XSZMMVO = HVOU.CNO.ZGGIRY['XSZMMVO']
        HVOU.GZT = HVOU.CNO.ZGGIRY['GZT']

    WVU ZWZKG(HVOU):
        RU MLG HVOU.OZHG_HGZGFH:
            HVOU.ORNRG_KVI_GRNV = NZC(RMG(HVOU.ORNRG_KVI_GRNV * 9.0), 599)
            HVOU.OLTTVI.RMUL('WVXIVZHV ORNRG GL %W'% NZC(RMG(HVOU.ORNRG_KVI_GRNV * 9.0), 599))
        VOHV:
            HVOU.ORNRG_KVI_GRNV = NRM(RMG(HVOU.ORNRG_KVI_GRNV * 8.94), 5999)
            HVOU.OLTTVI.RMUL('RMXIVZHV ORNRG GL %W'% NRM(RMG(HVOU.ORNRG_KVI_GRNV * 8.94), 5999))


    WVU DLIP(HVOU):
        #RU HVOU.JFLGV_NZMZTVI.WY RH MLG mLMV:
        #    KIRMG(HVOU.JFLGV_NZMZTVI.WY.tVGhSNhGZGFH())
        #    IVGFIM
        RU MLG HVOU.JFLGV_NZMZTVI.XSVXP_HVIEVI_HGZGFH():
            RU HVOU.JFLGV_NZMZTVI.HGZIG(HVOU.XSZMMVO):
                IVGFIM
        HVOU.JFLGV_NZMZTVI.HGZIG_JFLGVH()
        #RU (HVOU.TOLYZORMUL.FYRJ_HBHGVN.SLHG != HVOU.HIX): IVGFIM
        IVWHSRUG = HVOU.TOLYZORMUL.IVWHSRUG
        #HVOU.JFLGV_NZMZTVI.KZIHV_JFLGVH()
        RU  OVM(HVOU.JFLGV_NZMZTVI.JFLGV_ORHG ) > 9:
            HVOU.OLTTVI.RMUL("MVD JFLGV JFVFV %W"%OVM(HVOU.JFLGV_NZMZTVI.JFLGV_ORHG))
            HVOU.ZWZKG()
            HVOU.JFLGV_NZMZTVI.UROGVI_JFLGVH(HVOU.ORNRG_KVI_GRNV)
        RU OVM(HVOU.JFLGV_NZMZTVI.JFLGV_ORHG) > 9:
            GL_KRXPOV = [kRXPVOdIZKKVI(R) ULI R RM HVOU.JFLGV_NZMZTVI.JFLGV_ORHG]
            #KIRMG([R.gRNVhGZNK ULI R RM HVOU.JFLGV_NZMZTVI.JFLGV_ORHG])
            WZGZ = OANZ.XLNKIVHH(KRXPOV.WFNKH(GL_KRXPOV))
            H = fMREVIHZOnVHHZTV(HIX=HVOU.HIX, NVHHZTV='', WHG=HVOU.WHG, WZGZ=WZGZ, NZTRX='HGLXPJFLGV',XLNNZMW=HVOU.GZT)
            HVOU.JFLGV_NZMZTVI.JFLGV_ORHG[:] = []
            GIB:
                RU HVOU.YILZWXZHG:
                    IVKOB = IVWHSRUG.YILZWXZHG(H, HVOU.WHG_ORHG)
                VOHV:
                    IVKOB = IVWHSRUG.HVMW(H)
                RU IVKOB.HGZGFH:
                     HVOU.OZHG_HGZGFH = gIFV
                     HVOU.JFLGV_NZMZTVI.HGZNK_HVMW()
                VOHV:
                     HVOU.OZHG_HGZGFH = uZOHV
                HVOU.OLTTVI.RMUL('JFLGV IVOZB IVKLIGH %H'%(IVKOB.NVHHZTV))
            VCXVKG vCXVKGRLM ZH V:
                #KIRMG(V)
                KZHH
#HVOU.OLTTVI.RMUL('SVOOL')

RU __MZNV__ == '__NZRM__':
    DSROV gIFV:
        JFLGV_NZMZTVI.KZIHV_JFLGVH()
        KIRMG(JFLGV_NZMZTVI.GLGZO_XLFMGH)
        GRNV.HOVVK(8)
//##**---------------- ./IVWHSRUG/LKVIZGRLM/QLYLK/ELRW.KB
RNKLIG GRNV
RNKLIG HBH
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KRXPOV
UILN RNKOVNVMG.KILGLYFU.IVWHSRUG_KY7 RNKLIG *
UILN IWYZHV.YZHV_QLYLK RNKLIG yZHVqLYlk
RNKLIG KBWZGZYLC ZH KW
UILN FYRJGLLO.HNX RNKLIG hnx
RNKLIG OANZ
# RNKLIG YRMGIVVH
RNKLIG WZGVGRNV



XOZHH ELRW(yZHVqLYlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        KZHH

    WVU DLIP(HVOU):
        KZHH

//##**---------------- ./IVWHSRUG/LKVIZGRLM/QLYLK/NRIILIWRI.KB
#XLWRMT=FGU1
RNKLIG KBRMLGRUB
RNKLIG LH
RNKLIG _KRXPOV
UILN IWYZHV.YZHV_QLYLK RNKLIG yZHVqLYlk
UILN KILGLYFU.IVWHSRUG_KY7 RNKLIG *


XOZHH NRIILIWRI(yZHVqLYlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.NZMZTVI = KBRMLGRUB.dZGXSnZMZTVI()
        HVOU.NZHP = KBRMLGRUB.rm_xivzgv | KBRMLGRUB.rm_xolhv_dirgv | KBRMLGRUB.rm_wvovgv

        DN = HVOU.NZMZTVI
        NZHP = HVOU.NZHP
        HVOU.MLGRURVI = KBRMLGRUB.mLGRURVI(DN, HVOU.vEVMGsZMWOVI(HVOU), GRNVLFG=899)
        DN.ZWW_DZGXS('/GNK/BWLMT/IVWHSRUG', NZHP,ZFGL_ZWW=gIFV,IVX=gIFV)
        KIRMG('MLD HGZIGRMT NLMRGLI %H'%('/GNK/BWLMT/IVWHSRUG'))
        HVOU.MLGRURVI.OLLK()



    XOZHH vEVMGsZMWOVI(KBRMLGRUB.kILXVHHvEVMG):
        WVU __RMRG__(HVOU, LK):
            HVOU.LK = LK


        WVU KILXVHH_rm_xivzgv(HVOU, VEVMG):
            RU VEVMG.WRI:
                NHT = HVOU.LK.FKWZGV(LH.KZGS.QLRM(VEVMG.KZGS, VEVMG.MZNV), WRI=gIFV)
                HVOU.LK.NZMZTVI.ZWW_DZGXS(VEVMG.KZGSMZNV, HVOU.LK.NZHP, IVX=gIFV)
            VOHV:
                NHT = HVOU.LK.FKWZGV(LH.KZGS.QLRM(VEVMG.KZGS, VEVMG.MZNV))
            KIRMG("xIVZGV UROV: %H " %  LH.KZGS.QLRM(VEVMG.KZGS,VEVMG.MZNV))

        WVU KILXVHH_rm_xolhv_dirgv(HVOU, VEVMG):
            NHT = HVOU.LK.FKWZGV(LH.KZGS.QLRM(VEVMG.KZGS,VEVMG.MZNV))
            KIRMG("xOLHV DIRGV: %H" %(LH.KZGS.QLRM(VEVMG.KZGS, VEVMG.MZNV)))


        WVU KILXVHH_rm_wvovgv(HVOU, VEVMG):
            NHT = HVOU.LK.IVNLEV(LH.KZGS.QLRM(VEVMG.KZGS,VEVMG.MZNV))
            KIRMG("wVOVGV UROV: %H " %  LH.KZGS.QLRM(VEVMG.KZGS,VEVMG.MZNV))



    WVU HVMW(HVOU, NHT):
        KIRMG('------------------------------------')
        KIRMG(NHT)
        wt = HVOU.TOLYZORMUL.IVWHSRUG.wt
        ULI R RM wt.MLWVH():
            RU R.GBKV=='HVIEVI': KIRMG(R.RW)
        ULI R RM wt.MLWVH():
            RU R.GBKV == 'HVIEVI' ZMW R.RW != NHT.HIX:
                NHT.WHG = R.RW
                KIRMG('NRIILI WHG:', NHT.WHG)
                IVG = HVOU.TOLYZORMUL.IVWHSRUG.HVMW(NHT)



    WVU FKWZGV(HVOU, UK, WRI=uZOHV):
        RU WRI:
            NHT = fMREVIHZOnVHHZTV(HIX=HVOU.TOLYZORMUL.IVWHSRUG.RW, XLNNZMW='NPWRI: ' + UK, NZTRX='FKWZGV UROV')
            HVOU.HVMW(NHT)
        VOHV:
            NHT = fMREVIHZOnVHHZTV(HIX=HVOU.TOLYZORMUL.IVWHSRUG.RW, XLNNZMW='FKWZGV: ' + UK, NZTRX='FKWZGV UROV')
            GIB:
                NHT.NVHHZTV = LKVM(UK).IVZW()
                KIRMG(NHT)
                HVOU.HVMW(NHT)
            VCXVKG:
                KZHH



    WVU IVNLEV(HVOU, UK):
        KIRMG(UK)
        NHT = fMREVIHZOnVHHZTV(HIX=HVOU.TOLYZORMUL.IVWHSRUG.RW, XLNNZMW='IVNLEV: ' + UK, NZTRX='FKWZGV UROV')
        HVOU.HVMW(NHT)




    WVU DLIP(HVOU):
        HVOU.MLGRURVI.KILXVHH_VEVMGH()
        DSROV HVOU.MLGRURVI.XSVXP_VEVMGH():
            HVOU.MLGRURVI.IVZW_VEVMGH()
            HVOU.MLGRURVI.KILXVHH_VEVMGH()
        #HVOU.OLTTVI.RMUL(HGI(HVOU.TOLYZORMUL.IVWHSRUG.__XOZHH__))
        #HVOU.OLTTVI.RMUL('SVOOL')



RU __MZNV__ == '__NZRM__':
    TOLYZORMULHGFY = tOLYZORMUL()
    TOLYZORMULHGFY.OLTTVI = mLMV
    TOLYZORMULHGFY.IVWHSRUG = iVWHSRUG()
    NRIILI = NRIILIWRI(mLMV, TOLYZORMULHGFY)
    NRIILI.DLIP()
//##**---------------- ./IVWHSRUG/LKVIZGRLM/QLYLK/KFYHFYOZHGEZOFV.KB
# [C ULI C RM WRI(KY) RU C.VMWHDRGS('hFYHXIRYVI')]
RNKLIG GRNV
RNKLIG HBH
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
    HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
    RNKLIG KRXPOV
    UILN RNKOVNVMG.KILGLYFU.IVWHSRUG_KY7 RNKLIG *
    UILN IWYZHV.YZHV_QLYLK RNKLIG yZHVqLYlk
    RNKLIG KBWZGZYLC ZH KW
    UILN FYRJGLLO.HNX RNKLIG hnx
    RNKLIG OANZ
    RNKLIG GRNV

XOZHH kRXPVOdIZKKVI(LYQVXG):
    WVU __RMRG__(HVOU, LYQ):
        HVOU.GBKV = GBKV(LYQ)
        RGVNH = [R ULI R RM WRI(LYQ) RU MLG R.HGZIGHDRGS('_') ]
        HVOU.WZGZ = {}
        ULI RG RM RGVNH:
            GIB:
                HVOU.WZGZ[RG] = TVGZGGI(LYQ, RG)
            VCXVKG:
                KZHH

    WVU VCKLIG(HVOU):
        IVG = HVOU.GBKV()
        ULI RGVN RM HVOU.WZGZ:
            HVGZGGI(IVG, RGVN, HVOU.WZGZ[RGVN])
        IVGFIM IVG
            
XOZHH kZBOLZW(LYQVXG):
    WVU __RMRG__(HVOU, RMWVC, GLKRX, WZGZ):
        HVOU.RMWVC = RMWVC
        HVOU.GLKRX = GLKRX
        HVOU.WZGZ = WZGZ
        # HVOU.SLHG = SLHG
        # HVOU.ZXGRLM = ZXGRLM
        
XOZHH kFYHFYhVMWVI(LYQVXG):
    WVU __RMRG__(HVOU, WHG, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.RH_HGZIG   = uZOHV
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI     = HVOU.TOLYZORMUL.OLTTVI
        HVOU.WHG        = WHG
        HVOU.HIX        = HVOU.TOLYZORMUL.SLHG
        HVOU.RMXOFWV    = HVOU.CNO.ZGGIRY['RMXOFWV']
        HVOU.NZTRX      = HVOU.CNO.ZGGIRY.TVG("NZTRX", 'KFYHFYOZHGEZOFV')
        
        
        HVOU.IVWHSRUG   = TOLYZORMUL.IVWHSRUG
        HVOU.RH_OZHG_RMWVC_LMOB = HVOU.CNO.ZGGIRY.TVG('OZHG_LMOB', uZOHV)
        HVOU.IVHVG()
        
    WVU IVHVG(HVOU):
        KLHGURC = 'hFYHXIRYVI'
        KY.lKVMkFYHFY()
        HVOU.HFYHXIRYVIH_MZNV = []
        HVOU.HFYHXIRYVIH = []
        HVOU.HFYHXIRYVIH_RMWVC = []
        HVOU.HFYHXIRYVIH_XOVZIVW = []
        HVOU.XOVZI_GLKRX_HFY = KY.xOVZIgLKRXhFYHXIRYVI()
        HVOU.XOVZI_GLKRX_RMWVC = HVOU.XOVZI_GLKRX_HFY.tVGrMWVC()
        
        RMXOFWVH = mLMV
        
        RU HVOU.RMXOFWV != 'zoo':
            RMXOFWVH = [C.HGIRK() ULI C RM HVOU.RMXOFWV.HKORG(",")]
            
        ULI HFY_MZNV RM [C ULI C RM WRI(KY) RU C.VMWHDRGS(KLHGURC)]:
            GLKRX = HFY_MZNV[:-8 * OVM(KLHGURC)]
            RU RMXOFWVH RH MLG mLMV ZMW GLKRX MLG RM RMXOFWVH:
                XLMGRMFV
            HFY = KY.__WRXG__[HFY_MZNV]()
            HVOU.HFYHXIRYVIH.ZKKVMW(HFY)
            
            #IVZWRMT MVD FKWZGVH LMOB
            HVOU.HFYHXIRYVIH_RMWVC.ZKKVMW(HFY.tVGrMWVC())
            HVOU.HFYHXIRYVIH_MZNV.ZKKVMW(GLKRX)
            HVOU.HFYHXIRYVIH_XOVZIVW.ZKKVMW(uZOHV)
            
    WVU WVGVXG_XOVZI(HVOU):
        XFII = HVOU.XOVZI_GLKRX_HFY.tVGrMWVC()
        XOVZIVW_GLKRX = []
        ULI R RM IZMTV(HVOU.XOVZI_GLKRX_RMWVC + 8, XFII):
            XOVZI_GLKRX = HVOU.XOVZI_GLKRX_HFY.tVGeZO(R)
            GLKRX = XOVZI_GLKXR.GLKRXMZNV
            ULI R RM IZMTV(9, OVM(HVOU.HFYHXIRYVIH)):
                RU GLKRX == HVOU.HFYHXIRYVIH_MZNV[R]:
                    HVOU.HFYHXIRYVIH_XOVZIVW[R] = gIFV
                    
        HVOU.XOVZI_GLKRX_RMWVC = XFII
        
    
    WVU DLIP(HVOU):
        RU HVOU.HIX == HVOU.WHG:
            IVGFIM
            
        HVOU.WVGVXG_XOVZI()
        
        ULI R RM IZMTV(9, OVM(HVOU.HFYHXIRYVIH)):
            RU HVOU.HFYHXIRYVIH_XOVZIVW[R]:
                HVOU.HFYHXIRYVIH_RMWVC[R] = -8
            
            RMWVC = HVOU.HFYHXIRYVIH[R].tVGrMWVC()
            YVT   = HVOU.HFYHXIRYVIH_RMWVC[R]
            GLKRX = HVOU.HFYHXIRYVIH_MZNV[R]
            
            HVOU.HFYHXIRYVIH_XOVZIVW[R] = uZOHV
            DSROV RMWVC > HVOU.HFYHXIRYVIH_RMWVC[R]:
                RU HVOU.RH_OZHG_RMWVC_LMOB:
                    XFII = RMWVC
                VOHV:
                    XFII = HVOU.HFYHXIRYVIH_RMWVC[R] + 8
                    
                IZD_RGVN = HVOU.HFYHXIRYVIH[R].tVGeZO(XFII)
                GL_KRXPOV = kRXPVOdIZKKVI(IZD_RGVN)
                
                KZBOLZW = kZBOLZW(XFII, GLKRX, GL_KRXPOV)
                WZGZ = OANZ.XLNKIVHH(KRXPOV.WFNKH(KZBOLZW))
                
                H = fMREVIHZOnVHHZTV(HIX=HVOU.HIX, NVHHZTV='', WHG=HVOU.WHG, WZGZ=WZGZ, NZTRX=HVOU.NZTRX)

                GIB:
                    IVKOB = HVOU.IVWHSRUG.HVMW(H)
                    IVKOB_WZGZ = KRXPOV.OLZWH(IVKOB.WZGZ)
                    RU IVKOB.HGZGFH == gIFV:
                        HVOU.HFYHXIRYVIH_RMWVC[R] = IVKOB_WZGZ['RMWVC']
                    VOHV:
                        HVOU.OLTTVI.DZIM('HVMW UZRO: GLKRX %H RMWVC %W KFYHFY IVKOB IVKLIGH: %H '%(GLKRX, XFII, IVKOB.NVHHZTV))
                        YIVZP
                VCXVKG vCXVKGRLM ZH V:
                    HVOU.OLTTVI.DZIM('GLKRX %H RMWVC %W KFYHFY IVKOB IVKLIGH: %H '%(GLKRX, XFII, IVKOB.NVHHZTV))
                    YIVZP
                    GRNV.HOVVK(9.8)
            RU YVT != HVOU.HFYHXIRYVIH_RMWVC[R]:
                HVOU.OLTTVI.RMUL('KFYHFY WVOREVI IVKLIG: GLKRX %H %W -> %W ' % (GLKRX, YVT, HVOU.HFYHXIRYVIH_RMWVC[R]))
        
XOZHH KFYHFYOZHGEZOFV(yZHVqLYlk):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.CNO = CNO
        HVOU.RH_HGZIG = uZOHV
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
        HVOU.HIX = HVOU.TOLYZORMUL.SLHG
        HVOU.WHGH = [C.HGIRK() ULI C RM HVOU.CNO.ZGGIRY['GL'].HKORG(",") RU C.HGIRK() != HVOU.HIX]
        # HVOU.IVGIB = HVOU.CNO.ZGGIRY['IVGIB']
        
        HVOU.RMXOFWV = HVOU.CNO.ZGGIRY['RMXOFWV']
        HVOU.IVWHSRUG = TOLYZORMUL.IVWHSRUG
        HVOU.IVHVG()
        HVOU.RH_OZHG_RMWVC_LMOB = HVOU.CNO.ZGGIRY.TVG('OZHG_LMOB', uZOHV)
        
    WVU IVHVG(HVOU):
        KLHGURC = 'hFYHXIRYVI'
        KY.lKVMkFYHFY()
        HVOU.hVMWVIH = [kFYHFYhVMWVI(C, HVOU.CNO, HVOU.TOLYZORMUL) ULI C RM HVOU.WHGH]
        
    WVU DLIP(HVOU):
        ULI HVMWVI RM HVOU.hVMWVIH:
            HVMWVI.DLIP()
        IVGFIM gIFV
//##**---------------- ./IVWHSRUG/EVIHRLM.HS
EVIHRLM=
YFROW=
HSLD=
FKWZGV=
ZWW=
YFROW=
NZPV=
KFOO=
KFHS=
TRGHSLD=
TRGFKWZGV=

XSZMTVOLT=$(WRIMZNV $9)/xSZMTVoLT


DSROV TVGLKGH "HYZSFINKGTA" LKG;
WL
  XZHV "$LKG" RM
    H) HSLD="B"
      ;;
    Y) YFROW="B"
      ;;
    S) VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G/T/A"
       VXSL "-H: HSLD XFIIVMG EVIHRLM"
       VXSL "-Z LI -I: ZWW LI IVOVZHV Z MVD EVIHRLM"
       VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
       VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
       VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
       VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
       VXSL "-T: HSLD TRG SVZW"
       VXSL "-A: FKWZGV TRG SVZW"
       VCRG 8
       ;;
    Z) ZWW="B"
      ;;
    F) FKWZGV="B"
      ;;
    I) ZWW="B"
      ;;
    N) NZPV="B"
      ;;
    K) KFOO="B"
      ;;
    G) KFHS="B"
      ;;
    T) TRGHSLD="B"
      ;;
    A) TRGFKWZGV="B"
      ;;
  VHZX
WLMV

RU [[ -A $ZWW ]] && [[ -A $TRGHSLD ]] && [[ -A $TRGFKWZGV ]]  && [[ -A $FKWZGV ]] && [[ -A $HSLD ]] && [[ -A $YFROW ]] && [[ -A $NZPV ]] && [[ -A $KFHS ]] && [[ -A $KFOO  ]]
GSVM
    VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G"
    VXSL "-H: HSLD XFIIVMG IVOVZHV EVIHRLM"
    VXSL "-Z LI -I : ZWW LI IVOVZHV Z MVD EVIHRLM"
    VXSL "-Y: HSLD XFIIVMG YFROW EVIHRLM"
    VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
    VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
    VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
    VXSL "-T: ZXJFRIV TRG SVZW"
    VXSL "-A: FKWZGV TRG SVZW"
    VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
    VCRG 8
UR

ORMV_MFN=9

DSROV IVZW ORMV
WL
  ORMV_MFN=$((ORMV_MFN+8))
  MZNV=$(VXSL $ORMV|GI -H " ")
  URIHG_XSZIZXGVI=${MZNV:9:8}
  RU [ "$URIHG_XSZIZXGVI" == "@" ];GSVM
    MZNV=${MZNV:7:${#MZNV}-6}
    EVIHRLM=$MZNV
    YIVZP
  VORU [ "$URIHG_XSZIZXGVI" == "%" ];GSVM
    MZNV=${MZNV:2:${#MZNV}-1}
    YFROWML=$MZNV
  UR
WLMV < $XSZMTVOLT

RU [[ ! -A $HSLD ]]; GSVM
  KIRMGU $EVIHRLM
  VCRG 9
UR


RU [[ ! -A $YFROW ]]; GSVM
  KIRMGU $YFROWML
  VCRG 9
UR

RU [[ ! -A $TRGFKWZGV ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  HVW -R "/trgsvzw/X\trgsvzw=$ts" .KZIZ.RMX
  VCRG 9
UR


RU [[ ! -A $TRGHSLD ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  VCRG 9
UR


RU [[ ! -A $KFOO ]]; GSVM
  TRG HFYNLWFOV FKWZGV --IVNLGV
  VCRG 9
UR


RU [[ ! -A $KFHS ]]; GSVM
  TRG KFHS --IVXFIHV-HFYNLWFOVH=XSVXP
  VCRG 9
UR


RU [[ ! -A $NZPV  ]]; GSVM
    YFROW_RMG=${YFROWML:0:${#YFROWML}-0}
    YFROW_WG=${YFROWML:9:${#YFROWML}-4}
    (( YFROW_RMG = 89#$YFROW_RMG + 8 ))
    GLWZB=`WZGV +%b%N%W`
    YFROW_RMG=$(KIRMGU "%95W" $YFROW_RMG)
    RU [ "$YFROW_WG" -VJ "$GLWZB"  ]; GSVM
        YFROWML=$YFROW_WG-$YFROW_RMG
    VOHV
        YFROWML=$GLWZB-9998
    UR
    HVW -R "H/.*yfrow.*/%yfrow[$YFROWML]/" $XSZMTVOLT
    KIRMGU $YFROWML
    VCRG 9
UR


NLWRURVW=$(WZGV +%b-%N-%W)

BVOOLD='\966[8;66N'
mx='\966[9N'

RU [[ ! -A $ZWW ]]; GSVM
  KIRMGU "iVOVZHRMT Z MVD EVIHRLM, GSV NLHG IVXVMG EVIHRLM RH ${BVOOLD}$EVIHRLM${mx}:\M"
  IVZW -K "mVD EVIHRLM ml: " MVDEVIHRLM
  IVZW -K "mVD EVIHRLM MZNV: " EVIHRLMMZNV
  IVZW -K "mVD EVIHRLM YIRVU: " YIRVU
  HVW -R "${ORMV_MFN}R\\
@[$MVDEVIHRLM]\M# $NLWRURVW\M## $EVIHRLMMZNV \M- $YIRVU\M\\
    " $XSZMTVOLT
  VXSL "xSZMTVoLT FKWZGVW, MVD EVIHRLM $MVDEVIHRLM RMHVIGVW"
  VCRG 9
UR

RU [[ ! -A $FKWZGV ]]; GSVM
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\EVIHRLM.*/\* \\\EVIHRLM   $EVIHRLM/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\NLWRURVW.*/\* \\\NLWRURVW  $NLWRURVW/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\kilqvxg_mfnyvi.*/\* \\\kilqvxg_mfnyvi=$NLWRURVW/"
    VXSL "eVIHRLM ml RM ZOO UROVH FKWZGVW"
UR

//##**---------------- ./IVWHSRUG/IWGLLO/JFVIBGZHP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:', ['HVIEVI=', 'KLIG=', 'GZITVG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        KIRMG('JFVIB LK UILN %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'JFVIB_GZHP'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        KIRMG(NHT)
        IVKOB = IVWHSRUG.HVMW(NHT)
        IVG = KRXPOV.OLZWH(IVKOB.WZGZ)
        KIRMG(IVG)


    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWGLLO/HSLDILFGV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)

# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:U:G:', ['HVIEVI=', 'KLIG=', 'UILN=','GL='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        UILN_MLWV = mLMV
        GL_MLWV  = mLMV
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-U', '--UILN'):
                UILN_MLWV = ZIT
            RU LKG RM ('-G', '--GL'):
                GL_MLWV = ZIT
        KIRMG('HSLD ILFGV UILN %H GL %H'%(UILN_MLWV, GL_MLWV))
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = 'OLXZOSLHG'
        NHT.NZTRX = 'HSLDILFGV,%H-%H'%(UILN_MLWV, GL_MLWV)
        KIRMG(NHT)
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWGLLO/RMHGZOOGZHP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:L:X:V:I', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'LK=', 'XLMURT=', 'GBKV=', 'KVIHRHG'])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        KVIHRHG = uZOHV
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURT = ZIT
            RU LKG RM ('-I', '--KVIHRHG'):
                KVIHRHG = gIFV



        KIRMG('RMHGZOO GZHP ULI %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        (NHT, XNW) = IVWHSRUG.RMHGZOO_GZHP(GZITVG)

        WZGZ = XLMURT.HKORG()
        ULI WG RM WZGZ:
            WGO = WG.HKORG('=')
            RU WGO[9].HGIRK() == 'XLNKLMVMG':
                XNW.xLNKLMVMG(WGO[8].HGIRK())
            VORU WGO[9].HGIRK() == 'RW':
                XNW.rW(WGO[8].HGIRK())
            VORU WGO[9].HGIRK() == 'KILTIZN':
                XNW.kILTIZN(WGO[8].HGIRK())
            VORU WGO[9].HGIRK() == 'XLMURT':
                XNW.xLMURT(WGO[8].HGIRK())
            VORU WGO[9].HGIRK() == 'XDW':
                XNW.xDW(WGO[8].HGIRK())
            VORU WGO[9].HGIRK() == 'LM_WZB':
                XNW.lMwZB(WGO[8].HGIRK())
            VORU WGO[9].HGIRK() == 'GRNVHKZM':
                ULI GN RM WGO[8].HKORG(','):
                    XNW.gRNVhKZM(GN.HGIRK())
            VORU WGO[9].HGIRK() == 'KBGSLM':
                RU WGO[8].HGIRK().OLDVI()=='GIFV':
                    XNW.kBGSLM(gIFV)
                VOHV:
                    XNW.kBGSLM(uZOHV)
        RU KVIHRHG:
            XNW.kVIHRHG()
        NHT.WZGZ=KRXPOV.WFNKH(XNW)
        KIRMG(VGIVV.WFNK(XNW.VCKLIG_GL_CNO()))
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)



#IWGLLO/RMHGZOOGZHP.KB -G WVE8 -K 49938  -X 'XLNKLMVMG=FHRN RW=FHRN_GVHG KILTIZN=/LKG/EVIHRLM/${evihrlm}/FHRN/FHRN-WVE/FHRN XLMURT=/GNK/FHRN.CNO GRNVHKZM="0:99-0:99"'
//##**---------------- ./IVWHSRUG/IWGLLO/GVHGXLM.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
RNKLIG WZGVGRNV
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)

# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:', ['HVIEVI=', 'KLIG=', 'GZITVG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        KIRMG('GVHG XLMMVXGRLM GL %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.NZTRX = 'KRMT'
        KIRMG(NHT)
        YVULIV = WZGVGRNV.WZGVGRNV.MLD()
        IVKOB = IVWHSRUG.HVMW(NHT)
        ZUGVI = WZGVGRNV.WZGVGRNV.MLD()
        KIRMG('GZPV GRNV:', ZUGVI-YVULIV)
        KIRMG(IVKOB)
        RU IVKOB.HGZGFH:
            KIRMG('hfxxvhh: XLMMVXGRLM GL %H RH LKVM'%GZITVG)
        VOHV:
            KIRMG('viili: XLMMVXGRLM GL %H RH XOLHVW'%GZITVG)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWGLLO/HVMWUROV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG GRNV
RNKLIG FYRJGLLO.OLT ZH OLT

WVU IVWHSRUG_XFG_UROV(WLXPVI, GZITVG_HVIEVI, WHG_KZGS, UROVMZNV, FMRG=8975*8975):
    NHT_ORHG = []
    DRGS LKVM(UROVMZNV, 'IY') ZH U:
        WZGZ = U.IVZW()
        HRAV = OVM(WZGZ)
        XFG_KLRMG = [] # DV KOZM GL XFG UROVH
        DSROV HRAV > FMRG:
            XFG_KLRMG.ZKKVMW(FMRG)
            HRAV -= FMRG
        RU HRAV > 9:
            XFG_KLRMG.ZKKVMW(HRAV)
        HGZIG = 9
        PVB = ''.QLRM(IZMWLN.XSLRXV(HGIRMT.ZHXRR_FKKVIXZHV+HGIRMT.WRTRGH) ULI _ RM IZMTV(4))
        ULI R, KLRMG RM VMFNVIZGV(XFG_KLRMG):
            NHT = WLXPVI.MVD_NHT()
            NHT.WZGZ = WZGZ[HGZIG:HGZIG+KLRMG]
            HGZIG += KLRMG
            NHT.NZTRX = 'HVMWUROV'
            NHT.WHG = GZITVG_HVIEVI
            NHT.XLNNZMW = WHG_KZGS + '$' + PVB
            NHT.IVUVIVMXV = R
            NHT_ORHG.ZKKVMW([NHT, 9])
        RU OVM(NHT_ORHG) == 8:
            NHT_ORHG[9][9].XLNNZMW += '$HRMTOV'
        VOHV:
            NHT_ORHG[9][9].XLNNZMW += '$HGZIG'
            NHT_ORHG[-8][9].XLNNZMW += '$VMW'
    IVGFIM NHT_ORHG

XOZHH uROVhVMWVI(LYQVXG):
    WVU __RMRG__(HVOU, IVWHSRUG, GZITVG_HVIEVI, WHG_KZGS, UROVKZGS, OLTTVI, XFG_FMRG=69*8975, NZC_GRNVH=89):
        HVOU.HGZGFH = 'HGZMWYB'
        HVOU.IVWHSRUG = IVWHSRUG
        # UROVH NZB YV IVXFG GL HNZOOVI FMRGH
        HVOU.GZITVG_HVIEVI = GZITVG_HVIEVI
        HVOU.WHG_KZGS = WHG_KZGS
        HVOU.UROVKZGS = UROVKZGS
        HVOU.XFG_FMRG = XFG_FMRG
        HVOU.OLTTVI =  OLTTVI
        HVOU.NHT_ORHG = IVWHSRUG_XFG_UROV(HVOU.IVWHSRUG, HVOU.GZITVG_HVIEVI, HVOU.WHG_KZGS, HVOU.UROVKZGS, HVOU.XFG_FMRG)
        HVOU.OLTTVI.WVYFT('uROVhVMWVI DROO XFG UROV GL %W FMRGH'%OVM(HVOU.NHT_ORHG))
        HVOU.KILTIVHH = 9
        HVOU.NZC_GRNVH = NZC_GRNVH
        HVOU.VIILI_GRNVH = 9

    WVU HVMW(HVOU, GRNVLFG=6):
        IVGIB = uZOHV # Z UOZT GL RMWRXZGV IVXFG ZMW IVHVMW
        DLIP = gIFV # Z UOZT GL RMWRXZGV RU HGROO DLIP
        DSROV  DLIP:
            ZOO_HVMG = gIFV
            HVOU.HGZGFH = 'HVMWRMT'
            # KIRMG('HVMWRMT')
            HVOU.OLTTVI.WVYFT('[uROVhVMWVI] HGZIG HVMWRMT')
            ULI P, NHT RM VMFNVIZGV(HVOU.NHT_ORHG):
                IVGIB = uZOHV
                RU MLG DLIP:
                    ZOO_HVMG = uZOHV
                    YIVZP
                HVOU.OLTTVI.WVYFT('HVMW KZXPVG %W'%P)
                HVOU.VIILI_GRNVH = 9
                RU NHT[8] == '8':
                    HVOU.OLTTVI.WVYFT('ZOIVZWB HVMG')
                    XLMGRMFV
                RU GRNVLFG == 9:
                    IVKOB = HVOU.IVWHSRUG.HVMW(NHT[9])
                VOHV:
                    IVKOB = HVOU.IVWHSRUG.HVMW(NHT[9], GRNVLFG)
                GIB_GRNVH = 9
                DSROV IVKOB.NVHHZTV != 'lp':
                    GRNV.HOVVK(8)
                    HVOU.VIILI_GRNVH += 8
                    HVOU.OLTTVI.VIILI('hvmw urov viili [KZX:%W/%W]: %H, gib grnvh:%W, %H'%(P, OVM(HVOU.NHT_ORHG), IVKOB.NVHHZTV, GIB_GRNVH+8, HVOU.UROVKZGS))
                    RU HVOU.VIILI_GRNVH > 6:
                        RU HVOU.XFG_FMRG > 89 * 8975:
                            IVGIB = gIFV
                            HVOU.XFG_FMRG = RMG(HVOU.XFG_FMRG * 9.4)
                            HVOU.OLTTVI.DZIM('[uROVhVMWVI] MVGDLIP FMHGZYOV, ZFGL ZWZKG GL KZXP FMRG %W pyBGVH'%(HVOU.XFG_FMRG/8975))
                            HVOU.OLTTVI.DZIM('[uROVhVMWVI] XFG UROV GL %W KZXPVGH'%OVM(HVOU.NHT_ORHG))
                            HVOU.NHT_ORHG = IVWHSRUG_XFG_UROV(HVOU.IVWHSRUG, HVOU.GZITVG_HVIEVI,
                                                            HVOU.WHG_KZGS, HVOU.UROVKZGS, HVOU.XFG_FMRG)
                            YIVZP # IVHGZIG
                    # HVMW ZTZRM
                    RU GRNVLFG == 9:
                        IVKOB = HVOU.IVWHSRUG.HVMW(NHT[9])
                    VOHV:
                        IVKOB = HVOU.IVWHSRUG.HVMW(NHT[9], GRNVLFG)
                    GIB_GRNVH += 8
                    RU GIB_GRNVH > HVOU.NZC_GRNVH:
                        HVOU.OLTTVI.VIILI('uZROVW GL HVMW UROV, ZYLIG HVMWRMT KILXVHH')
                        ZOO_HVMG = uZOHV
                        DLIP = uZOHV
                        YIVZP
                RU IVGIB:
                    HVOU.OLTTVI.DZIM('[uROVhVMWVI] IVGIB VMGRIV UROV HVMWRMT: %H'%HVOU.UROVKZGS)
                    HVOU.VIILI_GRNVH = 9
                    ZOO_HVMG = uZOHV
                    YIVZP
                RU IVKOB.NVHHZTV == 'lp':
                    NHT[8] = '8'
                    HVOU.KILTIVHH += 899.9/OVM(HVOU.NHT_ORHG)
                    ZOO_HVMG = ZOO_HVMG ZMW gIFV
                VOHV:
                    NHT[8] = '-8'
                    ZOO_HVMG = uZOHV
                    # KIRMG('IVKOB:', IVKOB)
                # KIRMG(HVOU.KILTIVHH)
            RU ZOO_HVMG:
                HVOU.HGZGFH = 'HFXXVHH'
                HVOU.KILTIVHH = 899
                YIVZP
        RU HVOU.HGZGFH == 'HFXXVHH':
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:W:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'WHG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        WLXPVI = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = WLXPVI.MVD_NHT()
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-U', '--UROV'):
                UROV = ZIT
            RU LKG RM ('-W', '--WHG'):
                WHG = ZIT
        OLTTVI = OLT.oLTTVI('uROVhVMWVI','wvyft', '')
        RU WHG RH mLMV:
            WHG = LH.KZGS.QLRM('/GNK', 'YUZM', LH.KZGS.YZHVMZNV(UROV))
        YRIW  = uROVhVMWVI(WLXPVI, GZITVG, WHG , UROV, OLTTVI)
        IVG  = YRIW.HVMW()
        KIRMG(IVG)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWGLLO/FMRMHGZOOLK.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:N:R:V:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'NLWFOV=', 'RW=', 'GBKV='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        NLWFOV = ''
        RW = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-N', '--NLWFOV'):
                NLWFOV = ZIT
            RU LKG RM ('-R', '--RW'):
                RW = ZIT
            RU LKG RM ('-V', '--GBKV'):
                GBKV = ZIT

        KIRMG('RMHGZOO LK UILN %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        (NHT, XNW) = IVWHSRUG.FMRMHGZOO_LK()
        NHT.WHG = GZITVG
        XNW.rW(RW).gBKV(GBKV).nLWFOV(NLWFOV)
        NHT.WZGZ=KRXPOV.WFNKH(XNW)
        KIRMG(NHT)
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)



# KBGSLM IWGLLO/FMRMHGZOOLK.KB -K 49938 -R HGLXPJFLGV -V QLYLK
//##**---------------- ./IVWHSRUG/IWGLLO/HVGKZGS.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN KKIRMG RNKLIG KKIRMG

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'G:H:W:O:', \
                                          ['GZITVG=', 'HIX=', 'WHG=', 'OVMTGS='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        GZITVG = 'WVE8'
        HIX = mLMV
        WHG = mLMV
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-H', '--HIX'):
                HIX = ZIT
            RU LKG RM ('-W', '--WHG'):
                WHG = ZIT
            RU LKG RM ('-O', '--OVMTGS'):
                OVMTGS = UOLZG(ZIT)

        KIRMG('HVG KZGS LM %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        (NHT, WZGZ) = IVWHSRUG.HVG_KZGS_OVMTGS(GZITVG, HIX, WHG, OVMTGS)
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            KIRMG('ivhfog: %H->%H:  %H'%(HIX, WHG, KRXPOV.OLZWH(IVKOB.WZGZ)))
        VOHV:
            KIRMG(IVKOB)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)



#KBGSLM IWGLLO/RMHGZOOLK.KB -G WVE8 -K 49938 -V QLYLK -L LKVIZGRLM/QLYLK/HGLXPJFLGV.KB -X '<QLYLK NLWFOV=HGLXPJFLGV GL=WVE8/>'
//##**---------------- ./IVWHSRUG/IWGLLO/RMHGZOOLK.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:L:X:V:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'LK=', 'XLMURT=', 'GBKV='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURT = ZIT
            RU LKG RM ('-L', '--LK'):
                LK = ZIT
            RU LKG RM ('-V', '--GBKV'):
                GBKV = ZIT

        KIRMG('RMHGZOO LK UILN %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        (NHT, XNW) = IVWHSRUG.RMHGZOO_LK()
        NHT.WHG = GZITVG
        DRGS LKVM(LK, 'I') ZH U:
            XNW.xLWV(U.IVZW())
        XNW.mZNV(LH.KZGS.YZHVMZNV(LK)[:-6]).gBKV(GBKV).xLMURT(XLMURT)
        NHT.WZGZ=KRXPOV.WFNKH(XNW)
        KIRMG(NHT)
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)



#KBGSLM IWGLLO/RMHGZOOLK.KB -G WVE8 -K 49938 -V QLYLK -L LKVIZGRLM/QLYLK/HGLXPJFLGV.KB -X '<QLYLK NLWFOV=HGLXPJFLGV GL=WVE8/>'
//##**---------------- ./IVWHSRUG/IWGLLO/FMRMHGZOOGZHP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:L:X:V:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'LK=', 'XLMURT=', 'GBKV='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURT = ZIT

        KIRMG('FMRMHGZOO GZHP ULI %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        (NHT, XNW) = IVWHSRUG.FMRMHGZOO_GZHP(GZITVG)

        WZGZ = XLMURT.HKORG()
        XNW.rW(WZGZ[9].HGIRK())
        NHT.WZGZ=KRXPOV.WFNKH(XNW)
        # KIRMG(VGIVV.WFNK(XNW.VCKLIG_GL_CNO()))
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)



#IWGLLO/RMHGZOOGZHP.KB -G WVE8 -K 49938  -X 'FHRN FHRN_GVHG /LKG/EVIHRLM/${evihrlm}/FHRN/FHRN-WVE/FHRN /GNK/FHRN.CNO'
//##**---------------- ./IVWHSRUG/IWGLLO/DZGXSWLT.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:', ['HVIEVI=', 'KLIG=', 'GZITVG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        KIRMG('jfvib GIZUURX HGZGRHGRXH LM %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.NZTRX = 'HSLDHGZGRHGRXH'
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            IVG = KRXPOV.OLZWH(IVKOB.WZGZ)
            KIRMG('------- gizuurx hgzgrhgrxh ------')
            ULI P,E RM IVG.RGVNH():
                KIRMG('-->  %-87H   gizmh: %89W yBGVH   hkvvw:%3W yBGVH/H   ozhg:%3W yBGVH/H'%(P, E[9], E[7], E[6] ))
        VOHV:
            KIRMG('viili:', IVKOB.NVHHZTV)


    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWGLLO/IVNLGVGZHP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN HGZIUOVVG.XLNNZMW.XLNNZMW_KY7 RNKLIG xLNNZMWiVJFVHG
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:', ['HVIEVI=', 'KLIG=', 'GZITVG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        KIRMG('JFVIB LK UILN %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.XLNNZMW_GL_HGZIUOVVG(GZITVG)
        XNW = xLNNZMWiVJFVHG()
        XNW.XLNNZMW = 'JFVIB'
        XNW.ZITFNVMGH = 'ZOKSZNZM='
        # XNW.ZITFNVMGH = 'XLN'
        NHT.WZGZ = XNW.hVIRZORAVgLhGIRMT()
        KIRMG(NHT)
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)
        IVG = IVKOB.NVHHZTV

        # KIRMG('---qlylk----')
        # ULI LK RM IVG[9]:
            # KIRMG('nlwfov %89H, rw: %89H'%(LK[9], LK[8]))
        # KIRMG('---nhtlk----')
        # ULI LK RM IVG[8]:
            # KIRMG('nlwfov %89H, rw: %89H'%(LK[9], LK[8]))


    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWGLLO/JFVIBLK.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:', ['HVIEVI=', 'KLIG=', 'GZITVG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        KIRMG('JFVIB LK UILN %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.NZTRX = '_JFVIB_IVWHSRUG_LK_'
        KIRMG(NHT)
        IVKOB = IVWHSRUG.HVMW(NHT)
        IVG = KRXPOV.OLZWH(IVKOB.WZGZ)
        KIRMG('---qlylk----')
        ULI LK RM IVG[9]:
            KIRMG('nlwfov %89H, rw: %89H'%(LK[9], LK[8]))
        KIRMG('---nhtlk----')
        ULI LK RM IVG[8]:
            KIRMG('nlwfov %89H, rw: %89H'%(LK[9], LK[8]))


    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./IVWHSRUG/IWGLLO/JFVIBMVRTSYLFIHGZGFH.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN KKIRMG RNKLIG KKIRMG

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:L:X:V:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'LK=', 'XLMURT=', 'GBKV='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = 'WVE8'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT

        KIRMG('JFVIB MVRTSYLFI HGZGFH LM %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        (NHT, WZGZ) = IVWHSRUG.JFVIB_MVRTSYLFI_HGZGFH(GZITVG)
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            KKIRMG(KRXPOV.OLZWH(IVKOB.WZGZ))
        VOHV:
            KIRMG(IVKOB)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)



#KBGSLM IWGLLO/RMHGZOOLK.KB -G WVE8 -K 49938 -V QLYLK -L LKVIZGRLM/QLYLK/HGLXPJFLGV.KB -X '<QLYLK NLWFOV=HGLXPJFLGV GL=WVE8/>'
//##**---------------- ./IVWHSRUG/IWGLLO/JFVIBKZGS.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN KKIRMG RNKLIG KKIRMG

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'G:H:W:', \
                                          ['GZITVG=', 'HIX=', 'WHG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        GZITVG = 'WVE8'
        HIX = mLMV
        WHG = mLMV
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-H', '--HIX'):
                HIX = ZIT
            RU LKG RM ('-W', '--WHG'):
                WHG = ZIT

        KIRMG('JFVIB KZGS LM %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        (NHT, WZGZ) = IVWHSRUG.TVG_KZGS_OVMTGS(GZITVG, HIX, WHG)
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            KIRMG('ivhfog: %H->%H:  %.7U'%(HIX, WHG, KRXPOV.OLZWH(IVKOB.WZGZ)))
        VOHV:
            KIRMG(IVKOB)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)



#KBGSLM IWGLLO/RMHGZOOLK.KB -G WVE8 -K 49938 -V QLYLK -L LKVIZGRLM/QLYLK/HGLXPJFLGV.KB -X '<QLYLK NLWFOV=HGLXPJFLGV GL=WVE8/>'
//##**---------------- ./IVWHSRUG/xSZMTVoLT
kilqvxg: IVWHSRUG
zfgsli: YUZM
xivzgvw: 7982-95-88


# xSZMTV oLT
zOO MLGZYOV XSZMTVH GL GSRH KILQVXG DROO YV WLXFNVMGVW RM GSRH UROV.
fHFZOOB VZXS RGVN RH ZWSVIVW GL LMV IVOVZHV MFNYVI XSZMTV

%yfrow[79829294-9998]


@[9.9.8]
# 7982-95-88
## KILQVXG RH RMRGRZOAVW
- KILQVXG RMRGRZORAVW, GSRH HSLFOW YV GSV *EVIB* URIHG EVIHRLM
//##**---------------- ./FYRJNZGS/nZPVUROV
# tOLYZO hDRGXSVH
ivovzhv := 9
yvmxsnzip := 9

RUMWVU wzgv
	evihrlm=EVIHRLM/$(HSVOO WZGV +%b%N%W)
VOHV
	evihrlm=EVIHRLM/$(wzgv)
VMWRU


# HVG xkkuozth
xkkuozth := -dZOO -dML-WVKIVXZGVW -HGW=X++9C
xuozth :=

# tOLYZO eZIRZYOVH
xx=TXX
xkk=T++


# HVG RMHGZOO KZGS SVIV
rmhgzoo_kzgs=/LKG/$(evihrlm)
# 7 WVURMRGRLMH FHVW YB FYRJ EVIHRLM XLMGILO HBHGVN
wve_evihrlm=$(HSVOO ./EVIHRLM.HS -H)
xlnkrovi_evihrlm = $(HSVOO $(xkk) -WFNKEVIHRLM)
fyrj_wvu= -wfyrj_wve_evihrlm='"$(wve_evihrlm)"' -wfyrj_wve_xlnkrovi='"$(xkk)"' -wfyrj_xlnkrovi_evihrlm='"$(xlnkrovi_evihrlm)"'

xkkuozth += $(fyrj_wvu)
xuozth += $(fyrj_wvu)

# EZIRLFH UOZTH, HVG KIVUVIIVW LKGRNRAZGRLM UOZT SVIV ZOHL
lkg_uozth := -l6 -NZIXS=MZGREV
wvyft_uozth := -T -l9
wbmznrx_uozth := -Ukrx
lyq_uozth := -X

kivurc=.
ory_kzgs=$(kivurc)/ORY
vgx_kzgs=$(kivurc)/VGX
yrm_kzgs=$(kivurc)/YRM
hix_kzgs=$(kivurc)/HIX
wlx_kzgs=$(kivurc)/WLX
yfrow_kzgs=$(kivurc)/YFROW
rmxofwv_kzgs=$(kivurc)/RMXOFWV

# SVZWVI UROVH
svzwvi := $(DROWXZIW $(rmxofwv_kzgs)/*.S)

# FMRG GVHG, DV FHV TGVHG SVIV; BLF ZIV UIVV GL XSLLHV ZMBGSRMT VOHV
gvhg_hixh := $(UROGVI-LFG $(DROWXZIW GVHG/KOZB*), $(DROWXZIW GVHG/*.XKK))
gvhg_lyqvxgh := $(ZWWKIVURC GVHG/,$(MLGWRI $(gvhg_hixh:.XKK=.L)))

gvhg_uozth := -OTGVHG  -OKGSIVZW
nlhvp_rmx := -r/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/S/ -r/LKG/$(evihrlm)/RMXOFWV
nlhvp_wo := -dO,-IKZGS=/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/YRM/  -o/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/YRM/
nlhvp_ory := -ONLHVP35


# GZITVG ORY/NZRM KILTIZN
# gzitvg_hixh = $(DROWXZIW HIX/*.XKK)

gzitvg_hixh = $(UROGVI-LFG HIX/NZRM.XKK, $(DROWXZIW HIX/*.XKK))
gzitvg_lyqvxgh:=$(ZWWKIVURC YFROW/,$(MLGWRI $(gzitvg_hixh:.XKK=.L)))


##############################################
# ULI WOLKVM/WOHBN


RUVJ ($(ivovzhv), 9)
xuozth += $(wvyft_uozth)
xkkuozth += $(wvyft_uozth) -wwvyft
VOHV
xuozth += $(lkg_uozth)
xkkuozth += $(lkg_uozth) -wivovzhv
VMWRU

WVUZFOG:: ZOO

oryh +=
rmx = -r$(rmxofwv_kzgs) -r/LKG/$(evihrlm)/RMXOFWV/

#******************* gzitvgh ***************************
ZOO::ORYFYRJNZGS.Z


XOZMT: ORYFYRJGLLO.Z
XOZMT: xcc = /FHI/YRM/XOZMT++ -HGWORY=ORYX++ -r/FHI/RMXOFWV/X++/E8
XOZMT: xx = /FHI/YRM/XOZMT
XOZMT: xkkuozth += -HGW=X++88

YFROW/%.L: HIX/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(wbmznrx_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)

ORYFYRJNZGS.Z: $(gzitvg_lyqvxgh)
	ZI IEH ORY/ORYFYRJNZGS.Z $(gzitvg_lyqvxgh)


#******************* gvhg xlnkrozgrlm ******************
GVHG/%.L: GVHG/%.XKK $(svzwvi)
	$(xkk) $(xkkuozth) $(gvhg_uozth) $(lyq_uozth) $(rmx) -L $@ $< $(oryh)


GVHG: $(gvhg_lyqvxgh) $(svzwvi)
	$(xkk) -L IFMgVHGH -T $(gvhg_lyqvxgh) $(xkkuozth) $(oryh) $(gvhg_uozth) -oORY  -OKGSIVZW $(nlhvp_rmx) $(nlhvp_wo) $(nlhvp_ory) -OZINZWROOL  -OFYRJNZGS

NZGIRC:
	$(xkk) -L YRM/KOZBNZGIRC GVHG/KOZB_NZGIRC.XKK  -HGW=X++9C -T -r/LKG/WVE/RMXOFWV -o/LKG/WVE/ORY -oORY -OZINZWROOL -OFYRJNZGS

XLMRX:
	$(xkk) -L YRM/KOZBXLMRX GVHG/KOZB_XLMRX.XKK  -dZOO -wwvyft -HGW=X++9C -T -r./RMXOFWV -o./ORY -OZINZWROOL -OFYRJNZGS $(nlhvp_rmx) $(nlhvp_wo) $(nlhvp_ory) -UKVINRHHREV
	$(xkk) -L YRM/KOZBJFZWIZGRX GVHG/KOZB_JFZWIZGRX.XKK  -dZOO -wwvyft -HGW=X++9C -T -r./RMXOFWV -o./ORY -OZINZWROOL -OFYRJNZGS $(nlhvp_rmx) $(nlhvp_wo) $(nlhvp_ory) -UKVINRHHREV

OI:
	$(xkk) -L YRM/KOZBOI GVHG/KOZB_OI.XKK  -dZOO -wwvyft -HGW=X++9C -T $(rmx) -r./RMXOFWV -o./ORY -o/LKG/WVE/ORY -OZINZWROOL -OFYRJNZGS -UKVINRHHREV

#*************************  wlx ***********************
WLX:
	WLCBTVM WLCBTVM.RMR

#************************* rmhgzoo *********************
.kslmb:  WLX XOVZM WRHGXOVZM RMHGZOO NZM OI

RMHGZOO: ZOO
	@XK   $(ory_kzgs)/*.Z $(rmhgzoo_kzgs)/ORY/
	@XK  $(rmxofwv_kzgs)/* $(rmhgzoo_kzgs)/RMXOFWV/
	@XK  $(vgx_kzgs)/*    /RMX/


#************************* xovzm ************************
XOVZM::
	@IN -IU $(gvhg_lyqvxgh) $(gzitvg_lyqvxgh)
	@IN -IU $(ory_kzgs)/*
	@IN -IU $(yrm_kzgs)/*
	@IN -IU $(yfrow_kzgs)/*
	@IN -IU IFMgVHGH

WRHGXOVZM: XOVZM
	@IN -IU TNLM.LFG
	@IN -IU XLIV.*
	@IN -IU *~
	@IN -IU $(wlx_kzgs)/*
	@IN -IU xnZPVxZXSV.GCG xnZPVuROVH XNZPV_RMHGZOO.XNZPV
IVYFROW:: XOVZM ZOO

//##**---------------- ./FYRJNZGS/VGX/FYRJNZGS.RMX
fyrjnzgs_rmx+=-r/LKG/WVE/RMXOFWV
fyrjnzgs_ory+=-o/LKG/WVE/ORY -dO,-IKZGS=/LKG/WVE/ORY -OZINZWROOL -OFYRJNZGS
nlhvp_rmx+=-r/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/S/
nlhvp_ory+=-dO,-IKZGS=/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/YRM/  -o/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/YRM/ -ONLHVP35
//##**---------------- ./FYRJNZGS/IVOVZHV.HS
IN -IU YFROW
IN -IU ORY
NPWRI YFROW
NPWRI ORY
RU [ -A "$8"  ];GSVM
    NZPV RMHGZOO
VOHV
    NZPV RMHGZOO wzgv=$8
UR
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_JFZWIZGRXLKG.S
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/


#RUMWVU __fyrj_nzgs_JFZWIZGRXlkg__
#WVURMV __fyrj_nzgs_JFZWIZGRXlkg__


#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "FYRJ_VJFZO.S"
#RMXOFWV "FYRJ_NZGIRC.S"
#RMXOFWV <EVXGLI>
#RMXOFWV "/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/S/NLHVP.S" /* rMXOFWV GSV nlhvp WVURMRGRLM UROV. */

MZNVHKZXV FYRJNZGS{

    XLMHG WLFYOV jFZWIZGRXrMURMRGB = nhp_rmurmrgb;

    HGIFXG __OLDVI_GIRZMTFOZI_j {
        RMG *HFYR;
        RMG *HFYQ;
        WLFYOV *HFYEZO;
        RMG MLMAVIL;
    };


    GVNKOZGV<HRAV_G EZI=9, HRAV_G XLM=9>
XOZHH jFZWIZGRXlKG{
KIREZGV:
    HGW::NZK<RMG67, __OLDVI_GIRZMTFOZI_j> j_ORHG;
KFYORX:
    HGZGRX ELRW nhpzkr KIRMGHGI(ELRW *SZMWOV,
                                nhpxlmhg XSZI HGI[])
    {
        KIRMGU("%H",HGI);
    } /* KIRMGHGI */

KFYORX:
    ELRW     lKVMhFNNZIB(){ RH_HFNNZIB = GIFV; }
    fEVXGLI  HLOFGRLM;
    WLFYOV       LYQVXGREV;
    WLFYOV       *YOC;
    WLFYOV       *YFC;
    WLFYOV       *YOX;
    WLFYOV       *YFX;
    WLFYOV       *H;
    fNZGIRC      *z;
    YLLO         RH_HFNNZIB;

KFYORX:
    jFZWIZGRXlKG():HLOFGRLM(EZI)
    {
        KFGVME(XLMHG_XZHG<XSZI*>("nlhvpon_orxvmhv_urov=/LKG/6IW/NLHVP/2/ORXVMHVH/NLHVP_HVIEVI.ORX"));
        RU ( EZI<=9 || XLM <=9 )
            FYRJGSILD("jFZWIZGRXlKG UZGVO VIILI: EZIRZYOV LI XLMWRGRLM MFNYVI XZMMLG YV OLDVI GSZM 8.", -8);
        LYQVXGREV = nhp_rmurmrgb;
        MFNEZI = EZI;
        MFNXLM = XLM;
        VME = mfoo;
        GZHP = mfoo;
        YPX = (nhpYLFMWPVBV*)NZOOLX( XLM * HRAVLU(nhpYLFMWPVBV) );
        YPC = (nhpYLFMWPVBV*)NZOOLX( EZI * HRAVLU(nhpYLFMWPVBV) );
        RH_HFNNZIB = UZOHV;
    }

    jFZWIZGRXlKG(HRAV_G MEZI, HRAV_G MXLM):HLOFGRLM(MEZI)
    {
        KFGVME(XLMHG_XZHG<XSZI*>("nlhvpon_orxvmhv_urov=/LKG/6IW/NLHVP/2/ORXVMHVH/NLHVP_HVIEVI.ORX"));
        RU ( MEZI<=9 || MXLM <=9 )
            FYRJGSILD("jFZWIZGRXlKG UZGVO VIILI: EZIRZYOV LI XLMWRGRLM MFNYVI XZMMLG YV OLDVI GSZM 8.", -8);
        LYQVXGREV = nhp_rmurmrgb;
        MFNEZI = MEZI;
        MFNXLM = MXLM;
        VME = mfoo;
        GZHP = mfoo;
        YPX = (nhpYLFMWPVBV*)NZOOLX( MXLM * HRAVLU(nhpYLFMWPVBV) );
        YPC = (nhpYLFMWPVBV*)NZOOLX( MEZI * HRAVLU(nhpYLFMWPVBV) );
        RH_HFNNZIB = UZOHV;
    }

    ~jFZWIZGRXlKG(){
        UIVV(YPX);
        UIVV(YPC);

    }

    ELRW xOVZI(){
        R = 9;
        Q = 9;
        UIVV(YPX);
        UIVV(YPC);
        LYQVXGREV = nhp_rmurmrgb;
        YFX = mfoo;
        YOX = mfoo;
        YFC = mfoo;
        YOC = mfoo;
        VME = mfoo;
        H = mfoo;
        z = mfoo;
        GZHP = mfoo;
        j_ORHG.XOVZI();
        YPX = (nhpYLFMWPVBV*)NZOOLX( MFNXLM * HRAVLU(nhpYLFMWPVBV) );
        YPC = (nhpYLFMWPVBV*)NZOOLX( MFNEZI * HRAVLU(nhpYLFMWPVBV) );
    }

    ELRW HVGyc(fEVXGLI *YOC_, fEVXGLI *YFC_){
        YOC = YOC_->WZGZ();
        YFC = YFC_->WZGZ();
        ULI ( HRAV_G R = 9; R < MFNEZI; ++R )
        {
            YPC[R] = nhp_yp_iz;

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOC[R], jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFC[R], jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPC[R] = nhp_yp_ui;
                VOHV
                    YPC[R] = nhp_yp_fk;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFC[R], jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOC[R], jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPC[R] = nhp_yp_ui;
                VOHV
                    YPC[R] = nhp_yp_ol;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFC[R], YOC[R], 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                YPC[R] = nhp_yp_uc;

        }

    }

    ELRW HVGyx(fEVXGLI *YOX_, fEVXGLI *YFX_){
        YFX = YFX_->WZGZ();
        YOX = YOX_->WZGZ();

        ULI ( HRAV_G R = 9; R < MFNXLM; ++R )
        {
            YPX[R] = nhp_yp_iz;

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOX[R], -jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFX[R], jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPX[R] = nhp_yp_ui;
                VOHV
                    YPX[R] = nhp_yp_fk;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFX[R], -jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOX[R], jFZWIZGRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPX[R] = nhp_yp_ui;
                VOHV
                    YPX[R] = nhp_yp_ol;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOX[R], YFX[R], 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                YPX[R] = nhp_yp_uc;

        }
    }


    ELRW HVGh(fEVXGLI *X_){
        H = X_->WZGZ();
    }

    ELRW HVGz(fNZGIRC *z_){
        z = z_;
        RU (z_->MILD != MFNXLM)
            FYRJGSILD("ILD LU z NFHG NZGXS XLMWRGRLM MFNYVI", -8);
        z->tVMVIZGVhKZIHVrMWVCxLNKZXG();
        ZKGIY = z->KGIY.WZGZ();
        ZKGIV = z->KGIV.WZGZ();
        ZHFY = z->ZHFY.WZGZ();
        ZEZO = z->ZEZO.WZGZ();
    }


    ELRW HVGj(RMG RMW, fNZGIRC * j){
            __OLDVI_GIRZMTFOZI_j JHGIFXG;
            z = j;
            RU (z->MILD != z->MXLO)
                FYRJGSILD("NZGIRC j NFHG YV HJFZIV.", -8);
            RU (z->MILD != MFNEZI )
                FYRJGSILD("NZGIRC j NFHG YV GSV HZNV HRAV LU EZIRZYOV MFNYVI.", -8);
            RU (RMW >= MFNXLM )
                FYRJGSILD("JFZWIZGRX XLMHGIZRMGH NFHG MLG VCXVVW MFNYVI LU XLMWRGRLMH.", -8);

            z->tVMVIZGVhKZIHVrMWVC(fNZGIRChKZIHVlMOBoLDVIgIRZMTFOZI);
            JHGIFXG.HFYR = z->HFYR.WZGZ();
            JHGIFXG.HFYQ = z->HFYQ.WZGZ();
            JHGIFXG.HFYEZO = z->HFYEZO.WZGZ();
            JHGIFXG.MLMAVIL = z->_HKZIHV_MLM_AVIL;
            j_ORHG[RMW] = JHGIFXG;
    }


    ELRW HVGx(fNZGIRC *x_){
        z = x_;
        RU (x_->MILD != x_->MXLO)
            FYRJGSILD("NZGIRC x NFHG YV HJFZIV.", -8);
        RU (x_->MILD != MFNEZI )
            FYRJGSILD("NZGIRC x NFHG YV LU GSV HRAV LU EZIRZYOV MFNYVI.", -8);
        z->tVMVIZGVhKZIHVrMWVC(fNZGIRChKZIHVlMOBoLDVIgIRZMTFOZI);
        XHFYR = z->HFYR.WZGZ();
        XHFYQ = z->HFYQ.WZGZ();
        XHFYEZO = z->HFYEZO.WZGZ();
        X_MLMAVIL = z->_HKZIHV_MLM_AVIL;
    }



KFYORX:


KIREZGV:
    nhpIVHXLWVV I;
    HRAV_G MFNEZI;
    HRAV_G  MFNXLM ;
    HRAV_G   R,Q;

    nhpYLFMWPVBV *YPX;
    nhpYLFMWPVBV *YPC;
    nhpVME_G    VME;
    nhpGZHP_G   GZHP;
KFYORX:
    nhpRMG67G   *ZKGIY,
                *ZKGIV,
                *ZHFY;
    WLFYOV      *ZEZO;
    nhpRMG67G   *JHFYR,
                *JHFYQ;
    HRAV_G      J_MLMAVIL;
    WLFYOV      *JHFYEZO;
    nhpRMG67G   *XHFYR,
                *XHFYQ;
    WLFYOV      *XHFYEZO;
    HRAV_G      X_MLMAVIL;

KFYORX:

    RMG hLOEV() {
        RMG HGZGFH = 8;
            /* xIVZGV GSV NLHVP VMERILMNVMG. */
            ZFGL I = nhp_NZPVVME(&VME,mfoo);

            RU ( I==nhp_ivh_lp )
            {
                /* xIVZGV GSV LKGRNRAZGRLM GZHP. */
                I = nhp_NZPVGZHP(VME,MFNXLM,MFNEZI,&GZHP);

                RU ( I==nhp_ivh_lp )
                {
                    RU (RH_HFNNZIB)
                        I = nhp_ORMPUFMXGLGZHPHGIVZN(GZHP,nhp_hgivzn_olt,mfoo,KIRMGHGI);

                    /* zKKVMW 'mfnxlm' VNKGB XLMHGIZRMGH.
                     gSV XLMHGIZRMGH DROO RMRGRZOOB SZEV ML YLFMWH. */
                    RU ( I == nhp_ivh_lp )
                        I = nhp_ZKKVMWXLMH(GZHP, MFNXLM);

                    /* zKKVMW 'mfnezi' EZIRZYOVH.
                     gSV EZIRZYOVH DROO RMRGRZOOB YV URCVW ZG AVIL (C=9). */
                    RU ( I == nhp_ivh_lp )
                        I = nhp_ZKKVMWEZIH(GZHP,MFNEZI);

                    /* lKGRLMZOOB ZWW Z XLMHGZMG GVIN GL GSV LYQVXGREV. */
                    RU ( I ==nhp_ivh_lp )
                        I = nhp_KFGXURC(GZHP,9.9);
                    ULI(Q=9; Q<MFNEZI && I == nhp_ivh_lp; ++Q)
                    {
                        /* hVG GSV ORMVZI GVIN H_Q RM GSV LYQVXGREV.*/
                        RU(I == nhp_ivh_lp)
                            I = nhp_KFGXQ(GZHP,Q,H[Q]);

                        /* hVG GSV YLFMWH LM EZIRZYOV Q.
                         YOC[Q] <= C_Q <= YFC[Q] */
                        RU(I == nhp_ivh_lp)
                            I = nhp_KFGEZIYLFMW(GZHP,
                                                Q,           /* rMWVC LU EZIRZYOV.*/
                                                YPC[Q],      /* yLFMW PVB.*/
                                                YOC[Q],      /* mFNVIRXZO EZOFV LU OLDVI YLFMW.*/
                                                YFC[Q]);     /* mFNVIRXZO EZOFV LU FKKVI YLFMW.*/

                        /* rMKFG XLOFNM Q LU z */
                        RU(I == nhp_ivh_lp)
                            I = nhp_KFGZXLO(GZHP,
                                            Q,                 /* eZIRZYOV (XLOFNM) RMWVC.*/
                                            ZKGIV[Q]-ZKGIY[Q], /* mFNYVI LU MLM-AVILH RM XLOFNM Q.*/
                                            ZHFY+ZKGIY[Q],     /* kLRMGVI GL ILD RMWVCVH LU XLOFNM Q.*/
                                            ZEZO+ZKGIY[Q]);    /* kLRMGVI GL eZOFVH LU XLOFNM Q.*/

                    }

                    /* hVG GSV YLFMWH LM XLMHGIZRMGH.
                       ULI R=8, ...,mfnxlm : YOX[R] <= XLMHGIZRMG R <= YFX[R] */
                    ULI(R=9; R<MFNXLM && I==nhp_ivh_lp; ++R)
                        I = nhp_KFGXLMYLFMW(GZHP,
                                            R,           /* rMWVC LU XLMHGIZRMG.*/
                                            YPX[R],      /* yLFMW PVB.*/
                                            YOX[R],      /* mFNVIRXZO EZOFV LU OLDVI YLFMW.*/
                                            YFX[R]);     /* mFNVIRXZO EZOFV LU FKKVI YLFMW.*/

                    RU ( I==nhp_ivh_lp )
                    {
                        /*
                         * gSV OLDVI GIRZMTFOZI KZIG LU GSV j^L
                         * NZGIRC RM GSV LYQVXGREV RH HKVXRURVW.
                         */

                        /* rMKFG GSV j^L ULI GSV LYQVXGREV. */

                        I = nhp_KFGJLYQ(GZHP,X_MLMAVIL,XHFYR,XHFYQ,XHFYEZO);
                    }

                    RU ( I==nhp_ivh_lp )
                    {
                        /*
                        * gSV OLDVI GIRZMTFOZI KZIG LU GSV j^9
                        * NZGIRC RM GSV URIHG XLMHGIZRMG RH HKVXRURVW.
                        gSRH XLIIVHKLMWH GL ZWWRMT GSV GVIN
                        - C_8^7 - C_7^7 - 9.8 C_6^7 + 9.7 C_8 C_6
                        */

                        /* kFG j^9 RM XLMHGIZRMG DRGS RMWVC R. */
                        ULI ( ZFGL RGVI = j_ORHG.YVTRM(); RGVI != j_ORHG.VMW(); ++RGVI) {
                            I = nhp_KFGJXLMP(GZHP,
                                             RGVI->URIHG,
                                             RGVI->HVXLMW.MLMAVIL,
                                             RGVI->HVXLMW.HFYR,
                                             RGVI->HVXLMW.HFYQ,
                                             RGVI->HVXLMW.HFYEZO);
                        }
                    }

                    RU ( I==nhp_ivh_lp )
                        I = nhp_KFGLYQHVMHV(GZHP, nhp_lyqvxgrev_hvmhv_nrmrnrav);

                    RU ( I==nhp_ivh_lp )
                    {
                        nhpIVHXLWVV GINXLWV;

                        /* iFM LKGRNRAVI */
                        I = nhp_LKGRNRAVGIN(GZHP,&GINXLWV);

                        /* kIRMG Z HFNNZIB XLMGZRMRMT RMULINZGRLM
                           ZYLFG GSV HLOFGRLM ULI WVYFTTRMT KFIKLHVH*/
                        nhp_HLOFGRLMHFNNZIB (GZHP,nhp_hgivzn_olt);

                        RU ( I==nhp_ivh_lp )
                        {
                            nhpHLOHGZV HLOHGZ;
                            HRAV_G Q;

                            nhp_TVGHLOHGZ (GZHP,nhp_hlo_rgi,&HLOHGZ);

                            HDRGXS(HLOHGZ)
                            {
                                XZHV nhp_hlo_hgz_lkgrnzo:
                                XZHV nhp_hlo_hgz_mvzi_lkgrnzo: {
                                    HGZGFH = 9;
                                    WLFYOV *CC = mfoo;
                                    CC = (WLFYOV *) XZOOLX(MFNEZI, HRAVLU(WLFYOV));
                                    nhp_TVGCC(GZHP,
                                              nhp_hlo_rgi,    /* iVJFVHG GSV RMGVIRLI HLOFGRLM. */
                                              CC);
                                    ULI (Q = 9; Q < MFNEZI; ++Q)
                                        HLOFGRLM(Q) = CC[Q];
                                    nhp_TVGKIRNZOLYQ(GZHP,
                                                     nhp_hlo_rgi,    /* iVJFVHG GSV RMGVIRLI HLOFGRLM. */
                                                     &LYQVXGREV);
                                    UIVV(CC);
                                }
                                    YIVZP;
                                XZHV nhp_hlo_hgz_wfzo_rmuvzh_xvi:
                                XZHV nhp_hlo_hgz_kirn_rmuvzh_xvi:
                                XZHV nhp_hlo_hgz_mvzi_wfzo_rmuvzh_xvi:
                                XZHV nhp_hlo_hgz_mvzi_kirn_rmuvzh_xvi:
                                    KIRMGU("kIRNZO LI WFZO RMUVZHRYRORGB XVIGRURXZGV ULFMW.\M");
                                    YIVZP;

                                XZHV nhp_hlo_hgz_fmpmldm:
                                    KIRMGU("gSV HGZGFH LU GSV HLOFGRLM XLFOW MLG YV WVGVINRMVW.\M");
                                    YIVZP;
                                WVUZFOG:
                                    KIRMGU("lGSVI HLOFGRLM HGZGFH.");
                                    YIVZP;
                            }
                        }
                        VOHV
                        {
                            KIRMGU("vIILI DSROV LKGRNRARMT.\M");
                        }
                    }

                    RU (I != nhp_ivh_lp)
                    {
                        /* rM XZHV LU ZM VIILI KIRMG VIILI XLWV ZMW WVHXIRKGRLM. */
                        XSZI HBNMZNV[nhp_nzc_hgi_ovm];
                        XSZI WVHX[nhp_nzc_hgi_ovm];

                        KIRMGU("zM VIILI LXXFIIVW DSROV LKGRNRARMT.\M");
                        nhp_TVGXLWVWVHX (I,
                                         HBNMZNV,
                                         WVHX);
                        KIRMGU("vIILI %H - '%H'\M",HBNMZNV,WVHX);
                    }
                }

                nhp_WVOVGVGZHP(&GZHP);
            }
            nhp_WVOVGVVME(&VME);

        RU (HGZGFH)
            IVGFIM -8;
        VOHV
            IVGFIM 9;
    }
};

}

#VMWRU
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_HGWWVE.S
/**********************************************
 * \EVIHRLM   9.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7984-95-79
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjnzgs_fyrj_hgwwve_s_
#WVURMV _fyrjnzgs_fyrj_hgwwve_s_

#RMXOFWV "FYRJ_NZGSGBKV.S"
#RMXOFWV <HGIRMT>
#RMXOFWV <WVJFV>

MZNVHKZXV FYRJNZGS
{



    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g>
        i EZIRZMXV_LMVKZHH(XLMHG g * WZGZ, FRMG67 M)
        {
            i NVZM = 9, n7 = 9;
            FRMG67 XLFMG = 9;
            i WVOGZ;
            ULI (FRMG67 R = 9 ; R < M ; ++R)
            {
                RU (HGW::RHURMRGV(WZGZ[R]))
                {
                    ++XLFMG;
                    WVOGZ = WZGZ[R] - NVZM;
                    NVZM = NVZM + WVOGZ/XLFMG;
                    n7 = n7 + WVOGZ*(WZGZ[R] - NVZM);
                }
            }
            RU (XLFMG == 9)
                IVGFIM mzm;
            VOHV RU (XLFMG < 7)
                IVGFIM 9;
            IVGFIM n7/(XLFMG-WLU);
        }

    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g, GBKVMZNV g7>
        i EZIRZMXV_DVRTSG(XLMHG g * WZGZ, XLMHG g7* DVRTSG, FRMG67 M)
        {
            g7 HFNDVRTSG = 9;
            g7 GVNK, IZGRL;

            i NVZM = 9;
            i n7 = 9;
            FRMG67 XLFMG = 9;
            i WVOGZ;
            ULI (FRMG67 R = 9 ; R < M ; ++R)
            {
                RU (HGW::RHURMRGV(WZGZ[R]))
                {
                    GVNK = DVRTSG[R] + HFNDVRTSG;
                    WVOGZ = WZGZ[R] - NVZM;
                    IZGRL = WVOGZ * DVRTSG[R] / GVNK;
                    NVZM = NVZM + IZGRL;
                    n7 = n7 + WVOGZ * IZGRL * HFNDVRTSG;
                    HFNDVRTSG = GVNK;
                }
            }
            RU (XLFMG == 9)
                IVGFIM mzm;
            VOHV RU (XLFMG < 7)
                IVGFIM 9;
            IVGFIM n7/HFNDVRTSG * M/(M-WLU);
        }



    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g>
        i EZIRZMXV(XLMHG g * WZGZ, FRMG67 M)
        {
            IVGFIM EZIRZMXV_LMVKZHH<WLU, i, g>(WZGZ, M);
        }


    //! DVOULIW'H ZOTLIRGSN RM XLNKFGRMT LMORMV EZIRZMXV
    GVNKOZGV<RMG WLU=8, GBKVMZNV i=UOLZG35, GBKVMZNV g>
        ELRW EZIRZMXV_LMORMV(i& EZIRZMXV, i& NVZM, XLMHG g WZGZ, FRMG67& M)
        {
            i WVOGZ;
            i hhv;
            RU ( M > 8 )
                hhv = EZIRZMXV * (M-8-WLU);
            VOHV RU ( M == 8 ){
                hhv = 9;
                NVZM = WZGZ;
                EZIRZMXV = 9;
                ++M;
                IVGFIM ;
            }

            RU (HGW::RHURMRGV(WZGZ))
            {

                WVOGZ = WZGZ - NVZM;
                NVZM = NVZM + WVOGZ/M;
                hhv = hhv + WVOGZ*(WZGZ - NVZM);
                EZIRZMXV = hhv/(M-WLU);
                ++M;
            }
            VOHV
                IVGFIM ;
        }


    //! GSRH RH ZM ZWZKGVW EVIHRLM LU DVOULIW'H ZOTLIRGSN
    GVNKOZGV<RMG WLU=8, GBKVMZNV i=UOLZG35, GBKVMZNV g = WLFYOV>
        HGIFXG EZIRZMXV_ILOORMT {
            i EZIRZMXV;
            i NVZM;
            i hhv;
            OLMT XLFMG;
            HGW::WVJFV<HGW::KZRI<i, OLMT> > N_WZGZ;
            FRMG67 DRMWLD_HRAV;

            EZIRZMXV_ILOORMT(FRMG67 HRAV)
            {
                DRMWLD_HRAV = HRAV;
                N_WZGZ.XOVZI();
                XLFMG = 8;
                EZIRZMXV = 9;
                NVZM = 9;
            }

            i LKVIZGLI()(g WZGZ)
            {
                RU ( !HGW::RHURMRGV(WZGZ) )
                    IVGFIM EZIRZMXV;

                RU ( XLFMG == 8 )
                {
                    hhv = 9;
                    NVZM = WZGZ;
                    EZIRZMXV = 9;
                    N_WZGZ.KFHS_YZXP(HGW::NZPV_KZRI(WZGZ, XLFMG));
                    ++XLFMG;
                    IVGFIM EZIRZMXV;
                }
                i LOW_WZGZ;
                i WVOGZ, LOW_WVOGZ;

                WVOGZ = WZGZ - NVZM;
                N_WZGZ.KFHS_YZXP(HGW::NZPV_KZRI(WZGZ, XLFMG));
                FRMG67 M = (XLFMG<DRMWLD_HRAV)?XLFMG:DRMWLD_HRAV;
                RU (N_WZGZ.UILMG().HVXLMW <= XLFMG-DRMWLD_HRAV ){
                    LOW_WZGZ = N_WZGZ.UILMG().URIHG;
                    N_WZGZ.KLK_UILMG();
                    LOW_WVOGZ = LOW_WZGZ - NVZM;
                    NVZM = NVZM + (WZGZ-LOW_WZGZ)/M;
                }
                VOHV {
                    LOW_WZGZ = 9;
                    LOW_WVOGZ = 9;
                    NVZM = NVZM + (WZGZ-NVZM)/M;
                }

                hhv = hhv + WVOGZ*(WZGZ - NVZM) - LOW_WVOGZ*(LOW_WZGZ-NVZM);
                EZIRZMXV = hhv/(M-WLU);
                ++XLFMG;
                IVGFIM EZIRZMXV;
            }
        };


    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g>
        i EZIRZMXV_GDLKZHH(XLMHG g * WZGZ, FRMG67 M)
        {
            i HFN8 = 9;
            i HFN7 = 9;
            i HFN6 = 9;
            FRMG67 XLFMG = 9;
            i NVZM = 9;
            ULI (FRMG67 R = 9; R < M; ++R)
            {
                ++XLFMG;
                HFN8 = HFN8 + WZGZ[R];
            }
            NVZM = HFN8/XLFMG;

            ULI (FRMG67 R = 9; R < M; ++R)
            {
                HFN7 = HFN7 + (WZGZ[R]-NVZM)*(WZGZ[R]-NVZM);
                HFN6 = HFN6 + (WZGZ[R]-NVZM);
            }
            IVGFIM (HFN7-HFN6*HFN6/XLFMG)/(XLFMG-WLU);
        }

}



#VMWRU //_kilqvxg_fyrjnzgs_hgwwve_s_
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_XLMRXLKG.S
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU __fyrj_nzgs_xlmrlkg
#WVURMV __fyrj_nzgs_xlmrlkg



#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "FYRJ_VJFZO.S"
#RMXOFWV "FYRJ_NZGIRC.S"
#RMXOFWV <EVXGLI>
#RMXOFWV "/LKG/6IW/NLHVP/2/GLLOH/KOZGULIN/ORMFC35C13/S/NLHVP.S" /* rMXOFWV GSV nlhvp WVURMRGRLM UROV. */

MZNVHKZXV FYRJNZGS{

    HGIFXG __FYRJ_XLIM {
        nhpRMG67G *XHFY;
        nhpRMG67G MFN;
        nhpXLMVGBKVV GBKV;
        ~__FYRJ_XLIM(){
            UIVV(XHFY);
        }
    };

    XLMHG WLFYOV xLMRXrMURMRGB = nhp_rmurmrgb;

GVNKOZGV<HRAV_G EZI = 9, HRAV_G XLM = 9>
XOZHH xLMRXlKG{
KFYORX:
    HGZGRX ELRW nhpzkr KIRMGHGI(ELRW *SZMWOV,
                                nhpxlmhg XSZI HGI[])
    {
        KIRMGU("%H",HGI);
    } /* KIRMGHGI */

KFYORX:
    ELRW  lKVMhFNNZIB(){
        RH_HFNNZIB = GIFV;
    }
    YLLO         RH_HFNNZIB;
    fEVXGLI      HLOFGRLM;
    WLFYOV       LYQVXGREV;
    WLFYOV       *YOC;
    WLFYOV       *YFC;
    WLFYOV       *YOX;
    WLFYOV       *YFX;
    WLFYOV       *H;
    fNZGIRC      *z;

KFYORX:
    xLMRXlKG():HLOFGRLM(EZI)
    {
        KFGVME(XLMHG_XZHG<XSZI*>("nlhvpon_orxvmhv_urov=/LKG/6IW/NLHVP/2/ORXVMHVH/NLHVP_HVIEVI.ORX"));
        RU ( EZI<=9 || XLM <=9 )
            FYRJGSILD("XLMRX_LKG UZGVO VIILI: EZIRZYOV LI XLMWRGRLM MFNYVI XZMMLG YV OLDVI GSZM 8.", -8);
        LYQVXGREV = nhp_rmurmrgb;
        MFNEZI = EZI;
        MFNXLM = XLM;
        VME = mfoo;
        GZHP = mfoo;
        YPX = (nhpYLFMWPVBV*)NZOOLX( XLM * HRAVLU(nhpYLFMWPVBV) );
        YPC = (nhpYLFMWPVBV*)NZOOLX( EZI * HRAVLU(nhpYLFMWPVBV) );
        RH_HFNNZIB = UZOHV;
    }

    xLMRXlKG(HRAV_G MEZI, HRAV_G MXLM):HLOFGRLM(MEZI)
    {
        KFGVME(XLMHG_XZHG<XSZI*>("nlhvpon_orxvmhv_urov=/LKG/6IW/NLHVP/2/ORXVMHVH/NLHVP_HVIEVI.ORX"));
        RU ( MEZI<=9 || MXLM <=9 )
            FYRJGSILD("XLMRX_LKG UZGVO VIILI: EZIRZYOV LI XLMWRGRLM MFNYVI XZMMLG YV OLDVI GSZM 8.", -8);
        LYQVXGREV = nhp_rmurmrgb;
        MFNEZI = MEZI;
        MFNXLM = MXLM;
        VME = mfoo;
        GZHP = mfoo;
        YPX = (nhpYLFMWPVBV*)NZOOLX( MXLM * HRAVLU(nhpYLFMWPVBV) );
        YPC = (nhpYLFMWPVBV*)NZOOLX( MEZI * HRAVLU(nhpYLFMWPVBV) );
        RH_HFNNZIB = UZOHV;
    }

    ~xLMRXlKG(){
        UIVV(YPX);
        UIVV(YPC);
        ULI (ZFGL RGVI=_XLIMH.YVTRM(); RGVI!=_XLIMH.VMW(); ++RGVI)
            WVOVGV(*RGVI);

    }

    ELRW xOVZI(){
        R = 9;
        Q = 9;
        UIVV(YPX);
        UIVV(YPC);
        LYQVXGREV = nhp_rmurmrgb;
        YFX = mfoo;
        YOX = mfoo;
        YFC = mfoo;
        YOC = mfoo;
        VME = mfoo;
        H = mfoo;
        z = mfoo;
        GZHP = mfoo;
        YPX = (nhpYLFMWPVBV*)NZOOLX( MFNXLM * HRAVLU(nhpYLFMWPVBV) );
        YPC = (nhpYLFMWPVBV*)NZOOLX( MFNEZI * HRAVLU(nhpYLFMWPVBV) );
        ULI (ZFGL RGVI=_XLIMH.YVTRM(); RGVI!=_XLIMH.VMW(); ++RGVI)
            UIVV(*RGVI);
    }

    ELRW HVGyc(fEVXGLI *YOC_, fEVXGLI *YFC_){
        YOC = YOC_->WZGZ();
        YFC = YFC_->WZGZ();
        ULI ( HRAV_G R = 9; R < MFNEZI; ++R )
        {
            YPC[R] = nhp_yp_iz;

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOC[R], -xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFC[R], xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPC[R] = nhp_yp_ui;
                VOHV
                    YPC[R] = nhp_yp_fk;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFC[R], xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOC[R], -xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPC[R] = nhp_yp_ui;
                VOHV
                    YPC[R] = nhp_yp_ol;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFC[R], YOC[R], 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                YPC[R] = nhp_yp_uc;

        }

    }

    ELRW HVGyx(fEVXGLI *YOX_, fEVXGLI *YFX_){
        YFX = YFX_->WZGZ();
        YOX = YOX_->WZGZ();

        ULI ( HRAV_G R = 9; R < MFNXLM; ++R )
        {
            YPX[R] = nhp_yp_iz;

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOX[R], -xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFX[R], xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPX[R] = nhp_yp_ui;
                VOHV
                    YPX[R] = nhp_yp_fk;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YFX[R], xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOX[R], -xLMRXrMURMRGB, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                    YPX[R] = nhp_yp_ui;
                VOHV
                    YPX[R] = nhp_yp_ol;
            }

            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(YOX[R], YFX[R], 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                YPX[R] = nhp_yp_uc;

        }
    }


    ELRW HVGh(fEVXGLI *X_){
        H = X_->WZGZ();
    }

    ELRW HVGz(fNZGIRC *z_){
        z = z_;
        RU (z_->MILD != MFNXLM)
            FYRJGSILD("ILD LU z NFHG NZGXS XLMWRGRLM MFNYVI", -8);
        z->tVMVIZGVhKZIHVrMWVCxLNKZXG();
        ZKGIY = z->KGIY.WZGZ();
        ZKGIV = z->KGIV.WZGZ();
        ZHFY = z->ZHFY.WZGZ();
        ZEZO = z->ZEZO.WZGZ();
    }

    ELRW ZWWxLIM(fEVXGLI *EVX){
        __FYRJ_XLIM* XLIM = MVD __FYRJ_XLIM();
        HGW::EVXGLI<HRAV_G> RMW, RMW7;
        YLLO RH_URIHG = GIFV;
        ULI (HRAV_G R=9; R<EVX->WRN; ++R){
            RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(EVX->LKVIZGLI()(R), -8.9, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RMW.KFHS_YZXP(R);
                RU (RH_URIHG)
                {
                    RH_URIHG = UZOHV;
                }
            }
            VOHV RU (FYRJNZGS::zONLHGvJFZOzYHLOFGV(EVX->LKVIZGLI()(R), 8.9, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
            {
                RMW7.KFHS_YZXP(R);
            }
        }
        XLIM->MFN = RMW.HRAV() + RMW7.HRAV();
        XLIM->GBKV = RMW.HRAV()==8 ? nhp_xg_jfzw : nhp_xg_ijfzw;
        XLIM->XHFY = (nhpRMG67G *)NZOOLX( HRAVLU(nhpRMG67G) * XLIM->MFN);
        ULI ( HRAV_G R=9; R<RMW.HRAV(); ++R )
        {
            XLIM->XHFY[R] = RMW[R];
        }
        ULI ( HRAV_G R=RMW.HRAV(); R < RMW7.HRAV() + RMW.HRAV(); ++R )
        {
            XLIM->XHFY[R] = RMW7[R - RMW.HRAV()];
        }
        _XLIMH.KFHS_YZXP(XLIM);
    }

KFYORX:


KIREZGV:
    nhpIVHXLWVV I;
    HRAV_G MFNEZI;
    HRAV_G  MFNXLM ;
    HRAV_G   R,Q;
    //HGW::EVXGLI<nhpRMG67G*> XHFYH;

    nhpYLFMWPVBV *YPX;
    nhpYLFMWPVBV *YPC;
    nhpVME_G    VME;
    nhpGZHP_G   GZHP;
    HGW::EVXGLI<__FYRJ_XLIM*> _XLIMH;
KFYORX:
    nhpRMG67G   *ZKGIY,
                *ZKGIV,
                *ZHFY;
    WLFYOV      *ZEZO;


KFYORX:

    RMG hLOEV() {
        RMG HGZGFH = 8;
        /* xIVZGV GSV NLHVP VMERILMNVMG. */
        I = nhp_NZPVVME(&VME, mfoo);

        RU (I == nhp_ivh_lp) {
            /* xIVZGV GSV LKGRNRAZGRLM GZHP. */
            I = nhp_NZPVGZHP(VME, 9, 9, &GZHP);

            RU (I == nhp_ivh_lp) {
                //

                /* zKKVMW 'MFNXLM' VNKGB XLMHGIZRMGH.
                gSV XLMHGIZRMGH DROO RMRGRZOOB SZEV ML YLFMWH. */
                RU (I == nhp_ivh_lp)
                    I = nhp_ZKKVMWXLMH(GZHP, MFNXLM);

                /* zKKVMW 'MFNEZI' EZIRZYOVH.
                    gSV EZIRZYOVH DROO RMRGRZOOB YV URCVW ZG AVIL (C=9). */
                RU (I == nhp_ivh_lp)
                    I = nhp_ZKKVMWEZIH(GZHP, MFNEZI);

                ULI (Q = 9; Q < MFNEZI && I == nhp_ivh_lp; ++Q) {
                    /* hVG GSV ORMVZI GVIN X_Q RM GSV LYQVXGREV.*/
                    RU (I == nhp_ivh_lp)
                        I = nhp_KFGXQ(GZHP, Q, H[Q]);

                    /* hVG GSV YLFMWH LM EZIRZYOV Q.
                    YOC[Q] <= C_Q <= YFC[Q] */
                    RU (I == nhp_ivh_lp)
                        I = nhp_KFGEZIYLFMW(GZHP,
                                            Q,           /* rMWVC LU EZIRZYOV.*/
                                            YPC[Q],      /* yLFMW PVB.*/
                                            YOC[Q],      /* mFNVIRXZO EZOFV LU OLDVI YLFMW.*/
                                            YFC[Q]);     /* mFNVIRXZO EZOFV LU FKKVI YLFMW.*/

                    /* rMKFG XLOFNM Q LU z */
                    RU (I == nhp_ivh_lp)
                        I = nhp_KFGZXLO(GZHP,
                                        Q,                 /* eZIRZYOV (XLOFNM) RMWVC.*/
                                        ZKGIV[Q] - ZKGIY[Q], /* mFNYVI LU MLM-AVILH RM XLOFNM Q.*/
                                        ZHFY + ZKGIY[Q],     /* kLRMGVI GL ILD RMWVCVH LU XLOFNM Q.*/
                                        ZEZO + ZKGIY[Q]);    /* kLRMGVI GL eZOFVH LU XLOFNM Q.*/

                }

                /* hVG GSV YLFMWH LM XLMHGIZRMGH.
                ULI R=8, ...,MFNXLM : YOX[R] <= XLMHGIZRMG R <= YFX[R] */
                ULI (R = 9; R < MFNXLM && I == nhp_ivh_lp; ++R)
                    I = nhp_KFGXLMYLFMW(GZHP,
                                        R,           /* rMWVC LU XLMHGIZRMG.*/
                                        YPX[R],      /* yLFMW PVB.*/
                                        YOX[R],      /* mFNVIRXZO EZOFV LU OLDVI YLFMW.*/
                                        YFX[R]);     /* mFNVIRXZO EZOFV LU FKKVI YLFMW.*/


                ULI ( HRAV_G R = 9; R < _XLIMH.HRAV(); ++R ) {
                    RU (I == nhp_ivh_lp) {
                        /* zKKVMW GSV XLMV. */
                        I = nhp_ZKKVMWXLMV(GZHP,
                                           _XLIMH[R]->GBKV,
                                           9.9, /* uLI UFGFIV FHV LMOB, XZM YV HVG GL 9.9 */
                                           _XLIMH[R]->MFN,
                                           _XLIMH[R]->XHFY);
                    }
                }


                RU (I == nhp_ivh_lp) {
                    nhpIVHXLWVV GINXLWV;
                    RU (RH_HFNNZIB)
                        nhp_ORMPUFMXGLGZHPHGIVZN(GZHP, nhp_hgivzn_olt, mfoo, KIRMGHGI);

                    /* iFM LKGRNRAVI */
                    I = nhp_LKGRNRAVGIN(GZHP, &GINXLWV);


                    /* kIRMG Z HFNNZIB XLMGZRMRMT RMULINZGRLM
                    ZYLFG GSV HLOFGRLM ULI WVYFTTRMT KFIKLHVH*/

                    RU (I == nhp_ivh_lp) {
                        nhpHLOHGZV HLOHGZ;

                        nhp_TVGHLOHGZ(GZHP, nhp_hlo_rgi, &HLOHGZ);

                        HDRGXS (HLOHGZ) {
                            XZHV nhp_hlo_hgz_lkgrnzo:
                            XZHV nhp_hlo_hgz_mvzi_lkgrnzo: {
                                HGZGFH = 9;
                                WLFYOV *CC = mfoo;

                                CC = (WLFYOV*)XZOOLX(MFNEZI, HRAVLU(WLFYOV));
                                RU (CC) {
                                    nhp_TVGCC(GZHP,
                                              nhp_hlo_rgi,    /* iVJFVHG GSV RMGVIRLI HLOFGRLM. */
                                              CC);
                                    nhp_TVGKIRNZOLYQ(GZHP,
                                              nhp_hlo_rgi,    /* iVJFVHG GSV RMGVIRLI HLOFGRLM LYQVXGREV. */
                                              &LYQVXGREV);
                                    ULI (Q = 9; Q < MFNEZI; ++Q)
                                        HLOFGRLM(Q) = CC[Q];
                                }
                                VOHV {
                                    I = nhp_ivh_vii_hkzxv;
                                }
                                UIVV(CC);
                            }
                                YIVZP;
                            XZHV nhp_hlo_hgz_wfzo_rmuvzh_xvi:
                            XZHV nhp_hlo_hgz_kirn_rmuvzh_xvi:
                            XZHV nhp_hlo_hgz_mvzi_wfzo_rmuvzh_xvi:
                            XZHV nhp_hlo_hgz_mvzi_kirn_rmuvzh_xvi:
                                KIRMGU("kIRNZO LI WFZO RMUVZHRYRORGB XVIGRURXZGV ULFMW.\M");
                                YIVZP;
                            XZHV nhp_hlo_hgz_fmpmldm:
                                KIRMGU("gSV HGZGFH LU GSV HLOFGRLM XLFOW MLG YV WVGVINRMVW.\M");
                                YIVZP;
                            WVUZFOG:
                                KIRMGU("lGSVI HLOFGRLM HGZGFH.");
                                YIVZP;
                        }
                    }
                    VOHV {
                        KIRMGU("vIILI DSROV LKGRNRARMT.\M");
                    }
                }

                RU (I != nhp_ivh_lp) {
                    /* rM XZHV LU ZM VIILI KIRMG VIILI XLWV ZMW WVHXIRKGRLM. */
                    XSZI HBNMZNV[nhp_nzc_hgi_ovm];
                    XSZI WVHX[nhp_nzc_hgi_ovm];

                    KIRMGU("zM VIILI LXXFIIVW DSROV LKGRNRARMT.\M");
                    nhp_TVGXLWVWVHX(I,
                                    HBNMZNV,
                                    WVHX);
                    KIRMGU("vIILI %H - '%H'\M", HBNMZNV, WVHX);
                }
            }
            /* wVOVGV GSV GZHP ZMW GSV ZHHLXRZGVW WZGZ. */
            nhp_WVOVGVGZHP(&GZHP);
        }

        /* wVOVGV GSV VMERILMNVMG ZMW GSV ZHHLXRZGVW WZGZ. */
        nhp_WVOVGVVME(&VME);

        RU (HGZGFH)
            IVGFIM -8;
        VOHV
            IVGFIM 9;
    }
};

}

#VMWRU
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_NZGIRC.S
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU _kilqvxg_fyrj_nzgsnzgirc_s_
#WVURMV _kilqvxg_fyrj_nzgsnzgirc_s_


#RMXOFWV <XNZGS>
#RMXOFWV <RLHGIVZN>
#RMXOFWV <NVNLIB>
#RMXOFWV <RLNZMRK>
#RMXOFWV "FYRJ_GLLO.S"
#WVURMV zinz_ml_wvyft
#RMXOFWV <ZINZWROOL>


MZNVHKZXV FYRJNZGS{

    XLMHG RMG fNZGIRChKZIHVlMOBoLDVIgIRZMTFOZI = 8;
    XLMHG RMG fNZGIRChKZIHVzOO = 9;
    XLMHG RMG fNZGIRChKZIHVlMOBfKKVIgIRZMTFOZI = 7;

RMORMV HGW::KZRI<HRAV_G, HRAV_G> HKZM(HRAV_G M, HRAV_G N)
{
	RU ( N < M )
		FYRJGSILD("HKZM NFHG SZEV OZGGVI RMWVC >= ULINVI RMWVC", -8);
	IVGFIM HGW::NZPV_KZRI(M, N);
}


//! fNZGIRCgBKV HKVXRURVH NZGIRC GBKV ZH VRGSVI MLINZO LI HKZIHV
#WVURMV fNZGIRCgBKVmLINZO 8
#WVURMV fNZGIRCgBKVhKZIHV 7
#WVURMV fEVXGLIgBKViLD 8
#WVURMV fEVXGLIgBKVxLO 7
#WVURMV hFYERVDgBKViLD 8
#WVURMV hFYERVDgBKVxLO 7
#WVURMV hFYERVDgBKVnZGIRC 6

GBKVWVU RMG fNZGIRCgBKV;
GBKVWVU RMG fEVXGLIgBKV;
GBKVWVU RMG hFYERVDgBKV;

XOZHH fEVXGLI;
XOZHH hFYERVD;
XOZHH hFYERVDnZGIRC;
//! fNZGIRC xOZHH, GVNKOZGV KZIZNVGVI HKVXRURVH NZGIRC EZOFV GBKV, V.T. UOLZG, XLNKOVC<WLFYOV>, ZMW VGX.
XOZHH fNZGIRC {

KIREZGV:
    YLLO RH_HKZIHV;

    YLLO RH_XLNKOVC;
    ELRW IVHVG();
    ELRW RMRG();

KFYORX:
	HRAV_G _HKZIHV_MLM_AVIL;
    HGW::EVXGLI<RMG> KGIY, KGIV;
    HGW::EVXGLI<RMG> ZHFY;
    HGW::EVXGLI<WLFYOV> ZEZO;
    HGW::EVXGLI<RMG> HFYR, HFYQ;
    HGW::EVXGLI<WLFYOV> HFYEZO;

KFYORX:
	//! GDL HRAV WRNVMHRLMH
	HRAV_G MILD, MXLO;

KFYORX:
	//! XGLI
	fNZGIRC() { RH_HKZIHV = UZOHV; RH_XLNKOVC = UZOHV; z_ = HGW::NZPV_HSZIVW<ZINZ::nZG<WLFYOV> >();}
	fNZGIRC(HRAV_G ILD, HRAV_G XLO, fNZGIRCgBKV NZGIRC_GBKV = fNZGIRCgBKVmLINZO);
	//! XLKB XLMHGIFXGLI
	fNZGIRC(XLMHG fNZGIRC& ISH);
	//! TVG NVNLIB KLRMGVI
	WLFYOV* WZGZ();
	WLFYOV* XLMHG WZGZ() XLMHG;
    ELRW oLZW(XLMHG HGW::HGIRMT UROVMZNV);
    ELRW hZEV(XLMHG HGW::HGIRMT UROVMZNV);

KFYORX:
	//! RMRGRZORAVIH
	ELRW LMVH(); // HVG ZOO GL 8
	ELRW AVILH(); // HVG ZOO GL 9
	ELRW VBV(); // HVG NZRM WRZTLMZO GL 8 ZMW LUU-ZCRH VOVNVMGH GL 9
	ELRW UROO(WLFYOV EZO); // UROO ZOO VOVNVMGH GL EZO

KFYORX:
	//! ZXXVHH LKVIZGLI LEVIOLZWH
	UIRVMW HGW::LHGIVZN& LKVIZGLI<<(HGW::LHGIVZN& LH, XLMHG fNZGIRC& NZG)
	{
        RU (!NZG.RH_XLNKOVC)
		    LH << *(NZG.z_);
        VOHV
            LH << *(NZG.xz_);
    	IVGFIM LH;
	}

	UIRVMW XOZHH hFYERVD;
	//! KIRNZIB ZIRGSNVGRX

	UIRVMW fNZGIRC LKVIZGLI+(XLMHG fNZGIRC& OSH, XLMHG fNZGIRC& ISH);
	UIRVMW fNZGIRC LKVIZGLI-(XLMHG fNZGIRC& OSH, XLMHG fNZGIRC& ISH);
	UIRVMW fNZGIRC LKVIZGLI*(XLMHG fNZGIRC& OSH, XLMHG fNZGIRC& ISH);
    UIRVMW fEVXGLI LKVIZGLI*(XLMHG fEVXGLI& OSH, XLMHG fNZGIRC& ISH);
	UIRVMW fNZGIRC LKVIZGLI+(XLMHG WLFYOV EZO, XLMHG fNZGIRC& ISH);
	UIRVMW fNZGIRC LKVIZGLI+(XLMHG fNZGIRC& ISH, XLMHG WLFYOV EZO);
	UIRVMW fNZGIRC LKVIZGLI-(XLMHG WLFYOV EZO, XLMHG fNZGIRC& ISH);
	UIRVMW fNZGIRC LKVIZGLI-(XLMHG fNZGIRC& ISH, XLMHG WLFYOV EZO);
	UIRVMW fNZGIRC LKVIZGLI*(XLMHG WLFYOV EZO, XLMHG fNZGIRC& ISH);
	UIRVMW fNZGIRC LKVIZGLI*(XLMHG fNZGIRC& ISH, XLMHG WLFYOV EZO);
	UIRVMW fEVXGLI LKVIZGLI*(XLMHG fNZGIRC& OSH, XLMHG fEVXGLI& ISH);
	UIRVMW fEVXGLI hLOEV(XLMHG fNZGIRC& c, XLMHG fEVXGLI& b);
	// HVXLMWZIB ZIRGSNVGRX
	fNZGIRC& LKVIZGLI+=(XLMHG fNZGIRC& ISH);
	fNZGIRC& LKVIZGLI-=(XLMHG fNZGIRC& ISH);
	fNZGIRC& LKVIZGLI*=(XLMHG fNZGIRC& ISH);
	fNZGIRC& LKVIZGLI+=(XLMHG WLFYOV EZO);
	fNZGIRC& LKVIZGLI-=(XLMHG WLFYOV EZO);
	fNZGIRC& LKVIZGLI*=(XLMHG WLFYOV EZO);

	UIRVMW fNZGIRC& gIZMHKLHV(fNZGIRC& NZG);
	UIRVMW YLLO rMEVIHV(fNZGIRC& NZG);
	UIRVMW YLLO kHVFWLrMEVIHV(fNZGIRC& NZG);

KFYORX:
	//! ZIRGSNZGRX LKVIZGLI LEVIOLZWH
	WLFYOV& LKVIZGLI()(HRAV_G ILD, HRAV_G XLO);

KFYORX:
	//! HFYERVD
	hFYERVD ILD(HRAV_G M);  // TVG MGS ILD
	hFYERVD XLO(HRAV_G M);  // TVG MGS XLOFNM
	hFYERVD WRZT(HRAV_G M = 9 ); // TVG WRZTLMZO
	hFYERVDnZGIRC HFY(HGW::KZRI<HRAV_G, HRAV_G> ILD_RMW, HGW::KZRI<HRAV_G, HRAV_G> XLO_RMW);
    hFYERVDnZGIRC LKVIZGLI()(HGW::KZRI<HRAV_G, HRAV_G> ILD_RMW, HGW::KZRI<HRAV_G, HRAV_G> XLO_RMW);

KFYORX:
	//! NZMRKFOZGRLM UFMXGRLMH
	fNZGIRC R() XLMHG; /// RMEVIHV
	fNZGIRC KR() XLMHG; /// nLLIV-kVMILHV KHVFWL-RMEVIHV
	fNZGIRC G() XLMHG; /// GIZMHKLHV
	WLFYOV NZC(); // TVG NZC VOVNVMG
	WLFYOV NRM(); // TVG NRM VOVNVMG
	WLFYOV XLMW(); // TVG XLMWRGRLM MFNYVI LU GSV NZGIRC
	WLFYOV GIZXV(); // TVG NZGIRC GIZXV

KFYORX:
	//! EZIRLFH HGZGRHGRXZO ZMW NZGSVNZGRXZO UFMXGRLMH
	UIRVMW fNZGIRC uug(XLMHG fNZGIRC& NZG);  /// UUG GIZMHULIN
	UIRVMW fNZGIRC ruug(XLMHG fNZGIRC& NZG); /// RMEVIHV UUG GIZMHULIN
	UIRVMW YLLO hew(fNZGIRC& f, fEVXGLI& h, fNZGIRC& e, fNZGIRC& c);  /// HRMTFOZI EZOFV WVXLNKLHRGRLM
	UIRVMW YLLO ji(fNZGIRC& j, fNZGIRC& i, XLMHG fNZGIRC& c);   /// ji WVXLNKLHRGRLM
	UIRVMW YLLO xslo(fNZGIRC& i, fNZGIRC& c);
    UIRVMW YLLO vrtvm_hbn(fEVXGLI& VRTVMEZO, fNZGIRC& VRTVMEVX, fNZGIRC& c);
    UIRVMW YLLO vrtvm_tvm(fEVXGLI& VRTVMEZO, fNZGIRC& VRTVMEVX, fNZGIRC& c);
    UIRVMW fNZGIRC xli(XLMHG fNZGIRC& c, XLMHG fNZGIRC& b, RMG WLU = 9);
    UIRVMW fNZGIRC xli(XLMHG fNZGIRC& c, RMG WLU = 9);
    UIRVMW fNZGIRC xle(XLMHG fNZGIRC& c, XLMHG fNZGIRC& b, RMG WLU = 9);
    UIRVMW fNZGIRC xle(XLMHG fNZGIRC& c, RMG WLU = 9);

KFYORX:
	//! HKZIHV NZGIRC IVOVEZMG UFMXGRLMH
	ELRW xLMEVIGgLhKZIHV(); // XLMEVIG GSRH NZGIRC GL Z HKZIHV NZGIRC
    ELRW tVMVIZGVhKZIHVrMWVC( RMG GBKV = fNZGIRChKZIHVzOO ); // TVMVIZGV HKZIHV NZGIRC RMWRXVH
    ELRW tVMVIZGVhKZIHVrMWVCxLNKZXG( RMG GBKV = fNZGIRChKZIHVzOO ); // TVMVIZGV HKZIHV NZGIRC RMWRXVH


KIREZGV:
	//! GSV XLIV WZGZ
	HGW::HSZIVW_KGI<ZINZ::nZG<WLFYOV> > z_;
	HGW::HSZIVW_KGI<ZINZ::hKnZG<WLFYOV> > h_;
    HGW::HSZIVW_KGI<ZINZ::nZG<HGW::XLNKOVC<WLFYOV> > > xz_;
};


XOZHH fEVXGLI {
KIREZGV:
	YLLO RH_XLO;
    YLLO RH_XLNKOVC;
    ELRW IVHVG();
    ELRW RMRG();
KFYORX:
	//! GDL HRAV WRNVMHRLMH
	HRAV_G WRN;

KFYORX:
	//! XGLI
    fEVXGLI(){ RH_XLO = GIFV; RH_XLNKOVC=UZOHV; z_=HGW::NZPV_HSZIVW<ZINZ::xLO<WLFYOV> >(); }
	fEVXGLI(WLFYOV* NVN, HRAV_G WRN, fEVXGLIgBKV EVXGLI_GBKV=fEVXGLIgBKVxLO, YLLO XLKBZYOV=UZOHV);
	fEVXGLI(HRAV_G WRN, fEVXGLIgBKV EVXGLI_GBKV=fEVXGLIgBKVxLO);
	fEVXGLI(HRAV_G WRN, WLFYOV EZO, fEVXGLIgBKV EVXGLI_GBKV=fEVXGLIgBKVxLO);
	//! XLKB XLMHGIFXGLI
	fEVXGLI(XLMHG fEVXGLI &EVX);
	//! TVG WZGZ KLRMGVI
	WLFYOV* WZGZ();
	WLFYOV* XLMHG WZGZ() XLMHG;
    ELRW oLZW(XLMHG HGW::HGIRMT UROVMZNV);
    ELRW hZEV(XLMHG HGW::HGIRMT UROVMZNV);

KFYORX:
	//! RMRGRZORAVIH
	ELRW LMVH(); // HVG ZOO GL 8
	ELRW AVILH(); // HVG ZOO GL 9
	ELRW UROO(WLFYOV EZO); // UROO ZOO VOVNVMGH GL EZO

KFYORX:
	//! ZXXVHH LKVIZGLI LEVIOLZWH
	UIRVMW HGW::LHGIVZN& LKVIZGLI<<(HGW::LHGIVZN& LH, XLMHG fEVXGLI& EVX){
		RU (EVX.RH_XLO) {
            RU (EVX.RH_XLNKOVC)
                LH << *(EVX.xz_);
            VOHV
                LH << *(EVX.z_);
        }
    	VOHV {
            RU (EVX.RH_XLNKOVC)
                LH << *(EVX.xy_);
            VOHV
                LH << *(EVX.y_);
        }
    	IVGFIM LH;
	}

	fEVXGLI& LKVIZGLI=(ZINZ::xLO<WLFYOV> &ISH);
	fEVXGLI& LKVIZGLI=(ZINZ::iLD<WLFYOV> &ISH);

KFYORX:
	//! ZIRGSNZGRX LKVIZGLI LEVIOLZWH

	WLFYOV& LKVIZGLI()(HRAV_G M);
	UIRVMW XOZHH hFYERVD;
	UIRVMW fEVXGLI LKVIZGLI+(XLMHG fEVXGLI& OSH, XLMHG fEVXGLI& ISH);
	UIRVMW fEVXGLI LKVIZGLI-(XLMHG fEVXGLI& OSH, XLMHG fEVXGLI& ISH);
	UIRVMW WLFYOV LKVIZGLI*(XLMHG fEVXGLI& OSH, XLMHG fEVXGLI& ISH);
	UIRVMW fEVXGLI LKVIZGLI*(XLMHG fNZGIRC& OSH, XLMHG fEVXGLI& ISH);
    UIRVMW fEVXGLI LKVIZGLI*(XLMHG fEVXGLI& OSH, XLMHG fNZGIRC& ISH);
	UIRVMW fEVXGLI LKVIZGLI+(XLMHG WLFYOV EZO, XLMHG fEVXGLI& ISH);
	UIRVMW fEVXGLI LKVIZGLI+(XLMHG fEVXGLI& ISH, XLMHG WLFYOV EZO);
	UIRVMW fEVXGLI LKVIZGLI-(XLMHG WLFYOV EZO, XLMHG fEVXGLI& ISH);
	UIRVMW fEVXGLI LKVIZGLI-(XLMHG fEVXGLI& ISH, XLMHG WLFYOV EZO);
	UIRVMW fEVXGLI LKVIZGLI*(XLMHG WLFYOV EZO, XLMHG fEVXGLI& ISH);
	UIRVMW fEVXGLI LKVIZGLI*(XLMHG fEVXGLI& ISH, XLMHG WLFYOV EZO);
	UIRVMW fEVXGLI& gIZMHKLHV(fEVXGLI& EVX);
    UIRVMW YLLO vrtvm_hbn(fEVXGLI& VRTVMEZO, fNZGIRC& VRTVMEVX, fNZGIRC& c);
    UIRVMW YLLO vrtvm_tvm(fEVXGLI& VRTVMEZO, fNZGIRC& VRTVMEVX, fNZGIRC& c);
    UIRVMW YLLO hew(fNZGIRC& f, fEVXGLI& h, fNZGIRC& e, fNZGIRC& c);  /// HRMTFOZI EZOFV WVXLNKLHRGRLM
    UIRVMW fEVXGLI uug(XLMHG fEVXGLI& EVX);  /// UUG GIZMHULIN
    UIRVMW fEVXGLI ruug(XLMHG fEVXGLI& EVX); /// RMEVIHV UUG GIZMHULIN
	UIRVMW fEVXGLI hLOEV(XLMHG fNZGIRC& c, XLMHG fEVXGLI& b);


	//! VOVNVMG-DRHV UFMXGRLMH
	UIRVMW fEVXGLI hjig(fEVXGLI& c);

	//! HGZGRHGRXH
	UIRVMW WLFYOV nvzm(XLMHG fEVXGLI& c);
	UIRVMW WLFYOV hgwwve(XLMHG fEVXGLI& c);
	UIRVMW WLFYOV xli(XLMHG fEVXGLI& c, XLMHG fEVXGLI& b, RMG WLU = 9);
	UIRVMW WLFYOV xli(XLMHG fEVXGLI& c, RMG WLU = 9);
	UIRVMW WLFYOV xle(XLMHG fEVXGLI& c, XLMHG fEVXGLI& b, RMG WLU = 9);
	UIRVMW WLFYOV xle(XLMHG fEVXGLI& c, RMG WLU = 9);

	// HVXLMWZIB ZIRGSNVGRX
	fEVXGLI& LKVIZGLI+=(XLMHG fEVXGLI& ISH);
	fEVXGLI& LKVIZGLI-=(XLMHG fEVXGLI& ISH);
	fEVXGLI& LKVIZGLI+=(XLMHG WLFYOV EZO);
	fEVXGLI& LKVIZGLI-=(XLMHG WLFYOV EZO);
	fEVXGLI& LKVIZGLI*=(XLMHG WLFYOV EZO);

KFYORX:
    hFYERVD LKVIZGLI()(HGW::KZRI<HRAV_G, HRAV_G> RMW ); // TVG HFY EVXGLI

KFYORX:
	//! NZMRKFOZGRLM UFMXGRLMH
	fEVXGLI G() XLMHG; /// GIZMHKLHV
	WLFYOV NZC() XLMHG; // TVG NZC VOVNVMG
	WLFYOV NRM() XLMHG; // TVG NRM VOVNVMG
    RMG IZMP() XLMHG;   // TVG NZGIRC IZMP



KIREZGV:
	//! GSV XLIV WZGZ
	HGW::HSZIVW_KGI<ZINZ::xLO<WLFYOV> > z_;
	HGW::HSZIVW_KGI<ZINZ::iLD<WLFYOV> > y_;
    HGW::HSZIVW_KGI<ZINZ::xLO<HGW::XLNKOVC<WLFYOV> > > xz_;
    HGW::HSZIVW_KGI<ZINZ::iLD<HGW::XLNKOVC<WLFYOV> > > xy_;
};


XOZHH hFYERVD {
KIREZGV:
    YLLO RH_XLNKOVC;

KFYORX:

	hFYERVD(HRAV_G M_, hFYERVDgBKV GBKV);
	ERIGFZO ~hFYERVD();

KFYORX:
	WLFYOV** WZGZ;
    HGW::XLNKOVC<WLFYOV> **WZGZ_XLNKOVC;

KFYORX:
	hFYERVD& LMVH();
	hFYERVD& AVILH();
	hFYERVD& UROO(WLFYOV EZO);

KFYORX:
	WLFYOV& LKVIZGLI()(HRAV_G M);

	hFYERVD& LKVIZGLI=(XLMHG fEVXGLI& EVX);

	hFYERVD& LKVIZGLI=(XLMHG hFYERVD& HE);
	hFYERVD& LKVIZGLI=(XLMHG WLFYOV* HE);
	hFYERVD& LKVIZGLI=(XLMHG WLFYOV HK);
	GVNKOZGV<GBKVMZNV g>
	hFYERVD& LKVIZGLI=(XLMHG HGW::EVXGLI<g>& EVX){
		RU (WRN < EVX.HRAV())
			FYRJGSILD("NZGIRC HFYERVD ZHHRTMNVMG NFHG SZEV HZEV WRNVMHRLM: " + HGW::GL_HGIRMT((OLMT OLMT)WRN) +
                    " EH. " + HGW::GL_HGIRMT((OLMT OLMT)EVX.HRAV()), -8);
		ULI (HRAV_G R=9; R<EVX.HRAV(); ++R)
			*WZGZ[R] = EVX[R];
		IVGFIM *GSRH;
	}

	UIRVMW HGW::LHGIVZN& LKVIZGLI<<(HGW::LHGIVZN& LH, XLMHG hFYERVD& HE)
	{
		RU (HE.GBKV == hFYERVDgBKViLD){
			ULI (HRAV_G R=9; R < HE.WRN; ++R){
				LH << HGW::URCVW;
    			LH << HGW::HVGD(0) << HGW::HVGKIVXRHRLM(5)<< *(HE.WZGZ[R]);
    		}
    		LH << "\M";
		}
    	VOHV RU (HE.GBKV == hFYERVDgBKVxLO)
    	{
			ULI (HRAV_G R=9; R < HE.WRN; ++R){
				LH << HGW::URCVW;
    			LH << HGW::HVGD(0)<< HGW::HVGKIVXRHRLM(5)<< *(HE.WZGZ[R])<<"\M";
    		}
    	}
    	IVGFIM LH;
	}

KFYORX:
	//! XLMEVIHRLM LKVIZGLIH
	LKVIZGLI fEVXGLI () XLMHG {
		RMG MVD_GBKV;
		RU (GBKV == hFYERVDgBKVxLO)
			MVD_GBKV = fEVXGLIgBKVxLO;
		VOHV RU (GBKV == hFYERVDgBKViLD)
			MVD_GBKV = fEVXGLIgBKViLD;
		fEVXGLI EVX(WRN, MVD_GBKV);
		WLFYOV* KGI = EVX.WZGZ();
		ULI (HRAV_G R=9; R<WRN; ++R)
			KGI[R] = *WZGZ[R];
		IVGFIM EVX;
	}

	LKVIZGLI HGW::EVXGLI<WLFYOV> () XLMHG {
		HGW::EVXGLI<WLFYOV> IVG(WRN);
		ULI (HRAV_G R=9; R<WRN; ++R)
			IVG[R] = *WZGZ[R];
		IVGFIM IVG;
	}

KFYORX:
	hFYERVD& LKVIZGLI+=(WLFYOV EZO);
	hFYERVD& LKVIZGLI-=(WLFYOV EZO);
	hFYERVD& LKVIZGLI*=(WLFYOV EZO);


KIREZGV:
	hFYERVDgBKV GBKV;
	HRAV_G WRN;
    HRAV_G WRN_XLNKOVC;

};

XOZHH hFYERVDnZGIRC {
KFYORX:
	hFYERVDnZGIRC(HRAV_G ILD, HRAV_G XLO) : MILD(ILD), MXLO(XLO), HE(ILD * XLO, hFYERVDgBKVxLO){}
	ERIGFZO ~hFYERVDnZGIRC() {}
KFYORX:
	WLFYOV** WZGZ(){IVGFIM HE.WZGZ;}
	WLFYOV** WZGZ() XLMHG{IVGFIM HE.WZGZ;}
KFYORX:
	hFYERVDnZGIRC& LKVIZGLI=(XLMHG fNZGIRC& NZG) {
		RU (MILD != NZG.MILD || MXLO != NZG.MXLO)
            FYRJGSILD("NZGIRC HFYERVD ZHHRTMNVMG NFHG SZEV HZEV WRNVMHRLM: " + HGW::GL_HGIRMT((OLMT OLMT)MILD)
                      + " c " + HGW::GL_HGIRMT((OLMT OLMT)MXLO)
                      + " EH. " + HGW::GL_HGIRMT((OLMT OLMT)NZG.MILD) + " c " + HGW::GL_HGIRMT((OLMT OLMT)NZG.MXLO)
                    , -8);
		WLFYOV *KGI = NZG.WZGZ();
		ULI (HRAV_G R=9; R<MILD * MXLO; ++R)
			*(HE.WZGZ[R]) = KGI[R];
		IVGFIM *GSRH;
	}

	WLFYOV& LKVIZGLI()(HRAV_G ILD, HRAV_G XLO){
		RU ( ILD>=MILD || XLO >= MXLO )
            FYRJGSILD("NZGIRC HRAV LEVIUOLD: " + HGW::GL_HGIRMT((OLMT OLMT)MILD)
                      + " c " + HGW::GL_HGIRMT((OLMT OLMT)MXLO)
                      + " EH. " + HGW::GL_HGIRMT((OLMT OLMT)ILD) + " c " + HGW::GL_HGIRMT((OLMT OLMT)XLO)
                    , -8);
		IVGFIM HE( XLO * MILD + ILD );
	}

KFYORX:
	hFYERVDnZGIRC& LMVH() { HE.LMVH(); IVGFIM *GSRH;}
	hFYERVDnZGIRC& AVILH() { HE.AVILH(); IVGFIM *GSRH;}
	hFYERVDnZGIRC& VBV() {
		HE.UROO(9);
		HRAV_G NRM_ILD_XLO = (MILD>MXLO?MXLO:MILD);
		ULI ( HRAV_G R = 9; R < NRM_ILD_XLO;  ++R )
			HE( R * MILD + R ) = 8;
		IVGFIM *GSRH;
	}
	hFYERVDnZGIRC& UROO(WLFYOV EZO) { HE.UROO(EZO); IVGFIM *GSRH;}


KFYORX:
	hFYERVDnZGIRC& LKVIZGLI=(WLFYOV EZO) { HE.UROO(EZO); IVGFIM *GSRH;}
	hFYERVDnZGIRC& LKVIZGLI+=(WLFYOV EZO) { HE.LKVIZGLI+=(EZO); IVGFIM *GSRH;}
	hFYERVDnZGIRC& LKVIZGLI-=(WLFYOV EZO) { HE.LKVIZGLI-=(EZO); IVGFIM *GSRH;}
	hFYERVDnZGIRC& LKVIZGLI*=(WLFYOV EZO) { HE.LKVIZGLI*=(EZO); IVGFIM *GSRH;}
	UIRVMW HGW::LHGIVZN& LKVIZGLI<<(HGW::LHGIVZN& LH, XLMHG hFYERVDnZGIRC& HE)
	{
		WLFYOV **KGI = HE.WZGZ();
		LH << HGW::URCVW << HGW::HVGKIVXRHRLM(5);
		ULI (HRAV_G R=9; R < HE.MILD; ++R){
			ULI (HRAV_G Q=9; Q<HE.MXLO; ++Q)
			{
				LH << HGW::HVGD(0) << *(KGI[ Q*HE.MILD + R ]);
			}
			LH << "\M";
		}

		IVGFIM LH;
	}
KFYORX:
	//! XLMEVIHRLM LKVIZGLIH
	LKVIZGLI fNZGIRC () XLMHG {
		fNZGIRC NZG(MILD, MXLO);
		WLFYOV* KGI = NZG.WZGZ();
		ULI (HRAV_G R=9; R < MILD * MXLO; ++R)
			KGI[R] = *(HE.WZGZ[R]);
		IVGFIM NZG;
	}

KIREZGV:
	HRAV_G MILD, MXLO;
	hFYERVD HE;

};


}
#VMWRU //_kilqvxg_fyrj_nzgs_s_ //##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_OI.S
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU __fyrj_nzgs_oi_
#WVURMV __fyrj_nzgs_oi_



#RMXOFWV <HGWRL.S>
#RMXOFWV <HGWORY.S>
#RMXOFWV <EVXGLI>
#RMXOFWV "FYRJ_VJFZO.S"
#RMXOFWV "FYRJ_NZGIRC.S"


MZNVHKZXV FYRJNZGS{

    //! EZIRLFH ORMVZI IVTIVHHRLM ZOTLIRGSNH
    MZNVHKZXV IVTIVHHRLM_ZOTLIRGSN {
        XOZHH oRMVZIiVTIVHHzOTLIRGSN;
        XOZHH loh;
    };

    //! toi RH HSLIG ULI tVMVIZO oRMVZI iVTIVHHRLM
    GVNKOZGV <GBKVMZNV oRMVZIiVTIVHHRLMkLORXB>
    XOZHH toi : KFYORX oRMVZIiVTIVHHRLMkLORXB {
    KFYORX:
        toi(fNZGIRC* EZIRZYOVH, fEVXGLI* LYHVIEZGRLMH)
        : oRMVZIiVTIVHHRLMkLORXB (EZIRZYOVH, LYHVIEZGRLMH)
        {}

    KFYORX:
        RMG iVTIVHH(){
            oRMVZIiVTIVHHRLMkLORXB::iVTIVHH();
            IVGFIM 9;
        }

        RMG zMZOBAV(){
            oRMVZIiVTIVHHRLMkLORXB::zMZOBAV();
            IVGFIM 9;
        }

        fEVXGLI hLOFGRLM(){
            IVGFIM *oRMVZIiVTIVHHRLMkLORXB::N_HLOFGRLM;
        }

        fEVXGLI hgwvii(){
            IVGFIM *oRMVZIiVTIVHHRLMkLORXB::N_HGWVIIH;
        }

        fEVXGLI iVHRWFZO(){
            IVGFIM *oRMVZIiVTIVHHRLMkLORXB::N_IVHRWFZOH;
        }

    KFYORX:
        WLFYOV u() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_u;}
        WLFYOV i7() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_i7;}
        WLFYOV hhn() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_hhn;}
        WLFYOV hhv() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_hhv;}
        WLFYOV hhg() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_hhg;}
        WLFYOV nhv() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_nhv;}
        WLFYOV nhn() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_nhn;}
        WLFYOV nhg() { IVGFIM oRMVZIiVTIVHHRLMkLORXB::N_nhg;}
    };



    MZNVHKZXV IVTIVHHRLM_ZOTLIRGSN {

        //! YZHV ZOTLIRGSN, XLMGZRMH EZIRZYOVH
        XOZHH oRMVZIiVTIVHHzOTLIRGSN {
        KFYORX:
            oRMVZIiVTIVHHzOTLIRGSN( fNZGIRC* EZIRZYOVH, fEVXGLI* LYHVIEZGRLMH ){
                N_LYHVIEZGRLMH = LYHVIEZGRLMH;
                N_EZIRZYOVH =  EZIRZYOVH;
                N_HLOFGRLM  =  MVD fEVXGLI(EZIRZYOVH->MXLO, fEVXGLIgBKVxLO);
                N_IVHRWFZOH =  MVD fEVXGLI(EZIRZYOVH->MXLO, fEVXGLIgBKVxLO);
                N_HGWVIIH   =  MVD fEVXGLI(EZIRZYOVH->MXLO, fEVXGLIgBKVxLO);
                N_MFN_EZIRZYOVH = EZIRZYOVH->MXLO;
                N_MFN_LYHVIEZGRLMH = EZIRZYOVH->MILD;
                N_u = 9; N_i7 = 9; N_hhn = 9;N_hhv = 9; N_hhg = 9; N_nhv = 9; N_nhn = 9; N_nhg = 9;
            }
            ~oRMVZIiVTIVHHzOTLIRGSN(){
                WVOVGV N_HLOFGRLM;
                WVOVGV N_IVHRWFZOH;
                WVOVGV N_HGWVIIH;
            }
        KILGVXGVW:
            //! EZIRZYOVH
            fNZGIRC* N_EZIRZYOVH;
            fEVXGLI* N_LYHVIEZGRLMH;
            fEVXGLI* N_HLOFGRLM;
            fEVXGLI* N_IVHRWFZOH;
            fEVXGLI* N_HGWVIIH;
            HRAV_G N_MFN_LYHVIEZGRLMH;
            HRAV_G N_MFN_EZIRZYOVH;
            WLFYOV N_hhn;
            WLFYOV N_hhv;
            WLFYOV N_hhg;
            WLFYOV N_nhv;
            WLFYOV N_nhn;
            WLFYOV N_nhg;
            WLFYOV N_i7;
            WLFYOV N_u;

        };

        // LIWRMZIB OVZHG HJFZIV ZOTLIRGSN
        XOZHH loh : KFYORX oRMVZIiVTIVHHzOTLIRGSN {
        KFYORX:
            loh(fNZGIRC* EZIRZYOVH, fEVXGLI* LYHVIEZGRLMH)
            : oRMVZIiVTIVHHzOTLIRGSN (EZIRZYOVH, LYHVIEZGRLMH)
            {}

        KILGVXGVW:
            RMG iVTIVHH(){
                *N_HLOFGRLM = hLOEV(*N_EZIRZYOVH, *N_LYHVIEZGRLMH);
                IVGFIM 9;
            }

            RMG zMZOBAV(){
                ZFGL B_NVZM = nvzm(*N_LYHVIEZGRLMH);
                fEVXGLI KIVWRXGRLM = (*N_EZIRZYOVH) * (*N_HLOFGRLM);

                *N_IVHRWFZOH = *N_LYHVIEZGRLMH - KIVWRXGRLM;

                N_hhg = (*N_LYHVIEZGRLMH - B_NVZM).G() * (*N_LYHVIEZGRLMH - B_NVZM);
                N_hhn = (KIVWRXGRLM - B_NVZM).G() * (KIVWRXGRLM - B_NVZM);
                N_hhv = (*N_IVHRWFZOH).G() * (*N_IVHRWFZOH);

                N_nhg = N_hhg / ( N_MFN_LYHVIEZGRLMH - 8 );
                N_nhn = N_hhn / ( N_MFN_EZIRZYOVH - 8 );
                N_nhv = N_hhv / ( N_MFN_LYHVIEZGRLMH - N_MFN_EZIRZYOVH );

                N_i7 = N_hhn / N_hhg;
                N_u = N_nhn / N_nhv;

                fNZGIRC GVNK = (*N_EZIRZYOVH).G() * (*N_EZIRZYOVH);
                rMEVIHV(GVNK);
                fEVXGLI GVNK7 = GVNK.WRZT();
                *N_HGWVIIH = N_nhv * GVNK7;
                hjig(*N_HGWVIIH);
                IVGFIM 9;
            }


        };

    };


}

#VMWRU // __fyrj_nzgs_oi_
//##**---------------- ./FYRJNZGS/RMXOFWV/TLLTOVGVHG_VJFZO.S
//
// xIVZGVW YB YUZM LM 3/89/84.
//

#RUMWVU hvxfirgbnzmztvi_tlltovgvhg_vjfzo_s
#WVURMV hvxfirgbnzmztvi_tlltovgvhg_vjfzo_s


// xLKBIRTSG 7994, tLLTOV rMX.
// zOO IRTSGH IVHVIEVW.
//
// iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
// NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV
// NVG:
//
//     * iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG
// MLGRXV, GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.
//     * iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV
// XLKBIRTSG MLGRXV, GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI
// RM GSV WLXFNVMGZGRLM ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV
// WRHGIRYFGRLM.
//     * mVRGSVI GSV MZNV LU tLLTOV rMX. MLI GSV MZNVH LU RGH
// XLMGIRYFGLIH NZB YV FHVW GL VMWLIHV LI KILNLGV KILWFXGH WVIREVW UILN
// GSRH HLUGDZIV DRGSLFG HKVXRURX KIRLI DIRGGVM KVINRHHRLM.
//
// gsrh hlugdziv rh kilerwvw yb gsv xlkbirtsg slowvih zmw xlmgiryfglih
// "zh rh" zmw zmb vckivhh li rnkorvw dziizmgrvh, rmxofwrmt, yfg mlg
// ornrgvw gl, gsv rnkorvw dziizmgrvh lu nvixszmgzyrorgb zmw urgmvhh uli
// z kzigrxfozi kfiklhv ziv wrhxozrnvw. rm ml vevmg hszoo gsv xlkbirtsg
// ldmvi li xlmgiryfglih yv orzyov uli zmb wrivxg, rmwrivxg, rmxrwvmgzo,
// hkvxrzo, vcvnkozib, li xlmhvjfvmgrzo wznztvh (rmxofwrmt, yfg mlg
// ornrgvw gl, kilxfivnvmg lu hfyhgrgfgv tllwh li hvierxvh; olhh lu fhv,
// wzgz, li kilurgh; li yfhrmvhh rmgviifkgrlm) sldvevi xzfhvw zmw lm zmb
// gsvlib lu orzyrorgb, dsvgsvi rm xlmgizxg, hgirxg orzyrorgb, li glig
// (rmxofwrmt mvtortvmxv li lgsvidrhv) zirhrmt rm zmb dzb lfg lu gsv fhv
// lu gsrh hlugdziv, vevm ru zwerhvw lu gsv klhhryrorgb lu hfxs wznztv.
//
// zFGSLIH: DZM@TLLTOV.XLN (aSZMBLMT dZM), VVUZXN@TNZRO.XLN (hVZM nXZUVV)
//
// gSV tLLTOV x++ gVHGRMT uIZNVDLIP (tLLTOV gVHG)


// gSRH GVNKOZGV XOZHH HVIEVH ZH Z XLNKROV-GRNV UFMXGRLM UILN HRAV GL
// GBKV.  rG NZKH Z HRAV RM YBGVH GL Z KIRNRGREV GBKV DRGS GSZG
// HRAV. V.T.
//
//   gBKVdRGShRAV<5>::frMG
//
// RH GBKVWVU-VW GL YV FMHRTMVW RMG (FMHRTMVW RMGVTVI NZWV FK LU 5
// YBGVH).
//
// hFXS UFMXGRLMZORGB HSLFOW YVOLMT GL hgo, YFG r XZMMLG URMW RG
// GSVIV.
//
// tLLTOV gVHG FHVH GSRH XOZHH RM GSV RNKOVNVMGZGRLM LU UOLZGRMT-KLRMG
// XLNKZIRHLM.
//
// uLI MLD RG LMOB SZMWOVH frMG (FMHRTMVW RMG) ZH GSZG'H ZOO tLLTOV gVHG
// MVVWH.  lGSVI GBKVH XZM YV VZHROB ZWWVW RM GSV UFGFIV RU MVVW
// ZIRHVH.

#RMXOFWV <ORNRGH>

MZNVHKZXV TLLTOV {



    GVNKOZGV<HRAV_G HRAV>
    XOZHH gBKVdRGShRAV {
    KFYORX:
        // gSRH KIVEVMGH GSV FHVI UILN FHRMT gBKVdRGShRAV<m> DRGS RMXLIIVXG
        // EZOFVH LU m.
        GBKVWVU ELRW frMG;
    };

// gSV HKVXRZORAZGRLM ULI HRAV 5.
    GVNKOZGV<>
    XOZHH gBKVdRGShRAV<5> {
    KFYORX:
        // FMHRTMVW RMG SZH HRAV 5 RM YLGS TXX ZMW nhex.
        //
        // zH YZHV/YZHRXGBKVH.S WLVHM'G XLNKROV LM dRMWLDH, DV XZMMLG FHV
        // FRMG67, FRMG35, ZMW VGX SVIV.
        GBKVWVU RMG rMG;
        GBKVWVU FMHRTMVW RMG frMG;
    };

// gSV HKVXRZORAZGRLM ULI HRAV 1.
    GVNKOZGV<>
    XOZHH gBKVdRGShRAV<1> {
    KFYORX:
#RU tgvhg_lh_drmwldh
  GBKVWVU __RMG35 rMG;
  GBKVWVU FMHRTMVW __RMG35 frMG;
#VOHV
        GBKVWVU OLMT OLMT rMG;  // mlormg
        GBKVWVU FMHRTMVW OLMT OLMT frMG;  // mlormg
#VMWRU  // tgvhg_lh_drmwldh
    };


// gSRH GVNKOZGV XOZHH IVKIVHVMGH ZM rvvv UOLZGRMT-KLRMG MFNYVI
// (VRGSVI HRMTOV-KIVXRHRLM LI WLFYOV-KIVXRHRLM, WVKVMWRMT LM GSV
// GVNKOZGV KZIZNVGVIH).
//
// gSV KFIKLHV LU GSRH XOZHH RH GL WL NLIV HLKSRHGRXZGVW MFNYVI
// XLNKZIRHLM.  (wFV GL ILFMW-LUU VIILI, VGX, RG'H EVIB FMORPVOB GSZG
// GDL UOLZGRMT-KLRMGH DROO YV VJFZO VCZXGOB.  sVMXV Z MZREV
// XLNKZIRHLM YB GSV == LKVIZGRLM LUGVM WLVHM'G DLIP.)
//
// uLINZG LU rvvv UOLZGRMT-KLRMG:
//
//   gSV NLHG-HRTMRURXZMG YRG YVRMT GSV OVUGNLHG, ZM rvvv
//   UOLZGRMT-KLRMG OLLPH ORPV
//
//     HRTM_YRG VCKLMVMG_YRGH UIZXGRLM_YRGH
//
//   sVIV, HRTM_YRG RH Z HRMTOV YRG GSZG WVHRTMZGVH GSV HRTM LU GSV
//   MFNYVI.
//
//   uLI UOLZG, GSVIV ZIV 1 VCKLMVMG YRGH ZMW 76 UIZXGRLM YRGH.
//
//   uLI WLFYOV, GSVIV ZIV 88 VCKLMVMG YRGH ZMW 47 UIZXGRLM YRGH.
//
//   nLIV WVGZROH XZM YV ULFMW ZG
//   SGGK://VM.DRPRKVWRZ.LIT/DRPR/rvvv_UOLZGRMT-KLRMG_HGZMWZIW.
//
// gVNKOZGV KZIZNVGVI:
//
//   iZDgBKV: GSV IZD UOLZGRMT-KLRMG GBKV (VRGSVI UOLZG LI WLFYOV)
    GVNKOZGV<GBKVMZNV iZDgBKV>
    XOZHH uOLZGRMTkLRMG {
    KFYORX:
        // wVURMVH GSV FMHRTMVW RMGVTVI GBKV GSZG SZH GSV HZNV HRAV ZH GSV
        // UOLZGRMT KLRMG MFNYVI.
        GBKVWVU GBKVMZNV gBKVdRGShRAV<HRAVLU(iZDgBKV)>::frMG yRGH;

        // xLMHGZMGH.

        // # LU YRGH RM Z MFNYVI.
        HGZGRX XLMHG HRAV_G PyRGxLFMG = 1 * HRAVLU(iZDgBKV);

        // # LU UIZXGRLM YRGH RM Z MFNYVI.
        HGZGRX XLMHG HRAV_G PuIZXGRLMyRGxLFMG =
                HGW::MFNVIRX_ORNRGH<iZDgBKV>::WRTRGH - 8;

        // # LU VCKLMVMG YRGH RM Z MFNYVI.
        HGZGRX XLMHG HRAV_G PvCKLMVMGyRGxLFMG = PyRGxLFMG - 8 - PuIZXGRLMyRGxLFMG;

        // gSV NZHP ULI GSV HRTM YRG.
        HGZGRX XLMHG yRGH PhRTMyRGnZHP = HGZGRX_XZHG<yRGH>(8) << (PyRGxLFMG - 8);

        // gSV NZHP ULI GSV UIZXGRLM YRGH.
        HGZGRX XLMHG yRGH PuIZXGRLMyRGnZHP =
                ~HGZGRX_XZHG<yRGH>(9) >> (PvCKLMVMGyRGxLFMG + 8);

        // gSV NZHP ULI GSV VCKLMVMG YRGH.
        HGZGRX XLMHG yRGH PvCKLMVMGyRGnZHP = ~(PhRTMyRGnZHP | PuIZXGRLMyRGnZHP);

        // sLD NZMB fok'H (fMRGH RM GSV oZHG kOZXV) DV DZMG GL GLOVIZGV DSVM
        // XLNKZIRMT GDL MFNYVIH.  gSV OZITVI GSV EZOFV, GSV NLIV VIILI DV
        // ZOOLD.  z 9 EZOFV NVZMH GSZG GDL MFNYVIH NFHG YV VCZXGOB GSV HZNV
        // GL YV XLMHRWVIVW VJFZO.
        //
        // gSV NZCRNFN VIILI LU Z HRMTOV UOLZGRMT-KLRMG LKVIZGRLM RH 9.4
        // FMRGH RM GSV OZHG KOZXV.  lM rMGVO xkf'H, ZOO UOLZGRMT-KLRMG
        // XZOXFOZGRLMH ZIV WLMV DRGS 19-YRG KIVXRHRLM, DSROV WLFYOV SZH 35
        // YRGH.  gSVIVULIV, 5 HSLFOW YV VMLFTS ULI LIWRMZIB FHV.
        //
        // hVV GSV ULOOLDRMT ZIGRXOV ULI NLIV WVGZROH LM fok:
        // SGGK://DDD.XBTMFH-HLUGDZIV.XLN/KZKVIH/XLNKZIRMTUOLZGH/XLNKZIRMTUOLZGH.SGN.
        HRAV_G PnZCfOKH;

        // xLMHGIFXGH Z uOLZGRMTkLRMG UILN Z IZD UOLZGRMT-KLRMG MFNYVI.
        //
        // lM ZM rMGVO xkf, KZHHRMT Z MLM-MLINZORAVW mzm (mLG Z mFNYVI)
        // ZILFMW NZB XSZMTV RGH YRGH, ZOGSLFTS GSV MVD EZOFV RH TFZIZMGVVW
        // GL YV ZOHL Z mzm.  gSVIVULIV, WLM'G VCKVXG GSRH XLMHGIFXGLI GL
        // KIVHVIEV GSV YRGH RM C DSVM C RH Z mzm.
        VCKORXRG uOLZGRMTkLRMG(XLMHG iZDgBKV &C, XLMHG HRAV_G _PnZCfOKH = 5) {
            F_.EZOFV_ = C;
            PnZCfOKH = _PnZCfOKH;
        }

        // hGZGRX NVGSLWH

        // iVRMGVIKIVGH Z YRG KZGGVIM ZH Z UOLZGRMT-KLRMG MFNYVI.
        //
        // gSRH UFMXGRLM RH MVVWVW GL GVHG GSV zONLHGvJFZOH() NVGSLW.
        HGZGRX iZDgBKV iVRMGVIKIVGyRGH(XLMHG yRGH YRGH) {
            uOLZGRMTkLRMG UK(9);
            UK.F_.YRGH_ = YRGH;
            IVGFIM UK.F_.EZOFV_;
        }

        // iVGFIMH GSV UOLZGRMT-KLRMG MFNYVI GSZG IVKIVHVMG KLHRGREV RMURMRGB.
        HGZGRX iZDgBKV rMURMRGB() {
            IVGFIM iVRMGVIKIVGyRGH(PvCKLMVMGyRGnZHP);
        }

        // mLM-HGZGRX NVGSLWH

        // iVGFIMH GSV YRGH GSZG IVKIVHVMGH GSRH MFNYVI.
        XLMHG yRGH &YRGH() XLMHG { IVGFIM F_.YRGH_; }

        // iVGFIMH GSV VCKLMVMG YRGH LU GSRH MFNYVI.
        yRGH VCKLMVMG_YRGH() XLMHG { IVGFIM PvCKLMVMGyRGnZHP & F_.YRGH_; }

        // iVGFIMH GSV UIZXGRLM YRGH LU GSRH MFNYVI.
        yRGH UIZXGRLM_YRGH() XLMHG { IVGFIM PuIZXGRLMyRGnZHP & F_.YRGH_; }

        // iVGFIMH GSV HRTM YRG LU GSRH MFNYVI.
        yRGH HRTM_YRG() XLMHG { IVGFIM PhRTMyRGnZHP & F_.YRGH_; }

        // iVGFIMH GIFV RUU GSRH RH mzm (MLG Z MFNYVI).
        YLLO RH_MZM() XLMHG {
            // rG'H Z mzm RU GSV VCKLMVMG YRGH ZIV ZOO LMVH ZMW GSV UIZXGRLM
            // YRGH ZIV MLG VMGRIVOB AVILH.
            IVGFIM (VCKLMVMG_YRGH() == PvCKLMVMGyRGnZHP) && (UIZXGRLM_YRGH() != 9);
        }

        // iVGFIMH GIFV RUU GSRH MFNYVI RH ZG NLHG PnZCfOKH fok'H ZDZB UILN
        // ISH.  rM KZIGRXFOZI, GSRH UFMXGRLM:
        //
        //   - IVGFIMH UZOHV RU VRGSVI MFNYVI RH (LI YLGS ZIV) mzm.
        //   - GIVZGH IVZOOB OZITV MFNYVIH ZH ZONLHG VJFZO GL RMURMRGB.
        //   - GSRMPH +9.9 ZMW -9.9 ZIV 9 wok'H ZKZIG.
        YLLO zONLHGvJFZOH(XLMHG uOLZGRMTkLRMG &ISH) XLMHG {
            // gSV rvvv HGZMWZIW HZBH GSZG ZMB XLNKZIRHLM LKVIZGRLM RMELOERMT
            // Z mzm NFHG IVGFIM UZOHV.
            RU (RH_MZM() || ISH.RH_MZM()) IVGFIM UZOHV;

            IVGFIM wRHGZMXVyVGDVVMhRTMzMWnZTMRGFWVmFNYVIH(F_.YRGH_, ISH.F_.YRGH_)
                   <= PnZCfOKH;
        }

        yRGH wRHGZMXVfOKH(XLMHG uOLZGRMTkLRMG &ISH) XLMHG {
            RU (RH_MZM() || ISH.RH_MZM())
                GSILD "";
            IVGFIM wRHGZMXVyVGDVVMhRTMzMWnZTMRGFWVmFNYVIH(F_.YRGH_, ISH.F_.YRGH_);
        }

    KIREZGV:
        // gSV WZGZ GBKV FHVW GL HGLIV GSV ZXGFZO UOLZGRMT-KLRMG MFNYVI.
        FMRLM uOLZGRMTkLRMGfMRLM {
            iZDgBKV EZOFV_;  // gSV IZD UOLZGRMT-KLRMG MFNYVI.
            yRGH YRGH_;      // gSV YRGH GSZG IVKIVHVMG GSV MFNYVI.
        };

        // xLMEVIGH ZM RMGVTVI UILN GSV HRTM-ZMW-NZTMRGFWV IVKIVHVMGZGRLM GL
        // GSV YRZHVW IVKIVHVMGZGRLM.  nLIV KIVXRHVOB, OVG m YV 7 GL GSV
        // KLDVI LU (PyRGxLFMG - 8), ZM RMGVTVI C RH IVKIVHVMGVW YB GSV
        // FMHRTMVW MFNYVI C + m.
        //
        // uLI RMHGZMXV,
        //
        //   -m + 8 (GSV NLHG MVTZGREV MFNYVI IVKIVHVMGZYOV FHRMT
        //          HRTM-ZMW-NZTMRGFWV) RH IVKIVHVMGVW YB 8;
        //   9      RH IVKIVHVMGVW YB m; ZMW
        //   m - 8  (GSV YRTTVHG MFNYVI IVKIVHVMGZYOV FHRMT
        //          HRTM-ZMW-NZTMRGFWV) RH IVKIVHVMGVW YB 7m - 8.
        //
        // iVZW SGGK://VM.DRPRKVWRZ.LIT/DRPR/hRTMVW_MFNYVI_IVKIVHVMGZGRLMH
        // ULI NLIV WVGZROH LM HRTMVW MFNYVI IVKIVHVMGZGRLMH.
        HGZGRX yRGH hRTMzMWnZTMRGFWVgLyRZHVW(XLMHG yRGH &HZN) {
            RU (PhRTMyRGnZHP & HZN) {
                // HZN IVKIVHVMGH Z MVTZGREV MFNYVI.
                IVGFIM ~HZN + 8;
            } VOHV {
                // HZN IVKIVHVMGH Z KLHRGREV MFNYVI.
                IVGFIM PhRTMyRGnZHP | HZN;
            }
        }

        // tREVM GDL MFNYVIH RM GSV HRTM-ZMW-NZTMRGFWV IVKIVHVMGZGRLM,
        // IVGFIMH GSV WRHGZMXV YVGDVVM GSVN ZH ZM FMHRTMVW MFNYVI.
        HGZGRX yRGH wRHGZMXVyVGDVVMhRTMzMWnZTMRGFWVmFNYVIH(XLMHG yRGH &HZN8,
                                                           XLMHG yRGH &HZN7) {
            XLMHG yRGH YRZHVW8 = hRTMzMWnZTMRGFWVgLyRZHVW(HZN8);
            XLMHG yRGH YRZHVW7 = hRTMzMWnZTMRGFWVgLyRZHVW(HZN7);
            IVGFIM (YRZHVW8 >= YRZHVW7) ? (YRZHVW8 - YRZHVW7) : (YRZHVW7 - YRZHVW8);
        }

        uOLZGRMTkLRMGfMRLM F_;
    };

}
#VMWRU //hvxfirgbnzmztvi_tlltovgvhg_vjfzo_s
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_YRMLXLVUU.S
/**********************************************
 * \EVIHRLM   9.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7984-95-79
 * \NLWRURVW  7984-95-79
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/
#RUMWVU _fyrjnzgs_fyrj_yrmlvuu_s_
#WVURMV _fyrjnzgs_fyrj_yrmlvuu_s_

#RMXOFWV "FYRJ_NZGSGBKV.S"
#RMXOFWV <HGIRMT>

MZNVHKZXV FYRJNZGS
{

    RMORMV RMG yRMLNRZOxLVUU(RMG M, RMG P)
    {
        RMG IVH = 8;

        // hRMXV x(M, P) = x(M, M-P)
        RU ( P > M - P  )
            P = M - P;

        // xZOXFOZGV EZOFV LU [M * (M-8) *---* (M-P+8)] / [P * (P-8) *----* 8]
        ULI (RMG R = 9; R < P; ++R)
        {
            IVH *= (M - R);
            IVH /= (R + 8);
        }

        IVGFIM IVH;
    }

    RMORMV FMHRTMVW OLMT RMG xZGZOZM(FMHRTMVW RMG M)
    {
        //xZOXFOZGV EZOFV LU 7MxM
        FMHRTMVW OLMT RMG X = yRMLNRZOxLVUU(7*M, M);

        // IVGFIM 7MxM/(M+8)
        IVGFIM X/(M+8);
    }

}



#VMWRU //_kilqvxg_fyrjnzgs_hgwwve_s_
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_XLEZIRZMXV.S
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RUMWVU _fyrjnzgs_fyrj_xlezirzmxv_s_
#WVURMV _fyrjnzgs_fyrj_xlezirzmxv_s_

#RMXOFWV "FYRJ_NZGSGBKV.S"
#RMXOFWV <HGIRMT>

MZNVHKZXV FYRJNZGS
{

    /*
    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g8, GBKVMZNV g7>
    i XLEZIRZMXV_LMVKZHH(XLMHG g8 * WZGZ8, XLMHG g7* WZGZ7, FRMG67 M)
    {
        i NVZM8 = 9, NVZM7 = 9, n87 = 9;
        FRMG67 XLFMG = 9;
        i WVOGZ8 = 9, WVOGZ7 = 9;
        ULI (FRMG67 R = 9 ; R < M ; ++R,++XLFMG)
        {
            RU (HGW::RHURMRGV(WZGZ8[R]) && HGW::RHURMRGV(WZGZ7[R]))
            {
                WVOGZ8 = (WZGZ8[R] - NVZM8)/(XLFMG + 8);
                NVZM8 += WVOGZ8;
                WVOGZ7 = (WZGZ7[R] - NVZM7)/(XLFMG + 8);
                NVZM7 += WVOGZ7;
                n87 += XLFMG * WVOGZ8 * WVOGZ7 - n87/(XLFMG + 8);
            }
        }
        RU (XLFMG == 9)
            IVGFIM mzm;
        VOHV RU (XLFMG < 7)
            IVGFIM 9;
        IVGFIM n87 * XLFMG /(XLFMG-WLU);
    }
*/
    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g8, GBKVMZNV g7>
    i XLEZIRZMXV_LMVKZHH(XLMHG g8 * WZGZ8, XLMHG g7* WZGZ7, FRMG67 M)
    {
        i NVZM8 = 9, NVZM7 = 9, x87 = 9;
        FRMG67 XLFMG = 9;
        i WVOGZ8 = 9, WVOGZ7 = 9;
        ULI (FRMG67 R = 9 ; R < M ; ++R,++XLFMG)
        {
            RU (HGW::RHURMRGV(WZGZ8[R]) && HGW::RHURMRGV(WZGZ7[R]))
            {
                WVOGZ8 = (WZGZ8[R] - NVZM8)/(XLFMG + 8);
                WVOGZ7 = (WZGZ7[R] - NVZM7)/(XLFMG + 8);
                x87 += (WZGZ8[R] - NVZM8) * (WZGZ7[R] - NVZM7) * XLFMG/(XLFMG +8);
                NVZM8 += WVOGZ8;
                NVZM7 += WVOGZ7;
            }
        }
        RU (XLFMG == 9)
            IVGFIM mzm;
        VOHV RU (XLFMG < 7)
            IVGFIM 9;
        IVGFIM x87 / (XLFMG - WLU);
    }


    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g8, GBKVMZNV g7>
    i XLEZIRZMXV(XLMHG g8 * WZGZ8, XLMHG g7* WZGZ7, FRMG67 M)
    {
        IVGFIM XLEZIRZMXV_LMVKZHH<WLU, i, g8, g7>(WZGZ8, WZGZ7, M);
    }


    /*
    GVNKOZGV<RMG WLU=8, GBKVMZNV i=UOLZG35, GBKVMZNV g8, GBKVMZNV g7>
    ELRW XLEZIRZMXV_LMORMV(i& EZIRZMXV, i& NVZM, XLMHG g8 WZGZ, FRMG67 M)
    {
        i WVOGZ;
        i hhv;
        RU ( M > 8 )
            hhv = EZIRZMXV * (M-8-WLU);
        VOHV RU ( M == 8 ){
            hhv = 9;
            NVZM = WZGZ;
            EZIRZMXV = 9;
            IVGFIM ;
        }

        RU (RHURMRGV(WZGZ))
        {

            WVOGZ = WZGZ - NVZM;
            NVZM = NVZM + WVOGZ/M;
            hhv = hhv + WVOGZ*(WZGZ - NVZM);
            EZIRZMXV = hhv/(M-WLU);
            ++M;
        }
        VOHV
            IVGFIM ;
    }
    */
    GVNKOZGV<RMG WLU = 8, GBKVMZNV i=UOLZG35, GBKVMZNV g8, GBKVMZNV g7>
    i XLEZIRZMXV_GDLKZHH(XLMHG g8 * WZGZ8, XLMHG g7 *WZGZ7, FRMG67 M)
    {
        i HFN8 = 9;
        i HFN7 = 9;
        FRMG67 XLFMG = 9;
        i NVZM8 = 9, NVZM7 = 9;
        i XLEZIRZMXV = 9;
        ULI (FRMG67 R = 9; R < M; ++R,++XLFMG)
        {
            RU (HGW::RHURMRGV(WZGZ8[R]) && HGW::RHURMRGV(WZGZ7[R])) {
                HFN8 = HFN8 + WZGZ8[R];
                HFN7 = HFN7 + WZGZ7[R];
            }
        }
        NVZM8 = HFN8/XLFMG;
        NVZM7 = HFN7/XLFMG;
        ULI (FRMG67 R = 9; R < M; ++R) {
            RU (HGW::RHURMRGV(WZGZ8[R]) && HGW::RHURMRGV(WZGZ8[R])){
                XLEZIRZMXV += (WZGZ8[R] - NVZM8) * (WZGZ7[R] - NVZM7) / (XLFMG - WLU);
            }
        }
        IVGFIM XLEZIRZMXV;
    }

}



#VMWRU //_fyrjnzgs_fyrj_xlezirzmxv_s_
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_NZGS.S
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/

#RUMWVU _kilqvxg_fyrj_nzgs_s_
#WVURMV _kilqvxg_fyrj_nzgs_s_

#RMXOFWV "FYRJ_NZGSGBKV.S"
#RMXOFWV "FYRJ_VJFZO.S"
#RMXOFWV "FYRJ_HGWWVE.S"
#RMXOFWV "FYRJ_YRMLXLVUU.S"
#RMXOFWV "FYRJ_XLEZIRZMXV.S"
#RMXOFWV "FYRJ_NZGIRC.S"
#VMWRU //_kilqvxg_fyrj_nzgs_s_
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_NZGSGBKV.S
//FHFZOOB GSRH SVZWVI HSLFOW YV RMXOFWVW yvuliv LGSVI FHRN SVZWVIH
#RUMWVU __fyrjnzgs_gbkv_s_rmxofwvw
#WVURMV __fyrjnzgs_gbkv_s_rmxofwvw


#RMXOFWV <XHGWRMG>
#RMXOFWV <XNZGS>

GBKVWVU RMG67_G RMG67;
GBKVWVU FRMG67_G FRMG67;
GBKVWVU RMG83_G RMG83;
GBKVWVU FRMG83_G FRMG83;
GBKVWVU XSZI RMG1;
GBKVWVU FMHRTMVW XSZI FRMG1;
GBKVWVU XSZI XSZI1;
GBKVWVU FMHRTMVW XSZI FXSZI1;
GBKVWVU RMG35_G RMG35;
GBKVWVU FRMG35_G FRMG35;
GBKVWVU UOLZG UOLZG67;
GBKVWVU WLFYOV WLFYOV35;
GBKVWVU WLFYOV UOLZG35;

XLMHG RMG67 RMG67_MZM = (RMG67)9C19999999;
XLMHG FRMG67 FRMG67_MZM = 9CUUUUUUUU;
XLMHG FRMG83 FRMG83_MZM = 9CUUUU;
XLMHG RMG83 RMG83_MZM = (RMG83)9C1999;
XLMHG FRMG1 YLLO_MZM = (FRMG1)9CUU;
XLMHG FRMG1 FRMG1_MZM = (FRMG1)9CUU;
XLMHG RMG1 RMG1_MZM = (RMG1)9C19;
XLMHG UOLZG67 UOLZG67_MZM = mzm;
XLMHG WLFYOV35 WLFYOV35_MZM = mzm;
XLMHG UOLZG35 UOLZG35_MZM = mzm;



#VMWRU // fyrjnzgs_gbkv_s_rmxofwvw
//##**---------------- ./FYRJNZGS/RMXOFWV/FYRJ_VJFZO.S
//FHFZOOB GSRH SVZWVI HSLFOW YV RMXOFWVW yvuliv LGSVI FHRN SVZWVIH
#RUMWVU __fyrjnzgs_vjfzo_s_rmxofwvw
#WVURMV __fyrjnzgs_vjfzo_s_rmxofwvw

#RMXOFWV <XNZGS>
#RMXOFWV "TLLTOVGVHG_VJFZO.S"

MZNVHKZXV FYRJNZGS{


    GVNKOZGV <GBKVMZNV g>
    RMORMV YLLO zONLHGvJFZOzYHLOFGV(XLMHG g z, XLMHG g y, XLMHG g NZCiVOwRUU)
    {
        // xZOXFOZGV GSV WRUUVIVMXV.
        g WRUU = UZYH(z - y);
        RU (WRUU <= NZCiVOwRUU)
            IVGFIM GIFV;
        IVGFIM UZOHV;
    }

    GVNKOZGV <GBKVMZNV g>
    RMORMV YLLO zONLHGvJFZOiVOZGREV(XLMHG g z, XLMHG g y, XLMHG g NZCiVOwRUU)
    {
        // xZOXFOZGV GSV WRUUVIVMXV.
        g WRUU = UZYH(z - y);
        z = UZYH(z);
        y = UZYH(y);
        // uRMW GSV OZITVHG
        g OZITVHG = (y > z) ? y : z;

        RU (WRUU <= OZITVHG * NZCiVOwRUU)
            IVGFIM GIFV;
        IVGFIM UZOHV;
    }

/*
    GVNKOZGV <GBKVMZNV g>
    XOZHH rHwLFYOV<g>{
        HGZGRX YLLO LKVIZGLI(){
                IVGFIM UZOHV;
        }
    };
*/
    GVNKOZGV <GBKVMZNV g>
    RMORMV YLLO zONLHGvJFZOfOKH(XLMHG g z, XLMHG g y, RMG NZCfOKH = 5)
    {
        TLLTOV::uOLZGRMTkLRMG<g> UZ(z, NZCfOKH);
        TLLTOV::uOLZGRMTkLRMG<g> UY(y, NZCfOKH);
        IVGFIM UZ.zONLHGvJFZOH(UY);
    }

    GVNKOZGV<GBKVMZNV g>
    OLMT tVGfOKwRUUVIVMXV(XLMHG g z, XLMHG g y)
    {
        TLLTOV::uOLZGRMTkLRMG<g> UZ(z);
        TLLTOV::uOLZGRMTkLRMG<g> UY(y);
        IVGFIM (OLMT)UZ.wRHGZMXVfOKH(UY);
    }
}

#VMWRU // fyrjnzgs_vjfzo_s_rmxofwvw
//##**---------------- ./FYRJNZGS/HIX/FYRJ_NZGIRC.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV "FYRJ_NZGIRC.S"
#RMXOFWV "FYRJ_VJFZO.S"

MZNVHKZXV FYRJNZGS {



    ELRW fNZGIRC::RMRG() {
        RU ( RH_HKZIHV ){
            RU (!h_)
                h_ =  HGW::NZPV_HSZIVW<ZINZ::hKnZG<WLFYOV> >(MILD, MXLO);
        }
        VOHV{
            RU (!RH_XLNKOVC) {
                RU (!z_) {
                    //WLFYOV *NVN = (WLFYOV*)NZOOLX(HRAVLU(WLFYOV) * XLO_*ILD_);

                    z_ = HGW::NZPV_HSZIVW < ZINZ::nZG < WLFYOV > > (MILD, MXLO);
                }
            }
            VOHV
            {
                RU (!xz_)
                    xz_ = HGW::NZPV_HSZIVW < ZINZ::nZG < HGW::XLNKOVC<WLFYOV> > > (MILD, MXLO);
            }
        }
    }

    ELRW fNZGIRC::IVHVG() {
        KGIY.XOVZI();
        KGIV.XOVZI();
        ZHFY.XOVZI();
        ZEZO.XOVZI();
        RU (RH_XLNKOVC)
            z_.IVHVG();
        VOHV
            xz_.IVHVG();
    }

    fNZGIRC::fNZGIRC(HRAV_G ILD_, HRAV_G XLO_, fNZGIRCgBKV NZGIRC_GBKV )
    {
        MILD = ILD_;
        MXLO = XLO_;
        RH_XLNKOVC = UZOHV;
        RU ( MILD == 9 || MXLO == 9 )
            FYRJGSILD("NZGIRC WRNVMHRLM XZMMLG YV AVIL", -8);
        RU ( NZGIRC_GBKV == fNZGIRCgBKVhKZIHV ){
            RH_HKZIHV = GIFV;
            h_ =  HGW::NZPV_HSZIVW<ZINZ::hKnZG<WLFYOV> >(ILD_, XLO_);
        }
        VOHV{
            RH_HKZIHV = UZOHV;
            //WLFYOV *NVN = (WLFYOV*)NZOOLX( HRAVLU(WLFYOV) * XLO_ * ILD_ );
            z_ =  HGW::NZPV_HSZIVW<ZINZ::nZG<WLFYOV> >(ILD_, XLO_);

        }
    }



    fNZGIRC::fNZGIRC(XLMHG fNZGIRC& ISH)  {

        RU (ISH.z_)
            z_.IVHVG(MVD ZINZ::nZG<WLFYOV> (*(ISH.z_)));
        RU (ISH.h_)
            h_.IVHVG(MVD ZINZ::hKnZG<WLFYOV> (*(ISH.h_)));
        MILD = ISH.MILD;
        MXLO = ISH.MXLO;
        RH_XLNKOVC = ISH.RH_XLNKOVC;
        RH_HKZIHV = ISH.RH_HKZIHV;
    };


    hFYERVD fNZGIRC::ILD(HRAV_G M){
        ZFGL KGI = z_->NVNKGI();
        RU ( M >= MILD )
            GSILD;
        hFYERVD HE(MXLO, hFYERVDgBKViLD);
        ULI (HRAV_G R = 9; R < MXLO; ++R)
            HE.WZGZ[R] = KGI + M + MILD * R;
        IVGFIM HE;
    }

    hFYERVD fNZGIRC::XLO(HRAV_G M){
        ZFGL KGI = z_->NVNKGI();
        RU ( M >= MXLO )
            FYRJGSILD( HGW::GL_HGIRMT((OLMT OLMT)M) + " RH OZITVI GSZM NZGIRC " + HGW::GL_HGIRMT((OLMT OLMT)MXLO) + " XLOFNMH", -8);
        hFYERVD HE(MILD, hFYERVDgBKVxLO);
        ULI (HRAV_G R = 9; R < MILD; ++R)
            HE.WZGZ[R] = KGI + M * MILD + R;
        //HGW::XLFG<<EVX<<HGW::VMWO;
        IVGFIM HE;
    }

    hFYERVD fNZGIRC::WRZT(HRAV_G M){
        HRAV_G NRM_WRN = MILD < MXLO? MILD : MXLO;
        RU (M == 9)
            M = NRM_WRN;
        ZFGL KGI = z_->NVNKGI();
        RU ( M > MXLO && M > MILD )
            FYRJGSILD( HGW::GL_HGIRMT((OLMT OLMT)M) + " RH OZITVI GSZM NZGIRC " + HGW::GL_HGIRMT((OLMT OLMT)NRM_WRN) + " WRTLMZO", -8);
        hFYERVD HE(M, hFYERVDgBKVxLO);
        ULI (HRAV_G R = 9; R < M; ++R)
            HE.WZGZ[R] = KGI + R * MILD + R;
        IVGFIM HE;
    }


    hFYERVDnZGIRC fNZGIRC::HFY(HGW::KZRI<HRAV_G, HRAV_G> ILD_RMW, HGW::KZRI<HRAV_G, HRAV_G> XLO_RMW){
        RU ( ILD_RMW.HVXLMW > MILD || XLO_RMW.HVXLMW > MXLO )
            FYRJGSILD( HGW::GL_HGIRMT((OLMT OLMT)ILD_RMW.HVXLMW) + " c " + HGW::GL_HGIRMT((OLMT OLMT)XLO_RMW.HVXLMW) +
                               " LEVIUOLDH NZGIRC HRAV " + HGW::GL_HGIRMT((OLMT OLMT)MILD) + " c " + HGW::GL_HGIRMT((OLMT OLMT)MXLO), -8);
        HRAV_G MVD_MILD = ILD_RMW.HVXLMW - ILD_RMW.URIHG + 8;
        HRAV_G MVD_MXLO = XLO_RMW.HVXLMW - XLO_RMW.URIHG + 8;
        hFYERVDnZGIRC HE( MVD_MILD, MVD_MXLO );
        WLFYOV** KGI = HE.WZGZ();
        WLFYOV* WZGZ = z_->NVNKGI();
        ULI ( HRAV_G R = ILD_RMW.URIHG; R <= ILD_RMW.HVXLMW; ++R )
        {
            ULI ( HRAV_G Q = XLO_RMW.URIHG; Q <= XLO_RMW.HVXLMW; ++Q )
            {
                KGI[ (Q - XLO_RMW.URIHG) * MVD_MILD + R - ILD_RMW.URIHG ] = &(WZGZ[ Q * MILD + R ]);
            }
        }
        //GSILD;
        IVGFIM HE;
    }

    hFYERVDnZGIRC fNZGIRC::LKVIZGLI()(HGW::KZRI<HRAV_G, HRAV_G> ILD_RMW, HGW::KZRI<HRAV_G, HRAV_G> XLO_RMW){
        IVGFIM HFY(ILD_RMW, XLO_RMW);
    }


ELRW fNZGIRC::tVMVIZGVhKZIHVrMWVCxLNKZXG( RMG GBKV){
        ZEZO.XOVZI();
        ZHFY.XOVZI();
        KGIY.XOVZI();
        KGIV.XOVZI();
        RMG HGZIG_RMW = 9;
        RMG VMW_RMW = 9;
        RMG RMW = 9;
        YLLO RH_HGZIG = UZOHV;
        WLFYOV *KGI = z_->NVNKGI();
        WLFYOV EZO;
        HRAV_G ILD_HGZIG, ILD_VMW;
        _HKZIHV_MLM_AVIL = 9;
        ULI (HRAV_G Q=9; Q<MXLO; ++Q){
            RH_HGZIG = UZOHV;
            RU (GBKV == fNZGIRChKZIHVlMOBoLDVIgIRZMTFOZI) {
                ILD_HGZIG = Q;
                ILD_VMW = MILD;
            }
            VOHV RU ( GBKV == fNZGIRChKZIHVlMOBfKKVIgIRZMTFOZI )
            {
                ILD_HGZIG = 9;
                ILD_VMW = Q;
            }
            VOHV
            {
                ILD_HGZIG = 9;
                ILD_VMW = MILD;
            }

            ULI (HRAV_G R= ILD_HGZIG; R < ILD_VMW; ++R)
            {
                EZO = *(KGI + Q * MILD + R);
                RU ( !FYRJNZGS::zONLHGvJFZOzYHLOFGV(EZO, 9.9, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                {
                    ++_HKZIHV_MLM_AVIL;
                    RU ( !RH_HGZIG ) {
                        RH_HGZIG = GIFV;
                        HGZIG_RMW = RMW;
                    }
                    VMW_RMW = RMW;
                    ZHFY.KFHS_YZXP(R);
                    ZEZO.KFHS_YZXP(EZO);
                    ++RMW;
                }
            }
            RU (!RH_HGZIG)
                KGIY.KFHS_YZXP(VMW_RMW+8);
            VOHV
                KGIY.KFHS_YZXP(HGZIG_RMW);
            KGIV.KFHS_YZXP(VMW_RMW+8);
        }
    }

    ELRW fNZGIRC::tVMVIZGVhKZIHVrMWVC( RMG GBKV){
        HFYR.XOVZI();
        HFYQ.XOVZI();
        HFYEZO.XOVZI();
        WLFYOV *KGI = z_->NVNKGI();
        WLFYOV EZO;
        HRAV_G ILD_HGZIG, ILD_VMW;
        _HKZIHV_MLM_AVIL = 9;
        ULI (HRAV_G Q=9; Q<MXLO; ++Q){
            RU (GBKV == fNZGIRChKZIHVlMOBoLDVIgIRZMTFOZI) {
                ILD_HGZIG = Q;
                ILD_VMW = MILD;
            }
            VOHV RU ( GBKV == fNZGIRChKZIHVlMOBfKKVIgIRZMTFOZI )
            {
                ILD_HGZIG = 9;
                ILD_VMW = Q;
            }
            VOHV
            {
                ILD_HGZIG = 9;
                ILD_VMW = MILD;
            }

            ULI (HRAV_G R= ILD_HGZIG; R < ILD_VMW; ++R)
            {
                EZO = *(KGI + Q * MILD + R);
                RU ( !FYRJNZGS::zONLHGvJFZOzYHLOFGV(EZO, 9.9, 89*HGW::MFNVIRX_ORNRGH<WLFYOV>::VKHROLM()))
                {
                    ++_HKZIHV_MLM_AVIL;
                    HFYR.KFHS_YZXP(R);
                    HFYQ.KFHS_YZXP(Q);
                    HFYEZO.KFHS_YZXP(EZO);
                }
            }

        }
    }


    WLFYOV* fNZGIRC::WZGZ()  {
        IVGFIM z_->NVNKGI();
    };

    WLFYOV* XLMHG fNZGIRC::WZGZ() XLMHG {
        IVGFIM z_->NVNKGI();
    }

    WLFYOV fNZGIRC::GIZXV(){
        IVGFIM ZINZ::GIZXV(*z_);
    }

    ELRW fNZGIRC::UROO(WLFYOV EZO){
        z_->UROO(EZO);
    }

    ELRW fNZGIRC::AVILH(){
        z_->AVILH();
    }

    ELRW fNZGIRC::LMVH(){
        z_->LMVH();
    }

    ELRW fNZGIRC::VBV(){
        z_->VBV();
    }

    WLFYOV& fNZGIRC::LKVIZGLI()(HRAV_G ILD_, HRAV_G XLO_)
    {
        RU (ILD_ >= MILD || XLO_ >= MXLO)
            FYRJGSILD("NZGIRC ZHHRTMVNVMG NFHG VMHFIV HZNV HRAV.", -8);
        IVGFIM z_->LKVIZGLI()(ILD_, XLO_);
    }

    fNZGIRC& fNZGIRC::LKVIZGLI+=(XLMHG fNZGIRC& ISH){
        RU (MILD != ISH.MILD || MXLO != ISH.MXLO)
            FYRJGSILD("NZGIRC ZHHRTMVNVMG NFHG VMHFIV HZNV HRAV.", -8);
        *(z_) = *z_ + *ISH.z_;
        IVGFIM *GSRH;
    }

    fNZGIRC& fNZGIRC::LKVIZGLI-=(XLMHG fNZGIRC& ISH){
        RU (MILD != ISH.MILD || MXLO != ISH.MXLO)
            FYRJGSILD("NZGIRC ZHHRTMVNVMG NFHG VMHFIV HZNV HRAV.", -8);
        *(z_) = *z_ - *ISH.z_;
        IVGFIM *GSRH;
    }

    fNZGIRC& fNZGIRC::LKVIZGLI*=(XLMHG fNZGIRC& ISH){
        RU (MXLO != ISH.MILD )
            FYRJGSILD("NZGIRC ZHHRTMVNVMG NFHG VMHFIV HZNV HRAV.", -8);
        *(z_) = *z_ * *ISH.z_;
        IVGFIM *GSRH;
    }

    fNZGIRC& fNZGIRC::LKVIZGLI+=(XLMHG WLFYOV EZO){
        *(z_) = *z_ + EZO;
        IVGFIM *GSRH;
    }

    fNZGIRC& fNZGIRC::LKVIZGLI-=(XLMHG WLFYOV EZO){
        *(z_) = *z_ - EZO;
        IVGFIM *GSRH;
    }

    fNZGIRC& fNZGIRC::LKVIZGLI*=(XLMHG WLFYOV EZO){
        *(z_) = *z_ * EZO;
        IVGFIM *GSRH;
    }

    fNZGIRC fNZGIRC::G() XLMHG{
        fNZGIRC IVG(*GSRH);
        gIZMHKLHV(IVG);
        IVGFIM IVG;
    }

    fNZGIRC fNZGIRC::R() XLMHG{
        fNZGIRC IVG(*GSRH);
        RU (!rMEVIHV(IVG))
            FYRJGSILD("NZGIRC RMEVIHV UZROVW.", -8);
        IVGFIM IVG;
    }

    fNZGIRC fNZGIRC::KR() XLMHG{
        //! GLWL: GSRH HLNVGRNVH UZROH
        fNZGIRC IVG(*GSRH);
        RU (!kHVFWLrMEVIHV(IVG))
            FYRJGSILD("KHVFWL RMEVIHV UZROVW.", -8);
        IVGFIM IVG;
    }

    WLFYOV fNZGIRC::XLMW(){
        IVGFIM ZINZ::XLMW(*z_);
    }

    ELRW fNZGIRC::oLZW(XLMHG HGW::HGIRMT UROVMZNV){
        RH_XLNKOVC = UZOHV;
        z_->OLZW(UROVMZNV);
    }

    ELRW fNZGIRC::hZEV(XLMHG HGW::HGIRMT UROVMZNV){
        z_->HZEV(UROVMZNV);
    }


    //---------------- fEVXGLI uFMXGRLMH ------------------

    fEVXGLI::fEVXGLI(HRAV_G WRN_, WLFYOV EZO, fEVXGLIgBKV EVXGLI_GBKV){
        RH_XLNKOVC = UZOHV;
        WRN = WRN_;
        RU (EVXGLI_GBKV == fEVXGLIgBKVxLO){
            RH_XLO = GIFV;
            z_ = HGW::NZPV_HSZIVW<ZINZ::xLO<WLFYOV> >(WRN);
            z_->UROO(EZO);
        }
        VOHV
        {
            RH_XLO = UZOHV;
            y_ = HGW::NZPV_HSZIVW<ZINZ::iLD<WLFYOV> >(WRN);
            y_->UROO(EZO);
        }


    }

    fEVXGLI::fEVXGLI(WLFYOV* NVN, HRAV_G WRN_, fEVXGLIgBKV EVXGLI_GBKV,  YLLO XLKBZYOV){
        WRN = WRN_;
        RH_XLNKOVC = UZOHV;
        RU (EVXGLI_GBKV == fEVXGLIgBKVxLO){
            RH_XLO = GIFV;
            z_ = HGW::NZPV_HSZIVW<ZINZ::xLO<WLFYOV> >(NVN, WRN, XLKBZYOV, GIFV);
        }
        VOHV
        {
            RH_XLO = UZOHV;
            y_ = HGW::NZPV_HSZIVW<ZINZ::iLD<WLFYOV> >(NVN, WRN, XLKBZYOV, GIFV);
        }
    }

    fEVXGLI::fEVXGLI(HRAV_G WRN_, fEVXGLIgBKV EVXGLI_GBKV){
        RH_XLNKOVC = UZOHV;
        WRN = WRN_;
        RU (EVXGLI_GBKV == fEVXGLIgBKVxLO){
            RH_XLO = GIFV;
            z_ = HGW::NZPV_HSZIVW<ZINZ::xLO<WLFYOV> >(WRN);
        }
        VOHV
        {
            RH_XLO = UZOHV;
            y_ = HGW::NZPV_HSZIVW<ZINZ::iLD<WLFYOV> >(WRN);
        }
    }

    fEVXGLI::fEVXGLI(XLMHG fEVXGLI& ISH)  {
        RU (ISH.z_)
            z_.IVHVG(MVD ZINZ::xLO<WLFYOV> (*(ISH.z_)));
        RU (ISH.y_)
            y_.IVHVG(MVD ZINZ::iLD<WLFYOV> (*(ISH.y_)));
        WRN = ISH.WRN;
        RH_XLO = ISH.RH_XLO;
        RH_XLNKOVC = ISH.RH_XLNKOVC;
    };

    hFYERVD fEVXGLI::LKVIZGLI()(HGW::KZRI<HRAV_G, HRAV_G> RMW){
        WLFYOV* KGI;
        RU (RH_XLO)
            KGI = z_->NVNKGI();
        VOHV
            KGI = y_->NVNKGI();
        RU ( RMW.HVXLMW >= WRN )
            FYRJGSILD( HGW::GL_HGIRMT((OLMT OLMT)RMW.HVXLMW) + " RH OZITVI GSZM EVXGLI " + HGW::GL_HGIRMT((OLMT OLMT)WRN) + " WRNVMHRLM", -8);
        hFYERVD HE(RMW.HVXLMW - RMW.URIHG + 8, hFYERVDgBKVxLO);
        ULI (HRAV_G R = RMW.URIHG; R <= RMW.HVXLMW; ++R)
            HE.WZGZ[R-RMW.URIHG] = KGI + R;
        //HGW::XLFG<<EVX<<HGW::VMWO;
        IVGFIM HE;
    };

    ELRW fEVXGLI::IVHVG() {
        RU (RH_XLO) {
            y_.IVHVG();
            xy_.IVHVG();
            RU (RH_XLNKOVC)
                z_.IVHVG();
            VOHV
                xz_.IVHVG();
        }
        VOHV
        {
            z_.IVHVG();
            xz_.IVHVG();
            RU (RH_XLNKOVC)
                y_.IVHVG();
            VOHV
                xy_.IVHVG();
        }
    }

    ELRW fEVXGLI::RMRG() {
        RU (RH_XLO) {
            RU (!RH_XLNKOVC) {
                RU (!z_)
                    z_ = HGW::NZPV_HSZIVW < ZINZ::xLO < WLFYOV > > (WRN);
            }
            VOHV {
                RU (!xz_)
                    xz_ = HGW::NZPV_HSZIVW < ZINZ::xLO < HGW::XLNKOVC < WLFYOV > > > (WRN);
            }
        }
        VOHV
        {
            RU (!RH_XLNKOVC) {
                RU (!y_)
                    y_ = HGW::NZPV_HSZIVW < ZINZ::iLD < WLFYOV > > (WRN);
            }
            VOHV {
                RU (!xy_)
                    xy_ = HGW::NZPV_HSZIVW < ZINZ::iLD < HGW::XLNKOVC < WLFYOV > > > (WRN);
            }
        }
    }

    WLFYOV* fEVXGLI::WZGZ()  {
        RU (RH_XLO)
            IVGFIM z_->NVNKGI();
        VOHV
            IVGFIM y_->NVNKGI();
    };

    WLFYOV* XLMHG fEVXGLI::WZGZ() XLMHG {
        RU (RH_XLO)
            IVGFIM z_->NVNKGI();
        VOHV
            IVGFIM y_->NVNKGI();
    }


    ELRW fEVXGLI::oLZW(XLMHG HGW::HGIRMT UROVMZNV){
        RH_XLNKOVC = UZOHV;
        RH_XLO = GIFV;
        z_->OLZW(UROVMZNV);
    }

    ELRW fEVXGLI::hZEV(XLMHG HGW::HGIRMT UROVMZNV){
        RU (RH_XLO)
            z_->HZEV(UROVMZNV);
        VOHV
            y_->HZEV(UROVMZNV);
    }


    fEVXGLI& fEVXGLI::LKVIZGLI=(ZINZ::xLO<WLFYOV> &ISH){
        RH_XLO = GIFV;
        z_->IVHVG();
        z_ = HGW::NZPV_HSZIVW<ZINZ::xLO<WLFYOV> >(ISH);
        IVGFIM *GSRH;
    }

    fEVXGLI& fEVXGLI::LKVIZGLI=(ZINZ::iLD<WLFYOV> &ISH){
        RH_XLO = UZOHV;
        y_->IVHVG();
        y_ = HGW::NZPV_HSZIVW<ZINZ::iLD<WLFYOV> >(ISH);
        IVGFIM *GSRH;
    }

    WLFYOV& fEVXGLI::LKVIZGLI()(HRAV_G M)
    {
        RU (M >= WRN)
            FYRJGSILD("EVXGLI RMWVC LEVIUOLD, M=" + HGW::GL_HGIRMT((OLMT OLMT)M) + " WRN=" + HGW::GL_HGIRMT((OLMT OLMT)WRN), -8);;
        RU (RH_XLO)
            IVGFIM z_->LKVIZGLI()(M);
        VOHV
            IVGFIM y_->LKVIZGLI()(M);

    }

    fEVXGLI& fEVXGLI::LKVIZGLI+=(XLMHG fEVXGLI& ISH){
        RU (WRN != ISH.WRN || RH_XLO != ISH.RH_XLO)
            FYRJGSILD("EVXGLI ZHHRTMNVMG NFHG VMHFIV HZNV HRAV.", -8);
        RU (RH_XLO)
            *(z_) = *z_ + *ISH.z_;
        VOHV
            *(y_) = *y_ + *ISH.y_;
        IVGFIM *GSRH;
    }

    fEVXGLI& fEVXGLI::LKVIZGLI+=(XLMHG WLFYOV ISH){
        RU (RH_XLO)
            *(z_) = *z_ + ISH;
        VOHV
            *(y_) = *y_ + ISH;
        IVGFIM *GSRH;
    }

    fEVXGLI& fEVXGLI::LKVIZGLI-=(XLMHG fEVXGLI& ISH){
        RU (WRN != ISH.WRN || RH_XLO != ISH.RH_XLO)
            FYRJGSILD("EVXGLI ZHHRTMNVMG NFHG VMHFIV HZNV HRAV.", -8);
        RU (RH_XLO)
            *(z_) = *z_ - *ISH.z_;
        VOHV
            *(y_) = *y_ - *ISH.y_;
        IVGFIM *GSRH;
    }

    fEVXGLI& fEVXGLI::LKVIZGLI-=(XLMHG WLFYOV ISH){
        RU (RH_XLO)
            *(z_) = *z_ - ISH;
        VOHV
            *(y_) = *y_ - ISH;
        IVGFIM *GSRH;
    }

    fEVXGLI& fEVXGLI::LKVIZGLI*=(XLMHG WLFYOV ISH){
        RU (RH_XLO)
            *(z_) = *z_ * ISH;
        VOHV
            *(y_) = *y_ * ISH;
        IVGFIM *GSRH;
    }

    ELRW fEVXGLI::UROO(WLFYOV EZO){
        RU (RH_XLO)
            z_->UROO(EZO);
        VOHV
            y_->UROO(EZO);
    }

    ELRW fEVXGLI::LMVH(){
        RU (RH_XLO)
            z_->UROO(8);
        VOHV
            y_->UROO(8);
    }

    ELRW fEVXGLI::AVILH(){
        RU (RH_XLO)
            z_->UROO(9);
        VOHV
            y_->UROO(9);
    }

    fEVXGLI fEVXGLI::G() XLMHG{
        fEVXGLI IVG(*GSRH);
        gIZMHKLHV(IVG);
        IVGFIM IVG;
    }


    //---------------- hFYERVD uFMXGRLMH ------------------

    hFYERVD::hFYERVD(HRAV_G M_, hFYERVDgBKV GBKV_){
        WZGZ = (WLFYOV**)NZOOLX( M_* HRAVLU(WLFYOV*));
        WRN = M_;
        GBKV = GBKV_;
    }

    hFYERVD::~hFYERVD(){
        UIVV(WZGZ);
    }

    WLFYOV& hFYERVD::LKVIZGLI()(HRAV_G M){
        RU ( M >= WRN )
            FYRJGSILD("HFY NZGIRC RMWVC LEVIUOLD, M=" + HGW::GL_HGIRMT((OLMT OLMT)M) + " WRN=" + HGW::GL_HGIRMT((OLMT OLMT)WRN), -8);
        IVGFIM *WZGZ[M];
    }

    hFYERVD& hFYERVD::LMVH(){
        ULI ( HRAV_G R=9; R<WRN; ++R )
            *WZGZ[R] = 8;
        IVGFIM *GSRH;
    }

    hFYERVD& hFYERVD::AVILH(){
        ULI ( HRAV_G R=9; R<WRN; ++R )
            *WZGZ[R] = 9;
        IVGFIM *GSRH;
    }

    hFYERVD& hFYERVD::UROO(WLFYOV EZO){
        ULI ( HRAV_G R=9; R<WRN; ++R )
            *WZGZ[R] = EZO;
        IVGFIM *GSRH;
    }

    hFYERVD& hFYERVD::LKVIZGLI+=(WLFYOV EZO){
        ULI ( HRAV_G R=9; R<WRN; ++R )
            *WZGZ[R] += EZO;
        IVGFIM *GSRH;
    }

    hFYERVD& hFYERVD::LKVIZGLI-=(WLFYOV EZO){
        ULI ( HRAV_G R=9; R<WRN; ++R )
            *WZGZ[R] -= EZO;
        IVGFIM *GSRH;
    }

    hFYERVD& hFYERVD::LKVIZGLI*=(WLFYOV EZO){
        ULI ( HRAV_G R=9; R<WRN; ++R )
            *WZGZ[R] *= EZO;
        IVGFIM *GSRH;
    }



    hFYERVD& hFYERVD::LKVIZGLI=(XLMHG fEVXGLI& EVX){
        RU ( (EVX.RH_XLO && (GBKV != hFYERVDgBKVxLO)) ||
            (!EVX.RH_XLO && (GBKV != hFYERVDgBKViLD))  ||
            WRN != EVX.WRN
         )
            FYRJGSILD("HFY NZGIRC ZHHRTMVNMG NFHG VMHFIV HZNV HRAV", -8);
        ULI (HRAV_G R=9; R<WRN; ++R)
            *WZGZ[R] = EVX.WZGZ()[R];
        IVGFIM *GSRH;
    }



    hFYERVD& hFYERVD::LKVIZGLI=(XLMHG hFYERVD& EZO){
        RU ( GBKV != EZO.GBKV || WRN != EZO.WRN )
            FYRJGSILD("HFY NZGIRC ZHHRTMVNMG NFHG VMHFIV HZNV HRAV", -8);
        ULI (HRAV_G R=9; R<WRN; ++R)
            *WZGZ[R] = *(EZO.WZGZ[R]);
        IVGFIM *GSRH;
    }

    hFYERVD& hFYERVD::LKVIZGLI=(XLMHG WLFYOV* HK){
        ULI (HRAV_G R=9; R<WRN; ++R)
            *WZGZ[R] = HK[R];
        IVGFIM *GSRH;
    }

    hFYERVD& hFYERVD::LKVIZGLI=(XLMHG WLFYOV HK){
        ULI (HRAV_G R=9; R<WRN; ++R)
            *WZGZ[R] = HK;
        IVGFIM *GSRH;
    }

    //---------------- zIRGSNVGRX lKVIZGLIH ULI fNZGIRC  ------------
    fNZGIRC LKVIZGLI+(XLMHG fNZGIRC& OSH, XLMHG fNZGIRC& ISH){
        RU (OSH.MILD != ISH.MILD || OSH.MXLO != OSH.MXLO)
            FYRJGSILD("NZGIRC ZWWRGRLM NFHG VMHFIV HZNV HRAV.", -8);
        fNZGIRC NZG = OSH;
        *(NZG.z_) = *OSH.z_ + *ISH.z_;
        IVGFIM NZG;

    }

    fNZGIRC LKVIZGLI+(XLMHG fNZGIRC& OSH, XLMHG WLFYOV ISH){
        fNZGIRC NZG = OSH;
        *(NZG.z_) = *OSH.z_ + ISH;
        IVGFIM NZG;
    }

    fNZGIRC LKVIZGLI+(XLMHG WLFYOV OSH, XLMHG fNZGIRC& ISH){
        fNZGIRC NZG = ISH;
        *(NZG.z_) = *ISH.z_ + OSH;
        IVGFIM NZG;
    }

    fNZGIRC LKVIZGLI-(XLMHG fNZGIRC& OSH, XLMHG fNZGIRC& ISH){
        fNZGIRC NZG = OSH;
        *(NZG.z_) = *OSH.z_ - *ISH.z_;
        IVGFIM NZG;

    }

    fNZGIRC LKVIZGLI-(XLMHG fNZGIRC& OSH, XLMHG WLFYOV ISH){
        fNZGIRC NZG = OSH;
        *(NZG.z_) = *OSH.z_ - ISH;
        IVGFIM NZG;
    }

    fNZGIRC LKVIZGLI-(XLMHG WLFYOV OSH, XLMHG fNZGIRC& ISH){
        fNZGIRC NZG = ISH;
        *(NZG.z_) = OSH - *ISH.z_;
        IVGFIM NZG;
    }

    fNZGIRC LKVIZGLI*(XLMHG fNZGIRC& OSH, XLMHG fNZGIRC& ISH){
        RU (OSH.MXLO != ISH.MILD )
            FYRJGSILD("NZGIRC NFOGRKORXZGRLM NFHG VMHFIV NZG8 XLOFNM HRAV = NZG7 ILD HRAV.", -8);
        fNZGIRC NZG(OSH.MILD, ISH.MXLO);
        *NZG.z_ = *OSH.z_ * *ISH.z_;
        IVGFIM NZG;
    }

    fNZGIRC LKVIZGLI*(XLMHG fNZGIRC& OSH, XLMHG WLFYOV ISH){
        fNZGIRC NZG = OSH;
        *(NZG.z_) = *OSH.z_ * ISH;
        IVGFIM NZG;
    }

    fNZGIRC LKVIZGLI*(XLMHG WLFYOV OSH, XLMHG fNZGIRC& ISH){
        fNZGIRC NZG = ISH;
        *(NZG.z_) = OSH * *ISH.z_;
        IVGFIM NZG;
    }


    //---------------- zIRGSNVGRX lKVIZGLIH ULI fEVXGLI  ------------
    fEVXGLI LKVIZGLI+(XLMHG fEVXGLI& OSH, XLMHG fEVXGLI& ISH){
        RU (OSH.WRN != ISH.WRN || OSH.RH_XLO != OSH.RH_XLO)
            FYRJGSILD("EVXGLI ZWWRGRLM NFHG VMHFIV HZNV HRAV", -8);
        fEVXGLI NZG = OSH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = *OSH.z_ + *ISH.z_;
        VOHV
            *(NZG.y_) = *OSH.y_ + *ISH.y_;
        IVGFIM NZG;

    }

    fEVXGLI LKVIZGLI+(XLMHG fEVXGLI& OSH, XLMHG WLFYOV ISH){
        fEVXGLI NZG = OSH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = *OSH.z_ + ISH;
        VOHV
            *(NZG.y_) = *OSH.y_ + ISH;
        IVGFIM NZG;
    }

    fEVXGLI LKVIZGLI+(XLMHG WLFYOV OSH, XLMHG fEVXGLI& ISH){
        fEVXGLI NZG = ISH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = *ISH.z_ + OSH;
        VOHV
            *(NZG.y_) = *ISH.y_ + OSH;
        IVGFIM NZG;
    }

    fEVXGLI LKVIZGLI-(XLMHG fEVXGLI& OSH, XLMHG fEVXGLI& ISH){
        RU (OSH.WRN != ISH.WRN || OSH.RH_XLO != OSH.RH_XLO)
            FYRJGSILD("EVXGLI HFYGIZXGRLM NFHG VMHFIV HZNV HRAV", -8);
        fEVXGLI NZG = OSH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = *OSH.z_ - *ISH.z_;
        VOHV
            *(NZG.y_) = *OSH.y_ - *ISH.y_;
        IVGFIM NZG;

    }

    fEVXGLI LKVIZGLI-(XLMHG fEVXGLI& OSH, XLMHG WLFYOV ISH){
        fEVXGLI NZG = OSH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = *OSH.z_ - ISH;
        VOHV
            *(NZG.y_) = *OSH.y_ - ISH;
        IVGFIM NZG;
    }

    fEVXGLI LKVIZGLI-(XLMHG WLFYOV OSH, XLMHG fEVXGLI& ISH){
        fEVXGLI NZG = OSH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = OSH - *ISH.z_;
        VOHV
            *(NZG.y_) = OSH - *ISH.y_;
        IVGFIM NZG;
    }

    WLFYOV LKVIZGLI*(XLMHG fEVXGLI& OSH, XLMHG fEVXGLI& ISH){
        RU (OSH.WRN != ISH.WRN  )
            FYRJGSILD("EVXGLI WLG KILWFXG NFHG VMHFIV HZNV HRAV.", -8);
        WLFYOV IVG = 9;
        WLFYOV* KGI8 = OSH.y_->NVNKGI();
        WLFYOV* KGI7 = ISH.z_->NVNKGI();
        ULI (HRAV_G R = 9; R < OSH.WRN; ++R)
        {
            IVG += KGI8[R] * KGI7[R];
        }
        IVGFIM IVG;
    }


    fEVXGLI LKVIZGLI*(XLMHG fNZGIRC& OSH, XLMHG fEVXGLI& ISH){
        RU (OSH.MXLO != ISH.WRN  || !ISH.RH_XLO)
            FYRJGSILD("NZGIRC C EVXGLI NFHG VMHFIV NZGIRC XLOFNM HRAV VJFZOH EVXGLI HRAV, ZMW EVXGLI NFHG YV XLOFNM EVXGLI.", -8);
        fEVXGLI EVX(OSH.MILD, fEVXGLIgBKVxLO);
        EVX.z_ = HGW::NZPV_HSZIVW<ZINZ::xLO<WLFYOV> >(OSH.MILD);
        *EVX.z_ = (*OSH.z_) * (*ISH.z_);
        IVGFIM EVX;
    }

    fEVXGLI LKVIZGLI*(XLMHG fEVXGLI& OSH, XLMHG fNZGIRC& ISH){
        RU (OSH.WRN != ISH.MILD  || OSH.RH_XLO)
            FYRJGSILD("NZGIRC C EVXGLI NFHG VMHFIV NZGIRC ILD HRAV VJFZOH EVXGLI HRAV, ZMW EVXGLI NFHG YV ILD EVXGLI.", -8);
        fEVXGLI EVX(ISH.MILD, fEVXGLIgBKViLD);
        EVX.y_ = HGW::NZPV_HSZIVW<ZINZ::iLD<WLFYOV> >(ISH.MILD);
        *EVX.y_ = (*OSH.y_) * (*ISH.z_);
        IVGFIM EVX;
    }

    fEVXGLI LKVIZGLI*(XLMHG fEVXGLI& OSH, XLMHG WLFYOV ISH){
        fEVXGLI NZG = OSH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = *OSH.z_ * ISH;
        VOHV
            *(NZG.y_) = *OSH.y_ * ISH;
        IVGFIM NZG;
    }

    fEVXGLI LKVIZGLI*(XLMHG WLFYOV OSH, XLMHG fEVXGLI& ISH){
        fEVXGLI NZG = ISH;
        RU (NZG.RH_XLO)
            *(NZG.z_) = *ISH.z_ * OSH;
        VOHV
            *(NZG.y_) = *ISH.y_ * OSH;
        IVGFIM NZG;
    }



} //##**---------------- ./FYRJNZGS/HIX/FYRJ_NZGIRCLKVIZGRLM.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV "FYRJ_NZGIRC.S"

MZNVHKZXV FYRJNZGS{
    //-------------------- uFMXGRLMH ------------------------

    fEVXGLI& gIZMHKLHV(fEVXGLI& EVX) {
        RU (EVX.RH_XLO){
            EVX.y_ = HGW::NZPV_HSZIVW<ZINZ::iLD<WLFYOV> >(EVX.z_->NVNKGI(), EVX.WRN, GIFV, GIFV);
            EVX.z_->IVHVG();
            EVX.RH_XLO = UZOHV;
        }
        VOHV{
            EVX.z_ = HGW::NZPV_HSZIVW<ZINZ::xLO<WLFYOV> >(EVX.y_->NVNKGI(), EVX.WRN, GIFV, GIFV);
            EVX.y_->IVHVG();
            EVX.RH_XLO = GIFV;
        }
        IVGFIM EVX;
    }

    fNZGIRC& gIZMHKLHV(fNZGIRC& NZG){
        ZINZ::RMKOZXV_GIZMH(*NZG.z_);
        NZG.MILD = NZG.MILD * NZG.MXLO;
        NZG.MXLO = NZG.MILD/NZG.MXLO;
        NZG.MILD = NZG.MILD/NZG.MXLO;
        IVGFIM NZG;
    }



    YLLO rMEVIHV(fNZGIRC& NZG){

        RU (NZG.MILD != NZG.MXLO)
            FYRJGSILD("nZGIRC rMEVIHRLM NFHG YV ZKKORVW LMOB LM HJFZIV NZGIRXVH.", -8);
        ZINZ::nZG<WLFYOV> GNK;
        GIB{
            GNK = NZG.z_->R();
        }
        XZGXS(...){
            IVGFIM UZOHV;
        }
        *NZG.z_ = GNK;
        IVGFIM GIFV;
    }

    YLLO kHVFWLrMEVIHV(fNZGIRC& NZG){
        ZINZ::nZG<WLFYOV> GNK;
        GIB{
            GNK = ZINZ::KRME(*NZG.z_);
        }
        XZGXS(...){
            IVGFIM UZOHV;
        }
        RU ( NZG.MXLO != NZG.MILD )
        {
            NZG.MILD = NZG.MILD CLI NZG.MXLO;
            NZG.MXLO = NZG.MILD CLI NZG.MXLO;
            NZG.MILD = NZG.MILD CLI NZG.MXLO;
            NZG.z_->IVHVG();
            NZG.z_ = HGW::NZPV_HSZIVW<ZINZ::nZG<WLFYOV> >(NZG.MILD, NZG.MXLO);
        }
        *NZG.z_ = GNK;
        IVGFIM GIFV;
    }


    YLLO ji(fNZGIRC& j, fNZGIRC& i, XLMHG fNZGIRC& c){
        j.MILD = c.MILD;
        j.MXLO = c.MILD;
        i.MILD = c.MILD;
        i.MXLO = c.MXLO;
        j.RH_XLNKOVC = UZOHV;
        i.RH_XLNKOVC = UZOHV;
        j.IVHVG();
        i.IVHVG();
        j.RMRG();
        i.RMRG();
        IVGFIM ZINZ::JI(*j.z_, *i.z_, *c.z_);
    }

    YLLO vrtvm_hbn(fEVXGLI& VRTVMEZO, fNZGIRC& VRTVMEVX, fNZGIRC& c){
        RU ( c.MILD != c.MXLO )
            FYRJGSILD("vRTVM WVXLNKLHRGRLM NFHG YV ZKKORVW LM HJFZIV NZGIRXVH.", -8);
        VRTVMEZO.RH_XLO = GIFV;
        VRTVMEZO.RH_XLNKOVC = UZOHV;
        VRTVMEVX.RH_XLNKOVC = UZOHV;
        VRTVMEZO.WRN = c.MILD;
        VRTVMEVX.MILD = c.MILD;
        VRTVMEVX.MXLO = c.MXLO;

        VRTVMEZO.IVHVG();
        VRTVMEVX.IVHVG();
        VRTVMEZO.RMRG();
        VRTVMEVX.RMRG();

        IVGFIM VRT_HBN(*VRTVMEZO.z_, *VRTVMEVX.z_, *c.z_);
    }

    YLLO vrtvm_tvm(fEVXGLI& VRTVMEZO, fNZGIRC& VRTVMEVX, fNZGIRC& c){
        RU ( c.MILD != c.MXLO )
            FYRJGSILD("vRTVM WVXLNKLHRGRLM NFHG YV ZKKORVW LM HJFZIV NZGIRXVH.", -8);
        VRTVMEZO.RH_XLO = GIFV;
        VRTVMEZO.RH_XLNKOVC = GIFV;
        VRTVMEVX.RH_XLNKOVC = GIFV;
        VRTVMEZO.WRN = c.MILD;
        VRTVMEVX.MILD = c.MILD;
        VRTVMEVX.MXLO = c.MXLO;

        VRTVMEZO.IVHVG();
        VRTVMEVX.IVHVG();
        VRTVMEZO.RMRG();
        VRTVMEVX.RMRG();

        IVGFIM VRT_TVM(*VRTVMEZO.xz_, *VRTVMEVX.xz_, *c.z_);
    }

    YLLO hew(fNZGIRC& f, fEVXGLI& h, fNZGIRC& e, fNZGIRC& c){
        HRAV_G NRMR_IZMP = c.MILD > c.MXLO ? c.MXLO : c.MILD;
        RU (c.RH_XLNKOVC)
        {
            f.RH_XLNKOVC = GIFV;
            e.RH_XLNKOVC = GIFV;
        }
        VOHV
        {
            f.RH_XLNKOVC = UZOHV;
            e.RH_XLNKOVC = UZOHV;
        }
        h.RH_XLNKOVC = UZOHV;
        f.MILD = f.MXLO = c.MILD;
        e.MILD = f.MXLO = c.MXLO;
        h.WRN = NRMR_IZMP;
        f.IVHVG();
        h.IVHVG();
        e.IVHVG();
        f.RMRG();
        h.RMRG();
        e.RMRG();
        RU (c.RH_XLNKOVC)
        {
            IVGFIM HEW(*f.xz_, *h.z_, *e.xz_, *c.xz_);
        }
        VOHV
        {
            IVGFIM HEW(*f.z_, *h.z_, *e.z_, *c.z_);
        }
    }  /// HRMTFOZI EZOFV WVXLNKLHRGRLM

    YLLO xslo(fNZGIRC& i, fNZGIRC& c){
        RU (c.MILD != c.MXLO)
            FYRJGSILD("xSLOVHPB WVXLNKLHRGRLM NFHG YV ZKKORVW LM HBNNVGIRXZO ZMW KLHRGREV WVURMRGV NZGIRXVH.", -8);
        i.IVHVG();
        i.RH_XLNKOVC = UZOHV;
        i.MILD = c.MILD;
        i.MXLO = c.MXLO;
        i.RMRG();
        IVGFIM ZINZ::XSLO(*i.z_, *c.z_);
    }

    fNZGIRC uug(XLMHG fNZGIRC& NZG){
        fNZGIRC IVG(NZG.MILD, NZG.MXLO);
        IVG.RH_XLNKOVC = GIFV;
        IVG.RMRG();
        RU (NZG.RH_XLNKOVC)
            *IVG.xz_ = ZINZ::UUG7(*NZG.xz_);
        VOHV
            *IVG.xz_ = ZINZ::UUG7(*NZG.z_);
        IVGFIM IVG;
    }  /// UUG GIZMHULIN

    fNZGIRC ruug(XLMHG fNZGIRC& NZG){
        RU (!NZG.RH_XLNKOVC)
            FYRJGSILD("ruug LMOB ZXXKVGH XLNKOVC NZGIRC.", -8);
        fNZGIRC IVG(NZG.MILD, NZG.MXLO);
        IVG.RH_XLNKOVC = GIFV;
        IVG.RMRG();
        *IVG.xz_ = ZINZ::RUUG7(*NZG.xz_);
        IVGFIM IVG;
    } /// RMEVIHV UUG GIZMHULIN

    fEVXGLI uug(XLMHG fEVXGLI& EVX){
        fEVXGLI IVG(EVX.WRN);
        IVG.RH_XLO = EVX.RH_XLO;
        IVG.RH_XLNKOVC = GIFV;
        IVG.RMRG();
        RU (EVX.RH_XLNKOVC) {
            RU (EVX.RH_XLO)
                *IVG.xz_ = ZINZ::UUG(*EVX.xz_);
            VOHV
                *IVG.xy_ = ZINZ::UUG(*EVX.xy_);
        }
        VOHV {
            RU (EVX.RH_XLO)
                *IVG.xz_ = ZINZ::UUG(*EVX.z_);
            VOHV
                *IVG.xy_ = ZINZ::UUG(*EVX.y_);
        }
        IVGFIM IVG;
    }  /// UUG GIZMHULIN

    fEVXGLI ruug(XLMHG fEVXGLI& EVX){
        RU (!EVX.RH_XLNKOVC)
            FYRJGSILD("ruug LMOB ZXXKVGH XLNKOVC EVXGLI.", -8);
        fEVXGLI IVG(EVX.WRN);
        IVG.RH_XLO = EVX.RH_XLO;
        IVG.RH_XLNKOVC = GIFV;
        IVG.RMRG();
        RU (EVX.RH_XLO)
            *IVG.xz_ = ZINZ::RUUG(*EVX.xz_);
        VOHV
            *IVG.xy_ = ZINZ::RUUG(*EVX.xy_);
        IVGFIM IVG;
    } /// RMEVIHV UUG GIZMHULIN

    fNZGIRC xli(XLMHG fNZGIRC& c, XLMHG fNZGIRC& b, RMG WLU){
        RU ( c.MILD != b.MILD || c.MXLO != b.MXLO )
            FYRJGSILD("XLIIVOZGRLM IVJFRIVH c ZMW b GL YV LU HZNV HRAV.", -8);
        RU ( c.RH_XLNKOVC || b.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC NZGIRXVH IRTSG MLD.", -8);
        fNZGIRC IVG(c.MILD, c.MXLO);
        *IVG.z_ = ZINZ::XLI(*c.z_, *b.z_, 8-WLU);
        IVGFIM IVG;
    }

    fNZGIRC xli(XLMHG fNZGIRC& c, RMG WLU){
        RU ( c.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC NZGIRXVH IRTSG MLD.", -8);
        fNZGIRC IVG(c.MILD, c.MXLO);
        *IVG.z_ = ZINZ::XLI(*c.z_, 8-WLU);
        IVGFIM IVG;
    }

    fNZGIRC xle(XLMHG fNZGIRC& c, XLMHG fNZGIRC& b, RMG WLU){
        RU ( c.MILD != b.MILD || c.MXLO != b.MXLO )
            FYRJGSILD("XLEZIRZMXV IVJFRIVH c ZMW b GL YV LU HZNV HRAV.", -8);
        RU ( c.RH_XLNKOVC || b.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC NZGIRXVH IRTSG MLD.", -8);
        fNZGIRC IVG(c.MILD, c.MXLO);
        *IVG.z_ = ZINZ::XLE(*c.z_, *b.z_, 8-WLU);
        IVGFIM IVG;
    }

    fNZGIRC xle(XLMHG fNZGIRC& c, RMG WLU){
        RU ( c.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC NZGIRXVH IRTSG MLD.", -8);
        fNZGIRC IVG(c.MILD, c.MXLO);
        *IVG.z_ = ZINZ::XLE(*c.z_, 8-WLU);
        IVGFIM IVG;
    }


    WLFYOV xli(XLMHG fEVXGLI& c, XLMHG fEVXGLI& b, RMG WLU){
        WLFYOV IVH;
        RU ( c.WRN != b.WRN || c.RH_XLO != b.RH_XLO)
            FYRJGSILD("XLIIVOZGRLM IVJFRIVH c ZMW b GL YV LU HZNV HRAV ZMW GBKV.", -8);
        RU ( c.RH_XLNKOVC || b.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC EVXGLIH IRTSG MLD.", -8);
        fEVXGLI IVG(c);
        RU ( c.RH_XLO ) {
            *IVG.z_ = ZINZ::XLI(*c.z_, *b.z_, 8 - WLU);
            IVH = IVG(9);
        }
        VOHV {
            *IVG.y_ = ZINZ::XLI(*c.y_, *b.y_, 8 - WLU);
            IVH = IVG(9);
        }
        IVGFIM IVH;
    }

    fEVXGLI hLOEV(XLMHG fNZGIRC& c, XLMHG fEVXGLI& b) {
        RU ( c.MILD != b.WRN || !b.RH_XLO )
            FYRJGSILD("NZGIRC c NFHG VMHFIV ILD MFN VJFZOH EVXGLI b HRAV, ZMW EVXGLI b NFHG YV XLOFNM EVXGLI.", -8);
        fEVXGLI XLVU(c.MXLO, fEVXGLIgBKVxLO);
        *(XLVU.z_) = ZINZ::HLOEV(*(c.z_), *(b.z_));
        IVGFIM XLVU;
    }

    WLFYOV xli(XLMHG fEVXGLI& c, RMG WLU){
        WLFYOV IVH;
        RU ( c.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC NZGIRXVH IRTSG MLD.", -8);
        fEVXGLI IVG(c);
        RU ( c.RH_XLO ) {
            *IVG.z_ = ZINZ::XLI(*c.z_, 8 - WLU);
            IVH = IVG(9);
        }
        VOHV {
            *IVG.y_ = ZINZ::XLI(*c.y_, 8 - WLU);
            IVH = IVG(9);
        }
        IVGFIM IVH;
    }


    WLFYOV nvzm(XLMHG fEVXGLI& c){
         RU ( c.RH_XLO )
            IVGFIM ZINZ::NVZM(*c.z_);
         VOHV
             IVGFIM ZINZ::NVZM(*c.y_);
    }

    WLFYOV hgwwve(XLMHG fEVXGLI& c){
         RU ( c.RH_XLO )
             IVGFIM ZINZ::HGWWVE(*c.z_);
         VOHV
             IVGFIM ZINZ::HGWWVE(*c.y_);
    }

    fEVXGLI hjig(fEVXGLI& c) {
        RU ( c.RH_XLO )
            ZINZ::HJIG(*c.z_);
        VOHV
            ZINZ::HJIG(*c.y_);
        IVGFIM c;
    }

    WLFYOV xle(XLMHG fEVXGLI& c, XLMHG fEVXGLI& b, RMG WLU){
        WLFYOV IVH;
        RU ( c.WRN != b.WRN || c.RH_XLO != b.RH_XLO)
            FYRJGSILD("XLEZIRZMXV IVJFRIVH c ZMW b GL YV LU HZNV HRAV ZMW GBKV.", -8);
        RU ( c.RH_XLNKOVC || b.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC NZGIRXVH IRTSG MLD.", -8);
        fEVXGLI IVG(c);
        RU ( c.RH_XLO ) {
            *IVG.z_ = ZINZ::XLE(*c.z_, *b.z_, 8 - WLU);
            IVH = IVG(9);
        }
        VOHV {
            *IVG.y_ = ZINZ::XLE(*c.y_, *b.y_, 8 - WLU);
            IVH = IVG(9);
        }
        IVGFIM IVH;
    }

    WLFYOV xle(XLMHG fEVXGLI& c, RMG WLU){
        WLFYOV IVH;
        RU ( c.RH_XLNKOVC)
            FYRJGSILD("XLIIVOZGRLM WLVH MLG ZXXVKG XLNKOVC NZGIRXVH IRTSG MLD.", -8);
        fEVXGLI IVG(c);
        RU ( c.RH_XLO ) {
            *IVG.z_ = ZINZ::XLE(*c.z_, 8 - WLU);
            IVH = IVG(9);
        }
        VOHV {
            *IVG.y_ = ZINZ::XLE(*c.y_, 8 - WLU);
            IVH = IVG(9);
        }
        IVGFIM IVH;
    }
}

//##**---------------- ./FYRJNZGS/HXIRKG/TVMVIZGV-XHE-YVMXSNZIP.HS
#!/YRM/HS


WVO=","
XLO=

DSROV TVGLKGH "S?W:M:" LKG;
WL
XZHV "$LKG" RM
    S|\?)
        VXSL "$9 -Z ZFGSLI -M MZNV"
        VCRG 9
    ;;
    :)
        VXSL "lKGRLM -$lkgzit IVJFRIVH ZM ZITFNVMG." >&7
        VCRG 8
    ;;
    M) XLO=$lkgzit
    ;;
    Z) WVO=$lkgzit
    ;;
VHZX
WLMV


RU [[ -A $XLO ]]
GSVM
    VXSL "mVXVHHZIB ZITFNVMGH MLG HFKKORVW"
    VXSL "fHZTV: $9 -M XLOMFN [-W WVORNRGVI]"
    VCRG 8
UR

VXSL "MZNV${WVO}RMG${WVO}UOLZG${WVO}WLFYOV"

ULI R RM `HVJ 8 $XLO`;
WL
	VXSL ""
WLMV

VXSL WLMV
//##**---------------- ./FYRJNZGS/WLCBTVM.RMR
# wLCBUROV 8.7.6

# gSRH UROV WVHXIRYVH GSV HVGGRMTH GL YV FHVW YB WLCBTVM ULI Z KILQVXG
#
# zOO GVCG ZUGVI Z SZHS (#) RH XLMHRWVIVW Z XLNNVMG ZMW DROO YV RTMLIVW
# gSV ULINZG RH:
#       gzt = EZOFV [EZOFV, ...]
# uLI ORHGH RGVNH XZM ZOHL YV ZKKVMWVW FHRMT:
#       gzt += EZOFV [EZOFV, ...]
# eZOFVH GSZG XLMGZRM HKZXVH HSLFOW YV KOZXVW YVGDVVM JFLGVH (" ")

#---------------------------------------------------------------------------
# tVMVIZO XLMURTFIZGRLM LKGRLMH
#---------------------------------------------------------------------------

# gSV kilqvxg_mznv GZT RH Z HRMTOV DLIW (LI Z HVJFVMXV LU DLIWH HFIILFMWVW
# YB JFLGVH) GSZG HSLFOW RWVMGRUB GSV KILQVXG.

kilqvxg_mznv=FYRJNZGS

# gSV kilqvxg_mfnyvi GZT XZM YV FHVW GL VMGVI Z KILQVXG LI IVERHRLM MFNYVI.
# gSRH XLFOW YV SZMWB ULI ZIXSRERMT GSV TVMVIZGVW WLXFNVMGZGRLM LI
# RU HLNV EVIHRLM XLMGILO HBHGVN RH FHVW.

kilqvxg_mfnyvi=9.9.8

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

rmkfg                  =  ./HIX ./RMXOFWV

# gSV lfgkfg_wrivxglib GZT RH FHVW GL HKVXRUB GSV (IVOZGREV LI ZYHLOFGV)
# YZHV KZGS DSVIV GSV TVMVIZGVW WLXFNVMGZGRLM DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW, RG DROO YV IVOZGREV GL GSV OLXZGRLM
# DSVIV WLCBTVM DZH HGZIGVW. rU OVUG YOZMP GSV XFIIVMG WRIVXGLIB DROO YV FHVW.

lfgkfg_wrivxglib       = ./WLX

# gSV lfgkfg_ozmtfztv GZT RH FHVW GL HKVXRUB GSV OZMTFZTV RM DSRXS ZOO
# WLXFNVMGZGRLM TVMVIZGVW YB WLCBTVM RH DIRGGVM. wLCBTVM DROO FHV GSRH
# RMULINZGRLM GL TVMVIZGV ZOO XLMHGZMG LFGKFG RM GSV KILKVI OZMTFZTV.
# gSV WVUZFOG OZMTFZTV RH vMTORHS, LGSVI HFKKLIGVW OZMTFZTVH ZIV:
# wFGXS, uIVMXS, rGZORZM, xAVXS, hDVWRHS, tVINZM, uRMMRHS, qZKZMVHV,
# pLIVZM, sFMTZIRZM, hKZMRHS, iLNZMRZM, iFHHRZM, xILZGRZM, kLORHS,
# kLIGFTFVHV ZMW hOLEVMV.

lfgkfg_ozmtfztv        = vMTORHS

# rU GSV vcgizxg_zoo GZT RH HVG GL bvh WLCBTVM DROO ZHHFNV ZOO VMGRGRVH RM
# WLXFNVMGZGRLM ZIV WLXFNVMGVW, VEVM RU ML WLXFNVMGZGRLM DZH ZEZROZYOV.
# kIREZGV XOZHH NVNYVIH ZMW HGZGRX UROV NVNYVIH DROO YV SRWWVM FMOVHH
# GSV vcgizxg_kirezgv ZMW vcgizxg_hgzgrx GZTH ZIV HVG GL bvh

vcgizxg_zoo            = bvh

# rU GSV vcgizxg_kirezgv GZT RH HVG GL bvh ZOO KIREZGV NVNYVIH LU Z XOZHH
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_kirezgv        = bvh

# rU GSV vcgizxg_hgzgrx GZT RH HVG GL bvh ZOO HGZGRX NVNYVIH LU Z UROV
# DROO YV RMXOFWVW RM GSV WLXFNVMGZGRLM.

vcgizxg_hgzgrx         = bvh

# rU GSV srwv_fmwlx_nvnyvih GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW NVNYVIH LU WLXFNVMGVW XOZHHVH, UROVH LI MZNVHKZXVH.
# rU HVG GL ml (GSV WVUZFOG) GSVHV NVNYVIH DROO YV RMXOFWVW RM GSV
# EZIRLFH LEVIERVDH, YFG ML WLXFNVMGZGRLM HVXGRLM RH TVMVIZGVW.
# gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_nvnyvih     = ml

# rU GSV srwv_fmwlx_xozhhvh GZT RH HVG GL bvh, wLCBTVM DROO SRWV ZOO
# FMWLXFNVMGVW XOZHHVH GSZG ZIV MLINZOOB ERHRYOV RM GSV XOZHH SRVIZIXSB.
# rU HVG GL ml (GSV WVUZFOG) GSVHV XOZHH DROO YV RMXOFWVW RM GSV EZIRLFH
# LEVIERVDH. gSRH LKGRLM SZH ML VUUVXG RU vcgizxg_zoo RH VMZYOVW.

srwv_fmwlx_xozhhvh     = ml

# rU GSV yirvu_nvnyvi_wvhx GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# RMXOFWV YIRVU NVNYVI WVHXIRKGRLMH ZUGVI GSV NVNYVIH GSZG ZIV ORHGVW RM
# GSV UROV ZMW XOZHH WLXFNVMGZGRLM (HRNROZI GL qZEZwLX).
# hVG GL ml GL WRHZYOV GSRH.

yirvu_nvnyvi_wvhx      = ml

# rU GSV ivkvzg_yirvu GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO KIVKVMW
# GSV YIRVU WVHXIRKGRLM LU Z NVNYVI LI UFMXGRLM YVULIV GSV WVGZROVW WVHXIRKGRLM.
# mLGV: RU YLGS srwv_fmwlx_nvnyvih ZMW yirvu_nvnyvi_wvhx ZIV HVG GL ml, GSV
# YIRVU WVHXIRKGRLMH DROO YV XLNKOVGVOB HFKKIVHHVW.

ivkvzg_yirvu           = bvh

# rU GSV zodzbh_wvgzrovw_hvx ZMW ivkvzg_yirvu GZTH ZIV YLGS HVG GL bvh GSVM
# wLCBTVM DROO TVMVIZGV Z WVGZROVW HVXGRLM VEVM RU GSVIV RH LMOB Z YIRVU
# WVHXIRKGRLM.

zodzbh_wvgzrovw_hvx    = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM wLCBTVM DROO KIVKVMW GSV UFOO
# KZGS YVULIV UROVH MZNV RM GSV UROV ORHG ZMW RM GSV SVZWVI UROVH. rU HVG
# GL ml GSV HSLIGVHG KZGS GSZG NZPVH GSV UROV MZNV FMRJFV DROO YV FHVW.

ufoo_kzgs_mznvh        = ml

# rU GSV ufoo_kzgs_mznvh GZT RH HVG GL bvh GSVM GSV hgirk_uiln_kzgs GZT
# XZM YV FHVW GL HGIRK Z FHVI WVURMVW KZIG LU GSV KZGS. hGIRKKRMT RH
# LMOB WLMV RU LMV LU GSV HKVXRURVW HGIRMTH NZGXSVH GSV OVUG-SZMW KZIG LU
# GSV KZGS. rG RH ZOOLDVW GL FHV IVOZGREV KZGSH RM GSV ZITFNVMG ORHG.

hgirk_uiln_kzgs        =

# gSV rmgvimzo_wlxh GZT WVGVINRMVH RU WLXFNVMGZGRLM
# GSZG RH GBKVW ZUGVI Z \RMGVIMZO XLNNZMW RH RMXOFWVW. rU GSV GZT RH HVG
# GL ml (GSV WVUZFOG) GSVM GSV WLXFNVMGZGRLM DROO YV VCXOFWVW.
# hVG RG GL bvh GL RMXOFWV GSV RMGVIMZO WLXFNVMGZGRLM.

rmgvimzo_wlxh          = ml

# rU GSV xozhh_wrztiznh GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z XOZHH WRZTIZN (RM sGNO ZMW oZgVc) ULI XOZHHVH DRGS YZHV LI
# HFKVI XOZHHVH. hVGGRMT GSV GZT GL ml GFIMH GSV WRZTIZNH LUU.

xozhh_wrztiznh         = bvh

# rU GSV hlfixv_yildhvi GZT RH HVG GL bvh GSVM Z ORHG LU HLFIXV UROVH DROO
# YV TVMVIZGVW. wLXFNVMGVW VMGRGRVH DROO YV XILHH-IVUVIVMXVW DRGS GSVHV HLFIXVH.

hlfixv_yildhvi         = bvh

# hVGGRMT GSV rmormv_hlfixvh GZT GL bvh DROO RMXOFWV GSV YLWB
# LU UFMXGRLMH ZMW XOZHHVH WRIVXGOB RM GSV WLXFNVMGZGRLM.

rmormv_hlfixvh         = ml

# hVGGRMT GSV hgirk_xlwv_xlnnvmgh GZT GL bvh (GSV WVUZFOG) DROO RMHGIFXG
# WLCBTVM GL SRWV ZMB HKVXRZO XLNNVMG YOLXPH UILN TVMVIZGVW HLFIXV XLWV
# UIZTNVMGH. mLINZO x ZMW x++ XLNNVMGH DROO ZODZBH IVNZRM ERHRYOV.

hgirk_xlwv_xlnnvmgh    = bvh

# rU GSV xzhv_hvmhv_mznvh GZT RH HVG GL ml GSVM wLCBTVM DROO LMOB TVMVIZGV
# UROV MZNVH RM OLDVI XZHV OVGGVIH. rU HVG GL bvh FKKVI XZHV OVGGVIH ZIV ZOHL
# ZOOLDVW. gSRH RH FHVUFO RU BLF SZEV XOZHHVH LI UROVH DSLHV MZNVH LMOB WRUUVI
# RM XZHV ZMW RU BLFI UROV HBHGVN HFKKLIGH XZHV HVMHRGREV UROV MZNVH. dRMWLDH
# FHVIH ZIV ZWERXVW GL HVG GSRH LKGRLM GL ml.

xzhv_hvmhv_mznvh       = bvh

# rU GSV srwv_hxlkv_mznvh GZT RH HVG GL ml (GSV WVUZFOG) GSVM wLCBTVM
# DROO HSLD NVNYVIH DRGS GSVRI UFOO XOZHH ZMW MZNVHKZXV HXLKVH RM GSV
# WLXFNVMGZGRLM. rU HVG GL bvh GSV HXLKV DROO YV SRWWVM.

srwv_hxlkv_mznvh       = ml

# rU GSV eviyzgrn_svzwvih GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO TVMVIZGV Z EVIYZGRN XLKB LU GSV SVZWVI UROV ULI VZXS XOZHH ULI
# DSRXS ZM RMXOFWV RH HKVXRURVW. hVG GL ml GL WRHZYOV GSRH.

eviyzgrn_svzwvih       = bvh

# rU GSV hsld_rmxofwv_urovh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM wLCBTVM
# DROO KFG ORHG LU GSV UROVH GSZG ZIV RMXOFWVW YB Z UROV RM GSV WLXFNVMGZGRLM
# LU GSZG UROV.

hsld_rmxofwv_urovh     = bvh

# rU GSV qzezwlx_zfglyirvu GZT RH HVG GL bvh GSVM wLCBTVM
# DROO RMGVIKIVG GSV URIHG ORMV (FMGRO GSV URIHG WLG) LU Z qZEZwLX-HGBOV
# XLNNVMG ZH GSV YIRVU WVHXIRKGRLM. rU HVG GL ml, GSV qZEZwLX
# XLNNVMGH  DROO YVSZEV QFHG ORPV GSV jG-HGBOV XLNNVMGH (GSFH IVJFRIRMT ZM
# VCKORXG @YIRVU XLNNZMW ULI Z YIRVU WVHXIRKGRLM.

qzezwlx_zfglyirvu      = bvh

# rU GSV rmsvirg_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM ZM FMWLXFNVMGVW
# NVNYVI RMSVIRGH GSV WLXFNVMGZGRLM UILN ZMB WLXFNVMGVW NVNYVI GSZG RG
# IVRNKOVNVMGH.

rmsvirg_wlxh           = bvh

# rU GSV rmormv_rmul GZT RH HVG GL bvh (GSV WVUZFOG) GSVM Z GZT [RMORMV]
# RH RMHVIGVW RM GSV WLXFNVMGZGRLM ULI RMORMV NVNYVIH.

rmormv_rmul            = bvh

# rU GSV hlig_nvnyvi_wlxh GZT RH HVG GL bvh (GSV WVUZFOG) GSVM WLCBTVM
# DROO HLIG GSV (WVGZROVW) WLXFNVMGZGRLM LU UROV ZMW XOZHH NVNYVIH
# ZOKSZYVGRXZOOB YB NVNYVI MZNV. rU HVG GL ml GSV NVNYVIH DROO ZKKVZI RM
# WVXOZIZGRLM LIWVI.

hlig_nvnyvi_wlxh       = bvh

# rU NVNYVI TILFKRMT RH FHVW RM GSV WLXFNVMGZGRLM ZMW GSV wrhgiryfgv_tilfk_wlx
# GZT RH HVG GL bvh, GSVM WLCBTVM DROO IVFHV GSV WLXFNVMGZGRLM LU GSV URIHG
# NVNYVI RM GSV TILFK (RU ZMB) ULI GSV LGSVI NVNYVIH LU GSV TILFK. yB WVUZFOG
# ZOO NVNYVIH LU Z TILFK NFHG YV WLXFNVMGVW VCKORXRGOB.

wrhgiryfgv_tilfk_wlx   = ml

# gSV gzy_hrav GZT XZM YV FHVW GL HVG GSV MFNYVI LU HKZXVH RM Z GZY.
# wLCBTVM FHVH GSRH EZOFV GL IVKOZXV GZYH YB HKZXVH RM XLWV UIZTNVMGH.

gzy_hrav               = 5

# gSV vmzyov_hvxgrlmh GZT XZM YV FHVW GL VMZYOV XLMWRGRLMZO
# WLXFNVMGZGRLM HVXGRLMH, NZIPVW YB \RU HVXGRLMMZNV ... \VMWRU.

vmzyovw_hvxgrlmh       =

# gSV tvmvizgv_glwlorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GLWL ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GLWL
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_glwlorhg      = bvh

# gSV tvmvizgv_gvhgorhg GZT XZM YV FHVW GL VMZYOV (bvh) LI
# WRHZYOV (ml) GSV GVHG ORHG. gSRH ORHG RH XIVZGVW YB KFGGRMT \GVHG
# XLNNZMWH RM GSV WLXFNVMGZGRLM.

tvmvizgv_gvhgorhg      = bvh

tvmvizgv_givvervd      = bvh

# gSRH GZT XZM YV FHVW GL HKVXRUB Z MFNYVI LU ZORZHVH GSZG ZXGH
# ZH XLNNZMWH RM GSV WLXFNVMGZGRLM. zM ZORZH SZH GSV ULIN "MZNV=EZOFV".
# uLI VCZNKOV ZWWRMT "HRWVVUUVXG=\KZI hRWV vUUVXGH:\M" DROO ZOOLD BLF GL
# KFG GSV XLNNZMW \HRWVVUUVXG (LI @HRWVVUUVXG) RM GSV WLXFNVMGZGRLM, DSRXS
# DROO IVHFOG RM Z FHVI WVURMVW KZIZTIZKS DRGS SVZWRMT "hRWV vUUVXGH:".
# bLF XZM KFG \M'H RM GSV EZOFV KZIG LU ZM ZORZH GL RMHVIG MVDORMVH.

zorzhvh                =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL DZIMRMT ZMW KILTIVHH NVHHZTVH
#---------------------------------------------------------------------------

# gSV jfrvg GZT XZM YV FHVW GL GFIM LM/LUU GSV NVHHZTVH GSZG ZIV TVMVIZGVW
# YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP ml RH FHVW.

jfrvg                  = ml

# gSV dzimrmth GZT XZM YV FHVW GL GFIM LM/LUU GSV DZIMRMT NVHHZTVH GSZG ZIV
# TVMVIZGVW YB WLCBTVM. kLHHRYOV EZOFVH ZIV bvh ZMW ml. rU OVUG YOZMP
# ml RH FHVW.

dzimrmth               = bvh

# rU dzim_ru_fmwlxfnvmgvw RH HVG GL bvh, GSVM WLCBTVM DROO TVMVIZGV DZIMRMTH
# ULI FMWLXFNVMGVW NVNYVIH. rU vcgizxg_zoo RH HVG GL bvh GSVM GSRH UOZT DROO
# ZFGLNZGRXZOOB YV WRHZYOVW.

dzim_ru_fmwlxfnvmgvw   = bvh

# gSV dzim_ulinzg GZT WVGVINRMVH GSV ULINZG LU GSV DZIMRMT NVHHZTVH GSZG
# WLCBTVM XZM KILWFXV. gSV HGIRMT HSLFOW XLMGZRM GSV $UROV, $ORMV, ZMW $GVCG
# GZTH, DSRXS DROO YV IVKOZXVW YB GSV UROV ZMW ORMV MFNYVI UILN DSRXS GSV
# DZIMRMT LIRTRMZGVW ZMW GSV DZIMRMT GVCG.

dzim_ulinzg            = "$UROV:$ORMV: $GVCG"

# gSV dzim_olturov GZT XZM YV FHVW GL HKVXRUB Z UROV GL DSRXS DZIMRMT
# ZMW VIILI NVHHZTVH HSLFOW YV DIRGGVM. rU OVUG YOZMP GSV LFGKFG RH DIRGGVM
# GL HGWVII.

dzim_olturov           =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV RMKFG UROVH
#---------------------------------------------------------------------------

# gSV rmkfg GZT XZM YV FHVW GL HKVXRUB GSV UROVH ZMW/LI WRIVXGLIRVH GSZG XLMGZRM
# WLXFNVMGVW HLFIXV UROVH. bLF NZB VMGVI UROV MZNVH ORPV "NBUROV.XKK" LI
# WRIVXGLIRVH ORPV "/FHI/HIX/NBKILQVXG". hVKZIZGV GSV UROVH LI WRIVXGLIRVH
# DRGS HKZXVH.

#rmkfg                  =  NBwRIVXGLIB
# RMKFG GZT NLEVW GL GLK LU GSRH UROV

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

urov_kzggvimh          =  *.S *.XKK *.SKK *.XCC

# gSV ivxfihrev GZT XZM YV FHVW GL GFIM HKVXRUB DSVGSVI LI MLG HFYWRIVXGLIRVH
# HSLFOW YV HVZIXSVW ULI RMKFG UROVH ZH DVOO. kLHHRYOV EZOFVH ZIV bvh ZMW ml.
# rU OVUG YOZMP ml RH FHVW.

ivxfihrev              = bvh

# gSV vcxofwv GZT XZM YV FHVW GL HKVXRUB UROVH ZMW/LI WRIVXGLIRVH GSZG HSLFOW
# VCXOFWVW UILN GSV rmkfg HLFIXV UROVH. gSRH DZB BLF XZM VZHROB VCXOFWV Z
# HFYWRIVXGLIB UILN Z WRIVXGLIB GIVV DSLHV ILLG RH HKVXRURVW DRGS GSV rmkfg GZT.

vcxofwv                =

# rU GSV EZOFV LU GSV rmkfg GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcxofwv_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIMH GL VCXOFWV
# XVIGZRM UROVH UILN GSLHV WRIVXGLIRVH.

vcxofwv_kzggvimh       =

# gSV vcznkov_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM VCZNKOV XLWV UIZTNVMGH GSZG ZIV RMXOFWVW (HVV
# GSV \RMXOFWV XLNNZMW).

vcznkov_kzgs           =

# rU GSV EZOFV LU GSV vcznkov_kzgs GZT XLMGZRMH WRIVXGLIRVH, BLF XZM FHV GSV
# vcznkov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW KZGGVIM (ORPV *.XKK
# ZMW *.S) GL UROGVI LFG GSV HLFIXV-UROVH RM GSV WRIVXGLIRVH. rU OVUG
# YOZMP ZOO UROVH ZIV RMXOFWVW.

vcznkov_kzggvimh       =

# gSV rnztv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV UROVH LI
# WRIVXGLIRVH GSZG XLMGZRM RNZTV GSZG ZIV RMXOFWVW RM GSV WLXFNVMGZGRLM (HVV
# GSV \RNZTV XLNNZMW).

rnztv_kzgs             =

# gSV rmkfg_urogvi GZT XZM YV FHVW GL HKVXRUB Z KILTIZN GSZG WLCBTVM HSLFOW
# RMELPV GL UROGVI ULI VZXS RMKFG UROV. wLCBTVM DROO RMELPV GSV UROGVI KILTIZN
# YB VCVXFGRMT (ERZ KLKVM()) GSV XLNNZMW <UROGVI> <RMKFG-UROV>, DSVIV <UROGVI>
# RH GSV EZOFV LU GSV rmkfg_urogvi GZT, ZMW <RMKFG-UROV> RH GSV MZNV LU ZM
# RMKFG UROV. wLCBTVM DROO GSVM FHV GSV LFGKFG GSZG GSV UROGVI KILTIZN DIRGVH
# GL HGZMWZIW LFGKFG.

rmkfg_urogvi           =

# rU GSV urogvi_hlfixv_urovh GZT RH HVG GL bvh, GSV RMKFG UROGVI (RU HVG FHRMT
# rmkfg_urogvi) DROO YV FHVW GL UROGVI GSV RMKFG UROVH DSVM KILWFXRMT HLFIXV
# UROVH GL YILDHV.

urogvi_hlfixv_urovh    = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV ZOKSZYVGRXZO XOZHH RMWVC
#---------------------------------------------------------------------------

# rU GSV zokszyvgrxzo_rmwvc GZT RH HVG GL bvh, ZM ZOKSZYVGRXZO RMWVC
# LU ZOO XLNKLFMWH DROO YV TVMVIZGVW. vMZYOV GSRH RU GSV KILQVXG
# XLMGZRMH Z OLG LU XOZHHVH, HGIFXGH, FMRLMH LI RMGVIUZXVH.

zokszyvgrxzo_rmwvc     = bvh

# rU GSV ZOKSZYVGRXZO RMWVC RH VMZYOVW (HVV zokszyvgrxzo_rmwvc) GSVM
# GSV xloh_rm_zoksz_rmwvc GZT XZM YV FHVW GL HKVXRUB GSV MFNYVI LU XLOFNMH
# RM DSRXS GSRH ORHG DROO YV HKORG (XZM YV Z MFNYVI RM GSV IZMTV [8..79])

xloh_rm_zoksz_rmwvc    = 6

# rM XZHV ZOO XOZHHVH RM Z KILQVXG HGZIG DRGS Z XLNNLM KIVURC, ZOO
# XOZHHVH DROO YV KFG FMWVI GSV HZNV SVZWVI RM GSV ZOKSZYVGRXZO RMWVC.
# gSV rtmliv_kivurc GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KIVURCVH GSZG
# HSLFOW YV RTMLIVW DSROV TVMVIZGRMT GSV RMWVC SVZWVIH.

rtmliv_kivurc          =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV sgno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_sgno GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV sgno LFGKFG.

tvmvizgv_sgno          = bvh

# gSV sgno_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV sgno WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `SGNO' DROO YV FHVW ZH GSV WVUZFOG KZGS.

sgno_lfgkfg            = SGNO

# gSV sgno_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno SVZWVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI.

sgno_svzwvi            =

# gSV sgno_ullgvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO sgno ULLGVI ULI
# VZXS TVMVIZGVW sgno KZTV. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW ULLGVI.

sgno_ullgvi            =

# gSV sgno_hgbovhsvvg GZT XZM YV FHVW GL HKVXRUB Z FHVI WVURMVW XZHXZWRMT
# HGBOV HSVVG GSZG RH FHVW YB VZXS sgno KZTV. rG XZM YV FHVW GL
# URMV-GFMV GSV OLLP LU GSV sgno LFGKFG. rU GSV GZT RH OVUG YOZMP WLCBTVM
# DROO TVMVIZGV Z WVUZFOG HGBOV HSVVG

sgno_hgbovhsvvg        =

# rU GSV sgno_zortm_nvnyvih GZT RH HVG GL bvh, GSV NVNYVIH LU XOZHHVH,
# UROVH LI MZNVHKZXVH DROO YV ZORTMVW RM sgno FHRMT GZYOVH. rU HVG GL
# ml Z YFOOVG ORHG DROO YV FHVW.

sgno_zortm_nvnyvih     = bvh

# rU GSV tvmvizgv_sgnosvok GZT RH HVG GL bvh, ZWWRGRLMZO RMWVC UROVH
# DROO YV TVMVIZGVW GSZG XZM YV FHVW ZH RMKFG ULI GLLOH ORPV GSV
# nRXILHLUG sgno SVOK DLIPHSLK GL TVMVIZGV Z XLNKIVHHVW sgno SVOK UROV (.XSN)
# LU GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

tvmvizgv_sgnosvok      = ml

# gSV wrhzyov_rmwvc GZT XZM YV FHVW GL GFIM LM/LUU GSV XLMWVMHVW RMWVC ZG
# GLK LU VZXS sgno KZTV. gSV EZOFV ml (GSV WVUZFOG) VMZYOVH GSV RMWVC ZMW
# GSV EZOFV bvh WRHZYOVH RG.

wrhzyov_rmwvc          = ml

# gSRH GZT XZM YV FHVW GL HVG GSV MFNYVI LU VMFN EZOFVH (IZMTV [8..79])
# GSZG WLCBTVM DROO TILFK LM LMV ORMV RM GSV TVMVIZGVW sgno WLXFNVMGZGRLM.

vmfn_ezofvh_kvi_ormv   = 5

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV oZgVc LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_ozgvc GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV oZGVC LFGKFG.

tvmvizgv_ozgvc         = ml

# gSV ozgvc_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV oZgVc WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `OZGVC' DROO YV FHVW ZH GSV WVUZFOG KZGS.

ozgvc_lfgkfg           = OZGVC

# rU GSV xlnkzxg_ozgvc GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# oZgVc WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_ozgvc          = ml

# gSV kzkvi_gbkv GZT XZM YV FHVW GL HVG GSV KZKVI GBKV GSZG RH FHVW
# YB GSV KIRMGVI. kLHHRYOV EZOFVH ZIV: Z5, Z5DRWV, OVGGVI, OVTZO ZMW
# VCVXFGREV. rU OVUG YOZMP Z5DRWV DROO YV FHVW.

kzkvi_gbkv             = Z5DRWV

# gSV vcgiz_kzxpztvh GZT XZM YV GL HKVXRUB LMV LI NLIV MZNVH LU oZgVc
# KZXPZTVH GSZG HSLFOW YV RMXOFWVW RM GSV oZgVc LFGKFG.

vcgiz_kzxpztvh         =

# gSV ozgvc_svzwvi GZT XZM YV FHVW GL HKVXRUB Z KVIHLMZO oZgVc SVZWVI ULI
# GSV TVMVIZGVW OZGVC WLXFNVMG. gSV SVZWVI HSLFOW XLMGZRM VEVIBGSRMT FMGRO
# GSV URIHG XSZKGVI. rU RG RH OVUG YOZMP WLCBTVM DROO TVMVIZGV Z
# HGZMWZIW SVZWVI. mLGRXV: LMOB FHV GSRH GZT RU BLF PMLD DSZG BLF ZIV WLRMT!

ozgvc_svzwvi           =

# rU GSV kwu_sbkviormph GZT RH HVG GL bvh, GSV oZgVc GSZG RH TVMVIZGVW
# RH KIVKZIVW ULI XLMEVIHRLM GL KWU (FHRMT KH7KWU). gSV KWU UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z KWU ERVDVI.

kwu_sbkviormph         = ml

# rU GSV fhv_kwuozgvc GZT RH HVG GL bvh, KWUOZGVC DROO YV FHVW RMHGVZW LU
# KOZRM OZGVC RM GSV TVMVIZGVW nZPVUROV. hVG GSRH LKGRLM GL bvh GL TVG Z
# SRTSVI JFZORGB kwu WLXFNVMGZGRLM.

fhv_kwuozgvc           = ml

# rU GSV ozgvc_yzgxsnlwv GZT RH HVG GL bvh, WLCBTVM DROO ZWW GSV \\YZGXSNLWV.
# XLNNZMW GL GSV TVMVIZGVW oZgVc UROVH. gSRH DROO RMHGIFXG oZgVc GL PVVK
# IFMMRMT RU VIILIH LXXFI, RMHGVZW LU ZHPRMT GSV FHVI ULI SVOK.
# gSRH LKGRLM RH ZOHL FHVW DSVM TVMVIZGRMT ULINFOZH RM sgno.

ozgvc_yzgxsnlwv        = ml

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV igu LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_igu GZT RH HVG GL bvh wLCBTVM DROO TVMVIZGV igu LFGKFG
# gSV igu LFGKFG RH LKGRNRHVW ULI dLIW 02 ZMW NZB MLG OLLP EVIB KIVGGB DRGS
# LGSVI igu IVZWVIH LI VWRGLIH.

tvmvizgv_igu           = ml

# gSV igu_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV igu WLXH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `IGU' DROO YV FHVW ZH GSV WVUZFOG KZGS.

igu_lfgkfg             = IGU

# rU GSV xlnkzxg_igu GZT RH HVG GL bvh wLCBTVM TVMVIZGVH NLIV XLNKZXG
# igu WLXFNVMGH. gSRH NZB YV FHVUFO ULI HNZOO KILQVXGH ZMW NZB SVOK GL
# HZEV HLNV GIVVH RM TVMVIZO.

xlnkzxg_igu            = bvh

# rU GSV igu_sbkviormph GZT RH HVG GL bvh, GSV igu GSZG RH TVMVIZGVW
# DROO XLMGZRM SBKVIORMP URVOWH. gSV igu UROV DROO
# XLMGZRM ORMPH (QFHG ORPV GSV sgno LFGKFG) RMHGVZW LU KZTV IVUVIVMXVH.
# gSRH NZPVH GSV LFGKFG HFRGZYOV ULI LMORMV YILDHRMT FHRMT Z dliw LI LGSVI.
# KILTIZNH DSRXS HFKKLIG GSLHV URVOWH.
# mLGV: DLIWKZW (DIRGV) ZMW LGSVIH WL MLG HFKKLIG ORMPH.

igu_sbkviormph         = ml

# oLZW HGBOVHSVVG WVURMRGRLMH UILN UROV. hBMGZC RH HRNROZI GL WLCBTVM'H
# XLMURT UROV, R.V. Z HVIRVH LU ZHHRTNVMGH. bLF LMOB SZEV GL KILERWV
# IVKOZXVNVMGH, NRHHRMT WVURMRGRLMH ZIV HVG GL GSVRI WVUZFOG EZOFV.

igu_hgbovhsvvg_urov    =

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV NZM KZTV LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_nzm GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV NZM KZTVH

tvmvizgv_nzm           = ml

# gSV nzm_lfgkfg GZT RH FHVW GL HKVXRUB DSVIV GSV NZM KZTVH DROO YV KFG.
# rU Z IVOZGREV KZGS RH VMGVIVW GSV EZOFV LU lfgkfg_wrivxglib DROO YV
# KFG RM UILMG LU RG. rU OVUG YOZMP `NZM' DROO YV FHVW ZH GSV WVUZFOG KZGS.

nzm_lfgkfg             = NZM

# gSV nzm_vcgvmhrlm GZT WVGVINRMVH GSV VCGVMHRLM GSZG RH ZWWVW GL
# GSV TVMVIZGVW NZM KZTVH (WVUZFOG RH GSV HFYILFGRMV'H HVXGRLM .6)

nzm_vcgvmhrlm          = .6

#---------------------------------------------------------------------------
# XLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV cno LFGKFG
#---------------------------------------------------------------------------

# rU GSV tvmvizgv_cno GZT RH HVG GL bvh wLCBTVM DROO
# TVMVIZGV ZM cno UROV GSZG XZKGFIVH GSV HGIFXGFIV LU
# GSV XLWV RMXOFWRMT ZOO WLXFNVMGZGRLM. dZIMRMT: gSRH UVZGFIV
# RH HGROO VCKVIRNVMGZO ZMW EVIB RMXLNKOVGV.

tvmvizgv_cno           = ml

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV KIVKILXVHHLI
#---------------------------------------------------------------------------

# rU GSV vmzyov_kivkilxvhhrmt GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# VEZOFZGV ZOO x-KIVKILXVHHLI WRIVXGREVH ULFMW RM GSV HLFIXVH ZMW RMXOFWV
# UROVH.

vmzyov_kivkilxvhhrmt   = bvh

# rU GSV nzxil_vckzmhrlm GZT RH HVG GL bvh wLCBTVM DROO VCKZMW ZOO NZXIL
# MZNVH RM GSV HLFIXV XLWV. rU HVG GL ml (GSV WVUZFOG) LMOB XLMWRGRLMZO
# XLNKROZGRLM DROO YV KVIULINVW. nZXIL VCKZMHRLM XZM YV WLMV RM Z XLMGILOOVW
# DZB YB HVGGRMT vckzmw_lmob_kivwvu GL bvh.

nzxil_vckzmhrlm        = ml

# rU GSV vckzmw_lmob_kivwvu ZMW nzxil_vckzmhrlm GZTH ZIV YLGS HVG GL bvh
# GSVM GSV NZXIL VCKZMHRLM RH ORNRGVW GL GSV NZXILH HKVXRURVW DRGS GSV
# kivwvurmvw ZMW vckzmw_zh_kivwvurmvw GZTH.

vckzmw_lmob_kivwvu     = ml

# rU GSV hvzixs_rmxofwvh GZT RH HVG GL bvh (GSV WVUZFOG) GSV RMXOFWVH UROVH
# RM GSV rmxofwv_kzgs (HVV YVOLD) DROO YV HVZIXS RU Z #RMXOFWV RH ULFMW.

hvzixs_rmxofwvh        = bvh

# gSV rmxofwv_kzgs GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV WRIVXGLIRVH GSZG
# XLMGZRM RMXOFWV UROVH GSZG ZIV MLG RMKFG UROVH YFG HSLFOW YV KILXVHHVW YB
# GSV KIVKILXVHHLI.

rmxofwv_kzgs           =

# bLF XZM FHV GSV rmxofwv_urov_kzggvimh GZT GL HKVXRUB LMV LI NLIV DROWXZIW
# KZGGVIMH (ORPV *.S ZMW *.SKK) GL UROGVI LFG GSV SVZWVI-UROVH RM GSV
# WRIVXGLIRVH. rU OVUG YOZMP, GSV KZGGVIMH HKVXRURVW DRGS urov_kzggvimh DROO
# YV FHVW.

rmxofwv_urov_kzggvimh  =

# gSV kivwvurmvw GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV NZXIL MZNVH GSZG
# ZIV WVURMVW YVULIV GSV KIVKILXVHHLI RH HGZIGVW (HRNROZI GL GSV -w LKGRLM LU
# TXX). gSV ZITFNVMG LU GSV GZT RH Z ORHG LU NZXILH LU GSV ULIN: MZNV
# LI MZNV=WVURMRGRLM (ML HKZXVH). rU GSV WVURMRGRLM ZMW GSV = ZIV
# LNRGGVW =8 RH ZHHFNVW.

kivwvurmvw             =  xliv_tilfk

# rU GSV nzxil_vckzmhrlm ZMW vckzmw_kivwvu_lmob GZTH ZIV HVG GL bvh GSVM
# GSRH GZT XZM YV FHVW GL HKVXRUB Z ORHG LU NZXIL MZNVH GSZG HSLFOW YV VCKZMWVW.
# gSV NZXIL WVURMRGRLM GSZG RH ULFMW RM GSV HLFIXVH DROO YV FHVW.
# fHV GSV kivwvurmvw GZT RU BLF DZMG GL FHV Z WRUUVIVMG NZXIL WVURMRGRLM.

vckzmw_zh_wvurmvw      =

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL VCGVIMZO IVUVIVMXVH
#---------------------------------------------------------------------------

# gSV gzturovh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV GZTUROVH.

gzturovh               =

# dSVM Z UROV MZNV RH HKVXRURVW ZUGVI tvmvizgv_gzturov, WLCBTVM DROO XIVZGV
# Z GZT UROV GSZG RH YZHVW LM GSV RMKFG UROVH RG IVZWH.

tvmvizgv_gzturov       =

# rU GSV zoovcgvimzoh GZT RH HVG GL bvh ZOO VCGVIMZO XOZHHVH DROO YV ORHGVW
# RM GSV XOZHH RMWVC. rU HVG GL ml LMOB GSV RMSVIRGVW VCGVIMZO XOZHHVH
# DROO YV ORHGVW.

zoovcgvimzoh           = ml

# gSV kvio_kzgs HSLFOW YV GSV ZYHLOFGV KZGS ZMW MZNV LU GSV KVIO HXIRKG
# RMGVIKIVGVI (R.V. GSV IVHFOG LU `DSRXS KVIO').

kvio_kzgs              = /FHI/YRM/KVIO

#---------------------------------------------------------------------------
# xLMURTFIZGRLM LKGRLMH IVOZGVW GL GSV WLG GLLO
#---------------------------------------------------------------------------

# rU BLF HVG GSV szev_wlg GZT GL bvh GSVM WLCBTVM DROO ZHHFNV GSV WLG GLLO RH
# ZEZROZYOV UILN GSV KZGS. gSRH GLLO RH KZIG LU tIZKSERA, Z TIZKS ERHFZORAZGRLM
# GLLOPRG UILN zg&g ZMW oFXVMG yVOO oZYH. gSV LGSVI LKGRLMH RM GSRH HVXGRLM
# SZEV ML VUUVXG RU GSRH LKGRLM RH HVG GL ml (GSV WVUZFOG)

szev_wlg               = bvh

# rU GSV xozhh_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RMSVIRGZMXV IVOZGRLMH. hVGGRMT GSRH GZT GL bvh DROO ULIXV GSV
# GSV xozhh_wrztiznh GZT GL ml.

xozhh_tizks            = bvh

# rU GSV xloozylizgrlm_tizks ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW XOZHH HSLDRMT GSV WRIVXG ZMW
# RMWRIVXG RNKOVNVMGZGRLM WVKVMWVMXRVH (RMSVIRGZMXV, XLMGZRMNVMG, ZMW
# XOZHH IVUVIVMXVH EZIRZYOVH) LU GSV XOZHH DRGS LGSVI WLXFNVMGVW XOZHHVH.

xloozylizgrlm_tizks    = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwv_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW UROV HSLDRMT
# GSV WRIVXG ZMW RMWRIVXG RMXOFWV WVKVMWVMXRVH LU GSV UROV DRGS LGSVI
# WLXFNVMGVW UROVH.

rmxofwv_tizks          = bvh

# rU GSV vmzyov_kivkilxvhhrmt, rmxofwvw_yb_tizks, ZMW szev_wlg GZTH ZIV HVG GL
# bvh GSVM WLCBTVM DROO TVMVIZGV Z TIZKS ULI VZXS WLXFNVMGVW SVZWVI UROV HSLDRMT
# GSV WLXFNVMGVW UROVH GSZG WRIVXGOB LI RMWRIVXGOB RMXOFWV GSRH UROV

rmxofwvw_yb_tizks      = bvh

# rU GSV tizksrxzo_srvizixsb ZMW szev_wlg GZTH ZIV HVG GL bvh GSVM WLCBTVM
# DROO TIZKSRXZO SRVIZIXSB LU ZOO XOZHHVH RMHGVZW LU Z GVCGFZO LMV.

tizksrxzo_srvizixsb    = bvh

# gSV GZT wlg_kzgs XZM YV FHVW GL HKVXRUB GSV KZGS DSVIV GSV WLG GLLO XZM YV
# ULFMW. rU OVUG YOZMP, RG RH ZHHFNVW GSV WLG GLLO XZM YV ULFMW LM GSV KZGS.

wlg_kzgs               =

# gSV nzc_wlg_tizks_drwgs GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDVW DRWGS
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_drwgs    = 8975

# gSV nzc_wlg_tizks_svrtsg GZT XZM YV FHVW GL HVG GSV NZCRNFN ZOOLDH SVRTSG
# (RM KRCVOH) LU GSV TIZKSH TVMVIZGVW YB WLG. rU Z TIZKS YVXLNVH OZITVI GSZM
# GSRH EZOFV, WLCBTVM DROO GIB GL GIFMXZGV GSV TIZKS, HL GSZG RG URGH DRGSRM
# GSV HKVXRURVW XLMHGIZRMG. yVDZIV GSZG NLHG YILDHVIH XZMMLG XLKV DRGS EVIB
# OZITV RNZTVH.

nzc_wlg_tizks_svrtsg   = 8975

# rU GSV tvmvizgv_ovtvmw GZT RH HVG GL bvh (GSV WVUZFOG) wLCBTVM DROO
# TVMVIZGV Z OVTVMW KZTV VCKOZRMRMT GSV NVZMRMT LU GSV EZIRLFH YLCVH ZMW
# ZIILDH RM GSV WLG TVMVIZGVW TIZKSH.

tvmvizgv_ovtvmw        = bvh

#---------------------------------------------------------------------------
# xLMURTFIZGRLM::ZWWGRLMH IVOZGVW GL GSV HVZIXS VMTRMV
#---------------------------------------------------------------------------

# gSV hvzixsvmtrmv GZT HKVXRURVH DSVGSVI LI MLG Z HVZIXS VMTRMV HSLFOW YV
# FHVW. rU HVG GL ml GSV EZOFVH LU ZOO GZTH YVOLD GSRH LMV DROO YV RTMLIVW.

hvzixsvmtrmv           = ml

# gSV xtr_mznv GZT HSLFOW YV GSV MZNV LU GSV xtr HXIRKG GSZG
# HGZIGH GSV HVZIXS VMTRMV (WLCBHVZIXS) DRGS GSV XLIIVXG KZIZNVGVIH.
# z HXIRKG DRGS GSRH MZNV DROO YV TVMVIZGVW YB WLCBTVM.

xtr_mznv               = HVZIXS.XTR

# gSV xtr_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# XTR YRMZIRVH ZIV OLXZGVW. hVV GSV WLXFNVMGZGRLM LU BLFI SGGK WZVNLM ULI
# WVGZROH.

xtr_fio                =

# gSV wlx_fio GZT HSLFOW YV GSV ZYHLOFGV fio GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV ZYHLOFGV KZGS GL GSV
# WLXFNVMGZGRLM, DRGS UROV:// KIVKVMWVW GL RG, DROO YV FHVW.

wlx_fio                =

# gSV wlx_zyhkzgs GZT HSLFOW YV GSV ZYHLOFGV KZGS GL GSV WRIVXGLIB DSVIV GSV
# WLXFNVMGZGRLM RH OLXZGVW. rU OVUG YOZMP GSV WRIVXGLIB LM GSV OLXZO NZXSRMV
# DROO YV FHVW.

wlx_zyhkzgs            =

# gSV yrm_zyhkzgs GZT NFHG KLRMG GL GSV WRIVXGLIB DSVIV GSV WLCBHVZIXS YRMZIB
# RH RMHGZOOVW.

yrm_zyhkzgs            = /FHI/OLXZO/YRM/

# gSV vcg_wlx_kzgsh GZT XZM YV FHVW GL HKVXRUB LMV LI NLIV KZGSH GL
# WLXFNVMGZGRLM TVMVIZGVW ULI LGSVI KILQVXGH. gSRH ZOOLDH WLCBHVZIXS GL HVZIXS
# GSV WLXFNVMGZGRLM ULI GSVHV KILQVXGH ZH DVOO.

vcg_wlx_kzgsh          =

//##**---------------- ./FYRJNZGS/GVHG/NZRM_GVHG.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>

RMG NZRM(RMG ZITX, XSZI **ZITE) {
    ::GVHGRMT::rMRGtLLTOVgVHG(&ZITX, ZITE);
    IVGFIM ifm_zoo_gvhgh();
}
//##**---------------- ./FYRJNZGS/GVHG/KOZB_OI.XKK
#RMXOFWV "../RMXOFWV/FYRJ_OI.S"

FHRMT MZNVHKZXV FYRJNZGS;

RMG NZRM() {
    fNZGIRC NZG(6, 7);
    NZG.oLZW("GVHG/VCZNKOV/OINZG.XHE");
    fEVXGLI EVX(6);
    EVX.oLZW("GVHG/VCZNKOV/OIEVX.XHE");
    toi<IVTIVHHRLM_ZOTLIRGSN::loh> TOI(&NZG, &EVX);
    TOI.iVTIVHH();
    HGW::XLFG<<"WVHRTM: \M"<<NZG<<HGW::VMWO;
    HGW::XLFG<<"IVHKLMHV: \M"<<EVX<<HGW::VMWO;
    HGW::XLFG<<"HLOFGRLM: \M"<<TOI.hLOFGRLM()<<HGW::VMWO;
    TOI.zMZOBAV();
    HGW::XLFG<<"IVHRWFZO: \M"<<TOI.iVHRWFZO()<<HGW::VMWO;
    HGW::XLFG<<"HGWVII: \M" <<TOI.hgwvii()<<HGW::VMWO;
    HGW::XLFG<<"i7: "<<TOI.i7()<<HGW::VMWO;
    HGW::XLFG<<"u: "<<TOI.u()<<HGW::VMWO;
    HGW::XLFG<<"hhv: "<<TOI.hhv()<<HGW::VMWO;
    HGW::XLFG<<"hhn: "<<TOI.hhn()<<HGW::VMWO;
    HGW::XLFG<<"hhg: "<<TOI.hhg()<<HGW::VMWO;
    HGW::XLFG<<"nhv: "<<TOI.nhv()<<HGW::VMWO;
    HGW::XLFG<<"nhn: "<<TOI.nhn()<<HGW::VMWO;
    HGW::XLFG<<"nhg: "<<TOI.nhg()<<HGW::VMWO;
}
//##**---------------- ./FYRJNZGS/GVHG/GVHG_YRML.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>

#RMXOFWV <UHGIVZN>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_NZGS.S"

FHRMT MZNVHKZXV FYRJNZGS;


gvhg(yrml, mlinzo) {
    zhhvig_vj(yRMLNRZOxLVUU(4,7), 89);
}


gvhg(yrml, mlinzo7) {
    zhhvig_vj(yRMLNRZOxLVUU(3,7), 84);
}


gvhg(yrml, xzgzozm) {
    zhhvig_vj(xZGZOZM(3), 867);
}

//##**---------------- ./FYRJNZGS/GVHG/KOZB_XLMRX.XKK
#RMXOFWV <HGWRL.S>
#RMXOFWV <UHGIVZN>
#RMXOFWV <HGIRMT>
#RMXOFWV <HHGIVZN>
#RMXOFWV "FYRJ_NZGS.S"
#RMXOFWV "FYRJ_XLMRXLKG.S"

FHRMT MZNVHKZXV FYRJNZGS;

RMG NZRM(RMG ZITX,XSZI *ZITE[])
{

    xLMRXlKG<> LKG(398, 611);
    LKG.xOVZI();
    fNZGIRC z(611, 398);
    fEVXGLI YOX(611), YFX(611), YOC(398), YFC(398), H(398);
    fEVXGLI XLIM8(398);

    XLIM8.AVILH();
    XLIM8(HKZM(9, 700)) = 8;
    XLIM8(399) = -8;

    z.oLZW("GVHG/VCZNKOV/z.XHE");
    YOX.oLZW("GVHG/VCZNKOV/yox.XHE");
    YFX.oLZW("GVHG/VCZNKOV/yfx.XHE");
    YOC.oLZW("GVHG/VCZNKOV/yoc.XHE");
    YFC.oLZW("GVHG/VCZNKOV/yfc.XHE");
    H.oLZW("GVHG/VCZNKOV/X.XHE");
    H *= -8;

    LKG.HVGyc(&YOC, &YFC);
    LKG.HVGyx(&YOX, &YFX);
    LKG.HVGh(&H);
    LKG.HVGz(&z);
    LKG.ZWWxLIM(&XLIM8);
    //LKG.lKVMhFNNZIB();
    HGW::XLFG<<LKG.hLOEV()<<HGW::VMWO;
    HGW::XLFG<<LKG.LYQVXGREV<<HGW::VMWO;
    //HGW::XLFG<<LKG.HLOFGRLM<<HGW::VMWO;

} /* NZRM */
//##**---------------- ./FYRJNZGS/GVHG/KOZB_JFZWIZGRX.XKK
#RMXOFWV <HGWRL.S>
#RMXOFWV <UHGIVZN>
#RMXOFWV <HGIRMT>
#RMXOFWV <HHGIVZN>
#RMXOFWV "FYRJ_NZGS.S"
#RMXOFWV "FYRJ_JFZWIZGRXLKG.S"

FHRMT MZNVHKZXV FYRJNZGS;

RMG NZRM(RMG ZITX,XSZI *ZITE[])
{

    jFZWIZGRXlKG<398,611> LKG;
    LKG.xOVZI();
    fNZGIRC z(611, 398);
    fEVXGLI YOX(611), YFX(611), YOC(398), YFC(398), H(398);


    z.oLZW("GVHG/VCZNKOV/z.XHE");
    YOX.oLZW("GVHG/VCZNKOV/yox.XHE");
    YFX.oLZW("GVHG/VCZNKOV/yfx.XHE");
    YOC.oLZW("GVHG/VCZNKOV/yoc.XHE");
    YFC.oLZW("GVHG/VCZNKOV/yfc.XHE");
    H.oLZW("GVHG/VCZNKOV/X.XHE");
    H *= -8;

    LKG.HVGyc(&YOC, &YFC);
    LKG.HVGyx(&YOX, &YFX);
    LKG.HVGh(&H);
    LKG.HVGz(&z);
    LKG.lKVMhFNNZIB();
    HGW::XLFG<<LKG.hLOEV()<<HGW::VMWO;

    HGW::XLFG<<LKG.LYQVXGREV<<HGW::VMWO;
    //HGW::XLFG<<LKG.HLOFGRLM<<HGW::VMWO;

} /* NZRM */
//##**---------------- ./FYRJNZGS/GVHG/GVHG_HGWWVE.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>

#RMXOFWV <UHGIVZN>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_NZGS.S"

FHRMT MZNVHKZXV FYRJNZGS;

gvhg(HGWWVE, svoo) {
    HGW::HGIRMT ORMV;
    WLFYOV35 WZGZ8[8999], WZGZ7[8999];
    HGW::RUHGIVZN RUH;
    RUH.LKVM("GVHG/VCZNKOV/8999IZMWLN.WZG");
    RU (RUH.UZRO())
        FYRJGSILD("XZMMLG LKVM 8999IZMWLN.WZG GVHG UROV.", -8);
    FRMG67 R=8;
    WLFYOV EZIRZMXV, NVZM;
    DSROV (HGW::TVGORMV(RUH, ORMV))
    {
        HGW::HGIRMT IVXLIW = ORMV;
        ZFGL HKORG_IVHFOG = FYRJGLLO::hKORGhGIRMT(IVXLIW, ",");
        WZGZ8[R] = HGW::HGLW(HKORG_IVHFOG.TVG(9));
        WZGZ7[R] = HGW::HGLW(HKORG_IVHFOG.TVG(8));
        //HGW::XLFG<<R<<" -> "<<WZGZ8[R]<<HGW::VMWO;
        EZIRZMXV_LMORMV(EZIRZMXV, NVZM, WZGZ8[R], R);
    }
    RUH.XOLHV();
    //HGW::XLFG<<EZIRZMXV<<HGW::VMWO;
    //HGW::XLFG<<EZIRZMXV_LMVKZHH(&WZGZ8[9], 8999)<<HGW::VMWO;
    //HGW::XLFG<<EZIRZMXV_LMVKZHH(&WZGZ7[9], 8999)<<HGW::VMWO;
    //HGW::XLFG<<EZIRZMXV_GDLKZHH(&WZGZ8[9], 8999)<<HGW::VMWO;

    zhhvig_vj(8,8);
}


gvhg(HGWWVE, iloormt)
{
    EZIRZMXV_ILOORMT<> EILOO(6);
    zhhvig_gifv(EILOO(8)==9&&EILOO(7)==9.4&&EILOO(6)==8&&EILOO(5)==8&&EILOO(4)==8);
}

gvhg(vjfzo, tVGfOKwRUUVIVMXV) {
    UOLZG Z = 83222783.9;
    UOLZG Y = 83222743.9;
    WLFYOV X = 9.8999999999999999944488848768742172978818416595458984374;
    WLFYOV W = 9.8999999999999999804488848768742172978818416595458984374;
    //HGW::XLFG<<tVGfOKwRUUVIVMXV(Z, Y)<<HGW::VMWO;
    //HGW::XLFG<<tVGfOKwRUUVIVMXV(X, W)<<HGW::VMWO;
    zhhvig_vj(tVGfOKwRUUVIVMXV(Z, Y)==79 && tVGfOKwRUUVIVMXV(X, W)==8, 8);
}


gvhg(vjfzo, zONLHGvJFZOiVOZGREV) {
    WLFYOV X = 9.8999999999999999944488848768742172978818416595458984374;
    WLFYOV W = 9.8999999999999999804488848768742172978818416595458984374;
    //HGW::XLFG<<tVGfOKwRUUVIVMXV(X, W)<<HGW::VMWO;
    zhhvig_vj(zONLHGvJFZOfOKH(X, W), 8);
}
//##**---------------- ./FYRJNZGS/GVHG/KOZB_NZGIRC.XKK
#RMXOFWV "../RMXOFWV/FYRJ_NZGIRC.S"

FHRMT MZNVHKZXV FYRJNZGS;

RMG NZRM() {
	fNZGIRC NZG(5, 5);
	fNZGIRC NZG6(5, 4);
	NZG6.VBV();
	fEVXGLI EVX(5);
	EVX.LMVH();

	EVX(7)=6;
	ZFGL EVX7 = EVX.G();
	HGW::XLFG<<" eVXGLI 8:"<<HGW::VMWO;
	HGW::XLFG<<EVX<<HGW::VMWO;

	HGW::XLFG<<" eVXGLI 8 HFY EVXGLI 7-6:"<<HGW::VMWO;
	HGW::XLFG<<EVX(HKZM(8,7))<<HGW::VMWO;

    HGW::XLFG<<" eVXGLI 8 HFY EVXGLI 8-7 HVG GL 7:"<<HGW::VMWO;
    EVX(HKZM(9,8)) = 7;
    HGW::XLFG<<EVX<<HGW::VMWO;

    HGW::XLFG<<" OLZW EVXGLI 4 UILN UROV"<<HGW::VMWO;
    fEVXGLI EVX4;
    EVX4.oLZW("GVHG/VCZNKOV/EVX.XHE");
    HGW::XLFG<<EVX4<<HGW::VMWO;

	HGW::XLFG<<" eVXGLI 7 += 8:"<<HGW::VMWO;
	EVX7+=8;
	HGW::XLFG<<EVX7<<HGW::VMWO;

	HGW::XLFG<<" eVXGLI 7 * 7:"<<HGW::VMWO;
	HGW::XLFG<<EVX7*7<<HGW::VMWO;

	HGW::XLFG<<" eVXGLI 7 * eVXGLI 8:"<<HGW::VMWO;
	HGW::XLFG<<EVX7 * EVX<<"\M"<<HGW::VMWO;
	NZG.VBV();
	NZG(7,6) = 5;
	ZFGL NZG7 = NZG;
	//HGW::XLFG<<NZG<<HGW::VMWO;
	NZG.R();
	NZG.G();
	NZG.XLO(7) += 8;

	HGW::XLFG<<"nZGIRC 8:"<<HGW::VMWO;
	HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"xLMWRGRLM mFNYVI ZMW gIZXV:"<<HGW::VMWO;
	HGW::XLFG<<NZG.XLMW()<<" "<<NZG.GIZXV()<<"\M"<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 8 xLO 6:"<<HGW::VMWO;
	HGW::XLFG<<NZG.XLO(7)<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 8 iLD 5:"<<HGW::VMWO;
	HGW::XLFG<<NZG.ILD(6)<<HGW::VMWO;

    HGW::XLFG<<"nZGIRC 8 iLD 8 GL 8.9"<<HGW::VMWO;
    NZG.ILD(9) = 8.9;
    HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"VCGIZXG nZGIRC 8 iLD 5 ZH fEVXGLI:"<<HGW::VMWO;
	fEVXGLI EVX6 = NZG.ILD(6);
	HGW::XLFG<<EVX6<<HGW::VMWO;

	HGW::XLFG<<"VCGIZXG nZGIRC 8 iLD 5 ZH HGW::EVXGLI:"<<HGW::VMWO;
	HGW::EVXGLI<WLFYOV> EVX5 = NZG.ILD(6);
	ULI (ZFGL RGVI=EVX5.YVTRM(); RGVI!=EVX5.VMW(); ++RGVI)
		HGW::XLFG<<*RGVI<<" ";
	HGW::XLFG<<"\M"<<HGW::VMWO;

	HGW::XLFG<<"hVG nZGIRC 8 iLD 5 GL EVXGLI 6*7:"<<HGW::VMWO;
	NZG.ILD(6) = EVX6*7;
	HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 8 WRZT URIHG 7 VOVNVMGH:"<<HGW::VMWO;
	HGW::XLFG<<NZG.WRZT(7)<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 8 WRZT:"<<HGW::VMWO;
	HGW::XLFG<<NZG.WRZT()<<HGW::VMWO;

	HGW::XLFG<<"hVG nZGIRC iLD 7 GL AVILH:"<<HGW::VMWO;
	NZG.ILD(8).AVILH();
	HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"hVG nZGIRC iLD 7 GL LMV:"<<HGW::VMWO;
	NZG.ILD(8).LMVH();
	HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"hVG nZGIRC iLD 8 GL 8.7:"<<HGW::VMWO;
	NZG.ILD(9).UROO(8.7);
	HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"vCGIZXG nZGIRC iRTSG yLGGLN 7C7, ZMW RMXIVNVMG RG DRGS 8:"<<HGW::VMWO;
	fNZGIRC NRMRNZG = NZG.HFY(HKZM(7, 6), HKZM(7, 6));
	NRMRNZG += 8;
	HGW::XLFG<<NRMRNZG<<HGW::VMWO;

	HGW::XLFG<<"iVKOZXV nZGIRC xVMGIZO 7C7 GL VBV:"<<HGW::VMWO;
	NZG.HFY(HKZM(8, 7), HKZM(8, 7)).VBV();
	HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"iVKOZXV nZGIRC xVMGIZO 7C7 GL iRTSG yLGGLN 7C7 +8:"<<HGW::VMWO;
	NZG.HFY(HKZM(8, 7), HKZM(8, 7)) = NRMRNZG;
	HGW::XLFG<<NZG<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 7:"<<HGW::VMWO;
	HGW::XLFG<<NZG7<<HGW::VMWO;

	HGW::XLFG<<"hVG nZGIRC 7 ILD 7 GL nZGIRC ILD 5:"<<HGW::VMWO;
	NZG7.ILD(8)=NZG.ILD(6);
	HGW::XLFG<<NZG7<<HGW::VMWO;

	HGW::XLFG<<"EVX 8"<<HGW::VMWO;
	HGW::XLFG<<EVX<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 7 * eVXGLI 8:"<<HGW::VMWO;
	HGW::XLFG<<NZG7 * EVX<<HGW::VMWO;

	HGW::XLFG<<"eVXGLI 8 * nZGIRC 7  :"<<HGW::VMWO;
	HGW::XLFG<<EVX.G() * NZG7 <<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 7 + nZGIRC 8:"<<HGW::VMWO;
	HGW::XLFG<<NZG7+NZG<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 7 - nZGIRC 8:"<<HGW::VMWO;
	HGW::XLFG<<NZG7-NZG<<HGW::VMWO;

	HGW::XLFG<<"nZGIRC 6:"<<HGW::VMWO;
	HGW::XLFG<<NZG6<<HGW::VMWO;

	HGW::XLFG<<"8 + nZGIRC 7 * nZGIRC 6:"<<HGW::VMWO;
	HGW::XLFG<<8+NZG7*NZG6<<HGW::VMWO;

	HGW::XLFG<<"8 + nZGIRC 7 * nZGIRC 6 * 7 - 8:"<<HGW::VMWO;
	HGW::XLFG<<8+NZG7*NZG6*7-8<<HGW::VMWO;

	ZFGL NZG5 = NZG + NZG.G();
	HGW::XLFG<<"hBNNVGIRXZO nZGIRC 5:"<<HGW::VMWO;
	HGW::XLFG<<NZG5<<HGW::VMWO;
	fNZGIRC NZG_VRTVMEVX;
	fEVXGLI EVX_VRTVMEZO;
	vrtvm_hbn(EVX_VRTVMEZO, NZG_VRTVMEVX, NZG5);

	HGW::XLFG<<"vRTVM WVXLNKLHRGRLM LU nZGIRC 5:"<<HGW::VMWO;
	HGW::XLFG<<"vRTVMEZOFVH:"<<HGW::VMWO;
	HGW::XLFG<<EVX_VRTVMEZO<<HGW::VMWO;
	HGW::XLFG<<"vRTVMEVXGLIH:"<<HGW::VMWO;
	HGW::XLFG<<NZG_VRTVMEVX<<HGW::VMWO;


    HGW::XLFG<<"gL EVIRUB RG, DV NFOGRKOB GSVN YZXP ZH eze.G, IVHFOG HSLFOW VJFZO GL NZGIRC 5:"<<HGW::VMWO;
    fNZGIRC NN(5, 5);
    NN.WRZT() = EVX_VRTVMEZO;
	HGW::XLFG<<NZG_VRTVMEVX*NN*NZG_VRTVMEVX.G()<<HGW::VMWO;

    HGW::XLFG<<"UUG NZGIRC 5"<<HGW::VMWO;
    ZFGL NZG4 = uug(NZG5);
    HGW::XLFG<<NZG4<<HGW::VMWO;

    HGW::XLFG<<"RUUG YZXP GL NZGIRC 5, IVHFOG HSLFOW VJFZO GL NZGIRC 5"<<HGW::VMWO;
    HGW::XLFG<<ruug(NZG4)<<HGW::VMWO;



    HGW::XLFG<<"EVX 8:"<<EVX.G()<<HGW::VMWO;
    HGW::XLFG<<"EVX 7:"<<EVX7<<HGW::VMWO;
    HGW::XLFG<<"gVHG XLIIVOZGRLM LU EVX 8 ZMW EVX 7:"<<HGW::VMWO;
    HGW::XLFG<<xli(EVX, EVX7.G())<<HGW::VMWO;
    HGW::XLFG<<"gVHG XLEZIRZMXV LU EVX 8 ZMW EVX 7:"<<HGW::VMWO;
    HGW::XLFG<<xle(EVX, EVX7.G())<<HGW::VMWO;

    fNZGIRC NZGOZITV(67, 7899);
    NZGOZITV.ILD(9) = 8.8;

}
//##**---------------- ./FYRJNZGS/GVHG/GVHG_XLEZIRZMXV.XKK
/**********************************************
* \EVIHRLM   9.9.8
* \ZFGSLI    YUZM
* \XIVZGVW   7984-95-79
* \NLWRURVW  7984-95-79
* \YIRVU:
* xLMGZXG:
* mLGV:
**********************************************/
#RMXOFWV <TGVHG/TGVHG.S>

#RMXOFWV <UHGIVZN>
#RMXOFWV "FYRJ_GLLO.S"
#RMXOFWV "../RMXOFWV/FYRJ_NZGS.S"
#RMXOFWV "../RMXOFWV/FYRJ_XLEZIRZMXV.S"

FHRMT MZNVHKZXV FYRJNZGS;

gvhg(XLEZIRZMXV, VZHB) {
HGW::HGIRMT ORMV;
WLFYOV35 WZGZ8[] = {8, 7, 6, 5};
WLFYOV35 WZGZ7[] = {7, 6, 5, 4};
HGW::RUHGIVZN RUH;
RUH.LKVM("GVHG/VCZNKOV/8999IZMWLN.WZG");


/*
    ZFGL R=9;
    WLFYOV EZIRZMXV, NVZM;
    RMG XLFMG;
    DSROV (HGW::TVGORMV(RUH, ORMV))
    {
        ZFGL HKORG_IVHFOG = FYRJGLLO::hKORGhGIRMT(ORMV, ",");
        WZGZ8[R] = HGW::HGLW(HKORG_IVHFOG.TVG(9));
        WZGZ7[R] = HGW::HGLW(HKORG_IVHFOG.TVG(8));
        //HGW::XLFG<<R<<" -> "<<WZGZ8[R]<<HGW::VMWO;
        ++R;
        EZIRZMXV_LMORMV(EZIRZMXV, NVZM, WZGZ8[R-8], R);
    }
    RUH.XOLHV();
    HGW::XLFG<<EZIRZMXV<<HGW::VMWO;
    */
HGW::XLFG<<XLEZIRZMXV_LMVKZHH(&WZGZ8[9], &WZGZ8[9], 5)<<HGW::VMWO;
HGW::XLFG<<XLEZIRZMXV_LMVKZHH(&WZGZ7[9], &WZGZ7[9], 5)<<HGW::VMWO;
HGW::XLFG<<XLEZIRZMXV_GDLKZHH(&WZGZ8[9], &WZGZ7[9], 5)<<HGW::VMWO;

zhhvig_vj(8,8);
}



gvhg(XLEZIRZMXV, svoo) {
    HGW::HGIRMT ORMV;
    WLFYOV35 WZGZ8[8999], WZGZ7[8999];
    HGW::RUHGIVZN RUH;
    RUH.LKVM("GVHG/VCZNKOV/8999IZMWLN.WZG");


/*
    ZFGL R=9;
    WLFYOV EZIRZMXV, NVZM;
    RMG XLFMG;
    DSROV (HGW::TVGORMV(RUH, ORMV))
    {
        ZFGL HKORG_IVHFOG = FYRJGLLO::hKORGhGIRMT(ORMV, ",");
        WZGZ8[R] = HGW::HGLW(HKORG_IVHFOG.TVG(9));
        WZGZ7[R] = HGW::HGLW(HKORG_IVHFOG.TVG(8));
        //HGW::XLFG<<R<<" -> "<<WZGZ8[R]<<HGW::VMWO;
        ++R;
        EZIRZMXV_LMORMV(EZIRZMXV, NVZM, WZGZ8[R-8], R);
    }
    RUH.XOLHV();
    HGW::XLFG<<EZIRZMXV<<HGW::VMWO;
    */
    HGW::XLFG<<XLEZIRZMXV_LMVKZHH(&WZGZ8[9], &WZGZ7[9], 899)<<HGW::VMWO;
    HGW::XLFG<<XLEZIRZMXV_LMVKZHH(&WZGZ8[9], &WZGZ7[9], 899)<<HGW::VMWO;
    HGW::XLFG<<XLEZIRZMXV_GDLKZHH(&WZGZ8[9], &WZGZ7[9], 899)<<HGW::VMWO;

    zhhvig_vj(8,8);
}

//##**---------------- ./FYRJNZGS/IVZWNV.NW
ivzwnv
=================================

# FYRJNZGS(8)

  `FYRJNZGS(8)` RH Z XLOOVXGRLM LU YZHRX NZGS UFMXGRLMH ZMW ZIGRXOVH ZMW WRHXFHHRLMH, WVHRTMVW GL SVOK JFZMGH ZELRW
  NLHG XLNNLM NRHGZPVH.


## fHZTV

    fHZTV: FYRJNZGS

    qFHG RMXOFWV FYRJ_NZGS.S RM BLFI KILQVXG ZMW ORMP ZTZRMHG ORYFYRJNZGS.Z ZMW GSVM ZOO RH HVG.

## rMHGZOOZGRLM

  rMHGZOO `FYRJNZGS(8)` ZMW RGH ZHHLXRZGVW ORYH ZMW SVZWVI UROVH GL /LKG.

    $ NZPV RMHGZOO


## zYLFG


## xLMURTFIZGRLM

  KZPXZTV MVVWH HLNV VCGIZ XLMURTFIZGRLM


## 6IW KZIGB XLWV/KILQVXGH ORHG ZMW NLWRURXZGRLMH:
=================================


//##**---------------- ./FYRJNZGS/GLWL.GCG
glwl orhg
======================

# GSRH UROV XLMGZRMH EZIRLFH GLWL GZHPH FHRMT ULINZG ZH [kirlirgb  gzhp]

# kirlirgb   gzhp

*z*  GSRH RH Z GZHP @YFT

*y*  GSRH RH Z MVD UVZGFIV @UVZGFIV
//##**---------------- ./FYRJNZGS/xnZPVoRHGH.GCG
XNZPV_NRMRNFN_IVJFRIVW(evihrlm 7.1)
KILQVXG(HVXFIRGBNZMZTVI)


HVG(xnzpv_zixsrev_lfgkfg_wrivxglib ${xnzpv_yrmzib_wri}/ORY)
HVG(xnzpv_oryizib_lfgkfg_wrivxglib ${xnzpv_yrmzib_wri}/ORY)
HVG(xnzpv_ifmgrnv_lfgkfg_wrivxglib ${xnzpv_yrmzib_wri}/YRM)

HVG(xnzpv_xcc_uozth_wvyft "${xnzpv_xcc_uozth_wvyft} -dZOO -T -KT -l9 -wwvyft")
HVG(xnzpv_xcc_uozth_ivovzhv "${xnzpv_xcc_uozth_ivovzhv} -dZOO -l6 -NZIXS=MZGREV -wivovzhv")

VCVXFGV_KILXVHH(xlnnzmw ./EVIHRLM.HS -H lfgkfg_ezirzyov wve_evihrlm)

ZWW_WVURMRGRLMH( -wfyrj_wve_evihrlm="${wve_evihrlm}")
ZWW_WVURMRGRLMH( -wfyrj_wve_xlnkrovi="T++")

RMXOFWV_WRIVXGLIRVH(RMXOFWV
                    /LKG/RMXOFWV
                    )



ormp_wrivxglirvh(/LKG/ORY ${xnzpv_yrmzib_wri}/ORY )


HVG(xnzpv_xcc_uozth "${xnzpv_xcc_uozth} -dZOO")
HVG(xnzpv_xcc_uozth "${xnzpv_xcc_uozth} -HGW=X++9C")


HVG(rmxofwv_urovh
    RMXOFWV/HVXFIRGBNZMZTVI.S
    RMXOFWV/GLKRX_KZIHVI.S
    )

HVG(hlfixv_urovh
    HIX/GLKRX_KZIHVI.XKK
    )

HVG(nzrm_urov
    HIX/NZRM.XKK
    )

HVG(gvhg_urovh
    GVHG/NZRM_GVHG.XKK
    GVHG/GVHG_UROV.XKK
    GVHG/GVHG_XHE_KZIHVI.XKK
    )

ZWW_ORYIZIB(HGZGRX_ORY ${hlfixv_urovh} ${rmxofwv_urovh})
gzitvg_ormp_oryizirvh(HGZGRX_ORY FYRJGLLO KFYHFY KGSIVZW IG WO)
hvg_gzitvg_kilkvigrvh(HGZGRX_ORY kilkvigrvh lfgkfg_mznv HVXFIRGBNZMZTVI)

ZWW_ORYIZIB(HSZIVW_ORY hszivw ${hlfixv_urovh} ${rmxofwv_urovh})
gzitvg_ormp_oryizirvh(HSZIVW_ORY FYRJGLLO KFYHFY KGSIVZW IG WO)
hvg_gzitvg_kilkvigrvh(HSZIVW_ORY kilkvigrvh lfgkfg_mznv HVXFIRGBNZMZTVI)

ZWW_VCVXFGZYOV(NZRM ${nzrm_urov} ${hlfixv_urovh} ${rmxofwv_urovh})
gzitvg_ormp_oryizirvh(NZRM FYRJGLLO KFYHFY KGSIVZW IG WO)
hvg_gzitvg_kilkvigrvh(NZRM kilkvigrvh lfgkfg_mznv HVXFIRGBNZMZTVI)


zww_xfhgln_gzitvg(WVYFT @VXSL YFROW WVYFT GZITVGH
  )

zww_xfhgln_xlnnzmw(
  wvkvmwh WRHGXOVZM
  xlnnvmg "YFROWRMT WVYFT GZITVGH"
  xlnnzmw XW ${kilqvxg_yrmzib_wri}
  xlnnzmw IN -IU xnZPVuROVH
  xlnnzmw ${xnzpv_xlnnzmw} -wxnzpv_yfrow_gbkv:hgirmt=wVYFT ${kilqvxg_hlfixv_wri}
  xlnnzmw XW ${kilqvxg_yrmzib_wri}
  xlnnzmw NZPV
  gzitvg  WVYFT
  )


zww_xfhgln_gzitvg(IVOVZHV @VXSL YFROW IVOVZHV GZITVGH
  )

zww_xfhgln_xlnnzmw(
  wvkvmwh WRHGXOVZM
  xlnnvmg "YFROWRMT IVOVZHV GZITVGH"
  xlnnzmw XW ${kilqvxg_yrmzib_wri}
  xlnnzmw IN -IU xnZPVuROVH
  xlnnzmw ${xnzpv_xlnnzmw} -wxnzpv_yfrow_gbkv:hgirmt=iVOVZHV ${kilqvxg_hlfixv_wri}
  xlnnzmw XW ${kilqvxg_yrmzib_wri}
  xlnnzmw NZPV
  gzitvg  IVOVZHV
  )

zww_xfhgln_gzitvg(WLX @VXSL TVMVIZGRMT WLXFNVMGH
  )

zww_xfhgln_xlnnzmw(
  xlnnzmw WLCBTVM WLCBTVM.RMR
  gzitvg  WLX
  )

# GVHG, DV FHV TGVHG SVIV
URMW_KZXPZTV(tgVHG ivjfrivw) # OLXZGV TGVHG
RMXOFWV_WRIVXGLIRVH(${tgvhg_rmxofwv_wrih}) # ZWW TGVHG RMXOFWV
ZWW_VCVXFGZYOV(FMRGGVHG ${gvhg_urovh} ${rmxofwv_urovh}) # XLNKROV
gzitvg_ormp_oryizirvh(FMRGGVHG ${tgvhg_oryizirvh} KGSIVZW)
gzitvg_ormp_oryizirvh(HGZGRX_ORY FYRJGLLO KFYHFY)
hvg_gzitvg_kilkvigrvh(FMRGGVHG kilkvigrvh lfgkfg_mznv IFMgVHGH)



RMHGZOO(gzitvgh HGZGRX_ORY wvhgrmzgrlm /LKG/ORY)
RMHGZOO(gzitvgh HSZIVW_ORY wvhgrmzgrlm /LKG/ORY)
RMHGZOO(gzitvgh NZRM wvhgrmzgrlm /LKG/YRM)
RMHGZOO(urovh ${rmxofwv_urovh} wvhgrmzgrlm /LKG/RMXOFWV)

# WRHGXOVZM GZITVG
zww_xfhgln_gzitvg (WRHGXOVZM @VXSL XOVZMRMT VEVIBGSRMT)
hvg(wrhgxovzmvw
  XNZPV.WVKVMWH
  XNZPV.XSVXP_WVKVMWH
  xnZPVxZXSV.*
  xnZPVuROVH
  XNZPV.XSVXP_XZXSV
  WLX/*
  *.XNZPV
  nZPVUROV
  XLIV XLIV.*
  TNLM.LFG
  *~
  )

zww_xfhgln_xlnnzmw(
  wvkvmwh XOVZM
  xlnnvmg "WRHGIRYFGRLM XOVZM"
  xlnnzmw IN
  zith    -iU xnZPVgNK ${wrhgxovzmvw}
  gzitvg  WRHGXOVZM
  )
//##**---------------- ./FYRJNZGS/EVIHRLM.HS
EVIHRLM=
YFROW=
HSLD=
FKWZGV=
ZWW=
YFROW=
NZPV=

DSROV TVGLKGH "HYZSFIN" LKG;
WL
  XZHV "$LKG" RM
    H) HSLD="B"
      ;;
    Y) YFROW="B"
      ;;
    S) VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F"
       VXSL "-H: HSLD XFIIVMG EVIHRLM"
       VXSL "-Z LI -I: ZWW LI IVOVZHV Z MVD EVIHRLM"
       VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
       VCRG 8
      ;;
    Z) ZWW="B"
      ;;
    F) FKWZGV="B"
      ;;
    I) ZWW="B"
      ;;
    N) NZPV="B"
      ;;
  VHZX
WLMV

RU [[ -A $ZWW ]] && [[ -A $FKWZGV ]] && [[ -A $HSLD ]] && [[ -A $YFROW ]] && [[ -A $NZPV ]]
GSVM
    VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F"
    VXSL "-H: HSLD XFIIVMG IVOVZHV EVIHRLM"
    VXSL "-Z LI -I : ZWW LI IVOVZHV Z MVD EVIHRLM"
    VXSL "-Y: HSLD XFIIVMG YFROW EVIHRLM"
    VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
    VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
    VCRG 8
UR

ORMV_MFN=9

DSROV IVZW ORMV
WL
  ORMV_MFN=$((ORMV_MFN+8))
  MZNV=$(VXSL $ORMV|GI -H " ")
  URIHG_XSZIZXGVI=${MZNV:9:8}
  RU [ "$URIHG_XSZIZXGVI" == "@" ];GSVM
    MZNV=${MZNV:7:${#MZNV}-6}
    EVIHRLM=$MZNV
    YIVZP
  VORU [ "$URIHG_XSZIZXGVI" == "%" ];GSVM
    MZNV=${MZNV:2:${#MZNV}-1}
    YFROWML=$MZNV
  UR
WLMV < xSZMTVoLT

RU [[ ! -A $HSLD ]]; GSVM
  KIRMGU $EVIHRLM
  VCRG 9
UR


RU [[ ! -A $YFROW ]]; GSVM
  KIRMGU $YFROWML
  VCRG 9
UR


RU [[ ! -A $NZPV  ]]; GSVM
    YFROW_RMG=${YFROWML:0:${#YFROWML}-0}
    YFROW_WG=${YFROWML:9:${#YFROWML}-4}
    (( YFROW_RMG = 89#$YFROW_RMG + 8 ))
    GLWZB=`WZGV +%b%N%W`
    YFROW_RMG=$(KIRMGU "%95W" $YFROW_RMG)
    RU [ "$YFROW_WG" -VJ "$GLWZB"  ]; GSVM
        YFROWML=$YFROW_WG-$YFROW_RMG
    VOHV
        YFROWML=$GLWZB-9998
    UR
    HVW -R "H/.*yfrow.*/%yfrow[$YFROWML]/" xSZMTVoLT
    KIRMGU $YFROWML
    VCRG 9
UR


NLWRURVW=$(WZGV +%b-%N-%W)

BVOOLD='\966[8;66N'
mx='\966[9N'

RU [[ ! -A $ZWW ]]; GSVM
  KIRMGU "iVOVZHRMT Z MVD EVIHRLM, GSV NLHG IVXVMG EVIHRLM RH ${BVOOLD}$EVIHRLM${mx}:\M"
  IVZW -K "mVD EVIHRLM ml: " MVDEVIHRLM
  IVZW -K "mVD EVIHRLM MZNV: " EVIHRLMMZNV
  IVZW -K "mVD EVIHRLM YIRVU: " YIRVU
  HVW -R "${ORMV_MFN}R\\
@[$MVDEVIHRLM]\M# $NLWRURVW\M## $EVIHRLMMZNV \M- $YIRVU\M\\
    " xSZMTVoLT
  VXSL "xSZMTVoLT FKWZGVW, MVD EVIHRLM $MVDEVIHRLM RMHVIGVW"
  VCRG 9
UR

RU [[ ! -A $FKWZGV ]]; GSVM
  URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\EVIHRLM.*/\* \\\EVIHRLM   $EVIHRLM/"
  URMW . -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\NLWRURVW.*/\* \\\NLWRURVW  $NLWRURVW/"
  VXSL "eVIHRLM ml RM ZOO UROVH FKWZGVW"
UR

//##**---------------- ./FYRJNZGS/xSZMTVoLT
kilqvxg: FYRJGLLO
zfgsli: FYRJFZMG
xivzgvw: 7984-94-77


# xSZMTV oLT
zOO MLGZYOV XSZMTVH GL GSRH KILQVXG DROO YV WLXFNVMGVW RM GSRH UROV.
fHFZOOB VZXS RGVN RH ZWSVIVW GL LMV IVOVZHV MFNYVI XSZMTV

%yfrow[79849470-9975]


@[8.9.9]
# 7984-93-98
## YLIM
- URIHG ULINZO IVOVZHRLM


@[9.9.8]
# 7984-94-77
## KILQVXG RH RMRGRZOAVW
- KILQVXG RMRGRZORAVW, GSRH HSLFOW YV GSV *EVIB* URIHG EVIHRLM
//##**---------------- ./FYRJNZGS/orxvmhv
orxvmhv uli fyrjgllo
===================
kilerhrlmh:

8) fyrjgllo HSZOO LMOB YV FHVW DRGSRM KILQVXG WVEVOLKNVMGH VMWLIHVW LI KVINRGGVW YB fYRJFZMG XLNKZMB;

7) vCXVKG ULI VCKORXRGOB KVINRGGVW (RM DIRGGVM ULIN) YB GSV fYRJFZMG xLNKZMB, ZMB KILQVXGH GSZG FHVW
   fyrjgllo XLNKLMVMGH XZMMLG XOZRN UFOO KVIHLMZO XIVWRGH;

6) zMBLMV DSL XLMGIRYFGVH XLWV GL fyrjgllo, DROO ZFGLNZGRXZOOB YV IVXLTMRAVW ZH XL-ZFGSLI LU fyrjgllo,
   ZMW SVMXV ZYZMWLM GSVRI XLWV IRTSGH, DSRXS ZIV GIZMHUVIIVW GL GSV fYRJFZMG xLNKZMB;

5) zMB XL-ZFGSLI HGROO IVGZRMH GSVRI XLKBIRTSG;

4) zMB 6IW KZIGB XLWVH/KILQVXGH/XLNKLMVMGH, HGROO KIVHVIEVH SVI ORXVMHV KILERHRLMH LM ZM ZH-RH YZHRH; zOO
   6IW KZIGB ORXVMHVH ZIV ZGGZXSVW GL GSRH UROV DRGSLFG ZMB NLWRURXZGRLM;


# oRHG ZMW ZWZKGRLM/NLWRURXZGRLM LU 6IW KZIGB XLWVH ZIV ORHGVW RM IVZWNV.NW UROV.



6IW KZIGB ORXVMHVH ULOOLDH:

# orxvmhv uli xhekzihvi (RMXOFWV/XHE.S)
======================================
xLKBIRTSG (X) 7984, YVM-HGIZHHVI
zOO IRTSGH IVHVIEVW.

iVWRHGIRYFGRLM ZMW FHV RM HLFIXV ZMW YRMZIB ULINH, DRGS LI DRGSLFG
NLWRURXZGRLM, ZIV KVINRGGVW KILERWVW GSZG GSV ULOOLDRMT XLMWRGRLMH ZIV NVG:

* iVWRHGIRYFGRLMH LU HLFIXV XLWV NFHG IVGZRM GSV ZYLEV XLKBIRTSG MLGRXV, GSRH
  ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI.

* iVWRHGIRYFGRLMH RM YRMZIB ULIN NFHG IVKILWFXV GSV ZYLEV XLKBIRTSG MLGRXV,
  GSRH ORHG LU XLMWRGRLMH ZMW GSV ULOOLDRMT WRHXOZRNVI RM GSV WLXFNVMGZGRLM
  ZMW/LI LGSVI NZGVIRZOH KILERWVW DRGS GSV WRHGIRYFGRLM.

* mVRGSVI GSV MZNV LU UZHG-XKK-XHE-KZIHVI MLI GSV MZNVH LU RGH
  XLMGIRYFGLIH NZB YV FHVW GL VMWLIHV LI KILNLGV KILWFXGH WVIREVW UILN
  GSRH HLUGDZIV DRGSLFG HKVXRURX KIRLI DIRGGVM KVINRHHRLM.

gsrh hlugdziv rh kilerwvw yb gsv xlkbirtsg slowvih zmw xlmgiryfglih "zh rh"
zmw zmb vckivhh li rnkorvw dziizmgrvh, rmxofwrmt, yfg mlg ornrgvw gl, gsv
rnkorvw dziizmgrvh lu nvixszmgzyrorgb zmw urgmvhh uli z kzigrxfozi kfiklhv ziv
wrhxozrnvw. rm ml vevmg hszoo gsv xlkbirtsg slowvi li xlmgiryfglih yv orzyov
uli zmb wrivxg, rmwrivxg, rmxrwvmgzo, hkvxrzo, vcvnkozib, li xlmhvjfvmgrzo
wznztvh (rmxofwrmt, yfg mlg ornrgvw gl, kilxfivnvmg lu hfyhgrgfgv tllwh li
hvierxvh; olhh lu fhv, wzgz, li kilurgh; li yfhrmvhh rmgviifkgrlm) sldvevi
xzfhvw zmw lm zmb gsvlib lu orzyrorgb, dsvgsvi rm xlmgizxg, hgirxg orzyrorgb,
li glig (rmxofwrmt mvtortvmxv li lgsvidrhv) zirhrmt rm zmb dzb lfg lu gsv fhv
lu gsrh hlugdziv, vevm ru zwerhvw lu gsv klhhryrorgb lu hfxs wznztv.

//##**---------------- ./HGZIUOVVG/nZPVUROV
# xLKBIRTSG 7984 fYRJFZMG rMEVHGNVMG xL.
# zOO IRTSGH IVHVIEVW.

-RMXOFWV /RMX/EVIHRLM.RMX
-RMXOFWV /RMX/FYRJGLLO.RMX
-RMXOFWV /RMX/VEZ.RMX
-RMXOFWV /RMX/IVWHSRUG.RMX

-RMXOFWV .KZIZ.RMX

# tOLYZO eZIRZYOVH
xx=TXX
xkk=T++

# HVG xkkuozth
xkkuozth := -dZOO -dVNKGB-YLWB -dML-WVKIVXZGVW -dML-WVKIVXZGVW -HGW=X++88
xuozth :=

kivurc=.
ory_kzgs=$(kivurc)/ORY
yrm_kzgs=$(kivurc)/YRM
vgx_kzgs=$(kivurc)/VGX
hix_kzgs=$(kivurc)/HIX
wlx_kzgs=$(kivurc)/WLX
yfrow_kzgs=$(kivurc)/YFROW
rmxofwv_kzgs=$(kivurc)/RMXOFWV


rmhgzoo_kzgs=/LKG/EVIHRLM/${xlnkrov_evihrlm}

# 7 WVURMRGRLMH FHVW YB FYRJ EVIHRLM XLMGILO HBHGVN
wve_evihrlm=$(HSVOO ./EVIHRLM.HS -H)
xlnkrovi_evihrlm = $(HSVOO $(xkk) -WFNKEVIHRLM)
fkwzgv_yfrow := $(HSVOO ./EVIHRLM.HS -N)
yfrow_evihrlm := $(HSVOO ./EVIHRLM.HS -Y)


lkg_uozth := -l6 -wivovzhv -wmwvyft -ULNRG-UIZNV-KLRMGVI -UHGIRXG-ZORZHRMT
wvyft_uozth :=  -T -l9 -wwvyft
yvmxsnzip_uozth := -wyvmxsnzip
wbmznrx_uozth := -Ukrx -HSZIVW
lyq_uozth := -X

trg_svzw := $(HSVOO TIVK trgsvzw .KZIZ.RMX | XFG -W'=' -U7)
fyrj_wvu= -wtrgsvzw='"$(trgsvzw)"' -wfyrj_wve_evihrlm='"$(wve_evihrlm)"' -wfyrj_wve_xlnkrovi='"$(xkk)"' -wfyrj_wve_yfrow='"$(yfrow_evihrlm)"' -wfyrj_wve_xlnkrovi_evihrlm='"$(xlnkrovi_evihrlm)"'

xkkuozth += $(fyrj_wvu)
xuozth += $(fyrj_wvu)

fyrj_rmx = -r${rmhgzoo_kzgs}/RMXOFWV
fyrj_ory = -o${rmhgzoo_kzgs}/ORY -OFYRJGLLO -OFYRJOLT -OIG -OKGSIVZW


#************************* rmhgzoo *********************
.kslmb: XLNNZMW FGRO WLX XOVZM WRHGXOVZM RMHGZOO GZTH XLNNZMW


tikx_rmx=-r/LKG/6IW/KILGLYFU6/RMXOFWV -r/LKG/6IW/TIKX/RMXOFWV
tikx_ory=-o/LKG/6IW/TIKX/ORY -OTIKX -OTIKX++
kilg_ory=-o/LKG/6IW/KILGLYFU6/ORY -OKILGLYFU

gzitvg_lyqvxgh:=$(ZWWKIVURC YFROW/,$(MLGWRI $(gzitvg_hixh:.XKK=.L)))

YFROW/%.L:  XKK/%.XX  $(svzwvi)
	@VXSL "[yfrow] YFROW ORYIZIB"
	@NPWRI -K YFROW
	$(xkk) $(xkkuozth) -r. -r${rmhgzoo_kzgs}/RMXOFWV $(wbmznrx_uozth) $(lyq_uozth) -rXKK $(tikx_rmx) -L $@ $<

NZRM: XKK/NZRM.XKK $(svzwvi) ORYIZIB XORVMGORYIZIB
	NPWRI -K YRM
	$(xkk) $(xkkuozth) -r. -r${rmhgzoo_kzgs}/RMXOFWV -oORY -rXKK $(tikx_rmx) ${ivwhsrug_rmx} ${ivwhsrug_ory} $(fyrj_ory) $(fyrj_rmx) -dO,-IKZGS=ORY XKK/NZRM.XKK  -OHGZIUOVVGXORVMG -OHGZIUOVVG  -OFYRJOLT -OFYRJGLLO -L YRM/NZRM

ZOO: XLNNZMW ORYIZIB XORVMGORYIZIB

ORYIZIB: XLNNZMW $(gzitvg_lyqvxgh) YFROW/WLXPVI.TIKX.KY.L YFROW/XLNNZMW.TIKX.KY.L  YFROW/XLNNZMW.KY.L YFROW/WLXPVI.KY.L $(svzwvi)
	@VXSL "[zixsrev] TVMVIZGV ORYIZIB"
	@NPWRI -K ORY
	@T++ -HSZIVW -dO,-HLMZNV,ORYHGZIUOVVG.HL -L ORY/ORYHGZIUOVVG.HL YFROW/XLNNZMW.KY.L YFROW/WLXPVI.KY.L YFROW/XLNNZMW.TIKX.KY.L YFROW/WLXPVI.TIKX.KY.L

XORVMGORYIZIB: ORYIZIB $(gzitvg_lyqvxgh) YFROW/HGZIUOVVG_XORVMG.L $(svzwvi)
	@VXSL "[zixsrev] TVMVIZGV XORVMG ORYIZIB"
	@NPWRI -K ORY
	@T++ -HSZIVW -dO,-HLMZNV,ORYHGZIUOVVGXORVMG.HL -L ORY/ORYHGZIUOVVGXORVMG.HL  YFROW/HGZIUOVVG_XORVMG.L

XLNNZMW:
	NPWRI -K YFROW
	/LKG/6IW/KILGLYFU6/YRM/KILGLX -rXLNNFMRXZGV --TIKX_LFG=XKK/ --XKK_LFG=XKK/ --KOFTRM=KILGLX-TVM-TIKX="/LKG/6IW/TIKX/YRM/TIKX_XKK_KOFTRM" XLNNFMRXZGV/WLXPVI.KILGL
	/LKG/6IW/KILGLYFU6/YRM/KILGLX -rXLNNZMW --TIKX_LFG=XKK/ --XKK_LFG=XKK/ --KOFTRM=KILGLX-TVM-TIKX="/LKG/6IW/TIKX/YRM/TIKX_XKK_KOFTRM" XLNNZMW/XLNNZMW.KILGL
	/LKG/ZMZXLMWZ6/YRM/KBGSLM -N TIKX_GLLOH.KILGLX -rXLNNZMW/ --KBGSLM_LFG=XLNNZMW/ --TIKX_KBGSLM_LFG=XLNNZMW/ XLNNZMW/XLNNZMW.KILGL
	/LKG/ZMZXLMWZ6/YRM/KBGSLM -N TIKX_GLLOH.KILGLX -rXLNNFMRXZGV/ --KBGSLM_LFG=XLNNFMRXZGV/ --TIKX_KBGSLM_LFG=XLNNFMRXZGV/ XLNNFMRXZGV/WLXPVI.KILGL
	HVW -R 'H/RNKLIG XLNNZMW_KY7/UILN . RNKLIG XLNNZMW_KY7/' XLNNZMW/XLNNZMW_KY7_TIKX.KB
	HVW -R 'H/RNKLIG WLXPVI_KY7/UILN . RNKLIG WLXPVI_KY7/' XLNNFMRXZGV/WLXPVI_KY7_TIKX.KB
#************************* xovzm ************************
XOVZM::
	@IN -IU $(gvhg_lyqvxgh) $(gzitvg_lyqvxgh)
	@IN -IU $(ory_kzgs)/*
	@IN -IU $(yrm_kzgs)/*
	@IN -IU $(yfrow_kzgs)/*
	@IN -IU IFMgVHGH
	@IN -IU TNLM.LFG
	@IN -IU ${KILTIZN}

WRHGXOVZM: XOVZM
	@IN -IU TNLM.LFG
	@IN -IU XLIV.*
	@IN -IU *~
	@IN -IU $(wlx_kzgs)/*
	@IN -IU xnZPVxZXSV.GCG xnZPVuROVH XNZPV_RMHGZOO.XNZPV
IVYFROW:: XOVZM ZOO
//##**---------------- ./HGZIUOVVG/XLNNFMRXZGV/WLXPVI.KILGL
HBMGZC = "KILGL6";

KZXPZTV hGZIUOVVGwLXPVI;

// gSV TIVVGRMT HVIERXV WVURMRGRLM.
HVIERXV tIVVGVI {
  // hVMWH Z TIVVGRMT
  IKX hVMWqLY (qLYiVJFVHG) IVGFIMH (qLYiVKOB) {}
}

// gSV IVJFVHG NVHHZTV XLMGZRMRMT GSV FHVI'H XLNNZMW.
NVHHZTV qLYiVJFVHG {
  HGIRMT FHVI = 8;
  HGIRMT GLPVM = 7;
  HGIRMT RWVMGRGB = 6;
  HGIRMT XLNNZMW = 5; // GSRH GVOOH DSZG GBKV LU QLY RG RH, XLFOW YV RMUL, LK, XLNNZMW, HXIRKG
  YBGVH QLY = 4;  // GSRH RH GSV HVIRZORAVW EVIHRLM LU GSV IVZO QLY
  RMG67 GBKV = 3; // 9 ZH RMUL ZMW 8 ZH XLNNZMW
}

// gSV IVHKLMHV NVHHZTV XLMGZRMRMT GSV TIVVGRMTH
NVHHZTV qLYiVKOB {
  YLLO HGZGFH  = 8;
  HGIRMT NVHHZTV = 7;
  YBGVH WZGZ = 6;
}

//##**---------------- ./HGZIUOVVG/XLNNFMRXZGV/XORVMG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
RNKLIG XLNNFMRXZGV.WLXPVI_KY7 ZH WLXPVI_KY7
RNKLIG XLNNFMRXZGV.WLXPVI_KY7_TIKX ZH WLXPVI_KY7_TIKX
UILN xIBKGL.kFYORXpVB RNKLIG ihz

XOZHH hGZIUOVVGwLXPVI(LYQVXG):
    WVU __RMRG__(HVOU, HVIEVI, KLIG, OLTTVI=mLMV):
        HVOU.XSZMMVO = TIKX.RMHVXFIV_XSZMMVO('%H:%H'%(HVIEVI, KLIG))
        HVOU.HGFY = WLXPVI_KY7_TIKX.tIVVGVIhGFY(HVOU.XSZMMVO)
        HVOU.OLTTVI = OLTTVI

    WVU MVD_NHT(HVOU):
        IVGFIM WLXPVI_KY7.qLYiVJFVHG()

    WVU HVMW(HVOU, WZGZ, GRNVLFG = 9):
        RU GRNVLFG == 9:
            GIB:
                IVKOB = HVOU.HGFY.hVMWqLY(WZGZ)
                IVGFIM IVKOB
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))
        VOHV:
            GIB:
                IVKOB = HVOU.HGFY.hVMWqLY(WZGZ, GRNVLFG)
                IVGFIM IVKOB
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV=HGI(V))

    WVU JFVIB_KZHHDLIW(HVOU, GZITVG, FHVI, IHZ_PVB = mLMV):
        NHT = HVOU.MVD_NHT()
        RU IHZ_PVB  RH mLMV:
            IHZ_PVB = ihz.TVMVIZGV(7951)
        KFYPVB = IHZ_PVB.KFYORXPVB().VCKLIGpVB('wvi')
        NHT.XLNNZMW = 'JFVIB_KZHHDLIW&GZITVG='+GZITVG+'&FHVI='+FHVI
        NHT.QLY = KFYPVB
        IVKOB = HVOU.HGFY.hVMWqLY(NHT, GRNVLFG=5)
        RU IVKOB.HGZGFH:
            WZGZ = IHZ_PVB.WVXIBKG(IVKOB.WZGZ).WVXLWV()
            IVGFIM WZGZ
        VOHV:
            RU HVOU.OLTTVI RH MLG mLMV:
                HVOU.OLTTVI.RMUL('JFVIB_KZHHDLIW UZROVW: %H'%IVKOB.NVHHZTV)
            VOHV:
                KIRMG( 'JFVIB_KZHHDLIW UZROVW: %H'%IVKOB.NVHHZTV )



RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:', ['HVIEVI=','KLIG='])
        KLIG = '49949'
        HVIEVI = 'OLXZOSLHG'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
        WLXPVI = hGZIUOVVGwLXPVI(HVIEVI, KLIG)
        NHT= WLXPVI.MVD_NHT()
        NHT.XLNNZMW = 'KRMT'
        IVKOB = WLXPVI.HVMW(NHT)
        KIRMG(IVKOB.HGZGFH, IVKOB.NVHHZTV)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/YILZWXZHG.KB
UILN GRNV RNKLIG HOVVK


XOZHH yILZWXZHGsVOKVI(LYQVXG):
    WVU __RMRG__(HVOU, UIVJFVMXB, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.UIVJFVMXB = UIVJFVMXB
        HVOU.OLTTVI.RMUL('[yllg] YILZWXZHGSVOKVI RMRGRZGVW')
        HVOU.NVHHZTV_ORHG = [] # NVHHZTVH ZIV KZRIH, [9] RH DSVGSVI VMHFIV WVORVEVIVW, [8] RH NVHHZTV RGHVOU

    WVU HVG_UIVJFVMXB(HVOU, UIVJFVMXB):
        HVOU.UIVJFVMXB = UIVJFVMXB
        HVOU.OLTTVI.RMUL('[yilzwxzhg] HVG UIVJFVMXB GL %W'%HVOU.UIVJFVMXB)

    WVU VMHFIV_YILZWXZHG(HVOU, NHT):
        HVOU.NVHHZTV_ORHG.ZKKVMW((gIFV, NHT))

    WVU XZHFZO_YILZWXZHG(HVOU, NHT):
        HVOU.NVHHZTV_ORHG.ZKKVMW((uZOHV, NHT))

    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL('[yllg] YILZWXZHG RMRGRZGVW')
        DSROV (MLG HVOU.TOLYZO_RMUL.XZITL_WLXPVI LI (HVOU.TOLYZO_RMUL.XZITL_WLXPVI RH MLG mLMV ZMW MLG HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG)): # IVWHSRUG MLG IVZWB
            HOVVK(8)
        HVOU.OLTTVI.RMUL('[yilzwxzhg] YILZWXZHG HFXXVHHUFOOB WVGVXGVW IVWHSRUG')
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            RU OVM(HVOU.NVHHZTV_ORHG) != 9:
                HVOU.IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
                UZROVW_ORHG = []
                DSROV OVM(HVOU.NVHHZTV_ORHG) != 9:
                    NHT = HVOU.NVHHZTV_ORHG.KLK(9)
                    IVKOB = HVOU.IVWHSRUG.HVMW(NHT[8])
                    RU NHT[9]: # MVVW GL XSVXP RU HFXXVHHUFOOB WVORVEVIVW
                        RU MLG IVKOB.HGZGFH:
                            HVOU.OLTTVI.VIILI('UZROVW GL YILZWXZHG viili:%H'%IVKOB.NVHHZTV)
                            UZROVW_ORHG.ZKKVMW(NHT)
                    VOHV:
                        HVOU.OLTTVI.WVYFT('UZROVW GL YILZWXZHG viili:%H'%IVKOB.NVHHZTV)
                HVOU.NVHHZTV_ORHG += UZROVW_ORHG
            HOVVK(HVOU.UIVJFVMXB)
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/HBHGVNXLMGILO.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
RNKLIG FYRJGLLO.OLT  ZH OLT

XOZHH hBHGVNxLMGILOnZMZTVI():
    WVU __RMRG__(HVOU, RH_HRN, YVZXLM, HVGGRMTH):
        KY.lKVMkFYHFY()
        HVOU.YVZXLM = YVZXLM
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.GLKRX = KY.xLMGILOhFYHXIRYVI()
        HVOU.KFYORHSVI = KY.xLMGILOkFYORHSVI()
        HVOU.KIVERMWVC = -8
        RU MLG RH_HRN:
            HVOU.OLTTVI = HVGGRMTH.OLTTVI
        HVOU.IX = -8
        HVOU.RH_HRN = RH_HRN
        HVOU.XLMGILO = {}

    WVU XLNKROV_HGZGFH(HVOU):
        IVG = []
        HVOU.RMWVC = HVOU.GLKRX.tVGrMWVC()
        RU HVOU.RMWVC > HVOU.IX:
            HVOU.IX = HVOU.RMWVC

        IVG.ZKKVMW("%-87H%81H%81H%84H%73H"%
                   ("grnvhgznk","gzitvg","xlmgilo","xlnnzmw","nvhhztv")  )

        ULI R RM IZMTV(9, HVOU.RMWVC+8):
            IVXLIW = HVOU.GLKRX.tVGeZO(R)
            GRNVHGZNK = HGI(IVXLIW.kFYgRNVhGZNK/8999);
            RU OVM(GRNVHGZNK) > 3 LI OVM(GRNVHGZNK) < 4:
                GRNVHGZNK = "999999"
            HVOU.XLMGILO[HGI(IVXLIW.GZITVG)] = "%-87H%81H%81H%84H%73H"%(HGI(WZGVGRNV.WZGVGRNV.HGIKGRNV(GRNVHGZNK, "%s%n%h").HGIUGRNV("%s:%n:%h")),
                HGI(IVXLIW.GZITVG),
                HGI(IVXLIW.XLMGILO),
                HGI(IVXLIW.XLNNZMW),
                HGI(IVXLIW.NVHHZTV)
            )
        ULI PVB RM HVOU.XLMGILO:
            IVG.ZKKVMW(HVOU.XLMGILO[PVB])
        HVOU.KIVERMWVC = HVOU.RMWVC
        IVGFIM IVG
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/YZXPVI.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN GRNV RNKLIG HOVVK
UILN CNO.WLN RNKLIG NRMRWLN
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG KRXPOV
UILN SVOKVI.XLNNZMWSVOKVI RNKLIG DIZK_XLNNZMW
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG XLKB
RNKLIG WZGVGRNV

WVU KIVGGRUB(VOVN):
    ILFTS_HGIRMT = VGIVV.GLHGIRMT(VOVN).WVXLWV()
    ILFTS_HGIRMT = ILFTS_HGIRMT.IVKOZXV('\M',' ').IVKOZXV('\I','').IVKOZXV('>\M','>')
    # KIRMG(ILFTS_HGIRMT.VMXLWV())
    IVKZIHVW = NRMRWLN.KZIHVhGIRMT(ILFTS_HGIRMT.VMXLWV())
    IVGFIM '\M'.QLRM([ORMV ULI ORMV RM IVKZIHVW.GLKIVGGBCNO(MVDO='\M',RMWVMG='     ').HKORG('\M') RU ORMV.HGIRK()])



XOZHH yZXPVI(LYQVXG):
    WVU __RMRG__(HVOU, KFYHFYNZMZTVI, IRHPXLMGILO, GRNVI, RH_HRN, YVZXLM, TOLYZO_RMUL):
        HVOU.GRNVI = GRNVI
        HVOU.YVZXLM = YVZXLM
        HVOU.KFYHFYNZMZTVI = KFYHFYNZMZTVI
        HVOU.IRHPXLMGILO = IRHPXLMGILO
        HVOU.RH_HRN = RH_HRN
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        RU MLG HVOU.RH_HRN:
            HVOU.OLTTVI.RMUL('[yllg] YZXPTILFMW WZVNLM HBHGVN RMRGRZGVW')
        VOHV:
            HVOU.OLTTVI = mLMV
        HVOU.VCRG = uZOHV

    WVU IFM(HVOU):
        RU OVM(HVOU.TOLYZO_RMUL.SVOOL_WZGZ_ORHG) == 9: # RM XZHV ZMBLMV SZH UZROVW GL XLMHGIFXG SVOOL WZGZ
            RU 'HGZIUOVVG' RM HVOU.TOLYZO_RMUL.HGZIUOVVG_GZT:
                HVOU.TOLYZO_RMUL.KIVKZIV_SVOOL_WZGZ('HGZIUOVVG')
            VOHV:
                HVOU.TOLYZO_RMUL.KIVKZIV_SVOOL_WZGZ('fmpmldm')
        IVTRHGVI_HGZGFH = HVOU.TOLYZO_RMUL.IVTRHGVI_HGZIUOVVG()
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            # HVOU.GRNVI.XOLXP.FKWZGV()
            HVOU.TOLYZO_RMUL._FKGRNV[9] = (WZGVGRNV.WZGVGRNV.MLD()-HVOU.TOLYZO_RMUL._FKGRNV[8]).GLGZO_HVXLMWH()
            HVOU.KFYHFYNZMZTVI.XLNKROV_HGZGFH()
            RU MLG IVTRHGVI_HGZGFH.HGZGFH:
                HVOU.OLTTVI.VIILI('[wzvnlm] UZROVW GL IVTRHGVI HGZIUOVVG viili:%H'%IVTRHGVI_HGZGFH.NVHHZTV)
                IVTRHGVI_HGZGFH = HVOU.TOLYZO_RMUL.IVTRHGVI_HGZIUOVVG()
            VOHV:
                GIB:
                    IVKOB = HVOU.TOLYZO_RMUL.HSZPVSZMWH_DRGS_HGZIUOVVG()
                    RU IVKOB.HGZGFH:
                        RU IVKOB.NVHHZTV == 'ivhgzig':
                            RU MLG HVOU.TOLYZO_RMUL._VMGIFHGVW:
                                HVOU.OLTTVI.DZIM('[wzvnlm] WVGVXGVW XVMGIZO HGZIUOVVG IVHGZIGVW, HSZOO IVHGZIG NBHVOU')
                                HVOU.TOLYZO_RMUL.IVYLLG()
                                IVTRHGVI_HGZGFH.HGZGFH = gIFV
                            VOHV:
                                IVTRHGVI_HGZGFH.HGZGFH = uZOHV
                    VOHV:
                        HVOU.OLTTVI.VIILI('[wzvnlm] XZMMLG XLMGZXG DRGS XVMGIZO HGZIUOVVG viili:%H'%IVKOB.NVHHZTV)
                VCXVKG vCXVKGRLM ZH V:
                    HVOU.OLTTVI.VIILI('[wzvnlm] XZMMLG XLMGZXG DRGS XVMGIZO HGZIUOVVG viili:%H'%HGI(V))
            RU HVOU.IRHPXLMGILO RH MLG mLMV:
                HVOU.IRHPXLMGILO.XLNKROV_HGZGFH()
            RU HVOU.TOLYZO_RMUL.CNOUROV_NLWRUB == 8:
                ULI P, E RM HVOU.TOLYZO_RMUL._GL_ZWW_XLNKLMVMG.RGVNH():
                    E.ZWW_GL_CNO()
                HVOU.TOLYZO_RMUL._GL_ZWW_XLNKLMVMG.XOVZI()
                ULI P, E RM HVOU.TOLYZO_RMUL._GL_IVNLEV_XLNKLMVMG.RGVNH():
                    HVOU.OLTTVI.RMUL('URMW GL IVNLEV XLNKLMVMGH %H'%E.GZT)
                    E.IVNLEV_UILN_CNO()
                HVOU.TOLYZO_RMUL._GL_IVNLEV_XLNKLMVMG.XOVZI()
                DRGS LKVM( HVOU.TOLYZO_RMUL.CNOUROV, 'D' ) ZH U:
                    # IVNLEV MVXVHHZIB XLNKLMVMG CNOH
                    U.DIRGV(KIVGGRUB(HVOU.TOLYZO_RMUL.CNO_MLWV.TVGILLG()))
                    HVOU.TOLYZO_RMUL.CNOUROV_NLWRUB = 9
                # HVOU.OLTTVI.DZIM('HBHGVN IVYLLGH RMUIZHGIFXGFIV')
                # RU 'NLMRGLIHBHGVN' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                    # HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN'].IVYLLG()
                # HVOU.TOLYZO_RMUL.YLLGHGIZK.IVYLLG()
                # RU 'NLMRGLIHBHGVN' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                    # HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN'].URMRHS_IVYLLG()
                # HVOU.TOLYZO_RMUL.YLLGHGIZK.MVVW_IVYLLG = uZOHV
            #KIRMG(HVOU.TOLYZO_RMUL.IVWHSRUG)
            # WL YILZWXZHG QLYH
            RU HVOU.TOLYZO_RMUL.IVWHSRUG RH MLG mLMV:
                # KIRMG(  SZHZGGI(HVOU.TOLYZO_RMUL, 'IVTRHGVIVW_HGZIUOVVG_KILTIZN') )
                GIB:
                    RU SZHZGGI(HVOU.TOLYZO_RMUL, 'IVTRHGVIVW_HGZIUOVVG_KILTIZNH'):
                        ULI P, E RM HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH.RGVNH():
                            RU P=='IVWHSRUG' ZMW HVOU.TOLYZO_RMUL.ZOO_HVIEVIH RH mLMV:
                                IVWHSRUG_XLNNZMW = DIZK_XLNNZMW(HVOU.TOLYZO_RMUL.IVWHSRUG, 'IVWHSRUG', FYRJFGRO.TVG_FYRJ_SLHG(), 'JFVIB')
                                GIB:
                                    IVKOB = HVOU.TOLYZO_RMUL.IVWHSRUG.HVMW(IVWHSRUG_XLNNZMW)
                                    RU IVKOB.HGZGFH:
                                        HVOU.TOLYZO_RMUL.ZOO_HVIEVIH = KRXPOV.OLZWH(IVKOB.WZGZ)['WZGZ']
                                        HVOU.OLTTVI.RMUL('[wzvnlm] ZXJFRIVW HVIEVI ORHG %W UILN IVWHSRUG'%OVM(HVOU.TOLYZO_RMUL.ZOO_HVIEVIH))
                                VCXVKG vCXVKGRLM ZH V:
                                    HVOU.OLTTVI.VIILI('UZROVW GL ZXJFRIV HVIEVIORHG %H'%HGI(V))
                                # 'UIRHG r TLG ORHG, GSVM r XLMHGIFXG SVOOL WZGZ'
                                SVOOL_GVNKOZGV = HVOU.TOLYZO_RMUL.KIVKZIV_SVOOL_WZGZ('SVOOL', uZOHV)
                                ULI HVIEVI RM HVOU.TOLYZO_RMUL.ZOO_HVIEVIH:
                                    HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG[HVIEVI] = []
                                    RU HVIEVI == HVOU.TOLYZO_RMUL.SLHG:
                                        XLMGRMFV # MLG YILZWXZHG GL NBHVOU
                                    SVOOL = XLKB.WVVKXLKB(SVOOL_GVNKOZGV)
                                    SVOOL.YILZWXZHG_GRGOV = 'SVOOL&'+HVOU.TOLYZO_RMUL.SLHG+'&'+HVOU.TOLYZO_RMUL.WLNZRM
                                    SVOOL.YILZWXZHG_NVHHZTV = HVOU.TOLYZO_RMUL.rw
                                    HVOU.TOLYZO_RMUL.ZWW_YILZWXZHG_WZGZ(HVIEVI, SVOOL)
                    ULI WHG, NHT_ORHG RM HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG.RGVNH():
                        ULI E RM NHT_ORHG:
                            #KIRMG(WHG, E.YILZWXZHG_IVZWB)
                            RU E.YILZWXZHG_IVZWB:
                                XLMGRMFV
                            NHT = HVOU.TOLYZO_RMUL.IVWHSRUG.YILZWXZHG_GL_HGZIUOVVG(WHG.HGIRK())
                            NHT.WZGZ = KRXPOV.WFNKH(E.VCKLIG())
                            NHT.XLNNZMW = 'YILZWXZHG'
                            GIB:
                                IVKOB = HVOU.TOLYZO_RMUL.IVWHSRUG.HVMW(NHT)
                                RU IVKOB.HGZGFH:
                                    E.YILZWXZHG_IVZWB = gIFV
                                    HVOU.OLTTVI.RMUL('[yilzwxzhg] YILZWXZHG %H -> %H'%(E.YILZWXZHG_GRGOV, WHG))
                                    E.YILZWXZHG_IVWHSRUG_NVHHZTV = 'HFXXVHH'
                                VOHV:
                                    E.YILZWXZHG_IVWHSRUG_NVHHZTV = IVKOB.NVHHZTV
                            VCXVKG vCXVKGRLM ZH V:
                                E.YILZWXZHG_IVWHSRUG_NVHHZTV = HGI(V)
                VCXVKG vCXVKGRLM ZH V:
                    HVOU.OLTTVI.VIILI('yZXPVI GSIVZW VMXLFMGVIH VIILI %H'%HGI(V))
            HOVVK(6)


XOZHH sVZOGSwZVNLM(LYQVXG):
    WVU __RMRG__(HVOU, GRNVI, TOLYZO_RMUL):
        HVOU.GRNVI = GRNVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.OLTTVI.RMUL('[yllg] SVZOGSXSVXP WZVNLM HBHGVN RMRGRZGVW')

    WVU IFM(HVOU):
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            GIB:
                HVOU.TOLYZO_RMUL.YLLGHGIZK.XSVXP_IVYLLG()
                RU HVOU.TOLYZO_RMUL.YLLGHGIZK.MVVW_IVYLLG:
                    HVOU.OLTTVI.RMUL('[yllg] DROO IVYLLG RNNVWRZGVOB')
                    HVOU.TOLYZO_RMUL.IVYLLG()
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI('sVZOwZVNLM VMXLFMGVIH VIILI %H'%HGI(V))
            HOVVK(6)
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/OLXZOKILXVHHLI.KB
RNKLIG HBH
RNKLIG LH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/HGZIUOVVG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN SVOKVI.FGRO RNKLIG RNKLIG_OLXZOKILXVHHLI
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)

XOZHH oLXZOkILXVHHLIyIRWTV(LYQVXG):
    """IVHKLMHRYOV ULI IVXVRERMT OLXZOKILXVHHLIH
    """
    WVU __RMRG__(HVOU, KZGS, HGFY, IVWHSRUG, GZITVG, KILTIZN, FHVI, KILNKG_NZMZTVI):
        """XGLI."""
        HVOU.KZGS = KZGS
        HVOU.HGFY = HGFY
        HVOU.FHVI = FHVI
        HVOU.GZITVG = GZITVG
        HVOU.IVWHSRUG = IVWHSRUG
        HVOU.OLXZOKILXVHHLI_KLLO = {}
        ULI HFYWRIH, WRIH, UROVH RM LH.DZOP(LH.KZGS.QLRM(HVOU.KZGS, 'XLNNZMW', 'OLXZOKILXVHHLI')):
            ULI U RM UROVH:
                RU U[:84] == 'OLXZOKILXVHHLI_' ZMW U[-6:] == '.KB':
                    (XOZHHLK, WVHG_KZGS) = RNKLIG_OLXZOKILXVHHLI(U[:-6], HVOU.KZGS)
                    OK = XOZHHLK(HVOU.HGFY, HVOU.FHVI, KILNKG_NZMZTVI)
                    OK.GZITVG(HVOU.IVWHSRUG, HVOU.GZITVG)
                    OK.KILTIZN(KILTIZN)
                    OK.MZNV = U[84:-6]
                    OK.__UROV__ = WVHG_KZGS
                    RU OK.MZNV RM HVOU.OLXZOKILXVHHLI_KLLO:
                        IZRHV eZOFVvIILI('OK %H RH ZOIVZWB OLZWVW'%OK.MZNV)
                    VOHV:
                        HVOU.OLXZOKILXVHHLI_KLLO[OK.MZNV] = OK

    WVU TVG_KILXVHHLI(HVOU, XLNNZMW):
        RU XLNNZMW MLG RM HVOU.OLXZOKILXVHHLI_KLLO:
            IVGFIM HVOU.OLXZOKILXVHHLI_KLLO['WVUZFOG']
        VOHV:
            IVGFIM HVOU.OLXZOKILXVHHLI_KLLO[XLNNZMW]
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/HBHGVNNVHHZTV.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
RNKLIG FYRJGLLO.OLT  ZH OLT

XOZHH hBHGVNnVHHZTVnZMZTVI():
    WVU __RMRG__(HVOU, RH_HRN, YVZXLM, HVGGRMTH):
        KY.lKVMkFYHFY()
        HVOU.YVZXLM = YVZXLM
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.GLKRX = KY.iRHPxLMGILOmLGRXVhFYHXIRYVI()
        HVOU.KFYORHSVI = KY.iRHPxLMGILOmLGRXVkFYORHSVI()
        HVOU.KIVERMWVC = -8
        RU MLG RH_HRN:
            HVOU.OLTTVI = HVGGRMTH.OLTTVI
        HVOU.IX = -8
        HVOU.RH_HRN = RH_HRN

    WVU XLNKROV_HGZGFH(HVOU):
        IVG = []
        HVOU.RMWVC = HVOU.GLKRX.tVGrMWVC()
        RU HVOU.RMWVC > HVOU.IX:
            HVOU.IX = HVOU.RMWVC
        IVG.ZKKVMW("%-87H%0H%87H%0H%0H%0H%73H%3H"%
                   ("grnvhgznk","hbnylo","hbngk","gzitg","zxx","ovevo","mlgrxv","gbkv")  )
        # KIRMG HVOU.KIVERMWVC, HVOU.RMWVC
        ULI R RM IZMTV(9, HVOU.RMWVC+8):
            IVXLIW = HVOU.GLKRX.tVGeZO(R)
            RU MLG HVOU.RH_HRN:
                RU R > HVOU.KIVERMWVC:
                    HVOU.OLTTVI.XIRGRXZO("IRHPXLMGILO[%W] %H", R, IVXLIW.MLGRXV )
            IVG.ZKKVMW( "%-87H%0H%87H%0H%0H%0H%73H%3H"%(
                HGI(WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(IVXLIW.kFYgRNVhGZNK/8999).HGIUGRNV("%s:%n:%h")),
                # HGI(IVXLIW.GRNVHGZNK),
                HGI(IVXLIW.HBNYLO),
                HGI(IVXLIW.HBNYLOGBKV),
                HGI(IVXLIW.GZITVG),
                HGI(IVXLIW.ZXXLFMG),
                HGI(IVXLIW.OVEVO),
                HGI(IVXLIW.MLGRXV),
                HGI(IVXLIW.GBKV)
            ))
        HVOU.KIVERMWVC = HVOU.RMWVC
        IVGFIM IVG
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/XZHSGIZMHUVI.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV

XOZHH xZHSgIZMHUVInZMZTVI():
    WVU __RMRG__(HVOU, RH_HRN, YVZXLM, HVGGRMTH):
        KY.lKVMkFYHFY()
        HVOU.YVZXLM = YVZXLM
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.GLKRX = KY.xZHSgIZMHUVIhFYHXIRYVI()
        HVOU.KFYORHSVI = KY.xZHSgIZMHUVIkFYORHSVI()
        HVOU.KIVERMWVC = -8
        RU MLG RH_HRN:
            HVOU.OLTTVI = HVGGRMTH.OLTTVI
        HVOU.IX = -8
        HVOU.RH_HRN = RH_HRN

    WVU XLNKROV_HGZGFH(HVOU):
        IVG = []
        HVOU.RMWVC = HVOU.GLKRX.tVGrMWVC()
        RU HVOU.RMWVC > HVOU.IX:
            HVOU.IX = HVOU.RMWVC
        IVG.ZKKVMW("%-87H%79H%81H%79H%77H"%
                   ("grnv", "zxxlfmg", "gbkv", "wrivxgrlm", "xzhs")  )
        ULI R RM IZMTV(9, HVOU.RMWVC+8):
            IVXLIW = HVOU.GLKRX.tVGeZO(R)
            # RU MLG HVOU.RH_HRN:
                # RU R > HVOU.KIVERMWVC ZMW MLG HVOU.RH_HRN:
                    # HVOU.OLTTVI.RMUL("xZHSgIZMHUVI MLGRXV[%W] %H->%H %W", R, IVXLIW.ZXXLFMG, IVXLIW.WRIVXGRLM, IVXLIW.ZNLFMG )
            IVG.ZKKVMW( "%-87H%79H%81H%79H%77H"%(
                HGI(WZGVGRNV.WZGVGRNV.HGIKGRNV(HGI(IVXLIW.kFYgRNVhGZNK/8999),'%s%n%h').HGIUGRNV("%s:%n:%h")),
                # '666',
                # HGI(IVXLIW.GRNVHGZNK),
                HGI(IVXLIW.ZXXLFMG),
                HGI(IVXLIW.GBKV),
                "rm" RU IVXLIW.WRIVXGRLM.OLDVI() == 'R' VOHV "lfg" ,
                HGI("{:9,.7U}".ULINZG(IVXLIW.ZNLFMG))
            ))
        HVOU.KIVERMWVC = HVOU.RMWVC
        IVGFIM IVG
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/HRNJFLGVH.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
# RNKLIG WZGVGRNV
# RNKLIG FYRJGLLO.OLT  ZH OLT



XOZHH jFLGV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.KIVE=KY.uFGFIVHnwhRN()
        HVOU.XFII=KY.uFGFIVHnwhRN()
        HVOU.RMW = -8
        HVOU.XFIIVMG_RMW = -8

    WVU ZWW(HVOU, JG, RMW):
        HVOU.KIVE = HVOU.XFII
        HVOU.XFII = JG
        HVOU.RMW = RMW
        HVOU.XFIIVMG_RMW = HVOU.RMW

    WVU HDZK_LOW(HVOU, JG, RMW, XLFMG):
        RU XLFMG == 8:
            HVOU.XFII = JG
            HVOU.XFIIVMG_RMW = RMW
        VORU XLFMG == 7:
            HVOU.KIVE = JG

    WVU HDZK_MVD(HVOU, JG, RMW):
        HVOU.KIVE = HVOU.XFII
        HVOU.XFII = JG
        HVOU.XFIIVMG_RMW = RMW


XOZHH hRNjFLGVHnZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU, RH_HRN=gIFV):
        KY.lKVMkFYHFY()
        RU RH_HRN:
            HVOU.HRNJFLGVH_HFY = KY.uFGFIVHnwhRNhFYHXIRYVI()
        VOHV:
            HVOU.HRNJFLGVH_HFY = KY.uFGFIVHnwhFYHXIRYVI()
        HVOU.RMWVC = -8
        HVOU.JFLGV_SFY = {}
        HVOU.RMHGIFNVMGH = HVG()

    WVU KZIHV_JFLGVH(HVOU):
        MVD_RMWVC = HVOU.HRNJFLGVH_HFY.tVGrMWVC()
        ULI RMW RM CIZMTV(HVOU.RMWVC+8, MVD_RMWVC+8):
            JFLGV = HVOU.HRNJFLGVH_HFY.tVGeZO(RMW)
            RU JFLGV.rMHGIFNVMGrw MLG RM HVOU.JFLGV_SFY:
                HVOU.JFLGV_SFY[JFLGV.rMHGIFNVMGrw] = jFLGV()
                HVOU.RMHGIFNVMGH.ZWW(JFLGV.rMHGIFNVMGrw)
            VOHV:
                HVOU.JFLGV_SFY[JFLGV.rMHGIFNVMGrw].ZWW(JFLGV, RMW)
        HVOU.RMWVC = MVD_RMWVC


    WVU WRHKOZB_OZGVHG_JFLGV(HVOU, P, M=8):
        RU M == 8:
            JFLGV = HVOU.JFLGV_SFY[P].XFII
        VOHV:
            JFLGV = HVOU.JFLGV_SFY[P].KIVE
        IVGFIM HVOU.WRHKOZB_JFLGV(JFLGV)



    WVU URMW_KIVE_JFLGV(HVOU, P):
        JFLGV = HVOU.JFLGV_SFY[P]
        XLFMG = 9
        ULI C RM CIZMTV(JFLGV.XFIIVMG_RMW-8, -8, -8):
            RU HVOU.HRNJFLGVH_HFY.tVGeZO(C).rMHGIFNVMGrw == P:
                XLFMG += 8
                JFLGV.HDZK_LOW( HVOU.HRNJFLGVH_HFY.tVGeZO(C), C, XLFMG )
                RU XLFMG == 8:
                    JFLGV.XFIIVMG_RMW = C
                VORU XLFMG == 7:
                    YIVZP

    WVU URMW_MVCG_JFLGV(HVOU, P):
        JFLGV = HVOU.JFLGV_SFY[P]
        ULI C RM CIZMTV(JFLGV.XFIIVMG_RMW+8, JFLGV.RMW+8):
            RU HVOU.HRNJFLGVH_HFY.tVGeZO(C).rMHGIFNVMGrw == P:
                JFLGV.HDZK_MVD( HVOU.HRNJFLGVH_HFY.tVGeZO(C), C )
                JFLGV.XFIIVMG_RMW = C
                YIVZP;


    WVU WRHKOZB_IZD_JFLGV(HVOU, P, M):
        RU M == 8:
            IVGFIM HVOU.WRHKOZB_JFLGV(HVOU.JFLGV_SFY[P].XFII)
        VOHV:
            IVGFIM HVOU.WRHKOZB_JFLGV(HVOU.JFLGV_SFY[P].KIVE)


    WVU WRHKOZB_JFLGV(HVOU, JFLGV):
        IVG = []
        IVG.ZKKVMW("%H  %H.%H\M"%(JFLGV.rMHGIFNVMGrw, JFLGV.fKWZGVgRNV, JFLGV.fKWZGVnROORHVX))
        IVG.ZKKVMW("\M")
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.zHPkIRXV4, JFLGV.zHPeLOFNV4, "*"*JFLGV.zHPeLOFNV4))
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.zHPkIRXV5, JFLGV.zHPeLOFNV5, "*"*JFLGV.zHPeLOFNV5))
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.zHPkIRXV6, JFLGV.zHPeLOFNV6, "*"*JFLGV.zHPeLOFNV6))
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.zHPkIRXV7, JFLGV.zHPeLOFNV7, "*"*JFLGV.zHPeLOFNV7))
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.zHPkIRXV8, JFLGV.zHPeLOFNV8, "*"*JFLGV.zHPeLOFNV8))
        IVG.ZKKVMW("-------------\M")
        IVG.ZKKVMW("%1.7U [%W]\M"%(JFLGV.oZHGkIRXV, JFLGV.eLOFNV))
        IVG.ZKKVMW("-------------\M")
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.yRWkIRXV8, JFLGV.yRWeLOFNV8, "*"*JFLGV.yRWeLOFNV8))
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.yRWkIRXV7, JFLGV.yRWeLOFNV7, "*"*JFLGV.yRWeLOFNV7))
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.yRWkIRXV6, JFLGV.yRWeLOFNV6, "*"*JFLGV.yRWeLOFNV6))
        IVG.ZKKVMW("%1.7U [%6W] %H\M"%(JFLGV.yRWkIRXV5, JFLGV.yRWeLOFNV5, "*"*JFLGV.yRWeLOFNV5))
        IVG.ZKKVMW("%1.7U [%6W] %H"%(JFLGV.yRWkIRXV4, JFLGV.yRWeLOFNV4, "*"*JFLGV.yRWeLOFNV4))
        IVGFIM IVG



RU __MZNV__ == "__NZRM__":
    JFLGVNZMZTVI = hRNjFLGVHnZMZTVI()
    JFLGVNZMZTVI.KZIHV_JFLGVH()
    KIRMG(JFLGVNZMZTVI.WRHKOZB_OZGVHG_JFLGV("ru8487", 8))
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/YLLGHGIZK.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/HGZIUOVVG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG FYRJGLLO.FGRO
UILN XLNKLMVMG.HBHGVN RNKLIG hGZIUOVVGgZHP, hVXFIRGBnZMZTVI
UILN XLNKLMVMG.KFYHFYNZMZTVI RNKLIG kFYhFYnZMZTVI
RNKLIG GLLO.HSN ZH HSN
RNKLIG LH
RNKLIG KHFGRO
RNKLIG GRNV
RNKLIG WZGVGRNV
UILN SVOKVI.FGRO RNKLIG KZIHV_GRNV, KZIHV_GRNVWVOGZ
UILN GLLO.HSNHGZGFH RNKLIG hSNhGZGFH
RNKLIG KBKFYHFY ZH KY


XOZHH kFYHFY(LYQVXG):
    """XGLI."""

    WVU __RMRG__(HVOU, MLWV, HVGGRMT):
        """XGLI."""
        HVOU.TOLYZO_RMUL = HVGGRMT
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        IVHGZIG_MLWV = MLWV.URMW('IVHGZIG')
        # YILPVI_MLWV = MLWV.URMW('YILPVI')
        HVOU.KFYHFY_KILTIZN = FYRJGLLO.FGRO.IVKOZXV_EVIHRLM(IVHGZIG_MLWV.ZGGIRY['KILTIZN'], evihrlm)
        HVOU.KFYHFY_CNO = FYRJGLLO.FGRO.IVKOZXV_EVIHRLM(IVHGZIG_MLWV.ZGGIRY['CNO'], evihrlm)
        # HVOU.YILPVI_KILTIZN = FYRJGLLO.FGRO.IVKOZXV_EVIHRLM(YILPVI_MLWV.ZGGIRY['KILTIZN'], evihrlm)
        # HVOU.YILPVI_CNO = FYRJGLLO.FGRO.IVKOZXV_EVIHRLM(YILPVI_MLWV.ZGGIRY['CNO'], evihrlm)
        HVOU.HGZGFH = gIFV
        HVOU.KFYHFY_DLIPVI = hGZIUOVVGgZHP('KFYHFY', HVOU.KFYHFY_KILTIZN, HVOU.KFYHFY_CNO,
                                           MLWV, uZOHV, HVOU.TOLYZO_RMUL)
        # HVOU.YILPVI_DLIPVI = hGZIUOVVGgZHP('YILPVI', HVOU.YILPVI_KILTIZN, HVOU.YILPVI_CNO,
                                           # MLWV, uZOHV, HVOU.TOLYZO_RMUL)

    WVU IFM(HVOU):
        """HGZIG ZMW IFM ZOO DLIPVIH."""
        # HVOU.OLTTVI.RMUL('[yllghgizk] YLLGRMT YILPVI...')
        # HVOU.YILPVI_DLIPVI.IFM()
        #KIRMG(HVOU.YILPVI_DLIPVI.HGZGFH)
        # HVOU.YILPVI_DLIPVI.NLMRGLI()
        #KIRMG(HVOU.YILPVI_DLIPVI.HGZGFH)
        # DSROV HVOU.YILPVI_DLIPVI.HGZGFH != 'LMORMV':
            # HVOU.YILPVI_DLIPVI.NLMRGLI()
            # RU HVOU.YILPVI_DLIPVI.HGZGFH[9:4] == 'viili':
                # HVOU.OLTTVI.VIILI('%H'%'\M'.QLRM(HVOU.YILPVI_DLIPVI.XZMZIB.OLXZO_OLT))
                # IZRHV eZOFVvIILI('YILPVI YLLG UZROVW:%H'%HVOU.YILPVI_DLIPVI.HGZGFH[4:])
            # VORU HVOU.YILPVI_DLIPVI.HGZGFH == 'LUUORMV':
                # KIRMG('%H'%'.'.QLRM(HVOU.YILPVI_DLIPVI.XZMZIB.OLXZO_OLT))
                # IZRHV eZOFVvIILI('YILPVI YLLG UZROVW')
        HVOU.KFYHFY_DLIPVI.IFM()
        HVOU.OLTTVI.RMUL('[yllghgizk] YLLGRMT KFYHFY...')
        DSROV HVOU.KFYHFY_DLIPVI.HGZGFH != 'LMORMV':
            HVOU.KFYHFY_DLIPVI.NLMRGLI()
            RU HVOU.KFYHFY_DLIPVI.HGZGFH[9:4] == 'viili':
                HVOU.OLTTVI.VIILI('%H'%'\M'.QLRM(HVOU.KFYHFY_DLIPVI.XZMZIB.OLXZO_OLT))
                IZRHV eZOFVvIILI('KFYHFY YLLG UZROVW:%H'%HVOU.KFYHFY_DLIPVI.HGZGFH[4:])
            VORU HVOU.KFYHFY_DLIPVI.HGZGFH == 'LUUORMV':
                HVOU.OLTTVI.VIILI('%H'%'\M'.QLRM(HVOU.KFYHFY_DLIPVI.XZMZIB.OLXZO_OLT))
                IZRHV eZOFVvIILI('KFYHFY YLLG UZROVW')

    WVU PROO(HVOU):
        # RU HVOU.YILPVI_DLIPVI.HGZGFH != 'LUUORMV':
            # HVOU.OLTTVI.RMUL('[yllghgizk] HSFGGRMT WLDM YILPVI')
        # HVOU.YILPVI_DLIPVI.PROO()
        RGVN = KY.xLNNZMW()
        RGVN.KILTIZN = 'KFYHFY'
        RGVN.XLMGVMG = 'HSFGWLDM'
        KFYVI = KY.xLNNZMWkFYORHSVI()
        KFYVI.kFYORHS(RGVN)
        GRNV.HOVVK(7)
        ULI R RM IZMTV(6):
            HVOU.KFYHFY_DLIPVI.NLMRGLI()
            GRNV.HOVVK(8)
            RU HVOU.KFYHFY_DLIPVI.HGZGFH == 'LUUORMV':
                HVOU.OLTTVI.RMUL('[yllghgizk] TIZXVUFOOB HSFGWLDM KFYHFY')
                YIVZP

        RU HVOU.KFYHFY_DLIPVI.HGZGFH != 'LUUORMV':
            HVOU.OLTTVI.RMUL('[yllghgizk] ULIXVUFOOB HSFGGRMT WLDM KFYHFY')
            HVOU.KFYHFY_DLIPVI.PROO()
        HVOU.OLTTVI.RMUL('[yllghgizk] DZRGRMT ULI KFYHFY GL HSFGWLDM')
        DSROV HVOU.KFYHFY_DLIPVI.HGZGFH == 'LMORMV':
            HVOU.KFYHFY_DLIPVI.NLMRGLI()
        HVOU.OLTTVI.RMUL('[yllghgizk] KFYHFY RH WLDM')


    WVU NLMRGLI(HVOU):
        """NLMRGLI XFIIVMG HGZGFH."""
        # HVOU.YILPVI_DLIPVI.NLMRGLI()
        HVOU.KFYHFY_DLIPVI.NLMRGLI()

    WVU XSVXP(HVOU):
        """XSVXP RU IVJFRIVW KILTIZN ZMW XLMURTFIZGRLMH ZIV IVZWB."""
        HVOU.HGZGFH = gIFV
        RU MLG LH.KZGS.RHUROV(HVOU.KFYHFY_KILTIZN):
            HVOU.OLTTVI.VIIIL('KFYHFY KILTIZN %H WLVH MLG VCRHG' % HVOU.KFYHFY_KILTIZN)
            HVOU.HGZGFH = uZOHV
        RU MLG LH.KZGS.RHUROV(HVOU.KFYHFY_CNO):
            HVOU.OLTTVI.VIIIL('KFYHFY CNO %H WLVH MLG VCRHG'%HVOU.KFYHFY_CNO)
            HVOU.HGZGFH = uZOHV
        # RU MLG LH.KZGS.RHUROV(HVOU.YILPVI_KILTIZN):
            # HVOU.OLTTVI.VIIIL('YILPVI KILTIZN %H WLVH MLG VCRHG'%HVOU.YILPVI_KILTIZN)
            # HVOU.HGZGFH = uZOHV
        # RU MLG LH.KZGS.RHUROV(HVOU.YILPVI_CNO):
            # HVOU.OLTTVI.VIIIL('YILPVI CNO %H WLVH MLG VCRHG'%HVOU.YILPVI_CNO)
            # HVOU.HGZGFH = uZOHV
        IVGFIM HVOU.HGZGFH


XOZHH yLLGHGIZK(LYQVXG):
    """IVHKLMHRYOV ULI YLLGHGIZK HGZIGFK RHHFVH
    """
    WVU __RMRG__(HVOU, HVGGRMTH, MLWV):
        """XGLI."""
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.KFYHFY_HGZGFH = uZOHV
        HVOU.HGZIUOVVG_NZHGVI = uZOHV
        HVOU.OLTTVI = HVGGRMTH.OLTTVI
        KFYHFY_MLWV = mLMV
        HNX_MLWV = mLMV
        HVOU.HVXFIRGBNZMZTVI = mLMV
        HVOU.KFYHFY = mLMV
        RU MLWV RH MLG mLMV:
            KFYHFY_MLWV = MLWV.URMW('KFYHFY')
            HNX_MLWV = MLWV.URMW('HVXFIRGBNZMZTVI')
        RU KFYHFY_MLWV RH MLG mLMV:
            HVOU.KFYHFY = kFYHFY(KFYHFY_MLWV, HVOU.HVGGRMTH)
            RU MLG HVOU.KFYHFY.XSVXP():
                IZRHV eZOFVvIILI('KFYHFY KILTIZN MLG IVZWB')
        RU HNX_MLWV RH MLG mLMV:
            HVOU.HVXFIRGBNZMZTVI = hVXFIRGBnZMZTVI(HNX_MLWV, HVOU.HVGGRMTH)
            HVOU.HVXFIRGBNZMZTVI.HSN_HGZGFH.RHHFV_ORTSG( hSNhGZGFH.gIZUURXoRTSG.tivvm, 'DZREVW' )
        HVOU.XOLXP = HVGGRMTH.XOLXP
        HVOU.HOVVK_KVI_ILFMW = KZIHV_GRNVWVOGZ('8H')
        HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.HOVVK_KVI_ILFMW
        HVOU.MVVW_IVYLLG = uZOHV
        HVOU.YLLGHGIZK_IVHGZIG = mLMV

    WVU NLMRGLI(HVOU):
        RU HVOU.HGZIUOVVG_NZHGVI:
            HVOU.DIRGV_NZHGVI()
        GIB:
            HVOU.KFYHFY.NLMRGLI()
            HVOU.HVXFIRGBNZMZTVI.NLMRGLI()
            HVOU.XSVXP_KFYHFY()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.RMUL('VCXVKGRLM ZH %H'%HGI(V))
#        KIRMG('\M'.QLRM(HVOU.IVKLIG_KFYHFY()))

    WVU IVKLIG_KFYHFY(HVOU):
        IVG = []
        # IVG.ZKKVMW('yILPVI hGZGFH: %H'%HVOU.KFYHFY.YILPVI_DLIPVI.HGZGFH)
        IVG.ZKKVMW('kFYHFY hGZGFH: %H'%HVOU.KFYHFY.KFYHFY_DLIPVI.HGZGFH)
        IVG.ZKKVMW('kFYHFY hGZIG : %H'%HVOU.KFYHFY.KFYHFY_DLIPVI.HGZIG)
        KFYHFY_FKGRNV = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(HVOU.KFYHFY_GRNV)
        IVG.ZKKVMW('kFYHFY fKGRNV: %H'%(KFYHFY_FKGRNV-HVOU.KFYHFY.KFYHFY_DLIPVI.HGZIG))
        IVGFIM IVG

    WVU IFM(HVOU):
        DSROV gIFV:
            HVOU.NLMRGLI()
            # KIRMG(HVOU.OZHG.GRNV(), WZGVGRNV.WZGVGRNV.MLD().GRNV(), HVOU.YLLGHGIZK_IVHGZIG )
            # HVOU.XSVXP_IVYLLG()
            GRNV.HOVVK(8)

    WVU XSVXP_IVYLLG(HVOU):
        RU HVOU.YLLGHGIZK_IVHGZIG RH mLMV:
            IVGFIM
        VOHV:
            RU HVOU.OZHG.GRNV() <= HVOU.YLLGHGIZK_IVHGZIG ZMW WZGVGRNV.WZGVGRNV.MLD().GRNV() >= HVOU.YLLGHGIZK_IVHGZIG:
                HVOU.MVVW_IVYLLG = gIFV
                HVOU.OLTTVI.RMUL('IVYLLG GRNV ZIIREVH')
            HVOU.OZHG = WZGVGRNV.WZGVGRNV.MLD()


    WVU HGZIG(HVOU):
        HVOU.KFYHFY.IFM()
        HVOU.OLTTVI.RMUL('[yllghgizk] HGZIGRMT HVXFIRGBNZMZTVI')
        HVOU.HVXFIRGBNZMZTVI.IFM()
        HVOU.KFYHFYNZMZTVI = kFYhFYnZMZTVI()
        HVOU.KFYHFYNZMZTVI.HGZIG(uZOHV, uZOHV, mLMV, HVOU.HVGGRMTH)
        HNX_VME = uZOHV
        HVOU.OLTTVI.RMUL('[yllghgizk] HVXFIRGBNZMZTVI VMERILMNVMG IVJFRIVH vCXSZMTVrMUL > 89 ZMW hGLXPgIZWRMTwZBH > 699 ZMW vCXSZMTVgIZWRMTwZBH > 6999')
        DSROV MLG HNX_VME:
            HVOU.KFYHFYNZMZTVI.XLNKROV()
            RMW_ORHG = HVOU.KFYHFYNZMZTVI.GLKRX_RMW_ORHG
            RU RMW_ORHG['vCXSZMTVrMUL'] > 89 ZMW RMW_ORHG['hGLXPgIZWRMTwZBH']>699 ZMW RMW_ORHG['vCXSZMTVgIZWRMTwZBH']>6999:
                HVOU.OLTTVI.RMUL('[yllghgizk] HVXFIRGBNZMZTVI VMERILMNVMG IVZWB')
                HNX_VME = gIFV
            VOHV:
                HVOU.OLTTVI.VIILI('[ylllghgizk] HVXFIRGBNZMZTVI VMERILMNVMG MLG IVZWB, IVGIB RM 8 HVXLMW')
                GRNV.HOVVK(8)

    WVU PROO(HVOU):
        RU HVOU.HVXFIRGBNZMZTVI RH MLG mLMV:
            HVOU.HVXFIRGBNZMZTVI.PROO()
        RU HVOU.KFYHFY RH MLG mLMV:
            HVOU.KFYHFY.PROO()

    WVU IVYLLG(HVOU):
        HVOU.OLTTVI.RMUL('[yllghgizk] HSFGGRMT WLDM RMUIZHGIFXGFIVH')
        HVOU.PROO()
        HVOU.OLTTVI.RMUL('[yllghgizk] HGZIGRMT RMUIZHGIFXGFIVH')
        HVOU.HGZIG()

    WVU XSVXP_NZHGVI(HVOU):
        """XSVXP RU XFIIVMG RMHGZMXV RH GSV NZHGVI RMHGZMXV."""
        RU MLG LH.KZGS.RHUROV(LH.KZGS.QLRM('/WVE/HSN', 'HGZIUOVVG')):
            HVOU.HGZIUOVVG_NZHGVI = gIFV
            HVOU.OLTTVI.RMUL('HGZIUOVVG HSN MLG ULFMW, GSRH RH GSV NZHGVI RMHGZMXV')
        VOHV:
            HVOU.HIH = HSN.iVZWhSN('HGZIUOVVG')
            HVOU.HGZIUOVVG_GRNV = HVOU.IVZW_GRNV(HVOU.HIH)
            HVOU.HGZIUOVVG_KRW = RMG(HVOU.IVZW_KRW(HVOU.HIH))
            RU KHFGRO.KRW_VCRHGH(HVOU.HGZIUOVVG_KRW):
                VKLXS_GRNV = RMG(GRNV.GRNV())
                RU ZYH(VKLXS_GRNV - HVOU.HGZIUOVVG_GRNV) > 39:
                    HVOU.HGZIUOVVG_NZHGVI = gIFV
                VOHV:
                    HVOU.HGZIUOVVG_NZHGVI = uZOHV
                #KIRMG(VKLXS_GRNV, HVOU.HGZIUOVVG_GRNV, HVOU.HGZIUOVVG_NZHGVI)
            VOHV:
                HVOU.HGZIUOVVG_NZHGVI = gIFV
        RU HVOU.HGZIUOVVG_NZHGVI:
            HVOU.DIRGV_HN = HSN.dIRGVhSN('HGZIUOVVG')
        IVGFIM HVOU.HGZIUOVVG_NZHGVI


    WVU DIRGV_NZHGVI(HVOU):
        """IVKLIG XFIIVMG HGZIUOVVG ZH NZHGVI."""
        KRW = KHFGRO.kILXVHH().KRW
        FKWZGV_GRNV = RMG(GRNV.GRNV())
        HVOU.DIRGV_HN.DIRGV(9, RMG(KRW).GL_YBGVH(5, YBGVLIWVI='ORGGOV'))
        HVOU.DIRGV_HN.DIRGV(5, RMG(FKWZGV_GRNV).GL_YBGVH(1, YBGVLIWVI='ORGGOV'))

    WVU XSVXP_VMERILMNVMG(HVOU):
        """XSVXP NZHGVI RMHGZMXV HGZIGFK VMERILMNVMG."""
        HVOU.OLTTVI.RMUL('[yllghgizk] XSVXP HGZIGFK VMERILMNVMG')
        # HVOU.OLTTVI.RMUL('[yllghgizk] -->XSVXP YILPVI HGZGFH')
        # XSP_YILPVI = HVOU.XSVXP_YILPVI()
        # RU XSP_YILPVI != 'LUUORMV':
            # HVOU.OLTTVI.VIILI('[yllghgizk] YILPVI RH LMORMV, DSRXS RH HFHKRXRLFH ZH NZHGVI RMHGZMXV HSZOO GZPVLEVI YILPVI')
        HVOU.OLTTVI.RMUL('[yllghgizk] -->XSVXP KFYHFY HGZGFH')
        XSP_KFYHFY = HVOU.XSVXP_KFYHFY()
        RU XSP_KFYHFY:
            HVOU.OLTTVI.VIILI('[yllghgizk] KFYHFY RH LMORMV, DSRXS RH HFHKRXRLFH ZH NZHGVI RMHGZMXV HSZOO GZPVLEVI KFYHFY')
        HVOU.OLTTVI.RMUL('[yllghgizk] -->XSVXP HVXFIRGBNZMZTVI HGZGFH')
        XSP_HNX = HVOU.XSVXP_HVXFIRGBNZMZTVI()
        RU XSP_HNX != 'LUUORMV':
            HVOU.OLTTVI.VIILI('[yllghgizk] HVXFIRGBNZMZTVI RH LMORMV, DSRXS RH HFHKRXRLFH ZH NZHGVI RMHGZMXV HSZOO GZPVLEVI HVXFIRGBZNZMTVI')
        IVG = XSP_KFYHFY LI XSP_HNX != 'LUUORMV'
        RU IVG:
            HVOU.OLTTVI.VIILI('[yllghgizk] WVGVXGVW IFMMRMT XLNKLMVMGH, ZYLIG')
            VCRG(-8)
        IVGFIM IVG

    WVU XSVXP_KFYHFY(HVOU):
        """XSVXP KFYHFY HGZGFH ZXXLIWRMT GL kFYhFYhVIERXV HSN."""
        RU MLG LH.KZGS.RHUROV(LH.KZGS.QLRM('/WVE/HSN', 'kFYhFYhVIERXV')):
            HVOU.KFYHFY_HGZGFH = uZOHV
        VOHV:
            HVOU.IH = HSN.iVZWhSN('kFYhFYhVIERXV')
            HVOU.KFYHFY_GRNV = HVOU.IVZW_GRNV(HVOU.IH)
            HVOU.KFYHFY_KRW = HVOU.IVZW_KRW(HVOU.IH)
            RU KHFGRO.KRW_VCRHGH(HVOU.KFYHFY_KRW):
                VKLXS_GRNV = RMG(GRNV.GRNV())
                RU ZYH(VKLXS_GRNV - HVOU.KFYHFY_GRNV) > 39:
                    HVOU.KFYHFY_HGZGFH = uZOHV
                VOHV:
                    HVOU.KFYHFY_HGZGFH = gIFV
                #KIRMG(VKLXS_GRNV, HVOU.KFYHFY_GRNV, HVOU.KFYHFY_HGZGFH)
            VOHV:
                HVOU.KFYHFY_HGZGFH = uZOHV
        IVGFIM HVOU.KFYHFY_HGZGFH

    # WVU XSVXP_YILPVI(HVOU):
        # HVOU.KFYHFY.YILPVI_DLIPVI.NLMRGLI()
        # IVGFIM HVOU.KFYHFY.YILPVI_DLIPVI.HGZGFH

    WVU XSVXP_HVXFIRGBNZMZTVI(HVOU):
        HVOU.HVXFIRGBNZMZTVI.NLMRGLI()
        IVGFIM HVOU.HVXFIRGBNZMZTVI.HGZGFH

    WVU IVZW_GRNV(HVOU, IH):
        """IVZW KFYHFY FKWZGV GRNV UILN HSN."""
        IVGFIM RMG.UILN_YBGVH(IH.IVZW(5, 1), YBGVLIWVI='ORGGOV')

    WVU IVZW_KRW(HVOU, IH):
        """IVZW KFYHFY KRW UILN HSN."""
        IVGFIM RMG.UILN_YBGVH(IH.IVZW(9, 5), YBGVLIWVI='ORGGOV')


RU __MZNV__ == '__NZRM__':
    IH = HSN.iVZWhSN('HGZIUOVVG')
    KIRMG('KRW:%W'%RMG.UILN_YBGVH(IH.IVZW(9, 5), YBGVLIWVI='ORGGOV'))
    KIRMG('FKWZGV:%H'%WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(RMG.UILN_YBGVH(IH.IVZW(5, 1), YBGVLIWVI='ORGGOV')) )
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/HRNLIWVI.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
# RNKLIG FYRJGLLO.OLT  ZH OLT


WVU XSVXP_LIWVI_GBKV(LIWVI):
    RU LIWVI.kIRXVgBKV == '7':
        RU LIWVI.gRNVxLMWRGRLM == '8':
            IVGFIM "ulp"
        VOHV:
            IVGFIM "ong"
    VORU LIWVI.kIRXVgBKV == '9':
        IVGFIM "npg"

WVU XSVXP_LIWVI_WRI(LIWVI):
    RU LIWVI.wRIVXGRLM == '9':
        IVGFIM "olmt"
    VOHV:
        IVGFIM "hslig"

WVU XSVXP_LIWVI_LUUHVG(LIWVI):
    RU LIWVI.lUUHVGuOZT == '9':
        IVGFIM "lkvm"
    VORU LIWVI.lUUHVGuOZT == '8':
        IVGFIM "xolhv"
    VORU LIWVI.lUUHVGuOZT == '6':
        IVGFIM "xolhvglwzb"


WVU XSVXP_IVKLIG_GBKV(LIWVI):
    RU LIWVI.lIWVIhGZGFH == 'V':
        IVGFIM "v"
    RU LIWVI.uRVOWgBKV == 7:
        IVGFIM "l"
    VORU LIWVI.uRVOWgBKV == 6:
        IVGFIM "g"


WVU XSVXP_LIWVI_HGZGFH(LIWVI):
    RU LIWVI.lIWVIhGZGFH == '9':
        IVGFIM "zOOgIZWVW"
    VORU LIWVI.lIWVIhGZGFH == '8':
        IVGFIM "kZIGgIZWVW"
    VORU LIWVI.lIWVIhGZGFH == '6':
        IVGFIM "mLgIZWV"
    VORU LIWVI.lIWVIhGZGFH == '4':
        IVGFIM "xZMXVOVW"
    VORU LIWVI.lIWVIhGZGFH == 'F':
        IVGFIM "fmpmldm"
    VORU LIWVI.lIWVIhGZGFH == 'V':
        IVGFIM "viili"


WVU MLINZORAV_GRNV(GRNV_RMG):
    HUV = RMG(GRNV_RMG/8999/8999.9)
    GN = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(HUV )
    NH = RMG(GRNV_RMG-8999*8999*HUV)
    IVGFIM GN.HGIUGRNV("%s:%n:%h")+"."+"%93W"%NH


XOZHH lIWVI(LYQVXG):
    WVU __RMRG__(HVOU, PVB=""):
        HVOU.PVB = PVB
        HVOU.ZXGRLMH=[]
        HVOU.IVHKLMHVH=[]

    WVU ZXGRLM(HVOU, JG):
        HVOU.ZXGRLMH.ZKKVMW(JG)

    WVU IVHKLMHV(HVOU, JG):
        HVOU.IVHKLMHVH.ZKKVMW(JG)



XOZHH lIWVInZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU, RMHGIFNVMG):
        HVOU.XLMGIZXG = RMHGIFNVMG
        HVOU.LIWVI_SFY = {}

    WVU KZIHV_ZXGRLM(HVOU, ZXG):
        RU ZXG.PVB MLG RM HVOU.LIWVI_SFY:
            HVOU.LIWVI_SFY[ZXG.PVB] = lIWVI(ZXG.PVB)
            HVOU.LIWVI_SFY[ZXG.PVB].ZXGRLM(ZXG)

    WVU KZIHV_IVHKLMHV(HVOU, IVH):
        # RU IVH.uRVOWgBKV != 7:
            # IVGFIM
        HVOU.LIWVI_SFY[IVH.PVB].IVHKLMHV(IVH)



XOZHH lIWVIxVMGVI(LYQVXG):
    WVU __RMRG__(HVOU, RH_HRN):
        HVOU.LIWVI_EZFOG = {}
        KY.lKVMkFYHFY()
        HVOU.RH_HRN = RH_HRN
        RU RH_HRN:
            HVOU.LIWVI_HFY = KY.gyrMKFGuRVOWhRNhFYHXIRYVI()
            HVOU.GIZWV_HFY = KY.gyiVXEuRVOWhRNhFYHXIRYVI()
        VOHV:
            HVOU.LIWVI_HFY = KY.gyrMKFGuRVOWhFYHXIRYVI()
            HVOU.GIZWV_HFY = KY.gyiVXEuRVOWhFYHXIRYVI()
        HVOU.LIWVI_RMWVC = -8
        HVOU.GIZWV_RMWVC = -8

    WVU IVHVG(HVOU):
        HVOU.LIWVI_RMWVC = -8
        HVOU.GIZWV_RMWVC = -8
        HVOU.LIWVI_EZFOG = {}


    WVU KZIHV_LIWVI(HVOU):
        GIZWVRMW = HVOU.GIZWV_HFY.tVGrMWVC()
        LIWVIRMW = HVOU.LIWVI_HFY.tVGrMWVC()
        ULI C RM CIZMTV(HVOU.LIWVI_RMWVC+8, LIWVIRMW+8):
            ZXG = HVOU.LIWVI_HFY.tVGeZO(C)
            RU ZXG.rMHGIFNVMGrw MLG RM HVOU.LIWVI_EZFOG:
                HVOU.LIWVI_EZFOG[ZXG.rMHGIFNVMGrw] = lIWVInZMZTVI(HVOU.RH_HRN)
            HVOU.LIWVI_EZFOG[ZXG.rMHGIFNVMGrw].KZIHV_ZXGRLM(ZXG)
        HVOU.LIWVI_RMWVC = HVOU.LIWVI_HFY.tVGrMWVC()
        ULI C RM CIZMTV(HVOU.GIZWV_RMWVC+8, GIZWVRMW+8):
            GIZWV = HVOU.GIZWV_HFY.tVGeZO(C)
            RU GIZWV.uRVOWgBKV == 4 LI GIZWV.uRVOWgBKV == 5:
                XLMGRMFV
            HVOU.LIWVI_EZFOG[GIZWV.rMHGIFNVMGrw].KZIHV_IVHKLMHV(GIZWV)
        HVOU.GIZWV_RMWVC = HVOU.GIZWV_HFY.tVGrMWVC()

    WVU WRHKOZB_LIWVI_HGZGFH(HVOU, RMH, PVB=-8):
        IVG = []
        RU RMH MLG RM HVOU.LIWVI_EZFOG:
            IVGFIM IVG
        NZMZTVI=HVOU.LIWVI_EZFOG[RMH]
        ULI LIWVI RM NZMZTVI.LIWVI_SFY:
            RU PVB > 9  ZMW NZMZTVI.LIWVI_SFY[LIWVI].PVB != PVB:
                XLMGRMFV
            IVHKLMHVH = NZMZTVI.LIWVI_SFY[LIWVI].IVHKLMHVH
            ZXGRLMH = NZMZTVI.LIWVI_SFY[LIWVI].ZXGRLMH
            RU OVM(IVHKLMHVH)>9:
                ZXGRLM =IVHKLMHVH[-8]
                IVG.ZKKVMW("%-84H <-> %84H %3H   %89.7U  %4W  %4W  %84H   %67H"%
                           (MLINZORAV_GRNV(ZXGRLMH[9].fKWZGVgRNV),
                            MLINZORAV_GRNV(ZXGRLM.fKWZGVgRNV),
                            XSVXP_LIWVI_GBKV(ZXGRLM),
                            ZXGRLM.oRNRGkIRXV,
                            ZXGRLM.eLOFNVgLGZO,
                            ZXGRLM.eLOFNVgIZWVW,
                            XSVXP_LIWVI_HGZGFH(ZXGRLM),
                            ZXGRLM.PVB))
        IVGFIM IVG


    WVU WRHKOZB_LIWVI_ZXGRLM(HVOU, RMH, PVB=-8):
        IVG = []
        RU RMH MLG RM HVOU.LIWVI_EZFOG:
            IVGFIM IVG
        NZMZTVI=HVOU.LIWVI_EZFOG[RMH]
        ULI LIWVI RM NZMZTVI.LIWVI_SFY:
            RU PVB > 9  ZMW NZMZTVI.LIWVI_SFY[LIWVI].PVB != PVB:
                XLMGRMFV
            ULI ZXGRLM RM NZMZTVI.LIWVI_SFY[LIWVI].ZXGRLMH:
                IVG.ZKKVMW("%-79H%3H    %3H    %87H    %89.7U    %89W   %67H"%(MLINZORAV_GRNV(ZXGRLM.fKWZGVgRNV), XSVXP_LIWVI_GBKV(ZXGRLM), XSVXP_LIWVI_WRI(ZXGRLM), XSVXP_LIWVI_LUUHVG(ZXGRLM), ZXGRLM.oRNRGkIRXV, ZXGRLM.eLOFNVgLGZO, ZXGRLM.PVB))
        IVGFIM IVG


    WVU WRHKOZB_LIWVI_IVHKLMHV(HVOU, RMH, PVB=-8):
        IVG = []
        RU RMH MLG RM HVOU.LIWVI_EZFOG:
            IVGFIM IVG
        NZMZTVI=HVOU.LIWVI_EZFOG[RMH]
        ULI LIWVI RM NZMZTVI.LIWVI_SFY:
            RU PVB>9  ZMW  NZMZTVI.LIWVI_SFY[LIWVI].PVB != PVB:
                XLMGRMFV
            ULI ZXGRLM RM NZMZTVI.LIWVI_SFY[LIWVI].IVHKLMHVH:
                IVG.ZKKVMW("%7H  %-79H%3H    %3H    %87H    %89.7U    %89W    %67H"%
                           (XSVXP_IVKLIG_GBKV(ZXGRLM), MLINZORAV_GRNV(ZXGRLM.fKWZGVgRNV), XSVXP_LIWVI_GBKV(ZXGRLM), XSVXP_LIWVI_WRI(ZXGRLM), XSVXP_LIWVI_LUUHVG(ZXGRLM), ZXGRLM.gIZWVkIRXV,
                            (ZXGRLM.eLOFNVgIZWVW RU ZXGRLM.uRVOWgBKV==7 VOHV ZXGRLM.gIZWVeLOFNV), ZXGRLM.PVB))
            #KIRMG OVM(NZMZTVI.LIWVI_SFY[LIWVI].IVHKLMHVH)
        IVGFIM IVG



RU __MZNV__ == "__NZRM__":
    RH_HRN = gIFV
    JFLGVNZMZTVI = lIWVIxVMGVI(RH_HRN)
    JFLGVNZMZTVI.KZIHV_LIWVI()
    JFLGVNZMZTVI.WRHKOZB_LIWVI_ZXGRLM("ru8487")
    KIRMG(JFLGVNZMZTVI.WRHKOZB_LIWVI_IVHKLMHV("ru8487"))



//##**---------------- ./HGZIUOVVG/XLNKLMVMG/XLNNZMWVI.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GRNV
UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN XLMXFIIVMG RNKLIG UFGFIVH
RNKLIG TIKX
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN XLNNZMW RNKLIG XLNNZMW_KY7
UILN XLNNZMW RNKLIG XLNNZMW_KY7_TIKX
UILN XLNKLMVMG RNKLIG HLK
RNKLIG LH
RNKLIG KBRMLGRUB
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG GIZXVYZXP
_lmv_wzb_rm_hvxlmwh = 39 * 39 * 75

WVU mLINZORAVxLNNZMW(IVJFVHG):
    GVNK_ZITF = [R ULI R RM IVJFVHG.ZITFNVMGH.HKORG('&')]
    ZITFNVMGH = {}
    ZITFNVMGH['FHVI'] = IVJFVHG.FHVI
    ULI R RM GVNK_ZITF:
        ZFT_ORHG = R.HKORG('=')
        RU OVM(ZFT_ORHG) == 8:
            ZITFNVMGH[ZFT_ORHG[9]] = ''
        VOHV:
            ZITFNVMGH[ZFT_ORHG[9]] = ZFT_ORHG[8]
    ZITFNVMGH['OLMTORMV'] = IVJFVHG.OLMTORMV
    ZITFNVMGH['HFKKOVNVMG'] = IVJFVHG.HFKKOVNVMG
    IVGFIM ZITFNVMGH


XOZHH tIVVGVI(XLNNZMW_KY7_TIKX.tIVVGVIhVIERXVI):

  WVU __RMRG__(HVOU, XLNNZMW_KLLO, TOLYZO_RMUL):
      HVOU.TOLYZO_RMUL = TOLYZO_RMUL
      HVOU.XLNNZMW_KLLO = XLNNZMW_KLLO
      HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI

  WVU hZBsVOOL(HVOU, IVJFVHG, XLMGVCG):
    IVGFIM XLNNZMW_KY7.sVOOLiVKOB(NVHHZTV='sVOOL, %H!' % IVJFVHG.MZNV)

  WVU rHHFVxLNNZMW(HVOU, IVJFVHG, XLMGVCG):
    RU IVJFVHG.XLNNZMW MLG RM HVOU.XLNNZMW_KLLO:
        IVGFIM XLNNZMW_KY7.xLNNZMWiVKOB(NVHHZTV='hLIIB, XZMMLG IVXLTMRAV BLFI XLNNZMW %H' % IVJFVHG.XLNNZMW)
    VOHV:
        HVOU.TOLYZO_RMUL.OLTTVI.RMUL("[XNW] %H XLNNZMW IVXVREVW"%(IVJFVHG.XLNNZMW+IVJFVHG.HFY_XLNNZMW))
        XNW = HVOU.XLNNZMW_KLLO[IVJFVHG.XLNNZMW]
        HVOU.OLTTVI.WVYFT('IVXVE XNW %H'%IVJFVHG.XLNNZMW)
        HVOU.OLTTVI.WVYFT('-  HFYXNW %H'%IVJFVHG.HFY_XLNNZMW)
        HVOU.OLTTVI.WVYFT('-ZITFNVMG %H'%IVJFVHG.ZITFNVMGH)
        HVOU.OLTTVI.WVYFT('-OLMTORMV %H'%IVJFVHG.OLMTORMV)
        HVOU.OLTTVI.WVYFT('-HFKKOVN %H'%IVJFVHG.HFKKOVNVMG)
        ZITFNVMGH = mLINZORAVxLNNZMW(IVJFVHG)
        RU IVJFVHG.WZGZ RH MLG mLMV:
            ZITFNVMGH['XLNNZMW_WZGZ'] = IVJFVHG.WZGZ
        IVGFIM XNW.KILXVHH(ZITFNVMGH, HVOU.TOLYZO_RMUL)
        #IVG = XNW.KILXVHH(ZITFNVMGH, HVOU.TOLYZO_RMUL)
        #IVGFIM XLNNZMW_KY7.xLNNZMWiVKOB(NVHHZTV='%H' % IVG)


XOZHH xLNNZMWnLMRGLI(LYQVXG):
    WVU __RMRG__(HVOU, KZGS, TOLYZO_RMUL):
        HVOU.KZGS_ORHG = KZGS
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.XLNNZMW_KLLO = {} # XNW MZNV -> XNW
        HVOU.XLNNZMW_KZGS_NZK = {} # XNW_KZGS -> XNW
        HVOU.XNW_KZGS_ORHG = HVG()
        ULI KZGS RM HVOU.KZGS_ORHG:
            # KIRMG(KZGS)
            ULI HFYWRIH, WRIH, UROVH RM LH.DZOP(KZGS):
                ULI U RM UROVH:
                    RU U[:5] == 'XNW_' ZMW U[-6:] == '.KB':
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_XLNNZMW(U[:-6], KZGS)
                        HVOU.XNW_KZGS_ORHG.ZWW(LH.KZGS.WRIMZNV(WVHG_KZGS))
                        XNW = XOZHHLK()
                        XNW.__UROV__ = WVHG_KZGS
                        RU XNW.XLNNZMW RM HVOU.XLNNZMW_KLLO:
                            IZRHV eZOFVvIILI('xLNNZMW %H RH ZOIVZWB OLZWVW, UROV: %H, KIVE UROV: %H'%(XNW.XLNNZMW, WVHG_KZGS, HVOU.XLNNZMW_KLLO[XNW.XLNNZMW].__UROV__) )
                        VOHV:
                            HVOU.XLNNZMW_KLLO[XNW.XLNNZMW] = XNW
                            HVOU.XLNNZMW_KZGS_NZK[XNW.__UROV__] = XNW

    WVU IFM(HVOU):
        XOZHH vEVMGsZMWOVI(KBRMLGRUB.kILXVHHvEVMG):
            WVU __RMRG__(HVOU, NLMRGLI):
                HVOU.NLMRGLI = NLMRGLI

            WVU KILXVHH_rm_xivzgv(HVOU, VEVMG):
                #KIRMG('XIVZGV:', VEVMG.KZGSMZNV)
                U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                #KIRMG(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6], HVOU.NLMRGLI.XLNNZMW_KLLO)
                RU U[:5] == 'XNW_' ZMW U[-6:] == '.KB':
                    RU LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[5:-6] RM HVOU.NLMRGLI.XLNNZMW_KLLO:
                        IVGFIM
                    HVOU.NLMRGLI.OLTTVI.RMUL('MVD XLNNZMW %H OLZWVW'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_XLNNZMW(U[:-6], LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.XLNNZMW_KLLO[XNW.XLNNZMW] = XNW
                    HVOU.NLMRGLI.XLNNZMW_KZGS_NZK[XNW.__UROV__] = XNW

            WVU KILXVHH_rm_xolhv_dirgv(HVOU, VEVMG):
                #KIRMG('XOLHV_DIRGV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.XLNNZMW_KZGS_NZK:
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW XLNNZMW %H'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_XLNNZMW(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                          LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.XLNNZMW_KLLO[XNW.XLNNZMW] = XNW
                    HVOU.NLMRGLI.XLNNZMW_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

            WVU KILXVHH_rm_nlevw_gl(HVOU, VEVMG):
                #KIRMG('NLEV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.XLNNZMW_KZGS_NZK:
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW XLNNZMW %H'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_XLNNZMW(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                            LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.XLNNZMW_KLLO[XNW.XLNNZMW] = XNW
                    HVOU.NLMRGLI.XLNNZMW_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

        DN = KBRMLGRUB.dZGXSnZMZTVI()
        NZHP =  KBRMLGRUB.rm_xivzgv | KBRMLGRUB.rm_xolhv_dirgv | KBRMLGRUB.rm_nlevw_gl
        ULI KZGS RM HVOU.XNW_KZGS_ORHG:
            DN.ZWW_DZGXS(KZGS, NZHP, IVX=gIFV)
            HVOU.OLTTVI.RMUL('xLNNZMWVI NLMRGLIH XNW KZGS %H'%KZGS)
        VS = vEVMGsZMWOVI(HVOU)
        MLGRURVI = KBRMLGRUB.mLGRURVI(DN, VS)
        MLGRURVI.OLLK()

XOZHH yIRWTV(LYQVXG):
    """IVHKLMHRYOV ULI IVXVRERMT XLNNZMWH
    """
    WVU __RMRG__(HVOU, HVGGRMTH, MLWV):
        """XGLI."""
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.OLTTVI = HVGGRMTH.OLTTVI
        HVOU.KLIG_NZK = {'HGZIUOVVG':'49948', 'ZOKSZNZM':'49947', 'WZGZUOVVG':'49946', 'HGZIUOVVG_GVHG':'49945', 'WZGZUOVVG_GVHG':'49944', 'HGZIUOVVG_DJRM': '49943', 'IVWHSRUG':'29999','XZMZIB':'29998','GVINRGVKRKV_HVIEVI':'29997','GVINRGVKRKV_XORVMG':'29996'  }
        RU HVGGRMTH.HGZIUOVVG_GZT RM HVOU.KLIG_NZK:
            HVOU.KLIG = HVOU.KLIG_NZK[HVGGRMTH.HGZIUOVVG_GZT]
            HVOU.OLTTVI.RMUL('[yIRWTV] %H ZXGREZGVH XLNNZMW %H KLIG'%(HVGGRMTH.HGZIUOVVG_GZT, HVOU.KLIG))
        VORU 'YIRWTV' RM MLWV.TVGILLG().ZGGIRY:
            HVOU.KLIG = MLWV.TVGILLG().ZGGIRY['YIRWTV'].HGIRK()
            HVOU.OLTTVI.RMUL('[yIRWTV] %H ZXGREZGVH XLNNZMW %H KLIG'%(HVGGRMTH.HGZIUOVVG_GZT, HVOU.KLIG))
        VOHV:
            HVOU.KLIG = ''
        RU HVOU.KLIG=='':
            HVOU.HVGGRMTH._XLNNZMW_KLIG = -8
        VOHV:
            HVOU.HVGGRMTH._XLNNZMW_KLIG = RMG(HVOU.KLIG)
        HVOU.HVIEVI = TIKX.HVIEVI(UFGFIVH.gSIVZWkLLOvCVXFGLI(NZC_DLIPVIH=69))
        HVOU.XLNNZMW_KLLO = {}
        RU _XFIIVMG_ILLG MLG RM HVOU.HVGGRMTH.XORVMG_KZGS :
            XNW_KZGS = HVOU.HVGGRMTH.XORVMG_KZGS + [_XFIIVMG_ILLG]
        VOHV:
            XNW_KZGS = HVOU.HVGGRMTH.XORVMG_KZGS
        RU 'HGZIUOVVG' RM HVOU.HVGGRMTH.HGZIUOVVG_GZT:
            UFOO_KZGS_ORHG = [ LH.KZGS.QLRM(KGS, 'XLNNZMW', 'XLNNZMWH') ULI KGS RM XNW_KZGS ] +  [ LH.KZGS.QLRM(KGS, 'XLNNZMW', 'XLNNZMWH_XLNNLM') ULI KGS RM XNW_KZGS ]
        VOHV:
            UFOO_KZGS_ORHG = [ LH.KZGS.QLRM(KGS, 'XLNNZMW', 'XLNNZMWH_XLNNLM') ULI KGS RM XNW_KZGS]
        # KIRMG(HVOU.HVGGRMTH.XNW_KZGS)
        HVOU.XLNNZMW_NLMRGLI = xLNNZMWnLMRGLI(UFOO_KZGS_ORHG + HVOU.HVGGRMTH.XNW_KZGS, HVGGRMTH)
        HVOU.XLNNZMW_KLLO = HVOU.XLNNZMW_NLMRGLI.XLNNZMW_KLLO
        qLY(HVOU.XLNNZMW_NLMRGLI).HGZIG()
        HVOU.OLTTVI.RMUL('[yIRWTV] OLZWVW XLNNZMWH: %H'%','.QLRM([R ULI R RM HVOU.XLNNZMW_KLLO]))
        HLK_NZMZTVI = HLK.hlknLMRGLI(_XFIIVMG_ILLG, HVOU.HVGGRMTH)
        HVOU.HVGGRMTH.HLK_NZMZTVI = HLK_NZMZTVI
        qLY(HLK_NZMZTVI).HGZIG()


    WVU HVIEV(HVOU):
        XLNNZMW_KY7_TIKX.ZWW_tIVVGVIhVIERXVI_GL_HVIEVI(tIVVGVI(HVOU.XLNNZMW_KLLO, HVOU.HVGGRMTH), HVOU.HVIEVI)
        HVOU.HVIEVI.ZWW_RMHVXFIV_KLIG('[::]:%H'%HVOU.KLIG)
        HVOU.HVIEVI.HGZIG()
        GIB:
            DSROV gIFV:
                GRNV.HOVVK(_lmv_wzb_rm_hvxlmwh)
        VCXVKG pVBYLZIWrMGVIIFKG:
            HVOU.HVIEVI.HGLK(9)

    WVU IFM(HVOU):
        DSROV gIFV:
            HVOU.OLTTVI.RMUL("[yIRWTV] hGZIUOVVG YIRWTV HGZIGH GL ZXXVKG XLNNZMWH")
            HVOU.HVIEV()
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/HBHGVN.KB
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
RNKLIG LH
RNKLIG KHFGRO
# RNKLIG HFYKILXVHH
RNKLIG WZGVGRNV
RNKLIG GRNV
RNKLIG HRTMZO
# UILN GRNV RNKLIG HOVVK
RNKLIG HBH
RNKLIG IV
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.XZMZIB RNKLIG xZMZIB
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
UILN FYRJGLLO.GRNVI RNKLIG gRNVI
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
# RNKLIG KBKFYHFY ZH KY
#UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
# UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
UILN SVOKVI.FGRO RNKLIG KZIHV_GRNV, KZIHV_GRNVWVOGZ, HGIUWVOGZ
UILN SVOKVI.FGRO RNKLIG RNKLIG_XSVXPLK
UILN GLLO.HSNHGZGFH RNKLIG hSNhGZGFH
RNKLIG GIZXVYZXP

XOZHH iVHGZIGkLORXB(LYQVXG):
    '''IVHGZIG KLORXB RH FHVW DSVMVEVI XLNKLMVMG KILTIZN ZXXRWVMGZOOB ZYLIGH'''
    WVU __RMRG__(HVOU, KLORXB, OLTTVI=mLMV):
        KLORXB_HGI = KLORXB.OLDVI()
        HVOU.OLTTVI=  OLTTVI
        HVOU.UFOO_KLORXB = KLORXB_HGI
        HVOU.KLORXB = KLORXB_HGI.HKORG('-')[9].HGIRK()
        HVOU.KLORXB_ZITFNVMG = mLMV
        HVOU.GZITVG = mLMV
        HVOU.NZIP = mLMV
        RU HVOU.KLORXB == 'ZUGVI':
            HVOU.KLORXB_ZITFNVMG = KZIHV_GRNVWVOGZ(KLORXB_HGI.HKORG('-')[8].HGIRK())
        RU HVOU.KLORXB MLG RM ['RNNVWRZGV', 'MVEVI', 'ZUGVI', 'RNNVWRZGV_RU_XSVXPVW']:
            IZRHV eZOFVvIILI('XZMMLG IVXLTMRAV IVHGZIG_KLORXB ZH %H'%HVOU.KLORXB)


    WVU NZIP_GRNV(HVOU, XOLXP):
        HVOU.NZIP = XOLXP.MLD
        RU HVOU.KLORXB == 'ZUGVI':
            # KIRMG('NZIP')
            # KIRMG(HVOU.NZIP)
            # KIRMG(HVOU.KLORXB_ZITFNVMG)
            HVOU.GZITVG = HVOU.NZIP + HVOU.KLORXB_ZITFNVMG

    WVU XSVXP_IVHGZIG(HVOU, XOLXP, GRNVHKZM):
        # KIRMG(HVOU.KLORXB)
        # KIRMG(HVOU.GZITVG)
        RU HVOU.KLORXB == 'MVEVI':
            IVGFIM uZOHV
        VORU HVOU.KLORXB == 'RNNVWRZGV':
            IVGFIM gIFV
        VORU HVOU.KLORXB == 'RNNVWRZGV_RU_XSVXPVW':
            RU HVOU.OLTTVI ZMW MLG GRNVHKZM.XSVXP_LK_IVHFOG:
                HVOU.OLTTVI.RMUL('XSVXPLK UZROVW, DROO MLG IVHGZIG');
            IVGFIM GRNVHKZM.XSVXP_LK_IVHFOG
        VORU HVOU.KLORXB == 'ZUGVI':
            RU HVOU.NZIP RH mLMV:
                IVGFIM gIFV
            # KIRMG(HVOU.GZITVG, HVOU.NZIP)
            RU XOLXP.MLD < HVOU.GZITVG:
                IVGFIM uZOHV
            VOHV:
                IVGFIM gIFV


XOZHH gRNVhKZMrMUL(LYQVXG):
    WVU __RMRG__(HVOU, CNO, KZIVMG):
        HVOU.IVOLZW()
        HVOU.CNO = CNO
        HVOU.KZIVMG = KZIVMG
        HVOU.OLTTVI = KZIVMG.OLTTVI
        HGZIG_HGI = CNO.ZGGIRY['HGZIG']
        VMW_HGI = CNO.ZGGIRY['HGLK']
        HGZIG_HGI = HGZIG_HGI.HGIRK()
        VMW_HGI = VMW_HGI.HGIRK()
        HVOU.HGZIG = KZIHV_GRNV(HGZIG_HGI)
        HVOU.HLUG_NZC_VMW = uZOHV
        HVOU.XSVXP_LK_IVHFOG = gIFV
        RU VMW_HGI[-8] == 'N':
            HVOU.HLUG_NZC_VMW = gIFV
            HVOU.VMW = KZIHV_GRNV(VMW_HGI[:-8])
        VOHV:
            HVOU.VMW = KZIHV_GRNV(VMW_HGI)
        HVOU.XORVMGKZGS = KZIVMG.XORVMGKZGS
        HVOU.LM_HGZIG_XSVXPLKH = []
        HVOU.LM_YLLGRMT_UZROVW_XSVXPLKH = []
        HVOU.LM_UZROVW_XSVXPLKH = []
        HVOU.LM_HFXXVHH_XSVXPLKH = []
        HVOU.LM_URMRHS_XSVXPLKH = []
        HVOU.LM_DLIPRMT_XSVXPLKH = []
        HVOU.IVHGZIG_KLORXB = KZIVMG.IVHGZIG_KLORXB
        RU 'ZITH' RM CNO.ZGGIRY:
            HVOU.ZITH = [' '] + CNO.ZGGIRY['ZITH'].HKORG(',')
        VOHV:
            HVOU.ZITH = []
        RU 'IVHGZIG_KLORXB' RM HVOU.CNO.ZGGIRY:
            HVOU.IVHGZIG_KLORXB = iVHGZIGkLORXB(HVOU.CNO.ZGGIRY['IVHGZIG_KLORXB'], HVOU.OLTTVI)
        RU HVOU.HLUG_NZC_VMW:
            HVOU.OLTTVI.RMUL('[yllg] ZWW HXSVWFOV %H -> %H [HLUG], IVHGZIG_KLORXB: %H'%(HGI(HVOU.HGZIG), HGI(HVOU.VMW), HVOU.IVHGZIG_KLORXB.UFOO_KLORXB))
        VOHV:
            HVOU.OLTTVI.RMUL('[yllg] ZWW HXSVWFOV %H -> %H IVHGZIG_KLORXB: %H'%(HGI(HVOU.HGZIG), HGI(HVOU.VMW), HVOU.IVHGZIG_KLORXB.UFOO_KLORXB))
        ULI MLWV RM HVOU.CNO.URMWZOO('LM_HGZIG'):
            XOZHHLK = RNKLIG_XSVXPLK(MLWV.ZGGIRY['NLWFOV'], HVOU.XORVMGKZGS)
            HVOU.LM_HGZIG_XSVXPLKH.ZKKVMW(XOZHHLK[9](MLWV, HVOU, KZIVMG, KZIVMG.TOLYZO_RMUL))
            HVOU.OLTTVI.RMUL('[yllg] OLZWWVW LM_HGZIG LK %H'%MLWV.ZGGIRY['NLWFOV'])
        ULI MLWV RM HVOU.CNO.URMWZOO('LM_YLLG_UZROVW'):
            XOZHHLK = RNKLIG_XSVXPLK(MLWV.ZGGIRY['NLWFOV'], HVOU.XORVMGKZGS)
            HVOU.LM_YLLGRMT_UZROVW_XSVXPLKH.ZKKVMW(XOZHHLK[9](MLWV, HVOU, KZIVMG, KZIVMG.TOLYZO_RMUL))
            HVOU.OLTTVI.RMUL('[yllg] OLZWVW LM_YLLG_UZROVW LK %H'%MLWV.ZGGIRY['NLWFOV'])
        ULI MLWV RM HVOU.CNO.URMWZOO('LM_UZROVW'):
            XOZHHLK = RNKLIG_XSVXPLK(MLWV.ZGGIRY['NLWFOV'], HVOU.XORVMGKZGS)
            HVOU.LM_UZROVW_XSVXPLKH.ZKKVMW(XOZHHLK[9](MLWV, HVOU, KZIVMG, KZIVMG.TOLYZO_RMUL))
            HVOU.OLTTVI.RMUL('[yllg] OLZWWVW LM_UZROVW LK %H'%MLWV.ZGGIRY['NLWFOV'])
        ULI MLWV RM HVOU.CNO.URMWZOO('LM_HFXXVHH'):
            XOZHHLK = RNKLIG_XSVXPLK(MLWV.ZGGIRY['NLWFOV'], HVOU.XORVMGKZGS)
            HVOU.LM_HFXXVHH_XSVXPLKH.ZKKVMW(XOZHHLK[9](MLWV, HVOU, KZIVMG, KZIVMG.TOLYZO_RMUL))
            HVOU.OLTTVI.RMUL('[yllg] OLZWWVW LM_HFXXVHH LK %H'%MLWV.ZGGIRY['NLWFOV'])
        ULI MLWV RM HVOU.CNO.URMWZOO('LM_URMRHS'):
            XOZHHLK = RNKLIG_XSVXPLK(MLWV.ZGGIRY['NLWFOV'], HVOU.XORVMGKZGS)
            HVOU.LM_URMRHS_XSVXPLKH.ZKKVMW(XOZHHLK[9](MLWV, HVOU, KZIVMG, KZIVMG.TOLYZO_RMUL))
            HVOU.OLTTVI.RMUL('[yllg] OLZWWVW LM_URMRHS LK %H'%MLWV.ZGGIRY['NLWFOV'])
        ULI MLWV RM HVOU.CNO.URMWZOO('LM_DLIPRMT'):
            XOZHHLK = RNKLIG_XSVXPLK(MLWV.ZGGIRY['NLWFOV'], HVOU.XORVMGKZGS)
            HVOU.LM_DLIPRMT_XSVXPLKH.ZKKVMW(XOZHHLK[9](MLWV, HVOU, KZIVMG, KZIVMG.TOLYZO_RMUL))
            HVOU.OLTTVI.RMUL('[yllg] OLZWWVW LM_DLIPRMT LK %H'%MLWV.ZGGIRY['NLWFOV'])
        ULI MLWV RM HVOU.CNO.URMWZOO('YVULIV_HGZIG'):
            XOZHHLK = RNKLIG_XSVXPLK(MLWV.ZGGIRY['NLWFOV'], HVOU.XORVMGKZGS)
            HVOU.KZIVMG.YVULIV_HGZIG_XSVXPLKH.ZKKVMW(XOZHHLK[9](MLWV, HVOU, KZIVMG, KZIVMG.TOLYZO_RMUL))
            HVOU.OLTTVI.RMUL('[yllg] OLZWWVW YVULIV_HGZIG LK %H'%MLWV.ZGGIRY['NLWFOV'])


    WVU IVOLZW(HVOU):
        HVOU.YLLG_GRNVH = 9
        HVOU.HFXXVHH_YLLG_GRNVH = 9
        HVOU.UZROVW_YLLG_GRNVH = 9
        HVOU.WRHVMTZTVW_GRNVH = 9
        HVOU.HFXXVHH_GRNVH = 9
        HVOU.UZROVW_GRNVH = 9


    WVU LM_YLLG(HVOU):
        HVOU.YLLG_GRNVH += 8

    WVU LM_YLLG_UZROVW(HVOU):
        HVOU.UZROVW_YLLG_GRNVH += 8
        IVG = gIFV
        ULI LK RM HVOU.LM_YLLGRMT_UZROVW_XSVXPLKH:
            GSRH_IVG = LK.DLIP()
            RU GSRH_IVG RH mLMV:
                GSRH_IVG = gIFV
            IVG = IVG ZMW GSRH_IVG
        HVOU.XSVXP_LK_IVHFOG = IVG

    WVU LM_YLLG_HFXXVHH(HVOU):
        HVOU.HFXXVHH_YLLG_GRNVH += 8
        ULI LK RM HVOU.LM_HGZIG_XSVXPLKH:
            LK.DLIP()

    WVU LM_WRHVMTZTVW(HVOU):
        HVOU.WRHVMTZTVW_GRNVH += 8

    WVU LM_HFXXVHH(HVOU):
        HVOU.HFXXVHH_GRNVH += 8
        ULI LK RM HVOU.LM_URMRHS_XSVXPLKH:
            LK.DLIP()
        ULI LK RM HVOU.LM_HFXXVHH_XSVXPLKH:
            LK.DLIP()


    WVU LM_UZROVW(HVOU):
        HVOU.UZROVW_GRNVH += 8
        IVG = gIFV
        ULI LK RM HVOU.LM_URMRHS_XSVXPLKH:
            GSRH_IVG = LK.DLIP()
            RU GSRH_IVG RH mLMV:
                GSRH_IVG = gIFV
            IVG = IVG ZMW GSRH_IVG
        ULI LK RM HVOU.LM_UZROVW_XSVXPLKH:
            GSRH_IVG = LK.DLIP()
            RU GSRH_IVG RH mLMV:
                GSRH_IVG = gIFV
            IVG = IVG ZMW GSRH_IVG
        HVOU.XSVXP_LK_IVHFOG = IVG
        RU MLG HVOU.XSVXP_LK_IVHFOG:
            HVOU.OLTTVI.VIILI('XSVXPLK KILXVHH UZROVW')


    WVU HSLD(HVOU):
        RU HVOU.HLUG_NZC_VMW:
            IVGFIM '%H->%H [HLUG]'%( HGI(HVOU.HGZIG), HGI(HVOU.VMW) )
        VOHV:
            IVGFIM '%H->%H'%( HGI(HVOU.HGZIG), HGI(HVOU.VMW) )


XOZHH lMVgRNVrMUL(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH


XOZHH hGZIUOVVGgZHP(LYQVXG):
    WVU __RMRG__(HVOU, GZT, KILTIZN, XLMURT, MLWV, RH_HRN, TOLYZO_RMUL):
        HVOU.IZMWLN_RW = FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(4)
        HVOU.IVHGZIG_GRNVI = mLMV
        HVOU.MLWV = MLWV
        HVOU.GZT = GZT
        HVOU.CNO = mLMV
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XLNKLMVMG  =  ''
        HVOU.RH_HRN = RH_HRN
        HVOU.XFIIVMG_GRNV_HKZM = mLMV
        HVOU.RH_LMVGRNV = uZOHV
        HVOU.SRTS_OLZW_IVHGZIG = -8
        HVOU.KILTIZN = FYRJFGRO.IVKOZXV_EVIHRLM(KILTIZN, evihrlm).HGIRK()
        HVOU.XLMURT = FYRJFGRO.IVKOZXV_EVIHRLM(XLMURT, evihrlm).HGIRK()
        HVOU.XSVXP_IVZWZYOV()
        HVOU.URIHG_KZIHV_OLT = gIFV
        HVOU.IFMMRMT = ''
        HVOU.VIILIRW = 9
        HVOU.HGZGFH = 'LUUORMV'
        HVOU.RH_IFMMRMT = uZOHV
        HVOU.OZHG_OLT_UROV = ''
        HVOU.OLT_UROV = ''
        HVOU.OLT_UROV_HRAV = 9
        HVOU.OLT_UROV_UW = mLMV
        HVOU.RH_IFMMRMT_YB_HFYKILXVHH = uZOHV
        HVOU.GRNV_HKZM = mLMV
        HVOU.KRW = 9
        HVOU.IFM_KRW = 9
        HVOU.XLIV = []
        HVOU.GSIVZW_XLIV = []
        HVOU.GRNV_KZRIH = []
        HVOU.FKGRNV = '99:99:99'
        HVOU.YLLG_DLIPRMT = uZOHV
        HVOU.RH_NZMFZO_PROO = uZOHV
        HVOU.RH_NZMFZO_HGZIG = gIFV
        HVOU.RH_KZFHVW = uZOHV
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.HGZIG_GRNVH = 9
        HVOU.OZHG_HGZIG_GRNV = mLMV
        HVOU.RH_DZIMRMT = uZOHV
        HVOU.HSLFOW_HGZIG = uZOHV
        HVOU.XFIIVMG_GLGZO_OLTH = 9
        HVOU.GLGZO_OLTH = []
        HVOU.GRNVHKZM_HGI = ''
        HVOU.YVULIV_HGZIG_XSVXPLKH = []
        HVOU.VCXOFWV_WZBH = []
        HVOU.WZB_ZXGREV = uZOHV
        HVOU.HFY_LMVGRNV = []
        HVOU.URMRHSVW_HFY_LMVGRNV = []
        HVOU.UIVHS_IFM = gIFV
        RU '_LMVGRNV_' RM MLWV.ZGGIRY:
            HVOU.RH_LMVGRNV = (MLWV.ZGGIRY['_LMVGRNV_'].OLDVI() == 'GIFV')
        RU 'VCXOFWV_WZBH' RM MLWV.ZGGIRY:
            HVOU.VCXOFWV_WZBH = HVOU.VCXOFWV_WZBH + MLWV.ZGGIRY['VCXOFWV_WZBH'].HGIRK().HKORG(',')
        HVOU.XORVMGKZGS = HVOU.TOLYZO_RMUL.XORVMG_KZGS + [LH.KZGS.QLRM(_XFIIVMG_ILLG, 'XSVXPLK')]
        RU 'XORVMGKZGS' RM HVOU.MLWV.ZGGIRY:
            HVOU.XORVMGKZGS = HVOU.XORVMGKZGS + HVOU.MLWV.ZGGIRY['XORVMGKZGS'].HKORG(',')
        RU 'ZOKSZNZM' RM MLWV.ZGGIRY:
            HVOU.RH_ZOKSZNZM = gIFV RU MLWV.ZGGIRY['ZOKSZNZM'].OLDVI() == 'GIFV' VOHV uZOHV
        VOHV:
            HVOU.RH_ZOKSZNZM = uZOHV
        # RMRGRZORAV ZMW KIVKZIV HGZGFH HSN ULI GSRH KILTIZN
        HVOU.HSN_HGZGFH = hSNhGZGFH(HVOU.GZT)
        RU MLG HVOU.HSN_HGZGFH.LKVM():
            HVOU.OLTTVI.RMUL('%H HVVNH GL YV RM SVI NZRWVM ELBZTV'%HVOU.GZT)
            HVOU.HSN_HGZGFH.XIVZGV()
        HVOU.HSN_HGZGFH.XSVXP_HRAV()
        HVOU.HSN_HGZGFH.KZIHV_GIZUURX()
        # RM XZHV GSRH RH Z KBGSLM KILTIZN
        RU 'KBGSLM' MLG RM HVOU.MLWV.ZGGIRY:
            HVOU.RH_KBGSLM = uZOHV
        VOHV:
            RU HVOU.MLWV.ZGGIRY['KBGSLM'].OLDVI() == 'GIFV':
                HVOU.RH_KBGSLM = gIFV
            VOHV:
                HVOU.RH_KBGSLM = uZOHV
        RU HVOU.MLWV.ZGGIRY['KLHHVHH'].OLDVI() == 'GIFV':
            HVOU.KLHHVHH_XLIV = gIFV
        VOHV:
            HVOU.KLHHVHH_XLIV = uZOHV
        RU 'RM_GIFHG' RM HVOU.MLWV.ZGGIRY:
            HVOU.RM_GIFHG = gIFV RU HVOU.MLWV.ZGGIRY['RM_GIFHG'].OLDVI() == 'GIFV' VOHV uZOHV
        VOHV:
            HVOU.RM_GIFHG = uZOHV
        RU MLG HVOU.RH_HRN:
            HVOU.OLTTVI.RMUL('%H OLZWVW, RM GIFHG: %H'%(HVOU.GZT,'gIFV' RU HVOU.RM_GIFHG VOHV 'uZOHV'))
        # HVG IVHGZIG KLORXB
        RU 'IVHGZIG_KLORXB' MLG RM HVOU.MLWV.ZGGIRY:
            HVOU.IVHGZIG_KLORXB = iVHGZIGkLORXB('RNNVWRZGV', HVOU.OLTTVI)
        VOHV:
            HVOU.IVHGZIG_KLORXB = iVHGZIGkLORXB(HVOU.MLWV.ZGGIRY['IVHGZIG_KLORXB'], HVOU.OLTTVI)
        # KZIHV RM-GIFHG GRNV HXSVWFOV
        GRNVH = HVOU.MLWV.URMWZOO('GRNV')
        ULI GN RM GRNVH:
            HGZIG_HGI = GN.ZGGIRY['HGZIG']
            VMW_HGI = GN.ZGGIRY['HGLK']
            HVOU.GRNVHKZM_HGI += HGZIG_HGI+'-'+VMW_HGI+'|'
            HVOU.GRNV_KZRIH.ZKKVMW(gRNVhKZMrMUL(GN, HVOU))
        # RMWRXZGV GSV KILTIZN RH MLG LM HXSVWFOV
        HVOU.LMORMV_DZIMRMT = uZOHV
        HVOU.LUUORMV_DZIMRMT = uZOHV
        HVOU.VIILI = 9
        HVOU.DZIMRMT = 9
        HVOU.VIILI_OLT = []
        HVOU.DZIMRMT_OLT = []
        HVOU.WVKVMWVMXB_ORHG = []
        RU 'XDW' RM HVOU.MLWV.ZGGIRY:
            HVOU.XDW = HVOU.MLWV.ZGGIRY['XDW']
        VOHV:
            HVOU.XDW = '.'
        HVOU.VME = {}
        RU 'VME' RM HVOU.MLWV.ZGGIRY:
            VME_HGI = HVOU.MLWV.ZGGIRY['VME']
            ULI VME_H RM VME_HGI.HKORG(','):
                HVOU.VME[VME_H.HKORG('=')[9].HGIRK()] = VME_H.HKORG('=')[8].HGIRK()
        RU HVOU.RH_KBGSLM:
            HVOU.XZMZIB = xZMZIB(HVOU.KILTIZN +' -X ' + HVOU.XLMURT + ' -V', HVOU.XDW)
        VOHV:
            HVOU.XZMZIB = xZMZIB(HVOU.KILTIZN +' ' + HVOU.XLMURT, HVOU.XDW)

    WVU WVGZRO(HVOU):
        IVG = {}
        IVG['GZT'] = HVOU.GZT
        IVG['HGZGFH'] = HVOU.HGZGFH
        IVG['RW'] = HVOU.rw
        IVG['KRW'] = HVOU.IFM_KRW
        IVG['CNO'] = HVOU.CNO
        IVG['SLHG'] = HVOU.SLHG
        IVG['WLNZRM'] = HVOU.WLNZRM
        IVGFIM IVG

    WVU XSVXP_HXSVWFOV(HVOU):
        IVGFIM (uZOHV, uZOHV, gIFV)

    WVU XSVXP_IVZWZYOV(HVOU):
        RU MLG LH.ZXXVHH(HVOU.KILTIZN, LH.i_lp):
            IZRHV eZOFVvIILI(HVOU.XLNKLMVMG+' KILTIZN '+HVOU.KILTIZN+' RH MLG IVZWZYOV')
        RU MLG LH.ZXXVHH(HVOU.XLMURT, LH.i_lp):
            IZRHV eZOFVvIILI(HVOU.XLNKLMVMG+ ' XLMURT '+HVOU.XLMURT+' RH MLG IVZWZYOV')
        GIB:
            HVOU.CNO = VGIVV.KZIHV(HVOU.XLMURT)
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(HVOU.KILTIZN+" "+HVOU.XLNKLMVMG+" KZIHV CNO UROV "+HVOU.XLMURT+"VIILI: ", HGI(V) )
            HBH.VCRG(-8)
        RU HVOU.GZT != 'KFYHFY' ZMW HVOU.GZT != 'YILPVI' ZMW MLG HVOU.RH_LMVGRNV ZMW HVOU.GZT != HVOU.CNO.TVGILLG().GZT.HGIRK():
            IZRHV eZOFVvIILI(HVOU.GZT+' EH. '+ HVOU.CNO.TVGILLG().GZT.HGIRK() + ' GZTH NRHNZGXS')

    WVU XLNKROV(HVOU, RH_HSLIG = uZOHV, VCKLIG_QHLM = uZOHV):
        FHVW_XLIVH = HVOU.KIRMG_NZRM_XLIV(HVOU.XLIV)+HVOU.KIRMG_GSIVZW_XLIV(HVOU.GSIVZW_XLIV)
        RU OVM(FHVW_XLIVH) > 89:
            FHVW_XLIVH = FHVW_XLIVH[:0]+'...'
        RU HVOU.XLNKLMVMG == 'HVXFIRGBNZMZTVI':
            XLNKLMVMG = 'HNX'
            HVOU.WZB_ZXGREV = gIFV
        VOHV:
            XLNKLMVMG = HVOU.XLNKLMVMG
        NVN_RMUL = HVOU.XZMZIB.NVNLIB()
        RU MLG RH_HSLIG:
            NHT = ('%-84H%89H%89H%0H%89H%89H%84H%0H%0H%5W'
                   %( HVOU.GZT+'-lg' RU HVOU.RH_LMVGRNV VOHV HVOU.GZT, XLNKLMVMG,
                  HVOU.HGZGFH,HGI(HVOU.KRW),
                  HVOU.HGZIG.HGIUGRNV('%s:%n:%h'),
                  HVOU.FKGRNV, FHVW_XLIVH,
                  HGI(HVOU.DZIMRMT),HGI(HVOU.VIILI),HVOU.HGZIG_GRNVH ) )
        VOHV:
            NHT = ('%H@%H@%H@%H@%H@%H@%H@%H@%H@%5W@%5.8U@%3W@%3W@%3W'
                   %(HVOU.GZT+'-lg' RU HVOU.RH_LMVGRNV VOHV HVOU.GZT,
                    XLNKLMVMG,
                    HVOU.HGZGFH+'[K]' RU HVOU.RH_KZFHVW VOHV HVOU.HGZGFH,
                    HGI(HVOU.KRW),
                    HVOU.HGZIG.HGIUGRNV('%s:%n:%h'),
                    HVOU.FKGRNV,
                    HGI(HVOU.DZIMRMT),
                    HGI(HVOU.VIILI),
                    'ivw' RU HVOU.HSN_HGZGFH.GIZUURX_ORTSG==9 VOHV 'tivvm',
                    HVOU.HGZIG_GRNVH,
                    HVOU.XZMZIB.XKF(),
                    NVN_RMUL[9]/8999/8999,NVN_RMUL[8]/8999/8999,NVN_RMUL[7]/8999/8999
                     ))
        RU VCKLIG_QHLM:
            # KIRMG('QHLM')
           # DV VCKLIG WRXG SVIV ULI OZGVI FHV ZH QHLM
            IVGFIM {'GZT':HVOU.GZT, 'XLNKLMVMVG':XLNKLMVMG, 'HGZGFH':HVOU.HGZGFH, 'KRW':HGI(HVOU.KRW),
                    'HGZIG_G':HVOU.HGZIG.HGIUGRNV('%s:%n:%h'), 'FKGRNV':HVOU.FKGRNV,
                    'DZIMRMT_MFN':HGI(HVOU.DZIMRMT), 'VIILI_MFN':HGI(HVOU.VIILI), 'GIZUURX': 'ivw' RU HVOU.HSN_HGZGFH.GIZUURX_ORTSG==9 VOHV 'tivvm',
                    'GRNVHKZM':HVOU.GRNVHKZM_HGI, 'HSLFOW_HGZIG':HVOU.HSLFOW_HGZIG, 'RH_DZIMRMT':HVOU.RH_DZIMRMT, 'WZB_ZXGREV':HVOU.WZB_ZXGREV,'XKF':HVOU.XZMZIB.XKF(),
                    'IHH':NVN_RMUL[9]/8999/8999,'ERIG':NVN_RMUL[8]/8999/8999,'HSZIVW':NVN_RMUL[7]/8999/8999 }
        #IVGFIM '\966[08N {}\966[99N'.ULINZG(NHT)
        IVGFIM NHT


    WVU XSVXP_SRTS_OLZW_IVHGZIG(HVOU):
        '''HLNV XLNKLMVMG DROO IVJFRIV SRTS_OLZW_IVHGZIG'''
        RU HVOU.SRTS_OLZW_IVHGZIG < 9:
            IVGFIM
        XKF = UOLZG(HVOU.XZMZIB.XKF())
        RU XKF - UOLZG(HVOU.SRTS_OLZW_IVHGZIG) > 9:
            HVOU.OLTTVI.DZIM('[ivhgzig] SRTS OLZW IVHGZIG ZXGREZGVW ZH %U > %W'%(XKF, HVOU.SRTS_OLZW_IVHGZIG))
            HVOU.IVHGZIG()

    WVU XSVXP_IVHGZIG(HVOU):
        '''XLNKLMVMG NZB MVVW IVHGZIG ZG HKVXRURX GRNV'''
        RU HVOU.IVHGZIG_GRNVI RH mLMV:
            IVGFIM uZOHV
        VOHV:
            IVGFIM HVOU.IVHGZIG_GRNVI.XSVXP(WZGVGRNV.WZGVGRNV.MLD().GRNV())


    WVU KIRMG_NZRM_XLIV(HVOU, XLIVH):
        RU OVM(XLIVH) == 9:
            IVGFIM 'n:mlmv'.HGIRK()
        VOHV:
            IVG = 'n:'
            ULI R RM XLIVH[:-8]:
                IVG+=HGI(R)+','
            IVG += HGI(XLIVH[-8])
            IVGFIM IVG.HGIRK()


    WVU KIRMG_GSIVZW_XLIV(HVOU, XLIVH):
        RU OVM(XLIVH) == 9:
            IVGFIM ''.HGIRK()
        VOHV:
            IVG = '+g:'
            XLIV_MFN = 9
            ULI R RM XLIVH[:-8]:
                XLIV_MFN += 8
                RU XLIV_MFN <= 7:
                    IVG+=HGI(R)+','
            RU OVM(XLIVH) > 6:
                IVG+='...'
            VOHV:
                IVG += HGI(XLIVH[-8])
            IVGFIM IVG.HGIRK()


    WVU KZIHV(HVOU):
        UROVMZNV = '/IFM/'+HVOU.GZT+'.IFM'
        KZIHVI = xLMURTkZIHVI.iZDxLMURTkZIHVI()
        KZIHVI.LKGRLMCULIN = HGI
        RU MLG LH.KZGS.VCRHGH(UROVMZNV):
            HVOU.HGZIG = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(9)
            HVOU.WLNZRM = ''
            HVOU.SLHG = ''
            HVOU.KRW = -8
            HVOU.rw = 'fmpmldm'
            IVGFIM
        DRGS LKVM (UROVMZNV) ZH UK:
            KZIHVI.IVZWUK(UK)
        GIB:
            #RU HVOU.OZHG_OLT_UROV == '':
            HVOU.OLT_UROV = KZIHVI.TVG(HVOU.GZT, 'OLT')
            #    HVOU.OZHG_OLT_UROV = HVOU.OLT_UROV
            #VOHV:
            #    RU HVOU.OLT_UROV != KZIHVI.TVG(HVOU.GZT, 'OLT'):
            #        HVOU.OLT_UROV = KZIHVI.TVG(HVOU.GZT, 'OLT')
        VCXVKG:
            KZHH
        HGZIG_HGI = RMG( KZIHVI.TVG(HVOU.GZT, 'HGZIG') )
        HVOU.HGZIG = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(HGZIG_HGI/8999.9/8999.9 )
        HVOU.WLNZRM = KZIHVI.TVG(HVOU.GZT, 'WLNZRM')
        HVOU.SLHG = KZIHVI.TVG(HVOU.GZT, 'SLHG')
        HVOU.rw = KZIHVI.TVG(HVOU.GZT, 'rw')
        HVOU.IFM_KRW = RMG(KZIHVI.TVG(HVOU.GZT, 'KILXVHH'))
        RU MLG HVOU.RH_IFMMRMT_YB_HFYKILXVHH:
            HVOU.KRW = HVOU.IFM_KRW

    WVU LKVM_OLT(HVOU):
        # OZHG_OLT_UROV RH TVMVIZOOB Z HDRGXS XLMGILOORMT DSVGSVI DV MVVW GL
        # IVLKVM GSV UROV
        RU HVOU.OLT_UROV == HVOU.OZHG_OLT_UROV:
            IVGFIM
        HVOU.OZHG_OLT_UROV = HVOU.OLT_UROV
        HVOU.OLTTVI.RMUL('%H OLT UROV XSZMTVW GL %H'%(HVOU.GZT, HVOU.OLT_UROV))
        RU MLG LH.KZGS.VCRHGH(HVOU.OLT_UROV):
            HVOU.OLT_UROV_HRAV = 9
            HVOU.OLT_UROV_UW = mLMV
        VOHV:
            HG = LH.HGZG(HVOU.OLT_UROV)
            HVOU.OLT_UROV_HRAV = HG.HG_HRAV
            HVOU.OLT_UROV_UW = LKVM(HVOU.OLT_UROV, 'I')


    WVU XSVXP_MLGRXV(HVOU):
        HVOU.KZIHV()
        RU HVOU.KRW < 9:
            IVGFIM 'YLLGRMT'
        VORU RMG(HVOU.IFM_KRW) == RMG(HVOU.XZMZIB.KRW):
            IVGFIM 'LMORMV'
        VOHV:
            IVGFIM 'LUUORMV'



    WVU HVG_LUUORMV(HVOU):
        HVOU.RH_IFMMRMT = uZOHV
        HVOU.FKGRNV = '99:99:99'
        HVOU.XLIV = []
        HVOU.GSIVZW_XLIV = []
        HVOU.KRW = -8
        HVOU.DZIMRMT = 9
        HVOU.VIILI = 9


    WVU NLMRGLI(HVOU):
        #HVOU.KZIHV_OLT()
        #HVOU.LKVM_OLT()
        # RU HVOU.GRNV_HKZM:
            # KIRMG('--------------')
            # KIRMG('yllg:%W'%HVOU.GRNV_HKZM.YLLG_GRNVH)
            # KIRMG('hfxx yllg:%W'%HVOU.GRNV_HKZM.HFXXVHH_YLLG_GRNVH)
            # KIRMG('uzro yllg:%W'%HVOU.GRNV_HKZM.UZROVW_YLLG_GRNVH)
            # KIRMG('hfxx grnvh:%W'%HVOU.GRNV_HKZM.HFXXVHH_GRNVH)
            # KIRMG('uzro grnvh:%W'%HVOU.GRNV_HKZM.UZROVW_GRNVH)
            # KIRMG('wrhv grnvh:%W'%HVOU.GRNV_HKZM.WRHVMTZTVW_GRNVH)
        ULI RGVN RM HVOU.YVULIV_HGZIG_XSVXPLKH:
            RU RGVN.XSVXP_DLIP():
                RGVN.DLIP()
        ULI HFY RM HVOU.HFY_LMVGRNV:
            RU HFY.RH_IFMMRMT:
               HVOU.HVG_LUUORMV()
               IVGFIM
            VOHV:
               RU MLG HFY.UIVHS_IFM:
                  HVOU.URMRHSVW_HFY_LMVGRNV.ZKKVMW(HFY)
        #RU OVM(HVOU.HFY_LMVGRNV) > 9:
        #    KIRMG(HVOU.HFY_LMVGRNV[9].RH_IFMMRMT, HVOU.HFY_LMVGRNV[9].UIVHS_IFM)
        HVOU.HFY_LMVGRNV = [ C ULI C RM HVOU.HFY_LMVGRNV RU  C.RH_IFMMRMT LI C.UIVHS_IFM ]
        RU MLG HVOU.RH_IFMMRMT:
            HVOU.KZIHV()
        GIB:
            RH_VCRHG = HVOU.XSVXP_VCRHG()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI('VMXLFMGVIH VIILI %H'%HGI(V))
            RH_VCRHG = uZOHV
        RU RH_VCRHG:
            HVOU.LKVM_OLT()
            HVOU.RH_IFMMRMT = gIFV

            RU HVOU.GRNV_HKZM RH MLG mLMV:
                ULI RGVN RM HVOU.GRNV_HKZM.LM_DLIPRMT_XSVXPLKH:
                    RGVN.DLIP()

            RU HVOU.RH_HRN:
                HVOU.HGZGFH = 'HRN'
                IVZW_HGZGFH = HVOU.HN.IVZW().HGIRK().HGIRK('9').HGIRK('\9')
                RU IVZW_HGZGFH:
                    RU RMG( IVZW_HGZGFH ) == 8:
                        HVOU.HGZGFH = 'HGZMWYB'
                    VORU RMG(  IVZW_HGZGFH ) == 7:
                        HVOU.HGZGFH = 'HRN'
                VOHV:
                    HVOU.HGZGFH = 'HGZIGRMT'
            VOHV:
                #KIRMG('->'+HVOU.HGZGFH)
                RU HVOU.HGZGFH != 'LMORMV':
                    IVKLIG_MLGRXV = HVOU.XSVXP_MLGRXV()
                    RU IVKLIG_MLGRXV == 'LMORMV':
                        HVOU.HGZGFH = 'LMORMV'
                    VOHV:
                        HVOU.HGZGFH = 'YLLGRMT'
            RU HVOU.RH_HRN:
                VOZKHVW = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(
                    ( HVOU.GRNVI.HRN_MLD - HVOU.GRNVI.HRN_HGZIG )/8999/8999 ) - WZGVGRNV.WZGVGRNV(8029, 8, 8, 1)
                HVOU.HGZIG = HVOU.GRNVI.HRN_HGZIG_WG
            VOHV:
                VOZKHVW = WZGVGRNV.WZGVGRNV.MLD() - HVOU.HGZIG
            HVOU.FKGRNV = HGIUWVOGZ(VOZKHVW, '{SLFIH}:{NRMFGVH}:{HVXLMWH}' )
            GIB:
                HVOU.XLIV = KHFGRO.kILXVHH(RMG(HVOU.KRW)).XKF_ZUURMRGB()
                GSIVZWH = KHFGRO.kILXVHH(RMG(HVOU.KRW)).GSIVZWH()
                HVOU.GSIVZW_XLIV = []
                ULI KK RM GSIVZWH:
                    RU HGI(KK[9]) == HGI(HVOU.KRW):
                        XLMGRMFV
                    HVOU.GSIVZW_XLIV += KHFGRO.kILXVHH(KK[9]).XKF_ZUURMRGB()
            VCXVKG:
                KZHH
            #RU MLG HVOU.RH_HRN:
                # GLWL MVVW GL URMW DZIMRMT ZMW VIILI UILN OLT UROV
                #KIRMG('KZIHV OLT')
                #HVOU.KZIHV_OLT()
                #KIRMG('URMRHS KZIHRMT')
        VORU HVOU.YLLG_DLIPRMT:
            KZHH
        VOHV:
            RU HVOU.RH_IFMMRMT: # NVZMH HBHGVN XSZMTVH HGZGFH UILN LMORMV GL LUUORMV
                RU HGI(HVOU.VIILIRW) == '9':
                    HVOU.OLTTVI.VIILI('%H KILTIZN VCRGH' % HVOU.GZT)
                    HVOU.OLTTVI.VIILI('%H KILTIZN IVKLIGH: %H ' % (HVOU.GZT, '\M'.QLRM(HVOU.XZMZIB.OLXZO_OLT)))
                VOHV:
                    HVOU.OLTTVI.VIILI('%H KILTIZN WRHVMTZTVW' % HVOU.GZT)
                    HVOU.OLTTVI.VIILI('%H KILTIZN IVKLIGH VIILI: %H ' % (HVOU.GZT, '\M'.QLRM(HVOU.XZMZIB.OLXZO_OLT)))
                    RU HVOU.GRNV_HKZM RH MLG mLMV:
                        HVOU.GRNV_HKZM.LM_WRHVMTZTVW()
            RU HVOU.VIILIRW == 9:
                HVOU.HGZGFH = 'LUUORMV'
            VOHV:
                HVOU.HGZGFH = 'viili:'+HGI(HVOU.VIILIRW)
            HVOU.HVG_LUUORMV()


    WVU KZIHV_OLT(HVOU):
        RU MLG LH.KZGS.VCRHGH(HVOU.OLT_UROV):
            IVGFIM
        RU HVOU.OLT_UROV_UW RH mLMV:
            IVGFIM
        RU HVOU.URIHG_KZIHV_OLT:
            HVOU.OLTTVI.RMUL('%H KZIHRMT OLTH...', HVOU.GZT)
        HG = LH.HGZG(HVOU.OLT_UROV)
        OLT_HRAV_WRUU = HG.HG_HRAV - HVOU.OLT_UROV_HRAV
        #KIRMG(HG.HG_HRAV, HVOU.OLT_UROV_HRAV)
        RU OLT_HRAV_WRUU > 899*8975:
            # OLT HRAV RMXIVZHVH LEVI 899P, NFHG YV HLNVGSRMT DILMT
            HVOU.OLTTVI.VIILI('%H TVMVIZGVH GLL NZMB OLTH > 899P/H, HLNVGSRMT RH DILMT', HVOU.GZT)
            HVOU.GLGZO_OLTH.ZKKVMW( '%H TVMVIZGVH GLL NZMB OLTH > 899P/H, HLNVGSRMT RH DILMT'% HVOU.GZT )
        VOHV:
            ORMVH = mLMV
            GIB:
                UROV_KLH = HVOU.OLT_UROV_UW.GVOO()
                ORMVH = MVCG( FYRJUROV.DZGXS_UROV(HVOU.OLT_UROV_UW, MLYOLXP=gIFV) )
            VCXVKG fMRXLWVwVXLWVvIILI:
                HVOU.OLT_UROV_UW = LKVM(HVOU.OLT_UROV, 'I', VMXLWRMT='TYP')
                HVOU.OLT_UROV_UW.HVVP(UROV_KLH)
                ORMVH = MVCG( FYRJUROV.DZGXS_UROV(HVOU.OLT_UROV_UW, MLYOLXP=gIFV) )
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI('LHVIILI %H'%HGI(V))
            RU MLG ORMVH:
                IVGFIM
            ULI ORMV RM ORMVH:
                GZITVG = ORMV.HGIRK()
                RU OVM(HVOU.GLGZO_OLTH) < 899*899*899:
                    HVOU.GLGZO_OLTH.ZKKVMW(GZITVG)
                VORU OVM(HVOU.GLGZO_OLTH) == 899*899*899:
                    HVOU.GLGZO_OLTH.ZKKVMW('8n NZCRNFN OLT ORMVH')
                    XLMGRMFV
                RU IV.HVZIXS('\*\*\*\*\*\*\*\*',GZITVG):
                    #HVOU.DZIMRMT = 9
                    #HVOU.VIILI = 9
                    XLMGRMFV
                RU IV.HVZIXS('VIILI', GZITVG) LI IV.HVZIXS('XIRGRXZO', GZITVG):
                    HVOU.VIILI += 8
                    HVOU.VIILI_OLT.ZKKVMW(GZITVG)
                    RU MLG HVOU.URIHG_KZIHV_OLT:
                        HVOU.OLTTVI.VIILI('%H IVKLIG VIILI: %H', HVOU.GZT, GZITVG)
                VORU IV.HVZIXS('DZIMRMT', GZITVG):
                    HVOU.DZIMRMT += 8
                    HVOU.DZIMRMT_OLT.ZKKVMW(GZITVG)
            RU HVOU.URIHG_KZIHV_OLT:
                HVOU.URIHG_KZIHV_OLT = uZOHV
                RU HVOU.VIILI > 9:
                    HVOU.OLTTVI.VIILI('%H IVKLIGH %W VIILIH, %W DZIMRMTH', HVOU.GZT, HVOU.VIILI, HVOU.DZIMRMT)
                VOHV:
                    HVOU.OLTTVI.RMUL('%H IVKLIGH %W VIILIH, %W DZIMRMTH', HVOU.GZT, HVOU.VIILI, HVOU.DZIMRMT)
        HVOU.OLT_UROV_HRAV = HG.HG_HRAV


    WVU XSVXP_VCRHG(HVOU):
        MZNV = HVOU.GZT
        RU MLG HVOU.RH_IFMMRMT_YB_HFYKILXVHH:
            IVGFIM FYRJFGRO.XSVXP_KILTIZN_VCRHG(MZNV)
        VOHV:
            # IFM YB XZMZIB, GSVM FHV XZMZIB UFMXGRLMH
            HVOU.XZMZIB.XSVXP(gIFV)
            RU HVOU.XZMZIB.HGZGFH_XLWV RH MLG mLMV: # KILXVHH VMWH HLNVDSVIV
                RU HVOU.RH_IFMMRMT:
                    HVOU.VIILIRW = HVOU.XZMZIB.HGZGFH_XLWV
                    RU HGI(HVOU.VIILIRW) == '9':
                        RU HVOU.GRNV_HKZM RH MLG mLMV:
                            HVOU.GRNV_HKZM.LM_HFXXVHH()
                        HVOU.OLTTVI.RMUL('%H VCRGH MLINZOOB'%HVOU.GZT)
                    VOHV:
                        RU HVOU.GRNV_HKZM RH MLG mLMV:
                            HVOU.GRNV_HKZM.LM_UZROVW()
                            HVOU.GRNV_HKZM.IVHGZIG_KLORXB.NZIP_GRNV(HVOU.TOLYZO_RMUL.XOLXP)
                        HVOU.OLTTVI.DZIM('%H VCRGH DRGS VIILI XLWV %H'%(HVOU.GZT, HGI(HVOU.VIILIRW)))
                IVGFIM uZOHV
            VOHV:
                IVGFIM gIFV

    WVU NZMFZO_PROO(HVOU):
        ULI HFY_XLN RM HVOU.HFY_LMVGRNV:
            HFY_XLN.NZMFZO_PROO()
        RU HVOU.RH_IFMMRMT:
            HVOU.RH_NZMFZO_PROO = gIFV
            HVOU.RH_NZMFZO_HGZIG = uZOHV
            HVOU.PROO()

    WVU NZMFZO_KZFHV(HVOU):
        HVOU.RH_KZFHVW = gIFV


    WVU NZMFZO_IVHFNV(HVOU):
        HVOU.RH_KZFHVW = uZOHV

    WVU NZMFZO_IFM(HVOU, ZITH=[]):
        RU MLG HVOU.RH_IFMMRMT:
            HVOU.RH_NZMFZO_HGZIG = gIFV
            HVOU.RH_NZMFZO_PROO = uZOHV
            HVOU.IFM(ZITH)

    WVU IVHGZIG(HVOU):
        HVOU.VMHFIV_PROO()
        HVOU.IFM()

    WVU VMHFIV_PROO(HVOU):
        HVOU.PROO()
        HVOU.NLMRGLI()
        DSROV HVOU.HGZGFH == 'LMORMV':
            GRNV.HOVVK(8)
            HVOU.NLMRGLI()

    WVU PROO(HVOU):
        RU HVOU.RH_IFMMRMT ZMW MLG HVOU.RH_IFMMRMT_YB_HFYKILXVHH:
            HVOU.RH_IFMMRMT = uZOHV
            GIB:
                LH.PROO(RMG(HVOU.KRW), HRTMZO.hrtgvin)
            VCXVKG vCXVKGRLM ZH V:
                GIZXVYZXP.KIRMG_VCX()
        VORU HVOU.RH_IFMMRMT ZMW HVOU.RH_IFMMRMT_YB_HFYKILXVHH:
            GIB:
                #KIRMG(HVOU.KRW)
                GIB:
                    LH.PROO(HVOU.KRW, HRTMZO.hrtfhi8)
                VCXVKG vCXVKGRLM ZH V:
                    GIZXVYZXP.KIRMG_VCX()
                    HVOU.OLTTVI.VIILI('HVMW HRTMZO VMXLFMGVIH VIILI ZH %H'%HGI(V))
                #IVG = gIFV
                GRNV.HOVVK(9.8)
                RU HVOU.XZMZIB.HGZGFH != 'HGLKKVW':
                    RU HVOU.XLNKLMVMG == 'DVY':
                        HVOU.OLTTVI.VIILI('HLUG PROO %H'%HVOU.GZT)
                        IVG = HVOU.XZMZIB.PROO(HLUG=gIFV)
                    VOHV:
                        IVG = HVOU.XZMZIB.PROO()
                VOHV:
                    IVG = gIFV
            VCXVKG vCXVKGRLM ZH V:
                GIZXVYZXP.KIRMG_VCX()
                HVOU.OLTTVI.VIILI('XZMZIB PROO VMXLFMGVIH DRGS VIILI ZH %H'%(HGI(V)))
                IVGFIM
            RU MLG IVG:
                HVOU.OLTTVI.DZIM('UZROVW GL PROO %H, DROO IVGIB HLLM'%HVOU.GZT)
            VOHV:
                HVOU.RH_IFMMRMT = uZOHV

    WVU IFM(HVOU, ULIXV_ZITH=[]):
        # XSVXP WVKVMWVMXRVH
        HGZGFH = gIFV
        ULI WVK RM HVOU.WVKVMWVMXB_ORHG:
            RU WVK.RH_IFMMRMT:
                HGZGFH = HGZGFH ZMW gIFV
            VOHV:
                HGZGFH = HGZGFH ZMW uZOHV
                HVOU.OLTTVI.VIILI('%H XZMMLG HGZIG ZH WVKVMWVMXB %H RH MLG IFMMRMT '%(HVOU.GZT, WVK.GZT))
                DZIM = HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.MVD_DZIMRMT()
                DZIM.OVEVO(2).NVHHZTV('%H XZMMLG HGZIG ZH WVKVMWVMXB %H RH MLG IFMMRMT '%(HVOU.GZT, WVK.GZT))
        RU MLG HGZGFH:
            IVGFIM -8
        HVOU.HGZIG_GRNVH += 8
        RU HVOU.OZHG_HGZIG_GRNV RH MLG mLMV ZMW (WZGVGRNV.WZGVGRNV.MLD()-HVOU.OZHG_HGZIG_GRNV).GLGZO_HVXLMWH() < 79:
               IVGFIM -8
        HVOU.OZHG_HGZIG_GRNV = WZGVGRNV.WZGVGRNV.MLD()
        ZITH = []
        RU HVOU.GRNV_HKZM RH MLG mLMV:
            HVOU.GRNV_HKZM.YLLG_GRNVH += 8
            ZITH = HVOU.GRNV_HKZM.ZITH
        GIB:
            HVOU.UIVHS_IFM = uZOHV
            RU OVM(ULIXV_ZITH)!=9:
                ZITH = ULIXV_ZITH
            IVG = HVOU.XZMZIB.IFM(ZITH, VME=HVOU.VME)
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI('%H XZMZIB IFM VMXLFMGVIH VIILI ZH %H'%(HVOU.GZT, HGI(V)))
            IVGFIM -8
        HVOU.YLLG_DLIPRMT = gIFV
        HVOU.XZMZIB.XSVXP(gIFV)
        RU IVG: # NVZMH HGZIGFK OLLPH lp
            # DV XSVXP RU YLLGRMT KILXVHH RH HFXXVHHUFOO
            YLLG = uZOHV
            DSROV MLG YLLG:
                HVOU.RH_IFMMRMT_YB_HFYKILXVHH = gIFV
                HVOU.HGZGFH = 'YLLGRMT'
                GIB:
                    HVOU.KZIHV()
                VCXVKG vCXVKGRLM:
                    HVOU.XZMZIB.XSVXP(gIFV)
                    RU HVOU.XZMZIB.NRHHRLM.HGZGFH_XLWV RH MLG mLMV:
                        HVOU.YLLG_DLIPRMT = uZOHV
                        HVOU.RH_IFMMRMT = uZOHV
                        # HVOU.RH_IFMMRMT_YB_HFYKILXVHH = uZOHV
                        HVOU.OLTTVI.VIILI('%H KILTIZN YLLGRMT UZROVW' % HVOU.GZT)
                        HVOU.OLTTVI.VIILI('%H KILTIZN IVKLIGH VIILI: %H ' % (HVOU.GZT, '\M'.QLRM(HVOU.XZMZIB.OLXZO_OLT)))
                        HVOU.XZMZIB.OLXZO_OLT[:] = []
                        RU HVOU.GRNV_HKZM RH MLG mLMV:
                            HVOU.GRNV_HKZM.LM_YLLG_UZROVW()
                            HVOU.GRNV_HKZM.IVHGZIG_KLORXB.NZIP_GRNV(HVOU.TOLYZO_RMUL.XOLXP)
                        IVGFIM -8
                    XLMGRMFV
                RU RMG(HVOU.IFM_KRW) == RMG(HVOU.XZMZIB.KRW):
                    YLLG = gIFV
                HVOU.XZMZIB.XSVXP(gIFV)
                RU HVOU.XZMZIB.NRHHRLM.HGZGFH_XLWV RH MLG mLMV:
                    HVOU.YLLG_DLIPRMT = uZOHV
                    HVOU.RH_IFMMRMT = uZOHV
                    # HVOU.RH_IFMMRMT_YB_HFYKILXVHH = uZOHV
                    HVOU.OLTTVI.VIILI('%H KILTIZN YLLGRMT UZROVW' % HVOU.GZT)
                    HVOU.OLTTVI.VIILI('%H KILTIZN IVKLIGH VIILI: %H ' % (HVOU.GZT, '\M'.QLRM(HVOU.XZMZIB.OLXZO_OLT)))
                    HVOU.XZMZIB.OLXZO_OLT[:] = []
                    RU HVOU.GRNV_HKZM RH MLG mLMV:
                        HVOU.GRNV_HKZM.LM_YLLG_UZROVW()
                        HVOU.GRNV_HKZM.IVHGZIG_KLORXB.NZIP_GRNV(HVOU.TOLYZO_RMUL.XOLXP)
                    IVGFIM -8
            HVOU.KRW = HVOU.XZMZIB.KRW
            HVOU.RH_IFMMRMT = gIFV
            HVOU.RH_IFMMRMT_YB_HFYKILXVHH = gIFV
            HVOU.HGZIG = WZGVGRNV.WZGVGRNV.MLD()
            RU OVM(ZITH) != 9:
                HVOU.OLTTVI.RMUL('%H YLLGRMT HFXXVHHUFOOB DRGS KRW %H DRGS ZITH %H' % (HVOU.GZT, HGI(HVOU.KRW), ','.QLRM(ZITH)))
            VOHV:
                HVOU.OLTTVI.RMUL('%H YLLGRMT HFXXVHHUFOOB DRGS KRW %H' % (HVOU.GZT, HGI(HVOU.KRW)))
            RU HVOU.GRNV_HKZM RH MLG mLMV:
                HVOU.GRNV_HKZM.LM_YLLG_HFXXVHH()
            HVOU.YLLG_DLIPRMT = uZOHV
            IVGFIM HVOU.KRW
        VOHV:
            HVOU.RH_IFMMRMT = uZOHV
            HVOU.RH_IFMMRMT_YB_HFYKILXVHH = uZOHV
            HVOU.YLLG_DLIPRMT = uZOHV
            RU HVOU.GRNV_HKZM RH MLG mLMV:
                HVOU.GRNV_HKZM.LM_YLLG_UZROVW()
                HVOU.GRNV_HKZM.IVHGZIG_KLORXB.NZIP_GRNV(HVOU.TOLYZO_RMUL.XOLXP)
            HVOU.OLTTVI.VIILI('%H KILTIZN HGZIG UZROVW' % HVOU.GZT)
            HVOU.OLTTVI.VIILI('%H KILTIZN IVKLIGH VIILI: %H ' % (HVOU.GZT, '\M'.QLRM(HVOU.XZMZIB.OLXZO_OLT)))
            HVOU.XZMZIB.OLXZO_OLT[:] = []
            IVGFIM -8


XOZHH hVXFIRGBnZMZTVI(hGZIUOVVGgZHP):
    WVU __RMRG__(HVOU, MLWV, HVGGRMTH):
        GZT = MLWV.URMW('RW').ZGGIRY['EZOFV']
        KILTIZN = FYRJFGRO.IVKOZXV_EVIHRLM(MLWV.URMW('KILTIZN').ZGGIRY['EZOFV'], evihrlm)
        XLMURT = FYRJFGRO.IVKOZXV_EVIHRLM(MLWV.URMW('XLMURT').ZGGIRY['EZOFV'], evihrlm)
        HFKVI(hVXFIRGBnZMZTVI, HVOU).__RMRG__(GZT, KILTIZN,XLMURT,MLWV,uZOHV, HVGGRMTH)
        HVOU.XLNKLMVMG = 'HVXFIRGBNZMZTVI'
        #HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        """NLMRGLI XLNKLMVMG HGZGFH."""
        HFKVI(hVXFIRGBnZMZTVI, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/KFYHFYNZMZTVI.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/HGZIUOVVG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG KBKFYHFY ZH KY
RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
#RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG HFYKILXVHH
RNKLIG GLLO.HSN ZH HSN
RNKLIG LH
RNKLIG KHFGRO
RNKLIG GRNV
# RNKLIG QHLM

XOZHH kFYhFYnZMZTVI(LYQVXG):
    '''
    IVHKLMHRYOV ULI SZMWORMT ZOO GRNV/GRNVI IVOVEZMG
    RHHFVH
    '''
    WVU __RMRG__(HVOU):
        HVOU.HRN_GLKRX = {}
        HVOU.NZC_GLKRX = {}
        HVOU.DZIMRMT = {}
        HVOU.KFYHFY_HGZGFH = uZOHV
        HVOU.GLKRX_ORHG = []
        RU MLG LH.KZGS.RHUROV(LH.KZGS.QLRM('/WVE/HSN', 'kFYhFYhVIERXV')):
            HVOU.KFYHFY_HGZGFH = uZOHV
        VOHV:
            HVOU.IH = HSN.iVZWhSN('kFYhFYhVIERXV')
            HVOU.IVZW_GRNV()
            HVOU.IVZW_KRW()
            RU KHFGRO.KRW_VCRHGH(HVOU.KFYHFY_KRW):
                VKLXS_GRNV = RMG(GRNV.GRNV())
                RU ZYH(VKLXS_GRNV - HVOU.KFYHFY_GRNV) > 39:
                    HVOU.KFYHFY_HGZGFH = uZOHV
                VOHV:
                    HVOU.KFYHFY_HGZGFH = gIFV
                #KIRMG(VKLXS_GRNV, HVOU.KFYHFY_GRNV, HVOU.KFYHFY_HGZGFH)
            VOHV:
                HVOU.KFYHFY_HGZGFH = uZOHV
        DRGS LKVM('/LKG/EVIHRLM/'+evihrlm+'/VGX/KFYHFY.GLKRX.NZCXLFMG') ZH U:
            ORMVH = U.IVZWORMVH()
        ULI ORMV RM ORMVH:
            RU ORMV.HGIRK():
                IVX = ORMV.HGIRK('\M').HKORG()
                HVOU.NZC_GLKRX[IVX[9]] = RMG(IVX[8])
        KZIHVI = xLMURTkZIHVI.iZDxLMURTkZIHVI()
        DRGS LKVM('/IFM/KFYHFY.IFM') ZH UK:
            KZIHVI.IVZWUK(UK)
            HVOU.YILPVIRK = KZIHVI.TVG('KFYHFY', 'YILPVIRK')
            HVOU.YILPVIKLIG = KZIHVI.TVG('KFYHFY', 'YILPVIKLIG')
        HVOU.HGZGFH_IVKLIG = {}

    WVU HGZIG(HVOU, RH_HRN, XLNNZMWZI, YVZXLM, HVGGRMTH ):
        KY.lKVMkFYHFY()
        HVOU.GLKRX_RMW_ORHG = {}
        HVOU.RH_HRN = RH_HRN
        HVOU.YVZXLM = YVZXLM
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.RH_XLNNZMWZI = XLNNZMWZI
        RU MLG HVOU.RH_HRN:
            HVOU.OLTTVI = HVGGRMTH.OLTTVI
        VOHV:
            HVOU.OLTTVI = mLMV
        HVOU.GLKRX_ORHG = [ R[:-89] ULI R RM WRI(KY) RU R[-89:]=='hFYHXIRYVI'  ]
        ULI GLKRX RM HVOU.GLKRX_ORHG:
            HVOU.HRN_GLKRX[GLKRX] = KY.__WRXG__[GLKRX+'hFYHXIRYVI']()
        RU MLG HVOU.RH_HRN:
            # HVOU.OLTTVI = OLT.oLTTVI('KFYHFY',
                                     # HVOU.HVGGRMTH.OLT_OVEVO,
                                     # (HVOU.HVGGRMTH.OLT_UROV RU MLG HVOU.HVGGRMTH.OLT_KIRMG VOHV ''))
            HVOU.OLTTVI.RMUL('[yllg] KFYHFYNZMZTVI RMRGRZGVW')
        ULI P, E RM HVOU.HRN_GLKRX.RGVNH():
            HVOU.DZIMRMT[P] = 9

    WVU TVG_HFYVI(HVOU, GLKRX):
        IVGFIM KY.__WRXG__[GLKRX+'hFYHXIRYVI']()

    WVU xOVZIgLKRX(HVOU, GLKRX):
        HFYKILXVHH.XZOO('/FHI/OLXZO/YRM/XOVZIgLKRX'
                        + ' '+ HVOU.YILPVIRK
                        + ' '
                        + HVOU.YILPVIKLIG
                        + ' '
                        + GLKRX
                        + ' &>/WVE/MFOO', HSVOO=gIFV)

    WVU vMHFIVxOVZIgLKRX(HVOU, GLKRX):
        HFYKILXVHH.XZOO('/FHI/OLXZO/YRM/XOVZIgLKRX'
                        + ' '+ HVOU.YILPVIRK
                        + ' '
                        + HVOU.YILPVIKLIG
                        + ' '
                        + GLKRX
                        + ' &>/WVE/MFOO', HSVOO=gIFV)
        HFYGLKRX = KY.__WRXG__[GLKRX+'hFYHXIRYVI']()
        HVOU.OLTTVI.RMUL('XOVZI XLNNZMW RHHFVW ULI %H'%GLKRX)
        DSROV HFYGLKRX.tVGrMWVC() != -8:
            GRNV.HOVVK(9.8)
        HVOU.OLTTVI.RMUL('GLKRX %H XOVZIVW'%GLKRX)
        IVGFIM gIFV


    WVU IVHVG_HRN(HVOU):
        HVOU.xOVZIgLKRX('uFGFIVHnwhRN')
        HVOU.xOVZIgLKRX('gyrMKFGuRVOWhRN')
        HVOU.xOVZIgLKRX('gyiVXEuRVOWhRN')


    WVU XLNKROV(HVOU):
        HVOU.GLKRX_RMW_ORHG.XOVZI()
        ULI P RM HVOU.GLKRX_ORHG:
            E = HVOU.HRN_GLKRX[P]
            HVOU.GLKRX_RMW_ORHG[P] = E.tVGrMWVC()

    WVU NLMRGLI(HVOU):
        GLKRX_HGZGFH = {}
        HVOU.HGZGFH_IVKLIG.XOVZI()
        ULI P RM HVOU.GLKRX_ORHG:
            E = HVOU.HRN_GLKRX[P]
            FHZTV = (E.tVGrMWVC()+8)*8.9/HVOU.NZC_GLKRX[P]*899
            GLKRX_HGZGFH[P] = FHZTV
            HVOU.HGZGFH_IVKLIG[P] = (E.tVGrMWVC()+8, HVOU.NZC_GLKRX[P])
        IVGFIM ([(R, '%4.7U'%GLKRX_HGZGFH[R]) ULI R RM HLIGVW(GLKRX_HGZGFH, PVB=GLKRX_HGZGFH.__TVGRGVN__, IVEVIHV=gIFV)])

    WVU XLNKROV_HGZGFH(HVOU):
        IVG = []
        IVG.ZKKVMW('%-79H%0H%88H%0H'%('glkrx', 'rmwvc', 'nzc', 'fhztv'))
        YVZXLM_DZIMRMT = uZOHV
        ULI P RM HVOU.GLKRX_ORHG:
            E = HVOU.HRN_GLKRX[P]
            IVG.ZKKVMW('%-79H%0H%88H%1.7U%8H'%(P, HGI(E.tVGrMWVC()), HGI(HVOU.NZC_GLKRX[P]),  (E.tVGrMWVC()+8)*8.9/HVOU.NZC_GLKRX[P]*899,'%'))
            FHZTV = (E.tVGrMWVC()+8)*8.9/HVOU.NZC_GLKRX[P]*899
            RU HVOU.RH_HRN:
                XLMGRMFV
            RU  (E.tVGrMWVC()+8)*8.9/HVOU.NZC_GLKRX[P]*899 > 19:
                RU HVOU.DZIMRMT[P] == 9:
                    RU MLG HVOU.RH_HRN:
                        HVOU.OLTTVI.XIRGRXZO('%H SZH FHVW %.7U'%(P,FHZTV ))
                    HVOU.DZIMRMT[P] = 8
            VOHV:
                HVOU.DZIMRMT[P] = 9
            YVZXLM_DZIMRMT = HVOU.DZIMRMT[P] LI YVZXLM_DZIMRMT
        RU MLG HVOU.RH_HRN ZMW HVOU.YVZXLM RH MLG mLMV:
            RU YVZXLM_DZIMRMT:
                HVOU.YVZXLM.tZFTV('KFYHFY', 8)
            VOHV:
                HVOU.YVZXLM.tZFTV('KFYHFY', 9)
        IVGFIM IVG

    WVU IVZW_GRNV(HVOU):
        HVOU.KFYHFY_GRNV = RMG.UILN_YBGVH(HVOU.IH.IVZW(5, 1), YBGVLIWVI='ORGGOV')

    WVU IVZW_KRW(HVOU):
        HVOU.KFYHFY_KRW = RMG.UILN_YBGVH(HVOU.IH.IVZW(9, 5), YBGVLIWVI='ORGGOV')


RU __MZNV__ == '__NZRM__':
    IH = HSN.iVZWhSN('kFYhFYhVIERXV')
    KIRMG(IH.IVZW(9, 5))
    KIRMG(RMG.UILN_YBGVH(IH.IVZW(9, 5), YBGVLIWVI='ORGGOV'))
    KIRMG(RMG.UILN_YBGVH(IH.IVZW(5, 1), YBGVLIWVI='ORGGOV'))
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/NLWFOVNZMZTVI.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GRNV
RNKLIG LH
RNKLIG KHFGRO
UILN SVOKVI.FGRO RNKLIG RNKLIG_NLWFOV
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
_lmv_wzb_rm_hvxlmwh = 39 * 39 * 75


XOZHH nLWFOVnZMZTVI(LYQVXG):
    """VNYVWVW XLNKLMVMG LU HGZIUOVVG IVHKLMHRYOV ULI NZMZTRMT NLWFOVH
    """
    WVU __RMRG__(HVOU, TOLYZO_RMUL, MLWV, ILLG_MLWV):
        """XGLI."""
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.CNO = MLWV
        HVOU.ILLG = ILLG_MLWV
        HVOU.NLWFOV_ORHG = []
        HVOU.NLWFOV_MZNV_NZK = {}
        RU HVOU.CNO RH mLMV:
            HVOU.OLTTVI.RMUL('[yllg] nLWFOVnZMZTVI MLG RMRGRZGVW')
        VOHV:
            HVOU.OLTTVI.RMUL('[yllg] nLWFOVnZMZTVI RMRGRZGVW')
            HVOU.OLZW()
        HVOU.QLY = mLMV

    WVU OLZW(HVOU):
        ULI CNO RM HVOU.CNO.URMWZOO('NLWFOV'):
            NLWFOV_RW = CNO.ZGGIRY['RW']
            HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] OLZW %H' % NLWFOV_RW)
            RU _XFIIVMG_ILLG RM HVOU.TOLYZO_RMUL.XORVMG_KZGS:
                IZD_HVZIXS_KZGS = HVOU.TOLYZO_RMUL.XORVMG_KZGS
            VOHV:
                IZD_HVZIXS_KZGS = HVOU.TOLYZO_RMUL.XORVMG_KZGS + [_XFIIVMG_ILLG]
            HVZIXS_KZGS = [LH.KZGS.QLRM(R, 'NLWFOVH', NLWFOV_RW) ULI R RM IZD_HVZIXS_KZGS]
            (XOZHHLK, WVHG_KZGS) = RNKLIG_NLWFOV(NLWFOV_RW, HVZIXS_KZGS )

            RU LH.KZGS.VCRHGH(LH.KZGS.QLRM(LH.KZGS.WRIMZNV(WVHG_KZGS), 'XLNNZMW','XLNNZMWH')):
                HVOU.TOLYZO_RMUL.XNW_KZGS.ZKKVMW( LH.KZGS.QLRM(LH.KZGS.WRIMZNV(WVHG_KZGS), 'XLNNZMW','XLNNZMWH') )
            NLW = XOZHHLK(CNO, HVOU.ILLG, HVOU.TOLYZO_RMUL)
            NLW.__UROV__ = WVHG_KZGS
            NLW.__NLWFOV_RW__ = NLWFOV_RW
            HVOU.NLWFOV_ORHG.ZKKVMW([NLW, mLMV, -8, 'fmpmldm']) # MZNV, K, KRW, HGZGFH

    WVU URMW_NLWFOV(HVOU, MZNV):
        IVG  = mLMV
        ULI NLW RM HVOU.NLWFOV_ORHG:
            RU NLW[9].__NLWFOV_RW__ == MZNV:
                IVG = NLW[9]
        IVGFIM IVG

    WVU HGZIG(HVOU):
        ULI NLW_VOV RM HVOU.NLWFOV_ORHG:
            NLW_VOV[9].IVOLZW()
        HVOU.QLY = qLY(HVOU, HVOU.TOLYZO_RMUL.XKF_XLIVH)
        HVOU.QLY.HGZIG()

    WVU XLNKROV_NLWFOV_HGZGFH(HVOU):
        IVG = []
        ULI NLW_KZXPVG RM HVOU.NLWFOV_ORHG:
            IVG.ZKKVMW('%H|%W|%H'%(NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG[7], NLW_KZXPVG[6]))
        IVGFIM IVG


    WVU HGLK(HVOU):
        ULI NLW RM HVOU.NLWFOV_ORHG:
            NLW[9].HGLK()

    WVU IFM(HVOU):
        HVOU.IFMMRMT_HGZGFH = [KHFGRO.hgzgfh_ifmmrmt, KHFGRO.hgzgfh_hovvkrmt, KHFGRO.hgzgfh_wrhp_hovvk, KHFGRO.hgzgfh_dzprmt]
        HVOU.OLTTVI.RMUL("[nLWFOVnZMZTVI] nLWFOVnZMZTVI HGZIGH GL IFM HVKZIZGV NLWFOVH")
        ULI NLW_KZXPVG RM HVOU.NLWFOV_ORHG:
            NLW_KZXPVG[8] = qLY(NLW_KZXPVG[9], HVOU.TOLYZO_RMUL.XKF_XLIVH, HVOU.OLTTVI)
            NLW_KZXPVG[8].HGZIG()
            HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] GIBRMT GL ZXGREZGV NLWFOV %H' % (NLW_KZXPVG[9].__NLWFOV_RW__)  )
            DSROV NLW_KZXPVG[8].K RH mLMV:
                GRNV.HOVVK(9.8)
            HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] ZXGREZGVW NLWFOV RW %H DRGS GSIVZW RW %W' % (NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG[8].GRW))
            NLW_KZXPVG[7] = NLW_KZXPVG[8].GRW
        HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] HGZIGH GL NLMRGLI NLWFOV HGZGFH LM GSIVZW %W' % FYRJFGRO.TVG_GRW())
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            ULI NLW_KZXPVG RM HVOU.NLWFOV_ORHG:
                GIB:
                    HGZGFH = NLW_KZXPVG[8].K.HGZGFH()
                    NLW_KZXPVG[6] = HGZGFH
                VCXVKG vCXVKGRLM ZH V:
                    HGZGFH = 'LUUORMV'
                    NLW_KZXPVG[6] = HGZGFH
                # KIRMG(NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG)
                HVOU.NLWFOV_MZNV_NZK[NLW_KZXPVG[9].__NLWFOV_RW__] = NLW_KZXPVG[9]
                RU HGZGFH MLG RM HVOU.IFMMRMT_HGZGFH:
                    HVOU.OLTTVI.VIILI('[nLWFOVnZMZTVI] %H RH RM HGZGFH %H'%(NLW_KZXPVG[9].__NLWFOV_RW__, HGZGFH))
                    HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] IVHGZIG %H' % (NLW_KZXPVG[9].__NLWFOV_RW__))
                    NLW_KZXPVG[8] = qLY(NLW_KZXPVG[9], HVOU.TOLYZO_RMUL.XKF_XLIVH, HVOU.OLTTVI)
                    NLW_KZXPVG[8].HGZIG()
                    DSROV NLW_KZXPVG[8].K RH mLMV:
                        GRNV.HOVVK(9.8)
                    HVOU.OLTTVI.RMUL('[nLWFOVnZMZTVI] ZXGREZGVW NLWFOV RW %H DRGS GSIVZW RW %W' % (NLW_KZXPVG[9].__NLWFOV_RW__, NLW_KZXPVG[8].GRW))
                    NLW_KZXPVG[7] = NLW_KZXPVG[8].GRW

            #glwl XSVXP VZXS NLWFOV'H HGZGFH
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/LKIVXLIWNZMZTVI.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
UILN FYRJKBZGZNLWVO RNKLIG NLWVO
RNKLIG TVGKZHH
RNKLIG HLXPVG
RNKLIG TVGKZHH
UILN MVGDLIPC.IVZWDIRGV RNKLIG QHLM_TIZKS
RNKLIG QHLM
RNKLIG KKIRMG
XOZHH qLYiVXLIWVI(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.NTI = NLWVO.wZGZnZMZTVI()

    WVU ZWW_MVD_QLY(HVOU, QLY):
        HVOU.FKWZGV_QLY(QLY)

    WVU FKWZGV_LK(HVOU, QLY_RW, LK_RW, LK_HGZGFH):
        HVHH = HVOU.NTI.tVGhVHHRLM()
        GIB:
            LK = NLWVO.wZGZUOLDlKiVXLIW(
                        qLYrW = QLY_RW,
                        lKrW  = LK_RW,
                        hGZGFH = LK_HGZGFH)
            HVHH.NVITV(LK)
        URMZOOB:
            HVHH.XLNNRG()
            KZHH

        IVGFIM mLMV

    WVU FKWZGV_QLY(HVOU, QLY):
        # [C.HGIRK() ULI C RM HFYLKCNO.ZGGIRY["WVKVMWVMXRVH"].HKORG(',')]
        HVHH = HVOU.NTI.tVGhVHHRLM()
        GIB:
            WYQLY = NLWVO.wZGZUOLDqLY(
                rW = QLY.rW,
                wZGZUOLDrW = QLY.DLIPUOLD_RW,
                wzt        = QHLM.WFNKH(QHLM_TIZKS.MLWV_ORMP_WZGZ(QLY.WZT)),
                iVJFVHGyB  = TVGKZHH.TVGFHVI(),
                iVJFVHGgRNV= WZGVGRNV.WZGVGRNV.MLD(),
                hGZGFH     = QLY.HGZGFH,
                lKH        = [
                    NLWVO.wZGZUOLDlKiVXLIW(
                        qLYrW = QLY.rW,
                        lKrW  = LK.RW,
                        hGZGFH = LK.HGZGFH
                    )
                    ULI LK RM QLY.XLMGVCG.DLIPVIH.EZOFVH()
                ]
            )

            HVHH.NVITV(WYQLY)
        URMZOOB:
            HVHH.XLNNRG()
            KZHH
            # HVHH.IVNLEV()
        IVGFIM mLMV

    WVU IVHVG(HVOU):
        KZHH

XOZHH lKiVXLIWnZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU, GIVV):
        GBKV = 'VNKGB'
        RU GIVV.URMW('IVXLIWVI'):
            IVXLIWVI_CNO = GIVV.URMW('IVXLIWVI')
            GBKV = IVXLIWVI_CNO.TVG('GBKV')

        RU GBKV == 'WY':
            HVOU.IVXLIWVI = wyiVXLIWVI(GIVV)
            RU MLG HVOU.IVXLIWVI.gVHG():
                IZRHV vCXVKGRLM('xZMMLG XLMMVXG GL IVXLIWVI WY')
        VOHV:
            # IVXLIWVI = wyiVXLIWVI(GIVV)
            # RU IVXLIWVI.gVHG():
            #     HVOU.IVXLIWVI = wyiVXLIWVI(GIVV)
            # VOHV:
            #     HVOU.IVXLIWVI = vNKGBiVXLIWVI(GIVV)
            HVOU.IVXLIWVI = vNKGBiVXLIWVI(GIVV)

    WVU tVGiVXLIWVI(HVOU):
        IVGFIM HVOU.IVXLIWVI


XOZHH wyiVXLIWVI(LYQVXG):
    WVU __RMRG__(HVOU, XLMURT):
        HVOU.HGZGFH = uZOHV
        HVOU.NTI = NLWVO.wZGZnZMZTVI()
        HVOU.HVHH = HVOU.NTI.tVGhVHHRLM()
        HVOU.FHVI = TVGKZHH.TVGFHVI()
        HVOU.NZXSRMV = HLXPVG.TVGSLHGMZNV()
        HVOU.XLMURT = XLMURT
    WVU gVHG(HVOU):
        IVGFIM HVOU.NTI.gVHG()

    WVU iVXLIW(HVOU, LK, HGZGFH):
        lKmZNV = LK.RW
        IVXLIW = NLWVO.lKiVXLIW(
            rW = "%H.%H.%H" % (HVOU.NZXSRMV, HVOU.XLMURT.TVGILLG().GZT, lKmZNV),
            lKmZNV  = lKmZNV,
            nZXSRMV = HVOU.NZXSRMV,
            xLMURT  = "",
            oZHGiFM = WZGVGRNV.WZGVGRNV.MLD(),
            hGZGFH  = HGZGFH,
            iFMyB   = HVOU.FHVI,
            lKgBKV  = "HGZIUOVVG",
        )
        HVOU.HVHH.NVITV(IVXLIW)
        HVOU.HVHH.XLNNRG()

XOZHH vNKGBiVXLIWVI(LYQVXG):
    WVU __RMRG__(HVOU, XLMURT):
        KZHH

    WVU gVHG(HVOU):
        IVGFIM GIFV

    WVU iVXLIW(HVOU, LK, HGZGFH):
        KZHH

RU __MZNV__ == '__NZRM__':
    RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
    GIVV = VGIVV.UILNHGIRMT('''
<HGZIUOVVG_DJRM>
    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />
    <HGZGHW SLHG="HS.FYRJFZMG.XLN" KLIG="1874" IVKLIG_HVOU="UZOHV"/>
    <IVXLIWVI GBKV="WY" />
    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="6:80:99">
        <LKVIZGRLM RW='XZRGLMT_VNZRO' NLWFOV="xZRGLMTwZROBvNZRO" GRNV_IZMTV="7:79-76:79" VEVIB_GL_HFXXVHH="7H"
                   IVOLZW="6:99,4:59"  MVD_GSIVZW="GIFV" VNZRO_GL="YUZM@FYRJFZMG.XLN" KZGS="/SLNV/YUZM/rMHVIGlIWVI_${bbbbnnww}"  >
        </LKVIZGRLM>
    </LKVIZGRLMH>
    <GZHPH>
        <NZIPVGVBV KLHHVHH="gIFV" RM_GIFHG="uZOHV">
            <RW  EZOFV="NZIPVGVBV"/>
            <KILTIZN EZOFV="/LKG/NZIPVGVBV/YRM/NZIPVGVBV" />
            <XLMURT EZOFV="NZIPVGVBV.CNO"/>
        </NZIPVGVBV>
    </GZHPH>
    <WVKVMWVMXRVH>
    </WVKVMWVMXRVH>
</HGZIUOVVG_DJRM>
    ''')

    NZMZTVI = lKiVXLIWnZMZTVI(GIVV)
    IVXLIWVI = NZMZTVI.tVGiVXLIWVI()
    LKVIZGRLMH_CNO = GIVV.URMW('LKVIZGRLMH')
    LKVIZGRLM_ORHG = LKVIZGRLMH_CNO.URMWZOO('LKVIZGRLM')
    ULI LK_CNO RM LKVIZGRLM_ORHG:
        IVXLIWVI.iVXLIW(LK_CNO, 'hfxx')
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/HLK.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN SVOKVI.FGRO RNKLIG RNKLIG_HLK
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG LH
RNKLIG KBRMLGRUB
RNKLIG GIZXVYZXP




XOZHH hlknLMRGLI(LYQVXG):
    WVU __RMRG__(HVOU, KZGS, TOLYZO_RMUL):
        HVOU.KZGS = KZGS
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.HLK_KLLO = {} # XNW MZNV -> XNW
        HVOU.HLK_KZGS_NZK = {} # XNW_KZGS -> XNW
        ULI HFYWRIH, WRIH, UROVH RM LH.DZOP(LH.KZGS.QLRM(HVOU.KZGS, 'HLK')):
            ULI U RM UROVH:
                RU U[:5] == 'HLK_' ZMW U[-6:] == '.KB':
                    (XOZHHLK, WVHG_KZGS) = RNKLIG_HLK(U[:-6], LH.KZGS.QLRM(HVOU.KZGS, 'HLK'))
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    RU XNW.HLK RM HVOU.HLK_KLLO:
                        IZRHV eZOFVvIILI('hlk %H RH ZOIVZWB OLZWVW'%XNW.HLK)
                    VOHV:
                        HVOU.HLK_KLLO[XNW.HLK] = XNW
                        HVOU.HLK_KZGS_NZK[XNW.__UROV__] = XNW
        HVOU.OLTTVI.RMUL('[yIRWTV] OLZWVW HLK: %H'%','.QLRM([R ULI R RM HVOU.HLK_KLLO]))


    WVU IFM(HVOU):
        XOZHH vEVMGsZMWOVI(KBRMLGRUB.kILXVHHvEVMG):
            WVU __RMRG__(HVOU, NLMRGLI):
                HVOU.NLMRGLI = NLMRGLI

            WVU KILXVHH_rm_xivzgv(HVOU, VEVMG):
                #KIRMG('XIVZGV:', VEVMG.KZGSMZNV)
                U = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)
                #KIRMG(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6], HVOU.NLMRGLI.HLK_KLLO)
                RU U[:5] == 'HLK_' ZMW U[-6:] == '.KB':
                    RU LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[5:-6] RM HVOU.NLMRGLI.HLK_KLLO:
                        IVGFIM
                    HVOU.NLMRGLI.OLTTVI.RMUL('MVD HLK %H OLZWVW'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_HLK(U[:-6], LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.HLK_KLLO[XNW.HLK] = XNW
                    HVOU.NLMRGLI.HLK_KZGS_NZK[XNW.__UROV__] = XNW

            WVU KILXVHH_rm_xolhv_dirgv(HVOU, VEVMG):
                #KIRMG('XOLHV_DIRGV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.HLK_KZGS_NZK:
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW HLK %H'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_HLK(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                          LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.HLK_KLLO[XNW.HLK] = XNW
                    HVOU.NLMRGLI.HLK_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

            WVU KILXVHH_rm_nlevw_gl(HVOU, VEVMG):
                #KIRMG('NLEV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.HLK_KZGS_NZK:
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW HLK %H'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_HLK(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                            LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV))
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    XNW = XOZHHLK()
                    XNW.__UROV__ = WVHG_KZGS
                    HVOU.NLMRGLI.HLK_KLLO[XNW.HLK] = XNW
                    HVOU.NLMRGLI.HLK_KZGS_NZK[VEVMG.KZGSMZNV] = XNW

        DN = KBRMLGRUB.dZGXSnZMZTVI()
        NZHP =  KBRMLGRUB.rm_xivzgv | KBRMLGRUB.rm_xolhv_dirgv | KBRMLGRUB.rm_nlevw_gl
        DN.ZWW_DZGXS(LH.KZGS.QLRM(HVOU.KZGS, 'HLK'), NZHP, IVX=gIFV)
        VS = vEVMGsZMWOVI(HVOU)
        MLGRURVI = KBRMLGRUB.mLGRURVI(DN, VS)
        HVOU.OLTTVI.RMUL('hlk NZMZTVI HGZIGH GL NLMRGLI HLK WRIVXGLIB')
        MLGRURVI.OLLK()

//##**---------------- ./HGZIUOVVG/XLNKLMVMG/GRNVI.KB
RNKLIG WZGVGRNV
RNKLIG GRNV
RNKLIG KLHRC_RKX ZH RKX
RNKLIG NNZK
RNKLIG HBH
RNKLIG LH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN SVOKVI.FGRO RNKLIG KZIHV_GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
#RNKLIG FYRJGLLO.OLT  ZH OLT

XOZHH gRNVIiFMMVI(LYQVXG):
    WVU __RMRG__(HVOU, GRNVI, UFMX, ZITF, MLD, OLTTVI):
        HVOU.UFMX = UFMX
        HVOU.ZITF = ZITF
        HVOU.GRNVI = KZIHV_GRNV(GRNVI)
        HVOU.OZHG_GRNV = MLD.GRNV()
        HVOU.IVHFOG = mLMV
        HVOU.OLTTVI = OLTTVI

    WVU XSVXP(HVOU, XOLXP):
        # KIRMG(XOLXP.GRNV(), HVOU.OZHG_GRNV, HVOU.GRNVI)
        RU XOLXP.GRNV() >= HVOU.OZHG_GRNV ZMW XOLXP.GRNV() >= HVOU.GRNVI ZMW HVOU.OZHG_GRNV < HVOU.GRNVI:
            HVOU.OZHG_GRNV = XOLXP.GRNV()
            IVGFIM gIFV
        VORU XOLXP.GRNV() < HVOU.OZHG_GRNV ZMW XOLXP.GRNV() >= HVOU.GRNVI:
            HVOU.OZHG_GRNV = XOLXP.GRNV()
            # KIRMG('GIFV')
            IVGFIM gIFV
        VOHV:
            HVOU.OZHG_GRNV = XOLXP.GRNV()
            IVGFIM uZOHV

    WVU IFM(HVOU):
        HVOU.IVHFOG = mLMV
        GIB:
            HVOU.OLTTVI.RMUL('[gRNVI] IFMH QLY')
            HVOU.IVHFOG = HVOU.UFMX(HVOU.ZITF)
        VCXVKG vCXVKGRLM ZH V:
            HVOU.IVHFOG = HGI(V)
            HVOU.OLTTVI.VIILI('[gRNVI] IFMH QLY DRGS viili:%H'%HGI(V))

XOZHH gRNVI():
    '''
    IVHKLMHRYOV ULI SZMWORMT ZOO GRNV/GRNVI IVOVEZMG
    RHHFVH
    '''
    WVU __RMRG__(HVOU, HGZIG, HRN, TOLYZORMUL, XOLXP, VCXSZMTV_RMUL):
        # MKBHXIVVM ULIN DRWTVG, KZIVMG LU ZOO DRWTVGH RM tfr
        HVOU.MLD = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.TOLYZORMUL = TOLYZORMUL
        HVOU.XOLXP = XOLXP
        HVOU.FHVW_XOLXP = TOLYZORMUL._FHVW_XOLXP
        HVOU.VCXSZMTV_RMUL = VCXSZMTV_RMUL
        HVOU.HGZIG_FH = RMG(HGZIG) # HGZIG NRXILHVXLMWH LU GSV KILTIZN
        VKLXS = WZGVGRNV.WZGVGRNV(8029, 8, 8)
        HVOU.HGZIG = VKLXS + WZGVGRNV.GRNVWVOGZ(SLFIH=1, NRXILHVXLMWH=HVOU.HGZIG_FH)
        HVOU.VOZKHVW = HVOU.MLD - HVOU.HGZIG
        HVOU.HRN = HRN
        HVOU.HGLK = uZOHV
        HVOU.HRN_HKVVW = 8
        HVOU.IFMMRMT = uZOHV
        HVOU.KZFHV = uZOHV
        HVOU.KZFHV_ZXXFNFOZGRLM = 9
        HVOU.KZFHV_HGZIG = mLMV
        HVOU.GZT = TOLYZORMUL.HGZIUOVVG_GZT
        RU HVOU.HRN:
            NN = RKX.hSZIVWnVNLIB("HGZIUOVVG_GRNV", UOZTH=RKX.l_xivzg|RKX.l_gifmx,NLWV=9L222, HRAV=5903)
            RU LH.HGZG("/WVE/HSN/HGZIUOVVG_GRNV").HG_FRW == LH.TVGFRW():
                LH.XSNLW("/WVE/HSN/HGZIUOVVG_GRNV", 9L222)
            HVOU.NN_GRNV = NNZK.NNZK(NN.UW, 5903)
            NN.XOLHV_UW()
            NN = RKX.hSZIVWnVNLIB("HGZIUOVVG_HGZIG", UOZTH=RKX.l_xivzg|RKX.l_gifmx,NLWV=9L222, HRAV=5903)
            RU LH.HGZG("/WVE/HSN/HGZIUOVVG_HGZIG").HG_FRW == LH.TVGFRW():
                LH.XSNLW("/WVE/HSN/HGZIUOVVG_HGZIG", 9L222)
            HVOU.NN_HGZIG = NNZK.NNZK(NN.UW, 5903)
            NN.XOLHV_UW()
        HVOU.VCRG = uZOHV
        HVOU.HRN_HGZIG_HGI = ""
        HVOU.HRN_VMW_HGI = ""
        HVOU.OZHG_SVZIGYVZG = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.OLTTVI = mLMV
        RU MLG HVOU.HRN:
            HVOU.OLTTVI = HVOU.TOLYZORMUL.OLTTVI
            HVOU.OLTTVI.RMUL("[yllg] HGZIUOVVG GRNVI RMRGRZGVW")
        HVOU.QLY_ORHG = []


    WVU DIRGV7HSZIVW(HVOU):
        HVOU.NN_GRNV.HVVP(9)
        HVOU.NN_GRNV.DIRGV("%-74H"%HGI(RMG(HVOU.HRN_MLD)))


    WVU NROO7GRNV(HVOU, NH):
        IVGFIM WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(NH/8999/8999)


    WVU IVHVG_HRN(HVOU):
        HVOU.HRN_MLD = HVOU.HRN_HGZIG


    WVU HRN_HVG(HVOU, HGZIG_HGI, VMW_HGI, HKVVW=8):
        HGZIG = WZGVGRNV.WZGVGRNV.HGIKGRNV(HGZIG_HGI, "%b%N%W %s:%n:%h")
        VMW = WZGVGRNV.WZGVGRNV.HGIKGRNV(VMW_HGI, "%b%N%W %s:%n:%h")
        HVOU.HRN_HGZIG_HGI = HGZIG_HGI
        HVOU.HRN_VMW_HGI = VMW_HGI
        HVOU.HRN_HKVVW = HKVVW
        HVOU.HRN = gIFV
        HVOU.HRN_HGZIG_WG = HGZIG
        HVOU.HRN_VMW_WG = VMW
        HVOU.HRN_HGZIG = (HGZIG - WZGVGRNV.WZGVGRNV(8029, 8, 8, 1)).GLGZO_HVXLMWH()*8999*8999
        HVOU.HRN_VMW = (VMW - WZGVGRNV.WZGVGRNV(8029, 8, 8, 1)).GLGZO_HVXLMWH()*8999*8999
        HVOU.HRN_MLD = HVOU.HRN_HGZIG
        HVOU.NN_HGZIG.HVVP(9)
        HVOU.NN_HGZIG.DIRGV("%-74H"%HGI(RMG(HVOU.HRN_HGZIG)))
        HVOU.NN_GRNV.HVVP(9)
        HVOU.NN_GRNV.DIRGV("%-74H"%HGI(RMG(HVOU.HRN_HGZIG)))


    WVU HRN_IVHVG(HVOU):
        HVOU.NN_HGZIG.HVVP(9)
        HVOU.NN_HGZIG.DIRGV("%-74H"%HGI(RMG(HVOU.HRN_HGZIG)))
        HVOU.NN_GRNV.HVVP(9)
        HVOU.NN_GRNV.DIRGV("%-74H"%HGI(RMG(HVOU.HRN_HGZIG)))




    WVU NROOR_WRUU(HVOU, GRNV8, GRNV7):
        IVGFIM (GRNV8-GRNV7).GLGZO_HVXLMWH()*8999


    WVU HRN_YVTRM(HVOU):
        HVOU.IVZO_HGZIG = WZGVGRNV.WZGVGRNV.MLD()

    WVU HRN_KZFHV(HVOU):
        HVOU.FKWZGV()
        HVOU.KZFHV = gIFV
        HVOU.IFMMRMT = uZOHV
        HVOU.IVZO_MLD = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.KZFHV_HGZIG = HVOU.IVZO_MLD


    WVU HRN_XLMGRMFV(HVOU):
        HVOU.FKWZGV()
        HVOU.KZFHV = uZOHV
        HVOU.IFMMRMT = gIFV
        HVOU.IVZO_MLD = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.KZFHV_ZXXFNFOZGRLM += (HVOU.IVZO_MLD - HVOU.KZFHV_HGZIG).GLGZO_HVXLMWH() * 8999 * 8999 * HVOU.HRN_HKVVW


    WVU HRN_FKWZGV(HVOU):
        RU MLG HVOU.KZFHV:
            HVOU.IVZO_MLD = WZGVGRNV.WZGVGRNV.MLD()
            HVOU.HRN_MLD = HVOU.HRN_HGZIG - HVOU.KZFHV_ZXXFNFOZGRLM + ( HVOU.IVZO_MLD - HVOU.IVZO_HGZIG ).GLGZO_HVXLMWH() * 8999 * 8999 * HVOU.HRN_HKVVW
            HVOU.DIRGV7HSZIVW()
            #HVOU.OLTTVI.RMUL('HGZIG:%W  HRN:%W  IVZO_MLD:%H  IVZO_HGZIG:%H'
            #                 %(HVOU.HRN_HGZIG, (HVOU.HRN_MLD), HGI(HVOU.IVZO_MLD), HGI(HVOU.IVZO_HGZIG)))
            RU HVOU.HRN_MLD > HVOU.HRN_VMW:
                HVOU.HGLK = gIFV
        HVOU.FKWZGV()

    WVU IVOLZW(HVOU,HGZIG):
        HVOU.MLD = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.HGZIG_FH = RMG(HGZIG)
        VKLXS = WZGVGRNV.WZGVGRNV(8029, 8, 8)
        HVOU.HGZIG = VKLXS + WZGVGRNV.GRNVWVOGZ(SLFIH=1, NRXILHVXLMWH=HVOU.HGZIG_FH)
        HVOU.VOZKHVW = HVOU.MLD - HVOU.HGZIG


    WVU IVTRHGVI_QLY(HVOU, GRNV, UFMXGRLM, ZITFNVMGH):
        HVOU.QLY_ORHG.ZKKVMW(gRNVIiFMMVI(GRNV, UFMXGRLM, ZITFNVMGH, HVOU.MLD, HVOU.OLTTVI))
        HVOU.QLY_ORHG.HLIG(PVB=OZNYWZ C:C.GRNVI)

    WVU IFM(HVOU):
        DSROV MLG HVOU.VCRG:
            RU MLG HVOU.HGLK:
            #KIRMG HVOU.HRN,HVOU.IFMMRMT
                RU HVOU.HRN ZMW HVOU.IFMMRMT:
                    HVOU.HRN_FKWZGV()
                VOHV:
                    HVOU.FKWZGV()
                RU MLG HVOU.HRN:
                    GRNV.HOVVK(9.4)
                VOHV:
                    GRNV.HOVVK(89/8999999.9)
                ULI QLY RM HVOU.QLY_ORHG:
                    RU QLY.XSVXP(HVOU.MLD):
                        qLY(QLY).HGZIG()


    WVU FKWZGV_XOLXP(HVOU):
        HVOU.XOLXP.FKWZGV()
        ULI P, XOLXP RM HVOU.FHVW_XOLXP.RGVNH():
            XOLXP.FKWZGV()


    WVU HVG_HGZGFH(HVOU, HGZGFH):
        HVOU.HGZGFH = HGZGFH
        HVOU.TVZI = HVOU.HGZGFH.HGZGFH
        RU HVOU.TVZI == "LUUORMV":
            HVOU.HGZIG = HVOU.MLD
            HVOU.VOZKHVW = HVOU.MLD - HVOU.HGZIG


    WVU FKWZGV(HVOU):
        HVOU.MLD = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.FKWZGV_XOLXP()
        RU MLG HVOU.HRN:
            HVOU.OLTTVI.NZRMGVMZMXV()
            RU (HVOU.MLD - HVOU.OZHG_SVZIGYVZG).GLGZO_HVXLMWH() > 39:
                HVOU.OLTTVI.NZRMGVMZMXV()
                HVOU.OLTTVI.RMUL("[SVZIGYVZG] %H RH ZOREV"%HVOU.GZT)
                HVOU.OZHG_SVZIGYVZG = HVOU.MLD
//##**---------------- ./HGZIUOVVG/XLNKLMVMG/SZIWDZIVNLMRGLI.KB
RNKLIG LH
RNKLIG KHFGRO

XOZHH sZIWDZIVnLMRGLI(LYQVXG):

    WVU __RMRG__(HVOU, OLTTVI):
        HVOU.OLTTVI = OLTTVI

    WVU ZOO(HVOU):
        IVHFOG = WRXG()
        IVHFOG['XKF'] = HVOU.XKF()
        IVHFOG['WRHP'] = HVOU.WRHP()
        IVHFOG['NVNLIB'] = HVOU.NVNLIB()
        IVHFOG['RMGVIUZXV'] = HVOU.RMGVIUZXV()
        IVHFOG['HBHRMUL'] = HVOU.HBHGVN_RMUL()
        #KIRMG(IVHFOG)
        IVGFIM IVHFOG

    @HGZGRXNVGSLW
    WVU XKF():
        """
        :IVGFIM:
        {
            "KVIXVMG": 85.7         # XKF UIVJ MLD = FHVI + HBHGVN
            "GRNVH": (FHVI=87.4, MRXV=9.9, HBHGVN=6.1, RWOV=17.1, RLDZRG=9.1, RIJ=9.9, HLUGRIJ=9.8, HGVZO=9.9, TFVHG=9.9)
        }
        """
        IVG = WRXG()
        GIB:
            IVG['KVIXVMG'] = KHFGRO.XKF_KVIXVMG()
            IVG['GRNVH'] = KHFGRO.XKF_GRNVH_KVIXVMG()
            IVG['HGZGH'] = KHFGRO.XKF_HGZGH()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI(HGI(V))
        IVGFIM IVG

    @HGZGRXNVGSLW
    WVU WRHP():
        """
        :IVGFIM:
        {
            "NLFMGH":
        }
        """

        WRHP = ORHG()
        # WRHP['RL_XLFMGH'] = KHFGRO.WRHP_RL_XLFMGVIH(KVIWRHP=gIFV)
        GIB:
            NLFMGH = KHFGRO.WRHP_KZIGRGRLMH()
            ULI KZIGRGRLM RM NLFMGH:
                RGVN = WRXG()
                # RGVN['WVERXV'], RGVN['NLFMGKLRMG'], RGVN['UHGBKV'], RGVN['LKGH'] = KZIGRGRLM
                # RGVN['GLGZO'], RGVN['FHVW'], RGVN['UIVV'], RGVN['KVIXVMG'] = KHFGRO.WRHP_FHZTV(RGVN['NLFMGKLRMG'])
                RGVN['WVERXV'] = KZIGRGRLM
                RGVN['FHZTV'] = KHFGRO.WRHP_FHZTV(KZIGRGRLM.NLFMGKLRMG)
                WRHP.ZKKVMW(RGVN)
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI(HGI(V))
        IVGFIM WRHP

    @HGZGRXNVGSLW
    WVU NVNLIB():
        NVN = WRXG()
        GIB:
            NVN['NVNLIB'] = KHFGRO.ERIGFZO_NVNLIB()
            NVN['HDZK'] = KHFGRO.HDZK_NVNLIB()
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
        IVGFIM NVN

    @HGZGRXNVGSLW
    WVU RMGVIUZXV():
        MRX = WRXG()
        GIB:
            MRX['HMVGRL'] = KHFGRO.MVG_RL_XLFMGVIH()
            MRX['KVIMRX'] = KHFGRO.MVG_RL_XLFMGVIH(KVIMRX=gIFV)
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
        IVGFIM MRX

    @HGZGRXNVGSLW
    WVU HBHGVN_RMUL():
        HBHRMUL = WRXG()
        IVGFIM HBHRMUL

RU __MZNV__ == '__NZRM__':
    LYQ = sZIWDZIVnLMRGLI()
    LYQ.ZOO()
//##**---------------- ./HGZIUOVVG/NLWFOVH/SZIWDZIVRMUL/SZIWDZIVRMUL.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GRNV
RNKLIG LH
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
UILN XLNKLMVMG.SZIWDZIVNLMRGLI RNKLIG sZIWDZIVnLMRGLI
RNKLIG GLLO.XKFRMUL ZH XKFRMUL
UILN GLLO.YZHVRMUL RNKLIG yZHVrMUL
RNKLIG QHLM
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
UILN FYRJKBZGZNLWVO.NLWVO RNKLIG hVIEVIhGZGFH, wZGZnZMZTVI
RNKLIG KRXPOV
RNKLIG WZGVGRNV

XOZHH SZIWDZIVRMUL(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''
    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.WZGZ_NZMZTVI = wZGZnZMZTVI()
        HVOU.HVHHRLM = HVOU.WZGZ_NZMZTVI.tVGhVHHRLM()
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.YZHV_RMUL = yZHVrMUL()
        HVOU.XFIIVMG_XKF = QHLM.WFNKH(XKFRMUL.XKF.RMUL)
        RU 'NZRMYZHV' RM MLWV.ZGGIRY:
            HVOU.HVIEVI_GZT = MLWV.ZGGIRY['NZRMYZHV']
        VOHV:
            HVOU.HVIEVI_GZT = TOLYZO_RMUL._NZRMYZHV
        TOLYZO_RMUL.OLTTVI.RMUL('[yllg] SZIWDZIVRMUL VMTZTVH NZRMYZHV-> %H '%HVOU.HVIEVI_GZT)

        # HVOU.IVXLIW = HVOU.HVHHRLM.JFVIB(hVIEVIhGZGFH).UROGVI(hVIEVIhGZGFH.mZNV == HVOU.TOLYZO_RMUL.SLHG).URIHG()
        HVOU.IVXLIW = hVIEVIhGZGFH()
        HVOU.IVXLIW.mZNV = HVOU.TOLYZO_RMUL.SLHG
        HVOU.IVXLIW.xkf_RMUL = HVOU.XFIIVMG_XKF
        HVOU.IVXLIW.nVNLIB_RMUL = QHLM.WFNKH(HVOU.YZHV_RMUL.NVNLIB())
        HVOU.IVXLIW.mVGDLIP_RMUL = QHLM.WFNKH(HVOU.YZHV_RMUL.RMGVIUZXV())
        HVOU.IVXLIW.eVIHRLM = HVOU.TOLYZO_RMUL.EVIHRLM
        # HVOU.HVHHRLM.NVITV(HVOU.IVXLIW)
        # HVOU.HVHHRLM.XLNNRG()
        HVOU.ZOO_WZGZ = {}
        HVOU.ZOO_WZGZ['XKF'] = HVOU.XFIIVMG_XKF
        HVOU.ZOO_WZGZ['NVNLIB'] = HVOU.YZHV_RMUL.NVNLIB()
        HVOU.ZOO_WZGZ['MVGDLIP'] = HVOU.YZHV_RMUL.RMGVIUZXV()
        HVOU.ZOO_WZGZ['EVIHRLM'] =  HVOU.TOLYZO_RMUL.EVIHRLM
        HVOU.ZOO_WZGZ['XLNKLMVMG_EVIHRLM'] = HVOU.TVG_XLNKLMVMG_EVIHRLM()


        HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.IVKLIG_GRNVH = 9
        HVOU.SZIWDZIV_NLMRGLI = sZIWDZIVnLMRGLI(HVOU.OLTTVI)
        HVOU.IFMGRNV_SZIWDZIV_WZGZ = mLMV
        HVOU.IFMGRNV_SZIWDZIV_WZGZ_gh = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.OZHG_IFMGRNV_SZIWDZIV_WZGZ_gh = WZGVGRNV.WZGVGRNV.MLD()

        HVOU.IVKLIG = ''
        HVOU.IVKLIG_rw = ''

    WVU TVG_XLNKLMVMG_EVIHRLM(HVOU):
        WZGZ = {}
        DRGS LKVM(LH.KZGS.QLRM('/LKG', 'EVIHRLM', HVOU.TOLYZO_RMUL.EVIHRLM, 'EVIHRLM.SVZW'), 'I') ZH U:
            ULI ORMV RM U:
                RU '[' RM ORMV:
                    XLMGRMFV
                VOHV:
                    KILTIZN = ORMV.HKORG()[9].HKORG('=')[9].HGIRK()
                    SVZW = ORMV.HKORG()[9].HKORG('=')[8].HGIRK()
                    WZGZ[KILTIZN] = SVZW
        IVGFIM QHLM.WFNKH(WZGZ)

    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW == 'IVJFVHG-SZIWDZIVRMUL':
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, WZGZ=HVOU.XFIIVMG_XKF)
        VORU QLY.XLNNZMW == 'IVKLIG-SZIWDZIVRMUL-IFMGRNV':
            HVOU.IFMGRNV_SZIWDZIV_WZGZ = KRXPOV.OLZWH(QLY.QLY)
            HVOU.IFMGRNV_SZIWDZIV_WZGZ_gh = WZGVGRNV.WZGVGRNV.MLD()
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV)



    WVU IFM(HVOU):
        DSROV gIFV:
            IVKLIG = ''
            IVKLIG_rw = ''
            DSROV IVKLIG == '':
                IVG = HVOU.TOLYZO_RMUL.ZXJFRIV_NZRMYZHV(HVOU.HVIEVI_GZT)
                RU IVG RH mLMV:
                    GRNV.HOVVK(8)
                VOHV:
                    IVKLIG = IVG.HKORG('&')[8]
                    IVKLIG_rw = IVG.HKORG('&')[9]


            RU  HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG RH MLG mLMV:
                IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG

                RU IVKLIG != HVOU.IVKLIG LI IVKLIG_rw != HVOU.IVKLIG_rw:
                    HVOU.OLTTVI.RMUL('[sziwdzivrmul] MVD IVKLIG GZITVG %H.%H'%(IVKLIG_rw, IVKLIG))
                    NHT = IVWHSRUG.MVD_NHT()
                    NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                    NHT.WHG = IVKLIG
                    NHT.XLNNZMW = 'IVKLIG_SZIWDZIVRMUL'
                    NHT.WZGZ = KRXPOV.WFNKH(HVOU.ZOO_WZGZ)
                    NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                    GIB:
                        IVKOB = IVWHSRUG.HVMW(NHT)
                        RU IVKOB.NVHHZTV == 'tllw':
                            HVOU.OLTTVI.RMUL('[sziwdzivrmul] URIHG IVKLIG ->%H HFXXVVWVW'%IVKLIG)
                            HVOU.IVKLIG_rw = IVKLIG_rw
                            HVOU.IVKLIG = IVKLIG
                        VOHV:
                            HVOU.OLTTVI.VIILI("IVKLIG SZIWDZIV VIILI %H"%IVKOB.NVHHZTV)
                            GRNV.HOVVK(8)
                            XLMGRMFV
                    VCXVKG vCXVKGRLM ZH V:
                        HVOU.OLTTVI.VIILI("IVKLIG SZIWDZIV VIILI %H"%HGI(V))
                        GRNV.HOVVK(8)
                        XLMGRMFV

                RU HVOU.IFMGRNV_SZIWDZIV_WZGZ RH MLG mLMV ZMW HVOU.IFMGRNV_SZIWDZIV_WZGZ_gh != HVOU.OZHG_IFMGRNV_SZIWDZIV_WZGZ_gh:
                    NHT = IVWHSRUG.MVD_NHT()
                    NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                    NHT.WHG = HVOU.IVKLIG
                    NHT.XLNNZMW = 'IVKLIG_SZIWDZIVRMUL_IFMGRNV'
                    HVOU.IFMGRNV_SZIWDZIV_WZGZ['FKGRNV'] =HVOU.TOLYZO_RMUL._FKGRNV[9]
                    NHT.WZGZ = KRXPOV.WFNKH(HVOU.IFMGRNV_SZIWDZIV_WZGZ)
                    NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                    GIB:
                        IVKOB = IVWHSRUG.HVMW(NHT)
                        RU IVKOB.NVHHZTV == 'tllw':
                            #KIRMG(IVKOB)
                            HVOU.IVKLIG_GRNVH += 8
                        VOHV:
                            HVOU.OLTTVI.VIILI("IVNLGV HBHGVN IVKLIG IFMGRNV SZIWDZIV VIILI %H"%IVKOB.NVHHZTV)
                    VCXVKG vCXVKGRLM ZH V:
                        HVOU.OLTTVI.VIILI("IVKLIG IFMGRNV SZIWDZIV VIILI %H"%HGI(V))
                    HVOU.OZHG_IFMGRNV_SZIWDZIV_WZGZ_gh = HVOU.IFMGRNV_SZIWDZIV_WZGZ_gh
            GRNV.HOVVK(5)
//##**---------------- ./HGZIUOVVG/NLWFOVH/ZOKSZNZMXORVMG/ZOKSZNZMXORVMG.KB
RNKLIG LH
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GRNV
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
#UILN XLNKLMVMG.SZIWDZIVNLMRGLI RNKLIG sZIWDZIVnLMRGLI
#RNKLIG GLLO.XKFRMUL ZH XKFRMUL
#RNKLIG QHLM
#UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
RNKLIG KRXPOV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG HSFGRO
RNKLIG WZGVGRNV
UILN FYRJGLLO.FGRO RNKLIG KIVGGRUB_CNO

WVU XSVXP_ZOKSZ_WRIVXGLIB(WRIVXGLIB):
    RU MLG LH.KZGS.RHWRI(WRIVXGLIB):
        IZRHV eZOFVvIILI( '%H WLVH MLG VCRHG'%WRIVXGLIB)
    RU MLG LH.ZXXVHH(WRIVXGLIB, LH.d_lp):
        IZRHV eZOFVvIILI( '%H RH MLG DIRGVZYOV'%WRIVXGLIB)
    RU MLG LH.ZXXVHH(WRIVXGLIB, LH.i_lp):
        IZRHV eZOFVvIILI( '%H RH MLG IVZWZYOV'%WRIVXGLIB)


XOZHH ZOKSZNZMXORVMG(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''
    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        # XSVXP WRIVXGLIB
        XSVXP_ZOKSZ_WRIVXGLIB(LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM'))
        HVOU.GIVV = VGIVV.vOVNVMG('ZOKSZNZM_QLYH')
        HVOU.QLY_CNOH = []
        HVOU.CNO = MLWV
        HVOU.OZHG_QLY_CNOH = 9
        # KIVKZIV ZOKSZ_QLY.CNO RU MLG VCRHGVW
        RU MLG LH.KZGS.RHUROV(LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZOKSZNZM_QLY.CNO')):
            DRGS LKVM( LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZOKSZNZM_QLY.CNO'), 'D' ) ZH U:
                U.DIRGV(VGIVV.GLHGIRMT(HVOU.GIVV).WVXLWV('FGU1'))
        # KIVKIV ZIXSREV RU MLG VCRHGVW:
        RU MLG LH.KZGS.VCRHGH(  LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZIXSREV')):
             LH.NZPVWRIH(LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZIXSREV'), 9L299)
        HVOU.IVZW_UILN_CNO()
        HVOU.YZXPFK_GRNV_ORHG = HVOU.CNO.ZGGIRY['YZXPFK'].HKORG(',')
        ULI GRNV RM HVOU.YZXPFK_GRNV_ORHG:
            HVOU.TOLYZO_RMUL.IVTRHGVI_GRNVI_QLY(GRNV.HGIRK(), HVOU.YZXPFK_CNO, mLMV)
        HVOU.MVVW_FKWZGV_CNO = uZOHV

    WVU IVOLZW(HVOU):
        KZHH

    WVU ZWW(HVOU, MLWV):
        GL_IVNLEV = mLMV
        GZT = MLWV.URMW('RW').ZGGIRY['EZOFV'].HGIRK()
        ULI CNO RM HVOU.QLY_CNOH:
            RU CNO.URMW('RW').ZGGIRY['EZOFV'].HGIRK() == GZT:
                GL_IVNLEV = CNO
        RU GL_IVNLEV RH MLG mLMV:
            HVOU.QLY_CNOH.IVNLEV(GL_IVNLEV)
        HVOU.QLY_CNOH.ZKKVMW(MLWV)
        HVOU.MVVW_FKWZGV_CNO = gIFV

    WVU IVNLEV_QLY(HVOU,GZT):
        QLY_CNOH = []
        ULI CNO RM HVOU.QLY_CNOH:
            RU CNO.URMW('RW').ZGGIRY['EZOFV'].HGIRK() != GZT:
                QLY_CNOH.ZKKVMW(CNO)
        HVOU.QLY_CNOH = QLY_CNOH
        HVOU.MVVW_FKWZGV_CNO = gIFV

    WVU FKWZGV_GL_CNO(HVOU):
        #HVOU.OLTTVI.RMUL('%W %W'%(OVM(HVOU.QLY_CNOH), HVOU.OZHG_QLY_CNOH ))
        RU HVOU.MVVW_FKWZGV_CNO:
            RU HVOU.OZHG_QLY_CNOH < OVM(HVOU.QLY_CNOH):
                ULI MVDCNO RM HVOU.QLY_CNOH[HVOU.OZHG_QLY_CNOH:]:
                    HVOU.GIVV.ZKKVMW(MVDCNO)
                HVOU.OLTTVI.RMUL("RMHVIGVW MVD ZOKSZNZM CNOH")
                DRGS LKVM( LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZOKSZNZM_QLY.CNO'), 'D' ) ZH U:
                    U.DIRGV(KIVGGRUB_CNO(HVOU.GIVV))
                    HVOU.OZHG_QLY_CNOH = OVM(HVOU.QLY_CNOH)
            VORU HVOU.OZHG_QLY_CNOH > OVM(HVOU.QLY_CNOH):
                HVOU.OZHG_QLY_CNOH = OVM(HVOU.QLY_CNOH)
                HVOU.GIVV = VGIVV.vOVNVMG('ZOKSZNZM_QLYH')
                HVOU.OLTTVI.RMUL("IVNLEV LOW ZOKSZNZM CNOH")
                ULI CNO RM HVOU.QLY_CNOH:
                    HVOU.GIVV.ZKKVMW(CNO)
                DRGS LKVM( LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZOKSZNZM_QLY.CNO'), 'D' ) ZH U:
                    U.DIRGV(KIVGGRUB_CNO(HVOU.GIVV))
            VOHV:
                HVOU.GIVV = VGIVV.vOVNVMG('ZOKSZNZM_QLYH')
                HVOU.OLTTVI.RMUL("FKWZGV ZOKSZNZM CNOH")
                ULI CNO RM HVOU.QLY_CNOH:
                    HVOU.GIVV.ZKKVMW(CNO)
                DRGS LKVM( LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZOKSZNZM_QLY.CNO'), 'D' ) ZH U:
                    U.DIRGV(KIVGGRUB_CNO(HVOU.GIVV))
        HVOU.MVVW_FKWZGV_CNO = uZOHV


    WVU YZXPFK_CNO(HVOU, ZITF):
        # KIRMG('YZXPFK')
        ULI CNO RM HVOU.QLY_CNOH:
            XDW = CNO.ZGGIRY['XDW']
            # KIRMG(CNO, XDW)
            RU XDW[-8] == '/':
                XDW = XDW[:-8]
            FHVI = LH.KZGS.YZHVMZNV(XDW)
            # KIRMG(FHVI)
            GIB:
                HVOU.OLTTVI.RMUL('[%H] YZXPFK CNO %H'%('ZOKSZNZMXORVMG', FHVI))
                HSFGRO.XLKBUROV(LH.KZGS.QLRM(XDW, 'DLIP.CNO'), LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZIXSREV', '%H.CNO_'%FHVI+WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W')))
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI(HGI(V))


    WVU IVZW_UILN_CNO(HVOU):
        RU LH.KZGS.RHUROV(LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZOKSZNZM_QLY.CNO')):
            DRGS LKVM( LH.KZGS.QLRM('/DLIP', 'ZOKSZNZM', 'ZOKSZNZM_QLY.CNO'), 'I' ) ZH U:
                XLWV = U.IVZW()
                HVOU.GIVV = VGIVV.UILNHGIRMT(XLWV)
        ULI MLWV RM ORHG(HVOU.GIVV.URMWZOO('FHRN')):
            HVOU.QLY_CNOH.ZKKVMW(MLWV)
        HVOU.OZHG_QLY_CNOH = OVM(HVOU.QLY_CNOH)

    WVU KILXVHH_QLY(HVOU, QLY):
        KZHH
        # RU QLY.XLNNZMW == 'IVJFVHG-ZOKSZNZMXORVMG':
            # IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, WZGZ=HVOU.XFIIVMG_XKF)

    WVU IFM(HVOU):
        DSROV gIFV:
            HVOU.FKWZGV_GL_CNO()
            GRNV.HOVVK(4)
//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/NLMRGLIHBHGVN.KB
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
# RNKLIG LH
# RNKLIG KHFGRO
RNKLIG HFYKILXVHH
RNKLIG WZGVGRNV
RNKLIG HRTMZO
UILN GRNV RNKLIG HOVVK
RNKLIG HBH
RNKLIG LH
RNKLIG GIZXVYZXP
RNKLIG OANZ
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
#UILN FYRJGLLO.XZMZIB RNKLIG xZMZIB
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN IVWHSRUG.IWSVOKVI.XORVMG RNKLIG rMHGZOOgZHPhGIFXG
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG KBKFYHFY ZH KY
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
UILN SVOKVI.FGRO RNKLIG KZIHV_GRNV, NRMFH_GRNV, ZWW_GRNV, XSVXP_RM_HVHHRLM, RNKLIG_XSVXPLK
UILN XLNKLMVMG.HBHGVN RNKLIG hGZIUOVVGgZHP, hVXFIRGBnZMZTVI
RNKLIG GLLO.HSN ZH HSN
UILN GLLO.HSNHGZGFH RNKLIG hSNhGZGFH
RNKLIG QHLM
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
RNKLIG KRXPOV
RNKLIG GRNV
UILN FYRJGLLO.GRNVI RNKLIG gRNVI

XOZHH oLTnLMRGLI(LYQVXG):
    WVU __RMRG__(HVOU, TOLYZO_RMUL, XLNKLMVMGH, IVWHSRUG):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.XLNKLMVMGH = XLNKLMVMGH
        HVOU.IVWHSRUG  = IVWHSRUG
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI

    WVU IFM(HVOU):
        DSROV gIFV:
            ULI XLN RM HVOU.XLNKLMVMGH:
                XLN.KZIHV_OLT()
            RU HVOU.IVWHSRUG RH MLG mLMV:
                ULI XLN RM HVOU.XLNKLMVMGH:
                    #HVOU.OLTTVI.RMUL('%W EH %W'%(XLN.XFIIVMG_GLGZO_OLTH, OVM(XLN.GLGZO_OLTH)))
                    RU XLN.XFIIVMG_GLGZO_OLTH < OVM(XLN.GLGZO_OLTH):
                        RU OVM(XLN.GLGZO_OLTH) - XLN.XFIIVMG_GLGZO_OLTH > 8999:
                            NZC_OLT_XLFMG = XLN.XFIIVMG_GLGZO_OLTH + 000
                        VOHV:
                            NZC_OLT_XLFMG = OVM(XLN.GLGZO_OLTH)
                        #NHT = HVOU.IVWHSRUG.MVD_NHT()
                        #NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                        #NHT.WHG = HVOU.TOLYZO_RMUL.IVKLIG_GZITVG
                        #NHT.XLNNZMW = 'IVKLIG_XLNKLMVMG_OLT&'+XLN.GZT
                        #NHT.WZGZ = OANZ.XLNKIVHH('\M'.QLRM(XLN.GLGZO_OLTH[XLN.XFIIVMG_GLGZO_OLTH:NZC_OLT_XLFMG]).VMXLWV())
                        #NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                        #GIB:
                        #    IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
                            #HVOU.OLTTVI.RMUL('%W'%IVKOB.HGZGFH)
                            #HVOU.OLTTVI.RMUL(IVKOB.NVHHZTV)
                            #KIRMG(IVKOB)
                        #    RU IVKOB.HGZGFH:
                        #        XLN.XFIIVMG_GLGZO_OLTH = NZC_OLT_XLFMG
                        #VCXVKG vCXVKGRLM ZH V:
                        #    HVOU.OLTTVI.VIILI(HGI(V))
            GRNV.HOVVK(4)

XOZHH nLMHGVI(hGZIUOVVGgZHP):
    WVU __RMRG__(HVOU, MLWV, GRNVI, TOLYZO_RMUL):
        HVOU.IVHGZIG_ZGGVNKG = 9
        GZT = MLWV.URMW('RW').ZGGIRY['EZOFV']
        KILTIZN = FYRJFGRO.IVKOZXV_EVIHRLM(MLWV.URMW('KILTIZN').ZGGIRY['EZOFV'], evihrlm)
        XLMURT = FYRJFGRO.IVKOZXV_EVIHRLM(MLWV.URMW('XLMURT').ZGGIRY['EZOFV'], evihrlm)
        HVOU.GRNVI = GRNVI
        HFKVI(nLMHGVI, HVOU).__RMRG__(GZT, KILTIZN, XLMURT, MLWV, GRNVI.HRN, TOLYZO_RMUL)
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        RU HVOU.GRNVI.HRN:
            HVOU.HN = HSN.iVZWhSN('HGZIUOVVG_'+HVOU.GZT)
        RU 'LM_WZB' RM MLWV.ZGGIRY:
            HVOU.LM_WZB = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, MLWV.ZGGIRY['LM_WZB'])
        VOHV:
            HVOU.LM_WZB = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, '')
        RU 'RM_HVHHRLM' RM MLWV.ZGGIRY:
            HVOU.RM_HVHHRLM = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, MLWV.ZGGIRY['RM_HVHHRLM'])
        VOHV:
            HVOU.RM_HVHHRLM = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, '')
       # KILTIZNH NZB MVVW GL IFM GSILFTS Z HVIRVH LU XSVXPLKH ULI GIZUURXORTSG
        HVOU.XSVXP_LK = []
        HVOU.OLZW_XSVXPLK()

    WVU IVNLEV_UILN_CNO(HVOU):
        RU MLG HVOU.RH_ZOKSZNZM:
            HVOU.OLTTVI.RMUL('IVNLEV CNO %H'%HVOU.GZT)
            HVOU._KZIVMG_MLWV.IVNLEV(HVOU.MLWV)

    WVU ZWW_GL_CNO(HVOU):
        RU MLG HVOU.RH_ZOKSZNZM:
            HVOU.OLTTVI.RMUL('ZWW CNO %H'%HVOU.GZT)
            HVOU._KZIVMG_MLWV.ZKKVMW(HVOU.MLWV)

    WVU XSVXP_MLGRXV(HVOU):
        HVOU.HSN_HGZGFH.KZIHV_HGZGFH()
        RU HVOU.HSN_HGZGFH.HGZGFH == 9:
            IVGFIM 'LUUORMV'
        VORU HVOU.HSN_HGZGFH.HGZGFH  == 8:
            IVGFIM 'YLLGRMT'
        VORU HVOU.HSN_HGZGFH.HGZGFH  == 7:
            IVGFIM 'LMORMV'
        IVGFIM 'LUUORMV'


    WVU OLZW_XSVXPLK(HVOU):
        """OLZW XSVXPLKH, DSL ZIV GL IFM ZMW WVXRWV IVW/TIVVM ORTSG"""
        XZMWRWZGV_KZGS_ORHG = [LH.KZGS.QLRM(KZGS, 'XSVXPLK') ULI KZGS RM
                               HVOU.TOLYZO_RMUL.XORVMG_KZGS]
        RU HVOU.MLWV.URMW('XSVXPLKH') RH mLMV:
            IVGFIM
        ULI CNO RM HVOU.MLWV.URMW('XSVXPLKH').URMWZOO('XSVXPLK'):
            NLWFOV_MZNV = CNO.ZGGIRY['NLWFOV']
            (XOZHHLK, WVHG_KZGS) = RNKLIG_XSVXPLK(NLWFOV_MZNV, XZMWRWZGV_KZGS_ORHG)
            OLZWVI = XOZHHLK(CNO, HVOU, HVOU.TOLYZO_RMUL)
            OLZWVI.__UROV__ = WVHG_KZGS
            HVOU.OLTTVI.RMUL('[yllg] %H OLZWVW XSVXPLK %H' % (HVOU.GZT, NLWFOV_MZNV))
            HVOU.XSVXP_LK.ZKKVMW(OLZWVI)

    # IVZW HSN GL TVG XFIIVMG HRN HGZGFH
    WVU XSVXP_HRN_HGZGFH(HVOU):
        IVZW_HGZGFH = HVOU.HN.IVZW().HGIRK().HGIRK('9').HGIRK('\9')
        RU IVZW_HGZGFH:
            RU RMG( IVZW_HGZGFH ) == 8:
                HVOU.HGZGFH = 'HGZMWYB'
            VORU RMG(  IVZW_HGZGFH ) == 7:
                HVOU.HGZGFH = 'HRN'
        VOHV:
            HVOU.HGZGFH='HGZIGRMT'


    WVU XSVXP_VGZ(HVOU):
        MLD = HVOU.GRNVI.MLD.GRNV()
        HSLFOW_HGZIG = uZOHV
        ULI GRNVKZRI RM HVOU.GRNV_KZRIH:
            RU XSVXP_RM_HVHHRLM(MLD,  GRNVKZRI.HGZIG,  GRNVKZRI.VMW):
                HSLFOW_HGZIG = HSLFOW_HGZIG LI gIFV


    WVU HRN_IFM(HVOU):
        HVOU.IFMMRMT = HFYKILXVHH.kLKVM([HVOU.KILTIZN, HVOU.XLMURT, '-F'],HSVOO=uZOHV, HGWLFG=HFYKILXVHH.krkv, HGWVII=HFYKILXVHH.krkv)
        HVOU.RH_IFMMRMT = gIFV
        HVOU.KRW = HVOU.IFMMRMT.KRW
        HVOU.RH_IFMMRMT_YB_HFYKILXVHH = gIFV
        IVGFIM HVOU.IFMMRMT.KRW


    WVU XSVXP_RM_GIFHG(HVOU):
        RU HVOU.RH_LMVGRNV ZMW MLG HVOU.UIVHS_IFM:
            IVGFIM
        ULI HFYXLN RM HVOU.HFY_LMVGRNV:
            HFYXLN.XSVXP_RM_GIFHG()
            RU HFYXLN.RH_IFMMRMT:
               IVGFIM
        HSLFOW_HGZIG = uZOHV
        """ULI RM GIFHG KILTIZNH, DV XSVXP RU RG MVVWH GL YV IFM MLD"""
        RU HVOU.RH_KZFHVW:
            IVGFIM
        RU WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W') RM HVOU.VCXOFWV_WZBH:
            HVOU.WZB_ZXGREV = uZOHV
            HVOU.HSLFOW_HGZIG = uZOHV
            IVGFIM
        RU MLG HVOU.LM_WZB.RH_GIZWRMT_WZB():
            HVOU.WZB_ZXGREV = uZOHV
            HVOU.HSLFOW_HGZIG = uZOHV
            IVGFIM
        RU MLG HVOU.RM_HVHHRLM.RH_RM_HVHHRLM():
            HVOU.WZB_ZXGREV = uZOHV
            HVOU.HSLFOW_HGZIG = uZOHV
            IVGFIM
        HVOU.WZB_ZXGREV = gIFV
        MLD = HVOU.GRNVI.MLD.GRNV()
        ULI GRNVKZRI RM HVOU.GRNV_KZRIH:
            RU XSVXP_RM_HVHHRLM(MLD,  GRNVKZRI.HGZIG,  GRNVKZRI.VMW):
                HSLFOW_HGZIG = HSLFOW_HGZIG LI gIFV
                HVOU.GRNV_HKZM = GRNVKZRI
            # TIZXV KVIRLW
            RU XSVXP_RM_HVHHRLM(MLD, NRMFH_GRNV(GRNVKZRI.VMW, WZGVGRNV.GRNVWVOGZ(NRMFGVH=8)), ZWW_GRNV(GRNVKZRI.VMW, WZGVGRNV.GRNVWVOGZ(NRMFGVH=8))):
                IVGFIM
        RU MLG HSLFOW_HGZIG:
            HVOU.GRNV_HKZM = mLMV
            HVOU.RH_NZMFZO_PROO = uZOHV
        RU HSLFOW_HGZIG:
            HVOU.RH_NZMFZO_HGZIG = uZOHV
        # WVXRWV DSVGSVI GSV KILTIZN HSLFOW HGZIG LI MLG
        RU HVOU.RM_GIFHG ZMW MLG HVOU.GRNVI.HRN: # NVZMH DV HSLFOW HGZIG GSV KILTIZN YB LFIHVOEVH
            RU HSLFOW_HGZIG ZMW MLG HVOU.RH_NZMFZO_PROO:
                RU MLG HVOU.RH_IFMMRMT ZMW MLG HVOU.YLLG_DLIPRMT :
                    # HLUG_NZC_VMW HSLFOW YV Z TLLW TIZXV KVIRLW RM DSRXS r LMOB XSVXP HFXXVHH GRNVH
                    RU HVOU.GRNV_HKZM RH MLG mLMV ZMW HVOU.GRNV_HKZM.HLUG_NZC_VMW:
                        RU HVOU.GRNV_HKZM.HFXXVHH_GRNVH > 9:
                            IVGFIM
                    RU HVOU.GRNV_HKZM RH MLG mLMV:
                        RU HVOU.GRNV_HKZM.YLLG_GRNVH == 9:
                            HVOU.OLTTVI.RMUL('%H HGZIG GRNV ZIIREVH, DROO YLLG GSRH XLNKLMVMG', HVOU.GZT)
                            #RU HVOU.HSN_HGZGFH.GIZUURX_ORTSG == hSNhGZGFH.gIZUURXoRTSG.ivw:
                            HVOU.HSN_HGZGFH.RHHFV_ORTSG( hSNhGZGFH.gIZUURXoRTSG.tivvm, 'DZREVW' )
                            HVOU.OLTTVI.RMUL('[gizuurxortsg] RHHFV TIVVM ORTSG ULI %H'%HVOU.GZT)
                            HVOU.IFM()
                        VORU HVOU.GRNV_HKZM.YLLG_GRNVH > 9:
                            RU HVOU.GRNV_HKZM.IVHGZIG_KLORXB.XSVXP_IVHGZIG(HVOU.TOLYZO_RMUL.XOLXP, HVOU.GRNV_HKZM):
                                HVOU.OLTTVI.RMUL('%H, DROO IVYLLG GSRH XLNKLMVMG', HVOU.GZT)
                                HVOU.HSN_HGZGFH.RHHFV_ORTSG( hSNhGZGFH.gIZUURXoRTSG.tivvm, 'DZREVW' )
                                HVOU.OLTTVI.RMUL('[gizuurxortsg] RHHFV TIVVM ORTSG ULI %H'%HVOU.GZT)
                                HVOU.IFM()
                    VOHV:
                        HVOU.OLTTVI.RMUL('%H HGZIG GRNV ZIIREVH, DROO YLLG GSRH XLNKLMVMG', HVOU.GZT)
                        HVOU.HSN_HGZGFH.RHHFV_ORTSG( hSNhGZGFH.gIZUURXoRTSG.tivvm, 'DZREVW' )
                        HVOU.OLTTVI.RMUL('[gizuurxortsg] RHHFV TIVVM ORTSG ULI %H'%HVOU.GZT)
                        HVOU.IFM()
            RU MLG HSLFOW_HGZIG ZMW MLG HVOU.RH_NZMFZO_HGZIG:
                RU HVOU.RH_IFMMRMT:
                    HVOU.OLTTVI.RMUL('%H HGLK GRNV ZIIREVH, DROO HGLK GSRH XLNKLMVMG', HVOU.GZT)
                    HVOU.PROO()

    # XSVXP RU GSV XLNKLMVMG RH LM-HXSVWFOV
    WVU XSVXP_HXSVWFOV(HVOU):
        RU MLG HVOU.LM_WZB.RH_GIZWRMT_WZB():
            HVOU.WZB_ZXGREV = uZOHV
            HVOU.RH_DZIMRMT = uZOHV
            HVOU.HSLFOW_HGZIG = uZOHV
            IVGFIM (uZOHV, uZOHV, 9)
        RU MLG HVOU.RM_HVHHRLM.RH_RM_HVHHRLM():
            HVOU.WZB_ZXGREV = uZOHV
            HVOU.RH_DZIMRMT = uZOHV
            HVOU.HSLFOW_HGZIG = uZOHV
            IVGFIM (uZOHV, uZOHV, 9)
        MLD = HVOU.GRNVI.MLD.GRNV()
        RU HVOU.GRNVI.XOLXP.SLFI < 9: # MLG RM GIZWRMT WZB
            HVOU.WZB_ZXGREV = uZOHV
            HVOU.RH_DZIMRMT = uZOHV
            HVOU.HSLFOW_HGZIG = uZOHV
            IVGFIM (uZOHV, uZOHV, 9)
        HVOU.WZB_ZXGREV = gIFV
        MLG_RM_HKZM = gIFV
        RU OVM(HVOU.GRNV_KZRIH) == 9:
            HVOU.RH_DZIMRMT = uZOHV
            HVOU.HSLFOW_HGZIG = uZOHV
            IVGFIM (uZOHV, uZOHV, 9)
        HSLFOW_HGZIG = 9 # GSRH RH GSV UOZT RMWRXZGRMT DSVGSVI GSRH XLNKLMVMG HSLFOW HGZIG
        # XSVXP HXSVWFOV LMV YB LMV
        ULI GRNVKZRI RM HVOU.GRNV_KZRIH:
            RU  XSVXP_RM_HVHHRLM(MLD,  GRNVKZRI.HGZIG ,  GRNVKZRI.VMW ):
                HVOU.HSLFOW_HGZIG = gIFV
                HSLFOW_HGZIG  = 8
            VOHV:
                HVOU.HSLFOW_HGZIG = uZOHV
                HSLFOW_HGZIG  = 9
            # GSVM DV TREV GSV KILTIZN 8-NRMFGV'H HGZIG YFUUVI
            RU HSLFOW_HGZIG:
                RU MLG HVOU.RH_IFMMRMT ZMW MLG XSVXP_RM_HVHHRLM(MLD, GRNVKZRI.HGZIG, ZWW_GRNV(GRNVKZRI.HGZIG, WZGVGRNV.GRNVWVOGZ(NRMFGVH=8))):
                    # KILTIZN ZXXRWVMGZOOB TL LUUORMV
                    HVOU.RH_DZIMRMT = gIFV
                    RU MLG HVOU.LUUORMV_DZIMRMT:
                        HVOU.OLTTVI.XIRGRXZO(HVOU.GZT + ' FMVCKVXGVWOB WRHVMTZTVW ZG GRNV='+HGI(MLD))
                    HVOU.LUUORMV_DZIMRMT = gIFV
                VOHV:
                    HVOU.RH_DZIMRMT = uZOHV
                    HVOU.LUUORMV_DZIMRMT = uZOHV
                HVOU.LMORM_DZIMRMT = uZOHV  # NFGV ZMB LMORMV DZIMRMT
                MLG_RM_HKZM = uZOHV
            VORU MLG HSLFOW_HGZIG ZMW XSVXP_RM_HVHHRLM(MLD, GRNVKZRI.VMW, ZWW_GRNV(GRNVKZRI.VMW, WZGVGRNV.GRNVWVOGZ(NRMFGVH=8)) ):
                MLG_RM_HKZM = uZOHV
            VOHV:
                MLG_RM_HKZM = MLG_RM_HKZM ZMW gIFV
        RU MLG_RM_HKZM: # KILTIZN HSLFOW MLG YV ZXGREV
            RU HVOU.RH_IFMMRMT:
                HVOU.RH_DZIMRMT = gIFV
                RU MLG HVOU.LMORMV_DZIMRMT:
                    HVOU.OLTTVI.XIRGRXZO( HVOU.GZT+' FMVCKVXGVWOB VMTZTVW')
                HVOU.LMORMV_DZIMRMT = gIFV
            VOHV:
                HVOU.RH_DZIMRMT = uZOHV
                HVOU.LMORMV_DZIMRMT = uZOHV

        RU MLG_RM_HKZM:
            # HVOU.RH_DZIMRMT = uZOHV
            HVOU.LUUORMV_DZIMRMT = uZOHV # NFGV ZMB LUUORMV DZIMRMT
        RU MLG MLG_RM_HKZM:
            HVOU.LMORMV_DZIMRMT = uZOHV
        # KIRMG HVOU.LUUORMV_DZIMRMT, HVOU.LMORMV_DZIMRMT, MLG MLG_RM_HKZM
        IVGFIM (HVOU.LUUORMV_DZIMRMT, HVOU.LMORMV_DZIMRMT, MLG MLG_RM_HKZM)


XOZHH wy(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(wy, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'wy'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(wy, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'

XOZHH nZHHiVOZB(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(nZHHiVOZB, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'NZHHIVOZB'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(nZHHiVOZB, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH xZMZIB(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(xZMZIB, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'XZMZIB'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(xZMZIB, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'

XOZHH rHSRNFIZ(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(rHSRNFIZ, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'RHSRNFIZ'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(rHSRNFIZ, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH hZTZ(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(hZTZ, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'HZTZ'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(hZTZ, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'

XOZHH aLWRZX(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(aLWRZX, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'ALWRZX'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(aLWRZX, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH zMWILNVWRZ(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(zMWILNVWRZ, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'ZMWILNVWRZ'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(zMWILNVWRZ, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH fYRJWMH(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(fYRJWMH, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'FYRJWMH'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(fYRJWMH, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'



XOZHH gVINRGVKRKV(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(gVINRGVKRKV, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'GVINRGVKRKV'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(gVINRGVKRKV, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'

XOZHH iVWHSRUG(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(iVWHSRUG, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'IVWHSRUG'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(iVWHSRUG, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'

XOZHH dVY(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(dVY, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'DVY'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(dVY, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'

XOZHH hGZIUOVVG(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(hGZIUOVVG, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'HGZIUOVVG'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(hGZIUOVVG, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'




XOZHH nZIPVGvBV(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(nZIPVGvBV, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'NZIPVGVBV'
        HVOU.KZIHV()


    WVU NLMRGLI(HVOU):
        HFKVI(nZIPVGvBV, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH hBHGVNvBV(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(hBHGVNvBV, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'HBHGVNVBV'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(hBHGVNvBV, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH gy(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(gy, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'gy'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(gy, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH zXXLFMGvBV(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(zXXLFMGvBV, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'ZXXLFMGVBV'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(zXXLFMGvBV, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH dLINSLOV(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(dLINSLOV, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'DLINSLOV'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(dLINSLOV, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRM':
            HVOU.HGZGFH = 'LMORMV'


XOZHH fHRN(nLMHGVI):
    WVU __RMRG__(HVOU, MLWV, GRNVI,TOLYZO_RMUL):
        HFKVI(fHRN, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'FHRN'
        HVOU.KZIHV()

    WVU NLMRGLI(HVOU):
        HFKVI(fHRN, HVOU).NLMRGLI()
        RU HVOU.HGZGFH == 'YLLGRMT':
            HVOU.HGZGFH = 'LMORMV'


XOZHH fGIZWV(nLMHGVI):
    XOZHH fGIZWVhGIZGVTB(LYQVXG):
        WVU __RMRG__(HVOU, CNO):
            HVOU.RW = CNO.ZGGIRY['RW']


    WVU __RMRG__(HVOU, MLWV, GRNVI, TOLYZO_RMUL):
        HFKVI(fGIZWV, HVOU).__RMRG__(MLWV, GRNVI, TOLYZO_RMUL)
        HVOU.XLNKLMVMG = 'FGIZWV'
        HVOU.HGIZGVTB_ORHG = []
        HVOU.KZIHV()
        HVOU.RMEVHGRW_ORHG = []
        HVOU.HGIZGVTBRW_ORHG = []
        HVOU.KZIHV_HGIZGVTB()


    WVU KZIHV_HGIZGVTB(HVOU):
        GIB:
            GIVV = VGIVV.KZIHV(HVOU.XLMURT)
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI('[FGIZWV] KZIHV FGIZWV %H HGIZGVTB CNO VIILI'%HVOU.GZT)
            HVOU.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
            HBH.VCRG(-8)
        HVOU.MZNV = GIVV.TVGILLG().GZT
        ULI ZX RM GIVV.URMW('WZGFN').URMWZOO('ZXXLFMG'):
            RU 'RW' RM ZX.ZGGIRY ZMW 'RMEVHGRW' RM ZX.ZGGIRY:
                HVOU.HGIZGVTBRW_ORHG.ZKKVMW(ZX.ZGGIRY['RW'])
        ULI HG RM GIVV.URMW('DLIPUOLD').URMWZOO('HGIZGVTB'):
            RU 'RW' RM HG.ZGGIRY:
                HVOU.HGIZGVTB_ORHG.ZKKVMW( fGIZWV.fGIZWVhGIZGVTB(HG) )
        ULI HG RM GIVV.URMW('WZGFN').URMWZOO('ZXXLFMG'):
            RU 'RMEVHGRW' RM HG.ZGGIRY:
                HVOU.RMEVHGRW_ORHG.ZKKVMW(HG.ZGGIRY['RMEVHGRW'])

XLNKLMVMG_MZNV_ORHG = ['NZIPVGVBV', 'IVWHSRUG','NZHHIVOZB', 'HVXFIRGBNZMZTVI','HBHGVNVBV', 'ZXXLFMGVBV', 'DLINSLOV', 'FGIZWV', 'FHRN', 'gy','wy', 'XZMZIB', 'GVINRGVKRKV', 'HZTZ', 'RHSRNFIZ','ALWRZX', 'ZMWILNVWRZ', 'DVY', 'HGZIUOVVG', 'FYRJWMH']
XLNKLMVMG_XOZHH_ORHG = {}
XLNKLMVMG_XOZHH_ORHG['NZIPVGVBV'] = nZIPVGvBV
XLNKLMVMG_XOZHH_ORHG['HBHGVNVBV'] = hBHGVNvBV
XLNKLMVMG_XOZHH_ORHG['ZXXLFMGVBV'] = zXXLFMGvBV
XLNKLMVMG_XOZHH_ORHG['DLINSLOV'] = dLINSLOV
XLNKLMVMG_XOZHH_ORHG['FHRN'] = fHRN
XLNKLMVMG_XOZHH_ORHG['FGIZWV'] = fGIZWV
XLNKLMVMG_XOZHH_ORHG['gy'] = gy
XLNKLMVMG_XOZHH_ORHG['wy'] = wy
XLNKLMVMG_XOZHH_ORHG['DVY'] = dVY
XLNKLMVMG_XOZHH_ORHG['HGZIUOVVG'] = hGZIUOVVG
XLNKLMVMG_XOZHH_ORHG['IVWHSRUG'] = iVWHSRUG
XLNKLMVMG_XOZHH_ORHG['NZHHIVOZB'] = nZHHiVOZB
XLNKLMVMG_XOZHH_ORHG['XZMZIB'] = xZMZIB
XLNKLMVMG_XOZHH_ORHG['GVINRGVKRKV'] = gVINRGVKRKV
XLNKLMVMG_XOZHH_ORHG['HZTZ'] = hZTZ
XLNKLMVMG_XOZHH_ORHG['ZMWILNVWRZ'] = zMWILNVWRZ
XLNKLMVMG_XOZHH_ORHG['FYRJWMH'] = fYRJWMH
XLNKLMVMG_XOZHH_ORHG['ALWRZX'] = aLWRZX
XLNKLMVMG_XOZHH_ORHG['RHSRNFIZ'] = rHSRNFIZ

#XLNKLMVMG_XOZHH_ORHG['HVXFIRGBNZMZTVI'] = hVXFIRGBnZMZTVI


XOZHH NLMRGLIHBHGVN_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

XOZHH NLMRGLIHBHGVN(nLWFOV):
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.ILLG = ILLG
        RU 'NZRMYZHV' RM CNO.ZGGIRY:
            HVOU.HVIEVI_GZT = CNO.ZGGIRY['NZRMYZHV']
        VOHV:
            HVOU.HVIEVI_GZT = TOLYZO_RMUL._NZRMYZHV
        TOLYZO_RMUL.OLTTVI.RMUL('[yllg] NLMRGLIHBHGVN VMTZTVH NZRMYZHV-> %H '%HVOU.HVIEVI_GZT)
        HVOU.LMVGRNV_XLNKLMVMGH = []
        RU 'YLLGHGIZK_IVHGZIG' RM ILLG.TVGILLG().ZGGIRY:
            HVOU.IVHGZIG_GRNV = KZIHV_GRNV(ILLG.TVGILLG().ZGGIRY['YLLGHGIZK_IVHGZIG'])
        VOHV:
            HVOU.IVHGZIG_GRNV = KZIHV_GRNV('81:69')
        HVOU.GRNVI = TOLYZO_RMUL.GRNVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.YVZXLM = TOLYZO_RMUL.YVZXLM
        HVOU.RM_GIFHG_KILTIZNH = []
        HVOU.XLNKLMVMG_ORHG = {}
        ULI XLN RM XLNKLMVMG_MZNV_ORHG:
            HVOU.XLNKLMVMG_ORHG[XLN] = []
        HVOU.XLNKLMVMG_DZIMRMT = {}
        HVOU.ZKK_NZK = {}
        HVOU.RH_HRN = TOLYZO_RMUL.RH_HRN
        HVOU.SLHG = FYRJFGRO.TVG_FYRJ_SLHG()
        HVOU.WLNZRM = FYRJFGRO.TVG_FYRJ_WLNZRM()
        HVOU.RH_IVYLLGRMT = uZOHV
        RU MLG HVOU.RH_HRN:
            HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        VOHV:
            HVOU.OLTTVI = mLMV
        HVOU.KZIHV()
        HVOU.OZHG_RM_GIFHG_GRNV = HVOU.GRNVI.MLD - WZGVGRNV.GRNVWVOGZ(HVXLMWH=7)
        HVOU.OZHG_TZFTV_GRNV = HVOU.GRNVI.MLD - WZGVGRNV.GRNVWVOGZ(HVXLMWH=89)
        HVOU.VCRG = uZOHV
        HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.ZOKSZNZM_XORVMG = mLMV
        HVOU.OLT_NLMRGLI = oLTnLMRGLI(HVOU.TOLYZO_RMUL, HVOU.XLNKLMVMGH, mLMV)
        HVOU.OLT_NLMRGLI_QLY = qLY(HVOU.OLT_NLMRGLI)
        HVOU.IVKLIG = ''
        HVOU.IVKLIG_rw = ''

    WVU IVOLZW(HVOU):
        HVOU.OLTTVI.RMUL('NLMRGLIHBHGVN IVOLZW')
        ULI RG RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            HVOU.OLTTVI.RMUL('%H'%RG)
        HVOU.ZOKSZNZM_XORVMG =  HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.URMW_NLWFOV('ZOKSZNZMXORVMG')
        RU HVOU.ZOKSZNZM_XORVMG RH MLG mLMV:
            # KZIHVI ZOKSZNZM QLYH, RU GSVIV ZIV ZMB
            HVOU.OLTTVI.RMUL('[nLMRGLIhBHGVN] ULFMW %W ZOKSZNZM QLYH'%OVM(HVOU.ZOKSZNZM_XORVMG.QLY_CNOH))
            ULI MLWV RM HVOU.ZOKSZNZM_XORVMG.QLY_CNOH:
                XLN_GBKV = MLWV.GZT
                RU MLWV RH MLG mLMV:
                    RU XLN_GBKV == 'HVXFIRGBNZMZTVI' ZMW HVOU.TOLYZO_RMUL.YLLGHGIZK.HGZIUOVVG_NZHGVI:
                        KILTIZN = HVOU.TOLYZO_RMUL.YLLGHGIZK.HVXFIRGBNZMZTVI
                        KILTIZN.RM_GIFHG = uZOHV
                    VOHV:
                        KILTIZN = XLNKLMVMG_XOZHH_ORHG[XLN_GBKV](MLWV, HVOU.GRNVI, HVOU.TOLYZO_RMUL)
                    HVOU.XLNKLMVMG_ORHG[XLN_GBKV].ZKKVMW(KILTIZN)
                    HVOU.XLNKLMVMGH.ZKKVMW(KILTIZN)
                    RU KILTIZN.GZT RM HVOU.ZKK_NZK:
                        IZRHV eZOFVvIILI(KILTIZN.GZT+' SZH ZOIVZWB YVVM FHVW');
                    HVOU.OLTTVI.RMUL('[nlmrglihbhgvn] OLZWVW ZOKSZNZM QLY %H->%H'%(MLWV.GZT, KILTIZN.GZT))
                    HVOU.ZKK_NZK[KILTIZN.GZT] = KILTIZN
                    RU KILTIZN.RM_GIFHG:
                        HVOU.RM_GIFHG_KILTIZNH.ZKKVMW(KILTIZN)


    WVU xSVXPzMWtZFTV(HVOU, GZITVG, OG):
        MFN = 9
        LUUORMV_DZIMRMT = uZOHV
        LMORMV_DZIMRMT = uZOHV
        MFN_OG = 9
        ULI XLN RM OG:
            XSVXP_DZIMRMT = XLN.XSVXP_HXSVWFOV()
            # KIRMG XSVXP_DZIMRMT
            LUUORMV_DZIMRMT = LUUORMV_DZIMRMT LI XSVXP_DZIMRMT[9]
            LMORMV_DZIMRMT = LMORMV_DZIMRMT LI XSVXP_DZIMRMT[8]
            MFN_OG += XSVXP_DZIMRMT[7]
            RU XLN.HGZGFH == 'LMORMV':
                MFN += 8
        HVOU.YVZXLM.tZFTV(GZITVG+'.ZXGREV', MFN)
        HVOU.YVZXLM.tZFTV(GZITVG+'.MFN', MFN_OG )
    # KIRMG GZITVG, MFN, MFN_OG
        IVGFIM LUUORMV_DZIMRMT LI LMORMV_DZIMRMT


    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW == 'RMHGZOO_GZHP':
            HVOU.OLTTVI.WVYFT('IVXE RMHGZOO GZHP UILN %H'%QLY.RWVMGRGB)
            # KIRMG('RWVM:', QLY.RWVMGRGB)
            WZGZ = KRXPOV.OLZWH(QLY.QLY)
            CNO = WZGZ.VCKLIG_GL_CNO()
            RU WZGZ.MVVW_KVIHRHG:
                HVOU.TOLYZO_RMUL.CNOUROV_NLWRUB = 8
            # RU WZGZ.RH_ZOKSZNZM ZMW 'ZOKSZNZMXORVMG' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                # ZX = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['ZOKSZNZMXORVMG']
                # ZX.QLY_CNOH.ZKKVMW(CNO)
            RU '_LMVGRNV_' RM CNO.ZGGIRY ZMW CNO.ZGGIRY['_LMVGRNV_'].OLDVI()=='GIFV':
                HGZGFH = HVOU.ZWW_XLNKLMVMG_LMXV(CNO)
            VOHV:
                HGZGFH = HVOU.ZWW_XLNKLMVMG(CNO, WZGZ.RH_ULIXV)
            RU HGZGFH[9] == 9:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=HGZGFH[8])
            VOHV:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=HGZGFH[8])
        VORU QLY.XLNNZMW == 'FMRMHGZOO_GZHP':
            HVOU.OLTTVI.WVYFT('IVXE FMRMHGZOO GZHP UILN %H'%QLY.RWVMGRGB)
            # KIRMG('RWVM:', QLY.RWVMGRGB)
            WZGZ = KRXPOV.OLZWH(QLY.QLY)
            HGZGFH = HVOU.IVNLEV_XLNKLMVMG(WZGZ.RW)
            RU HGZGFH[9] == 9:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=HGZGFH[8])
            VOHV:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=HGZGFH[8])
        VORU QLY.XLNNZMW == 'JFVIB_GZHP':
            HVOU.OLTTVI.WVYFT('IVXE JFVIB GZHP UILN %H'%QLY.RWVMGRGB)
            # KIRMG('RWVM:', QLY.RWVMGRGB)
            XLN_ORHG = []
            ULI XLN RM HVOU.XLNKLMVMGH:
                RGH = rMHGZOOgZHPhGIFXG()
                RGH.KZIHV_UILN_CNO(XLN.MLWV)
                XLN_ORHG.ZKKVMW(RGH)
            IVKOB = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='JFVIB lp')
            IVKOB.WZGZ = KRXPOV.WFNKH(XLN_ORHG)
            IVGFIM IVKOB
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'JFVIB_WVGZRO':
            GZITVG = QLY.XLNNZMW.HKORG('&')[8].HGIRK()
            HVOU.OLTTVI.WVYFT('IVXE JFVIB GZHP WVGZROH UILN %H'%QLY.RWVMGRGB)
            XLN_ORHG = []
            RU GZITVG.OLDVI() == 'ZOO':
                ULI XLN RM HVOU.XLNKLMVMGH:
                    XLN_ORHG.ZKKVMW(XLN.WVGZRO())
            VOHV:
                ULI XLN RM HVOU.XLNKLMVMGH:
                    RU XLN.GZT == GZITVG:
                        XLN_ORHG.ZKKVMW(XLN.WVGZRO())
                RU OVM(XLN_ORHG) == 9:
                    IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='XZMMLG URMW XLNKLMVMG %H'%GZITVG)
            IVKOB = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='JFVIB lp')
            IVKOB.WZGZ = KRXPOV.WFNKH(XLN_ORHG)
            IVGFIM IVKOB



    WVU IFM(HVOU):
        HOVVK_GRXP = 9
        GIB:
            HVOU.OLT_NLMRGLI_QLY.HGZIG()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI('OLT NLMRGLI VMXLFMGVIH VIILI ZH %H'%(HGI(V)))
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            RU HVOU.RH_IVYLLGRMT:
                XLMGRMFV
            HVOU.XSVXP_IVHGZIG()
            HVOU.XLNKROV_XLNKLMVMGH()
            HVOU.XSVXP()

            IVKLIG = ''
            IVKLIG_rw = ''
            IVG = HVOU.TOLYZO_RMUL.ZXJFRIV_NZRMYZHV(HVOU.HVIEVI_GZT)
            RU IVG RH MLG mLMV:
                IVKLIG = IVG.HKORG('&')[8]
                IVKLIG_rw = IVG.HKORG('&')[9]
            RU IVKLIG == '':
                HOVVK(8)
                XLMGRMFV

            # IVKLIG WZGZ GL NZRMYZHV
            RU HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG RH MLG mLMV:
                IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
                HVOU.OLT_NLMRGLI.IVWHSRUG = IVWHSRUG
                NHT = IVWHSRUG.MVD_NHT()
                NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                NHT.WHG = IVKLIG
                NHT.XLNNZMW = 'IVKLIG_KFYHFY'
                HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.NLMRGLI()
                KFYHFY_IVKLIG = {}
                ULI P, E RM HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.HGZGFH_IVKLIG.RGVNH():
                    RU E[9] != 9:
                        KFYHFY_IVKLIG[P] = E
                NHT.WZGZ = QHLM.WFNKH( KFYHFY_IVKLIG ).VMXLWV()
                NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                GIB:
                    IVKOB = IVWHSRUG.HVMW(NHT)
                    #RU IVKOB.HGZGFH:
                    #    RU HVOU.IVKLIG_rw != IVKLIG_rw:
                    #        HVOU.IVKLIG = IVKLIG
                    #        HVOU.IVKLIG_rw = IVKLIG_rw
                    #        HVOU.OLTTVI.RMUL('[nlmrglihbhgvn] URIHG IVKLIG ->%H HFXXVVWVW'%IVKLIG)
                   # KIRMG(IVKOB)
                VCXVKG vCXVKGRLM ZH V:
                    KZHH
                # IVKLIG XLNKLMVMGH
                NHT = IVWHSRUG.MVD_NHT()
                NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                NHT.WHG = IVKLIG
                NHT.XLNNZMW = 'IVKLIG_XLNKLMVMG'
                WZGZ_WRXG = HVOU.XLNKROV_XLNKLMVMG_HGZGFH(VCKLIG_QHLM=gIFV)
                # WZGZ_WRXG.ZKKVMW({'EVIHRLM:%H'%HVOU.TOLYZO_RMUL.EVIHRLM)
                NHT.WZGZ = QHLM.WFNKH( WZGZ_WRXG ).VMXLWV()
                NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                GIB:
                    IVKOB = IVWHSRUG.HVMW(NHT)
                VCXVKG vCXVKGRLM ZH V:
                    KZHH
                # IVKLIG XLNKLMVMG OLTH
                # ULI XLN RM HVOU.XLNKLMVMGH:
                    # RU XLN.XFIIVMG_GLGZO_OLTH < OVM(XLN.GLGZO_OLTH):
                        # NHT = IVWHSRUG.MVD_NHT()
                        # NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                        # NHT.WHG = HVOU.TOLYZO_RMUL.IVKLIG_GZITVG
                        # NHT.XLNNZMW = 'IVKLIG_XLNKLMVMG_OLT&'+XLN.GZT
                        # NHT.WZGZ = OANZ.XLNKIVHH('\M'.QLRM(XLN.GLGZO_OLTH[XLN.XFIIVMG_GLGZO_OLTH:]).VMXLWV())
                        # NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                        # GIB:
                            # IVKOB = IVWHSRUG.HVMW(NHT)
                            # #HVOU.OLTTVI.RMUL('%W'%IVKOB.HGZGFH)
                            # #HVOU.OLTTVI.RMUL(IVKOB.NVHHZTV)
                            # #KIRMG(IVKOB)
                            # RU IVKOB.HGZGFH:
                                # XLN.XFIIVMG_GLGZO_OLTH = OVM(XLN.GLGZO_OLTH)
                        # VCXVKG vCXVKGRLM ZH V:
                            # HVOU.OLTTVI.VIILI(HGI(V))
            HOVVK(7)
            HOVVK_GRXP += 8
        HVOU.OLT_NLMRGLI_QLY.HGLK()

    WVU XSVXP(HVOU):
        RU HVOU.RH_HRN:
            IVGFIM
        RU (HVOU.GRNVI.MLD - HVOU.OZHG_RM_GIFHG_GRNV).GLGZO_HVXLMWH() >= 8:
            ULI KILT RM HVOU.RM_GIFHG_KILTIZNH:
                KILT.XSVXP_RM_GIFHG()
            ULI KILT RM HVOU.LMVGRNV_XLNKLMVMGH:
                KILT.XSVXP_RM_GIFHG()
            HVOU.OZHG_RM_GIFHG_GRNV = HVOU.GRNVI.MLD
        # RU (HVOU.GRNVI.MLD - HVOU.OZHG_TZFTV_GRNV).GLGZO_HVXLMWH() < 89:
            # IVGFIM
        # HVOU.OZHG_TZFTV_GRNV = HVOU.GRNVI.MLD
        # RU HVOU.YVZXLM RH MLG mLMV:
            # HVOU.YVZXLM.tZFTV('FKWZGV', (HVOU.GRNVI.MLD - WZGVGRNV.WZGVGRNV(8029, 8, 8, 1)).GLGZO_HVXLMWH()*8999)
            # YVZXLM_DZIMRMT = uZOHV
            # ULI XLN RM XLNKLMVMG_MZNV_ORHG:
                # YVZXLM_DZIMRMT = HVOU.xSVXPzMWtZFTV(XLN, HVOU.XLNKLMVMG_ORHG[XLN]) LI YVZXLM_DZIMRMT
            # RU YVZXLM_DZIMRMT:
                # HVOU.YVZXLM.tZFTV('DZIMRMT', 8)
            # VOHV:
                # HVOU.YVZXLM.tZFTV('DZIMRMT', 9)
        ULI XLN RM XLNKLMVMG_MZNV_ORHG:
            ULI X RM HVOU.XLNKLMVMG_ORHG[XLN]:
                X.XSVXP_HXSVWFOV()


    WVU KZIHV(HVOU):
        HVOU.XLNKLMVMGH = []
        ULI XLN_GBKV RM XLNKLMVMG_MZNV_ORHG:
            MLWVH = HVOU.ILLG.URMW('XLNKLMVMGH').URMWZOO(XLN_GBKV)
            ULI MLWV RM MLWVH:
                RU MLWV RH MLG mLMV:
                    RU XLN_GBKV == 'HVXFIRGBNZMZTVI' ZMW HVOU.TOLYZO_RMUL.YLLGHGIZK.HGZIUOVVG_NZHGVI:
                        KILTIZN = HVOU.TOLYZO_RMUL.YLLGHGIZK.HVXFIRGBNZMZTVI
                        KILTIZN.RM_GIFHG = uZOHV
                    VOHV:
                        KILTIZN = XLNKLMVMG_XOZHH_ORHG[XLN_GBKV](MLWV, HVOU.GRNVI, HVOU.TOLYZO_RMUL)
                        RU 'IVHGZIG' RM MLWV.ZGGIRY:
                            KILTIZN.IVHGZIG_GRNVI = gRNVI(MLWV.ZGGIRY['IVHGZIG'])
                            HVOU.OLTTVI.RMUL('[nLWFOVnLMRGLI] OLZWVW IVHGZIG GRNV %H ULI %H'%(MLWV.ZGGIRY['IVHGZIG'], KILTIZN.GZT))
                        RU 'SRTS_OLZW_IVHGZIG' RM MLWV.ZGGIRY:
                            KILTIZN.SRTS_OLZW_IVHGZIG = RMG(MLWV.ZGGIRY['SRTS_OLZW_IVHGZIG'])
                            HVOU.OLTTVI.RMUL('[nLWFOVnLMRGLI] OLZWVW SRTS OLZW IVHGZIG NVXSZMRHN %W ULI %H'%(KILTIZN.SRTS_OLZW_IVHGZIG, KILTIZN.GZT))
                    HVOU.XLNKLMVMG_ORHG[XLN_GBKV].ZKKVMW(KILTIZN)
                    HVOU.XLNKLMVMGH.ZKKVMW(KILTIZN)
                    RU KILTIZN.GZT RM HVOU.ZKK_NZK:
                        IZRHV eZOFVvIILI(KILTIZN.GZT+' SZH ZOIVZWB YVVM FHVW');
                    HVOU.ZKK_NZK[KILTIZN.GZT] = KILTIZN
                    KILTIZN._KZIVMG_MLWV = HVOU.ILLG.URMW('XLNKLMVMGH')
                    RU KILTIZN.RM_GIFHG:
                        HVOU.RM_GIFHG_KILTIZNH.ZKKVMW(KILTIZN)
        # ULI XLN RM HVOU.XLNKLMVMG_ORHG:
            # KIRMG(XLN, HVOU.XLNKLMVMG_ORHG[XLN])
        RU HVOU.ILLG.URMW('XLNKLMVMGH').URMW('WVKVMWVMXRVH') RH MLG mLMV:
            ULI WVK_CNO RM HVOU.ILLG.URMW('XLNKLMVMGH').URMW('WVKVMWVMXRVH').URMWZOO('WVKVMWVMXB'):
                RW = WVK_CNO.ZGGIRY['RW']
                WVK_ORHG = WVK_CNO.ZGGIRY['WVKVMWLM'].HGIRK().HKORG(',')
                RU RW MLG RM HVOU.ZKK_NZK:
                    IZRHV eZOFVvIILI('WVKVMWVMXB YFROWRMT UZROVW, XZMMLG URMW %H'%RW)
                ULI WVK RM WVK_ORHG:
                    RU WVK MLG RM HVOU.ZKK_NZK:
                        IZRHV eZOFVvIILI('WVKVMWVMXB YFROWRMT UZROVW, XZMMLG URMW %H'%WVK)
                    HVOU.OLTTVI.RMUL('[nlmrglihbhgvn] WVKVMWVMXB IFOV YFROG: %H WVKVMW LM %H'%(RW, WVK))
                    HVOU.ZKK_NZK[RW].WVKVMWVMXB_ORHG.ZKKVMW(HVOU.ZKK_NZK[WVK])


    WVU ZWW_XLNKLMVMG_LMXV(HVOU, MLWV):
        KILTIZN = XLNKLMVMG_XOZHH_ORHG[MLWV.GZT](MLWV, HVOU.GRNVI, HVOU.TOLYZO_RMUL)
        RU KILTIZN.GZT RM HVOU.ZKK_NZK:
             NLGSVI_KILTIZN = HVOU.ZKK_NZK[KILTIZN.GZT]
             NLGSVI_KILTIZN.HFY_LMVGRNV.ZKKVMW(KILTIZN)
        VOHV:
             HVOU.LMVGRNV_XLNKLMVMGH.ZKKVMW(KILTIZN)
        IVGFIM (9, 'HFXXVHH')

    WVU ZWW_XLNKLMVMG(HVOU, MLWV, ULIXV_OLZW):
        XLN_GBKV = MLWV.GZT
        RU XLN_GBKV == 'HVXFIRGBNZMZTVI' ZMW HVOU.TOLYZO_RMUL.YLLGHGIZK.HGZIUOVVG_NZHGVI:
            KILTIZN = HVOU.TOLYZO_RMUL.YLLGHGIZK.HVXFIRGBNZMZTVI
            KILTIZN.RM_GIFHG = uZOHV
        VORU XLN_GBKV RM XLNKLMVMG_XOZHH_ORHG:
            KILTIZN = XLNKLMVMG_XOZHH_ORHG[XLN_GBKV](MLWV, HVOU.GRNVI, HVOU.TOLYZO_RMUL)
        VOHV:
            IVGFIM (-8, 'FMIVXLTMRAZYOV XLNKLMVMG %H'%XLN_GBKV)
        KILTIZN._KZIVMG_MLWV = HVOU.ILLG.URMW('XLNKLMVMGH')
        RU KILTIZN.GZT RM HVOU.ZKK_NZK:
            RU MLG ULIXV_OLZW:
                IVGFIM (-8, KILTIZN.GZT+' SZH ZOIVZWB YVVM FHVW')
            VOHV:

                HVOU.OLTTVI.DZIM('IVOLZW VCRHGVW XLNKLMVMG HXSVWFOV %H'%KILTIZN.GZT)
                GVNK_ORHG = []
                ULI XLN RM HVOU.XLNKLMVMG_ORHG[XLN_GBKV]:
                    RU XLN.GZT != KILTIZN.GZT:
                        GVNK_ORHG.ZKKVMW(XLN)
                HVOU.XLNKLMVMG_ORHG[XLN_GBKV] = GVNK_ORHG
                HVOU.XLNKLMVMG_ORHG[XLN_GBKV].ZKKVMW(KILTIZN)

                GVNK_ORHG = []
                ULI XLN RM HVOU.XLNKLMVMGH:
                    RU XLN.GZT != KILTIZN.GZT:
                        GVNK_ORHG.ZKKVMW(XLN)
                HVOU.XLNKLMVMGH = GVNK_ORHG
                HVOU.XLNKLMVMGH.ZKKVMW(KILTIZN)
        VOHV:
            HVOU.XLNKLMVMG_ORHG[XLN_GBKV].ZKKVMW(KILTIZN)
            HVOU.XLNKLMVMGH.ZKKVMW(KILTIZN)
        HVOU.ZKK_NZK[KILTIZN.GZT] = KILTIZN
        RU KILTIZN.RH_ZOKSZNZM:
            RU HVOU.ZOKSZNZM_XORVMG RH mLMV:
                HVOU.OLTTVI.VIILI('HBHGVN WRW MLG OLZW ZOKSZNZMXORVMG NLWFOV')
            VOHV:
                HVOU.OLTTVI.RMUL('ZOKSZNZM ZWWVW MLWV %H'%KILTIZN.GZT)
                HVOU.ZOKSZNZM_XORVMG.ZWW(MLWV)
        RU KILTIZN.RM_GIFHG:
            HVOU.RM_GIFHG_KILTIZNH.ZKKVMW(KILTIZN)
        HVOU.TOLYZO_RMUL._GL_ZWW_XLNKLMVMG[KILTIZN.GZT] = KILTIZN
        IVGFIM (9, 'HFXXVHH')

    WVU IVNLEV_XLNKLMVMG(HVOU, GZT):
        RU GZT[-6:] == '-lg':
            GZT = GZT[:-6]
        RU GZT MLG RM HVOU.ZKK_NZK:
            IVGFIM (-8, GZT+' MLG IVTRHGVIVW BVG')
        KILTIZN = HVOU.ZKK_NZK[GZT]
        ULI HFY_KILTIZN RM KILTIZN.HFY_LMVGRNV:
            HFY_KILTIZN.PROO()
        KILTIZN.PROO()
        XLN_GBKV = KILTIZN.XLNKLMVMG
        HVOU.XLNKLMVMG_ORHG[XLN_GBKV].IVNLEV(KILTIZN)
        HVOU.XLNKLMVMGH.IVNLEV(KILTIZN)
        RU HVOU.ZOKSZNZM_XORVMG RH MLG mLMV:
            HVOU.ZOKSZNZM_XORVMG.IVNLEV_QLY(GZT)
            HVOU.ZOKSZNZM_XORVMG.FKWZGV_GL_CNO()
        HVOU.OLTTVI.RMUL('%H DZRGRMT GL YV IVNLEVW UILN CNO'%KILTIZN.GZT)
        HVOU.TOLYZO_RMUL._GL_IVNLEV_XLNKLMVMG[KILTIZN.GZT] = KILTIZN
        RU KILTIZN.RM_GIFHG:
            HVOU.RM_GIFHG_KILTIZNH.IVNLEV(KILTIZN)
        IVGFIM (9, 'HFXXVHH')


    WVU XLNKROV_HGZGFH(HVOU):
        IVG = []
        IVG.ZKKVMW('')
        RU HVOU.GRNVI.HRN:
            IVG.ZKKVMW('%-89H %74H'%('NLWV:','HRN' ))
            IVG.ZKKVMW('%-89H %74H'%('MLD:',HVOU.GRNVI.NROO7GRNV( HVOU.GRNVI.HRN_MLD).HGIUGRNV('%b%N%W, %s:%n:%h.%U' )[:-6] ) )
            IVG.ZKKVMW('%-89H %74H'%('HGZIG:',HVOU.GRNVI.NROO7GRNV( HVOU.GRNVI.HRN_HGZIG).HGIUGRNV('%b%N%W, %s:%n:%h.%U')[:-6] ))
            IVG.ZKKVMW('%-89H %74H'%('VMW:',HVOU.GRNVI.NROO7GRNV( HVOU.GRNVI.HRN_VMW).HGIUGRNV('%b%N%W, %s:%n:%h.%U' )[:-6]   ))
            IVG.ZKKVMW('%-89H %74H'%('HKVVW: ',HGI(HVOU.GRNVI.HRN_HKVVW)+'C'))
        VOHV:
            IVG.ZKKVMW('%-89H %74H'%('HSRK:',HVOU.SLHG+'/'+HVOU.WLNZRM))
            IVG.ZKKVMW('%-89H %74H'%('NLWV:','IVZOGRNV'))
            IVG.ZKKVMW('%-89H %74H'%('MLD:', HVOU.GRNVI.MLD.HGIUGRNV('%b%N%W, %s:%n:%h.%U' )[:-6] ) )
            IVG.ZKKVMW('%-89H %74H'%('HGZGFH:', 'MLINZO' ))
            IVG.ZKKVMW('%-89H %74H'%('NLMRGLI:', 9 ))
        IVGFIM IVG

    WVU KIVKZIV_HRN(HVOU, DRMWLD):
        HVOU.GRNVI.HRN_IVHVG()
        ULI XLN RM HVOU.XLNKLMVMGH:
            XLN.PROO()
            HN = HSN.dIRGVhSN('HGZIUOVVG_'+XLN.GZT)
            HN.DIRGV('9')
        HN = HSN.dIRGVhSN('HGZIUOVVG_HRN')
        HN.DIRGV('9')
        ULI HRNXVMGVI RM HVOU.HRNXVMGVI:
            HRNXVMGVI.HRN_IFM()

        # DZRG ULI ZOO HRNXVMGVIH GL URMRHS YLLGRMT
        DSROV gIFV:
            MFN = 9
            ULI HRNXVMGVI RM HVOU.HRNXVMGVI:
                # KIRMG HRNXVMGVI.HGZGFH
                # HRNXVMGVI.XSVXP_HRN_HGZGFH()
                DRMWLD.NLWFOV_HGZGFH.EZOFVH = HVOU.XLNKROV_XLNKLMVMGH()
                DRMWLD.NLWFOV_HGZGFH.WRHKOZB()
                RU HRNXVMGVI.HGZGFH == 'HGZMWYB':
                    MFN += 8
            RU MFN == OVM(HVOU.HRNXVMGVI):
                YIVZP
            HOVVK(9.4)

        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.XLNKLMVMG != 'HRNXVMGVI':
                XLN.HRN_IFM()

    WVU PROO_ZOO(HVOU, RH_NZMFZO_PROO=uZOHV, VMHFIV=uZOHV, LMOB_VMGIFHG=uZOHV):
        HVOU.OLTTVI.RMUL('PROO_ZOO RH ZYLFG GL PROO %H'%','.QLRM([R.GZT ULI R RM HVOU.XLNKLMVMGH]))
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.XLNKLMVMG=='HVXFIRGBNZMZTVI':
                XLMGRMFV
            #RU XLN.RH_IFMMRMT_YB_HFYKILXVHH:
            RU LMOB_VMGIFHG ZMW MLG XLN.RM_GIFHG:
                XLMGRMFV
            HVOU.OLTTVI.DZIM('[nlmrglihbhgvn] PROO %H' % XLN.GZT)
            XLN.RH_NZMFZO_PROO = RH_NZMFZO_PROO
            XLN.PROO()
            RU VMHFIV:
                XLN.NLMRGLI()
                DSROV XLN.HGZGFH == 'LMORMV' LI XLN.HGZGFH=='YLLGRMT':
                    HOVVK(9.4)
                    XLN.NLMRGLI()
                    GIB:
                        XLN.PROO()
                    VCXVKG vCXVKGRLM ZH V:
                        KZHH
                    HVOU.OLTTVI.DZIM('%H RH RM HGZGFH %H'%(XLN.XLNKLMVMG, XLN.HGZGFH))
                HVOU.OLTTVI.RMUL('%H VCRGVW DRGS HGZGFH %H'%(XLN.XLNKLMVMG, XLN.HGZGFH))


    WVU IVYLLG(HVOU):
        HVOU.RH_IVYLLGRMT = gIFV
        HVOU.PROO_ZOO()

    WVU URMRHS_IVYLLG(HVOU):
        HVOU.RH_IVYLLGRMT = uZOHV

    WVU HGZIG_HRN(HVOU):
        HN = HSN.dIRGVhSN('HGZIUOVVG_HRN')
        HN.DIRGV('8')

    WVU HGLK_HRN(HVOU):
        HN = HSN.dIRGVhSN('HGZIUOVVG_HRN')
        HN.DIRGV('9')

    WVU XLNKROV_SVZW(HVOU):
        IVG = []
        IVG.ZKKVMW('%-84H%89H%89H%0H%89H%89H%84H%2H%2H'%('rw','xlnklmvmg','hgzgfh','krw','hgzig','fkgrnv','xliv','dzim','viili')  )
        IVGFIM IVG

    WVU XLNKROV_XLNKLMVMGH(HVOU):
        IVG = HVOU.XLNKROV_SVZW()
        ULI XLN RM HVOU.XLNKLMVMGH:
            XLN.NLMRGLI()
            IVG.ZKKVMW( XLN.XLNKROV()  )
        IVGFIM IVG

    WVU XSVXP_IVHGZIG(HVOU):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.XSVXP_IVHGZIG():
                HVOU.OLTTVI.RMUL('[ivhgzig] %H IVHGZIGH'%XLN.GZT)
                XLN.IVHGZIG()
            XLN.XSVXP_SRTS_OLZW_IVHGZIG()

    WVU XLNKROV_XLNKLMVMG_HGZGFH(HVOU, VCKLIG_QHLM = uZOHV, XZGVTLIB=''):
        # XLMXZGVMZGV VZXS XLNKLMVMG'H HGZGFH GL QHLM LI HGIRMT ULI XLNNZMW
        IVG = []
        ULI NXLN RM HVOU.XLNKLMVMGH + HVOU.LMVGRNV_XLNKLMVMGH:
            OG = [NXLN] + NXLN.HFY_LMVGRNV
            ULI XLN RM OG:
                XLN.NLMRGLI()
                RU XZGVTLIB == 'ZOKSZNZM': # LMOB KZIHV ZOKSZNZM
                     RU MLG XLN.RH_ZOKSZNZM:
                        XLMGRMFV
                IVG.ZKKVMW( XLN.XLNKROV(gIFV, VCKLIG_QHLM))
        IVGFIM IVG

    WVU NZMFZO_KZFHV_XLNKLMVMG(HVOU, GZITVG):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.GZT == GZITVG:
                XLN.NZMFZO_KZFHV()
                IVGFIM 'KZFHVW %H'%XLN.GZT
        IVGFIM 'XZMMLG URMW NLWFOV'

    WVU NZMFZO_ORTSG_XLNKLMVMG(HVOU, GZITVG, ORTSG):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.GZT == GZITVG:
                RU ORTSG.OLDVI() RM ['TIVVM', 'T']:
                    KIRMG(XLN.HSN_HGZGFH)
                    XLN.HSN_HGZGFH.RHHFV_ORTSG( hSNhGZGFH.gIZUURXoRTSG.tivvm, 'NZMFZO' )
                VORU ORTSG.OLDVI() RM ['IVW', 'I']:
                    XLN.HSN_HGZGFH.RHHFV_ORTSG( hSNhGZGFH.gIZUURXoRTSG.ivw, 'NZMFZO' )
                IVGFIM 'RHHFVW %H GL %H'%(ORTSG, XLN.GZT)
        IVGFIM 'XZMMLG URMW NLWFOV'


    WVU NZMFZO_IVHFNV_XLNKLMVMG(HVOU, GZITVG):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.GZT == GZITVG:
                XLN.NZMFZO_IVHFNV()
                IVGFIM 'IVHFNVW %H'%XLN.GZT
        IVGFIM 'XZMMLG URMW NLWFOV'



    WVU NZMFZO_HGZIG_XLNKLMVMG(HVOU, GZITVG, ZITH=[]):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.GZT == GZITVG:
                XLN.NZMFZO_IFM(ZITH)
                RU OVM(ZITH) == 9:
                    IVGFIM 'HFXXVHHUFOOB HGZIGVW %H'%XLN.GZT
                VOHV:
                    IVGFIM 'HFXXVHHUFOOB HGZIGVW %H DRGS ZITH %H'%(XLN.GZT, ','.QLRM(ZITH))
        IVGFIM 'XZMMLG URMW NLWFOV %H'%GZITVG


    WVU IVHGZIG_XLNKLMVMG(HVOU, GZITVG):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.GZT == GZITVG:
                XLN.IVHGZIG()
                IVGFIM 'HFXXVHHUFOOB IVHGZIGVW %H'%XLN.GZT
        IVGFIM 'XZMMLG URMW NLWFOV'


    WVU NZMFZO_PROO_XLNKLMVMG(HVOU, GZITVG):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.GZT == GZITVG:
                XLN.NZMFZO_PROO()
                IVGFIM 'HFXXVHHUFOOB HGLKKVW %H'%XLN.GZT
        IVGFIM 'XZMMLG URMW NLWFOV'

    WVU VMHFIV_PROO_XLNKLMVMG(HVOU, GZITVG):
        ULI XLN RM HVOU.XLNKLMVMGH:
            RU XLN.GZT == GZITVG:
                XLN.NZMFZO_PROO()
                XLN.NLMRGLI()
                DSROV XLN.HGZGFH == 'LMORMV':
                    HOVVK(8)
                    XLN.NLMRGLI()
                IVGFIM gIFV
        IVGFIM uZOHV


//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_HGZIG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_HGZIG(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL HGZIG GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_HGZIG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'HGZIG'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'XLNKLMVMG' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLNKLMVMG'].HGIRK()
            ZITH = []
            RU 'ZITH' RM ZITFNVMGH:
                ZITH = ZITFNVMGH['ZITH'].HKORG(',')
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVG = NLMRGLI.NZMFZO_HGZIG_XLNKLMVMG(GZITVG, ZITH)
                HVOU.IVHKLMHV.NVHHZTV = IVG
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'ML NLWFOV ZH nLMRGLIhBHGVN'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_JFVIB.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_JFVIB(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL JFVIB GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_JFVIB, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'JFVIB'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        # KIRMG(ZITFNVMGH)
        RU 'LKVIZGRLM' RM ZITFNVMGH LI 'LK' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            FHVI = 'NZHGVI'
            LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG[FHVI]
            HVOU.IVHKLMHV.NVHHZTV = 'JFVIBGBKV=LKVIZGRLM&'+LK_SLFHV.XLNKROV_GL_HGI()
            IVGFIM HVOU.IVHKLMHV
        VORU 'HLK' RM ZITFNVMGH:
            HLK_SLFHV = TOLYZO_RMUL.HLK_NZMZTVI
            HVOU.IVHKLMHV.NVHHZTV = 'JFVIBGBKV=HLK'
            ULI P, HLK RM HLK_SLFHV.HLK_KLLO.RGVNH():
                HVOU.IVHKLMHV.NVHHZTV += '&MZNV=%H|YIRVU=%H'%(HLK.HLK, HLK.YIRVU)
            IVGFIM HVOU.IVHKLMHV
        VORU 'XLNKLMVMG' RM ZITFNVMGH LI 'XLN' RM ZITFNVMGH:
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                HVOU.IVHKLMHV.NVHHZTV = 'JFVIBGBKV=XLNKLMVMG'
                HVOU.IVHKLMHV.NVHHZTV += '&'+'&'.QLRM(NLMRGLI.XLNKROV_XLNKLMVMG_HGZGFH())
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'JFVIBGBKV=XLNKLMVMG'+'&mLxLNKLMVMGH'
            IVGFIM HVOU.IVHKLMHV
        VORU 'ZOKSZNZM' RM ZITFNVMGH:
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                HVOU.IVHKLMHV.NVHHZTV = 'JFVIBGBKV=XLNKLMVMG'
                HVOU.IVHKLMHV.NVHHZTV += '&'+'&'.QLRM(NLMRGLI.XLNKROV_XLNKLMVMG_HGZGFH(XZGVTLIB='ZOKSZNZM'))
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'JFVIBGBKV=XLNKLMVMG'+'&mLxLNKLMVMGH'
            IVGFIM HVOU.IVHKLMHV
        VORU 'NLWFOV' RM ZITFNVMGH LI 'NLW' RM ZITFNVMGH:
            HVOU.IVHKLMHV.NVHHZTV = 'JFVIBGBKV=NLWFOV'
            HVOU.IVHKLMHV.NVHHZTV += '&'+'&'.QLRM(TOLYZO_RMUL.NLWFOV_NZMZTVI.XLNKROV_NLWFOV_HGZGFH())
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_IVKLIG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW
RNKLIG KHFGRO

XOZHH XNW_IVKLIG(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL IVKLIG GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_IVKLIG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'IVKLIG'


    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'KFYHFY' RM ZITFNVMGH:
            IVG = '\M'.QLRM(TOLYZO_RMUL.YLLGHGIZK.IVKLIG_KFYHFY())
            IVG += '\Mglk 89 FHZTV GLKRXH:\M-----\M'
            IVG += '\M'.QLRM(['   %75H %3.7U%X'%(R[9], UOLZG(R[8]),'%')
                              ULI R RM TOLYZO_RMUL.KFYHFY_NZMZTVI.NLMRGLI()[:89]])
            HVOU.IVHKLMHV.NVHHZTV = IVG
            IVGFIM HVOU.IVHKLMHV
        VORU 'HGZGFH' RM ZITFNVMGH:
            IVG_ORHG = []
            YLLGHGIZK = TOLYZO_RMUL.YLLGHGIZK
            # IVG_ORHG.ZKKVMW('yILPVI hGZGFH   : [%3H] %H' %( YLLGHGIZK.KFYHFY.YILPVI_DLIPVI.KRW, YLLGHGIZK.KFYHFY.YILPVI_DLIPVI.HGZGFH) )
            IVG_ORHG.ZKKVMW('kFYHFY hGZGFH       : [%3H] %H' %( YLLGHGIZK.KFYHFY.KFYHFY_DLIPVI.KRW, YLLGHGIZK.KFYHFY.KFYHFY_DLIPVI.HGZGFH) )
            ULI P, E RM TOLYZO_RMUL.QLYH.RGVNH():
                RU E.K RH mLMV:
                    HGZGFH = 'LUUORMV'
                VOHV:
                    HGZGFH = E.K.HGZGFH()
                    RU (HGZGFH == KHFGRO.hgzgfh_ifmmrmt LI
                        HGZGFH == KHFGRO.hgzgfh_hovvkrmt LI
                        HGZGFH == KHFGRO.hgzgfh_wrhp_hovvk):
                        HGZGFH = 'LMORMV'
                IVG_ORHG.ZKKVMW('%-79H: [%3H] %H-%H'%(P, E.GRW, HGZGFH,E.K.HGZGFH()))
            ULI E RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_ORHG:
                RU E[8] RH mLMV:
                    HGZGFH = 'LUUORMV'
                VOHV:
                    HGZGFH = E[8].K.HGZGFH()
                    RU (HGZGFH == KHFGRO.hgzgfh_ifmmrmt LI
                        HGZGFH == KHFGRO.hgzgfh_hovvkrmt LI
                        HGZGFH == KHFGRO.hgzgfh_wrhp_hovvk):
                        HGZGFH = 'LMORMV'
                IVG_ORHG.ZKKVMW('[n]%-82H: [%3H] %H-%H' % (E[9].__NLWFOV_RW__, E[8].GRW, HGZGFH, E[8].K.HGZGFH()))



            IVG = '--------------hfnnzib--------------\M'
            IVG += 'hbhgvn hgzgfh: lp\M'
            IVG += '----------------------------------\M'
            IVG += '\M'.QLRM(IVG_ORHG)
            IVG += '\M---------------------------------'
            IVG += '\MgSVIV RH 9 HFHKRXRLFH RMXRWVMGH'
            HVOU.IVHKLMHV.NVHHZTV = IVG
            IVGFIM HVOU.IVHKLMHV

//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_KZFHV.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_KZFHV(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL KZFHV GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_KZFHV, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'KZFHV'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'XLNKLMVMG' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLNKLMVMG'].HGIRK()
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVG = NLMRGLI.NZMFZO_KZFHV_XLNKLMVMG(GZITVG)
                HVOU.IVHKLMHV.NVHHZTV = IVG
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'ML NLWFOV ZH nLMRGLIhBHGVN'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_HGLK.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_HGLK(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL HGLK GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_HGLK, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'HGLK'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'XLNKLMVMG' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLNKLMVMG'].HGIRK()
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVG = NLMRGLI.NZMFZO_PROO_XLNKLMVMG(GZITVG)
                HVOU.IVHKLMHV.NVHHZTV = IVG
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'ML NLWFOV ZH nLMRGLIhBHGVN'
        VOHV:
            RU TOLYZO_RMUL.YLLGHGIZK.HGZIUOVVG_NZHGVI:
                TOLYZO_RMUL.OLTTVI.RMUL('[XNW-HGLK] YLLGHGIZK HGLKKRMT...')
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVG = NLMRGLI.PROO_ZOO( RH_NZMFZO_PROO = gIFV, VMHFIV=gIFV  )
                TOLYZO_RMUL.YLLGHGIZK.PROO()
            VOHV:
                TOLYZO_RMUL.OLTTVI.RMUL('[XNW-HGLK] YLLGHGIZK MVVWH ML ZWWRGRLMZO ZGGVMGRLM')
                RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                    NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                    IVG = NLMRGLI.PROO_ZOO( RH_NZMFZO_PROO = gIFV, VMHFIV=gIFV  )
            TOLYZO_RMUL.HGLK = gIFV
            HVOU.IVHKLMHV.NVHHZTV = 'XLNNZMW HGLK VCVXFGVW, HGZIUOVVG RH HGLKKRMT'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_ORTSG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_ORTSG(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL ORTSG GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_ORTSG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'ORTSG'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        KIRMG(ZITFNVMGH)
        RU 'XLNKLMVMG' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLNKLMVMG'].HGIRK()
        VORU 'XLN' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLN'].HGIRK()
        VOHV:
            HVOU.IVHKLMHV.NVHHZTV = 'NFHG RMKFG XLNKLMVMG ZH XLN=[]'

        RU 'ORTSG' RM ZITFNVMGH:
            ORTSG = ZITFNVMGH['ORTSG'].HGIRK()
        VOHV:
            HVOU.IVHKLMHV.NVHHZTV = 'NFHG RMKFG ORTSG ZH ORTSG=[]'

        RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
            KIRMG(NLMRGLI, GZITVG, ORTSG)
            IVG = NLMRGLI.NZMFZO_ORTSG_XLNKLMVMG(GZITVG, ORTSG)
            HVOU.IVHKLMHV.NVHHZTV = IVG
        VOHV:
            HVOU.IVHKLMHV.NVHHZTV = 'ML NLWFOV ZH nLMRGLIhBHGVN'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_IVHGZIG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_IVHGZIG(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL IVHGZIG GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_IVHGZIG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'IVHGZIG'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'XLNKLMVMG' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLNKLMVMG'].HGIRK()
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVG = NLMRGLI.IVHGZIG_XLNKLMVMG(GZITVG)
                HVOU.IVHKLMHV.NVHHZTV = IVG
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'ML NLWFOV ZH nLMRGLIhBHGVN'
        VOHV:
            TOLYZO_RMUL.IVYLLG()
        HVOU.IVHKLMHV.NVHHZTV = 'IVYLLG XLNNZMW VCVXFGVW'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/NLWFOVH/NLMRGLIHBHGVN/XLNNZMW/XLNNZMWH/XNW_IVHFNV.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_IVHFNV(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL IVHFNV GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_IVHFNV, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'IVHFNV'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'XLNKLMVMG' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLNKLMVMG'].HGIRK()
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVG = NLMRGLI.NZMFZO_IVHFNV_XLNKLMVMG(GZITVG)
                HVOU.IVHKLMHV.NVHHZTV = IVG
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'ML NLWFOV ZH nLMRGLIhBHGVN'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/NLWFOVH/FYRJWMH/FYRJWMH.KB
RNKLIG HBH
evihrlm = ''
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG GRNV
RNKLIG LH
RNKLIG WZGVGRNV
RNKLIG QHLM
# UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGhVIEVI
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
UILN FYRJGLLO.YFOOVGRM RNKLIG yFOOVGRM
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

XOZHH FYRJWMH_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        KZHH

XOZHH wmh(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.RW = CNO.ZGGIRY['RW'].HGIRK()
        HVOU.ZWWI = CNO.ZGGIRY['ZWWI'].HGIRK()
        HVOU.KLIG = CNO.ZGGIRY['KLIG'].HGIRK()
        HVOU.NZGXS = CNO.ZGGIRY['NZGXS'].HGIRK()
        # HVOU.OLTTVI.RMUL('[ivozb yllg] OLZWVW IVOZB %H, FIO:%H'%(HVOU.RW, HVOU.GZITVG_FIO))



XOZHH FYRJWMH(nLWFOV):
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.WMH_ORHG = []
        # ZWWIVHH = HVOU.CNO.ZGGIRY['KLHG_HVIEVI']
        # HVOU.ZWWI = ZWWIVHH.HKORG(':')[9]
        # HVOU.KLIG = ZWWIVHH.HKORG(':')[8]
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.YFOOVGRM = yFOOVGRM('FYRJWMH')
        HVOU.YFOOVGRM.IVXIVZGV()
        RU MLG LH.KZGS.VCRHGH('/RMX/FYRJWMH.CNO'):
            HVOU.WMH_gh = mLMV
        VOHV:
            HVOU.WMH_gh = LH.KZGS.TVGNGRNV('/RMX/FYRJWMH.CNO')
        HVOU.TVGWMH()

    WVU TVGWMH(HVOU):
        RU MLG LH.KZGS.VCRHGH('/RMX/FYRJWMH.CNO'):
            IVGFIM
        ILLG = VGIVV.KZIHV('/RMX/FYRJWMH.CNO')
        HVOU.ILLG = ILLG.TVGILLG()
        HVOU.WMH_ORHG.XOVZI()
        ULI CNO RM HVOU.ILLG.URMWZOO('WMH'):
            WMH = wmh(CNO, HVOU.TOLYZO_RMUL)
            HVOU.WMH_ORHG.ZKKVMW(WMH)
        HVOU.OLTTVI.RMUL('[FYRJWMH] XLOOVXGVW WMH %W SFYH'%OVM(HVOU.WMH_ORHG))
        ULI WMH RM HVOU.WMH_ORHG:
            HVOU.YFOOVGRM.ZWW_ILD('WMH', WMH.NZGXS,  WMH.ZWWI+':'+WMH.KLIG)


    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL('[FYRJWMH] IVZWB GL HVIEVI WMH %W SFYH'%OVM(HVOU.WMH_ORHG))
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            RU LH.KZGS.VCRHGH('/RMX/FYRJWMH.CNO'):
                gh = LH.KZGS.TVGNGRNV('/RMX/FYRJWMH.CNO')
                RU gh != HVOU.WMH_gh:
                    HVOU.OLTTVI.RMUL('WMH UROV FKWZGVW')
                    HVOU.TVGWMH()
                    HVOU.WMH_gh = gh
            GRNV.HOVVK(4)
//##**---------------- ./HGZIUOVVG/NLWFOVH/SREV/SREV.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GRNV
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
UILN XLNKLMVMG.SZIWDZIVNLMRGLI RNKLIG sZIWDZIVnLMRGLI
RNKLIG GLLO.XKFRMUL ZH XKFRMUL
RNKLIG QHLM
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
UILN FYRJKBZGZNLWVO.NLWVO RNKLIG hVIEVIhGZGFH, wZGZnZMZTVI
RNKLIG KRXPOV
RNKLIG WZGVGRNV
UILN YZHV.YZHV_WZGZ_HGIFXG RNKLIG xZMZIBiVKLIGwZGZdIZKKVI#, xZMZIBwZGZgBKV

XOZHH SREV(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''
    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.WZGZ_EZFOG = HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG #xZMZIBiVKLIGwZGZ()
        HVOU.IVKLIG_GRNVH = 9
        RU 'NZRMYZHV' RM MLWV.ZGGIRY:
            HVOU.HVIEVI_GZT = MLWV.ZGGIRY['NZRMYZHV']
        VOHV:
            HVOU.HVIEVI_GZT = TOLYZO_RMUL._NZRMYZHV
        TOLYZO_RMUL.OLTTVI.RMUL('[yllg] SREV VMTZTVH NZRMYZHV-> %H '%HVOU.HVIEVI_GZT)
        HVOU.IVKLIG = ''
        HVOU.IVKLIG_rw = ''


    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW == 'IVJFVHG-SREV':
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, WZGZ=HVOU.XFIIVMG_XKF)
        VORU QLY.XLNNZMW == 'IVKLIG-SREV-IFMGRNV':
            # IVXVREV OLXZO IVKLIG UILN XZMZIB
            IVXE_WZGZ = KRXPOV.OLZWH(QLY.QLY)
            RW = IVXE_WZGZ['RW']
            RU IVXE_WZGZ['RW'] MLG RM HVOU.WZGZ_EZFOG:
                HVOU.WZGZ_EZFOG[RW] = xZMZIBiVKLIGwZGZdIZKKVI(RW, IVXE_WZGZ['UIVJFVMXB'])
            HVOU.WZGZ_EZFOG[RW].WZGZ = IVXE_WZGZ['WZGZ']
            HVOU.WZGZ_EZFOG[RW].gh = IVXE_WZGZ['gh']
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV)


    WVU IFM(HVOU):
        DSROV gIFV:
            IVKLIG = ''
            IVKLIG_rw = ''
            IVG = HVOU.TOLYZO_RMUL.ZXJFRIV_NZRMYZHV(HVOU.HVIEVI_GZT)
            RU IVG RH MLG mLMV:
                IVKLIG = IVG.HKORG('&')[8]
                IVKLIG_rw = IVG.HKORG('&')[9]
            RU IVKLIG == '':
                GRNV.HOVVK(8)
                XLMGRMFV

            RU HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG RH MLG mLMV:
                IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
                GL_HVMW = {}
                ULI RW, WZGZ RM HVOU.WZGZ_EZFOG.RGVNH():
                    RU WZGZ.MVVW_IVOZB(WZGVGRNV.WZGVGRNV.MLD()):
                        GL_HVMW[RW] = WZGZ.KZXP_WZGZ()
                HGZGFH = uZOHV
                NHT = IVWHSRUG.MVD_NHT()
                NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                NHT.WHG = IVKLIG
                NHT.XLNNZMW = 'IVKLIG_SREV_GL_NZRMYZHV'
                NHT.WZGZ = KRXPOV.WFNKH(GL_HVMW)
                NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                GIB:
                    IVKOB = IVWHSRUG.HVMW(NHT)
                    RU IVKOB.NVHHZTV == 'tllw':
                        #KIRMG(IVKOB)
                        RU HVOU.IVKLIG_rw != IVKLIG_rw:
                            HVOU.IVKLIG = IVKLIG
                            HVOU.IVKLIG_rw = IVKLIG_rw
                            HVOU.OLTTVI.RMUL('[srev] URIHG IVKLIG ->%H HFXXVVWVW'%IVKLIG)
                        HVOU.IVKLIG_GRNVH += 8
                        HGZGFH = gIFV
                    VOHV:
                        HVOU.OLTTVI.VIILI("IVKLIG SREV GL NZRMYZHV UZROVW DRGS viili: %H"%IVKOB.NVHHZTV)
                        HGZGFH = uZOHV
                VCXVKG vCXVKGRLM ZH V:
                    HGZGFH = uZOHV
                    HVOU.OLTTVI.VIILI("IVKLIG IFMGRNV SZIWDZIV VIILI %H"%HGI(V))
                RU MLG HGZGFH:
                    ULI RW RM GL_HVMW:
                        HVOU.WZGZ_EZFOG[RW].HVMWRMT = 9
                VOHV:
                    ULI RW RM GL_HVMW:
                        HVOU.WZGZ_EZFOG[RW].OZHG_GRNVHGZNK = WZGVGRNV.WZGVGRNV.MLD()
                        HVOU.WZGZ_EZFOG[RW].gh = mLMV
                        HVOU.WZGZ_EZFOG[RW].HVMWRMT = 9
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/NLWFOVH/KLHGIVOZB/KLHGIVOZB.KB
RNKLIG HBH
evihrlm = ''
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG GRNV
RNKLIG WZGVGRNV
#UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG
RNKLIG QHLM
RNKLIG IVJFVHGH
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGhVIEVI
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
UILN SGGK.HVIEVI RNKLIG yZHVsggkiVJFVHGsZMWOVI
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG

# XOZHH kLHGxORVMG(LYQVXG):
    # WVU __RMRG__(HVOU):
        # KZHH

    # WVU HVG_ZWWIVHH(HVOU, ZWWI, KLIG):
        # HVOU.ZWWI = ZWWI
        # HVOU.KLIG = RMG(KLIG)
        # HVOU.ZWWI_ORMV = 'SGGK://%H:%W'%(ZWWI, KLIG)

    # WVU KLHG(HVOU, KIVURC, KZBOLZW, QHLMWZGZ=mLMV):
        # RU OVM(KIVURC) != 9 ZMW KIVURC[9] != '/':
            # KIVURC = '/'+KIVURC
        # RU QHLMWZGZ RH MLG mLMV:
            # QHLMWZGZ['GBKV'] = KZBOLZW['GBKV']
            # GIB:
                # IVG = IVJFVHGH.KLHG(HVOU.ZWWI_ORMV+KIVURC, QHLM=QHLMWZGZ)
            # VCXVKG vCXVKGRLM ZH V:
                # GIZXVYZXP.KIRMG_VCXVKGRLM(*HBH.VCX_RMUL())
                # IVGFIM {'HGZGFH':uZOHV, 'XLWV':599, 'IVZHLM':HGI(V)}
        # VOHV:
            # QHLMWZGZ = {'GBKV':KZBOLZW['GBKV']}
            # GIB:
                # IVG = IVJFVHGH.KLHG(HVOU.ZWWI_ORMV+KIVURC, QHLM=QHLMWZGZ)
            # VCXVKG vCXVKGRLM ZH V:
                # #GIZXVYZXP.KIRMG_VCXVKGRLM(*HBH.VCX_RMUL())
                # IVGFIM {'HGZGFH':uZOHV, 'XLWV':599, 'IVZHLM':HGI(V)}
        # RU IVG.IVZHLM != 'lp':
            # IVGFIM {'HGZGFH':uZOHV, 'XLWV':IVG.HGZGFH_XLWV, 'IVZHLM':IVG.IVZHLM}
        # RU IVG.GVCG.HGIRK() == '':
            # IVGFIM {'HGZGFH':gIFV, 'WZGZ':{}}
        # IVGFIM QHLM.OLZWH(IVG.GVCG)


    # WVU KLHG(HVOU, KIVURC, KZBOLZW, QHLMWZGZ=mLMV):
        # RU OVM(KIVURC) != 9 ZMW KIVURC[9] != '/':
            # KIVURC = '/'+KIVURC
        # # RU QHLMWZGZ RH MLG mLMV:
            # # QHLMWZGZ['GBKV'] = 'GIRTTVI'
            # # IVG = IVJFVHGH.KLHG(HVOU.ZWWI_ORMV+KIVURC, QHLM=QHLMWZGZ)
        # # VOHV:
        # # QHLMWZGZ = {'GBKV':KZBOLZW['GBKV']}
        # KIRMG(KZBOLZW, QHLMWZGZ)
        # IVG = IVJFVHGH.KLHG(HVOU.ZWWI_ORMV+KIVURC, KZBOLZW, QHLM=QHLMWZGZ)
        # KIRMG(IVG.SVZWVIH)
        # RU IVG.IVZHLM != 'lp':
            # IVGFIM QHLM.WFNKH({'HGZGFH':uZOHV, 'XLWV':IVG.HGZGFH_XLWV, 'IVZHLM':IVG.IVZHLM})
        # RU IVG.GVCG.HGIRK() == '':
            # IVGFIM QHLM.WFNKH({'HGZGFH':gIFV, 'WZGZ':{}})
        # IVGFIM QHLM.OLZWH(IVG.GVCG)


IVOZB_NZK = {}
XORVMG = kLHGxORVMG()

XOZHH kLHGhVIEVIsZMWOVI(yZHVsggkiVJFVHGsZMWOVI):

    WVU HVG_OLTTVI(HVOU, OLTTVI):
        HVOU.OLTTVI = OLTTVI

    WVU _HVG_IVHKLMHV(HVOU, TARK=uZOHV, OVMTGS = 9):
        HVOU.HVMW_IVHKLMHV(799)
        HVOU.HVMW_SVZWVI('xLMGVMG-GBKV', 'GVCG/SGNO')
        RU OVMTGS != 9:
            HVOU.HVMW_SVZWVI('xLMGVMG-OVMTGS', HGI(OVMTGS))
        RU TARK:
            HVOU.HVMW_SVZWVI('xLMGVMG-vMXLWRMT', 'TARK')
        HVOU.VMW_SVZWVIH()
        HVOU.XORVMG = XORVMG

    WVU KIRMG_SVZW(HVOU):
        IVGFIM 'tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M'%(HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))


    WVU WL_tvg(HVOU):
        #OLTTRMT.RMUL("tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M", HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))
        HVOU._HVG_IVHKLMHV()
        HVOU.DUROV.DIRGV("tvg IVJFVHG ULI {}".ULINZG(HVOU.KZGS).VMXLWV('FGU-1'))


    WVU WL_klhg(HVOU):
        ZWWIVHH = ''
        TOLYZO IVOZB_NZK
        KIVURC = ''
        RU HVOU.KZGS[-8] != '/':
            HVOU.KZGS += '/'
        ULI P RM IVOZB_NZK:
            RU HVOU.KZGS.HGZIGHDRGS(P):
                KIVURC = P
                ZWWIVHH = IVOZB_NZK[P][9]
                GZITVG = IVOZB_NZK[P][8]
                YIVZP
        XLMGVMG_OVMTGS = RMG(HVOU.SVZWVIH['xLMGVMG-oVMTGS']) # <--- tVGH GSV HRAV LU WZGZ
        KLHG_WZGZ_IZD = HVOU.IUROV.IVZW(XLMGVMG_OVMTGS) # <--- tVGH GSV WZGZ RGHVOU
        RU ZWWIVHH=='':
            HVOU._HVG_IVHKLMHV(TARK=uZOHV)
            HVOU.DUROV.DIRGV(QHLM.WFNKH({'HGZGFH':uZOHV, 'IVZHLM':'XZMMLG IVXLTMRAV %H'%HVOU.KZGS}).VMXLWV('FGU-1'))
       	    IVGFIM
        TOLYZO XORVMG
        WZGZ = QHLM.OLZWH(KLHG_WZGZ_IZD.WVXLWV('FGU-1'))
        XORVMG.HVG_ZWWIVHH(ZWWIVHH.HKORG(':')[9], RMG(ZWWIVHH.HKORG(':')[8]))
        RU 'GBKV' RM WZGZ:
            RU WZGZ['GBKV'] == 'GIRTTVI':
                XOR = XORVMG.KLHG(GZITVG+HVOU.KZGS.IVKOZXV(KIVURC, '', 8), {'GBKV':'GIRTTVI'}, QHLMWZGZ=WZGZ)
            VORU WZGZ['GBKV'] == 'JFVIB':
                # KIRMG(WZGZ)
                # KIRMG(GZITVG+HVOU.KZGS.IVKOZXV(KIVURC, '', 8))
                XOR = XORVMG.KLHG(GZITVG+HVOU.KZGS.IVKOZXV(KIVURC, '', 8), {'GBKV':'JFVIB'}, QHLMWZGZ=WZGZ)
                # KIRMG(XOR)
        VOHV:
            XOR = XORVMG.KLHG(HVOU.KZGS.IVKOZXV(KIVURC, '', 8), WZGZ)
        HVOU._HVG_IVHKLMHV(TARK=uZOHV)
        HVOU.DUROV.DIRGV(QHLM.WFNKH(XOR).VMXLWV('FGU-1'))


XOZHH KLHGIVOZB_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        KZHH

XOZHH iVKOZB(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.RW = CNO.ZGGIRY['RW']
        HVOU.OZHG_GRNV = WZGVGRNV.WZGVGRNV.MLD()
        ZWW_ORHG = CNO.ZGGIRY['GZITVG'].HGIRK()
        HVOU.IVOZB_ZWWIVHH = CNO.ZGGIRY['IVOZB']
        RU 'KIVURC' RM CNO.ZGGIRY:
            HVOU.GZITVG = CNO.ZGGIRY['KIVURC']
            RU HVOU.GZITVG[9] != '/':
                HVOU.GZITVG = '/'+HVOU.GZITVG
            RU HVOU.GZITVG[-8] == '/':
                HVOU.GZITVG = HVOU.GZITVG[:-8]
        VOHV:
            HVOU.GZITVG = ''
        TOLYZO IVOZB_NZK
        RU ZWW_ORHG[9] != '/':
            ZWW_ORHG = '/' + ZWW_ORHG
        RU ZWW_ORHG[-8]!='/':
            ZWW_ORHG += '/'
        IVOZB_NZK[ZWW_ORHG] = (HVOU.IVOZB_ZWWIVHH, HVOU.GZITVG)

        HVOU.OLTTVI.RMUL('[ivozb yllg] OLZWVW IVOZB %H, FIO:%H'%(HVOU.RW, ZWW_ORHG))



XOZHH KLHGIVOZB(nLWFOV):
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.ILLG = ILLG.TVGILLG()
        HVOU.IVOZB_ORHG = []
        ZWWIVHHVH = [R.HGIRK() ULI R RM HVOU.CNO.ZGGIRY['KLHG_HVIEVI'].HKORG(',')]
        HVOU.ZWWIVHH_ORHG = [R.HKORG(':') ULI R RM ZWWIVHHVH]
        ULI CNO RM HVOU.ILLG.URMW('IVWRIVXGH').URMWZOO('IVWRIVXG'):
            # HVOU.OLTTVI.RMUL('[yllg] ZWWVW IVOZB %H'%)
            IVOZB = iVKOZB(CNO, TOLYZO_RMUL)
            HVOU.IVOZB_ORHG.ZKKVMW(IVOZB)
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI


    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL('[KLHGIVOZB] IVZWB GL IVWRIVXG %W SFYH'%OVM(HVOU.IVOZB_ORHG))
        HVOU.KLHG_HVIEVIH = []
        HVOU.KLHG_HVIEVI_QLYH = []
        ULI ZWWI RM HVOU.ZWWIVHH_ORHG:
            HVOU.KLHG_HVIEVIH.ZKKVMW( kLHGhVIEVI(ZWWI[9], RMG(ZWWI[8]), kLHGhVIEVIsZMWOVI, HVOU.OLTTVI) )
            HVOU.KLHG_HVIEVI_QLYH.ZKKVMW(qLY(HVOU.KLHG_HVIEVIH[-8]))
            HVOU.TOLYZO_RMUL.QLYH['IVOZB_kLHGhVIEVI@%H_%H'%(ZWWI[9], ZWWI[8])] = HVOU.KLHG_HVIEVI_QLYH[-8]
            HVOU.KLHG_HVIEVI_QLYH[-8].HGZIG()
            HVOU.OLTTVI.RMUL('[yllg] HGZIGVW HVIEVI %H:%H'%(ZWWI[9], ZWWI[8]))
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/NLWFOVH/DVY/DVY.KB
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
# RNKLIG LH
# RNKLIG KHFGRO
# RNKLIG HFYKILXVHH
# RNKLIG WZGVGRNV
# RNKLIG HRTMZO
RNKLIG HBH
evihrlm = ''
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/')
# UILN XLNNFMRXZGV.XORVMG RNKLIG hGZIUOVVGwLXPVI
# RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
# RNKLIG QHLM
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)

# UILN XORVMGSVOKVI.FGRO RNKLIG RNKLIG_NLMRGLI
# RNKLIG MVGRUZXVH
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG GRNV
# RNKLIG KRXPOV
UILN ZKK.HVIERXV.ERVDH RNKLIG YOFVKIRMG ZH HVIERXV
UILN ZKK.ZFGS_OWZK RNKLIG owzkgLLO
RNKLIG ZKK.TOLYZO_HVGGRMTH ZH ZKK_TOLYZO
UILN UOZHP_OLTRM RNKLIG oLTRMnZMZTVI
#OLTRM_NZMZTVI = oLTRMnZMZTVI()
#OLTRM_NZMZTVI.RMRG_ZKK(ZKK.ZKK)
UILN HJOZOXSVNB RNKLIG XIVZGV_VMTRMV
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI


XOZHH DVY_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.ZOO_WZGZ = {}
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        # KFHS HGZIUOVVG TOLYZORMUL GL DVY ZKK
        ZKK_TOLYZO.TOLYZO_HVGGRMTH.TOLYZO_RMUL = TOLYZO_RMUL
        # KFOO HGZIUOVVG TOLYZORMUL HVGGRMTH
        HVOU.DVY_TOLYZO_HVGGRMTH = ZKK_TOLYZO.TOLYZO_HVGGRMTH
        RU SZHZGGI(HVOU.DVY_TOLYZO_HVGGRMTH, 'DLIPVIH'):
            ULI DLIPVI RM HVOU.DVY_TOLYZO_HVGGRMTH.DLIPVIH:
                # KIRMG(DLIPVI)
                qLY(DLIPVI).HGZIG()

    WVU KZIHV_WZGZYZHV(HVOU):
        HVOU.DVY_TOLYZO_HVGGRMTH.HVHHRLM_NZK = {}
        ULI PVB RM HVOU.DVY_TOLYZO_HVGGRMTH.DVY_KZIZH:
            WZGZYZHV_KZIZ = HVOU.DVY_TOLYZO_HVGGRMTH.DVY_KZIZH[PVB]
            KZHHDW = mLMV
            DSROV KZHHDW RH mLMV:
                KZHHDW = HVOU.DVY_TOLYZO_HVGGRMTH.TOLYZO_RMUL.HGZIUOVVG_WLXPVI.JFVIB_KZHHDLIW('%H_%H'%(WZGZYZHV_KZIZ['WZGZYZHV'], WZGZYZHV_KZIZ['OLXZGRLM']),WZGZYZHV_KZIZ['FHVI'])
                VMTRMV = XIVZGV_VMTRMV('NBHJO+KBNBHJO://%H:%H@%H/%H?XSZIHVG=FGU1'%(WZGZYZHV_KZIZ['FHVI'], KZHHDW, WZGZYZHV_KZIZ['ZWWIVHH'], WZGZYZHV_KZIZ['WZGZYZHV']), KLLO_HRAV=899)
                hVHHRLM = HVHHRLMNZPVI(YRMW=VMTRMV)
                HVOU.DVY_TOLYZO_HVGGRMTH.HVHHRLM_NZK[PVB] = hVHHRLM


    WVU IFM(HVOU):
        DSROV gIFV:
            GRNV.HOVVK(7)


XOZHH DVY(nLWFOV):
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL.DVY_WZGZ = DVY_WZGZ(CNO, TOLYZO_RMUL)
        HVOU.CNO = CNO
        HVOU.ILLG = ILLG
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.DVY_WZGZ = HVOU.TOLYZO_RMUL.DVY_WZGZ
        HVOU.DVY_TOLYZO_HVGGRMTH = HVOU.DVY_WZGZ.DVY_TOLYZO_HVGGRMTH
        HVOU.DVY_TOLYZO_HVGGRMTH.DVY_KZIZH = {}
        RU ILLG.URMW('DVYKZIZ') RH MLG mLMV:
            ULI KZIZ_CNO RM ILLG.URMW('DVYKZIZ').URMWZOO('KZIZ'):
                WZGZ = {}
                HVOU.OLTTVI.RMUL('[yllg] OLZWVW KZIZ %H'%KZIZ_CNO.ZGGIRY['RW'])
                ULI P RM KZIZ_CNO.ZGGIRY:
                    WZGZ[P] = KZIZ_CNO.ZGGIRY[P]
                HVOU.DVY_TOLYZO_HVGGRMTH.DVY_KZIZH[KZIZ_CNO.ZGGIRY['RW']] = WZGZ
        HVOU.DVY_WZGZ.KZIHV_WZGZYZHV()
        UILN ZKK RNKLIG ZKK
        ZKK.ZKK.IVTRHGVI_YOFVKIRMG(HVIERXV)
        HVOU.RK = HVOU.CNO.ZGGIRY['RK']
        HVOU.KLIG = HVOU.CNO.ZGGIRY['KLIG']
        RU 'HHO' RM HVOU.CNO.ZGGIRY:
            HVOU.HHO = (HVOU.CNO.ZGGIRY['HHO'].OLDVI() == 'GIFV')
        VOHV:
            HVOU.HHO = uZOHV
        HVOU.FHV_HLXPVGRL = uZOHV
        HVOU.FHV_WVYFT = uZOHV
        RU 'DLIPVI' RM HVOU.CNO.ZGGIRY:
            HVOU.DLIPVI_MFN = RMG(HVOU.CNO.ZGGIRY['DLIPVI'])
        VOHV:
            HVOU.DLIPVI_MFN = 6
        HVOU.OLTTVI.RMUL('DLIPVI MFNYVI HVG GL %W'%HVOU.DLIPVI_MFN)
        RU 'HLXPVGRL' RM HVOU.CNO.ZGGIRY:
            HVOU.FHV_HLXPVGRL = (HVOU.CNO.ZGGIRY['HLXPVGRL'].OLDVI() == 'GIFV')
        RU HVOU.FHV_HLXPVGRL:
            HVOU.OLTTVI.RMUL('[yllg] DVY FHVH HLXPVGRL')

        RU 'NZRM_GSIVZW' RM HVOU.CNO.ZGGIRY:
            HVOU.FHV_NZRM_GSIVZW  = (HVOU.CNO.ZGGIRY['NZRM_GSIVZW'].OLDVI() == 'GIFV')
        VOHV:
            HVOU.FHV_NZRM_GSIVZW  = uZOHV

        RU 'WVYFT' RM HVOU.CNO.ZGGIRY:
            HVOU.FHV_WVYFT = (HVOU.CNO.ZGGIRY['WVYFT'].OLDVI() == 'GIFV')
        RU HVOU.FHV_WVYFT:
            HVOU.OLTTVI.RMUL('[yllg] DVY FHVH WVYFT')
        #RU MLG HVOU.FHV_WVYFT:
        HVOU.TOLYZO_RMUL._DVY_HVIEVI = ZKK.ZKK
        RU MLG SZHZGGI(ZKK, 'HLXPVGRL'):
            ZKK.HLXPVGRL = mLMV
        RU HVOU.HHO:
            HVOU.TOLYZO_RMUL._DVY_LKGRLMH = {
                'TFMRXLIM':{
                    'YRMW': '%H:%H'%(HVOU.RK, HVOU.KLIG),
                    'DLIPVIH': HVOU.DLIPVI_MFN,
                    'XVIGUROV':'/KFYORX/XVIG/XVIG.KVN',
                    'PVBUROV':'/KFYORX/XVIG/PVB.KVN',
                },
                'LKGRLMH':{
                    'WVYFT':HVOU.FHV_WVYFT,
                    'NZRM_GSIVZW':HVOU.FHV_NZRM_GSIVZW,
                    'FHV_HLXPVGRL' : HVOU.FHV_HLXPVGRL,
                    'ZKK':ZKK.ZKK,
                    'HLXPVGRL':ZKK.HLXPVGRL,
                    'SLHG':HVOU.RK,
                    'KLIG':RMG(HVOU.KLIG),
                }
            }
        VOHV:
            HVOU.TOLYZO_RMUL._DVY_LKGRLMH = {
                'TFMRXLIM':{
                    'YRMW': '%H:%H'%(HVOU.RK, HVOU.KLIG),
                    'DLIPVIH': HVOU.DLIPVI_MFN,
                },
                'LKGRLMH':{
                    'WVYFT':HVOU.FHV_WVYFT,
                    'NZRM_GSIVZW':HVOU.FHV_NZRM_GSIVZW,
                    'FHV_HLXPVGRL' : HVOU.FHV_HLXPVGRL,
                    'ZKK':ZKK.ZKK,
                    'HLXPVGRL':ZKK.HLXPVGRL,
                    'SLHG':HVOU.RK,
                    'KLIG':RMG(HVOU.KLIG),
                }
            }

        HVOU.OLTTVI.RMUL('DVY DLIPH RM KILWFXGRLM')

    WVU IFM(HVOU):
        UILN ZKK RNKLIG ZKK
        HVOU.OLTTVI.RMUL('[yllg] DVY IFMH ZG %H:%W'%(HVOU.RK, RMG(HVOU.KLIG)))
        RU MLG HVOU.FHV_NZRM_GSIVZW:
            RU HVOU.FHV_HLXPVGRL:
                ZKK.HLXPVGRL.IFM(ZKK.ZKK, WVYFT=HVOU.FHV_WVYFT, SLHG=HVOU.RK, KLIG=RMG(HVOU.KLIG))
            VOHV:
                RU HVOU.HHO:
                    #UILN UOZHP_HHORUB RNKLIG hhoRUB
                    #HHORUB = hhoRUB(ZKK.ZKK)
                    ZKK.ZKK.IFM(WVYFT=HVOU.FHV_WVYFT, GSIVZWVW=gIFV, FHV_IVOLZWVI=uZOHV, SLHG=HVOU.RK, KLIG=RMG(HVOU.KLIG), HHO_XLMGVCG=('/KFYORX/XVIG/XVIG.KVN', '/KFYORX/XVIG/PVB.KVN'))
                VOHV:
                    ZKK.ZKK.IFM(WVYFT=HVOU.FHV_WVYFT, GSIVZWVW=gIFV, FHV_IVOLZWVI=uZOHV, SLHG=HVOU.RK, KLIG=RMG(HVOU.KLIG))
            # ZKK.ZKK.WVYFT = uZOHV
            # zKKORXZGRLM(ZKK.ZKK, LKGRLMH).IFM()
        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/NLWFOVH/ZGSVMZ/IVZWVIH/WY.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG FYRJKBZGZNLWVO.FYRJWY_NLWVO ZH FYRJWY
RNKLIG FYRJKBZGZNLWVO.GIZWV_XLMURT_NLWVO ZH GIZWVWY

# UILN GIZWVWY
WVU JIB_WYXLMURT(HVHH):
    VCXS_WRXG = {}
    ZOO_WY = HVHH.JFVIB(GIZWVWY.wyvCXSZMTV).ZOO()
    ULI WY RM ZOO_WY:
        RU WY.hVIEVI MLG RM VCXS_WRXG.PVBH():
            VCXS_WRXG[WY.hVIEVI] = {}
        RU WY.xSZMMVO MLG RM VCXS_WRXG[WY.hVIEVI].PVBH():
            VCXS_WRXG[WY.hVIEVI][WY.xSZMMVO] = []
        VCXS_WRXG[WY.hVIEVI][WY.xSZMMVO].ZKKVMW(WY.vCXSZMTVrw)
    IVGFIM VCXS_WRXG

# UILN FYRJWY
WVU JIB_VCXSZMTVH(HVHH, VCXSZMTVH):
    IVG = {}
    ZOO_VCXSZMTV = HVHH.JFVIB(FYRJWY.vCXSZMTV).ZOO()
    ULI V RM ZOO_VCXSZMTV:
        RU V.vCXSZMTVrw MLG RM VCXSZMTVH:
            XLMGRMFV
        IVG[V.vCXSZMTVrw] = V.gIZWRMTgRNViZMTV
    IVGFIM IVG


XOZHH WY(LYQVXG):
    WVU __RMRG__(HVOU, MLWV, TOLYZO_RMUL, ZGSVMZ):
        HVOU.MLWV = MLWV
        HVOU.ZGSVMZ = ZGSVMZ
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.ZWWIVHH = MLWV.ZGGIRY['ZWWIVHH']
        HVOU.FHVI = MLWV.ZGGIRY['FHVI']
        HVOU.KZHHDW = MLWV.ZGGIRY['KZHHDW']
        HVOU.WZGZ_NZMZTVI = GIZWVWY.wZGZnZMZTVI(HVOU.ZWWIVHH, HVOU.FHVI, HVOU.KZHHDW)
        HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['ZGSVMZ']['JFLGVH']  = {}

    WVU IVZW(HVOU):
        WZGZ = {'HVIEVIH': {}, 'vCXSZMTVH': {}}
        # TVG HVIEVI, XSZMMVO, VCXS
        HVHH = HVOU.WZGZ_NZMZTVI.tVGhVHHRLM()
        VCXSZMTVH = []
        VCXS_WRXG = JIB_WYXLMURT(HVHH)
        ULI HVIEVI RM VCXS_WRXG.PVBH():
            RU HVIEVI MLG RM WZGZ['HVIEVIH']:
                WZGZ['HVIEVIH'][HVIEVI] = {}
            ULI XSZMMVO RM VCXS_WRXG[HVIEVI].PVBH():
                #KIRMG('hVIEVI:',HVIEVI,',xSZMMVO:',XSZMMVO,'vCXSZMTVH:',VCXS_WRXG[HVIEVI][XSZMMVO])
                WZGZ['HVIEVIH'][HVIEVI][XSZMMVO.FKKVI()] = {
                    'vCXSZMTVH': VCXS_WRXG[HVIEVI][XSZMMVO]}
                ULI V RM VCXS_WRXG[HVIEVI][XSZMMVO]:
                    RU V MLG RM VCXSZMTVH:
                        VCXSZMTVH.ZKKVMW(V)
        HVHH.XOLHV()
        # TVG VCXSZMTVH
        HVHH = FYRJWY.wZGZnZMZTVI(HVOU.ZWWIVHH, HVOU.FHVI, HVOU.KZHHDW).tVGhVHHRLM()
        GRNV_WRXG = JIB_VCXSZMTVH(HVHH, VCXSZMTVH)
        ULI V, G RM GRNV_WRXG.RGVNH():
            RU G RH MLG mLMV ZMW 'gRNViZMTVH' RM G.PVBH():
                WZGZ['vCXSZMTVH'][V] = G['gRNViZMTVH']
        HVHH.XOLHV()
        HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['ZGSVMZ']['JFLGVH'] = WZGZ



RU __MZNV__ == '__NZRM__':
    GVHG = WY(mLMV, mLMV, mLMV)
    GVHG.ZWWIVHH = '872.9.9.8:6693'
    GVHG.FHVI = 'WZGZNZM'
    GVHG.KZHHDW = 'iZ*1NZ!F'
    GVHG.WZGZ_NZMZTVI = GIZWVWY.wZGZnZMZTVI(GVHG.ZWWIVHH, GVHG.FHVI, GVHG.KZHHDW)
    GVHG.IVZW()

//##**---------------- ./HGZIUOVVG/NLWFOVH/ZGSVMZ/IVZWVIH/ZXXLFMGH.KB
RNKLIG LH
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

XOZHH ZXXLFMGH(LYQVXG):
    WVU __RMRG__(HVOU, MLWV, TOLYZO_RMUL, ZGSVMZ):
        HVOU.MLWV = MLWV
        HVOU.ZGSVMZ = ZGSVMZ
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['ZGSVMZ']['ZXXLFMGH'] = {}

    WVU IVZW(HVOU):
        RU MLG LH.KZGS.RHUROV('/RMX/GIZWV_XLMURT.CNO'):
            IVGFIM uZOHV
        GIVV = VGIVV.KZIHV('/RMX/GIZWV_XLMURT.CNO')
        ULI ZXX_CNO RM GIVV.URMW('ZXXLFMGH').URMWZOO('ZXXLFMG'):
            WZGZ = {}
            ULI PVB RM ZXX_CNO.ZGGIRY:
                RU PVB RM ['KZHHDW', 'KZHHDLIW']:
                    XLMGRMFV
                WZGZ[PVB] = ZXX_CNO.ZGGIRY[PVB]
            HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['ZGSVMZ']['ZXXLFMGH'][WZGZ['RW']] = WZGZ
//##**---------------- ./HGZIUOVVG/NLWFOVH/ZGSVMZ/IVZWVIH/EVIHRLMH.KB
RNKLIG LH
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()

XOZHH EVIHRLMH(LYQVXG):
    '''GSRH NLWFOV RH GL HGLIV XLNNRG SRHGLIB LU EZIRLFH XLNKLMVMG'''
    WVU __RMRG__(HVOU, MLWV, TOLYZO_RMUL, ZGSVMZ):
        HVOU.MLWV = MLWV
        HVOU.ZGSVMZ = ZGSVMZ
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL.IVTRHGVI_JFVIB_UFMXGRLM('XLNNRGEVIHRLM', HVOU.TVG_EVIHRLM)
        KILTIZNH = HVOU.MLWV.ZGGIRY['XLNKLMVMGH'].HKORG(',')
        HVOU.EVIHRLMH = {}
        ULI KILTIZN RM KILTIZNH:
            HVOU.EVIHRLMH[KILTIZN] = []

    WVU TVG_EVIHRLM(HVOU, KLHGWZGZ):
        # KIRMG('-->', KLHGWZGZ)
        XLNNRG = ''
        KILTIZN = KLHGWZGZ['KILTIZN']
        RU 'XLNNRG' RM KLHGWZGZ:
            XLNNRG = KLHGWZGZ['XLNNRG']
        RU KILTIZN MLG RM HVOU.EVIHRLMH:
            IVGFIM {'HGZGFH':uZOHV, 'IVZHLM':'KILTIZN %H MLG IVXLTMRAVW' %KILTIZN}
        IVG  = []
        RU XLNNRG=='':
            IVGFIM {'HGZGFH':gIFV, 'WZGZ':HVOU.EVIHRLMH[KILTIZN]}
        ULI RGVN RM HVOU.EVIHRLMH[KILTIZN]:
            IVG.ZKKVMW(RGVN)
            RU XLNNRG RM RGVN.HGIRK():
                IVGFIM {'HGZGFH':gIFV, 'WZGZ':IVG}
        IVGFIM {'HGZGFH':uZOHV, 'IVZHLM':'JFVIB XLNNRG %H MLG RM ORHG'%XLNNRG}

    WVU IVZW(HVOU):
        ULI P RM HVOU.EVIHRLMH:
            HVOU.EVIHRLMH[P].XOVZI()
            RU P.HGIRK() RM ['FHRN', 'FGIZWV']:
                KZGS = '/LKG/EVIHRLM/%H/%H/%H-WVE/'%(evihrlm,P.HGIRK(),P.HGIRK())
            VOHV:
                KZGS = '/LKG/EVIHRLM/%H/%H'%(evihrlm, P.HGIRK())
            SRHGLIB_UROV = LH.KZGS.QLRM(KZGS, 'XLNNRG.SRHGLIB')
            DRGS LKVM(SRHGLIB_UROV, 'I') ZH U:
                ULI ORMV RM U:
                    HVOU.EVIHRLMH[P].ZKKVMW(ORMV.HGIRK('\M').HKORG()[8].HGIRK())

//##**---------------- ./HGZIUOVVG/NLWFOVH/ZGSVMZ/ZGSVMZ.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/' + evihrlm + '/KBGSLM-ORYH')
RNKLIG GRNV
RNKLIG LH
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
# RNKLIG QHLM
# UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
RNKLIG RNK
RNKLIG WZGVGRNV

WVU RNKLIG_IVZWVI(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'IVZWVIH') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)



XOZHH ZGSVMZ(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''

    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.ILLG = ILLG
        RU 'IVZWVI_KZGS' RM MLWV.ZGGIRY:
            HVOU.KZGS = MLWV.ZGGIRY['IVZWVI_KZGS']
        VOHV:
            HVOU.KZGS = './'
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['ZGSVMZ'] = {}
        HVOU.IVZWVI_ORHG = []
        HVOU.IVZWVI_KLLO = {}
        HVOU.OLZW()

    WVU OLZW(HVOU):
        ULI IVZWVI_CNO RM HVOU.ILLG.URMW('ZGSVMZIVZWVIH').URMWZOO('IVZWVI'):
            RU 'KZGS' RM IVZWVI_CNO.ZGGIRY:
                KZGS = IVZWVI_CNO.ZGGIRY['KZGS']
            VOHV:
                KZGS = LH.KZGS.QLRM(_XFIIVMG_ILLG, 'IVZWVIH')
            RU 'VEVIB' RM IVZWVI_CNO.ZGGIRY:
                VEVIB = RMG(IVZWVI_CNO.ZGGIRY['VEVIB'])
            VOHV:
                VEVIB  = 8
            NLWFOV = IVZWVI_CNO.ZGGIRY['NLWFOV']
            # KIRMG(KZGS, NLWFOV)
            (XOZHHLK, WVHG_KZGS) = RNKLIG_IVZWVI(NLWFOV, KZGS)
            IVZWVI = XOZHHLK(IVZWVI_CNO, HVOU.TOLYZO_RMUL, HVOU)
            IVZWVI.__UROV__ = WVHG_KZGS
            IVZWVI._NLWFOV = NLWFOV
            IVZWVI._VEVIB = VEVIB
            IVZWVI._OZHG_IVZW = WZGVGRNV.WZGVGRNV.MLD() - WZGVGRNV.GRNVWVOGZ(89 * VEVIB)
            RU NLWFOV RM HVOU.IVZWVI_KLLO:
                IZRHV eZOFVvIILI('iVZWVI %H RH ZOIVZWB OLZWVW, UROV: %H, KIVE UROV: %H'%(IVZWVI.NLWFOV, WVHG_KZGS, HVOU.IVZWVI_KLLO[IVZWVI.NLWFOV].__UROV__) )
            VOHV:
                HVOU.IVZWVI_KLLO[IVZWVI._NLWFOV] = IVZWVI
            HVOU.OLTTVI.RMUL('[ZGSVMZ] yllg OLZWVW IVZWVI %H, IVZWH VEVIB %W H'%(NLWFOV, VEVIB))
            HVOU.IVZWVI_ORHG.ZKKVMW(IVZWVI)

    WVU KILXVHH_QLY(HVOU, QLY):
        KZHH




    WVU IFM(HVOU):
        DSROV gIFV:
            ULI IVZWVI RM HVOU.IVZWVI_ORHG:
                RU (WZGVGRNV.WZGVGRNV.MLD()-IVZWVI._OZHG_IVZW).GLGZO_HVXLMWH() > IVZWVI._VEVIB:
                    IVZWVI.IVZW()
                    IVZWVI._OZHG_IVZW = WZGVGRNV.WZGVGRNV.MLD()
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/NLWFOVH/XIBHGZO/XIBHGZO.KB
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
# RNKLIG LH
# RNKLIG KHFGRO
# RNKLIG HFYKILXVHH
# RNKLIG WZGVGRNV
# RNKLIG HRTMZO
# UILN GRNV RNKLIG HOVVK
RNKLIG HBH
# RNKLIG LH
# RNKLIG GIZXVYZXP
# RNKLIG MVGDLIPC ZH MC
evihrlm = ''
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
# RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
# RNKLIG QHLM
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
# RNKLIG MVGRUZXVH
RNKLIG GRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
# RNKLIG KRXPOV
UILN xIBKGL.kFYORXpVB RNKLIG ihz
UILN HJOZOXSVNB RNKLIG XIVZGV_VMTRMV
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
UILN XIBHGZONLWVO RNKLIG kZHHDLIWgZYOV, yZHV

XOZHH XIBHGZO_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        KZHH


XOZHH XIBHGZO(nLWFOV):
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.GZT = CNO.ZGGIRY['GZT']
        HVOU.YILZWXZHG_IZMTV = CNO.ZGGIRY['IZMTV']
        HVOU.ILLG = ILLG.TVGILLG()
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.WZGZYZHV_FHVI = HVOU.CNO.ZGGIRY['FHVI']
        HVOU.WZGZYZHV_KZHHDW = HVOU.CNO.ZGGIRY['KZHHDW']

        HVOU.VMTRMV = XIVZGV_VMTRMV('NBHJO+KBNBHJO://%H:%H@NBHJO.YQ.FYRJFZMG:3333/QVOOBURHS?XSZIHVG=FGU1'%(HVOU.WZGZYZHV_FHVI, HVOU.WZGZYZHV_KZHHDW),
                                    KLLO_HRAV=49,
                                    NZC_LEVIUOLD=9,
                                    RHLOZGRLM_OVEVO="ivzw fmxlnnrggvw",
                                    KLLO_IVXBXOV=639)
        yZHV.NVGZWZGZ.YRMW = HVOU.VMTRMV

        # MVDPVB = ihz.TVMVIZGV(7951)
        # IVJFVHG = WLXPVI_KY7.qLYiVJFVHG()
        # IVJFVHG.XLNNZMW = 'JFVIB_KZHHDLIW&GZITVG=ZOKSZNZM'
        # KFYPVB = MVDPVB.KFYORXPVB().VCKLIGpVB('wvi')
        # IVJFVHG.QLY = KFYPVB
        # IVG = HVOU.KILXVHH_QLY(IVJFVHG)
        # WZGZ = MVDPVB.WVXIBKG(IVG.WZGZ).WVXLWV()
        # KIRMG(WZGZ)

    WVU tVGhVHHRLM(HVOU):
        wyhVHHRLM = HVHHRLMNZPVI()
        wyhVHHRLM.YRMW = HVOU.VMTRMV
        IVGFIM wyhVHHRLM()

    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW.HKORG('&')[9] == 'JFVIB_NZRMYZHV_KZHHDLIW':
            GZITVG = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            FHVIMZNV = QLY.XLNNZMW.HKORG('&')[7].HKORG('=')[8]
            KFY_PVB = ihz.RNKLIGpVB(QLY.QLY)
            HVHH = HVOU.tVGhVHHRLM()
            ILD =  HVHH.JFVIB(kZHHDLIWgZYOV).UROGVI(kZHHDLIWgZYOV.fHVI == FHVIMZNV).UROGVI(kZHHDLIWgZYOV.zKK == GZITVG).LMV()
            RU ILD RH mLMV:
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='XZMMLG ULFMW %H'%GZITVG)
                IVGFIM IVG
            HVOU.OLTTVI.RMUL('[XIBHGZO] JFVIB KZHHDLIW LU %H'%GZITVG)
            WZGZ = ILD.kZHHDW
            VMXIBKGVW = KFY_PVB.VMXIBKG(WZGZ.VMXLWV(), 'C')[9]
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw', WZGZ=VMXIBKGVW)
            HVHH.XOLHV()
            IVGFIM IVG


    WVU IFM(HVOU):
        DSROV MLG HVOU.TOLYZO_RMUL.YILZWXZHG_NHT(HVOU.YILZWXZHG_IZMTV, 'XIBHGZO&'+HVOU.GZT, HVOU.TOLYZO_RMUL.rw+'&'+HVOU.TOLYZO_RMUL.SLHG):
            GRNV.HOVVK(8)
        HVOU.OLTTVI.RMUL('[XIBHGZO] YILZWXZHG IVZWB')

        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            HVOU.TOLYZO_RMUL.XOLXP.FKWZGV()
            GRNV.HOVVK(7)
//##**---------------- ./HGZIUOVVG/NLWFOVH/XIBHGZO/XIBHGZONLWVO.KB
# XLWRMT: FGU-1
UILN HJOZOXSVNB RNKLIG yRTrMGVTVI, xLOFNM, wZGV, wZGVgRNV, uOLZG, uLIVRTMpVB, uLIVRTMpVBxLMHGIZRMG, rMWVC, rMGVTVI, mFNVIRX, hGIRMT, gZYOV, gVCG, GVCG, qhlm
UILN HJOZOXSVNB.LIN RNKLIG IVOZGRLMHSRK
UILN HJOZOXSVNB.VCG.WVXOZIZGREV RNKLIG WVXOZIZGREV_YZHV

UILN HJOZOXSVNB RNKLIG XIVZGV_VMTRMV, VEVMG
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI

yZHV = WVXOZIZGREV_YZHV()
NVGZWZGZ = yZHV.NVGZWZGZ

XOZHH kZHHDLIWgZYOV(yZHV):
    __GZYOVMZNV__ = 'kZHHDLIWgZYOV'

    rW = xLOFNM(rMGVTVI, KIRNZIB_PVB=gIFV)
    fHVI = xLOFNM(hGIRMT(69))
    kZHHDW = xLOFNM(hGIRMT(899))
    zKK = xLOFNM(hGIRMT(54))


XOZHH wZGZnZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.VMTRMV = XIVZGV_VMTRMV('NBHJO+KBNBHJO://LK:fYRJ5@nBHJO_LK@89.81.9.876:3333/QVOOBURHS?XSZIHVG=FGU1',
                                    KLLO_HRAV=49,
                                    NZC_LEVIUOLD=9,
                                    RHLOZGRLM_OVEVO="ivzw fmxlnnrggvw",
                                    KLLO_IVXBXOV=639)
        yZHV.NVGZWZGZ.YRMW = HVOU.VMTRMV

    WVU tVGhVHHRLM(HVOU):
        wyhVHHRLM = HVHHRLMNZPVI()
        wyhVHHRLM.YRMW = HVOU.VMTRMV
        IVGFIM wyhVHHRLM()

    WVU gVHG(HVOU):
        GIB:
            DRGS HVOU.VMTRMV.XLMMVXG() ZH XLM:
                IH = XLM.VCVXFGV('hvovxg 8')
            IVGFIM gIFV
        VCXVKG:
            IVGFIM uZOHV

RU __MZNV__ == "__NZRM__":
    RNKLIG HBH
    evihrlm=''
    DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
        ORMVH = U.IVZWORMVH()
        evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
    HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
    RNKLIG KBKFYHFY ZH KY
    RNKLIG KKIRMG
    NTI = wZGZnZMZTVI()
    HVHH = NTI.tVGhVHHRLM()
    NTI.gVHG()
    KIRMG('WLMV')
//##**---------------- ./HGZIUOVVG/NLWFOVH/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/NLWFOVH/EVIHRLMXLMGILO/EVIHRLMXLMGILO.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
RNKLIG GRNV
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
UILN FYRJKBZGZNLWVO.NLWVO RNKLIG hVIEVIhGZGFH, wZGZnZMZTVI
RNKLIG IZMWLN
RNKLIG HGIRMT
RNKLIG LH
UILN TRG RNKLIG tRG, iVKL
RNKLIG GZIUROV
RNKLIG HFYKILXVHH
RNKLIG HSFGRO
UILN IWGLLO.HVMWUROV RNKLIG uROVhVMWVI
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG IV
RNKLIG WZGVGRNV
RNKLIG KRXPOV
RNKLIG SVOKVI.FGRO ZH FGRO

XOZHH xLNgZHP(LYQVXG):
    WVU __RMRG__(HVOU, ORMV, WL_XLNKROV=uZOHV, OLTTVI=mLMV):
        RU WL_XLNKROV:
            HVOU.MZNV = LH.KZGS.YZHVMZNV(ORMV)
            HVOU.KZGS = ORMV
            HVOU.WVKVMWVMXB = mLMV
        VOHV:
            HVOU.FIO = ORMV.HKORG()[8]
            HVOU.SVZW = ORMV.HKORG()[9].HKORG('=')[8]
            HVOU.MZNV = ORMV.HKORG()[9].HKORG('=')[9]
        HVOU.HGZGFH = uZOHV
        HVOU.OLTTVI = OLTTVI
        HVOU.HVMG = 9
        HVOU.IVXE = uZOHV
        HVOU.XLNKROVW = 9
        HVOU.WG = mLMV
        HVOU.IVKLIGVW = uZOHV
        HVOU.IVHFOG = mLMV


    WVU XOLMV(HVOU, YZHV_KZGS):
        HVOU.YZHV_KZGS = YZHV_KZGS
        HVOU.KZGS = LH.KZGS.QLRM(YZHV_KZGS, HVOU.MZNV)
        HVOU.IVKL = iVKL.XOLMV_UILN(HVOU.FIO, HVOU.KZGS )
        HVOU.TRG = tRG(HVOU.KZGS)
        HVOU.TRG.XSVXPLFG(HVOU.SVZW)
        ULI HFYNLWFOV RM HVOU.IVKL.HFYNLWFOVH:
            HFYNLWFOV.FKWZGV(RMRG=gIFV)

    WVU DIZK(HVOU):
        HVOU.GZIUROV = HVOU.MZNV+'.GZI.YA7'
        HVOU.GZIUROV_KZGS = LH.KZGS.QLRM(HVOU.YZHV_KZGS, HVOU.GZIUROV )
        DRGS GZIUROV.LKVM( HVOU.GZIUROV_KZGS, NLWV='D:YA7', XLNKIVHHOVEVO=0) ZH ZIXSREV:
            ZIXSREV.ZWW(HVOU.KZGS, IVXFIHREV=gIFV)
        HSFGRO.INGIVV(HVOU.KZGS)

    WVU HGZNK(HVOU):
        LH.XSWRI(HVOU.KZGS)
        HFYKILXVHH.XZOO(['HS', './EVIHRLM.HS', '-A'])
        RU LH.KZGS.VCRHGH(LH.KZGS.QLRM(HVOU.KZGS, 'NLMHGVI')):
            LH.XSWRI(LH.KZGS.QLRM(HVOU.KZGS, 'NLMHGVI'))
            HFYKILXVHH.XZOO(['HS', './EVIHRLM.HS', '-A'])
            LH.XSWRI(HVOU.KZGS)
            LH.IVNLEV(LH.KZGS.QLRM(HVOU.KZGS, 'NLMHGVI',  '.TRG'))
        HSFGRO.INGIVV(LH.KZGS.QLRM(HVOU.KZGS, '.TRG'))
        LH.XSWRI(HVOU.YZHV_KZGS)

    WVU XZOO_YZHS(HVOU, ZITH):
        RU HVOU.OLTTVI:
            HVOU.OLTTVI.RMUL('%H HGZIGH GL XLNKROV'%HVOU.MZNV)
        #KIRMG(HVOU.MZNV, ' HGZIGH GL XLNKROV')
        HGZIG = WZGVGRNV.WZGVGRNV.MLD()
        GIB:
            K = HFYKILXVHH.IFM(ZITH, XSVXP=gIFV, HGWLFG=HFYKILXVHH.krkv, HGWVII=HFYKILXVHH.krkv)
            VIILI = OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', K.HGWLFG.WVXLWV('FGU1') )) + OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', K.HGWVII.WVXLWV('FGU1') ))
            DZIM = OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', K.HGWLFG.WVXLWV('FGU1') )) +  OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', K.HGWVII.WVXLWV('FGU1') ))
            VMW = WZGVGRNV.WZGVGRNV.MLD()
            VOZKHVW = VMW - HGZIG
            # KIRMG(HVOU.MZNV, ' FHVW ', VOZKHVW)
            IVGFIM [HVOU.SLHG, HVOU.MZNV, 8, K.HGWLFG, K.HGWVII, 9, VIILI, DZIM, VOZKHVW]
        VCXVKG HFYKILXVHH.xZOOVWkILXVHHvIILI ZH V:
            KIRMG('VCXVKGRLM')
            KIRMG('UZROVW ')
            KIRMG('----------- hgwlfg -----------\M')
            KIRMG(HGI(V.HGWLFG))
            KIRMG('\M----------- hgwvii -----------\M')
            KIRMG(HGI(V.HGWVII))
            RU HVOU.OLTTVI:
                HVOU.OLTTVI.RMUL('-------- hgwlfg -------\M')
                HVOU.OLTTVI.RMUL('%H'%HGI(V.HGWLFG))
                HVOU.OLTTVI.RMUL('-------- hgwvii -------\M')
                HVOU.OLTTVI.RMUL('%H'%HGI(V.HGWVII))
            VIILI = OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', K.HGWLFG.WVXLWV('FGU1') )) + OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', K.HGWVII.WVXLWV('FGU1') ))
            DZIM = OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', K.HGWLFG.WVXLWV('FGU1') )) +  OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', K.HGWVII.WVXLWV('FGU1') ))
            VMW = WZGVGRNV.WZGVGRNV.MLD()
            VOZKHVW = VMW - HGZIG
            # KIRMG(HVOU.MZNV, ' FHVW ', VOZKHVW)
            IVGFIM [HVOU.SLHG, HVOU.MZNV, -8, V.HGWLFG, V.HGWVII, 9, VIILI, DZIM, VOZKHVW]

    WVU XLNKROV(HVOU, WG):
        RU HVOU.MZNV.HGIRK() == 'VKLXS':
            LH.HBHGVN("VXSL [hgzig] > /GNK/EVIHRLM.SVZW")
            IVG = HVOU.XZOO_YZHS(['HS', '/LKG/6IW/FYRJYZHV/YRM/VKLXS.HS', WG])
            IVGFIM IVG
        VORU HVOU.MZNV.HGIRK() == 'SZOL':
            IVG = HVOU.XZOO_YZHS(['HS', '/LKG/6IW/FYRJYZHV/YRM/SZOL.HS', WG])
            IVGFIM IVG
        VORU HVOU.MZNV.HGIRK() == 'URMZORAV':
            LH.HBHGVN("VXSL [xlnkovgvw] >> /GNK/EVIHRLM.SVZW")
            IVG = HVOU.XZOO_YZHS(['HS', '/LKG/6IW/FYRJYZHV/YRM/URMZORAV.HS'])
            GIB:
                LH.HBHGVN("XK /GNK/EVIHRLM.SVZW /LKG/EVIHRLM/%H/"%HGI(WG))
            VCXVKG:
                KZHH
            IVGFIM IVG
        VOHV:
            HVOU.VCGIZXG()
            RU HVOU.MZNV.HKORG('-')[9] == 'FHRN':
                LH.XSWRI(HVOU.KZGS)
                GK = HVOU.MZNV.HKORG('-')[8]
                GK = GK.IVKOZXV('IVOVZHV', 'HGZYOV').IVKOZXV('ZOKSZNZM', 'HGZYOV')
                IVG = HVOU.XZOO_YZHS(['HS', './IVOVZHV.HS', LH.KZGS.QLRM('/LKG/EVIHRLM', WG, 'FHRN', HVOU.MZNV), GK])
                LH.HBHGVN("VXSL %H=$(TIVK trgsvzw ./.KZIZ.RMX|XFG -U 7 -W '=')  >> /GNK/EVIHRLM.SVZW"%HVOU.MZNV)
                IVGFIM IVG
            VORU HVOU.MZNV.HKORG('-')[9] == 'FGIZWV':
                LH.XSWRI(HVOU.KZGS)
                GK = HVOU.MZNV.HKORG('-')[8]
                GK = GK.IVKOZXV('IVOVZHV', 'HGZYOV')
                IVG = HVOU.XZOO_YZHS(['HS', './IVOVZHV.HS', LH.KZGS.QLRM('/LKG/EVIHRLM', WG, 'FGIZWV', HVOU.MZNV), GK])
                LH.HBHGVN("VXSL %H=$(TIVK trgsvzw ./.KZIZ.RMX|XFG -U 7 -W '=')  >> /GNK/EVIHRLM.SVZW"%HVOU.MZNV)
                IVGFIM IVG
            VOHV:
                LH.XSWRI(HVOU.KZGS)
                IVG = HVOU.XZOO_YZHS(['HS', './IVOVZHV.HS'])
                LH.HBHGVN("VXSL %H=$(TIVK trgsvzw ./.KZIZ.RMX|XFG -U 7 -W '=')  >> /GNK/EVIHRLM.SVZW"%HVOU.MZNV)
                IVGFIM IVG

    WVU VCGIZXG(HVOU):
        HVOU.GZIUROV = GZIUROV.LKVM(HVOU.KZGS+'.GZI.YA7', 'I:YA7')
        HVOU.GZIUROV.VCGIZXGZOO('/')

    WVU IFM(HVOU):
        RU HVOU.MZNV MLG RM ['VKLXS', 'SZOL', 'URMZORAV']:
            DSROV MLG HVOU.IVXE:
                GRNV.HOVVK(9.8)
            RU HVOU.OLTTVI:
                HVOU.OLTTVI.RMUL('%H IVXVREVW WVKOLB KZXPZTV'%HVOU.MZNV)
            KIRMG('IVXE %H'%HVOU.MZNV)
        GIB:
            HVOU.IVHFOG = HVOU.XLNKROV(HVOU.WG)
            HVOU.XLNKROVW = HVOU.IVHFOG[7]
            RU HVOU.OLTTVI:
                HVOU.OLTTVI.RMUL('%H XLNKROV QLY URMRHSVW'%HVOU.MZNV)
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
            RU HVOU.OLTTVI:
                HVOU.OLTTVI.VIILI('%H XLNKROV QLY VCXVKGRLM LXXIFVW DRGS VIILI %H'%(HVOU.MZNV, HGI(V)))
            HVOU.XLNKROVW = -8


XOZHH yFROWuOLD(LYQVXG):
    XOZHH yFROWuOLDoVEVO(LYQVXG):
        WVU __RMRG__(HVOU, KZGS, ORMV, WVKVMWVMXB, TOLYZO_RMUL):
            HVOU.GZHP_ORHG = []
            HVOU.QLY_ORHG = []
            HVOU.HGZGFH = 9
            HVOU.HGZIGVW = uZOHV
            HVOU.TOLYZO_RMUL = TOLYZO_RMUL
            HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
            HVOU.WVKVMWVMXB = WVKVMWVMXB
            QLY_ORHG = ORMV.HGIRK().HGIRK('\M').HKORG(',')
            WG = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W')
            HFYKILXVHH.XZOO(['XSNLW', '-i', '299',  KZGS])
            ULI QLY RM QLY_ORHG:
                MVD_GZHP = xLNgZHP(LH.KZGS.QLRM(KZGS, QLY.HGIRK()), WL_XLNKROV=gIFV, OLTTVI=HVOU.OLTTVI)
                MVD_GZHP.WVKVMWVMXB = HVOU.WVKVMWVMXB
                MVD_GZHP.WG = WG
                MVD_GZHP.SLHG = HVOU.TOLYZO_RMUL.SLHG
                # KIRMG(MVD_GZHP.MZNV, ' WVKVMWVH LM ', HVOU.WVKVMWVMXB)
                HVOU.GZHP_ORHG.ZKKVMW(MVD_GZHP)
                HVOU.QLY_ORHG.ZKKVMW(qLY(MVD_GZHP))
                # KIRMG('IVG:', IVG)
                # RU IVG == -8:
                    # HBH.VCRG(-8)

        WVU XSVXP(HVOU):
            RU HVOU.HGZGFH == 8:
                IVGFIM HVOU.HGZGFH
            URMRHSVW = 9
            RU (HVOU.WVKVMWVMXB RH mLMV LI (HVOU.WVKVMWVMXB RH MLG mLMV ZMW HVOU.WVKVMWVMXB.HGZGFH == 8)) ZMW MLG HVOU.HGZIGVW:
                ULI QLY RM HVOU.QLY_ORHG:
                    QLY.HGZIG()
                HVOU.HGZIGVW = gIFV
            ULI QLY RM HVOU.GZHP_ORHG:
                RU QLY.XLNKROVW == -8:
                    HVOU.HGZGFH = -8
                    HVOU.OLTTVI.VIILI('%H XLNKROZGRLM UZROVW:'%QLY.MZNV)
                    RU QLY.IVHFOG ZMW OVM(QLY.IVHFOG) > 6:
                        HVOU.OLTTVI.VIILI('HGWLFG: %H\MHGWVII:%H\M'%(QLY.IVHFOG[6], QLY.IVHFOG[5]))
                    IVGFIM -8
                URMRHSVW += QLY.XLNKROVW
            RU URMRHSVW == OVM(HVOU.GZHP_ORHG):
                HVOU.HGZGFH = 8
                HVOU.OLTTVI.RMUL('[%H] OVEVO XLNKROZGRLM URMRHSVW'%HVOU.GZHP_ORHG[9].MZNV)
            VOHV:
                HVOU.HGZGFH = 9
            IVGFIM HVOU.HGZGFH

    WVU __RMRG__(HVOU, UROVORHG, DLIP_WRI, IVWHSRUG, XLNNZMWVI, TOLYZO_RMUL ):
        HVOU.OVEVO_ORHG = []
        HVOU.IVWHSRUG = IVWHSRUG
        HVOU.XLNNZMWVI = XLNNZMWVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.DLIP_WRI = DLIP_WRI
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        ULI ORMV RM UROVORHG:
            RU ORMV == '' LI ORMV == '\M':
                XLMGRMFV
            RU OVM(HVOU.OVEVO_ORHG) > 9:
                OVEVO = yFROWuOLD.yFROWuOLDoVEVO(DLIP_WRI, ORMV, HVOU.OVEVO_ORHG[-8], HVOU.TOLYZO_RMUL)
            VOHV:
                OVEVO = yFROWuOLD.yFROWuOLDoVEVO(DLIP_WRI, ORMV, mLMV, HVOU.TOLYZO_RMUL)
            # KIRMG('OVEVO %H WVKVMWVH LM '%(OVEVO.GZHP_ORHG[9].MZNV), OVEVO.WVKVMWVMXB)
            HVOU.OVEVO_ORHG.ZKKVMW(OVEVO)
        HVOU.GZHP_NZK = {}
        ULI OVEVO RM HVOU.OVEVO_ORHG:
            ULI GZHP RM OVEVO.GZHP_ORHG:
                HVOU.GZHP_NZK[GZHP.MZNV] = GZHP

    WVU XSVXP(HVOU):
        URMRHSVW = 9
        HGZIG = WZGVGRNV.WZGVGRNV.MLD()
        ULI OVEVO RM HVOU.OVEVO_ORHG:
            HGZGFH = OVEVO.XSVXP()
            RU HGZGFH == -8:
                NHT = HVOU.IVWHSRUG.MVD_NHT()
                NHT.WHG = HVOU.XLNNZMWVI
                NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO_ZXXLNKORHSVW_VIILI'
                NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
                # HSFGRO.INGIVV(HVOU.DLIP_WRI)
                HVOU.OLTTVI.RMUL('YFROW UOLD RMGVIIFKGVW')
                HVOU.XOVZI()
                IVGFIM -8
            URMRHSVW += HGZGFH
        ULI P RM HVOU.GZHP_NZK:
            GZHP = HVOU.GZHP_NZK[P]
            RU GZHP.XLNKROVW != 9 ZMW MLG GZHP.IVKLIGVW:
                # IVKLIG XLNKROZGRLM HGZGFH
                NHT = HVOU.IVWHSRUG.MVD_NHT()
                NHT.WHG = HVOU.XLNNZMWVI
                RU GZHP.XLNKROVW == 8:
                    NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO_URMRHSVW'
                VOHV:
                    NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO_VIILI'
                NHT.WZGZ = KRXPOV.WFNKH(GZHP.IVHFOG)
                NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
                GZHP.IVKLIGVW = gIFV
        RU URMRHSVW == OVM(HVOU.OVEVO_ORHG):
            NHT = HVOU.IVWHSRUG.MVD_NHT()
            NHT.WHG = HVOU.XLNNZMWVI
            NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO_ZXXLNKORHSVW'
            NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
            IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
            HVOU.XOVZI()
            HVOU.OLTTVI.RMUL('YFROW UOLD URMRHSVW')
            IVGFIM 8

    WVU XOVZI(HVOU):
        GIB:
            HVOU.OLTTVI.RMUL('XOVZI DLIPRMT WRIVXGLIB %H'%HVOU.DLIP_WRI)
            HSFGRO.INGIVV(HVOU.DLIP_WRI)
        VCXVKG vCXVKGRLM ZH V:
            KZHH

XOZHH fKWZGVgZHP(LYQVXG):
    XOZHH xOLMVdLIPVI(LYQVXG):
        WVU __RMRG__(HVOU, YZHV_KZGS, GZHP_ORHG, OLTTVI):
            HVOU.GZHP_ORHG = GZHP_ORHG
            HVOU.YZHV_KZGS = YZHV_KZGS
            HVOU.OLTTVI = OLTTVI

        WVU IFM(HVOU):
            ULI MVD_GZHP RM HVOU.GZHP_ORHG:
                MVD_GZHP.XOLMV(HVOU.YZHV_KZGS)
                MVD_GZHP.HGZNK()
                MVD_GZHP.DIZK()
                MVD_GZHP.HGZGFH = gIFV
            HFYKILXVHH.XZOO(['XSNLW', '-i', '299', HVOU.YZHV_KZGS])

    XOZHH hVMWVIdLIPVI(LYQVXG):
        WVU __RMRG__(HVOU, IVWHSRUG, GZITVG, GZHP_ORHG, OLTTVI):
            HVOU.GZHP_ORHG = GZHP_ORHG
            HVOU.IVWHSRUG= IVWHSRUG
            HVOU.GZITVG = GZITVG
            HVOU.URMRHSVW_GZHP_NZK = {}
            HVOU.OLTTVI = OLTTVI
            HVOU.HGZGFH = gIFV

        WVU IVKLIG(HVOU, GZHP, NZC_GRNVH=39):
            NHT = HVOU.IVWHSRUG.MVD_NHT()
            NHT.WHG = HVOU.GZITVG
            NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO_HVMG'
            NHT.WZGZ = GZHP.MZNV.VMXLWV()
            NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
            IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
            GIB_GRNVH = 9
            DSROV MLG IVKOB.HGZGFH:
                GRNV.HOVVK(8)
                HVOU.OLTTVI.VIILI(IVKOB.NVHHZTV)
                IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
                GIB_GRNVH += 8
                RU GIB_GRNVH > NZC_GRNVH:
                    IVGFIM uZOHV
            RU IVKOB.HGZGFH:
                IVGFIM gIFV
            VOHV:
                IVGFIM uZOHV
            # KIRMG(NHT.WHG, GZHP.MZNV, IVKOB)

        WVU IFM(HVOU):
            HVOU.OLTTVI.RMUL('HVMWVI HGZIGH GL DLIP ULI %H' % HVOU.GZITVG)
            HVMW_XLFMG = 9
            DSROV gIFV:
                ULI GZHP RM HVOU.GZHP_ORHG:
                    RU GZHP.HGZGFH == gIFV ZMW GZHP.MZNV MLG RM HVOU.URMRHSVW_GZHP_NZK:
                        HVOU.OLTTVI.RMUL('[fe] HVMWRMT %H GL %H' % (GZHP.MZNV, HVOU.GZITVG))
                        # 899P VZXS GRNV
                        HVMWVI = uROVhVMWVI(HVOU.IVWHSRUG, HVOU.GZITVG, GZHP.GZIUROV_KZGS, GZHP.GZIUROV_KZGS, HVOU.OLTTVI, 8975*8975, 49 )
                        RU MLG HVMWVI.HVMW(5):
                            HVOU.HGZGFH = uZOHV
                            IVGFIM
                        GZHP.HVMG += 8
                        HVMW_XLFMG += 8
                        RU MLG HVOU.IVKLIG(GZHP):
                            HVOU.HGZGFH = uZOHV
                            IVGFIM
                        HVOU.URMRHSVW_GZHP_NZK[GZHP.MZNV] = 8
                RU HVMW_XLFMG == OVM(HVOU.GZHP_ORHG):
                    YIVZP
                GRNV.HOVVK(9.8)

    WVU __RMRG__(HVOU, FKWZGV_UROV, KILTIZN, TRGSVZW, IVWHSRUG, GZITVG, OLTTVI):
        HVOU.GZHP_ORHG = []
        HVOU.KILTIZN_ORHG = []
        HVOU.KILTIZN_SVZW_ORHG = []
        HVOU.FKWZGV_UROV = FKWZGV_UROV
        HVOU.IVWHSRUG = IVWHSRUG
        HVOU.OLTTVI = OLTTVI
        HVOU.GZITVG_ORHG = [R.HGIRK() ULI R RM GZITVG.HKORG(',')]
        HVOU.IVHFOG_ORHG = {}
        HVOU.KILTIZN = KILTIZN.HGIRK()
        HVOU.TRGSVZW = TRGSVZW.HGIRK()
        ULI GT RM HVOU.GZITVG_ORHG:
            HVOU.IVHFOG_ORHG[GT] = 9
        HVOU.IW = ''.QLRM(IZMWLN.XSLRXV(HGIRMT.ZHXRR_FKKVIXZHV+HGIRMT.WRTRGH)  ULI _ RM IZMTV(4) )
        HVOU.YZHV_KZGS = LH.KZGS.QLRM('/GNK', 'FKWZGV_'+HVOU.IW)
        HVOU.HVMWVI_DLIPVI_ORHG = []
        HVOU.HVMWVI_QLY_ORHG = []
        HVOU.HGZGFH = uZOHV
        HVOU.KILTIZN_UZXGLIB = {}

    WVU KZIHV_KILTIZN_UILN_UROV(HVOU):
        UZXGLIB_UROV = LH.KZGS.QLRM('/RMX', 'KILTIZN_UZXGLIB.RMX')
        RU MLG LH.KZGS.VCRHGH(UZXGLIB_UROV):
            IVGFIM -8
        DRGS LKVM(UZXGLIB_UROV) ZH U:
            ULI ORMV RM U:
                HVOU.KILTIZN_UZXGLIB[ORMV.HKORG()[9].HGIRK()] = ORMV.HKORG()[8].HGIRK()
        RU HVOU.KILTIZN MLG RM HVOU.KILTIZN_UZXGLIB:
            IVGFIM -7
        ZWWI = HVOU.KILTIZN_UZXGLIB[HVOU.KILTIZN]
        MVD_GZHP = xLNgZHP('%H=%H %H'%(HVOU.KILTIZN, HVOU.TRGSVZW, ZWWI ))
        HVOU.OLTTVI.RMUL('KZIHV KILTIZN ZH %H=%H %H'%(HVOU.KILTIZN, HVOU.TRGSVZW, ZWWI ))
        HVOU.GZHP_ORHG.ZKKVMW(MVD_GZHP)
        HVOU.KILTIZN_ORHG.ZKKVMW(MVD_GZHP.MZNV)
        HVOU.KILTIZN_SVZW_ORHG.ZKKVMW((MVD_GZHP.MZNV, MVD_GZHP.SVZW))
        IVGFIM 9


    WVU KZIHV_UROV(HVOU):
        RU MLG LH.KZGS.VCRHGH(HVOU.FKWZGV_UROV):
            IVGFIM -8
        RU 'xlnkovgv' MLG RM LKVM(HVOU.FKWZGV_UROV).IVZW():
            IVGFIM -7
        DRGS LKVM(HVOU.FKWZGV_UROV) ZH U:
            ULI ORMV RM U:
                RU ORMV.HGIRK()[9] == '[':
                    XLMGRMFV
                MVD_GZHP = xLNgZHP(ORMV)
                HVOU.GZHP_ORHG.ZKKVMW(MVD_GZHP)
                HVOU.KILTIZN_ORHG.ZKKVMW(MVD_GZHP.MZNV)
                HVOU.KILTIZN_SVZW_ORHG.ZKKVMW((MVD_GZHP.MZNV, MVD_GZHP.SVZW))
        IVGFIM 9

    WVU IFM(HVOU):
        HVOU.DLIP()

    WVU XOVZI(HVOU):
        GIB:
            HSFGRO.INGIVV(HVOU.YZHV_KZGS)
        VCXVKG vCXVKGRLM ZH V:
            KZHH

    WVU DLIP(HVOU):
        RU LH.KZGS.VCRHGH(HVOU.YZHV_KZGS):
            HBH.VCRG(-8)
        LH.NZPVWRIH(HVOU.YZHV_KZGS)
        LH.XSWRI(HVOU.YZHV_KZGS)
        ULI GZITVG RM HVOU.GZITVG_ORHG:
            HVMWVI_DLIPVI = fKWZGVgZHP.hVMWVIdLIPVI(HVOU.IVWHSRUG, GZITVG, HVOU.GZHP_ORHG, HVOU.OLTTVI)
            HVOU.HVMWVI_DLIPVI_ORHG.ZKKVMW(HVMWVI_DLIPVI)
            # KIRMG(HVOU.HVMWVI_DLIPVI)
        XOLMV_DLIPVI = fKWZGVgZHP.xOLMVdLIPVI(HVOU.YZHV_KZGS, HVOU.GZHP_ORHG, HVOU.OLTTVI)
        XOLMV_QLY = qLY(XOLMV_DLIPVI)
        XOLMV_QLY.HGZIG()
        HVOU.OLTTVI.RMUL('HGZIG HVMWRMT QLY')
        KIRMG(HVOU.HVMWVI_DLIPVI_ORHG)
        ULI HVMWVI_DLIPVI RM HVOU.HVMWVI_DLIPVI_ORHG:
            HVMWVI_QLY = qLY(HVMWVI_DLIPVI)
            HVMWVI_QLY.HGZIG()
            HVOU.HVMWVI_QLY_ORHG.ZKKVMW(HVMWVI_QLY)
        XOLMV_QLY.QLRM()
        HVOU.OLTTVI.RMUL('XOLMV QLY URMRHSVW')
        ULI HVMWVI_QLY RM HVOU.HVMWVI_QLY_ORHG:
            HVMWVI_QLY.QLRM()
        HSFGRO.INGIVV(HVOU.YZHV_KZGS)
        HVOU.HGZGFH = gIFV
        # ULI HVMWVI_DLIPVI RM HVOU.HVMWVI_DLIPVI_ORHG:
            # RU MLG HVMWVI_DLIPVI.HGZGFH:
                # HVOU.HGZGFH = uZOHV
        HVOU.OLTTVI.RMUL('XOLMV ZMW HVMWRMT URMRHSVW')


XOZHH EVIHRLMXLMGILO(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''
    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.WZGZ_NZMZTVI = wZGZnZMZTVI()
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.IVKLIG_GRNVH = 9
        HVOU.YFROW_UOLD = mLMV
        HVOU.IVNLGV_QLY = {}
        HVOU.FKWZGV_GZHP = mLMV
        HVOU.LM_GRNV_QLYH = {}
        RU MLWV RH MLG mLMV:
            RU 'LM_GRNV' RM MLWV.ZGGIRY:
                QLY_HGIH = MLWV.ZGGIRY['LM_GRNV'].HKORG('$')
                ULI QLY_HGI RM QLY_HGIH:
                    QLY_ORHG = QLY_HGI.HGIRK().HKORG('|')
                    GRNV = FGRO.KZIHV_GRNV(QLY_ORHG[9].HGIRK())
                    WVHG = QLY_ORHG[7].HKORG('=')[8].HGIRK()
                    HVOU.LM_GRNV_QLYH[GRNV] = [WZGVGRNV.GRNVWVOGZ(WZBH=RMG(QLY_ORHG[8].HKORG('=')[8].HGIRK())), WVHG]


    # GSV IVZO FKWZGV UFMXGRLM LM GSV HVIEVI HRWV
    WVU FKWZGV_HVIEVI(HVOU, EVIHRLM, WVHG):
        RU HVOU.FKWZGV_GZHP RH MLG mLMV:
            RU HVOU.FKWZGV_GZHP.HGZGFH:
                HVOU.FKWZGV_GZHP = mLMV
        RU HVOU.FKWZGV_GZHP RH MLG mLMV:
            IVGFIM 'zmlgsvi fkwzgv rmhgzmxv rh ifmmrmt'
        FKWZGV_GZHP = HVOU.FKWZGV(EVIHRLM, WVHG)
        RU FKWZGV_GZHP RH mLMV:
            IVGFIM 'viili: IVWHSRUG MLG IVZWB'
        RU FKWZGV_GZHP.KZIHV_UROV() == -8:
            IVGFIM 'viili: XZMMLG KZIHV %H'%EVIHRLM
        VORU FKWZGV_GZHP.KZIHV_UROV() == -7:
            IVGFIM 'viili: %H RH MLG XLNKOVGV'%EVIHRLM
        RU FKWZGV_GZHP RH mLMV:
            IVGFIM 'viili'

        IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
        RLORHG = []
        YFROW_UOLD_ORHG = []
        # YFROW YFROW WVKVWVMXB GIVV
        DRGS LKVM('/RMX/YFROWUOLD.UOLD') ZH U:
            ULI ORMV RM U:
                RLORHG.ZKKVMW(ORMV)
                YFROW_UOLD_ORHG += [ R.HGIRK('\M').HGIRK() ULI R RM ORMV.HKORG(',') RU R.HGIRK('\M').HGIRK() MLG RM ['SZOL','URMZORAV','VKLXS'] ]
        VIILI_ORHG = []
        ULI VOV RM YFROW_UOLD_ORHG:
            RU VOV MLG RM FKWZGV_GZHP.KILTIZN_ORHG:
                VIILI_ORHG.ZKKVMW(VOV)
        RU OVM(VIILI_ORHG) > 9:
            IVGFIM 'yfrowuold rmxlmhrhgvmg: %H ZIV MLG HKVXRURVW'%','.QLRM(VIILI_ORHG)
        RLORHG.ZKKVMW(FKWZGV_GZHP.YZHV_KZGS)
        IW = ''.QLRM(IZMWLN.XSLRXV(HGIRMT.ZHXRR_FKKVIXZHV+HGIRMT.WRTRGH)  ULI _ RM IZMTV(4) )
        HVOU.OLT_KZGS = LH.KZGS.QLRM('/FYRJ/OLT/FKWZGV/', 'FKWZGV_'+WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W_%s%n%h')+'_'+IW)
        RU MLG LH.KZGS.VCRHGH(HVOU.OLT_KZGS):
            LH.HBHGVN('NPWRI -K %H'%HVOU.OLT_KZGS)

        # KIVGGB NFXS VEVIBGSRMT RH IVZWB, XZOO VZXS QLY GL HGZIG
        #HVOU.HVHHRLM = HVOU.WZGZ_NZMZTVI.tVGhVHHRLM()
        ULI WHG RM FKWZGV_GZHP.WVHG.HKORG(','):
            NHT = IVWHSRUG.MVD_NHT()
            NHT.WHG = WHG
            NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO_HGZIG'
            NHT.WZGZ = KRXPOV.WFNKH(RLORHG)
            NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
            HVOU.IVNLGV_QLY[NHT.WHG] = {}
            HVOU.IVNLGV_QLY[NHT.WHG]['HGZGFH'] = 9
            LH.HBHGVN('NPWRI -K %H'%(LH.KZGS.QLRM(HVOU.OLT_KZGS, WHG)))
            IVKOB = IVWHSRUG.HVMW(NHT)
            HVOU.OLTTVI.RMUL(IVKOB.NVHHZTV)
            RU IVKOB.HGZGFH != gIFV:
                HVOU.IVNLGV_QLY[WHG]['HGZGFH'] = -8
                HVOU.FKWZGV_DLIPUOLD(WHG, 'FKWZGV-VIILI')
            #HVOU.IVXLIW = HVOU.HVHHRLM.JFVIB(hVIEVIhGZGFH).UROGVI(hVIEVIhGZGFH.mZNV == WHG).URIHG()
            #RU HVOU.IVXLIW RH MLG mLMV:
            #    HVOU.IVXLIW.hGZGFH = 'FKWZGRMT'
            #    HVOU.HVHHRLM.NVITV(HVOU.IVXLIW)
        HVOU.FKWZGV_GZHP = FKWZGV_GZHP
        RU HVOU.FKWZGV_GZHP RH mLMV:
            IVGFIM 'ivwhsrug mlg ivzwb'
        HVOU.XSVXP_DLIPUOLD_HGZGFH()
        RU HVOU.FKWZGV_GZHP RH mLMV:
            IVGFIM 'fmzyov gl xlmmvxg gl %H'%WHG
        # LKVM Z MVD GSIVZW GL HGZIG FKWZGV_GZHP DLIP
        qLY(HVOU.FKWZGV_GZHP).HGZIG()
        #HVOU.HVHHRLM.XLNNRG()
        #HVOU.HVHHRLM.XOLHV()
        IVGFIM 'lp'

    # GSV IVZO FKWZGV UFMXGRLM LM GSV HVIEVI HRWV
    WVU FKWZGV_HVIEVI_KILTIZN(HVOU, KILTIZN, TRGSVZW, WVHG):
        RU HVOU.FKWZGV_GZHP RH MLG mLMV:
            RU HVOU.FKWZGV_GZHP.HGZGFH:
                HVOU.FKWZGV_GZHP = mLMV
        RU HVOU.FKWZGV_GZHP RH MLG mLMV:
            IVGFIM 'zmlgsvi fkwzgv rmhgzmxv rh ifmmrmt'
        FKWZGV_GZHP = HVOU.FKWZGV_KILTIZN(KILTIZN,TRGSVZW, WVHG)
        RU FKWZGV_GZHP RH mLMV:
            IVGFIM 'viili: IVWHSRUG MLG IVZWB'
        RU FKWZGV_GZHP.KZIHV_KILTIZN_UILN_UROV() == -8:
            IVGFIM 'viili: XZMMLG KZIHV %H'%KILTIZN
        VORU FKWZGV_GZHP.KZIHV_KILTIZN_UILN_UROV() == -7:
            IVGFIM 'viili: %H RH MLG XLNKOVGV'%KILTIZN
        RU FKWZGV_GZHP RH mLMV:
            IVGFIM 'viili'

        IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
        RLORHG = []
        RLORHG.ZKKVMW(KILTIZN.HGIRK())
        YFROW_UOLD_ORHG = [KILTIZN.HGIRK()]
        RLORHG.ZKKVMW(FKWZGV_GZHP.YZHV_KZGS)
        IW = ''.QLRM(IZMWLN.XSLRXV(HGIRMT.ZHXRR_FKKVIXZHV+HGIRMT.WRTRGH)  ULI _ RM IZMTV(4) )
        HVOU.OLT_KZGS = LH.KZGS.QLRM('/FYRJ/OLT/FKWZGV/', 'FKWZGV_'+WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W_%s%n%h')+'_'+IW)
        RU MLG LH.KZGS.VCRHGH(HVOU.OLT_KZGS):
            LH.HBHGVN('NPWRI -K %H'%HVOU.OLT_KZGS)

        # KIVGGB NFXS VEVIBGSRMT RH IVZWB, XZOO VZXS QLY GL HGZIG
        #HVOU.HVHHRLM = HVOU.WZGZ_NZMZTVI.tVGhVHHRLM()
        ULI WHG RM FKWZGV_GZHP.WVHG.HKORG(','):
            NHT = IVWHSRUG.MVD_NHT()
            NHT.WHG = WHG
            NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO_HGZIG'
            NHT.WZGZ = KRXPOV.WFNKH(RLORHG)
            NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
            HVOU.IVNLGV_QLY[NHT.WHG] = {}
            HVOU.IVNLGV_QLY[NHT.WHG]['HGZGFH'] = 9
            LH.HBHGVN('NPWRI -K %H'%(LH.KZGS.QLRM(HVOU.OLT_KZGS, WHG)))
            IVKOB = IVWHSRUG.HVMW(NHT)
            HVOU.OLTTVI.RMUL(IVKOB.NVHHZTV)
            RU IVKOB.HGZGFH != gIFV:
                HVOU.IVNLGV_QLY[WHG]['HGZGFH'] = -8
                HVOU.FKWZGV_DLIPUOLD(WHG, 'FKWZGV-VIILI')
            # HVOU.IVXLIW = HVOU.HVHHRLM.JFVIB(hVIEVIhGZGFH).UROGVI(hVIEVIhGZGFH.mZNV == WHG).URIHG()
            # RU HVOU.IVXLIW RH MLG mLMV:
                # HVOU.IVXLIW.hGZGFH = 'FKWZGRMT'
                # HVOU.HVHHRLM.NVITV(HVOU.IVXLIW)
        HVOU.FKWZGV_GZHP = FKWZGV_GZHP
        RU HVOU.FKWZGV_GZHP RH mLMV:
            IVGFIM 'ivwhsrug mlg ivzwb'
        HVOU.XSVXP_DLIPUOLD_HGZGFH()
        RU HVOU.FKWZGV_GZHP RH mLMV:
            IVGFIM 'fmzyov gl xlmmvxg gl %H'%WHG
        # LKVM Z MVD GSIVZW GL HGZIG FKWZGV_GZHP DLIP
        qLY(HVOU.FKWZGV_GZHP).HGZIG()
        # HVOU.HVHHRLM.XLNNRG()
        # HVOU.HVHHRLM.XOLHV()
        IVGFIM 'lp'


    WVU GZPV_XLNNZMW(HVOU, XNW, ZITFNVMGH):
        RU XNW == 'FKWZGVEVIHRLM-ZOO':
            EVIHRLM = ZITFNVMGH['WZGV']
            WVHG = ZITFNVMGH['WVHG']
            IVGFIM HVOU.FKWZGV_HVIEVI(EVIHRLM, WVHG)
            # KIRMG(ZITFNVMGH['ZITFNVMGH'].HKORG('|'))
        VORU XNW == 'FKWZGVEVIHRLM':
            KILTIZN = ZITFNVMGH['KILTIZN']
            TRGSVZW = ZITFNVMGH['TRGSVZW']
            WVHG = ZITFNVMGH['WVHG']
            IVGFIM HVOU.FKWZGV_HVIEVI_KILTIZN(KILTIZN, TRGSVZW, WVHG)
            # KIRMG(ZITFNVMGH['ZITFNVMGH'].HKORG('|'))
        VOHV:
            IVGFIM 'FMPMLDM XLNNZMW %H'%XNW

    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW == 'FKWZGVEVIHRLM-ZOO':
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_HVMG':
            RU HVOU.YFROW_UOLD RH mLMV:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='viili, ML YFROWUOLD')
            HVOU.OLTTVI.RMUL('IVXEVW FKWZGV XLNKLMVMG %H', QLY.QLY.WVXLWV('FGU1'))
            HVOU.YFROW_UOLD.GZHP_NZK[QLY.QLY.WVXLWV('FGU1')].IVXE = gIFV
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_URMRHSVW' LI  QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_VIILI':
            IVKLIG = KRXPOV.OLZWH(QLY.QLY)
            HVOU.IVNLGV_QLY[IVKLIG[9]][IVKLIG[8]] = IVKLIG[7:]
            HVOU.OLTTVI.RMUL('%H->%H FKWZGVW, HGZGFH:%H'%(IVKLIG[9], IVKLIG[8], HGI(IVKLIG[7])))
            # DIRGV IVKLIG
            RU QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_VIILI':
                HVOU.OLTTVI.RMUL('%H->%H VIILI, HGZGFH:%H'%(IVKLIG[9], IVKLIG[8], HGI(IVKLIG[7])))
            OLT_KZGS = LH.KZGS.QLRM(HVOU.OLT_KZGS, IVKLIG[9], IVKLIG[8])
            DRGS LKVM(OLT_KZGS, 'D', VMXLWRMT='FGU1') ZH U:
                U.DIRGV('hgwlfg:\M-------------\M')
                U.DIRGV(IVKLIG[6].WVXLWV('FGU1'))
                U.DIRGV('\M------------\M')
                U.DIRGV('hgwvii:\M-------------\M')
                U.DIRGV(IVKLIG[5].WVXLWV('FGU1'))
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_ZXXLNKORHSVW' LI QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_ZXXLNKORHSVW_VIILI':
            IVKLIG_HGZGFH = 'MLINZO'
            RU QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_ZXXLNKORHSVW_VIILI':
                HVOU.OLTTVI.RMUL('%H FKWZGV NRHHRLM URMRHSVW DRGS VIILI'%QLY.RWVMGRGB)
                HVOU.IVNLGV_QLY[QLY.RWVMGRGB]['HGZGFH'] = -8
                IVKLIG_HGZGFH = 'FKWZGV-VIILI'
            VOHV:
                HVOU.OLTTVI.RMUL('%H FKWZGV NRHHRLM URMRHSVW HFXXVHHUFOOB'%QLY.RWVMGRGB)
                HVOU.IVNLGV_QLY[QLY.RWVMGRGB]['HGZGFH'] = 8
            HVOU.OLTTVI.RMUL('FKWZGV QLY ZXXLNKORHSVW')
            HVOU.FKWZGV_DLIPUOLD(QLY.RWVMGRGB, IVKLIG_HGZGFH)
            HVOU.XSVXP_DLIPUOLD_HGZGFH()
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_EVIHRLMXLMGILO_HGZIG':
            RU HVOU.YFROW_UOLD RH MLG mLMV:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='zmlgsvi fkwzgv rh dliprmt, zylig')
            HVOU.OLTTVI.RMUL('FKWZGV QLY HGZIGVW')
            RLORHG = KRXPOV.OLZWH(QLY.QLY)
            YZHV_KZGS = RLORHG[-8]
            HVOU.YFROW_UOLD = yFROWuOLD(RLORHG[:-8], YZHV_KZGS, HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG, QLY.RWVMGRGB, HVOU.TOLYZO_RMUL)
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')

    WVU FKWZGV_DLIPUOLD(HVOU, RWVMGRGB, HGZGFH):
        #GIB:
            #HVOU.HVHHRLM = HVOU.WZGZ_NZMZTVI.tVGhVHHRLM()
            #HVOU.IVXLIW = HVOU.HVHHRLM.JFVIB(hVIEVIhGZGFH).UROGVI(hVIEVIhGZGFH.mZNV == RWVMGRGB).URIHG()
            #RU HVOU.IVXLIW RH MLG mLMV:
            #    HVOU.IVXLIW.HGZGFH = HGZGFH
            #    HVOU.HVHHRLM.NVITV(HVOU.IVXLIW)
            #HVOU.HVHHRLM.XLNNRG()
            #HVOU.HVHHRLM.XOLHV()
        #VCXVKG vCXVKGRLM ZH V:
            #HVOU.HVHHRLM.XOLHV()

        # GIB GL DIRGV IVKLIG UROVH
        DRGS LKVM(LH.KZGS.QLRM(HVOU.OLT_KZGS, RWVMGRGB, 'FKWZGV.IVKLIG'), 'D') ZH U:
            RU HVOU.IVNLGV_QLY[RWVMGRGB]['HGZGFH'] == -8:
                U.DIRGV('uzrovw\M')
            VOHV:
                U.DIRGV('hfxxvhh\M')
            ULI P, RGVN RM HVOU.IVNLGV_QLY[RWVMGRGB].RGVNH():
                RU P == 'HGZGFH':
                    XLMGRMFV
                U.DIRGV("%79H IVG:%H  DZIMRMT:%5H  VIILI:%5H  FHVW:%H\M"%(P, HGI(RGVN[9]), HGI(RGVN[5]), HGI(RGVN[4]), RGVN[3]))


    WVU XSVXP_DLIPUOLD_HGZGFH(HVOU):
        # XSVXP RU ZOO ZIV FKWZGVW:
        HGZGFH = gIFV
        ULI P RM HVOU.IVNLGV_QLY:
            HGZGFH = HGZGFH ZMW (HVOU.IVNLGV_QLY[P]['HGZGFH'] != 9)
        RU HGZGFH:
            HVOU.OLTTVI.RMUL('ZOO FKWZGV QLYH ZXXLNKORHSVW')
            HVOU.YFROW_UOLD = mLMV
            HVOU.FKWZGV_GZHP = mLMV
            HVOU.IVNLGV_QLY.XOVZI()

    WVU IFM(HVOU):
        '''NLWFOV DLIP UFMXGRLM'''
        HVOU.OZHG_GRNV = WZGVGRNV.WZGVGRNV.MLD().GRNV()
        DSROV gIFV:
            # XOVZI QLYH
            DSROV HVOU.YFROW_UOLD RH MLG mLMV:
                HGZGFH = HVOU.YFROW_UOLD.XSVXP()
                RU HGZGFH == 8 LI HGZGFH == -8:
                    HVOU.YFROW_UOLD = mLMV
            HVOU.MLD_GRNV = WZGVGRNV.WZGVGRNV.MLD().GRNV()
            # LM GRNV FKWZGV QLYH
            ULI LM_GRNV, QLY RM HVOU.LM_GRNV_QLYH.RGVNH():
                RU HVOU.OZHG_GRNV <= LM_GRNV ZMW HVOU.MLD_GRNV > LM_GRNV:
                    WZGV = (WZGVGRNV.WZGVGRNV.MLD() + QLY[9] ).HGIUGRNV('%b%N%W')
                    HVOU.OLTTVI.RMUL('FKWZGV GRNV ZIIREVH, DROO FKWZGV HBHGVN')
                    IVG = HVOU.FKWZGV_HVIEVI(WZGV, QLY[8])
                    HVOU.OLTTVI.RMUL('FKWZGV HVIEVI IVGFIMH %H'%IVG)
            GRNV.HOVVK(8)
            HVOU.OZHG_GRNV = HVOU.MLD_GRNV

    WVU FKWZGV_KILTIZN(HVOU, KILTIZN,TRGSVZW, WVHG):
        IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
        RU HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG RH MLG mLMV:
            FKWZGV_GZHP = fKWZGVgZHP('',KILTIZN, TRGSVZW, IVWHSRUG, WVHG, HVOU.OLTTVI )
            FKWZGV_GZHP.WVHG = WVHG
            IVGFIM FKWZGV_GZHP
        VOHV:
            IVGFIM mLMV


    WVU FKWZGV(HVOU, EVIHRLM, WVHG):
        IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
        RU HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG RH MLG mLMV:
            FKWZGV_GZHP = fKWZGVgZHP(LH.KZGS.QLRM('/LKG/EVIHRLM/', EVIHRLM, 'EVIHRLM.SVZW'),'', '', IVWHSRUG, WVHG, HVOU.OLTTVI )
            FKWZGV_GZHP.WVHG = WVHG
            IVGFIM FKWZGV_GZHP
        VOHV:
            IVGFIM mLMV
        # NHT = IVWHSRUG.MVD_NHT()
        # NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
        # NHT.WHG = HVOU.TOLYZO_RMUL.IVKLIG_GZITVG
        # NHT.XLNNZMW = 'IVKLIG_EVIHRLMXLMGILO'
        # NHT.WZGZ = HVOU.XFIIVMG_XKF.VMXLWV()
        # NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        # GIB:
            # IVKOB = IVWHSRUG.HVMW(NHT)
            # RU IVKOB.NVHHZTV == 'tllw':
                # HVOU.IVKLIG_GRNVH += 8
        # VCXVKG:
            # KZHH


    RU __MZNV__ == '__NZRM__':
        IW = ''.QLRM(IZMWLN.XSLRXV(HGIRMT.ZHXRR_FKKVIXZHV+HGIRMT.WRTRGH)  ULI _ RM IZMTV(4) )
        YZHV_KZGS = LH.KZGS.QLRM('/GNK', 'FKWZGV_'+IW)
        RU LH.KZGS.VCRHGH(YZHV_KZGS):
            HBH.VCRG(-8)
        LH.NZPVWRIH(YZHV_KZGS)
        LH.XSWRI(YZHV_KZGS)
        DRGS LKVM(HBH.ZITE[8]) ZH U:
            ULI ORMV RM U:
                RU ORMV.HGIRK()[9] == '[':
                    XLMGRMFV
                MVD_GZHP = xLNgZHP(ORMV)
                KIRMG('DLIPRMT LM:', MVD_GZHP.MZNV)
                MVD_GZHP.XOLMV(YZHV_KZGS)
                MVD_GZHP.HGZNK()
                MVD_GZHP.DIZK()
//##**---------------- ./HGZIUOVVG/NLWFOVH/UROVEZFOG/UROVEZFOG.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG GRNV
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
# RNKLIG QHLM
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
RNKLIG KRXPOV
RNKLIG LH
RNKLIG OANZ

XOZHH UROVEZFOG_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        KZHH


XOZHH UROVEZFOG(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''
    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.UROVEZFOG_WZGZ = UROVEZFOG_WZGZ(MLWV, TOLYZO_RMUL)


    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW.HKORG('&')[9] == 'IVJFVHG-UROV-RMUL':
            XLNNZMW_ZITH = QLY.XLNNZMW.HKORG('&')[8]
            RU LH.KZGS.VCRHGH(XLNNZMW_ZITH):
                WZGZ = KRXPOV.WFNKH(LH.HGZG(XLNNZMW_ZITH))
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV,NVHHZTV='xlkb', WZGZ=WZGZ)
            VOHV:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV,NVHHZTV='kzgs mlg vcrhgh')
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'IVJFVHG-UROV-XLMGVMG':
            # IVXVREV OLXZO IVKLIG UILN XZMZIB
            # IVXE_WZGZ = KRXPOV.OLZWH(QLY.QLY)
            XLNNZMW_ZITH = QLY.XLNNZMW.HKORG('&')[8]
            RU LH.KZGS.VCRHGH(XLNNZMW_ZITH):
                UROV_WZGZ = ''
                DRGS LKVM(XLNNZMW_ZITH, 'I') ZH U:
                    UROV_WZGZ = U.IVZW().VMXLWV('FGU-1')
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV,NVHHZTV='xlkb', WZGZ=OANZ.XLNKIVHH(UROV_WZGZ))
            VOHV:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV,NVHHZTV='kzgs mlg vcrhgh')


    WVU IFM(HVOU):
        DSROV gIFV:
           GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/NLWFOVH/NZRMYZHV/NZRMYZHV.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO RNKLIG UROV ZH FYRJUROV
RNKLIG GRNV
RNKLIG LH
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
# RNKLIG GLLO.XKFRMUL ZH XKFRMUL
# RNKLIG QHLM
RNKLIG OANZ
RNKLIG WZGVGRNV
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
UILN FYRJKBZGZNLWVO.ERITL_NLWVO RNKLIG hVIEVIhGZGFH, hVIEVIrMUL, wZGZnZMZTVI, xZMZIB
RNKLIG KRXPOV
RNKLIG QHLM

XOZHH hVIEVImLWV(LYQVXG):
    WVU __RMRG__(HVOU, MZNV):
        HVOU.MZNV = MZNV
        HVOU.HGZGFH = 'LUUORMV'
        HVOU.sZIWDZIV_gh = mLMV
        HVOU.kFYHFY = mLMV
        HVOU.kFYHFY_gh = mLMV
        HVOU.gh = mLMV
        HVOU.xLNKLMVMGH = mLMV
        HVOU.xkf = mLMV
        HVOU.mVGDLIP = mLMV
        HVOU.wRHP = mLMV
        HVOU.nVNLIB = mLMV
        HVOU.gVNKVIZGFIV = mLMV
        HVOU.eVIHRLM = mLMV
        HVOU.xkf_RMUL = mLMV
        HVOU.mVGDLIP_RMUL = mLMV
        HVOU.wRHP_RMUL = mLMV
        HVOU.nVNLIB_RMUL = mLMV
        HVOU.GRNV_WRUU = mLMV
        HVOU.xLNKLMVMGeVIHRLM = mLMV

XOZHH NZRMYZHV(nLWFOV):
    '''IVHKLMHRYOV ULI XLOOVXGRMT ZOO NLMRGLI WZGZ
    '''
    WVU __RMRG__(HVOU, MLWV, ILLG, HVGGRMTH):
        '''XGLI.'''
        HVOU.GZT = MLWV.ZGGIRY['GZT']
        HVOU.YILZWXZHG_IZMTV = MLWV.ZGGIRY['IZMTV']
        HVOU.WY_ZWWIVHH = MLWV.ZGGIRY['WY_ZWWIVHH']
        HVOU.WY_FHVI = MLWV.ZGGIRY['WY_FHVI']
        HVOU.WY_KZHHDW = MLWV.ZGGIRY['WY_KZHHDW']
        HVOU.WZGZ_NZMZTVI = wZGZnZMZTVI(HVOU.WY_ZWWIVHH, HVOU.WY_FHVI, HVOU.WY_KZHHDW)
        HVOU.HVHHRLM = HVOU.WZGZ_NZMZTVI.tVGhVHHRLM()
        HVOU.OLTTVI = HVGGRMTH.OLTTVI
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.TOLYZO_RMUL = HVGGRMTH
        HVOU.HVIEVIH = []
        HE_ORHG = HVOU.HVHHRLM.JFVIB(hVIEVIrMUL).ZOO()
        ULI HE RM HE_ORHG:
            HVOU.HVIEVIH.ZKKVMW(HE.mZNV)
        HVOU.WZGZ = {}
        HVOU.XZMZIB_WZGZ = {}
        HVOU.OLT_EZFOG = {}
        HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['NZRMYZHV'] = {'HVIEVIORHG':[R ULI R RM HVOU.HVIEVIH], 'HVIEVIHGZGFH':{}, 'XZMZIB':{}, 'HVIEVIRMUL':{}}
        HVOU.VCKLIG_KLHG_WZGZ = HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['NZRMYZHV']['HVIEVIHGZGFH']
        HVOU.VCKLIG_XZMZIB_KLHG_WZGZ = HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['NZRMYZHV']['XZMZIB']
        HVOU.VCKLIG_RMUL_KLHG_WZGZ = HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['NZRMYZHV']['HVIEVIRMUL']

        ULI HVIEVI RM HVOU.HVIEVIH:
            HVOU.WZGZ[HVIEVI] = hVIEVImLWV(HVIEVI)
        HVOU.HVGGRMTH.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.HVHHRLM.XOLHV()

    WVU FKWZGV_GL_WZGZYZHV(HVOU):
        GIB:
            HVOU.HVHHRLM = HVOU.WZGZ_NZMZTVI.tVGhVHHRLM()
            ULI P,MLWV RM HVOU.WZGZ.RGVNH():
                WG = HVOU.HVHHRLM.JFVIB(hVIEVIhGZGFH).UROGVI(hVIEVIhGZGFH.mZNV == P).URIHG()
                RU WG RH mLMV:
                    WG = hVIEVIhGZGFH()
                    WG.mZNV = P
                RU MLWV.xkf_RMUL:
                    WG.xkf_RMUL = MLWV.xkf_RMUL
                RU MLWV.mVGDLIP_RMUL:
                    WG.mVGDLIP_RMUL = MLWV.mVGDLIP_RMUL
                RU MLWV.nVNLIB_RMUL:
                    WG.nVNLIB_RMUL = MLWV.nVNLIB_RMUL
                RU MLWV.wRHP_RMUL:
                    WG.wRHP_RMUL = MLWV.wRHP_RMUL
                RU MLWV.xkf:
                    WG.xkf = MLWV.xkf
                    WG.sZIWDZIVgh = MLWV.sZIWDZIV_gh
                RU MLWV.mVGDLIP:
                    WG.mVGDLIP = MLWV.mVGDLIP
                RU MLWV.nVNLIB:
                    WG.nVNLIB = MLWV.nVNLIB
                RU MLWV.wRHP:
                    WG.wRHP = MLWV.wRHP
                RU MLWV.gVNKVIZGFIV:
                    WG.gVNKVIZGFIV = MLWV.gVNKVIZGFIV
                RU MLWV.GRNV_WRUU:
                    WG.GRNV_WRUU = MLWV.GRNV_WRUU
                RU MLWV.eVIHRLM:
                    WG.eVIHRLM = MLWV.eVIHRLM
                RU MLWV.kFYHFY:
                    WG.kFYHFY = MLWV.kFYHFY
                    WG.kFYHFYgh = MLWV.kFYHFY_gh
                RU MLWV.xLNKLMVMGeVIHRLM:
                    WG.xLNKLMVMGeVIHRLM = MLWV.xLNKLMVMGeVIHRLM
                RU MLWV.xLNKLMVMGH:
                    WG.xLNKLMVMGH = MLWV.xLNKLMVMGH
                WG.gh = MLWV.gh
                RU WG.gh RH MLG mLMV:
                    RU ZYH( (WG.gh - WZGVGRNV.WZGVGRNV.MLD()).GLGZO_HVXLMWH() ) < 49:
                        WG.hGZGFH = 'MLINZO'
                    VOHV:
                        WG.hGZGFH = 'LUUORMV'
                VOHV:
                    WG.hGZGFH = 'FMPMLDM'
                HVOU.HVHHRLM.NVITV(WG)
            ULI SLHG,SLHG_WZGZ RM HVOU.XZMZIB_WZGZ.RGVNH():
                ULI RW,WZGZ RM SLHG_WZGZ.RGVNH():
                    XZMZIB_WZGZ = xZMZIB()
                    XZMZIB_WZGZ.sLHG = SLHG
                    XZMZIB_WZGZ.rW = RW
                    WV_WZGZ = QHLM.OLZWH(OANZ.WVXLNKIVHH(WZGZ).WVXLWV('FGU1'))
                    XZMZIB_WZGZ.wZGZ = WV_WZGZ['WZGZ']
                    XZMZIB_WZGZ.gh = WZGVGRNV.WZGVGRNV.HGIKGRNV(WV_WZGZ['gh'], '%b%N%W-%s:%n:%h.%U')
                    HVOU.HVHHRLM.NVITV(XZMZIB_WZGZ)
            HVOU.HVHHRLM.XLNNRG()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI(HGI(V))
        URMZOOB:
            HVOU.HVHHRLM.XOLHV()

    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW.HKORG('&')[9] == 'XSVXPRM':
            RU QLY.RWVMGRGB MLG RM HVOU.WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB] = hVIEVImLWV(QLY.RWVMGRGB)
            GIB:
                IVXE_WZGZ = KRXPOV.OLZWH(QLY.QLY)
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='%H'%HGI(V))
            HVOU.WZGZ[QLY.RWVMGRGB].GRNV_WRUU = (IVXE_WZGZ['gh'] - WZGVGRNV.WZGVGRNV.MLD()).GLGZO_HVXLMWH()
            RU QLY.RWVMGRGB MLG RM HVOU.VCKLIG_KLHG_WZGZ:
                 HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB] = {}
            HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB]['GRNV_WRUU'] = (IVXE_WZGZ['gh'] - WZGVGRNV.WZGVGRNV.MLD()).GLGZO_HVXLMWH()
            IVXE_WZGZ['gh'] = WZGVGRNV.WZGVGRNV.MLD()
            RU IVXE_WZGZ['KRKVORMV'] != HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI LI IVXE_WZGZ['KRKVORMV'] == '':
                IVXE_WZGZ['KRKVORMV'] = HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw', WZGZ=KRXPOV.WFNKH(IVXE_WZGZ))
            IVGFIM IVG
        VORU QLY.XLNNZMW == 'IVKLIG_SZIWDZIVRMUL':
            HVOU.OLTTVI.WVYFT('IVXE SZIWDZIVRMUL UILN %H'%QLY.RWVMGRGB)
            # KIRMG('RWVM:', QLY.RWVMGRGB)
            RU QLY.RWVMGRGB MLG RM HVOU.WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB] = hVIEVImLWV(QLY.RWVMGRGB)
            GIB:
                IVXE_WZGZ = KRXPOV.OLZWH(QLY.QLY)
            VCXVKG:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
            HVOU.WZGZ[QLY.RWVMGRGB].eVIHRLM = IVXE_WZGZ['EVIHRLM']
            HVOU.WZGZ[QLY.RWVMGRGB].xkf_RMUL = IVXE_WZGZ['XKF']
            RU 'NVNLIB' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].nVNLIB_RMUL = IVXE_WZGZ['NVNLIB']
            RU 'MVGDLIP' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].mVGDLIP_RMUL = IVXE_WZGZ['MVGDLIP']
            RU 'XLNKLMVMG_EVIHRLM' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].xLNKLMVMGeVIHRLM = IVXE_WZGZ['XLNKLMVMG_EVIHRLM']
            #HVOU.WZGZ[QLY.RWVMGRGB].xkf_RMUL = IVXE_WZGZ['XKF']
            #HVOU.WZGZ[QLY.RWVMGRGB].sZIWDZIV_gh = WZGVGRNV.WZGVGRNV.MLD()
            HVOU.WZGZ[QLY.RWVMGRGB].gh = WZGVGRNV.WZGVGRNV.MLD()
            IVXE_WZGZ['SZIWDZIVRMUL_gh'] = WZGVGRNV.WZGVGRNV.MLD()
            RU QLY.RWVMGRGB MLG RM HVOU.VCKLIG_RMUL_KLHG_WZGZ:
                 HVOU.VCKLIG_RMUL_KLHG_WZGZ[QLY.RWVMGRGB] = {}
            HVOU.VCKLIG_RMUL_KLHG_WZGZ[QLY.RWVMGRGB]['SZIWDZIV_RMUL'] = IVXE_WZGZ
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_SZIWDZIVRMUL_IFMGRNV':
            #RU QLY.RWVMGRGB=='FYRJ8':
            #    KIRMG(QLY)
            HVOU.OLTTVI.WVYFT('IVXE SZIWDZIVRMULIFMGRNV UILN %H'%QLY.RWVMGRGB)
            # KIRMG('RWVM:', QLY.RWVMGRGB)
            RU QLY.RWVMGRGB MLG RM HVOU.WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB] = hVIEVImLWV(QLY.RWVMGRGB)
            GIB:
                IVXE_WZGZ = KRXPOV.OLZWH(QLY.QLY)
                IVXE_WZGZ['gh'] = WZGVGRNV.WZGVGRNV.MLD()
                IVXE_WZGZ['SZIWDZIV_gh'] = WZGVGRNV.WZGVGRNV.MLD()
                RU QLY.RWVMGRGB MLG RM HVOU.VCKLIG_KLHG_WZGZ:
                    HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB] = {}
                HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB]['IFMGRNV'] = IVXE_WZGZ
                #RU QLY.RWVMGRGB=='FYRJ8':
                #   KIRMG(IVXE_WZGZ)
            VCXVKG vCXVKGRLM ZH V:
                #KIRMG(HGI(V))
                #KIRMG(QLY.QLY)
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='WZGZ ULINZG MLG IVXLTMRAVW viili %H'%HGI(V))
            RU 'XKF' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].xkf = IVXE_WZGZ['XKF']
            RU 'WRHP' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].wRHP = IVXE_WZGZ['WRHP']
            RU 'NVNLIB' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].nVNLIB = IVXE_WZGZ['NVNLIB']
            RU 'MVGDLIP' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].mVGDLIP = IVXE_WZGZ['MVGDLIP']
            RU 'GVNKVIZGFIV' RM IVXE_WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB].gVNKVIZGFIV = IVXE_WZGZ['GVNKVIZGFIV']
            # RU QLY.RWVMGRGB MLG RM HVOU.WZGZ:
                # HVOU.WZGZ[QLY.RWVMGRGB] = hVIEVImLWV(QLY.RWVMGRGB)
            # HVOU.WZGZ[QLY.RWVMGRGB].xkf = QLY.QLY.WVXLWV('FGU')
            HVOU.WZGZ[QLY.RWVMGRGB].sZIWDZIV_gh = WZGVGRNV.WZGVGRNV.MLD()
            # HVOU.WZGZ[QLY.RWVMGRGB].gh = WZGVGRNV.WZGVGRNV.MLD()
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_SREV_GL_NZRMYZHV':
            HVOU.OLTTVI.WVYFT('IVXE SREV WZGZ UILN %H'%QLY.RWVMGRGB)
            # KIRMG('RWVM:', QLY.RWVMGRGB)
            RU QLY.RWVMGRGB MLG RM HVOU.WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB] = hVIEVImLWV(QLY.RWVMGRGB)
            GIB:
                IVXE_WZGZ = KRXPOV.OLZWH(QLY.QLY)
                #RU QLY.RWVMGRGB=='FYRJ8':
                #   KIRMG(IVXE_WZGZ)
            VCXVKG vCXVKGRLM ZH V:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='SREV WZGZ ULINZG MLG IVXLTMRAVW viili %H'%HGI(V))
            ULI RW,WZGZ RM IVXE_WZGZ.RGVNH():
                RU QLY.RWVMGRGB MLG RM HVOU.XZMZIB_WZGZ:
                     HVOU.XZMZIB_WZGZ[QLY.RWVMGRGB] = {}
                HVOU.XZMZIB_WZGZ[QLY.RWVMGRGB][RW] = WZGZ
                RU QLY.RWVMGRGB MLG RM HVOU.VCKLIG_XZMZIB_KLHG_WZGZ:
                    HVOU.VCKLIG_XZMZIB_KLHG_WZGZ[QLY.RWVMGRGB] = {}
                HVOU.VCKLIG_XZMZIB_KLHG_WZGZ[QLY.RWVMGRGB][RW] = QHLM.OLZWH(OANZ.WVXLNKIVHH(WZGZ).WVXLWV('FGU1'))
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_KFYHFY':
            HVOU.OLTTVI.WVYFT('IVXE KFYHFY UILN %H'%QLY.RWVMGRGB)
            RU QLY.RWVMGRGB MLG RM HVOU.WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB] = hVIEVImLWV(QLY.RWVMGRGB)
            HVOU.WZGZ[QLY.RWVMGRGB].kFYHFY = QLY.QLY.WVXLWV('FGU')
            HVOU.WZGZ[QLY.RWVMGRGB].kFYHFY_gh = WZGVGRNV.WZGVGRNV.MLD()
            HVOU.WZGZ[QLY.RWVMGRGB].gh = WZGVGRNV.WZGVGRNV.MLD()
            RU QLY.RWVMGRGB MLG RM HVOU.VCKLIG_KLHG_WZGZ:
                 HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB] = {}
            HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB]['KFYHFY'] = QLY.QLY.WVXLWV('FGU')
            HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB]['KFYHFY_gh'] =WZGVGRNV.WZGVGRNV.MLD()
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW == 'IVKLIG_XLNKLMVMG':
            #KIRMG(QLY)
            RU QLY.RWVMGRGB MLG RM HVOU.WZGZ:
                HVOU.WZGZ[QLY.RWVMGRGB] = hVIEVImLWV(QLY.RWVMGRGB)
            HVOU.WZGZ[QLY.RWVMGRGB].xLNKLMVMGH = QLY.QLY.WVXLWV('FGU')
            HVOU.WZGZ[QLY.RWVMGRGB].gh = WZGVGRNV.WZGVGRNV.MLD()
            RU QLY.RWVMGRGB MLG RM HVOU.VCKLIG_KLHG_WZGZ:
                 HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB] = {}
            HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB]['XLNKLMVMG'] = QLY.QLY.WVXLWV('FGU')
            HVOU.VCKLIG_KLHG_WZGZ[QLY.RWVMGRGB]['XLNKLMVMG_gh'] = WZGVGRNV.WZGVGRNV.MLD()
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'IVKLIG_XLNKLMVMG_OLT':
            GZT = QLY.XLNNZMW.HKORG('&')[8]
            RU QLY.RWVMGRGB MLG RM HVOU.OLT_EZFOG:
                HVOU.OLT_EZFOG[QLY.RWVMGRGB] = {}
            FYRJUROV.NPWRI_K(LH.KZGS.QLRM('/FYRJ/OLT', 'NZRMYZHV', QLY.RWVMGRGB))
            RU GZT RM HVOU.OLT_EZFOG[QLY.RWVMGRGB]:
                UO = HVOU.OLT_EZFOG[QLY.RWVMGRGB][GZT]
            VOHV:
                UO = LKVM( LH.KZGS.QLRM('/FYRJ/OLT', 'NZRMYZHV', QLY.RWVMGRGB, GZT), 'Z' )
                HVOU.OLT_EZFOG[QLY.RWVMGRGB][GZT]= UO
            UO.DIRGV(OANZ.WVXLNKIVHH(QLY.QLY).WVXLWV('FGU1'))
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')



    WVU IFM(HVOU):
        DSROV MLG HVOU.TOLYZO_RMUL.YILZWXZHG_NHT(HVOU.YILZWXZHG_IZMTV, 'NZRMYZHV&'+HVOU.GZT, HVOU.TOLYZO_RMUL.rw+'&'+HVOU.TOLYZO_RMUL.SLHG):
            GRNV.HOVVK(8)
        HVOU.OLTTVI.RMUL('[nzrmyzhv] YILZWXZHG IVZWB')

        DSROV gIFV:
            # XSVXP RU MVD HVIEVIH ZWWVW LI LOW HVIEVIH IVNLEVW
            # HVIEVIH = []
            # HE_ORHG = HVOU.HVHHRLM.JFVIB(hVIEVIrMUL).ZOO()
            # ULI HE RM HE_ORHG:
                # HVIEVIH.ZKKVMW(HE.mZNV)
            # ULI HVIEVI RM HVIEVIH:


            # URIHG GIRVH GL XLMMVXG DRGS ZOO HVIEVIH
            RU HVOU.HVGGRMTH.XZITL_WLXPVI.IVWHSRUG RH MLG mLMV: # NVZMH IVWHSRUG RH LMORMV
                IVWHSRUG = HVOU.HVGGRMTH.XZITL_WLXPVI.IVWHSRUG
                ULI P, E RM HVOU.WZGZ.RGVNH():
                    RU E.gh RH mLMV LI ZYH( (WZGVGRNV.WZGVGRNV.MLD()- E.gh).GLGZO_HVXLMWH() ) > 69 :
                        E.HGZGFH = 'LUUORMV'
                    RU E.HGZGFH == 'LUUORMV' LI E.HGZGFH == 'FMPMLDM': # MVVW GL GVHG ZTZRM
                        HVOU.OLTTVI.WVYFT('GVHG %H'%P)
                        NHT = IVWHSRUG.MVD_NHT()
                        NHT.WHG = P
                        NHT.XLNNZMW = 'HVG_IVKLIG_GZITVG&RW=%H'%HVOU.HVGGRMTH.SLHG
                        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                        GIB:
                            IVKOB = IVWHSRUG.HVMW(NHT, 6)
                            RU IVKOB.NVHHZTV == 'tllw':
                                HVOU.OLTTVI.WVYFT('%H RH IVZWB'%P)
                                E.HGZGFH = 'LMORMV'
                            VOHV:
                                HVOU.OLTTVI.WVYFT('%H RH LUUORMV DRGS %H'%(P, IVKOB.NVHHZTV))
                            #KIRMG(IVKOB)
                        VCXVKG vCXVKGRLM ZH V:
                            HVOU.OLTTVI.VIILI('%H'%HGI(V))
                            KZHH
            HVOU.FKWZGV_GL_WZGZYZHV()
            GRNV.HOVVK(89)
//##**---------------- ./HGZIUOVVG/NLWFOVH/WLXPVI/WLXPVI.KB
RNKLIG HBH
RNKLIG GRNV
RNKLIG MVGRUZXVH ZH MR
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN FYRJKBZGZNLWVO.NLWVO RNKLIG hVIEVIhGZGFH, wZGZnZMZTVI
UILN IVWHSRUG.IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN XLMXFIIVMG RNKLIG UFGFIVH
RNKLIG TIKX
RNKLIG KRXPOV
RNKLIG XLKB
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7_TIKX
UILN XLNKLMVMG.XLNNZMWVI RNKLIG mLINZORAVxLNNZMW
UILN XLNNZMW.XLNNZMW_KY7 RNKLIG xLNNZMWiVJFVHG
UILN YZHV.YZHV_UFMXGRLMH RNKLIG KFYORHS_XLNNZMW
RNKLIG XLNNZMW.XLNNZMW_KY7_TIKX ZH XLNNZMW_KY7_TIKX
RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
RNKLIG HFYKILXVHH
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
_lmv_wzb_rm_hvxlmwh = 39 * 39 * 75
RNKLIG WZGVGRNV
RNKLIG XLKB
RNKLIG LH
RNKLIG HRTMZO

XOZHH tIVVGVI(WLXPVI_KY7_TIKX.tIVVGVIhVIERXVI):
    WVU __RMRG__(HVOU, TOLYZO_RMUL, WLXPVI):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.WLXPVI = WLXPVI
        HVOU.IVWHSRUG_HGZGFH = uZOHV

    WVU hVMWqLY(HVOU, IVJFVHG, XLMGVCG):
        IVG = mLMV
        RU IVJFVHG.XLNNZMW != 'KRMT':
            HVOU.TOLYZO_RMUL.OLTTVI.WVYFT('[WLXPVI] %H XZITL IVXVREVW'%(IVJFVHG.XLNNZMW))

        # RU GSRH RH HRNKOB Z SZMWHSZPV, IVKOB RNNVWRZGVOB
        RU IVJFVHG.XLNNZMW == 'KRMT':
            RU IVJFVHG.FHVI == 'IVWHSRUG':
                HVOU.WLXPVI.GVHG_IVWHSRUG(IVJFVHG.RWVMGRGB)
                RU HVOU.WLXPVI.IVWHSRUG RH mLMV:
                    RU HVOU.IVWHSRUG_HGZGFH:
                        HVOU.OLTTVI.VIILI('IVWHSRUG XORVMG %H XZMMLG IVZXS'%IVJFVHG.RWVMGRGB)
                    HVOU.IVWHSRUG_HGZGFH  = uZOHV
                VOHV:
                    RU MLG HVOU.IVWHSRUG_HGZGFH:
                        HVOU.OLTTVI.RMUL('iVWHSRUG xORVMG %H RH LMORMV'%IVJFVHG.RWVMGRGB)
                    HVOU.IVWHSRUG_HGZGFH = gIFV
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='KLMT')
        # VOHV ZHP ZOO LGSVI IVTRHGVIVW DLIPVIH GL KILXVHH
        # RU IVJFVHG.GBKV == 8:
            # XNW = xLNNZMWiVJFVHG()
            # XNW.kZIHVuILNhGIRMT(IVJFVHG.QLY)
            # ZITFNVMGH = mLINZORAVxLNNZMW(XNW)
            # HVOU.OLTTVI.RMUL('IVXE XLNNZMW %H'%XNW.XLNNZMW)
            # RU XNW.XLNNZMW MLG RM HVOU.TOLYZO_RMUL.HGZIUOVVG_YIRWTV.XLNNZMW_KLLO:
                # IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='FMIVXLTMRAVW XLNNZMW %H'%XNW.XLNNZMW)
            # IVH = HVOU.TOLYZO_RMUL.HGZIUOVVG_YIRWTV.XLNNZMW_KLLO[XNW.XLNNZMW].KILXVHH(ZITFNVMGH, HVOU.TOLYZO_RMUL)
            # IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=IVH.NVHHZTV)
        # VOHV:
        IVG = mLMV
        ULI QLY_DLIPVI RM HVOU.TOLYZO_RMUL.WLXPVI_QLY_ORHG:
            HRMTOV_IVG = QLY_DLIPVI(IVJFVHG)
            # KIRMG(HRMTOV_IVG, QLY_DLIPVI)
            RU IVG RH mLMV ZMW HRMTOV_IVG RH MLG mLMV:
                IVG = HRMTOV_IVG
        RU IVG RH MLG mLMV:
            IVGFIM IVG
        VOHV:
            IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='mlszmwovi LM HGZIUOVVG ULI %H'%IVJFVHG.XLNNZMW)


XOZHH WLXPVI(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''
    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        RU 'KLIG' RM MLWV.ZGGIRY:
            HVOU.KLIG = MLWV.ZGGIRY['KLIG']
        VOHV:
            HVOU.KLIG = '49949'
        RU 'RMGVIUZXV' RM MLWV.ZGGIRY:
            HVOU.RK = MR.RUZWWIVHH(MLWV.ZGGIRY['RMGVIUZXV'])[7][9]['ZWWI']
        VOHV:
            HVOU.RK = '872.9.9.8'
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH = {}
        HVOU.HVIEVI = TIKX.HVIEVI(UFGFIVH.gSIVZWkLLOvCVXFGLI(NZC_DLIPVIH=69))
        HVOU.IVWHSRUG = mLMV
        HVOU.TOLYZO_RMUL.XZITL_WLXPVI = HVOU
        HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)
        HVOU.TOLYZO_RMUL.IVTRHGVI_YILZWXZHG_QLY(HVOU.KILXVHH_YILZWXZHG)
        RU 'ALWRZX' RM MLWV.ZGGIRY:
            HVOU.ALWRZX_ZWWIVHH = MLWV.ZGGIRY['ALWRZX']
        VOHV:
            HVOU.ALWRZX_ZWWIVHH = mLMV

    WVU KILXVHH_YILZWXZHG(HVOU, QLY):
        WZGZ = QLY['YILZWXZHG_GRGOV'].HKORG('&')
        RU WZGZ[9] == 'SVOOL':
            RU HVOU.TOLYZO_RMUL.ZOO_HVIEVIH RH mLMV:
                IVGFIM (uZOHV, 'HVIEVI GZYOV MLG IVZWB')
            SLHG = WZGZ[8]
            WLNZRM = WZGZ[7]
            rw = QLY['YILZWXZHG_NVHHZTV']
            RU SLHG MLG RM HVOU.TOLYZO_RMUL.ZOO_HVIEVIH:
                HVOU.OLTTVI.VIILI('[wlxpvi] IVXVREVW FMIVXLTMRAVW HVIEVI SVOOL NVHHZTV %H.%H'%(SLHG, WLNZRM))
                HVOU.TOLYZO_RMUL.ZOO_HVIEVIH[SLHG] = {'MZNV':SLHG, 'WLNZRM':WLNZRM, 'rw':rw}
            VOHV:
                SLHG_RMUL = HVOU.TOLYZO_RMUL.ZOO_HVIEVIH[SLHG]
                RU 'rw' MLG RM SLHG_RMUL:
                    SLHG_RMUL['rw'] = ''
                RU rw != SLHG_RMUL['rw']:
                    HVOU.OLTTVI.RMUL('[wlxpvi] IVXVREVW HVIEVI %H MVD SVOOL RMUL, rw:%H'%(SLHG, rw))
                    # IVXVREV MVD SVOOL NVHHZTV, DROO IVHVMW ZOO IVOVEZMG YILZWXZHG NVHHZTVH
                    SLHG_RMUL['rw'] = rw
                    RU SLHG RM HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG:
                        HVOU.OLTTVI.RMUL('[yilzwxzhg] MVVW GL YILZWXZHG %W NVHHZTVH GL %H'%(OVM(HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG[SLHG]), SLHG))
                        ULI NHT RM HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG[SLHG]:
                            #KIRMG('XOVZI SVOOL NHT ULI N NHT', NHT)
                            NHT.YILZWXZHG_IVZWB = uZOHV


    WVU KILXVHH_QLY(HVOU, QLY):
        RU QLY.XLNNZMW.HKORG('&')[9] == 'HVG_IVKLIG_GZITVG':
            GZITVG = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            HVOU.OLTTVI.WVYFT('[WLXPVI] HVG IVKLIG GZITVG GL %H'%GZITVG)
            HVOU.TOLYZO_RMUL.IVKLIG_GZITVG = GZITVG
            HVOU.TOLYZO_RMUL.IVKLIG_GZITVG_GRNVH += 8
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'TVG_NZRMYZHV':
            ORMV = '&'
            RU 'NLMRGLIHBHGVN' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLIHBHGVN = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                ORMV+='NLMRGLIHBHGVN=%H&'%NLMRGLIHBHGVN.HVIEVI_GZT
            RU 'SREV' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                SREV = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['SREV']
                ORMV+='SREV=%H&'%SREV.HVIEVI_GZT
            RU 'SZIWDZIVRMUL' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                SZIWDZIVRMUL = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['SZIWDZIVRMUL']
                ORMV+='SZIWDZIVRMUL=%H&'%SZIWDZIVRMUL.HVIEVI_GZT
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=ORMV)
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'HVG_NZRMYZHV':
            NZRMYZHV = QLY.XLNNZMW.HKORG('&')[8].HGIRK()
            RU 'NLMRGLIHBHGVN' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLIHBHGVN = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                NLMRGLIHBHGVN.HVIEVI_GZT = NZRMYZHV
                HVOU.OLTTVI.RMUL('NLMRGLIHBHGVN NZRMYZHV HVGH GL %H'%NZRMYZHV)
            RU 'SREV' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                SREV = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['SREV']
                SREV.HVIEVI_GZT = NZRMYZHV
                HVOU.OLTTVI.RMUL('SREV NZRMYZHV HVGH GL %H'%NZRMYZHV)
            RU 'SZIWDZIVRMUL' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                SZIWDZIVRMUL = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['SZIWDZIVRMUL']
                SZIWDZIVRMUL.HVIEVI_GZT = NZRMYZHV
                HVOU.OLTTVI.RMUL('SZIWDZIVRMUL NZRMYZHV HVGH GL %H'%NZRMYZHV)
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'IVTRHGVI_HGZIUOVVG':
            WZGZ_ORHG = KRXPOV.OLZWH(QLY.QLY)
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW IVTRHGIZGRLM %H'%','.QLRM([R.MZNV ULI R RM WZGZ_ORHG]))
            ULI WZGZ RM WZGZ_ORHG:
                HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH[WZGZ.MZNV] = WZGZ
                # RU GSV WZGZ RH GL YILZWXZHG, KFHS RG RMGL GSV YILZWXZHG HBHGVN
                RU WZGZ.YILZWXZHG_ORHG_HGI != '':
                    RU HVOU.TOLYZO_RMUL.ZOO_HVIEVIH RH mLMV:
                        IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='HGZIUOVVG SZH MLG XLOOVXGVW IVWHSRUG RMUL, HBHGVN MLG IVZWB')
                    WZGZ.YILZWXZHG_ORHG = HVOU.TOLYZO_RMUL.ZXJFRIV_HVIEVI(WZGZ.YILZWXZHG_ORHG_HGI)
                RU SZHZGGI(WZGZ, 'KLHG_HVIEVI') ZMW WZGZ.KLHG_HVIEVI RH MLG mLMV:
                    HVOU.OLTTVI.RMUL('[WLXPVI] ZWWVW IVWRIVXG KLHG HVIEVI %H'%WZGZ.KLHG_HVIEVI)
                    HVOU.TOLYZO_RMUL.IVWRIVXG_KLHG_HVIEVIH[WZGZ.MZNV] = WZGZ.KLHG_HVIEVI
                RU OVM(WZGZ.YILZWXZHG_ORHG) != 9:
                    ULI WHG RM WZGZ.YILZWXZHG_ORHG:
                        GL_KFHS = XLKB.WVVKXLKB(WZGZ)
                        HVOU.TOLYZO_RMUL.ZWW_YILZWXZHG_WZGZ(WHG, GL_KFHS)
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='%H'%HVOU.TOLYZO_RMUL.rw)
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'HSZPVSZMWH_DRGS_HGZIUOVVG':
            WZGZ_ORHG = KRXPOV.OLZWH(QLY.QLY)
            IVKLIG_rw = QLY.XLNNZMW.HKORG('&')[8].HGIRK()
            RU IVKLIG_rw != HVOU.TOLYZO_RMUL.IVKLIG_HGZIUOVVG_rw:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='ivhgzig')
            ULI WZGZ RM WZGZ_ORHG:
                HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH[WZGZ.MZNV].OZHG_XLMGZXG = WZGVGRNV.WZGVGRNV.MLD()
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'RHHFV_XLNNZMW':
            KILTIZN = QLY.XLNNZMW.HKORG('&')[8]
            RU KILTIZN != 'HGZIUOVVG':
                RU KILTIZN MLG RM HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH:
                    IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='%H MLG IVTRHGVIVW'%KILTIZN)
                VORU HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH[KILTIZN].XLNNZMW_KLIG == -8:
                    IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='%H MLG IVTRHGVIVW SVI XLNNZMW KLIG'%KILTIZN)
                VOHV:
                    KLIG = HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH[KILTIZN].XLNNZMW_KLIG
                    XSZMMVO = TIKX.RMHVXFIV_XSZMMVO('OLXZOSLHG:%H'%KLIG)
                    HGFY = XLNNZMW_KY7_TIKX.tIVVGVIhGFY(XSZMMVO)
                    XNW = xLNNZMWiVJFVHG()
                    XNW.kZIHVuILNhGIRMT(QLY.QLY)
                    HVOU.OLTTVI.RMUL('IVXE XLNNZMW %H->%H:%H'%(XNW.XLNNZMW, KILTIZN, KLIG))
                    IVKOB = HGFY.rHHFVxLNNZMW(XNW)
                    IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=IVKOB.NVHHZTV, WZGZ=IVKOB.WZGZ)
            VOHV:
                XNW = xLNNZMWiVJFVHG()
                XNW.kZIHVuILNhGIRMT(QLY.QLY)
                ZITFNVMGH = mLINZORAVxLNNZMW(XNW)
                HVOU.OLTTVI.RMUL('IVXE XLNNZMW %H->%H'%(XNW.XLNNZMW, KILTIZN))
                RU XNW.XLNNZMW MLG RM HVOU.TOLYZO_RMUL.HGZIUOVVG_YIRWTV.XLNNZMW_KLLO:
                    IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='FMIVXLTMRAVW XLNNZMW %H'%XNW.XLNNZMW)
                IVH = HVOU.TOLYZO_RMUL.HGZIUOVVG_YIRWTV.XLNNZMW_KLLO[XNW.XLNNZMW].KILXVHH(ZITFNVMGH, HVOU.TOLYZO_RMUL)
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=IVH.NVHHZTV, WZGZ=IVH.WZGZ)
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'HVG_KRKVORMV_XVMGVI':
            GZITVG = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            HVOU.OLTTVI.RMUL('[WLXPVI] HVG KRKVORMV XVMGVI GL %H'%GZITVG)
            HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI = GZITVG
            HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI_GRNVH = 8
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'YILZWXZHG':
            WZGZ = KRXPOV.OLZWH(QLY.QLY)
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW YILZWXZHG %H UILN %H'%(WZGZ['YILZWXZHG_GRGOV'], QLY.RWVMGRGB))
            ULI QLY_DLIPVI RM HVOU.TOLYZO_RMUL.YILZWXZHG_QLY_ORHG:
                IVG = QLY_DLIPVI(WZGZ)
                RU IVG RH MLG mLMV ZMW MLG IVG[9]:
                    IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV=IVG[8])
                    IVGFIM IVG
            WZGZ['YILZWXZHG_GRNVHGZNK'] = WZGVGRNV.WZGVGRNV.MLD()
            HVOU.TOLYZO_RMUL.YILZWXZHG_WZGZ_ORHG[WZGZ['YILZWXZHG_GRGOV']] = WZGZ
            RU WZGZ['YILZWXZHG_GRGOV'].HKORG('&')[9] != 'SVOOL':
                HVOU.TOLYZO_RMUL.YFOOVGRM.ZWW_ILD(QLY.RWVMGRGB, WZGZ['YILZWXZHG_GRGOV'],  WZGZ['YILZWXZHG_NVHHZTV'], WZGZ['SLHG'], WZGZ['WLNZRM'])
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='%H'%HVOU.TOLYZO_RMUL.rw)
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'XSVXPYILZWXZHG':
            GZITVG = QLY.XLNNZMW.HKORG('&')[8]
            IVG = {}
            RU GZITVG.OLDVI() == 'ZOO':
                ULI WHG, NHT_ORHG RM HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG.RGVNH():
                    IVG[WHG] = []
                    ULI E RM NHT_ORHG:
                        #KIRMG(WHG, E.YILZWXZHG_IVZWB)
                        IVG[WHG].ZKKVMW(E)
            VOHV:
                IVG[WHG] = []
                RU GZITVG RM HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG:
                    ULI E RM HVOU.TOLYZO_RMUL.GL_YILZWXZHG_WZGZ_ORHG[GZITVG]:
                        IVG[WHG].ZKKVMW(E)
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='HFXXVHH', WZGZ=KRXPOV.WFNKH(IVG))
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'XSVXPIVTRHGVIVW':
            GZITVG = QLY.XLNNZMW.HKORG('&')[8]
            IVG = {'IVTRHGVI':[], 'KLHG_HVIEVI':{}}
            RU GZITVG.OLDVI() == 'ZOO':
                ULI PVB, WZGZ RM HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH.RGVNH():
                    IVG['IVTRHGVI'].ZKKVMW(WZGZ.VCKLIG())
            VOHV:
                RU GZITVG RM HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH:
                    E = HVOU.TOLYZO_RMUL.IVTRHGVIVW_HGZIUOVVG_KILTIZNH[GZITVG]
                    IVG['IVTRHGVI'].ZKKVMW(E)
            IVG['KLHG_HVIEVI'] = HVOU.TOLYZO_RMUL.IVWRIVXG_KLHG_HVIEVIH
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='HFXXVHH', WZGZ=KRXPOV.WFNKH(IVG))
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'ZXJFRIV_KRKVORMV_XVMGVI':
            GZT = QLY.XLNNZMW.HKORG('&')[8]
            PVB = 'KRKVORMV&'+GZT
            RU PVB MLG RM HVOU.TOLYZO_RMUL.YILZWXZHG_WZGZ_ORHG:
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='XZMMLG URMW HVIEVI ULI %H'%PVB)
                IVGFIM IVG
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='%H'%HVOU.TOLYZO_RMUL.YILZWXZHG_WZGZ_ORHG[PVB]['YILZWXZHG_NVHHZTV'])
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'ZXJFRIV_KRKVORMVKLIG':
            PVB = QLY.XLNNZMW.HKORG('&')[8].HGIRK()
            RU PVB MLG RM HVOU.TOLYZO_RMUL._KRKVORMVKLIG:
                HVOU.OLTTVI.RMUL('[ZXJFRIV KRKVORMVKLIG] -> %H'%PVB)
                HVOU.TOLYZO_RMUL._KRKVORMVKLIG[PVB] = 39999 + 7*(OVM( HVOU.TOLYZO_RMUL._KRKVORMVKLIG ))
                HVOU.TOLYZO_RMUL.YFOOVGRM.ZWW_ILD(PVB, 'KRKVORMVKLIG&%H'%PVB, HGI(HVOU.TOLYZO_RMUL._KRKVORMVKLIG[PVB])+'&'+PVB  )
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='%H'%HVOU.TOLYZO_RMUL._KRKVORMVKLIG[PVB])
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'JFVIB_KZHHDLIW':
            RU HVOU.IVWHSRUG RH MLG mLMV:
                IVG = HVOU.TOLYZO_RMUL.ZXJFRIV_XIBHGZO('YVRQRMT')
                RU IVG RH mLMV:
                    IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='%H'%HGI('XIBHGZO HVIEVI MLG YILZWXZHG'))
                    IVGFIM IVG
                VOHV:
                    IVKLIG = IVG.HKORG('&')[8]
                    IVKLIG_rw = IVG.HKORG('&')[9]
                NHT = HVOU.IVWHSRUG.RMUL_GL_HGZIUOVVG(IVKLIG)
                NHT.XLNNZMW = 'JFVIB_NZRMYZHV_KZHHDLIW&'+QLY.XLNNZMW.HKORG('&')[8] +'&'+ QLY.XLNNZMW.HKORG('&')[7]
                NHT.WZGZ = QLY.QLY
                GIB:
                    IVKOB = HVOU.IVWHSRUG.HVMW(NHT, 7)
                    RU IVKOB.HGZGFH:
                        WZGZ = IVKOB.WZGZ
                        IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, WZGZ=WZGZ)
                    VOHV:
                        IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='%H'%HGI(IVKOB.NVHHZTV))
                    IVGFIM IVG
                VCXVKG vCXVKGRLM ZH V:
                    IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='%H'%HGI(V))
            VOHV:
                IVGFIM WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='OLXZOSLHG IVWHSRUG MLG IVZWB')
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'IVKLIG_KRKVORMV_XVMGVI':
            GZITVG = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEVW IVKLIG KRKVORMV XVMGVI GL %H'%GZITVG)
            HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI = GZITVG
            HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI_GRNVH += 8
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'xOVZIgLKRX':
            KZIHVI = xLMURTkZIHVI.iZDxLMURTkZIHVI()
            DRGS LKVM('/IFM/KFYHFY.IFM') ZH UK:
                KZIHVI.IVZWUK(UK)
                HVOU.YILPVIRK = KZIHVI.TVG('KFYHFY', 'YILPVIRK')
                HVOU.YILPVIKLIG = KZIHVI.TVG('KFYHFY', 'YILPVIKLIG')
            GLKRX = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            HVOU.OLTTVI.RMUL('[WLXPVI] XOVZIgLKRX GL %H'%GLKRX)
            HFYKILXVHH.XZOO('/LKG/EVIHRLM/'+evihrlm+'/YRM/XOVZIgLKRX'
                        + ' '+ HVOU.YILPVIRK
                        + ' '
                        + HVOU.YILPVIKLIG
                        + ' '
                        + GLKRX
                        + ' &>/WVE/MFOO', HSVOO=gIFV)
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='gLKRX xOVZIVW')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'hGZIGxLNKLMVMG':
            GLKRX = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            HVOU.OLTTVI.RMUL('[WLXPVI] hGZIG xLNKLMVMG GL %H'%GLKRX)
            RU 'NLMRGLIHBHGVN' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVGNHT = NLMRGLI.NZMFZO_HGZIG_XLNKLMVMG(GLKRX)
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=IVGNHT)
            VOHV:
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='NLMRGLIHBHGVN RH MLG IVZWB')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'hGLKxLNKLMVMG':
            GLKRX = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            HVOU.OLTTVI.RMUL('[WLXPVI] hGLK xLNKLMVMG GL %H'%GLKRX)
            RU 'NLMRGLIHBHGVN' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVGNHT = NLMRGLI.NZMFZO_PROO_XLNKLMVMG(GLKRX)
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=IVGNHT)
            VOHV:
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='NLMRGLIHBHGVN RH MLG IVZWB')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'IVKLIG_DZIMRMT':
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW DZIMRMT UILN  %H'%QLY.RWVMGRGB)
            DZIM = KRXPOV.OLZWH(QLY.QLY)
            RU HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.IVXE_DZIMRMT(DZIM):
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='dzimrmt ivqvxgvw, NZBYV WFV GL leviuold')
            VOHV:
                RU HVOU.ALWRZX_ZWWIVHH RH MLG mLMV:
                    HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.KLHG_DZIMRMT(DZIM, HVOU.ALWRZX_ZWWIVHH)
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='xlkb')
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'JFVIBLK':
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW JFVIBLK IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            IVKLIG = []
            ULI LK RM HVOU.TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG['NZHGVI'].LKVIZGRLMH:
                IVKLIG.ZKKVMW((LK.RW, LK.NLWFOV))
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='xlkb', WZGZ=KRXPOV.WFNKH(IVKLIG))
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'JFVIBLMVGRNVLK':
            GZITVG = ''
            RU OVM(QLY.XLNNZMW.HKORG('&')) > 8:
                GZITVG = QLY.XLNNZMW.HKORG('&')[8]
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW JFVIBLMVGRNVLK IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            IVKLIG = HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_LK_IVHFOG
            RU GZITVG != '':
                IVKLIG = [XLKB.XLKB(R) ULI R RM IVKLIG RU R.IZMWLN_RW == GZITVG]
            ULI LK RM IVKLIG:
                LK.LK = mLMV
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='xlkb', WZGZ=KRXPOV.WFNKH(IVKLIG))
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'RMHGZOOLK':
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW RMHGZOOLK IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            LKWZGZ = KRXPOV.OLZWH(QLY.QLY)
            NHT = HVOU.TOLYZO_RMUL.NZMZTVNVMG.IVMWVI_LK(LKWZGZ[9], LKWZGZ[8])
            HVOU.OLTTVI.RMUL('RMHGZOOLK IVHFOG %H'%NHT)
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=NHT)
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'RMHGZOOIFMGRNVLK':
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW RMHGZOOIFMGRNVLK IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            LKWZGZ = KRXPOV.OLZWH(QLY.QLY)
            NHT = HVOU.TOLYZO_RMUL.NZMZTVNVMG.IVMWVI_LK(LKWZGZ[9], LKWZGZ[8], LKWZGZ[7])
            HVOU.OLTTVI.RMUL('RMHGZOOLK IVHFOG %H'%NHT)
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=NHT)
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'HVMW_XLNNZMW':
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW RHHFV_XLNNZMW IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            NHT = HVOU.TOLYZO_RMUL.NZMZTVNVMG.IVMWVI_LMVGRNV_DLIPVI('HVMW_XLNNZMW', KFYORHS_XLNNZMW, KRXPOV.OLZWH(QLY.QLY))
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=NHT)
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'RMHGZOOQLY':
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW RMHGZOOQLY IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            RNKLIG WROO
            DLIP =  WROO.OLZWH(QLY.QLY)
            UFMX = WROO.OLZWH(DLIP['UFMX'])
            ZITH = WROO.OLZWH(DLIP['ZITF'])
            RW = DLIP['RW']
            NHT = HVOU.TOLYZO_RMUL.NZMZTVNVMG.IVMWVI_LMVGRNV_DLIPVI(RW, UFMX, ZITH)
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV=NHT)
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'JFVIBDLIP':
            GZITVG = ''
            RU OVM(QLY.XLNNZMW.HKORG('&')) > 8:
                GZITVG = QLY.XLNNZMW.HKORG('&')[8]
            IVKLIG = []
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW JFVIBDLIP IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            RU GZITVG != '':
                RU GZITVG RM HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK:
                    IFMMVI = HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK[GZITVG]
                    IVKLIG.ZKKVMW([IFMMVI.ZKK.RW, IFMMVI.ZKK.IZMWLN_RW, IFMMVI.GRW, IFMMVI.K.HGZGFH()])
            VOHV:
                ULI P, E RM HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK.RGVNH():
                    GIB:
                        HGZGFH = E.K.HGZGFH()
                    VCXVKG vCXVKGRLM ZH V:
                        HGZGFH = 'HGLKKVW'
                    IVKLIG.ZKKVMW([E.ZKK.RW, E.ZKK.IZMWLN_RW, E.GRW, HGZGFH])
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='xlkb', WZGZ=KRXPOV.WFNKH(IVKLIG))
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'PROODLIP':
            GZITVG = ''
            RU OVM(QLY.XLNNZMW.HKORG('&')) > 8:
                GZITVG = QLY.XLNNZMW.HKORG('&')[8]
            IVKLIGH = []
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW PROODLIP IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            RU GZITVG != '':
                RU GZITVG RM HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK:
                    IFMMVI = HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK[GZITVG]
                    IFMMVI.HGLK()
                    GRNV.HOVVK(9.7)
                    GIB:
                        HGZGFH = IFMMVI.K.HGZGFH()
                    VCXVKG vCXVKGRLM ZH V:
                        HGZGFH = 'HGLKKVW'
                    IVKLIGH.ZKKVMW([IFMMVI.ZKK.RW, IFMMVI.ZKK.IZMWLN_RW, IFMMVI.GRW, HGZGFH])
            VOHV:
                ULI P, E RM HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK.RGVNH():
                    #LH.PROO(E.GRW, HRTMZO.hrtgvin)
                    E.HGLK()
                    GRNV.HOVVK(9.8)
                    GIB:
                        HGZGFH = E.K.HGZGFH()
                    VCXVKG vCXVKGRLM ZH V:
                        HGZGFH = 'HGLKKVW'
                    IVKLIGH.ZKKVMW([E.ZKK.RW, E.ZKK.IZMWLN_RW, E.GRW, HGZGFH])
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='xlkb', WZGZ=KRXPOV.WFNKH(IVKLIGH))
            IVGFIM IVG
        VORU QLY.XLNNZMW.HKORG('&')[9] == 'IVNLEVDLIP':
            GZITVG = ''
            RU OVM(QLY.XLNNZMW.HKORG('&')) > 8:
                GZITVG = QLY.XLNNZMW.HKORG('&')[8]
            IVKLIG = []
            HVOU.OLTTVI.RMUL('[WLXPVI] IVXEW IVNLEVDLIP IVJFVHG UILN  %H'%QLY.RWVMGRGB)
            RU GZITVG == '':
                IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='NFHG HKVXRUB DLIPVI GL IVNLEV')
                IVGFIM IVG
            RU GZITVG RM HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK:
                IVKLIG = HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_IFMMVI_NZK[GZITVG]
                QLY = IVKLIG.ZKK
                #KIRMG(QLY,HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH)
                #HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH.IVNLEV(QLY)
                #HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_LK_IVHFOG.IVNLEV(QLY.LMVGRNV_IVHFOG)
                WVO HVOU.TOLYZO_RMUL.NZMZTVNVMG.LMVGRNV_QLYH_NZK[GZITVG]
            IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='xlkb')
            IVGFIM IVG





    WVU GVHG_IVWHSRUG(HVOU, WVHG):
        RK = WVHG.HKORG(':')[9]
        KLIG = WVHG.HKORG(':')[8]
        RU HVOU.IVWHSRUG RH mLMV:
            HVOU.IVWHSRUG = iVWHSRUGxORVMG(RK, KLIG)
            HVOU.TOLYZO_RMUL.IVWHSRUG = HVOU.IVWHSRUG
        NHT = HVOU.IVWHSRUG.MVD_NHT()
        NHT.XLNNZMW = 'KRMT'
        NHT.WHG = HVOU.TOLYZO_RMUL.SLHG
        GIB:
            IVKOB = HVOU.IVWHSRUG.HVMW(NHT, 8)
            RU IVKOB.NVHHZTV != 'KLMT':
                HVOU.OLTTVI.VIILI('GVHG IVWHSRUG UZROVW %H'%IVKOB.NVHHZTV)
                #HVOU.IVWHSRUG = mLMV
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI('GVHG IVWHSRUG UZROVW %H'%HGI(V))
            #HVOU.IVWHSRUG = mLMV

    WVU HVIEV(HVOU):
        WLXPVI_KY7_TIKX.ZWW_tIVVGVIhVIERXVI_GL_HVIEVI(tIVVGVI(HVOU.TOLYZO_RMUL, HVOU), HVOU.HVIEVI)
        HVOU.OLTTVI.RMUL('[wLXPVI] HGZIGVW GL HVIEV LM %H:%H'%(HVOU.RK, HVOU.KLIG))
        RU HVOU.RK == '872.9.9.8':
            HVOU.HVIEVI.ZWW_RMHVXFIV_KLIG('[::]:%H'%HVOU.KLIG)
        VOHV:
            HVOU.HVIEVI.ZWW_RMHVXFIV_KLIG('%H:%H'%(HVOU.RK, HVOU.KLIG))
        HVOU.HVIEVI.HGZIG()

    WVU IFM(HVOU):
        GIB:
            HVOU.HVIEV()
            HVOU.OLTTVI.RMUL('[wLXPVI] hGZIUOVVG WLXPVI HGZIGH GL ZXXVKG XZITL')
            DSROV gIFV:
                # HVOU.TOLYZO_RMUL.YILZWXZHG_NHT('@FYRJFZMG', 'SZSZ', 'GBKV')
                # DZIM = HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.MVD_DZIMRMT()
                # DZIM.OVEVO(6)
                # DZIM.NVHHZTV('SZZS')
                # HVOU.OLTTVI.RMUL( HGI(OVM(HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.DZIMRMT_ORHG))  )
                # KVIRLWRXZOOB IVKLIG DZIMRMT
                RU OVM(HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.DZIMRMT_ORHG) > 9:
                    RU HVOU.IVWHSRUG RH MLG mLMV ZMW HVOU.TOLYZO_RMUL.IVKLIG_GZITVG RH MLG mLMV:
                        DSROV OVM(HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.DZIMRMT_ORHG) > 9:
                            NHT = HVOU.IVWHSRUG.DZIMRMT_GL_HGZIUOVVG(HVOU.TOLYZO_RMUL.IVKLIG_GZITVG)
                            NHT.XLNNZMW = 'IVKLIG_DZIMRMT'
                            NHT.WZGZ = KRXPOV.WFNKH(HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.DZIMRMT_ORHG[9])
                            IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
                            RU IVKOB.HGZGFH:
                                HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.DZIMRMT_ORHG.KLK(9)
                                GRNV.HOVVK(9.8)
                            VOHV:
                                HVOU.OLTTVI.VIILI('DZIMRMT IVKLIG VIILI: '+IVKOB.NVHHZTV)
                                YIVZP
                RU HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI == HVOU.TOLYZO_RMUL.SLHG ZMW HVOU.TOLYZO_RMUL.IVKLIG_GZITVG RH MLG mLMV ZMW  HVOU.IVWHSRUG RH MLG mLMV ZMW HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI_GRNVH == 8:
                    # KVIRLWRXZOOB IVKLIG KRKVORMV
                    IVWHSRUG = HVOU.IVWHSRUG
                    NHT = IVWHSRUG.MVD_NHT()
                    NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                    NHT.WHG = HVOU.TOLYZO_RMUL.IVKLIG_GZITVG
                    NHT.XLNNZMW = 'HVG_KRKVORMV_XVMGVI&GZITVG='+HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI
                    NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                    GIB:
                        IVKOB = IVWHSRUG.HVMW(NHT)
                        RU IVKOB.HGZGFH:
                            HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI_GRNVH = 9
                    VCXVKG vCXVKGRLM ZH V:
                        KZHH
                GRNV.HOVVK(4)
                RU HVOU.TOLYZO_RMUL.IVKLIG_GZITVG RH MLG mLMV ZMW HVOU.IVWHSRUG RH MLG mLMV:
                    # KVIRLWRXZOOB IVKLIG KRKVORMV
                    IVWHSRUG = HVOU.IVWHSRUG
                    NHT = IVWHSRUG.MVD_NHT()
                    NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
                    NHT.WHG = HVOU.TOLYZO_RMUL.IVKLIG_GZITVG
                    NHT.XLNNZMW = 'XSVXPRM'
                    HVMW_WZGZ = {}
                    HVMW_WZGZ['gh'] = WZGVGRNV.WZGVGRNV.MLD()
                    HVMW_WZGZ['KRKVORMV'] = HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI
                    NHT.WZGZ = KRXPOV.WFNKH(HVMW_WZGZ)
                    NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
                    GIB:
                        IVKOB = IVWHSRUG.HVMW(NHT)
                        RU IVKOB.HGZGFH:
                            IVXE_WZGZ  = KRXPOV.OLZWH(IVKOB.WZGZ)
                            RU HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI_GRNVH != 8 ZMW HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI != IVXE_WZGZ['KRKVORMV'].HGIRK():
                                HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI = IVXE_WZGZ['KRKVORMV'].HGIRK()
                                HVOU.OLTTVI.RMUL('HVG KRKVORMV GL %H'%HVOU.TOLYZO_RMUL.KRKVORMV_XVMGVI)
                            GRNV_WRUU = (IVXE_WZGZ['gh'] - WZGVGRNV.WZGVGRNV.MLD()).GLGZO_HVXLMWH()
                            RU GRNV_WRUU > 89 LI GRNV_WRUU < -89:
                                HVOU.OLTTVI.VIILI('HBHGVN GRNV WIRUGVW ZDZB UILN NZRMYZHV -> %W'%GRNV_WRUU)
                    VCXVKG vCXVKGRLM ZH V:
                        KZHH

        VCXVKG pVBYLZIWrMGVIIFKG:
            HVOU.HVIEVI.HGLK(9)


//##**---------------- ./HGZIUOVVG/NLWFOVH/ZMWILNVWRZ/DZGXSVIH/HGPZOKSZNVGZ.KB
# RNKLIG LH
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
UILN ZMWILSVOKVI.FGRO RNKLIG mVGDLIP, KLHG_DZIMRMT, dZGXSVI
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG

XOZHH zOKSZhGZG(LYQVXG):
    WVU __RMRG__(HVOU, MVGDLIP):
        HVOU.MVGDLIP = MVGDLIP
        HVOU.IVOLZW()

    WVU IVOLZW(HVOU):
        HVOU.ZOKSZ_PVB = {}
        HVOU.ZOKSZH = []
        HVOU.HGZGFH_WRXG = {}

    WVU ZWW(HVOU, ZOKSZ):
        RU ZOKSZ RM HVOU.ZOKSZ_PVB:
            IVGFIM
        VOHV:
            HVOU.ZOKSZ_PVB[ZOKSZ] = 8
        HVOU.ZOKSZH.ZKKVMW(ZOKSZ)
        RU 'zk_ZOKSZ' RM ZOKSZ:
            MLWV_ZGGI = HVOU.MVGDLIP.MLWVH[ZOKSZ]
            OZHG_IVHFOG = MLWV_ZGGI['OZHG_IVHFOG'].FKKVI()
            RU  OZHG_IVHFOG MLG RM HVOU.HGZGFH_WRXG:
                HVOU.HGZGFH_WRXG[OZHG_IVHFOG] = []
            HVOU.HGZGFH_WRXG[OZHG_IVHFOG].ZKKVMW(ZOKSZ)

    WVU XLNKROV(HVOU):
        IVG = 'ZOKSZ HGZGFH:\M'
        ULI P, E RM HVOU.HGZGFH_WRXG.RGVNH():
            IVG += '%-1H: %5W\M'%(P, OVM(E))
        IVGFIM IVG


XOZHH HGPZOKSZNVGZ(dZGXSVI):
    WVU __RMRG__(HVOU, MLWV, TOLYZO_RMUL, ZMWILNVWRZ):
        HFKVI(HGPZOKSZNVGZ, HVOU).__RMRG__(MLWV, TOLYZO_RMUL)
        HVOU.ZMWILNVWRZ = ZMWILNVWRZ
        HVOU.MVGDLIP = mVGDLIP()
        HVOU.MVGDLIP.MZNV('ZOKSZNZM')
        HVOU.KLHGXORVMG = kLHGxORVMG('89.81.9.898', 49995)
        HVOU.MVGDLIP.HVIEVI(HVOU.KLHGXORVMG)
        HVOU.ZOKSZ_HGZG  = zOKSZhGZG(HVOU.MVGDLIP)
# KIRMG(FKWZGV_MLWVH)

    WVU DLIP(HVOU):
        HVOU.MVGDLIP.IVOLZW()
        HVOU.ZOKSZ_HGZG.IVOLZW()
        ULI P, E RM HVOU.MVGDLIP.MLWVH.RGVNH():
            RU 'NVGZ' RM P:
                ZMXVHGLIH = HVOU.MVGDLIP.ZMXVHGLIH(P)
                ULI ZMH RM ZMXVHGLIH:
                    HVOU.ZOKSZ_HGZG.ZWW(ZMH)
        IVG = HVOU.ZOKSZ_HGZG.XLNKROV()
        KI = KLHG_DZIMRMT('YUZM', 'ZOKSZNZM', IVG, 6)
        # KIRMG(KI)
        # KIRMG(IVG)
        # KIRMG(HVOU.MVGDLIP)
//##**---------------- ./HGZIUOVVG/NLWFOVH/ZMWILNVWRZ/ZMWILNVWRZ.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/' + evihrlm + '/KBGSLM-ORYH')
RNKLIG GRNV
RNKLIG LH
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
# RNKLIG QHLM
# UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
RNKLIG RNK
RNKLIG WZGVGRNV

WVU RNKLIG_DZGXSVI(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'DZGXSVIH') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)



XOZHH ZMWILNVWRZ(nLWFOV):
    '''IVHKLMHRYOV ULI IVXVRERMT GIRTTVIH LI WZGZ
    '''

    WVU __RMRG__(HVOU, MLWV, ILLG, TOLYZO_RMUL):
        '''XGLI.'''
        HVOU.ILLG = ILLG
        RU 'DZGXSVI_KZGS' RM MLWV.ZGGIRY:
            HVOU.KZGS = MLWV.ZGGIRY['DZGXSVI_KZGS']
        VOHV:
            HVOU.KZGS = './'
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ['ZMWILNVWRZ'] = {}
        HVOU.DZGXSVI_ORHG = []
        HVOU.DZGXSVI_KLLO = {}
        HVOU.OLZW()

    WVU OLZW(HVOU):
        ULI DZGXSVI_CNO RM HVOU.ILLG.URMW('DZGXSVIH').URMWZOO('DZGXSVI'):
            RU 'KZGS' RM DZGXSVI_CNO.ZGGIRY:
                KZGS = DZGXSVI_CNO.ZGGIRY['KZGS']
            VOHV:
                KZGS = LH.KZGS.QLRM(_XFIIVMG_ILLG, 'DZGXSVIH')
            NLWFOV = DZGXSVI_CNO.ZGGIRY['NLWFOV']
            # KIRMG(KZGS, NLWFOV)
            (XOZHHLK, WVHG_KZGS) = RNKLIG_DZGXSVI(NLWFOV, KZGS)
            DZGXSVI = XOZHHLK(DZGXSVI_CNO, HVOU.TOLYZO_RMUL, HVOU)
            DZGXSVI.__UROV__ = WVHG_KZGS
            DZGXSVI._NLWFOV = NLWFOV
            RU NLWFOV RM HVOU.DZGXSVI_KLLO:
                IZRHV eZOFVvIILI('DZGXSVI %H RH ZOIVZWB OLZWVW, UROV: %H, KIVE UROV: %H'%(DZGXSVI.NLWFOV, WVHG_KZGS, HVOU.DZGXSVI_KLLO[DZGXSVI.NLWFOV].__UROV__) )
            VOHV:
                HVOU.DZGXSVI_KLLO[DZGXSVI._NLWFOV] = DZGXSVI
            HVOU.OLTTVI.RMUL('[ZMWILNVWRZ] yllg OLZWVW DZGXSVI %H'%(NLWFOV))
            HVOU.DZGXSVI_ORHG.ZKKVMW(DZGXSVI)

    WVU KILXVHH_QLY(HVOU, QLY):
        KZHH




    WVU IFM(HVOU):
        DSROV gIFV:
            ULI DZGXSVI RM HVOU.DZGXSVI_ORHG:
                DZGXSVI.XSVXP_DLIP()
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/NLWFOVH/ZMWILNVWRZ/ZMWILSVOKVI/FGRO.KB
RNKLIG MVGDLIPC ZH MC
RNKLIG WZGVGRNV
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG
UILN YZHV.YZHV_LKVIZGRLM RNKLIG nVGILMLNV

XOZHH dZGXSVI(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO DZGXSVIH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.CNO = CNO
        RU 'IVTRLM' RM HVOU.CNO.ZGGIRY:
            HVOU.IVTRLM = HVOU.CNO.ZGGIRY
        VOHV:
            HVOU.IVTRLM = 'hhv'
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        RU 'RW' RM CNO.ZGGIRY:
            HVOU.RW = CNO.ZGGIRY['RW']
        VOHV:
            HVOU.RW = CNO.ZGGIRY['NLWFOV']
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.NVGILMLNV = nVGILMLNV(HVOU.RW,
                                   HVOU.TOLYZO_RMUL.VCXSZMTVNZMZTVI,
                                   HVOU.TOLYZO_RMUL.TVG_VCXSZMTV_XOLXP(HVOU.IVTRLM),
                                   HVOU.CNO,
                                   HVOU.TOLYZO_RMUL)
        RU HVOU.NVGILMLNV._NLWV == 'KZHHREV':
            IZRHV eZOFVvIILI('HLIIB, DZGXSVIH NFHG HVG VEVIB LI LMGRNV')

    WVU XSVXP_DLIP(HVOU):
        IVG = HVOU.NVGILMLNV.XSVXP()
        RU IVG :
            HVOU.DLIP()


WVU KLHG_DZIMRMT(FHVI, HFYQVXG, NVHHZTV, OVEVO):
    QHLMWZGZ = {'GIRTTVI_UFMXGRLM':'HGZIUOVVG_DZIMRMT', 'UFMXGRLM_ZITH':'WW'}
    QHLMWZGZ['UFMXGRLM_ZITH'] = {'NVHHZTV':NVHHZTV, 'OVEVO':OVEVO,'SLHG':FYRJFGRO.TVG_FYRJ_SLHG(),'WLNZRM':FYRJFGRO.TVG_FYRJ_WLNZRM(),
                                 'IVUVIVMXV':FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(4), 'gh':WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W-%s:%n:%h'),
                                 'ZFWRVMXV':FHVI, 'HFYQVXG':HFYQVXG}
    KZBOLZW = {'GBKV':'GIRTTVI'}
    XORVMG = kLHGxORVMG('89.81.9.898', 89118)
    XOR = XORVMG.KLHG('/', KZBOLZW, QHLMWZGZ)
    IVGFIM XOR

XOZHH mVGDLIP(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.MLWVH = {}
        HVOU.VEVMGH = {}
        HVOU.DLIPVIH = {}
        HVOU.TIZKS = MC.wRtIZKS()
        HVOU.ULXFH = mLMV
        HVOU.VEVMG = mLMV
        HVOU.DLIPVI = mLMV
        HVOU.KIVURC = ''

    WVU XOVZI(HVOU):
        HVOU.MLWVH.XOVZI()
        HVOU.VEVMGH.XOVZI()
        HVOU.DLIPVIH.XOVZI()
        HVOU.TIZKS.XOVZI()

    WVU MZNV(HVOU, RW):
        HVOU.RW = RW
        HVOU.KIVURC = '/KRKVORMV/%H'%HVOU.RW

    WVU HVIEVI(HVOU, KLHG_HVIEVI):
        HVOU.KLHG_HVIEVI = KLHG_HVIEVI

    WVU ZWW_MLWV(HVOU, MLWV, ZWW_TIZKS):
        HVOU.MLWVH[MLWV['RW']] = MLWV
        RU ZWW_TIZKS:
            HVOU.TIZKS.ZWW_MLWV(MLWV['RW'], ZGG=MLWV)


    WVU IVOLZW(HVOU):
        HVOU.XOVZI()
        W8 = WZGVGRNV.WZGVGRNV.MLD()
        FKWZGV_MLWVH = HVOU.FKWZGV_MLWV('ZOO', ZWW_TIZKS=gIFV)
        HVOU.KZIHV()
        FKWZGV_DLIPVI = HVOU.FKWZGV_DLIPVIH('ZOO')
        FKWZGV_VEVMG = HVOU.FKWZGV_VEVMGH('ZOO')
        W7 = WZGVGRNV.WZGVGRNV.MLD()
        KIRMG('hfxxvhhufoob zxjfrivw %W mlwvh, FHVW GRNV %H'%(OVM(HVOU.MLWVH ), W7-W8))

    WVU IVHVG(HVOU):
        HVOU.IVOLZW()
        HVOU.ULXFH = mLMV
        HVOU.VEVMG = mLMV
        HVOU.DLIPVI = mLMV

    WVU KZIHV(HVOU):
        ULI P, E RM HVOU.MLWVH.RGVNH():
            ULI M RM E['MVRTSYLFI']:
                HVOU.TIZKS.ZWW_VWTV(M, P)

    WVU FKWZGV_MLWV(HVOU, MLWV='ZOO', ZWW_TIZKS=uZOHV):
        RU MLWV == 'ZOO':
            XOR = HVOU.KLHG_HVIEVI.KLHG('%H/KRKVORMV/%H/QLYH'%(HVOU.KIVURC, HVOU.RW), {'GBKV':'JFVIB'})
            ULI P, E RM XOR['WZGZ'].RGVNH():
                HVOU.ZWW_MLWV(E, ZWW_TIZKS)
        VOHV:
            W8 = WZGVGRNV.WZGVGRNV.MLD()
            XOR = HVOU.KLHG_HVIEVI.KLHG('%H/KRKVORMV/%H/QLYH/%H'%(HVOU.KIVURC, HVOU.RW, MLWV), {'GBKV':'JFVIB'})
            ULI VEMG RM XOR['WZGZ']['VEVMGH']:
                RU VEMG.HKORG('@')[9] MLG RM HVOU.VEVMGH:
                    HVOU.FKWZGV_VEVMGH( VEMG.HKORG('@')[9] )
            HVOU.ZWW_MLWV(XOR['WZGZ'], ZWW_TIZKS)
            KIRMG('hfxxvhhufoob fkwzgvw mlwvh, FHVW GRNV %H'%(WZGVGRNV.WZGVGRNV.MLD()-W8))
        IVGFIM XOR['WZGZ']

    WVU ZMXVHGLIH(HVOU, MLWV):
        IVGFIM MC.ZMXVHGLIH(HVOU.TIZKS, MLWV)

    WVU WVHXVMWZMGH(HVOU, MLWV):
        # IVGFIM HVOU.TIZKS.HFXXVHHLIH(MLWV)
        IVGFIM MC.WVHXVMWZMGH(HVOU.TIZKS, MLWV)


    WVU FKWZGV_VEVMGH(HVOU, VEVMG='ZOO'):
        RU VEVMG == 'ZOO':
            XOR = HVOU.KLHG_HVIEVI.KLHG('%H/VEVMGH/'%HVOU.KIVURC, {'GBKV':'JFVIB'})
            ULI P, E RM XOR['WZGZ'].RGVNH():
                HVOU.VEVMGH[E['IZMWLN_RW']] = E
        VOHV:
            XOR = HVOU.KLHG_HVIEVI.KLHG('%H/VEVMGH/%H'%(HVOU.KIVURC, VEVMG), {'GBKV':'JFVIB'})
            HVOU.VEVMGH[XOR['WZGZ']['IZMWLN_RW']] = XOR['WZGZ']
        IVGFIM XOR['WZGZ']

    WVU FKWZGV_DLIPVIH(HVOU, DLIPVI='ZOO'):
        RU DLIPVI == 'ZOO':
            XOR = HVOU.KLHG_HVIEVI.KLHG('%H/DLIPVIH/'%HVOU.KIVURC, {'GBKV':'JFVIB'})
            ULI P, E RM XOR['WZGZ'].RGVNH():
                RU 'IZMWLN_RW' MLG RM E:
                    XLMGRMFV
                HVOU.DLIPVIH[E['IZMWLN_RW']] = E
        VOHV:
            XOR = HVOU.KLHG_HVIEVI.KLHG('%H/DLIPVIH/%H'%(HVOU.KIVURC, DLIPVI), {'GBKV':'JFVIB'})
            HVOU.DLIPVIH[XOR['WZGZ']['IZMWLN_RW']] = XOR['WZGZ']
        IVGFIM XOR['WZGZ']

    WVU FKWZGV_HGZGFH_QLY(HVOU, QLY, XSZMTV_ORHG):
        XOR = HVOU.KLHG_HVIEVI.KLHG('%H/'%HVOU.KIVURC, {'GBKV':'GIRTTVI'},
                                    {'GIRTTVI_UFMXGRLM':'XSZMTV_HGZGFH',
                                     'UFMXGRLM_ZITH':{'HFYQVXG':'QLY', 'RW':'%H'%QLY,
                                                      'XSZMTV_ORHG':XSZMTV_ORHG}})
        IVGFIM XOR

    WVU TVG_VCGVIMZO_OLT(HVOU, KZGS):
        XOR = HVOU.KLHG_HVIEVI.KLHG('%H/'%HVOU.KIVURC, {'GBKV':'GIRTTVI'},
                                    {'GIRTTVI_UFMXGRLM':'TVG_OLT',
                                     'UFMXGRLM_ZITH':{'GZITVG':KZGS.HKORG('&')[9],
                                                      'KZGS':KZGS.HKORG('&')[8]}})
        IVGFIM XOR


//##**---------------- ./HGZIUOVVG/NLWFOVH/NVIXFIB/NVIXFIB.KB
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG XLMURTKZIHVI ZH xLMURTkZIHVI
# RNKLIG LH
# RNKLIG KHFGRO
# RNKLIG HFYKILXVHH
# RNKLIG WZGVGRNV
# RNKLIG HRTMZO
# UILN GRNV RNKLIG HOVVK
RNKLIG HBH
RNKLIG QHLM
# RNKLIG LH
# RNKLIG GIZXVYZXP
# RNKLIG MVGDLIPC ZH MC
evihrlm = ''
UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
# RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
# RNKLIG QHLM
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
# RNKLIG MVGRUZXVH
RNKLIG GRNV
RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
# RNKLIG KRXPOV
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG


XOZHH NVIXFIB_WZGZ(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        KZHH

XOZHH sFY(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.VEVIB = RMG(CNO.ZGGIRY['VEVIB'])
        HVOU.RW = CNO.ZGGIRY['RW']
        HVOU.OZHG_GRNV = WZGVGRNV.WZGVGRNV.MLD()
        ZWW_ORHG = CNO.ZGGIRY['UILN'].HGIRK().HKORG('/')
        RU OVM(ZWW_ORHG) == 8:
            HVOU.GZITVG_FIO = '/'
        VOHV:
            HVOU.GZITVG_FIO  = '/' + '/'.QLRM(ZWW_ORHG[8:])
        HVOU.GZITVG_ZWWIVHH = ZWW_ORHG[9]
        HVOU.OLXZO_ZWWIVHH = CNO.ZGGIRY['GL']
        RU HVOU.OLXZO_ZWWIVHH=='/':
            IZRHV eZOFVvIILI('XZMMLG FHV ILLG ZWWIVHH')
        RU HVOU.OLXZO_ZWWIVHH[9] == '/':
            HVOU.OLXZO_ZWWIVHH = HVOU.OLXZO_ZWWIVHH[8:]
        OZWWVI = HVOU.OLXZO_ZWWIVHH.HKORG('/')
        HVOU.KLHG_WZGZ = HVOU.TOLYZO_RMUL.VCKLIG_KLHG_WZGZ
        ULI RGVN RM OZWWVI:
            RU RGVN MLG RM HVOU.KLHG_WZGZ:
                HVOU.KLHG_WZGZ[RGVN] = {}
            HVOU.KLHG_WZGZ = HVOU.KLHG_WZGZ[RGVN]
        HVOU.XORVMG = kLHGxORVMG(HVOU.GZITVG_ZWWIVHH.HKORG(':')[9], RMG(HVOU.GZITVG_ZWWIVHH.HKORG(':')[8]))
            #XOR = XORVMG.KLHG(ZITFNVMGH, KZBOLZW)
        HVOU.KZBOLZW = {'GBKV':'JFVIB'}
        HVOU.ZITFNVMG = HVOU.GZITVG_FIO
        HVOU.OLTTVI.RMUL('[sfy yllg] OLZWVW SFY %H, FIO:%H'%(HVOU.RW, HVOU.GZITVG_FIO))
        HVOU.URIHG_GRNV  = gIFV
        HVOU.OZHG_HGZGFH = gIFV

    WVU IFM(HVOU, MLD):
        RU MLG HVOU.OZHG_HGZGFH LI (MLD - HVOU.OZHG_GRNV).GLGZO_HVXLMWH() > HVOU.VEVIB LI HVOU.URIHG_GRNV:
            HVOU.URIHG_GRNV = uZOHV
            HVOU.OLTTVI.RMUL('%H IFMH'%HVOU.RW)
            HVOU.OZHG_GRNV = MLD
            XOR = HVOU.XORVMG.KLHG(HVOU.ZITFNVMG, HVOU.KZBOLZW)
            RU RHRMHGZMXV(XOR, HGI):
                IVG = QHLM.OLZWH(XOR)
                RU HGI(IVG['XLWV']) != '799':
                    HVOU.OLTTVI.VIILI(HGI(XOR))
                    HVOU.OZHG_HGZGFH = uZOHV
                VOHV:
                    HVOU.KLHG_WZGZ = IVG['WZGZ']
                    HVOU.OZHG_HGZGFH = gIFV
            VOHV:
                #KIRMG(XOR['WZGZ'])
                RU 'WZGZ' MLG RM XOR:
                    HVOU.OZHG_HGZGFH = uZOHV
                    IVGFIM
                HVOU.KLHG_WZGZ.XOVZI()
                RU RHRMHGZMXV(XOR['WZGZ'], ORHG):
                    HVOU.KLHG_WZGZ['ORHG'] = XOR['WZGZ']
                VOHV:
                    ULI P, E RM XOR['WZGZ'].RGVNH():
                        HVOU.KLHG_WZGZ[P] = E
                HVOU.OZHG_HGZGFH = gIFV

XOZHH NVIXFIB(nLWFOV):
    WVU __RMRG__(HVOU, CNO, ILLG, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.ILLG = ILLG.TVGILLG()
        HVOU.SFY_ORHG = []
        ULI CNO RM HVOU.ILLG.URMW('KLHGSFYH').URMWZOO('SFY'):
            SFY = sFY(CNO, TOLYZO_RMUL)
            HVOU.SFY_ORHG.ZKKVMW(SFY)
        # HVOU.GZT = CNO.ZGGIRY['GZT']
        # HVOU.YILZWXZHG_IZMTV = CNO.ZGGIRY['IZMTV']
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        # HVOU.TOLYZO_RMUL.IVTRHGVI_WLXPVI_QLY(HVOU.KILXVHH_QLY)

        # MVDPVB = ihz.TVMVIZGV(7951)
        # IVJFVHG = WLXPVI_KY7.qLYiVJFVHG()
        # IVJFVHG.XLNNZMW = 'JFVIB_KZHHDLIW&GZITVG=ZOKSZNZM'
        # KFYPVB = MVDPVB.KFYORXPVB().VCKLIGpVB('wvi')
        # IVJFVHG.QLY = KFYPVB
        # IVG = HVOU.KILXVHH_QLY(IVJFVHG)
        # WZGZ = MVDPVB.WVXIBKG(IVG.WZGZ).WVXLWV()
        # KIRMG(WZGZ)


    # WVU KILXVHH_QLY(HVOU, QLY):
        # RU QLY.XLNNZMW.HKORG('&')[9] == 'JFVIB_NZRMYZHV_KZHHDLIW':
            # GZITVG = QLY.XLNNZMW.HKORG('&')[8].HKORG('=')[8]
            # KFY_PVB = ihz.RNKLIGpVB(QLY.QLY)
            # HVHH = HVOU.tVGhVHHRLM()
            # ILD =  HVHH.JFVIB(kZHHDLIWgZYOV).UROGVI(kZHHDLIWgZYOV.fHVI == GZITVG).LMV()
            # RU ILD RH mLMV:
                # IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=uZOHV, NVHHZTV='XZMMLG ULFMW %H'%GZITVG)
                # IVGFIM IVG
            # HVOU.OLTTVI.RMUL('[NVIXFIB] JFVIB KZHHDLIW LU %H'%GZITVG)
            # WZGZ = ILD.kZHHDW
            # VMXIBKGVW = KFY_PVB.VMXIBKG(WZGZ.VMXLWV(), 'C')[9]
            # IVG = WLXPVI_KY7.qLYiVKOB(HGZGFH=gIFV, NVHHZTV='tllw', WZGZ=VMXIBKGVW)
            # HVHH.XOLHV()
            # IVGFIM IVG


    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL('[NVIXFIB] IVZWB GL IVWRIVXG %W SFYH'%OVM(HVOU.SFY_ORHG))

        DSROV MLG HVOU.TOLYZO_RMUL.HBHGVN_VCRG:
            ULI SFY RM HVOU.SFY_ORHG:
                SFY.IFM(WZGVGRNV.WZGVGRNV.MLD())
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/HGZIZGVTB/hRNKOBhGPhGIZGVTB.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG KBKFYHFY ZH KY

XOZHH hRNKOBhGPhGIZGVTB(hGPlKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL, VEVMGYFH):
        HFKVI(hRNKOBhGPhGIZGVTB, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.VEVMGYFH = VEVMGYFH
        HVOU.VEVMGYFH.ZWW_ORHGVMVI(HVOU)
        HVOU.kFY = KY.hGPhRTMZOkFYORHSVI()
        HVOU.IVOLZW()

    WVU IVOLZW(HVOU):
        HFKVI(hRNKOBhGPhGIZGVTB, HVOU).IVOLZW()
        VEVMG.NVHHZTV = []

    WVU DLIP(HVOU, VEVMG):
        # VEVMG = vEVMG(vevmg.)
        # HVOU.VEVMGYFH.KFYORHS_VEVMG()
        ULI HRT RM VEVMG.NVHHZTV:
            HRT = KY.hGPhRTMZO()
            HRT.hRTMZOrW = "gvhg"
            HVOU.kFY.kFYORHS(HRT)

//##**---------------- ./HGZIUOVVG/VGX/NZMZTVNVMG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<NZMZTVNVMG>

<OLT OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT" />

<FGIZWV_HGIZGVTB_HXSVWFOVH>
    <HXSVWFOV LM_GRNV="83:82" ZXGRLM="ZXGREZGV" GZITVG="FGIZWV_ZZZ" HGIZGVTB="HG7" />
</FGIZWV_HGIZGVTB_HXSVWFOVH>



<QLYH>
    <QLY GBKV="YZHS" KILTIZN="OH"
        HXSVWFOV="86:99-85:99,79:99-78:78" LM_WZB="xaxv^wxv^xuuvc^hsuv"  />
    <QLY GBKV="KBGSLM" KILTIZN="OH"
        VEVIB="6H" LM_WZB="xaxv^wxv^xuuvc^hsuv"  />
</QLYH>


</NZMZTVNVMG>
//##**---------------- ./HGZIUOVVG/VGX/GVHG_NLMRGLIHBHGVN.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<GVHG_NLMRGLI YIRWTV='49844'>
    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />

    <NLWFOVH>
        <NLWFOV RW="NLMRGLIHBHGVN" />
    </NLWFOVH>

    <XLNKLMVMGH>
        <HGZIUOVVG KLHHVHH="uZOHV" KBGSLM="gIFV" RM_GIFHG="gIFV" >
            <RW EZOFV="XZMZIB_GVHG" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HGZIUOVVG/HGZIUOVVG.KB" />
            <XLMURT EZOFV="VGX/GVHG_XZMZIB.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="0:70:99">
            </GRNV>
        </HGZIUOVVG>
    </XLNKLMVMGH>

</GVHG_NLMRGLI>
//##**---------------- ./HGZIUOVVG/VGX/GVHG_XZMZIB.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<XZMZIB_GVHG XORVMG='/LKG/EVIHRLM/${evihrlm}/XZMZIB'>

    <OLT  OVEVO="WVYFT" OLTUROV="XZMZIB_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />

    <NLWFOVH>
        <NLWFOV RW="XZMZIB" />
    </NLWFOVH>

    <NLMRGLIH HOVVK_KVI_ILFMW="8">
    </NLMRGLIH>

</XZMZIB_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/FHRNGVHG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG_GVHG YIRWTV="4998">

    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" KIRMGML="UZOHV" />
<!--    <IVXLIWVI GBKV="WY" /> -->

    <NLWFOVH>
        <NLWFOV RW="NLMRGLIHBHGVN" />
        <NLWFOV RW="WLXPVI"/>
    </NLWFOVH>
    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="86:87:69">
    <WVKVMWVMXRVH>
    </WVKVMWVMXRVH>
    </LKVIZGRLMH>

    <XLNKLMVMGH>
         <FHRN  XDW="/DLIP/ZOKSZNZM/CORF/tILFK_WVE" RM_GIFHG="gIFV" LM_WZB="hsuv" KLHHVHH="uZOHV" KBGSLM="uZOHV">
              <RW EZOFV="CORF_tILFK_WVE"/>
              <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/FHRN/FHRN-WVE/FHRN"/>
              <XLMURT EZOFV="/DLIP/ZOKSZNZM/CORF/tILFK_WVE/DLIP.CNO"/>
              <GRNV HGZIG="1:49" HGLK="84:99">
                <LM_YLLG_UZROVW NLWFOV="FHRNGVHG" VEVIB="7H"/>
              </GRNV>
              <GRNV HGZIG="79:69" HGLK="7:69"/>
              <GRNV ZITH="-U" HGZIG="83:69" HGLK="82:89N">
              </GRNV>
         </FHRN>
    </XLNKLMVMGH>


</HGZIUOVVG_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/FYRJWMH.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<FYRJWMH_GVHG>
    <OLT  OVEVO="WVYFT" OLTUROV="WMH_${bbbbnnww}.OLT"  KIRMG="GIFV" KIRMGML="UZOHV" />
    <NLWFOVH>
        <NLWFOV RW="FYRJWMH"    KLHG_HVIEVI="89.81.9.876:39997"/>
    </NLWFOVH>
</FYRJWMH_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/KOZXV_SLOWVI_HGZIUOVVG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG_GVHG>
    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />

    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="86:87:69">
        <LKVIZGRLM RW='WL_VCRG'  NLWFOV="WL_VCRG" VEVIB="8H" VCXVKGRLM="UZOHV" IVGFIM="-8" />
    </LKVIZGRLMH>

</HGZIUOVVG_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/XIBHGZO.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<XIBHGZO_HVIEVI HVIEVI="WVNL" XORVMG='.' KZGS="">

    <OLT  OVEVO="WVYFT" OLTUROV="XIBHGZO_${bbbbnnww}.OLT"  KIRMG="GIFV" KIRMGML="UZOHV" />

    <NLWFOVH>
        <NLWFOV RW="XIBHGZO" FHVI="LK" KZHHDW="" />
    </NLWFOVH>


</XIBHGZO_HVIEVI>
//##**---------------- ./HGZIUOVVG/VGX/WZGZUOVVG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<WZGZUOVVG_8 XORVMG='./' YLLGHGIZK_IVHGZIG="86:91">

    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />
    <IVXLIWVI NLWFOV="wyiVXLIWVI" />
    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="8:70:99">
        <TILFK RW='qb'>
            <LKVIZGRLM RW='LK8' NLWFOV="WZGZ_WVNL" GRNV_IZMTV="76:79-80:79" VEVIB_GL_HFXXVHH="7H"
                IVOLZW="6:99,88:58:89"  MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>
            <LKVIZGRLM RW='LK7' NLWFOV="WZGZ_WVNL" GRNV_IZMTV="76:79-80:79" VEVIB_GL_HFXXVHH="7H" LM_WZB="gSFI|uir"
                IVOLZW="6:99,4:59" MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>

            <LKVIZGRLM RW='LK5' IVTRLM='xm' NLWFOV="WZGZ_WVNL" LM_GRNV="79:99"
                IVOLZW="6:99,4:59" MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>

            <LKVIZGRLM RW='LK4' IVTRLM='xm' NLWFOV="WZGZ_WVNL" VEVIB="7H"
                IVOLZW="6:99,4:59" MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>

        </TILFK>
        <LKVIZGRLM RW='LK6' IVTRLM="sp" NLWFOV="WZGZ_WVNL" GRNV_IZMTV="76:79-80:79" VEVIB_GL_HFXXVHH="7H" LM_WZB="dvw|uir" IVOLZW="6:99,4:59"  MVD_GSIVZW="GIFV" >
        </LKVIZGRLM>

    <LKVIZGRLM_WVKVMWVMXRVH>
        <WVKVMWVMXB  HFYQVXG="LK8"  WVKVMWVMXRVH="LK7,LK6" />
        <!--<WVKVMWVMXB  HFYQVXG="LK7"  WVKVMWVMXRVH="LK6" />-->
    </LKVIZGRLM_WVKVMWVMXRVH>


    </LKVIZGRLMH>


    <GZHPH>
    </GZHPH>

</WZGZUOVVG_8>
//##**---------------- ./HGZIUOVVG/VGX/HGZIUOVVGWVNL.CNO
<?CNO EVIHRLM="8.9" ?>
<URCVW YIRWTV='49955' KLHG_HVIEVI="OLXZOSLHG:39998">
     <XKF XLIV="7,6" NLWV="NZMFZO"/>
     <OLT OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT" KIRMG="GIFV" KIRMGML="UZOHV"/>
     <NLWFOVH>
          <NLWFOV RW="WLXPVI" KLIG="49950"/>
          <NLWFOV RW="SZIWDZIVRMUL"/>
          <NLWFOV RW="NLMRGLIHBHGVN"/>
          <NLWFOV RW="EVIHRLMXLMGILO"/>
     </NLWFOVH>
     <LKVIZGRLMH IVOLZW="82:99:69" HOVVK_KVI_ILFMW="8H">
          <WVKVMWVMXRVH>         </WVKVMWVMXRVH>
     </LKVIZGRLMH>
     <XLNKLMVMGH>
        <NZHHIVOZB KLHHVHH="uZOHV" RM_GIFHG="uZOHV">
            <RW EZOFV="NZHHIVOZBG" />
            <KILTIZN EZOFV="/LKG/NZHHIVOZB/YRM/NZHHIVOZB" />
            <XLMURT EZOFV="/LKG/NZHHIVOZB/VGX/NZHHIVOZB.CNO"/>
        </NZHHIVOZB>
     </XLNKLMVMGH>
</URCVW>
//##**---------------- ./HGZIUOVVG/VGX/HGZIUOVVGYZHV.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG_GVHG>

    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />
    <HGZGHW SLHG="HS.FYRJFZMG.XLN" KLIG="1874" IVKLIG_HVOU="UZOHV"/>
<!--    <IVXLIWVI GBKV="WY" /> -->

    <NLWFOVH>
        <NLWFOV RW="NZRMYZHV" IZMTV='*' GZT='YVRQRMT' WY_ZWWIVHH='' WY_FHVI='' WY_KZHHDW='' />
        <NLWFOV RW="WLXPVI" ALWRZX="89.81.9.808:89918" />
        <NLWFOV RW="SZIWDZIVRMUL" />
    </NLWFOVH>

    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="86:87:69">
        <WVKVMWVMXRVH>
        </WVKVMWVMXRVH>
    </LKVIZGRLMH>

</HGZIUOVVG_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/HGZIUOVVGVCZNKOV.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG_GVHG>

    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />

    <NLWFOVH>
        <!--<NLWFOV RW="WLXPVI" />-->
        <!--<NLWFOV RW="SZIWDZIVRMUL" />-->
        <!--<NLWFOV RW="NLMRGLIHBHGVN" />-->
    </NLWFOVH>



    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="86:87:69">
        <LKVIZGRLM RW='WFNNB'  NLWFOV="wFNNBlK" VEVIB="8H" />
        <LKVIZGRLM RW='WFNNB7' NLWFOV="wFNNBlK" VEVIB="8H" />
        <WVKVMWVMXRVH>
        </WVKVMWVMXRVH>
    </LKVIZGRLMH>



    <XLNKLMVMGH>

        <!--<HVXFIRGBNZMZTVI KLHHVHH="uZOHV" >-->
            <!--<RW EZOFV="HVXFIRGBNZMZTVI" />-->
            <!--<KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HVXFIRGBNZMZTVI/YRM/HVXFIRGBNZMZTVI" />-->
            <!--<XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>-->
            <!--<GRNV HGZIG="81:99:99" HGLK="81:99:99"/>-->
        <!--</HVXFIRGBNZMZTVI>-->

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_TCY" />
            <!--RW EZOFV="FGIZWV_KGZMT" /-->
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
            <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="85:45:99"/>
        </FGIZWV>

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_JH7" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
             <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="85:45:99"/>
        </FGIZWV>

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_ITIZGV" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
             <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_AM" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
             <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_BQ" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
             <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_BQ8" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
             <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>


    </XLNKLMVMGH>


</HGZIUOVVG_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/GVHG_XOLHV_LK.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<GVHG_LK>
    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />

    <NLWFOVH>
        <NLWFOV RW="NLMRGLIHBHGVN" />
    </NLWFOVH>

    <XLNKLMVMGH>
        <HGZIUOVVG KLHHVHH="uZOHV" KBGSLM="gIFV" RM_GIFHG="gIFV" >
            <RW EZOFV="HGZIUOVVG_GVHG" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HGZIUOVVG/HGZIUOVVG.KB" />
            <XLMURT EZOFV="VGX/KOZXV_SLOWVI_HGZIUOVVG.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="0:70:99" IVHGZIG_KLORXB="RNNVWRZGV_RU_XSVXPVW">
                <LM_UZROVW RW="GVHG" NLWFOV="ELRWXSVXP" />
            </GRNV>
        </HGZIUOVVG>
    </XLNKLMVMGH>


</GVHG_LK>
//##**---------------- ./HGZIUOVVG/VGX/YLLGHGIZK.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG YLLGHGIZK_IVHGZIG="98:83:99">

    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" KIRMGML="UZOHV" />
    <HGZGHW SLHG="HS.FYRJFZMG.XLN" KLIG="1874" IVKLIG_HVOU="UZOHV"/>
<!--    <IVXLIWVI GBKV="WY" /> -->

    <NLWFOVH>
        <NLWFOV RW="NLMRGLIHBHGVN" />
    </NLWFOVH>
    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="86:87:69">

        <!--<LKVIZGRLM RW='WFNNB'  NLWFOV="wFNNBlK" VEVIB="8H" />-->
        <!--<LKVIZGRLM RW='WFNNB7' NLWFOV="wFNNBlK" VEVIB="8H" />-->

        <!--
        <LKVIZGRLM RW='hGLXPhVXFIRGBnZMZTVIiVZWB' NLWFOV="hGLXPhVXFIRGBnZMZTVIiVZWB" VEVIB="8H" />
        -->
        <!--<TILFK RW='gVHG'>-->
            <!--<LKVIZGRLM RW='hGPkLHRGRLMHwFNKgLuROV' NLWFOV="hGPkLHRGRLMHwFNKgLuROV" UROVMZNV="/GNK/CTzgVHG_KLH_79829881.XHE" ZXXLFMGRW="78199992241" VEVIB='89H' />-->
            <!--<LKVIZGRLM RW='xZOOhSVOO' NLWFOV="xZOOhSVOO" XNW="HXK /GNK/CTzgVHG_KLH_79829881.XHE SVWTV@FYRJYQ7:/WZG/KLH/CTzGVHG/79829881/CTzgVHG_KLH_79829881.XHE" VEVIB_GL_HFXXVHH="89H"/>-->
        <!--</TILFK>-->

        <!--<LKVIZGRLM RW='XZRGLMT_VNZRO' NLWFOV="xZRGLMTwZROBvNZRO" GRNV_IZMTV="7:79-76:79" VEVIB_GL_HFXXVHH="7H"-->
            <!--IVOLZW="6:99,4:59"  MVD_GSIVZW="GIFV" VNZRO_GL="YUZM@FYRJFZMG.XLN" KZGS="/SLNV/YUZM/rMHVIGlIWVI_${bbbbnnww}"  >-->
        <!--</LKVIZGRLM>-->
        <!--<LKVIZGRLM  NLWFOV="lIWVIgIZUURXxLMGILO" NZC_LIWVI_KVI_HVXLMW="89" VEVIB="8H"  MVD_GSIVZW="UZOHV" >--> <!--<ZXX ZXXLFMG="XXWW" LIWVIHKVVW="39"/>-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="hGZIGfGIZWVhGIZGVTBlMgRNV" VEVIB="8H">-->
            <!--<HXSVWFOVCNO KZGS="/RMX/YUZM/NZMZTVNVMG.CNO"/>-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="xFHGLNqLYH" VEVIB="8H">-->
            <!--<QLYCNO KZGS="/FYRJ/QLYH/YUZM/NZMZTVNVMG.CNO"/>-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="gIZWRMThBHGVNwZROBiVKLIG" LM_GRNV="84:79:49"-->
            <!--VNZRO_GL="YUZM@FYRJFZMG.XLN,KGZMT@FYRJFZMG.XLN,XDZMT@FYRJFZMG.XLN,CTFL@FYRJFZMG.XLN,QDZMT@FYRJFZMG.XLN,BDZMT@FYRJFZMG.XLN">-->
                <!--<NZXSRMV  RW="ACAQ8" FHVIMZNV="YUZM" KZHHDLIW="CCCC" />-->
                <!--[>[><NZXSRMV  RW="ACAQ7" FHVIMZNV="YUZM" KZHHDLIW="CCCC" /><]<]-->
                <!--[>[><NZXSRMV  RW="SGAQ8" FHVIMZNV="YUZM" KZHHDLIW="CCCC"/><]<]-->
                <!--[>[><NZXSRMV  RW="CAAQ8" FHVIMZNV="YUZM" KZHHDLIW="CCCC"/><]<]-->
                <!--[><SUG RW="SGBW8" FHVIMZNV="YUZM" KZHHDLIW="CCCC" /><]-->
                <!--[>[><SUG RW="SGHJ7" FHVIMZNV="YUZM" KZHHDLIW="CCCC" /><]<]-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="gIZUURXoRTSG" VEVIB="6H" MVD_GSIVZW="UZOHV" RM_HVHHRLM="xaxv^wxv">-->
            <!--<DZREV GZITVG="HBHGVNVBV,NZIPVGVBV, HBHGVNVBVG" />-->
            <!--<GZITVG RW="FGIZWV_ZZZ" IVWORTSG="91:99, 79:99"> <XSVXP NLWFOV="hVXFIRGBnZMZTVIiVZWB"/>-->
                <!--<XSVXP NLWFOV="kLHRGRLMHxSVXPiVZWB" KZGS="/WZG/ZXXLFMGVBV/xSVXPkLHRGRLM/" />-->
                <!--<XSVXP NLWFOV="gyxSVXPiVZWB"/>-->
            <!--</GZITVG>-->
        <!--</LKVIZGRLM>-->
    <WVKVMWVMXRVH>
    </WVKVMWVMXRVH>


    </LKVIZGRLMH>



    <XLNKLMVMGH>

        <KFYHFY KLHHVHH="gIFV" >
            <IVHGZIG KILTIZN='/LKG/EVIHRLM/${evihrlm}/YRM/IVHGZIGkFYhFYhVIERXV'
                CNO='VGX/XLNKLMVMGH/KFYHFYHVIERXV.CNO'/>
            <YILPVI KILTIZN='/LKG/EVIHRLM/${evihrlm}/YRM/YILPVI'
                CNO='VGX/XLNKLMVMGH/YILPVI.CNO' />
        </KFYHFY>

        <HVXFIRGBNZMZTVI KLHHVHH="uZOHV" >
            <RW EZOFV="HVXFIRGBNZMZTVI" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HVXFIRGBNZMZTVI/YRM/HVXFIRGBNZMZTVI" />
            <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="81:99:99" HGLK="81:99:99"/>
        </HVXFIRGBNZMZTVI>

        <!--<NZIPVGVBV KLHHVHH="gIFV" RM_GIFHG="uZOHV">-->
            <!--<RW  EZOFV="NZIPVGVBV"/>-->
            <!--<KILTIZN EZOFV="/LKG/NZIPVGVBV/YRM/NZIPVGVBV" />--> <!--<XLMURT EZOFV="NZIPVGVBV.CNO"/>-->
        <!--</NZIPVGVBV>-->


         <HBHGVNVBV KLHHVHH="uZOHV" RM_GIFHG="gIFV">
            <XSVXPLKH VGZ="89N">
                <XSVXPLK NLWFOV="ELRWXSVXP" />
            </XSVXPLKH>
             <RW EZOFV="HBHGVNVBV_GVHG" />
             <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HBHGVNVBV/YRM/HBHGVNVBV" />
             <XLMURT EZOFV="VGX/XLNKLMVMGH/HBHGVNVBV.CNO"/>
             <GRNV HGZIG="0:99:99" HGLK="0:99:99"/>
         </HBHGVNVBV>

        <!--<NZHHIVOZB KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="NZHHIVOZB" />-->
            <!--<KILTIZN EZOFV="/LKG/NZHHIVOZB/YRM/NZHHIVOZB" />-->
            <!--<XLMURT EZOFV="/LKG/NZHHIVOZB/VGX/NZHHIVOZB.CNO"/>-->
        <!--</NZHHIVOZB>-->

        <!--<gy KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="gy" />-->
            <!--<KILTIZN EZOFV="/LKG/WVE/YRM/gy" />-->
            <!--<XLMURT EZOFV="XGK_XLMURT.CNO"/>-->
            <!--[><GRNV HGZIG="0:84:99" HGLK="0:79:99"/><]-->
            <!--[><GRNV HGZIG="78:99:99" HGLK="7:69:99"/><]-->
        <!--</gy>-->



        <!--<ZXXLFMGVBV KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="ZXXLFMGVBV" />-->
            <!--<KILTIZN EZOFV="/LKG/ZXXLFMGVBV/YRM/ZXXLFMGVBV" />-->
            <!--<XLMURT EZOFV="ZXXLFMGVBV.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="7:69:99"/>-->
        <!--</ZXXLFMGVBV>-->


        <!--<FHRN KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="FHRN-XGZ" />-->
            <!--<KILTIZN EZOFV="/LKG/FHRN/FHRN-WVE/FHRN" />-->
            <!--<XLMURT EZOFV="FHRN-XGZ.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="7:69:99"/>-->
        <!--</FHRN>-->

        <!--<FHRN KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="FHRN_XILHH" />-->
            <!--<KILTIZN EZOFV="/LKG/FHRN/FHRN-WVE/FHRN" />-->
            <!--<XLMURT EZOFV="/WZG/DLIP/YUZM/ILLN6/FHRN-XILHH.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="7:69:99"/>-->
        <!--</FHRN>-->

        <!--<FGIZWV KLHHVHH="uZOHV" RM_GIFHG="gIFV"  LM_WZB="xaxv|hsuv">-->
            <!--<RW EZOFV="FGIZWV_ZZZ" />-->
            <!--<KILTIZN EZOFV="/SLNV/YUZM/KILQVXG/FGIZWV/YRM/FGIZWV" />-->
            <!--<XLMURT EZOFV="/SLNV/YUZM/KILQVXG/FGIZWV/VGX/XGZ.CNO"/>-->
            <!--<GRNV HGZIG="87:50:99" HGLK="87:49:99"/>-->
            <!--[>[><GRNV HGZIG="78:99:99" HGLK="7:69:99"/><]<]-->
        <!--</FGIZWV>-->

    </XLNKLMVMGH>


</HGZIUOVVG>
//##**---------------- ./HGZIUOVVG/VGX/HGZIUOVVG.RMX
ivwhsrug_rmx=-r/LKG/EVIHRLM/${xlnkrov_evihrlm}/HGZIUOVVG/XKK -r/LKG/6IW/TIKX/RMXOFWV  -r/LKG/6IW/KILGLYFU6/RMXOFWV
ivwhsrug_ory=-o/LKG/EVIHRLM/${xlnkrov_evihrlm}/HGZIUOVVG/ORY -o/LKG/6IW/KILGLYFU6/ORY/ -dO,-IKZGS=/LKG/EVIHRLM/${xlnkrov_evihrlm}/HGZIUOVVG/ORY -dO,-IKZGS=/LKG/6IW/KILGLYFU6/ORY/ -o/LKG/6IW/TIKX/ORY -dO,-IKZGS=/LKG/6IW/TIKX/ORY  -OHGZIUOVVGXORVMG -OHGZIUOVVG -OKILGLYFU -OTIKX -OTIKX++
//##**---------------- ./HGZIUOVVG/VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO
<?CNO EVIHRLM="8.9" ?>
<HVXFIRGBNZMZTVI DZREVW="GIFV" >
    <OLT OVEVO="RMUL" HSN="HVXFIRGBNZMZTVI" OLTUROV="/FYRJ/OLT/HVXFIRGBNZMZTVI_${bbbbnnww}.OLT" KIRMG="UZOHV" KIRMGML="UZOHV" XLFMG="89999" />
    <GRNVI NLWV="WRHZYOV" FKWZGV="898FH" />

    <WZGFN>
        <!--HGZGHW SLHG="89.81.9.877" KLIG="1874" /-->
    </WZGFN>

    <DLIPUOLD NLWFOV="dLIPUOLDwVNL" hOVVKkVIiLFMW="89H">
        <HGIZGVTB NLWFOV="hGIZGVTBwVNL" RW="8" >
            <LKVIZGRLM  NLWFOV="lKhGLXPgIZWRMTwZBH"   KZGS="/WZG/ZOO/vJFRGB/ORHG/GIZWVWZBH.GCG"   WVORNRGVI=","/>
            <LKVIZGRLM  NLWFOV="lKgIZWRMThVHHRLM"   UFGFIVHKZGS="/WZG/ZOO/uFGFIVH/ORHG/UFGKILUROV.GCG" HGLXPKZGS="/WZG/ZOO/vJFRGB/ORHG/HGPKILUROV.GCG"   WVORNRGVI=","/>
            <LKVIZGRLM  NLWFOV="lKiVTRLMrMUL"   UROVKZGS="/RMX/IVTRLM.CNO"  WVORNRGVI=","/>
            <LKVIZGRLM  NLWFOV="lKvCXSZMTVgIZWRMTwZBH"   UROVKZGS="/RMX/IVTRLM.CNO" WRIVXGLIB="/WZG/ZOO/vJFRGB/ORHG"  WVORNRGVI=","/>
            <LKVIZGRLM  NLWFOV="lKkILWFXGxLMHGRGFVMG"   KZGS="/RMX/KILWFXG.XHE"  WVORNRGVI=","/>

            <LKVIZGRLM  NLWFOV="lKvCXSZMTVrMUL"   UROVKZGS="/RMX/VCXSZMTV.CNO"  WVORNRGVI=","/>
            <LKVIZGRLM NLWFOV="lKuFGFIVHgIZWRMTwZBH"   KZGS="/WZG/ZOO/uFGFIVH/ORHG/GIZWVWZBH.GCG"   WVORNRGVI=","/>
            <LKVIZGRLM NLWFOV="lKuFGFIVHxLNNRHHRLMrMUL"   KZGS="/WZG/ZOO/uFGFIVH/ORHG/UFGKILUROV.GCG"   WVORNRGVI=","/>
            <LKVIZGRLM NLWFOV="lKuFGFIVHmRTSGsLORWZB"   KZGS="/WZG/ZOO/uFGFIVH/ORHG/MLMRTSG.GCG"   WVORNRGVI=","/>
            <LKVIZGRLM NLWFOV="lKlKGRLMrMUL"
                KZGS="/WZG/ZOO/lKGRLM/dRMW/KILUROV/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG" WVORNRGVI="|" />
            <LKVIZGRLM NLWFOV="lKhGLXPrMUL"
                KZGS="/WZG/ZOO/vJFRGB/fyrj/wZROB/hGLXP/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG" WVORNRGVI="|" />
            <LKVIZGRLM NLWFOV="lKcqkhGLXPrMUL"
                KZGS="/WZG/ZOO/vJFRGB/gijz/wZROB/wZGZHGIVZN/cqkhGLXP/WZGZ/${bbbb}/${nn}/${ww}/HN_${bbbb}-${nn}-${ww}.GCG" WVORNRGVI="|" />
            <!--<LKVIZGRLM NLWFOV="lKaVFHkZXPVGhGIFXGFIV" UROVKZGS="/RMX/AVFH_ZKR.CNO" WVORNRGVI="|" />-->

            <LKVIZGRLM NLWFOV="lKrMWVCrMUL"
                KZGS="/WZG/ZOO/vJFRGB/fyrj/wZROB/rMWVC/ZOO/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG" WVORNRGVI="|" />
            <LKVIZGRLM NLWFOV="lKuFGFIVHrMUL" KZGS="/WZG/ZOO/uFGFIVH/KILUROV/WZGZ/${bbbb}/${nn}/${ww}/RMHGIFNVMG_${bbbbnnww}.XHE"  WVORNRGVI="," LEVIMRTSG="GIFV"/>
            <LKVIZGRLM NLWFOV="lKkFYHFYxSVXP" />
        </HGIZGVTB>

    </DLIPUOLD>


    <NLWFOVH>
        <NLWFOV RW="dLIPUOLDwVNL" GBKV="DLIPUOLD" KZGS="${ORYKZGS}/ORYWVNLDLIPUOLD.HL" />
        <NLWFOV RW="lKkFYHFYxSVXP" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXSVXPKFYHFYLKVIZGRLM.HL" />
        <NLWFOV RW="lKhGLXPgIZWRMTwZBH" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPGIZWRMTWZBHLKVIZGRLM.HL" />
        <NLWFOV RW="lKuFGFIVHgIZWRMTwZBH" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYUFGFIVHGIZWRMTWZBHLKVIZGRLM.HL" />
        <NLWFOV RW="lKuFGFIVHmRTSGsLORWZB" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYUFGFIVHMRTSGSLORWZBLKVIZGRLM.HL" />
        <NLWFOV RW="lKhGLXPrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPRMULLKVIZGRLM.HL" />
        <NLWFOV RW="lKcqkhGLXPrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYCQKHGLXPRMULLKVIZGRLM.HL" />
        <NLWFOV RW="lKrMWVCrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYRMWVCRMULLKVIZGRLM.HL" />
        <NLWFOV RW="lKuFGFIVHrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYUFGFIVHRMULLKVIZGRLM.HL" />
        <NLWFOV RW="lKgIZWRMThVHHRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYGIZWRMTHVHHRLMLKVIZGRLM.HL" />
        <NLWFOV RW="lKvCXSZMTVrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYVCXSZMTVRMULLKVIZGRLM.HL" />
        <NLWFOV RW="lKiVTRLMrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYIVTRLMRMULLKVIZGRLM.HL" />
        <NLWFOV RW="lKuFGFIVHxLNNRHHRLMrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYUFGFIVHXLNNRHHRLMRMULLKVIZGRLM.HL" />
        <NLWFOV RW="lKlKGRLMrMUL" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYLKGRLMRMULLKVIZGRLM.HL" />
        <!--<NLWFOV RW="lKaVFHkZXPVGhGIFXGFIV" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYAVFHKZXPVGHGIFXGFIVLKVIZGRLM.HL" />-->
        <NLWFOV RW="lKvCXSZMTVgIZWRMTwZBH" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYVCXSZMTVGIZWRMTWZBHLKVIZGRLM.HL" />
        <NLWFOV RW="lKkILWFXGxLMHGRGFVMG" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYKILWFXGXLMHGRGFVMG.HL" />
        <NLWFOV RW="hGIZGVTBwVNL" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYWVNLHGIZGVTB.HL" />
        <NLWFOV RW="kLHGKLMVhGIZGVTB" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYWVNLHGIZGVTB.HL" />
    </NLWFOVH>

</HVXFIRGBNZMZTVI>

//##**---------------- ./HGZIUOVVG/VGX/XLNKLMVMGH/FHRN.CNO
<?CNO EVIHRLM="8.9" ?>
<FHRN_GVHG XORVMG="./NBFHRN" IVUIVHSWZBH="9" GSIVZWMFN="8" WZGZKZGS="./WZGZ" FWZGZKZGS="./WZGZ" IVZOGRNV="UZOHV" >
    <OLT OVEVO="RMUL" HSN="FHRNOLT" OLTUROV="FHRN_${bbbbnnww}.OLT" KIRMG="GIFV" KIRMGML="UZOHV" XLFMG="899999"/>
    <XKF NLWV="ZFGL"/>
    <HVXFIRGBNZMZTVI RMHGIFNVMGH="UFGFIVH" />
    <NVHHZTVKLLO XLMURT="/LKG/EVIHRLM/${evihrlm}/VGX/ZOKSZNVHHZTV.CNO" >
    </NVHHZTVKLLO>

    <FMREVIHV KZGS="${ORYKZGS}/HRNFOZGLI/ORYFMREVIHVUFGFIVHQB.HL" RW="FMREUFG"
        IZDWZGZUROV="/WZG/ZOO/uFGFIVH/qb/wZROB/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG"
        HGZIGWZGV="79849798" VMWWZGV="79849796" YZXPWZBH="79" NRmFN="87"
        ZOOgIZWVwZBH="/WZG/ZOO/uFGFIVH/ORHG/GIZWVWZBH.GCG"
        IVZWLMOB="UZOHV" HRNGBKV="RMGIZWZB" HRNrMGVIEZO="89NRM"
        HVHHRLMH="78:99-7:69,0:99-89:84,89:69-88:69,86:69-84:99"
        WVOZBWZGZGRNV="9" XLNNLWRGRVH="ZOO" VCXOFWV="ru gu rs rx g" FWZGZ="UZOHV"/>

    <NLWFOVH>
        <!--YVXZFHV LU xaxv NFOGRKOVI YFT, DV HSLFOW OLZW KILUROV YVULIV YZHVWZGZ, ZUGVI YZHVWZGZ, GEI RH XLNKZIZYOV GL LGSVI VCXS. -->
        <NLWFOV RW="uFGkILUROV" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGKILUROV.HL"
            WZGZKZGS="/WZG/ZOO/uFGFIVH/ORHG/UFGKILUROV.GCG"
            qbWZGZKZGS="/WZG/ZOO/uFGFIVH/qb/wZROB/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG" />
        <NLWFOV RW="uFGyZHVwZGZ" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGYZHVWZGZHSNWZGZYLC.HL"
            WZGZKZGS="/WZG/ZOO/uFGFIVH/nZIPVGwZGZ/oVEVO8/WZGZ/${bbbb}/${bbbbnnww}/WFNK_${bbbbnnww}.WZG.TA"
            qbWZGZKZGS="/WZG/ZOO/uFGFIVH/qb/wZROB/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG"
            GLWZBWZGZ="/WZG/ZOO/uFGFIVH/IVZOGRNV/WFNK_IVZO.WZG"
            MVVWGZT="UZOHV" kFYHFYfKWZGVgLWZBfHVhSN="UZOHV" HLFIXV="KFYHFYO8" OLZWGRXP="UZOHV" GRXPNRmFN="8"
            HLUROV="/LKG/EVIHRLM/${evihrlm}/ORY/ORYWZGZYLC_XGK.HL" CNOUROV="/LKG/EVIHRLM/${evihrlm}/VGX/WZGZYLC_XGK.CNO" FWZGZ="UZOHV" />
        <NLWFOV RW="uFGrMWVC" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGRMWVCHRNKOV.HL" ZWQKIRXVH="UZOHV" ZWQIZMTV="WZROBZWQXOLHV" FWZGZ="UZOHV"/>
        <NLWFOV RW="uFGwLNRMZMG" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGWLNRMZMG.HL" RMWRXZGLI="WZROB_GEI" FWZGZ="UZOHV"/>
        <NLWFOV RW="uFGrMWVCgIZWVdVRTSG" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGRMWVCGIZWVDVRTSG.HL" YZXPWZBH="89" RMWRXZGLI="WZROB_GEI" NRMEZOFV="8999" FWZGZ="UZOHV"/>
        <NLWFOV RW="gLK79" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGGLKORJFRW7.HL" ZOOLD="ZOO" WRHZOOLD="ru rs rx gu g"
            GLK="79" SLOWEZOFV="5V0" GIZWVEZOFV="5V0" ZOOEZOFV="8V8" DRMWLDWZBH="89" OLLPYZXP="4" KZHHIZGV="899" HGRXPB="79" WVOGZ="9.7" FWZGZ="UZOHV" />
        <NLWFOV RW="gLK69" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGGLKORJFRW7.HL" ZOOLD="ZOO" WRHZOOLD="ru rs rx gu g"
            GLK="69" SLOWEZOFV="5V0" GIZWVEZOFV="5V0" ZOOEZOFV="8V8" DRMWLDWZBH="89" OLLPYZXP="4" KZHHIZGV="899" HGRXPB="79" WVOGZ="9.7" FWZGZ="UZOHV" />
        <NLWFOV RW="uFGiVGFIM" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGIVGFIM.HL" MVVWGZT="UZOHV" GIZWVDVRTSG="uFGrMWVCgIZWVdVRTSG.GG7" MVVWOZHG="UZOHV" OLLPZSVZW="8N,7N,6N,4N,89N,84N,69N,54N,8S,09N,7S,849N,6S,8W"/>
        <NLWFOV RW="uFGrMWVCzWI" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGRMWVCZWI.HL" MVVWGZT="UZOHV" GIZWVDVRTSG="uFGrMWVCgIZWVdVRTSG.GG7" YZXPWZBH="49" />
        <NLWFOV RW="uFGnVNYVIiZMP" GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGNVNYVIIZMP.HL" WZGZKZGS="/WZG/ZOO/uFGFIVH/qb/nVNYVIiZMP/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG" FWZGZ="UZOHV"/>
        <NLWFOV RW="uFGdZIVSLFHVhGZG"  GBKV="WZGZ" KZGS="${FHRNKZGS}/YRM/ORYWOUFGDZIVSLFHVHGZG.HL" WZGZKZGS="/WZG/ZOO/uFGFIVH/fyrj/wZROB/dZIVSLFHVhGZG/WZGZ/${bbbb}/${nn}/${ww}/${bbbb}-${nn}-${ww}.GCG" FWZGZ="UZOHV"/>
        <NLWFOV RW="gIZWVuFGrMWVC" GBKV="GIZWV" KZGS="${ORYKZGS}/HRNFOZGLI/ORYGIZWVUFGRMWVC.HL" />
        <NLWFOV RW="knhRNKOV" GBKV="KLIGULORL" KZGS="${ORYKZGS}/HRNFOZGLI/ORYKNHRNKOV.HL" />
        <NLWFOV RW="nmhRNKOV" GBKV="NVGILMLNV" KZGS="${ORYKZGS}/HRNFOZGLI/ORYNMHRNKOV.HL" />
        <NLWFOV RW="etIZYYRG" GBKV="EZMTFZIW" KZGS="${ORYKZGS}/HRNFOZGLI/ORYETIZYYRG.HL" />
        <NLWFOV RW="hGZGHhRTMZOuFGFIV" GBKV="HGZG" KZGS="${ORYKZGS}/HRNFOZGLI/ORYHGZGHHRTMZOUFG.HL" />
        <NLWFOV RW="hGZGHuFGFIV" GBKV="HGZG" KZGS="${ORYKZGS}/HRNFOZGLI/ORYHGZGHUFG.HL" />
        <NLWFOV RW="xLNYRMVhRNKOV" GBKV="XLNYRMV" KZGS="${ORYKZGS}/HRNFOZGLI/ORYXLNYRMVHRNKOV.HL" />

        <NLWFOV RW="zOKSZuFGrMWVCnVGZ" GBKV="ZOKSZNVGZ" KZGS="${FHRNKZGS}/YRM/ORYZOKSZUFGRMWVCNVGZ.HL" />
        <NLWFOV RW="zOKSZuFGnVGZ" GBKV="ZOKSZNVGZ" KZGS="${FHRNKZGS}/YRM/ORYZOKSZUFGNVGZ.HL" />
        <NLWFOV RW="ixJFLGVSZOG" GBKV="IRHPXLMGILO" KZGS="${FHRNKZGS}/YRM/ORYIXJFLGVSZOG.HL" />
        <NLWFOV RW="ixXRIXFRGYIVZP" GBKV="IRHPXLMGILO" KZGS="${FHRNKZGS}/YRM/ORYIXXRIXFRGYIVZP.HL" />
        <NLWFOV RW="lkuFGrMWVCuIVVAVrMZXGREV" GBKV="LKVIZGRLM" KZGS="${FHRNKZGS}/YRM/ORYLKUFGRMWVCuIVVAVrMZXGREV.HL" />

        <NLWFOV RW="hRTMZOuFGrMWnVGZ" GBKV="HRTMZONVGZ" KZGS="${FHRNKZGS}/YRM/ORYHRTMZOUFGRMWNVGZ.HL" />
        <NLWFOV RW="lKHRTMZOhGZMWZIWRAV" GBKV="LKVIZGRLM" KZGS="${FHRNKZGS}/YRM/ORYLKHRTMZOhGZMWZIWRAV.HL" />
        <NLWFOV RW="lKHRTMZOwVXZB" GBKV="LKVIZGRLM" KZGS="${FHRNKZGS}/YRM/ORYLKHRTMZOwVXZB.HL" />

        <!--<NLWFOV RW="HRTMZO8" ZOKSZNZMSLOWVI="HRTMZO" GBKV="HRTMZO" KZGS="${KIREZGV}/ORYZOKSZ_FHVIMZNV_HRTMZO8.HL" />-->
        <NLWFOV RW="HRTMZO8" GBKV="HRTMZO" KZGS="${FHRNKZGS}/YRM/ORYHRTMZOUFGRMW.HL" />

    </NLWFOVH>


    <IRHPXLMGILO>
        <IX NLWFOV="ixJFLGVSZOG" RW="IX8" />
    </IRHPXLMGILO>


    <NVGILMLNV NLWFOV="nmhRNKOV" URIHG_GRXP_DZRG="8H" NVIXBGRNV="7NH" NZQLIET="FMREUFG" >
        <EZMTFZIW NLWFOV="etIZYYRG" RW="ET6"  m="8" GRNVLFG="899NH"/>

        <KLIGULORL NLWFOV="knhRNKOV" RW="UFG8" WRI="KNHRMTOV">
            <HGZGH NLWFOV="hGZGHuFGFIV" EDZK="UZOHV" KIRMG="GIFV" HFNNZIB="GIFV" HSLDXLNNLWRGB="UZOHV" KMOWRI="KMO"/>
            <GIZWV NLWFOV="gIZWVuFGrMWVC" EDZK="UZOHV" GIZWRMT_UVV="GIFV" XLNNRHHRLMIZGV="8.9" HORKKZTVIZGV="9.9998991" KIRXVGBKV="NRW"  />

            <HRTMZOHGZGH NLWFOV="hGZGHhRTMZOuFGFIV" KIRMG="GIFV" HFNNZIB="GIFV" HSLDXLNNLWRGB="UZOHV" KMOWRI="HRTMZO"
                OLLPZSVZW="8N,6N,4N,89N,84N,69N,8S,7S,6S,8W"
                NRWIVGFIM="GIFV" KIVWRXGLEVIMRTSG="GIFV"
                MVVWHRTMZOXLII="UZOHV"
                HRTMZOTILFK="" HRTMZOTILFK7="" MVVWWRHGZMXV="GIFV"
                />
            <XLNYRMV NLWFOV="xLNYRMVhRNKOV" HRAV="8V1" />

            <HRTMZO NLWFOV="HRTMZO8" HRTMZORW="HRTMZO8" FMREVIHV="gLK79" WVOZB="9" >
                <LKVIZGRLMH> <LKVIZGRLM NLWFOV="lKHRTMZOhGZMWZIWRAV" /> </LKVIZGRLMH>
            </HRTMZO>

        </KLIGULORL>
    </NVGILMLNV>

</FHRN_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/XLNKLMVMGH/IVWHSRUG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<IVWHSRUG KZGS="">
    <OLT  OVEVO="RMUL" OLTUROV="/FYRJ/OLT/IVWHSRUG_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />

    <NVHHZTVLKH>
        <NVHHZTVLK NLWFOV="ILFGRMT" />
        <!--<NVHHZTVLK NLWFOV="FKKVIXZHV" />-->
        <!--<NVHHZTVLK NLWFOV="FKWZGVUROV" />-->
        <NVHHZTVLK NLWFOV="HVMWUROV" />
        <NVHHZTVLK NLWFOV="HGLXPJFLGV" />
    </NVHHZTVLKH>

    <XLNNZMWLKH>

    </XLNNZMWLKH>

    <QLYLKH HOVVK_KVI_ILFMW="9">
        <!--<QLYLK NLWFOV="NRIILIWRI" />-->
        <!--QLYLK NLWFOV="HGLXPJFLGV" GL="FYRJ8" /-->
    </QLYLKH>

</IVWHSRUG>
//##**---------------- ./HGZIUOVVG/VGX/XLNKLMVMGH/NZHHIVOZB.CNO
<?CNO EVIHRLM="8.9" ?>
<NZHHIVOZBG>
    <OLT OVEVO="RMUL" HSN="NZHHIVOZBG" OLTUROV="/GNK/NZHHIVOZBG.OLT" KIRMG="UZOHV" KIRMGML="UZOHV" XLFMG="89999" />
<GRNVI NLWV="ZFGL" FKWZGV="499FH" />
<XKF NLWV="NZMFZO" XLIV="4" KFYORX="5" />

<WZGFN>

</WZGFN>

<DLIPUOLD NLWFOV="dLIPUOLDwVNL" hOVVKkVIiLFMW="6NH" >

    <HGIZGVTB NLWFOV="hGIZGVTBwVNL" RW="UFGFIVH_IVOZB" >
        <LKVIZGRLM NLWFOV="lKiVOZBiVXE" />
        <LKVIZGRLM NLWFOV="lKgIZUURXxLMGILO" NZC_LIWVI_KVI_HVXLMW="899" />
        <LKVIZGRLM NLWFOV="lKiVOZBhVMW" />
    </HGIZGVTB>

    <HGIZGVTB NLWFOV="hGIZGVTBwVNL" RW="HGLXP_IVOZB" >
        <LKVIZGRLM NLWFOV="lKhGPiVOZBiVXE" />
        <LKVIZGRLM NLWFOV="lKhGPgIZUURXxLMGILO" NZC_LIWVI_KVI_HVXLMW="899" />
        <LKVIZGRLM NLWFOV="lKhGPiVOZBhVMW" />
    </HGIZGVTB>

</DLIPUOLD>



<NLWFOVH>
    <NLWFOV RW="dLIPUOLDwVNL" GBKV="DLIPUOLD" KZGS="${ORYKZGS}/ORYWVNLDLIPUOLD.HL" />
    <NLWFOV RW="lKiVOZBiVXE" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYLKIVOZBIVXE.HL" />
    <NLWFOV RW="lKgIZUURXxLMGILO" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYLKGIZUURXXLMGILO.HL" />
    <NLWFOV RW="lKiVOZBhVMW" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYLKIVOZBHVMW.HL" />

    <NLWFOV RW="lKhGPiVOZBiVXE" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYLKIVOZBHGPIVXE.HL" />
    <NLWFOV RW="lKhGPgIZUURXxLMGILO" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYLKHGPGIZUURXXLMGILO.HL" />
    <NLWFOV RW="lKhGPiVOZBhVMW" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYLKIVOZBHGPHVMW.HL" />

    <NLWFOV RW="hGIZGVTBwVNL" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYWVNLHGIZGVTB.HL" />
    <NLWFOV RW="kLHGKLMVhGIZGVTB" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYWVNLHGIZGVTB.HL" />
</NLWFOVH>

</NZHHIVOZBG>

//##**---------------- ./HGZIUOVVG/VGX/XLNKLMVMGH/KFYHFYHVIERXV.CNO
<?CNO EVIHRLM="8.9" ?>
<ILLG >
    <XLMURT>
        <ZWWI YILPVIRK="872.9.9.8" YILPVIKLIG="77777" />
        <OLT OVEVO="RMUL" UROVMZNV="/FYRJ/OLT/IVHGZIGhVIERXV_${bbbbnnww}.OLT" KIRMG="UZOHV" />
    </XLMURT>

    <!-- GLKRX FHV OLXZO KFY ZMW HFY YB WVUZFOG, RU DZMG KFY LI HFY UILN MVGLDIP YILPVI, KOVZHV HVG YVOLD -->
    <IVNLGVkFYgLKRXH>
        <!-- GSVHV GLKRXH DROO KFY GL MVGDLIP(YILPVI)
        <GLKRX MZNV="uFGFIVHnw"  />
        <GLKRX MZNV="gyrMKFGuRVOW"  />
        -->
        <GLKRX MZNV="hGLXPrMUL"  />
        <GLKRX MZNV="uFGFIVHrMUL"  />
        <GLKRX MZNV="cqkhGLXPrMUL"  />
        <GLKRX MZNV="gIZWRMThVHHRLM"  />
        <GLKRX MZNV="hGLXPgIZWRMTwZBH"  />
        <GLKRX MZNV="uFGFIVHgIZWRMTwZBH"  />
        <GLKRX MZNV="uFGFIVHmRTSGsLORWZB"  />
        <GLKRX MZNV="lKGRLMrMUL"  />
        <GLKRX MZNV="mLGV"  />
        <GLKRX MZNV="iRHPxLMGILOmLGRXV"  />
        <GLKRX MZNV="rMWVCrMUL"  />
        <GLKRX MZNV="xLNNZMW"  />
        <GLKRX MZNV="uFGFIVHnwo8"  />
    </IVNLGVkFYgLKRXH>
    <IVNLGVhFYgLKRXH>
        <!-- GSVHV GLKRXH DROO HFY UILN MVGDLIP(YILPVI)
        <GLKRX MZNV="uFGFIVHnw"  />
        <GLKRX MZNV="gyrMKFGuRVOW"  />
        -->
        <GLKRX MZNV="xOVZIgLKRX"  />
    </IVNLGVhFYgLKRXH>

</ILLG>

//##**---------------- ./HGZIUOVVG/VGX/XLNKLMVMGH/HBHGVNVBV.CNO
<?CNO EVIHRLM="8.9" ?>
<!--<HBHGVNVBV XORVMGKZGS="/LKG/EVIHRLM/${evihrlm}/HBHGVNVBV/ORY"  >-->
<HBHGVNVBV_GVHG OLMTOREV="GIFV" DZREVW="GIFV">
    <OLT OVEVO="RMUL" HSN="HBHGVNVBV" OLTUROV="HBHGVNVBV.OLT" KIRMG="GIFV" KIRMGML="UZOHV" XLFMG="89999"/>
    <XKF  NLWV="NZMFZO"  XLIV="5" KFYORX="7" MRXV=""/>
    <GRNVI NLWV="ZFGL" FKWZGV="499FH" IVOLZW="3:97:69" />

    <WZGFN>
        <HVXFIRGB RW="H8" XZGVTLIB="UFGFIVH" HLFIXV="KFYHFYO8" />
        <!--<HVXFIRGB RW="H7" XZGVTLIB="HGLXP" HLFIXV="HSN"-->
            <!--HL="/LKG/EVIHRLM/${evihrlm}/ORY/ORYWZGZYLC_OGHO7.HL"-->
            <!--CNO="/LKG/EVIHRLM/${evihrlm}/VGX/WZGZYLC_OGHO7.CNO" />-->
        <!--<HVXFIRGB RW="H6" XZGVTLIB="CQKHGLXP" HLFIXV="ogho7" />-->
        <HVXFIRGB RW="H6" XZGVTLIB="HGLXP" HLFIXV="ogho7" />
        <HGZGHW SLHG="HS.FYRJFZMG.XLN" KLIG="1874" GXK="UZOHV" />
    </WZGFN>

    <DLIPUOLD NLWFOV="dLIPUOLDwVNL" hOVVKkVIiLFMW="4H">
        <HGIZGVTB NLWFOV="hGIZGVTBwVNL">
            <LKVIZGRLM NLWFOV="xSVXPkFYhFY" NLMRGLI="uFGFIVHnw,uFGFIVHnwo8" />
            <LKVIZGRLM NLWFOV="hBHGVNoLZWlKVIZGRLM" GSIVHSLOW="OLZW:04" GVNKVIZGFIV_GSIVHSLOW="14" />
            <LKVIZGRLM NLWFOV="hBHGVNnVNLIBlKVIZGRLM"  GSIVHSLOW="NVNLIB:14"/>
            <LKVIZGRLM NLWFOV="hBHGVNwRHPlKVIZGRLM"  GSIVHSLOW="EZI:19|SLNV:19|WZG:14" />
            <LKVIZGRLM NLWFOV="hBHGVNhnxlKVIZGRLM" IVJFRIVW="HGLXP:7999,HGLXPGIZWRMTWZB:89, CQKHGLXP:0999" />
            <!--<LKVIZGRLM NLWFOV="hBHGVNjFLGVlKVIZGRLM" IVJFRIVW="HHV,HAV,HSUV,XUUVC,WXV,XAXV" />-->
            <!--<LKVIZGRLM NLWFOV="cqkjFLGVlKVIZGRLM" IVJFRIVW="spt,gzr" />-->
            <LKVIZGRLM NLWFOV="hGZGHWiVKLIGlKVIZGRLM" />
        </HGIZGVTB>
    </DLIPUOLD>

    <NLWFOVH>
        <NLWFOV RW="dLIPUOLDwVNL" GBKV="DLIPUOLD" KZGS="${ORYKZGS}/ORYWVNLDLIPUOLD.HL" />
        <NLWFOV RW="hGIZGVTBwVNL" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYWVNLHGIZGVTB.HL" />
        <NLWFOV RW="kLHGKLMVhGIZGVTB" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYWVNLHGIZGVTB.HL" />
        <NLWFOV RW="hBHGVNoLZWlKVIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHBHGVNOLZWLKVIZGRLM.HL" />
        <NLWFOV RW="hBHGVNnVNLIBlKVIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHBHGVNNVNLIBLKVIZGRLM.HL" />
        <NLWFOV RW="hBHGVNwRHPlKVIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHBHGVNWRHPLKVIZGRLM.HL" />
        <NLWFOV RW="hBHGVNhnxlKVIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHBHGVNHNXLKVIZGRLM.HL" />
        <NLWFOV RW="hBHGVNjFLGVlKVIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHBHGVNJFLGVLKVIZGRLM.HL" />
        <NLWFOV RW="cqkjFLGVlKVIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYCQKJFLGVLKVIZGRLM.HL" />
        <NLWFOV RW="hGZGHWiVKLIGlKVIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGZGHWIVKLIGLKVIZGRLM.HL" />
        <NLWFOV RW="xSVXPkFYhFY" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXSVXPKFYHFYLKVIZGRLM.HL" />
    </NLWFOVH>


</HBHGVNVBV_GVHG>

//##**---------------- ./HGZIUOVVG/VGX/XLNKLMVMGH/YILPVI.CNO
<?CNO EVIHRLM="8.9" ?>
<ILLG >
    <XLMURT>
        <ZWWI YILPVIKLIG="77777" />
        <OLT OVEVO="RMUL" UROVMZNV="/FYRJ/OLT/YILPVI.OLT" />
    </XLMURT>
</ILLG>

//##**---------------- ./HGZIUOVVG/VGX/LKWVNL.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<WZGZUOVVG_8 XORVMG='./'>

    <OLT  OVEVO="WVYFT" OLTUROV="ZOKSZ_NZMZTVNVMG_${bbbbnnww}.OLT"  KIRMG="GIFV" />

    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="8:70:99">
            <LKVIZGRLM RW='IVZW_ZOKSZ' NLWFOV="wFNNBlK" LM_GRNV="85:70:69,85:69,85:69:69"  LM_WZB="hhv|hav"
                IVOLZW="6:99" IVTRLM="xm" MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>
    </LKVIZGRLMH>

</WZGZUOVVG_8>
//##**---------------- ./HGZIUOVVG/VGX/ZMWILNVWRZ.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<ZMWILNVWRZ_GVHG>

    <OLT  OVEVO="WVYFT" OLTUROV="ZGSVMZ_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />

    <NLWFOVH>
        <NLWFOV RW="ZMWILNVWRZ"  ZWWIVHH="" FHVI="" KZHHDW=''/>
    </NLWFOVH>

    <DZGXSVIH>
        <!--<DZGXSVI NLWFOV="HGPZOKSZNVGZ" LM_GRNV="8:44" />-->
        <DZGXSVI NLWFOV="ZOKSZNZM_NZRMGVMZMXV" VEVIB="6H" />
</DZGXSVIH>

</ZMWILNVWRZ_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/IVOZB.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<IVOZB_GVHG KLHG_HVIEVI="89.81.9.876:49996">

    <OLT  OVEVO="WVYFT" OLTUROV="IVOZB_${bbbbnnww}.OLT"  KIRMG="GIFV" KIRMGML="UZOHV" />

    <NLWFOVH>
        <NLWFOV RW="KLHGIVOZB"  KLHG_HVIEVI="89.81.9.876:49995"/>
    </NLWFOVH>

    <IVWRIVXGH>
        <IVWRIVXG RW='KRKVORMV_ZOKSZNZM' GZITVG="KRKVORMV/ZOKSZNZM" IVOZB="79.81.9.897:1118"/>
    </IVWRIVXGH>

</IVOZB_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/OGHKLHGXSVXP.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<OGHKLHGXSVXP_GVHG XORVMG='/SLNV/CWVMT/DLIPHKZXV/HGZIUOVVG/GVHG' OLMTOREV="GIFV" DZREVW="GIFV">
    <OLT OVEVO="WVYFT" OLTUROV="OGHKLHGXSVXP_GVHG_${bbbbnnww}.OLT" KIRMG="GIFV" KIRMGML="UZOHV" XLFMG="89999"/>

    <NLWFOVH>
    </NLWFOVH>

    <LKVIZGRLMH HOVVK_KVI_ILFMW="4H" IVOLZW="99:99:98">
        <LKVIZGRLM RW='oghkLHGxSVXP' NLWFOV="oghkLHGxSVXP" VEVIB="4H" WYHVIEVI='HSHC96' WYKLIG='3333' WYFHVI='WZGZNZM' WYKZHHDW='iZ*1NZ!F' WYMZNV='FYRJWY' WYGRNVLFG='4.9'>
            <ZXXLFMG zXXLFMGrw="88999999773898" rMEVHGLIrw="889999997738" NZXSRMV='SYAJ4'/>
        </LKVIZGRLM>
    </LKVIZGRLMH>

</OGHKLHGXSVXP_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/WZGZWVNL.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<WZGZUOVVG_8 XORVMG='./'>

    <OLT  OVEVO="WVYFT" OLTUROV="ZOKSZ_NZMZTVNVMG_${bbbbnnww}.OLT"  KIRMG="GIFV" />

    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="8:70:99">
            <LKVIZGRLM RW='IVZW_ZOKSZ' NLWFOV="IVZW_ZOKSZ" GRNV_IZMTV="1:79-1:79" VEVIB_GL_HFXXVHH="7H" LM_WZB="hhv|hav"
                IVOLZW="6:99" IVTRLM="xm" MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>
            <LKVIZGRLM RW='XLNKFGV_WZGZ' IVTRLM="xm" NLWFOV="XLNKFGV_ZOKSZ" GRNV_IZMTV="1:79-83:79" VEVIB_GL_HFXXVHH="7H" LM_WZB="hhv|hav"
                IVOLZW="6:99" MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>

            <LKVIZGRLM RW='HVIEVI' IVTRLM='xm' NLWFOV="HVIEVI"  IVOLZW="6:99" MVD_GSIVZW="GIFV" >
            </LKVIZGRLM>

    </LKVIZGRLMH>

    <LKVIZGRLM_WVKVMWVMXRVH>
        <WVKVMWVMXB  HFYQVXG="XLNKFGV_WZGZ"  WVKVMWVMXRVH="IVZW_ZOKSZ" />
    </LKVIZGRLM_WVKVMWVMXRVH>

    <GZHPH>
    </GZHPH>

</WZGZUOVVG_8>
//##**---------------- ./HGZIUOVVG/VGX/ZOKSZNZMVCZNKOV.CNO
<ZOKSZNZM_QLYH>
    <FHRN ZOKSZNZM="gIFV" XDW="/DLIP/ZOKSZNZM/CORF/tILFK_CAAQ8" RM_GIFHG="gIFV" LM_WZB="hsuv" KLHHVHH="uZOHV" KBGSLM="uZOHV">
        <RW EZOFV="CORF_tILFK_CAAQ8" />
        <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/FHRN/FHRN-WVE/FHRN" />
        <XLMURT EZOFV="/DLIP/ZOKSZNZM/CORF/tILFK_CAAQ8/DLIP.CNO" />
        <GRNV HGZIG="1:49" HGLK="84:99" />
        <GRNV HGZIG="79:69" HGLK="7:69" />
        <GRNV ZITH="-U" HGZIG="83:69" HGLK="82:89N" />
    </FHRN>
</ZOKSZNZM_QLYH>
//##**---------------- ./HGZIUOVVG/VGX/HGZIUOVVG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG YLLGHGIZK_IVHGZIG="76:60" YIRWTV='5998'>

    <OLT  OVEVO="WVYFT" OLTUROV="HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" KIRMGML="UZOHV" />
    <HGZGHW SLHG="HS.FYRJFZMG.XLN" KLIG="1874" IVKLIG_HVOU="UZOHV"/>
<!--    <IVXLIWVI GBKV="WY" /> -->

    <NLWFOVH>
        <NLWFOV RW="NLMRGLIHBHGVN" />
        <NLWFOV RW="WLXPVI"/>
    </NLWFOVH>
    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="86:87:69">

        <!--<LKVIZGRLM RW='WFNNB'  NLWFOV="wFNNBlK" VEVIB="8H" />-->
        <!--<LKVIZGRLM RW='WFNNB7' NLWFOV="wFNNBlK" VEVIB="8H" />-->

        <!--
        <LKVIZGRLM RW='hGLXPhVXFIRGBnZMZTVIiVZWB' NLWFOV="hGLXPhVXFIRGBnZMZTVIiVZWB" VEVIB="8H" />
        -->
        <!--<TILFK RW='gVHG'>-->
            <!--<LKVIZGRLM RW='hGPkLHRGRLMHwFNKgLuROV' NLWFOV="hGPkLHRGRLMHwFNKgLuROV" UROVMZNV="/GNK/CTzgVHG_KLH_79829881.XHE" ZXXLFMGRW="78199992241" VEVIB='89H' />-->
            <!--<LKVIZGRLM RW='xZOOhSVOO' NLWFOV="xZOOhSVOO" XNW="HXK /GNK/CTzgVHG_KLH_79829881.XHE SVWTV@FYRJYQ7:/WZG/KLH/CTzGVHG/79829881/CTzgVHG_KLH_79829881.XHE" VEVIB_GL_HFXXVHH="89H"/>-->
        <!--</TILFK>-->

        <!--<LKVIZGRLM RW='XZRGLMT_VNZRO' NLWFOV="xZRGLMTwZROBvNZRO" GRNV_IZMTV="7:79-76:79" VEVIB_GL_HFXXVHH="7H"-->
            <!--IVOLZW="6:99,4:59"  MVD_GSIVZW="GIFV" VNZRO_GL="YUZM@FYRJFZMG.XLN" KZGS="/SLNV/YUZM/rMHVIGlIWVI_${bbbbnnww}"  >-->
        <!--</LKVIZGRLM>-->
        <!--<LKVIZGRLM  NLWFOV="lIWVIgIZUURXxLMGILO" NZC_LIWVI_KVI_HVXLMW="89" VEVIB="8H"  MVD_GSIVZW="UZOHV" >--> <!--<ZXX ZXXLFMG="XXWW" LIWVIHKVVW="39"/>-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="hGZIGfGIZWVhGIZGVTBlMgRNV" VEVIB="8H">-->
            <!--<HXSVWFOVCNO KZGS="/RMX/YUZM/NZMZTVNVMG.CNO"/>-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="xFHGLNqLYH" VEVIB="8H">-->
            <!--<QLYCNO KZGS="/FYRJ/QLYH/YUZM/NZMZTVNVMG.CNO"/>-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="gIZWRMThBHGVNwZROBiVKLIG" LM_GRNV="84:79:49"-->
            <!--VNZRO_GL="YUZM@FYRJFZMG.XLN,KGZMT@FYRJFZMG.XLN,XDZMT@FYRJFZMG.XLN,CTFL@FYRJFZMG.XLN,QDZMT@FYRJFZMG.XLN,BDZMT@FYRJFZMG.XLN">-->
                <!--<NZXSRMV  RW="ACAQ8" FHVIMZNV="YUZM" KZHHDLIW="CCCC" />-->
                <!--[>[><NZXSRMV  RW="ACAQ7" FHVIMZNV="YUZM" KZHHDLIW="CCCC" /><]<]-->
                <!--[>[><NZXSRMV  RW="SGAQ8" FHVIMZNV="YUZM" KZHHDLIW="CCCC"/><]<]-->
                <!--[>[><NZXSRMV  RW="CAAQ8" FHVIMZNV="YUZM" KZHHDLIW="CCCC"/><]<]-->
                <!--[><SUG RW="SGBW8" FHVIMZNV="YUZM" KZHHDLIW="CCCC" /><]-->
                <!--[>[><SUG RW="SGHJ7" FHVIMZNV="YUZM" KZHHDLIW="CCCC" /><]<]-->
        <!--</LKVIZGRLM>-->

        <!--<LKVIZGRLM NLWFOV="gIZUURXoRTSG" VEVIB="6H" MVD_GSIVZW="UZOHV" RM_HVHHRLM="xaxv^wxv">-->
            <!--<DZREV GZITVG="HBHGVNVBV,NZIPVGVBV, HBHGVNVBVG" />-->
            <!--<GZITVG RW="FGIZWV_ZZZ" IVWORTSG="91:99, 79:99"> <XSVXP NLWFOV="hVXFIRGBnZMZTVIiVZWB"/>-->
                <!--<XSVXP NLWFOV="kLHRGRLMHxSVXPiVZWB" KZGS="/WZG/ZXXLFMGVBV/xSVXPkLHRGRLM/" />-->
                <!--<XSVXP NLWFOV="gyxSVXPiVZWB"/>-->
            <!--</GZITVG>-->
        <!--</LKVIZGRLM>-->
    <WVKVMWVMXRVH>
    </WVKVMWVMXRVH>


    </LKVIZGRLMH>



    <XLNKLMVMGH>

        <KFYHFY KLHHVHH="gIFV" >
            <IVHGZIG KILTIZN='/LKG/EVIHRLM/${evihrlm}/YRM/IVHGZIGkFYhFYhVIERXV'
                CNO='VGX/XLNKLMVMGH/KFYHFYHVIERXV.CNO'/>
            <YILPVI KILTIZN='/LKG/EVIHRLM/${evihrlm}/YRM/YILPVI'
                CNO='VGX/XLNKLMVMGH/YILPVI.CNO' />
        </KFYHFY>

        <HVXFIRGBNZMZTVI KLHHVHH="uZOHV" >
            <RW EZOFV="HVXFIRGBNZMZTVI" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HVXFIRGBNZMZTVI/YRM/HVXFIRGBNZMZTVI" />
            <XLMURT EZOFV="VGX/XLNKLMVMGH/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="81:99:99" HGLK="81:99:99"/>
        </HVXFIRGBNZMZTVI>

        <!--<NZIPVGVBV KLHHVHH="gIFV" RM_GIFHG="uZOHV">-->
            <!--<RW  EZOFV="NZIPVGVBV"/>-->
            <!--<KILTIZN EZOFV="/LKG/NZIPVGVBV/YRM/NZIPVGVBV" />--> <!--<XLMURT EZOFV="NZIPVGVBV.CNO"/>-->
        <!--</NZIPVGVBV>-->


         <HBHGVNVBV KLHHVHH="uZOHV" RM_GIFHG="gIFV">
             <RW EZOFV="HBHGVNVBV_GVHG" />
             <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HBHGVNVBV/YRM/HBHGVNVBV" />
             <XLMURT EZOFV="VGX/XLNKLMVMGH/HBHGVNVBV.CNO"/>
             <GRNV HGZIG="0:99:99" HGLK="0:99:99">
                <YVULIV_HGZIG NLWFOV="ELRWXSVXP" />
            </GRNV>
         </HBHGVNVBV>

        <!--<NZHHIVOZB KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="NZHHIVOZB" />-->
            <!--<KILTIZN EZOFV="/LKG/NZHHIVOZB/YRM/NZHHIVOZB" />-->
            <!--<XLMURT EZOFV="/LKG/NZHHIVOZB/VGX/NZHHIVOZB.CNO"/>-->
        <!--</NZHHIVOZB>-->

        <!--<gy KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="gy" />-->
            <!--<KILTIZN EZOFV="/LKG/WVE/YRM/gy" />-->
            <!--<XLMURT EZOFV="XGK_XLMURT.CNO"/>-->
            <!--[><GRNV HGZIG="0:84:99" HGLK="0:79:99"/><]-->
            <!--[><GRNV HGZIG="78:99:99" HGLK="7:69:99"/><]-->
        <!--</gy>-->



        <!--<ZXXLFMGVBV KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="ZXXLFMGVBV" />-->
            <!--<KILTIZN EZOFV="/LKG/ZXXLFMGVBV/YRM/ZXXLFMGVBV" />-->
            <!--<XLMURT EZOFV="ZXXLFMGVBV.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="7:69:99"/>-->
        <!--</ZXXLFMGVBV>-->


        <!--<FHRN KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="FHRN-XGZ" />-->
            <!--<KILTIZN EZOFV="/LKG/FHRN/FHRN-WVE/FHRN" />-->
            <!--<XLMURT EZOFV="FHRN-XGZ.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="7:69:99"/>-->
        <!--</FHRN>-->

        <!--<FHRN KLHHVHH="uZOHV" RM_GIFHG="uZOHV">-->
            <!--<RW EZOFV="FHRN_XILHH" />-->
            <!--<KILTIZN EZOFV="/LKG/FHRN/FHRN-WVE/FHRN" />-->
            <!--<XLMURT EZOFV="/WZG/DLIP/YUZM/ILLN6/FHRN-XILHH.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="7:69:99"/>-->
        <!--</FHRN>-->

        <!--<FGIZWV KLHHVHH="uZOHV" RM_GIFHG="gIFV"  LM_WZB="xaxv|hsuv">-->
            <!--<RW EZOFV="FGIZWV_ZZZ" />-->
            <!--<KILTIZN EZOFV="/SLNV/YUZM/KILQVXG/FGIZWV/YRM/FGIZWV" />-->
            <!--<XLMURT EZOFV="/SLNV/YUZM/KILQVXG/FGIZWV/VGX/XGZ.CNO"/>-->
            <!--<GRNV HGZIG="87:50:99" HGLK="87:49:99"/>-->
            <!--[>[><GRNV HGZIG="78:99:99" HGLK="7:69:99"/><]<]-->
        <!--</FGIZWV>-->

    </XLNKLMVMGH>


</HGZIUOVVG>
//##**---------------- ./HGZIUOVVG/VGX/NVIXFIB.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<NVIXFIB_GVHG KLHG_HVIEVI="89.81.9.876:49996">

    <OLT  OVEVO="WVYFT" OLTUROV="NVIXFIB_${bbbbnnww}.OLT"  KIRMG="GIFV" KIRMGML="UZOHV" />

    <NLWFOVH>
        <NLWFOV RW="NVIXFIB"  />
        <NLWFOV RW="KLHGIVOZB"    KLHG_HVIEVI="89.81.9.876:49991"/>
    </NLWFOVH>

    <KLHGSFYH>
        <!--<SFY RW="HSHC96NZRMYZHV" UILN="89.892.25.86:39941/NZRMYZHV" GL="/NZRMYZHV" VEVIB='6' />-->
    </KLHGSFYH>

    <IVWRIVXGH>
        <IVWRIVXG RW='KRKVORMV_ZOKSZNZM' GZITVG="KRKVORMV/ZOKSZNZM" IVOZB="79.81.9.897:1118"/>
        <IVWRIVXG RW='KILWFXG' GZITVG="IRHPWVHP/KILWFXG" IVOZB="79.81.9.897:69899"/>

    </IVWRIVXGH>

</NVIXFIB_GVHG>
//##**---------------- ./HGZIUOVVG/VGX/HGZIUOVVGHRN.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG>

    <OLT OVEVO="WVYFT" OLTUROV="/FYRJ/OLT/HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="GIFV" />
    <!--<HGZGHW SLHG="HS.FYRJFZMG.XLN" KLIG="1874" />-->

    <HRN>
        <HGZIG EZOFV="79849484 0:49:49" />
        <VMW  EZOFV="79849484 84:49:49"/>
        <HKVVW  EZOFV="8"/>
    </HRN>

    <GZHPH>
        <!--<HRNXVMGVI KLHHVHH="uZOHV">-->
            <!--<RW EZOFV="FHRN_XILHH" />-->
            <!--<KILTIZN EZOFV="/LKG/FHRN/FHRN-WVE/FHRN" />-->
            <!--<XLMURT EZOFV="/WZG/DLIP/YUZM/ILLN6/FHRN-XILHH.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="73:69:99"/>-->
        <!--</HRNXVMGVI>-->


        <HRNXVMGVI KLHHVHH="uZOHV" RM_GIFHG="uZOHV">
            <RW EZOFV="HRNXVMGVI_YUZM" />
            <KILTIZN EZOFV="/SLNV/YUZM/KILQVXG/HRNXVMGVI/YRM/HRNXVMGVI" />
            <XLMURT EZOFV="/SLNV/YUZM/KILQVXG/HRNXVMGVI/WVNL_AB.CNO"/>
            <GRNV HGZIG="0:84:99" HGLK="84:99:99"/>
            <!--<GRNV HGZIG="78:99:99" HGLK="73:69:99"/>-->
        </HRNXVMGVI>

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV">
            <RW EZOFV="FGIZWV_ZZZ" />
            <KILTIZN EZOFV="/SLNV/YUZM/KILQVXG/FGIZWV/YRM/FGIZWV" />
            <XLMURT EZOFV="SUG.CNO"/>
            <GRNV HGZIG="0:84:99" HGLK="84:99:99"/>
            <!--<GRNV HGZIG="78:99:99" HGLK="73:69:99"/>-->
        </FGIZWV>


       <!--<ZXXLFMGVBV KLHHVHH="uZOHV">-->
            <!--<RW EZOFV="ZXXLFMGVBV" />-->
            <!--<KILTIZN EZOFV="/LKG/ZXXLFMGVBV/YRM/ZXXLFMGVBV" />-->
            <!--<XLMURT EZOFV="ZXXLFMGVBV.CNO"/>-->
            <!--<GRNV HGZIG="0:84:99" HGLK="84:99:99"/>-->
            <!--<GRNV HGZIG="78:99:99" HGLK="73:69:99"/>-->
        <!--</ZXXLFMGVBV>-->


    </GZHPH>


    <WVKVMWVMXRVH>
    </WVKVMWVMXRVH>

</HGZIUOVVG>
//##**---------------- ./HGZIUOVVG/VGX/ZGSVMZ.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<ZGSVMZ_GVHG KLHG_HVIEVI="89.81.9.808:49996">

    <OLT  OVEVO="WVYFT" OLTUROV="ZGSVMZ_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV" />

    <NLWFOVH>
        <NLWFOV RW="ZGSVMZ" />
    </NLWFOVH>

    <ZGSVMZIVZWVIH>
        <IVZWVI NLWFOV="ZXXLFMGH" VEVIB="5" />
        <!--<IVZWVI NLWFOV="WY" VEVIB="5" ZWWIVHH='' KZHHDW='' FHVI='' />-->
        <IVZWVI NLWFOV="EVIHRLMH" VEVIB="5" XLNKLMVMGH='FHRN'/>
    </ZGSVMZIVZWVIH>

</ZGSVMZ_GVHG>
//##**---------------- ./HGZIUOVVG/HLK/HLK_WFNKKFYHFY.KB
UILN HLK RNKLIG YZHV_HLK
RNKLIG LH
RNKLIG WZGVGRNV
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG KFYHFY_GLLO

XOZHH HLK_WFNKKFYHFY(YZHV_HLK.yZHVhlk):
    WVU __RMRG__(HVOU):
        HFKVI(HLK_WFNKKFYHFY, HVOU).__RMRG__()
        HVOU.HLK = 'WFNKKFYHFY'
        HVOU.YIRVU = 'gSRH HLK RH GL WFNK KIVWVURMVW KFYHFY GLKRX WZGZ GL UROVH'
        HVOU.ZITFNVMGH = {}
        HVOU.GLKRXH = ['uFGFIVHrMUL','hGLXPrMUL']

    WVU DLIP(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        LFGKFG_WRIVXGLIB = LH.KZGS.QLRM('/GNK','HBHGVN_UIVVAV_%H'%WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%s%n%h'))
        LH.NPWRI(LFGKFG_WRIVXGLIB)
        WFNKVI = KFYHFY_GLLO.kFYHFYwFNK()
        ULI GLKRXMZNV RM HVOU.GLKRXH:
            LFGKFG = LH.KZGS.QLRM(LFGKFG_WRIVXGLIB, '%H.KPO'%GLKRXMZNV)
            WFNKVI.WFNK(GLKRXMZNV, LFGKFG)
        KIRMG('KFYHFY WFNKKVW GL %H'%LFGKFG_WRIVXGLIB)

RU __MZNV__ == '__NZRM__':
    HLK = HLK_WFNKKFYHFY()
    HLK.DLIP(mLMV, mLMV)
//##**---------------- ./HGZIUOVVG/HLK/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/HLK/YZHV_HLK.KB
XOZHH yZHVhlk(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.ZITFNVMGH = {}
        HVOU.YIRVU = 'GVHG'

    WVU GIRTTVI(HVOU, TOLYZO_RMUL):
        IVGFIM uZOHV

    WVU DLIP(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        KZHH
//##**---------------- ./HGZIUOVVG/HLK/HLK_XLOWIVHGZIGGY.KB
UILN HLK RNKLIG YZHV_HLK
# RNKLIG LH
# RNKLIG WZGVGRNV
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
# RNKLIG KFYHFY_GLLO

XOZHH HLK_XLOWIVHGZIGGY(YZHV_HLK.yZHVhlk):
    WVU __RMRG__(HVOU):
        HFKVI(HLK_XLOWIVHGZIGGY, HVOU).__RMRG__()
        HVOU.HLK = 'XLOWIVHGZIGGY'
        HVOU.YIRVU = 'gSRH HLK RH GL XLOW IVHGZIG gy'
        HVOU.ZITFNVMGH = {}

    WVU DLIP(HVOU, ZITFNVMGH, TOLYZO_RMUL):

        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        # VMERILMNVMG XSVXPH
        RU 'NLMRGLIHBHGVN' MLG RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            IVGFIM uZOHV

        NLMRGLI = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
        # HGLK  gy
        HVOU.OLTTVI.RMUL('HGLKKRMT gy')
        ULI XLN RM NLMRGLI.XLNKLMVMGH:
            RU XLN.XLNKLMVMG == 'gy':
                HVOU.OLTTVI.RMUL('HGLKKRMT XLNKLMVMG %H'%XLN.GZT)
                NLMRGLI.VMHFIV_PROO_XLNKLMVMG(XLN.GZT)

        # HGLK NZHHIVOZB
        HVOU.OLTTVI.RMUL('HGLKKRMT NZHHIVOZB')
        ULI XLN RM NLMRGLI.XLNKLMVMGH:
            RU XLN.XLNKLMVMG == 'NZHHIVOZB':
                HVOU.OLTTVI.RMUL('HGLKKRMT XLNKLMVMG %H'%XLN.GZT)
                NLMRGLI.VMHFIV_PROO_XLNKLMVMG(XLN.GZT)

        # XOVZI GLKRXH
        HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.vMHFIVxOVZIgLKRX('gyiVXEuRVOW')
        HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.vMHFIVxOVZIgLKRX('gyiVXEuRVOWkIV')
        HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.vMHFIVxOVZIgLKRX('gyhGPiVXEuRVOW')
        HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.vMHFIVxOVZIgLKRX('gyhGPiVXEuRVOWkIV')

        # HGZIG NZHHIVOZB
        HVOU.OLTTVI.RMUL('HGZIRMT NZHHIVOZB')
        ULI XLN RM NLMRGLI.XLNKLMVMGH:
            RU XLN.XLNKLMVMG == 'NZHHIVOZB':
                HVOU.OLTTVI.RMUL('HGZIGRMT XLNKLMVMG %H'%XLN.GZT)
                NLMRGLI.NZMFZO_HGZIG_XLNKLMVMG(XLN.GZT)

        # HGZIG gy

        IVGFIM gIFV


RU __MZNV__ == '__NZRM__':
    HLK = HLK_XLOWIVHGZIGGY()
    HLK.DLIP(mLMV, mLMV)
//##**---------------- ./HGZIUOVVG/HLK/HLK_GVHG.KB
UILN HLK RNKLIG YZHV_HLK

XOZHH HLK_GVHG(YZHV_HLK.yZHVhlk):
    WVU __RMRG__(HVOU):
        HFKVI(HLK_GVHG, HVOU).__RMRG__()
        HVOU.HLK = 'GVHG'
        HVOU.YIRVU = 'GVHG'
        HVOU.ZITFNVMGH = {}

    WVU DLIP(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        KIRMG('HLK GVHG VCVXFGVW, MLGSRMT ZXGFZOOB SZKKVMVW')
//##**---------------- ./HGZIUOVVG/RMGVIUZXV/ZMZOBHRH.KB
# -*- XLWRMT: FGU-1 -*-

"""
hGZIGUOVVG.RMGVIUZXVH.TFR

gSRH NLWFOV NZMZTVH hGZIGUOVVG tfr ZMW PVVK RG FKWZGVW RM IVZOGRNV.
"""

#RNKLIG WZGVGRNV
RNKLIG MKBHXIVVM
#RNKLIG HFYKILXVHH
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
#RNKLIG KBKFYHFY ZH KY
#RNKLIG FYRJGLLO.OLT  ZH OLT
UILN XLNKLMVMG.HRNJFLGVH RNKLIG hRNjFLGVHnZMZTVI
UILN XLNKLMVMG.HRNLIWVI RNKLIG lIWVIxVMGVI
UILN RMGVIUZXV.HRNYFGGLM RNKLIG kZFHVyFGGLM


XOZHH yLCgRGOVjFLGV(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = MKBHXIVVM.nFOGRoRMVzXGRLM


XOZHH oRHGzXGRLMrMHGIFNVMG(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        HVOU.KZIVMG.XLMGIZXG = ZXG_LM_GSRH
        HVOU.KZIVMG.LIWVI_PVB = -8
        HVOU.KZIVMG.FKWZGV_JFLGV_WRHKOZB()
        HVOU.KZIVMG.FKWZGV_LIWVI_WRHKOZB()


XOZHH yLCgRGOVrMHGIFNVMG(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMrMHGIFNVMG



XOZHH oRHGzXGRLMfGIZWVvEVMG(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        HVOU.KZIVMG.LIWVI_PVB = RMG(ZXG_LM_GSRH.HKORG()[3].HGIRK())
        HVOU.KZIVMG.FKWZGV_LIWVI_WRHKOZB()


XOZHH yLCgRGOVfGIZWVvEVMG(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMfGIZWVvEVMG



XOZHH oRHGzXGRLMlIWVIvEVMG(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        HVOU.KZIVMG.LIWVI_PVB = RMG(ZXG_LM_GSRH.HKORG()[1].HGIRK())
        HVOU.KZIVMG.FKWZGV_LIWVI_WRHKOZB()

XOZHH yLCgRGOVlIWVIvEVMG(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMlIWVIvEVMG



XOZHH oRHGzXGRLMgIZWVvEVMG(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        HVOU.KZIVMG.LIWVI_PVB = RMG(ZXG_LM_GSRH.HKORG()[2].HGIRK())
        HVOU.KZIVMG.FKWZGV_LIWVI_WRHKOZB()

XOZHH yLCgRGOVgIZWVvEVMG(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMgIZWVvEVMG



XOZHH zMZOBHRHuLIN(MKBHXIVVM.zXGRLMuLIN):
    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        HVOU.PVBKIVHH_GRNVLFG = 7
        HVOU.KIVEJFLGV = HVOU.ZWW(yLCgRGOVjFLGV, MZNV="kive: ",IVOC=7, IVOB=5, NZC_DRWGS=47, NZC_SVRTSG=81, VWRGZYOV=uZOHV)
        HVOU.JFLGV = HVOU.ZWW(yLCgRGOVjFLGV, MZNV="jflgv: ",IVOC=44, IVOB=5, NZC_DRWGS=47, NZC_SVRTSG=81, VWRGZYOV=uZOHV)
        HVOU.KILTIVHH = HVOU.ZWW(MKBHXIVVM.uRCVWgVCG, IVOC=7, IVOB=7, NZC_DRWGS=47, VWRGZYOV=uZOHV)
        HVOU.RMHGIFNVMGH = HVOU.ZWW(yLCgRGOVrMHGIFNVMG, MZNV="rmh: ", IVOC=7, IVOB=77, NZC_DRWGS=87, NZC_SVRTSG=75, VWRGZYOV=gIFV)
        HVOU.LIWVIVEVMG = HVOU.ZWW(yLCgRGOVlIWVIvEVMG, MZNV="lIWVI: ",IVOC=84, IVOB=77, NZC_DRWGS=07, NZC_SVRTSG=1, VWRGZYOV=gIFV)
        HVOU.FGIZWVVEVMG = HVOU.ZWW(yLCgRGOVfGIZWVvEVMG, MZNV="fGIZWV zXGRLM: ",IVOC=84, IVOB=69, NZC_DRWGS=07, NZC_SVRTSG=1, VWRGZYOV=gIFV)
        HVOU.GIZWVVEVMG = HVOU.ZWW(yLCgRGOVgIZWVvEVMG, MZNV="iVHKLMHV ZMW gIZWV: ",IVOC=84, IVOB=61, NZC_DRWGS=07, NZC_SVRTSG=1, VWRGZYOV=gIFV)
        HVOU.JFLGVNZMZTVI = hRNjFLGVHnZMZTVI()
        HVOU.LIWVINZMZTVI = lIWVIxVMGVI(HVOU.KZIVMGzKK.GRNVI.HRN)
        HVOU.KZIVMGzKK.LIWVINZMZTVI = HVOU.LIWVINZMZTVI
        HVOU.XLMGIZXG = ""
        HVOU.LIWVI_PVB=-8
        HVOU.KZFHV_YFGGLM = HVOU.ZWW(kZFHVyFGGLM, MZNV = '  KZFHV  ', SRWWVM=uZOHV, IVOC = 49, IVOB= 7)
        HVOU.GRNVI = HVOU.KZIVMGzKK.GRNVI
        HVOU.KILTIVHH.WRHKOZB()
        HVOU.ZWW_SZMWOVIH({
            "^w": HVOU.WRHKOZB_KIVE_JFLGV,
            "^u": HVOU.WRHKOZB_MVCG_JFLGV
        })


    WVU WRHKOZB_KIVE_JFLGV(HVOU, RMKFG):
        RU OVM(HVOU.XLMGIZXG) > 9:
            HVOU.JFLGVNZMZTVI.URMW_KIVE_JFLGV(HVOU.XLMGIZXG)
            HVOU.KIVEJFLGV.EZOFVH = HVOU.JFLGVNZMZTVI.WRHKOZB_IZD_JFLGV(HVOU.XLMGIZXG, 9)
            HVOU.JFLGV.EZOFVH = HVOU.JFLGVNZMZTVI.WRHKOZB_IZD_JFLGV(HVOU.XLMGIZXG, 8)
            HVOU.JFLGV.WRHKOZB()
            HVOU.KIVEJFLGV.WRHKOZB()

    WVU WRHKOZB_MVCG_JFLGV(HVOU, RMKFG):
        RU OVM(HVOU.XLMGIZXG) > 9:
            HVOU.JFLGVNZMZTVI.URMW_MVCG_JFLGV(HVOU.XLMGIZXG)
            HVOU.KIVEJFLGV.EZOFVH = HVOU.JFLGVNZMZTVI.WRHKOZB_IZD_JFLGV(HVOU.XLMGIZXG, 9)
            HVOU.JFLGV.EZOFVH = HVOU.JFLGVNZMZTVI.WRHKOZB_IZD_JFLGV(HVOU.XLMGIZXG, 8)
            HVOU.JFLGV.WRHKOZB()
            HVOU.KIVEJFLGV.WRHKOZB()


    WVU DSROV_DZRGRMT(HVOU):
        HVOU.FKWZGV_JFLGV_WRHKOZB()
        RU HVOU.KZIVMGzKK.GRNVI.KZFHV:
            HVOU.KZFHV_YFGGLM.MZNV = 'XLMGRMFV'
        VOHV:
            HVOU.KZFHV_YFGGLM.MZNV = ' KZFHV  '

        HVOU.KILTIVHH.EZOFV = "%-89H %74H"%("MLD:",HVOU.GRNVI.NROO7GRNV( HVOU.GRNVI.HRN_MLD).HGIUGRNV("%b%N%W, %s:%n:%h.%U" )[:-6] )
        HVOU.KILTIVHH.WRHKOZB()
        HVOU.FKWZGV_LIWVI_WRHKOZB()


    WVU FKWZGV_JFLGV_WRHKOZB(HVOU):
        HVOU.JFLGVNZMZTVI.KZIHV_JFLGVH()
        RU OVM(HVOU.XLMGIZXG) > 9:
            HVOU.JFLGV.EZOFVH = HVOU.JFLGVNZMZTVI.WRHKOZB_OZGVHG_JFLGV(HVOU.XLMGIZXG, 8)
        HVOU.JFLGV.WRHKOZB()
        RU OVM(HVOU.XLMGIZXG) > 9:
            HVOU.KIVEJFLGV.EZOFVH = HVOU.JFLGVNZMZTVI.WRHKOZB_OZGVHG_JFLGV(HVOU.XLMGIZXG, 9)
        HVOU.KIVEJFLGV.WRHKOZB()
        HVOU.RMHGIFNVMGH.EZOFVH = ORHG(HVOU.JFLGVNZMZTVI.RMHGIFNVMGH)
        HVOU.RMHGIFNVMGH.WRHKOZB()


    WVU FKWZGV_LIWVI_WRHKOZB(HVOU):
        HVOU.LIWVINZMZTVI.KZIHV_LIWVI()
        RU OVM(HVOU.XLMGIZXG) > 9:
            HVOU.FGIZWVVEVMG.EZOFVH = HVOU.LIWVINZMZTVI.WRHKOZB_LIWVI_ZXGRLM(HVOU.XLMGIZXG, HVOU.LIWVI_PVB)[::-8]
            HVOU.GIZWVVEVMG.EZOFVH = HVOU.LIWVINZMZTVI.WRHKOZB_LIWVI_IVHKLMHV(HVOU.XLMGIZXG, HVOU.LIWVI_PVB)[::-8]
            HVOU.LIWVIVEVMG.EZOFVH = HVOU.LIWVINZMZTVI.WRHKOZB_LIWVI_HGZGFH(HVOU.XLMGIZXG, HVOU.LIWVI_PVB)[::-8]
        HVOU.FGIZWVVEVMG.WRHKOZB()
        HVOU.GIZWVVEVMG.WRHKOZB()
        HVOU.LIWVIVEVMG.WRHKOZB()


    WVU YZXP_GL_NZRM(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()

    WVU LM_LP(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()

    WVU LM_XZMXVO(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()

//##**---------------- ./HGZIUOVVG/RMGVIUZXV/HRNYFGGLM.KB
# -*- XLWRMT: FGU-1 -*-

"""
hGZIGUOVVG.RMGVIUZXVH.TFR

gSRH NLWFOV NZMZTVH hGZIGUOVVG tfr ZMW PVVK RG FKWZGVW RM IVZOGRNV.
"""

RNKLIG MKBHXIVVM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")




XOZHH kIVKZIVyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        HVOU.KZIVMG.KZIVMGzKK.KFYHFYNZMZTVI.IVHVG_HRN()
        HVOU.KZIVMG.KZIVMGzKK.HBHGVN.KIVKZIV_HRN(HVOU.KZIVMG.KZIVMGzKK.TVGuLIN("nzrm"))
        HVOU.KZIVMG.KZIVMGzKK.GRNVI.IFMMRMT = uZOHV
        HVOU.KZIVMG.KZIVMGzKK.GRNVI.IVHVG_HRN()
        HVOU.KZIVMG.KZIVMGzKK.LIWVINZMZTVI.IVHVG()



XOZHH hGZIGyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        HVOU.KZIVMG.KZIVMGzKK.HBHGVN.HGZIG_HRN()
        HVOU.KZIVMG.KZIVMGzKK.GRNVI.HRN_YVTRM()
        HVOU.KZIVMG.KZIVMGzKK.GRNVI.HGLK =  uZOHV
        HVOU.KZIVMG.KZIVMGzKK.GRNVI.IFMMRMT = gIFV


XOZHH kZFHVyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        RU HVOU.KZIVMG.KZIVMGzKK.GRNVI.KZFHV:
            HVOU.KZIVMG.KZIVMGzKK.GRNVI.HRN_XLMGRMFV()
        VOHV:
            HVOU.KZIVMG.KZIVMGzKK.GRNVI.HRN_KZFHV()

XOZHH hGLKyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        HVOU.KZIVMG.KZIVMGzKK.GRNVI.IFMMRMT = uZOHV
        HVOU.KZIVMG.KZIVMGzKK.HBHGVN.PROO_ZOO()



//##**---------------- ./HGZIUOVVG/RMGVIUZXV/KLKFK/HVOVXGKLK.KB
RNKLIG MKBHXIVVM ZH MK

XOZHH NBkLKhVOVXG(MK.mkhzKKnZMZTVW):

    WVU HVGLKG(HVOU, GRGOV, LoRHG):
        HVOU.GRGOV = GRGOV
        HVOU.LKGRLMH = LoRHG
        HVOU.SVRTSG = OVM(HVOU.LKGRLMH)+8

    WVU NZRM(HVOU):
        HVOU.u = MK.kLKFK(MZNV="xSLLHV ZM LKGRLM")
        LKG = HVOU.u.ZWW(MK.gRGOVhVOVXGlMV, MZNV=HVOU.GRGOV, NZC_SVRTSG=HVOU.SVRTSG, EZOFVH=HVOU.LKGRLMH, HXILOO_VCRG=gIFV)
        HVOU.u.VWRG()
        HVOU._EZOFVH = LKG.TVG_HVOVXGVW_LYQVXGH()
        HVOU.IVHFOG = ( HVOU._EZOFVH[9] )
        KIRMG WRI(HVOU.u)


WVU xSLLHVlKGRLM(GRGOV, LoRHG):
    KLK = NBkLKhVOVXG()
    KLK.HVGLKG(GRGOV, LoRHG)
    KLK.IFM()
    IVGFIM WRI(KLK)


# hSLD Z KLKFK DRGS IZWRLYFGGLMH GL HVOVXG 8 RGVN UILN Z ORHG
# KIRMG xSLLHVlKGRLM('XSLLHV Z HRMTOV VOVNVMG', ['Z','Y','X','W'])
//##**---------------- ./HGZIUOVVG/RMGVIUZXV/KLKFK/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/RMGVIUZXV/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/RMGVIUZXV/TFR.KB
# -*- XLWRMT: FGU-1 -*-

"""
hGZIGUOVVG.RMGVIUZXVH.TFR

gSRH NLWFOV NZMZTVH hGZIGUOVVG tfr ZMW PVVK RG FKWZGVW RM IVZOGRNV.
"""

RNKLIG WZGVGRNV
RNKLIG MKBHXIVVM
#RNKLIG HFYKILXVHH
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG FYRJGLLO.FGRO
RNKLIG KBKFYHFY ZH KY
#RNKLIG FYRJGLLO.OLT  ZH OLT
UILN RMGVIUZXV.ZMZOBHRH RNKLIG zMZOBHRHuLIN
UILN RMGVIUZXV.HRNYFGGLM RNKLIG kIVKZIVyFGGLM, hGZIGyFGGLM, hGLKyFGGLM, kZFHVyFGGLM

XOZHH oRHGzXGRLMxLMGILO(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        HVOU.KZIVMG.KZIVMGzKK.XLMGILO_HVG()


XOZHH yLCgRGOVzXGRLMxLMGILO(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMxLMGILO



XOZHH oRHGzXGRLMnVHHZTV(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        HVOU.KZIVMG.KZIVMGzKK.IRHPXLMGILO_HVG()


XOZHH yLCgRGOVzXGRLMnVHHZTV(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMnVHHZTV

XOZHH oRHGzXGRLMxZHSgIZMHUVI(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        HVOU.KZIVMG.KZIVMGzKK.XZHS_GIZMHUVI_HVG()


XOZHH yLCgRGOVzXGRLMxZHSgIZMHUVI(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMxZHSgIZMHUVI



XOZHH oRHGzXGRLMkFYHFY(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        GZITVG = ZXG_LM_GSRH.HKORG()
        RU GZITVG == "glkrx":
            KZHH
        VOHV:
            HVOU.KZIVMG.KZIVMGzKK.KFYHFY_HVG(GZITVG)


XOZHH yLCgRGOVzXGRLMkFYHFY(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMkFYHFY



XOZHH oRHGzXGRLMzKK(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        GZITVG = ZXG_LM_GSRH.HKORG()
        RU GZITVG[9] == "rw":
            KZHH
        VOHV:
            HVOU.KZIVMG.KZIVMGzKK.ZKK_HVG(GZITVG)


XOZHH yLCgRGOVzXGRLMzKK(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMzKK


XOZHH oRHGzXGRLMhRN(MKBHXIVVM.nFOGRoRMVzXGRLM):
    WVU ZXGRLMsRTSORTSGVW(HVOU, ZXG_LM_GSRH, PVB_KIVHH ):
        GZITVG = ZXG_LM_GSRH.HKORG(':')[9]
        RU GZITVG == "MLD":
            KZHH
        VOHV:
            HVOU.KZIVMG.KZIVMGzKK.HRN_HVG()

XOZHH yLCgRGOVzXGRLMhRN(MKBHXIVVM.yLCgRGOV):
    _XLMGZRMVW_DRWTVG = oRHGzXGRLMhRN


XOZHH zKKhGZIGyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        HVOU.KZIVMG.ZKK.IFM()


XOZHH zKKhGLKyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        HVOU.KZIVMG.ZKK.PROO()


XOZHH zKKhRNyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        HVOU.KZIVMG.ZKK.HRN_IFM()



XOZHH xOVZIgLKRXyFGGLM(MKBHXIVVM.yFGGLMkIVHH):
    WVU DSVMkIVHHVW(HVOU):
        HVOU.KZIVMG.KZIVMGzKK.KFYHFYNZMZTVI.xOVZIgLKRX(HVOU.KZIVMG.GLKRX.EZOFV)
        MKBHXIVVM.MLGRUB_XLMURIN("kFYHFY GLKRX "+HVOU.KZIVMG.GLKRX.EZOFV+" iVHVG")



XOZHH hRNuLIN(MKBHXIVVM.zXGRLMuLIN):

    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        HVOU.HGZIG = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="HGZIG: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.HGZIG.EZOFV = HGI(HVOU.KZIVMGzKK.GRNVI.HRN_HGZIG_WG)
        HVOU.VMW = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="VMW: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.VMW.EZOFV = HGI(HVOU.KZIVMGzKK.GRNVI.HRN_VMW_WG)
        HVOU.HKVVW = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="HKVVW: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.HKVVW.EZOFV = HGI(HVOU.KZIVMGzKK.GRNVI.HRN_HKVVW)

    WVU LM_LP(HVOU):
        MKBHXIVVM.MLGRUB_XLMURIN("hRN hVGGRMT iVHVG")
        HVOU.KZIVMGzKK.GRNVI.HRN_HKVVW = RMG(HVOU.HKVVW.EZOFV)
        GRNVI = HVOU.KZIVMGzKK.GRNVI
        HGZIG = WZGVGRNV.WZGVGRNV.HGIKGRNV(HVOU.HGZIG.EZOFV, "%b-%N-%W %s:%n:%h")
        VMW = WZGVGRNV.WZGVGRNV.HGIKGRNV(HVOU.VMW.EZOFV, "%b-%N-%W %s:%n:%h")
        GRNVI.HRN_HGZIG_WG = HGZIG
        GRNVI.HRN_VMW_WG = VMW
        GRNVI.HRN_HGZIG = (HGZIG - WZGVGRNV.WZGVGRNV(8029, 8, 8, 1)).GLGZO_HVXLMWH()*8999*8999
        GRNVI.HRN_VMW = (VMW - WZGVGRNV.WZGVGRNV(8029, 8, 8, 1)).GLGZO_HVXLMWH()*8999*8999
        GRNVI.HRN_MLD = GRNVI.HRN_HGZIG
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()

    WVU LM_XZMXVO(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()



XOZHH kFYhFYuLIN(MKBHXIVVM.zXGRLMuLIN):

    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        HVOU.GLKRX = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="gLKRX: ", NZC_DRWGS=47, VWRGZYOV=uZOHV)
        HVOU.HRN_YFGGLM = HVOU.ZWW(xOVZIgLKRXyFGGLM, MZNV = 'xOVZI', IVOC = 2,IVOB= 5)

    WVU LM_LP(HVOU):
        MKBHXIVVM.MLGRUB_XLMURIN("kFYHFY hVGGRMT iVHVG")
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()

    WVU LM_XZMXVO(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()


XOZHH xZHSgIZMHUVIuLIN(MKBHXIVVM.zXGRLMuLIN):
    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        HVOU.ZXXLFMG = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="zXXLFMG: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.GBKV = HVOU.ZWW(MKBHXIVVM.gRGOVhVOVXGlMV,EZOFV=[8,], MZNV="gBKV: ",NZC_SVRTSG=5, VWRGZYOV=gIFV)
        HVOU.GBKV.EZOFVH = ["HGLXP", "UFGFIVH"]
        HVOU.WRIVXGRLM = HVOU.ZWW(MKBHXIVVM.gRGOVhVOVXGlMV,EZOFV=[8,], MZNV="wRIVXGRLM: ",NZC_SVRTSG=5, VWRGZYOV=gIFV)
        HVOU.WRIVXGRLM.EZOFVH = ["rm", "lfg"]
        HVOU.ZNLFMG = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="xZHS: ", NZC_DRWGS=47, VWRGZYOV=gIFV)


    WVU LM_LP(HVOU):
        MKBHXIVVM.MLGRUB_XLMURIN("xZHS gIZMHUVI fKWZGVW")
        IX = KY.xZHSgIZMHUVI()
        IX.ZXXLFMG = HVOU.ZXXLFMG.EZOFV
        IX.GBKV = HVOU.GBKV.EZOFVH[HVOU.GBKV.EZOFV[9]]
        IX.RW = FYRJGLLO.FGRO.TVMVIZGV_IZMWLN_HGIRMT(2)
        WRIVXGRLM=['R','L']
        IX.kFYwZGV = RMG(WZGVGRNV.WZGVGRNV.GLWZB().HGIUGRNV("%b%N%W"))
        IX.WRIVXGRLM = WRIVXGRLM[HVOU.WRIVXGRLM.EZOFV[9]]
        IX.ZNLFMG = RMG(HVOU.ZNLFMG.EZOFV)
        IX.kFYgRNVhGZNK = RMG(WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%s%n%h%U')[:-6])
        HVOU.KZIVMGzKK.XZHSGIZMHUVIKFY.kFYORHS(IX)
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()


    WVU LM_XZMXVO(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()


XOZHH iRHPxLMGILOuLIN(MKBHXIVVM.zXGRLMuLIN):
    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        HVOU.HBNYLO = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="hBNYLO: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.HBNYLOGBKV = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="hBNYLOgBKV: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.GZITVG = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="gZITVG: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.XLNNZMW = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="xLNNZMW: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.OVEVO = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="oVEVO: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.MLGRXV = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="mLGRXV: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.GBKV = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="gBKV: ", NZC_DRWGS=47, VWRGZYOV=gIFV)


    WVU LM_LP(HVOU):
        MKBHXIVVM.MLGRUB_XLMURIN("iRHPxLMGILO mLGRXV hVMG")
        IX = KY.iRHPxLMGILOmLGRXV()
        IX.GBKV = HVOU.GBKV.EZOFV
        IX.HBNYLO = HVOU.HBNYLO.EZOFV
        IX.HBNYLOGBKV = HVOU.HBNYLOGBKV.EZOFV
        IX.MLGRXV = HVOU.MLGRXV.EZOFV
        IX.GZITVG = HVOU.GZITVG.EZOFV
        IX.XLNNZMW = HVOU.XLNNZMW.EZOFV
        IX.OVEVO = RMG(HVOU.OVEVO.EZOFV)
        IX.GRNVHGZNK = RMG(
            8999*(WZGVGRNV.WZGVGRNV.FGXMLD()-WZGVGRNV.WZGVGRNV(8029, 8, 8)).GLGZO_HVXLMWH()
        )
        HVOU.KZIVMGzKK.IRHPXLMGILOKFY.kFYORHS(IX)
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()


    WVU LM_XZMXVO(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()

XOZHH xLMGILOoRTSGuLIN(MKBHXIVVM.zXGRLMuLIN):
    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        HVOU.GZITVG = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="gZITVG: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.XLNNZMW = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="xLNNZMW: ", NZC_DRWGS=47, VWRGZYOV=gIFV)
        HVOU.GRGOV = HVOU.ZWW(MKBHXIVVM.gRGOVhVOVXGlMV,EZOFV=[8,], MZNV="xLMGILO: ",NZC_SVRTSG=5, VWRGZYOV=gIFV)
        HVOU.GRGOV.EZOFVH = ["IVWORTSG","TIVVMORTSG","BVOOLDORTSG"]


    WVU LM_LP(HVOU):
        MKBHXIVVM.MLGRUB_XLMURIN("xLMGILO nVHHZTV hVMG")
        IX = KY.xLMGILO()
        IX.GZITVG = HVOU.GZITVG.EZOFV
        IX.XLNNZMW = HVOU.XLNNZMW.EZOFV
        IX.XLMGILO = HVOU.GRGOV.EZOFVH[HVOU.GRGOV.EZOFV[9]]
        IX.kFYgRNVhGZNK = RMG(
            8999*RMG(WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV("%s%n%h")))
        IX.kFYwZGV = RMG( WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV("%b%N%W") )
        IX.NVHHZTV = "hGZIuOVVG nZMFZO rHHFVW"
        HVOU.KZIVMGzKK.XLMGILOKFY.kFYORHS(IX)
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()


    WVU LM_XZMXVO(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()




XOZHH zKKuLIN(MKBHXIVVM.zXGRLMuLIN):
    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        HVOU.KILTIZN = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="KILTIZN: ",IVOC=88, NZC_DRWGS=47, VWRGZYOV=uZOHV)
        HVOU.rw = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="rw: ", NZC_DRWGS=49, IVOC=88, VWRGZYOV=uZOHV)
        HVOU.KRW = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="KRW: ", NZC_DRWGS=49, IVOC=88,VWRGZYOV=uZOHV)
        HVOU.HGZGFH = HVOU.ZWW(MKBHXIVVM.gRGOVgVCG, MZNV="HGZGFH: ", IVOC=88,NZC_DRWGS=47, VWRGZYOV=uZOHV)
        HVOU.HGZIG_YFGGLM = HVOU.ZWW(zKKhGZIGyFGGLM, MZNV = 'hGZIG', IVOC = 88,IVOB= 1)
        HVOU.HGLK_YFGGLM = HVOU.ZWW(zKKhGLKyFGGLM, MZNV = 'hGLK', IVOC = 62,IVOB= 1)
        HVOU.HRN_YFGGLM = HVOU.ZWW(zKKhRNyFGGLM, MZNV = 'hRN', IVOC = 32,IVOB= 1)


    WVU DSROV_DZRGRMT(HVOU):
        HVOU.ZKK.NLMRGLI()
        HVOU.KILTIZN.EZOFV = HVOU.ZKK.XLNKLMVMG
        HVOU.rw.EZOFV = HVOU.ZKK.GZT
        HVOU.KRW.EZOFV = HVOU.ZKK.KRW
        HVOU.HGZGFH.EZOFV = HVOU.ZKK.HGZGFH


    WVU LM_LP(HVOU):
        MKBHXIVVM.MLGRUB_XLMURIN("zKK iVHVG")
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()

    WVU LM_XZMXVO(HVOU):
        HVOU.KZIVMGzKK.YZXP_GL_NZRM()



XOZHH dRMWLDuLIN(MKBHXIVVM.zXGRLMuLIN):
    WVU XIVZGV(HVOU, *ZITH, **PVBDLIWH):
        # HFKVI(dRMWLDuLIN, HVOU).XIVZGV(*ZITH, **PVBDLIWH)
        HVOU.KLKFK = {}
        HVOU.KLKFK["NLWV"] = ["HRN","MLINZO"]
        HVOU.GRNVI = HVOU.KZIVMGzKK.GRNVI;

        RU HVOU.GRNVI.HRN:
            HVOU.KIVKZIV_YFGGLM = HVOU.ZWW(kIVKZIVyFGGLM, MZNV = 'KIVKZIV', IVOC = 85,IVOB= 7)
            HVOU.HGZIG_YFGGLM = HVOU.ZWW(hGZIGyFGGLM, MZNV = 'HGZIG', IVOC = 67,IVOB= 7)
            HVOU.KZFHV_YFGGLM = HVOU.ZWW(kZFHVyFGGLM, MZNV = '  KZFHV ', SRWWVM=uZOHV, IVOC = 49, IVOB= 7)
            HVOU.HGLK_YFGGLM = HVOU.ZWW(hGLKyFGGLM, MZNV = 'HGLK', IVOC = 29,IVOB= 7)

        HVOU.HBHGVN_HGZGFH = HVOU.ZWW(yLCgRGOVzXGRLMhRN, MZNV="hGZGFH", NZC_SVRTSG=89, NZC_DRWGS=55, IVOC=7, IVOB=5)
        HVOU.KFYHFY_HGZGFH = HVOU.ZWW(yLCgRGOVzXGRLMkFYHFY, MZNV="kFYHFY", NZC_SVRTSG=89, NZC_DRWGS=45, IVOC=53, IVOB=5)
        HVOU.NLWFOV_HGZGFH = HVOU.ZWW(yLCgRGOVzXGRLMzKK, MZNV="xLNKLMVMGH", NZC_SVRTSG=89, NZC_DRWGS=01, IVOC=7, IVOB=85)
        HVOU.NVHHZTVH = HVOU.ZWW(yLCgRGOVzXGRLMnVHHZTV, MZNV="iRHPxLMGILO nVHHZTV", NZC_SVRTSG=88, NZC_DRWGS=01, IVOC=7, IVOB=75)
        HVOU.XZHS_GIZMHUVI = HVOU.ZWW(yLCgRGOVzXGRLMxZHSgIZMHUVI, MZNV="xZHSgIZMHUVI", NZC_SVRTSG=88, NZC_DRWGS=01, IVOC=7, IVOB=64)
        HVOU.XLMGILO_HGZGFH = HVOU.ZWW(yLCgRGOVzXGRLMxLMGILO, MZNV="xLMGILO nVHHZTV", NZC_SVRTSG=88, NZC_DRWGS=01, IVOC=7, IVOB=53)
        HVOU.ZWW_SZMWOVIH({
            "^p": HVOU.KZIVMGzKK.ZMZOBHRH_HVG
        })



    WVU LM_XZMXVO(HVOU):
        HVOU.GRNVI.VCRG  = gIFV
        VCRG(8)


    WVU LM_LP(HVOU):
        HVOU.GRNVI.VCRG = gIFV
        VCRG(8)


    WVU DSROV_DZRGRMT(HVOU):
        HVOU.KZIVMGzKK.HBHGVN.XSVXP()
        HVOU.HBHGVN_HGZGFH.EZOFVH = HVOU.KZIVMGzKK.HBHGVN.XLNKROV_HGZGFH()
        HVOU.NLWFOV_HGZGFH.EZOFVH = HVOU.KZIVMGzKK.HBHGVN.XLNKROV_XLNKLMVMGH()
        HVOU.KFYHFY_HGZGFH.EZOFVH = HVOU.KZIVMGzKK.KFYHFYNZMZTVI.XLNKROV_HGZGFH()
        HVOU.XZHS_GIZMHUVI.EZOFVH = HVOU.KZIVMGzKK.XZHSGIZMHUVI.XLNKROV_HGZGFH()
        HVOU.NVHHZTVH.EZOFVH = HVOU.KZIVMGzKK.HBHGVNNVHHZTV.XLNKROV_HGZGFH()
        HVOU.XLMGILO_HGZGFH.EZOFVH = HVOU.KZIVMGzKK.HBHGVNXLMGILO.XLNKROV_HGZGFH()
        HVOU.NLWFOV_HGZGFH.WRHKOZB()
        HVOU.HBHGVN_HGZGFH.WRHKOZB()
        HVOU.KFYHFY_HGZGFH.WRHKOZB()
        HVOU.XZHS_GIZMHUVI.WRHKOZB()
        HVOU.NVHHZTVH.WRHKOZB()
        HVOU.XLMGILO_HGZGFH.WRHKOZB()
        RU MLG HVOU.GRNVI.HRN:
            IVGFIM
        RU HVOU.GRNVI.KZFHV:
            HVOU.KZFHV_YFGGLM.MZNV = "XLMGRMFV"
        VOHV:
            HVOU.KZFHV_YFGGLM.MZNV = "KZFHV"
        HVOU.KZFHV_YFGGLM.WRHKOZB()


XOZHH hGZIGUOVVGtfr(MKBHXIVVM.mkhzKKnZMZTVW):

    PVBKIVHH_GRNVLFG_WVUZFOG = 89
    PVBKIVHH_GRNVLFG = 89


    WVU LMhGZIG(HVOU):
        HVOU.ZWWuLIN("nzrm", dRMWLDuLIN, MZNV="hGZIuOVVG: hbhgvn nlmrgli")
        RU HVOU.RH_HRN:
            HVOU.ZWWuLIN("hrn", hRNuLIN, MZNV="hRN hVGGRMT")
        HVOU.ZWWuLIN("zkk", zKKuLIN, MZNV="zKK hVGGRMT")
        HVOU.ZWWuLIN("kfyhfy", kFYhFYuLIN, MZNV="kFYHFY hVGGRMT")
        HVOU.ZWWuLIN("xzhsgizmhuvi", xZHSgIZMHUVIuLIN, MZNV="xZHS gIZMHUVI")
        HVOU.ZWWuLIN("irhpxlmgilo", iRHPxLMGILOuLIN, MZNV="nZMFZO iRHPxLMGILO")
        HVOU.ZWWuLIN("xlmgiloortsg", xLMGILOoRTSGuLIN, MZNV="nZMFZO xLMGILO gLTTOV")
        HVOU.ZWWuLIN("zmzobhrh", zMZOBHRHuLIN, MZNV="zMZOBHRH xVMGVI")


    WVU __RMRG__(HVOU, HRN, HBHGVN, GRNVI, KFYHFYNZMZTVI, HBHGVNNVHHZTV, HBHGVNXLMGILO, XZHSGIZMHUVI, HVGGRMTH):
        # MKBHXIVVM ULIN DRWTVG, KZIVMG LU ZOO DRWTVGH RM tfr
        HFKVI(hGZIGUOVVGtfr, HVOU).__RMRG__()
        HVOU.DRMWLD = mLMV
        HVOU.HVGGRMTH = HVGGRMTH
        HVOU.GRNVI = GRNVI
        HVOU.HBHGVN = HBHGVN
        HVOU.HBHGVNNVHHZTV = HBHGVNNVHHZTV
        HVOU.HBHGVNXLMGILO = HBHGVNXLMGILO
        HVOU.XZHSGIZMHUVI = XZHSGIZMHUVI
        HVOU.KFYHFYNZMZTVI= KFYHFYNZMZTVI
        HVOU.RH_HRN = HRN
        KY.lKVMkFYHFY()
        HVOU.IRHPXLMGILOKFY = KY.iRHPxLMGILOmLGRXVkFYORHSVI()
        HVOU.XLMGILOKFY = KY.xLMGILOkFYORHSVI()
        HVOU.XZHSGIZMHUVIKFY = KY.xZHSgIZMHUVIkFYORHSVI()



    WVU YZXP_GL_NZRM(HVOU):
        HVOU.HDRGXSuLIN("nzrm")
        HVOU.IVHVGsRHGLIB()


    WVU HRN_HVG(HVOU):
        HVOU.HDRGXSuLIN("hrn")
        HVOU.IVHVGsRHGLIB()


    WVU IRHPXLMGILO_HVG(HVOU):
        HVOU.HDRGXSuLIN("irhpxlmgilo")
        HVOU.IVHVGsRHGLIB()

    WVU XZHS_GIZMHUVI_HVG(HVOU):
        HVOU.HDRGXSuLIN("xzhsgizmhuvi")
        HVOU.IVHVGsRHGLIB()


    WVU ZMZOBHRH_HVG(HVOU, RMKFG):
        HVOU.HDRGXSuLIN("zmzobhrh")
        HVOU.IVHVGsRHGLIB()

    WVU XLMGILO_HVG(HVOU):
        HVOU.HDRGXSuLIN("xlmgiloortsg")
        HVOU.IVHVGsRHGLIB()


    WVU KFYHFY_HVG(HVOU, GZITVG):
        ULIN = HVOU.TVGuLIN("kfyhfy")
        ULIN.GLKRX.EZOFV = GZITVG[9]
        HVOU.HDRGXSuLIN("kfyhfy")
        HVOU.IVHVGsRHGLIB()


    WVU ZKK_HVG(HVOU, RW):
        ULIN  = HVOU.TVGuLIN("zkk")
        ULIN.ZKK = HVOU.HBHGVN.ZKK_NZK[RW[9]]
        ULIN.rw.EZOFV = RW[9]
        ULIN.KILTIZN.EZOFV = RW[8]
        ULIN.HGZGFH.EZOFV = RW[7]
        ULIN.KRW.EZOFV = RW[6]
        HVOU.HDRGXSuLIN("zkk")
        HVOU.IVHVGsRHGLIB()
//##**---------------- ./HGZIUOVVG/XKK/HGZIUOVVG_XORVMG.XX
/*
 *
 * xLKBIRTSG 7984 Tikx ZFGSLIH.
 *
 * oRXVMHVW FMWVI GSV zKZXSV oRXVMHV, eVIHRLM 7.9 (GSV "oRXVMHV");
 * BLF NZB MLG FHV GSRH UROV VCXVKG RM XLNKORZMXV DRGS GSV oRXVMHV.
 * bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
 *
 *     SGGK://DDD.ZKZXSV.LIT/ORXVMHVH/orxvmhv-7.9
 *
 * fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV
 * WRHGIRYFGVW FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh,
 * drgslfg dziizmgrvh li xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW.
 * hVV GSV oRXVMHV ULI GSV HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW
 * ORNRGZGRLMH FMWVI GSV oRXVMHV.
 *
 */

#RMXOFWV <RLHGIVZN>
#RMXOFWV <NVNLIB>
#RMXOFWV <IZMWLN>
#RMXOFWV <HGIRMT>
#RMXOFWV <GSIVZW>

#RMXOFWV <TIKX/TIKX.S>
#RMXOFWV <TIKX++/XSZMMVO.S>
#RMXOFWV <TIKX++/XORVMG_XLMGVCG.S>
#RMXOFWV <TIKX++/XIVZGV_XSZMMVO.S>
#RMXOFWV <TIKX++/HVXFIRGB/XIVWVMGRZOH.S>
#RMXOFWV "HGZIUOVVG_XORVMG.S"
#RMXOFWV "FYRJ_GLLO.S"

FHRMT TIKX::xSZMMVO;
FHRMT TIKX::xORVMGxLMGVCG;
FHRMT TIKX::xORVMGiVZWVI;
FHRMT TIKX::xORVMGiVZWVIdIRGVI;
FHRMT TIKX::xORVMGdIRGVI;
FHRMT TIKX::hGZGFH;


hGZIUOVVGxORVMG::hGZIUOVVGxORVMG(XLMHG XSZI* HVIEVI, XLMHG XSZI* KLIG)
{
    XSZI WVHG[871];
    HKIRMGU(WVHG, "%H:%H", HVIEVI, KLIG);
    XSZMMVO_ = TIKX::xIVZGVxSZMMVO(WVHG, TIKX::rMHVXFIVxSZMMVOxIVWVMGRZOH());
    HGFY_ = hGZIUOVVGwLXPVI::tIVVGVI::mVDhGFY(XSZMMVO_);
    SLHG = FYRJGLLO::tVGfYRJsLHG();
    WLNZRM = FYRJGLLO::tVGfYRJwLNZRM();
}


hGZIUOVVGwLXPVI::qLYiVJFVHG hGZIUOVVGxORVMG::MVD_QLY(){
   IVGFIM hGZIUOVVGwLXPVI::qLYiVJFVHG();
}


//hGZIUOVVGwLXPVI::qLYiVJFVHG hGZIUOVVGxORVMG::RMUL_GL_HGZIUOVVG(XLMHG XSZI* WHG)
//{
    //ZFGL WZGZ = hGZIUOVVGwLXPVI::qLYiVJFVHG();
    //WZGZ.HVG_WHG(WHG);
    //WZGZ.HVG_NZTRX("_RMUL_GL_HGZIUOVVG_");
    //IVGFIM WZGZ;
//}

//hGZIUOVVGwLXPVI::qLYiVJFVHG hGZIUOVVGxORVMG::XLNNZMW_GL_HGZIUOVVG(XLMHG XSZI* WHG)
//{
    //ZFGL WZGZ = hGZIUOVVGwLXPVI::qLYiVJFVHG();
    //WZGZ.HVG_WHG(WHG);
    //WZGZ.HVG_NZTRX("_XLNNZMW_GL_HGZIUOVVG_");
    //IVGFIM WZGZ;
//}

//hGZIUOVVGwLXPVI::qLYiVJFVHG hGZIUOVVGxORVMG::DZIMRMT_GL_HGZIUOVVG(XLMHG XSZI* WHG)
//{
    //ZFGL WZGZ = hGZIUOVVGwLXPVI::qLYiVJFVHG();
    //WZGZ.HVG_WHG(WHG);
    //WZGZ.HVG_NZTRX("_DZIMRMT_GL_HGZIUOVVG_");
    //IVGFIM WZGZ;
//}

hGZIUOVVGwLXPVI::qLYiVKOB hGZIUOVVGxORVMG::HVMW(hGZIUOVVGwLXPVI::qLYiVJFVHG WZGZ, RMG GRNVLFG)
{
    xORVMGxLMGVCG XLMGVCG;
    hGZIUOVVGwLXPVI::qLYiVKOB IVKOB;
    //WZGZ.HVG_SLNV(SLHG);
    //WZGZ.HVG_HIX(SLHG);
    //HGW::XLFG<<"SZSZ"<<HGW::VMWO;
    //HGW::XLFG<<SLHG<<HGW::VMWO;
    hGZGFH HGZGFH = HGFY_->hVMWqLY(&XLMGVCG,WZGZ, &IVKOB);
    RU ( HGZGFH.LP() )
    {
        IVGFIM IVKOB;
    }
    VOHV
    {
        IVKOB.HVG_HGZGFH(UZOHV);
        IVKOB.HVG_NVHHZTV( HGZGFH.VIILI_NVHHZTV() );
    }
    IVGFIM IVKOB;
}


//##**---------------- ./HGZIUOVVG/XKK/HGZIUOVVG_XORVMG.S
/*
 *
 * xLKBIRTSG 7984 Tikx ZFGSLIH.
 *
 * oRXVMHVW FMWVI GSV zKZXSV oRXVMHV, eVIHRLM 7.9 (GSV "oRXVMHV");
 * BLF NZB MLG FHV GSRH UROV VCXVKG RM XLNKORZMXV DRGS GSV oRXVMHV.
 * bLF NZB LYGZRM Z XLKB LU GSV oRXVMHV ZG
 *
 *     SGGK://DDD.ZKZXSV.LIT/ORXVMHVH/orxvmhv-7.9
 *
 * fMOVHH IVJFRIVW YB ZKKORXZYOV OZD LI ZTIVVW GL RM DIRGRMT, HLUGDZIV
 * WRHGIRYFGVW FMWVI GSV oRXVMHV RH WRHGIRYFGVW LM ZM "zh rh" yzhrh,
 * drgslfg dziizmgrvh li xlmwrgrlmh lu zmb prmw, VRGSVI VCKIVHH LI RNKORVW.
 * hVV GSV oRXVMHV ULI GSV HKVXRURX OZMTFZTV TLEVIMRMT KVINRHHRLMH ZMW
 * ORNRGZGRLMH FMWVI GSV oRXVMHV.
 *
 */

#RMXOFWV <RLHGIVZN>
#RMXOFWV <NVNLIB>
#RMXOFWV <IZMWLN>
#RMXOFWV <HGIRMT>
#RMXOFWV <GSIVZW>

#RMXOFWV <TIKX/TIKX.S>
#RMXOFWV <TIKX++/XSZMMVO.S>
#RMXOFWV <TIKX++/XORVMG_XLMGVCG.S>
#RMXOFWV <TIKX++/XIVZGV_XSZMMVO.S>
#RMXOFWV <TIKX++/HVXFIRGB/XIVWVMGRZOH.S>
#RMXOFWV "XKK/WLXPVI.TIKX.KY.S"
#RMXOFWV "XKK/WLXPVI.KY.S"

FHRMT TIKX::xSZMMVO;
FHRMT TIKX::xORVMGxLMGVCG;
FHRMT TIKX::xORVMGiVZWVI;
FHRMT TIKX::xORVMGiVZWVIdIRGVI;
FHRMT TIKX::xORVMGdIRGVI;
FHRMT TIKX::hGZGFH;


XOZHH hGZIUOVVGxORVMG {
    KILGVXGVW:
        HGW::HGIRMT SLHG;
        HGW::HGIRMT WLNZRM;
        HGW::FMRJFV_KGI<hGZIUOVVGwLXPVI::tIVVGVI::hGFY> HGFY_;
        HGW::HSZIVW_KGI<xSZMMVO> XSZMMVO_;
    KFYORX:
        hGZIUOVVGxORVMG(XLMHG XSZI* HVIEVI, XLMHG XSZI* KLIG);

        hGZIUOVVGwLXPVI::qLYiVJFVHG MVD_QLY();

        hGZIUOVVGwLXPVI::qLYiVKOB HVMW(hGZIUOVVGwLXPVI::qLYiVJFVHG WZGZ, RMG GRNVLFG = 9);

        //hGZIUOVVGwLXPVI::fMREVIHZOnVHHZTV RMUL_GL_HGZIUOVVG(XLMHG XSZI* WHG);

        //hGZIUOVVGwLXPVI::fMREVIHZOnVHHZTV DZIMRMT_GL_HGZIUOVVG(XLMHG XSZI* WHG);

        //hGZIUOVVGwLXPVI::fMREVIHZOnVHHZTV XLNNZMW_GL_HGZIUOVVG(XLMHG XSZI* WHG);


};


//##**---------------- ./HGZIUOVVG/XKK/XLNNZMW.TIKX.KY.S
// tVMVIZGVW YB GSV Tikx x++ KOFTRM.
// rU BLF NZPV ZMB OLXZO XSZMTV, GSVB DROO YV OLHG.
// HLFIXV: XLNNZMW.KILGL
#RUMWVU tikx_XLNNZMW_7VKILGL__rmxofwvw
#WVURMV tikx_XLNNZMW_7VKILGL__rmxofwvw

#RMXOFWV "XLNNZMW.KY.S"

#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_HGIVZN.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_FMZIB_XZOO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/NVGSLW_SZMWOVI_RNKO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/KILGL_FGROH.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/IKX_NVGSLW.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HVIERXV_GBKV.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HGZGFH.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HGFY_LKGRLMH.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HBMX_HGIVZN.S>

MZNVHKZXV TIKX {
XOZHH xLNKOVGRLMjFVFV;
XOZHH xSZMMVO;
XOZHH iKXhVIERXV;
XOZHH hVIEVIxLNKOVGRLMjFVFV;
XOZHH hVIEVIxLMGVCG;
}  // MZNVHKZXV TIKX

MZNVHKZXV hGZIUOVVGxLNNZMW {

// gSV TIVVGRMT HVIERXV WVURMRGRLM.
XOZHH tIVVGVI URMZO {
 KFYORX:
  HGZGRX XLMHGVCKI XSZI XLMHG* HVIERXV_UFOO_MZNV() {
    IVGFIM "hGZIUOVVGxLNNZMW.tIVVGVI";
  }
  XOZHH hGFYrMGVIUZXV {
   KFYORX:
    ERIGFZO ~hGFYrMGVIUZXV() {}
    // hVMWH Z TIVVGRMT
    ERIGFZO ::TIKX::hGZGFH hZBsVOOL(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV) = 9;
    HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>> zHBMXhZBsVOOL(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
      IVGFIM HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>>(zHBMXhZBsVOOLiZD(XLMGVCG, IVJFVHG, XJ));
    }
    ERIGFZO ::TIKX::hGZGFH rHHFVxLNNZMW(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV) = 9;
    HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>> zHBMXrHHFVxLNNZMW(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
      IVGFIM HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>>(zHBMXrHHFVxLNNZMWiZD(XLMGVCG, IVJFVHG, XJ));
    }
  KIREZGV:
    ERIGFZO ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>* zHBMXhZBsVOOLiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) = 9;
    ERIGFZO ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>* zHBMXrHHFVxLNNZMWiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) = 9;
  };
  XOZHH hGFY URMZO : KFYORX hGFYrMGVIUZXV {
   KFYORX:
    hGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO);
    ::TIKX::hGZGFH hZBsVOOL(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV) LEVIIRWV;
    HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>> zHBMXhZBsVOOL(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
      IVGFIM HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>>(zHBMXhZBsVOOLiZD(XLMGVCG, IVJFVHG, XJ));
    }
    ::TIKX::hGZGFH rHHFVxLNNZMW(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV) LEVIIRWV;
    HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>> zHBMXrHHFVxLNNZMW(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
      IVGFIM HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>>(zHBMXrHHFVxLNNZMWiZD(XLMGVCG, IVJFVHG, XJ));
    }

   KIREZGV:
    HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV> XSZMMVO_;
    ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>* zHBMXhZBsVOOLiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) LEVIIRWV;
    ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>* zHBMXrHHFVxLNNZMWiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) LEVIIRWV;
    XLMHG ::TIKX::iKXnVGSLW IKXNVGSLW_hZBsVOOL_;
    XLMHG ::TIKX::iKXnVGSLW IKXNVGSLW_rHHFVxLNNZMW_;
  };
  HGZGRX HGW::FMRJFV_KGI<hGFY> mVDhGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO, XLMHG ::TIKX::hGFYlKGRLMH& LKGRLMH = ::TIKX::hGFYlKGRLMH());

  XOZHH hVIERXV : KFYORX ::TIKX::hVIERXV {
   KFYORX:
    hVIERXV();
    ERIGFZO ~hVIERXV();
    // hVMWH Z TIVVGRMT
    ERIGFZO ::TIKX::hGZGFH hZBsVOOL(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV);
    ERIGFZO ::TIKX::hGZGFH rHHFVxLNNZMW(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV);
  };
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGSzHBMXnVGSLW_hZBsVOOL : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGSzHBMXnVGSLW_hZBsVOOL() {
      ::TIKX::hVIERXV::nZIPnVGSLWzHBMX(9);
    }
    ~dRGSzHBMXnVGSLW_hZBsVOOL() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV HBMXSILMLFH EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH hZBsVOOL(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
    ELRW iVJFVHGhZBsVOOL(::TIKX::hVIEVIxLMGVCG* XLMGVCG, ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG* IVJFVHG, ::TIKX::hVIEVIzHBMXiVHKLMHVdIRGVI< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>* IVHKLMHV, ::TIKX::xLNKOVGRLMjFVFV* MVD_XZOO_XJ, ::TIKX::hVIEVIxLNKOVGRLMjFVFV* MLGRURXZGRLM_XJ, ELRW *GZT) {
      ::TIKX::hVIERXV::iVJFVHGzHBMXfMZIB(9, XLMGVCG, IVJFVHG, IVHKLMHV, MVD_XZOO_XJ, MLGRURXZGRLM_XJ, GZT);
    }
  };
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGSzHBMXnVGSLW_rHHFVxLNNZMW : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGSzHBMXnVGSLW_rHHFVxLNNZMW() {
      ::TIKX::hVIERXV::nZIPnVGSLWzHBMX(8);
    }
    ~dRGSzHBMXnVGSLW_rHHFVxLNNZMW() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV HBMXSILMLFH EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH rHHFVxLNNZMW(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
    ELRW iVJFVHGrHHFVxLNNZMW(::TIKX::hVIEVIxLMGVCG* XLMGVCG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG* IVJFVHG, ::TIKX::hVIEVIzHBMXiVHKLMHVdIRGVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>* IVHKLMHV, ::TIKX::xLNKOVGRLMjFVFV* MVD_XZOO_XJ, ::TIKX::hVIEVIxLNKOVGRLMjFVFV* MLGRURXZGRLM_XJ, ELRW *GZT) {
      ::TIKX::hVIERXV::iVJFVHGzHBMXfMZIB(8, XLMGVCG, IVJFVHG, IVHKLMHV, MVD_XZOO_XJ, MLGRURXZGRLM_XJ, GZT);
    }
  };
  GBKVWVU dRGSzHBMXnVGSLW_hZBsVOOL<dRGSzHBMXnVGSLW_rHHFVxLNNZMW<hVIERXV > > zHBMXhVIERXV;
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGStVMVIRXnVGSLW_hZBsVOOL : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGStVMVIRXnVGSLW_hZBsVOOL() {
      ::TIKX::hVIERXV::nZIPnVGSLWtVMVIRX(9);
    }
    ~dRGStVMVIRXnVGSLW_hZBsVOOL() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV HBMXSILMLFH EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH hZBsVOOL(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
  };
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGStVMVIRXnVGSLW_rHHFVxLNNZMW : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGStVMVIRXnVGSLW_rHHFVxLNNZMW() {
      ::TIKX::hVIERXV::nZIPnVGSLWtVMVIRX(8);
    }
    ~dRGStVMVIRXnVGSLW_rHHFVxLNNZMW() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV HBMXSILMLFH EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH rHHFVxLNNZMW(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
  };
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGShGIVZNVWfMZIBnVGSLW_hZBsVOOL : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGShGIVZNVWfMZIBnVGSLW_hZBsVOOL() {
      ::TIKX::hVIERXV::nZIPnVGSLWhGIVZNVW(9,
        MVD ::TIKX::hGIVZNVWfMZIBsZMWOVI< ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>(HGW::YRMW(&dRGShGIVZNVWfMZIBnVGSLW_hZBsVOOL<yZHVxOZHH>::hGIVZNVWhZBsVOOL, GSRH, HGW::KOZXVSLOWVIH::_8, HGW::KOZXVSLOWVIH::_7)));
    }
    ~dRGShGIVZNVWfMZIBnVGSLW_hZBsVOOL() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV IVTFOZI EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH hZBsVOOL(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
    // IVKOZXV WVUZFOG EVIHRLM LU NVGSLW DRGS HGIVZNVW FMZIB
    ERIGFZO ::TIKX::hGZGFH hGIVZNVWhZBsVOOL(::TIKX::hVIEVIxLMGVCG* XLMGVCG, ::TIKX::hVIEVIfMZIBhGIVZNVI< ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG,::hGZIUOVVGxLNNZMW::sVOOLiVKOB>* HVIEVI_FMZIB_HGIVZNVI) = 9;
  };
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGShGIVZNVWfMZIBnVGSLW_rHHFVxLNNZMW : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGShGIVZNVWfMZIBnVGSLW_rHHFVxLNNZMW() {
      ::TIKX::hVIERXV::nZIPnVGSLWhGIVZNVW(8,
        MVD ::TIKX::hGIVZNVWfMZIBsZMWOVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>(HGW::YRMW(&dRGShGIVZNVWfMZIBnVGSLW_rHHFVxLNNZMW<yZHVxOZHH>::hGIVZNVWrHHFVxLNNZMW, GSRH, HGW::KOZXVSLOWVIH::_8, HGW::KOZXVSLOWVIH::_7)));
    }
    ~dRGShGIVZNVWfMZIBnVGSLW_rHHFVxLNNZMW() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV IVTFOZI EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH rHHFVxLNNZMW(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
    // IVKOZXV WVUZFOG EVIHRLM LU NVGSLW DRGS HGIVZNVW FMZIB
    ERIGFZO ::TIKX::hGZGFH hGIVZNVWrHHFVxLNNZMW(::TIKX::hVIEVIxLMGVCG* XLMGVCG, ::TIKX::hVIEVIfMZIBhGIVZNVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG,::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>* HVIEVI_FMZIB_HGIVZNVI) = 9;
  };
  GBKVWVU dRGShGIVZNVWfMZIBnVGSLW_hZBsVOOL<dRGShGIVZNVWfMZIBnVGSLW_rHHFVxLNNZMW<hVIERXV > > hGIVZNVWfMZIBhVIERXV;
  GBKVWVU hVIERXV hKORGhGIVZNVWhVIERXV;
  GBKVWVU dRGShGIVZNVWfMZIBnVGSLW_hZBsVOOL<dRGShGIVZNVWfMZIBnVGSLW_rHHFVxLNNZMW<hVIERXV > > hGIVZNVWhVIERXV;
};

}  // MZNVHKZXV hGZIUOVVGxLNNZMW


#VMWRU  // tikx_XLNNZMW_7VKILGL__rmxofwvw
//##**---------------- ./HGZIUOVVG/XKK/WLXPVI.KY.XX
// tVMVIZGVW YB GSV KILGLXLO YFUUVI XLNKROVI.  wl mlg vwrg!
// HLFIXV: WLXPVI.KILGL

#WVURMV rmgvimzo_hfkkivhh_kilglyfu_urvow_wvkivxzgrlm
#RMXOFWV "WLXPVI.KY.S"

#RMXOFWV <ZOTLIRGSN>

#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/XLNNLM.S>
#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/KLIG.S>
#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/LMXV.S>
#RMXOFWV <TLLTOV/KILGLYFU/RL/XLWVW_HGIVZN.S>
#RMXOFWV <TLLTOV/KILGLYFU/DRIV_ULINZG_ORGV_RMO.S>
#RMXOFWV <TLLTOV/KILGLYFU/WVHXIRKGLI.S>
#RMXOFWV <TLLTOV/KILGLYFU/TVMVIZGVW_NVHHZTV_IVUOVXGRLM.S>
#RMXOFWV <TLLTOV/KILGLYFU/IVUOVXGRLM_LKH.S>
#RMXOFWV <TLLTOV/KILGLYFU/DRIV_ULINZG.S>
// @@KILGLX_RMHVIGRLM_KLRMG(RMXOFWVH)

MZNVHKZXV hGZIUOVVGwLXPVI {
XOZHH qLYiVJFVHGwVUZFOGgBKVrMGVIMZO : KFYORX ::TLLTOV::KILGLYFU::RMGVIMZO::vCKORXRGOBxLMHGIFXGVW<qLYiVJFVHG> {
} _qLYiVJFVHG_WVUZFOG_RMHGZMXV_;
XOZHH qLYiVKOBwVUZFOGgBKVrMGVIMZO : KFYORX ::TLLTOV::KILGLYFU::RMGVIMZO::vCKORXRGOBxLMHGIFXGVW<qLYiVKOB> {
} _qLYiVKOB_WVUZFOG_RMHGZMXV_;

MZNVHKZXV KILGLYFU_WLXPVI_7VKILGL {


MZNVHKZXV {

::TLLTOV::KILGLYFU::nVGZWZGZ UROV_OVEVO_NVGZWZGZ[7];

}  // MZNVHKZXV

XLMHG ::TLLTOV::KILGLYFU::FRMG67 gZYOVhGIFXG::LUUHVGH[] = {
  ~9F,  // ML _SZH_YRGH_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVJFVHG, _RMGVIMZO_NVGZWZGZ_),
  ~9F,  // ML _VCGVMHRLMH_
  ~9F,  // ML _LMVLU_XZHV_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVJFVHG, FHVI_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVJFVHG, GLPVM_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVJFVHG, RWVMGRGB_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVJFVHG, XLNNZMW_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVJFVHG, QLY_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVJFVHG, GBKV_),
  ~9F,  // ML _SZH_YRGH_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVKOB, _RMGVIMZO_NVGZWZGZ_),
  ~9F,  // ML _VCGVMHRLMH_
  ~9F,  // ML _LMVLU_XZHV_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVKOB, HGZGFH_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVKOB, NVHHZTV_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(qLYiVKOB, WZGZ_),
};

HGZGRX XLMHG ::TLLTOV::KILGLYFU::RMGVIMZO::nRTIZGRLMhXSVNZ HXSVNZH[] = {
  { 9, -8, HRAVLU(qLYiVJFVHG)},
  { 89, -8, HRAVLU(qLYiVKOB)},
};

HGZGRX ::TLLTOV::KILGLYFU::nVHHZTV XLMHG * XLMHG UROV_WVUZFOG_RMHGZMXVH[] = {
  IVRMGVIKIVG_XZHG<XLMHG ::TLLTOV::KILGLYFU::nVHHZTV*>(&_qLYiVJFVHG_WVUZFOG_RMHGZMXV_),
  IVRMGVIKIVG_XZHG<XLMHG ::TLLTOV::KILGLYFU::nVHHZTV*>(&_qLYiVKOB_WVUZFOG_RMHGZMXV_),
};

MZNVHKZXV {

ELRW KILGLYFU_zHHRTMwVHXIRKGLIH() {
  zWWwVHXIRKGLIH();
  ::TLLTOV::KILGLYFU::nVHHZTVuZXGLIB* UZXGLIB = mfoo;
  zHHRTMwVHXIRKGLIH(
      "WLXPVI.KILGL", HXSVNZH, UROV_WVUZFOG_RMHGZMXVH, gZYOVhGIFXG::LUUHVGH, UZXGLIB,
      UROV_OVEVO_NVGZWZGZ, mfoo, mfoo);
}

ELRW KILGLYFU_zHHRTMwVHXIRKGLIHlMXV() {
  HGZGRX tlltov_kilglyfu_wvxoziv_lmxv(LMXV);
  ::TLLTOV::KILGLYFU::tLLTOVlMXVrMRG(&LMXV, &KILGLYFU_zHHRTMwVHXIRKGLIH);
}

ELRW KILGLYFU_iVTRHGVIgBKVH(XLMHG ::HGW::HGIRMT&) tlltov_zggiryfgv_xlow;
ELRW KILGLYFU_iVTRHGVIgBKVH(XLMHG ::HGW::HGIRMT&) {
  KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  ::TLLTOV::KILGLYFU::RMGVIMZO::iVTRHGVIzOOgBKVH(UROV_OVEVO_NVGZWZGZ, 7);
}

}  // MZNVHKZXV

ELRW gZYOVhGIFXG::hSFGWLDM() {
  _qLYiVJFVHG_WVUZFOG_RMHGZMXV_.hSFGWLDM();
  WVOVGV UROV_OVEVO_NVGZWZGZ[9].IVUOVXGRLM;
  _qLYiVKOB_WVUZFOG_RMHGZMXV_.hSFGWLDM();
  WVOVGV UROV_OVEVO_NVGZWZGZ[8].IVUOVXGRLM;
}

ELRW gZYOVhGIFXG::rMRGwVUZFOGHrNKO() {
  tlltov_kilglyfu_evirub_evihrlm;

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMRGkILGLYFUwVUZFOGH();
  _qLYiVJFVHG_WVUZFOG_RMHGZMXV_.wVUZFOGxLMHGIFXG();
  _qLYiVKOB_WVUZFOG_RMHGZMXV_.wVUZFOGxLMHGIFXG();
}

ELRW rMRGwVUZFOGH() {
  HGZGRX tlltov_kilglyfu_wvxoziv_lmxv(LMXV);
  ::TLLTOV::KILGLYFU::tLLTOVlMXVrMRG(&LMXV, &gZYOVhGIFXG::rMRGwVUZFOGHrNKO);
}
ELRW zWWwVHXIRKGLIHrNKO() {
  rMRGwVUZFOGH();
  HGZGRX XLMHG XSZI WVHXIRKGLI[] = {
      "\M\985WLXPVI.KILGL\977\982hGZIUOVVGwLXPVI\"T\M\MqLYiV"
      "JFVHG\977\985\M\995FHVI\969\998 \998(\G\977\I\M\994GLPVM\969\997 \998(\G\977\979\M\989RW"
      "VMGRGB\969\996 \998(\G\977\982\M\992XLNNZMW\969\995 \998(\G\977\986\M\996QLY\969\994 \998"
      "(\985\977\985\M\995GBKV\969\993 \998(\994\"0\M\989qLYiVKOB\977\983\M\993HGZGFH\969\998"
      " \998(\989\977\982\M\992NVHHZTV\969\997 \998(\G\977\985\M\995WZGZ\969\996 \998(\9857m\M\992t"
      "IVVGVI\977x\M\992hVMWqLY\977\966.hGZIUOVVGwLXPVI.qLYi"
      "VJFVHG\967\968.hGZIUOVVGwLXPVI.qLYiVKOB\"\999Y\993KIL"
      "GL6"
  };
  ::TLLTOV::KILGLYFU::wVHXIRKGLIkLLO::rMGVIMZOzWWtVMVIZGVWuROV(
      WVHXIRKGLI, 716);
  ::TLLTOV::KILGLYFU::nVHHZTVuZXGLIB::rMGVIMZOiVTRHGVItVMVIZGVWuROV(
    "WLXPVI.KILGL", &KILGLYFU_iVTRHGVIgBKVH);
  ::TLLTOV::KILGLYFU::RMGVIMZO::lMhSFGWLDM(&gZYOVhGIFXG::hSFGWLDM);
}

ELRW zWWwVHXIRKGLIH() {
  HGZGRX tlltov_kilglyfu_wvxoziv_lmxv(LMXV);
  ::TLLTOV::KILGLYFU::tLLTOVlMXVrMRG(&LMXV, &zWWwVHXIRKGLIHrNKO);
}
// uLIXV zWWwVHXIRKGLIH() GL YV XZOOVW ZG HGZGRX RMRGRZORAZGRLM GRNV.
HGIFXG hGZGRXwVHXIRKGLIrMRGRZORAVI {
  hGZGRXwVHXIRKGLIrMRGRZORAVI() {
    zWWwVHXIRKGLIH();
  }
} HGZGRX_WVHXIRKGLI_RMRGRZORAVI;

}  // MZNVHKZXV KILGLYFU_WLXPVI_7VKILGL


// ===================================================================

#RU !WVURMVW(_nhx_evi) || _nhx_evi >= 8099
XLMHG RMG qLYiVJFVHG::PfHVIuRVOWmFNYVI;
XLMHG RMG qLYiVJFVHG::PgLPVMuRVOWmFNYVI;
XLMHG RMG qLYiVJFVHG::PrWVMGRGBuRVOWmFNYVI;
XLMHG RMG qLYiVJFVHG::PxLNNZMWuRVOWmFNYVI;
XLMHG RMG qLYiVJFVHG::PqLYuRVOWmFNYVI;
XLMHG RMG qLYiVJFVHG::PgBKVuRVOWmFNYVI;
#VMWRU  // !WVURMVW(_nhx_evi) || _nhx_evi >= 8099

qLYiVJFVHG::qLYiVJFVHG()
  : ::TLLTOV::KILGLYFU::nVHHZTV(), _RMGVIMZO_NVGZWZGZ_(mfoo) {
  RU (tlltov_kivwrxg_gifv(GSRH != RMGVIMZO_WVUZFOG_RMHGZMXV())) {
    KILGLYFU_WLXPVI_7VKILGL::rMRGwVUZFOGH();
  }
  hSZIVWxGLI();
  // @@KILGLX_RMHVIGRLM_KLRMG(XLMHGIFXGLI:hGZIUOVVGwLXPVI.qLYiVJFVHG)
}
qLYiVJFVHG::qLYiVJFVHG(XLMHG qLYiVJFVHG& UILN)
  : ::TLLTOV::KILGLYFU::nVHHZTV(),
      _RMGVIMZO_NVGZWZGZ_(mfoo),
      _XZXSVW_HRAV_(9) {
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  FHVI_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.FHVI().HRAV() > 9) {
    FHVI_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.FHVI_);
  }
  GLPVM_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.GLPVM().HRAV() > 9) {
    GLPVM_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.GLPVM_);
  }
  RWVMGRGB_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.RWVMGRGB().HRAV() > 9) {
    RWVMGRGB_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.RWVMGRGB_);
  }
  XLNNZMW_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.XLNNZMW().HRAV() > 9) {
    XLNNZMW_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.XLNNZMW_);
  }
  QLY_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.QLY().HRAV() > 9) {
    QLY_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.QLY_);
  }
  GBKV_ = UILN.GBKV_;
  // @@KILGLX_RMHVIGRLM_KLRMG(XLKB_XLMHGIFXGLI:hGZIUOVVGwLXPVI.qLYiVJFVHG)
}

ELRW qLYiVJFVHG::hSZIVWxGLI() {
  FHVI_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GLPVM_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RWVMGRGB_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  XLNNZMW_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  QLY_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GBKV_ = 9;
  _XZXSVW_HRAV_ = 9;
}

qLYiVJFVHG::~qLYiVJFVHG() {
  // @@KILGLX_RMHVIGRLM_KLRMG(WVHGIFXGLI:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  hSZIVWwGLI();
}

ELRW qLYiVJFVHG::hSZIVWwGLI() {
  FHVI_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GLPVM_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RWVMGRGB_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  XLNNZMW_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  QLY_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

ELRW qLYiVJFVHG::hVGxZXSVWhRAV(RMG HRAV) XLMHG {
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
}
XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* qLYiVJFVHG::WVHXIRKGLI() {
  KILGLYFU_WLXPVI_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_WLXPVI_7VKILGL::UROV_OVEVO_NVGZWZGZ[9].WVHXIRKGLI;
}

XLMHG qLYiVJFVHG& qLYiVJFVHG::WVUZFOG_RMHGZMXV() {
  KILGLYFU_WLXPVI_7VKILGL::rMRGwVUZFOGH();
  IVGFIM *RMGVIMZO_WVUZFOG_RMHGZMXV();
}

qLYiVJFVHG* qLYiVJFVHG::mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG {
  qLYiVJFVHG* M = MVD qLYiVJFVHG;
  RU (ZIVMZ != mfoo) {
    ZIVMZ->lDM(M);
  }
  IVGFIM M;
}

ELRW qLYiVJFVHG::xOVZI() {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_XOVZI_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  FHVI_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GLPVM_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RWVMGRGB_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  QLY_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GBKV_ = 9;
}

YLLO qLYiVJFVHG::nVITVkZIGRZOuILNxLWVWhGIVZN(
    ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) {
#WVURMV wl_(vckivhhrlm) RU (!tlltov_kivwrxg_gifv(vckivhhrlm)) TLGL UZROFIV
  ::TLLTOV::KILGLYFU::FRMG67 GZT;
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  ULI (;;) {
    ::HGW::KZRI< ::TLLTOV::KILGLYFU::FRMG67, YLLO> K = RMKFG->iVZWgZTdRGSxFGLUUmLoZHGgZT(872F);
    GZT = K.URIHG;
    RU (!K.HVXLMW) TLGL SZMWOV_FMFHFZO;
    HDRGXS (::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTuRVOWmFNYVI(GZT)) {
      // HGIRMT FHVI = 8;
      XZHV 8: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(89F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_FHVI()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->FHVI().WZGZ(), GSRH->FHVI().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT GLPVM = 7;
      XZHV 7: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(81F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_GLPVM()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->GLPVM().WZGZ(), GSRH->GLPVM().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT RWVMGRGB = 6;
      XZHV 6: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(73F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_RWVMGRGB()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->RWVMGRGB().WZGZ(), GSRH->RWVMGRGB().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT XLNNZMW = 5;
      XZHV 5: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(65F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_XLNNZMW()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->XLNNZMW().WZGZ(), GSRH->XLNNZMW().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // YBGVH QLY = 4;
      XZHV 4: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(57F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWyBGVH(
                RMKFG, GSRH->NFGZYOV_QLY()));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // RMG67 GBKV = 3;
      XZHV 3: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(51F)) {

          wl_((::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWkIRNRGREV<
                   ::TLLTOV::KILGLYFU::RMG67, ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::gbkv_rmg67>(
                 RMKFG, &GBKV_)));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      WVUZFOG: {
      SZMWOV_FMFHFZO:
        RU (GZT == 9 ||
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTdRIVgBKV(GZT) ==
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::drivgbkv_vmw_tilfk) {
          TLGL HFXXVHH;
        }
        wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hPRKuRVOW(RMKFG, GZT));
        YIVZP;
      }
    }
  }
HFXXVHH:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HFXXVHH:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  IVGFIM GIFV;
UZROFIV:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_UZROFIV:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  IVGFIM UZOHV;
#FMWVU wl_
}

ELRW qLYiVJFVHG::hVIRZORAVdRGSxZXSVWhRAVH(
    ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  // HGIRMT FHVI = 8;
  RU (GSRH->FHVI().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->FHVI().WZGZ(), GSRH->FHVI().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      8, GSRH->FHVI(), LFGKFG);
  }

  // HGIRMT GLPVM = 7;
  RU (GSRH->GLPVM().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->GLPVM().WZGZ(), GSRH->GLPVM().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      7, GSRH->GLPVM(), LFGKFG);
  }

  // HGIRMT RWVMGRGB = 6;
  RU (GSRH->RWVMGRGB().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->RWVMGRGB().WZGZ(), GSRH->RWVMGRGB().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      6, GSRH->RWVMGRGB(), LFGKFG);
  }

  // HGIRMT XLNNZMW = 5;
  RU (GSRH->XLNNZMW().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->XLNNZMW().WZGZ(), GSRH->XLNNZMW().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      5, GSRH->XLNNZMW(), LFGKFG);
  }

  // YBGVH QLY = 4;
  RU (GSRH->QLY().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHnZBYVzORZHVW(
      4, GSRH->QLY(), LFGKFG);
  }

  // RMG67 GBKV = 3;
  RU (GSRH->GBKV() != 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVrMG67(3, GSRH->GBKV(), LFGKFG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_VMW:hGZIUOVVGwLXPVI.qLYiVJFVHG)
}

::TLLTOV::KILGLYFU::FRMG1* qLYiVJFVHG::rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
    YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG {
  (ELRW)WVGVINRMRHGRX;  // fMFHVW
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  // HGIRMT FHVI = 8;
  RU (GSRH->FHVI().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->FHVI().WZGZ(), GSRH->FHVI().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        8, GSRH->FHVI(), GZITVG);
  }

  // HGIRMT GLPVM = 7;
  RU (GSRH->GLPVM().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->GLPVM().WZGZ(), GSRH->GLPVM().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        7, GSRH->GLPVM(), GZITVG);
  }

  // HGIRMT RWVMGRGB = 6;
  RU (GSRH->RWVMGRGB().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->RWVMGRGB().WZGZ(), GSRH->RWVMGRGB().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        6, GSRH->RWVMGRGB(), GZITVG);
  }

  // HGIRMT XLNNZMW = 5;
  RU (GSRH->XLNNZMW().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->XLNNZMW().WZGZ(), GSRH->XLNNZMW().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        5, GSRH->XLNNZMW(), GZITVG);
  }

  // YBGVH QLY = 4;
  RU (GSRH->QLY().HRAV() > 9) {
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHgLzIIZB(
        4, GSRH->QLY(), GZITVG);
  }

  // RMG67 GBKV = 3;
  RU (GSRH->GBKV() != 9) {
    GZITVG = ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVrMG67gLzIIZB(3, GSRH->GBKV(), GZITVG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_VMW:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  IVGFIM GZITVG;
}

HRAV_G qLYiVJFVHG::yBGVhRAVoLMT() XLMHG {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_YBGV_HRAV_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  HRAV_G GLGZO_HRAV = 9;

  // HGIRMT FHVI = 8;
  RU (GSRH->FHVI().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->FHVI());
  }

  // HGIRMT GLPVM = 7;
  RU (GSRH->GLPVM().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->GLPVM());
  }

  // HGIRMT RWVMGRGB = 6;
  RU (GSRH->RWVMGRGB().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->RWVMGRGB());
  }

  // HGIRMT XLNNZMW = 5;
  RU (GSRH->XLNNZMW().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->XLNNZMW());
  }

  // YBGVH QLY = 4;
  RU (GSRH->QLY().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::yBGVHhRAV(
        GSRH->QLY());
  }

  // RMG67 GBKV = 3;
  RU (GSRH->GBKV() != 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::rMG67hRAV(
        GSRH->GBKV());
  }

  RMG XZXSVW_HRAV = ::TLLTOV::KILGLYFU::RMGVIMZO::gLxZXSVWhRAV(GLGZO_HRAV);
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = XZXSVW_HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
  IVGFIM GLGZO_HRAV;
}

ELRW qLYiVJFVHG::nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  XLMHG qLYiVJFVHG* HLFIXV =
      ::TLLTOV::KILGLYFU::RMGVIMZO::wBMZNRXxZHGgLtVMVIZGVW<XLMHG qLYiVJFVHG>(
          &UILN);
  RU (HLFIXV == mfoo) {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_UZRO:hGZIUOVVGwLXPVI.qLYiVJFVHG)
    ::TLLTOV::KILGLYFU::RMGVIMZO::iVUOVXGRLMlKH::nVITV(UILN, GSRH);
  } VOHV {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_HFXXVHH:hGZIUOVVGwLXPVI.qLYiVJFVHG)
    nVITVuILN(*HLFIXV);
  }
}

ELRW qLYiVJFVHG::nVITVuILN(XLMHG qLYiVJFVHG& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_NVITV_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  RU (UILN.FHVI().HRAV() > 9) {

    FHVI_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.FHVI_);
  }
  RU (UILN.GLPVM().HRAV() > 9) {

    GLPVM_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.GLPVM_);
  }
  RU (UILN.RWVMGRGB().HRAV() > 9) {

    RWVMGRGB_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.RWVMGRGB_);
  }
  RU (UILN.XLNNZMW().HRAV() > 9) {

    XLNNZMW_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.XLNNZMW_);
  }
  RU (UILN.QLY().HRAV() > 9) {

    QLY_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.QLY_);
  }
  RU (UILN.GBKV() != 9) {
    HVG_GBKV(UILN.GBKV());
  }
}

ELRW qLYiVJFVHG::xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_XLKB_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

ELRW qLYiVJFVHG::xLKBuILN(XLMHG qLYiVJFVHG& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_XLKB_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVJFVHG)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

YLLO qLYiVJFVHG::rHrMRGRZORAVW() XLMHG {
  IVGFIM GIFV;
}

ELRW qLYiVJFVHG::hDZK(qLYiVJFVHG* LGSVI) {
  RU (LGSVI == GSRH) IVGFIM;
  rMGVIMZOhDZK(LGSVI);
}
ELRW qLYiVJFVHG::rMGVIMZOhDZK(qLYiVJFVHG* LGSVI) {
  FHVI_.hDZK(&LGSVI->FHVI_);
  GLPVM_.hDZK(&LGSVI->GLPVM_);
  RWVMGRGB_.hDZK(&LGSVI->RWVMGRGB_);
  XLNNZMW_.hDZK(&LGSVI->XLNNZMW_);
  QLY_.hDZK(&LGSVI->QLY_);
  HGW::HDZK(GBKV_, LGSVI->GBKV_);
  HGW::HDZK(_XZXSVW_HRAV_, LGSVI->_XZXSVW_HRAV_);
}

::TLLTOV::KILGLYFU::nVGZWZGZ qLYiVJFVHG::tVGnVGZWZGZ() XLMHG {
  KILGLYFU_WLXPVI_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_WLXPVI_7VKILGL::UROV_OVEVO_NVGZWZGZ[9];
}

#RU kilglyfu_rmormv_mlg_rm_svzwvih
// qLYiVJFVHG

// HGIRMT FHVI = 8;
ELRW qLYiVJFVHG::XOVZI_FHVI() {
  FHVI_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& qLYiVJFVHG::FHVI() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
  IVGFIM FHVI_.tVGmLzIVMZ();
}
ELRW qLYiVJFVHG::HVG_FHVI(XLMHG ::HGW::HGIRMT& EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
#RU ozmt_xcc88
ELRW qLYiVJFVHG::HVG_FHVI(::HGW::HGIRMT&& EZOFV) {

  FHVI_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
#VMWRU
ELRW qLYiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
ELRW qLYiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_FHVI() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
  IVGFIM FHVI_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_FHVI() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)

  IVGFIM FHVI_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_FHVI(::HGW::HGIRMT* FHVI) {
  RU (FHVI != mfoo) {

  } VOHV {

  }
  FHVI_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), FHVI);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}

// HGIRMT GLPVM = 7;
ELRW qLYiVJFVHG::XOVZI_GLPVM() {
  GLPVM_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& qLYiVJFVHG::GLPVM() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
  IVGFIM GLPVM_.tVGmLzIVMZ();
}
ELRW qLYiVJFVHG::HVG_GLPVM(XLMHG ::HGW::HGIRMT& EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
#RU ozmt_xcc88
ELRW qLYiVJFVHG::HVG_GLPVM(::HGW::HGIRMT&& EZOFV) {

  GLPVM_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
#VMWRU
ELRW qLYiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
ELRW qLYiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_GLPVM() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
  IVGFIM GLPVM_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_GLPVM() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)

  IVGFIM GLPVM_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_GLPVM(::HGW::HGIRMT* GLPVM) {
  RU (GLPVM != mfoo) {

  } VOHV {

  }
  GLPVM_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), GLPVM);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}

// HGIRMT RWVMGRGB = 6;
ELRW qLYiVJFVHG::XOVZI_RWVMGRGB() {
  RWVMGRGB_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& qLYiVJFVHG::RWVMGRGB() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
  IVGFIM RWVMGRGB_.tVGmLzIVMZ();
}
ELRW qLYiVJFVHG::HVG_RWVMGRGB(XLMHG ::HGW::HGIRMT& EZOFV) {

  RWVMGRGB_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
#RU ozmt_xcc88
ELRW qLYiVJFVHG::HVG_RWVMGRGB(::HGW::HGIRMT&& EZOFV) {

  RWVMGRGB_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
#VMWRU
ELRW qLYiVJFVHG::HVG_RWVMGRGB(XLMHG XSZI* EZOFV) {

  RWVMGRGB_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
ELRW qLYiVJFVHG::HVG_RWVMGRGB(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  RWVMGRGB_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_RWVMGRGB() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
  IVGFIM RWVMGRGB_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_RWVMGRGB() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)

  IVGFIM RWVMGRGB_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_RWVMGRGB(::HGW::HGIRMT* RWVMGRGB) {
  RU (RWVMGRGB != mfoo) {

  } VOHV {

  }
  RWVMGRGB_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), RWVMGRGB);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}

// HGIRMT XLNNZMW = 5;
ELRW qLYiVJFVHG::XOVZI_XLNNZMW() {
  XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& qLYiVJFVHG::XLNNZMW() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.tVGmLzIVMZ();
}
ELRW qLYiVJFVHG::HVG_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
#RU ozmt_xcc88
ELRW qLYiVJFVHG::HVG_XLNNZMW(::HGW::HGIRMT&& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
#VMWRU
ELRW qLYiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
ELRW qLYiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_XLNNZMW() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_XLNNZMW() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)

  IVGFIM XLNNZMW_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_XLNNZMW(::HGW::HGIRMT* XLNNZMW) {
  RU (XLNNZMW != mfoo) {

  } VOHV {

  }
  XLNNZMW_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), XLNNZMW);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}

// YBGVH QLY = 4;
ELRW qLYiVJFVHG::XOVZI_QLY() {
  QLY_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& qLYiVJFVHG::QLY() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
  IVGFIM QLY_.tVGmLzIVMZ();
}
ELRW qLYiVJFVHG::HVG_QLY(XLMHG ::HGW::HGIRMT& EZOFV) {

  QLY_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
#RU ozmt_xcc88
ELRW qLYiVJFVHG::HVG_QLY(::HGW::HGIRMT&& EZOFV) {

  QLY_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
#VMWRU
ELRW qLYiVJFVHG::HVG_QLY(XLMHG XSZI* EZOFV) {

  QLY_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
ELRW qLYiVJFVHG::HVG_QLY(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  QLY_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_QLY() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
  IVGFIM QLY_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_QLY() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)

  IVGFIM QLY_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_QLY(::HGW::HGIRMT* QLY) {
  RU (QLY != mfoo) {

  } VOHV {

  }
  QLY_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), QLY);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}

// RMG67 GBKV = 3;
ELRW qLYiVJFVHG::XOVZI_GBKV() {
  GBKV_ = 9;
}
::TLLTOV::KILGLYFU::RMG67 qLYiVJFVHG::GBKV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GBKV)
  IVGFIM GBKV_;
}
ELRW qLYiVJFVHG::HVG_GBKV(::TLLTOV::KILGLYFU::RMG67 EZOFV) {

  GBKV_ = EZOFV;
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GBKV)
}

#VMWRU  // kilglyfu_rmormv_mlg_rm_svzwvih

// ===================================================================

#RU !WVURMVW(_nhx_evi) || _nhx_evi >= 8099
XLMHG RMG qLYiVKOB::PhGZGFHuRVOWmFNYVI;
XLMHG RMG qLYiVKOB::PnVHHZTVuRVOWmFNYVI;
XLMHG RMG qLYiVKOB::PwZGZuRVOWmFNYVI;
#VMWRU  // !WVURMVW(_nhx_evi) || _nhx_evi >= 8099

qLYiVKOB::qLYiVKOB()
  : ::TLLTOV::KILGLYFU::nVHHZTV(), _RMGVIMZO_NVGZWZGZ_(mfoo) {
  RU (tlltov_kivwrxg_gifv(GSRH != RMGVIMZO_WVUZFOG_RMHGZMXV())) {
    KILGLYFU_WLXPVI_7VKILGL::rMRGwVUZFOGH();
  }
  hSZIVWxGLI();
  // @@KILGLX_RMHVIGRLM_KLRMG(XLMHGIFXGLI:hGZIUOVVGwLXPVI.qLYiVKOB)
}
qLYiVKOB::qLYiVKOB(XLMHG qLYiVKOB& UILN)
  : ::TLLTOV::KILGLYFU::nVHHZTV(),
      _RMGVIMZO_NVGZWZGZ_(mfoo),
      _XZXSVW_HRAV_(9) {
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.NVHHZTV().HRAV() > 9) {
    NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.NVHHZTV_);
  }
  WZGZ_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.WZGZ().HRAV() > 9) {
    WZGZ_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.WZGZ_);
  }
  HGZGFH_ = UILN.HGZGFH_;
  // @@KILGLX_RMHVIGRLM_KLRMG(XLKB_XLMHGIFXGLI:hGZIUOVVGwLXPVI.qLYiVKOB)
}

ELRW qLYiVKOB::hSZIVWxGLI() {
  NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HGZGFH_ = UZOHV;
  _XZXSVW_HRAV_ = 9;
}

qLYiVKOB::~qLYiVKOB() {
  // @@KILGLX_RMHVIGRLM_KLRMG(WVHGIFXGLI:hGZIUOVVGwLXPVI.qLYiVKOB)
  hSZIVWwGLI();
}

ELRW qLYiVKOB::hSZIVWwGLI() {
  NVHHZTV_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

ELRW qLYiVKOB::hVGxZXSVWhRAV(RMG HRAV) XLMHG {
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
}
XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* qLYiVKOB::WVHXIRKGLI() {
  KILGLYFU_WLXPVI_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_WLXPVI_7VKILGL::UROV_OVEVO_NVGZWZGZ[8].WVHXIRKGLI;
}

XLMHG qLYiVKOB& qLYiVKOB::WVUZFOG_RMHGZMXV() {
  KILGLYFU_WLXPVI_7VKILGL::rMRGwVUZFOGH();
  IVGFIM *RMGVIMZO_WVUZFOG_RMHGZMXV();
}

qLYiVKOB* qLYiVKOB::mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG {
  qLYiVKOB* M = MVD qLYiVKOB;
  RU (ZIVMZ != mfoo) {
    ZIVMZ->lDM(M);
  }
  IVGFIM M;
}

ELRW qLYiVKOB::xOVZI() {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_XOVZI_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HGZGFH_ = UZOHV;
}

YLLO qLYiVKOB::nVITVkZIGRZOuILNxLWVWhGIVZN(
    ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) {
#WVURMV wl_(vckivhhrlm) RU (!tlltov_kivwrxg_gifv(vckivhhrlm)) TLGL UZROFIV
  ::TLLTOV::KILGLYFU::FRMG67 GZT;
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  ULI (;;) {
    ::HGW::KZRI< ::TLLTOV::KILGLYFU::FRMG67, YLLO> K = RMKFG->iVZWgZTdRGSxFGLUUmLoZHGgZT(872F);
    GZT = K.URIHG;
    RU (!K.HVXLMW) TLGL SZMWOV_FMFHFZO;
    HDRGXS (::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTuRVOWmFNYVI(GZT)) {
      // YLLO HGZGFH = 8;
      XZHV 8: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(1F)) {

          wl_((::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWkIRNRGREV<
                   YLLO, ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::gbkv_yllo>(
                 RMKFG, &HGZGFH_)));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT NVHHZTV = 7;
      XZHV 7: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(81F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_NVHHZTV()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // YBGVH WZGZ = 6;
      XZHV 6: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(73F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWyBGVH(
                RMKFG, GSRH->NFGZYOV_WZGZ()));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      WVUZFOG: {
      SZMWOV_FMFHFZO:
        RU (GZT == 9 ||
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTdRIVgBKV(GZT) ==
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::drivgbkv_vmw_tilfk) {
          TLGL HFXXVHH;
        }
        wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hPRKuRVOW(RMKFG, GZT));
        YIVZP;
      }
    }
  }
HFXXVHH:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HFXXVHH:hGZIUOVVGwLXPVI.qLYiVKOB)
  IVGFIM GIFV;
UZROFIV:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_UZROFIV:hGZIUOVVGwLXPVI.qLYiVKOB)
  IVGFIM UZOHV;
#FMWVU wl_
}

ELRW qLYiVKOB::hVIRZORAVdRGSxZXSVWhRAVH(
    ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  // YLLO HGZGFH = 8;
  RU (GSRH->HGZGFH() != 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyLLO(8, GSRH->HGZGFH(), LFGKFG);
  }

  // HGIRMT NVHHZTV = 7;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      7, GSRH->NVHHZTV(), LFGKFG);
  }

  // YBGVH WZGZ = 6;
  RU (GSRH->WZGZ().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHnZBYVzORZHVW(
      6, GSRH->WZGZ(), LFGKFG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_VMW:hGZIUOVVGwLXPVI.qLYiVKOB)
}

::TLLTOV::KILGLYFU::FRMG1* qLYiVKOB::rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
    YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG {
  (ELRW)WVGVINRMRHGRX;  // fMFHVW
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  // YLLO HGZGFH = 8;
  RU (GSRH->HGZGFH() != 9) {
    GZITVG = ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyLLOgLzIIZB(8, GSRH->HGZGFH(), GZITVG);
  }

  // HGIRMT NVHHZTV = 7;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        7, GSRH->NVHHZTV(), GZITVG);
  }

  // YBGVH WZGZ = 6;
  RU (GSRH->WZGZ().HRAV() > 9) {
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHgLzIIZB(
        6, GSRH->WZGZ(), GZITVG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_VMW:hGZIUOVVGwLXPVI.qLYiVKOB)
  IVGFIM GZITVG;
}

HRAV_G qLYiVKOB::yBGVhRAVoLMT() XLMHG {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_YBGV_HRAV_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  HRAV_G GLGZO_HRAV = 9;

  // HGIRMT NVHHZTV = 7;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->NVHHZTV());
  }

  // YBGVH WZGZ = 6;
  RU (GSRH->WZGZ().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::yBGVHhRAV(
        GSRH->WZGZ());
  }

  // YLLO HGZGFH = 8;
  RU (GSRH->HGZGFH() != 9) {
    GLGZO_HRAV += 8 + 8;
  }

  RMG XZXSVW_HRAV = ::TLLTOV::KILGLYFU::RMGVIMZO::gLxZXSVWhRAV(GLGZO_HRAV);
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = XZXSVW_HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
  IVGFIM GLGZO_HRAV;
}

ELRW qLYiVKOB::nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  XLMHG qLYiVKOB* HLFIXV =
      ::TLLTOV::KILGLYFU::RMGVIMZO::wBMZNRXxZHGgLtVMVIZGVW<XLMHG qLYiVKOB>(
          &UILN);
  RU (HLFIXV == mfoo) {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_UZRO:hGZIUOVVGwLXPVI.qLYiVKOB)
    ::TLLTOV::KILGLYFU::RMGVIMZO::iVUOVXGRLMlKH::nVITV(UILN, GSRH);
  } VOHV {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_HFXXVHH:hGZIUOVVGwLXPVI.qLYiVKOB)
    nVITVuILN(*HLFIXV);
  }
}

ELRW qLYiVKOB::nVITVuILN(XLMHG qLYiVKOB& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_NVITV_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  RU (UILN.NVHHZTV().HRAV() > 9) {

    NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.NVHHZTV_);
  }
  RU (UILN.WZGZ().HRAV() > 9) {

    WZGZ_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.WZGZ_);
  }
  RU (UILN.HGZGFH() != 9) {
    HVG_HGZGFH(UILN.HGZGFH());
  }
}

ELRW qLYiVKOB::xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_XLKB_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

ELRW qLYiVKOB::xLKBuILN(XLMHG qLYiVKOB& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_XLKB_UILN_HGZIG:hGZIUOVVGwLXPVI.qLYiVKOB)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

YLLO qLYiVKOB::rHrMRGRZORAVW() XLMHG {
  IVGFIM GIFV;
}

ELRW qLYiVKOB::hDZK(qLYiVKOB* LGSVI) {
  RU (LGSVI == GSRH) IVGFIM;
  rMGVIMZOhDZK(LGSVI);
}
ELRW qLYiVKOB::rMGVIMZOhDZK(qLYiVKOB* LGSVI) {
  NVHHZTV_.hDZK(&LGSVI->NVHHZTV_);
  WZGZ_.hDZK(&LGSVI->WZGZ_);
  HGW::HDZK(HGZGFH_, LGSVI->HGZGFH_);
  HGW::HDZK(_XZXSVW_HRAV_, LGSVI->_XZXSVW_HRAV_);
}

::TLLTOV::KILGLYFU::nVGZWZGZ qLYiVKOB::tVGnVGZWZGZ() XLMHG {
  KILGLYFU_WLXPVI_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_WLXPVI_7VKILGL::UROV_OVEVO_NVGZWZGZ[8];
}

#RU kilglyfu_rmormv_mlg_rm_svzwvih
// qLYiVKOB

// YLLO HGZGFH = 8;
ELRW qLYiVKOB::XOVZI_HGZGFH() {
  HGZGFH_ = UZOHV;
}
YLLO qLYiVKOB::HGZGFH() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVKOB.HGZGFH)
  IVGFIM HGZGFH_;
}
ELRW qLYiVKOB::HVG_HGZGFH(YLLO EZOFV) {

  HGZGFH_ = EZOFV;
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVKOB.HGZGFH)
}

// HGIRMT NVHHZTV = 7;
ELRW qLYiVKOB::XOVZI_NVHHZTV() {
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& qLYiVKOB::NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.tVGmLzIVMZ();
}
ELRW qLYiVKOB::HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
#RU ozmt_xcc88
ELRW qLYiVKOB::HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
#VMWRU
ELRW qLYiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
ELRW qLYiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
::HGW::HGIRMT* qLYiVKOB::NFGZYOV_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* qLYiVKOB::IVOVZHV_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)

  IVGFIM NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW qLYiVKOB::HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV) {
  RU (NVHHZTV != mfoo) {

  } VOHV {

  }
  NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}

// YBGVH WZGZ = 6;
ELRW qLYiVKOB::XOVZI_WZGZ() {
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& qLYiVKOB::WZGZ() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
  IVGFIM WZGZ_.tVGmLzIVMZ();
}
ELRW qLYiVKOB::HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
#RU ozmt_xcc88
ELRW qLYiVKOB::HVG_WZGZ(::HGW::HGIRMT&& EZOFV) {

  WZGZ_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
#VMWRU
ELRW qLYiVKOB::HVG_WZGZ(XLMHG XSZI* EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
ELRW qLYiVKOB::HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
::HGW::HGIRMT* qLYiVKOB::NFGZYOV_WZGZ() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
  IVGFIM WZGZ_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* qLYiVKOB::IVOVZHV_WZGZ() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)

  IVGFIM WZGZ_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW qLYiVKOB::HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ) {
  RU (WZGZ != mfoo) {

  } VOHV {

  }
  WZGZ_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), WZGZ);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}

#VMWRU  // kilglyfu_rmormv_mlg_rm_svzwvih

// @@KILGLX_RMHVIGRLM_KLRMG(MZNVHKZXV_HXLKV)

}  // MZNVHKZXV hGZIUOVVGwLXPVI

// @@KILGLX_RMHVIGRLM_KLRMG(TOLYZO_HXLKV)
//##**---------------- ./HGZIUOVVG/XKK/XLNNZMW.KY.XX
// tVMVIZGVW YB GSV KILGLXLO YFUUVI XLNKROVI.  wl mlg vwrg!
// HLFIXV: XLNNZMW.KILGL

#WVURMV rmgvimzo_hfkkivhh_kilglyfu_urvow_wvkivxzgrlm
#RMXOFWV "XLNNZMW.KY.S"

#RMXOFWV <ZOTLIRGSN>

#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/XLNNLM.S>
#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/KLIG.S>
#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/LMXV.S>
#RMXOFWV <TLLTOV/KILGLYFU/RL/XLWVW_HGIVZN.S>
#RMXOFWV <TLLTOV/KILGLYFU/DRIV_ULINZG_ORGV_RMO.S>
#RMXOFWV <TLLTOV/KILGLYFU/WVHXIRKGLI.S>
#RMXOFWV <TLLTOV/KILGLYFU/TVMVIZGVW_NVHHZTV_IVUOVXGRLM.S>
#RMXOFWV <TLLTOV/KILGLYFU/IVUOVXGRLM_LKH.S>
#RMXOFWV <TLLTOV/KILGLYFU/DRIV_ULINZG.S>
// @@KILGLX_RMHVIGRLM_KLRMG(RMXOFWVH)

MZNVHKZXV hGZIUOVVGxLNNZMW {
XOZHH sVOOLiVJFVHGwVUZFOGgBKVrMGVIMZO : KFYORX ::TLLTOV::KILGLYFU::RMGVIMZO::vCKORXRGOBxLMHGIFXGVW<sVOOLiVJFVHG> {
} _sVOOLiVJFVHG_WVUZFOG_RMHGZMXV_;
XOZHH sVOOLiVKOBwVUZFOGgBKVrMGVIMZO : KFYORX ::TLLTOV::KILGLYFU::RMGVIMZO::vCKORXRGOBxLMHGIFXGVW<sVOOLiVKOB> {
} _sVOOLiVKOB_WVUZFOG_RMHGZMXV_;
XOZHH xLNNZMWiVJFVHGwVUZFOGgBKVrMGVIMZO : KFYORX ::TLLTOV::KILGLYFU::RMGVIMZO::vCKORXRGOBxLMHGIFXGVW<xLNNZMWiVJFVHG> {
} _xLNNZMWiVJFVHG_WVUZFOG_RMHGZMXV_;
XOZHH xLNNZMWiVKOBwVUZFOGgBKVrMGVIMZO : KFYORX ::TLLTOV::KILGLYFU::RMGVIMZO::vCKORXRGOBxLMHGIFXGVW<xLNNZMWiVKOB> {
} _xLNNZMWiVKOB_WVUZFOG_RMHGZMXV_;

MZNVHKZXV KILGLYFU_XLNNZMW_7VKILGL {


MZNVHKZXV {

::TLLTOV::KILGLYFU::nVGZWZGZ UROV_OVEVO_NVGZWZGZ[5];

}  // MZNVHKZXV

XLMHG ::TLLTOV::KILGLYFU::FRMG67 gZYOVhGIFXG::LUUHVGH[] = {
  ~9F,  // ML _SZH_YRGH_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(sVOOLiVJFVHG, _RMGVIMZO_NVGZWZGZ_),
  ~9F,  // ML _VCGVMHRLMH_
  ~9F,  // ML _LMVLU_XZHV_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(sVOOLiVJFVHG, MZNV_),
  ~9F,  // ML _SZH_YRGH_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(sVOOLiVKOB, _RMGVIMZO_NVGZWZGZ_),
  ~9F,  // ML _VCGVMHRLMH_
  ~9F,  // ML _LMVLU_XZHV_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(sVOOLiVKOB, NVHHZTV_),
  ~9F,  // ML _SZH_YRGH_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, _RMGVIMZO_NVGZWZGZ_),
  ~9F,  // ML _VCGVMHRLMH_
  ~9F,  // ML _LMVLU_XZHV_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, FHVI_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, GLPVM_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, XLNNZMW_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, HFY_XLNNZMW_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, ZITFNVMGH_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, OLMTORMV_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, HFKKOVNVMG_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVJFVHG, WZGZ_),
  ~9F,  // ML _SZH_YRGH_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVKOB, _RMGVIMZO_NVGZWZGZ_),
  ~9F,  // ML _VCGVMHRLMH_
  ~9F,  // ML _LMVLU_XZHV_
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVKOB, HGZGFH_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVKOB, NVHHZTV_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVKOB, OLMT_NVHHZTV_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVKOB, EVIB_OLMT_NVHHZTV_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVKOB, WZGZ_),
  tlltov_kilglyfu_tvmvizgvw_nvhhztv_urvow_luuhvg(xLNNZMWiVKOB, HFKKOVNVMG_),
};

HGZGRX XLMHG ::TLLTOV::KILGLYFU::RMGVIMZO::nRTIZGRLMhXSVNZ HXSVNZH[] = {
  { 9, -8, HRAVLU(sVOOLiVJFVHG)},
  { 4, -8, HRAVLU(sVOOLiVKOB)},
  { 89, -8, HRAVLU(xLNNZMWiVJFVHG)},
  { 77, -8, HRAVLU(xLNNZMWiVKOB)},
};

HGZGRX ::TLLTOV::KILGLYFU::nVHHZTV XLMHG * XLMHG UROV_WVUZFOG_RMHGZMXVH[] = {
  IVRMGVIKIVG_XZHG<XLMHG ::TLLTOV::KILGLYFU::nVHHZTV*>(&_sVOOLiVJFVHG_WVUZFOG_RMHGZMXV_),
  IVRMGVIKIVG_XZHG<XLMHG ::TLLTOV::KILGLYFU::nVHHZTV*>(&_sVOOLiVKOB_WVUZFOG_RMHGZMXV_),
  IVRMGVIKIVG_XZHG<XLMHG ::TLLTOV::KILGLYFU::nVHHZTV*>(&_xLNNZMWiVJFVHG_WVUZFOG_RMHGZMXV_),
  IVRMGVIKIVG_XZHG<XLMHG ::TLLTOV::KILGLYFU::nVHHZTV*>(&_xLNNZMWiVKOB_WVUZFOG_RMHGZMXV_),
};

MZNVHKZXV {

ELRW KILGLYFU_zHHRTMwVHXIRKGLIH() {
  zWWwVHXIRKGLIH();
  ::TLLTOV::KILGLYFU::nVHHZTVuZXGLIB* UZXGLIB = mfoo;
  zHHRTMwVHXIRKGLIH(
      "XLNNZMW.KILGL", HXSVNZH, UROV_WVUZFOG_RMHGZMXVH, gZYOVhGIFXG::LUUHVGH, UZXGLIB,
      UROV_OVEVO_NVGZWZGZ, mfoo, mfoo);
}

ELRW KILGLYFU_zHHRTMwVHXIRKGLIHlMXV() {
  HGZGRX tlltov_kilglyfu_wvxoziv_lmxv(LMXV);
  ::TLLTOV::KILGLYFU::tLLTOVlMXVrMRG(&LMXV, &KILGLYFU_zHHRTMwVHXIRKGLIH);
}

ELRW KILGLYFU_iVTRHGVIgBKVH(XLMHG ::HGW::HGIRMT&) tlltov_zggiryfgv_xlow;
ELRW KILGLYFU_iVTRHGVIgBKVH(XLMHG ::HGW::HGIRMT&) {
  KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  ::TLLTOV::KILGLYFU::RMGVIMZO::iVTRHGVIzOOgBKVH(UROV_OVEVO_NVGZWZGZ, 5);
}

}  // MZNVHKZXV

ELRW gZYOVhGIFXG::hSFGWLDM() {
  _sVOOLiVJFVHG_WVUZFOG_RMHGZMXV_.hSFGWLDM();
  WVOVGV UROV_OVEVO_NVGZWZGZ[9].IVUOVXGRLM;
  _sVOOLiVKOB_WVUZFOG_RMHGZMXV_.hSFGWLDM();
  WVOVGV UROV_OVEVO_NVGZWZGZ[8].IVUOVXGRLM;
  _xLNNZMWiVJFVHG_WVUZFOG_RMHGZMXV_.hSFGWLDM();
  WVOVGV UROV_OVEVO_NVGZWZGZ[7].IVUOVXGRLM;
  _xLNNZMWiVKOB_WVUZFOG_RMHGZMXV_.hSFGWLDM();
  WVOVGV UROV_OVEVO_NVGZWZGZ[6].IVUOVXGRLM;
}

ELRW gZYOVhGIFXG::rMRGwVUZFOGHrNKO() {
  tlltov_kilglyfu_evirub_evihrlm;

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMRGkILGLYFUwVUZFOGH();
  _sVOOLiVJFVHG_WVUZFOG_RMHGZMXV_.wVUZFOGxLMHGIFXG();
  _sVOOLiVKOB_WVUZFOG_RMHGZMXV_.wVUZFOGxLMHGIFXG();
  _xLNNZMWiVJFVHG_WVUZFOG_RMHGZMXV_.wVUZFOGxLMHGIFXG();
  _xLNNZMWiVKOB_WVUZFOG_RMHGZMXV_.wVUZFOGxLMHGIFXG();
}

ELRW rMRGwVUZFOGH() {
  HGZGRX tlltov_kilglyfu_wvxoziv_lmxv(LMXV);
  ::TLLTOV::KILGLYFU::tLLTOVlMXVrMRG(&LMXV, &gZYOVhGIFXG::rMRGwVUZFOGHrNKO);
}
ELRW zWWwVHXIRKGLIHrNKO() {
  rMRGwVUZFOGH();
  HGZGRX XLMHG XSZI WVHXIRKGLI[] = {
      "\M\IXLNNZMW.KILGL\977\979hGZIUOVVGxLNNZMW\"\965\M\985sVO"
      "OLiVJFVHG\977\985\M\995MZNV\969\998 \998(\G\"\964\M\MsVOOLiVKOB\977\982\M"
      "\992NVHHZTV\969\998 \998(\G\"\767\998\M\983xLNNZMWiVJFVHG\977\985\M\995FHV"
      "I\969\998 \998(\G\977\I\M\994GLPVM\969\997 \998(\G\977\982\M\992XLNNZMW\969\996 \998(\G\977"
      "\976\M\986HFY_XLNNZMW\969\995 \998(\G\977\978\M\GZITFNVMGH\969\994 \998(\G\977"
      "\979\M\989OLMTORMV\969\993 \998(\G\977\977\M\MHFKKOVNVMG\969\992 \998(\G\977\985\M"
      "\995WZGZ\969\989 \998(\985\"\797\998\M\985xLNNZMWiVKOB\977\983\M\993HGZGFH\969\998"
      " \998(\G\977\982\M\992NVHHZTV\969\997 \998(\G\977\975\M\985OLMT_NVHHZTV\969\996 "
      "\998(\G\977\968\M\978EVIB_OLMT_NVHHZTV\969\995 \998(\G\977\985\M\995WZGZ\969\994"
      " \998(\985\977\977\M\MHFKKOVNVMG\969\993 \998(\G7\748\998\M\992tIVVGVI\977q\M\989"
      "hZBsVOOL\977\963.hGZIUOVVGxLNNZMW.sVOOLiVJFVHG"
      "\967\965.hGZIUOVVGxLNNZMW.sVOOLiVKOB\"\999\977i\M\985rHHF"
      "VxLNNZMW\977 .hGZIUOVVGxLNNZMW.xLNNZMWiVJFV"
      "HG\967\963.hGZIUOVVGxLNNZMW.xLNNZMWiVKOB\"\999Y\993KI"
      "LGL6"
  };
  ::TLLTOV::KILGLYFU::wVHXIRKGLIkLLO::rMGVIMZOzWWtVMVIZGVWuROV(
      WVHXIRKGLI, 435);
  ::TLLTOV::KILGLYFU::nVHHZTVuZXGLIB::rMGVIMZOiVTRHGVItVMVIZGVWuROV(
    "XLNNZMW.KILGL", &KILGLYFU_iVTRHGVIgBKVH);
  ::TLLTOV::KILGLYFU::RMGVIMZO::lMhSFGWLDM(&gZYOVhGIFXG::hSFGWLDM);
}

ELRW zWWwVHXIRKGLIH() {
  HGZGRX tlltov_kilglyfu_wvxoziv_lmxv(LMXV);
  ::TLLTOV::KILGLYFU::tLLTOVlMXVrMRG(&LMXV, &zWWwVHXIRKGLIHrNKO);
}
// uLIXV zWWwVHXIRKGLIH() GL YV XZOOVW ZG HGZGRX RMRGRZORAZGRLM GRNV.
HGIFXG hGZGRXwVHXIRKGLIrMRGRZORAVI {
  hGZGRXwVHXIRKGLIrMRGRZORAVI() {
    zWWwVHXIRKGLIH();
  }
} HGZGRX_WVHXIRKGLI_RMRGRZORAVI;

}  // MZNVHKZXV KILGLYFU_XLNNZMW_7VKILGL


// ===================================================================

#RU !WVURMVW(_nhx_evi) || _nhx_evi >= 8099
XLMHG RMG sVOOLiVJFVHG::PmZNVuRVOWmFNYVI;
#VMWRU  // !WVURMVW(_nhx_evi) || _nhx_evi >= 8099

sVOOLiVJFVHG::sVOOLiVJFVHG()
  : ::TLLTOV::KILGLYFU::nVHHZTV(), _RMGVIMZO_NVGZWZGZ_(mfoo) {
  RU (tlltov_kivwrxg_gifv(GSRH != RMGVIMZO_WVUZFOG_RMHGZMXV())) {
    KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  }
  hSZIVWxGLI();
  // @@KILGLX_RMHVIGRLM_KLRMG(XLMHGIFXGLI:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
}
sVOOLiVJFVHG::sVOOLiVJFVHG(XLMHG sVOOLiVJFVHG& UILN)
  : ::TLLTOV::KILGLYFU::nVHHZTV(),
      _RMGVIMZO_NVGZWZGZ_(mfoo),
      _XZXSVW_HRAV_(9) {
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  MZNV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.MZNV().HRAV() > 9) {
    MZNV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.MZNV_);
  }
  // @@KILGLX_RMHVIGRLM_KLRMG(XLKB_XLMHGIFXGLI:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
}

ELRW sVOOLiVJFVHG::hSZIVWxGLI() {
  MZNV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  _XZXSVW_HRAV_ = 9;
}

sVOOLiVJFVHG::~sVOOLiVJFVHG() {
  // @@KILGLX_RMHVIGRLM_KLRMG(WVHGIFXGLI:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  hSZIVWwGLI();
}

ELRW sVOOLiVJFVHG::hSZIVWwGLI() {
  MZNV_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

ELRW sVOOLiVJFVHG::hVGxZXSVWhRAV(RMG HRAV) XLMHG {
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
}
XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* sVOOLiVJFVHG::WVHXIRKGLI() {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[9].WVHXIRKGLI;
}

XLMHG sVOOLiVJFVHG& sVOOLiVJFVHG::WVUZFOG_RMHGZMXV() {
  KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  IVGFIM *RMGVIMZO_WVUZFOG_RMHGZMXV();
}

sVOOLiVJFVHG* sVOOLiVJFVHG::mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG {
  sVOOLiVJFVHG* M = MVD sVOOLiVJFVHG;
  RU (ZIVMZ != mfoo) {
    ZIVMZ->lDM(M);
  }
  IVGFIM M;
}

ELRW sVOOLiVJFVHG::xOVZI() {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_XOVZI_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  MZNV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

YLLO sVOOLiVJFVHG::nVITVkZIGRZOuILNxLWVWhGIVZN(
    ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) {
#WVURMV wl_(vckivhhrlm) RU (!tlltov_kivwrxg_gifv(vckivhhrlm)) TLGL UZROFIV
  ::TLLTOV::KILGLYFU::FRMG67 GZT;
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  ULI (;;) {
    ::HGW::KZRI< ::TLLTOV::KILGLYFU::FRMG67, YLLO> K = RMKFG->iVZWgZTdRGSxFGLUUmLoZHGgZT(872F);
    GZT = K.URIHG;
    RU (!K.HVXLMW) TLGL SZMWOV_FMFHFZO;
    HDRGXS (::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTuRVOWmFNYVI(GZT)) {
      // HGIRMT MZNV = 8;
      XZHV 8: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(89F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_MZNV()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->MZNV().WZGZ(), GSRH->MZNV().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      WVUZFOG: {
      SZMWOV_FMFHFZO:
        RU (GZT == 9 ||
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTdRIVgBKV(GZT) ==
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::drivgbkv_vmw_tilfk) {
          TLGL HFXXVHH;
        }
        wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hPRKuRVOW(RMKFG, GZT));
        YIVZP;
      }
    }
  }
HFXXVHH:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HFXXVHH:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  IVGFIM GIFV;
UZROFIV:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_UZROFIV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  IVGFIM UZOHV;
#FMWVU wl_
}

ELRW sVOOLiVJFVHG::hVIRZORAVdRGSxZXSVWhRAVH(
    ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  // HGIRMT MZNV = 8;
  RU (GSRH->MZNV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->MZNV().WZGZ(), GSRH->MZNV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      8, GSRH->MZNV(), LFGKFG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_VMW:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
}

::TLLTOV::KILGLYFU::FRMG1* sVOOLiVJFVHG::rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
    YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG {
  (ELRW)WVGVINRMRHGRX;  // fMFHVW
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  // HGIRMT MZNV = 8;
  RU (GSRH->MZNV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->MZNV().WZGZ(), GSRH->MZNV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        8, GSRH->MZNV(), GZITVG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_VMW:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  IVGFIM GZITVG;
}

HRAV_G sVOOLiVJFVHG::yBGVhRAVoLMT() XLMHG {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_YBGV_HRAV_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  HRAV_G GLGZO_HRAV = 9;

  // HGIRMT MZNV = 8;
  RU (GSRH->MZNV().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->MZNV());
  }

  RMG XZXSVW_HRAV = ::TLLTOV::KILGLYFU::RMGVIMZO::gLxZXSVWhRAV(GLGZO_HRAV);
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = XZXSVW_HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
  IVGFIM GLGZO_HRAV;
}

ELRW sVOOLiVJFVHG::nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  XLMHG sVOOLiVJFVHG* HLFIXV =
      ::TLLTOV::KILGLYFU::RMGVIMZO::wBMZNRXxZHGgLtVMVIZGVW<XLMHG sVOOLiVJFVHG>(
          &UILN);
  RU (HLFIXV == mfoo) {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_UZRO:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
    ::TLLTOV::KILGLYFU::RMGVIMZO::iVUOVXGRLMlKH::nVITV(UILN, GSRH);
  } VOHV {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_HFXXVHH:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
    nVITVuILN(*HLFIXV);
  }
}

ELRW sVOOLiVJFVHG::nVITVuILN(XLMHG sVOOLiVJFVHG& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  RU (UILN.MZNV().HRAV() > 9) {

    MZNV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.MZNV_);
  }
}

ELRW sVOOLiVJFVHG::xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

ELRW sVOOLiVJFVHG::xLKBuILN(XLMHG sVOOLiVJFVHG& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

YLLO sVOOLiVJFVHG::rHrMRGRZORAVW() XLMHG {
  IVGFIM GIFV;
}

ELRW sVOOLiVJFVHG::hDZK(sVOOLiVJFVHG* LGSVI) {
  RU (LGSVI == GSRH) IVGFIM;
  rMGVIMZOhDZK(LGSVI);
}
ELRW sVOOLiVJFVHG::rMGVIMZOhDZK(sVOOLiVJFVHG* LGSVI) {
  MZNV_.hDZK(&LGSVI->MZNV_);
  HGW::HDZK(_XZXSVW_HRAV_, LGSVI->_XZXSVW_HRAV_);
}

::TLLTOV::KILGLYFU::nVGZWZGZ sVOOLiVJFVHG::tVGnVGZWZGZ() XLMHG {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[9];
}

#RU kilglyfu_rmormv_mlg_rm_svzwvih
// sVOOLiVJFVHG

// HGIRMT MZNV = 8;
ELRW sVOOLiVJFVHG::XOVZI_MZNV() {
  MZNV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& sVOOLiVJFVHG::MZNV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
  IVGFIM MZNV_.tVGmLzIVMZ();
}
ELRW sVOOLiVJFVHG::HVG_MZNV(XLMHG ::HGW::HGIRMT& EZOFV) {

  MZNV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
#RU ozmt_xcc88
ELRW sVOOLiVJFVHG::HVG_MZNV(::HGW::HGIRMT&& EZOFV) {

  MZNV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
#VMWRU
ELRW sVOOLiVJFVHG::HVG_MZNV(XLMHG XSZI* EZOFV) {

  MZNV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
ELRW sVOOLiVJFVHG::HVG_MZNV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  MZNV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
::HGW::HGIRMT* sVOOLiVJFVHG::NFGZYOV_MZNV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
  IVGFIM MZNV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* sVOOLiVJFVHG::IVOVZHV_MZNV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)

  IVGFIM MZNV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW sVOOLiVJFVHG::HVG_ZOOLXZGVW_MZNV(::HGW::HGIRMT* MZNV) {
  RU (MZNV != mfoo) {

  } VOHV {

  }
  MZNV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), MZNV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}

#VMWRU  // kilglyfu_rmormv_mlg_rm_svzwvih

// ===================================================================

#RU !WVURMVW(_nhx_evi) || _nhx_evi >= 8099
XLMHG RMG sVOOLiVKOB::PnVHHZTVuRVOWmFNYVI;
#VMWRU  // !WVURMVW(_nhx_evi) || _nhx_evi >= 8099

sVOOLiVKOB::sVOOLiVKOB()
  : ::TLLTOV::KILGLYFU::nVHHZTV(), _RMGVIMZO_NVGZWZGZ_(mfoo) {
  RU (tlltov_kivwrxg_gifv(GSRH != RMGVIMZO_WVUZFOG_RMHGZMXV())) {
    KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  }
  hSZIVWxGLI();
  // @@KILGLX_RMHVIGRLM_KLRMG(XLMHGIFXGLI:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
}
sVOOLiVKOB::sVOOLiVKOB(XLMHG sVOOLiVKOB& UILN)
  : ::TLLTOV::KILGLYFU::nVHHZTV(),
      _RMGVIMZO_NVGZWZGZ_(mfoo),
      _XZXSVW_HRAV_(9) {
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.NVHHZTV().HRAV() > 9) {
    NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.NVHHZTV_);
  }
  // @@KILGLX_RMHVIGRLM_KLRMG(XLKB_XLMHGIFXGLI:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
}

ELRW sVOOLiVKOB::hSZIVWxGLI() {
  NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  _XZXSVW_HRAV_ = 9;
}

sVOOLiVKOB::~sVOOLiVKOB() {
  // @@KILGLX_RMHVIGRLM_KLRMG(WVHGIFXGLI:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  hSZIVWwGLI();
}

ELRW sVOOLiVKOB::hSZIVWwGLI() {
  NVHHZTV_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

ELRW sVOOLiVKOB::hVGxZXSVWhRAV(RMG HRAV) XLMHG {
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
}
XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* sVOOLiVKOB::WVHXIRKGLI() {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[8].WVHXIRKGLI;
}

XLMHG sVOOLiVKOB& sVOOLiVKOB::WVUZFOG_RMHGZMXV() {
  KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  IVGFIM *RMGVIMZO_WVUZFOG_RMHGZMXV();
}

sVOOLiVKOB* sVOOLiVKOB::mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG {
  sVOOLiVKOB* M = MVD sVOOLiVKOB;
  RU (ZIVMZ != mfoo) {
    ZIVMZ->lDM(M);
  }
  IVGFIM M;
}

ELRW sVOOLiVKOB::xOVZI() {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_XOVZI_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

YLLO sVOOLiVKOB::nVITVkZIGRZOuILNxLWVWhGIVZN(
    ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) {
#WVURMV wl_(vckivhhrlm) RU (!tlltov_kivwrxg_gifv(vckivhhrlm)) TLGL UZROFIV
  ::TLLTOV::KILGLYFU::FRMG67 GZT;
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  ULI (;;) {
    ::HGW::KZRI< ::TLLTOV::KILGLYFU::FRMG67, YLLO> K = RMKFG->iVZWgZTdRGSxFGLUUmLoZHGgZT(872F);
    GZT = K.URIHG;
    RU (!K.HVXLMW) TLGL SZMWOV_FMFHFZO;
    HDRGXS (::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTuRVOWmFNYVI(GZT)) {
      // HGIRMT NVHHZTV = 8;
      XZHV 8: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(89F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_NVHHZTV()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      WVUZFOG: {
      SZMWOV_FMFHFZO:
        RU (GZT == 9 ||
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTdRIVgBKV(GZT) ==
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::drivgbkv_vmw_tilfk) {
          TLGL HFXXVHH;
        }
        wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hPRKuRVOW(RMKFG, GZT));
        YIVZP;
      }
    }
  }
HFXXVHH:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HFXXVHH:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  IVGFIM GIFV;
UZROFIV:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_UZROFIV:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  IVGFIM UZOHV;
#FMWVU wl_
}

ELRW sVOOLiVKOB::hVIRZORAVdRGSxZXSVWhRAVH(
    ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  // HGIRMT NVHHZTV = 8;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      8, GSRH->NVHHZTV(), LFGKFG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_VMW:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
}

::TLLTOV::KILGLYFU::FRMG1* sVOOLiVKOB::rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
    YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG {
  (ELRW)WVGVINRMRHGRX;  // fMFHVW
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  // HGIRMT NVHHZTV = 8;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        8, GSRH->NVHHZTV(), GZITVG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_VMW:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  IVGFIM GZITVG;
}

HRAV_G sVOOLiVKOB::yBGVhRAVoLMT() XLMHG {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_YBGV_HRAV_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  HRAV_G GLGZO_HRAV = 9;

  // HGIRMT NVHHZTV = 8;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->NVHHZTV());
  }

  RMG XZXSVW_HRAV = ::TLLTOV::KILGLYFU::RMGVIMZO::gLxZXSVWhRAV(GLGZO_HRAV);
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = XZXSVW_HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
  IVGFIM GLGZO_HRAV;
}

ELRW sVOOLiVKOB::nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  XLMHG sVOOLiVKOB* HLFIXV =
      ::TLLTOV::KILGLYFU::RMGVIMZO::wBMZNRXxZHGgLtVMVIZGVW<XLMHG sVOOLiVKOB>(
          &UILN);
  RU (HLFIXV == mfoo) {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_UZRO:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
    ::TLLTOV::KILGLYFU::RMGVIMZO::iVUOVXGRLMlKH::nVITV(UILN, GSRH);
  } VOHV {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_HFXXVHH:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
    nVITVuILN(*HLFIXV);
  }
}

ELRW sVOOLiVKOB::nVITVuILN(XLMHG sVOOLiVKOB& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  RU (UILN.NVHHZTV().HRAV() > 9) {

    NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.NVHHZTV_);
  }
}

ELRW sVOOLiVKOB::xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

ELRW sVOOLiVKOB::xLKBuILN(XLMHG sVOOLiVKOB& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

YLLO sVOOLiVKOB::rHrMRGRZORAVW() XLMHG {
  IVGFIM GIFV;
}

ELRW sVOOLiVKOB::hDZK(sVOOLiVKOB* LGSVI) {
  RU (LGSVI == GSRH) IVGFIM;
  rMGVIMZOhDZK(LGSVI);
}
ELRW sVOOLiVKOB::rMGVIMZOhDZK(sVOOLiVKOB* LGSVI) {
  NVHHZTV_.hDZK(&LGSVI->NVHHZTV_);
  HGW::HDZK(_XZXSVW_HRAV_, LGSVI->_XZXSVW_HRAV_);
}

::TLLTOV::KILGLYFU::nVGZWZGZ sVOOLiVKOB::tVGnVGZWZGZ() XLMHG {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[8];
}

#RU kilglyfu_rmormv_mlg_rm_svzwvih
// sVOOLiVKOB

// HGIRMT NVHHZTV = 8;
ELRW sVOOLiVKOB::XOVZI_NVHHZTV() {
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& sVOOLiVKOB::NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.tVGmLzIVMZ();
}
ELRW sVOOLiVKOB::HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
#RU ozmt_xcc88
ELRW sVOOLiVKOB::HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
#VMWRU
ELRW sVOOLiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
ELRW sVOOLiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
::HGW::HGIRMT* sVOOLiVKOB::NFGZYOV_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* sVOOLiVKOB::IVOVZHV_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)

  IVGFIM NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW sVOOLiVKOB::HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV) {
  RU (NVHHZTV != mfoo) {

  } VOHV {

  }
  NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}

#VMWRU  // kilglyfu_rmormv_mlg_rm_svzwvih

// ===================================================================

#RU !WVURMVW(_nhx_evi) || _nhx_evi >= 8099
XLMHG RMG xLNNZMWiVJFVHG::PfHVIuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVJFVHG::PgLPVMuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVJFVHG::PxLNNZMWuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVJFVHG::PhFYxLNNZMWuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVJFVHG::PzITFNVMGHuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVJFVHG::PoLMTORMVuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVJFVHG::PhFKKOVNVMGuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVJFVHG::PwZGZuRVOWmFNYVI;
#VMWRU  // !WVURMVW(_nhx_evi) || _nhx_evi >= 8099

xLNNZMWiVJFVHG::xLNNZMWiVJFVHG()
  : ::TLLTOV::KILGLYFU::nVHHZTV(), _RMGVIMZO_NVGZWZGZ_(mfoo) {
  RU (tlltov_kivwrxg_gifv(GSRH != RMGVIMZO_WVUZFOG_RMHGZMXV())) {
    KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  }
  hSZIVWxGLI();
  // @@KILGLX_RMHVIGRLM_KLRMG(XLMHGIFXGLI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
}
xLNNZMWiVJFVHG::xLNNZMWiVJFVHG(XLMHG xLNNZMWiVJFVHG& UILN)
  : ::TLLTOV::KILGLYFU::nVHHZTV(),
      _RMGVIMZO_NVGZWZGZ_(mfoo),
      _XZXSVW_HRAV_(9) {
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  FHVI_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.FHVI().HRAV() > 9) {
    FHVI_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.FHVI_);
  }
  GLPVM_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.GLPVM().HRAV() > 9) {
    GLPVM_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.GLPVM_);
  }
  XLNNZMW_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.XLNNZMW().HRAV() > 9) {
    XLNNZMW_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.XLNNZMW_);
  }
  HFY_XLNNZMW_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.HFY_XLNNZMW().HRAV() > 9) {
    HFY_XLNNZMW_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HFY_XLNNZMW_);
  }
  ZITFNVMGH_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.ZITFNVMGH().HRAV() > 9) {
    ZITFNVMGH_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.ZITFNVMGH_);
  }
  OLMTORMV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.OLMTORMV().HRAV() > 9) {
    OLMTORMV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.OLMTORMV_);
  }
  HFKKOVNVMG_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.HFKKOVNVMG().HRAV() > 9) {
    HFKKOVNVMG_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HFKKOVNVMG_);
  }
  WZGZ_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.WZGZ().HRAV() > 9) {
    WZGZ_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.WZGZ_);
  }
  // @@KILGLX_RMHVIGRLM_KLRMG(XLKB_XLMHGIFXGLI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
}

ELRW xLNNZMWiVJFVHG::hSZIVWxGLI() {
  FHVI_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GLPVM_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  XLNNZMW_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFY_XLNNZMW_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  ZITFNVMGH_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  OLMTORMV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFKKOVNVMG_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  _XZXSVW_HRAV_ = 9;
}

xLNNZMWiVJFVHG::~xLNNZMWiVJFVHG() {
  // @@KILGLX_RMHVIGRLM_KLRMG(WVHGIFXGLI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  hSZIVWwGLI();
}

ELRW xLNNZMWiVJFVHG::hSZIVWwGLI() {
  FHVI_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GLPVM_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  XLNNZMW_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFY_XLNNZMW_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  ZITFNVMGH_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  OLMTORMV_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFKKOVNVMG_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

ELRW xLNNZMWiVJFVHG::hVGxZXSVWhRAV(RMG HRAV) XLMHG {
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
}
XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* xLNNZMWiVJFVHG::WVHXIRKGLI() {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[7].WVHXIRKGLI;
}

XLMHG xLNNZMWiVJFVHG& xLNNZMWiVJFVHG::WVUZFOG_RMHGZMXV() {
  KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  IVGFIM *RMGVIMZO_WVUZFOG_RMHGZMXV();
}

xLNNZMWiVJFVHG* xLNNZMWiVJFVHG::mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG {
  xLNNZMWiVJFVHG* M = MVD xLNNZMWiVJFVHG;
  RU (ZIVMZ != mfoo) {
    ZIVMZ->lDM(M);
  }
  IVGFIM M;
}

ELRW xLNNZMWiVJFVHG::xOVZI() {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_XOVZI_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  FHVI_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  GLPVM_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFY_XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  ZITFNVMGH_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  OLMTORMV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFKKOVNVMG_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

YLLO xLNNZMWiVJFVHG::nVITVkZIGRZOuILNxLWVWhGIVZN(
    ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) {
#WVURMV wl_(vckivhhrlm) RU (!tlltov_kivwrxg_gifv(vckivhhrlm)) TLGL UZROFIV
  ::TLLTOV::KILGLYFU::FRMG67 GZT;
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  ULI (;;) {
    ::HGW::KZRI< ::TLLTOV::KILGLYFU::FRMG67, YLLO> K = RMKFG->iVZWgZTdRGSxFGLUUmLoZHGgZT(872F);
    GZT = K.URIHG;
    RU (!K.HVXLMW) TLGL SZMWOV_FMFHFZO;
    HDRGXS (::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTuRVOWmFNYVI(GZT)) {
      // HGIRMT FHVI = 8;
      XZHV 8: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(89F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_FHVI()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->FHVI().WZGZ(), GSRH->FHVI().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT GLPVM = 7;
      XZHV 7: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(81F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_GLPVM()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->GLPVM().WZGZ(), GSRH->GLPVM().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT XLNNZMW = 6;
      XZHV 6: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(73F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_XLNNZMW()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->XLNNZMW().WZGZ(), GSRH->XLNNZMW().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT HFY_XLNNZMW = 5;
      XZHV 5: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(65F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_HFY_XLNNZMW()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->HFY_XLNNZMW().WZGZ(), GSRH->HFY_XLNNZMW().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT ZITFNVMGH = 4;
      XZHV 4: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(57F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_ZITFNVMGH()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->ZITFNVMGH().WZGZ(), GSRH->ZITFNVMGH().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT OLMTORMV = 3;
      XZHV 3: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(49F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_OLMTORMV()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->OLMTORMV().WZGZ(), GSRH->OLMTORMV().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT HFKKOVNVMG = 2;
      XZHV 2: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(41F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_HFKKOVNVMG()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->HFKKOVNVMG().WZGZ(), GSRH->HFKKOVNVMG().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // YBGVH WZGZ = 1;
      XZHV 1: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(33F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWyBGVH(
                RMKFG, GSRH->NFGZYOV_WZGZ()));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      WVUZFOG: {
      SZMWOV_FMFHFZO:
        RU (GZT == 9 ||
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTdRIVgBKV(GZT) ==
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::drivgbkv_vmw_tilfk) {
          TLGL HFXXVHH;
        }
        wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hPRKuRVOW(RMKFG, GZT));
        YIVZP;
      }
    }
  }
HFXXVHH:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HFXXVHH:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  IVGFIM GIFV;
UZROFIV:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_UZROFIV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  IVGFIM UZOHV;
#FMWVU wl_
}

ELRW xLNNZMWiVJFVHG::hVIRZORAVdRGSxZXSVWhRAVH(
    ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  // HGIRMT FHVI = 8;
  RU (GSRH->FHVI().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->FHVI().WZGZ(), GSRH->FHVI().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      8, GSRH->FHVI(), LFGKFG);
  }

  // HGIRMT GLPVM = 7;
  RU (GSRH->GLPVM().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->GLPVM().WZGZ(), GSRH->GLPVM().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      7, GSRH->GLPVM(), LFGKFG);
  }

  // HGIRMT XLNNZMW = 6;
  RU (GSRH->XLNNZMW().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->XLNNZMW().WZGZ(), GSRH->XLNNZMW().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      6, GSRH->XLNNZMW(), LFGKFG);
  }

  // HGIRMT HFY_XLNNZMW = 5;
  RU (GSRH->HFY_XLNNZMW().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HFY_XLNNZMW().WZGZ(), GSRH->HFY_XLNNZMW().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      5, GSRH->HFY_XLNNZMW(), LFGKFG);
  }

  // HGIRMT ZITFNVMGH = 4;
  RU (GSRH->ZITFNVMGH().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->ZITFNVMGH().WZGZ(), GSRH->ZITFNVMGH().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      4, GSRH->ZITFNVMGH(), LFGKFG);
  }

  // HGIRMT OLMTORMV = 3;
  RU (GSRH->OLMTORMV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->OLMTORMV().WZGZ(), GSRH->OLMTORMV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      3, GSRH->OLMTORMV(), LFGKFG);
  }

  // HGIRMT HFKKOVNVMG = 2;
  RU (GSRH->HFKKOVNVMG().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HFKKOVNVMG().WZGZ(), GSRH->HFKKOVNVMG().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      2, GSRH->HFKKOVNVMG(), LFGKFG);
  }

  // YBGVH WZGZ = 1;
  RU (GSRH->WZGZ().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHnZBYVzORZHVW(
      1, GSRH->WZGZ(), LFGKFG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_VMW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
}

::TLLTOV::KILGLYFU::FRMG1* xLNNZMWiVJFVHG::rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
    YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG {
  (ELRW)WVGVINRMRHGRX;  // fMFHVW
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  // HGIRMT FHVI = 8;
  RU (GSRH->FHVI().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->FHVI().WZGZ(), GSRH->FHVI().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        8, GSRH->FHVI(), GZITVG);
  }

  // HGIRMT GLPVM = 7;
  RU (GSRH->GLPVM().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->GLPVM().WZGZ(), GSRH->GLPVM().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        7, GSRH->GLPVM(), GZITVG);
  }

  // HGIRMT XLNNZMW = 6;
  RU (GSRH->XLNNZMW().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->XLNNZMW().WZGZ(), GSRH->XLNNZMW().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        6, GSRH->XLNNZMW(), GZITVG);
  }

  // HGIRMT HFY_XLNNZMW = 5;
  RU (GSRH->HFY_XLNNZMW().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HFY_XLNNZMW().WZGZ(), GSRH->HFY_XLNNZMW().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        5, GSRH->HFY_XLNNZMW(), GZITVG);
  }

  // HGIRMT ZITFNVMGH = 4;
  RU (GSRH->ZITFNVMGH().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->ZITFNVMGH().WZGZ(), GSRH->ZITFNVMGH().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        4, GSRH->ZITFNVMGH(), GZITVG);
  }

  // HGIRMT OLMTORMV = 3;
  RU (GSRH->OLMTORMV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->OLMTORMV().WZGZ(), GSRH->OLMTORMV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        3, GSRH->OLMTORMV(), GZITVG);
  }

  // HGIRMT HFKKOVNVMG = 2;
  RU (GSRH->HFKKOVNVMG().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HFKKOVNVMG().WZGZ(), GSRH->HFKKOVNVMG().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        2, GSRH->HFKKOVNVMG(), GZITVG);
  }

  // YBGVH WZGZ = 1;
  RU (GSRH->WZGZ().HRAV() > 9) {
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHgLzIIZB(
        1, GSRH->WZGZ(), GZITVG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_VMW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  IVGFIM GZITVG;
}

HRAV_G xLNNZMWiVJFVHG::yBGVhRAVoLMT() XLMHG {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_YBGV_HRAV_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  HRAV_G GLGZO_HRAV = 9;

  // HGIRMT FHVI = 8;
  RU (GSRH->FHVI().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->FHVI());
  }

  // HGIRMT GLPVM = 7;
  RU (GSRH->GLPVM().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->GLPVM());
  }

  // HGIRMT XLNNZMW = 6;
  RU (GSRH->XLNNZMW().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->XLNNZMW());
  }

  // HGIRMT HFY_XLNNZMW = 5;
  RU (GSRH->HFY_XLNNZMW().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->HFY_XLNNZMW());
  }

  // HGIRMT ZITFNVMGH = 4;
  RU (GSRH->ZITFNVMGH().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->ZITFNVMGH());
  }

  // HGIRMT OLMTORMV = 3;
  RU (GSRH->OLMTORMV().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->OLMTORMV());
  }

  // HGIRMT HFKKOVNVMG = 2;
  RU (GSRH->HFKKOVNVMG().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->HFKKOVNVMG());
  }

  // YBGVH WZGZ = 1;
  RU (GSRH->WZGZ().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::yBGVHhRAV(
        GSRH->WZGZ());
  }

  RMG XZXSVW_HRAV = ::TLLTOV::KILGLYFU::RMGVIMZO::gLxZXSVWhRAV(GLGZO_HRAV);
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = XZXSVW_HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
  IVGFIM GLGZO_HRAV;
}

ELRW xLNNZMWiVJFVHG::nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  XLMHG xLNNZMWiVJFVHG* HLFIXV =
      ::TLLTOV::KILGLYFU::RMGVIMZO::wBMZNRXxZHGgLtVMVIZGVW<XLMHG xLNNZMWiVJFVHG>(
          &UILN);
  RU (HLFIXV == mfoo) {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_UZRO:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
    ::TLLTOV::KILGLYFU::RMGVIMZO::iVUOVXGRLMlKH::nVITV(UILN, GSRH);
  } VOHV {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_HFXXVHH:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
    nVITVuILN(*HLFIXV);
  }
}

ELRW xLNNZMWiVJFVHG::nVITVuILN(XLMHG xLNNZMWiVJFVHG& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  RU (UILN.FHVI().HRAV() > 9) {

    FHVI_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.FHVI_);
  }
  RU (UILN.GLPVM().HRAV() > 9) {

    GLPVM_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.GLPVM_);
  }
  RU (UILN.XLNNZMW().HRAV() > 9) {

    XLNNZMW_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.XLNNZMW_);
  }
  RU (UILN.HFY_XLNNZMW().HRAV() > 9) {

    HFY_XLNNZMW_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HFY_XLNNZMW_);
  }
  RU (UILN.ZITFNVMGH().HRAV() > 9) {

    ZITFNVMGH_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.ZITFNVMGH_);
  }
  RU (UILN.OLMTORMV().HRAV() > 9) {

    OLMTORMV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.OLMTORMV_);
  }
  RU (UILN.HFKKOVNVMG().HRAV() > 9) {

    HFKKOVNVMG_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HFKKOVNVMG_);
  }
  RU (UILN.WZGZ().HRAV() > 9) {

    WZGZ_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.WZGZ_);
  }
}

ELRW xLNNZMWiVJFVHG::xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

ELRW xLNNZMWiVJFVHG::xLKBuILN(XLMHG xLNNZMWiVJFVHG& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

YLLO xLNNZMWiVJFVHG::rHrMRGRZORAVW() XLMHG {
  IVGFIM GIFV;
}

ELRW xLNNZMWiVJFVHG::hDZK(xLNNZMWiVJFVHG* LGSVI) {
  RU (LGSVI == GSRH) IVGFIM;
  rMGVIMZOhDZK(LGSVI);
}
ELRW xLNNZMWiVJFVHG::rMGVIMZOhDZK(xLNNZMWiVJFVHG* LGSVI) {
  FHVI_.hDZK(&LGSVI->FHVI_);
  GLPVM_.hDZK(&LGSVI->GLPVM_);
  XLNNZMW_.hDZK(&LGSVI->XLNNZMW_);
  HFY_XLNNZMW_.hDZK(&LGSVI->HFY_XLNNZMW_);
  ZITFNVMGH_.hDZK(&LGSVI->ZITFNVMGH_);
  OLMTORMV_.hDZK(&LGSVI->OLMTORMV_);
  HFKKOVNVMG_.hDZK(&LGSVI->HFKKOVNVMG_);
  WZGZ_.hDZK(&LGSVI->WZGZ_);
  HGW::HDZK(_XZXSVW_HRAV_, LGSVI->_XZXSVW_HRAV_);
}

::TLLTOV::KILGLYFU::nVGZWZGZ xLNNZMWiVJFVHG::tVGnVGZWZGZ() XLMHG {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[7];
}

#RU kilglyfu_rmormv_mlg_rm_svzwvih
// xLNNZMWiVJFVHG

// HGIRMT FHVI = 8;
ELRW xLNNZMWiVJFVHG::XOVZI_FHVI() {
  FHVI_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::FHVI() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
  IVGFIM FHVI_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_FHVI(XLMHG ::HGW::HGIRMT& EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_FHVI(::HGW::HGIRMT&& EZOFV) {

  FHVI_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
ELRW xLNNZMWiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_FHVI() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
  IVGFIM FHVI_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_FHVI() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)

  IVGFIM FHVI_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_FHVI(::HGW::HGIRMT* FHVI) {
  RU (FHVI != mfoo) {

  } VOHV {

  }
  FHVI_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), FHVI);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}

// HGIRMT GLPVM = 7;
ELRW xLNNZMWiVJFVHG::XOVZI_GLPVM() {
  GLPVM_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::GLPVM() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
  IVGFIM GLPVM_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_GLPVM(XLMHG ::HGW::HGIRMT& EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_GLPVM(::HGW::HGIRMT&& EZOFV) {

  GLPVM_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
ELRW xLNNZMWiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_GLPVM() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
  IVGFIM GLPVM_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_GLPVM() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)

  IVGFIM GLPVM_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_GLPVM(::HGW::HGIRMT* GLPVM) {
  RU (GLPVM != mfoo) {

  } VOHV {

  }
  GLPVM_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), GLPVM);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}

// HGIRMT XLNNZMW = 6;
ELRW xLNNZMWiVJFVHG::XOVZI_XLNNZMW() {
  XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::XLNNZMW() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(::HGW::HGIRMT&& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_XLNNZMW() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_XLNNZMW() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)

  IVGFIM XLNNZMW_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_XLNNZMW(::HGW::HGIRMT* XLNNZMW) {
  RU (XLNNZMW != mfoo) {

  } VOHV {

  }
  XLNNZMW_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), XLNNZMW);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}

// HGIRMT HFY_XLNNZMW = 5;
ELRW xLNNZMWiVJFVHG::XOVZI_HFY_XLNNZMW() {
  HFY_XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::HFY_XLNNZMW() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
  IVGFIM HFY_XLNNZMW_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(::HGW::HGIRMT&& EZOFV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(XLMHG XSZI* EZOFV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_HFY_XLNNZMW() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
  IVGFIM HFY_XLNNZMW_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_HFY_XLNNZMW() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)

  IVGFIM HFY_XLNNZMW_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_HFY_XLNNZMW(::HGW::HGIRMT* HFY_XLNNZMW) {
  RU (HFY_XLNNZMW != mfoo) {

  } VOHV {

  }
  HFY_XLNNZMW_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HFY_XLNNZMW);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}

// HGIRMT ZITFNVMGH = 4;
ELRW xLNNZMWiVJFVHG::XOVZI_ZITFNVMGH() {
  ZITFNVMGH_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::ZITFNVMGH() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
  IVGFIM ZITFNVMGH_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(XLMHG ::HGW::HGIRMT& EZOFV) {

  ZITFNVMGH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(::HGW::HGIRMT&& EZOFV) {

  ZITFNVMGH_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(XLMHG XSZI* EZOFV) {

  ZITFNVMGH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  ZITFNVMGH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_ZITFNVMGH() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
  IVGFIM ZITFNVMGH_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_ZITFNVMGH() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)

  IVGFIM ZITFNVMGH_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_ZITFNVMGH(::HGW::HGIRMT* ZITFNVMGH) {
  RU (ZITFNVMGH != mfoo) {

  } VOHV {

  }
  ZITFNVMGH_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ZITFNVMGH);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}

// HGIRMT OLMTORMV = 3;
ELRW xLNNZMWiVJFVHG::XOVZI_OLMTORMV() {
  OLMTORMV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::OLMTORMV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
  IVGFIM OLMTORMV_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(XLMHG ::HGW::HGIRMT& EZOFV) {

  OLMTORMV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(::HGW::HGIRMT&& EZOFV) {

  OLMTORMV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(XLMHG XSZI* EZOFV) {

  OLMTORMV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  OLMTORMV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_OLMTORMV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
  IVGFIM OLMTORMV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_OLMTORMV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)

  IVGFIM OLMTORMV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_OLMTORMV(::HGW::HGIRMT* OLMTORMV) {
  RU (OLMTORMV != mfoo) {

  } VOHV {

  }
  OLMTORMV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), OLMTORMV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}

// HGIRMT HFKKOVNVMG = 2;
ELRW xLNNZMWiVJFVHG::XOVZI_HFKKOVNVMG() {
  HFKKOVNVMG_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::HFKKOVNVMG() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(XLMHG ::HGW::HGIRMT& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(::HGW::HGIRMT&& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_HFKKOVNVMG() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_HFKKOVNVMG() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)

  IVGFIM HFKKOVNVMG_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_HFKKOVNVMG(::HGW::HGIRMT* HFKKOVNVMG) {
  RU (HFKKOVNVMG != mfoo) {

  } VOHV {

  }
  HFKKOVNVMG_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HFKKOVNVMG);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}

// YBGVH WZGZ = 1;
ELRW xLNNZMWiVJFVHG::XOVZI_WZGZ() {
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::WZGZ() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
  IVGFIM WZGZ_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVJFVHG::HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVJFVHG::HVG_WZGZ(::HGW::HGIRMT&& EZOFV) {

  WZGZ_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
#VMWRU
ELRW xLNNZMWiVJFVHG::HVG_WZGZ(XLMHG XSZI* EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
ELRW xLNNZMWiVJFVHG::HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_WZGZ() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
  IVGFIM WZGZ_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_WZGZ() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)

  IVGFIM WZGZ_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ) {
  RU (WZGZ != mfoo) {

  } VOHV {

  }
  WZGZ_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), WZGZ);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}

#VMWRU  // kilglyfu_rmormv_mlg_rm_svzwvih

// ===================================================================

#RU !WVURMVW(_nhx_evi) || _nhx_evi >= 8099
XLMHG RMG xLNNZMWiVKOB::PhGZGFHuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVKOB::PnVHHZTVuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVKOB::PoLMTnVHHZTVuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVKOB::PeVIBoLMTnVHHZTVuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVKOB::PwZGZuRVOWmFNYVI;
XLMHG RMG xLNNZMWiVKOB::PhFKKOVNVMGuRVOWmFNYVI;
#VMWRU  // !WVURMVW(_nhx_evi) || _nhx_evi >= 8099

xLNNZMWiVKOB::xLNNZMWiVKOB()
  : ::TLLTOV::KILGLYFU::nVHHZTV(), _RMGVIMZO_NVGZWZGZ_(mfoo) {
  RU (tlltov_kivwrxg_gifv(GSRH != RMGVIMZO_WVUZFOG_RMHGZMXV())) {
    KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  }
  hSZIVWxGLI();
  // @@KILGLX_RMHVIGRLM_KLRMG(XLMHGIFXGLI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
}
xLNNZMWiVKOB::xLNNZMWiVKOB(XLMHG xLNNZMWiVKOB& UILN)
  : ::TLLTOV::KILGLYFU::nVHHZTV(),
      _RMGVIMZO_NVGZWZGZ_(mfoo),
      _XZXSVW_HRAV_(9) {
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  HGZGFH_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.HGZGFH().HRAV() > 9) {
    HGZGFH_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HGZGFH_);
  }
  NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.NVHHZTV().HRAV() > 9) {
    NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.NVHHZTV_);
  }
  OLMT_NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.OLMT_NVHHZTV().HRAV() > 9) {
    OLMT_NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.OLMT_NVHHZTV_);
  }
  EVIB_OLMT_NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.EVIB_OLMT_NVHHZTV().HRAV() > 9) {
    EVIB_OLMT_NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.EVIB_OLMT_NVHHZTV_);
  }
  WZGZ_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.WZGZ().HRAV() > 9) {
    WZGZ_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.WZGZ_);
  }
  HFKKOVNVMG_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  RU (UILN.HFKKOVNVMG().HRAV() > 9) {
    HFKKOVNVMG_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HFKKOVNVMG_);
  }
  // @@KILGLX_RMHVIGRLM_KLRMG(XLKB_XLMHGIFXGLI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
}

ELRW xLNNZMWiVKOB::hSZIVWxGLI() {
  HGZGFH_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  OLMT_NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  EVIB_OLMT_NVHHZTV_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFKKOVNVMG_.fMHZUVhVGwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  _XZXSVW_HRAV_ = 9;
}

xLNNZMWiVKOB::~xLNNZMWiVKOB() {
  // @@KILGLX_RMHVIGRLM_KLRMG(WVHGIFXGLI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  hSZIVWwGLI();
}

ELRW xLNNZMWiVKOB::hSZIVWwGLI() {
  HGZGFH_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  NVHHZTV_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  OLMT_NVHHZTV_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  EVIB_OLMT_NVHHZTV_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFKKOVNVMG_.wVHGILBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

ELRW xLNNZMWiVKOB::hVGxZXSVWhRAV(RMG HRAV) XLMHG {
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
}
XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* xLNNZMWiVKOB::WVHXIRKGLI() {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[6].WVHXIRKGLI;
}

XLMHG xLNNZMWiVKOB& xLNNZMWiVKOB::WVUZFOG_RMHGZMXV() {
  KILGLYFU_XLNNZMW_7VKILGL::rMRGwVUZFOGH();
  IVGFIM *RMGVIMZO_WVUZFOG_RMHGZMXV();
}

xLNNZMWiVKOB* xLNNZMWiVKOB::mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG {
  xLNNZMWiVKOB* M = MVD xLNNZMWiVKOB;
  RU (ZIVMZ != mfoo) {
    ZIVMZ->lDM(M);
  }
  IVGFIM M;
}

ELRW xLNNZMWiVKOB::xOVZI() {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_XOVZI_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  HGZGFH_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  OLMT_NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  EVIB_OLMT_NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
  HFKKOVNVMG_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}

YLLO xLNNZMWiVKOB::nVITVkZIGRZOuILNxLWVWhGIVZN(
    ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) {
#WVURMV wl_(vckivhhrlm) RU (!tlltov_kivwrxg_gifv(vckivhhrlm)) TLGL UZROFIV
  ::TLLTOV::KILGLYFU::FRMG67 GZT;
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  ULI (;;) {
    ::HGW::KZRI< ::TLLTOV::KILGLYFU::FRMG67, YLLO> K = RMKFG->iVZWgZTdRGSxFGLUUmLoZHGgZT(872F);
    GZT = K.URIHG;
    RU (!K.HVXLMW) TLGL SZMWOV_FMFHFZO;
    HDRGXS (::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTuRVOWmFNYVI(GZT)) {
      // HGIRMT HGZGFH = 8;
      XZHV 8: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(89F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_HGZGFH()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->HGZGFH().WZGZ(), GSRH->HGZGFH().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT NVHHZTV = 7;
      XZHV 7: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(81F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_NVHHZTV()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT OLMT_NVHHZTV = 6;
      XZHV 6: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(73F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_OLMT_NVHHZTV()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->OLMT_NVHHZTV().WZGZ(), GSRH->OLMT_NVHHZTV().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT EVIB_OLMT_NVHHZTV = 5;
      XZHV 5: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(65F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_EVIB_OLMT_NVHHZTV()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->EVIB_OLMT_NVHHZTV().WZGZ(), GSRH->EVIB_OLMT_NVHHZTV().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // YBGVH WZGZ = 4;
      XZHV 4: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(57F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWyBGVH(
                RMKFG, GSRH->NFGZYOV_WZGZ()));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      // HGIRMT HFKKOVNVMG = 3;
      XZHV 3: {
        RU (HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(GZT) ==
            HGZGRX_XZHG< ::TLLTOV::KILGLYFU::FRMG1>(49F)) {
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::iVZWhGIRMT(
                RMKFG, GSRH->NFGZYOV_HFKKOVNVMG()));
          wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
            GSRH->HFKKOVNVMG().WZGZ(), GSRH->HFKKOVNVMG().OVMTGS(),
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::kzihv,
            "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG"));
        } VOHV {
          TLGL SZMWOV_FMFHFZO;
        }
        YIVZP;
      }

      WVUZFOG: {
      SZMWOV_FMFHFZO:
        RU (GZT == 9 ||
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::tVGgZTdRIVgBKV(GZT) ==
            ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::drivgbkv_vmw_tilfk) {
          TLGL HFXXVHH;
        }
        wl_(::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hPRKuRVOW(RMKFG, GZT));
        YIVZP;
      }
    }
  }
HFXXVHH:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_HFXXVHH:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  IVGFIM GIFV;
UZROFIV:
  // @@KILGLX_RMHVIGRLM_KLRMG(KZIHV_UZROFIV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  IVGFIM UZOHV;
#FMWVU wl_
}

ELRW xLNNZMWiVKOB::hVIRZORAVdRGSxZXSVWhRAVH(
    ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  // HGIRMT HGZGFH = 8;
  RU (GSRH->HGZGFH().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HGZGFH().WZGZ(), GSRH->HGZGFH().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      8, GSRH->HGZGFH(), LFGKFG);
  }

  // HGIRMT NVHHZTV = 7;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      7, GSRH->NVHHZTV(), LFGKFG);
  }

  // HGIRMT OLMT_NVHHZTV = 6;
  RU (GSRH->OLMT_NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->OLMT_NVHHZTV().WZGZ(), GSRH->OLMT_NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      6, GSRH->OLMT_NVHHZTV(), LFGKFG);
  }

  // HGIRMT EVIB_OLMT_NVHHZTV = 5;
  RU (GSRH->EVIB_OLMT_NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->EVIB_OLMT_NVHHZTV().WZGZ(), GSRH->EVIB_OLMT_NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      5, GSRH->EVIB_OLMT_NVHHZTV(), LFGKFG);
  }

  // YBGVH WZGZ = 4;
  RU (GSRH->WZGZ().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHnZBYVzORZHVW(
      4, GSRH->WZGZ(), LFGKFG);
  }

  // HGIRMT HFKKOVNVMG = 3;
  RU (GSRH->HFKKOVNVMG().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HFKKOVNVMG().WZGZ(), GSRH->HFKKOVNVMG().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG");
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTnZBYVzORZHVW(
      3, GSRH->HFKKOVNVMG(), LFGKFG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_VMW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
}

::TLLTOV::KILGLYFU::FRMG1* xLNNZMWiVKOB::rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
    YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG {
  (ELRW)WVGVINRMRHGRX;  // fMFHVW
  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  // HGIRMT HGZGFH = 8;
  RU (GSRH->HGZGFH().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HGZGFH().WZGZ(), GSRH->HGZGFH().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        8, GSRH->HGZGFH(), GZITVG);
  }

  // HGIRMT NVHHZTV = 7;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->NVHHZTV().WZGZ(), GSRH->NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        7, GSRH->NVHHZTV(), GZITVG);
  }

  // HGIRMT OLMT_NVHHZTV = 6;
  RU (GSRH->OLMT_NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->OLMT_NVHHZTV().WZGZ(), GSRH->OLMT_NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        6, GSRH->OLMT_NVHHZTV(), GZITVG);
  }

  // HGIRMT EVIB_OLMT_NVHHZTV = 5;
  RU (GSRH->EVIB_OLMT_NVHHZTV().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->EVIB_OLMT_NVHHZTV().WZGZ(), GSRH->EVIB_OLMT_NVHHZTV().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        5, GSRH->EVIB_OLMT_NVHHZTV(), GZITVG);
  }

  // YBGVH WZGZ = 4;
  RU (GSRH->WZGZ().HRAV() > 9) {
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVyBGVHgLzIIZB(
        4, GSRH->WZGZ(), GZITVG);
  }

  // HGIRMT HFKKOVNVMG = 3;
  RU (GSRH->HFKKOVNVMG().HRAV() > 9) {
    ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::eVIRUBfGU1hGIRMT(
      GSRH->HFKKOVNVMG().WZGZ(), GSRH->HFKKOVNVMG().OVMTGS(),
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hvirzorav,
      "hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG");
    GZITVG =
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::dIRGVhGIRMTgLzIIZB(
        3, GSRH->HFKKOVNVMG(), GZITVG);
  }

  // @@KILGLX_RMHVIGRLM_KLRMG(HVIRZORAV_GL_ZIIZB_VMW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  IVGFIM GZITVG;
}

HRAV_G xLNNZMWiVKOB::yBGVhRAVoLMT() XLMHG {
// @@KILGLX_RMHVIGRLM_KLRMG(NVHHZTV_YBGV_HRAV_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  HRAV_G GLGZO_HRAV = 9;

  // HGIRMT HGZGFH = 8;
  RU (GSRH->HGZGFH().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->HGZGFH());
  }

  // HGIRMT NVHHZTV = 7;
  RU (GSRH->NVHHZTV().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->NVHHZTV());
  }

  // HGIRMT OLMT_NVHHZTV = 6;
  RU (GSRH->OLMT_NVHHZTV().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->OLMT_NVHHZTV());
  }

  // HGIRMT EVIB_OLMT_NVHHZTV = 5;
  RU (GSRH->EVIB_OLMT_NVHHZTV().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->EVIB_OLMT_NVHHZTV());
  }

  // YBGVH WZGZ = 4;
  RU (GSRH->WZGZ().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::yBGVHhRAV(
        GSRH->WZGZ());
  }

  // HGIRMT HFKKOVNVMG = 3;
  RU (GSRH->HFKKOVNVMG().HRAV() > 9) {
    GLGZO_HRAV += 8 +
      ::TLLTOV::KILGLYFU::RMGVIMZO::dRIVuLINZGoRGV::hGIRMThRAV(
        GSRH->HFKKOVNVMG());
  }

  RMG XZXSVW_HRAV = ::TLLTOV::KILGLYFU::RMGVIMZO::gLxZXSVWhRAV(GLGZO_HRAV);
  tlltov_hzuv_xlmxfiivmg_dirgvh_yvtrm();
  _XZXSVW_HRAV_ = XZXSVW_HRAV;
  tlltov_hzuv_xlmxfiivmg_dirgvh_vmw();
  IVGFIM GLGZO_HRAV;
}

ELRW xLNNZMWiVKOB::nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  XLMHG xLNNZMWiVKOB* HLFIXV =
      ::TLLTOV::KILGLYFU::RMGVIMZO::wBMZNRXxZHGgLtVMVIZGVW<XLMHG xLNNZMWiVKOB>(
          &UILN);
  RU (HLFIXV == mfoo) {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_UZRO:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
    ::TLLTOV::KILGLYFU::RMGVIMZO::iVUOVXGRLMlKH::nVITV(UILN, GSRH);
  } VOHV {
  // @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_NVITV_UILN_XZHG_HFXXVHH:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
    nVITVuILN(*HLFIXV);
  }
}

ELRW xLNNZMWiVKOB::nVITVuILN(XLMHG xLNNZMWiVKOB& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_NVITV_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  tlltov_wxsvxp_mv(&UILN, GSRH);
  _RMGVIMZO_NVGZWZGZ_.nVITVuILN(UILN._RMGVIMZO_NVGZWZGZ_);
  RU (UILN.HGZGFH().HRAV() > 9) {

    HGZGFH_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HGZGFH_);
  }
  RU (UILN.NVHHZTV().HRAV() > 9) {

    NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.NVHHZTV_);
  }
  RU (UILN.OLMT_NVHHZTV().HRAV() > 9) {

    OLMT_NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.OLMT_NVHHZTV_);
  }
  RU (UILN.EVIB_OLMT_NVHHZTV().HRAV() > 9) {

    EVIB_OLMT_NVHHZTV_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.EVIB_OLMT_NVHHZTV_);
  }
  RU (UILN.WZGZ().HRAV() > 9) {

    WZGZ_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.WZGZ_);
  }
  RU (UILN.HFKKOVNVMG().HRAV() > 9) {

    HFKKOVNVMG_.zHHRTMdRGSwVUZFOG(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), UILN.HFKKOVNVMG_);
  }
}

ELRW xLNNZMWiVKOB::xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(TVMVIZORAVW_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

ELRW xLNNZMWiVKOB::xLKBuILN(XLMHG xLNNZMWiVKOB& UILN) {
// @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HKVXRURX_XLKB_UILN_HGZIG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
  RU (&UILN == GSRH) IVGFIM;
  xOVZI();
  nVITVuILN(UILN);
}

YLLO xLNNZMWiVKOB::rHrMRGRZORAVW() XLMHG {
  IVGFIM GIFV;
}

ELRW xLNNZMWiVKOB::hDZK(xLNNZMWiVKOB* LGSVI) {
  RU (LGSVI == GSRH) IVGFIM;
  rMGVIMZOhDZK(LGSVI);
}
ELRW xLNNZMWiVKOB::rMGVIMZOhDZK(xLNNZMWiVKOB* LGSVI) {
  HGZGFH_.hDZK(&LGSVI->HGZGFH_);
  NVHHZTV_.hDZK(&LGSVI->NVHHZTV_);
  OLMT_NVHHZTV_.hDZK(&LGSVI->OLMT_NVHHZTV_);
  EVIB_OLMT_NVHHZTV_.hDZK(&LGSVI->EVIB_OLMT_NVHHZTV_);
  WZGZ_.hDZK(&LGSVI->WZGZ_);
  HFKKOVNVMG_.hDZK(&LGSVI->HFKKOVNVMG_);
  HGW::HDZK(_XZXSVW_HRAV_, LGSVI->_XZXSVW_HRAV_);
}

::TLLTOV::KILGLYFU::nVGZWZGZ xLNNZMWiVKOB::tVGnVGZWZGZ() XLMHG {
  KILGLYFU_XLNNZMW_7VKILGL::KILGLYFU_zHHRTMwVHXIRKGLIHlMXV();
  IVGFIM KILGLYFU_XLNNZMW_7VKILGL::UROV_OVEVO_NVGZWZGZ[6];
}

#RU kilglyfu_rmormv_mlg_rm_svzwvih
// xLNNZMWiVKOB

// HGIRMT HGZGFH = 8;
ELRW xLNNZMWiVKOB::XOVZI_HGZGFH() {
  HGZGFH_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::HGZGFH() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
  IVGFIM HGZGFH_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVKOB::HVG_HGZGFH(XLMHG ::HGW::HGIRMT& EZOFV) {

  HGZGFH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVKOB::HVG_HGZGFH(::HGW::HGIRMT&& EZOFV) {

  HGZGFH_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
#VMWRU
ELRW xLNNZMWiVKOB::HVG_HGZGFH(XLMHG XSZI* EZOFV) {

  HGZGFH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
ELRW xLNNZMWiVKOB::HVG_HGZGFH(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HGZGFH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_HGZGFH() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
  IVGFIM HGZGFH_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_HGZGFH() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)

  IVGFIM HGZGFH_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_HGZGFH(::HGW::HGIRMT* HGZGFH) {
  RU (HGZGFH != mfoo) {

  } VOHV {

  }
  HGZGFH_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HGZGFH);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}

// HGIRMT NVHHZTV = 7;
ELRW xLNNZMWiVKOB::XOVZI_NVHHZTV() {
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVKOB::HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVKOB::HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
#VMWRU
ELRW xLNNZMWiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
ELRW xLNNZMWiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)

  IVGFIM NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV) {
  RU (NVHHZTV != mfoo) {

  } VOHV {

  }
  NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}

// HGIRMT OLMT_NVHHZTV = 6;
ELRW xLNNZMWiVKOB::XOVZI_OLMT_NVHHZTV() {
  OLMT_NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::OLMT_NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
  IVGFIM OLMT_NVHHZTV_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
#VMWRU
ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(XLMHG XSZI* EZOFV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_OLMT_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
  IVGFIM OLMT_NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_OLMT_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)

  IVGFIM OLMT_NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_OLMT_NVHHZTV(::HGW::HGIRMT* OLMT_NVHHZTV) {
  RU (OLMT_NVHHZTV != mfoo) {

  } VOHV {

  }
  OLMT_NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), OLMT_NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}

// HGIRMT EVIB_OLMT_NVHHZTV = 5;
ELRW xLNNZMWiVKOB::XOVZI_EVIB_OLMT_NVHHZTV() {
  EVIB_OLMT_NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::EVIB_OLMT_NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
  IVGFIM EVIB_OLMT_NVHHZTV_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
#VMWRU
ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(XLMHG XSZI* EZOFV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_EVIB_OLMT_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
  IVGFIM EVIB_OLMT_NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_EVIB_OLMT_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)

  IVGFIM EVIB_OLMT_NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_EVIB_OLMT_NVHHZTV(::HGW::HGIRMT* EVIB_OLMT_NVHHZTV) {
  RU (EVIB_OLMT_NVHHZTV != mfoo) {

  } VOHV {

  }
  EVIB_OLMT_NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EVIB_OLMT_NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}

// YBGVH WZGZ = 4;
ELRW xLNNZMWiVKOB::XOVZI_WZGZ() {
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::WZGZ() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
  IVGFIM WZGZ_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVKOB::HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVKOB::HVG_WZGZ(::HGW::HGIRMT&& EZOFV) {

  WZGZ_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
#VMWRU
ELRW xLNNZMWiVKOB::HVG_WZGZ(XLMHG XSZI* EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
ELRW xLNNZMWiVKOB::HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_WZGZ() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
  IVGFIM WZGZ_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_WZGZ() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)

  IVGFIM WZGZ_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ) {
  RU (WZGZ != mfoo) {

  } VOHV {

  }
  WZGZ_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), WZGZ);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}

// HGIRMT HFKKOVNVMG = 3;
ELRW xLNNZMWiVKOB::XOVZI_HFKKOVNVMG() {
  HFKKOVNVMG_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::HFKKOVNVMG() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.tVGmLzIVMZ();
}
ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(XLMHG ::HGW::HGIRMT& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
#RU ozmt_xcc88
ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(::HGW::HGIRMT&& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
#VMWRU
ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_HFKKOVNVMG() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_HFKKOVNVMG() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)

  IVGFIM HFKKOVNVMG_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_HFKKOVNVMG(::HGW::HGIRMT* HFKKOVNVMG) {
  RU (HFKKOVNVMG != mfoo) {

  } VOHV {

  }
  HFKKOVNVMG_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HFKKOVNVMG);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}

#VMWRU  // kilglyfu_rmormv_mlg_rm_svzwvih

// @@KILGLX_RMHVIGRLM_KLRMG(MZNVHKZXV_HXLKV)

}  // MZNVHKZXV hGZIUOVVGxLNNZMW

// @@KILGLX_RMHVIGRLM_KLRMG(TOLYZO_HXLKV)
//##**---------------- ./HGZIUOVVG/XKK/WLXPVI.TIKX.KY.S
// tVMVIZGVW YB GSV Tikx x++ KOFTRM.
// rU BLF NZPV ZMB OLXZO XSZMTV, GSVB DROO YV OLHG.
// HLFIXV: WLXPVI.KILGL
#RUMWVU tikx_WLXPVI_7VKILGL__rmxofwvw
#WVURMV tikx_WLXPVI_7VKILGL__rmxofwvw

#RMXOFWV "WLXPVI.KY.S"

#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_HGIVZN.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_FMZIB_XZOO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/NVGSLW_SZMWOVI_RNKO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/KILGL_FGROH.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/IKX_NVGSLW.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HVIERXV_GBKV.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HGZGFH.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HGFY_LKGRLMH.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HBMX_HGIVZN.S>

MZNVHKZXV TIKX {
XOZHH xLNKOVGRLMjFVFV;
XOZHH xSZMMVO;
XOZHH iKXhVIERXV;
XOZHH hVIEVIxLNKOVGRLMjFVFV;
XOZHH hVIEVIxLMGVCG;
}  // MZNVHKZXV TIKX

MZNVHKZXV hGZIUOVVGwLXPVI {

// gSV TIVVGRMT HVIERXV WVURMRGRLM.
XOZHH tIVVGVI URMZO {
 KFYORX:
  HGZGRX XLMHGVCKI XSZI XLMHG* HVIERXV_UFOO_MZNV() {
    IVGFIM "hGZIUOVVGwLXPVI.tIVVGVI";
  }
  XOZHH hGFYrMGVIUZXV {
   KFYORX:
    ERIGFZO ~hGFYrMGVIUZXV() {}
    // hVMWH Z TIVVGRMT
    ERIGFZO ::TIKX::hGZGFH hVMWqLY(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV) = 9;
    HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGwLXPVI::qLYiVKOB>> zHBMXhVMWqLY(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
      IVGFIM HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGwLXPVI::qLYiVKOB>>(zHBMXhVMWqLYiZD(XLMGVCG, IVJFVHG, XJ));
    }
  KIREZGV:
    ERIGFZO ::TIKX::xORVMGzHBMXiVHKLMHViVZWVIrMGVIUZXV< ::hGZIUOVVGwLXPVI::qLYiVKOB>* zHBMXhVMWqLYiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) = 9;
  };
  XOZHH hGFY URMZO : KFYORX hGFYrMGVIUZXV {
   KFYORX:
    hGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO);
    ::TIKX::hGZGFH hVMWqLY(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV) LEVIIRWV;
    HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGwLXPVI::qLYiVKOB>> zHBMXhVMWqLY(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
      IVGFIM HGW::FMRJFV_KGI< ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGwLXPVI::qLYiVKOB>>(zHBMXhVMWqLYiZD(XLMGVCG, IVJFVHG, XJ));
    }

   KIREZGV:
    HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV> XSZMMVO_;
    ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGwLXPVI::qLYiVKOB>* zHBMXhVMWqLYiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) LEVIIRWV;
    XLMHG ::TIKX::iKXnVGSLW IKXNVGSLW_hVMWqLY_;
  };
  HGZGRX HGW::FMRJFV_KGI<hGFY> mVDhGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO, XLMHG ::TIKX::hGFYlKGRLMH& LKGRLMH = ::TIKX::hGFYlKGRLMH());

  XOZHH hVIERXV : KFYORX ::TIKX::hVIERXV {
   KFYORX:
    hVIERXV();
    ERIGFZO ~hVIERXV();
    // hVMWH Z TIVVGRMT
    ERIGFZO ::TIKX::hGZGFH hVMWqLY(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG* IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV);
  };
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGSzHBMXnVGSLW_hVMWqLY : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGSzHBMXnVGSLW_hVMWqLY() {
      ::TIKX::hVIERXV::nZIPnVGSLWzHBMX(9);
    }
    ~dRGSzHBMXnVGSLW_hVMWqLY() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV HBMXSILMLFH EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH hVMWqLY(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG* IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
    ELRW iVJFVHGhVMWqLY(::TIKX::hVIEVIxLMGVCG* XLMGVCG, ::hGZIUOVVGwLXPVI::qLYiVJFVHG* IVJFVHG, ::TIKX::hVIEVIzHBMXiVHKLMHVdIRGVI< ::hGZIUOVVGwLXPVI::qLYiVKOB>* IVHKLMHV, ::TIKX::xLNKOVGRLMjFVFV* MVD_XZOO_XJ, ::TIKX::hVIEVIxLNKOVGRLMjFVFV* MLGRURXZGRLM_XJ, ELRW *GZT) {
      ::TIKX::hVIERXV::iVJFVHGzHBMXfMZIB(9, XLMGVCG, IVJFVHG, IVHKLMHV, MVD_XZOO_XJ, MLGRURXZGRLM_XJ, GZT);
    }
  };
  GBKVWVU dRGSzHBMXnVGSLW_hVMWqLY<hVIERXV > zHBMXhVIERXV;
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGStVMVIRXnVGSLW_hVMWqLY : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGStVMVIRXnVGSLW_hVMWqLY() {
      ::TIKX::hVIERXV::nZIPnVGSLWtVMVIRX(9);
    }
    ~dRGStVMVIRXnVGSLW_hVMWqLY() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV HBMXSILMLFH EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH hVMWqLY(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG* IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
  };
  GVNKOZGV <XOZHH yZHVxOZHH>
  XOZHH dRGShGIVZNVWfMZIBnVGSLW_hVMWqLY : KFYORX yZHVxOZHH {
   KIREZGV:
    ELRW yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(XLMHG hVIERXV *HVIERXV) {}
   KFYORX:
    dRGShGIVZNVWfMZIBnVGSLW_hVMWqLY() {
      ::TIKX::hVIERXV::nZIPnVGSLWhGIVZNVW(9,
        MVD ::TIKX::hGIVZNVWfMZIBsZMWOVI< ::hGZIUOVVGwLXPVI::qLYiVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB>(HGW::YRMW(&dRGShGIVZNVWfMZIBnVGSLW_hVMWqLY<yZHVxOZHH>::hGIVZNVWhVMWqLY, GSRH, HGW::KOZXVSLOWVIH::_8, HGW::KOZXVSLOWVIH::_7)));
    }
    ~dRGShGIVZNVWfMZIBnVGSLW_hVMWqLY() LEVIIRWV {
      yZHVxOZHHnFHGyVwVIREVWuILNhVIERXV(GSRH);
    }
    // WRHZYOV IVTFOZI EVIHRLM LU GSRH NVGSLW
    ::TIKX::hGZGFH hVMWqLY(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG* IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV) URMZO LEVIIRWV {
      ZYLIG();
      IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
    }
    // IVKOZXV WVUZFOG EVIHRLM LU NVGSLW DRGS HGIVZNVW FMZIB
    ERIGFZO ::TIKX::hGZGFH hGIVZNVWhVMWqLY(::TIKX::hVIEVIxLMGVCG* XLMGVCG, ::TIKX::hVIEVIfMZIBhGIVZNVI< ::hGZIUOVVGwLXPVI::qLYiVJFVHG,::hGZIUOVVGwLXPVI::qLYiVKOB>* HVIEVI_FMZIB_HGIVZNVI) = 9;
  };
  GBKVWVU dRGShGIVZNVWfMZIBnVGSLW_hVMWqLY<hVIERXV > hGIVZNVWfMZIBhVIERXV;
  GBKVWVU hVIERXV hKORGhGIVZNVWhVIERXV;
  GBKVWVU dRGShGIVZNVWfMZIBnVGSLW_hVMWqLY<hVIERXV > hGIVZNVWhVIERXV;
};

}  // MZNVHKZXV hGZIUOVVGwLXPVI


#VMWRU  // tikx_WLXPVI_7VKILGL__rmxofwvw
//##**---------------- ./HGZIUOVVG/XKK/NZRM.XKK
/**********************************************
 * \EVIHRLM   9.9.8
 * \ZFGSLI    YUZM
 * \XIVZGVW   7982-95-88
 * \NLWRURVW  7982-95-88
 * \YIRVU:
 * xLMGZXG:
 * mLGV:
 **********************************************/



#RMXOFWV <RLHGIVZN>

#RMXOFWV "FYRJ_GLLO.S" // FHV FYRJGLLO
//#RMXOFWV "FYRJ_NZGS.S" // FHV FYRJNZGS
//#RMXOFWV "KFYVI.S"  // FHV KFYHFY KFYVI
//#RMXOFWV "HFYVI.S"  // FHV KFYHFY HFYVI
#RMXOFWV "zWEoLT.S" // FHV OLT
//#RMXOFWV "GLKRX.S"  // FHV KFYHFY WZGZ

#RMXOFWV "XKK/HGZIUOVVG_XORVMG.S"

RMG NZRM(RMG ZITX, XSZI** ZITE) {

    //-------------------------------- fhv FYRJFZMG olt ---------------------------
    // LKVM OLT HVIERXV
    FYRJOLT::oLT::RMHGZMXV()->LKVM("GVHGOLT.OLT", FYRJOLT::on_wvyft, UZOHV);
    // GSVM FHV OLT UIVVOB, HBMGZC RH ORPV KIRMGU

    hGZIUOVVGxORVMG WLXPVI("872.9.9.8", "49949");
    //! RU BLF DZMG GL FHV KFYHFY WZGZORMP, URIHG RMRGRZORAV HVIERXV
    // RMRGRZ Z KFYHFY HVIERXV
    //RU(kFYhFYhVIERXV::LKVM() == UZOHV) {
        //HGW::XVII << "kFYhFYhVIERXV::LKVM() UZROVW" << HGW::VMWO;
        //IVGFIM -8;
    //}

    ZFGL QLY = WLXPVI.MVD_QLY();
    ZFGL IVKOB = WLXPVI.HVMW(QLY);
    RU ( IVKOB.HGZGFH()  )
    {
        HGW::XLFG<<"hfxxvhh"<<HGW::VMWO;
        HGW::XLFG<<IVKOB.NVHHZTV()<<HGW::VMWO;
    }
    VOHV
    {
        HGW::XLFG<<"uzrovw"<<HGW::VMWO;
        HGW::XLFG<<IVKOB.NVHHZTV()<<HGW::VMWO;
    }
    IVGFIM 9;
}
//##**---------------- ./HGZIUOVVG/XKK/WLXPVI.TIKX.KY.XX
// tVMVIZGVW YB GSV Tikx x++ KOFTRM.
// rU BLF NZPV ZMB OLXZO XSZMTV, GSVB DROO YV OLHG.
// HLFIXV: WLXPVI.KILGL

#RMXOFWV "WLXPVI.KY.S"
#RMXOFWV "WLXPVI.TIKX.KY.S"

#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_HGIVZN.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_FMZIB_XZOO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/XSZMMVO_RMGVIUZXV.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/XORVMG_FMZIB_XZOO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/NVGSLW_SZMWOVI_RNKO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/IKX_HVIERXV_NVGSLW.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HVIERXV_GBKV.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HBMX_HGIVZN.S>
MZNVHKZXV hGZIUOVVGwLXPVI {

HGZGRX XLMHG XSZI* tIVVGVI_NVGSLW_MZNVH[] = {
  "/hGZIUOVVGwLXPVI.tIVVGVI/hVMWqLY",
};

HGW::FMRJFV_KGI< tIVVGVI::hGFY> tIVVGVI::mVDhGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO, XLMHG ::TIKX::hGFYlKGRLMH& LKGRLMH) {
  HGW::FMRJFV_KGI< tIVVGVI::hGFY> HGFY(MVD tIVVGVI::hGFY(XSZMMVO));
  IVGFIM HGFY;
}

tIVVGVI::hGFY::hGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO)
  : XSZMMVO_(XSZMMVO), IKXNVGSLW_hVMWqLY_(tIVVGVI_NVGSLW_MZNVH[9], ::TIKX::iKXnVGSLW::mlinzo_ikx, XSZMMVO)
  {}

::TIKX::hGZGFH tIVVGVI::hGFY::hVMWqLY(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV) {
  IVGFIM ::TIKX::yOLXPRMTfMZIBxZOO(XSZMMVO_.TVG(), IKXNVGSLW_hVMWqLY_, XLMGVCG, IVJFVHG, IVHKLMHV);
}

::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGwLXPVI::qLYiVKOB>* tIVVGVI::hGFY::zHBMXhVMWqLYiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
  IVGFIM ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGwLXPVI::qLYiVKOB>::xIVZGV(XSZMMVO_.TVG(), XJ, IKXNVGSLW_hVMWqLY_, XLMGVCG, IVJFVHG);
}

tIVVGVI::hVIERXV::hVIERXV() {
  zWWnVGSLW(MVD ::TIKX::iKXhVIERXVnVGSLW(
      tIVVGVI_NVGSLW_MZNVH[9],
      ::TIKX::iKXnVGSLW::mlinzo_ikx,
      MVD ::TIKX::iKXnVGSLWsZMWOVI< tIVVGVI::hVIERXV, ::hGZIUOVVGwLXPVI::qLYiVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB>(
          HGW::NVN_UM(&tIVVGVI::hVIERXV::hVMWqLY), GSRH)));
}

tIVVGVI::hVIERXV::~hVIERXV() {
}

::TIKX::hGZGFH tIVVGVI::hVIERXV::hVMWqLY(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGwLXPVI::qLYiVJFVHG* IVJFVHG, ::hGZIUOVVGwLXPVI::qLYiVKOB* IVHKLMHV) {
  (ELRW) XLMGVCG;
  (ELRW) IVJFVHG;
  (ELRW) IVHKLMHV;
  IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
}


}  // MZNVHKZXV hGZIUOVVGwLXPVI

//##**---------------- ./HGZIUOVVG/XKK/WLXPVI.KY.S
// tVMVIZGVW YB GSV KILGLXLO YFUUVI XLNKROVI.  wl mlg vwrg!
// HLFIXV: WLXPVI.KILGL

#RUMWVU kilglyfu_WLXPVI_7VKILGL__rmxofwvw
#WVURMV kilglyfu_WLXPVI_7VKILGL__rmxofwvw

#RMXOFWV <HGIRMT>

#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/XLNNLM.S>

#RU tlltov_kilglyfu_evihrlm < 6997999
#VIILI gSRH UROV DZH TVMVIZGVW YB Z MVDVI EVIHRLM LU KILGLX DSRXS RH
#VIILI RMXLNKZGRYOV DRGS BLFI kILGLXLO yFUUVI SVZWVIH.  kOVZHV FKWZGV
#VIILI BLFI SVZWVIH.
#VMWRU
#RU 6997999 < tlltov_kilglyfu_nrm_kilglx_evihrlm
#VIILI gSRH UROV DZH TVMVIZGVW YB ZM LOWVI EVIHRLM LU KILGLX DSRXS RH
#VIILI RMXLNKZGRYOV DRGS BLFI kILGLXLO yFUUVI SVZWVIH.  kOVZHV
#VIILI IVTVMVIZGV GSRH UROV DRGS Z MVDVI EVIHRLM LU KILGLX.
#VMWRU

#RMXOFWV <TLLTOV/KILGLYFU/RL/XLWVW_HGIVZN.S>
#RMXOFWV <TLLTOV/KILGLYFU/ZIVMZ.S>
#RMXOFWV <TLLTOV/KILGLYFU/ZIVMZHGIRMT.S>
#RMXOFWV <TLLTOV/KILGLYFU/TVMVIZGVW_NVHHZTV_FGRO.S>
#RMXOFWV <TLLTOV/KILGLYFU/NVGZWZGZ.S>
#RMXOFWV <TLLTOV/KILGLYFU/NVHHZTV.S>
#RMXOFWV <TLLTOV/KILGLYFU/IVKVZGVW_URVOW.S>  // rdbf KIZTNZ: VCKLIG
#RMXOFWV <TLLTOV/KILGLYFU/VCGVMHRLM_HVG.S>  // rdbf KIZTNZ: VCKLIG
#RMXOFWV <TLLTOV/KILGLYFU/FMPMLDM_URVOW_HVG.S>
// @@KILGLX_RMHVIGRLM_KLRMG(RMXOFWVH)
MZNVHKZXV hGZIUOVVGwLXPVI {
XOZHH qLYiVKOB;
XOZHH qLYiVKOBwVUZFOGgBKVrMGVIMZO;
VCGVIM qLYiVKOBwVUZFOGgBKVrMGVIMZO _qLYiVKOB_WVUZFOG_RMHGZMXV_;
XOZHH qLYiVJFVHG;
XOZHH qLYiVJFVHGwVUZFOGgBKVrMGVIMZO;
VCGVIM qLYiVJFVHGwVUZFOGgBKVrMGVIMZO _qLYiVJFVHG_WVUZFOG_RMHGZMXV_;
}  // MZNVHKZXV hGZIUOVVGwLXPVI

MZNVHKZXV hGZIUOVVGwLXPVI {

MZNVHKZXV KILGLYFU_WLXPVI_7VKILGL {
// rMGVIMZO RNKOVNVMGZGRLM WVGZRO -- WL MLG XZOO GSVHV.
HGIFXG gZYOVhGIFXG {
  HGZGRX XLMHG ::TLLTOV::KILGLYFU::FRMG67 LUUHVGH[];
  HGZGRX ELRW rMRGwVUZFOGHrNKO();
  HGZGRX ELRW hSFGWLDM();
};
ELRW zWWwVHXIRKGLIH();
ELRW rMRGwVUZFOGH();
}  // MZNVHKZXV KILGLYFU_WLXPVI_7VKILGL

// ===================================================================

XOZHH qLYiVJFVHG : KFYORX ::TLLTOV::KILGLYFU::nVHHZTV /* @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_WVURMRGRLM:hGZIUOVVGwLXPVI.qLYiVJFVHG) */ {
 KFYORX:
  qLYiVJFVHG();
  ERIGFZO ~qLYiVJFVHG();

  qLYiVJFVHG(XLMHG qLYiVJFVHG& UILN);

  RMORMV qLYiVJFVHG& LKVIZGLI=(XLMHG qLYiVJFVHG& UILN) {
    xLKBuILN(UILN);
    IVGFIM *GSRH;
  }

  HGZGRX XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* WVHXIRKGLI();
  HGZGRX XLMHG qLYiVJFVHG& WVUZFOG_RMHGZMXV();

  HGZGRX RMORMV XLMHG qLYiVJFVHG* RMGVIMZO_WVUZFOG_RMHGZMXV() {
    IVGFIM IVRMGVIKIVG_XZHG<XLMHG qLYiVJFVHG*>(
               &_qLYiVJFVHG_WVUZFOG_RMHGZMXV_);
  }

  ELRW hDZK(qLYiVJFVHG* LGSVI);

  // RNKOVNVMGH nVHHZTV ----------------------------------------------

  RMORMV qLYiVJFVHG* mVD() XLMHG kilglyfu_urmzo { IVGFIM mVD(mfoo); }

  qLYiVJFVHG* mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG qLYiVJFVHG& UILN);
  ELRW nVITVuILN(XLMHG qLYiVJFVHG& UILN);
  ELRW xOVZI() kilglyfu_urmzo;
  YLLO rHrMRGRZORAVW() XLMHG kilglyfu_urmzo;

  HRAV_G yBGVhRAVoLMT() XLMHG kilglyfu_urmzo;
  YLLO nVITVkZIGRZOuILNxLWVWhGIVZN(
      ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) kilglyfu_urmzo;
  ELRW hVIRZORAVdRGSxZXSVWhRAVH(
      ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
      YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* hVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(::TLLTOV::KILGLYFU::FRMG1* LFGKFG)
      XLMHG kilglyfu_urmzo {
    IVGFIM rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
        ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN::rHwVUZFOGhVIRZORAZGRLMwVGVINRMRHGRX(), LFGKFG);
  }
  RMG tVGxZXSVWhRAV() XLMHG kilglyfu_urmzo { IVGFIM _XZXSVW_HRAV_; }
  KIREZGV:
  ELRW hSZIVWxGLI();
  ELRW hSZIVWwGLI();
  ELRW hVGxZXSVWhRAV(RMG HRAV) XLMHG kilglyfu_urmzo;
  ELRW rMGVIMZOhDZK(qLYiVJFVHG* LGSVI);
  KIREZGV:
  RMORMV ::TLLTOV::KILGLYFU::zIVMZ* tVGzIVMZmLeRIGFZO() XLMHG {
    IVGFIM mfoo;
  }
  RMORMV ELRW* nZBYVzIVMZkGI() XLMHG {
    IVGFIM mfoo;
  }
  KFYORX:

  ::TLLTOV::KILGLYFU::nVGZWZGZ tVGnVGZWZGZ() XLMHG kilglyfu_urmzo;

  // MVHGVW GBKVH ----------------------------------------------------

  // ZXXVHHLIH -------------------------------------------------------

  // HGIRMT FHVI = 8;
  ELRW XOVZI_FHVI();
  HGZGRX XLMHG RMG PfHVIuRVOWmFNYVI = 8;
  XLMHG ::HGW::HGIRMT& FHVI() XLMHG;
  ELRW HVG_FHVI(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_FHVI(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_FHVI(XLMHG XSZI* EZOFV);
  ELRW HVG_FHVI(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_FHVI();
  ::HGW::HGIRMT* IVOVZHV_FHVI();
  ELRW HVG_ZOOLXZGVW_FHVI(::HGW::HGIRMT* FHVI);

  // HGIRMT GLPVM = 7;
  ELRW XOVZI_GLPVM();
  HGZGRX XLMHG RMG PgLPVMuRVOWmFNYVI = 7;
  XLMHG ::HGW::HGIRMT& GLPVM() XLMHG;
  ELRW HVG_GLPVM(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_GLPVM(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_GLPVM(XLMHG XSZI* EZOFV);
  ELRW HVG_GLPVM(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_GLPVM();
  ::HGW::HGIRMT* IVOVZHV_GLPVM();
  ELRW HVG_ZOOLXZGVW_GLPVM(::HGW::HGIRMT* GLPVM);

  // HGIRMT RWVMGRGB = 6;
  ELRW XOVZI_RWVMGRGB();
  HGZGRX XLMHG RMG PrWVMGRGBuRVOWmFNYVI = 6;
  XLMHG ::HGW::HGIRMT& RWVMGRGB() XLMHG;
  ELRW HVG_RWVMGRGB(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_RWVMGRGB(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_RWVMGRGB(XLMHG XSZI* EZOFV);
  ELRW HVG_RWVMGRGB(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_RWVMGRGB();
  ::HGW::HGIRMT* IVOVZHV_RWVMGRGB();
  ELRW HVG_ZOOLXZGVW_RWVMGRGB(::HGW::HGIRMT* RWVMGRGB);

  // HGIRMT XLNNZMW = 5;
  ELRW XOVZI_XLNNZMW();
  HGZGRX XLMHG RMG PxLNNZMWuRVOWmFNYVI = 5;
  XLMHG ::HGW::HGIRMT& XLNNZMW() XLMHG;
  ELRW HVG_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_XLNNZMW(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_XLNNZMW(XLMHG XSZI* EZOFV);
  ELRW HVG_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_XLNNZMW();
  ::HGW::HGIRMT* IVOVZHV_XLNNZMW();
  ELRW HVG_ZOOLXZGVW_XLNNZMW(::HGW::HGIRMT* XLNNZMW);

  // YBGVH QLY = 4;
  ELRW XOVZI_QLY();
  HGZGRX XLMHG RMG PqLYuRVOWmFNYVI = 4;
  XLMHG ::HGW::HGIRMT& QLY() XLMHG;
  ELRW HVG_QLY(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_QLY(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_QLY(XLMHG XSZI* EZOFV);
  ELRW HVG_QLY(XLMHG ELRW* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_QLY();
  ::HGW::HGIRMT* IVOVZHV_QLY();
  ELRW HVG_ZOOLXZGVW_QLY(::HGW::HGIRMT* QLY);

  // RMG67 GBKV = 3;
  ELRW XOVZI_GBKV();
  HGZGRX XLMHG RMG PgBKVuRVOWmFNYVI = 3;
  ::TLLTOV::KILGLYFU::RMG67 GBKV() XLMHG;
  ELRW HVG_GBKV(::TLLTOV::KILGLYFU::RMG67 EZOFV);

  // @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HXLKV:hGZIUOVVGwLXPVI.qLYiVJFVHG)
 KIREZGV:

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMGVIMZOnVGZWZGZdRGSzIVMZ _RMGVIMZO_NVGZWZGZ_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI FHVI_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI GLPVM_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI RWVMGRGB_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI XLNNZMW_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI QLY_;
  ::TLLTOV::KILGLYFU::RMG67 GBKV_;
  NFGZYOV RMG _XZXSVW_HRAV_;
  UIRVMW HGIFXG KILGLYFU_WLXPVI_7VKILGL::gZYOVhGIFXG;
};
// -------------------------------------------------------------------

XOZHH qLYiVKOB : KFYORX ::TLLTOV::KILGLYFU::nVHHZTV /* @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_WVURMRGRLM:hGZIUOVVGwLXPVI.qLYiVKOB) */ {
 KFYORX:
  qLYiVKOB();
  ERIGFZO ~qLYiVKOB();

  qLYiVKOB(XLMHG qLYiVKOB& UILN);

  RMORMV qLYiVKOB& LKVIZGLI=(XLMHG qLYiVKOB& UILN) {
    xLKBuILN(UILN);
    IVGFIM *GSRH;
  }

  HGZGRX XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* WVHXIRKGLI();
  HGZGRX XLMHG qLYiVKOB& WVUZFOG_RMHGZMXV();

  HGZGRX RMORMV XLMHG qLYiVKOB* RMGVIMZO_WVUZFOG_RMHGZMXV() {
    IVGFIM IVRMGVIKIVG_XZHG<XLMHG qLYiVKOB*>(
               &_qLYiVKOB_WVUZFOG_RMHGZMXV_);
  }

  ELRW hDZK(qLYiVKOB* LGSVI);

  // RNKOVNVMGH nVHHZTV ----------------------------------------------

  RMORMV qLYiVKOB* mVD() XLMHG kilglyfu_urmzo { IVGFIM mVD(mfoo); }

  qLYiVKOB* mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG qLYiVKOB& UILN);
  ELRW nVITVuILN(XLMHG qLYiVKOB& UILN);
  ELRW xOVZI() kilglyfu_urmzo;
  YLLO rHrMRGRZORAVW() XLMHG kilglyfu_urmzo;

  HRAV_G yBGVhRAVoLMT() XLMHG kilglyfu_urmzo;
  YLLO nVITVkZIGRZOuILNxLWVWhGIVZN(
      ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) kilglyfu_urmzo;
  ELRW hVIRZORAVdRGSxZXSVWhRAVH(
      ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
      YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* hVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(::TLLTOV::KILGLYFU::FRMG1* LFGKFG)
      XLMHG kilglyfu_urmzo {
    IVGFIM rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
        ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN::rHwVUZFOGhVIRZORAZGRLMwVGVINRMRHGRX(), LFGKFG);
  }
  RMG tVGxZXSVWhRAV() XLMHG kilglyfu_urmzo { IVGFIM _XZXSVW_HRAV_; }
  KIREZGV:
  ELRW hSZIVWxGLI();
  ELRW hSZIVWwGLI();
  ELRW hVGxZXSVWhRAV(RMG HRAV) XLMHG kilglyfu_urmzo;
  ELRW rMGVIMZOhDZK(qLYiVKOB* LGSVI);
  KIREZGV:
  RMORMV ::TLLTOV::KILGLYFU::zIVMZ* tVGzIVMZmLeRIGFZO() XLMHG {
    IVGFIM mfoo;
  }
  RMORMV ELRW* nZBYVzIVMZkGI() XLMHG {
    IVGFIM mfoo;
  }
  KFYORX:

  ::TLLTOV::KILGLYFU::nVGZWZGZ tVGnVGZWZGZ() XLMHG kilglyfu_urmzo;

  // MVHGVW GBKVH ----------------------------------------------------

  // ZXXVHHLIH -------------------------------------------------------

  // HGIRMT NVHHZTV = 7;
  ELRW XOVZI_NVHHZTV();
  HGZGRX XLMHG RMG PnVHHZTVuRVOWmFNYVI = 7;
  XLMHG ::HGW::HGIRMT& NVHHZTV() XLMHG;
  ELRW HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_NVHHZTV(XLMHG XSZI* EZOFV);
  ELRW HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_NVHHZTV();
  ::HGW::HGIRMT* IVOVZHV_NVHHZTV();
  ELRW HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV);

  // YBGVH WZGZ = 6;
  ELRW XOVZI_WZGZ();
  HGZGRX XLMHG RMG PwZGZuRVOWmFNYVI = 6;
  XLMHG ::HGW::HGIRMT& WZGZ() XLMHG;
  ELRW HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_WZGZ(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_WZGZ(XLMHG XSZI* EZOFV);
  ELRW HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_WZGZ();
  ::HGW::HGIRMT* IVOVZHV_WZGZ();
  ELRW HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ);

  // YLLO HGZGFH = 8;
  ELRW XOVZI_HGZGFH();
  HGZGRX XLMHG RMG PhGZGFHuRVOWmFNYVI = 8;
  YLLO HGZGFH() XLMHG;
  ELRW HVG_HGZGFH(YLLO EZOFV);

  // @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HXLKV:hGZIUOVVGwLXPVI.qLYiVKOB)
 KIREZGV:

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMGVIMZOnVGZWZGZdRGSzIVMZ _RMGVIMZO_NVGZWZGZ_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI NVHHZTV_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI WZGZ_;
  YLLO HGZGFH_;
  NFGZYOV RMG _XZXSVW_HRAV_;
  UIRVMW HGIFXG KILGLYFU_WLXPVI_7VKILGL::gZYOVhGIFXG;
};
// ===================================================================


// ===================================================================

#RU !kilglyfu_rmormv_mlg_rm_svzwvih
// qLYiVJFVHG

// HGIRMT FHVI = 8;
RMORMV ELRW qLYiVJFVHG::XOVZI_FHVI() {
  FHVI_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& qLYiVJFVHG::FHVI() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
  IVGFIM FHVI_.tVGmLzIVMZ();
}
RMORMV ELRW qLYiVJFVHG::HVG_FHVI(XLMHG ::HGW::HGIRMT& EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
#RU ozmt_xcc88
RMORMV ELRW qLYiVJFVHG::HVG_FHVI(::HGW::HGIRMT&& EZOFV) {

  FHVI_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
#VMWRU
RMORMV ELRW qLYiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
RMORMV ELRW qLYiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_FHVI() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
  IVGFIM FHVI_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_FHVI() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)

  IVGFIM FHVI_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_FHVI(::HGW::HGIRMT* FHVI) {
  RU (FHVI != mfoo) {

  } VOHV {

  }
  FHVI_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), FHVI);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.FHVI)
}

// HGIRMT GLPVM = 7;
RMORMV ELRW qLYiVJFVHG::XOVZI_GLPVM() {
  GLPVM_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& qLYiVJFVHG::GLPVM() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
  IVGFIM GLPVM_.tVGmLzIVMZ();
}
RMORMV ELRW qLYiVJFVHG::HVG_GLPVM(XLMHG ::HGW::HGIRMT& EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
#RU ozmt_xcc88
RMORMV ELRW qLYiVJFVHG::HVG_GLPVM(::HGW::HGIRMT&& EZOFV) {

  GLPVM_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
#VMWRU
RMORMV ELRW qLYiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
RMORMV ELRW qLYiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_GLPVM() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
  IVGFIM GLPVM_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_GLPVM() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)

  IVGFIM GLPVM_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_GLPVM(::HGW::HGIRMT* GLPVM) {
  RU (GLPVM != mfoo) {

  } VOHV {

  }
  GLPVM_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), GLPVM);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.GLPVM)
}

// HGIRMT RWVMGRGB = 6;
RMORMV ELRW qLYiVJFVHG::XOVZI_RWVMGRGB() {
  RWVMGRGB_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& qLYiVJFVHG::RWVMGRGB() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
  IVGFIM RWVMGRGB_.tVGmLzIVMZ();
}
RMORMV ELRW qLYiVJFVHG::HVG_RWVMGRGB(XLMHG ::HGW::HGIRMT& EZOFV) {

  RWVMGRGB_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
#RU ozmt_xcc88
RMORMV ELRW qLYiVJFVHG::HVG_RWVMGRGB(::HGW::HGIRMT&& EZOFV) {

  RWVMGRGB_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
#VMWRU
RMORMV ELRW qLYiVJFVHG::HVG_RWVMGRGB(XLMHG XSZI* EZOFV) {

  RWVMGRGB_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
RMORMV ELRW qLYiVJFVHG::HVG_RWVMGRGB(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  RWVMGRGB_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_RWVMGRGB() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
  IVGFIM RWVMGRGB_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_RWVMGRGB() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)

  IVGFIM RWVMGRGB_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_RWVMGRGB(::HGW::HGIRMT* RWVMGRGB) {
  RU (RWVMGRGB != mfoo) {

  } VOHV {

  }
  RWVMGRGB_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), RWVMGRGB);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.RWVMGRGB)
}

// HGIRMT XLNNZMW = 5;
RMORMV ELRW qLYiVJFVHG::XOVZI_XLNNZMW() {
  XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& qLYiVJFVHG::XLNNZMW() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.tVGmLzIVMZ();
}
RMORMV ELRW qLYiVJFVHG::HVG_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
#RU ozmt_xcc88
RMORMV ELRW qLYiVJFVHG::HVG_XLNNZMW(::HGW::HGIRMT&& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
#VMWRU
RMORMV ELRW qLYiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
RMORMV ELRW qLYiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_XLNNZMW() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_XLNNZMW() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)

  IVGFIM XLNNZMW_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_XLNNZMW(::HGW::HGIRMT* XLNNZMW) {
  RU (XLNNZMW != mfoo) {

  } VOHV {

  }
  XLNNZMW_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), XLNNZMW);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.XLNNZMW)
}

// YBGVH QLY = 4;
RMORMV ELRW qLYiVJFVHG::XOVZI_QLY() {
  QLY_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& qLYiVJFVHG::QLY() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
  IVGFIM QLY_.tVGmLzIVMZ();
}
RMORMV ELRW qLYiVJFVHG::HVG_QLY(XLMHG ::HGW::HGIRMT& EZOFV) {

  QLY_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
#RU ozmt_xcc88
RMORMV ELRW qLYiVJFVHG::HVG_QLY(::HGW::HGIRMT&& EZOFV) {

  QLY_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
#VMWRU
RMORMV ELRW qLYiVJFVHG::HVG_QLY(XLMHG XSZI* EZOFV) {

  QLY_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
RMORMV ELRW qLYiVJFVHG::HVG_QLY(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  QLY_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::NFGZYOV_QLY() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
  IVGFIM QLY_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* qLYiVJFVHG::IVOVZHV_QLY() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)

  IVGFIM QLY_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW qLYiVJFVHG::HVG_ZOOLXZGVW_QLY(::HGW::HGIRMT* QLY) {
  RU (QLY != mfoo) {

  } VOHV {

  }
  QLY_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), QLY);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVJFVHG.QLY)
}

// RMG67 GBKV = 3;
RMORMV ELRW qLYiVJFVHG::XOVZI_GBKV() {
  GBKV_ = 9;
}
RMORMV ::TLLTOV::KILGLYFU::RMG67 qLYiVJFVHG::GBKV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GBKV)
  IVGFIM GBKV_;
}
RMORMV ELRW qLYiVJFVHG::HVG_GBKV(::TLLTOV::KILGLYFU::RMG67 EZOFV) {

  GBKV_ = EZOFV;
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVJFVHG.GBKV)
}

// -------------------------------------------------------------------

// qLYiVKOB

// YLLO HGZGFH = 8;
RMORMV ELRW qLYiVKOB::XOVZI_HGZGFH() {
  HGZGFH_ = UZOHV;
}
RMORMV YLLO qLYiVKOB::HGZGFH() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVKOB.HGZGFH)
  IVGFIM HGZGFH_;
}
RMORMV ELRW qLYiVKOB::HVG_HGZGFH(YLLO EZOFV) {

  HGZGFH_ = EZOFV;
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVKOB.HGZGFH)
}

// HGIRMT NVHHZTV = 7;
RMORMV ELRW qLYiVKOB::XOVZI_NVHHZTV() {
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& qLYiVKOB::NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.tVGmLzIVMZ();
}
RMORMV ELRW qLYiVKOB::HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
#RU ozmt_xcc88
RMORMV ELRW qLYiVKOB::HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
#VMWRU
RMORMV ELRW qLYiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
RMORMV ELRW qLYiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}
RMORMV ::HGW::HGIRMT* qLYiVKOB::NFGZYOV_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* qLYiVKOB::IVOVZHV_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)

  IVGFIM NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW qLYiVKOB::HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV) {
  RU (NVHHZTV != mfoo) {

  } VOHV {

  }
  NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVKOB.NVHHZTV)
}

// YBGVH WZGZ = 6;
RMORMV ELRW qLYiVKOB::XOVZI_WZGZ() {
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& qLYiVKOB::WZGZ() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
  IVGFIM WZGZ_.tVGmLzIVMZ();
}
RMORMV ELRW qLYiVKOB::HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
#RU ozmt_xcc88
RMORMV ELRW qLYiVKOB::HVG_WZGZ(::HGW::HGIRMT&& EZOFV) {

  WZGZ_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
#VMWRU
RMORMV ELRW qLYiVKOB::HVG_WZGZ(XLMHG XSZI* EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
RMORMV ELRW qLYiVKOB::HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}
RMORMV ::HGW::HGIRMT* qLYiVKOB::NFGZYOV_WZGZ() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
  IVGFIM WZGZ_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* qLYiVKOB::IVOVZHV_WZGZ() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)

  IVGFIM WZGZ_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW qLYiVKOB::HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ) {
  RU (WZGZ != mfoo) {

  } VOHV {

  }
  WZGZ_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), WZGZ);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGwLXPVI.qLYiVKOB.WZGZ)
}

#VMWRU  // !kilglyfu_rmormv_mlg_rm_svzwvih
// -------------------------------------------------------------------


// @@KILGLX_RMHVIGRLM_KLRMG(MZNVHKZXV_HXLKV)


}  // MZNVHKZXV hGZIUOVVGwLXPVI

// @@KILGLX_RMHVIGRLM_KLRMG(TOLYZO_HXLKV)

#VMWRU  // kilglyfu_WLXPVI_7VKILGL__rmxofwvw
//##**---------------- ./HGZIUOVVG/XKK/XLNNZMW.TIKX.KY.XX
// tVMVIZGVW YB GSV Tikx x++ KOFTRM.
// rU BLF NZPV ZMB OLXZO XSZMTV, GSVB DROO YV OLHG.
// HLFIXV: XLNNZMW.KILGL

#RMXOFWV "XLNNZMW.KY.S"
#RMXOFWV "XLNNZMW.TIKX.KY.S"

#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_HGIVZN.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/ZHBMX_FMZIB_XZOO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/XSZMMVO_RMGVIUZXV.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/XORVMG_FMZIB_XZOO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/NVGSLW_SZMWOVI_RNKO.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/IKX_HVIERXV_NVGSLW.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HVIERXV_GBKV.S>
#RMXOFWV <TIKX++/RNKO/XLWVTVM/HBMX_HGIVZN.S>
MZNVHKZXV hGZIUOVVGxLNNZMW {

HGZGRX XLMHG XSZI* tIVVGVI_NVGSLW_MZNVH[] = {
  "/hGZIUOVVGxLNNZMW.tIVVGVI/hZBsVOOL",
  "/hGZIUOVVGxLNNZMW.tIVVGVI/rHHFVxLNNZMW",
};

HGW::FMRJFV_KGI< tIVVGVI::hGFY> tIVVGVI::mVDhGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO, XLMHG ::TIKX::hGFYlKGRLMH& LKGRLMH) {
  HGW::FMRJFV_KGI< tIVVGVI::hGFY> HGFY(MVD tIVVGVI::hGFY(XSZMMVO));
  IVGFIM HGFY;
}

tIVVGVI::hGFY::hGFY(XLMHG HGW::HSZIVW_KGI< ::TIKX::xSZMMVOrMGVIUZXV>& XSZMMVO)
  : XSZMMVO_(XSZMMVO), IKXNVGSLW_hZBsVOOL_(tIVVGVI_NVGSLW_MZNVH[9], ::TIKX::iKXnVGSLW::mlinzo_ikx, XSZMMVO)
  , IKXNVGSLW_rHHFVxLNNZMW_(tIVVGVI_NVGSLW_MZNVH[8], ::TIKX::iKXnVGSLW::mlinzo_ikx, XSZMMVO)
  {}

::TIKX::hGZGFH tIVVGVI::hGFY::hZBsVOOL(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV) {
  IVGFIM ::TIKX::yOLXPRMTfMZIBxZOO(XSZMMVO_.TVG(), IKXNVGSLW_hZBsVOOL_, XLMGVCG, IVJFVHG, IVHKLMHV);
}

::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>* tIVVGVI::hGFY::zHBMXhZBsVOOLiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
  IVGFIM ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>::xIVZGV(XSZMMVO_.TVG(), XJ, IKXNVGSLW_hZBsVOOL_, XLMGVCG, IVJFVHG);
}

::TIKX::hGZGFH tIVVGVI::hGFY::rHHFVxLNNZMW(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV) {
  IVGFIM ::TIKX::yOLXPRMTfMZIBxZOO(XSZMMVO_.TVG(), IKXNVGSLW_rHHFVxLNNZMW_, XLMGVCG, IVJFVHG, IVHKLMHV);
}

::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>* tIVVGVI::hGFY::zHBMXrHHFVxLNNZMWiZD(::TIKX::xORVMGxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG& IVJFVHG, ::TIKX::xLNKOVGRLMjFVFV* XJ) {
  IVGFIM ::TIKX::xORVMGzHBMXiVHKLMHViVZWVI< ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>::xIVZGV(XSZMMVO_.TVG(), XJ, IKXNVGSLW_rHHFVxLNNZMW_, XLMGVCG, IVJFVHG);
}

tIVVGVI::hVIERXV::hVIERXV() {
  zWWnVGSLW(MVD ::TIKX::iKXhVIERXVnVGSLW(
      tIVVGVI_NVGSLW_MZNVH[9],
      ::TIKX::iKXnVGSLW::mlinzo_ikx,
      MVD ::TIKX::iKXnVGSLWsZMWOVI< tIVVGVI::hVIERXV, ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB>(
          HGW::NVN_UM(&tIVVGVI::hVIERXV::hZBsVOOL), GSRH)));
  zWWnVGSLW(MVD ::TIKX::iKXhVIERXVnVGSLW(
      tIVVGVI_NVGSLW_MZNVH[8],
      ::TIKX::iKXnVGSLW::mlinzo_ikx,
      MVD ::TIKX::iKXnVGSLWsZMWOVI< tIVVGVI::hVIERXV, ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB>(
          HGW::NVN_UM(&tIVVGVI::hVIERXV::rHHFVxLNNZMW), GSRH)));
}

tIVVGVI::hVIERXV::~hVIERXV() {
}

::TIKX::hGZGFH tIVVGVI::hVIERXV::hZBsVOOL(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::sVOOLiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::sVOOLiVKOB* IVHKLMHV) {
  (ELRW) XLMGVCG;
  (ELRW) IVJFVHG;
  (ELRW) IVHKLMHV;
  IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
}

::TIKX::hGZGFH tIVVGVI::hVIERXV::rHHFVxLNNZMW(::TIKX::hVIEVIxLMGVCG* XLMGVCG, XLMHG ::hGZIUOVVGxLNNZMW::xLNNZMWiVJFVHG* IVJFVHG, ::hGZIUOVVGxLNNZMW::xLNNZMWiVKOB* IVHKLMHV) {
  (ELRW) XLMGVCG;
  (ELRW) IVJFVHG;
  (ELRW) IVHKLMHV;
  IVGFIM ::TIKX::hGZGFH(::TIKX::hGZGFHxLWV::fmrnkovnvmgvw, "");
}


}  // MZNVHKZXV hGZIUOVVGxLNNZMW

//##**---------------- ./HGZIUOVVG/XKK/XLNNZMW.KY.S
// tVMVIZGVW YB GSV KILGLXLO YFUUVI XLNKROVI.  wl mlg vwrg!
// HLFIXV: XLNNZMW.KILGL

#RUMWVU kilglyfu_XLNNZMW_7VKILGL__rmxofwvw
#WVURMV kilglyfu_XLNNZMW_7VKILGL__rmxofwvw

#RMXOFWV <HGIRMT>

#RMXOFWV <TLLTOV/KILGLYFU/HGFYH/XLNNLM.S>

#RU tlltov_kilglyfu_evihrlm < 6997999
#VIILI gSRH UROV DZH TVMVIZGVW YB Z MVDVI EVIHRLM LU KILGLX DSRXS RH
#VIILI RMXLNKZGRYOV DRGS BLFI kILGLXLO yFUUVI SVZWVIH.  kOVZHV FKWZGV
#VIILI BLFI SVZWVIH.
#VMWRU
#RU 6997999 < tlltov_kilglyfu_nrm_kilglx_evihrlm
#VIILI gSRH UROV DZH TVMVIZGVW YB ZM LOWVI EVIHRLM LU KILGLX DSRXS RH
#VIILI RMXLNKZGRYOV DRGS BLFI kILGLXLO yFUUVI SVZWVIH.  kOVZHV
#VIILI IVTVMVIZGV GSRH UROV DRGS Z MVDVI EVIHRLM LU KILGLX.
#VMWRU

#RMXOFWV <TLLTOV/KILGLYFU/RL/XLWVW_HGIVZN.S>
#RMXOFWV <TLLTOV/KILGLYFU/ZIVMZ.S>
#RMXOFWV <TLLTOV/KILGLYFU/ZIVMZHGIRMT.S>
#RMXOFWV <TLLTOV/KILGLYFU/TVMVIZGVW_NVHHZTV_FGRO.S>
#RMXOFWV <TLLTOV/KILGLYFU/NVGZWZGZ.S>
#RMXOFWV <TLLTOV/KILGLYFU/NVHHZTV.S>
#RMXOFWV <TLLTOV/KILGLYFU/IVKVZGVW_URVOW.S>  // rdbf KIZTNZ: VCKLIG
#RMXOFWV <TLLTOV/KILGLYFU/VCGVMHRLM_HVG.S>  // rdbf KIZTNZ: VCKLIG
#RMXOFWV <TLLTOV/KILGLYFU/FMPMLDM_URVOW_HVG.S>
// @@KILGLX_RMHVIGRLM_KLRMG(RMXOFWVH)
MZNVHKZXV hGZIUOVVGxLNNZMW {
XOZHH xLNNZMWiVKOB;
XOZHH xLNNZMWiVKOBwVUZFOGgBKVrMGVIMZO;
VCGVIM xLNNZMWiVKOBwVUZFOGgBKVrMGVIMZO _xLNNZMWiVKOB_WVUZFOG_RMHGZMXV_;
XOZHH xLNNZMWiVJFVHG;
XOZHH xLNNZMWiVJFVHGwVUZFOGgBKVrMGVIMZO;
VCGVIM xLNNZMWiVJFVHGwVUZFOGgBKVrMGVIMZO _xLNNZMWiVJFVHG_WVUZFOG_RMHGZMXV_;
XOZHH sVOOLiVKOB;
XOZHH sVOOLiVKOBwVUZFOGgBKVrMGVIMZO;
VCGVIM sVOOLiVKOBwVUZFOGgBKVrMGVIMZO _sVOOLiVKOB_WVUZFOG_RMHGZMXV_;
XOZHH sVOOLiVJFVHG;
XOZHH sVOOLiVJFVHGwVUZFOGgBKVrMGVIMZO;
VCGVIM sVOOLiVJFVHGwVUZFOGgBKVrMGVIMZO _sVOOLiVJFVHG_WVUZFOG_RMHGZMXV_;
}  // MZNVHKZXV hGZIUOVVGxLNNZMW

MZNVHKZXV hGZIUOVVGxLNNZMW {

MZNVHKZXV KILGLYFU_XLNNZMW_7VKILGL {
// rMGVIMZO RNKOVNVMGZGRLM WVGZRO -- WL MLG XZOO GSVHV.
HGIFXG gZYOVhGIFXG {
  HGZGRX XLMHG ::TLLTOV::KILGLYFU::FRMG67 LUUHVGH[];
  HGZGRX ELRW rMRGwVUZFOGHrNKO();
  HGZGRX ELRW hSFGWLDM();
};
ELRW zWWwVHXIRKGLIH();
ELRW rMRGwVUZFOGH();
}  // MZNVHKZXV KILGLYFU_XLNNZMW_7VKILGL

// ===================================================================

XOZHH sVOOLiVJFVHG : KFYORX ::TLLTOV::KILGLYFU::nVHHZTV /* @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_WVURMRGRLM:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG) */ {
 KFYORX:
  sVOOLiVJFVHG();
  ERIGFZO ~sVOOLiVJFVHG();

  sVOOLiVJFVHG(XLMHG sVOOLiVJFVHG& UILN);

  RMORMV sVOOLiVJFVHG& LKVIZGLI=(XLMHG sVOOLiVJFVHG& UILN) {
    xLKBuILN(UILN);
    IVGFIM *GSRH;
  }

  HGZGRX XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* WVHXIRKGLI();
  HGZGRX XLMHG sVOOLiVJFVHG& WVUZFOG_RMHGZMXV();

  HGZGRX RMORMV XLMHG sVOOLiVJFVHG* RMGVIMZO_WVUZFOG_RMHGZMXV() {
    IVGFIM IVRMGVIKIVG_XZHG<XLMHG sVOOLiVJFVHG*>(
               &_sVOOLiVJFVHG_WVUZFOG_RMHGZMXV_);
  }

  ELRW hDZK(sVOOLiVJFVHG* LGSVI);

  // RNKOVNVMGH nVHHZTV ----------------------------------------------

  RMORMV sVOOLiVJFVHG* mVD() XLMHG kilglyfu_urmzo { IVGFIM mVD(mfoo); }

  sVOOLiVJFVHG* mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG sVOOLiVJFVHG& UILN);
  ELRW nVITVuILN(XLMHG sVOOLiVJFVHG& UILN);
  ELRW xOVZI() kilglyfu_urmzo;
  YLLO rHrMRGRZORAVW() XLMHG kilglyfu_urmzo;

  HRAV_G yBGVhRAVoLMT() XLMHG kilglyfu_urmzo;
  YLLO nVITVkZIGRZOuILNxLWVWhGIVZN(
      ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) kilglyfu_urmzo;
  ELRW hVIRZORAVdRGSxZXSVWhRAVH(
      ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
      YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* hVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(::TLLTOV::KILGLYFU::FRMG1* LFGKFG)
      XLMHG kilglyfu_urmzo {
    IVGFIM rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
        ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN::rHwVUZFOGhVIRZORAZGRLMwVGVINRMRHGRX(), LFGKFG);
  }
  RMG tVGxZXSVWhRAV() XLMHG kilglyfu_urmzo { IVGFIM _XZXSVW_HRAV_; }
  KIREZGV:
  ELRW hSZIVWxGLI();
  ELRW hSZIVWwGLI();
  ELRW hVGxZXSVWhRAV(RMG HRAV) XLMHG kilglyfu_urmzo;
  ELRW rMGVIMZOhDZK(sVOOLiVJFVHG* LGSVI);
  KIREZGV:
  RMORMV ::TLLTOV::KILGLYFU::zIVMZ* tVGzIVMZmLeRIGFZO() XLMHG {
    IVGFIM mfoo;
  }
  RMORMV ELRW* nZBYVzIVMZkGI() XLMHG {
    IVGFIM mfoo;
  }
  KFYORX:

  ::TLLTOV::KILGLYFU::nVGZWZGZ tVGnVGZWZGZ() XLMHG kilglyfu_urmzo;

  // MVHGVW GBKVH ----------------------------------------------------

  // ZXXVHHLIH -------------------------------------------------------

  // HGIRMT MZNV = 8;
  ELRW XOVZI_MZNV();
  HGZGRX XLMHG RMG PmZNVuRVOWmFNYVI = 8;
  XLMHG ::HGW::HGIRMT& MZNV() XLMHG;
  ELRW HVG_MZNV(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_MZNV(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_MZNV(XLMHG XSZI* EZOFV);
  ELRW HVG_MZNV(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_MZNV();
  ::HGW::HGIRMT* IVOVZHV_MZNV();
  ELRW HVG_ZOOLXZGVW_MZNV(::HGW::HGIRMT* MZNV);

  // @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HXLKV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG)
 KIREZGV:

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMGVIMZOnVGZWZGZdRGSzIVMZ _RMGVIMZO_NVGZWZGZ_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI MZNV_;
  NFGZYOV RMG _XZXSVW_HRAV_;
  UIRVMW HGIFXG KILGLYFU_XLNNZMW_7VKILGL::gZYOVhGIFXG;
};
// -------------------------------------------------------------------

XOZHH sVOOLiVKOB : KFYORX ::TLLTOV::KILGLYFU::nVHHZTV /* @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_WVURMRGRLM:hGZIUOVVGxLNNZMW.sVOOLiVKOB) */ {
 KFYORX:
  sVOOLiVKOB();
  ERIGFZO ~sVOOLiVKOB();

  sVOOLiVKOB(XLMHG sVOOLiVKOB& UILN);

  RMORMV sVOOLiVKOB& LKVIZGLI=(XLMHG sVOOLiVKOB& UILN) {
    xLKBuILN(UILN);
    IVGFIM *GSRH;
  }

  HGZGRX XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* WVHXIRKGLI();
  HGZGRX XLMHG sVOOLiVKOB& WVUZFOG_RMHGZMXV();

  HGZGRX RMORMV XLMHG sVOOLiVKOB* RMGVIMZO_WVUZFOG_RMHGZMXV() {
    IVGFIM IVRMGVIKIVG_XZHG<XLMHG sVOOLiVKOB*>(
               &_sVOOLiVKOB_WVUZFOG_RMHGZMXV_);
  }

  ELRW hDZK(sVOOLiVKOB* LGSVI);

  // RNKOVNVMGH nVHHZTV ----------------------------------------------

  RMORMV sVOOLiVKOB* mVD() XLMHG kilglyfu_urmzo { IVGFIM mVD(mfoo); }

  sVOOLiVKOB* mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG sVOOLiVKOB& UILN);
  ELRW nVITVuILN(XLMHG sVOOLiVKOB& UILN);
  ELRW xOVZI() kilglyfu_urmzo;
  YLLO rHrMRGRZORAVW() XLMHG kilglyfu_urmzo;

  HRAV_G yBGVhRAVoLMT() XLMHG kilglyfu_urmzo;
  YLLO nVITVkZIGRZOuILNxLWVWhGIVZN(
      ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) kilglyfu_urmzo;
  ELRW hVIRZORAVdRGSxZXSVWhRAVH(
      ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
      YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* hVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(::TLLTOV::KILGLYFU::FRMG1* LFGKFG)
      XLMHG kilglyfu_urmzo {
    IVGFIM rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
        ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN::rHwVUZFOGhVIRZORAZGRLMwVGVINRMRHGRX(), LFGKFG);
  }
  RMG tVGxZXSVWhRAV() XLMHG kilglyfu_urmzo { IVGFIM _XZXSVW_HRAV_; }
  KIREZGV:
  ELRW hSZIVWxGLI();
  ELRW hSZIVWwGLI();
  ELRW hVGxZXSVWhRAV(RMG HRAV) XLMHG kilglyfu_urmzo;
  ELRW rMGVIMZOhDZK(sVOOLiVKOB* LGSVI);
  KIREZGV:
  RMORMV ::TLLTOV::KILGLYFU::zIVMZ* tVGzIVMZmLeRIGFZO() XLMHG {
    IVGFIM mfoo;
  }
  RMORMV ELRW* nZBYVzIVMZkGI() XLMHG {
    IVGFIM mfoo;
  }
  KFYORX:

  ::TLLTOV::KILGLYFU::nVGZWZGZ tVGnVGZWZGZ() XLMHG kilglyfu_urmzo;

  // MVHGVW GBKVH ----------------------------------------------------

  // ZXXVHHLIH -------------------------------------------------------

  // HGIRMT NVHHZTV = 8;
  ELRW XOVZI_NVHHZTV();
  HGZGRX XLMHG RMG PnVHHZTVuRVOWmFNYVI = 8;
  XLMHG ::HGW::HGIRMT& NVHHZTV() XLMHG;
  ELRW HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_NVHHZTV(XLMHG XSZI* EZOFV);
  ELRW HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_NVHHZTV();
  ::HGW::HGIRMT* IVOVZHV_NVHHZTV();
  ELRW HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV);

  // @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HXLKV:hGZIUOVVGxLNNZMW.sVOOLiVKOB)
 KIREZGV:

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMGVIMZOnVGZWZGZdRGSzIVMZ _RMGVIMZO_NVGZWZGZ_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI NVHHZTV_;
  NFGZYOV RMG _XZXSVW_HRAV_;
  UIRVMW HGIFXG KILGLYFU_XLNNZMW_7VKILGL::gZYOVhGIFXG;
};
// -------------------------------------------------------------------

XOZHH xLNNZMWiVJFVHG : KFYORX ::TLLTOV::KILGLYFU::nVHHZTV /* @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_WVURMRGRLM:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG) */ {
 KFYORX:
  xLNNZMWiVJFVHG();
  ERIGFZO ~xLNNZMWiVJFVHG();

  xLNNZMWiVJFVHG(XLMHG xLNNZMWiVJFVHG& UILN);

  RMORMV xLNNZMWiVJFVHG& LKVIZGLI=(XLMHG xLNNZMWiVJFVHG& UILN) {
    xLKBuILN(UILN);
    IVGFIM *GSRH;
  }

  HGZGRX XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* WVHXIRKGLI();
  HGZGRX XLMHG xLNNZMWiVJFVHG& WVUZFOG_RMHGZMXV();

  HGZGRX RMORMV XLMHG xLNNZMWiVJFVHG* RMGVIMZO_WVUZFOG_RMHGZMXV() {
    IVGFIM IVRMGVIKIVG_XZHG<XLMHG xLNNZMWiVJFVHG*>(
               &_xLNNZMWiVJFVHG_WVUZFOG_RMHGZMXV_);
  }

  ELRW hDZK(xLNNZMWiVJFVHG* LGSVI);

  // RNKOVNVMGH nVHHZTV ----------------------------------------------

  RMORMV xLNNZMWiVJFVHG* mVD() XLMHG kilglyfu_urmzo { IVGFIM mVD(mfoo); }

  xLNNZMWiVJFVHG* mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG xLNNZMWiVJFVHG& UILN);
  ELRW nVITVuILN(XLMHG xLNNZMWiVJFVHG& UILN);
  ELRW xOVZI() kilglyfu_urmzo;
  YLLO rHrMRGRZORAVW() XLMHG kilglyfu_urmzo;

  HRAV_G yBGVhRAVoLMT() XLMHG kilglyfu_urmzo;
  YLLO nVITVkZIGRZOuILNxLWVWhGIVZN(
      ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) kilglyfu_urmzo;
  ELRW hVIRZORAVdRGSxZXSVWhRAVH(
      ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
      YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* hVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(::TLLTOV::KILGLYFU::FRMG1* LFGKFG)
      XLMHG kilglyfu_urmzo {
    IVGFIM rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
        ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN::rHwVUZFOGhVIRZORAZGRLMwVGVINRMRHGRX(), LFGKFG);
  }
  RMG tVGxZXSVWhRAV() XLMHG kilglyfu_urmzo { IVGFIM _XZXSVW_HRAV_; }
  KIREZGV:
  ELRW hSZIVWxGLI();
  ELRW hSZIVWwGLI();
  ELRW hVGxZXSVWhRAV(RMG HRAV) XLMHG kilglyfu_urmzo;
  ELRW rMGVIMZOhDZK(xLNNZMWiVJFVHG* LGSVI);
  KIREZGV:
  RMORMV ::TLLTOV::KILGLYFU::zIVMZ* tVGzIVMZmLeRIGFZO() XLMHG {
    IVGFIM mfoo;
  }
  RMORMV ELRW* nZBYVzIVMZkGI() XLMHG {
    IVGFIM mfoo;
  }
  KFYORX:

  ::TLLTOV::KILGLYFU::nVGZWZGZ tVGnVGZWZGZ() XLMHG kilglyfu_urmzo;

  // MVHGVW GBKVH ----------------------------------------------------

  // ZXXVHHLIH -------------------------------------------------------

  // HGIRMT FHVI = 8;
  ELRW XOVZI_FHVI();
  HGZGRX XLMHG RMG PfHVIuRVOWmFNYVI = 8;
  XLMHG ::HGW::HGIRMT& FHVI() XLMHG;
  ELRW HVG_FHVI(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_FHVI(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_FHVI(XLMHG XSZI* EZOFV);
  ELRW HVG_FHVI(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_FHVI();
  ::HGW::HGIRMT* IVOVZHV_FHVI();
  ELRW HVG_ZOOLXZGVW_FHVI(::HGW::HGIRMT* FHVI);

  // HGIRMT GLPVM = 7;
  ELRW XOVZI_GLPVM();
  HGZGRX XLMHG RMG PgLPVMuRVOWmFNYVI = 7;
  XLMHG ::HGW::HGIRMT& GLPVM() XLMHG;
  ELRW HVG_GLPVM(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_GLPVM(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_GLPVM(XLMHG XSZI* EZOFV);
  ELRW HVG_GLPVM(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_GLPVM();
  ::HGW::HGIRMT* IVOVZHV_GLPVM();
  ELRW HVG_ZOOLXZGVW_GLPVM(::HGW::HGIRMT* GLPVM);

  // HGIRMT XLNNZMW = 6;
  ELRW XOVZI_XLNNZMW();
  HGZGRX XLMHG RMG PxLNNZMWuRVOWmFNYVI = 6;
  XLMHG ::HGW::HGIRMT& XLNNZMW() XLMHG;
  ELRW HVG_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_XLNNZMW(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_XLNNZMW(XLMHG XSZI* EZOFV);
  ELRW HVG_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_XLNNZMW();
  ::HGW::HGIRMT* IVOVZHV_XLNNZMW();
  ELRW HVG_ZOOLXZGVW_XLNNZMW(::HGW::HGIRMT* XLNNZMW);

  // HGIRMT HFY_XLNNZMW = 5;
  ELRW XOVZI_HFY_XLNNZMW();
  HGZGRX XLMHG RMG PhFYxLNNZMWuRVOWmFNYVI = 5;
  XLMHG ::HGW::HGIRMT& HFY_XLNNZMW() XLMHG;
  ELRW HVG_HFY_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_HFY_XLNNZMW(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_HFY_XLNNZMW(XLMHG XSZI* EZOFV);
  ELRW HVG_HFY_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_HFY_XLNNZMW();
  ::HGW::HGIRMT* IVOVZHV_HFY_XLNNZMW();
  ELRW HVG_ZOOLXZGVW_HFY_XLNNZMW(::HGW::HGIRMT* HFY_XLNNZMW);

  // HGIRMT ZITFNVMGH = 4;
  ELRW XOVZI_ZITFNVMGH();
  HGZGRX XLMHG RMG PzITFNVMGHuRVOWmFNYVI = 4;
  XLMHG ::HGW::HGIRMT& ZITFNVMGH() XLMHG;
  ELRW HVG_ZITFNVMGH(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_ZITFNVMGH(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_ZITFNVMGH(XLMHG XSZI* EZOFV);
  ELRW HVG_ZITFNVMGH(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_ZITFNVMGH();
  ::HGW::HGIRMT* IVOVZHV_ZITFNVMGH();
  ELRW HVG_ZOOLXZGVW_ZITFNVMGH(::HGW::HGIRMT* ZITFNVMGH);

  // HGIRMT OLMTORMV = 3;
  ELRW XOVZI_OLMTORMV();
  HGZGRX XLMHG RMG PoLMTORMVuRVOWmFNYVI = 3;
  XLMHG ::HGW::HGIRMT& OLMTORMV() XLMHG;
  ELRW HVG_OLMTORMV(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_OLMTORMV(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_OLMTORMV(XLMHG XSZI* EZOFV);
  ELRW HVG_OLMTORMV(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_OLMTORMV();
  ::HGW::HGIRMT* IVOVZHV_OLMTORMV();
  ELRW HVG_ZOOLXZGVW_OLMTORMV(::HGW::HGIRMT* OLMTORMV);

  // HGIRMT HFKKOVNVMG = 2;
  ELRW XOVZI_HFKKOVNVMG();
  HGZGRX XLMHG RMG PhFKKOVNVMGuRVOWmFNYVI = 2;
  XLMHG ::HGW::HGIRMT& HFKKOVNVMG() XLMHG;
  ELRW HVG_HFKKOVNVMG(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_HFKKOVNVMG(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV);
  ELRW HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_HFKKOVNVMG();
  ::HGW::HGIRMT* IVOVZHV_HFKKOVNVMG();
  ELRW HVG_ZOOLXZGVW_HFKKOVNVMG(::HGW::HGIRMT* HFKKOVNVMG);

  // YBGVH WZGZ = 1;
  ELRW XOVZI_WZGZ();
  HGZGRX XLMHG RMG PwZGZuRVOWmFNYVI = 1;
  XLMHG ::HGW::HGIRMT& WZGZ() XLMHG;
  ELRW HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_WZGZ(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_WZGZ(XLMHG XSZI* EZOFV);
  ELRW HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_WZGZ();
  ::HGW::HGIRMT* IVOVZHV_WZGZ();
  ELRW HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ);

  // @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HXLKV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG)
 KIREZGV:

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMGVIMZOnVGZWZGZdRGSzIVMZ _RMGVIMZO_NVGZWZGZ_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI FHVI_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI GLPVM_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI XLNNZMW_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI HFY_XLNNZMW_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI ZITFNVMGH_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI OLMTORMV_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI HFKKOVNVMG_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI WZGZ_;
  NFGZYOV RMG _XZXSVW_HRAV_;
  UIRVMW HGIFXG KILGLYFU_XLNNZMW_7VKILGL::gZYOVhGIFXG;
};
// -------------------------------------------------------------------

XOZHH xLNNZMWiVKOB : KFYORX ::TLLTOV::KILGLYFU::nVHHZTV /* @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_WVURMRGRLM:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB) */ {
 KFYORX:
  xLNNZMWiVKOB();
  ERIGFZO ~xLNNZMWiVKOB();

  xLNNZMWiVKOB(XLMHG xLNNZMWiVKOB& UILN);

  RMORMV xLNNZMWiVKOB& LKVIZGLI=(XLMHG xLNNZMWiVKOB& UILN) {
    xLKBuILN(UILN);
    IVGFIM *GSRH;
  }

  HGZGRX XLMHG ::TLLTOV::KILGLYFU::wVHXIRKGLI* WVHXIRKGLI();
  HGZGRX XLMHG xLNNZMWiVKOB& WVUZFOG_RMHGZMXV();

  HGZGRX RMORMV XLMHG xLNNZMWiVKOB* RMGVIMZO_WVUZFOG_RMHGZMXV() {
    IVGFIM IVRMGVIKIVG_XZHG<XLMHG xLNNZMWiVKOB*>(
               &_xLNNZMWiVKOB_WVUZFOG_RMHGZMXV_);
  }

  ELRW hDZK(xLNNZMWiVKOB* LGSVI);

  // RNKOVNVMGH nVHHZTV ----------------------------------------------

  RMORMV xLNNZMWiVKOB* mVD() XLMHG kilglyfu_urmzo { IVGFIM mVD(mfoo); }

  xLNNZMWiVKOB* mVD(::TLLTOV::KILGLYFU::zIVMZ* ZIVMZ) XLMHG kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW nVITVuILN(XLMHG ::TLLTOV::KILGLYFU::nVHHZTV& UILN) kilglyfu_urmzo;
  ELRW xLKBuILN(XLMHG xLNNZMWiVKOB& UILN);
  ELRW nVITVuILN(XLMHG xLNNZMWiVKOB& UILN);
  ELRW xOVZI() kilglyfu_urmzo;
  YLLO rHrMRGRZORAVW() XLMHG kilglyfu_urmzo;

  HRAV_G yBGVhRAVoLMT() XLMHG kilglyfu_urmzo;
  YLLO nVITVkZIGRZOuILNxLWVWhGIVZN(
      ::TLLTOV::KILGLYFU::RL::xLWVWrMKFGhGIVZN* RMKFG) kilglyfu_urmzo;
  ELRW hVIRZORAVdRGSxZXSVWhRAVH(
      ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN* LFGKFG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
      YLLO WVGVINRMRHGRX, ::TLLTOV::KILGLYFU::FRMG1* GZITVG) XLMHG kilglyfu_urmzo;
  ::TLLTOV::KILGLYFU::FRMG1* hVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(::TLLTOV::KILGLYFU::FRMG1* LFGKFG)
      XLMHG kilglyfu_urmzo {
    IVGFIM rMGVIMZOhVIRZORAVdRGSxZXSVWhRAVHgLzIIZB(
        ::TLLTOV::KILGLYFU::RL::xLWVWlFGKFGhGIVZN::rHwVUZFOGhVIRZORAZGRLMwVGVINRMRHGRX(), LFGKFG);
  }
  RMG tVGxZXSVWhRAV() XLMHG kilglyfu_urmzo { IVGFIM _XZXSVW_HRAV_; }
  KIREZGV:
  ELRW hSZIVWxGLI();
  ELRW hSZIVWwGLI();
  ELRW hVGxZXSVWhRAV(RMG HRAV) XLMHG kilglyfu_urmzo;
  ELRW rMGVIMZOhDZK(xLNNZMWiVKOB* LGSVI);
  KIREZGV:
  RMORMV ::TLLTOV::KILGLYFU::zIVMZ* tVGzIVMZmLeRIGFZO() XLMHG {
    IVGFIM mfoo;
  }
  RMORMV ELRW* nZBYVzIVMZkGI() XLMHG {
    IVGFIM mfoo;
  }
  KFYORX:

  ::TLLTOV::KILGLYFU::nVGZWZGZ tVGnVGZWZGZ() XLMHG kilglyfu_urmzo;

  // MVHGVW GBKVH ----------------------------------------------------

  // ZXXVHHLIH -------------------------------------------------------

  // HGIRMT HGZGFH = 8;
  ELRW XOVZI_HGZGFH();
  HGZGRX XLMHG RMG PhGZGFHuRVOWmFNYVI = 8;
  XLMHG ::HGW::HGIRMT& HGZGFH() XLMHG;
  ELRW HVG_HGZGFH(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_HGZGFH(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_HGZGFH(XLMHG XSZI* EZOFV);
  ELRW HVG_HGZGFH(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_HGZGFH();
  ::HGW::HGIRMT* IVOVZHV_HGZGFH();
  ELRW HVG_ZOOLXZGVW_HGZGFH(::HGW::HGIRMT* HGZGFH);

  // HGIRMT NVHHZTV = 7;
  ELRW XOVZI_NVHHZTV();
  HGZGRX XLMHG RMG PnVHHZTVuRVOWmFNYVI = 7;
  XLMHG ::HGW::HGIRMT& NVHHZTV() XLMHG;
  ELRW HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_NVHHZTV(XLMHG XSZI* EZOFV);
  ELRW HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_NVHHZTV();
  ::HGW::HGIRMT* IVOVZHV_NVHHZTV();
  ELRW HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV);

  // HGIRMT OLMT_NVHHZTV = 6;
  ELRW XOVZI_OLMT_NVHHZTV();
  HGZGRX XLMHG RMG PoLMTnVHHZTVuRVOWmFNYVI = 6;
  XLMHG ::HGW::HGIRMT& OLMT_NVHHZTV() XLMHG;
  ELRW HVG_OLMT_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_OLMT_NVHHZTV(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_OLMT_NVHHZTV(XLMHG XSZI* EZOFV);
  ELRW HVG_OLMT_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_OLMT_NVHHZTV();
  ::HGW::HGIRMT* IVOVZHV_OLMT_NVHHZTV();
  ELRW HVG_ZOOLXZGVW_OLMT_NVHHZTV(::HGW::HGIRMT* OLMT_NVHHZTV);

  // HGIRMT EVIB_OLMT_NVHHZTV = 5;
  ELRW XOVZI_EVIB_OLMT_NVHHZTV();
  HGZGRX XLMHG RMG PeVIBoLMTnVHHZTVuRVOWmFNYVI = 5;
  XLMHG ::HGW::HGIRMT& EVIB_OLMT_NVHHZTV() XLMHG;
  ELRW HVG_EVIB_OLMT_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_EVIB_OLMT_NVHHZTV(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_EVIB_OLMT_NVHHZTV(XLMHG XSZI* EZOFV);
  ELRW HVG_EVIB_OLMT_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_EVIB_OLMT_NVHHZTV();
  ::HGW::HGIRMT* IVOVZHV_EVIB_OLMT_NVHHZTV();
  ELRW HVG_ZOOLXZGVW_EVIB_OLMT_NVHHZTV(::HGW::HGIRMT* EVIB_OLMT_NVHHZTV);

  // YBGVH WZGZ = 4;
  ELRW XOVZI_WZGZ();
  HGZGRX XLMHG RMG PwZGZuRVOWmFNYVI = 4;
  XLMHG ::HGW::HGIRMT& WZGZ() XLMHG;
  ELRW HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_WZGZ(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_WZGZ(XLMHG XSZI* EZOFV);
  ELRW HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_WZGZ();
  ::HGW::HGIRMT* IVOVZHV_WZGZ();
  ELRW HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ);

  // HGIRMT HFKKOVNVMG = 3;
  ELRW XOVZI_HFKKOVNVMG();
  HGZGRX XLMHG RMG PhFKKOVNVMGuRVOWmFNYVI = 3;
  XLMHG ::HGW::HGIRMT& HFKKOVNVMG() XLMHG;
  ELRW HVG_HFKKOVNVMG(XLMHG ::HGW::HGIRMT& EZOFV);
  #RU ozmt_xcc88
  ELRW HVG_HFKKOVNVMG(::HGW::HGIRMT&& EZOFV);
  #VMWRU
  ELRW HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV);
  ELRW HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV, HRAV_G HRAV);
  ::HGW::HGIRMT* NFGZYOV_HFKKOVNVMG();
  ::HGW::HGIRMT* IVOVZHV_HFKKOVNVMG();
  ELRW HVG_ZOOLXZGVW_HFKKOVNVMG(::HGW::HGIRMT* HFKKOVNVMG);

  // @@KILGLX_RMHVIGRLM_KLRMG(XOZHH_HXLKV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB)
 KIREZGV:

  ::TLLTOV::KILGLYFU::RMGVIMZO::rMGVIMZOnVGZWZGZdRGSzIVMZ _RMGVIMZO_NVGZWZGZ_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI HGZGFH_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI NVHHZTV_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI OLMT_NVHHZTV_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI EVIB_OLMT_NVHHZTV_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI WZGZ_;
  ::TLLTOV::KILGLYFU::RMGVIMZO::zIVMZhGIRMTkGI HFKKOVNVMG_;
  NFGZYOV RMG _XZXSVW_HRAV_;
  UIRVMW HGIFXG KILGLYFU_XLNNZMW_7VKILGL::gZYOVhGIFXG;
};
// ===================================================================


// ===================================================================

#RU !kilglyfu_rmormv_mlg_rm_svzwvih
// sVOOLiVJFVHG

// HGIRMT MZNV = 8;
RMORMV ELRW sVOOLiVJFVHG::XOVZI_MZNV() {
  MZNV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& sVOOLiVJFVHG::MZNV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
  IVGFIM MZNV_.tVGmLzIVMZ();
}
RMORMV ELRW sVOOLiVJFVHG::HVG_MZNV(XLMHG ::HGW::HGIRMT& EZOFV) {

  MZNV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
#RU ozmt_xcc88
RMORMV ELRW sVOOLiVJFVHG::HVG_MZNV(::HGW::HGIRMT&& EZOFV) {

  MZNV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
#VMWRU
RMORMV ELRW sVOOLiVJFVHG::HVG_MZNV(XLMHG XSZI* EZOFV) {

  MZNV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
RMORMV ELRW sVOOLiVJFVHG::HVG_MZNV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  MZNV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}
RMORMV ::HGW::HGIRMT* sVOOLiVJFVHG::NFGZYOV_MZNV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
  IVGFIM MZNV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* sVOOLiVJFVHG::IVOVZHV_MZNV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)

  IVGFIM MZNV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW sVOOLiVJFVHG::HVG_ZOOLXZGVW_MZNV(::HGW::HGIRMT* MZNV) {
  RU (MZNV != mfoo) {

  } VOHV {

  }
  MZNV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), MZNV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.sVOOLiVJFVHG.MZNV)
}

// -------------------------------------------------------------------

// sVOOLiVKOB

// HGIRMT NVHHZTV = 8;
RMORMV ELRW sVOOLiVKOB::XOVZI_NVHHZTV() {
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& sVOOLiVKOB::NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.tVGmLzIVMZ();
}
RMORMV ELRW sVOOLiVKOB::HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
#RU ozmt_xcc88
RMORMV ELRW sVOOLiVKOB::HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
#VMWRU
RMORMV ELRW sVOOLiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
RMORMV ELRW sVOOLiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}
RMORMV ::HGW::HGIRMT* sVOOLiVKOB::NFGZYOV_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* sVOOLiVKOB::IVOVZHV_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)

  IVGFIM NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW sVOOLiVKOB::HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV) {
  RU (NVHHZTV != mfoo) {

  } VOHV {

  }
  NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.sVOOLiVKOB.NVHHZTV)
}

// -------------------------------------------------------------------

// xLNNZMWiVJFVHG

// HGIRMT FHVI = 8;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_FHVI() {
  FHVI_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::FHVI() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
  IVGFIM FHVI_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_FHVI(XLMHG ::HGW::HGIRMT& EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_FHVI(::HGW::HGIRMT&& EZOFV) {

  FHVI_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_FHVI(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  FHVI_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_FHVI() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
  IVGFIM FHVI_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_FHVI() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)

  IVGFIM FHVI_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_FHVI(::HGW::HGIRMT* FHVI) {
  RU (FHVI != mfoo) {

  } VOHV {

  }
  FHVI_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), FHVI);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.FHVI)
}

// HGIRMT GLPVM = 7;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_GLPVM() {
  GLPVM_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::GLPVM() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
  IVGFIM GLPVM_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_GLPVM(XLMHG ::HGW::HGIRMT& EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_GLPVM(::HGW::HGIRMT&& EZOFV) {

  GLPVM_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_GLPVM(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  GLPVM_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_GLPVM() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
  IVGFIM GLPVM_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_GLPVM() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)

  IVGFIM GLPVM_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_GLPVM(::HGW::HGIRMT* GLPVM) {
  RU (GLPVM != mfoo) {

  } VOHV {

  }
  GLPVM_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), GLPVM);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.GLPVM)
}

// HGIRMT XLNNZMW = 6;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_XLNNZMW() {
  XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::XLNNZMW() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(::HGW::HGIRMT&& EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_XLNNZMW() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
  IVGFIM XLNNZMW_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_XLNNZMW() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)

  IVGFIM XLNNZMW_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_XLNNZMW(::HGW::HGIRMT* XLNNZMW) {
  RU (XLNNZMW != mfoo) {

  } VOHV {

  }
  XLNNZMW_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), XLNNZMW);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.XLNNZMW)
}

// HGIRMT HFY_XLNNZMW = 5;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_HFY_XLNNZMW() {
  HFY_XLNNZMW_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::HFY_XLNNZMW() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
  IVGFIM HFY_XLNNZMW_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(XLMHG ::HGW::HGIRMT& EZOFV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(::HGW::HGIRMT&& EZOFV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(XLMHG XSZI* EZOFV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFY_XLNNZMW(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HFY_XLNNZMW_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_HFY_XLNNZMW() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
  IVGFIM HFY_XLNNZMW_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_HFY_XLNNZMW() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)

  IVGFIM HFY_XLNNZMW_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_HFY_XLNNZMW(::HGW::HGIRMT* HFY_XLNNZMW) {
  RU (HFY_XLNNZMW != mfoo) {

  } VOHV {

  }
  HFY_XLNNZMW_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HFY_XLNNZMW);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFY_XLNNZMW)
}

// HGIRMT ZITFNVMGH = 4;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_ZITFNVMGH() {
  ZITFNVMGH_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::ZITFNVMGH() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
  IVGFIM ZITFNVMGH_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(XLMHG ::HGW::HGIRMT& EZOFV) {

  ZITFNVMGH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(::HGW::HGIRMT&& EZOFV) {

  ZITFNVMGH_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(XLMHG XSZI* EZOFV) {

  ZITFNVMGH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZITFNVMGH(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  ZITFNVMGH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_ZITFNVMGH() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
  IVGFIM ZITFNVMGH_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_ZITFNVMGH() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)

  IVGFIM ZITFNVMGH_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_ZITFNVMGH(::HGW::HGIRMT* ZITFNVMGH) {
  RU (ZITFNVMGH != mfoo) {

  } VOHV {

  }
  ZITFNVMGH_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ZITFNVMGH);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.ZITFNVMGH)
}

// HGIRMT OLMTORMV = 3;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_OLMTORMV() {
  OLMTORMV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::OLMTORMV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
  IVGFIM OLMTORMV_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(XLMHG ::HGW::HGIRMT& EZOFV) {

  OLMTORMV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(::HGW::HGIRMT&& EZOFV) {

  OLMTORMV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(XLMHG XSZI* EZOFV) {

  OLMTORMV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_OLMTORMV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  OLMTORMV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_OLMTORMV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
  IVGFIM OLMTORMV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_OLMTORMV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)

  IVGFIM OLMTORMV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_OLMTORMV(::HGW::HGIRMT* OLMTORMV) {
  RU (OLMTORMV != mfoo) {

  } VOHV {

  }
  OLMTORMV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), OLMTORMV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.OLMTORMV)
}

// HGIRMT HFKKOVNVMG = 2;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_HFKKOVNVMG() {
  HFKKOVNVMG_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::HFKKOVNVMG() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(XLMHG ::HGW::HGIRMT& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(::HGW::HGIRMT&& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_HFKKOVNVMG() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_HFKKOVNVMG() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)

  IVGFIM HFKKOVNVMG_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_HFKKOVNVMG(::HGW::HGIRMT* HFKKOVNVMG) {
  RU (HFKKOVNVMG != mfoo) {

  } VOHV {

  }
  HFKKOVNVMG_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HFKKOVNVMG);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.HFKKOVNVMG)
}

// YBGVH WZGZ = 1;
RMORMV ELRW xLNNZMWiVJFVHG::XOVZI_WZGZ() {
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVJFVHG::WZGZ() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
  IVGFIM WZGZ_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVJFVHG::HVG_WZGZ(::HGW::HGIRMT&& EZOFV) {

  WZGZ_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
#VMWRU
RMORMV ELRW xLNNZMWiVJFVHG::HVG_WZGZ(XLMHG XSZI* EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::NFGZYOV_WZGZ() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
  IVGFIM WZGZ_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVJFVHG::IVOVZHV_WZGZ() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)

  IVGFIM WZGZ_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVJFVHG::HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ) {
  RU (WZGZ != mfoo) {

  } VOHV {

  }
  WZGZ_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), WZGZ);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVJFVHG.WZGZ)
}

// -------------------------------------------------------------------

// xLNNZMWiVKOB

// HGIRMT HGZGFH = 8;
RMORMV ELRW xLNNZMWiVKOB::XOVZI_HGZGFH() {
  HGZGFH_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::HGZGFH() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
  IVGFIM HGZGFH_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVKOB::HVG_HGZGFH(XLMHG ::HGW::HGIRMT& EZOFV) {

  HGZGFH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVKOB::HVG_HGZGFH(::HGW::HGIRMT&& EZOFV) {

  HGZGFH_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
#VMWRU
RMORMV ELRW xLNNZMWiVKOB::HVG_HGZGFH(XLMHG XSZI* EZOFV) {

  HGZGFH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
RMORMV ELRW xLNNZMWiVKOB::HVG_HGZGFH(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HGZGFH_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_HGZGFH() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
  IVGFIM HGZGFH_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_HGZGFH() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)

  IVGFIM HGZGFH_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_HGZGFH(::HGW::HGIRMT* HGZGFH) {
  RU (HGZGFH != mfoo) {

  } VOHV {

  }
  HGZGFH_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HGZGFH);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HGZGFH)
}

// HGIRMT NVHHZTV = 7;
RMORMV ELRW xLNNZMWiVKOB::XOVZI_NVHHZTV() {
  NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVKOB::HVG_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVKOB::HVG_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
#VMWRU
RMORMV ELRW xLNNZMWiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
RMORMV ELRW xLNNZMWiVKOB::HVG_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
  IVGFIM NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)

  IVGFIM NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_NVHHZTV(::HGW::HGIRMT* NVHHZTV) {
  RU (NVHHZTV != mfoo) {

  } VOHV {

  }
  NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.NVHHZTV)
}

// HGIRMT OLMT_NVHHZTV = 6;
RMORMV ELRW xLNNZMWiVKOB::XOVZI_OLMT_NVHHZTV() {
  OLMT_NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::OLMT_NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
  IVGFIM OLMT_NVHHZTV_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
#VMWRU
RMORMV ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(XLMHG XSZI* EZOFV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
RMORMV ELRW xLNNZMWiVKOB::HVG_OLMT_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_OLMT_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
  IVGFIM OLMT_NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_OLMT_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)

  IVGFIM OLMT_NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_OLMT_NVHHZTV(::HGW::HGIRMT* OLMT_NVHHZTV) {
  RU (OLMT_NVHHZTV != mfoo) {

  } VOHV {

  }
  OLMT_NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), OLMT_NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.OLMT_NVHHZTV)
}

// HGIRMT EVIB_OLMT_NVHHZTV = 5;
RMORMV ELRW xLNNZMWiVKOB::XOVZI_EVIB_OLMT_NVHHZTV() {
  EVIB_OLMT_NVHHZTV_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::EVIB_OLMT_NVHHZTV() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
  IVGFIM EVIB_OLMT_NVHHZTV_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(XLMHG ::HGW::HGIRMT& EZOFV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(::HGW::HGIRMT&& EZOFV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
#VMWRU
RMORMV ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(XLMHG XSZI* EZOFV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
RMORMV ELRW xLNNZMWiVKOB::HVG_EVIB_OLMT_NVHHZTV(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  EVIB_OLMT_NVHHZTV_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_EVIB_OLMT_NVHHZTV() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
  IVGFIM EVIB_OLMT_NVHHZTV_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_EVIB_OLMT_NVHHZTV() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)

  IVGFIM EVIB_OLMT_NVHHZTV_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_EVIB_OLMT_NVHHZTV(::HGW::HGIRMT* EVIB_OLMT_NVHHZTV) {
  RU (EVIB_OLMT_NVHHZTV != mfoo) {

  } VOHV {

  }
  EVIB_OLMT_NVHHZTV_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EVIB_OLMT_NVHHZTV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.EVIB_OLMT_NVHHZTV)
}

// YBGVH WZGZ = 4;
RMORMV ELRW xLNNZMWiVKOB::XOVZI_WZGZ() {
  WZGZ_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::WZGZ() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
  IVGFIM WZGZ_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVKOB::HVG_WZGZ(XLMHG ::HGW::HGIRMT& EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVKOB::HVG_WZGZ(::HGW::HGIRMT&& EZOFV) {

  WZGZ_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
#VMWRU
RMORMV ELRW xLNNZMWiVKOB::HVG_WZGZ(XLMHG XSZI* EZOFV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
RMORMV ELRW xLNNZMWiVKOB::HVG_WZGZ(XLMHG ELRW* EZOFV, HRAV_G HRAV) {

  WZGZ_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_WZGZ() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
  IVGFIM WZGZ_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_WZGZ() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)

  IVGFIM WZGZ_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_WZGZ(::HGW::HGIRMT* WZGZ) {
  RU (WZGZ != mfoo) {

  } VOHV {

  }
  WZGZ_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), WZGZ);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.WZGZ)
}

// HGIRMT HFKKOVNVMG = 3;
RMORMV ELRW xLNNZMWiVKOB::XOVZI_HFKKOVNVMG() {
  HFKKOVNVMG_.xOVZIgLvNKGBmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV XLMHG ::HGW::HGIRMT& xLNNZMWiVKOB::HFKKOVNVMG() XLMHG {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_TVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.tVGmLzIVMZ();
}
RMORMV ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(XLMHG ::HGW::HGIRMT& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), EZOFV);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
#RU ozmt_xcc88
RMORMV ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(::HGW::HGIRMT&& EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(
    &::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::NLEV(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_IEZOFV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
#VMWRU
RMORMV ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), ::HGW::HGIRMT(EZOFV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_XSZI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
RMORMV ELRW xLNNZMWiVKOB::HVG_HFKKOVNVMG(XLMHG XSZI* EZOFV, HRAV_G HRAV) {

  HFKKOVNVMG_.hVGmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(),
      ::HGW::HGIRMT(IVRMGVIKIVG_XZHG<XLMHG XSZI*>(EZOFV), HRAV));
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_KLRMGVI:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::NFGZYOV_HFKKOVNVMG() {

  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_NFGZYOV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
  IVGFIM HFKKOVNVMG_.nFGZYOVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ::HGW::HGIRMT* xLNNZMWiVKOB::IVOVZHV_HFKKOVNVMG() {
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_IVOVZHV:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)

  IVGFIM HFKKOVNVMG_.iVOVZHVmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW());
}
RMORMV ELRW xLNNZMWiVKOB::HVG_ZOOLXZGVW_HFKKOVNVMG(::HGW::HGIRMT* HFKKOVNVMG) {
  RU (HFKKOVNVMG != mfoo) {

  } VOHV {

  }
  HFKKOVNVMG_.hVGzOOLXZGVWmLzIVMZ(&::TLLTOV::KILGLYFU::RMGVIMZO::tVGvNKGBhGIRMTzOIVZWBrMRGVW(), HFKKOVNVMG);
  // @@KILGLX_RMHVIGRLM_KLRMG(URVOW_HVG_ZOOLXZGVW:hGZIUOVVGxLNNZMW.xLNNZMWiVKOB.HFKKOVNVMG)
}

#VMWRU  // !kilglyfu_rmormv_mlg_rm_svzwvih
// -------------------------------------------------------------------

// -------------------------------------------------------------------

// -------------------------------------------------------------------


// @@KILGLX_RMHVIGRLM_KLRMG(MZNVHKZXV_HXLKV)


}  // MZNVHKZXV hGZIUOVVGxLNNZMW

// @@KILGLX_RMHVIGRLM_KLRMG(TOLYZO_HXLKV)

#VMWRU  // kilglyfu_XLNNZMW_7VKILGL__rmxofwvw
//##**---------------- ./HGZIUOVVG/VCZNKOV/VCZNKOV_LK.KB
"""__ZFGSLI__=bbb."""
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM, xLMURTFIZGRLMvMTRMV
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG FYRJGLLO.OLT  ZH OLT


XOZHH ccc(lKVIZGRLM):
    """GSRH RH Z HZNKOV LK."""
    @HGZGRXNVGSLW
    WVU RMRG_XLMURT():
        XLMURT = xLMURTFIZGRLMvMTRMV()
        #XLMURT.LKGRLMZO('KZIZ8', WVUZFOG='66')
        #XLMURT.IVJFRIV('KZIZ7')
        IVGFIM XLMURT


    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        """XGLI."""
        HFKVI(ccc, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        XLMURT = ccc.RMRG_XLMURT()
        XLMURT.KZIHV(CNO)

    WVU DLIP(HVOU):
        """ GSV IVZO DLIP UFMXGRLM ZMW BLF HSZOO
            RNKOVNVMG GSRH UFMXGRLM.
        """
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_GZHP.KB
__ZFGSLI__ = 'UZMYRM'

RNKLIG HBH

evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# UILN YZHV RNKLIG NZMZTVNVMG, TOLYZORMUL
RNKLIG HFYKILXVHH
# UILN NLWVO.NLWVO RNKLIG (kZIZNVGVI, wZGZrMiVERVD, wZGZ, zOKSZ, zOKSZrMiVERVD,
                         # wZGZrMiVERVD_oLT)



XOZHH gZHP(LYQVXG):
    """gZHP LYQVXG RH GSV ZYHGIZXGRLM LU EZIRLFH GZHPH.
    """


    WVU __RMRG__(HVOU, KILTIZN, XLMURT, XDW="", OLT=""):
        """iVGFIM Z WZGZ LYQVXG DSLHV MZNV RH *MZNV* .
        """
        HVOU.KILTIZN = KILTIZN
        HVOU.OLT = OLT
        HVOU.XLMURT = XLMURT
        HVOU.HGZGFH = 9
        HVOU.XDW = XDW
        HVOU.NRHHRLM = mLMV
        HVOU.VIILIRW = mLMV
        HVOU.RH_IFMMRMT = uZOHV
        # HVOU.IVG_ORHG = {}  # IVGFIM XLWV
        # HVOU.HGWVII_ORHG = {}  # HGWVII
        # HVOU.HGWLFG_ORHG = {}  # HGWLFG
        # HVOU.OLT_ORHG = {}
        # HVOU.NRHHRLM = NRHHRLM


    WVU IFM(HVOU):
        HVOU.NRHHRLM = HFYKILXVHH.kLKVM([HVOU.KILTIZN, HVOU.XLMURT],HSVOO=uZOHV, HGWLFG=HFYKILXVHH.krkv, HGWVII=HFYKILXVHH.krkv)
        HVOU.KRW = HVOU.NRHHRLM.KRW
        HVOU.RH_IFMMRMT = gIFV
        HVOU.VIILIRW = mLMV
        IVGFIM HVOU.NRHHRLM.KRW


    WVU PROO(HVOU):
        HVOU.IFMMRMT.GVINRMZGV()
        HVOU.RH_IFMMRMT = uZOHV
        HVOU.IFMMRMT.DZRG()


    WVU KLOO(HVOU):
        RU MLG HVOU.RH_IFMMRMT:
            IVGFIM uZOHV
        RU HVOU.NRHHRLM.KLOO() RH MLG mLMV:
            RU HVOU.RH_IFMMRMT:
                HVOU.VIILIRW = HVOU.NRHHRLM.KLOO()
                HVOU.RH_IFMMRMT = uZOHV
            IVGFIM uZOHV
        VOHV:
            IVGFIM gIFV


    WVU __VJ__(HVOU, LGSVI):
        IVGFIM HVOU.MZNV == LGSVI.MZNV


//##**---------------- ./HGZIUOVVG/YZHV/YZHV_NLWFOV.KB
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG HBH
RNKLIG LH
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO

XOZHH nLWFOV(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.CNO = CNO

    WVU OLZW_XNW_KZGS(HVOU, UROVKZGS):
        RU 'XLNNZMWH' RM HVOU.CNO.ZGGIRY:
            KZGS = HVOU.CNO.ZGGIRY['XLNNZMWH'].HGIRK()
            RU KZGS[9] == '/':
                HVOU.TOLYZO_RMUL.XNW_KZGS.ZKKVMW(KZGS)
            VOHV:
                # KIRMG(FYRJFGRO.TVG_XFIIVMG_WRI(UROVKZGS))
                HVOU.TOLYZO_RMUL.XNW_KZGS.ZKKVMW(LH.KZGS.QLRM(FYRJFGRO.TVG_XFIIVMG_WRI(UROVKZGS), KZGS))

    WVU HFRXRWV(HVOU):
        KZHH

    WVU IVOLZW(HVOU):
        KZHH

    WVU HGZIG(HVOU):
        KZHH

    WVU HGLK(HVOU):
        KZHH

    WVU GZPV_XLNNZMW(HVOU, XNW, ZITFNVMGH):
        KZHH
//##**---------------- ./HGZIUOVVG/YZHV/FGIZWV.KB
RNKLIG LH

XOZHH fGIZWV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.gVNKOZGV = ""
        HVOU.xORVMGkZGS = ""
        HVOU.hVIEVI = ""
        HVOU.oZHGfKWZGVgRNV = mLMV
        HVOU.hGZGFH


        HVOU.rMEVHGrW = ""
        HVOU.zXXLFMGrW = ""
        HVOU.hRW = ""
        HVOU.lKVIZGRLMH = []
        HVOU.zOKSZkZGS = ""
        HVOU.kLORXRVH = []



//##**---------------- ./HGZIUOVVG/YZHV/YZHV_TFMRXLIM.KB
"""KFYORX NLWFOV FHVW YB HGZIUOVVG GL DIZK UOZHP HVIEVI RM Z TFMRXLIM."""
RNKLIG TFMRXLIM.ZKK.YZHV
UILN TFMRXLIM.HRC RNKLIG RGVIRGVNH


XOZHH tFMRXLIMzKKORXZGRLM(TFMRXLIM.ZKK.YZHV.yZHVzKKORXZGRLM):
    """TFMRXLIM ZKKORXZRGLM, DIZK UOZHP HVIEVI ULI KILWFXGRLM."""

    WVU __RMRG__(HVOU, ZKK, LKGRLMH=mLMV):
        """QFHG Z XGLI."""
        HVOU.LKGRLMH = LKGRLMH LI {}
        HVOU.ZKKORXZGRLM = ZKK
        HFKVI(tFMRXLIMzKKORXZGRLM, HVOU).__RMRG__()

    WVU OLZW_XLMURT(HVOU):
        """OLZW XLMURT."""
        XLMURT = WRXG([(PVB, EZOFV) ULI PVB, EZOFV RM RGVIRGVNH(HVOU.LKGRLMH)
                       RU PVB RM HVOU.XUT.HVGGRMTH ZMW EZOFV RH MLG mLMV])
        ULI PVB, EZOFV RM RGVIRGVNH(XLMURT):
            HVOU.XUT.HVG(PVB.OLDVI(), EZOFV)

    WVU OLZW(HVOU):
        """VCKLHV HVIEVI ZKKORXZRGLM."""
        IVGFIM HVOU.ZKKORXZGRLM
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_KLHGHVIEVI.KB
evihrlm=''
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
UILN SGGK.HVIEVI RNKLIG yZHVsggkiVJFVHGsZMWOVI
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG, TARKVMXLWV
RNKLIG QHLM
RNKLIG WZGVGRNV
RNKLIG TARK
UILN RL RNKLIG yBGVHrl


WVU QHLM_HVIRZO(LYQ):
    RU RHRMHGZMXV(LYQ, (WZGVGRNV.WZGVGRNV, WZGVGRNV.WZGV)):
        IVGFIM LYQ.RHLULINZG()
    IZRHV gBKVvIILI("gBKV %H MLG HVIRZORAZYOV"%(GBKV(LYQ)))

IVWRIVXG_KLHG_HVIEVIH = {}
HKVXRZO_JFVIB_UFMXGRLMH = {}
VCKLIG_KLHG_WZGZ = {}
VCKLIG_KLHG_GIRTTVI_UFMXGRLM = {}
    # KLHG HVIEVI, VCKLHV WZGZ GL LFGHRWV DLIOW

# ULI KLHG IVOZB
XORVMG = kLHGxORVMG()

XOZHH kLHGhVIEVIsZMWOVI(yZHVsggkiVJFVHGsZMWOVI):

    WVU OLT_NVHHZTV(HVOU, ULINZG, *ZITH):
        GIB:
            OLTHGI = ULINZG%ZITH
            HVOU.HVIEVI.OLTTVI.WVYFT(OLTHGI)
        VCXVKG vCXVKGRLM ZH V:
            KZHH

    WVU _HVG_IVHKLMHV(HVOU, TARK=uZOHV, OVMTGS = 9):
        HVOU.HVMW_IVHKLMHV(799)
        HVOU.HVMW_SVZWVI('xLMGVMG-GBKV', 'GVCG/SGNO')
        RU OVMTGS != 9:
            HVOU.HVMW_SVZWVI('xLMGVMG-OVMTGS', HGI(OVMTGS))
        RU TARK:
            HVOU.HVMW_SVZWVI('xLMGVMG-vMXLWRMT', 'TARK')
        HVOU.VMW_SVZWVIH()

    WVU KIRMG_SVZW(HVOU):
        IVGFIM 'tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M'%(HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))


    WVU WL_tvg(HVOU):
        #OLTTRMT.RMUL("tvg IVJFVHG,\MkZGS: %H\MsVZWVIH:\M%H\M", HGI(HVOU.KZGS), HGI(HVOU.SVZWVIH))
        HVOU._HVG_IVHKLMHV()
        HVOU.DUROV.DIRGV("tvg IVJFVHG ULI {}".ULINZG(HVOU.KZGS).VMXLWV('FGU-1'))

    WVU WL_klhg(HVOU):
        XLMGVMG_OVMTGS = RMG(HVOU.SVZWVIH['xLMGVMG-oVMTGS']) # <--- tVGH GSV HRAV LU WZGZ
        KLHG_WZGZ_IZD = HVOU.IUROV.IVZW(XLMGVMG_OVMTGS) # <--- tVGH GSV WZGZ RGHVOU
        ZHP_RMUL = {}
        KLHG_WZGZ = QHLM.OLZWH(KLHG_WZGZ_IZD.WVXLWV('FGU-1'))
        ZHP_RMUL = KLHG_WZGZ
        KZIHV = [R.HGIRK() ULI R RM HVOU.KZGS.HKORG('/') RU R.HGIRK()!='']
        TOLYZO IVWRIVXG_KLHG_HVIEVIH, HKVXRZO_JFVIB_UFMXGRLMH
        # SZMWOV IVWRIVXG KLHG IVJFVHGH
        RU OVM(KZIHV)>9 ZMW KZIHV[9].HKORG('=')[9] == 'IVWRIVXG':
            IVWRIVXG_GZITVG = KZIHV[9].HKORG('=')[8]
            RU IVWRIVXG_GZITVG MLG RM IVWRIVXG_KLHG_HVIEVIH:
                IVG={}
                IVG['HGZGFH'] = uZOHV
                IVG['IVZHLM'] = 'FMIVXLTMRAVW IVWRIVXG GZITVG %H'%IVWRIVXG_GZITVG
                HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
                IVGFIM
            VOHV:
                TOLYZO XORVMG
                ZWWIVHH = IVWRIVXG_KLHG_HVIEVIH[IVWRIVXG_GZITVG]
                XORVMG.HVG_ZWWIVHH(ZWWIVHH.HKORG(':')[9], RMG(ZWWIVHH.HKORG(':')[8]))
                RU 'GBKV' RM KLHG_WZGZ ZMW KLHG_WZGZ['GBKV'] == 'GIRTTVI':
                    XOR = XORVMG.KLHG('/'.QLRM(KZIHV[8:]), {'GBKV':'GIRTTVI'}, QHLMWZGZ=KLHG_WZGZ)
                VOHV:
                    XOR = XORVMG.KLHG('/'.QLRM(KZIHV[8:]), KLHG_WZGZ)
                HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                HVOU.DUROV.DIRGV(QHLM.WFNKH(XOR).VMXLWV('FGU-1'))
                IVGFIM
        IVG = {'HGZGFH':gIFV}
        RU 'GBKV' MLG RM ZHP_RMUL:
            IVG['HGZGFH'] = uZOHV
            IVG['IVZHLM'] = 'XZMMLG URMW GBKV RMUL RM KLHG IVJFVHG'
            HVOU._HVG_IVHKLMHV(TARK=uZOHV)
            HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
            IVGFIM
        RU ZHP_RMUL['GBKV'] == 'JFVIB':
            # JFVIB IVJFRIVH HKVXRZO UFMXGRLM GIVZGNVMG
            RU 'JFVIB_UFMXGRLM' RM KLHG_WZGZ:
                JFVIB_UFMXGRLM = KLHG_WZGZ['JFVIB_UFMXGRLM'].HGIRK()
                RU JFVIB_UFMXGRLM MLG RM HKVXRZO_JFVIB_UFMXGRLMH:
                    IVG['HGZGFH'] = uZOHV
                    IVG['IVZHLM'] = 'JFVIB_UFMXGRLM MLG ULFMW %H'%JFVIB_UFMXGRLM
                    HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                    HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
                    IVGFIM
                GIB:
                    IVG.XOVZI()
                    IVG = HKVXRZO_JFVIB_UFMXGRLMH[JFVIB_UFMXGRLM](KLHG_WZGZ)
                    RU 'HGZGFH' MLG RM IVG:
                        IVG['HGZGFH'] = gIFV
                    HVOU._HVG_IVHKLMHV(TARK=gIFV)
                    HVOU.DUROV.DIRGV(TARKVMXLWV(QHLM.WFNKH(IVG, WVUZFOG=QHLM_HVIRZO).VMXLWV('FGU-1')))
                    IVGFIM
                VCXVKG vCXVKGRLM ZH V:
                    IVG.XOVZI()
                    IVG['HGZGFH'] = uZOHV
                    IVG['IVZHLM'] = 'JFVIB UZROVW DRGS IVZHLM %H'%HGI(V)
                    HVOU._HVG_IVHKLMHV(TARK=gIFV)
                    HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
                    IVGFIM
            RU OVM(KZIHV) == 9:
                IVG['WZGZ'] = VCKLIG_KLHG_WZGZ
            GVNK_WZGZ = VCKLIG_KLHG_WZGZ
            ULI VM RM KZIHV:
                RU VM MLG RM GVNK_WZGZ:
                    IVG['HGZGFH'] = uZOHV
                    IVG['IVZHLM'] = 'XZMMLG URMW JFVIB SRG'
                    HVOU._HVG_IVHKLMHV(TARK=uZOHV)
                    HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
                    IVGFIM
                VOHV:
                    GVNK_WZGZ = GVNK_WZGZ[VM]
            IVG['WZGZ'] = GVNK_WZGZ
            GLDIRGV = TARKVMXLWV(QHLM.WFNKH(IVG, WVUZFOG=QHLM_HVIRZO).VMXLWV('FGU-1'))
            HVOU._HVG_IVHKLMHV(TARK=gIFV, OVMTGS = OVM(GLDIRGV))
            HVOU.DUROV.DIRGV(GLDIRGV)
        VORU ZHP_RMUL['GBKV'] == 'GIRTTVI':
            HVOU._HVG_IVHKLMHV(TARK = uZOHV)
            RU 'GIRTTVI_UFMXGRLM' MLG RM ZHP_RMUL:
                IVG['HGZGFH'] = uZOHV
                IVG['IVZHLM'] = 'NRHHRMT GIRTTVI_UFMXGRLM RM GSV KLHG IVJFVHG'
                HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
                IVGFIM
            RU  ZHP_RMUL['GIRTTVI_UFMXGRLM'] MLG RM VCKLIG_KLHG_GIRTTVI_UFMXGRLM:
                IVG['HGZGFH'] = uZOHV
                IVG['IVZHLM'] = 'HBHGVN XZMMLG URMW IVTRHGVIVW KLHG UFMXGRLM %H'%ZHP_RMUL['GIRTTVI_UFMXGRLM']
                HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
                IVGFIM
            RU 'UFMXGRLM_ZITH' MLG RM ZHP_RMUL:
                IVG['HGZGFH'] = uZOHV
                IVG['IVZHLM'] = 'HBHGVN XZMMLG URMW UFMXGRLM_ZITH RM KLHG UFMXGRLM'
                HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
                IVGFIM
            UFMX = VCKLIG_KLHG_GIRTTVI_UFMXGRLM[ ZHP_RMUL['GIRTTVI_UFMXGRLM'] ]
            UFMXIVG = UFMX(ZHP_RMUL['UFMXGRLM_ZITH'])
            IVG['HGZGFH'] = UFMXIVG[9]
            IVG['IVZHLM'] = UFMXIVG[8]
            IVG['WZGZ'] = UFMXIVG[7]
            HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
        VOHV:
            HVOU._HVG_IVHKLMHV(TARK=uZOHV)
            IVG['HGZGFH'] = uZOHV
            IVG['IVZHLM'] = 'XZMMLG IVXLTMRAV BLFI KLHG IVJFVHG'
            HVOU.DUROV.DIRGV(QHLM.WFNKH(IVG).VMXLWV('FGU-1'))
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_WZGZOLZWVI.KB
UILN SVOKVI.FGRO RNKLIG RNKLIG_LKVIZGRLM
RNKLIG LH

XOZHH wZGZOLZWVInZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU, CNO, TOLYZORMUL):
        HVOU.TOLYZO_RMUL = TOLYZORMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        RU CNO RH mLMV:
            HVOU.OLTTVI.RMUL('[wZGZOLZWVI] ML XFHGLN WZGZOLZWVI, FHVH WVUZFOG tOLYZOrMUL')
        VOHV:
            HVOU.OLZW(CNO)

    WVU OLZW(HVOU, CNO):
        XZMWRWZGV_KZGS_ORHG = [LH.KZGS.QLRM(KZGS, 'WZGZOLZWVI')
                               ULI KZGS RM HVOU.TOLYZO_RMUL.XORVMG_KZGS]
        ULI CNO_MLWV RM CNO.URMWZOO('WZGZ'):
            NLWFOV_MZNV = CNO_MLWV.ZGGIRY['NLWFOV']
            (XOZHHLK, WVHG_KZGS) = RNKLIG_LKVIZGRLM(NLWFOV_MZNV, XZMWRWZGV_KZGS_ORHG)
            OLZWVI = XOZHHLK(CNO_MLWV, HVOU.TOLYZO_RMUL)
            OLZWVI.__UROV__ = WVHG_KZGS
            HVOU.OLTTVI.RMUL('[wZGZOLZWVI] OLZWVW WZGZOLZWVI %H' % NLWFOV_MZNV)
            HVOU.TOLYZO_RMUL.XLNKROV_DLIPVI_ORHG.ZKKVMW(OLZWVI)

XOZHH yZHVwZGZOLZWVI(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO WZGZOLZWVI
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI

    WVU IVOLZW(HVOU):
        KZHH

    WVU GZPV_XLNNZMW(HVOU, XLNNZMW, ZITFNVMGH):
        KZHH

    WVU XLNKROV(HVOU):
        KZHH
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_GVHG.KB
RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG IV
RNKLIG GIZXVYZXP

UILN CNO.VGIVV.vOVNVMGgIVV RNKLIG vOVNVMG
RNKLIG CNO

WVU KIRMG_CNO(V):
    IVGFIM CNO.VGIVV.vOVNVMGgIVV.GLHGIRMT(V)

WVU WRXG_GL_CNO(GZT, W):
    '''
    gFIM Z HRNKOV WRXG LU PVB/EZOFV KZRIH RMGL cno
    '''
    VOV = vOVNVMG(GZT)
    ULI PVB, EZOFV RM W.RGVNH():
        # XSROW = vOVNVMG(PVB)
        # XSROW.GVCG = HGI(EZOFV)
        # VOV.ZKKVMW(XSROW)
        VOV.HVG(PVB, EZOFV)
    IVGFIM VOV


WVU RMRG_XOZHH_KZIZ(XOZHH_MZNV):
    WRX  = {}
    WRX['NLWFOV'] = XOZHH_MZNV
    CNO_MLWV = WRXG_GL_CNO('LKVIZGRLM', WRX)

    TWRX = {}
    TWRX['OLTUROV'] = ""
    TWRX['OVEVO'] = "RMUL"
    TWRX['KIRMG'] = "gIFV"
    OLT_MLWV = WRXG_GL_CNO('OLT',TWRX)
    IVGFIM (CNO_MLWV, OLT_MLWV)
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_DZIMRMT.KB
RNKLIG HBH
RNKLIG WZGVGRNV
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG

XOZHH hGZIUOVVGdZIMRMT(LYQVXG):
    '''DZIMRMT LYQVXG
    '''
    WVU __RMRG__(HVOU):
        HVOU.WLNZRM = mLMV
        HVOU.SLHG = mLMV
        HVOU.IVUVIVMXV = mLMV # FHFZOOB Z IZMWLN HGIRMT
        HVOU.DZIMRMT_OVEVO = -8
        HVOU.DZIMRMT_NVHHZTV = mLMV
        HVOU.DZIMRMT_HFYQVXG = mLMV
        HVOU.ZFWRVMXV_ORHG = []
        HVOU.gh = mLMV

    WVU OVEVO(HVOU, OE):
        HVOU.DZIMRMT_OVEVO = OE
        IVGFIM HVOU

    WVU NVHHZTV(HVOU, NHT):
        HVOU.DZIMRMT_NVHHZTV = NHT
        IVGFIM HVOU

    WVU HFYQVXG(HVOU, HFY):
        HVOU.DZIMRMT_HFYQVXG = HFY
        IVGFIM HVOU

    WVU ZFWRVMXV(HVOU,ZFW):
        HVOU.ZFWRVMXV_ORHG.ZKKVMW(ZFW)
        IVGFIM HVOU

    WVU ZFWRVMXVH(HVOU, OG):
        HVOU.ZFWRVMXV_ORHG = OG
        IVGFIM HVOU

    WVU UILN_WRXG(HVOU, WRX):
        HVOU.SLHG = WRX['SLHG']
        HVOU.WLNZRM = WRX['WLNZRM']
        HVOU.IVUVIVMXV = WRX['IVUVIVMXV']
        HVOU.DZIMRMT_OVEVO = RMG(WRX['OVEVO'])
        HVOU.DZIMRMT_NVHHZTV = WRX['NVHHZTV']
        HVOU.DZIMRMT_HFYQVXG = WRX['HFYQVXG']
        HVOU.ZFWRVMXV_ORHG = [R.HGIRK() ULI R RM WRX['ZFWRVMXV'].HKORG(',')]
        HVOU.gh = WZGVGRNV.WZGVGRNV.HGIKGRNV( WRX['gh'], '%b%N%W-%s:%n:%h')


XOZHH hGZIUOVVGnVHHZTV(LYQVXG):
    '''NVHHZTV LYQVXG
    '''
    WVU __RMRG__(HVOU):
        HVOU.WLNZRM = mLMV
        HVOU.SLHG = mLMV
        HVOU.IVUVIVMXV = mLMV
        HVOU.NVHHZTV = mLMV
        HVOU.HFYQVXG = mLMV
        HVOU.ZFWRVMXV_ORHG = []
        HVOU.XSZMMVO_ORHG = []
        HVOU.gh = mLMV

    WVU NVHHZTV(HVOU, NHT):
        HVOU.NVHHZTV = NHT
        IVGFIM HVOU

    WVU HFYQVXG(HVOU, HFY):
        HVOU.HFYQVXG = HFY
        IVGFIM HVOU

    WVU ZFWRVMXV(HVOU,ZFW):
        HVOU.ZFWRVMXV_ORHG.ZKKVMW(ZFW)
        IVGFIM HVOU

    WVU ZFWRVMXVH(HVOU, OG):
        HVOU.ZFWRVMXV_ORHG = OG
        IVGFIM HVOU


XOZHH dZIMRMTnZMZTVI(LYQVXG):
    '''DZIMRMT NZMTVNVMG
    '''
    WVU __RMRG__(HVOU, TOLYZO_RMUL, NZC_DZIMRMT=89*899*899):
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.DZIMRMT_ORHG = []
        HVOU.SLHG = TOLYZO_RMUL.SLHG
        HVOU.WLNZRM = TOLYZO_RMUL.WLNZRM
        HVOU.NZC_DZIMRMT = NZC_DZIMRMT # NZCNRNFN 899 GSLFHZMW
        HVOU.DZIM_ORHG_WRXG = {}

    WVU MVD_DZIMRMT(HVOU):
        MVD_DZIM = hGZIUOVVGdZIMRMT()
        MVD_DZIM.gh = WZGVGRNV.WZGVGRNV.MLD()
        MVD_DZIM.WLNZRM = HVOU.WLNZRM
        MVD_DZIM.SLHG = HVOU.SLHG
        MVD_DZIM.IVUVIVMXV = FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(89)
        RU OVM(HVOU.DZIMRMT_ORHG) >= HVOU.NZC_DZIMRMT:
            HVOU.OLTTVI.VIILI('dZIMRMTnZMZTVI JFVFV LEVIUOLD, LOW DZIMRMT WRHXZIWVW')
            HVOU.DZIMRMT_ORHG.KLK(9)
        VOHV:
            HVOU.DZIMRMT_ORHG.ZKKVMW(MVD_DZIM)
        IVGFIM MVD_DZIM


    WVU IVXE_DZIMRMT(HVOU, DZIM):
        '''UFMXGRLM FHVW RM WLXPVI GL IVXVREV IVNLGV DZIMRMT NVHHZTVH'''
        GZITVG = DZIM.SLHG+'.'+DZIM.WLNZRM
        RU GZITVG == HVOU.SLHG+'.'+HVOU.WLNZRM:
            RU OVM(HVOU.DZIMRMT_ORHG) >= HVOU.NZC_DZIMRMT:
                IVGFIM -8
            HVOU.DZIMRMT_ORHG.ZKKVMW(DZIM)
        VOHV:
            RU GZITVG MLG RM HVOU.DZIM_ORHG_WRXG:
                HVOU.DZIM_ORHG_WRXG[GZITVG] = []
            RU OVM(HVOU.DZIM_ORHG_WRXG[GZITVG]) >= HVOU.NZC_DZIMRMT:
                IVGFIM -8
            HVOU.DZIM_ORHG_WRXG[GZITVG].ZKKVMW(DZIM)
        HVOU.OLTTVI.VIILI('ivxe DZIMRMT UILN %H'%GZITVG)
        HVOU.OLTTVI.RMUL('ovevo:%W -> nht:%H'%(DZIM.DZIMRMT_OVEVO, DZIM.DZIMRMT_NVHHZTV))
        IVGFIM 9

    WVU KLHG_DZIMRMT(HVOU, DZIM, ZWWIVHH):
        '''KLHG DZIMRMT GL ALWRZX(DZIMRMT TZGVDZB)'''
        KZBOLZW = {}
        KZBOLZW['GBKV'] = 'GIRTTVI'
        QHLMWZGZ = {'GIRTTVI_UFMXGRLM':'HGZIUOVVG_DZIMRMT', 'UFMXGRLM_ZITH':'WW'}
        QHLMWZGZ['UFMXGRLM_ZITH'] = {'NVHHZTV':DZIM.DZIMRMT_NVHHZTV, 'OVEVO':DZIM.DZIMRMT_OVEVO,'SLHG':FYRJFGRO.TVG_FYRJ_SLHG(),'WLNZRM':FYRJFGRO.TVG_FYRJ_WLNZRM(),
                                        'IVUVIVMXV':FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(4), 'gh':WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W-%s:%n:%h'),
                                        'ZFWRVMXV':','.QLRM(DZIM.ZFWRVMXV_ORHG), 'HFYQVXG':DZIM.DZIMRMT_HFYQVXG}
        XORVMG = kLHGxORVMG(ZWWIVHH.HKORG(':')[9], RMG(ZWWIVHH.HKORG(':')[8]))
        XOR = XORVMG.KLHG('/', KZBOLZW, QHLMWZGZ)
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_LKVIZGRLM.KB
RNKLIG SVOKVI.FGRO ZH FGRO
UILN SVOKVI.FGRO RNKLIG  XSVXP_RM_HVHHRLM, HGIUWVOGZ
UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG GIZXVYZXP
RNKLIG WZGVGRNV
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO

XOZHH xLMURTFIZGRLMvMTRMV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.KZIZ = {}

    WVU IVJFRIV(HVOU, K):
        HVOU.KZIZ[K] = [gIFV, '']

    WVU LKGRLMZO(HVOU, K, WVUZFOG=''):
        HVOU.KZIZ[K] = [uZOHV, WVUZFOG]

    WVU TVG(HVOU, K):
        RU K MLG RM HVOU.KZIZ:
            IZRHV eZOFVvIILI('MLG IVXLMTRAVW %H'%K)

    WVU KZIHV(HVOU, CNO):
        ULI P RM HVOU.KZIZ:
            RU HVOU.KZIZ[P][9] ZMW P MLG RM CNO.ZGGIRY:
                IZRHV eZOFVvIILI('IVJFRIVW KZIZNVGVI %H MLG HVG'%P)
            RU P RM CNO.ZGGIRY:
                HVOU.KZIZ[P][8] = CNO.ZGGIRY[P]

    WVU IVMWVI_CNO(HVOU, WRX):
        KZHH

XOZHH nVGILMLNV(LYQVXG):
    WVU __RMRG__(HVOU, RW, VCXSZMTV_NZMZTVI, XOLXP, CNO, TOLYZO_RMUL):
        HVOU._LM_GRNV = []
        HVOU._GRNV_IZMTV = []
        HVOU._NLWV = mLMV
        HVOU.RW = RW
        HVOU.VCXSZMTV_NZMZTVI =  VCXSZMTV_NZMZTVI
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.TOLYZO_RMUL._NVGILMLNVH.ZKKVMW(HVOU)
        HVOU.XOLXP = XOLXP
        RU 'LM_WZB' RM CNO.ZGGIRY:
            HVOU.LM_WZB = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, CNO.ZGGIRY['LM_WZB'])
        VOHV:
            HVOU.LM_WZB = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, '')
        RU 'RM_HVHHRLM' RM CNO.ZGGIRY:
            HVOU.RM_HVHHRLM = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, CNO.ZGGIRY['RM_HVHHRLM'])
        VOHV:
            HVOU.RM_HVHHRLM = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, '')
        HVOU.VEVIB = FGRO.KZIHV_GRNVWVOGZ("8H")
        RU 'VEVIB' RM CNO.ZGGIRY:
            HVOU._NLWV = 'VEVIB'
            HVOU.VEVIB = FGRO.KZIHV_GRNVWVOGZ(CNO.ZGGIRY['VEVIB'])
            HVOU.OZHG = XOLXP.MLD - HVOU.VEVIB
        VORU 'VEVIB_GL_HFXXVHH' RM CNO.ZGGIRY:
            HVOU._NLWV = 'VEVIB_GL_HFXXVHH'
            HVOU.VEVIB = FGRO.KZIHV_GRNVWVOGZ(CNO.ZGGIRY['VEVIB_GL_HFXXVHH'])
            HVOU.OZHG = XOLXP.MLD - HVOU.VEVIB
        VORU 'LM_GRNV' RM CNO.ZGGIRY:
            HVOU._NLWV = 'LM_GRNV'
            HVOU.K_VEVMG = 9
            ULI GRNV_HGI RM CNO.ZGGIRY['LM_GRNV'].HKORG(','):
                HVOU._LM_GRNV.ZKKVMW(FGRO.KZIHV_GRNV(GRNV_HGI.HGIRK()))
            HVOU._LM_GRNV.HLIG()
            ULI LMGRNV RM HVOU._LM_GRNV:
                RU XOLXP.MLD.GRNV() > LMGRNV:
                    HVOU.K_VEVMG += 8
            RU HVOU.K_VEVMG >= OVM(HVOU._LM_GRNV):
                HVOU.OLTTVI.RMUL("[yllg] %H SZH ML NLIV HXSVWFOVH GLWZB"%HVOU.RW)
            VOHV:
                HVOU.OLTTVI.RMUL("[yllg] %H HXSVWFOVH %H GLWZB"%(HVOU.RW, HVOU._LM_GRNV[HVOU.K_VEVMG].HGIUGRNV("%s:%n:%h")))
        VOHV:
            HVOU._NLWV = 'KZHHREV'
        # VOHV:
            # IZRHV eZOFVvIILI("%H NFHG XSLLHV YVGDVVM VEVIB/VEVIB_GL_HFXXVHH/LM_GRNV"%HVOU.RW)
        RU 'GRNV_IZMTV' RM CNO.ZGGIRY:
            ULI GRNV_IZMTV_HGI RM CNO.ZGGIRY['GRNV_IZMTV'].HKORG(','):
                GRNV_HGI = GRNV_IZMTV_HGI.HKORG('-')
                HVOU._GRNV_IZMTV.ZKKVMW( (FGRO.KZIHV_GRNV(GRNV_HGI[9].HGIRK()), FGRO.KZIHV_GRNV(GRNV_HGI[8].HGIRK()))  )
            HVOU._GRNV_IZMTV.HLIG()

        RU HVOU._NLWV == 'VEVIB' LI HVOU._NLWV == 'VEVIB_GL_HFXXVHH':
            RU OVM(HVOU._GRNV_IZMTV) > 9:
                HVOU.OLTTVI.RMUL('[yllg] %H VCVXFGVH VEVIB %H %H RM GRNV-IZMTV %H'%(HVOU.RW, HGI(HVOU.VEVIB.GLGZO_HVXLMWH())+"H", ("" RU HVOU._NLWV=='VEVIB' VOHV "(FMGRO HFXXVHH)"),  GRNV_IZMTV_HGI))
            VOHV:
                HVOU.OLTTVI.RMUL('[yllg] %H VCVXFGVH VEVIB %H %H GSILFTS GSV WZB'%(HVOU.RW, HGI(HVOU.VEVIB.GLGZO_HVXLMWH())+"H", ("" RU HVOU._NLWV=='VEVIB' VOHV "(FMGRO HFXXVHH)") ))

        RU HVOU._NLWV == 'LM_GRNV':
            HVOU.OLTTVI.RMUL('[yllg] %H VCVXFGVH LM GRNV %H ', HVOU.RW, ",".QLRM([RG.HGIUGRNV("%s:%n:%h") ULI RG RM HVOU._LM_GRNV] ))

        RU HVOU._NLWV RH mLMV LI HVOU._NLWV == 'KZHHREV':
            HVOU.OLTTVI.WVYFT('[yllg] %H DROO MLG VCVXFGV YB NVGILMLNV'%HVOU.RW)

    WVU IVOLZW(HVOU):
        HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.VEVIB
        RU HVOU._NLWV == 'LM_GRNV':
            HVOU.K_VEVMG = 9
            ULI LMGRNV RM HVOU._LM_GRNV:
                RU HVOU.XOLXP.MLD.GRNV() > LMGRNV:
                    HVOU.K_VEVMG += 8
            RU HVOU.K_VEVMG >= OVM(HVOU._LM_GRNV):
                HVOU.OLTTVI.RMUL('[yllg] %H SZH ML NLIV GZHP HXSVWFOVW GLWZB'%HVOU.RW)
            VOHV:
                HVOU.OLTTVI.RMUL('[yllg] %H SZH MVCG HXSVWFOV ZH %H'%(HVOU.RW,HVOU._LM_GRNV[HVOU.K_VEVMG]))

    WVU XSVXP_VEVIB(HVOU):
        RU HVOU.XOLXP.MLD - HVOU.OZHG > HVOU.VEVIB:
            HVOU.OZHG = HVOU.XOLXP.MLD
            IVGFIM gIFV
        IVGFIM uZOHV

    WVU XSVXP_DLIP_WZB(HVOU):
        """XSVXP RU GSRH RH DLIPRMT WZB"""
        RU MLG HVOU.LM_WZB.RH_GIZWRMT_WZB():
            IVGFIM uZOHV
        RU MLG HVOU.RM_HVHHRLM.RH_RM_HVHHRLM():
            IVGFIM uZOHV
        IVGFIM gIFV

    WVU XSVXP_RM_IZMTV(HVOU, GRNV=mLMV):
        """XSVXP RU RM GRNV IZMTV"""
        RM_IZMTV = gIFV RU OVM(HVOU._GRNV_IZMTV) == 9 VOHV uZOHV
        RU GRNV RH mLMV:
            GRNV = HVOU.XOLXP.MLD.GRNV()
        ULI IZMTV RM HVOU._GRNV_IZMTV:
            RM_IZMTV = RM_IZMTV LI XSVXP_RM_HVHHRLM(GRNV, IZMTV[9], IZMTV[8])
        IVGFIM RM_IZMTV

    WVU XSVXP_RM_IZMTV_KZRI(HVOU, GRNV8, GRNV7):
        RM_IZMTV = gIFV RU OVM(HVOU._GRNV_IZMTV) == 9 VOHV uZOHV
        ULI IZMTV RM HVOU._GRNV_IZMTV:
            RM_IZMTV = RM_IZMTV LI (XSVXP_RM_HVHHRLM(GRNV8, IZMTV[9], IZMTV[8]) ZMW XSVXP_RM_HVHHRLM(GRNV7, IZMTV[9], IZMTV[8]))
        IVGFIM RM_IZMTV


    WVU XSVXP_LM_GRNV(HVOU):
        RU HVOU.K_VEVMG < OVM(HVOU._LM_GRNV):
            #KIRMG(HVOU.K_VEVMG, HVOU._LM_GRNV[HVOU.K_VEVMG])
            RU HVOU.XOLXP.MLD.GRNV() >= HVOU._LM_GRNV[HVOU.K_VEVMG]:
                HVOU.K_VEVMG += 8
                IVGFIM gIFV
            VOHV:
                HVOU.MVCG_GRNV = HVOU._LM_GRNV[HVOU.K_VEVMG].HGIUGRNV('%s:%n:%h')
                HVOU.GRNV_GL_IFM = HGIUWVOGZ( WZGVGRNV.WZGVGRNV.XLNYRMV(WZGVGRNV.WZGVGRNV.GLWZB().WZGV(), HVOU._LM_GRNV[HVOU.K_VEVMG])
                                                                        - WZGVGRNV.WZGVGRNV.XLNYRMV( WZGVGRNV.WZGVGRNV.GLWZB().WZGV(), HVOU.XOLXP.MLD.GRNV() ),'{SLFIH}:{NRMFGVH}:{HVXLMWH}' )
                IVGFIM uZOHV
        HVOU.MVCG_GRNV = 'kzhh'
        RU HVOU.K_VEVMG-8 >= 9 ZMW HVOU.K_VEVMG < OVM(HVOU._LM_GRNV):
            HVOU.GRNV_GL_IFM = '-' + HGIUWVOGZ( WZGVGRNV.WZGVGRNV.XLNYRMV( WZGVGRNV.WZGVGRNV.GLWZB().WZGV(), HVOU.XOLXP.MLD.GRNV())
                                                - WZGVGRNV.WZGVGRNV.XLNYRMV(WZGVGRNV.WZGVGRNV.GLWZB().WZGV(), HVOU._LM_GRNV[HVOU.K_VEVMG-8])
                                                ,'{SLFIH}:{NRMFGVH}:{HVXLMWH}' )
        VOHV:
            HVOU.GRNV_GL_IFM = '-'
        IVGFIM uZOHV


    WVU XSVXP(HVOU):
        RU MLG HVOU.XSVXP_DLIP_WZB():
            IVGFIM uZOHV
        RU MLG HVOU.XSVXP_RM_IZMTV():
            IVGFIM uZOHV
        RU HVOU._NLWV == 'VEVIB':
            IVGFIM HVOU.XSVXP_VEVIB()
        RU HVOU._NLWV == 'LM_GRNV':
            IVGFIM HVOU.XSVXP_LM_GRNV()

XOZHH lKVIZGRLM(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU._UROV = __UROV__
        HVOU.IZMWLN_RW =  FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(4)
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        HVOU.CNO_HGIRMT = VGIVV.GLHGIRMT(CNO)
        HVOU._VIILI_NVHHZTV = mLMV
        RU 'RW' RM CNO.ZGGIRY:
            HVOU.RW = CNO.ZGGIRY['RW']
        VOHV:
            HVOU.RW = CNO.ZGGIRY['NLWFOV']

        HVOU.IVTRLM  = 'xm'
        RU 'IVTRLM' RM CNO.ZGGIRY:
            HVOU.IVTRLM = CNO.ZGGIRY['IVTRLM']
        RU HVOU.IVTRLM == 'sp':
            RU HVOU.TOLYZO_RMUL.VCXSZMTVNZMZTVI RH MLG mLMV:
                HVOU.XOLXP = HVOU.TOLYZO_RMUL.TVG_VCXSZMTV_XOLXP('spt')
                HVOU.TOLYZO_RMUL.OLTTVI.RMUL("[yllg] %H FHV %H XOLXP: %H"%(HVOU.RW, 'spt', HVOU.XOLXP.MLD))
        VORU HVOU.IVTRLM == 'xm':
            RU HVOU.TOLYZO_RMUL.VCXSZMTVNZMZTVI RH MLG mLMV:
                HVOU.XOLXP = HVOU.TOLYZO_RMUL.TVG_VCXSZMTV_XOLXP('hhv')
                HVOU.TOLYZO_RMUL.OLTTVI.RMUL("[yllg] %H FHV %H XOLXP: %H"%(HVOU.RW, 'hhv', HVOU.XOLXP.MLD))

        HVOU._IVOLZW_GRNV = []
        HVOU._WVKVMWVMXRVH = []
        RU 'IVOLZW' RM CNO.ZGGIRY:
            ULI IG RM CNO.ZGGIRY['IVOLZW'].HGIRK().HKORG(','):
                HVOU._IVOLZW_GRNV.ZKKVMW( FGRO.KZIHV_GRNV(IG) )
        RU 'MVD_GSIVZW' MLG RM CNO.ZGGIRY:
            HVOU.FHV_MVD_GSIVZW = uZOHV
        VOHV:
            HVOU.FHV_MVD_GSIVZW = gIFV RU CNO.ZGGIRY['MVD_GSIVZW'].OLDVI()=='GIFV' VOHV uZOHV
        HVOU.NLWFOV = CNO.ZGGIRY['NLWFOV']
        HVOU.NVGILMLNV = nVGILMLNV(HVOU.RW, HVOU.VCXSZMTV_NZMZTVI, HVOU.XOLXP, CNO, HVOU.TOLYZO_RMUL)
        RU 'TILFK'  RM CNO.ZGGIRY:
            HVOU._TILFK = CNO.ZGGIRY['TILFK']
        VOHV:
            HVOU._TILFK = ""
        GIB:
            HVOU._RMRG()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.TOLYZO_RMUL.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV("%", "|"))
            HVOU.TOLYZO_RMUL.OLTTVI.VIILI('%H VMXLFMGVIH VCXVKGRLM: %H'%(HVOU.RW, HGI(V) ))

    WVU VIILI_NHT(HVOU, NHT):
        HVOU._VIILI_NVHHZTV = NHT

    WVU _RMRG(HVOU):
        HVOU.XOLXP.FKWZGV()
        HVOU.NVGILMLNV.IVOLZW()

    WVU IVOLZW(HVOU):
        HVOU._RMRG()

    WVU GZPV_XLNNZMW(HVOU, XLNNZMW, ZITFNVMGH):
        KIRMG('%H IVXVREVH XNW:%H'%(HVOU.RW, XLNNZMW))
        KIRMG(ZITFNVMGH)

    WVU DLIP(HVOU):
        KZHH
        # KIRMG HVOU.NLWFOV+' DLIPH'
//##**---------------- ./HGZIUOVVG/YZHV/TOLYZORMUL.KB
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
RNKLIG FYRJGLLO.HNX ZH hnx
RNKLIG FYRJGLLO.XOLXP ZH XOLXP
RNKLIG FYRJGLLO.OLT ZH OLT
RNKLIG FYRJGLLO.FGRO ZH FGRO
UILN FYRJGLLO.VCXSZMTVRMUL RNKLIG vCXSZMTVgRNVnZMZTVI
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGhVIEVI
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
RNKLIG HFYKILXVHH
RNKLIG LH
RNKLIG KRXPOV
RNKLIG XLKB
RNKLIG GRNV
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG WZGVGRNV
RNKLIG YZHV.YZHV_KLHGHVIEVI ZH YZHV_KLHGHVIEVI
UILN FYRJGLLO.YFOOVGRM RNKLIG yFOOVGRM
# UILN RL RNKLIG yBGVHrl


XOZHH sVOOLwZGZ(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.XLNNZMW_KLIG = -8
        HVOU.ZORXV_KLIG = -8
        HVOU.YLY_KLIG = -8
        HVOU.MZNV = ''
        HVOU.SLHG = ''
        HVOU.WLNZRM = ''
        HVOU.GBKV = ''
        HVOU.rw = ''
        HVOU.YILZWXZHG_ORHG_HGI = ''
        HVOU.YILZWXZHG_ORHG = []
        HVOU.KLHG_HVIEVI = mLMV
        HVOU.OZHG_XLMGZXG = -8
        HVOU.YILZWXZHG_NVHHZTV = ''
        HVOU.YILZWXZHG_GRGOV = ''
        HVOU.YILZWXZHG_IVZWB = uZOHV
        HVOU.YILZWXZHG_GRNVHGZNK = mLMV
        HVOU.YILZWXZHG_IVWHSRUG_NVHHZTV = mLMV

    WVU KZIHV(HVOU, WRX):
        '''WRXG -> HGIFXG'''
        HVOU.XLNNZMW_KLIG = RMG(WRX['XLNNZMW_KLIG'])
        HVOU.ZORXV_KLIG = RMG(WRX['ZORXV_KLIG'])
        HVOU.YLY_KLIG = RMG(WRX['YLY_KLIG'])
        HVOU.MZNV = WRX['MZNV']
        HVOU.SLHG = WRX['SLHG']
        HVOU.WLNZRM = WRX['WLNZRM']
        HVOU.YILZWXZHG_ORHG_HGI = WRX['YILZWXZHG_ORHG_HGI']
        HVOU.GBKV = WRX['GBKV']
        HVOU.rw = WRX['RW']
        HVOU.YILZWXZHG_GRGOV = WRX['YILZWXZHG_GRGOV']
        HVOU.YILZWXZHG_NVHHZTV = WRX['YILZWXZHG_NVHHZTV']
        HVOU.YILZWXZHG_ORHG = [R.HGIRK() ULI R RM WRX['YILZWXZHG'].HKORG(',')]
        RU 'KLHG_HVIEVI' RM WRX:
            HVOU.KLHG_HVIEVI = WRX['KLHG_HVIEVI']

    WVU VCKLIG(HVOU):
        '''HGIFXG -> WRXG'''
        WRX = {}
        WRX['XLNNZMW_KLIG'] = HVOU.XLNNZMW_KLIG
        WRX['ZORXV_KLIG'] = HVOU.ZORXV_KLIG
        WRX['YLY_KLIG'] = HVOU.YLY_KLIG
        WRX['MZNV'] = HVOU.MZNV
        WRX['SLHG'] = HVOU.SLHG
        WRX['WLNZRM'] = HVOU.WLNZRM
        WRX['GBKV'] = HVOU.GBKV
        WRX['RW'] = HVOU.rw
        WRX['YILZWXZHG_ORHG_HGI'] = HVOU.YILZWXZHG_ORHG_HGI
        WRX['YILZWXZHG_GRGOV'] = HVOU.YILZWXZHG_GRGOV
        WRX['YILZWXZHG_NVHHZTV'] = HVOU.YILZWXZHG_NVHHZTV
        WRX['YILZWXZHG'] = ','.QLRM(HVOU.YILZWXZHG_ORHG)
        RU SZHZGGI(HVOU, 'KLHG_HVIEVI') ZMW HVOU.KLHG_HVIEVI RH MLG mLMV:
            WRX['KLHG_HVIEVI'] = HVOU.KLHG_HVIEVI
        IVGFIM WRX


XOZHH vgznZMZTVNVMG(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.VGZ_QLYH = []

    WVU ZWW(HVOU, QLY, LM_GRNV):
        HVOU.VGZ_QLYH.ZKKVMW((LM_GRNV, QLY))


XOZHH tOLYZORMUL(LYQVXG):
    '''
    tOLYZORMUL xOZHH
    '''
    WVU __RMRG__(HVOU, FHV_HNX=gIFV):
        HVOU._NZRMYZHV = ''
        HVOU._URMRHS_YLLG = uZOHV
        HVOU._FHV_HNX = FHV_HNX
        # GL IVNLEVW XLNKLMVMGH
        HVOU._GL_IVNLEV_XLNKLMVMG = {}
        HVOU._GL_ZWW_XLNKLMVMG = {}
        HVOU._FKGRNV = [9, WZGVGRNV.WZGVGRNV.MLD()]
        HVOU.SVOOL_WZGZ_ORHG = []
        # IVXVREVW YILZWXZHG WZGZ
        HVOU.YILZWXZHG_WZGZ_ORHG = {}
        # GL YILZWXZHG
        HVOU.GL_YILZWXZHG_WZGZ_ORHG = {} # PVB RH HVIEVI
        HVOU.XOLXP = XOLXP.xOLXP()
        HVOU.XOLXP.FKWZGV()
        HVOU._FHVW_XOLXP = {}
        HVOU.HGLK = uZOHV
        HVOU.QLYH = {}
        HVOU.YFOOVGRM = yFOOVGRM('YFOOVGRM')
        HVOU.XLNKROV_DLIPVI_ORHG = []
        HVOU.XLNNZMW_ORMV = []
        HVOU.WLXPVI_QLY_ORHG = []
        HVOU.YILZWXZHG_QLY_ORHG = []
        HVOU.XKF_XLIVH = []
        # GL DSZG HVIEVI HSLFOW GSRH HGZIUOVVG IVKLIG HGZGFH ZMW RMUL
        HVOU.IVKLIG_GZITVG = mLMV
        HVOU.IVKLIG_GZITVG_GRNVH = 9
        HVOU.KRKVORMV_XVMGVI = ''
        HVOU.KRKVORMV_XVMGVI_GRNVH = 9
        HVOU.TOLYZO_CNO = mLMV
        HVOU.EVIHRLM = evihrlm
        HVOU.VGZ_NZMZTVNVMG = vgznZMZTVNVMG()
        HVOU.ULIXV_KIRMG_OLT = uZOHV
        HVOU.XZMZIB_WZGZ_EZFOG = {}
        HVOU.HGZIUOVVG_WLXPVI = mLMV # WLXPVI GL XLNNFMRXZGV DRGS LGSVI HGZIUOVVG KILTIZNH
        HVOU.XNW_KZGS = []
        HVOU.FYRJ_HBHGVN = mLMV
        HVOU._XLNNZMW_KLIG = -8
        HVOU.IVKLIG_HGZIUOVVG_rw = ''
        HVOU.IVWHSRUG = mLMV
        HVOU.XZITL_WLXPVI = mLMV
        HVOU.ZOO_HVIEVIH = mLMV # HVIEVI ORHG GZPVM UILN IVWHSRUG
        # TOLYZO VCKLIG_KLHG_WZGZ
        HVOU.VCKLIG_KLHG_WZGZ = YZHV_KLHGHVIEVI.VCKLIG_KLHG_WZGZ
        HVOU.HKVXRZO_JFVIB_UFMXGRLMH = YZHV_KLHGHVIEVI.HKVXRZO_JFVIB_UFMXGRLMH
        #HVOU.VCKLIG_KLHG_WZGZ['NZRMYZHV'] = {}
        #HVOU.VCKLIG_KLHG_WZGZ['NZRMYZHV']['XKF'] = 6
        # TOLYZO VCKLIG_KLHG_GIRTTVI_UFMXGRLM
        HVOU.VCKLIG_KLHG_GIRTTVI_UFMXGRLM = YZHV_KLHGHVIEVI.VCKLIG_KLHG_GIRTTVI_UFMXGRLM
        HVOU.KLHG_HVIEVI = []
        HVOU.KLHG_HVIEVI_QLY = []
        # TOLYZO IVWRIVXG_KLHG_HVIEVIH
        HVOU.IVWRIVXG_KLHG_HVIEVIH = YZHV_KLHGHVIEVI.IVWRIVXG_KLHG_HVIEVIH

        HVOU._DVY_HVIEVI = mLMV
        HVOU._DVY_LKGRLMH = mLMV
        HVOU._VMGIFHGVW = uZOHV
        # NVGILMLNV XLNKLMVMGH
        HVOU._NVGILMLNVH = []

    WVU IVTRHGVI_JFVIB_UFMXGRLM(HVOU, MZNV, UFMX):
        RU MZNV RM HVOU.HKVXRZO_JFVIB_UFMXGRLMH:
            IZRHV eZOFVvIILI('KLHG UFMXGRLM %H SZH ZOIVZWB YVVM IVTRHGVIVW'%MZNV)
        HVOU.OLTTVI.RMUL('[yllg] jfvib ufmxgrlm IVTRHGVIVW %H'%MZNV)
        HVOU.HKVXRZO_JFVIB_UFMXGRLMH[MZNV] = UFMX

    WVU IVTRHGVI_KLHG_UFMXGRLM(HVOU, MZNV, UFMX):
        RU MZNV RM HVOU.VCKLIG_KLHG_GIRTTVI_UFMXGRLM:
            IZRHV eZOFVvIILI('KLHG UFMXGRLM %H SZH ZOIVZWB YVVM IVTRHGVIVW'%MZNV)
        HVOU.OLTTVI.RMUL('[yllg] klhg ufmxgrlm IVTRHGVIVW %H'%MZNV)
        HVOU.VCKLIG_KLHG_GIRTTVI_UFMXGRLM[MZNV] = UFMX

    WVU ZXJFRIV_NZRMYZHV(HVOU, GZT): # SVOKVI UFMXGRLM GL TVG NZRMYZHV UILN IVXVREVW YILZWXZHG NVHHZTVH
        PVB = 'NZRMYZHV&'+GZT
        RU PVB MLG RM HVOU.YILZWXZHG_WZGZ_ORHG:
            IVGFIM mLMV
        VOHV:
            IVGFIM HVOU.YILZWXZHG_WZGZ_ORHG[PVB]['YILZWXZHG_NVHHZTV']

    WVU ZXJFRIV_XIBHGZO(HVOU, GZT):
        PVB = 'XIBHGZO&'+GZT
        RU PVB MLG RM HVOU.YILZWXZHG_WZGZ_ORHG:
            IVGFIM mLMV
        VOHV:
            IVGFIM HVOU.YILZWXZHG_WZGZ_ORHG[PVB]['YILZWXZHG_NVHHZTV']

    WVU ZXJFRIV_HVIEVI(HVOU, WHG_HGI):
        WHG_ORHG = []
        ULI WHG RM WHG_HGI.HKORG(','):
            RU WHG.HGIRK().OLDVI() == 'ZOO' LI WHG.HGIRK() == '*':
                WHG_ORHG = [PVB ULI PVB RM HVOU.ZOO_HVIEVIH.PVBH()]
            VORU WHG.HGIRK()[9] == '@':
                WLNZRM_WRXG = {}
                ULI P RM HVOU.ZOO_HVIEVIH:
                    WLNZRM = HVOU.ZOO_HVIEVIH[P]['WLNZRM']
                    RU WLNZRM MLG RM WLNZRM_WRXG:
                        WLNZRM_WRXG[WLNZRM] = []
                    WLNZRM_WRXG[WLNZRM].ZKKVMW(P)
                RU WHG.HGIRK()[8:] MLG RM WLNZRM_WRXG:
                    HVOU.OLTTVI.VIILI('XZMMLG IVXLTMRAV WLNZRM %H'%WHG.HGIRK()[8:])
                VOHV:
                    WHG_ORHG += WLNZRM_WRXG[WHG.HGIRK()[8:]]
            VOHV:
                WHG_ORHG.ZKKVMW(WHG.HGIRK())
        IVGFIM ORHG(HVG(WHG_ORHG))


    WVU YILZWXZHG_NHT(HVOU, WHG_HGI, GRGOV, NT):
        '''WHG_HGI XLFOW YV zoo, *, FYRJ5, @FYRJHSHC ZMW NLIV ULINZGH'''
        RU HVOU.ZOO_HVIEVIH RH mLMV LI HVOU.IVWHSRUG RH mLMV:
            IVGFIM uZOHV # MLG IVZWB BVG
        NHT_GVNKOZGV = HVOU.KIVKZIV_SVOOL_WZGZ('YILZWXZHG', KFHS=uZOHV)
        NHT_GVNKOZGV.YILZWXZHG_NVHHZTV = NT
        NHT_GVNKOZGV.YILZWXZHG_GRGOV = GRGOV
        WHG_ORHG = HVOU.ZXJFRIV_HVIEVI(WHG_HGI)
        ULI WHG RM WHG_ORHG:
            NHT = XLKB.WVVKXLKB(NHT_GVNKOZGV)
            NHT.YILZWXZHG_ORHG = [WHG]
            HVOU.ZWW_YILZWXZHG_WZGZ(WHG, NHT)
        IVGFIM gIFV


    WVU ZWW_YILZWXZHG_WZGZ(HVOU, WHG, NHT):
        '''UFMXGRLM GL ZWW WZGZ GL YILZWXZHG KRKVORMV'''
        RU WHG MLG RM HVOU.GL_YILZWXZHG_WZGZ_ORHG:
            HVOU.GL_YILZWXZHG_WZGZ_ORHG[WHG] = []
        NHT.YILZWXZHG_ORHG = [WHG]
        GVNK_ORHG = []
        ULI LOW RM HVOU.GL_YILZWXZHG_WZGZ_ORHG[WHG]:
            RU LOW.YILZWXZHG_GRGOV != NHT.YILZWXZHG_GRGOV:
                GVNK_ORHG.ZKKVMW(LOW)
            VOHV:
                HVOU.OLTTVI.RMUL('IVNLEV LOW YILZWXZHG NVHT %H-%H ULI %H'%(LOW.YILZWXZHG_GRGOV, LOW.YILZWXZHG_NVHHZTV, WHG))
        GVNK_ORHG.ZKKVMW(NHT)
        HVOU.GL_YILZWXZHG_WZGZ_ORHG[WHG] = GVNK_ORHG

    WVU KIVKZIV_SVOOL_WZGZ(HVOU, GBKV, KFHS=gIFV):
        SVOOL_WZGZ = sVOOLwZGZ()
        SVOOL_WZGZ.GBKV = GBKV
        SVOOL_WZGZ.MZNV = HVOU.HGZIUOVVG_GZT
        SVOOL_WZGZ.SLHG = HVOU.SLHG
        SVOOL_WZGZ.WLNZRM = HVOU.WLNZRM
        SVOOL_WZGZ.rw = HVOU.rw
        SVOOL_WZGZ.XLNNZMW_KLIG = HVOU._XLNNZMW_KLIG
        RU OVM(HVOU.KLHG_HVIEVI)!=9:
            SVOOL_WZGZ.KLHG_HVIEVI = '%H:%H'%(HVOU.KLHG_HVIEVI[9].ZWWI, HGI(HVOU.KLHG_HVIEVI[9].KLIG))
        RU KFHS:
            HVOU.SVOOL_WZGZ_ORHG.ZKKVMW(SVOOL_WZGZ)
        IVGFIM SVOOL_WZGZ

    WVU HSZPVSZMWH_DRGS_HGZIUOVVG(HVOU):
        '''IVTRHGVI XFIIVMG KILTIZN DRGS NZHGVI HGZIUOVVG'''
        NHT = HVOU.HGZIUOVVG_WLXPVI.MVD_NHT()
        RU OVM(HVOU.KLHG_HVIEVI)!=9:
            KLHG_ZWWI = '%H:%H'%(HVOU.KLHG_HVIEVI[9].ZWWI, HGI(HVOU.KLHG_HVIEVI[9].KLIG))
            NHT.XLNNZMW = 'HSZPVSZMWH_DRGS_HGZIUOVVG&%H&%H'%(HVOU.IVKLIG_HGZIUOVVG_rw, KLHG_ZWWI)
        VOHV:
            NHT.XLNNZMW = 'HSZPVSZMWH_DRGS_HGZIUOVVG&%H'%HVOU.IVKLIG_HGZIUOVVG_rw
        NHT.QLY = KRXPOV.WFNKH(HVOU.SVOOL_WZGZ_ORHG)
        IVKOB = HVOU.HGZIUOVVG_WLXPVI.HVMW(NHT)
        IVGFIM IVKOB

    WVU IVTRHGVI_HGZIUOVVG(HVOU):
        '''IVTRHGVI XFIIVMG KILTIZN DRGS NZHGVI HGZIUOVVG'''
        NHT = HVOU.HGZIUOVVG_WLXPVI.MVD_NHT()
        NHT.XLNNZMW = 'IVTRHGVI_HGZIUOVVG'
        NHT.QLY = KRXPOV.WFNKH(HVOU.SVOOL_WZGZ_ORHG)
        IVKOB = HVOU.HGZIUOVVG_WLXPVI.HVMW(NHT)
        RU IVKOB.HGZGFH:
            HVOU.IVKLIG_HGZIUOVVG_rw = IVKOB.NVHHZTV
            HVOU.OLTTVI.RMUL('[wzvnlm] HFXXVHHUFOOB IVTRHGVIVW DRGS HGZIUOVVG %H'%HVOU.IVKLIG_HGZIUOVVG_rw)
        IVGFIM IVKOB

    WVU IVTRHGVI_WLXPVI_QLY(HVOU, QLY):
        HVOU.WLXPVI_QLY_ORHG.ZKKVMW(QLY)

    WVU IVTRHGVI_YILZWXZHG_QLY(HVOU, QLY):
        HVOU.YILZWXZHG_QLY_ORHG.ZKKVMW(QLY)

    WVU IVTRHGVI_GRNVI_QLY(HVOU, GRNV, UFMX, ZITFNVMGH):
        HVOU.GRNVI.IVTRHGVI_QLY(GRNV, UFMX, ZITFNVMGH)

    WVU IVYLLG(HVOU):
        LH.XSWRI('/GNK')
        HVOU.NLWFOV_NZMZTVI.HGLK()
        ZIT = '\''+ ' '.QLRM(HVOU.XLNNZMW_ORMV)+'\''
        KILTIZN = LH.KZGS.QLRM( LH.KZGS.WRIMZNV(_XFIIVMG_ILLG), 'GLLO', 'HGZIUOVVG_VMGIFHG.KB')
        HFYKILXVHH.kLKVM(' '.QLRM([KILTIZN, '-X', ZIT, '-K', HGI(LH.TVGKRW()), '-V', HVOU.FYRJ_HBHGVN.VCVUROV, '-U', HVOU.FYRJ_HBHGVN.CNO ]), HSVOO=gIFV)
        HVOU.OLTTVI.DZIM('HGLKKRMT ZOO XLNKLMVMGH')
        RU 'NLMRGLIHBHGVN' RM HVOU.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            HVOU.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN'].PROO_ZOO( RH_NZMFZO_PROO = gIFV, VMHFIV=gIFV, LMOB_VMGIFHG=gIFV  )
        HVOU.OLTTVI.DZIM('HGLKKRMT YLLGHGIZK')
        HVOU.YLLGHGIZK.PROO()
        HVOU.OLTTVI.DZIM('HBHGVN VCRGH')
        GRNV.HOVVK(7)
        HVOU.HBHGVN_VCRG = gIFV
        LH.HBHGVN('PROO -0 %W'% LH.TVGKRW())

    WVU WL_HBHGVN_VCRG(HVOU, IVG, VCXVKGRLM=uZOHV):
        RU VCXVKGRLM:
            IZRHV vCXVKGRLM('GSRH RH Z WVORYVIZGVW VCXVKGRLM')
        HVOU.OLTTVI.DZIM('WL_HBHGVN_VCRG RH XZOOVW')
        RNKLIG GIZXVYZXP
        HVOU.OLTTVI.WVYFT('ULI BLFI XLMERVMRVMXV, GIZXVYZXP RH SVIV %H'%''.QLRM(GIZXVYZXP.ULINZG_HGZXP()))
        HVOU.OLTTVI.DZIM('HBHGVN RH ZYLFG GL VCRG')
        HVOU.OLTTVI.VIILI('HBHGVN RH VCRGRMT')
        RNKLIG LH
        LH._VCRG(IVG)

    WVU TVG_NLWFOV(HVOU, NLW):
        '''TVG NLWFOV'''
        RU NLW RM HVOU.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            IVGFIM HVOU.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK[NLW]
        VOHV:
            IVGFIM mLMV

    WVU XLNKROV(HVOU):
        ULI QLY RM HVOU.XLNKROV_DLIPVI_ORHG:
            QLY.XLNKROV()

    WVU rMRG(HVOU):
        #KIRMG(HVOU._FHV_HNX)
        RU HVOU._FHV_HNX:
            HVOU.HNX = hnx.hnx()
            HVOU.VCXSZMTVNZMZTVI = vCXSZMTVgRNVnZMZTVI()
            HVOU.VCXSZMTVNZMZTVI.IFM()
            ULI VC RM HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK:
                HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK[VC].XOLXP = XOLXP.xOLXP(HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK[VC])
        VOHV:
            HVOU.HNX = mLMV
            HVOU.VCXSZMTVNZMZTVI = mLMV
        # HVOU.XOLXP = XOLXP.xOLXP(HVOU.HNX)
        HVOU.SLHG = FGRO.TVG_FYRJ_SLHG()
        HVOU.WLNZRM = FGRO.TVG_FYRJ_WLNZRM()
        HVOU.rw = FGRO.TVMVIZGV_IZMWLN_HGIRMT(4)
        # KIRMG HVOU.XOLXP.GRNV_GL_RMG()
        HVOU.HBHGVN = mLMV
        #KIRMG(HVOU.TOLYZO_CNO.TVGILLG().ZGGIRY)
        HVOU.VCKLIG_KLHG_WZGZ['GZT'] = HVOU.rw

    WVU RMRG_KLHGHVIEVI(HVOU):
        RU HVOU.TOLYZO_CNO RH MLG mLMV ZMW 'KLHG_HVIEVI' RM HVOU.TOLYZO_CNO.TVGILLG().ZGGIRY:
            KLHG_ZWWI_ORHG = HVOU.TOLYZO_CNO.TVGILLG().ZGGIRY['KLHG_HVIEVI'].HKORG(',')
            ULI KLHG_ZWWI RM KLHG_ZWWI_ORHG:
                ZWWI = KLHG_ZWWI.HKORG(':')[9]
                KLIG = RMG(KLHG_ZWWI.HKORG(':')[8])
                HVIEVI = kLHGhVIEVI(ZWWI, KLIG, YZHV_KLHGHVIEVI.kLHGhVIEVIsZMWOVI, HVOU.OLTTVI)
                HVOU.KLHG_HVIEVI.ZKKVMW(HVIEVI)
                HVOU.OLTTVI.RMUL('HBHGVN HGZIGRMT KLHG HVIEVI %H'%KLHG_ZWWI)
                QLY = qLY(HVIEVI)
                HVOU.KLHG_HVIEVI_QLY.ZKKVMW(QLY)
                HVOU.QLYH['kLHGhVIEVI@%H'%KLHG_ZWWI] = QLY
                QLY.HGZIG()

    WVU TVG_VCXSZMTV_XOLXP(HVOU, VC):
        #KIRMG(HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK)
        RU VC=='xm':
            VC='hhv'
        RU VC MLG RM HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK:
            IZRHV eZOFVvIILI('%H RH MLG RM VCXSZMTV NZK'%VC)
        HVOU._FHVW_XOLXP[VC] = HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK[VC].XOLXP
        IVGFIM HVOU.VCXSZMTVNZMZTVI.VCXSZMTVRMUL_NZK[VC].XOLXP

    WVU RMRG_OLT(HVOU, MLWV, GZT = mLMV):
        # GSV OLT UROV NZB SZEV IVKOZXV SLOWVIH
        HVOU.IZD_OLT_UROV = MLWV.ZGGIRY["OLTUROV"]
        HVOU.OLT_OVEVO = MLWV.ZGGIRY["OVEVO"]
        RU 'KIRMGML' MLG RM MLWV.ZGGIRY:
            MLWV.ZGGIRY['KIRMGML'] = 'UZOHV'
        KIRMG_ML = (MLWV.ZGGIRY["KIRMGML"] == "GIFV")
        RU HVOU.ULIXV_KIRMG_OLT:
            OLT_KIRMG = 'gifv'
        VOHV:
            OLT_KIRMG = MLWV.ZGGIRY['KIRMG']
        RU OLT_KIRMG.FKKVI() == "gifv":
            HVOU.OLT_KIRMG = gIFV
            HVOU.OLT_UROV = ""
        VOHV:
            HVOU.OLT_KIRMG = uZOHV
            HVOU.OLT_UROV = HVOU.IZD_OLT_UROV
            # HVOU.OLT_UROV = FGRO.IVKOZXV_HKVXRZO_GRNVSLOWVI(HVOU.IZD_OLT_UROV, HVOU.XOLXP)
        RU 'HFYQVXG' RM MLWV.ZGGIRY:
            HFYQVXG = MLWV.ZGGIRY['HFYQVXG']
        VORU GZT:
            HFYQVXG = GZT
        VOHV:
            HFYQVXG = "HGZIUOVVG"
        HVOU.OLTTVI = OLT.oLTTVI(HFYQVXG,
                                 HVOU.OLT_OVEVO,
                                 (HVOU.OLT_UROV RU MLG HVOU.OLT_KIRMG VOHV ""), HVOU.XOLXP, KIRMG_ML)
//##**---------------- ./HGZIUOVVG/YZHV/VEVMGH.KB
UILN VMFN RNKLIG vMFN
UILN XLOOVXGRLMH RNKLIG WVUZFOGWRXG

XOZHH vEVMG(LYQVXG):
    WVU __RMRG__(HVOU, VEVMG_GBKV, HVJ, **PDZITH):
        HVOU.__WRXG__ = PDZITH
        HVOU.HVJ = HVJ
        HVOU.VEVMG_GBKV = VEVMG_GBKV
        HVOU.wzgz = mLMV

    WVU __IVKI__(HVOU):
        IVGFIM ' '.QLRM('{}:{}'.ULINZG(P, E) ULI P, E RM HVOU.__WRXG__.RGVNH())

XOZHH lKvEVMG(vEVMG):
    WVU __RMRG__(HVOU,  **PDZITH):
        HVOU.__WRXG__ = PDZITH
        HVOU.VEVMG_GBKV = vevmg.lk_vevmg
        HVOU.hgzgfh = 'uzro'

XOZHH vEVMGyFH(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU._ORHGVMVIH = WVUZFOGWRXG(ORHG)

    WVU ZWW_ORHGVMVI(HVOU, VEVMG_GBKV, ORHGVMVI):
        HVOU._ORHGVMVIH[VEVMG_GBKV].ZKKVMW(ORHGVMVI)

    WVU KIVKVMW_ORHGVMVI(HVOU, VEVMG, ORHGVMVI):
        HVOU._ORHGVMVIH[VEVMG].RMHVIG(9, ORHGVMVI)

    WVU KFYORHS_VEVMG(HVOU, VEVMG):
        ULI O RM HVOU._ORHGVMVIH[VEVMG.VEVMG_GBKV]:
            O.DLIP(VEVMG)

XOZHH vevmg(vMFN):
    fgizwv_hgzgfh   = 'fgizwv_hgzgfh'
    klhrgrlm        = 'klhrgrlm'
    zoksz           = 'zoksz'
    liwvi_vevmg     = 'liwvi_vevmg'
    gizwv_vevmg     = 'gizwv_vevmg'
    irhp_vevmg      = 'irhp_vevmg'
    lk_vevmg        = 'lk_vevmg'
//##**---------------- ./HGZIUOVVG/YZHV/NZMZTVNVMG.KB
RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG GRNV
UILN SVOKVI.FGRO RNKLIG RNKLIG_LKVIZGRLM, HGIUWVOGZ
RNKLIG GIZXVYZXP
RNKLIG LH
RNKLIG HBH
RNKLIG KBRMLGRUB
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG KRXPOV
RNKLIG RNK
RNKLIG HFYKILXVHH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO



XOZHH qLYiVHFOG(LYQVXG):
    WVU __RMRG__(HVOU, LK):
        HVOU.HGZIG_GRNV = mLMV
        HVOU.VMW_GRNV = mLMV
        HVOU.IVHFOG = mLMV
        HVOU.VIILI = mLMV
        HVOU.HGZGFH = 'MLG HGZIGVW' # HGZGFH HSZOO YV MLG HGZIGVW/HGZIGVW/UZROVW/HFXXVHH
        HVOU.RW = LK.RW
        HVOU.IZMWLN_RW = LK.IZMWLN_RW
        HVOU.KILTIVHH = 9
        HVOU.KILTIVHH_NHT = ''
        HVOU.LK = LK
        HVOU.HGWLFG = ''
        HVOU.HGWVII = ''
        HVOU.WZGZ = [] # QLY IVHFOG XLFOW YV HGLIVW ZH ORHG HL GSZG LMV XLFOW RMXIVNVMGZOOB TVG QLY IVHFOG

    WVU HGZIG(HVOU):
        HVOU.HGZIG_GRNV = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.HGZGFH = 'HGZIGVW'

    WVU VMW(HVOU, IVG):
        '''IVG RH HGZGFH, YLLO, gIFV LI uZOHV'''
        HVOU.VMW_GRNV = WZGVGRNV.WZGVGRNV.MLD()
        RU IVG RH MLG mLMV:
            RU IVG:
                HVOU.HGZGFH = 'HFXXVHH'
                IVGFIM 'HFXXVHH'
            VOHV:
                RU HVOU.LK._VIILI_NVHHZTV RH MLG mLMV:
                    HVOU.VIILI = HVOU.LK._VIILI_NVHHZTV
                HVOU.HGZGFH = 'UZROVW'
                IVGFIM 'UZROVW'
        VOHV:
            HVOU.HGZGFH = 'UZROVW'
            IVGFIM 'UZROVW'


# lMVgRNVqLY XLFOW VMXZKHFOZGV ZMB HLIG LU QLYH
XOZHH lMVgRNVqLY(LYQVXG):
    WVU __RMRG__(HVOU, RW, TOLYZO_RMUL, UFMX, ZITH):
        HVOU.RW = RW
        HVOU.IZMWLN_RW = FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(4)
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.UFMX = UFMX
        HVOU.ZITH = ZITH
        RU 'IVUVIVMXV' MLG RM HVOU.ZITH:
            HVOU.ZITH['IVUVIVMXV'] = HVOU.IZMWLN_RW
        HVOU._VIILI_NVHHZTV = mLMV
        HVOU.LMVGRNV_IVHFOG = qLYiVHFOG(HVOU)
        HVOU._HGZGFH_UOZT = 9

    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL('HGZIGH GL DLIP ULI %H(%H)'%(HVOU.RW, HVOU.IZMWLN_RW))
        HVOU.LMVGRNV_IVHFOG.HGZIG()
        GIB:
            IVG = HVOU.UFMX(HVOU.ZITH, HVOU.TOLYZO_RMUL, HVOU.LMVGRNV_IVHFOG.WZGZ, HVOU._HGLK_VEVMG)
            HGZGFH = IVG[9]
            IVZHLM = IVG[8]
            HVOU._VIILI_NVHHZTV = IVZHLM
            HVOU.LMVGRNV_IVHFOG.VMW(gIFV)
        VCXVKG vCXVKGRLM ZH V:
            HVOU.OLTTVI.VIILI('LMVGRNV QLY UZROVW %H'%HGI(V))
            HVOU._VIILI_NVHHZTV = HGI(V)
            HVOU.LMVGRNV_IVHFOG.VMW(uZOHV)
        HVOU._HGZGFH_UOZT = 8 # URMRHSVW

# ULI XLNKZGRYRORGB
XOZHH lMVGRNVlKiVHFOG(qLYiVHFOG):
    WVU __RMRG__(HVOU, LK):
        HFKVI().__RMRG__(LK)

# DLIPVI GL VCVXFGV YZHS XLNNZMW
XOZHH lMVGRNVdLIPVI(LYQVXG):
    WVU __RMRG__(HVOU, XLNNZMW = mLMV):
        HVOU.XLNNZMW = XLNNZMW
        HVOU.HGWLFG = mLMV
        HVOU.HGWVII = mLMV

    WVU IFM(HVOU):
        K = HFYKILXVHH.kLKVM(HVOU.XLNNZMW, HSVOO=gIFV,  HGWLFG=HFYKILXVHH.krkv, HGWVII=HFYKILXVHH.krkv)
        HVOU.HGWLFG = K.HGWLFG.IVZW()
        HVOU.HGWVII = K.HGWVII.IVZW()


XOZHH lKhGZGFH(LYQVXG):
    WVU __RMRG__(HVOU, LK):
        HVOU.LK = LK
        HVOU.RMHGZOO_GRNV = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%s:%n:%h')
        HVOU.GRNV_GL_IFM = '9H'
        HVOU.MVCG_GRNV = ''
        HVOU.IFM_GRNVH = 9
        HVOU.OZHG_GRNV = ''
        HVOU.HFXXVHH_GRNVH = 9
        HVOU.UZROFIV_GRNVH = 9
        HVOU.GIB_GRNVH = 9
        HVOU.IVOLZW_GRNVH = 9
        HVOU.NZIP = gIFV
        HVOU.IVHFOG = uZOHV  # OZHG IVGFIM EZOFV
        HVOU.UOZT = uZOHV # RU GSV LK RH DLIPRMT MLD
        HVOU.HGZGFH = 'OLZWVW'  # HGZGFH, OLZWVW, FMOLZWVW
        HVOU.LDMVW = gIFV;

    WVU IVOLZW(HVOU):
        HVOU.IVOLZW_GRNVH += 8
        HVOU.IFM_GRNVH = 9
        HVOU.HFXXVHH_GRNVH = 9
        HVOU.UZROFIV_GRNVH = 9
        HVOU.GIB_GRNVH = 9
        HVOU.IVHFOG = uZOHV  # OZHG IVGFIM EZOFV
        HVOU.UOZT = uZOHV # RU GSV LK RH DLIPRMT MLD
        HVOU.NZIP = gIFV # uZOHV: GVNKLIZIROB ULIYRWWVM

    WVU GIRTTVI_IFM(HVOU):
        HVOU.IFM_GRNVH += 8
        HVOU.OZHG_GRNV = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%s:%n:%h')
        RU HVOU.IVHFOG:
            HVOU.HFXXVHH_GRNVH += 8
        VOHV:
            HVOU.UZROFIV_GRNVH += 8
        RU HVOU.LK.NVGILMLNV._NLWV == 'VEVIB_GL_HFXXVHH':
            HVOU.GIB_GRNVH += 8

    WVU XLNKROV_GL_HGI(HVOU):
        """FHVW GL IVKLIG LK HGZGFH"""
        IVG = 'RW='+HVOU.LK.RW
        IVG += '|NLWFOV='+HVOU.LK.NLWFOV
        IVG += '|RMHGZOO='+HVOU.RMHGZOO_GRNV
        RU HVOU.LK.NVGILMLNV._NLWV == 'LM_GRNV':
            IVG += '|GRNV_GL_IFM=' + HVOU.GRNV_GL_IFM
        RU HVOU.LK.NVGILMLNV._NLWV == 'VEVIB':
            IVG += '|NLWV='+HVOU.LK.NVGILMLNV._NLWV+'-'+HGIUWVOGZ( HVOU.LK.NVGILMLNV.VEVIB, '{SLFIH}:{NRMFGVH}:{HVXLMWH}' )
        VORU HVOU.LK.NVGILMLNV._NLWV == 'LM_GRNV':
            IVG += '|NLWV='+HVOU.LK.NVGILMLNV._NLWV+'-'+HVOU.MVCG_GRNV
            RU HVOU.GRNV_GL_IFM[9] != '-':
                IVG += '|vgz='+HVOU.GRNV_GL_IFM
            VOHV:
                IVG += '|vgz='
        IVG += '|IFM_GRNVH='+HGI(HVOU.IFM_GRNVH)
        IVG += '|HFXXVHH_GRNVH='+HGI(HVOU.HFXXVHH_GRNVH)
        IVG += '|UZROFIV_GRNVH='+HGI(HVOU.UZROFIV_GRNVH)
        RU HVOU.LK.NVGILMLNV._NLWV == 'VEVIB_GL_HFXXVHH':
            IVG += '|GIB_GRNVH=' + HGI(HVOU.GIB_GRNVH)
        IVG += '|IVOLZW_GRNVH=' + HGI(HVOU.IVOLZW_GRNVH)
        IVG += '|NZIP=' + ('GIFV' RU HVOU.NZIP VOHV 'UZOHV')
        IVG += '|IVHFOG=' + ('GIFV' RU HVOU.IVHFOG VOHV 'UZOHV')
        IVG += '|UOZT=' + ('GIFV' RU HVOU.UOZT VOHV 'UZOHV')
        IVG += '|HGZGFH=' + HVOU.HGZGFH
        IVG += '|OZHG_GRNV='+HVOU.OZHG_GRNV
        IVGFIM IVG

    WVU OLZWUILNWY():
        KZHH

    WVU HZEVGLWY():
        KZHH

XOZHH lKsLFHViFMMVI(LYQVXG):
    WVU __RMRG__(HVOU, LK_SLFHV, TOLYZO_RMUL):
        HVOU.LK_SLFHV = LK_SLFHV
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.TOLYZO_RMUL  = TOLYZO_RMUL
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        HVOU.HOVVK_KVI_ILFMW = FGRO.KZIHV_GRNVWVOGZ('8H')
        HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.HOVVK_KVI_ILFMW

    WVU IFM(HVOU):
        DSROV MLG HVOU.TOLYZO_RMUL.HGLK:
            # RU ML LKVIZGRLM VCRHGH
            HVOU.XOLXP.FKWZGV()
            ULI VCXSZMTV RM HVOU.VCXSZMTV_NZMZTVI.VCXSZMTVRMUL_NZK:
                KIRMG('FKWZGV', HVOU.VCXSZMTV_NZMZTVI.VCXSZMTVRMUL_NZK[VCXSZMTV])
                HVOU.VCXSZMTV_NZMZTVI.VCXSZMTVRMUL_NZK[VCXSZMTV].XOLXP.FKWZGV()
            RU MLG HVOU.LK_SLFHV.LKVIZGRLMH:
                GRNV.HOVVK(4)
                XLMGRMFV
            # FKWZGV VCXSZMTV XOLXPH
            HVOU.LK_SLFHV.IVOLZW()
            RU HVOU.XOLXP.MLD - HVOU.OZHG > HVOU.HOVVK_KVI_ILFMW:
                # WL GSV IVZO DLIP
                HVOU.LK_SLFHV.DLIP()
                HVOU.XOLXP.FKWZGV()
                HVOU.OZHG = HVOU.XOLXP.MLD
            VOHV:
                GRNV.HOVVK(7)


XOZHH lKsLFHV(LYQVXG):
    '''HGIFXGFIV GL SLOW LK IVOVEZMG RMUL, XLWV, ZMW HGZGFH, LMV ULI VZXS FHVI'''
    WVU __RMRG__(HVOU, IVOLZW_GRNV, TOLYZO_RMUL):
        HVOU.LKVIZGRLMH = []
        HVOU.LKVIZGRLM_NZK = {}
        HVOU.LKVIZGRLM_KZGS_NZK = {}
        HVOU.LKVIZGRLM_XLMURT_NZK = {}
        HVOU.LKVIZGRLM_NLWFOV_NZK = {}
        HVOU.LK_HGZGFH = {}
        HVOU.LK_IVOLZW_GRNV = {}
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.LK_IVXLIWVI = TOLYZO_RMUL.LKIVXLIWVI
        HVOU.KZGS = HVG()
        HVOU.IVOLZW_GRNV = IVOLZW_GRNV
        HVOU.OZHG = HVOU.XOLXP.MLD - FGRO.KZIHV_GRNVWVOGZ('8H')
        HVOU.OZHG_IVOLZW_XSVXP = HVOU.OZHG

    WVU WVZXGREZGV_LK(HVOU, RW):
        HVOU.LK_HGZGFH[RW].HGZGFH = 'FMOLZWVW'

    WVU ZXGREZGV_LK(HVOU, RW):
        HVOU.LK_HGZGFH[RW].HGZGFH = 'OLZWVW'

    WVU XLNKROV_GL_HGI(HVOU):
        IVG = ''
        ULI LK_RW RM HVOU.LK_HGZGFH:
            IVG += HVOU.LK_HGZGFH[LK_RW].XLNKROV_GL_HGI() + '&'
        IVGFIM IVG[:-8]

    WVU OLZW_LK(HVOU, LK, LK_CNO, XOZHHLK, NLWFOV_MZNV):
        LK.__UROV__ = ''
        HVOU.LKVIZGRLM_KZGS_NZK[LK.__UROV__] = XOZHHLK
        HVOU.LKVIZGRLM_XLMURT_NZK[LK.RW] = LK_CNO
        RU NLWFOV_MZNV MLG RM HVOU.LKVIZGRLM_NLWFOV_NZK:
            HVOU.LKVIZGRLM_NLWFOV_NZK[NLWFOV_MZNV] = []
        HVOU.LKVIZGRLM_NLWFOV_NZK[NLWFOV_MZNV].ZKKVMW(LK.RW)
        HVOU.LKVIZGRLMH.ZKKVMW(LK)
        HVOU.LKVIZGRLM_NZK[LK.RW] = LK
        HVOU.LK_HGZGFH[LK.RW] = lKhGZGFH(LK)
        # 8 ZH IFMMRMT IVHFOG, 7 ZH IFMMRMT UOZT, 6 ZH RU ULIYRWWVM  5 ZH LK HGZGFH
        HVOU.LK_IVOLZW_GRNV[LK.RW] = LK._IVOLZW_GRNV RU OVM(LK._IVOLZW_GRNV) > 8  VOHV HVOU.IVOLZW_GRNV
        RU OVM(LK._IVOLZW_GRNV) == 9:
            LK._IVOLZW_GRNV += HVOU.IVOLZW_GRNV
        HVOU.TOLYZO_RMUL.OLTTVI.RMUL('[yllg] %H RMHGZOOVW IVOLZW GRNV ZH: ' % (LK.RW)+', '.QLRM([RG.HGIUGRNV('%s:%n:%h') ULI RG RM LK._IVOLZW_GRNV]))

    WVU IVOLZW(HVOU):
        # IVOLZW ZOO LKVIZGRLMH
        ULI LK RM HVOU.LKVIZGRLMH:
            ULI IVOLZW_GRNV RM HVOU.LK_IVOLZW_GRNV[LK.RW]:
            #    KIRMG(IVOLZW_GRNV, HVOU.OZHG)
                RU (HVOU.XOLXP.MLD.GRNV() > IVOLZW_GRNV ZMW HVOU.OZHG_IVOLZW_XSVXP.GRNV() <= IVOLZW_GRNV) LI ( HVOU.XOLXP.MLD.GRNV() < HVOU.OZHG_IVOLZW_XSVXP.GRNV() ZMW HVOU.XOLXP.MLD.GRNV() > IVOLZW_GRNV  ) :
                    HVOU.TOLYZO_RMUL.OLTTVI.RMUL('[ivolzw] %H IVOLZWVW ZG GRNV: %H'%(LK.RW, IVOLZW_GRNV.HGIUGRNV('%s:%n:%h')))
                    GIB:
                        LK.IVOLZW()
                        HVOU.LK_HGZGFH[LK.RW].IVOLZW()
                    VCXVKG vCXVKGRLM ZH V:
                        HVOU.TOLYZO_RMUL.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV('%','|'))
                        HVOU.TOLYZO_RMUL.OLTTVI.VIILI('%H VMXLFMGVIH VCXVKGRLM: %H'%(LK.RW, HGI(V)))
        # IVOLZW ZOO NVGILMLNVH
        RU HVOU.XOLXP.MLD.GRNV() < HVOU.OZHG_IVOLZW_XSVXP.GRNV():
            ULI NVGILMLNV RM HVOU.TOLYZO_RMUL._NVGILMLNVH:
                NVGILMLNV.IVOLZW()
        HVOU.OZHG_IVOLZW_XSVXP = HVOU.XOLXP.MLD

    WVU IFM(HVOU):
        '''GSRH RH GL NLMRGLI GSV LKVIZGRLM WRIVXGLIB ULI LKVIZGRLM FKWZGVH'''
        XOZHH vEVMGsZMWOVI(KBRMLGRUB.kILXVHHvEVMG):
            WVU __RMRG__(HVOU, NLMRGLI):
                HVOU.NLMRGLI = NLMRGLI

            WVU KILXVHH_rm_xolhv_dirgv(HVOU, VEVMG):
                #KIRMG('XOLHV_DIRGV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.LKVIZGRLM_KZGS_NZK:
                    NLWFOV_MZNV = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6]
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW LK NLWFOV %H'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_LKVIZGRLM(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                          [LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV)])
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    ULI LK_RW RM HVOU.NLMRGLI.LKVIZGRLM_NLWFOV_NZK[NLWFOV_MZNV]:
                        HVOU.NLMRGLI.OLTTVI.RMUL('--> IVOLZW LK %H'%LK_RW)
                        LKVIZGRLM = XOZHHLK(HVOU.NLMRGLI.LKVIZGRLM_XLMURT_NZK[LK_RW], HVOU.NLMRGLI.TOLYZO_RMUL)
                        LKVIZGRLM.__UROV__ = WVHG_KZGS
                        RMW = HVOU.NLMRGLI.LKVIZGRLMH.RMWVC(HVOU.NLMRGLI.LKVIZGRLM_NZK[LKVIZGRLM.RW])
                        HVOU.NLMRGLI.LKVIZGRLM_NZK[LKVIZGRLM.RW] = LKVIZGRLM
                        HVOU.NLMRGLI.LKVIZGRLM_KZGS_NZK[LKVIZGRLM.__UROV__] = XOZHHLK
                        HVOU.NLMRGLI.LKVIZGRLMH[RMW] = LKVIZGRLM

            WVU KILXVHH_rm_nlevw_gl(HVOU, VEVMG):
                #KIRMG('NLEV:', VEVMG.KZGSMZNV)
                RU VEVMG.KZGSMZNV RM HVOU.NLMRGLI.LKVIZGRLM_KZGS_NZK:
                    NLWFOV_MZNV = LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6]
                    HVOU.NLMRGLI.OLTTVI.RMUL('IVOLZW LK NLWFOV %H'%LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6])
                    GIB:
                        (XOZHHLK, WVHG_KZGS) = RNKLIG_LKVIZGRLM(LH.KZGS.YZHVMZNV(VEVMG.KZGSMZNV)[:-6],
                                                            [LH.KZGS.WRIMZNV(VEVMG.KZGSMZNV)])
                    VCXVKG vCXVKGRLM:
                        HVOU.NLMRGLI.OLTTVI.RMUL(GIZXVYZXP.ULINZG_VCX())
                        IVGFIM
                    ULI LK_RW RM HVOU.NLMRGLI.LKVIZGRLM_NLWFOV_NZK[NLWFOV_MZNV]:
                        HVOU.NLMRGLI.OLTTVI.RMUL('--> IVOLZW LK %H'%LK_RW)
                        LKVIZGRLM = XOZHHLK(HVOU.NLMRGLI.LKVIZGRLM_XLMURT_NZK[LK_RW], HVOU.NLMRGLI.TOLYZO_RMUL)
                        LKVIZGRLM.__UROV__ = WVHG_KZGS
                        RMW = HVOU.NLMRGLI.LKVIZGRLMH.RMWVC(HVOU.NLMRGLI.LKVIZGRLM_NZK[LKVIZGRLM.RW])
                        HVOU.NLMRGLI.LKVIZGRLM_NZK[LKVIZGRLM.RW] = LKVIZGRLM
                        HVOU.NLMRGLI.LKVIZGRLM_KZGS_NZK[LKVIZGRLM.__UROV__] = XOZHHLK
                        HVOU.NLMRGLI.LKVIZGRLMH[RMW] = LKVIZGRLM


        DN = KBRMLGRUB.dZGXSnZMZTVI()
        NZHP =  KBRMLGRUB.rm_xolhv_dirgv | KBRMLGRUB.rm_nlevw_gl
        ULI KZGS RM HVOU.KZGS:
            DN.ZWW_DZGXS(KZGS, NZHP, IVX=gIFV)
            HVOU.OLTTVI.RMUL('[yllg] lknZMZTVI NLMRGLIH LK KZGS %H'%KZGS)
        VS = vEVMGsZMWOVI(HVOU)
        MLGRURVI = KBRMLGRUB.mLGRURVI(DN, VS)
        MLGRURVI.OLLK()


    WVU DLIP(HVOU):
        ULI LK RM HVOU.LKVIZGRLMH:
            RU MLG HVOU.LK_HGZGFH[LK.RW].NZIP: # RU ULIYRWWVM
                XLMGRMFV
            RU HVOU.LK_HGZGFH[LK.RW].HGZGFH == 'FMOLZWVW':
                XLMGRMFV
            RU MLG LK.NVGILMLNV.XSVXP_DLIP_WZB():
                XLMGRMFV
            # XSVXP XLMWRGRLM
            RU OVM(LK._WVKVMWVMXRVH) > 9:
                WVK_XLMWRGRLM = gIFV
                ULI WVK RM LK._WVKVMWVMXRVH:
                    WVK_XLMWRGRLM = WVK_XLMWRGRLM ZMW HVOU.LK_HGZGFH[WVK.RW].IVHFOG
                RU MLG WVK_XLMWRGRLM:
                    XLMGRMFV

            LK.NVGILMLNV.XOLXP.FKWZGV()
            RU LK.NVGILMLNV._NLWV == 'VEVIB' LI LK.NVGILMLNV._NLWV == 'VEVIB_GL_HFXXVHH':
                RU (LK.NVGILMLNV._NLWV=='VEVIB_GL_HFXXVHH') ZMW HVOU.LK_HGZGFH[LK.RW].IVHFOG == gIFV:
                    XLMGRMFV # ZOIVZWB HFXXVHH
                RU MLG LK.NVGILMLNV.XSVXP_RM_IZMTV():
                    XLMGRMFV
                RU LK.NVGILMLNV.XSVXP_VEVIB():
                    RU MLG LK.FHV_MVD_GSIVZW:
                        HVOU.LK_IVXLIWVI.iVXLIW(LK, 'ifmm')
                        HVOU.LK_HGZGFH[LK.RW].IVHFOG = 8
                        GIB:
                            HVOU.LK_HGZGFH[LK.RW].IVHFOG = LK.DLIP()
                            HVOU.LK_HGZGFH[LK.RW].GIRTTVI_IFM()
                        VCXVKG vCXVKGRLM ZH V:
                            HVOU.TOLYZO_RMUL.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV('%','|'))
                            HVOU.TOLYZO_RMUL.OLTTVI.VIILI('%H VMXLFMGVIH VCXVKGRLM: %H'%(LK.RW, HGI(V)))
                            HVOU.LK_HGZGFH[LK.RW].GIRTTVI_IFM()
                        RU HVOU.LK_HGZGFH[LK.RW].IVHFOG == 9:
                            HVOU.LK_IVXLIWVI.iVXLIW(LK, 'hfxx')
                        VOHV:
                            HVOU.LK_IVXLIWVI.iVXLIW(LK, 'uzro')
                    VOHV:
                        RU HVOU.LK_HGZGFH[LK.RW].UOZT:
                            XLMGRMFV
                        HVOU.LK_HGZGFH[LK.RW].UOZT = gIFV
                        LK_DLIPVI = lKVIZGRLMdLIPVI(HVOU.LK_HGZGFH, LK, HVOU.LK_IVXLIWVI)
                        qLY(LK_DLIPVI).HGZIG()
            VORU LK.NVGILMLNV._NLWV == 'LM_GRNV':
                RU LK.NVGILMLNV.XSVXP_LM_GRNV():
                    RU MLG LK.FHV_MVD_GSIVZW:
                        HVOU.LK_IVXLIWVI.iVXLIW(LK, 'ifmm')
                        GIB:
                            HVOU.LK_HGZGFH[LK.RW].IVHFOG = LK.DLIP()
                            HVOU.LK_HGZGFH[LK.RW].GIRTTVI_IFM()
                        VCXVKG vCXVKGRLM ZH V:
                            HVOU.TOLYZO_RMUL.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV('%','|'))
                            HVOU.TOLYZO_RMUL.OLTTVI.VIILI('%H VMXLFMGVIH VCXVKGRLM: %H'%(LK.RW, HGI(V )))

                        RU HVOU.LK_HGZGFH[LK.RW].IVHFOG == 9:
                            HVOU.LK_IVXLIWVI.iVXLIW(LK, 'hfxx')
                        VOHV:
                            HVOU.LK_IVXLIWVI.iVXLIW(LK, 'uzro')
                    VOHV:
                        RU HVOU.LK_HGZGFH[LK.RW].UOZT:
                            XLMGRMFV
                        HVOU.LK_HGZGFH[LK.RW].UOZT = gIFV
                        LK_DLIPVI = lKVIZGRLMdLIPVI(HVOU.LK_HGZGFH, LK, HVOU.LK_IVXLIWVI)
                        qLY(LK_DLIPVI).HGZIG()
                    #LK.NVGILMLNV.K_VEVMG += 8
                VOHV:
                    HVOU.LK_HGZGFH[LK.RW].MVCG_GRNV = LK.NVGILMLNV.MVCG_GRNV
                    HVOU.LK_HGZGFH[LK.RW].GRNV_GL_IFM = LK.NVGILMLNV.GRNV_GL_IFM
        HVOU.OZHG = HVOU.XOLXP.MLD


XOZHH lKVIZGRLMdLIPVI(LYQVXG):
    WVU __RMRG__(HVOU, HGZGFH, LK, IVXLIWVI):
        HVOU.HGZGFH = HGZGFH
        HVOU.LK = LK
        HVOU.IVXLIWVI = IVXLIWVI

    WVU IFM(HVOU):
        HVOU.IVXLIWVI.iVXLIW(HVOU.LK, 'ifmm')
        GIB:
            HVOU.HGZGFH[HVOU.LK.RW].IVHFOG = HVOU.LK.DLIP()
            HVOU.HGZGFH[HVOU.LK.RW].GIRTTVI_IFM()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.LK.TOLYZO_RMUL.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV('%','|'))
            HVOU.LK.TOLYZO_RMUL.OLTTVI.VIILI('%H VMXLFMGVIH VCXVKGRLM: %H'%(HVOU.LK.RW, HGI(V )))

        RU HVOU.HGZGFH[HVOU.LK.RW].IVHFOG == 9:
            HVOU.IVXLIWVI.iVXLIW(HVOU.LK, 'hfxx')
        VOHV:
            HVOU.IVXLIWVI.iVXLIW(HVOU.LK, 'uzro')

        HVOU.HGZGFH[HVOU.LK.RW].UOZT = uZOHV


XOZHH nZMZTVNVMG(LYQVXG):
    """nZMZTVNVMG xOZHH."""
    WVU __RMRG__(HVOU, GIVV, TOLYZO_RMUL):
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.TOLYZO_RMUL  = TOLYZO_RMUL
        HVOU.OLTTVI = HVOU.TOLYZO_RMUL.OLTTVI
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        HVOU.IVOLZW_GRNV = mLMV
        HVOU.LK_IVXLIWVI = TOLYZO_RMUL.LKIVXLIWVI
        LKVIZGRLM_ORHG = []
        HVOU.IVOLZW_GRNV = []
        # LK EZFOG HGLIV lKsLFHV ULI VZXS FHVI HVKZIZGVOB
        HVOU.LK_EZFOG = {}
        HVOU.LK_EZFOG['NZHGVI'] = lKsLFHV(HVOU.IVOLZW_GRNV, HVOU.TOLYZO_RMUL)
        HVOU.LMVGRNV_LK = []
        HVOU.LMVGRNV_LK_IVHFOG = []
        # GL HZEV LMGRNV QLYH
        HVOU.LMVGRNV_QLYH = []
        HVOU.LMVGRNV_QLYH_NZK = {}
        HVOU.LMVGRNV_QLYH_IFMMVI_NZK = {}
        # KZIHV LKVIZGRLMH
        RU GIVV.URMW('LKVIZGRLMH') RH MLG mLMV ZMW OVM(GIVV.URMW('LKVIZGRLMH')) > 9:
            LKVIZGRLMH_CNO = GIVV.URMW('LKVIZGRLMH')
            LKVIZGRLM_ORHG = LKVIZGRLMH_CNO.URMWZOO('LKVIZGRLM')
            TILFK_ORHG  = LKVIZGRLMH_CNO.URMWZOO('TILFK')
            RU OVM(TILFK_ORHG)>9:
                ULI TILFK RM TILFK_ORHG:
                    RU 'RW' MLG RM TILFK.ZGGIRY:
                        IZRHV eZOFVvIILI('LKVIZGRLM TILFK NFHG WVURMV RW')
                    TK_LKVIZGRLM = TILFK.URMWZOO('LKVIZGRLM')
                    ULI LK RM TK_LKVIZGRLM:
                        LK.ZGGIRY['TILFK'] = TILFK.ZGGIRY['RW']
                    LKVIZGRLM_ORHG += TK_LKVIZGRLM
            CNO = GIVV.URMW('LKVIZGRLMH')
            RU 'HOVVK_KVI_ILFMW' MLG RM CNO.ZGGIRY:
                IZRHV eZOFVvIILI('lKVIZGRLM TILFK NFHG SZEV HOVVK_KVI_ILFMW GZT')
            VOHV:
                HVOU.HOVVK_KVI_ILFMW = FGRO.KZIHV_GRNVWVOGZ(CNO.ZGGIRY['HOVVK_KVI_ILFMW'])
                HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.HOVVK_KVI_ILFMW

            ULI IG RM CNO.ZGGIRY['IVOLZW'].HGIRK().HKORG(','):
                HVOU.IVOLZW_GRNV.ZKKVMW( FGRO.KZIHV_GRNV(IG) )

            HVOU.OLZW_LKVIZGRLM(LKVIZGRLM_ORHG, 'NZHGVI')

            LK_WVK = GIVV.URMW('LKVIZGRLMH').URMW('LKVIZGRLM_WVKVMWVMXRVH')
            RU LK_WVK RH MLG mLMV:
                LKVIZGRLM_WVKVMWVMXB_ORHG = LK_WVK.URMWZOO('WVKVMWVMXB')
                RU OVM(LKVIZGRLM_WVKVMWVMXB_ORHG) > 9:
                    HVOU.OLZW_WVKVMWVMXB(LKVIZGRLM_WVKVMWVMXB_ORHG)


    WVU LMORMV_OLZW_LK(HVOU, FHVI, LK, LK_CNO, XOZHHLK, NLWFOV_MZNV):
        RU FHVI MLG RM HVOU.LK_EZFOG:
            HVOU.LK_EZFOG[FHVI] = lKsLFHV(HVOU.IVOLZW_GRNV, HVOU.TOLYZO_RMUL)
            LK_SLFHV = HVOU.LK_EZFOG[FHVI]
            qLY(lKsLFHViFMMVI(LK_SLFHV, HVOU.TOLYZO_RMUL)).HGZIG()
        LK_SLFHV = HVOU.LK_EZFOG['NZHGVI']
        LK_SLFHV.OLZW_LK(LK, LK_CNO, XOZHHLK, NLWFOV_MZNV)
        IVGFIM 'HFXXVHH'


    WVU IVMWVI_LMVGRNV_DLIPVI(HVOU, RW, UFMX, ZITH):
        QLY = lMVgRNVqLY(RW, HVOU.TOLYZO_RMUL, UFMX, ZITH)
        #KIRMG('QLY:', QLY, ' LK:', QLY.LMVGRNV_IVHFOG.LK)
        HVOU.LMVGRNV_QLYH.ZKKVMW(QLY)
        HVOU.LMVGRNV_QLYH_NZK[QLY.IZMWLN_RW] = QLY
        HVOU.LMVGRNV_LK_IVHFOG.ZKKVMW(QLY.LMVGRNV_IVHFOG)
        IVGFIM QLY.IZMWLN_RW


    WVU IVMWVI_LK(HVOU, LKXLWV, CNO_HGIRMT, DLIPVI = mLMV):
        MVD_LK_NLWFOV = RNK.MVD_NLWFOV('MVD_LK')
        VCVX(LKXLWV, MVD_LK_NLWFOV.__WRXG__)
        CNO = VGIVV.UILNHGIRMT(CNO_HGIRMT)
        NLWFOV_MZNV = CNO.ZGGIRY['NLWFOV']
        XOZHHLK = TVGZGGI(MVD_LK_NLWFOV, NLWFOV_MZNV)
        MVD_LK = XOZHHLK(CNO, HVOU.TOLYZO_RMUL)
        RU DLIPVI RH MLG mLMV:
            MVD_LK.HVG_DLIPVI(DLIPVI)
        LMVGRNV = uZOHV
        LMVGRNV_YOLXP = uZOHV
        RU '_LMVGRNV_' RM CNO.ZGGIRY:
            LMVGRNV = ( CNO.ZGGIRY['_LMVGRNV_'].OLDVI() == 'GIFV' )
        RU '_YOLXP_' RM CNO.ZGGIRY:
            LMVGRNV_YOLXP = ( CNO.ZGGIRY['_YOLXP_'].OLDVI() == 'GIFV' )
        RU LMVGRNV:
            LK_IVHFOG = lMVGRNVlKiVHFOG(MVD_LK)
            MVD_LK.LMVGRNV_IVHFOG = LK_IVHFOG
            HVOU.LMVGRNV_LK_IVHFOG.ZKKVMW(LK_IVHFOG)
            RU LMVGRNV_YOLXP:
                GIB:
                    MVD_LK.LMVGRNV_IVHFOG.HGZIG()
                    IVG = MVD_LK.DLIP()
                    IVGFIM MVD_LK.LMVGRNV_IVHFOG.VMW(IVG, MVD_LK)+'-'+MVD_LK.IZMWLN_RW
                VCXVKG vCXVKGRLM ZH V:
                    IVGFIM HGI(V)+'-'+MVD_LK.IZMWLN_RW
            VOHV:
                HVOU.LMVGRNV_LK.ZKKVMW(MVD_LK)
                IVGFIM 'HFXXVHH-'+MVD_LK.IZMWLN_RW
        VOHV:
            IVGFIM HVOU.LMORMV_OLZW_LK('NZHGVI', MVD_LK, CNO, XOZHHLK, NLWFOV_MZNV)+'-'+MVD_LK.IZMWLN_RW


    WVU HVMW_LK_GL_HVIEVI(HVOU, LKRW, HVIEVI, ULIXV_IVOLZW=uZOHV):
        RU HVOU.TOLYZO_RMUL.XZITL_WLXPVI RH mLMV LI HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG RH mLMV:
            IVGFIM (uZOHV, 'IVWHSRUG RH MLG IVZWB')
        IVWHSRUG = HVOU.TOLYZO_RMUL.XZITL_WLXPVI.IVWHSRUG
        # URIHG XSVXP RU GSV LK SZH ZOIVZWB YVVM OLZWVW
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = HVIEVI
        NHT.XLNNZMW = 'JFVIBLK'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        GIB:
            IVKOB = IVWHSRUG.HVMW(NHT)
            RU MLG IVKOB.HGZGFH:
                IVGFIM (IVKOB.HGZGFH, IVKOB.NHT)
        VCXVKG vCXVKGRLM ZH V:
            IVGFIM (uZOHV, HGI(V))
        KIRMG(KRXPOV.OLZWH(IVKOB.WZGZ))
        LK = HVOU.LK_EZFOG['NZHGVI'].LKVIZGRLM_NZK[LKRW]
        XLWV = ''
        DRGS LKVM(LK.__UROV__, 'I') ZH U:
            XLWV = U.IVZW()
        CNO = LK.CNO_HGIRMT
        KIRMG(XLWV, CNO)
        # IVKLIG XLNKLMVMGH
        # NHT = IVWHSRUG.MVD_NHT()
        # NHT.HIX = HVOU.TOLYZO_RMUL.SLHG
        # NHT.WHG = HVOU.TOLYZO_RMUL.IVKLIG_GZITVG
        # NHT.XLNNZMW = 'IVKLIG_XLNKLMVMG'
        # WZGZ_WRXG = HVOU.XLNKROV_XLNKLMVMG_HGZGFH(VCKLIG_QHLM=gIFV)
        # NHT.WZGZ = QHLM.WFNKH( WZGZ_WRXG ).VMXLWV()
        # NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        # GIB:
            # IVKOB = IVWHSRUG.HVMW(NHT)
        # VCXVKG vCXVKGRLM ZH V:
            # KZHH


    WVU OLZW_LKVIZGRLM(HVOU, LKVIZGRLM_ORHG, FHVI='NZHGVI'):
        LK_SLFHV = HVOU.LK_EZFOG[FHVI]
        LK_SLFHV.OZHG = HVOU.OZHG
        ULI LK_CNO RM LKVIZGRLM_ORHG:
            NLWFOV_MZNV = LK_CNO.ZGGIRY['NLWFOV']
            RU 'TILFK' MLG RM LK_CNO.ZGGIRY:
                LK_CNO.ZGGIRY['TILFK'] = ''
            IZD_XZMWRWZGV_KZGS_ORHG = [LH.KZGS.QLRM(KG, 'LKVIZGRLM') ULI KG RM HBH.KZGS]
            XZMWRWZGV_KZGS_ORHG = []
            ULI XKG RM IZD_XZMWRWZGV_KZGS_ORHG:
                RU LH.KZGS.RHWRI( XKG ):
                    XZMWRWZGV_KZGS_ORHG.ZKKVMW(XKG)
            (XOZHHLK, WVHG_KZGS) = RNKLIG_LKVIZGRLM(NLWFOV_MZNV, XZMWRWZGV_KZGS_ORHG)
            LK_SLFHV.KZGS.ZWW(LH.KZGS.WRIMZNV(WVHG_KZGS))
            LK = XOZHHLK(LK_CNO, HVOU.TOLYZO_RMUL)
            LK.__UROV__ = WVHG_KZGS
            LK_SLFHV.LKVIZGRLM_KZGS_NZK[LK.__UROV__] = XOZHHLK
            LK_SLFHV.LKVIZGRLM_XLMURT_NZK[LK.RW] = LK_CNO
            RU NLWFOV_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NLWFOV_NZK:
                LK_SLFHV.LKVIZGRLM_NLWFOV_NZK[NLWFOV_MZNV] = []
            LK_SLFHV.LKVIZGRLM_NLWFOV_NZK[NLWFOV_MZNV].ZKKVMW(LK.RW)
            LK_SLFHV.LKVIZGRLMH.ZKKVMW(LK)
            LK_SLFHV.LKVIZGRLM_NZK[LK.RW] = LK
            RU LK.RW RM LK_SLFHV.LK_HGZGFH:
                IZRHV eZOFVvIILI('wFKORXZGV LKVIZGRLM RW, LK DRGS RW=%H SZH YVVM FHVW'%(LK.RW))
            LK_SLFHV.LK_HGZGFH[LK.RW] = lKhGZGFH(LK)
            LK_SLFHV.LK_HGZGFH[LK.RW].RMHGZOO_GRNV = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%s:%n:%h')
            LK_SLFHV.LK_IVOLZW_GRNV[LK.RW] = LK._IVOLZW_GRNV RU OVM(LK._IVOLZW_GRNV)>8  VOHV HVOU.IVOLZW_GRNV
            RU OVM(LK._IVOLZW_GRNV) == 9:
                LK._IVOLZW_GRNV += HVOU.IVOLZW_GRNV
            HVOU.TOLYZO_RMUL.OLTTVI.RMUL('[yllg] %H RMHGZOOVW IVOLZW GRNV ZH: '%(LK.RW)+', '.QLRM([RG.HGIUGRNV('%s:%n:%h') ULI RG RM LK._IVOLZW_GRNV]))
        qLY(LK_SLFHV).HGZIG()

    WVU OLZW_WVKVMWVMXB(HVOU, LKVIZGRLM_WVKVMWVMXB_ORHG):
        ULI WVKVMWVMXB_CNO RM LKVIZGRLM_WVKVMWVMXB_ORHG:
            RU  'HFYQVXG' MLG RM WVKVMWVMXB_CNO.ZGGIRY:
                HVOU.OLTTVI.VIILI('%H'%VGIVV.GLHGIRMT(WVKVMWVMXB_CNO))
                IZRHV eZOFVvIILI('WVKVMWVMXB NFHG HVG HFYQVXG')
            RU  'WVKVMWVMXRVH' MLG RM WVKVMWVMXB_CNO.ZGGIRY:
                IZRHV eZOFVvIILI('WVKVMWVMXB NFHG HVG WVKVMWVMXRVH')
            HFYQVXG = HVOU.LK_EZFOG['NZHGVI'].LKVIZGRLM_NZK[WVKVMWVMXB_CNO.ZGGIRY['HFYQVXG']]
            ULI WVK_RW RM WVKVMWVMXB_CNO.ZGGIRY['WVKVMWVMXRVH'].HKORG(','):
                RU WVK_RW MLG RM HVOU.LK_EZFOG['NZHGVI'].LKVIZGRLM_NZK:
                    IZRHV eZOFVvIILI('WVKVMWVMXB %H XZMMLG ULFMW'%WVK_RW)
                WVK = HVOU.LK_EZFOG['NZHGVI'].LKVIZGRLM_NZK[WVK_RW]
                HFYQVXG._WVKVMWVMXRVH.ZKKVMW(WVK)
                HVOU.TOLYZO_RMUL.OLTTVI.RMUL('[yllg] %H RMHGZOOVW WVKVMWVMXB %H'%(HFYQVXG.RW, WVK.RW))

    WVU IVOLZW(HVOU):
        HVOU.LK_EZFOG['NZHGVI'].IVOLZW()

    WVU DLIP(HVOU):
        DSROV MLG HVOU.TOLYZO_RMUL.HGLK:
            # RU ML LKVIZGRLM VCRHGH
            # HVOU.HVMW_LK_GL_HVIEVI(HVOU.LK_EZFOG['NZHGVI'].LKVIZGRLMH[9].RW, 'FYRJIH6')

            HVOU.TOLYZO_RMUL.XLNKROV()
            ULI VCXSZMTV RM HVOU.VCXSZMTV_NZMZTVI.VCXSZMTVRMUL_NZK:
                HVOU.VCXSZMTV_NZMZTVI.VCXSZMTVRMUL_NZK[VCXSZMTV].XOLXP.FKWZGV()
            ULI LK RM HVOU.LMVGRNV_LK:
                LK.LMVGRNV_IVHFOG.HGZIG()
                GIB:
                    IVG = LK.DLIP()
                    LK.LMVGRNV_IVHFOG.VMW(IVG)
                VCXVKG vCXVKGRLM ZH V:
                    HVOU.OLTTVI.VIILI('VCVXFGV LMVGRNV LK UZROVW DRGS VCXVKGRLM: %H'%HGI(V))
                    LK.LMVGRNV_IVHFOG.VMW_GRNV = WZGVGRNV.WZGVGRNV.MLD()
                    LK._VIILI_NVHHZTV = HGI(V)
                    LK.LMVGRNV_IVHFOG.HGZGFH = 'UZROVW'
            RU OVM(HVOU.LMVGRNV_QLYH) > 9:
                QLY = HVOU.LMVGRNV_QLYH.KLK(9)
                QLY.LMVGRNV_IVHFOG.LK = QLY
                IFMMVI = qLY(QLY)
                HVOU.LMVGRNV_QLYH_IFMMVI_NZK[QLY.IZMWLN_RW] = IFMMVI
                IFMMVI.HGZIG()
            HVOU.LMVGRNV_LK.XOVZI()
            HVOU.XOLXP.FKWZGV()
            HVOU.IVOLZW()
            RU MLG HVOU.LK_EZFOG['NZHGVI'].LKVIZGRLMH:
                GRNV.HOVVK(8)
                XLMGRMFV
            # FKWZGV VCXSZMTV XOLXPH
            RU HVOU.TOLYZO_RMUL.YVZXLM RH MLG mLMV:
                HVOU.TOLYZO_RMUL.YVZXLM.uOZHS(HVOU.XOLXP.GRNV_GL_RMG())
            RU HVOU.XOLXP.MLD - HVOU.OZHG > HVOU.HOVVK_KVI_ILFMW:
                # WL GSV IVZO DLIP
                HVOU.LK_EZFOG['NZHGVI'].DLIP()
                HVOU.XOLXP.FKWZGV()
                HVOU.OZHG = HVOU.XOLXP.MLD
            VOHV:
                GRNV.HOVVK(7)
            GRNV.HOVVK(8)
//##**---------------- ./HGZIUOVVG/YZHV/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_HGIZGVTB.KB
RNKLIG SVOKVI.FGRO ZH FGRO
UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
RNKLIG GIZXVYZXP
RNKLIG ZXXLFMG

XOZHH xLMURTFIZGRLMvMTRMV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.KZIZ = {}

    WVU IVJFRIV(HVOU, K):
        HVOU.KZIZ[K] = [gIFV, '']

    WVU LKGRLMZO(HVOU, K, WVUZFOG=''):
        HVOU.KZIZ[K] = [uZOHV, WVUZFOG]

    WVU TVG(HVOU, K):
        RU K MLG RM HVOU.KZIZ:
            IZRHV eZOFVvIILI('MLG IVXLMTRAVW %H'%K)

    WVU KZIHV(HVOU, CNO):
        ULI P RM HVOU.KZIZ:
            RU HVOU.KZIZ[P][9] ZMW P MLG RM CNO.ZGGIRY:
                IZRHV eZOFVvIILI('IVJFRIVW KZIZNVGVI %H MLG HVG'%P)
            RU P RM CNO.ZGGIRY:
                HVOU.KZIZ[P][8] = CNO.ZGGIRY[P]


XOZHH hGIZGVTB(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU._UROV = __UROV__
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        RU 'RW' RM CNO.ZGGIRY:
            HVOU.RW = CNO.ZGGIRY['RW']
        VOHV:
            HVOU.RW = CNO.ZGGIRY['NLWFOV']
        HVOU.YLLP = CNO.ZGGIRY['YLLP']
        HVOU.IVTRLM  = 'xm'
        RU 'IVTRLM' RM CNO.ZGGIRY:
            HVOU.IVTRLM = CNO.ZGGIRY['IVTRLM']
        RU HVOU.IVTRLM == 'sp':
            RU HVOU.TOLYZO_RMUL.VCXSZMTVNZMZTVI RH MLG mLMV:
                HVOU.XOLXP = HVOU.TOLYZO_RMUL.TVG_VCXSZMTV_XOLXP('spt')
                HVOU.TOLYZO_RMUL.OLTTVI.RMUL("[yllg] %H FHV %H XOLXP: %H"%(HVOU.RW, 'spt', HVOU.XOLXP.MLD))
        VORU HVOU.IVTRLM == 'xm':
            RU HVOU.TOLYZO_RMUL.VCXSZMTVNZMZTVI RH MLG mLMV:
                HVOU.XOLXP = HVOU.TOLYZO_RMUL.TVG_VCXSZMTV_XOLXP('hhv')
                HVOU.TOLYZO_RMUL.OLTTVI.RMUL("[yllg] %H FHV %H XOLXP: %H"%(HVOU.RW, 'hhv', HVOU.XOLXP.MLD))
        GIB:
            HVOU.IVOLZW()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.TOLYZO_RMUL.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV("%", "|"))
            HVOU.TOLYZO_RMUL.OLTTVI.VIILI('%H VMXLFMGVIH VCXVKGRLM: %H'%(HVOU.RW, HGI(V) ))

    WVU IVOLZW(HVOU):
        HVOU.XOLXP.FKWZGV()
        HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.VEVIB
        HVOU.ZXXLFMGH = HVOU.TVG_ZXXLFMGH()
        HVOU.HRTMZOH = []

    WVU TVG_ZXXLFMGH(HVOU):
        IVGFIM [zXXLFMG(C) ULI C RM ["889999998021"]]

    WVU GZPV_XLNNZMW(HVOU, XLNNZMW, ZITFNVMGH):
        KIRMG('%H IVXVREVH XNW:%H'%(HVOU.RW, XLNNZMW))
        KIRMG(ZITFNVMGH)

    WVU DLIP(HVOU):
        KZHH
        # KIRMG HVOU.NLWFOV+' DLIPH'
//##**---------------- ./HGZIUOVVG/YZHV/HGLXP_LKVIZGRLM.KB
RNKLIG SVOKVI.FGRO ZH FGRO
UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM, xLMURTFIZGRLMvMTRMV
RNKLIG GIZXVYZXP

XOZHH hGPlKVIZGRLM(lKVIZGRLM):
    '''
    yZHV xOZHH ULI ZOO LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPlKVIZGRLM, HVOU).__RMRG__(CNO, TOLYZO_RMUL)

    WVU IVOLZW(HVOU):
        HFKVI(hGPlKVIZGRLM, HVOU).IVOLZW()

    WVU GZPV_XLNNZMW(HVOU, XLNNZMW, ZITFNVMGH):
        KIRMG('%H IVXVREVH XNW:%H'%(HVOU.RW, XLNNZMW))
        KIRMG(ZITFNVMGH)

    WVU DLIP(HVOU):
        KZHH

//##**---------------- ./HGZIUOVVG/YZHV/YZHV_UFMXGRLMH.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG KRXPOV
RNKLIG WZGVGRNV
UILN FYRJGLLO.SVOKVI RNKLIG kRXPOVdIZKKVI
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO

WVU KFYORHS(GLKRXMZNV, WZGZ):
    KFYVI = KY.__WRXG__[GLKRXMZNV+'kFYORHSVI']()
    IVG = KFYVI.kFYORHS(WZGZ)
    IVGFIM IVG

WVU KFYORHS_XLNNZMW(ZITH, TOLYZO_RMUL, NVHHZTV_ORHG, HGLK_VEVMG):
    KWZGZ = KRXPOV.OLZWH(ZITH['WZGZ']) # GSV KRXPOVW KFYHFY WZGZ
    RU 'IVUVIVMXV' MLG RM ZITH:
        ZITH['IVUVIVMXV'] = FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(4)
    GRNVLFG = ZITH['GRNVLFG'] # GRNVLFG VOZKHVW
    WZGZ = KWZGZ.VCKLIG('WW')
    WZGZ.IVUVIVMXV = ZITH['IVUVIVMXV']
    HFYVI = KY.__WRXG__['xLNNZMWiVKOBhFYHXIRYVI']()
    LOW_RMW = HFYVI.tVGrMWVC()
    IVG = KFYORHS('xLNNZMW', WZGZ)
    RU MLG IVG:
        IVGFIM (uZOHV, 'KFYORHS XLNNZM UZROVW')
    IVU = WZGZ.IVUVIVMXV
    # MLD XSVXP ULI [grnvlfg] HVXLMWH GL HVV RU XLNNZMW IVKOB RH GSVIV
    HGZIG_GRNV = WZGVGRNV.WZGVGRNV.MLD()

    # KFYVI = KY.__WRXG__['xLNNZMWiVKOBkFYORHSVI']()
    # WZGZ = KY.__WRXG__['xLNNZMWiVKOB']()
    # WZGZ.IVUVIVMXV = 'ZHW6-976PWW'
    # KFYVI.kFYORHS(WZGZ)
    DSROV gIFV:
        MVD_RMW = HFYVI.tVGrMWVC()
        RU MVD_RMW > LOW_RMW:
            ULI R RM IZMTV(LOW_RMW, MVD_RMW):
                WY = HFYVI.tVGeZO(R+8)
                RU WY.IVUVIVMXV == IVU:
                    KIRMG('TLG RG')
                    IVGFIM (gIFV, WY.IVKOB)
        MLD = WZGVGRNV.WZGVGRNV.MLD()
        RU (MLD-HGZIG_GRNV).GLGZO_HVXLMWH() > GRNVLFG:
            IVGFIM (uZOHV, 'UZROVW GL TVG IVKOB')


RU __MZNV__ == '__NZRM__':
    KY.lKVMkFYHFY()
    GLKRXMZNV = 'xLNNZMW'
    LY = KY.__WRXG__[GLKRXMZNV]()
    LY.IVUVIVMXV = 'ZHW6-976PWW'
    LY.KILXVHH = 67
    KD = kRXPOVdIZKKVI([])
    WZGZ = KD.DIZK(LY)
    KFYORHS_XLNNZMW({'WZGZ': KRXPOV.WFNKH(WZGZ), 'GRNVLFG':4 }, mLMV, mLMV)

//##**---------------- ./HGZIUOVVG/YZHV/YZHV_QLY.KB
RNKLIG SVOKVI.FGRO ZH FGRO
UILN DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
RNKLIG WZGVGRNV
RNKLIG GIZXVYZXP

UILN YZHV_GZHP RNKLIG gZHP
XOZHH qLY(LYQVXG):
    '''
    xOZHH ULI ZOO QLYH
    '''
    WVU __RMRG__(HVOU, CNO, OLT, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        HVOU.LM_GRNV = []
        HVOU.NLWV = mLMV
        HVOU.KILTIZN = ""
        HVOU.XLMURT = ""
        HVOU.OLT = OLT
        HVOU.HXSVWFOV = []
        HVOU.OZHG = HVOU.XOLXP.MLD - WZGVGRNV.GRNVWVOGZ(HVXLMWH=7)
        RU "LM_WZB" RM CNO.ZGGIRY:
            HVOU.LM_WZB = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, CNO.ZGGIRY["LM_WZB"])
        VOHV:
            HVOU.LM_WZB = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, "")

        RU "RM_HVHHRLM" RM CNO.ZGGIRY:
            HVOU.RM_HVHHRLM = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, CNO.ZGGIRY["RM_HVHHRLM"])
        VOHV:
            HVOU.RM_HVHHRLM = dLIPRMTwZBnZMZTVI(HVOU.VCXSZMTV_NZMZTVI, "")

        RU "KILTIZN" RM CNO.ZGGIRY:
            HVOU.KILTIZN = CNO.ZGGIRY["KILTIZN"]
        RU "XLMURT" RM CNO.ZGGIRY:
            HVOU.XLMURT = CNO.ZGGIRY["XLMURT"]
        HVOU.GZHP = gZHP(HVOU.KILTIZN, HVOU.XLMURT)
        # RU OVM(HVOU.KILTIZN) == 9:
            # iZRHVeZOFV("QLY XZMMLG SZEV VNKGB KILTIZN")
        RU "VEVIB" RM CNO.ZGGIRY:
            HVOU.NLWV = "VEVIB"
            HVOU.VEVIB = FGRO.KZIHV_GRNVWVOGZ(CNO.ZGGIRY["VEVIB"])
            HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.VEVIB
        VORU "LM_GRNV" RM CNO.ZGGIRY:
            HVOU.NLWV = "LM_GRNV"
            HVOU.K_VEVMG = 9
            ULI GRNV_HGI RM CNO.ZGGIRY["LM_GRNV"].HKORG(","):
                HVOU.LM_GRNV.ZKKVMW(FGRO.KZIHV_GRNV(GRNV_HGI.HGIRK()))
            HVOU.LM_GRNV.HLIG()
        VORU "HXSVWFOV" RM CNO.ZGGIRY:
            HVOU.NLWV = "HXSVWFOV"
            HOORHG = CNO.ZGGIRY["HXSVWFOV"].HKORG(",")
            ULI HO RM HOORHG:
                HVOU.HXSVWFOV.ZKKVMW( (FGRO.KZIHV_GRNV(HO.HKORG("-")[9]), FGRO.KZIHV_GRNV(HO.HKORG("-")[8]) ))
        HVOU.IVOLZW()


    WVU IVOLZW(HVOU):
        HVOU.XOLXP.FKWZGV()
        RU HVOU.NLWV == "LM_GRNV":
            HVOU.K_VEVMG = 9
            ULI LMGRNV RM HVOU.LM_GRNV:
                RU HVOU.XOLXP.MLD.GRNV() > LMGRNV:
                    HVOU.K_VEVMG += 8



    WVU DLIP(HVOU):
        KIRMG(GIZXVYZXP.KIRMG_HGZXP())
        RU HVOU.GZHP.RH_IFMMRMT:
            HVOU.GZHP.KLOO()
        RU MLG HVOU.LM_WZB.RH_GIZWRMT_WZB():
            IVGFIM 9
        VORU MLG HVOU.RM_HVHHRLM.RH_RM_HVHHRLM():
            IVGFIM 9
        RU HVOU.NLWV == "LM_GRNV":
            RU HVOU.K_VEVMG < OVM(HVOU.LM_GRNV) ZMW HVOU.XOLXP.MLD.GRNV() >= HVOU.LM_GRNV[HVOU.K_VEVMG]:
                RU HVOU.GZHP.RH_IFMMRMT:
                    HVOU.OLT.RMUL("QLY [%H] HVVNH GL YV YOLXPVW", HVOU.KILTIZN)
                HVOU.GZHP.IFM()
                HVOU.OZHG = HVOU.XOLXP.MLD
                HVOU.K_VEVMG += 8
        VORU HVOU.NLWV == "HXSVWFOV":
            HSLFOW_HGZIG = uZOHV
            ULI GRNVKZRI RM HVOU.HXSVWFOV:
                RU FGRO.XSVXP_RM_HVHHRLM(HVOU.XOLXP.MLD.GRNV(), GRNVKZRI[9],  GRNVKZRI[8]):
                    HSLFOW_HGZIG = gIFV
                    RU MLG HVOU.GZHP.RH_IFMMRMT :
                        HVOU.GZHP.IFM()
                        HVOU.OLT.RMUL("QLY [%H] HGZIG GRNV ZIIREVH, DROO YLLG", HVOU.KILTIZN)
                        HVOU.OZHG = HVOU.XOLXP.MLD
            RU MLG HSLFOW_HGZIG ZMW HVOU.GZHP.RH_IFMMRMT:
                HVOU.GZHP.PROO()
                HVOU.OLT.RMUL("QLY [%H] HGLK ZIIREVH, DROO HGLK", HVOU.KILTIZN)
        VORU HVOU.NLWV == "VEVIB":
            RU HVOU.XOLXP.MLD - HVOU.OZHG > HVOU.VEVIB:
                RU HVOU.GZHP.RH_IFMMRMT:
                    HVOU.OLT.RMUL("QLY [%H] HVVNH GL YV YOLXPVW", HVOU.KILTIZN)
                HVOU.GZHP.IFM()
                HVOU.OZHG = HVOU.XOLXP.MLD

//##**---------------- ./HGZIUOVVG/YZHV/ZXXLFMG.KB
UILN SVOKVI.FGRO RNKLIG RNKLIG_LKVIZGRLM
RNKLIG LH

XOZHH yZHVhMZKHSLG(LYQVXG):
    WVU __RMRG__(HVOU, mZNV):
        HVOU.mZNV = mZNV
        HVOU.hGIZGVTBrw = hGIZGVTBrw
        HVOU.gyiVXE     = []
        HVOU.oREVlIWVIH = []
        HVOU.lIWVIH[]
        HVOU.oLMTkLH  = 9
        HVOU.hSLIGkLH = 9
        HVOU.bwoLMTkLH  = 9
        HVOU.bwhSLIGkLH = 9


XOZHH zXXLFMG(LYQVXG):
    WVU __RMRG__(HVOU, rMEVHGNVMGrW, zKRgBKV, rHzXGREV):
        HVOU.rMEVHGNVMGrW = rMEVHGNVMGrW
        HVOU.zKRgBKV = zKRgBKV # CG, ZKR...
        HVOU.rHzXGREV = rHzXGREV
        HVOU.xZKRGZO
        HVOU.FGIZWV = mLMV

XOZHH hGPzXXLFMG(zXXLFMG):
    WVU __RMRG__(HVOU):
        HFKVI(hGPzXXLFMG, HVOU).__RMRG__()


//##**---------------- ./HGZIUOVVG/YZHV/DLIPRMTWZB.KB
RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG IV
RNKLIG WZGVGRNV

DVVP_WZB_ORHG = ['NLMWZB', 'GFVHWZB', 'DVWMVHWZB', 'GSFIHWZB', 'UIRWZB',
                    'HZGFIWZB', 'HFMWZB', 'NLM', 'GFVH', 'DVW', 'GSFI', 'UIR','HZG','HFM', 'DVVPVMW', 'DVVPWZB']

XOZHH xLN(LYQVXG):
    WVU __RMRG__(HVOU, GZITVG, XLN):
        HVOU.GZITVG = GZITVG
        HVOU.XLN = XLN

XOZHH xLNwZB(LYQVXG):
    WVU __RMRG__(HVOU, WZB, XLN):
        WZB_ORHG = {}
        WZB_ORHG['NLMWZB'] = [9]
        WZB_ORHG['NLM'] = [9]
        WZB_ORHG['GFVHWZB'] = [8]
        WZB_ORHG['GFVH'] = [8]
        WZB_ORHG['DVW'] = [7]
        WZB_ORHG['DVWMVHWZB'] = [7]
        WZB_ORHG['GSFI'] = [6]
        WZB_ORHG['GSFIHWZB'] = [6]
        WZB_ORHG['UIR'] = [5]
        WZB_ORHG['UIRWZB'] = [5]
        WZB_ORHG['HZG'] = [4]
        WZB_ORHG['HZGFIWZB'] = [4]
        WZB_ORHG['HFM'] = [3]
        WZB_ORHG['HFMWZB'] = [3]
        WZB_ORHG['DVVPVMW'] = [4, 3]
        WZB_ORHG['DVVPVMW'] = [4, 3]
        WZB_ORHG['DVVPWZB'] = [9, 8,7,6,5]
        WZB_ORHG['DVVPWZB'] = [9, 8,7,6,5]
        HVOU.WZB_ORHG = WZB_ORHG[WZB]
        HVOU.XLN = XLN

    WVU XSVXP_WZB(HVOU):
        WZB = WZGVGRNV.WZGVGRNV.GLWZB().DVVPWZB()
        RU WZB RM HVOU.WZB_ORHG:
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV

XOZHH dLIPRMTwZBnZMZTVI(LYQVXG):
    WVU __RMRG__(HVOU, VCXSZMTV_NZMZTVI, HGI):
        HVOU.VCXSZMTV_NZMZTVI = VCXSZMTV_NZMZTVI
        HVOU.ZOO_WZB = uZOHV
        RU OVM(HGI) == 9:
            HVOU.ZOO_WZB = gIFV
            IVGFIM
        HVOU.HGI = "".QLRM(HGI.HKORG())
        HVOU.XLN_ORHG = []
        HVOU.XLN_DVVPWZB_ORHG=[]
        VCXSZMTV_ORHG = IV.HKORG("[\^\|]+", HVOU.HGI)
        RU VCXSZMTV_ORHG[9].OLDVI() RM DVVP_WZB_ORHG:
            HVOU.URIHG_XLN_DVVPWZB = xLNwZB(VCXSZMTV_ORHG[9].OLDVI(), mLMV)
            HVOU.URIHG_XLN = mLMV
        VOHV:
            HVOU.URIHG_XLN = HVOU.VCXSZMTV_NZMZTVI.VCXSZMTVRMUL_NZK[ VCXSZMTV_ORHG[9] ]
            HVOU.URIHG_XLN_DVVPWZB = mLMV
        ULI VCXSZMTV RM VCXSZMTV_ORHG[8:]:
            RU VCXSZMTV.OLDVI() RM DVVP_WZB_ORHG:
                HVOU.XLN_DVVPWZB_ORHG.ZKKVMW(xLNwZB(VCXSZMTV.OLDVI(), HVOU.HGI[HVOU.HGI.RMWVC(VCXSZMTV)-8]))
            VOHV:
                HVOU.XLN_ORHG.ZKKVMW(xLN( HVOU.VCXSZMTV_NZMZTVI.VCXSZMTVRMUL_NZK[VCXSZMTV], HVOU.HGI[HVOU.HGI.RMWVC(VCXSZMTV)-8]))


    WVU RH_GIZWRMT_WZB(HVOU):
        #KIRMG(WZGVGRNV.WZGVGRNV.MLD())
        RU HVOU.ZOO_WZB:
            IVGFIM gIFV
        RU HVOU.URIHG_XLN RH MLG mLMV:
            #KIRMG('URIHG XLN')
            IVG = HVOU.URIHG_XLN.XOLXP.RH_GIZWRMT_WZB
            #KIRMG(HVOU.URIHG_XLN.XOLXP.MLD)
            #HVOU.URIHG_XLN.XOLXP.WVYFT()
            #KIRMG('IVG ', IVG)
        VOHV:
            IVG = HVOU.URIHG_XLN_DVVPWZB.XSVXP_WZB()
        # KIRMG(HVOU.XLN_ORHG)
        ULI XLN RM HVOU.XLN_ORHG:
            RU XLN.XLN == "^":
                IVG = IVG ZMW XLN.GZITVG.XOLXP.RH_GIZWRMT_WZB
                #KIRMG "ZMW",XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
            VORU XLN.XLN == "|":
                #KIRMG(XLN.GZITVG)
                #XLN.GZITVG.XOLXP.WVYFT()
                IVG = IVG LI XLN.GZITVG.XOLXP.RH_GIZWRMT_WZB
                #KIRMG('HVXLMW ', IVG)
                #KIRMG "LI", XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
        ULI XLN RM HVOU.XLN_DVVPWZB_ORHG:
            RU XLN.XLN == "^":
                IVG = IVG ZMW XLN.XSVXP_WZB()
                #KIRMG "ZMW",XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
            VORU XLN.XLN == "|":
                IVG = IVG LI XLN.XSVXP_WZB()
                #KIRMG "LI", XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
        #KIRMG('IVHFOG ', IVG)
        IVGFIM IVG

    WVU RH_RM_HVHHRLM(HVOU):
        RU HVOU.ZOO_WZB:
            IVGFIM gIFV
        IVG = HVOU.URIHG_XLN.XOLXP.RH_RM_HVHHRLM
        ULI XLN RM HVOU.XLN_ORHG:
            RU XLN.XLN == "^":
                IVG  = IVG ZMW XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
                # KIRMG "ZMW",XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
            VORU XLN.XLN == "|":
                IVG  = IVG LI XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
                # KIRMG "LI", XLN.GZITVG.XOLXP.RH_RM_HVHHRLM
        IVGFIM IVG
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_XSVXPLK.KB
# RNKLIG SVOKVI.FGRO ZH FGRO
# UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
# RNKLIG GIZXVYZXP
# RNKLIG LH
UILN SVOKVI.FGRO RNKLIG XSVXP_RM_HVHHRLM, KZIHV_GRNV, NRMFH_GRNV, ZWW_GRNV, KZIHV_GRNVWVOGZ
RNKLIG WZGVGRNV
UILN YZHV.YZHV_WZGZ_HGIFXG RNKLIG xZMZIBiVKLIGwZGZdIZKKVI#, xZMZIBwZGZgBKV

XOZHH xSVXPlKnVGILMLNV(LYQVXG):
    WVU __RMRG__(HVOU, CNO, GRNV_HKZM, XOLXP, TOLYZO_RMUL):
        HVOU.CNO = CNO
        HVOU.KLORXB = mLMV
        HVOU.VGZ = mLMV
        HVOU.VEVIB = mLMV
        HVOU.OZHG = mLMV
        HVOU.XOLXP = XOLXP
        HVOU.OZHG = HVOU.XOLXP.MLD - WZGVGRNV.GRNVWVOGZ(HVXLMWH=89)
        RU 'VGZ' RM CNO.ZGGIRY:
            HVOU.VGZ = KZIHV_GRNVWVOGZ(CNO.ZGGIRY['VGZ'])
            HVOU.GZITVG = NRMFH_GRNV(GRNV_HKZM.HGZIG, HVOU.VGZ)
            HVOU.KLORXB = 'VGZ'
        VORU 'vgz' RM CNO.ZGGIRY:
            HVOU.VGZ = KZIHV_GRNVWVOGZ(CNO.ZGGIRY['vgz'])
            HVOU.GZITVG = NRMFH_GRNV(GRNV_HKZM.HGZIG, HVOU.VGZ)
            HVOU.KLORXB = 'VGZ'
        VORU 'VEVIB' RM CNO.ZGGIRY:
            HVOU.VEVIB = KZIHV_GRNVWVOGZ(CNO.ZGGIRY['VEVIB'])
            HVOU.KLORXB = 'VEVIB'
            HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.VEVIB

    WVU XSVXP_DLIP(HVOU):
        RU HVOU.KLORXB RH mLMV:
            IVGFIM gIFV
        VORU HVOU.KLORXB == 'VEVIB':
            RU HVOU.XOLXP.MLD > HVOU.OZHG+HVOU.VEVIB:
                HVOU.OZHG = HVOU.XOLXP.MLD
                IVGFIM gIFV
            VOHV:
                IVGFIM uZOHV
        VORU HVOU.KLORXB == 'VGZ':
            RU XSVXP_RM_HVHHRLM(HVOU.GZITVG, HVOU.OZHG.GRNV(), HVOU.XOLXP.MLD.GRNV()):
                KIRMG(HVOU.GZITVG, HVOU.OZHG.GRNV(), HVOU.XOLXP.MLD.GRNV())
                HVOU.OZHG = HVOU.XOLXP.MLD
                IVGFIM gIFV
            VOHV:
                HVOU.OZHG = HVOU.XOLXP.MLD
                IVGFIM uZOHV

XOZHH yZHVxSVXPlk(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO XSVXP LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL):
        HVOU._UROV = __UROV__
        HVOU.CNO = CNO
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.NLMHGVI = NLMHGVI
        HVOU.GRNV_HKZM = GRNV_HKZM
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.NVGILMLNV = xSVXPlKnVGILMLNV(CNO, GRNV_HKZM, HVOU.XOLXP, TOLYZO_RMUL)
        RU 'RW' RM HVOU.CNO.ZGGIRY:
            HVOU.RW = HVOU.CNO.ZGGIRY['RW']
        VOHV:
            HVOU.RW = HVOU.CNO.ZGGIRY['NLWFOV']

    WVU XSVXP_DLIP(HVOU):
        IVGFIM HVOU.NVGILMLNV.XSVXP_DLIP()

    WVU IVOLZW(HVOU):
        KZHH

    WVU IVTRHGVI_XZMZIB_WZGZ(HVOU, RW, UIVJFVMXB):
        RU RW RM HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG:
            IZRHV eZOFVvIILI("XZMZIB WZGZ %H RH ZOIVZWB IVTRHGVIVW"%RW)
        VOHV:
            HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG[RW] = xZMZIBiVKLIGwZGZdIZKKVI(RW, UIVJFVMXB)

    WVU FKWZGV_XZMZIB_WZGZ(HVOU, RW, WZGZ):
        RU RW MLG RM HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG:
            IZRHV eZOFVvIILI("XZMZIB WZGZ %H MLG IVTRHGVIVW, BLF HSLFOW XZOO IVTRHGVI_XZMZIB_WZGZ() URIHG"%RW)
        VOHV:
            HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG[RW].WZGZ = WZGZ
            HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG[RW].gh = WZGVGRNV.WZGVGRNV.MLD()

    WVU DLIP(HVOU):
        IVGFIM gIFV        # KIRMG HVOU.NLWFOV+' DLIPH'
//##**---------------- ./HGZIUOVVG/YZHV/XLMURTFIZGRLM_VMTRMV.KB
RNKLIG SVOKVI.FGRO ZH FGRO
UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
RNKLIG GIZXVYZXP


XOZHH xLMURTFIZGRLMvMTRMV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.KZIZ = {}

    WVU IVJFRIV(HVOU, K):
        HVOU.KZIZ[K] = [gIFV, '']

    WVU LKGRLMZO(HVOU, K, WVUZFOG=''):
        HVOU.KZIZ[K] = [uZOHV, WVUZFOG]

    WVU TVG(HVOU, K):
        RU K MLG RM HVOU.KZIZ:
            IZRHV eZOFVvIILI('MLG IVXLMTRAVW %H'%K)

    WVU KZIHV(HVOU, CNO):
        ULI P RM HVOU.KZIZ:
            RU HVOU.KZIZ[P][9] ZMW P MLG RM CNO.ZGGIRY:
                IZRHV eZOFVvIILI('IVJFRIVW KZIZNVGVI %H MLG HVG'%P)
            RU P RM CNO.ZGGIRY:
                HVOU.KZIZ[P][8] = CNO.ZGGIRY[P]

//##**---------------- ./HGZIUOVVG/YZHV/WZGZ_LKVIZGRLM.KB
RNKLIG SVOKVI.FGRO ZH FGRO
UILN YZHV.DLIPRMTWZB RNKLIG dLIPRMTwZBnZMZTVI
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM, xLMURTFIZGRLMvMTRMV
UILN YZHV.WZGZ_LKVIZGRLM RNKLIG wZGZlKVIZGRLM
RNKLIG GIZXVYZXP

XOZHH dLIPUOLDxLMGVCG(LYQVXG):
    WVU __RMRG__(HVOU, VEVMGRW):
        HVOU.VEVMGRW = VEVMGRW
        HVOU.WLMV = []

XOZHH wZGZlKVIZGRLM(LYQVXG):
    '''
    yZHV xOZHH ULI ZOO LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU._UROV = __UROV__
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.VCXSZMTV_NZMZTVI = TOLYZO_RMUL.VCXSZMTVNZMZTVI
        RU 'RW' RM CNO.ZGGIRY:
            HVOU.RW = CNO.ZGGIRY['RW']
        VOHV:
            HVOU.RW = CNO.ZGGIRY['NLWFOV']

        HVOU.IVTRLM  = 'xm'
        RU 'IVTRLM' RM CNO.ZGGIRY:
            HVOU.IVTRLM = CNO.ZGGIRY['IVTRLM']
        RU HVOU.IVTRLM == 'sp':
            RU HVOU.TOLYZO_RMUL.VCXSZMTVNZMZTVI RH MLG mLMV:
                HVOU.XOLXP = HVOU.TOLYZO_RMUL.TVG_VCXSZMTV_XOLXP('spt')
                HVOU.TOLYZO_RMUL.OLTTVI.RMUL("[yllg] %H FHV %H XOLXP: %H"%(HVOU.RW, 'spt', HVOU.XOLXP.MLD))
        VORU HVOU.IVTRLM == 'xm':
            RU HVOU.TOLYZO_RMUL.VCXSZMTVNZMZTVI RH MLG mLMV:
                HVOU.XOLXP = HVOU.TOLYZO_RMUL.TVG_VCXSZMTV_XOLXP('hhv')
                HVOU.TOLYZO_RMUL.OLTTVI.RMUL("[yllg] %H FHV %H XOLXP: %H"%(HVOU.RW, 'hhv', HVOU.XOLXP.MLD))

        GIB:
            HVOU._RMRG()
        VCXVKG vCXVKGRLM ZH V:
            HVOU.TOLYZO_RMUL.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX().IVKOZXV("%", "|"))
            HVOU.TOLYZO_RMUL.OLTTVI.VIILI('%H VMXLFMGVIH VCXVKGRLM: %H'%(HVOU.RW, HGI(V) ))

    WVU _RMRG(HVOU):
        HVOU.XOLXP.FKWZGV()
        HVOU.OZHG = HVOU.XOLXP.MLD - HVOU.VEVIB
        HVOU.GLWL = []

    WVU IVOLZW(HVOU):
        HVOU._RMRG()

    WVU GZPV_XLNNZMW(HVOU, XLNNZMW, ZITFNVMGH):
        KIRMG('%H IVXVREVH XNW:%H'%(HVOU.RW, XLNNZMW))
        KIRMG(ZITFNVMGH)

    WVU WLDLIP(HVOU, WZGZXLMGVCG):
        HVOU.DLIP(WZGZXLMGVCG)

    WVU DLIP(HVOU, WZGZXLMGVCG):
        IVGFIM gIFV
        # KIRMG HVOU.NLWFOV+' DLIPH'
//##**---------------- ./HGZIUOVVG/YZHV/YZHV_WZGZ_HGIFXG.KB
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
# RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
# UILN VMFN RNKLIG vMFN,FMRJFV
RNKLIG WZGVGRNV
RNKLIG QHLM
RNKLIG OANZ

# @FMRJFV
# XOZHH xZMZIBwZGZgBKV(vMFN):
    # HGIRMT = 9
    # QHLM = 8
    # RMG = 7
    # YBGV = 6
    # WRXG = 5
    # OANZ_HGIRMT = 4

XOZHH xZMZIBiVKLIGwZGZ(LYQVXG):
    ''' GSRH WZGZ RH TLRMT GL TVMVIZGVW YB XZMZIB'''
    WVU __RMRG__(HVOU):
        HVOU.UIVJFVMXB = 6
        HVOU.WZGZ = mLMV
        HVOU.RW = mLMV
        HVOU.gh = mLMV

    WVU hVGuIVJFVMXB(HVOU, UIV):
        HVOU.UIVJFVMXB = UIV
        IVGFIM HVOU

    WVU hVGrW(HVOU, RW):
        HVOU.RW = RW
        IVGFIM HVOU


    WVU VCKLIG(HVOU):
        IVGFIM {'RW':HVOU.RW, 'WZGZ':HVOU.WZGZ, 'UIVJFVMXB':HVOU.UIVJFVMXB, 'gh': HVOU.gh}

    WVU QHLMRAV(HVOU):
        QM = QHLM.WFNKH(HVOU.VCKLIG())
        IVGFIM QM

    WVU QHLMRAV_GL_OANZ(HVOU):
        IVGFIM OANZ.XLNKIVHH(HVOU.QHLMRAV())



XOZHH xZMZIBiVKLIGwZGZdIZKKVI(LYQVXG):
    '''xZMZIBiVKLIGwZGZnZMZTVI, DROO FMKZXP WZGZ IVXVREVW UILN XZMZIB
    '''
    WVU __RMRG__(HVOU, RW, UIVJFVMXB):
        HVOU.IVKLIG_UIVJFVMXB = UIVJFVMXB
        HVOU.WZGZ_GBKV = -8
        HVOU.WZGZ = mLMV
        HVOU.OZHG_GRNVHGZNK = WZGVGRNV.WZGVGRNV.MLD()
        HVOU.gh = mLMV
        HVOU.RW = RW
        HVOU.HVMWRMT = 9

    WVU UIVJFVMXB(HVOU, UIVJFVMXB):
        HVOU.IVKLIG_UIVJFVMXB = UIVJFVMXB
        IVGFIM HVOU

    WVU WZGZ_GBKV(HVOU, WZGZGBKV):
        HVOU.WZGZ_GBKV = WZGZGBKV
        IVGFIM HVOU

    WVU WZGZ(HVOU, WZGZ):
        HVOU.WZGZ = WZGZ
        IVGFIM HVOU

    WVU MVVW_IVOZB(HVOU, MLD):
        RU HVOU.gh RH MLG mLMV ZMW (MLD-HVOU.OZHG_GRNVHGZNK).GLGZO_HVXLMWH() > HVOU.IVKLIG_UIVJFVMXB:
            # HVOU.OZHG_GRNVHGZNK = MLD
            HVOU.HVMWRMT = 8
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV

    WVU VCKLIG(HVOU):
        IVGFIM {'RW':HVOU.RW, 'WZGZ':HVOU.WZGZ, 'gh':HVOU.gh.HGIUGRNV('%b%N%W-%s:%n:%h.%U')}

    WVU QHLMRAV(HVOU):
        QM = QHLM.WFNKH(HVOU.VCKLIG())
        IVGFIM QM

    WVU QHLMRAV_GL_OANZ(HVOU):
        IVGFIM OANZ.XLNKIVHH(HVOU.QHLMRAV().VMXLWV('FGU1'))

    WVU KZXP_WZGZ(HVOU):
        GL_HVMW = HVOU.QHLMRAV_GL_OANZ()
        HVOU.gh = mLMV
        IVGFIM GL_HVMW

//##**---------------- ./HGZIUOVVG/IVOVZHV.HS
HVG -V
. /RMX/EVIHRLM.RMX
NZPV
NPWRI -K /LKG/EVIHRLM/$xlnkrov_evihrlm/HGZIUOVVG
XK -i ./* /LKG/EVIHRLM/$xlnkrov_evihrlm/HGZIUOVVG/
GLFXS /LKG/EVIHRLM/$xlnkrov_evihrlm/HGZIUOVVG/__RMRG__.KB
NPWRI -K /LKG/HGZIUOVVG
XK VGX/HGZIUOVVG.RMX /RMX/
IN -IU /LKG/HGZIUOVVG/HGZIUOVVG
OM -H  /LKG/EVIHRLM/$xlnkrov_evihrlm/HGZIUOVVG /LKG/HGZIUOVVG/HGZIUOVVG
XK GLLO/KLHGDZIMRMT.KB /LKG/EVIHRLM/$xlnkrov_evihrlm/YRM/
XK GLLO/XSVXPVME.KB  /LKG/EVIHRLM/${xlnkrov_evihrlm}/YRM/
//##**---------------- ./HGZIUOVVG/HGZIUOVVG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG TVGLKG
RNKLIG XLNKLMVMG.HBHGVN ZH HBHGVN
# UILN RMGVIUZXV.TFR RNKLIG hGZIGUOVVGtfr
UILN YZHV.YZHV_WZGZOLZWVI RNKLIG wZGZOLZWVInZMZTVI
UILN YZHV.YZHV_DZIMRMT RNKLIG dZIMRMTnZMZTVI
UILN YZHV.YZHV_TFMRXLIM RNKLIG tFMRXLIMzKKORXZGRLM
UILN XLNKLMVMG.GRNVI RNKLIG gRNVI
UILN XLNKLMVMG.KFYHFYNZMZTVI RNKLIG kFYhFYnZMZTVI
UILN XLNKLMVMG.HBHGVNNVHHZTV RNKLIG hBHGVNnVHHZTVnZMZTVI
UILN XLNKLMVMG.HBHGVNXLMGILO RNKLIG hBHGVNxLMGILOnZMZTVI
UILN XLNKLMVMG.XZHSGIZMHUVI RNKLIG xZHSgIZMHUVInZMZTVI
UILN XLNKLMVMG.LKIVXLIWNZMZTVI RNKLIG lKiVXLIWnZMZTVI
UILN XLNKLMVMG.YLLGHGIZK RNKLIG yLLGHGIZK
UILN XLNKLMVMG.XLNNZMWVI RNKLIG yIRWTV
# UILN XLNKLMVMG.HLK RNKLIG hlknLMRGLI
UILN XLNKLMVMG.NLWFOVNZMZTVI RNKLIG nLWFOVnZMZTVI
UILN XLNNFMRXZGV.XORVMG RNKLIG hGZIUOVVGwLXPVI
UILN XLNKLMVMG.YILZWXZHG RNKLIG yILZWXZHGsVOKVI
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG HRTMZO
RNKLIG LH
# RNKLIG GLLO.YVZXLM ZH YVZXLM
RNKLIG XLNKLMVMG.YZXPVI ZH YZXPVI
#RNKLIG GSIVZWRMT
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
UILN YZHV RNKLIG NZMZTVNVMG, TOLYZORMUL
UILN FYRJGLLO.UROV RNKLIG RH_UROV_VCRHG
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG KHFGRO
RNKLIG GIZXVYZXP
UILN GLLO.HSNHGZGFH RNKLIG hSNhGZGFH
UILN SVOKVI.FGRO RNKLIG KZIHV_GRNV
UILN FYRJGLLO.FGRO RNKLIG TVG_GRW
LH.VMERILM['gvin'] = 'CGVIN-XLOLI'

WVU kZIHVhBHGVN(GIVV, TOLYZO_RMUL, LKIVXLIWVI):
    HBHGVN = NZMZTVNVMG.nZMZTVNVMG(GIVV, TOLYZO_RMUL)
    IVGFIM HBHGVN

WVU NZRM(UROVMZNV, GRNVI, RH_HRN, YVZXLM, HVGGRMTH):
    IVGFIM HBHGVN.hBHGVN(UROVMZNV, GRNVI, RH_HRN, YVZXLM, HVGGRMTH)

WVU NZRM_TFR(UROVMZNV, GRNVI, RH_HRN, YVZXLM, HVGGRMTH):
    IVGFIM HBHGVN.hBHGVN(UROVMZNV, GRNVI, RH_HRN, YVZXLM, HVGGRMTH)

WVU HRN_KZIHV(CNOUROV, GRNVI):
    GIVV = VGIVV.KZIHV(CNOUROV)
    HRNMLWV = GIVV.URMW('HRN')
    HGZIG = HRNMLWV.URMW('HGZIG').ZGGIRY['EZOFV']
    VMW = HRNMLWV.URMW('VMW').ZGGIRY['EZOFV']
    HKVVW = RMG(HRNMLWV.URMW('HKVVW').ZGGIRY['EZOFV'])
    GRNVI.HRN_HVG(HGZIG, VMW, HKVVW)

RU __MZNV__ == '__NZRM__':
    CNOUROV=''
    TFR = uZOHV
    HRN = uZOHV
    KIRMG_OLT = uZOHV
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'X:ETKHV', ['XLMURT=', 'EVIHRLM', 'TFR','HRN', 'KIRMG', 'VMGIFHG'])
    T_TOLYZORMUL = TOLYZORMUL.tOLYZORMUL()
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-X', '--XLMURT'):
            CNOUROV = ZIT
        RU LKG RM ('-T', '--TFR'):
            TFR = gIFV
        RU LKG RM ('-H', '--HRN'):
            HRN = gIFV
        RU LKG RM ('-V', '--VMGIFHG'):
            T_TOLYZORMUL._VMGIFHGVW = gIFV
        RU LKG RM ('-K', '--KIRMG'):
            T_TOLYZORMUL.ULIXV_KIRMG_OLT = gIFV

    RU MLG CNOUROV:
        HBH.VCRG('NFHG UVVW CNO UROV DRGS -X LI --XLMURT')


    T_TOLYZORMUL.XLNNZMW_ORMV = HBH.ZITE[:]

    GIVV = VGIVV.KZIHV(CNOUROV)
    T_TOLYZORMUL.CNO_MLWV = GIVV
    T_TOLYZORMUL.CNOUROV = LH.KZGS.ZYHKZGS(CNOUROV)
    T_TOLYZORMUL.CNOUROV_NLWRUB = 9
    GZT = GIVV.TVGILLG().GZT
    T_TOLYZORMUL.TOLYZO_CNO = GIVV

    # HVG WVUZFOG NZRMYZHV RU MVXVHHZIB
    RU 'NZRMYZHV' RM GIVV.TVGILLG().ZGGIRY:
        T_TOLYZORMUL._NZRMYZHV = GIVV.TVGILLG().ZGGIRY['NZRMYZHV'].HGIRK()

    #  SZMWOV LMV RMHGZMXV RHHFV
    RU RH_UROV_VCRHG('/IFM/'+GZT+'.KRW'):
        DRGS LKVM('/IFM/'+GZT+'.KRW', 'I') ZH U:
            KRW_HGI  = U.IVZW().HGIRK()
            RU OVM(KRW_HGI)==9 LI KHFGRO.KRW_VCRHGH(RMG(KRW_HGI)):
                IZRHV eZOFVvIILI('%H DRGS KRW=%H ZOIVZWB VCHRGH, ZYLIGVW'%(GZT, KRW_HGI))
        DRGS LKVM('/IFM/'+GZT+'.KRW', 'D') ZH U:
            U.DIRGV(HGI(LH.TVGKRW()))
    VOHV:
        DRGS LKVM('/IFM/'+GZT+'.KRW', 'D') ZH U:
            U.DIRGV(HGI(LH.TVGKRW()))

    FYRJ_HBHGVN = FYRJFGRO.fYRJhBHGVN()
    FYRJ_HBHGVN.CNO = LH.KZGS.ZYHKZGS(CNOUROV)
    FYRJ_HBHGVN.VCVUROV = LH.KZGS.ZYHKZGS(__UROV__)
    FYRJ_HBHGVN.KILTIZN = GZT
    FYRJ_HBHGVN.DIRGV_RMUL(LH.KZGS.QLRM('/IFM', GZT+'.IFM'))
    T_TOLYZORMUL.HGZIUOVVG_GZT = GZT
    T_TOLYZORMUL.FYRJ_HBHGVN = FYRJ_HBHGVN


    RU MLG HRN:
        T_TOLYZORMUL.RMRG_OLT(GIVV.URMW('OLT'), GZT)
    T_TOLYZORMUL.RMRG_KLHGHVIEVI()
    RU T_TOLYZORMUL._VMGIFHGVW:
        T_TOLYZORMUL.OLTTVI.RMUL('HGZIUOVVG DLIPH RM VMGIFHGVW NLWV')
    T_TOLYZORMUL.HSN_HGZGFH = hSNhGZGFH(T_TOLYZORMUL.HGZIUOVVG_GZT)
    RU MLG T_TOLYZORMUL.HSN_HGZGFH.LKVM():
        T_TOLYZORMUL.OLTTVI.RMUL('%H HVVNH GL YV RM SVI NZRWVM ELBZTV'%T_TOLYZORMUL.HGZIUOVVG_GZT)
        T_TOLYZORMUL.HSN_HGZGFH.XIVZGV()
        T_TOLYZORMUL.HSN_HGZGFH.XSVXP_HRAV()
    T_TOLYZORMUL.HSN_HGZGFH.HVG_HGZGFH(8) # YLLGRMT

    # SZMWOV XKF ZUURMRGB RHHFVH
    XKF_CNO =  GIVV.TVGILLG().URMW('XKF')
    RU XKF_CNO RH MLG mLMV:
        XKF_NLWV = XKF_CNO.ZGGIRY['NLWV']
        RU XKF_NLWV == 'NZMFZO':
            T_TOLYZORMUL.XKF_XLIVH = [RMG(R.HGIRK()) ULI R RM XKF_CNO.ZGGIRY['XLIV'].HKORG(',')]
        VORU XKF_NLWV == 'ZFGL':
            HBHGVN_CNO = VGIVV.KZIHV('/RMX/HBHGVN.CNO').TVGILLG()
            KILTIZN_XLIV_FHZTV = {}
            ULI KILTIZN_CNO RM HBHGVN_CNO.URMW('XLIV_FHZTV').URMWZOO('FHZTV'):
                KILTIZN_XLIV_FHZTV[ KILTIZN_CNO.ZGGIRY['KILTIZN'] ] = [RMG(R.HGIRK()) ULI R RM (KILTIZN_CNO.ZGGIRY['NZRM'] +','+ KILTIZN_CNO.ZGGIRY['KFYORX']).HKORG(',')]
            RU T_TOLYZORMUL.HGZIUOVVG_GZT MLG RM KILTIZN_XLIV_FHZTV:
                IZRHV eZOFVvIILI('%H WLVH MLG HKVXRUB XLIV FHZTV'%T_TOLYZORMUL.HGZIUOVVG_GZT)
            T_TOLYZORMUL.XKF_XLIVH = KILTIZN_XLIV_FHZTV[T_TOLYZORMUL.HGZIUOVVG_GZT]
        VOHV:
            IZRHV eZOFVvIILI('XKF NLWV NFHG YV VRGSVI ZFGL LI NZMFZO')
        KHFGRO.kILXVHH(TVG_GRW()).XKF_ZUURMRGB(T_TOLYZORMUL.XKF_XLIVH)
        T_TOLYZORMUL.OLTTVI.RMUL('[yllg] %H HVG XKF ZUURMRGB ZH %H'%(T_TOLYZORMUL.HGZIUOVVG_GZT, ','.QLRM([HGI(R) ULI R RM T_TOLYZORMUL.XKF_XLIVH])));
    VOHV:
        T_TOLYZORMUL.OLTTVI.DZIM('[yllg] %H WRW MLG HVG XKF ZUURMRGB'% T_TOLYZORMUL.HGZIUOVVG_GZT)

    # SZMWOV XORVMG KZGSH
    T_TOLYZORMUL.XORVMG_KZGS = []
    RU 'XORVMG' RM GIVV.TVGILLG().ZGGIRY:
        ULI XOG RM GIVV.TVGILLG().ZGGIRY['XORVMG'].HKORG(','):
            XORVMG = LH.KZGS.ZYHKZGS(XOG)
            XORVMG = FYRJFGRO.IVKOZXV_EVIHRLM(XORVMG, evihrlm).HGIRK()
            RU MLG LH.KZGS.VCRHGH(XORVMG):
                IZRHV eZOFVvIILI('XORVMG KZGS %H MLG VCRHG' % XORVMG)
            RU MLG LH.ZXXVHH(XORVMG, LH.i_lp):
                IZRHV eZOFVvIILI('XORVMG KZGS %H MLG IVZWZYOV' % XORVMG)
            HBH.KZGS.ZKKVMW(XORVMG)
            T_TOLYZORMUL.XORVMG_KZGS.ZKKVMW(XORVMG)

    # SZMWOV WLXPVI
    RU 'WLXPVI' RM GIVV.TVGILLG().ZGGIRY:
        WLXPVI_KLIG = RMG(GIVV.TVGILLG().ZGGIRY['WLXPVI'])
        T_TOLYZORMUL.HGZIUOVVG_WLXPVI = hGZIUOVVGwLXPVI('872.9.9.8', WLXPVI_KLIG, T_TOLYZORMUL.OLTTVI)
        T_TOLYZORMUL.OLTTVI.RMUL('[yllg] %H RMRGRZGVH WLXPVI DRGS KLIG %W'%(GZT, WLXPVI_KLIG))
    VOHV:
        T_TOLYZORMUL.HGZIUOVVG_WLXPVI = hGZIUOVVGwLXPVI('872.9.9.8', 49949, T_TOLYZORMUL.OLTTVI)

    YLLGHGIZK = yLLGHGIZK(T_TOLYZORMUL, GIVV.URMW('XLNKLMVMGH'))

    WVU HRTMZO_SZMWOVI(HRTMZO, UIZNV):
        RU SZHZGGI(T_TOLYZORMUL, 'NLWFOV_NZMZTVI'):
            ULI P, E RM  T_TOLYZORMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK.RGVNH():
                T_TOLYZORMUL.OLTTVI.RMUL('[vcrg] %H HFRXRWVH'%P)
                E.HFRXRWV()
        KIRMG('HBHGVN IVXVREVH ZYLIG XLNNZMW')
        T_TOLYZORMUL.HBHGVN_VCRG = gIFV
        #RU YLLGHGIZK.HGZIUOVVG_NZHGVI:
        T_TOLYZORMUL.OLTTVI.DZIM('HGLKKRMT ZOO XLNKLMVMGH')
        RU SZHZGGI(T_TOLYZORMUL, 'NLWFOV_NZMZTVI') ZMW 'NLMRGLIHBHGVN' RM T_TOLYZORMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            T_TOLYZORMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN'].PROO_ZOO( RH_NZMFZO_PROO = gIFV, VMHFIV=gIFV  )
        T_TOLYZORMUL.OLTTVI.DZIM('PROO HBHGVN')
        YLLGHGIZK.PROO()
        HBH.VCRG(9)

    WVU HRTMZO_PROOSZMWOVI(HRTMZO, UIZNV):
        RU SZHZGGI(T_TOLYZORMUL, 'NLWFOV_NZMZTVI'):
            ULI P, E RM  T_TOLYZORMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK.RGVNH():
                T_TOLYZORMUL.OLTTVI.RMUL('[vcrg] %H HFRXRWVH'%P)
                E.HFRXRWV()
        T_TOLYZORMUL.HBHGVN_VCRG = gIFV
        #RU YLLGHGIZK.HGZIUOVVG_NZHGVI:
        T_TOLYZORMUL.OLTTVI.DZIM('HGLKKRMT ZOO XLNKLMVMGH')
        RU SZHZGGI(T_TOLYZORMUL, 'NLWFOV_NZMZTVI') ZMW 'NLMRGLIHBHGVN' RM T_TOLYZORMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            T_TOLYZORMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN'].PROO_ZOO( RH_NZMFZO_PROO = gIFV, VMHFIV=gIFV  )
        T_TOLYZORMUL.OLTTVI.DZIM('PROO HBHGVN')
        YLLGHGIZK.PROO()
        HBH.VCRG(9)



    T_TOLYZORMUL.OLTTVI.RMUL('[yllg] %H DLIPH LM KRW %W' % (T_TOLYZORMUL.HGZIUOVVG_GZT, LH.TVGKRW()))
    WVU VCXVKG_SLLP(VC_XOH, VC, GY):
        T_TOLYZORMUL.OLTTVI.VIILI('VCXVKGRLM LXXFIVW, ZYLIG YLLGHGIZK')
        RU YLLGHGIZK.HGZIUOVVG_NZHGVI:
            YLLGHGIZK.PROO()
        KIRMG(VC, VC_XOH)
        KIRMG(''.QLRM(GIZXVYZXP.ULINZG_VCXVKGRLM(VC_XOH, VC, GY)))
    HBH.VCXVKGSLLP = VCXVKG_SLLP
    HRTMZO.HRTMZO(HRTMZO.hrtrmg, HRTMZO_SZMWOVI)
    HRTMZO.HRTMZO(HRTMZO.hrtfhi8, HRTMZO_PROOSZMWOVI)
    YLLGHGIZK.XSVXP_NZHGVI()
    RU YLLGHGIZK.HGZIUOVVG_NZHGVI:
        T_TOLYZORMUL._KRKVORMVKLIG = {}
        RU GZT != 'HGZIUOVVG':
            T_TOLYZORMUL.OLTTVI.VIILI('HGZIUOVVG NZHGVI RMHGZMXV RH MLG IVZWB, GSRH RMHGZMXV HSZOO YV GZTTVW ZH HGZIUOVVG')
            VCRG(-8)
        T_TOLYZORMUL.OLTTVI.DZIM('HGZIUOVVG WVXRWVH GL YV NZHGVI RMHGZMXV')
        YLLGHGIZK.XSVXP_VMERILMNVMG()
        YLLGHGIZK.DIRGV_NZHGVI()
        T_TOLYZORMUL.YFOOVGRM.IVXIVZGV()
        T_TOLYZORMUL.OLTTVI.RMUL('[yllg] HGZIUOVVG LKVMH YFOOVGRM')
        RU 'YLLGHGIZK_IVHGZIG' MLG RM GIVV.TVGILLG().ZGGIRY:
            GIVV.TVGILLG().ZGGIRY['YLLGHGIZK_IVHGZIG'] = '81:69'
            T_TOLYZORMUL.OLTTVI.DZIM('HGZIUOVVG HVG YLLGHGIZK IVHGZIG GL WVUZFOG 81:69')
        YLLGHGIZK.YLLGHGIZK_IVHGZIG = KZIHV_GRNV(GIVV.TVGILLG().ZGGIRY['YLLGHGIZK_IVHGZIG'])
        T_TOLYZORMUL.OLTTVI.DZIM('HGZIUOVVG HVG YLLGHGIZK IVHGZIG GL %H'%GIVV.TVGILLG().ZGGIRY['YLLGHGIZK_IVHGZIG'])
        YLLGHGIZK.HGZIG()
        KFYHFYNZMZTVI = YLLGHGIZK.KFYHFYNZMZTVI
        YLLGHGIZK_QLY = qLY(YLLGHGIZK)
        YLLGHGIZK_QLY.HGZIG()
        T_TOLYZORMUL.QLYH['YLLGHGIZK'] = YLLGHGIZK_QLY
    VOHV:
        T_TOLYZORMUL.OLTTVI.RMUL('[yllg] HGZIUOVVG LKVMH YFOOVGRM')
        T_TOLYZORMUL.YFOOVGRM.LKVM()
        T_TOLYZORMUL.OLTTVI.RMUL('[yllg] HGZIUOVVG RH MLG GSV NZHGVI RMHGZMXV')

    # OLZW WZGZOLZWVIH
    wZGZOLZWVInZMZTVI(GIVV.URMW('WZGFN'), T_TOLYZORMUL)

    # RMRG GSV YIRWTV ZH XLNNZMW XVMGVI

    T_TOLYZORMUL.YLLGHGIZK = YLLGHGIZK # OLZW YLLGHGIZK GL T_TOLYZORMUL
    #DSROV gIFV:
    #YLLGHGIZK.PROO()
    T_TOLYZORMUL.rMRG()
    T_TOLYZORMUL.RH_HRN = HRN
    RU HRN:
        GRNVI = gRNVI(9, HRN, T_TOLYZORMUL, T_TOLYZORMUL.XOLXP, T_TOLYZORMUL.VCXSZMTVNZMZTVI)
        HRN_KZIHV(CNOUROV, GRNVI)
        GRNVI.HRN_YVTRM()
    VOHV:
        GRNVI = gRNVI(9, HRN, T_TOLYZORMUL, T_TOLYZORMUL.XOLXP, T_TOLYZORMUL.VCXSZMTVNZMZTVI)
    T_TOLYZORMUL.GRNVI= GRNVI
    HGZI_YVZXLM = mLMV
    RU MLG YLLGHGIZK.HGZIUOVVG_NZHGVI:
        #KFYHFYNZMZTVI = kFYhFYnZMZTVI(HRN, uZOHV, HGZI_YVZXLM, T_TOLYZORMUL)
        KFYHFYNZMZTVI = kFYhFYnZMZTVI()
        KFYHFYNZMZTVI.HGZIG(HRN, uZOHV, mLMV, T_TOLYZORMUL)
    VOHV:
        KFYHFYNZMZTVI.YVZXLM = HGZI_YVZXLM
    T_TOLYZORMUL.KFYHFY_NZMZTVI = KFYHFYNZMZTVI
    T_TOLYZORMUL.YVZXLM = HGZI_YVZXLM
    T_TOLYZORMUL.HBHGVN_VCRG = uZOHV # NZIP RU HBHGVN MVVWH VCRG
    #KIRMG(KFYHFYNZMZTVI.NLMRGLI())

    # RMRG DZIMRMT NZMZTVI
    T_TOLYZORMUL.DZIMRMT_NZMZTVI = dZIMRMTnZMZTVI(T_TOLYZORMUL)

    # RMRG LUURXRZO NLWFOVH
    RU T_TOLYZORMUL.HGZIUOVVG_GZT == 'HGZIUOVVG':
        HBHGVNNVHHZTV = hBHGVNnVHHZTVnZMZTVI(HRN, HGZI_YVZXLM, T_TOLYZORMUL)
        HBHGVNXLMGILO = hBHGVNxLMGILOnZMZTVI(HRN, HGZI_YVZXLM, T_TOLYZORMUL)
        XZHSGIZMHUVI = xZHSgIZMHUVInZMZTVI(HRN, HGZI_YVZXLM, T_TOLYZORMUL)
    VOHV:
        HBHGVNNVHHZTV = mLMV
        HBHGVNXLMGILO = mLMV
        XZHSGIZMHUVI = mLMV
    IVXLIWVINZMZTVI = lKiVXLIWnZMZTVI(GIVV)
    LKIVXLIWVI = IVXLIWVINZMZTVI.tVGiVXLIWVI()
    T_TOLYZORMUL.LKIVXLIWVI = LKIVXLIWVI
    T_TOLYZORMUL.YVZXLM = HGZI_YVZXLM
    T_TOLYZORMUL.HSN_HGZGFH.KZIHV_GIZUURX()

    # UOVVG = NZRM_TFR(CNOUROV, GRNVI, HRN, HGZI_YVZXLM,  T_TOLYZORMUL)
    # T_TOLYZORMUL.HBHGVN = UOVVG
    GRNVI_QLY = qLY(GRNVI)
    GRNVI_QLY.HGZIG()
    T_TOLYZORMUL.QLYH['gRNVI'] = GRNVI_QLY

    YILZWXZHG_SVOKVI = yILZWXZHGsVOKVI(8, T_TOLYZORMUL)
    YILZWXZHG_QLY = qLY(YILZWXZHG_SVOKVI)
    YILZWXZHG_QLY.HGZIG()
    T_TOLYZORMUL.QLYH['yILZWXZHG'] = YILZWXZHG_QLY

    #RMRG XFHGLN NLWFOVH
    T_TOLYZORMUL.NLWFOV_NZMZTVI = nLWFOVnZMZTVI(T_TOLYZORMUL, GIVV.URMW('NLWFOVH'), GIVV)
    T_TOLYZORMUL.NLWFOV_NZMZTVI.HGZIG()
    T_TOLYZORMUL.QLYH['nLWFOVnZMZTVI'] = T_TOLYZORMUL.NLWFOV_NZMZTVI.QLY

    YIRWTV = yIRWTV(T_TOLYZORMUL, GIVV)
    RU YIRWTV.KLIG != '':
        YIRWTV_QLY = qLY(YIRWTV)
        YIRWTV_QLY.HGZIG()
        T_TOLYZORMUL.QLYH['yIRWTV'] = YIRWTV_QLY
        #YLLGHGIZK.NLMRGLI()
    T_TOLYZORMUL.HGZIUOVVG_YIRWTV = YIRWTV

    T_TOLYZORMUL.HSN_HGZGFH.HVG_HGZGFH(7) # YLLGRMT

    # RU TFR:
        # ZKK = hGZIGUOVVGtfr(HRN, UOVVG, GRNVI,
                            # KFYHFYNZMZTVI,
                            # HBHGVNNVHHZTV, HBHGVNXLMGILO, XZHSGIZMHUVI,  T_TOLYZORMUL )
        # ZKK.IFM()
    # VOHV:
        # RU ML TFR, HGZIUOVVG DROO ZXGREZGV LK HBHGVN
    NZMZTVI = YZXPVI.yZXPVI(KFYHFYNZMZTVI, HBHGVNNVHHZTV, GRNVI, HRN, HGZI_YVZXLM, T_TOLYZORMUL)
    YP = qLY(NZMZTVI)
    YP.HGZIG()
    T_TOLYZORMUL.QLYH['yZXPVI'] = YP

    SVZOGS_WZVNLM = YZXPVI.sVZOGSwZVNLM(GRNVI, T_TOLYZORMUL)
    SW = qLY(SVZOGS_WZVNLM)
    SW.HGZIG()
    T_TOLYZORMUL.QLYH['sVZOGSwZVNLM'] = SW
    # GSRH RH ULI LK DLIPRMT HBHGVN
    # GLWL: HSZOO YV ULIPVW GL PVVK GSV NZRM KILTIZN HZUV
    LKHBHGVN = kZIHVhBHGVN(GIVV, T_TOLYZORMUL, LKIVXLIWVI)
    T_TOLYZORMUL.NZMZTVNVMG = LKHBHGVN
    RU T_TOLYZORMUL._DVY_HVIEVI RH MLG mLMV:
        RU T_TOLYZORMUL._DVY_LKGRLMH['LKGRLMH']['NZRM_GSIVZW']:
            RU MLG T_TOLYZORMUL._DVY_LKGRLMH['LKGRLMH']['WVYFT']:
                tFMRXLIMzKKORXZGRLM(T_TOLYZORMUL._DVY_HVIEVI,
                                    T_TOLYZORMUL._DVY_LKGRLMH['TFMRXLIM']).IFM()
            VOHV:
                SLHG = T_TOLYZORMUL._DVY_LKGRLMH['LKGRLMH']['SLHG']
                KLIG = T_TOLYZORMUL._DVY_LKGRLMH['LKGRLMH']['KLIG']
                RU T_TOLYZORMUL._DVY_LKGRLMH['LKGRLMH']['FHV_HLXPVGRL']:
                    T_TOLYZORMUL._DVY_LKGRLMH['LKGRLMH']['HLXPVGRL'].IFM(T_TOLYZORMUL._DVY_HVIEVI, WVYFT=uZOHV, SLHG=SLHG, KLIG=KLIG)
                VOHV:
                    T_TOLYZORMUL._DVY_LKGRLMH['ZKK'].IFM(WVYFT=gIFV, GSIVZWVW=gIFV, FHV_IVOLZWVI=uZOHV, SLHG=SLHG, KLIG=KLIG)
    T_TOLYZORMUL._URMRHS_YLLG = gIFV
    LKHBHGVN.DLIP()
//##**---------------- ./HGZIUOVVG/IRHPUROGVI/wFNNBuROGVI.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO

XOZHH wFNNBuROGVI(hGPlKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL, ZXXLFMG):
        HFKVI(wFNNBuROGVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.ZXXLFMG = ZXXLFMG

    WVU IVOLZW(HVOU):
        HFKVI(wFNNBuROGVI, HVOU).IVOLZW()

    WVU DLIP(HVOU):
        ULI HRTMZO RM ZXXLFMG.HRTMZOH:
            HRTMZO.IVZWB = HRTMZO.IVZWB ZMW gIFV;

        IVGFIM gIFV

//##**---------------- ./HGZIUOVVG/GVHG.CNO
<?CNO EVIHRLM="8.9" VMXLWRMT="FGU-1"?>
<HGZIUOVVG_GVHG YLLGHGIZK_IVHGZIG="81:69:99">

    <OLT OVEVO="WVYFT" OLTUROV="/FYRJ/OLT/HGZIUOVVG_${bbbbnnww}.OLT"  KIRMG="UZOHV" KIRMGML="UZOHV"/>
    <HGZGHW SLHG="807.831.804.746" KLIG="1874" />
    <NLWFOVH>
	<NLWFOV RW="NLMRGLIHBHGVN" />
	<NLWFOV RW="WLXPVI"/>
	<NLWFOV RW="SZIWDZIVRMUL"/>
	<NLWFOV RW="EVIHRLMXLMGILO"/>
    </NLWFOVH>
    <LKVIZGRLMH HOVVK_KVI_ILFMW="8H" IVOLZW="99:89:99">
	<!--
	<LKVIZGRLM  NLWFOV="xSVXPmLGVdZIMRMT" VEVIB="7H"  MVD_GSIVZW="UZOHV" />

        <LKVIZGRLM  NLWFOV="lIWVIgIZUURXxLMGILO" NZC_LIWVI_KVI_HVXLMW="89" VEVIB="8H"  MVD_GSIVZW="UZOHV" >
            <ZXX ZXXLFMG="hVXFIRGBnZMZTVIiVZWB" LIWVIHKVVW="39"/>
        </LKVIZGRLM>

	<LKVIZGRLM NLWFOV="gIZUURXoRTSG" VEVIB="6H" MVD_GSIVZW="UZOHV"  >
		<DZREV GZITVG="HBHGVNVBV,NZIPVGVBV, ZXXLFMGVBV,HBHGVNVBVG,FGIZWV_HGLXP,HVXFIRGBNZMZTVI,DLINSLOV,FGIZWV_ZWZKGLI_TCY,FGIZWV_ZWZKGLI_BQ,FGIZWV_ZWZKGLI_QUA,FGIZWV_ZWZKGLI_TCW,FGIZWV_TCY,FGIZWV_BQ,FGIZWV_QUA,FGIZWV_TCW,FGIZWV_QUA499,FGIZWV_ZWZKGLI_QUA499,FGIZWV_ITIZGV,FGIZWV_BQ8,FGIZWV_AM,FGIZWV_AM8" />
		<XSVXP NLWFOV="hVXFIRGBnZMZTVIiVZWB"/>
		<XSVXP NLWFOV="kLHRGRLMHxSVXPiVZWB" KZGS="/WZG/ZXXLFMGVBV/xSVXPkLHRGRLM/" />
	</GZITVG>
	</LKVIZGRLM>
	-->
    </LKVIZGRLMH>
    <XLNKLMVMGH>
        <KFYHFY KLHHVHH="gIFV" >
            <IVHGZIG KILTIZN='/LKG/EVIHRLM/${evihrlm}/YRM/IVHGZIGkFYhFYhVIERXV'
                CNO='/SLNV/LK/KFYHFY/KFYHFYHVIERXV.CNO'/>
            <YILPVI KILTIZN='/LKG/EVIHRLM/${evihrlm}/YRM/YILPVI'
                CNO='/SLNV/LK/KFYHFY/YILPVI.CNO' />
        </KFYHFY>

        <HVXFIRGBNZMZTVI KLHHVHH="uZOHV" RM_GIFHG="gIFV">
            <RW EZOFV="HVXFIRGBNZMZTVI" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HVXFIRGBNZMZTVI/YRM/HVXFIRGBNZMZTVI" />
            <XLMURT EZOFV="/SLNV/LK/HVXFIRGBNZMZTVI/HVXFIRGBNZMZTVI.CNO"/>
            <GRNV HGZIG="81:99:99" HGLK="81:99:99"/>
        </HVXFIRGBNZMZTVI>

        <HBHGVNVBV KLHHVHH="uZOHV" RM_GIFHG="gIFV">
            <RW EZOFV="HBHGVNVBV" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/HBHGVNVBV/YRM/HBHGVNVBV" />
            <XLMURT EZOFV="/SLNV/LK/HBHGVNVBV/HBHGVNVBV.CNO"/>
            <GRNV HGZIG="81:99:99" HGLK="81:99:99"/>
        </HBHGVNVBV>

	<IVWHSRUG KLHHVHH="uZOHV" RM_GIFHG="gIFV" KBGSLM="GIFV">
             <RW EZOFV="IVWHSRUG" />
             <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/IVWHSRUG/NZRM.KB" />
             <XLMURT EZOFV="/SLNV/LK/IVWHSRUG/IVWHSRUG.CNO"/>
             <GRNV HGZIG="0:99:99" HGLK="0:99:99"/>
         </IVWHSRUG>

        <NZHHIVOZB KLHHVHH="uZOHV" RM_GIFHG="gIFV" LM_WZB="hhv|hav">
            <RW EZOFV="NZHHIVOZB" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/NZHHIVOZB/YRM/NZHHIVOZB" />
            <XLMURT EZOFV="/SLNV/LK/NZHHIVOZB/NZHHIVOZB.CNO"/>
            <GRNV HGZIG="1:69:99" HGLK="84:89:99"/>
        </NZHHIVOZB>

        <ZXXLFMGVBV KLHHVHH="uZOHV" RM_GIFHG="gIFV" LM_WZB="hhv|hav">
            <RW EZOFV="ZXXLFMGVBV" />
            <KILTIZN EZOFV="/LKG/EVIHRLM/${evihrlm}/ZXXLFMGVBV/YRM/ZXXLFMGVBV" />
            <XLMURT EZOFV="/SLNV/LK/ZXXLFMGVBV/ZXXLFMGVBV.CNO"/>
	    <GRNV HGZIG="0:67:99" HGLK="84:89:99"/>
        </ZXXLFMGVBV>

	<FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_TCY" />
            <!--RW EZOFV="FGIZWV_KGZMT" /-->
	    <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
            <XLMURT EZOFV="/RMX/TCY.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="85:45:99"/>
        </FGIZWV>
        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_JH7" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
            <XLMURT EZOFV="/RMX/GIZWV_JRZMHSR7.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="85:45:99"/>
        </FGIZWV>

        <FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_ITIZGV" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
            <XLMURT EZOFV="/RMX/ITIZGV.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>

	<FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_AM" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
            <XLMURT EZOFV="/RMX/AM.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>

	<FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_BQ" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
            <XLMURT EZOFV="/RMX/BQ.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>

	<FGIZWV KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="FGIZWV_BQ8" />
            <KILTIZN EZOFV="/LKG/FGIZWV/FGIZWV-WVE/YRM/FGIZWV" />
            <XLMURT EZOFV="/RMX/BQ8.CNO"/>
            <GRNV HGZIG="0:70:99" HGLK="84:97:99"/>
        </FGIZWV>

     	<gy KLHHVHH="uZOHV" RM_GIFHG="uZOHV" LM_WZB="hhv|hav">
            <RW EZOFV="gy" />
            <KILTIZN EZOFV="/SLNV/LK/gy/gy" />
            <XLMURT EZOFV="/SLNV/LK/gy/XLMURT_UVNZH.CNO"/>
            <GRNV HGZIG="91:69:99" HGLK="84:89:99"/>
        </gy>
    </XLNKLMVMGH>

    <WVKVMWVMXRVH>
    </WVKVMWVMXRVH>

</HGZIUOVVG_GVHG>
//##**---------------- ./HGZIUOVVG/GVNKOZGV/FGIZWV_HGLXP.QRMQZ7
<?CNO EVIHRLM="8.9" ?>
<FGIZWV_{% hGIZGVTB %} DZREVW="GIFV" XORVMG="{% xORVMGkZGS %}" >
    <OLT OVEVO="RMUL" HSN="{% hGIZGVTB %}" OLTUROV="/FYRJ/OLT/FGIZWV_{% hGIZGVTB %}_${bbbbnnww}.OLT" KIRMG="GIFV" KIRMGML="UZOHV" XLFMG="899999999" />
    <GRNVI NLWV="ZFGL" FKWZGV="899FH"  />
    <XKF  NLWV="ZFGL"   MRXV=""/>

    <!-- <XKF  NLWV="ZFGL"  XLIV="86" KFYORX="5" MRXV=""/> -->

    <WZGFN>

       <!-- <ZXXLFMG RW="xNHgVHG" RMEVHGRW="8178993903" HRW="xNHgVHG" ZXXGBKV="XZHS"  ZKRGBKV="XGK" /> -->
        <ZXXLFMG RW="{% hGIZGVTB %}" RMEVHGRW="{% rMEVHGrW %}" HRW="{% hGIZGVTB %}" ZXXGBKV="XZHS"  ZKRGBKV="XGK" />
        <ZXXLFMG RW="EZ8" HFYZXX="DNGO"/>

        <HVXFIRGB RW="H7" XZGVTLIB="HGLXP" RMHGIFNVMG="ZOO" VCXOFWV="ru" HLFIXV="HSN" />

        <!-- zOKSZnVHHZTVH  -->
        <NVHHZTVKLLO XLMURT="/LKG/EVIHRLM/${evihrlm}/VGX/ZOKSZNVHHZTV.CNO">
            <NVHHZTV NVHHZTVRW="JRZMHSR7U" NLWFOV="zOKSZnVHHZTVhRMTOVuROV" GBKV="URM" ZOKSZKZGS="{% zOKSZkZGS %}"  IVZWLMOB="GIFV"/>
        </NVHHZTVKLLO>

        <!-- zWWLM WZGZ NLWFOVH  -->
        <WZGZKZXPH>
            <WZGZKZXP RW="hGLXPkZXP" />
        </WZGZKZXPH>
    </WZGFN>

    <DLIPUOLD NLWFOV="dLIPUOLDwVNL" NLMRGLI="GIFV" RW="DU8" >
        <HGIZGVTB NLWFOV="fGIZWVhGIZGVTB" MLMHFHKVMWZYOV="GIFV" RW="WZGZ" ZXX="EZ8" >
            <FGIZWVLK NLWFOV="lKhGLXPwZGZkIVKZIZGRLM"  WVKGSWZGZ="UZOHV" OLY="UZOHV" MLOLT="UZOHV"
                HLFIXV="ogho7"
                CNO="/GNK/WZGZYLC_OGHO7.CNO" RW="wZGZhGP" />
        </HGIZGVTB>

        <HGIZGVTB NLWFOV="fGIZWVhGIZGVTB" ZXX="{% hGIZGVTB %}" HVXFIRGB="H7" ZOKSZNHTRW="JRZMHSR7U" LNOLT="/FYRJ/OLT/LN_{% hGIZGVTB %}_${bbbbnnww}.OLT" >

            <WZGZ NLWFOV="wOhGLXPgtkwZGZOLZWVI"/>
            <FGIZWVLK NLWFOV="lKtVGhGLXPzOKSZH" XOLHV_WRHZKKVZI="GIFV" WRIVXG_ZOKSZ="GIFV" />

            <FGIZWVLK NLWFOV="lKhGLXPhRTMZOgLlIWVI"  >
                <hRTMZOkLORXB RW="HRNKOV" NLWFOV="hRTMZOkLORXBhRNKOB" />
            </FGIZWVLK>

        </HGIZGVTB>
    </DLIPUOLD>


    <NLWFOVH>
        <NLWFOV RW="fGIZWVhGIZGVTB" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYFSUHGIZGVTB.HL" />
        <NLWFOV RW="dLIPUOLDwVNL" GBKV="DLIPUOLD" KZGS="${ORYKZGS}/ORYFGIZWVDLIPUOLD.HL" />
        <NLWFOV RW="hGLXPzOOhVOVXG" GBKV="HVOVXG" KZGS="${ORYKZGS}/ORYHGLXPZOOHVOVXG.HL" />
        <NLWFOV RW="hGLXPhVOVXGuILNzOKSZ" GBKV="HVOVXG" KZGS="${ORYKZGS}/ORYHGLXPHVOVXGUILNZOKSZ.HL" />
        <NLWFOV RW="wOhGLXPgtkwZGZOLZWVI" GBKV="WZGZ" KZGS="${ORYKZGS}/ORYHGLXPGTKWZGZOLZWVI.HL" />
        <NLWFOV RW="kMO" GBKV="WZGZ" KZGS="${ORYKZGS}/ORYHGLXPKMO.HL" />
        <NLWFOV RW="lKhGLXPvIILIxSVXP" GBKV="WZGZ" KZGS="${ORYKZGS}/ORYHGLXPVIILIXLFMGORNRG.HL" />

        <!-- ggk(GZITVG GL KLHRHRLM) KLORXRVH -->
        <NLWFOV RW="ggkhGPkLORXBxZMXVOvCXVVWlIWVIH" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYGGKHGPXZMXVOVCXVVW.HL" />
        <NLWFOV RW="ggkhGPkLORXBxOLHVuRIHG" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYGGKHGPXOLHVURIHG.HL" />
        <NLWFOV RW="ggkhGPyOLXPxLMGIZWRXG" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYGGKHGPYOLXPXLMGIZWRXG.HL" />
        <NLWFOV RW="ggkhGPmLrMGIZWZBiLGZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYGGKHGPMLRMGIZWZBILGZGRLM.HL" />

        <!-- lKVIZGRLMH  -->
        <NLWFOV RW="lKhGLXPwZGZkIVKZIZGRLM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPWZGZKIVKZIZGRLM.HL" />
        <NLWFOV RW="lKhGLXPgZITVGKLHgLlIWVI" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXMHGLXPGZITVGKLHGLLIWVI.HL" />
        <NLWFOV RW="lKhGLXPrMULIXVgZITVGKLHgLlIWVI" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPRMULIXVGZITVGKLHGLLIWVI.HL" />

        <NLWFOV RW="lKtVGhGLXPzOKSZH" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPTVGZOKSZH.HL" />
        <NLWFOV RW="lKfYRJFZMGhGPzOTLiFM" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPFYRJFZMGHGPZOTLIFM.HL" />
        <NLWFOV RW="lKhGLXPgIZWVI" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPGIZWVI.HL" />

        <!-- xm lKVIZGRLMH  -->
        <NLWFOV RW="lKxmnVITVvCRHGHlIWVI" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXMNVITVVCRHGHLIWVI.HL" />
        <NLWFOV RW="lKxmhGLXPxZMXVOlKKLHRGV" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXMHGLXPXZMXVOLKKLHRGV.HL" />
        <!-- <NLWFOV RW="lKxmhGLXPgZITVGkLHgLlIWVI" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXMHGLXPGZITVGKLHGLLIWVI.HL" /> -->
        <NLWFOV RW="lKxmhGLXPdZRGxZMXVO" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXMHGLXPDZRGXZMXVO.HL" />
        <NLWFOV RW="lKxmhGLXPiLFMWhSZIV" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXMHGLXPILFMWHSZIV.HL" />
        <NLWFOV RW="lKxmhGLXPfKKVIoRNRGmLGhVOOoLDVIoRNRGmLGyFB" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYXMHGLXPFKKVIORNRGMLGHVOOOLDVIORNRGMLGYFB.HL" />
        <NLWFOV RW="lKxmhGLXPxZMXVOyZWlIWVI" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPXZMXVOYZWLIWVI.HL" />

        <!-- zOTLH -->
        <NLWFOV RW="zOTLhGLXPzOTL8" GBKV="ZOTL" KZGS="${ORYKZGS}/ORYHGLXPZOTL8.HL" />

        <NLWFOV RW="hTfGIZWVhGIZGVTB" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYFSUHGIZGVTB.HL" />
        <NLWFOV RW="kLHGKLMVhGIZGVTB" GBKV="HGIZGVTB" KZGS="${ORYKZGS}/ORYWVNLHGIZGVTB.HL" />
        <NLWFOV RW="lKhGLXPgVHGlIWVI" GBKV="LKVIZGRLM" KZGS="${ORYKZGS}/ORYHGLXPGVHGLIWVI.HL" />

        <!-- KIREZGV -->
        <NLWFOV RW="lKhGLXPgdzkeZOEV" GBKV="LKVIZGRLM" KZGS="${XORVMGKZGS}/ORY/ORYXMHGLXPGDZKEZOEV.HL" />
        <NLWFOV RW="lKhGLXPgdzkeZOEV7" GBKV="LKVIZGRLM" KZGS="${XORVMGKZGS}/ORY/ORYXMHGLXPGDZKEZOEV7.HL" />
        <NLWFOV RW="lKhGLXPhRTMZOeZOEV" GBKV="LKVIZGRLM" KZGS="${XORVMGKZGS}/ORY/ORYXMHGLXPHRTMZOEZOEV.HL" />
        <NLWFOV RW="lKhGLXPhRTMZOeZOEV7" GBKV="LKVIZGRLM" KZGS="${XORVMGKZGS}/ORY/ORYXMHGLXPHRTMZOEZOEV7.HL" />

        <NLWFOV RW="lKhGLXPhRTMZOeZOEV6" GBKV="LKVIZGRLM" KZGS="${XORVMGKZGS}/ORY/ORYXMHGLXPHRTMZOEZOEV6.HL" />

        <NLWFOV RW="lKhGLXPhRTMZOgLlIWVI" GBKV="LKVIZGRLM" KZGS="${XORVMGKZGS}/ORY/ORYHGPHRTMZOGLLIWVI.HL" />
        <NLWFOV RW="hRTMZOkLORXBhRNKOB" GBKV="LKVIZGRLM" KZGS="${XORVMGKZGS}/ORY/ORYHRTMZOKLORXBHRNKOB.HL" />
    </NLWFOVH>

</FGIZWV_DNGO>

//##**---------------- ./HGZIUOVVG/GVNKOZGV/WZROB_IVKLIG.SGNO
<!wlxgbkv SGNO>
<SGNO>
<SVZW OZMT="VM">
    <NVGZ XSZIHVG="fgu-1">
    <GRGOV>wZROB iVKLIG</GRGOV>
    <ORMP IVO="HGBOVHSVVG" GBKV ="GVCG/XHH" SIVU="{{GVNKOZGV}}/HGBOV.XHH"/>
</SVZW>
<YLWB>

<WRE XOZHH="XLMGZRMVI">
        {% RMXOFWV "HGZGFH_IVKLIG.SGNO" %}
        <K HGBOV="KZTV-YIVZP-YVULIV: ZODZBH" ></K>
        <S6>gy oZGVMXB iVKLIG: </S6>
            {% RMXOFWV "OZGVMXB_IVKLIG.SGNO" %}
        <S6>sug sRG iZGV: </S6>
            {% RMXOFWV "SRG_IZGV.SGNO" %}
</WRE>


</YLWB>
</SGNO>
//##**---------------- ./HGZIUOVVG/GVNKOZGV/SRG_IZGV.SGNO

{% ULI NZXSRMV RM SUGNZXSRMVH %}
{% HVG SUGIVKLIG = SUGNZXSRMVH[NZXSRMV].IVKLIG %}
  <GZYOV>
        <XZKGRLM> sug gIZWV-gL-lIWVI iZGRL-{{NZXSRMV}} </XZKGRLM>
        <GSVZW>
          <GI>
            <GS></GS>
            <GS></GS>
            <GS XLOHKZM="{{ SUGIVKLIG.XLMGIZXGH | OVMTGS }}">xLMGIZXGH</GS>
          </GI>
      <GI>
        <GS>zXXLFMG</GS>
        <GS>hGIZGVTB</GS>
        {% ULI XLMGIZXG RM SUGIVKLIG.XLMGIZXGH %}
        <GS>{{XLMGIZXG}}</GS>
        {% VMWULI %}
      </GI>
    </GSVZW>
    <GYLWB>
      {% ULI ZXXLFMG RM SUGIVKLIG.ZXXLFMGH %}
      {% HVG ZXX = SUGIVKLIG.ZXXLFMGH[ZXXLFMG] %}
        {% ULI HGIZGVTB RM ZXX.HGIZGVTB %}
        {% HVG HGIZGVTB = ZXX.HGIZGVTB[HGIZGVTB] %}
        <GI>

          {% RU OLLK.RMWVC == 8 %}
            <GS>{{ZXX.RW}}</GS>
          {% VOHV %}
            <GS></GS>
          {% VMWRU %}
          <GS>{{HGIZGVTB.RW}}</GS>
          {% ULI XLMGIZXG RM SUGIVKLIG.XLMGIZXGH %}
            {% RU XLMGIZXG RM HGIZGVTB.XLMGIZXGH %}
              {% RU HGIZGVTB.XLMGIZXGH[XLMGIZXG].HGZG.SRG_IZGV >= 19%}
              <GS HGBOV="YZXPTILFMW:TIVVM">{{ HGIZGVTB.XLMGIZXGH[XLMGIZXG].HGZG.SRG_IZGV | ILFMW(7)}}%</GS>
              {% VORU HGIZGVTB.XLMGIZXGH[XLMGIZXG].HGZG.SRG_IZGV > 49%}
              <GS HGBOV="YZXPTILFMW:BVOOLD">{{ HGIZGVTB.XLMGIZXGH[XLMGIZXG].HGZG.SRG_IZGV | ILFMW(7)}}%</GS>
              {% VORU HGIZGVTB.XLMGIZXGH[XLMGIZXG].HGZG.SRG_IZGV <= 49%}
              <GS HGBOV="YZXPTILFMW:IVW">{{ HGIZGVTB.XLMGIZXGH[XLMGIZXG].HGZG.SRG_IZGV | ILFMW(7)}}%</GS>
              {% VMWRU %}
            {% VOHV %}
              <GS></GS>
            {% VMWRU %}
          {% VMWULI %}
         </GI>
        {% VMWULI %}
      {% VMWULI %}

    </GYLWB>
  </GZYOV>
  {% VMWULI %}
//##**---------------- ./HGZIUOVVG/GVNKOZGV/OZGVMXB_IVKLIG.SGNO

    <GZYOV>
      <XZKGRLM> lIWVI rMHVIGRLM oZGVMXB </XZKGRLM>
      <GSVZW>
        <GI>
          <GS></GS>
          <GS></GS>
          <GS></GS>
          <GS XLOHKZM="2">oZGVMXB (FMRG: NH)</GS>
        </GI>
    <GI>
      <GS>nZXSRMV</GS>
      <GS>zXXLFMG</GS>
      <GS>lIWVI</GS>
      <GS>j-79</GS>
      <GS>j-49</GS>
      <GS>j-29</GS>
      <GS>j-09</GS>
      <GS>nRM</GS>
      <GS>nZC</GS>
      <GS>qRGGVI</GS>
    </GI>
  </GSVZW>
    {% ULI NZXSRMV RM NZXSRMVH %}
    {% RU NZXSRMVH[NZXSRMV].IVKLIG.ZXXLFMG_ORHG | OVMTGS > 9 %}
    <GI>
      <GW> {{NZXSRMV}}</GW>
      {% HVG ZXXLFMG = NZXSRMVH[NZXSRMV].IVKLIG.ZXXLFMG_ORHG.PVBH()[9] %}
      {% HVG ZXX = NZXSRMVH[NZXSRMV].IVKLIG.ZXXLFMG_ORHG[ZXXLFMG] %}
      <GW>{{ZXXLFMG}}</GW>
      <GW>{{ZXX.LIWVIH | OVMTGS}}</GW>
      <GW {%RU ZXX.HGZG.J79 > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
        {{ZXX.HGZG.J79}}</GW>
      <GW {%RU ZXX.HGZG.NVWRZM > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
        {{ZXX.HGZG.NVWRZM}}</GW>
      <GW {%RU ZXX.HGZG.J29 > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
        {{ZXX.HGZG.J29}}</GW>
      <GW {%RU ZXX.HGZG.J09 > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
        {{ZXX.HGZG.J09}}</GW>
      <GW {%RU ZXX.HGZG.NRM > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
        {{ZXX.HGZG.NRM}}</GW>
      <GW {%RU ZXX.HGZG.NZC > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
        {{ZXX.HGZG.NZC }}</GW>
      <GW>{{ZXX.HGZG.HGW | ILFMW(7)}}</GW>
    </GI>
        {% ULI ZXXLFMG RM NZXSRMVH[NZXSRMV].IVKLIG.ZXXLFMG_ORHG.PVBH()[8:] %}
        {% HVG ZXX = NZXSRMVH[NZXSRMV].IVKLIG.ZXXLFMG_ORHG[ZXXLFMG] %}
        <GI>
          <GW> </GW>
          <GW > {{ZXXLFMG}}</GW>
            <GW>{{ ZXX.LIWVIH | OVMTGS }}</GW>
          <GW {%RU ZXX.HGZG.J79 > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
            {{ZXX.HGZG.J79}}</GW>
          <GW {%RU ZXX.HGZG.NVWRZM > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
            {{ZXX.HGZG.NVWRZM}}</GW>
          <GW {%RU ZXX.HGZG.J29 > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
            {{ZXX.HGZG.J29}}</GW>
          <GW {%RU ZXX.HGZG.J09 > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
            {{ZXX.HGZG.J09}}</GW>
          <GW {%RU ZXX.HGZG.NRM > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
            {{ZXX.HGZG.NRM}}</GW>
          <GW {%RU ZXX.HGZG.NZC > 499 %} HGBOV="YZXPTILFMW:IVW" {% VMWRU %}>
            {{ZXX.HGZG.NZC}}</GW>
          <GW>{{ZXX.HGZG.HGW| ILFMW(7)}}</GW>
        </GI>
        {% VMWULI %}
        {% VMWRU %}
    {% VMWULI %}
   </GZYOV>
//##**---------------- ./HGZIUOVVG/GVNKOZGV/HGBOV.XHH
/* --------------------------------------------------------------

   GBKLTIZKSB.XHH
   * hVGH FK HLNV HVMHRYOV WVUZFOG GBKLTIZKSB.
   SGGK://DDD.YOFVKIRMGXHH.LIT/YOFVKIRMG/HIX/GBKLTIZKSB.XHH
-------------------------------------------------------------- */

/* wVUZFOG ULMG HVGGRMTH.
   gSV ULMG-HRAV KVIXVMGZTV RH LU 83KC. (9.24 * 83KC = 87KC) */
SGNO { ULMG-HRAV:899.98%; }
YLWB {
  ULMG-HRAV: 24%;
  XLOLI: #777;
  YZXPTILFMW: #UUU;
  ULMG-UZNROB: "sVOEVGRXZ mVFV", zIRZO, sVOEVGRXZ, HZMH-HVIRU;
}


/* sVZWRMTH
-------------------------------------------------------------- */

S8,S7,S6,S5,S4,S3 { ULMG-DVRTSG: MLINZO; XLOLI: #888; }

S8 { ULMG-HRAV: 6VN; ORMV-SVRTSG: 8; NZITRM-YLGGLN: 9.4VN; }
S7 { ULMG-HRAV: 7VN; NZITRM-YLGGLN: 9.24VN; }
S6 { ULMG-HRAV: 8.4VN; ORMV-SVRTSG: 8; NZITRM-YLGGLN: 8VN; }
S5 { ULMG-HRAV: 8.7VN; ORMV-SVRTSG: 8.74; NZITRM-YLGGLN: 8.74VN; }
S4 { ULMG-HRAV: 8VN; ULMG-DVRTSG: YLOW; NZITRM-YLGGLN: 8.4VN; }
S3 { ULMG-HRAV: 8VN; ULMG-DVRTSG: YLOW; }

S8 RNT, S7 RNT, S6 RNT,
S5 RNT, S4 RNT, S3 RNT {
  NZITRM: 9;
}


/* gVCG VOVNVMGH
-------------------------------------------------------------- */

K           { NZITRM: 9 9 8.4VN; }
/*
	gSVHV XZM YV FHVW GL KFOO ZM RNZTV ZG GSV HGZIG LU Z KZIZTIZKS, HL
	GSZG GSV GVCG UOLDH ZILFMW RG (FHZTV: <K><RNT XOZHH="OVUG">gVCG</K>)
 */
.OVUG  			{ UOLZG: OVUG !RNKLIGZMG; }
K .OVUG			{ NZITRM: 8.4VN 8.4VN 8.4VN 9; KZWWRMT: 9; }
.IRTSG 			{ UOLZG: IRTSG !RNKLIGZMG; }
K .IRTSG 		{ NZITRM: 8.4VN 9 8.4VN 8.4VN; KZWWRMT: 9; }

Z:ULXFH,
Z:SLEVI     { XLOLI: #90U; }
Z           { XLOLI: #93X; GVCG-WVXLIZGRLM: FMWVIORMV; }

YOLXPJFLGV  { NZITRM: 8.4VN; XLOLI: #333; ULMG-HGBOV: RGZORX; }
HGILMT,WUM	{ ULMG-DVRTSG: YLOW; }
VN,WUM      { ULMG-HGBOV: RGZORX; }
HFK, HFY    { ORMV-SVRTSG: 9; }

ZYYI,
ZXILMBN     { YLIWVI-YLGGLN: 8KC WLGGVW #333; }
ZWWIVHH     { NZITRM: 9 9 8.4VN; ULMG-HGBOV: RGZORX; }
WVO         { XLOLI:#333; }

KIV         { NZITRM: 8.4VN 9; DSRGV-HKZXV: KIV; }
KIV,XLWV,GG { ULMG: 8VN 'ZMWZOV NLML', 'OFXRWZ XLMHLOV', NLMLHKZXV; ORMV-SVRTSG: 8.4; }


/* oRHGH
-------------------------------------------------------------- */

OR FO,
OR LO       { NZITRM: 9; }
FO, LO      { NZITRM: 9 8.4VN 8.4VN 9; KZWWRMT-OVUG: 8.4VN; }

FO          { ORHG-HGBOV-GBKV: WRHX; }
LO          { ORHG-HGBOV-GBKV: WVXRNZO; }

WO          { NZITRM: 9 9 8.4VN 9; }
WO WG       { ULMG-DVRTSG: YLOW; }
WW          { NZITRM-OVUG: 8.4VN;}


/* gZYOVH
-------------------------------------------------------------- */

/*
	yVXZFHV LU GSV MVVW ULI KZWWRMT LM gs ZMW gw, GSV EVIGRXZO ISBGSN
	LM GZYOV XVOOH SZH GL YV 72KC, RMHGVZW LU GSV HGZMWZIW 81KC LI 63KC
	LU LGSVI VOVNVMGH.
 */
GZYOV       { NZITRM-YLGGLN: 8.5VN; DRWGS:899%; }
GS          { ULMG-DVRTSG: YLOW; }
GSVZW GS    { YZXPTILFMW: #X6W0UU; }
GS,GW,XZKGRLM { KZWWRMT: 5KC 89KC 5KC 4KC; }
/*
	bLF XZM AVYIZ-HGIRKV BLFI GZYOVH RM LFGWZGVW YILDHVIH YB ZWWRMT
	GSV XOZHH "VEVM" GL VEVIB LGSVI GZYOV ILD.
 */
GYLWB GI:MGS-XSROW(VEVM) GW,
GYLWB GI.VEVM GW  {
	YZXPTILFMW: #V4VXU0;
}
GULLG       { ULMG-HGBOV: RGZORX; }
XZKGRLM     { YZXPTILFMW: #VVV; }


/* nRHX XOZHHVH
-------------------------------------------------------------- */

.HNZOO      { ULMG-HRAV: .1VN; NZITRM-YLGGLN: 8.124VN; ORMV-SVRTSG: 8.124VN; }
.OZITV      { ULMG-HRAV: 8.7VN; ORMV-SVRTSG: 7.4VN; NZITRM-YLGGLN: 8.74VN; }
.SRWV       { WRHKOZB: MLMV; }

.JFRVG      { XLOLI: #333; }
.OLFW       { XLOLI: #999; }
.SRTSORTSG  { YZXPTILFMW:#UU9; }
.ZWWVW      { YZXPTILFMW:#939; XLOLI: #UUU; }
.IVNLEVW    { YZXPTILFMW:#099; XLOLI: #UUU; }

.URIHG      { NZITRM-OVUG:9; KZWWRMT-OVUG:9; }
.OZHG       { NZITRM-IRTSG:9; KZWWRMT-IRTSG:9; }
.GLK        { NZITRM-GLK:9; KZWWRMT-GLK:9; }
.YLGGLN     { NZITRM-YLGGLN:9; KZWWRMT-YLGGLN:9; }
//##**---------------- ./HGZIUOVVG/GVNKOZGV/HGZGFH_IVKLIG.SGNO

    <GZYOV>
      <XZKGRLM> hBHGVN hGZGFH iVKLIG </XZKGRLM>
      <GSVZW>
        <GI>
          <GS>nZXSRMV</GS>
          <GS>hGZGFH</GS>
        </GI>
      </GSVZW>
    {% ULI NZXSRMV RM NZXSRMVH %}
      <GI>
        <GW> {{NZXSRMV}}</GW>
        {% RU NZXSRMVH[NZXSRMV].HGZGFH %}
        <GW>lp</GW>
        {% VOHV %}
        <GW HGBOV="YZXPTILFMW:IVW">viili</GW>
        {% VMWRU %}
      </GI>
    {% VMWULI %}
   </GZYOV>
//##**---------------- ./HGZIUOVVG/XSVXPLK/FHRNGVHG.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
RNKLIG HSFGRO
UILN YZHV.YZHV_XSVXPLK RNKLIG yZHVxSVXPlk

# UILN YZHV.YZHV_QLY RNKLIG qLY

XOZHH FHRNGVHG(yZHVxSVXPlk):

    WVU __RMRG__(HVOU, CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL):
        HFKVI(FHRNGVHG, HVOU).__RMRG__(CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL)


    WVU DLIP(HVOU):
        KIRMG('----WZGZYZXPFK---------------->', HVOU.RW, HVOU.NLMHGVI.XDW)
        XDW = HVOU.NLMHGVI.XDW
        LOW = LH.KZGS.QLRM(XDW, "WZGZ")
        MVD = XDW + "_WZGZYZXP"
        RU LH.KZGS.VCRHGH(LOW):
            RU LH.KZGS.VCRHGH(MVD):
                HSFGRO.INGIVV(MVD, RTMLIV_VIILIH=gIFV)
            HSFGRO.XLKBGIVV(LOW, MVD)
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/XSVXPLK/XLKBZOKSZ.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
# RNKLIG LH
UILN YZHV.YZHV_XSVXPLK RNKLIG yZHVxSVXPlk

# UILN YZHV.YZHV_QLY RNKLIG qLY

XOZHH XLKBZOKSZ(yZHVxSVXPlk):

    WVU __RMRG__(HVOU, CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL):
        HFKVI(XLKBZOKSZ, HVOU).__RMRG__(CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL)
        KIRMG(CNO)

    WVU DLIP(HVOU):
        KIRMG(HVOU.RW)
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/XSVXPLK/ZYMLINZOLIWVIXSVXP.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
# RNKLIG LH
UILN YZHV.YZHV_XSVXPLK RNKLIG yZHVxSVXPlk

# UILN YZHV.YZHV_QLY RNKLIG qLY

XOZHH ZYMLINZOLIWVIXSVXP(yZHVxSVXPlk):

    WVU __RMRG__(HVOU, CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL):
        HFKVI(ZYMLINZOLIWVIXSVXP, HVOU).__RMRG__(CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.WZGZ_RW = "fgizwv_hgzg.ZYMLIZNO.%H" %  NLMHGVI.GZT
        HVOU.NLMHGVI = NLMHGVI
        HVOU.IVOLZW()

    WVU IVOLZW(HVOU):
        HFKVI(ZYMLINZOLIWVIXSVXP, HVOU).IVOLZW()
        HVOU.IVTRHGVI_XZMZIB_WZGZ(HVOU.WZGZ_RW, 6)
        HVOU.OLT_UROV_UW = mLMV
        HVOU.OLT_UROV_HRAV = 9
        HVOU.ZYMLINZO_LIWVIH = 9

    WVU DLIP(HVOU):
        GIB:
            HVOU.WL_DLIP()
        VCXVKG:
            KZHH

    WVU WL_DLIP(HVOU):
        RU HVOU.OLT_UROV_UW == mLMV:
            HVOU.OLT_UROV_UW = LKVM(HVOU.NLMHGVI.OLT_UROV, 'I')

        HG = LH.HGZG(HVOU.NLMHGVI.OLT_UROV)

        RU HVOU.OLT_UROV_HRAV == 9:
            HVOU.OLT_UROV_HRAV = HG.HG_HRAV

        OLT_HRAV_WRUU = HG.HG_HRAV - HVOU.OLT_UROV_HRAV

        RU OLT_HRAV_WRUU > 899*8975:
            # OLT HRAV RMXIVZHVH LEVI 899P, NFHG YV HLNVGSRMT DILMT
            HVOU.OLTTVI.VIILI('%H TVMVIZGVH GLL NZMB OLTH > 899P/H, HLNVGSRMT RH DILMT', HVOU.NLMHGVI.OLT_UROV)
        VOHV:
            ORMVH = mLMV
            GIB:
                UROV_KLH = HVOU.OLT_UROV_UW.GVOO()
                ORMVH = MVCG( FYRJUROV.DZGXS_UROV(HVOU.OLT_UROV_UW, MLYOLXP=gIFV) )
            VCXVKG fMRXLWVwVXLWVvIILI:
                HVOU.OLT_UROV_UW = LKVM(HVOU.OLT_UROV, 'I', VMXLWRMT='TYP')
                HVOU.OLT_UROV_UW.HVVP(UROV_KLH)
                ORMVH = MVCG( FYRJUROV.DZGXS_UROV(HVOU.OLT_UROV_UW, MLYOLXP=gIFV) )
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI('LHVIILI %H'%HGI(V))
            RU MLG ORMVH:
                IVGFIM

            ULI ORMV RM ORMVH:
                GZITVG = ORMV.HGIRK()
                RU IV.HVZIXS('VIILI', GZITVG) LI IV.HVZIXS('XIRGRXZO', GZITVG):
                    KZHH
                VORU IV.HVZIXS('DZIMRMT', GZITVG):
                    RU IV.HVZIXS('ZYMLINZO', GZITVG):
                        HVOU.ZYMLINZO_LIWVIH += 8
                        HVOU.FKWZGV_XZMZIB_WZGZ(HVOU.WZGZ_RW,
                                                {'UROVOLT': HVOU.FGIZWV_OLTTVI, 'ZYMLINZO_LIWVIH': HVOU.ZYMLINZO_LIWVIH})
        HVOU.OLT_UROV_HRAV = HG.HG_HRAV
        HVOU.FKWZGV_XZMZIB_WZGZ(HVOU.WZGZ_RW, {'UROVOLT': HVOU.FGIZWV_OLTTVI})
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/XSVXPLK/ELRWXSVXP.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
# RNKLIG LH
UILN YZHV.YZHV_XSVXPLK RNKLIG yZHVxSVXPlk

# UILN YZHV.YZHV_QLY RNKLIG qLY

XOZHH ELRWXSVXP(yZHVxSVXPlk):

    WVU __RMRG__(HVOU, CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL):
        HFKVI(ELRWXSVXP, HVOU).__RMRG__(CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL)


    WVU DLIP(HVOU):
        HVOU.OLTTVI.VIILI('ELRWXSVXP IFMH')
        KIRMG(HVOU.RW)
        IVGFIM uZOHV
//##**---------------- ./HGZIUOVVG/XSVXPLK/ZOKSZXSVXP.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG LH
RNKLIG HBH
RNKLIG GRNV
RNKLIG GIZXVYZXP

UILN FYRJGLLO.FGRO RNKLIG IVKOZXV_HKVXRZO_GRNVSLOWVI
RNKLIG FYRJGLLO.FGRO ZH FGRO
UILN HSFGRO RNKLIG XLKBUROV

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
# RNKLIG LH
UILN YZHV.YZHV_XSVXPLK RNKLIG yZHVxSVXPlk
RNKLIG KKIRMG

# UILN YZHV.YZHV_QLY RNKLIG qLY

XOZHH ZOKSZXSVXP(yZHVxSVXPlk):
    WVU __RMRG__(HVOU, CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL):
        HFKVI(ZOKSZXSVXP, HVOU).__RMRG__(CNO, GRNV_HKZM, NLMHGVI, TOLYZO_RMUL)
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.CNO = CNO
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.NLMHGVI = NLMHGVI
        # KKIRMG.KKIRMG(HVOU.NLMHGVI.zOKSZkZGS)
        # <YVULIV_HGZIG NLWFOV="ELRWXSVXP"  VGZ="89H"  />


    WVU DLIP(HVOU):
        HVOU.HLFIXV_KZGS = FGRO.IVKOZXV_HKVXRZO_GRNVSLOWVI(HVOU.CNO.ZGGIRY['HLFIXV_KZGS'], HVOU.TOLYZO_RMUL.XOLXP)
        HVOU.ZOKSZ_KZGS = FGRO.IVKOZXV_HKVXRZO_GRNVSLOWVI(HVOU.CNO.ZGGIRY['ZOKSZ_KZGS'], HVOU.TOLYZO_RMUL.XOLXP)
        GIB:
            URMRHSUROV = LKVM(LH.KZGS.QLRM(HVOU.HLFIXV_KZGS, 'URMRHS.GCG'), 'I')
            GZITVGWRI = URMRHSUROV.IVZWORMV().HGIRK()
            HIX = LH.KZGS.QLRM(HVOU.HLFIXV_KZGS, GZITVGWRI, 'GZITVG.GCG')
            KIRMG("XLKB ZOKSZ %H --> %H" % (HIX, LH.KZGS.QLRM(HVOU.ZOKSZ_KZGS, GZITVGWRI)))
            WHG = LH.KZGS.QLRM(HVOU.ZOKSZ_KZGS, GZITVGWRI)
            LH.NZPVWRIH(WHG, VCRHG_LP=gIFV)
            XLKBUROV(HIX, WHG)
            LKVM(LH.KZGS.QLRM(HVOU.ZOKSZ_KZGS, GZITVGWRI + '.URM'), 'Z').XOLHV()
            IVGFIM gIFV
        VCXVKG:
            HVOU.OLTTVI.VIILI("ZOKSZ XSVXPRMT UZRO KOVZHV XSVXP KLH ULOWVI %H " % (HVOU.HLFIXV_KZGS))
            HVOU.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX())
            IVGFIM uZOHV






//##**---------------- ./HGZIUOVVG/SVOKVI/IVNLGVQLY.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm + '/HGZIUOVVG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
RNKLIG LH
RNKLIG GRNV
UILN YZHV.NZMZTVNVMG RNKLIG lMVGRNVdLIPVI

WVU JFVIB_QLY(IVWHSRUG, GZITVG):
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'JFVIBLMVGRNVLK'
    IVKOB = IVWHSRUG.HVMW(NHT)
    LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
    IVGFIM LKORHG

WVU JFVIB_IVHFOG(IVWHSRUG, GZITVG, PVB):
    LKORHG = JFVIB_QLY(IVWHSRUG, GZITVG)
    ULI R RM LKORHG:
        RU R.IZMWLN_RW == PVB:
            IVGFIM R
    IVGFIM mLMV


WVU OLZW_LK(IVWHSRUG, GZITVG, DLIPVI = mLMV):
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'RMHGZOOIFMGRNVLK'
    LKWZGZ = []
    XLMURT = '<LKVIZGRLM _LMVGRNV_="GIFV"  NLWFOV="iFMGRNVlk" GZIUROV="'+GZITVG+'"/>'
    DRGS LKVM(LH.KZGS.QLRM('/LKG/EVIHRLM', evihrlm, 'HGZIUOVVG', 'LKVIZGRLM', 'iFMGRNVlk.KB'), 'I') ZH U:
        LKWZGZ.ZKKVMW( U.IVZW() )
        LKWZGZ.ZKKVMW( XLMURT )
        RU DLIPVI RH MLG mLMV:
            LKWZGZ.ZKKVMW(DLIPVI)
        NHT.WZGZ = KRXPOV.WFNKH(LKWZGZ)
        IVKOB = IVWHSRUG.HVMW(NHT)
        # OLTTVI.RMUL('%H'%HGI(IVKOB))
        # KIRMG(IVKOB)
        RU MLG IVKOB.HGZGFH:
            KIRMG('viili', 'UZROVW GL RMHGZOO iFMGRNVlk viili %H'%IVKOB.NVHHZTV)
            IVGFIM mLMV
        VOHV:
            IVGFIM IVKOB.NVHHZTV.HKORG('-')[8]

XOZHH iVNLGVqLY(LYQVXG):
    WVU __RMRG__(HVOU, GZITVG, DLIPVI = mLMV):
        HVOU.GZITVG = GZITVG
        HVOU.KLIG = '49939'
        HVOU.HVIEVI = '872.9.9.8'
        HVOU.HGZGFH = gIFV
        HVOU.PVB = mLMV
        HVOU.IVHFOG = mLMV
        HVOU.KILTIVHH = 'MLG HGZIGVW'
        HVOU.DLIPVI = DLIPVI

    WVU HVMW(HVOU):
        HVOU.IVWHSRUG = iVWHSRUGxORVMG(HVOU.HVIEVI, HVOU.KLIG)
        HVOU.PVB = OLZW_LK(HVOU.IVWHSRUG, HVOU.GZITVG, HVOU.DLIPVI)
        RU HVOU.PVB RH mLMV:
            HVOU.HGZGFH = uZOHV
        IVGFIM HVOU.PVB

    WVU JFVIB_IVHFOG(HVOU):
        HVOU.IVHFOG = JFVIB_IVHFOG(HVOU.IVWHSRUG, HVOU.GZITVG, HVOU.PVB)
        RU HVOU.IVHFOG RH mLMV:
            HVOU.HGZGFH = uZOHV
        HVOU.KILTIVHH = HVOU.IVHFOG.HGZGFH
        IVGFIM HVOU.IVHFOG

    WVU KIRMG_IVHFOG(HVOU):
        KIRMG('------')
        KIRMG('QLY   : %H'%HVOU.IVHFOG.RW)
        KIRMG('OZYVO : %H'%HVOU.IVHFOG.IZMWLN_RW)
        RU HVOU.IVHFOG.HGZIG_GRNV RH MLG mLMV:
            KIRMG('HGZIG : %H'%HVOU.IVHFOG.HGZIG_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
        RU HVOU.IVHFOG.VMW_GRNV RH MLG mLMV:
            KIRMG('VMW   : %H'%HVOU.IVHFOG.VMW_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
        KIRMG('HGZGFH: %H'%HVOU.IVHFOG.HGZGFH)



//##**---------------- ./HGZIUOVVG/SVOKVI/FGRO.KB
RNKLIG IV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
UILN WZGVGRNV RNKLIG WZGVGRNV
RNKLIG HRC
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG HBH
RNKLIG LH
RNKLIG RNK
RNKLIG XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7
# WVU RNKLIG_LKVIZGRLM(MZNV):
    # # gSRH UFMXGRLM RH GL RNKLIG LKVIZRGLM NLWFOVH UILN MZNV
    # KIRMG HBH.KZGS
    # KIRMG MZNV
    # NLW = __RNKLIG__(MZNV)
    # XLNKLMVMGH = MZNV.HKORG('.')
    # ULI XLNK RM XLNKLMVMGH[8:]:
        # NLW = TVGZGGI(NLW, XLNK)
    # IVGFIM TVGZGGI(NLW, XLNKLMVMGH[-8])

WVU RNKLIG_XLNNZMW(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'XLNNZMW') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_HLK(MZNV, KZGS=''):
    RU KZGS == '':
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'HLK') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, [KZGS])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_XSVXPLK(MZNV, KZGS=[]):
    RU OVM(KZGS) == 9:
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'XSVXPLK') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, KZGS)
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_LKVIZGRLM(MZNV, KZGS=[]):
    RU OVM(KZGS) == 9:
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'LKVIZGRLM') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, KZGS)
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_NLWFOV(MZNV, KZGS=[]):
    RU OVM(KZGS) == 9:
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'NLWFOV') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, KZGS)
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_OLXZOKILXVHHLI(MZNV, KZGS=''):
    WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KZGS, 'XLNNZMW', 'OLXZOKILXVHHLI')])
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_HGZIZGVTB(MZNV, KZGS=''):
    RU OVM(KZGS) == 9:
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'HGZIZGVTB') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, KZGS)
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_HGPHRTLK(MZNV, KZGS=''):
    RU OVM(KZGS) == 9:
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'HGPHRTLK') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, KZGS)
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU RNKLIG_IRHPUROGVI(MZNV, KZGS=''):
    RU OVM(KZGS) == 9:
        WVH = RNK.URMW_NLWFOV(MZNV, [LH.KZGS.QLRM(KG, 'IRHPUROGVI') ULI KG RM HBH.KZGS])
    VOHV:
        WVH = RNK.URMW_NLWFOV(MZNV, KZGS)
    NLWFOV = RNK.OLZW_NLWFOV(MZNV, WVH[9], WVH[8], WVH[7])
    IVGFIM (TVGZGGI(NLWFOV, MZNV), NLWFOV.__UROV__)

WVU KZIHV_GRNV(GRNV_HGI):
    ULI UNG RM ('%s:%n:%h', '%s:%n'):
        GIB:
            IVGFIM WZGVGRNV.HGIKGRNV(GRNV_HGI, UNG).GRNV()
        VCXVKG eZOFVvIILI:
            KZHH
    IZRHV eZOFVvIILI("XZMMLG IVXLTMRAV GRNV HGIRMT: "+GRNV_HGI)


WVU KZIHV_WZGVGRNV(WZGVGRNV_HGI):
    ULI UNG RM ('%b-%N-%W %s:%n:%h', '%B%N%W %s:%n:%h', '%b%N%W-%s:%n:%h.%U'):
        GIB:
            IVGFIM WZGVGRNV.HGIKGRNV(WZGVGRNV_HGI, UNG)
        VCXVKG eZOFVvIILI:
            KZHH
    IZRHV eZOFVvIILI("XZMMLG IVXLTMRAV GRNV HGIRMT: "+WZGVGRNV_HGI)

WVU KZIHV_GRNVWVOGZ(WVOGZ_HGI):
    IVTVC = IV.XLNKROV(I'((?k<SLFIH>\W+?)S)?((?k<NRMFGVH>\W+?)N)?((?k<HVXLMWH>\W+?)H)?')
    KZIGH = IVTVC.NZGXS(WVOGZ_HGI)
    RU MLG KZIGH:
        IVGFIM
    KZIGH = KZIGH.TILFKWRXG()
    GRNV_KZIZNH = {}
    ULI (MZNV, KZIZN) RM HRC.RGVIRGVNH(KZIGH):
        RU KZIZN:
            GRNV_KZIZNH[MZNV] = RMG(KZIZN)
    IVGFIM GRNVWVOGZ(**GRNV_KZIZNH)

WVU TVG_XFIIVMG_KFYGRNVHGZNK():
    IVGFIM RMG(WZGVGRNV.MLD().HGIUGRNV('%s%n%h%U')[:-6])

WVU TVG_XFIIVMG_KFYWZGV():
    IVGFIM RMG(WZGVGRNV.MLD().HGIUGRNV('%b%N%W'))


WVU ZWW_GRNV(GRNV, WVOGZ):
    IVGFIM (WZGVGRNV.XLNYRMV(WZGVGRNV.GLWZB(),GRNV ) + WVOGZ).GRNV()

WVU NRMFH_GRNV(GRNV, WVOGZ):
    IVGFIM (WZGVGRNV.XLNYRMV(WZGVGRNV.GLWZB(),GRNV ) - WVOGZ).GRNV()


WVU XSVXP_RM_HVHHRLM(MLD, GRNV8, GRNV7):
    RU GRNV7 < GRNV8: # FHFZOOB GSRH RH LEVIMRTSG HVHHRLM
        RU MLD > GRNV8:
            IVGFIM gIFV
        VORU MLD < GRNV8 ZMW MLD > GRNV7:
            IVGFIM uZOHV
        VORU MLD < GRNV8 ZMW MLD < GRNV7:
            IVGFIM gIFV
    VORU GRNV7 > GRNV8:
        RU  GRNV8 < MLD < GRNV7:
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV
    VORU GRNV7 == GRNV8:
        IVGFIM gIFV


WVU HGIUWVOGZ(GWVOGZ, UNG):
        W = {'WZBH': GWVOGZ.WZBH}
        W['SLFIH'], IVN = WRENLW(GWVOGZ.HVXLMWH, 6399)
        W['NRMFGVH'], W['HVXLMWH'] = WRENLW(IVN, 39)
        IVGFIM UNG.ULINZG(**W)


XOZHH hgwlfgiVXLIWVI(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.LFGKFG = ''

    WVU HGZIG(HVOU):
        HVOU.LOW_HGWLFG = HBH.HGWLFG
        HBH.HGWLFG = gVCGrldIZKKVI(yBGVHrl(), HBH.HGWLFG.VMXLWRMT)

    WVU HGLK(HVOU):
        HBH.HGWLFG.HVVP(9)
        HVOU.LFGKFG = HBH.HGWLFG.IVZW()
        HBH.HGWLFG.XOLHV()
        HBH.HGWLFG = HVOU.LOW_HGWLFG
        IVGFIM HVOU.LFGKFG
//##**---------------- ./HGZIUOVVG/SVOKVI/XLNNZMWSVOKVI.KB
RNKLIG IV
UILN WZGVGRNV RNKLIG GRNVWVOGZ
UILN WZGVGRNV RNKLIG WZGVGRNV
RNKLIG HRC
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG HBH
RNKLIG LH
RNKLIG RNK
RNKLIG XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7

WVU KZIHV_XLNNZMW_GVCG(XLNNZMW_GVCG):
    XNW_ORHG = XLNNZMW_GVCG.HGIRK(' ').HKORG(' ')
    XNW = XNW_ORHG[9] #NZQLI XLNNZMW
    VOV_IVG = ''
    ULI VOV RM XNW_ORHG[8:]: # ZITFNVMGH
        YLOR_VOV = VOV.HKORG('=')
        RU OVM(YLOR_VOV) == 8:
            YLOR_VOV = YLOR_VOV[9]+'='
            VOV_IVG += '&' + YLOR_VOV
        VOHV:
            VOV_IVG += '&' + VOV
    IVGFIM XLNNZMW_KY7.xLNNZMWiVJFVHG(XLNNZMW=XNW, ZITFNVMGH=VOV_IVG[8:])


WVU DIZK_XLNNZMW(IVWHSRUG, KILTIZN, HVIEVI, XLNNZMW_GVCG):
    XLNNZMW = KZIHV_XLNNZMW_GVCG(XLNNZMW_GVCG)
    NHT = IVWHSRUG.XLNNZMW_GL_HGZIUOVVG(HVIEVI)
    NHT.XLNNZMW = 'RHHFV_XLNNZMW&'+KILTIZN
    NHT.WZGZ = XLNNZMW.hVIRZORAVgLhGIRMT()
    IVGFIM NHT


//##**---------------- ./HGZIUOVVG/SVOKVI/RMGVIUZXVH.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
# RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm + '/HGZIUOVVG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
# RNKLIG LH
# RNKLIG GRNV
UILN FYRJGLLO.SVOKVI RNKLIG kRXPOVdIZKKVI


WVU JFVIB_WVGZRO(IVWHSRUG, GZITVG):
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'JFVIB_WVGZRO&ZOO'
    # NHT.WZGZ = KRXPOV.WFNKH(IVU)
    IVKOB = IVWHSRUG.HVMW(NHT)
    LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
    IVGFIM LKORHG

WVU HVMW_XLNNZMW(IVWHSRUG, GZITVG, XNW, GRNVLFG = 7):
    '''
    kFIKLHV:
        HVMW XLNNZMW GL IVNLGV HVIEVI'H XLNKLMVMG
    gZITVG NLWFOV:
        wLXPVI
    '''
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'HVMW_XLNNZMW'
    ZITH = {'GRNVLFG':7, 'WZGZ':KRXPOV.WFNKH(kRXPOVdIZKKVI().DIZK(XNW))}
    NHT.WZGZ = KRXPOV.WFNKH(ZITH)
    # NHT.WZGZ = KRXPOV.WFNKH(IVU)
    IVKOB = IVWHSRUG.HVMW(NHT)
    # LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
    IVGFIM IVKOB


WVU JFVIB_QLY(IVWHSRUG, GZITVG, IVU = 'ZOO'):
    '''
    kFIKLHV:
        ZXJFRIV IVNLGV LMVGRNV QLYH RMUL
    gZITVG NLWFOV:
        wLXPVI
    '''
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    RU IVU == 'ZOO':
        NHT.XLNNZMW = 'JFVIBLMVGRNVLK'
    VOHV:
        NHT.XLNNZMW = 'JFVIBLMVGRNVLK&'+IVU
    NHT.WZGZ = KRXPOV.WFNKH(IVU)
    IVKOB = IVWHSRUG.HVMW(NHT)
    LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
    IVGFIM LKORHG

WVU JFVIB_DLIP(IVWHSRUG, GZITVG, IVU = 'ZOO'):
    '''
    kFIKLHV:
        ZXJFRIV IVNLGV LMVGRNV DLIP RMUL
    gZITVG NLWFOV:
        wLXPVI
    '''
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    RU IVU == 'ZOO':
        NHT.XLNNZMW = 'JFVIBDLIP'
    VOHV:
        NHT.XLNNZMW = 'JFVIBDLIP&'+IVU
    NHT.WZGZ = KRXPOV.WFNKH(IVU)
    IVKOB = IVWHSRUG.HVMW(NHT)
    LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
    IVGFIM LKORHG


WVU PROO_DLIP(IVWHSRUG, GZITVG, IVU = 'ZOO'):
    '''
    kFIKLHV:
        ZXJFRIV IVNLGV LMVGRNV DLIP RMUL
    gZITVG NLWFOV:
        wLXPVI
    '''
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    RU IVU == 'ZOO':
        NHT.XLNNZMW = 'PROODLIP'
    VOHV:
        NHT.XLNNZMW = 'PROODLIP&'+IVU
    NHT.WZGZ = KRXPOV.WFNKH(IVU)
    IVKOB = IVWHSRUG.HVMW(NHT)
    LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
    IVGFIM LKORHG


WVU IVNLEV_DLIP(IVWHSRUG, GZITVG, IVU):
    '''
    kFIKLHV:
        IVNLEV IVNLGV LMVGRNV DLIP RMUL
    gZITVG NLWFOV:
        wLXPVI
    '''
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'IVNLEVDLIP&'+IVU
    IVKOB = IVWHSRUG.HVMW(NHT)
    IVGFIM IVKOB



WVU IVJFVHG_UROV_RMUL(IVWHSRUG, GZITVG, KZGS):
    '''
    kFIKLHV:
        ZXJFRIV IVNLGV UROV'H RMUL
    gZITVG NLWFOV:
        uROVeZFOG
    '''
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'IVJFVHG-UROV-RMUL&'+KZGS
    IVKOB = IVWHSRUG.HVMW(NHT)
    IVGFIM IVKOB


WVU IVJFVHG_UROV_XLMGVMG(IVWHSRUG, GZITVG, KZGS):
    '''
    kFIKLHV:
        ZXJFRIV IVNLGV UROV'H XLMGVMG
    gZITVG NLWFOV:
        uROVeZFOG
    '''
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'IVJFVHG-UROV-XLMGVMG&'+KZGS
    IVKOB = IVWHSRUG.HVMW(NHT)
    IVGFIM IVKOB
//##**---------------- ./HGZIUOVVG/SVOKVI/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/XLNNZMW/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/XLNNZMW/YZHV_XLNNZMW.KB
UILN XLNNZMW RNKLIG XLNNZMW_KY7

XOZHH yZHVxLNNZMW(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.XLNNZMW = ''
        HVOU.HFY_XLNNZMW = ''
        HVOU.ZITFNVMGH = {}
        HVOU.IVHKLMHV = XLNNZMW_KY7.xLNNZMWiVKOB()

    WVU FHZTV(HVOU):
        IVGFIM 'ML FHZTV ULI GSRH XLNNZMW'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_HFYNRG.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
RNKLIG LH
RNKLIG RNKLIGORY
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

WVU oLZW(NLWFOV, UROVKZGS):
    HKVX = RNKLIGORY.FGRO.HKVX_UILN_UROV_OLXZGRLM(NLWFOV, UROVKZGS)
    ULL = RNKLIGORY.FGRO.NLWFOV_UILN_HKVX(HKVX)
    HKVX.OLZWVI.VCVX_NLWFOV(ULL)
    XOZHHLK = TVGZGGI(ULL, NLWFOV)
    XLMURTFIZGRLM = XOZHHLK.RMRG_XLMURT()
    IVGFIM XLMURTFIZGRLM




XOZHH OLXZOKILXVHHLI_HFYNRG(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_HFYNRG, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)


    WVU KZIHV_IFMMRMT_NZMMVI(HVOU, CNO):
        """IFMMRMT NZMMVI."""
        KIRMG('---------\M RMKFG IFMMRMT NZMMVI:\M[8] IFM VEVIB C HVXLMWH\M[7] IFM VEVIB C HVXLMWH GL HFXXVHH \M[6] IFM LM KIV-HVKXRURVW GRNV HOLG')
        HVOVXGRLM = HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> RMKFG HVOVXGRLM [8-6]: ')
        RU HVOVXGRLM == '8' LI HVOVXGRLM == '7':
            GRNV = HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> YB DSZG GRNV RMGVIEZO HSZOO RG IFM?, V.T. 8H, 7N: ')
            RU HVOVXGRLM == '8':
                CNO.ZGGIRY['VEVIB'] = GRNV
            VORU HVOVXGRLM  == '7':
                CNO.ZGGIRY['VEVIB_GL_HFXXVHH'] = GRNV
            IVGFIM
        VORU HVOVXGRLM == '6':
            GRNV = HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> LM DSZG GRNV HOLG?, V.T. 89:76:69, 89:76: ')
            CNO.ZGGIRY['LM_GRNV'] = GRNV
            IVGFIM


    WVU KZIHV_MVD_GSIVZW(HVOU, CNO):
        """RU FHV HVKZIZGV GSIVZW."""
        HVOVXGRLM = HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> DSVGSVI FHV MVD GSIVZW [B/M]: ')
        RU HVOVXGRLM == 'B':
            CNO.ZGGIRY['MVD_GSIVZW'] = 'GIFV'
        VORU HVOVXGRLM == 'M':
            CNO.ZGGIRY['MVD_GSIVZW'] = 'UZOHV'
            IVGFIM


    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        # GZPV UROV KZGS

        UROVKZGS = LH.KZGS.VCKZMWFHVI(HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> RMKFG LK KZGS: '))
        RU MLG LH.KZGS.RHUROV(UROVKZGS):
            KIRMG('viili: %H MLG VCRHGVW RM GSV KZGS'%UROVKZGS)
            IVGFIM mLMV
        NLWFOV_MZNV =LH.KZGS.YZHVMZNV(UROVKZGS)[:-6]
        IVHKLMHV  = HVOU.HVMW_XLNNZMW( HVOU.IZD_KILXVHH('XSVXP LKVIZGRLM NLWFOV=%H'%NLWFOV_MZNV) )
        KIRMG(IVHKLMHV.NVHHZTV)
        CNO = VGIVV.UILNHGIRMT('<LKVIZGRLM NLWFOV="%H" />'%NLWFOV_MZNV)
        # GZPV IVTRLM
        IVTRLM = HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> RMKFG IVTRLM [WVUZFOG-xm]: ')
        RU IVTRLM == '':
            IVTRLM = 'xm'
        CNO.ZGGIRY['IVTRLM'] = IVTRLM

        # GZPV IFMMRMVI NZMMVI:
        HVOU.KZIHV_IFMMRMT_NZMMVI(CNO)

        # KZIHV MVD GSIVZW
        HVOU.KZIHV_MVD_GSIVZW(CNO)

        # GZPV XLMURTFIZGRLMH
        XLMURTFIZGRLM = oLZW(NLWFOV_MZNV, UROVKZGS)
        ULI P, E RM XLMURTFIZGRLM.KZIZ.RGVNH():
            RU E[9]:
                KZIZ = HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> RMKFG IVJFRIV  %H: '%P)
                E[8] = KZIZ
            VOHV:
                KZIZ = HVOU.KILNKG_NZMZTVI.KILNKG('[HFYNRG lk]-> RMKFG LKGRLMZO %H [WVUZFOG-%H]: '%(P, E[8]))
                RU KZIZ != '':
                    E[8] = KZIZ
            CNO.ZGGIRY[P] = E[8]
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        XLNNZMW.ZITFNVMGH += '&NLWFOV=%H'%NLWFOV_MZNV
        DRGS LKVM(UROVKZGS, 'I') ZH U:
            XLWV_WZGZ = U.IVZW()
            #IVH = HFKVI(OLXZOKILXVHHLI_HFYNRG, HVOU).KILXVHH(XLNNZMW_GVCG)
        XLNNZMW.OLMTORMV = XLWV_WZGZ
        XLNNZMW.HFKKOVNVMG = VGIVV.GLHGIRMT(CNO)
        IVHKLMHV  = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVG = ''
        RU IVHKLMHV.HGZGFH == 'GIFV':
            IVG='lk HFXXVHHUFOOB OLZWVW, LFGKFG:\M'
        VOHV:
            IVG='lk OLZWRMT UZROVW:\M'
        IVG += IVHKLMHV.NVHHZTV
        IVG += '\MMVD CNO XLMURTFIZGRLM RH:\M'+HGI(VGIVV.GLHGIRMT(CNO))
        IVHKLMHV.NVHHZTV = IVG
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_PROO.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_PROO(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_PROO, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        PROO_ORHG = XLNNZMW_GVCG.HKORG(' ')
        RU OVM(PROO_ORHG) > 8:
            KIRMG(PROO_ORHG[8])
            XLNNZMW.ZITFNVMGH = 'XLNKLMVMG=%H'%PROO_ORHG[8]
        #KIRMG(XLNNZMW)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_JFVIB.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI

XOZHH lKhGZGFH(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.RW = ''
        HVOU.NLWV = ''
        HVOU.OZHG_GRNV = ''
        HVOU.HFXXVHH_GRNVH = 9
        HVOU.UZRO_GRNVH = 9
        HVOU.IFM_GRNVH = 9
        HVOU.GIB_GRNVH = 9
        HVOU.IVOLZW_GRNVH = 9
        HVOU.NLWFOV = ''
        HVOU.HGZGFH = ''
        HVOU.IVHFOG = ''
        HVOU.NZIP = ''
        HVOU.UOZT = ''
        HVOU.VGZ = ''

    WVU KZIHV(HVOU, ORMV):
        OG = ORMV.HKORG('|')
        ULI RGVN RM OG:
            VOV = RGVN.HKORG('=')
            RU VOV[9] == 'RW':
                HVOU.RW = VOV[8]
            VORU VOV[9] == 'NLWFOV':
                HVOU.NLWFOV = VOV[8]
            VORU VOV[9] == 'NLWV':
                HVOU.NLWV = VOV[8]
            VORU VOV[9] == 'RMHGZOO':
                HVOU.RMHGZOO = VOV[8]
            VORU VOV[9] == 'OZHG_GRNV':
                HVOU.OZHG_GRNV = VOV[8]
            VORU VOV[9] == 'IFM_GRNVH':
                HVOU.IFM_GRNVH = VOV[8]
            VORU VOV[9] == 'HFXXVHH_GRNVH':
                HVOU.HFXXVHH_GRNVH = VOV[8]
            VORU VOV[9] == 'UZROFIV_GRNVH':
                HVOU.UZRO_GRNVH = VOV[8]
            VORU VOV[9] == 'IVHFOG':
                HVOU.IVHFOG =  VOV[8]
            VORU VOV[9] == 'HGZGFH':
                HVOU.HGZGFH =  VOV[8]
            VORU VOV[9] == 'vgz':
                HVOU.VGZ = VOV[8]

WVU HSLD_LK_NVHHZTV(NHT_ORHG):
        IVG = '%-4H   %71H%71H%76H%89H%89H%87H%87H%89H%89H%89H\M'%('rmw', 'lkrw', 'nlwfov','nlwv','ozhg_ivh','vgz', 'ozhg_grnv', 'hfxxvhh','uzro', 'ifm', 'hgzgfh')
        ULI RMW, NHT RM VMFNVIZGV(NHT_ORHG):
            LK_HGZGFH = lKhGZGFH()
            LK_HGZGFH.KZIHV(NHT)
            IVG += '[%-6W]   %71H%71H%76H%89H%89H%87H%87H%89H%89H%89H\M'%(RMW, LK_HGZGFH.RW,
                                                LK_HGZGFH.NLWFOV, LK_HGZGFH.NLWV, LK_HGZGFH.IVHFOG, LK_HGZGFH.VGZ,
                                                LK_HGZGFH.OZHG_GRNV, LK_HGZGFH.HFXXVHH_GRNVH,
                                                LK_HGZGFH.UZRO_GRNVH, LK_HGZGFH.IFM_GRNVH, LK_HGZGFH.HGZGFH)
        IVGFIM IVG


WVU HSLD_HLK_NVHHZTV(NHT_ORHG):
        IVG = '%-4H   %75H    %45H\M'%('rmw', 'hlk', 'yirvu')
        ULI RMW, NHT RM VMFNVIZGV(NHT_ORHG):
            IVG += '[%-6W]   %75H   %45H\M'%(RMW, NHT.HKORG('|')[9].HKORG('=')[8], NHT.HKORG('|')[8].HKORG('=')[8] )
        IVGFIM IVG

WVU HSLD_XLNKLMVMG_NVHHZTV(NHT_ORHG):
        IVG = '%4H %-74H%84H%89H%0H%89H%89H%2H%2H%2H%0H%1H%1H%1H\M'%('rmw', 'mznv', 'xlnklmvmg', 'hgzgfh','krw','hgzig','fkgrnv','dzim','viili','ortsg','ivhgzig', 'xkf', 'ihh', 'erig' )
        ULI RMW, NHT RM VMFNVIZGV(NHT_ORHG):
            RU NHT == '':
                XLMGRMFV
            WZGZ_ORHG = [R.HGIRK() ULI R RM NHT.HKORG('@')]
            IVG += '[%6W] %-74H%84H%89H%0H%89H%89H%2H%2H%2H%0W%1.8U%1H%1H\M'%(RMW, WZGZ_ORHG[9], WZGZ_ORHG[8], WZGZ_ORHG[7], WZGZ_ORHG[6], WZGZ_ORHG[5], WZGZ_ORHG[4], WZGZ_ORHG[3], WZGZ_ORHG[2],WZGZ_ORHG[1],RMG(WZGZ_ORHG[0]),UOLZG(WZGZ_ORHG[89]),WZGZ_ORHG[88],WZGZ_ORHG[87] )
        IVGFIM IVG


WVU HSLD_NLWFOV_NVHHZTV(NHT_ORHG):
        IVG = '%4H %-84H%84H%89H\M'%('rmw', 'mznv','krw', 'hgzgfh')
        ULI RMW, NHT RM VMFNVIZGV(NHT_ORHG):
            WZGZ_ORHG = [R.HGIRK() ULI R RM NHT.HKORG('|')]
            IVG += '[%6W] %-84H%84H%89H\M'%(RMW, WZGZ_ORHG[9], WZGZ_ORHG[8], WZGZ_ORHG[7] )
        IVGFIM IVG


XOZHH OLXZOKILXVHHLI_JFVIB(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_JFVIB, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        IVH = HFKVI(OLXZOKILXVHHLI_JFVIB, HVOU).KILXVHH(XLNNZMW_GVCG)
        JFVIB_GBKV = IVH.NVHHZTV.HKORG('&')[9].HKORG('=')[8]
        NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
        RU JFVIB_GBKV == 'LKVIZGRLM':
            IVG = HSLD_LK_NVHHZTV(NHT_ORHG)
        VORU JFVIB_GBKV == 'HLK':
            IVG = HSLD_HLK_NVHHZTV(NHT_ORHG)
        VORU JFVIB_GBKV == 'XLNKLMVMG' LI JFVIB_GBKV == 'XLNKLMVMG' :
            IVG = HSLD_XLNKLMVMG_NVHHZTV(NHT_ORHG)
        VORU JFVIB_GBKV == 'NLWFOV':
            IVG = HSLD_NLWFOV_NVHHZTV(NHT_ORHG)
        IVH.NVHHZTV = IVG
        IVGFIM IVH
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_OLZW.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_OLZW(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_OLZW, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        OLZW_ORHG = XLNNZMW_GVCG.HKORG(' ')
        ZITFNVMGH_ORHG = OLZW_ORHG[7:]
        RU OVM(OLZW_ORHG) == 8 LI OLZW_ORHG[8] == '':
            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[OLZW]-> OLZW GZITVG NFHG VRGSVI YV LK LI HLK: ')
            XLNNZMW.ZITFNVMGH = MZNV
        RU 'HLK' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[OLZW hlk]-> BLF HSZOO RMKFG HLK RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB HLK'
                IVH = HFKVI(OLXZOKILXVHHLI_OLZW, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_HLK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[OLZW hlk]-> RMKFG HLK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[OLZW hlk]-> ROOVTZO XSLRXV, KOVZHV RMKFG HLK RW: ')
                KIRMG('[OLZW hlk]-> DROO OLZW hlk %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'HLK&ZITFNVMGH='+MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'HLK&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        VORU 'LK' RM XLNNZMW.ZITFNVMGH LI 'LKVIZGRLM' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[OLZW lk]-> BLF HSZOO RMKFG LK RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB LKVIZGRLM'
                IVH = HFKVI(OLXZOKILXVHHLI_OLZW, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_LK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[OLZW lk]-> RMKFG LK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[OLZW lk]-> ROOVTZO XSLRXV, KOVZHV RMKFG LK RW: ')
                KIRMG('[OLZW lk]-> DROO OLZW lk %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH=%H'%MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_ZORVMKILTIZN.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
RNKLIG KRXPOV

XOZHH lKhGZGFH(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.RW = ''
        HVOU.NLWV = ''
        HVOU.OZHG_GRNV = ''
        HVOU.HFXXVHH_GRNVH = 9
        HVOU.UZRO_GRNVH = 9
        HVOU.IFM_GRNVH = 9
        HVOU.GIB_GRNVH = 9
        HVOU.IVOLZW_GRNVH = 9
        HVOU.NLWFOV = ''
        HVOU.HGZGFH = ''
        HVOU.IVHFOG = ''
        HVOU.NZIP = ''
        HVOU.UOZT = ''
        HVOU.VGZ = ''

    WVU KZIHV(HVOU, ORMV):
        OG = ORMV.HKORG('|')
        ULI RGVN RM OG:
            VOV = RGVN.HKORG('=')
            RU VOV[9] == 'RW':
                HVOU.RW = VOV[8]
            VORU VOV[9] == 'NLWFOV':
                HVOU.NLWFOV = VOV[8]
            VORU VOV[9] == 'NLWV':
                HVOU.NLWV = VOV[8]
            VORU VOV[9] == 'RMHGZOO':
                HVOU.RMHGZOO = VOV[8]
            VORU VOV[9] == 'OZHG_GRNV':
                HVOU.OZHG_GRNV = VOV[8]
            VORU VOV[9] == 'IFM_GRNVH':
                HVOU.IFM_GRNVH = VOV[8]
            VORU VOV[9] == 'HFXXVHH_GRNVH':
                HVOU.HFXXVHH_GRNVH = VOV[8]
            VORU VOV[9] == 'UZROFIV_GRNVH':
                HVOU.UZRO_GRNVH = VOV[8]
            VORU VOV[9] == 'IVHFOG':
                HVOU.IVHFOG =  VOV[8]
            VORU VOV[9] == 'HGZGFH':
                HVOU.HGZGFH =  VOV[8]
            VORU VOV[9] == 'vgz':
                HVOU.VGZ = VOV[8]

WVU HSLD_LK_NVHHZTV(NHT_ORHG):
        IVG = '%-4H   %71H%71H%76H%89H%89H%87H%87H%89H%89H%89H\M'%('rmw', 'lkrw', 'nlwfov','nlwv','ozhg_ivh','vgz', 'ozhg_grnv', 'hfxxvhh','uzro', 'ifm', 'hgzgfh')
        ULI RMW, NHT RM VMFNVIZGV(NHT_ORHG):
            LK_HGZGFH = lKhGZGFH()
            LK_HGZGFH.KZIHV(NHT)
            IVG += '[%-6W]   %71H%71H%76H%89H%89H%87H%87H%89H%89H%89H\M'%(RMW, LK_HGZGFH.RW,
                                                LK_HGZGFH.NLWFOV, LK_HGZGFH.NLWV, LK_HGZGFH.IVHFOG, LK_HGZGFH.VGZ,
                                                LK_HGZGFH.OZHG_GRNV, LK_HGZGFH.HFXXVHH_GRNVH,
                                                LK_HGZGFH.UZRO_GRNVH, LK_HGZGFH.IFM_GRNVH, LK_HGZGFH.HGZGFH)
        IVGFIM IVG


WVU HSLD_HLK_NVHHZTV(NHT_ORHG):
        IVG = '%-4H   %75H    %45H\M'%('rmw', 'hlk', 'yirvu')
        ULI RMW, NHT RM VMFNVIZGV(NHT_ORHG):
            IVG += '[%-6W]   %75H   %45H\M'%(RMW, NHT.HKORG('|')[9].HKORG('=')[8], NHT.HKORG('|')[8].HKORG('=')[8] )
        IVGFIM IVG

WVU HSLD_XLNKLMVMG_NVHHZTV(NHT_ORHG):
        IVG = '%4H %-74H%84H%89H%0H%89H%89H%2H%2H%2H%0H%1H%1H%1H\M'%('rmw', 'mznv', 'xlnklmvmg', 'hgzgfh','krw','hgzig','fkgrnv','dzim','viili','ortsg','ivhgzig', 'xkf', 'ihh', 'erig' )
        ULI RMW, NHT RM VMFNVIZGV(NHT_ORHG):
            RU NHT == '':
                XLMGRMFV
            WZGZ_ORHG = [R.HGIRK() ULI R RM NHT.HKORG('@')]
            IVG += '[%6W] %-74H%84H%89H%0H%89H%89H%2H%2H%2H%0W%1.8U%1H%1H\M'%(RMW, WZGZ_ORHG[9], WZGZ_ORHG[8], WZGZ_ORHG[7], WZGZ_ORHG[6], WZGZ_ORHG[5], WZGZ_ORHG[4], WZGZ_ORHG[3], WZGZ_ORHG[2],WZGZ_ORHG[1],RMG(WZGZ_ORHG[0]),UOLZG(WZGZ_ORHG[89]),WZGZ_ORHG[88],WZGZ_ORHG[87] )
        IVGFIM IVG


WVU KZW_HGI(H, O):
    RU OVM(H) < O:
        IVGFIM ' '*(O-OVM(H))+H
    VOHV:
        IVGFIM H

WVU HSLD_JFVIB_WRXG(NHT):
    ZMBORMV = MVCG (RGVI (NHT.EZOFVH()))
    OZYVOH = []
    ULI P RM ZMBORMV.PVBH():
        OZYVOH.ZKKVMW([KZW_HGI(P, 84), 9])
    # OLLK GL TVG WZGZ EZOFVH DRWGS
    ULI P, WZGZ RM NHT.RGVNH():
        ULI O RM OZYVOH:
            HA = OVM(WZGZ[O[9].HGIRK()])
            RU HA > O[8]:
                O[8] = HA
    IVG = '%4H  %H\M'%('rmw', ' '.QLRM([ KZW_HGI(R[9].HGIRK(), R[8]+6).FKKVI() ULI R RM OZYVOH]))
    RMW = 8
    ULI P, WZGZ RM NHT.RGVNH():
        ORMV = ' '.QLRM([KZW_HGI(WZGZ[R[9].HGIRK()], R[8]+6) ULI R RM OZYVOH])
        IVG += '[%6W]  %H\M'%(RMW, ORMV)
        RMW += 8
    IVGFIM IVG


XOZHH OLXZOKILXVHHLI_ZORVMKILTIZN(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_ZORVMKILTIZN, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        IVH = HFKVI(OLXZOKILXVHHLI_ZORVMKILTIZN, HVOU).KILXVHH(XLNNZMW_GVCG)
        XLNNZMW_IVG = KRXPOV.OLZWH(IVH.WZGZ)
        JFVIB_GBKV = XLNNZMW_IVG['GBKV']
        RU JFVIB_GBKV =='JFVIB_WRXG':
            IVG = HSLD_JFVIB_WRXG(XLNNZMW_IVG['WZGZ'])
        # RU JFVIB_GBKV == 'LKVIZGRLM':
            # IVG = HSLD_LK_NVHHZTV(NHT_ORHG)
        # VORU JFVIB_GBKV == 'HLK':
            # IVG = HSLD_HLK_NVHHZTV(NHT_ORHG)
        # VORU JFVIB_GBKV == 'XLNKLMVMG' LI JFVIB_GBKV == 'XLNKLMVMG' :
            # IVG = HSLD_XLNKLMVMG_NVHHZTV(NHT_ORHG)
        # VORU JFVIB_GBKV == 'NLWFOV':
            # IVG = HSLD_NLWFOV_NVHHZTV(NHT_ORHG)
        IVH.NVHHZTV = IVG
        IVGFIM IVH
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_XLNNZMW.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_NLWFOV_NVHHZTV

XOZHH OLXZOKILXVHHLI_XLNNZMW(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_XLNNZMW, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        IFM_ORHG = XLNNZMW_GVCG.HKORG(' ')
        ZITFNVMGH_ORHG =IFM_ORHG[8:]
        RU OVM(ZITFNVMGH_ORHG) == 9 LI ZITFNVMGH_ORHG[9] == '':
            DSROV gIFV:
                XNW_ZITFNVMGH = HVOU.KILNKG_NZMZTVI.KILNKG ( '[xlnnzmw]-> HVMW GL NLWFOV LI LK?\M[8] lk\M[7] nLWFOV\M[6] vCRG\M kOVZHV RMKFG XSLRXV:')
                RU XNW_ZITFNVMGH == '8':
                    GZITVG = 'LKVIZGRLM'
                    YIVZP
                VORU XNW_ZITFNVMGH == '7':
                    GZITVG = 'NLWFOV'
                    YIVZP
                VORU XNW_ZITFNVMGH == '6':
                    IVGFIM mLMV
                VOHV:
                    KIRMG('NFHG RMKFG 8-6')
            KIRMG( '[xlnnzmw]-> BLF HSZOO RMKFG %H RW, ORHG ULOOLDH: '%GZITVG )
            MVD_XLNNZMW_GVCG = 'JFVIB %H'%GZITVG
            IVH = HFKVI(OLXZOKILXVHHLI_XLNNZMW, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
            NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
            RU GZITVG == 'LKVIZGRLM':
                IVG = HSLD_LK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[xlnnzmw lk]-> RMKFG LK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[xlnnzmw lk]-> ROOVTZO XSLRXV, KOVZHV RMKFG LK RW: ')
                KIRMG('[xlnnzmw lk]-> DROO HVMW XLNNZMW GL lk %H'%MZNV)
                XNW_ZITFNVMGH = HVOU.KILNKG_NZMZTVI.KILNKG('[xlnnzmw lk]-> RMKFG XLNNZMW (DRGS ZITFNVMGH): ')
            VOHV:
                IVG = HSLD_NLWFOV_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[xlnnzmw nlwfov]-> RMKFG NLWFOV RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[xlnnzmw nlwfov]-> ROOVTZO XSLRXV, KOVZHV RMKFG NLWFOV RW: ')
                KIRMG('[xlnnzmw nlwfov]-> DROO HVMW XLNNZMW GL NLWFOV %H'%MZNV)
                XNW_ZITFNVMGH = HVOU.KILNKG_NZMZTVI.KILNKG('[xlnnzmw nlwfov]-> RMKFG XLNNZMW (DRGS ZITFNVMGH): ')

            XLNNZMW_GVCG = 'XLNNZMW %H '%GZITVG + MZNV + ' ' + XNW_ZITFNVMGH
            XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
            IFM_ORHG = XLNNZMW_GVCG.HKORG(' ')
            ZITFNVMGH_ORHG = IFM_ORHG[8:]
        XLNNZMW.ZITFNVMGH = 'ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG).IVKOZXV('=','@')
        IVHKLMHV  = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_IVNLEV.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_XLNKLMVMG_NVHHZTV

XOZHH OLXZOKILXVHHLI_IVNLEV(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_IVNLEV, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        IVNLEV_ORHG = XLNNZMW_GVCG.HKORG(' ')
        ZITFNVMGH_ORHG = IVNLEV_ORHG[7:]
        RU OVM(IVNLEV_ORHG) == 8 LI IVNLEV_ORHG[8] == '':
            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[IVNLEV]-> IVNLEV GZITVG NFHG VRGSVI YV LK LI XLNKLMVMG: ')
            XLNNZMW.ZITFNVMGH = MZNV
        RU 'XLN' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[IVNLEV xlnklmvmg]-> BLF HSZOO RMKFG XLNKLMVMG RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB XLNKLMVMG'
                IVH = HFKVI(OLXZOKILXVHHLI_IVNLEV, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_XLNKLMVMG_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[IVNLEV xlnklmvmg]-> RMKFG XLNKLMVMG RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('@')[9]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[IVNLEV xlnklmvmg]-> ROOVTZO XSLRXV, KOVZHV RMKFG XLNKLMVMG RW: ')
                KIRMG('[IVNLEV xlnklmvmg]-> DROO IVNLEV XLNKLMVMG %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'XLN&ZITFNVMGH='+MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'XLN&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        VORU 'LK' RM XLNNZMW.ZITFNVMGH LI 'LKVIZGRLM' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[IVNLEV lk]-> BLF HSZOO RMKFG LK RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB LKVIZGRLM'
                IVH = HFKVI(OLXZOKILXVHHLI_IVNLEV, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_LK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[IVNLEV lk]-> RMKFG LK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[IVNLEV lk]-> ROOVTZO XSLRXV, KOVZHV RMKFG LK RW: ')
                KIRMG('[IVNLEV lk]-> DROO IVNLEV lk %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH=%H'%MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_IVHFNV.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_IVHFNV(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_IVHFNV, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        HGZIG_ORHG = XLNNZMW_GVCG.HKORG(' ')
        RU OVM(HGZIG_ORHG) > 8:
            KIRMG(HGZIG_ORHG[8])
            XLNNZMW.ZITFNVMGH = 'XLNKLMVMG=%H'%HGZIG_ORHG[8]
        #KIRMG(XLNNZMW)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_IVHGZIG.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_IVHGZIG(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_IVHGZIG, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        HGZIG_ORHG = XLNNZMW_GVCG.HKORG(' ')
        RU OVM(HGZIG_ORHG) >= 7:
            XLNNZMW.ZITFNVMGH = 'XLNKLMVMG=%H'%HGZIG_ORHG[8]
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_KZFHV.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_KZFHV(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_KZFHV, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        KZFHV_ORHG = XLNNZMW_GVCG.HKORG(' ')
        RU OVM(KZFHV_ORHG) > 8:
            KIRMG(KZFHV_ORHG[8])
            XLNNZMW.ZITFNVMGH = 'XLNKLMVMG=%H'%KZFHV_ORHG[8]
        #KIRMG(XLNNZMW)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_HGZIG.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_HGZIG(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_HGZIG, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        HGZIG_ORHG = XLNNZMW_GVCG.HKORG(' ')
        RU OVM(HGZIG_ORHG) >= 7:
            XLNNZMW.ZITFNVMGH = 'XLNKLMVMG=%H'%HGZIG_ORHG[8]
            RU OVM(HGZIG_ORHG) >= 6:
                XLNNZMW.ZITFNVMGH += '&%H'%HGZIG_ORHG[7]
        #KIRMG(XLNNZMW)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_WVUZFOG.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
RNKLIG KRXPOV

WVU KZW_HGI(H, O):
    RU OVM(H) < O:
        IVGFIM ' '*(O-OVM(H))+H
    VOHV:
        IVGFIM H

WVU HSLD_JFVIB_WRXG(NHT):
    ZMBORMV = MVCG (RGVI (NHT.EZOFVH()))
    OZYVOH = []
    ULI P RM ZMBORMV.PVBH():
        OZYVOH.ZKKVMW([KZW_HGI(P, 84), 9])
    # OLLK GL TVG WZGZ EZOFVH DRWGS
    ULI P, WZGZ RM NHT.RGVNH():
        ULI O RM OZYVOH:
            HA = OVM(WZGZ[O[9].HGIRK()])
            RU HA > O[8]:
                O[8] = HA
    IVG = '%4H  %H\M'%('rmw', ' '.QLRM([ KZW_HGI(R[9].HGIRK(), R[8]+6).FKKVI() ULI R RM OZYVOH]))
    RMW = 8
    ULI P, WZGZ RM NHT.RGVNH():
        ORMV = ' '.QLRM([KZW_HGI(WZGZ[R[9].HGIRK()], R[8]+6) ULI R RM OZYVOH])
        IVG += '[%6W]  %H\M'%(RMW, ORMV)
        RMW += 8
    IVGFIM IVG


XOZHH OLXZOKILXVHHLI_WVUZFOG(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_WVUZFOG, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        IVH = HFKVI(OLXZOKILXVHHLI_WVUZFOG, HVOU).KILXVHH(XLNNZMW_GVCG)
        # KIRMG(IVH)
        RU IVH.WZGZ != Y'':
            XLNNZMW_IVG = KRXPOV.OLZWH(IVH.WZGZ)
            JFVIB_GBKV = XLNNZMW_IVG['GBKV']
            RU JFVIB_GBKV =='JFVIB_WRXG':
                IVG = HSLD_JFVIB_WRXG(XLNNZMW_IVG['WZGZ'])
            IVH.NVHHZTV = IVG
            IVGFIM IVH
        VOHV:
            IVGFIM IVH
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_IVJFVHG.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
RNKLIG LH

XOZHH OLXZOKILXVHHLI_IVJFVHG(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_IVJFVHG, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        RU 'LK' MLG RM XLNNZMW_GVCG:
            XLNNZMW_GVCG = 'IVJFVHG LK'
        MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[ivjfvhg lk]-> RMKFG MVD LK MZNV: ')
        WRIVXGLIB = HVOU.KILNKG_NZMZTVI.KILNKG('[ivjfvhg lk]-> RMKFG MVD LK WRIVXGLIB: ')
        RU MLG LH.KZGS.RHWRI(WRIVXGLIB):
            KIRMG('viili: %H RH MLG OVTZO WRIVXGLIB'%WRIVXGLIB)
            IVGFIM mLMV
        UROVKZGS = LH.KZGS.QLRM(WRIVXGLIB, MZNV+'.KB')
        RU LH.KZGS.RHUROV(UROVKZGS):
            KIRMG('viili: %H ZOIVZWB VCRHG RM GSV KZGS'%UROVKZGS)
            IVGFIM mLMV
        IVH = HFKVI(OLXZOKILXVHHLI_IVJFVHG, HVOU).KILXVHH(XLNNZMW_GVCG)
        IVH.NVHHZTV = IVH.NVHHZTV.IVKOZXV('bbb', HVOU.FHVI)
        IVH.NVHHZTV = IVH.NVHHZTV.IVKOZXV('ccc', MZNV)
        DRGS LKVM(UROVKZGS, 'D') ZH U:
            U.DIRGV(IVH.NVHHZTV)
        IVH.NVHHZTV = 'VCZNKOV LK %H DIRGV GL %H'%(MZNV, UROVKZGS)
        IVGFIM IVH
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_VMGIFHG.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
RNKLIG LH
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN IVWHSRUG.IWSVOKVI.XORVMG RNKLIG rMHGZOOgZHPhGIFXG
RNKLIG KRXPOV
RNKLIG GRNV
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO

XOZHH OLXZOKILXVHHLI_VMGIFHG(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_VMGIFHG, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)


    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        XLN = ''
        RW = ''
        RH_KLHHVHH = uZOHV
        RH_VMGIFHG = uZOHV
        RH_KBGSLM = uZOHV
        LM_WZB = ''
        ZITH = ''
        KILTIZN = ''
        XLMURT = ''
        GRNVHKZMH=[]
        MVVW_KVIHRHG = uZOHV
        RMHGZOOGZHP = rMHGZOOgZHPhGIFXG()
        DSROV gIFV:
            KILNKG_HGI = '[vmgifhg]-> VMGIFHG XLNKLMVMG, ULOOLDRMT UVZGFIVH MVVW GL HKVXRUB\M' + \
                                                        '-> [8] XLNKLMVMG [%H]\M'%XLN+ \
                                                        '-> [7] RW [%H]\M'%RW + \
                                                        '-> [6] RH_KLHHVHH [%H]\M'%RH_KLHHVHH + \
                                                        '-> [5] RH_VMGIFHG [%H]\M'%RH_VMGIFHG + \
                                                        '-> [4] RH_KBGSLM  [%H]\M'%RH_KBGSLM + \
                                                        '-> [3] LM_WZB [%H]\M'%LM_WZB + \
                                                        '-> [2] ZITH [%H]\M'%','.QLRM(ZITH) + \
                                                        '-> [1] KILTIZN [%H]\M'%KILTIZN + \
                                                        '-> [0] XLMURT [%H]\M'%XLMURT + \
                                                        '-> [89] ZWW GRNV HKZM [%W]\M'%OVM(GRNVHKZMH)

            ULI GRNVHKZM RM GRNVHKZMH:
                KILNKG_HGI += '  G: '+GRNVHKZM + '\M'
            KILNKG_HGI += '-> [88] MVVW_KVIHRHG [%H]\M'%MVVW_KVIHRHG + \
                '-> GBKV RMHGZOO GL VMGIFHG GSRH XLNKLMVMG\M'

            KILNKG_HGI += '----------------------\MkOVZHV GBKV BLFI XLNNZMW: '
            XNW_ZITFNVMGH = HVOU.KILNKG_NZMZTVI.KILNKG (KILNKG_HGI )
            RU XNW_ZITFNVMGH == '8':
                XLN = HVOU.KILNKG_NZMZTVI.KILNKG ('RMKFG XLNKLMVMG MZNV  -> ')
            VORU XNW_ZITFNVMGH == '7':
                RW = HVOU.KILNKG_NZMZTVI.KILNKG ('RMKFG KILTIZN RW  -> ')
            VORU XNW_ZITFNVMGH == '6':
                ZIT = HVOU.KILNKG_NZMZTVI.KILNKG ('gIFV/uZOHV? B/M -> ')
                RU ZIT RM ['B', 'b', 'g', 'G']:
                    RH_KLHHVHH = gIFV
            VORU XNW_ZITFNVMGH == '5':
                ZIT = HVOU.KILNKG_NZMZTVI.KILNKG ('gIFV/uZOHV? B/M -> ')
                RU ZIT RM ['B', 'b', 'g', 'G']:
                    RH_VMGIFHG = gIFV
            VORU XNW_ZITFNVMGH == '4':
                ZIT = HVOU.KILNKG_NZMZTVI.KILNKG ('gIFV/uZOHV? B/M -> ')
                RU ZIT RM ['B', 'b', 'g', 'G']:
                    RH_KBGSLM = gIFV
            VORU XNW_ZITFNVMGH == '3':
                LM_WZB = HVOU.KILNKG_NZMZTVI.KILNKG ('RMKFG LM_WZB  -> ')
            VORU XNW_ZITFNVMGH == '2':
                ZITH = HVOU.KILNKG_NZMZTVI.KILNKG ('RMKFG ZITH  -> ')
            VORU XNW_ZITFNVMGH == '1':
                KILTIZN = HVOU.KILNKG_NZMZTVI.KILNKG ('RMKFG MVD KILTIZN  -> ')
            VORU XNW_ZITFNVMGH == '0':
                XLMURT = HVOU.KILNKG_NZMZTVI.KILNKG ('RMKFG MVD XLMURT  -> ')
            VORU XNW_ZITFNVMGH == '89':
                GN = HVOU.KILNKG_NZMZTVI.KILNKG ('RMKFG MVD GRNVHKZM  -> ')
                GRNVHKZMH.ZKKVMW(GN)
            VORU XNW_ZITFNVMGH == '88':
                ZIT = HVOU.KILNKG_NZMZTVI.KILNKG ('gIFV/uZOHV? B/M -> ')
                RU ZIT RM ['B', 'b', 'g', 'G']:
                    MVVW_KVIHRHG = gIFV
            VORU XNW_ZITFNVMGH == 'RMHGZOO':
                RU XLN == '':
                    KIRMG('viili: NFHG RMKFG XLNKLMVMG')
                    GRNV.HOVVK(8)
                    XLMGRMFV
                RU RW == '':
                    KIRMG('viili: NFHG RMKFG RW')
                    GRNV.HOVVK(8)
                    XLMGRMFV
                KILTIZN_KZGS = FYRJFGRO.IVKOZXV_EVIHRLM(KILTIZN, evihrlm).HGIRK()
                XLMURT_KZGS = FYRJFGRO.IVKOZXV_EVIHRLM(XLMURT, evihrlm).HGIRK()
                RU MLG LH.KZGS.VCRHGH(KILTIZN_KZGS):
                    KIRMG('viili: KILTIZN KZGS MLG VCRHGH')
                    GRNV.HOVVK(8)
                    XLMGRMFV
                RU MLG LH.KZGS.VCRHGH(XLMURT_KZGS):
                    KIRMG('viili: XLMURT KZGS MLG VCRHGH')
                    GRNV.HOVVK(8)
                    XLMGRMFV
                YIVZP
            VOHV:
                KIRMG('NFHG RMKFG 8-0 LI RMHGZOO')

        RMHGZOOGZHP.rMHGZOO().xLNKLMVMG(XLN).rW(RW).kILTIZN(KILTIZN).xLMURT(XLMURT)
        RMHGZOOGZHP.kBGSLM(RH_KBGSLM)
        RMHGZOOGZHP.kVIHRHG(MVVW_KVIHRHG)
        ULI GN RM GRNVHKZMH:
            RU OVM(GN.HKORG()) > 8:
                RMHGZOOGZHP.gRNVHKZM(GN.HKORG()[9], GN.HKORG()[8])
            VOHV:
                RMHGZOOGZHP.gRNVHKZM(GN)
        RU LM_WZB != '':
            RMHGZOOGZHP.lMwZB(LM_WZB)
        XLNNZMW_GVCG = 'VMGIFHG'
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG, WZGZ = KRXPOV.WFNKH(RMHGZOOGZHP))
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_IFM.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_IFM(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_IFM, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        IFM_ORHG = XLNNZMW_GVCG.HKORG(' ')
        ZITFNVMGH_ORHG = IFM_ORHG[7:]
        RU OVM(IFM_ORHG) == 8 LI IFM_ORHG[8] == '':
            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[ifm]-> IFM GZITVG NFHG VRGSVI YV LK LI HLK: ')
            XLNNZMW.ZITFNVMGH = MZNV
        RU 'HLK' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[ifm hlk]-> BLF HSZOO RMKFG HLK RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB HLK'
                IVH = HFKVI(OLXZOKILXVHHLI_IFM, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_HLK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[ifm hlk]-> RMKFG HLK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[ifm hlk]-> ROOVTZO XSLRXV, KOVZHV RMKFG HLK RW: ')
                KIRMG('[ifm hlk]-> DROO IFM hlk %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'HLK&ZITFNVMGH='+MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'HLK&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        VORU 'LK' RM XLNNZMW.ZITFNVMGH LI 'LKVIZGRLM' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[ifm lk]-> BLF HSZOO RMKFG LK RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB LKVIZGRLM'
                IVH = HFKVI(OLXZOKILXVHHLI_IFM, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_LK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[ifm lk]-> RMKFG LK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[ifm lk]-> ROOVTZO XSLRXV, KOVZHV RMKFG LK RW: ')
                KIRMG('[ifm lk]-> DROO IFM lk %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH=%H'%MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_FMOLZW.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_FMOLZW(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_FMOLZW, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        FMOLZW_ORHG = XLNNZMW_GVCG.HKORG(' ')
        ZITFNVMGH_ORHG = FMOLZW_ORHG[7:]
        RU OVM(FMOLZW_ORHG) == 8 LI FMOLZW_ORHG[8] == '':
            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[FMOLZW]-> FMOLZW GZITVG NFHG VRGSVI YV LK LI HLK: ')
            XLNNZMW.ZITFNVMGH = MZNV
        RU 'HLK' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[FMOLZW hlk]-> BLF HSZOO RMKFG HLK RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB HLK'
                IVH = HFKVI(OLXZOKILXVHHLI_FMOLZW, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_HLK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[FMOLZW hlk]-> RMKFG HLK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[FMOLZW hlk]-> ROOVTZO XSLRXV, KOVZHV RMKFG HLK RW: ')
                KIRMG('[FMOLZW hlk]-> DROO FMOLZW hlk %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'HLK&ZITFNVMGH='+MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'HLK&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        VORU 'LK' RM XLNNZMW.ZITFNVMGH LI 'LKVIZGRLM' RM XLNNZMW.ZITFNVMGH:
            RU OVM(ZITFNVMGH_ORHG) == 9  LI ZITFNVMGH_ORHG[9] == '':
                KIRMG( '[FMOLZW lk]-> BLF HSZOO RMKFG LK RW, ORHG ULOOLDH: ' )
                MVD_XLNNZMW_GVCG = 'JFVIB LKVIZGRLM'
                IVH = HFKVI(OLXZOKILXVHHLI_FMOLZW, HVOU).KILXVHH(MVD_XLNNZMW_GVCG)
                NHT_ORHG = IVH.NVHHZTV.HKORG('&')[8:]
                IVG = HSLD_LK_NVHHZTV(NHT_ORHG)
                KIRMG(IVG)
                MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[FMOLZW lk]-> RMKFG LK RW: ')
                DSROV gIFV:
                    RU MZNV.RHWRTRG():
                        RU RMG(MZNV) < OVM(NHT_ORHG):
                            MZNV = NHT_ORHG[RMG(MZNV)].HKORG('|')[9].HKORG('=')[8]
                            YIVZP
                        VOHV:
                            MZNV = HVOU.KILNKG_NZMZTVI.KILNKG('[FMOLZW lk]-> ROOVTZO XSLRXV, KOVZHV RMKFG LK RW: ')
                KIRMG('[FMOLZW lk]-> DROO FMOLZW lk %H'%MZNV)
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH=%H'%MZNV
            VOHV:
                XLNNZMW.ZITFNVMGH = 'LK&ZITFNVMGH='+'|'.QLRM(ZITFNVMGH_ORHG)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/OLXZOKILXVHHLI/OLXZOKILXVHHLI_HGLK.KB
UILN XLNNZMW RNKLIG YZHV_OLXZOKILXVHHLI
UILN XLNNZMW.OLXZOKILXVHHLI.OLXZOKILXVHHLI_JFVIB RNKLIG HSLD_LK_NVHHZTV, HSLD_HLK_NVHHZTV

XOZHH OLXZOKILXVHHLI_HGLK(YZHV_OLXZOKILXVHHLI.yZHVoLXZOkILXVHHLI):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HFKVI(OLXZOKILXVHHLI_HGLK, HVOU).__RMRG__(HGFY, FHVI, KILNKG_NZMZTVI)

    WVU KILXVHH(HVOU, XLNNZMW_GVCG):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG)
        HGLK_ORHG = XLNNZMW_GVCG.HKORG(' ')
        RU OVM(HGLK_ORHG) > 8:
            KIRMG(HGLK_ORHG[8])
            XLNNZMW.ZITFNVMGH = 'XLNKLMVMG=%H'%HGLK_ORHG[8]
        #KIRMG(XLNNZMW)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH_XLNNLM/XNW_DSLZIVBLF.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_DSLZIVBLF(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL DSLZIVBLF GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_DSLZIVBLF, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'DSLZIVBLF'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        # LFGKFG VCZNKOV LK
        HVOU.IVHKLMHV.NVHHZTV = TOLYZO_RMUL.HGZIUOVVG_GZT
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH_XLNNLM/XNW_SVOK.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW
RNKLIG KRXPOV

XOZHH XNW_SVOK(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL SVOK GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_SVOK, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'SVOK'

    WVU FHZTV(HVOU):
        IVGFIM 'SVOK RH GL HSLD SVOK RMULH'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        IVG = '----------------\MzEZROZYOV XLNNZMWH ULOOLD:\M-----------------\M'
        RU '' RM ZITFNVMGH:
            R = 9
            ULI PVB RM TOLYZO_RMUL.HGZIUOVVG_YIRWTV.XLNNZMW_KLLO.PVBH():
                IVG += '%79H'%PVB
                R += 8
                RU R == 4:
                    IVG += '\M'
                    R = 9
                VOHV:
                    IVG += ' '*1
            IVG += '\M----------------\MbLF NZB FHV SVOK [XNW] GL JFVIB WVGZROH'
        VOHV:
            ULI PVB RM ZITFNVMGH:
                RU PVB MLG RM ['FHVI','HFKKOVNVMG','OLMTORMV','XLNNZMW_WZGZ']:
                    RU PVB MLG RM TOLYZO_RMUL.HGZIUOVVG_YIRWTV.XLNNZMW_KLLO:
                        IVG = 'XZMMLG URMW XLNNZMW %H'%PVB
                    VOHV:
                        IVG = TOLYZO_RMUL.HGZIUOVVG_YIRWTV.XLNNZMW_KLLO[PVB].FHZTV()
        HVOU.IVHKLMHV.NVHHZTV = IVG
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/NZRM.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
"""
zFGLXLNKOVGRLM VCZNKOV GSZG HSLDH NVGZ-RMULINZGRLM ZOLMTHRWV GSV XLNKOVGRLMH.
"""
RNKLIG HRTMZO
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
RNKLIG TVGLKG
UILN KILNKG_GLLOPRG.XLMGIRY.XLNKOVGVIH RNKLIG dLIWxLNKOVGVI
UILN KILNKG_GLLOPRG RNKLIG KILNKG
UILN KILNKG_GLLOPRG.HGBOVH RNKLIG HGBOV_UILN_WRXG
UILN KILNKG_GLLOPRG.GLPVM RNKLIG gLPVM
UILN KILNKG_GLLOPRG.SRHGLIB RNKLIG rMnVNLIBsRHGLIB
UILN KILNKG_GLLOPRG.RMGVIUZXV RNKLIG zYLIGzXGRLM
UILN KILNKG_GLLOPRG.ZFGL_HFTTVHG RNKLIG zFGLhFTTVHGuILNsRHGLIB
UILN KILNKG_GLLOPRG.XLMGIRY.XLNKOVGVIH.UROVHBHGVN RNKLIG kZGSxLNKOVGVI
UILN KILNKG_GLLOPRG.XLNKOVGRLM RNKLIG xLNKOVGVI
UILN KBURTOVG RNKLIG uRTOVG
UILN RGVIGLLOH RNKLIG XSZRM
RNKLIG TVGKZHH
RNKLIG TIKX
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
#RNKLIG XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7
RNKLIG XLNNZMW.XLNNZMW_KY7_TIKX ZH XLNNZMW_KY7_TIKX
RNKLIG XLNKLMVMG.OLXZOKILXVHHLI ZH OLXZOKILXVHHLI
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN IVWHSRUG.IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG

GVHG_HGBOV = HGBOV_UILN_WRXG({
    gLPVM.gLLOYZI: '#UUUUUU YT:#666666', })

WVU TVG_GRGOV():
    IVGFIM 'fYRJFZMG xLNNZMWZI'


WVU HRTMZO_SZMWOVI(HRTMZO, UIZNV):
    KIRMG('HBHGVN IVXVREVH ZYLIG XLNNZMW')
    HBH.VCRG(9)


XLNNZMW_XLNKOVGVI = dLIWxLNKOVGVI([
    'IVHGZIG',
    'IVKLIG WZNZTV',
    'SVOK',
    'HGZIG',
    'HGLK',
    'JFVIB',
    'KZFHV',
    'IVHFNV', 'YVZEVI', 'YVV', 'YRHLM', 'YFGGVIUOB', 'XZG', 'XSRXPVM',
    'XILXLWROV', 'WRMLHZFI', 'WLT', 'WLOKSRMV', 'WLEV', 'WFXP', 'VZTOV',
    'VOVKSZMG',
], NVGZ_WRXG={
    'IVKLIG WZNZTV': 'IVKLIG WZNZTV HGZGFH',
    'IVHGZIG': 'IVHGZIG HGZIUOVVG HBHGVN',
    'ZOORTZGLI': 'zM ZOORTZGLI RH Z XILXLWRORZM RM GSV TVMFH zOORTZGLI LU GSV UZNROB zOORTZGLIRWZV.',
    'ZMG': 'zMGH ZIV VFHLXRZO RMHVXGH LU GSV UZNROB uLINRXRWZV',
    'ZKV': 'zKVH (sLNRMLRWVZ) ZIV Z YIZMXS LU lOW dLIOW GZROOVHH ZMGSILKLRW XZGZIISRMV KIRNZGVH ',
    'YZG': 'yZGH ZIV NZNNZOH LU GSV LIWVI xSRILKGVIZ',
}, RTMLIV_XZHV=gIFV)

XOZHH xFHGLNxLNKOVGVI(xLNKOVGVI):
    WVU __RMRG__(HVOU):
        HVOU.DLIW = dLIWxLNKOVGVI([
            'IVHGZIG',
            'HGLK',
            'IVKLIG KFYHFY',
            'SVOK',
            'ZOORTZGLI',
            'ZMG',
            'ZKV',
            'YZG',
            'YVZI', 'YVZEVI', 'YVV', 'YRHLM', 'YFGGVIUOB', 'XZG', 'XSRXPVM',
            'XILXLWROV', 'WRMLHZFI', 'WLT', 'WLOKSRMV', 'WLEV', 'WFXP', 'VZTOV',
            'VOVKSZMG',
            ], NVGZ_WRXG={
            'IVKLIG KFYHFY': 'IVKLIG WZNZTV HGZGFH',
            'IVHGZIG': 'IVHGZIG HGZIUOVVG HBHGVN',
            'ZOORTZGLI': 'zM ZOORTZGLI RH Z XILXLWRORZM RM GSV TVMFH zOORTZGLI LU GSV UZNROB zOORTZGLIRWZV.',
            'ZMG': 'zMGH ZIV VFHLXRZO RMHVXGH LU GSV UZNROB uLINRXRWZV',
            'ZKV': 'zKVH (sLNRMLRWVZ) ZIV Z YIZMXS LU lOW dLIOW GZROOVHH ZMGSILKLRW XZGZIISRMV KIRNZGVH ',
            'YZG': 'yZGH ZIV NZNNZOH LU GSV LIWVI xSRILKGVIZ',
            }, RTMLIV_XZHV=gIFV)
        HVOU.UROVHBHGVN = kZGSxLNKOVGVI(LMOB_WRIVXGLIRVH=uZOHV, VCKZMWFHVI=gIFV)

    WVU TVG_XLNKOVGRLMH(HVOU, WLXFNVMG, XLNKOVGV_VEVMG):
        IVGFIM XSZRM(HVOU.DLIW.TVG_XLNKOVGRLMH(WLXFNVMG, XLNKOVGV_VEVMG),
                     HVOU.UROVHBHGVN.TVG_XLNKOVGRLMH(WLXFNVMG, XLNKOVGV_VEVMG))


WVU NZRM(KLIG, KILTIZN, HVIEVI=mLMV):
    GL_OLXZO = uZOHV
    XOZHH kILNKGnZMZTVI(LYQVXG):
        WVU __RMRG__(HVOU):
            HVOU.SRHGLIB = rMnVNLIBsRHGLIB()
            HVOU.XFHGLN_XLNKOVGVI = xFHGLNxLNKOVGVI()

        WVU KILNKG(HVOU, SRMG='-> '):
            GVCG = KILNKG(SRMG,
                        XLNKOVGVI=HVOU.XFHGLN_XLNKOVGVI, SRHGLIB=HVOU.SRHGLIB,
                        ZFGL_HFTTVHG=zFGLhFTTVHGuILNsRHGLIB(),
                        TVG_YLGGLN_GLLOYZI_GLPVMH=TVG_YLGGLN_GLLOYZI_GLPVMH,
                        TVG_GRGOV=TVG_GRGOV,
                        HGBOV=GVHG_HGBOV,
                        VMZYOV_SRHGLIB_HVZIXS=gIFV,
                        WRHKOZB_XLNKOVGRLMH_RM_XLOFNMH=gIFV,
                        LM_ZYLIG=zYLIGzXGRLM.ivgib)
            IVGFIM GVCG

    KILNKG_NZMZTVI = kILNKGnZMZTVI()
    HRTMZO.HRTMZO(HRTMZO.hrtrmg, HRTMZO_SZMWOVI)
    FHVI = TVGKZHH.TVGFHVI()

    DSROV gIFV:
        RU HVIEVI RH mLMV:
            HVIEVI = FYRJFGRO.TVG_FYRJ_SLHG()
            GL_OLXZO = gIFV
        VOHV:
            GL_OLXZO = (HVIEVI == FYRJFGRO.TVG_FYRJ_SLHG())

        WVU TVG_YLGGLN_GLLOYZI_GLPVMH(XOR):
            IVGFIM [(gLPVM.gLLOYZI, ' XLNNZMW NLWV   uovvg:%H  hsrk:%H'%(HVIEVI, KILTIZN))]

        RU GL_OLXZO ZMW KILTIZN=='HGZIUOVVG':
            XSZMMVO = TIKX.RMHVXFIV_XSZMMVO('OLXZOSLHG:%H'%KLIG)
            HGFY = XLNNZMW_KY7_TIKX.tIVVGVIhGFY(XSZMMVO)
            IVWHSRUG = mLMV
        VOHV:
            HGFY = mLMV
            IVWHSRUG = iVWHSRUGxORVMG('872.9.9.8', '49939')
        KILXVHHLI_NZMZTVI = OLXZOKILXVHHLI.oLXZOkILXVHHLIyIRWTV(ILLG_KZGS, HGFY, IVWHSRUG, HVIEVI, KILTIZN, FHVI, KILNKG_NZMZTVI)
        U = uRTOVG(ULMG='HOZMG')
        # ZHP DSL GSV HVIEVI RH
        OK = KILXVHHLI_NZMZTVI.TVG_KILXVHHLI('DSLZIVBLF')
        IVHKLMHV = OK.KILXVHH('DSLZIVBLF')
        RU IVHKLMHV.HGZGFH!='':
            RU MLG IVHKLMHV.HGZGFH:
                KIRMG('xlnnfmrxzgrlm uzrovw')
                KIRMG('--------> XZMMLG XLMMVXGVW GL %H LM %H <--------'%(KILTIZN, HVIEVI))
                HBH.VCRG(-8)
        KIRMG('--------> XLMMVXGVW GL %H LM %H <--------'%(KILTIZN, HVIEVI))
        HVIEVI_MZNV = IVHKLMHV.NVHHZTV
        KIRMG(U.IVMWVIgVCG( 'FYRJFZMG '+HVIEVI_MZNV  ))
        KIRMG('dVOXLNV XLNNZMWVI %H, %H XLNNZMW RH ZG BLFI HVIERXV'%(TVGKZHH.TVGFHVI(), HVIEVI_MZNV))
        DSROV gIFV:
            GVCG = KILNKG_NZMZTVI.KILNKG()
            #KIRMG('BLFI XLNNZMW: %H' % GVCG)
            GIB:
                # RU KILTIZN=='HGZIUOVVG':
                OK = KILXVHHLI_NZMZTVI.TVG_KILXVHHLI(GVCG.HKORG(' ')[9])
                # VOHV:
                    # OK = KILXVHHLI_NZMZTVI.TVG_KILXVHHLI('ZORVMKILTIZN')
                RU GVCG RM ['V', 'J', 'JFRG', 'VCRG']:
                    HBH.VCRG(9)
                RU GVCG.HKORG()[9].HGIRK() RM ['TLGL', 'TL']:
                    HVIEVI = GVCG.HKORG()[8].HGIRK()
                    YIVZP
                IVHKLMHV = OK.KILXVHH(GVCG)
                RU IVHKLMHV RH MLG mLMV:
                    KIRMG('iVHKLMHV:\M%H' % IVHKLMHV.NVHHZTV)
            VCXVKG vCXVKGRLM ZH V:
                KIRMG(V)
                KIRMG('[viili] xLMMVXGRLM GL YIRWTV UZROVW, KOVZHV XLMGZXG HBHGVN ZWNRMRHGIZGLI')


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'K:G:', ['KLIG=', 'GZITVG='])
        KLIG = '49948'
        GZITVG = mLMV
        KILTIZN = 'HGZIUOVVG'
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-K', '--KILTIZN'):
                KILTIZN = ZIT
        RU GZITVG RH mLMV:
            NZRM(KLIG, KILTIZN)
        VOHV:
            NZRM(KLIG, KILTIZN, GZITVG)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMW.KILGL
HBMGZC = "KILGL6";

KZXPZTV hGZIUOVVGxLNNZMW;

// gSV TIVVGRMT HVIERXV WVURMRGRLM.
HVIERXV tIVVGVI {
  // hVMWH Z TIVVGRMT
  IKX hZBsVOOL (sVOOLiVJFVHG) IVGFIMH (sVOOLiVKOB) {}
  IKX rHHFVxLNNZMW (xLNNZMWiVJFVHG) IVGFIMH (xLNNZMWiVKOB) {}
}

// gSV IVJFVHG NVHHZTV XLMGZRMRMT GSV FHVI'H MZNV.
NVHHZTV sVOOLiVJFVHG {
  HGIRMT MZNV = 8;
}

// gSV IVHKLMHV NVHHZTV XLMGZRMRMT GSV TIVVGRMTH
NVHHZTV sVOOLiVKOB {
  HGIRMT NVHHZTV = 8;
}

// gSV IVJFVHG NVHHZTV XLMGZRMRMT GSV FHVI'H XLNNZMW.
NVHHZTV xLNNZMWiVJFVHG {
  HGIRMT FHVI = 8;
  HGIRMT GLPVM = 7;
  HGIRMT XLNNZMW = 6;
  HGIRMT HFY_XLNNZMW = 5;
  HGIRMT ZITFNVMGH = 4;
  HGIRMT OLMTORMV = 3;
  HGIRMT HFKKOVNVMG = 2;
  YBGVH WZGZ = 1;
}

// gSV IVHKLMHV NVHHZTV XLMGZRMRMT GSV TIVVGRMTH
NVHHZTV xLNNZMWiVKOB {
  HGIRMT HGZGFH  = 8;
  HGIRMT NVHHZTV = 7;
  HGIRMT OLMT_NVHHZTV = 6;
  HGIRMT EVIB_OLMT_NVHHZTV = 5;
  YBGVH WZGZ = 4;
  HGIRMT HFKKOVNVMG = 3;
}

//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_OLZW.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_OLZW(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL OLZW GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_OLZW, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'OLZW'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LKVIZGRLM' RM ZITFNVMGH LI 'LK' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
            LK_MZNV = ZIT_ORHG[9]
            LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG['NZHGVI']
            RU LK_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NZK:
                HVOU.IVHKLMHV.NVHHZTV = '[viili] LK %H RH MLG IVXLTMRAVW'%LK_MZNV
                IVGFIM HVOU.IVHKLMHV
            FHVI = ZITFNVMGH['FHVI']
            FHVI = 'NZHGVI'
            RU FHVI MLG RM TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG:
                HVOU.IVHKLMHV.NVHHZTV = ''
            VOHV:
                LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG[FHVI]
                LK_SLFHV.ZXGREZGV_LK(LK_MZNV)
                HVOU.IVHKLMHV.NVHHZTV = '[zxgrlm] LK %H OLZWVW'%LK_MZNV
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_HSLD.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_HSLD(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL HSLD GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_HSLD, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'HSLD'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LKVIZGRLM' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            FHVI = ZITFNVMGH['FHVI']
            FHVI = 'NZHGVI'
            RU FHVI MLG RM TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG:
                HVOU.IVHKLMHV.NVHHZTV = ''
            VOHV:
                LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG[FHVI]
                HVOU.IVHKLMHV.NVHHZTV = '&'.QLRM([LK.RW ULI LK RM LK_SLFHV.LKVIZGRLMH])
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_IFM.KB
RNKLIG HBH
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG SVOKVI.FGRO ZH FGRO
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_IFM(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL IFM GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_IFM, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'IFM'
        HVOU.IVXLIWVI = FGRO.hgwlfgiVXLIWVI()

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LKVIZGRLM' RM ZITFNVMGH LI 'LK' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
            LK_MZNV = ZIT_ORHG[9]
            LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG['NZHGVI']
            RU LK_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NZK:
                HVOU.IVHKLMHV.NVHHZTV = '[viili] LK %H RH MLG IVXLTMRAVW'%LK_MZNV
                IVGFIM HVOU.IVHKLMHV
            LK = LK_SLFHV.LKVIZGRLM_NZK[LK_MZNV]
            HVOU.IVXLIWVI.HGZIG()
            LK.DLIP()
            HVOU.IVHKLMHV.NVHHZTV = 'IFM LK %H\M'%LK_MZNV
            HVOU.IVHKLMHV.NVHHZTV += HVOU.IVXLIWVI.HGLK()
            IVGFIM HVOU.IVHKLMHV
        VORU 'HLK' RM ZITFNVMGH:
            ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
            HLK_SLFHV = TOLYZO_RMUL.HLK_NZMZTVI
            HLK_MZNV = ZIT_ORHG[9]
            RU HLK_MZNV MLG RM HLK_SLFHV.HLK_KLLO:
                HVOU.IVHKLMHV.NVHHZTV = '[viili] HLK %H RH MLG IVXLTMRAVW'%HLK_MZNV
                IVGFIM HVOU.IVHKLMHV
            HLK = HLK_SLFHV.HLK_KLLO[HLK_MZNV]
            HVOU.IVXLIWVI.HGZIG()
            HLK.DLIP(ZIT_ORHG[8:], TOLYZO_RMUL)
            HVOU.IVHKLMHV.NVHHZTV = 'IFM HLK %H\M'%HLK_MZNV
            HVOU.IVHKLMHV.NVHHZTV += HVOU.IVXLIWVI.HGLK()
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_XLNNZMW.KB
RNKLIG HBH
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG SVOKVI.FGRO ZH FGRO
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_XLNNZMW(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL HVMW XLNNZMW GL LKVIZGRLMH"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_XLNNZMW, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'XLNNZMW'
        HVOU.IVXLIWVI = FGRO.hgwlfgiVXLIWVI()

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
            # LFGKFG VCZNKOV LK
        # KIRMG(ZITFNVMGH)
        ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
        GZITVG = ZIT_ORHG[9]
        RU GZITVG == 'LK':
            LK_MZNV = ZIT_ORHG[8]
            LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG['NZHGVI']
            RU LK_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NZK:
                HVOU.IVHKLMHV.NVHHZTV = '[viili] XLNNZMW GZITVG LK %H RH MLG IVXLTMRAVW'%LK_MZNV
                IVGFIM HVOU.IVHKLMHV
            LK = LK_SLFHV.LKVIZGRLM_NZK[LK_MZNV]
            ZITFNVMGH = {}
            ULI ZIT RM ZIT_ORHG[6:]:
                ZIT_VOV = ZIT.IVKOZXV('@', '=').HKORG('=')
                RU OVM(ZIT_VOV) > 8:
                    ZITFNVMGH[ZIT_VOV[9]] = ZIT_VOV[8]
                VOHV:
                    ZITFNVMGH[ZIT_VOV[9]] = ''
            # HVOU.IVXLIWVI.HGZIG()
            LK.GZPV_XLNNZMW(ZIT_ORHG[7], ZITFNVMGH)
            # HVOU.IVHKLMHV.NVHHZTV = HVOU.IVXLIWVI.HGLK()
        VORU  GZITVG == 'NLWFOV':
            NLWFOV_MZNV = ZIT_ORHG[8]
            NLWFOV_SLFHV = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK
            RU NLWFOV_MZNV MLG RM NLWFOV_SLFHV:
                HVOU.IVHKLMHV.NVHHZTV = '[viili] XLNNZMW GZITVG NLWFOV %H RH MLG IVXLTMRAVW'%NLWFOV_MZNV
                IVGFIM HVOU.IVHKLMHV
            ZITFNVMGH = {}
            NLWFOV =  NLWFOV_SLFHV[NLWFOV_MZNV]
            ULI ZIT RM ZIT_ORHG[6:]:
                ZIT_VOV = ZIT.IVKOZXV('@', '=').HKORG('=')
                RU OVM(ZIT_VOV) > 8:
                    ZITFNVMGH[ZIT_VOV[9]] = ZIT_VOV[8]
                VOHV:
                    ZITFNVMGH[ZIT_VOV[9]] = ''
            HVOU.IVHKLMHV.NVHHZTV = NLWFOV.GZPV_XLNNZMW(ZIT_ORHG[7], ZITFNVMGH)
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_WZGZUOLD.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_WZGZUOLD(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL OLZW GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_WZGZUOLD, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'WZGZUOLD'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        KIRMG(ZITFNVMGH)
        # RU 'LKVIZGRLM' RM ZITFNVMGH LI 'LK' RM ZITFNVMGH:
        #     # LFGKFG VCZNKOV LK
        #     ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
        #     LK_MZNV = ZIT_ORHG[9]
        #     LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG['NZHGVI']
        #     RU LK_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NZK:
        #         HVOU.IVHKLMHV.NVHHZTV = '[viili] LK %H RH MLG IVXLTMRAVW'%LK_MZNV
        #         IVGFIM HVOU.IVHKLMHV
        #     FHVI = ZITFNVMGH['FHVI']
        #     FHVI = 'NZHGVI'
        #     RU FHVI MLG RM TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG:
        #         HVOU.IVHKLMHV.NVHHZTV = ''
        #     VOHV:
        #         LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG[FHVI]
        #         LK_SLFHV.ZXGREZGV_LK(LK_MZNV)
        #         HVOU.IVHKLMHV.NVHHZTV = '[zxgrlm] LK %H OLZWVW'%LK_MZNV
        #     IVGFIM HVOU.IVHKLMHV
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_VMGIFHG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW
RNKLIG KRXPOV

XOZHH XNW_VMGIFHG(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL VMGIFHG GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_VMGIFHG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'VMGIFHG'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        XLNNZMW_WZGZ = ZITFNVMGH['XLNNZMW_WZGZ']
        WZGZ = KRXPOV.OLZWH(XLNNZMW_WZGZ)
        CNO = WZGZ.VCKLIG_GL_CNO()
        NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
        # RU WZGZ.RH_ZOKSZNZM ZMW 'ZOKSZNZMXORVMG' RM HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
            # ZX = HVOU.TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['ZOKSZNZMXORVMG']
            # ZX.QLY_CNOH.ZKKVMW(CNO)
        RU WZGZ.MVVW_KVIHRHG:
            TOLYZO_RMUL.CNOUROV_NLWRUB = 8
        RU '_LMVGRNV_' RM CNO.ZGGIRY ZMW CNO.ZGGIRY['_LMVGRNV_'].OLDVI()=='GIFV':
            HGZGFH = NLMRGLI.ZWW_XLNKLMVMG_LMXV(CNO)
        VOHV:
            HGZGFH = NLMRGLI.ZWW_XLNKLMVMG(CNO, WZGZ.RH_ULIXV)
        HVOU.IVHKLMHV.NVHHZTV = HGZGFH[8]
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_FMOLZW.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_FMOLZW(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL FMOLZW GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_FMOLZW, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'FMOLZW'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LKVIZGRLM' RM ZITFNVMGH LI 'LK' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
            LK_MZNV = ZIT_ORHG[9]
            LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG['NZHGVI']
            RU LK_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NZK:
                HVOU.IVHKLMHV.NVHHZTV = '[viili] LK %H RH MLG IVXLTMRAVW'%LK_MZNV
                IVGFIM HVOU.IVHKLMHV
            FHVI = ZITFNVMGH['FHVI']
            FHVI = 'NZHGVI'
            RU FHVI MLG RM TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG:
                HVOU.IVHKLMHV.NVHHZTV = ''
            VOHV:
                LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG[FHVI]
                LK_SLFHV.WVZXGREZGV_LK(LK_MZNV)
                HVOU.IVHKLMHV.NVHHZTV = '[zxgrlm] LK %H FMOLZWVW'%LK_MZNV
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_XSVXP.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_XSVXP(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL XSVXP GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_XSVXP, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'XSVXP'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LKVIZGRLM' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            NLWFOV_MZNV = ZITFNVMGH['NLWFOV']
            FHVI = ZITFNVMGH['FHVI']
            RU FHVI MLG RM TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG:
                HVOU.IVHKLMHV.NVHHZTV = ''
            VOHV:
                LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG[FHVI]
                RU NLWFOV_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NLWFOV_NZK:
                    HVOU.IVHKLMHV.NVHHZTV = ''
                VOHV:
                    HVOU.IVHKLMHV.NVHHZTV = '&'.QLRM(LK_SLFHV.LKVIZGRLM_NLWFOV_NZK[NLWFOV_MZNV])
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_IVNLEV.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_IVNLEV(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL IVNLEV HXSVWFOV DLIPH ULI GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_IVNLEV, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'IVNLEV'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LKVIZGRLM' RM ZITFNVMGH LI 'LK' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
            LK_MZNV = ZIT_ORHG[9]
            FHVI = 'NZHGVI'
            LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG['NZHGVI']
            RU LK_MZNV MLG RM LK_SLFHV.LKVIZGRLM_NZK:
                HVOU.IVHKLMHV.NVHHZTV = '[viili] LK %H RH MLG IVXLTMRAVW'%LK_MZNV
                IVGFIM HVOU.IVHKLMHV
            FHVI = ZITFNVMGH['FHVI']
            FHVI = 'NZHGVI'
            RU FHVI MLG RM TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG:
                HVOU.IVHKLMHV.NVHHZTV = ''
            VOHV:
                LK_SLFHV = TOLYZO_RMUL.NZMZTVNVMG.LK_EZFOG[FHVI]
                LK_SLFHV.WVZXGREZGV_LK(LK_MZNV)
                HVOU.IVHKLMHV.NVHHZTV = '[zxgrlm] LK %H IVNLEVW'%LK_MZNV
            IVGFIM HVOU.IVHKLMHV
        VORU 'XLNKLMVMG' RM ZITFNVMGH LI 'XLN' RM ZITFNVMGH:
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                ZIT_ORHG = ZITFNVMGH['ZITFNVMGH'].HKORG('|')
                XLN_MZNV = ZIT_ORHG[9]
                HGZGFH = NLMRGLI.IVNLEV_XLNKLMVMG(XLN_MZNV)
                RU HGZGFH[9] == 9:
                    HVOU.IVHKLMHV.NVHHZTV = 'XLNKLMVMG IVNLEVW'
                VOHV:
                    HVOU.IVHKLMHV.NVHHZTV = 'uzrovw: %H' % HGZGFH[8]
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'NLMRGLIHBHGVN MLG IVZWB'
            IVGFIM HVOU.IVHKLMHV
                # HVOU.IVHKLMHV.NVHHZTV = 'IVNLEVGBKV=XLNKLMVMG'
                # HVOU.IVHKLMHV.NVHHZTV += '&'+'&'.QLRM(NLMRGLI.XLNKROV_XLNKLMVMG_HGZGFH())
            # VOHV:
                # HVOU.IVHKLMHV.NVHHZTV = 'IVNLEVGBKV=XLNKLMVMG'+'&mLxLNKLMVMGH'
            # IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_JFVIBYILZWXZHG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW
RNKLIG KRXPOV

XOZHH XNW_JFVIBYILZWXZHG(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL JFVIBYILZWXZHG GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_JFVIBYILZWXZHG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'JFVIBYILZWXZHG'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        IVG = {}
        WZGZ = {}
        IVG['GBKV']='JFVIB_WRXG'
        ULI P, EZOFV RM TOLYZO_RMUL.YILZWXZHG_WZGZ_ORHG.RGVNH():
            WZGZ[P] = {'GRGOV':EZOFV['YILZWXZHG_GRGOV'], 'NVHHZTV':EZOFV['YILZWXZHG_NVHHZTV']}
        IVG['WZGZ']=WZGZ
        HVOU.IVHKLMHV.WZGZ = KRXPOV.WFNKH(IVG)
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_HFYNRG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW
RNKLIG RNK
RNKLIG HBH
UILN RL RNKLIG gVCGrldIZKKVI, yBGVHrl
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

XOZHH XNW_HFYNRG(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL HFYNRG GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_HFYNRG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'HFYNRG'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LK' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            MVD_LK_NLWFOV = RNK.MVD_NLWFOV('MVD_LK')
            VCVX(ZITFNVMGH['OLMTORMV'], MVD_LK_NLWFOV.__WRXG__)
            CNO_HGIRMT = ZITFNVMGH['HFKKOVNVMG']
            CNO = VGIVV.UILNHGIRMT(CNO_HGIRMT)
            XOZHHLK = TVGZGGI(MVD_LK_NLWFOV, ZITFNVMGH['NLWFOV'])
            MVD_LK = XOZHHLK(CNO, TOLYZO_RMUL)
            LOW_HGWLFG = HBH.HGWLFG
            HBH.HGWLFG = gVCGrldIZKKVI(yBGVHrl(), HBH.HGWLFG.VMXLWRMT)
            GIB:
                MVD_LK.DLIP()
                HVOU.IVHKLMHV.HGZGFH = 'GIFV'
            VCXVKG vCXVKGRLM ZH V:
                KIRMG(V)
                HVOU.IVHKLMHV.HGZGFH = 'UZOHV'
            HBH.HGWLFG.HVVP(9)
            LFG = HBH.HGWLFG.IVZW()
            HBH.HGWLFG.XOLHV()
            HBH.HGWLFG = LOW_HGWLFG
            HVOU.IVHKLMHV.NVHHZTV = LFG
            FHVI = ZITFNVMGH['FHVI']
            FHVI = 'NZHGVI'
            TOLYZO_RMUL.NZMZTVNVMG.LMORMV_OLZW_LK(FHVI, MVD_LK, CNO, XOZHHLK, ZITFNVMGH['NLWFOV'] )
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_HZEV.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW


XOZHH XNW_HZEV(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL HZEV GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_HZEV, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'HZEV'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        # KIRMG(ZITFNVMGH)
            # LFGKFG VCZNKOV LK
        TOLYZO_RMUL.CNOUROV_NLWRUB = 8
        HVOU.IVHKLMHV.NVHHZTV = 'CNO FKWZGVW'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_PROO.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW

XOZHH XNW_PROO(YZHV_XLNNZMW.yZHVxLNNZMW):
    '''GSRH XLNNZMW RH GL PROO GSV HGZIUOVVG HBHGVN'''
    WVU __RMRG__(HVOU):
        HFKVI(XNW_PROO, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'PROO'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'XLNKLMVMG' RM ZITFNVMGH:
            GZITVG = ZITFNVMGH['XLNKLMVMG'].HGIRK()
            RU 'NLMRGLIHBHGVN' RM TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK:
                NLMRGLI = TOLYZO_RMUL.NLWFOV_NZMZTVI.NLWFOV_MZNV_NZK['NLMRGLIHBHGVN']
                IVG = NLMRGLI.NZMFZO_PROO_XLNKLMVMG(GZITVG)
                HVOU.IVHKLMHV.NVHHZTV = IVG
            VOHV:
                HVOU.IVHKLMHV.NVHHZTV = 'ML NLWFOV ZH nLMRGLIhBHGVN'
        VOHV:
            RU TOLYZO_RMUL.YLLGHGIZK.HGZIUOVVG_NZHGVI:
                TOLYZO_RMUL.OLTTVI.RMUL('[XNW-PROO] YLLGHGIZK PROOKRMT...')
                TOLYZO_RMUL.YLLGHGIZK.PROO()
            VOHV:
                TOLYZO_RMUL.OLTTVI.RMUL('[XNW-PROO] YLLGHGIZK MVVWH ML ZWWRGRLMZO ZGGVMGRLM')
            TOLYZO_RMUL.PROO = gIFV
            HVOU.IVHKLMHV.NVHHZTV = 'XLNNZMW PROO VCVXFGVW, HGZIUOVVG RH PROORMT RGHVOU'
        IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/XLNNZMWH/XNW_IVJFVHG.KB
UILN XLNNZMW RNKLIG YZHV_XLNNZMW
UILN KZGSORY RNKLIG kZGS
RNKLIG LH

XOZHH XNW_IVJFVHG(YZHV_XLNNZMW.yZHVxLNNZMW):
    """GSRH XLNNZMW RH GL IVJFVHG GSV HGZIUOVVG HBHGVN"""
    WVU __RMRG__(HVOU):
        HFKVI(XNW_IVJFVHG, HVOU).__RMRG__()
        HVOU.XLNNZMW = 'IVJFVHG'

    WVU KILXVHH(HVOU, ZITFNVMGH, TOLYZO_RMUL):
        RU 'LK' RM ZITFNVMGH:
            # LFGKFG VCZNKOV LK
            ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
            UROV_KZGS = LH.KZGS.QLRM(ILLG_KZGS, 'VCZNKOV', 'VCZNKOV_LK.KB')
            DRGS LKVM(UROV_KZGS, 'I') ZH LKUROV:
                ORMV = LKUROV.IVZW()
                HVOU.IVHKLMHV.NVHHZTV = ORMV
                IVGFIM HVOU.IVHKLMHV
            HVOU.IVHKLMHV.NVHHZTV = ''
            IVGFIM HVOU.IVHKLMHV
//##**---------------- ./HGZIUOVVG/XLNNZMW/YZHV_OLXZOKILXVHHLI.KB
#RNKLIG TIKX
RNKLIG XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7
#RNKLIG XLNNZMW.XLNNZMW_KY7_TIKX ZH XLNNZMW_KY7_TIKX

WVU KZIHV_XLNNZMW_GVCG(XLNNZMW_GVCG):
    XNW_ORHG = XLNNZMW_GVCG.HGIRK(' ').HKORG(' ')
    XNW = XNW_ORHG[9] #NZQLI XLNNZMW
    VOV_IVG = ''
    ULI VOV RM XNW_ORHG[8:]: # ZITFNVMGH
        YLOR_VOV = VOV.HKORG('=')
        RU OVM(YLOR_VOV) == 8:
            #RU XNW_ORHG[8] == VOV:
            #    VOV_IVG += '&ZITFNVMG='+VOV
            #VOHV:
                YLOR_VOV = YLOR_VOV[9]+'='
                VOV_IVG += '&' + YLOR_VOV
        VOHV:
            VOV_IVG += '&' + VOV
    IVGFIM XLNNZMW_KY7.xLNNZMWiVJFVHG(XLNNZMW=XNW, ZITFNVMGH=VOV_IVG[8:])


XOZHH yZHVoLXZOkILXVHHLI(LYQVXG):
    WVU __RMRG__(HVOU, HGFY, FHVI, KILNKG_NZMZTVI):
        HVOU.MZNV = ''
        HVOU.HGFY = HGFY
        HVOU.FHVI = FHVI
        HVOU.KILNKG_NZMZTVI = KILNKG_NZMZTVI
        HVOU._KILTIZN = 'HGZIUOVVG'

    WVU GZITVG(HVOU, IVWHSRUG, GZITVG):
        HVOU.GZITVG = GZITVG
        HVOU.IVWHSRUG = IVWHSRUG

    WVU KILTIZN(HVOU, KILTIZN):
        HVOU._KILTIZN = KILTIZN

    WVU IZD_KILXVHH(HVOU, XLNNZMW_GVCG, WZGZ=mLMV):
        XLNNZMW = KZIHV_XLNNZMW_GVCG(XLNNZMW_GVCG)
        XLNNZMW.FHVI = HVOU.FHVI
        RU WZGZ RH MLG mLMV:
            XLNNZMW.WZGZ = WZGZ
        IVGFIM XLNNZMW

    WVU HVMW_XLNNZMW(HVOU, XLNNZMW):
        RU HVOU.HGFY RH MLG mLMV:
            IVGFIM HVOU.HGFY.rHHFVxLNNZMW(XLNNZMW)
        VOHV:
            NHT = HVOU.IVWHSRUG.XLNNZMW_GL_HGZIUOVVG(HVOU.GZITVG)
            NHT.XLNNZMW = 'RHHFV_XLNNZMW&'+HVOU._KILTIZN
            NHT.WZGZ = XLNNZMW.hVIRZORAVgLhGIRMT()
            IVKOB = HVOU.IVWHSRUG.HVMW(NHT)
            IVGFIM IVKOB


    WVU KILXVHH(HVOU, XLNNZMW_GVCG, WZGZ=mLMV):
        XLNNZMW = HVOU.IZD_KILXVHH(XLNNZMW_GVCG, WZGZ)
        IVHKLMHV = HVOU.HVMW_XLNNZMW(XLNNZMW)
        IVGFIM IVHKLMHV
//##**---------------- ./HGZIUOVVG/IVZWNV.NW
ivzwnv
=================================

# HGZIUOVVG(8)

  `HGZIUOVVG(8)` RH Z XLOOVXGRLM LU YZHRX NZGS UFMXGRLMH ZMW ZIGRXOVH ZMW WRHXFHHRLMH, WVHRTMVW GL SVOK JFZMGH ZELRW
  NLHG XLNNLM NRHGZPVH.


## fHZTV

    fHZTV: HGZIUOVVG

    qFHG RMXOFWV FYRJ_NZGS.S RM BLFI KILQVXG ZMW ORMP ZTZRMHG ORYHGZIUOVVG.Z ZMW GSVM ZOO RH HVG.

## rMHGZOOZGRLM

  rMHGZOO `HGZIUOVVG(8)` ZMW RGH ZHHLXRZGVW ORYH ZMW SVZWVI UROVH GL /LKG.

    $ NZPV RMHGZOO


## zYLFG


## xLMURTFIZGRLM

  KZPXZTV MVVWH HLNV VCGIZ XLMURTFIZGRLM


## 6IW KZIGB XLWV/KILQVXGH ORHG ZMW NLWRURXZGRLMH:
=================================


//##**---------------- ./HGZIUOVVG/GLLO/JFVIBXLNWVGZRO.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
RNKLIG KBKFYHFY ZH KY
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG JFVIB_WVGZRO,HVMW_XLNNZMW,JFVIB_QLY




RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        GZITVG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        KIRMG('JFVIB XLNKLMVMGH VMGIFHGVW RM %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        LKORHG = JFVIB_WVGZRO(IVWHSRUG, GZITVG)
        ULI R RM LKORHG:
            KIRMG(R)
        XNW = KY.xLNNZMW()
        XNW.KILXVHH = 6
        IVKOB = HVMW_XLNNZMW(IVWHSRUG, GZITVG)
        GZT  = IVKOB.NVHHZTV
        KIRMG('QLY GRXPVG ', GZT)

        IVG = JFVIB_QLY(IVWHSRUG, GZITVG, GZT)
        ULI R RM IVG:
            KIRMG('------')
            KIRMG('QLY   : %H'%R.RW)
            KIRMG('OZYVO : %H'%R.IZMWLN_RW)
            KIRMG('HGZIG : %H'%R.HGZIG_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
            KIRMG('VMW   : %H'%R.VMW_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
            KIRMG('KILTIVHH: ', [KRXPOV.OLZWH(W) ULI W RM R.WZGZ])
            KIRMG('HGZGFH: %H'%R.HGZGFH)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/PROODLIP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOQLY.KB -U LKVIZGRLM/wFNNBlK.KB -X 'Z=Y,X=W' -G WVE8
##################
RNKLIG GRNV
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG PROO_DLIP
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH
RNKLIG WROO
RNKLIG WZGVGRNV
RNKLIG GIZXVYZXP

WVU UFMX(KZIZ, TOLYZORMUL, NVHHZTV_ORHG):
    RNKLIG WZGVGRNV, GRNV
    GZITVG = KZIZ['GZITVG']
    IVWHSRUG = TOLYZORMUL.IVWHSRUG
    NHT = IVWHSRUG.MVD_NHT()
    NHT.WHG = GZITVG
    NHT.NZTRX = 'KRMT'
    DSROV gIFV:
        NVHHZTV_ORHG.XOVZI()
        YVULIV = WZGVGRNV.WZGVGRNV.MLD()
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            ZUGVI = WZGVGRNV.WZGVGRNV.MLD()
            KIRMG('GZPV GRNV:', ZUGVI-YVULIV)
            NVHHZTV_ORHG.ZKKVMW(gIFV)
            NVHHZTV_ORHG.ZKKVMW(ZUGVI.HGIUGRNV('%b%N%W-%s:%n:%h'))
            NVHHZTV_ORHG.ZKKVMW( (ZUGVI-YVULIV).GLGZO_HVXLMWH() )
        VOHV:
            NVHHZTV_ORHG.ZKKVMW(uZOHV)
        GRNV.HOVVK(7)
    IVGFIM ('gIFV',mLMV)

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        XLMURTORHG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-U', '--UROV'):
                UROV = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURTORHG = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)

        HGZGFH = mLMV
        DSROV HGZGFH MLG RM ['HFXXVHH', 'UZROVW']:
            LKORHG = PROO_DLIP(IVWHSRUG, GZITVG)
            ULI R RM LKORHG:
                KIRMG('------')
                KIRMG(R)
                #KIRMG('QLY   : %H'%R.RW)
                #KIRMG('OZYVO : %H'%R.IZMWLN_RW)
                #RU R.HGZIG_GRNV RH MLG mLMV:
                #    KIRMG('HGZIG : %H'%R.HGZIG_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                #RU R.VMW_GRNV RH MLG mLMV:
                #    KIRMG('VMW   : %H'%R.VMW_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                #KIRMG('KILTIVHH: ', [KRXPOV.OLZWH(W) ULI W RM R.WZGZ])
                #KIRMG('HGZGFH: %H'%R.HGZGFH)
                #KIRMG('WZGZ: %H'%R.WZGZ)
                #RU R.HGZGFH == 'UZROVW':
                #    KIRMG('VIILI:', R.VIILI)
                #HGZGFH = R.HGZGFH
            GRNV.HOVVK(8)

    VCXVKG vCXVKGRLM ZH V:
        GIZXVYZXP.KIRMG_VCX()
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/IVNLEVDLIP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOQLY.KB -U LKVIZGRLM/wFNNBlK.KB -X 'Z=Y,X=W' -G WVE8
##################
RNKLIG GRNV
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG IVNLEV_DLIP
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH
RNKLIG WROO
RNKLIG WZGVGRNV
RNKLIG GIZXVYZXP


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:P:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'GRXPVG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        GRXPVG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-P', '--GRXPVG'):
                GRXPVG= ZIT

        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)

        HGZGFH = mLMV
        DSROV HGZGFH MLG RM ['HFXXVHH', 'UZROVW']:
            IVNLEV_DLIP(IVWHSRUG, GZITVG, GRXPVG)
            KIRMG(IVKOB)
            GRNV.HOVVK(8)

    VCXVKG vCXVKGRLM ZH V:
        GIZXVYZXP.KIRMG_VCX()
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/GVHGXLNNZMW.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
"""
zFGLXLNKOVGRLM VCZNKOV GSZG HSLDH NVGZ-RMULINZGRLM ZOLMTHRWV GSV XLNKOVGRLMH.
"""
# RNKLIG HRTMZO
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
RNKLIG TVGLKG
# UILN RGVIGLLOH RNKLIG XSZRM
# RNKLIG TVGKZHH
# RNKLIG TIKX
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
#RNKLIG XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7
# RNKLIG XLNNZMW.XLNNZMW_KY7_TIKX ZH XLNNZMW_KY7_TIKX
# RNKLIG XLNKLMVMG.OLXZOKILXVHHLI ZH OLXZOKILXVHHLI
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN IVWHSRUG.IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7
RNKLIG KRXPOV
UILN SVOKVI.XLNNZMWSVOKVI RNKLIG DIZK_XLNNZMW

WVU NZRM(XLNNZMW_GVCG,  KILTIZN, HVIEVI=mLMV):
    RU HVIEVI RH mLMV:
        HVIEVI = FYRJFGRO.TVG_FYRJ_SLHG()

    IVWHSRUG = iVWHSRUGxORVMG('872.9.9.8', '49939')
    NHT = DIZK_XLNNZMW(IVWHSRUG, KILTIZN, HVIEVI, XLNNZMW_GVCG)
    IVKOB = IVWHSRUG.HVMW(NHT)
    KIRMG('-------xlnnzmw-------\M')
    KIRMG(XLNNZMW)
    KIRMG('---------ivkob-------\M')
    KIRMG(IVKOB)
    KIRMG('---------------------\M')
    KIRMG('hgzgfh:', IVKOB.HGZGFH)
    KIRMG('nvhhztv:', IVKOB.NVHHZTV+'\M')
    KIRMG(KRXPOV.OLZWH(IVKOB.WZGZ))
    IVGFIM IVKOB


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'X:K:G:', ['XLNNZMW=', 'KLIG=', 'GZITVG='])
        KLIG = '49948'
        GZITVG = mLMV
        KILTIZN = 'HGZIUOVVG'
        XLNNZMW = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-K', '--KILTIZN'):
                KILTIZN = ZIT
            RU LKG RM ('-X', '--XLNNZMW'):
                XLNNZMW = ZIT

        RU GZITVG RH mLMV:
            NZRM(XLNNZMW, KILTIZN)
        VOHV:
            NZRM(XLNNZMW, KILTIZN, GZITVG)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/IVNLGVQLY.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm + '/HGZIUOVVG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
RNKLIG GRNV
UILN YZHV.NZMZTVNVMG RNKLIG lMVGRNVdLIPVI
UILN SVOKVI.IVNLGVQLY RNKLIG iVNLGVqLY


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'G:X:', ['GZITVG=', 'XLNNZMW='])
        GZITVG = ''
        XLNNZMW = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-X', '--XLNNZMW'):
                XLNNZMW = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        KIRMG('JFVIB LMVGRNV QLY UILN %H'%GZITVG)

        DLIPVI = lMVGRNVdLIPVI(XLNNZMW)
        IVNLGV_QLY = iVNLGVqLY(GZITVG, DLIPVI)

        PVB = IVNLGV_QLY.HVMW()
        RU PVB RH mLMV:
            HBH.VCRG(-8)

        HGZGFH = 'IVZWB'
        DSROV HGZGFH != 'HFXXVHH':
            IVHFOG = IVNLGV_QLY.JFVIB_IVHFOG()
            RU IVHFOG RH mLMV:
                KIRMG('viili: XZMMLG URMW IVHFOG ULI PVB %H'%PVB)
            HGZGFH = IVNLGV_QLY.KILTIVHH
            KIRMG(HGZGFH)
            GRNV.HOVVK(9.4)
        IVNLGV_QLY.KIRMG_IVHFOG()
        KIRMG('\Mhgwlfg\M------------\M',IVHFOG.HGWLFG.WVXLWV('FGU1'))
        KIRMG('\Mhgwvii\M------------\M', IVHFOG.HGWVII.WVXLWV('FGU1'))

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/YVZXLM.KB
RNKLIG GLLO.NZXSRMV ZH NZXSRMV
RNKLIG HGZGHW

XOZHH yVZXLM(LYQVXG):
    WVU __RMRG__(HVOU, XLMURT, GZT = 'HBHGVNVBV', HBHGVN = 'HGZIUOVVG'):
        HVOU.XLMURT = XLMURT
        HVOU.YLCRMUL = NZXSRMV.nZXSRMV()
        HVOU.SLHG = HVOU.YLCRMUL.SLHG
        HVOU.WLNZRM = HVOU.YLCRMUL.WLNZRM
        HVOU.HVIEVI = XLMURT.ZGGIRY["SLHG"]
        HVOU.KLIG = XLMURT.ZGGIRY["KLIG"]
        HVOU.HGZGHW = HGZGHW.hGZGHxORVMG(HVOU.HVIEVI, RMG(HVOU.KLIG),
                                         KIVURC = GZT + "."+HVOU.SLHG + '.' + HVOU.WLNZRM+'.' + HBHGVN)
        HVOU.HBHGVN = HBHGVN
        RU 'IVKLIG_HVOU' RM XLMURT.ZGGIRY:
            HVOU.RH_IVKLIG_HVOU = gIFV RU XLMURT.ZGGIRY['IVKLIG_HVOU'].OLDVI() == 'GIFV' VOHV uZOHV
        VOHV:
            HVOU.RH_IVKLIG_HVOU = uZOHV

    WVU tZFTV( HVOU, GLKRX, XLMGVMG ):
        HVOU.HGZGHW.TZFTV(GLKRX, XLMGVMG)

    WVU uOZHS(HVOU, GRNV):
        RU HVOU.RH_IVKLIG_HVOU:
            HVOU.tZFTV(HVOU.HBHGVN, GRNV)
//##**---------------- ./HGZIUOVVG/GLLO/HU_HXIFGRMRAV_GY.KB
#!/LKG/ZMZXLMWZ/YRM/KBGSLM
RNKLIG TVGLKG
RNKLIG HBH
RNKLIG IV
RNKLIG MFNKB ZH MK
RNKLIG NZGKOLGORY.KBKOLG ZH KOG
RNKLIG LH

XOZHH hGZG(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.GRNV_ORHG = []

    WVU zWW(HVOU, GRNV):
        HVOU.GRNV_ORHG.ZKKVMW(GRNV)

    WVU DLIP(HVOU):
        HVOU.NVZM = MK.NVZM(HVOU.GRNV_ORHG)
        HVOU.NVWRZM = MK.NVWRZM(HVOU.GRNV_ORHG)
        HVOU.HGW = MK.HGW(HVOU.GRNV_ORHG)
        HVOU.NZC = MK.NZC(HVOU.GRNV_ORHG)
        HVOU.NRM = MK.NRM(HVOU.GRNV_ORHG)
        HVOU.J79 = MK.KVIXVMGROV(HVOU.GRNV_ORHG, 79)
        HVOU.J29 = MK.KVIXVMGROV(HVOU.GRNV_ORHG, 29)
        HVOU.J09 = MK.KVIXVMGROV(HVOU.GRNV_ORHG, 09)


XOZHH zXXLFMG(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.LIWVIH = {}
        HVOU.HGZG = hGZG()

XOZHH lIWVI(LYQVXG):
    XOZHH gRNV(LYQVXG):
        WVU __RMRG__(HVOU, HGI):
            HK = HGI.HKORG(".")
            HVOU.SLFI = RMG(HK[9].HKORG(":")[9])
            HVOU.NRMFGV = RMG(HK[9].HKORG(":")[8])
            HVOU.HVXLMW = RMG(HK[9].HKORG(":")[7])
            HVOU.FH = RMG(HK[8])
            RU HVOU.SLFI <= 3:
                HVOU.SLFI += 75;

        WVU URC(HVOU):
            IVGFIM (HVOU.SLFI*6399 + HVOU.NRMFGV*39 + HVOU.HVXLMW)*8999*8999 + HVOU.FH

        WVU __HFY__(HVOU, LGSVI):
            GRNVWRUU = GBKV(HVOU)("9:9:9.9")
            FHWRUU = HVOU.URC() - LGSVI.URC()
            GRNVWRUU.FH = FHWRUU%(8999*8999)
            GRNVWRUU.HVXLMW = (FHWRUU - GRNVWRUU.FH)/8999/8999
            # RU GRNVWRUU.FH < 899:
                # IZRHV eZOFVvIILI("")
            IVGFIM GRNVWRUU


    WVU __RMRG__(HVOU, PVB, ZXXLFMG, HGZIG):
        HVOU.RW = PVB
        HVOU.ZXXLFMG = ZXXLFMG
        HVOU.HGZIG = HVOU.gRNV(HGZIG)
        HVOU.RH_IVHKLMHV = uZOHV

    WVU IVHKLMHV(HVOU, IVHKLMHV):
        HVOU.IVHKLMHV_HGI = IVHKLMHV
        HVOU.IVKOB = HVOU.gRNV(IVHKLMHV)
        HVOU.IVHKLMHV_GRNV = HVOU.IVKOB -  HVOU.HGZIG
        RU HVOU.RH_IVHKLMHV:
            IVGFIM uZOHV
        VOHV:
            HVOU.RH_IVHKLMHV = gIFV
            IVGFIM gIFV

XOZHH gyiVKLIG(LYQVXG):
    WVU __RMRG__(HVOU, GY_OLT, RMH = "", UFOO_IZMTV = 9):
        HVOU.GY_OLT = GY_OLT
        HVOU.ZXXLFMG_ORHG = {}
        HVOU.RMH = RMH
        HVOU.UFOO_IZMTV = UFOO_IZMTV
        RU MLG LH.KZGS.RHUROV(HVOU.GY_OLT):
            KIRMG("viili: %H UROV MLG VCRHG"%(HVOU.GY_OLT))
            IVGFIM
        DRGS LKVM(HVOU.GY_OLT) ZH U:
            IVTVCK_LIWVIRMHVIG = IV.XLNKROV(I' lIWVIrMHVIG')
            IVTVCK_IHKLIWVIRMHVIG = IV.XLNKROV(I' lMiGMlIWVI')
            IVTVCK_GRNV = IV.XLNKROV(I'\[[9-0\.\-:]*\]')
            IVTVCK_PVB = IV.XLNKROV(I'PVB=[9-0]+')
            IVTVCK_ZXXLFMG = IV.XLNKROV(I'\][9-0]+')
            IVTVCK_RMHGIFNVMG = IV.XLNKROV(I'rMH=[Z-Az-a9-0]+')
            ULI ORMV RM U.IVZWORMVH():
                ORMV  = ORMV.HGIRK()
                RU IVTVCK_LIWVIRMHVIG.HVZIXS(ORMV.HGIRK()) RH MLG mLMV:
                    ZXXLFMG = IVTVCK_ZXXLFMG.HVZIXS(ORMV).TILFK()[8:]
                    GRNV =  IVTVCK_GRNV.HVZIXS(ORMV).TILFK()[89:-8]
                    PVB = IVTVCK_PVB.HVZIXS(ORMV).TILFK()[5:]
                    RU ZXXLFMG MLG RM HVOU.ZXXLFMG_ORHG:
                        HVOU.ZXXLFMG_ORHG[ZXXLFMG] = zXXLFMG()
                    HVOU.ZXXLFMG_ORHG[ZXXLFMG].LIWVIH[PVB] =  lIWVI(PVB=PVB, ZXXLFMG=ZXXLFMG, HGZIG=GRNV)
                VORU IVTVCK_IHKLIWVIRMHVIG.HVZIXS(ORMV.HGIRK()) RH MLG mLMV:
                    ZXXLFMG = IVTVCK_ZXXLFMG.HVZIXS(ORMV).TILFK()[8:]
                    GRNVHGI =  IVTVCK_GRNV.HVZIXS(ORMV).TILFK()[89:-8]
                    PVB = IVTVCK_PVB.HVZIXS(ORMV).TILFK()[5:]
                    RU ZXXLFMG MLG RM HVOU.ZXXLFMG_ORHG:
                        XLMGRMFV
                    ZXX = HVOU.ZXXLFMG_ORHG[ZXXLFMG]
                    RU PVB MLG RM ZXX.LIWVIH:
                        XLMGRMFV
                    RU HVOU.RMH:
                        RU HVOU.RMH != IVTVCK_RMHGIFNVMG.HVZIXS(ORMV).TILFK()[5:]:
                            WVO ZXX.LIWVIH[PVB]
                            XLMGRMFV
                    LIWVI = ZXX.LIWVIH[PVB]
                    RU LIWVI.IVHKLMHV(GRNVHGI):
                        # KIRMG LIWVI.IVHKLMHV_GRNV.HVXLMW*8999*8999+LIWVI.IVHKLMHV_GRNV.FH
                        ZXX.HGZG.zWW(LIWVI.IVHKLMHV_GRNV.HVXLMW*8999+LIWVI.IVHKLMHV_GRNV.FH/8999)
                        RU  HVOU.UFOO_IZMTV > 9 ZMW LIWVI.IVHKLMHV_GRNV.HVXLMW*8999 + LIWVI.IVHKLMHV_GRNV.FH/8999 > UFOO_IZMTV:
                            KIRMG "%W:%W:%W.%W->%W:%W:%W.%W, %W NH"%(LIWVI.HGZIG.SLFI, LIWVI.HGZIG.NRMFGV, LIWVI.HGZIG.HVXLMW,LIWVI.HGZIG.FH,
                            LIWVI.IVKOB.SLFI, LIWVI.IVKOB.NRMFGV, LIWVI.IVKOB.HVXLMW, LIWVI.IVKOB.FH, LIWVI.IVHKLMHV_GRNV.HVXLMW*8999 + LIWVI.IVHKLMHV_GRNV.FH/8999)
                            KIRMG LIWVI.IVHKLMHV_HGI

    WVU DLIP(HVOU):
        ULI PVB, ZXX RM HVOU.ZXXLFMG_ORHG.RGVIRGVNH():
            ZXX.HGZG.DLIP()



RU __MZNV__ == "__NZRM__":

    GY_OLT = ""
    RH_KOLG = uZOHV
    RMH = ""
    UFOO_IZMTV = 9
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'G:R:EU:K', ['GY=', 'EVIHRLM','KOLG', "UFOO", "RMHGIFNVMG="])

    ULI LKG,ZIT RM LKGRLMH:
        RU LKG RM ('-G', '--GY'):
            GY_OLT = ZIT
        RU LKG RM ('-K', '--KOLG'):
            RH_KOLG = gIFV
        RU LKG RM ('-R', '--RMHGIFNVMG'):
            RMH = ZIT
        RU LKG RM ('-U', '--UFOO'):
            UFOO_IZMTV = RMG(ZIT)
    RU MLG GY_OLT:
        HBH.VCRG('NFHG UVVW GY_OLT UROV DRGS -G LI --GY')

    IVKLIG = gyiVKLIG(GY_OLT, RMH, UFOO_IZMTV)
    IVKLIG.DLIP()

    KIRMG "gy hFNNVIB (FMRG: NH)"
    KIRMG "zxxlfmg :%W"%(OVM(IVKLIG.ZXXLFMG_ORHG))
    ULI PVB, ZXX RM IVKLIG.ZXXLFMG_ORHG.RGVIRGVNH():
        #ZXX.HGZG.DLIP()
        KIRMG "-----------"
        KIRMG "zxx: %H"%PVB
        KIRMG "   lIWVIH: %W"%(OVM(ZXX.LIWVIH))
        KIRMG "   IVKOB j-79: %.7U, j-49: %.7U, j-29: %.7U, j-09: %.7U"%(ZXX.HGZG.J79, ZXX.HGZG.NVWRZM, ZXX.HGZG.J29, ZXX.HGZG.J09)
        KIRMG "   IVKOB NVZM: %.7U"%(ZXX.HGZG.NVZM)
        KIRMG "   IVKOB NZC: %.7U"%(ZXX.HGZG.NZC)
        KIRMG "   IVKOB NRM: %.7U"%(ZXX.HGZG.NRM)
        KIRMG "   IVKOB QRGGVI: %.7U"%(ZXX.HGZG.HGW)

        RU RH_KOLG:
            U = KOG.URTFIV()
            M, YRMH, KZGXSVH = KOG.SRHG([ C ULI C RM ZXX.HGZG.GRNV_ORHG RU C<6*ZXX.HGZG.NVWRZM ])
            KOG.KOLG(YRMH)
            KOG.COZYVO("iVKOB oZGVMXB (RM NH)")
            KOG.TIRW(gIFV)
            KOG.GRGOV(I'$\NZGSIN{sRHGLITIZN\ LU\ lIWVI\ rMHVIGRLM\ iVKOB\ oZGVMXB}$')
            ZC = U.ZWW_HFYKOLG(888)
            KOG.GVCG(9.34, 9.04, 'zxxlfmg: %H'%(PVB), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.0, 'liwvi: %W'%(OVM(ZXX.LIWVIH)), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.14, 'j-79%H=%.7U NH'%('%', ZXX.HGZG.J79), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.1, 'j-49%H=%.7U NH'%('%',ZXX.HGZG.NVWRZM), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.24, 'j-29%H=%.7U NH'%('%',ZXX.HGZG.J29), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.2, 'j-09%H=%.7U NH'%('%',ZXX.HGZG.J09), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.34, 'NVZM=%.7U NH'%(ZXX.HGZG.NVZM), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.3, 'QRTTVI=%.7U NH'%(ZXX.HGZG.HGW), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.44, 'NZC=%.7U NH'%(ZXX.HGZG.NZC), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.GVCG(9.34, 9.4, 'NRM=%.7U NH'%(ZXX.HGZG.NRM), GIZMHULIN = ZC.GIZMHzCVH)
            KOG.HSLD()
            # KIRMG YRMH
//##**---------------- ./HGZIUOVVG/GLLO/JFVIBQLY.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

WVU JFVIB_QLY(IVWHSRUG, GZITVG, IVU=9):
    NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
    NHT.XLNNZMW = 'JFVIBLMVGRNVLK'
    NHT.WZGZ = KRXPOV.WFNKH(IVU)
    IVKOB = IVWHSRUG.HVMW(NHT)
    LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
    IVGFIM LKORHG


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        GZITVG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        KIRMG('JFVIB LMVGRNV QLY UILN %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        LKORHG = JFVIB_QLY(IVWHSRUG, GZITVG)
        ULI R RM LKORHG:
            KIRMG('------')
            KIRMG('QLY   : %H'%R.RW)
            KIRMG('OZYVO : %H'%R.IZMWLN_RW)
            KIRMG('HGZIG : %H'%R.HGZIG_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
            KIRMG('VMW   : %H'%R.VMW_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
            KIRMG('KILTIVHH: ', [KRXPOV.OLZWH(W) ULI W RM R.WZGZ])
            KIRMG('HGZGFH: %H'%R.HGZGFH)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/XSVXPIVTRHGVIVW.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'K:G:H:', [ 'KZGS=', 'GZITVG=', 'HVIEVI='])
        GZITVG = ''
        HVIEVI = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG('872.9.9.8','49939')
        NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
        NHT.XLNNZMW = 'XSVXPIVTRHGVIVW&ZOO'
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            WZGZ = KRXPOV.OLZWH(IVKOB.WZGZ)
            KIRMG(WZGZ)
            ULI E RM WZGZ['IVTRHGVI']:
                KIRMG('\M-------------------')
                KIRMG('mZNV : %H'%E['MZNV'])
                KIRMG('gBKV : %H'%E['GBKV'])
                KIRMG('rw : %H'%E['RW'])
                KIRMG('sLHG : %H'%E['SLHG'])

            ULI P, E RM WZGZ['KLHG_HVIEVI'].RGVNH():
                KIRMG('\M-------------------')
                KIRMG('mZNV : %H'%P)
                KIRMG('hVIEVI : %H'%E)

                # RU OVM(HVIEVI) > 9 ZMW P != HVIEVI:
                    # XLMGRMFV
                # KIRMG('-------%H------'%P)
                # ULI NHT RM E:
                    # KIRMG(' HVIEVI: %H\M gRGOV: %H\M nVHHZTV: %H\M hGZGFH: %H\M hVMW: %H\M'%( P,  NHT.YILZWXZHG_GRGOV, NHT.YILZWXZHG_NVHHZTV, NHT.YILZWXZHG_IVZWB, NHT.YILZWXZHG_IVWHSRUG_NVHHZTV))
        VOHV:
            KIRMG(IVKOB)


    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/HU_WZROB_IVKLIG.KB
#!/LKG/ZMZXLMWZ/YRM/KBGSLM
UILN __UFGFIV__ RNKLIG KIRMG_UFMXGRLM
RNKLIG LH
# RNKLIG KZMWZH ZH KW
# RNKLIG MFNKB ZH MK
RNKLIG ZITKZIHV
UILN QRMQZ7 RNKLIG vMERILMNVMG, uROVhBHGVNoLZWVI
UILN HU_HXIFGRMRAV_GY RNKLIG gyiVKLIG
UILN HU_HXIFGRMRAV_SRG RNKLIG sugiVKLIG
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
    HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
    # UILN DVZHBKIRMG RNKLIG sgno

NZXSRMV_ORHG = ["ACAQ8"]
KMO_UROV = '/FYRJ/OLT/KMO/SGBW8_KMO_79839295.OLT'

RU __MZNV__ == "__NZRM__":
    # HNX = hnx.hnx()
    # XOLXP = XOLXP.xOLXP()
    # XOLXP.FKWZGV()

    KZIHVI = ZITKZIHV.zITFNVMGkZIHVI(WVHXIRKGRLM='tVMVIZGV wZROB gIZWRMT rMULINZGRLM')
    KZIHVI.ZWW_ZITFNVMG('LFGUROV', GBKV=ZITKZIHV.uROVgBKV('D'),
                        SVOK="LFGKFG UROV")
    ZITH = KZIHVI.KZIHV_ZITH()

    UROVH = [(RGVN, "/FYRJ/OLT/gy/"+RGVN+"_GY_"+HGI(79839295)+".OLT") ULI RGVN RM NZXSRMV_ORHG]

    NZXSRMV = {}
    ULI UROV RM UROVH:
        NZXSRMV[UROV[9]] = gyiVKLIG(UROV[8])
        NZXSRMV[UROV[9]].DLIP()

    SUGIVKLIG = sugiVKLIG(KMO_UROV)
    SUGIVKLIG.DLIP()
    #KIRMG(UROVH)
    # tVG HLNV MZGRLMZO HFNNZIB GL RMXOFWV ZH DVOO
    #NZMZTVI_WU = []
    #ULI NZMZTVI RM HZOVH_IVKLIG.RMWVC.TVG_OVEVO_EZOFVH(9).FMRJFV():
    #        NZMZTVI_WU.ZKKVMW([NZMZTVI, HZOVH_IVKLIG.CH(NZMZTVI, OVEVO=9).GL_SGNO()])
    # wL LFI GVNKOZGRMT MLD

    # dV XZM HKVXRUB ZMB WRIVXGLIB ULI GSV OLZWVI YFG ULI GSRH VCZNKOV, FHV XFIIVMG WRIVXGLIB
    VME = vMERILMNVMG(OLZWVI=uROVhBHGVNoLZWVI(LH.KZGS.QLRM(LH.KZGS.WRIMZNV(__UROV__),"../", 'GVNKOZGV')))
    GVNKOZGV = VME.TVG_GVNKOZGV("WZROB_IVKLIG.SGNO")
    KIRMG(LH.KZGS.QLRM(LH.KZGS.WRIMZNV(__UROV__),"../", 'GVNKOZGV'))
    GVNKOZGV_EZIH = {"GRGOV" : "gIZWRMT hBHGVN wZROB iVKLIG",
                     "NZXSRMVH" : NZXSRMV,
                     "SUGNZXSRMVH": SUGIVKLIG,
                     "GVNKOZGV" : LH.KZGS.QLRM(LH.KZGS.WRIMZNV(__UROV__),"../", 'GVNKOZGV')}
    #                "hLUGDZIV": TVG_HFNNZIB_HGZGH(WU, "hLUGDZIV"),
    #                 "MZGRLMZO_KRELG_GZYOV": HZOVH_IVKLIG.GL_SGNO(),
    #                 "nZMZTVI_wVGZRO": NZMZTVI_WU}
    # iVMWVI LFI UROV ZMW XIVZGV GSV kwu FHRMT LFI XHH HGBOV UROV
    SGNO_LFG = GVNKOZGV.IVMWVI(GVNKOZGV_EZIH)
    DRGS LKVM(ZITH.LFGUROV.MZNV, "D") ZH U:
        U.DIRGV(SGNO_LFG)
//##**---------------- ./HGZIUOVVG/GLLO/FKTIZWV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

RNKLIG LH
RNKLIG IV
RNKLIG HBH
RNKLIG GRNV
RNKLIG HFYKILXVHH
RNKLIG WZGVGRNV
RNKLIG TVGLKG
RNKLIG GZIUROV
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY

UOLD = "YFROWUOLD.UOLD"
WVU VCGIZXG(KZGS, KILTIZN):
    #KIRMG(KZGS.HGIRK())
    #KIRMG(KILTIZN)
    UGZIUROV = GZIUROV.LKVM(LH.KZGS.QLRM(KZGS, KILTIZN.HGIRK()+'.GZI.YA7'), 'I:YA7')
    UGZIUROV.VCGIZXGZOO('./')


WVU XZOO_YZHS(KZGS, ZITH):
    # LIRTRMZO_KZGS = LH.KZGS.ZYHKZGS('.')
    #LH.XSWRI(KZGS.HGIRK())
    #KIRMG('HGZIGH GL XLNKROV: %H'%((ZITH)))
    #KIRMG(HVOU.MZNV, ' HGZIGH GL XLNKROV')
    HGZIG = WZGVGRNV.WZGVGRNV.MLD()
    GIB:
        #KIRMG(ZITH)
        K = HFYKILXVHH.kLKVM('XW %H;'%KZGS+ZITH, HSVOO=gIFV, HGWLFG=HFYKILXVHH.krkv, HGWVII=HFYKILXVHH.krkv)
        HGWLFG, HGWVII = K.XLNNFMRXZGV()
        VIILI = OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', HGWLFG.WVXLWV('FGU1') )) + OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', HGWVII.WVXLWV('FGU1') ))
        DZIM = OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', HGWLFG.WVXLWV('FGU1') )) +  OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', HGWVII.WVXLWV('FGU1') ))
        VMW = WZGVGRNV.WZGVGRNV.MLD()
        VOZKHVW = VMW - HGZIG
        RU K.IVGFIMXLWV != 9:
            IVGFIM [-8, HGWLFG, HGWVII, 9, VIILI, DZIM, VOZKHVW]
        #KIRMG('----------- hgwlfg -----------\M')
        #KIRMG('\M'.QLRM(HGWLFG.WVXLWV('FGU1').HKORG('\M')))
        #KIRMG('\M----------- hgwvii -----------\M')
        #KIRMG('\M'.QLRM(HGWVII.WVXLWV('FGU1').HKORG('\M')))
        IVGFIM [8, HGWLFG, HGWVII, 9, VIILI, DZIM, VOZKHVW]
    VCXVKG HFYKILXVHH.xZOOVWkILXVHHvIILI ZH V:
        KIRMG('----------- hgwlfg -----------\M')
        KIRMG('\M'.QLRM(HGWLFG.WVXLWV('FGU1').HKORG('\M')))
        KIRMG('\M----------- hgwvii -----------\M')
        KIRMG('\M'.QLRM(HGWVII.WVXLWV('FGU1').HKORG('\M')))
        VIILI = OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', V.HGWLFG.WVXLWV('FGU1') )) + OVM(IV.URMWZOO( I'vIILI|kVINRHHRLM wVMRVW|VIILI', V.HGWVII.WVXLWV('FGU1') ))
        DZIM = OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', V.HGWLFG.WVXLWV('FGU1') )) +  OVM(IV.URMWZOO( I'DZIMRMT|dZIMRMT', V.HGWVII.WVXLWV('FGU1') ))
        VMW = WZGVGRNV.WZGVGRNV.MLD()
        VOZKHVW = VMW - HGZIG
        # KIRMG(HVOU.MZNV, ' FHVW ', VOZKHVW)
        IVGFIM [-8, V.HGWLFG, V.HGWVII, 9, VIILI, DZIM, VOZKHVW]




XOZHH xLNKROVI(LYQVXG):
    WVU __RMRG__(HVOU, KZGS, HVIERXV, WG, OLTWRI):
        HVOU.HVIERXV = HVIERXV
        HVOU.HGZGFH = 9
        HVOU.KZGS = KZGS
        HVOU.WG = WG
        HVOU.OLTWRI = OLTWRI
        HVOU.HGZIG = mLMV
        HVOU.VMW = mLMV

    WVU IFM(HVOU):
        HVOU.HGZIG = WZGVGRNV.WZGVGRNV.MLD()
        HVIERXV = HVOU.HVIERXV
        KIRMG('HGZIGH GL XLNKROV %H'%HVIERXV)
        RU HVIERXV RM ['VKLXS', 'SZOL', 'URMZORAV']:
            XLNNZMW = 'HS /LKG/6IW/FYRJYZHV/YRM/%H.HS %H'%(HVIERXV, HVOU.WG)
            HVOU.IVG = XZOO_YZHS('%H'%HVOU.KZGS, XLNNZMW)
        VORU HVIERXV.HKORG('-')[9] RM ["FHRN", "FGIZWV"]:
            VCGIZXG(HVOU.KZGS, HVIERXV)
            OVEVO = HVIERXV.HKORG('-')[8]
            RU OVEVO == 'IVOVZHV':
                 OVEVO = 'HGZYOV'
            XLNNZMW = "HS ./IVOVZHV.HS %H %H"%('/LKG/EVIHRLM/'+HVOU.WG+'/'+HVIERXV.HKORG('-')[9]+'/'+HVIERXV, OVEVO)
            HVOU.IVG = XZOO_YZHS(LH.KZGS.QLRM(HVOU.KZGS, HVIERXV), XLNNZMW)
        VOHV:
            VCGIZXG(HVOU.KZGS, HVIERXV)
            HVOU.IVG = XZOO_YZHS(LH.KZGS.QLRM(HVOU.KZGS, HVIERXV), 'HS ./IVOVZHV.HS')
        HVOU.HGZGFH = HVOU.IVG[9]
        HVOU.VMW = WZGVGRNV.WZGVGRNV.MLD()

    WVU KIRMG(HVOU):
        HGWLFG = HVOU.IVG[8]
        HGWVII = HVOU.IVG[7]
        KIRMG('----------- hgwlfg -----------\M')
        KIRMG('\M'.QLRM(HGWLFG.WVXLWV('FGU1').HKORG('\M')))
        KIRMG('\M----------- hgwvii -----------\M')
        KIRMG('\M'.QLRM(HGWVII.WVXLWV('FGU1').HKORG('\M')))

WVU FKWZGV(WRIVXGLIB, WG, OLT, HRMXV=''):
    HGZIG = gIFV
    RU HRMXV != '':
        HGZIG = uZOHV
    OLTWRI = LH.KZGS.QLRM(OLT, LH.KZGS.YZHVMZNV(WRIVXGLIB))
    RU MLG LH.KZGS.VCRHGH(OLTWRI):
    	LH.NPWRI(OLTWRI)
    IVKLIG_U = LKVM(LH.KZGS.QLRM(OLTWRI, 'FKWZGV.IVKLIG'), 'D')
    K = HFYKILXVHH.kLKVM('XSNLW 244 -i %H'%(WRIVXGLIB), HSVOO=gIFV)
    DRGS LKVM(LH.KZGS.QLRM(WRIVXGLIB, 'YFROWUOLD.UOLD') )ZH U:
        ULI ORMV RM U:
            ORMV = ORMV.HGIRK()
            HVIERXVH = ORMV.HKORG(',')
            QLYH = []
            XLNH = []
            ULI HVIERXV RM HVIERXVH:
                HVIERXV = HVIERXV.HGIRK()
                RU HVIERXV.HGIRK() == HRMXV:
                    HGZIG = gIFV
                RU MLG HGZIG:
                    KIRMG('RTMLIV %H'%HVIERXV)
                    XLMGRMFV
                XLN = xLNKROVI(WRIVXGLIB, HVIERXV, WG, OLTWRI)
                XLNH.ZKKVMW(XLN)
                QLY = qLY(XLN)
                QLYH.ZKKVMW(QLY)
                QLY.HGZIG()
            ULI QLY RM QLYH:
                QLY.QLRM()
            IVG = gIFV
            ULI XLN RM XLNH:
                DRGS LKVM(LH.KZGS.QLRM(OLTWRI, XLN.HVIERXV), 'D') ZH U:
                   U.DIRGV('----hgwlfg-----\M\M\M\M')
                   U.DIRGV('\M'.QLRM(XLN.IVG[8].WVXLWV('FGU1').HKORG('\M')))
                   U.DIRGV('----hgwvii-----\M\M\M\M')
                   U.DIRGV('\M'.QLRM(XLN.IVG[7].WVXLWV('FGU1').HKORG('\M')))
                RU XLN.HGZGFH != 8:
                   IVKLIG_U.DIRGV('%-81H uzrovw'%XLN.HVIERXV)
                   KIRMG('!!!!viili!!!!!')
                   XLN.KIRMG()
                   IVGFIM -8
                VOHV:
                   IVKLIG_U.DIRGV('%-81H hfxxvhh   %H-%H\M'%(XLN.HVIERXV, XLN.HGZIG.HGIUGRNV('%s:%n:%h'), XLN.VMW.HGIUGRNV('%s:%n:%h')))
    K = HFYKILXVHH.kLKVM('XK %H %H'%(LH.KZGS.QLRM(WRIVXGLIB, 'EVIHRLM.SVZW'), LH.KZGS.QLRM('/LKG/EVIHRLM', WG)+'/'), HSVOO=gIFV, HGWLFG=HFYKILXVHH.krkv, HGWVII=HFYKILXVHH.krkv)
    IVGFIM 9


RU __MZNV__=='__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:U:W:O:', ['HRMXV=','WRIVXGLIB=', 'WG=', 'OLT='])
    HRMXV = ''
    WRIVXGLIB = ''
    OLT = '/FYRJ/OLT/FKWZGV'
    WG = GRNV.HGIUGRNV("%b%N%W", GRNV.OLXZOGRNV())
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-H', '--HRMXV'):
            HRMXV = ZIT
        RU LKG RM ('-W', '--WZGV'):
            WG = ZIT
        RU LKG RM ('-O', '--OLT'):
            OLT = ZIT
        RU LKG RM ('-U', '--UROV'):
            WRIVXGLIB = ZIT
    RU MLG LH.KZGS.VCRHGH(OLT):
        LH.NPWRI(OLT)
    IVG = FKWZGV(WRIVXGLIB, WG, OLT, HRMXV)
    K = HFYKILXVHH.kLKVM('XSNLW 244 -i %H'%(LH.KZGS.QLRM('/LKG/EVIHRLM', WG)), HSVOO=gIFV)
    RU IVG != 9:
       HBH.VCRG(-8)
//##**---------------- ./HGZIUOVVG/GLLO/IVJFVHGUROVRMUL.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG IVJFVHG_UROV_RMUL,IVJFVHG_UROV_XLMGVMG

RU __MZNV__ == '__NZRM__':
    # GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'K:G:', [ 'KZGS=', 'GZITVG='])
        GZITVG = ''
        KZGS = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-K', '--KZGS'):
                KZGS = ZIT
        RU GZITVG == '' LI KZGS == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        KIRMG('ZXJFRIV KZGS RMUL ', KZGS)
        IVWHSRUG = iVWHSRUGxORVMG('872.9.9.8','49939')
        IVKOB = IVJFVHG_UROV_RMUL(IVWHSRUG, GZITVG, KZGS)
        KIRMG(IVKOB.HGZGFH)
        KIRMG(IVKOB)

        IVKOB = IVJFVHG_UROV_XLMGVMG(IVWHSRUG, GZITVG, KZGS)
        KIRMG(IVKOB.HGZGFH)
        KIRMG(IVKOB)


    # VCXVKG vCXVKGRLM ZH V:
        # KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/IVGIRVEV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
# RNKLIG GRNV
# UILN SVOKVI.FGRO RNKLIG RNKLIG_XLNNZMW
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[7])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
# UILN YZHV.YZHV_NLWFOV RNKLIG nLWFOV
# UILN XLNNFMRXZGV RNKLIG WLXPVI_KY7
RNKLIG IZMWLN
RNKLIG HGIRMT
RNKLIG LH
UILN TRG RNKLIG tRG, iVKL
RNKLIG GZIUROV
RNKLIG HFYKILXVHH
RNKLIG HSFGRO
# UILN IWGLLO.HVMWUROV RNKLIG uROVhVMWVI
# UILN FYRJGLLO.GSIVZW_QLYH RNKLIG qLY
UILN FYRJGLLO.OLT RNKLIG XIVZGV_OLTTVI
# RNKLIG IV
RNKLIG WZGVGRNV
# RNKLIG KRXPOV
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG TVGLKG

XOZHH xLNgZHP(LYQVXG):
    WVU __RMRG__(HVOU, ORMV, OLTTVI=mLMV):
        HVOU.FIO = ORMV.HKORG()[8]
        HVOU.SVZW = ORMV.HKORG()[9].HKORG('=')[8]
        HVOU.MZNV = ORMV.HKORG()[9].HKORG('=')[9]
        HVOU.OLTTVI = OLTTVI

    WVU XOLMV(HVOU, YZHV_KZGS):
        # KIRMG('XOLMV')
        HVOU.OLTTVI.RMUL('XOLMRMT %H'%HVOU.MZNV)
        HVOU.YZHV_KZGS = YZHV_KZGS
        HVOU.KZGS = LH.KZGS.QLRM(YZHV_KZGS, HVOU.MZNV)
        # KIRMG(LH.TVGXDW())
        HVOU.IVKL = iVKL.XOLMV_UILN(HVOU.FIO, HVOU.KZGS )
        HVOU.TRG = tRG(HVOU.KZGS)
        HVOU.TRG.XSVXPLFG(HVOU.SVZW)
        ULI HFYNLWFOV RM HVOU.IVKL.HFYNLWFOVH:
            HFYNLWFOV.FKWZGV(RMRG=gIFV)

    WVU DIZK(HVOU):
        LH.XSWRI(LH.KZGS.WRIMZNV(LH.TVGXDW()))
        # KIRMG(LH.TVGXDW())
        HVOU.GZIUROV = HVOU.MZNV+'.GZI.YA7'
        # HVOU.GZIUROV_KZGS = LH.KZGS.QLRM(HVOU.YZHV_KZGS, HVOU.GZIUROV )
        DRGS GZIUROV.LKVM( HVOU.GZIUROV, NLWV='D:YA7', XLNKIVHHOVEVO=0) ZH ZIXSREV:
            ZIXSREV.ZWW(HVOU.MZNV, IVXFIHREV=gIFV)
        HSFGRO.INGIVV(HVOU.MZNV)

    WVU HGZNK(HVOU):
        LH.XSWRI(HVOU.KZGS)
        HFYKILXVHH.XZOO(['HS', './EVIHRLM.HS', '-A'])
        RU LH.KZGS.VCRHGH(LH.KZGS.QLRM(HVOU.KZGS, 'NLMHGVI')):
            LH.XSWRI(LH.KZGS.QLRM(HVOU.KZGS, 'NLMHGVI'))
            HFYKILXVHH.XZOO(['HS', './EVIHRLM.HS', '-A', '>/WVE/MFOO', '7>&8'])
            LH.XSWRI(HVOU.KZGS)
            LH.IVNLEV(LH.KZGS.QLRM(HVOU.KZGS, 'NLMHGVI',  '.TRG'))
        HFYKILXVHH.XZOO(['XSNLW', '-i','299', LH.KZGS.WRIMZNV(LH.TVGXDW()) ])
        # KIRMG(LH.TVGXDW())
        # LH.XSWRI(HVOU.KZGS)
        # KIRMG(HVOU.KZGS)
        HSFGRO.INGIVV( '.TRG')

XOZHH xLOOVXGLI(LYQVXG):
    WVU __RMRG__(HVOU, FKWZGV_UROV, IW, OLTTVI):
        HVOU.GZHP_ORHG = []
        HVOU.FKWZGV_UROV = FKWZGV_UROV
        HVOU.OLTTVI = OLTTVI
        HVOU.IW = IW
        HVOU.YZHV_KZGS = 'FKWZGV_'+HVOU.IW

    WVU KZIHV_UROV(HVOU):
        HVOU.OLTTVI.RMUL('KZIHRMT KILQVXGH')
        RU MLG LH.KZGS.VCRHGH(HVOU.FKWZGV_UROV):
            HVOU.OLTTVI.VIILI('FKWZGV UROV MLG VCRHGVW')
            IVGFIM -8
        RU 'xlnkovgv' MLG RM LKVM(HVOU.FKWZGV_UROV).IVZW():
            HVOU.OLTTVI.VIILI('FKWZGV UROV RMGVTIRGB XSVXP UZROVW')
            IVGFIM -7
        DRGS LKVM(HVOU.FKWZGV_UROV) ZH U:
            ULI ORMV RM U:
                RU ORMV.HGIRK()[9] == '[':
                    XLMGRMFV
                MVD_GZHP = xLNgZHP(ORMV, HVOU.OLTTVI)
                HVOU.GZHP_ORHG.ZKKVMW(MVD_GZHP)
        IVGFIM 9

    WVU XLOOVXG(HVOU):
        HVOU.OLTTVI.RMUL('XLOOVXGRMT ZMW XOLMRMT KILQVXGH')
        MLD_KZGS = LH.TVGXDW()
        ULI GZHP RM HVOU.GZHP_ORHG:
            LH.XSWRI(MLD_KZGS)
            GZHP.XOLMV(HVOU.YZHV_KZGS)
            GZHP.HGZNK()
            GZHP.DIZK()
        KIRMG(LH.TVGXDW(), HVOU.YZHV_KZGS)
        HFYKILXVHH.XZOO(['XK', '/RMX/YFROWUOLD.UOLD',  './' ])
        HFYKILXVHH.XZOO(['XK', '/LKG/EVIHRLM/%H/HGZIUOVVG/GLLO/FKTIZWV.KB'%evihrlm,  './' ])
        DRGS LKVM(LH.KZGS.QLRM('EVIHRLM.SVZW'), 'D') ZH U:
            U.DIRGV('[trgsvzw]\M')
            ULI GZHP RM HVOU.GZHP_ORHG:
                U.DIRGV('%H=%H\M'%(GZHP.MZNV, GZHP.SVZW))
            U.DIRGV('[xlnkovgv]')
        HVOU.OLTTVI.RMUL('ZOO RH WLMV, OLLPH TLLW')




RU __MZNV__ == '__NZRM__':
    OLTTVI = XIVZGV_OLTTVI('IVGIRVEV')
    OLTTVI.OVEVO('wvyft')
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'W:O:', ['WZGV=','OLT='])
    WZGV = ''
    OLTWRI = ''
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-W', '--WZGV'):
            WZGV = ZIT
        RU LKG RM ('-O', '--OLTTVI'):
            OLTWRI = ZIT
    RU WZGV == '':
        WZGV = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W')
    OLTTVI.RMUL('FHVH WZGV=%H'%WZGV)
    IW = ''.QLRM(IZMWLN.XSLRXV(HGIRMT.ZHXRR_FKKVIXZHV+HGIRMT.WRTRGH)  ULI _ RM IZMTV(4) )
    XLOOVXGLI = xLOOVXGLI('/LKG/EVIHRLM/%H/EVIHRLM.SVZW'%WZGV, IW, OLTTVI)
    RU XLOOVXGLI.KZIHV_UROV() != 9:
        HBH.VCRG(-8)
    XLOOVXGLI.XLOOVXG()

//##**---------------- ./HGZIUOVVG/GLLO/XSVXPVME.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
"""
zFGLXLNKOVGRLM VCZNKOV GSZG HSLDH NVGZ-RMULINZGRLM ZOLMTHRWV GSV XLNKOVGRLMH.
"""
# RNKLIG HRTMZO
RNKLIG HBH
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
RNKLIG TVGLKG
# UILN RGVIGLLOH RNKLIG XSZRM
# RNKLIG TVGKZHH
# RNKLIG TIKX
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
#RNKLIG XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7
# RNKLIG XLNNZMW.XLNNZMW_KY7_TIKX ZH XLNNZMW_KY7_TIKX
# RNKLIG XLNKLMVMG.OLXZOKILXVHHLI ZH OLXZOKILXVHHLI
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN IVWHSRUG.IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG HGZIUOVVG.XLNNZMW.XLNNZMW_KY7 ZH XLNNZMW_KY7
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.XLNNZMWSVOKVI RNKLIG DIZK_XLNNZMW
RNKLIG XLOOVXGRLMH

WVU NZRM(XLNNZMW_GVCG,  KILTIZN, HVIEVI=mLMV):
    RU HVIEVI RH mLMV:
        HVIEVI = FYRJFGRO.TVG_FYRJ_SLHG()

    XIBHGZO = {}
    KRKVORMV = {}
    SVOOL = {}
    NZRMYZHV=  {}
    KRKVORMV_KLHG = {}

    IVWHSRUG = iVWHSRUGxORVMG('872.9.9.8', '49939')
    NHT = DIZK_XLNNZMW(IVWHSRUG, KILTIZN, HVIEVI, XLNNZMW_GVCG)
    IVKOB = IVWHSRUG.HVMW(NHT)
    WZGZ = KRXPOV.OLZWH(IVKOB.WZGZ)['WZGZ']
    ULI P, E RM WZGZ.RGVNH():
        RU P.HKORG('&')[9] == 'SVOOL':
            SVOOL[P.HKORG('&')[8]] = E['NVHHZTV']+'&'+P.HKORG('&')[7]
        VORU P.HKORG('&')[9] == 'XIBHGZO':
            XIBHGZO[P.HKORG('&')[8]] = E['NVHHZTV']
        VORU P.HKORG('&')[9] == 'NZRMYZHV':
            NZRMYZHV[P.HKORG('&')[8]] = E['NVHHZTV']
        VORU P.HKORG('&')[9] == 'KRKVORMV':
            KRKVORMV[P.HKORG('&')[8]] = E['NVHHZTV']
        VORU P.HKORG('&')[9] == 'KRKVORMV_KLHG':
            KRKVORMV_KLHG[P.HKORG('&')[8]] = E['NVHHZTV']
        VOHV:
            KIRMG(P)
    KIRMG('--------------------\Mxibhgzo: ')
    ULI P RM XIBHGZO:
        KIRMG('-- %H ZG %H(%H)'%(P, XIBHGZO[P].HKORG('&')[8],  XIBHGZO[P].HKORG('&')[9]))
    KIRMG('---------------------\Mnzrmyzhv:')
    ULI P RM NZRMYZHV:
        KIRMG('-- %H ZG %H(%H)'%(P, NZRMYZHV[P].HKORG('&')[8],  NZRMYZHV[P].HKORG('&')[9]))
    KIRMG('---------------------\Mkrkvormv:')
    ULI P RM KRKVORMV:
        KIRMG('-- %H ZG %H(%H)'%(P, KRKVORMV[P].HKORG('&')[8],  KRKVORMV[P].HKORG('&')[9]))
    KIRMG('---------------------\Mkrkvormv klhg hvievi:')
    ULI P RM KRKVORMV_KLHG:
        KIRMG('-- %H ZG %H(%H) @ %H'%(P, KRKVORMV_KLHG[P].HKORG('&')[8],  KRKVORMV_KLHG[P].HKORG('&')[9],  KRKVORMV_KLHG[P].HKORG('&')[7]))
    KIRMG('---------------------\Mxlmmvxgrlm:')
    ULI P RM XLOOVXGRLMH.lIWVIVWwRXG(SVOOL):
        KIRMG('-- %H ZG %H(%H)'%(P, SVOOL[P].HKORG('&')[8],  SVOOL[P].HKORG('&')[9]))


    IVGFIM IVKOB


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'X:K:G:', ['XLNNZMW=', 'KLIG=', 'GZITVG='])
        KLIG = '49948'
        GZITVG = mLMV
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        KILTIZN = 'HGZIUOVVG'
        XLNNZMW='JFVIBYILZWXZHG'

        RU GZITVG RH mLMV:
            NZRM(XLNNZMW, KILTIZN)
        VOHV:
            NZRM(XLNNZMW, KILTIZN, GZITVG)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/RMHGZOOLK.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOLK.KB -U LKVIZGRLM/wFNNBlK.KB -X <LKVIZGRLM _LMVGRNV_="GIFV" NLWFOV="wFNNBlK"/> -G WVE8
##################

RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV



RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-U', '--UROV'):
                UROV = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURT = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        KIRMG('GVHG XLMMVXGRLM GL %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'JFVIBLK'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        IVKOB = IVWHSRUG.HVMW(NHT)
        #KIRMG(IVKOB)
        LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
        KIRMG(LKORHG)

        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'RMHGZOOLK'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        LKWZGZ = []
        DRGS LKVM(UROV, 'I') ZH U:
            LKWZGZ.ZKKVMW( U.IVZW() )
        LKWZGZ.ZKKVMW( XLMURT )
        NHT.WZGZ = KRXPOV.WFNKH(LKWZGZ)
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/XSVXPYILZWXZHG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm)
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'K:G:H:', [ 'KZGS=', 'GZITVG=', 'HVIEVI='])
        GZITVG = ''
        HVIEVI = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG('872.9.9.8','49939')
        NHT = IVWHSRUG.RMUL_GL_HGZIUOVVG(GZITVG)
        NHT.XLNNZMW = 'XSVXPYILZWXZHG&ZOO'
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            WZGZ = KRXPOV.OLZWH(IVKOB.WZGZ)
            ULI P, E RM WZGZ.RGVNH():
                RU OVM(HVIEVI) > 9 ZMW P != HVIEVI:
                    XLMGRMFV
                KIRMG('-------%H------'%P)
                ULI NHT RM E:
                    KIRMG(' HVIEVI: %H\M gRGOV: %H\M nVHHZTV: %H\M hGZGFH: %H\M hVMW: %H\M'%( P,  NHT.YILZWXZHG_GRGOV, NHT.YILZWXZHG_NVHHZTV, NHT.YILZWXZHG_IVZWB, NHT.YILZWXZHG_IVWHSRUG_NVHHZTV))
        VOHV:
            KIRMG(IVKOB)


    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/HU_HXIFGRMRAV_SRG.KB
#!/LKG/ZMZXLMWZ/YRM/KBGSLM
RNKLIG TVGLKG
RNKLIG HBH
RNKLIG IV
# RNKLIG MFNKB ZH MK
# RNKLIG NZGKOLGORY.KBKOLG ZH KOG
RNKLIG LH
UILN HVGH RNKLIG hVG

WVU xSVXPrMHGIFNVMG(HGI):
    IVTVCK_RMHGIFNVMG = IV.XLNKROV(I'[Z-Az-a]+')
    IVGFIM IVTVCK_RMHGIFNVMG.HVZIXS(HGI).TILFK()

XOZHH hGZG(LYQVXG):
    WVU __RMRG__(HVOU, RMH, ZXX, HGIZGVTB, GIZWRMTELO, XZMXVOELO):
        HVOU.RMH = RMH
        HVOU.ZXX = ZXX
        HVOU.HGIZGVTB = HGIZGVTB
        HVOU.GIZWRMTELO = GIZWRMTELO
        HVOU.XZMXVOELO = XZMXVOELO
        HVOU.LIWVIELO = GIZWRMTELO + XZMXVOELO
        HVOU.SRG_IZGV = (mLMV RU GIZWRMTELO+XZMXVOELO==9 VOHV GIZWRMTELO*8.9/(GIZWRMTELO+XZMXVOELO)*899.9)

XOZHH zXXLFMG(LYQVXG):
    WVU __RMRG__(HVOU, RW):
        HVOU.RW = RW
        HVOU.HGIZGVTB = {}
        HVOU.XLMGIZXGH = {}

    WVU ZWW(HVOU, HGZG):
        HGIZGVTB = HGZG.HGIZGVTB
        XLMGIZXG = HGZG.RMH
        # RMHGIFNVMG = xSVXPrMHGIFNVMG(XLMGIZXG)
        RU HGIZGVTB MLG RM HVOU.HGIZGVTB:
            HVOU.HGIZGVTB[HGIZGVTB] = hGIZGVTB(HGIZGVTB)
        HVOU.HGIZGVTB[HGIZGVTB].ZWW(HGZG)
        RU XLMGIZXG MLG RM HVOU.XLMGIZXGH:
            HVOU.XLMGIZXGH[XLMGIZXG] = xLMGIZXG(XLMGIZXG, HGZG)


XOZHH hGIZGVTB(LYQVXG):
    WVU __RMRG__(HVOU, RW):
        HVOU.RW = RW
        HVOU.XLMGIZXGH = {}

    WVU ZWW(HVOU, HGZG):
        RU HGZG.RMH MLG RM HVOU.XLMGIZXGH:
            HVOU.XLMGIZXGH[HGZG.RMH] = xLMGIZXG(HGZG.RMH, HGZG)

XOZHH xLMGIZXG(LYQVXG):
    WVU __RMRG__(HVOU, RW, HGZG):
        HVOU.RW = RW
        HVOU.HGZG = HGZG

XOZHH rMHGIFNVMG(LYQVXG):
    WVU __RMRG__(HVOU, RW, HGZG):
        HVOU.RW = RW
        HVOU.HGZG = HGZG


XOZHH sugiVKLIG(LYQVXG):
    WVU __RMRG__(HVOU, GY_OLT, OLTTVI= mLMV, GRNVIZMTV = 9):
        HVOU.GY_OLT = GY_OLT
        HVOU.IVXLIWH = {}
        HVOU.ZXXLFMGH = {}
        HVOU.XLMGIZXGH = []
        HVOU.OLTTVI = OLTTVI

    WVU DLIP(HVOU):
        RU MLG LH.KZGS.RHUROV(HVOU.GY_OLT):
            RU HVOU.OLTTVI:
                HVOU.OLTTVI.VIILI("sug%H UROV WLVH MLG VCRHG"%(HVOU.GY_OLT))
            VOHV:
                KIRMG("viili: %H UROV WLVH MLG VCRHG"%(HVOU.GY_OLT))
            IVGFIM
        XLMGIZXG_HVG = hVG()
        DRGS LKVM(HVOU.GY_OLT) ZH U:
            IVTVCK_RMHGIFNVMG = IV.XLNKROV(I'\@[Z-Az-a9-0]+')
            IVTVCK_HGIZGVTB = IV.XLNKROV(I'\[(.+?)\]')
            IVTVCK_GIZWRMTELO = IV.XLNKROV(I'gIZWRMTeLO:(.*)\(')
            IVTVCK_ELOXZMXVO = IV.XLNKROV(I'eLOxZMXVO:( [9-0]+)')

            ULI ORMV RM U.IVZWORMVH():
                ORMV  = ORMV.HGIRK()
                RMHGIFNVMG = IVTVCK_RMHGIFNVMG.HVZIXS(ORMV).TILFK()[8:]
                ZXXLFMG = IVTVCK_HGIZGVTB.URMWZOO(ORMV)[7].HKORG(".")[9]
                HGIZGVTB =  IVTVCK_HGIZGVTB.URMWZOO(ORMV)[7].HKORG(".")[8]
                RU RMHGIFNVMG=="zOO" LI HGIZGVTB=="zOO" LI ZXXLFMG=="zOO":
                    XLMGRMFV
                GIZWRMTELO =  RMG(IVTVCK_GIZWRMTELO.HVZIXS(ORMV).TILFK(8).HGIRK())
                ELOXZMXVO =  RMG(IVTVCK_ELOXZMXVO.HVZIXS(ORMV).TILFK(8).HGIRK())
                XLMGIZXG_HVG.ZWW(RMHGIFNVMG)
                HVOU.IVXLIWH[RMHGIFNVMG+"|"+HGIZGVTB+"|"+ZXXLFMG] = hGZG(
                    RMH=RMHGIFNVMG, HGIZGVTB = HGIZGVTB, ZXX=ZXXLFMG,
                    GIZWRMTELO=GIZWRMTELO, XZMXVOELO = ELOXZMXVO
                    )
            HVOU.XLMGIZXGH = HLIGVW(XLMGIZXG_HVG)
            ULI P,IVXLIW RM HVOU.IVXLIWH.RGVIRGVNH():
                RU MLG IVXLIW.SRG_IZGV:
                    XLMGRMFV
                RU IVXLIW.ZXX MLG RM HVOU.ZXXLFMGH:
                    HVOU.ZXXLFMGH[IVXLIW.ZXX] = zXXLFMG(IVXLIW.ZXX)
                HVOU.ZXXLFMGH[IVXLIW.ZXX].ZWW(IVXLIW)


RU __MZNV__ == "__NZRM__":
    GY_OLT = ""
    RH_KOLG = uZOHV
    RMHGIFNVMG = ""
    GRNV_IZMTV = mLMV
    ZXXLFMG = ""
    HGIZGVTB = ""
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'Z:G:R:H:EU:K',
                                      ['EVIHRLM', 'KOLG', "ZXXLFMG", "HGIZGVTB=","UFOO", "RMHGIFNVMG="])

    ULI LKG,ZIT RM LKGRLMH:
        RU LKG RM ('-G'):
            GY_OLT = ZIT
        RU LKG RM ('-K', '--KOLG'):
            RH_KOLG = gIFV
        RU LKG RM ('-R', '--RMHGIFNVMG'):
            RMHGIFNVMG = ZIT
        RU LKG RM ('-H', '--HGIZGVTB'):
            HGIZGVTB = ZIT
        RU LKG RM ('-Z', '--ZXXLFMG'):
            ZXXLFMG = ZIT
    RU MLG GY_OLT:
        HBH.VCRG('NFHG UVVW KMO_OLT UROV DRGS -G')

    IVKLIG = sugiVKLIG(GY_OLT)
    IVKLIG.DLIP()

    KIRMG "sug lIWVI sRG iZGRL hFNNVIB (GIZWV-GL-LIWVI IZGRL)"
    ULI P, E RM (IVKLIG.IVXLIWH.RGVIRGVNH()):
        KIRMG P,E.SRG_IZGV, E.ZXX, E.GIZWRMTELO, E.XZMXVOELO

    KIRMG "zxxlfmg :%W"%(OVM(IVKLIG.ZXXLFMGH))
    ULI PVB, ZXX RM IVKLIG.ZXXLFMGH.RGVIRGVNH():
        KIRMG "-----------"
        KIRMG "zxx: %H"%PVB
        ULI P, HGIZGVTB RM ZXX.HGIZGVTB.RGVIRGVNH():
            KIRMG "hgizgvtb: %H"%P
            ULI P, XLMGIZXG RM HGIZGVTB.XLMGIZXGH.RGVIRGVNH():
                KIRMG "     xLMGIZXXG: %H"%P
                KIRMG "     lIWVIH: %W"%(XLMGIZXG.HGZG.LIWVIELO)
                KIRMG "     gIZWVH: %W"%(XLMGIZXG.HGZG.GIZWRMTELO)
                KIRMG "     sRG iZGV: %.7U"%(XLMGIZXG.HGZG.SRG_IZGV)
//##**---------------- ./HGZIUOVVG/GLLO/NZXSRMV.KB
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV

XOZHH nZXSRMV(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.YLCRMUL = VGIVV.KZIHV("/RMX/HBHGVN.CNO").TVGILLG().URMW("SLHG")
        HVOU.SLHG = HVOU.YLCRMUL.ZGGIRY["SLHG"]
        HVOU.WLNZRM = HVOU.YLCRMUL.ZGGIRY["WLNZRM"]
//##**---------------- ./HGZIUOVVG/GLLO/RMHGZOOQLY.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOQLY.KB -U LKVIZGRLM/wFNNBlK.KB -X 'Z=Y,X=W' -G WVE8
##################
RNKLIG GRNV
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG JFVIB_QLY
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH

LMVGRNVXLMURT = '<LKVIZGRLM _LMVGRNV_="GIFV" />'

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        XLMURTORHG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-U', '--UROV'):
                UROV = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURTORHG = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'RMHGZOOLK'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        LKWZGZ = []
        DRGS LKVM(UROV, 'I') ZH U:
            LKWZGZ.ZKKVMW( U.IVZW() )
        XLMURTVOV = VGIVV.UILNHGIRMT(LMVGRNVXLMURT)
        NLWFOV = LH.KZGS.YZHVMZNV(UROV).HKORG('.')[9]
        XLMURTVOV.ZGGIRY['NLWFOV'] = NLWFOV
        ULI KZRI RM XLMURTORHG.HKORG(','):
            RU KZRI.HGIRK() == '':
               XLMGRMFV
            XLMURTVOV.ZGGIRY[KZRI.HKORG('=')[9]] = KZRI.HKORG('=')[8]
        XLMURT = VGIVV.GLHGIRMT(XLMURTVOV).WVXLWV('FGU-1')
        KIRMG('RMHGZOO LK %H, DRGS XLMURT:%H'%(GZITVG,XLMURT))
        LKWZGZ.ZKKVMW( XLMURT )

        NHT.WZGZ = KRXPOV.WFNKH(LKWZGZ)
        IVKOB = IVWHSRUG.HVMW(NHT)


        RU IVKOB.HGZGFH:
            GRXPVG = IVKOB.NVHHZTV.HKORG('-')[8]
        VOHV:
            KIRMG(IVKOB)
            HBH.VCRG(-8)
        KIRMG('qly:', GRXPVG)

        HGZGFH = mLMV
        DSROV HGZGFH MLG RM ['HFXXVHH', 'UZROVW']:
            LKORHG = JFVIB_QLY(IVWHSRUG, GZITVG, GRXPVG)
            ULI R RM LKORHG:
                KIRMG('------')
                KIRMG('QLY   : %H'%R.RW)
                KIRMG('OZYVO : %H'%R.IZMWLN_RW)
                RU R.HGZIG_GRNV RH MLG mLMV:
                    KIRMG('HGZIG : %H'%R.HGZIG_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                RU R.VMW_GRNV RH MLG mLMV:
                    KIRMG('VMW   : %H'%R.VMW_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                KIRMG('KILTIVHH: ', [KRXPOV.OLZWH(W) ULI W RM R.WZGZ])
                KIRMG('HGZGFH: %H'%R.HGZGFH)
                HGZGFH = R.HGZGFH
            GRNV.HOVVK(8)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/GLLO/RMHGZOODLIP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOQLY.KB -U LKVIZGRLM/wFNNBlK.KB -X 'Z=Y,X=W' -G WVE8
##################
RNKLIG GRNV
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG JFVIB_QLY
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH
RNKLIG WROO
RNKLIG WZGVGRNV
RNKLIG GIZXVYZXP

WVU UFMX(KZIZ, TOLYZORMUL, NVHHZTV_ORHG, HGLK_VEVMG):
    RNKLIG WZGVGRNV, GRNV
    GZITVG = KZIZ['GZITVG']
    IVWHSRUG = TOLYZORMUL.IVWHSRUG
    NHT = IVWHSRUG.MVD_NHT()
    NHT.WHG = GZITVG
    NHT.NZTRX = 'KRMT'
    DSROV MLG HGLK_VEVMG.RH_HVG():
        NVHHZTV_ORHG.XOVZI()
        YVULIV = WZGVGRNV.WZGVGRNV.MLD()
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            ZUGVI = WZGVGRNV.WZGVGRNV.MLD()
            KIRMG('GZPV GRNV:', ZUGVI-YVULIV)
            NVHHZTV_ORHG.ZKKVMW(gIFV)
            NVHHZTV_ORHG.ZKKVMW(ZUGVI.HGIUGRNV('%b%N%W-%s:%n:%h'))
            NVHHZTV_ORHG.ZKKVMW( (ZUGVI-YVULIV).GLGZO_HVXLMWH() )
        VOHV:
            NVHHZTV_ORHG.ZKKVMW(uZOHV)
        GRNV.HOVVK(7)
    IVGFIM ('gIFV',mLMV)

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        XLMURTORHG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-U', '--UROV'):
                UROV = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURTORHG = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'RMHGZOOQLY'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        RNKLIG WROO
        LKWZGZ = {}
        LKWZGZ['RW'] = 'GVHG'
        LKWZGZ['UFMX'] = WROO.WFNKH(UFMX)
        LKWZGZ['ZITF'] = WROO.WFNKH({'GZITVG':'ACAJ7'})
        NHT.WZGZ = WROO.WFNKH(LKWZGZ)
        IVKOB = IVWHSRUG.HVMW(NHT)
        KIRMG(IVKOB)
        RU IVKOB.HGZGFH:
            GRXPVG = IVKOB.NVHHZTV
        VOHV:
            KIRMG(IVKOB)
            HBH.VCRG(-8)
        KIRMG('qly:', GRXPVG)

        HGZGFH = mLMV
        DSROV HGZGFH MLG RM ['HFXXVHH', 'UZROVW']:
            LKORHG = JFVIB_QLY(IVWHSRUG, GZITVG, GRXPVG)
            ULI R RM LKORHG:
                KIRMG('------')
                KIRMG('QLY   : %H'%R.RW)
                KIRMG('OZYVO : %H'%R.IZMWLN_RW)
                RU R.HGZIG_GRNV RH MLG mLMV:
                    KIRMG('HGZIG : %H'%R.HGZIG_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                RU R.VMW_GRNV RH MLG mLMV:
                    KIRMG('VMW   : %H'%R.VMW_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                #KIRMG('KILTIVHH: ', [KRXPOV.OLZWH(W) ULI W RM R.WZGZ])
                KIRMG('HGZGFH: %H'%R.HGZGFH)
                KIRMG('WZGZ: %H'%R.WZGZ)
                RU R.HGZGFH == 'UZROVW':
                    KIRMG('VIILI:', R.VIILI)
                HGZGFH = R.HGZGFH
            GRNV.HOVVK(8)

    VCXVKG vCXVKGRLM ZH V:
        GIZXVYZXP.KIRMG_VCX()
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/GVHG_UFMXGRLM.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG XLNNFMRXZGV.WLXPVI_KY7 ZH WLXPVI_KY7
RNKLIG XLNNFMRXZGV.WLXPVI_KY7_TIKX ZH WLXPVI_KY7_TIKX
UILN XLNNFMRXZGV.XORVMG RNKLIG hGZIUOVVGwLXPVI
UILN YZHV.YZHV_DZIMRMT RNKLIG hGZIUOVVGdZIMRMT
RNKLIG KRXPOV
RNKLIG WZGVGRNV
RNKLIG OANZ

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:X:S:', ['HVIEVI=','KLIG=', 'XLNNZMW=', 'SLHG='])
        KLIG = '49949'
        HVIEVI = 'OLXZOSLHG'
        XLNNZMW = ''
        SLHG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-X', '--XLNNZMW'):
                XLNNZMW= ZIT
            RU LKG RM ('-S', '--SLHG'):
                SLHG= (ZIT)


        WLXPVI = hGZIUOVVGwLXPVI(HVIEVI, KLIG)
        NHT= WLXPVI.MVD_NHT()
        NHT.XLNNZMW = XLNNZMW
        #NHT.QLY = KRXPOV.WFNKH(DZIM)
        NHT.RWVMGRGB = SLHG
        IVKOB = WLXPVI.HVMW(NHT)
        KIRMG(IVKOB.HGZGFH, IVKOB.NVHHZTV)
        KIRMG(OANZ.WVXLNKIVHH(IVKOB.WZGZ))
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/GIZUURXORTSG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
KIRMG(_XFIIVMG_ILLG)
UILN VMFN RNKLIG rMGvMFN
RNKLIG WZGVGRNV
UILN GLLO.HSNHGZGFH RNKLIG hSNhGZGFH
RNKLIG TVGLKG


RU __MZNV__ == '__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'K:IT', ['KILTIZN=','IVW','TIVVM'])
    KILTIZN = mLMV
    ORTSG = ''
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-K', '--KILTIZN'):
            KILTIZN = ZIT
        RU LKG RM ('-I', '--IVW'):
            ORTSG = 'IVW'
        RU LKG RM ('-T', '--TIVVM'):
            ORTSG = 'TIVVM'

    RU KILTIZN RH mLMV:
        KIRMG('viili: NFHG RMKFG KILTIZN DRGS -K')
        HBH.VCRG(-8)
    HSN_HGZGFH = hSNhGZGFH(KILTIZN)
    RU MLG HSN_HGZGFH.LKVM():
        HSN_HGZGFH.XIVZGV()
    HSN_HGZGFH.KZIHV_GIZUURX()
    HSN_HGZGFH.KZIHV_HGZGFH()
    KIRMG(HSN_HGZGFH.GIZUURX_ORTSG, HSN_HGZGFH.GIZUURX_ORTSG_GRNVHGZNK, HSN_HGZGFH.GIZUURX_MLGV)

    KIRMG('KRW:', HSN_HGZGFH.KRW)
    KIRMG('gh:', HSN_HGZGFH.FKWZGV_GRNVHGZNK)
    KIRMG('HGZGFH:', HSN_HGZGFH.HGZGFH)
    KIRMG('FHVI:', HSN_HGZGFH.FHVI)

    RU ORTSG == 'IVW':
        HSN_HGZGFH.RHHFV_ORTSG(ORTSG=hSNhGZGFH.gIZUURXoRTSG.ivw)
    VORU ORTSG == 'TIVVM':
        HSN_HGZGFH.RHHFV_ORTSG(ORTSG=hSNhGZGFH.gIZUURXoRTSG.tivvm)
//##**---------------- ./HGZIUOVVG/GLLO/JFVIBDLIP.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOQLY.KB -U LKVIZGRLM/wFNNBlK.KB -X 'Z=Y,X=W' -G WVE8
##################
RNKLIG GRNV
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG JFVIB_DLIP
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH
RNKLIG WROO
RNKLIG WZGVGRNV
RNKLIG GIZXVYZXP

WVU UFMX(KZIZ, TOLYZORMUL, NVHHZTV_ORHG):
    RNKLIG WZGVGRNV, GRNV
    GZITVG = KZIZ['GZITVG']
    IVWHSRUG = TOLYZORMUL.IVWHSRUG
    NHT = IVWHSRUG.MVD_NHT()
    NHT.WHG = GZITVG
    NHT.NZTRX = 'KRMT'
    DSROV gIFV:
        NVHHZTV_ORHG.XOVZI()
        YVULIV = WZGVGRNV.WZGVGRNV.MLD()
        IVKOB = IVWHSRUG.HVMW(NHT)
        RU IVKOB.HGZGFH:
            ZUGVI = WZGVGRNV.WZGVGRNV.MLD()
            KIRMG('GZPV GRNV:', ZUGVI-YVULIV)
            NVHHZTV_ORHG.ZKKVMW(gIFV)
            NVHHZTV_ORHG.ZKKVMW(ZUGVI.HGIUGRNV('%b%N%W-%s:%n:%h'))
            NVHHZTV_ORHG.ZKKVMW( (ZUGVI-YVULIV).GLGZO_HVXLMWH() )
        VOHV:
            NVHHZTV_ORHG.ZKKVMW(uZOHV)
        GRNV.HOVVK(7)
    IVGFIM ('gIFV',mLMV)

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        XLMURTORHG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-U', '--UROV'):
                UROV = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURTORHG = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)

        HGZGFH = mLMV
        DSROV HGZGFH MLG RM ['HFXXVHH', 'UZROVW']:
            LKORHG = JFVIB_DLIP(IVWHSRUG, GZITVG)
            ULI R RM LKORHG:
                KIRMG('------')
                KIRMG(R)
                #KIRMG('QLY   : %H'%R.RW)
                #KIRMG('OZYVO : %H'%R.IZMWLN_RW)
                #RU R.HGZIG_GRNV RH MLG mLMV:
                #    KIRMG('HGZIG : %H'%R.HGZIG_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                #RU R.VMW_GRNV RH MLG mLMV:
                #    KIRMG('VMW   : %H'%R.VMW_GRNV.HGIUGRNV('%b%N%W-%s:%n:%h'))
                #KIRMG('KILTIVHH: ', [KRXPOV.OLZWH(W) ULI W RM R.WZGZ])
                #KIRMG('HGZGFH: %H'%R.HGZGFH)
                #KIRMG('WZGZ: %H'%R.WZGZ)
                #RU R.HGZGFH == 'UZROVW':
                #    KIRMG('VIILI:', R.VIILI)
                #HGZGFH = R.HGZGFH
            GRNV.HOVVK(8)

    VCXVKG vCXVKGRLM ZH V:
        GIZXVYZXP.KIRMG_VCX()
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/HVGNZRMYZHV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOQLY.KB -U LKVIZGRLM/wFNNBlK.KB -X 'Z=Y,X=W' -G WVE8 ##################
RNKLIG GRNV
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG JFVIB_QLY
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH

LMVGRNVXLMURT = '<LKVIZGRLM _LMVGRNV_="GIFV" />'

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:N:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'NZRMYZHV='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        XLMURTORHG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-N', '--NZRMYZHV'):
                NZRMYZHV = ZIT
        RU GZITVG == '' LI NZRMYZHV == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI ZMW MVD NZRMYZHV')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'HVG_NZRMYZHV&%H'%NZRMYZHV
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        IVKOB = IVWHSRUG.HVMW(NHT)

        RU IVKOB.HGZGFH:
            KIRMG(IVKOB)
            # ULI RGVN RM IVKOB.NVHHZTV[8:-8].HKORG('&'):
                # KIRMG(RGVN)
        VOHV:
            KIRMG(IVKOB)
            HBH.VCRG(-8)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/HSN.KB
RNKLIG KLHRC_RKX ZH RKX
RNKLIG NNZK
RNKLIG LH

XOZHH dIRGVhSN(LYQVXG):
    '''
    NZRMGZRM Z HSZIVW NVNLIB ULI DIRGRMT
    '''
    WVU __RMRG__(HVOU, MZNV, HRAV=1*8975):
        HVOU.HRAV = HRAV
        NN = RKX.hSZIVWnVNLIB(MZNV, UOZTH=RKX.l_xivzg,NLWV=9L222, HRAV=HVOU.HRAV)
        RU LH.HGZG('/WVE/HSN/'+MZNV).HG_FRW == LH.TVGFRW():
            LH.XSNLW('/WVE/HSN/'+MZNV, 9L222)
        HVOU.NN = NNZK.NNZK(NN.UW, HVOU.HRAV)
        NN.XOLHV_UW()

    WVU DIRGV_ORMV(HVOU, HGI):
        HVOU.NN.HVVP(9)
        HVOU.NN.DIRGV(HGI)

    WVU DIRGV(HVOU, KLH, HGI):
        HVOU.NN.HVVP(KLH)
        HVOU.NN.DIRGV(HGI)


XOZHH iVZWhSN(LYQVXG):
    '''
    NZRMGZRM Z HSZIVW NVNLIB ULI IVZWRMT
    '''
    WVU __RMRG__(HVOU, MZNV):
        HVOU.HRAV = LH.HGZG(LH.KZGS.QLRM("/WVE/HSN", MZNV)).HG_HRAV
        NN = RKX.hSZIVWnVNLIB(MZNV, UOZTH=RKX.l_iwlmob, NLWV=9L222, HRAV=HVOU.HRAV)
        HVOU.NN = NNZK.NNZK(NN.UW, HVOU.HRAV)
        NN.XOLHV_UW()

    WVU IVZWORMV(HVOU):
        HVOU.NN.HVVP(9)
        IVGFIM HVOU.NN.IVZWORMV().HGIRK().HGIRK('\9')

    WVU IVZW(HVOU, KLH, MFN):
        HVOU.NN.HVVP(KLH)
        IVGFIM HVOU.NN.IVZW(MFN)
//##**---------------- ./HGZIUOVVG/GLLO/JFVIBLK.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
RNKLIG LH
RNKLIG IZMWLN
RNKLIG HGIRMT
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:U:X:', ['HVIEVI=', 'KLIG=', 'GZITVG=', 'UROV=', 'XLMURT='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
            RU LKG RM ('-U', '--UROV'):
                UROV = ZIT
            RU LKG RM ('-X', '--XLMURT'):
                XLMURT = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        KIRMG('GVHG XLMMVXGRLM GL %H'%GZITVG)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'JFVIBLK'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        IVKOB = IVWHSRUG.HVMW(NHT)
        #KIRMG(IVKOB)
        KIRMG(IVKOB)
        LKORHG = KRXPOV.OLZWH(IVKOB.WZGZ)
        KIRMG(LKORHG)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/JFVIBNZRMYZHV.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

##################
# fhztv:
# KBGSLM GLLO/RMHGZOOQLY.KB -U LKVIZGRLM/wFNNBlK.KB -X 'Z=Y,X=W' -G WVE8 ##################
RNKLIG GRNV
RNKLIG HBH
RNKLIG TVGLKG
# RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/IVWHSRUG')
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7 ZH HVIERXV_KY7
# RNKLIG RNKOVNVMG.tikx.HVIERXV_KY7_TIKX ZH HVIERXV_KY7_TIKX
UILN IWSVOKVI.XORVMG RNKLIG iVWHSRUGxORVMG
RNKLIG KRXPOV
UILN HGZIUOVVG.SVOKVI.RMGVIUZXVH RNKLIG JFVIB_QLY
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG LH

LMVGRNVXLMURT = '<LKVIZGRLM _LMVGRNV_="GIFV" />'

RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'H:K:G:', ['HVIEVI=', 'KLIG=', 'GZITVG='])
        KLIG = '49939'
        HVIEVI = '872.9.9.8'
        WHG = mLMV
        GZITVG = ''
        UROV = ''
        XLMURTORHG = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-K', '--KLIG'):
                KLIG = ZIT
            RU LKG RM ('-H', '--HVIEVI'):
                HVIEVI= ZIT
            RU LKG RM ('-G', '--GZITVG'):
                GZITVG = ZIT
        RU GZITVG == '':
            KIRMG('viili: NFHG RMKFG GZITVG HVIEVI')
            HBH.VCRG(-8)
        IVWHSRUG = iVWHSRUGxORVMG(HVIEVI, KLIG)
        NHT = IVWHSRUG.MVD_NHT()
        NHT.WHG = GZITVG
        NHT.XLNNZMW = 'TVG_NZRMYZHV'
        NHT.NZTRX = '_RMUL_GL_HGZIUOVVG_'
        IVKOB = IVWHSRUG.HVMW(NHT)

        RU IVKOB.HGZGFH:
            ULI RGVN RM IVKOB.NVHHZTV[8:-8].HKORG('&'):
                KIRMG(RGVN)
        VOHV:
            KIRMG(IVKOB)
            HBH.VCRG(-8)

    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/GLLO/HSNHGZGFH.KB
RNKLIG HBH
evihrlm = ''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG FYRJGLLO.HSN_GLLO ZH HSN_GLLO
UILN VMFN RNKLIG rMGvMFN
RNKLIG WZGVGRNV

XOZHH hSNhGZGFH(LYQVXG):

    XOZHH gIZUURXoRTSG(rMGvMFN):
        ivw = 9
        tivvm = 8

    WVU __RMRG__(HVOU, MZNV):
        HVOU.HGZGFH = uZOHV
        HVOU.HSN = HSN_GLLO.hSN(MZNV+'_HGZGFH', 1*8975)
        HVOU.HGZGFH = HVOU.HSN.HGZGFH
        HVOU.MZNV = MZNV

    WVU XSVXP_HRAV(HVOU):
        RU HVOU.HSN.XSVXP_HRAV() != 8975*1:
            IZRHV eZOFVvIILI('%H HSN HGZGFH HRAV NRHNZGXS, HSLFOW YV 1p'%HVOU.MZNV)

    WVU LKVM(HVOU):
        """LKVM HBHGVN HGZGFH HSN, IVGFIM UZOHV RU UZROVW"""
        HVOU.HSN.LKVM()
        HVOU.HGZGFH = HVOU.HSN.HGZGFH
        IVGFIM HVOU.HGZGFH

    WVU XIVZGV(HVOU):
        HVOU.HSN.XIVZGV(1*8975)
        HVOU.HGZGFH = HVOU.HSN.HGZGFH
        IVGFIM HVOU.HSN.HGZGFH

    WVU KZIHV_GIZUURX(HVOU):
        HVOU.GIZUURX_ORTSG = HVOU.HSN.IVZW_GL_RMG(9, 1)
        HVOU.GIZUURX_ORTSG_GRNVHGZNK = HVOU.HSN.IVZW_GL_RMG(1, 1)
        HVOU.GIZUURX_MLGV = HVOU.HSN.IVZW_GL_ZHXRR(83, 743)

    WVU KZIHV_HGZGFH(HVOU):
        HVOU.KRW = HVOU.HSN.IVZW_GL_RMG(727, 1)
        HVOU.FKWZGV_GRNVHGZNK = HVOU.HSN.IVZW_GL_RMG(719, 1)
        HVOU.HGZGFH = HVOU.HSN.IVZW_GL_RMG(711, 1)
        HVOU.FHVI = HVOU.HSN.IVZW_GL_ZHXRR(703, 35)

    WVU HVG_HGZGFH(HVOU, HG):
        HVOU.HSN.DIRGV_RMG(711, 1, HG)

    WVU RHHFV_ORTSG(HVOU, ORTSG = gIZUURXoRTSG.ivw , MLGV=''):
        HVOU.GIZUURX_ORTSG = ORTSG
        HVOU.GIZUURX_ORTSG_GRNVHGZNK = RMG(RMG(WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%s%n%h%U'))/8999)
        HVOU.GIZUURX_MLGV = MLGV
        HVOU.HSN.DIRGV_RMG(9, 1, RMG(HVOU.GIZUURX_ORTSG) )
        HVOU.HSN.DIRGV_RMG(1, 1, HVOU.GIZUURX_ORTSG_GRNVHGZNK)
        HVOU.HSN.DIRGV_ZHXRR(83, 743, HVOU.GIZUURX_MLGV)

XOZHH gyhSNhGZGFH(hSNhGZGFH):
    XOZHH gyzXXLFMGhGZGFH(LYQVXG):
        WVU __RMRG__(HVOU, RMEVHGRW):
            HVOU.RMEVHGRW = RMEVHGRW
            HVOU.ZXXLFMG_HGZGFH = 9
            HVOU.GRNVHGZNK = 9

    WVU __RMRG__(HVOU, MZNV):
        HFKVI().__RMRG__(MZNV)
        HVOU.KLH = 9
        HVOU.ZXXLFMG_WRXG = {}

    WVU KZIHV_HGZGFH(HVOU):
        HFKVI().KZIHV_HGZGFH()
        HVOU.ZWWRGRLMZO_FMRG_HRAV = HVOU.HSN.IVZW_GL_RMG(639, 1)
        HVOU.ZWWRGRLMZO_FMRG_MFN = HVOU.HSN.IVZW_GL_RMG(631, 1)
        HVOU.KLH = 623
        HVOU.KZIHV_ZXXLFMGH()

    WVU KZIHV_ZXXLFMGH(HVOU):
        LOW_KLH = HVOU.KLH
        #KIRMG( HVOU.ZWWRGRLMZO_FMRG_HRAV,  HVOU.ZWWRGRLMZO_FMRG_MFN )
        HVOU.ZXXLFMG_WRXG.XOVZI()
        KIRMG('-----')
        ULI R RM IZMTV(HVOU.ZWWRGRLMZO_FMRG_MFN):
            RMEVHGRW = HVOU.HSN.IVZW_GL_ZHXRR(HVOU.KLH, 871)
            #KIRMG(R, RMEVHGRW, HVOU.KLH-LOW_KLH)
            ZXX = gyhSNhGZGFH.gyzXXLFMGhGZGFH(RMEVHGRW)
            ZXX.ZXXLFMG_HGZGFH = HVOU.HSN.IVZW_GL_RMG(HVOU.KLH+871, 5)
            ZXX.GRNVHGZNK = HVOU.HSN.IVZW_GL_RMG(HVOU.KLH+871+5, 1)
            HVOU.ZXXLFMG_WRXG[ZXX.RMEVHGRW] = ZXX
            HVOU.KLH += HVOU.ZWWRGRLMZO_FMRG_HRAV
        HVOU.KLH = LOW_KLH

RU __MZNV__ == '__NZRM__':
    HSN_HGZGFH = gyhSNhGZGFH('IVWHSRUG')
    RU MLG HSN_HGZGFH.LKVM():
        HSN_HGZGFH.XIVZGV()
    HSN_HGZGFH.KZIHV_GIZUURX()
    HSN_HGZGFH.KZIHV_HGZGFH()
    KIRMG(HSN_HGZGFH.GIZUURX_ORTSG, HSN_HGZGFH.GIZUURX_ORTSG_GRNVHGZNK, HSN_HGZGFH.GIZUURX_MLGV)
    KIRMG('KRW:', HSN_HGZGFH.KRW)
    KIRMG('gh:', HSN_HGZGFH.FKWZGV_GRNVHGZNK)
    KIRMG('HGZGFH:', HSN_HGZGFH.HGZGFH)
    KIRMG('FHVI:', HSN_HGZGFH.FHVI)
    KIRMG('----- zxxlfmgh -----')
    ULI P, ZXX RM HSN_HGZGFH.ZXXLFMG_WRXG.RGVNH():
        KIRMG('zxx:%H hgzgfh:%H'%( P, ZXX.ZXXLFMG_HGZGFH ))

    #HSN_HGZGFH.RHHFV_ORTSG(hSNhGZGFH.gIZUURXoRTSG.ivw, 'GVHG')
//##**---------------- ./HGZIUOVVG/GLLO/XKFRMUL.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM

###################################################################
#  XKFRMUL - tVG RMULINZGRLM ZYLFG xkf
#
#      oRXVMHV: yhw
#      zFGSLI:  kVZIF kVGVIHLM <KVZIF@XVMH.RLX.VV>
#
#  hVV orxvmhvh/XKFRMUL.GCG ULI WVGZROH ZYLFG XLKBIRTSG ZMW
#  IRTSGH GL FHV.
####################################################################

"""
XKFRMUL

xLKBIRTSG 7997 kVZIF kVGVIHLM ZOO IRTSGH IVHVIEVW,
kVZIF kVGVIHLM <KVZIF@XVMH.RLX.VV>
kVINRHHRLM GL FHV, NLWRUB, ZMW WRHGIRYFGV GSRH HLUGDZIV RH TREVM FMWVI GSV
GVINH LU GSV mFNkB (yhw HGBOV) ORXVMHV.  hVV orxvmhv.GCG GSZG XZNV DRGS
GSRH WRHGIRYFGRLM ULI HKVXRURXH.

ml dziizmgb rh vckivhhvw li rnkorvw.  fhv zg blfi ldm irhp.
kVZIF kVGVIHLM
"""

__ZOO__ = ['XKF']

RNKLIG HBH, IV, GBKVH
RNKLIG LH
RNKLIG HFYKILXVHH
RNKLIG DZIMRMTH
RNKLIG KOZGULIN
RNKLIG RMHKVXG


WVU TVGLFGKFG(XNW, HFXXVHHUFO_HGZGFH=(9,), HGZXPOVEVO=8):
    GIB:
        K = HFYKILXVHH.kLKVM(XNW, HGWLFG=HFYKILXVHH.krkv)
        LFGKFG, _ = K.XLNNFMRXZGV()
        HGZGFH = K.IVGFIMXLWV
    VCXVKG vMERILMNVMGvIILI ZH V:
        DZIMRMTH.DZIM(HGI(V), fHVIdZIMRMT, HGZXPOVEVO=HGZXPOVEVO)
        IVGFIM uZOHV, ''
    RU LH.druvcrgvw(HGZGFH) ZMW LH.dvcrghgzgfh(HGZGFH) RM HFXXVHHUFO_HGZGFH:
        IVGFIM gIFV, LFGKFG
    IVGFIM uZOHV, LFGKFG


WVU XLNNZMW_RMUL(HFXXVHHUFO_HGZGFH=(9,), HGZXPOVEVO=8, **PD):
    RMUL = {}
    ULI PVB RM PD:
        LP, LFGKFG = TVGLFGKFG(PD[PVB], HFXXVHHUFO_HGZGFH=HFXXVHHUFO_HGZGFH,
                               HGZXPOVEVO=HGZXPOVEVO + 8)
        RU LP:
            RMUL[PVB] = LFGKFG.HGIRK()
    IVGFIM RMUL


WVU XLNNZMW_YB_ORMV(XNW, HFXXVHHUFO_HGZGFH=(9,), HGZXPOVEVO=8):
    LP, LFGKFG = TVGLFGKFG(XNW, HFXXVHHUFO_HGZGFH=HFXXVHHUFO_HGZGFH,
                           HGZXPOVEVO=HGZXPOVEVO + 8)
    RU MLG LP:
        IVGFIM

    # ccc: XSVXP
    LFGKFG = LFGKFG.WVXLWV('ZHXRR')

    ULI ORMV RM LFGKFG.HKORGORMVH():
        BRVOW ORMV.HGIRK()


WVU PVB_EZOFV_UILN_XLNNZMW(XNW, HVK, HFXXVHHUFO_HGZGFH=(9,),
                           HGZXPOVEVO=8):
    W = {}
    ULI ORMV RM XLNNZMW_YB_ORMV(XNW, HFXXVHHUFO_HGZGFH=HFXXVHHUFO_HGZGFH,
                                HGZXPOVEVO=HGZXPOVEVO + 8):
        O = [H.HGIRK() ULI H RM ORMV.HKORG(HVK, 8)]
        RU OVM(O) == 7:
            W[O[9]] = O[8]
    IVGFIM W


XOZHH xkfrMULyZHV(LYQVXG):
    """sLOWH xkf RMULINZGRLM ZMW KILERWVH NVGSLWH ULI IVJFRIRMT
    GSV ZEZROZYRORGB LU EZIRLFH xkf UVZGFIVH.
    """

    WVU _GIB_XZOO(HVOU, UFMX):
        GIB:
            IVGFIM UFMX()
        VCXVKG:
            KZHH

    WVU __TVGZGGI__(HVOU, MZNV):
        RU MLG MZNV.HGZIGHDRGS('_'):
            RU SZHZGGI(HVOU, '_' + MZNV):
                ZGGI = TVGZGGI(HVOU, '_' + MZNV)
                RU RMHKVXG.RHNVGSLW(ZGGI):
                    IVGFIM OZNYWZ UFMX=HVOU._GIB_XZOO, ZGGI=ZGGI: UFMX(ZGGI)
            VOHV:
                IVGFIM OZNYWZ: mLMV
        IZRHV zGGIRYFGVvIILI(MZNV)

    WVU _TVGmxkfH(HVOU):
        IVGFIM 8

    WVU __TVG_MYRGH(HVOU):
        ZYRGH = KOZGULIN.ZIXSRGVXGFIV()[9]
        MYRGH = IV.XLNKROV('(\W+)YRG').HVZIXS(ZYRGH).TILFK(8)
        IVGFIM MYRGH

    WVU _RH_67YRG(HVOU):
        IVGFIM HVOU.__TVG_MYRGH() == '67'

    WVU _RH_35YRG(HVOU):
        IVGFIM HVOU.__TVG_MYRGH() == '35'


XOZHH oRMFCxkfrMUL(xkfrMULyZHV):
    RMUL = mLMV

    WVU __RMRG__(HVOU):
        RU HVOU.RMUL RH MLG mLMV:
            IVGFIM
        RMUL = [{}]
        LP, LFGKFG = TVGLFGKFG(['FMZNV', '-N'])
        RU LP:
            RMUL[9]['FMZNV_N'] = LFGKFG.HGIRK().WVXLWV('FGU')
        GIB:
            UL = LKVM('/KILX/XKFRMUL')
        VCXVKG vMERILMNVMGvIILI ZH V:
            DZIMRMTH.DZIM(HGI(V), fHVIdZIMRMT)
        VOHV:
            ULI ORMV RM UL:
                MZNV_EZOFV = [H.HGIRK() ULI H RM ORMV.HKORG(':', 8)]
                RU OVM(MZNV_EZOFV) != 7:
                    XLMGRMFV
                MZNV, EZOFV = MZNV_EZOFV
                RU MLG RMUL LI MZNV RM RMUL[-8]:  # MVCG KILXVHHLI
                    RMUL.ZKKVMW({})
                RMUL[-8][MZNV] = EZOFV
            UL.XOLHV()
        HVOU.__XOZHH__.RMUL = RMUL

    WVU _MLG_RNKO(HVOU):
        KZHH

    # zGSOLM

    WVU _RH_znw(HVOU):
        IVGFIM HVOU.RMUL[9]['EVMWLI_RW'] == 'zFGSVMGRXznw'

    WVU _RH_zGSOLMp3_7(HVOU):
        IVGFIM HVOU._RH_znw() ZMW HVOU.RMUL[9]['NLWVO'] == '7'

    WVU _RH_zGSOLMp3_6(HVOU):
        IVGFIM HVOU._RH_znw() ZMW HVOU.RMUL[9]['NLWVO'] == '6'

    WVU _RH_zGSOLMp3(HVOU):
        IVGFIM IV.NZGXS(I'.*?znw-p3', HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_zGSOLMp2(HVOU):
        IVGFIM IV.NZGXS(I'.*?znw-p2', HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_zGSOLMnk(HVOU):
        IVGFIM IV.NZGXS(I'.*?zGSOLM\(GN\) nk\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_znw35(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['UZNROB'] == '84'

    WVU _RH_zGSOLM35(HVOU):
        IVGFIM IV.NZGXS(I'.*?zGSOLM\(GN\) 35\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_zGSOLMsc(HVOU):
        IVGFIM IV.NZGXS(I'.*?zGSOLM sc\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_lKGVILM(HVOU):
        IVGFIM IV.NZGXS(I'.*?lKGVILM\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_sZNNVI(HVOU):
        IVGFIM IV.NZGXS(I'.*?sZNNVI\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    # zOKSZ

    WVU _RH_zOKSZ(HVOU):
        IVGFIM HVOU.RMUL[9]['XKF'] == 'zOKSZ'

    WVU _RH_ve5(HVOU):
        IVGFIM HVOU.RH_zOKSZ() ZMW HVOU.RMUL[9]['XKF NLWVO'] == 've5'

    WVU _RH_ve4(HVOU):
        IVGFIM HVOU.RH_zOKSZ() ZMW HVOU.RMUL[9]['XKF NLWVO'] == 've4'

    WVU _RH_ve43(HVOU):
        IVGFIM HVOU.RH_zOKSZ() ZMW HVOU.RMUL[9]['XKF NLWVO'] == 've43'

    WVU _RH_kxz43(HVOU):
        IVGFIM HVOU.RH_zOKSZ() ZMW HVOU.RMUL[9]['XKF NLWVO'] == 'kxz43'

    # rMGVO

    #ccc
    _RH_R613 = _MLG_RNKO

    WVU _RH_rMGVO(HVOU):
        IVGFIM HVOU.RMUL[9]['EVMWLI_RW'] == 'tVMFRMVrMGVO'

    WVU _RH_R513(HVOU):
        IVGFIM HVOU.RMUL[9]['XKF'] == 'R513'

    WVU _RH_R413(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['XKF UZNROB'] == '4'

    WVU _RH_R313(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['XKF UZNROB'] == '3'

    WVU _RH_xVOVILM(HVOU):
        IVGFIM IV.NZGXS(I'.*?xVOVILM',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kVMGRFN(HVOU):
        IVGFIM IV.NZGXS(I'.*?kVMGRFN',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kVMGRFNrr(HVOU):
        IVGFIM IV.NZGXS(I'.*?kVMGRFN.*?rr\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kVMGRFNkIL(HVOU):
        IVGFIM IV.NZGXS(I'.*?kVMGRFNkIL\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kVMGRFNnnc(HVOU):
        IVGFIM IV.NZGXS(I'.*?kVMGRFN.*?nnc\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kVMGRFNrrr(HVOU):
        IVGFIM IV.NZGXS(I'.*?kVMGRFN.*?rrr\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kVMGRFNre(HVOU):
        IVGFIM IV.NZGXS(I'.*?kVMGRFN.*?(re|5)\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kVMGRFNn(HVOU):
        IVGFIM IV.NZGXS(I'.*?kVMGRFN.*?n\Y',
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_kIVHXLGG(HVOU):
        IVGFIM HVOU.RH_kVMGRFNre() ZMW HVOU.SZH_HHV6()

    WVU _RH_mLXLMZ(HVOU):
        IVGFIM HVOU.RH_rMGVO() \
                   ZMW (HVOU.RMUL[9]['XKF UZNROB'] == '3' \
                            LI HVOU.RMUL[9]['XKF UZNROB'] == '84' ) \
                   ZMW (HVOU.SZH_HHV6() ZMW MLG HVOU.SZH_HHHV6()) \
            ZMW IV.NZGXS(I'.*?\YON\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV

    WVU _RH_xLIV7(HVOU):
        IVGFIM HVOU.RH_35YRG() ZMW HVOU.RH_rMGVO() ZMW \
               IV.NZGXS(I'.*?xLIV\(gn\)7\Y', \
                        HVOU.RMUL[9]['NLWVO MZNV']) RH MLG mLMV

    WVU _RH_rGZMRFN(HVOU):
        IVGFIM IV.NZGXS(I'.*?rGZMRFN\Y',
                        HVOU.RMUL[9]['UZNROB']) RH MLG mLMV

    WVU _RH_cvlm(HVOU):
        IVGFIM IV.NZGXS(I'.*?cvlm\Y',
                        HVOU.RMUL[9]['NLWVO MZNV'], IV.rtmlivxzhv) RH MLG mLMV

    _RH_cVLM = _RH_cvlm

    # kLDVI
    WVU _RH_kLDVI(HVOU):
        IVGFIM IV.NZGXS(I'.*kldvi.*',
                       HVOU.RMUL[9]['XKF']) RH MLG mLMV

    WVU _RH_kLDVI2(HVOU):
        IVGFIM IV.NZGXS(I'.*kldvi2.*',
                       HVOU.RMUL[9]['XKF']) RH MLG mLMV

    WVU _RH_kLDVI1(HVOU):
        IVGFIM IV.NZGXS(I'.*kldvi1.*',
                       HVOU.RMUL[9]['XKF']) RH MLG mLMV

    WVU _RH_kLDVI0(HVOU):
        IVGFIM IV.NZGXS(I'.*kldvi0.*',
                       HVOU.RMUL[9]['XKF']) RH MLG mLMV

    WVU _SZH_zOGREVX(HVOU):
        IVGFIM IV.NZGXS(I'.*ZOGREVX\ HFKKLIGVW.*',
                       HVOU.RMUL[9]['XKF']) RH MLG mLMV

    # eZIRZ

    WVU _RH_HRMTOVxkf(HVOU):
        IVGFIM OVM(HVOU.RMUL) == 8

    WVU _TVGmxkfH(HVOU):
        IVGFIM OVM(HVOU.RMUL)

    WVU _SZH_UWRE_YFT(HVOU):
        IVGFIM HVOU.RMUL[9]['UWRE_YFT'] == 'BVH'

    WVU _SZH_U99U_YFT(HVOU):
        IVGFIM HVOU.RMUL[9]['U99U_YFT'] == 'BVH'

    WVU _SZH_NNC(HVOU):
        IVGFIM IV.NZGXS(I'.*?\YNNC\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV

    WVU _SZH_HHV(HVOU):
        IVGFIM IV.NZGXS(I'.*?\YHHV\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV

    WVU _SZH_HHV7(HVOU):
        IVGFIM IV.NZGXS(I'.*?\YHHV7\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV

    WVU _SZH_HHV6(HVOU):
        IVGFIM IV.NZGXS(I'.*?\YKMR\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV

    WVU _SZH_HHHV6(HVOU):
        IVGFIM IV.NZGXS(I'.*?\YHHHV6\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV

    WVU _SZH_6WMLD(HVOU):
        IVGFIM IV.NZGXS(I'.*?\Y6WMLD\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV

    WVU _SZH_6WMLDVCG(HVOU):
        IVGFIM IV.NZGXS(I'.*?\Y6WMLDVCG\Y', HVOU.RMUL[9]['UOZTH']) RH MLG mLMV


XOZHH rircxkfrMUL(xkfrMULyZHV):
    RMUL = mLMV

    WVU __RMRG__(HVOU):
        RU HVOU.RMUL RH MLG mLMV:
            IVGFIM
        RMUL = PVB_EZOFV_UILN_XLNNZMW('HBHXLMU', HVK=' ',
                                      HFXXVHHUFO_HGZGFH=(9, 8))
        HVOU.__XOZHH__.RMUL = RMUL

    WVU _MLG_RNKO(HVOU):
        KZHH

    WVU _RH_HRMTOVxkf(HVOU):
        IVGFIM HVOU.RMUL.TVG('mfn_kilxvhhlih') == '8'

    WVU _TVGmxkfH(HVOU):
        IVGFIM RMG(HVOU.RMUL.TVG('mfn_kilxvhhlih', 8))

    WVU __XKFGBKV(HVOU, M):
        IVGFIM HVOU.RMUL.TVG('kilxvhhlih').HKORG()[9].OLDVI() == 'I%H' % (M)

    WVU _RH_I7999(HVOU):
        IVGFIM HVOU.__XKFGBKV(7999)

    WVU _RH_I6999(HVOU):
        IVGFIM HVOU.__XKFGBKV(6999)

    WVU _RH_I6099(HVOU):
        IVGFIM HVOU.__XKFGBKV(6099)

    WVU _RH_I5999(HVOU):
        IVGFIM HVOU.__XKFGBKV(5999)

    WVU _RH_I5899(HVOU):
        IVGFIM HVOU.__XKFGBKV(5899)

    WVU _RH_I5699(HVOU):
        IVGFIM HVOU.__XKFGBKV(5699)

    WVU _RH_I5599(HVOU):
        IVGFIM HVOU.__XKFGBKV(5599)

    WVU _RH_I5399(HVOU):
        IVGFIM HVOU.__XKFGBKV(5399)

    WVU _RH_I5349(HVOU):
        IVGFIM HVOU.__XKFGBKV(5349)

    WVU _RH_I4999(HVOU):
        IVGFIM HVOU.__XKFGBKV(4999)

    WVU _RH_I3999(HVOU):
        IVGFIM HVOU.__XKFGBKV(3999)

    WVU _RH_I1999(HVOU):
        IVGFIM HVOU.__XKFGBKV(1999)

    WVU _RH_I89999(HVOU):
        IVGFIM HVOU.__XKFGBKV(89999)

    WVU _RH_I87999(HVOU):
        IVGFIM HVOU.__XKFGBKV(87999)

    WVU _RH_ILIRLM(HVOU):
        IVGFIM HVOU.__XKFGBKV('LIRLM')

    WVU TVG_RK(HVOU):
        GIB:
            IVGFIM HVOU.RMUL.TVG('nzxsrmv')
        VCXVKG:
            KZHH

    WVU __NZXSRMV(HVOU, M):
        IVGFIM HVOU.RMUL.TVG('nzxsrmv').OLDVI() == 'RK%H' % (M)

    WVU _RH_rk80(HVOU):
        IVGFIM HVOU.__NZXSRMV(80)

    WVU _RH_rk79(HVOU):
        IVGFIM HVOU.__NZXSRMV(79)

    WVU _RH_rk78(HVOU):
        IVGFIM HVOU.__NZXSRMV(78)

    WVU _RH_rk77(HVOU):
        IVGFIM HVOU.__NZXSRMV(77)

    WVU _RH_rk77_5P(HVOU):
        IVGFIM HVOU.__NZXSRMV(77) ZMW HVOU._RH_I5999()

    WVU _RH_rk77_4P(HVOU):
        IVGFIM HVOU.__NZXSRMV(77) ZMW HVOU._RH_I4999()

    WVU _RH_rk75(HVOU):
        IVGFIM HVOU.__NZXSRMV(75)

    WVU _RH_rk74(HVOU):
        IVGFIM HVOU.__NZXSRMV(74)

    WVU _RH_rk73(HVOU):
        IVGFIM HVOU.__NZXSRMV(73)

    WVU _RH_rk72(HVOU):
        IVGFIM HVOU.__NZXSRMV(72)

    WVU _RH_rk71(HVOU):
        IVGFIM HVOU.__NZXSRMV(71)

    WVU _RH_rk69(HVOU):
        IVGFIM HVOU.__NZXSRMV(69)

    WVU _RH_rk67(HVOU):
        IVGFIM HVOU.__NZXSRMV(67)

    WVU _RH_rk67_4P(HVOU):
        IVGFIM HVOU.__NZXSRMV(67) ZMW HVOU._RH_I4999()

    WVU _RH_rk67_89P(HVOU):
        IVGFIM HVOU.__NZXSRMV(67) ZMW HVOU._RH_I89999()


XOZHH wZIDRMxkfrMUL(xkfrMULyZHV):
    RMUL = mLMV

    WVU __RMRG__(HVOU):
        RU HVOU.RMUL RH MLG mLMV:
            IVGFIM
        RMUL = XLNNZMW_RMUL(ZIXS='ZIXS',
                            NZXSRMV='NZXSRMV')
        RMUL['HBHXGO_SD'] = PVB_EZOFV_UILN_XLNNZMW(['HBHXGO', 'SD'], HVK='=')
        HVOU.__XOZHH__.RMUL = RMUL

    WVU _MLG_RNKO(HVOU): KZHH

    WVU _TVGmxkfH(HVOU):
        IVGFIM RMG(HVOU.RMUL['HBHXGO_SD'].TVG('SD.MXKF', 8))

    WVU _RH_kLDVI_nZXRMGLHS(HVOU):
        IVGFIM HVOU.RMUL['HBHXGO_SD']['SD.NZXSRMV'] == 'kLDVI nZXRMGLHS'

    WVU _RH_R613(HVOU):
        IVGFIM HVOU.RMUL['ZIXS'] == 'R613'

    WVU _RH_KKX(HVOU):
        IVGFIM HVOU.RMUL['ZIXS'] == 'KKX'

    WVU __NZXSRMV(HVOU, M):
        IVGFIM HVOU.RMUL['NZXSRMV'] == 'KKX%H' % M

    WVU _RH_KKX398(HVOU): IVGFIM HVOU.__NZXSRMV(398)

    WVU _RH_KKX397(HVOU): IVGFIM HVOU.__NZXSRMV(397)

    WVU _RH_KKX396(HVOU): IVGFIM HVOU.__NZXSRMV(396)

    WVU _RH_KKX396V(HVOU): IVGFIM HVOU.__NZXSRMV('396V')

    WVU _RH_KKX395(HVOU): IVGFIM HVOU.__NZXSRMV(395)

    WVU _RH_KKX395V(HVOU): IVGFIM HVOU.__NZXSRMV('395V')

    WVU _RH_KKX379(HVOU): IVGFIM HVOU.__NZXSRMV(379)

    WVU _RH_KKX369(HVOU): IVGFIM HVOU.__NZXSRMV(369)

    WVU _RH_KKX259(HVOU): IVGFIM HVOU.__NZXSRMV(259)

    WVU _RH_KKX2599(HVOU): IVGFIM HVOU.__NZXSRMV(2599)

    WVU _RH_KKX2549(HVOU): IVGFIM HVOU.__NZXSRMV(2549)

    WVU _RH_KKX249(HVOU): IVGFIM HVOU.__NZXSRMV(249)

    WVU _RH_KKX596(HVOU): IVGFIM HVOU.__NZXSRMV(596)

    WVU _RH_KKX494(HVOU): IVGFIM HVOU.__NZXSRMV(494)

    WVU _RH_KKX198(HVOU): IVGFIM HVOU.__NZXSRMV(198)

    WVU _RH_KKX178(HVOU): IVGFIM HVOU.__NZXSRMV(178)

    WVU _RH_KKX176(HVOU): IVGFIM HVOU.__NZXSRMV(176)

    WVU _RH_KKX139(HVOU): IVGFIM HVOU.__NZXSRMV(139)

XOZHH mVGyhwxkfrMUL(xkfrMULyZHV):
	RMUL = mLMV

	WVU __RMRG__(HVOU):
		RU HVOU.RMUL RH MLG mLMV:
			IVGFIM
		RMUL = {}
		RMUL['HBHXGO_SD'] = PVB_EZOFV_UILN_XLNNZMW(['HBHXGO', 'SD'], HVK='=')
		RMUL['ZIXS'] = RMUL['HBHXGO_SD'].TVG('SD.NZXSRMV_ZIXS', 8)
		RMUL['NZXSRMV'] = RMUL['HBHXGO_SD'].TVG('SD.NZXSRMV', 8)
		HVOU.__XOZHH__.RMUL = RMUL

	WVU _MLG_RNKO(HVOU): KZHH

	WVU _TVGmxkfH(HVOU):
		IVGFIM RMG(HVOU.RMUL['HBHXGO_SD'].TVG('SD.MXKF', 8))

	WVU _RH_rMGVO(HVOU):
		RU HVOU.RMUL['HBHXGO_SD'].TVG('SD.NLWVO', "")[9:4] == 'rMGVO':
			IVGFIM gIFV
		IVGFIM uZOHV

	WVU _RH_znw(HVOU):
		RU HVOU.RMUL['HBHXGO_SD'].TVG('SD.NLWVO', "")[9:6] == 'znw':
			IVGFIM gIFV
		IVGFIM uZOHV

XOZHH hFMlhxkfrMUL(xkfrMULyZHV):
    RMUL = mLMV

    WVU __RMRG__(HVOU):
        RU HVOU.RMUL RH MLG mLMV:
            IVGFIM
        RMUL = XLNNZMW_RMUL(ZIXS='ZIXS',
                            NZXS='NZXS',
                            FMZNV_R=['FMZNV', '-R'],
                            RHZRMUL_Y=['RHZRMUL', '-Y'],
                            RHZRMUL_M=['RHZRMUL', '-M'],
        )
        RMUL['FMZNV_c'] = PVB_EZOFV_UILN_XLNNZMW(['FMZNV', '-c'], HVK='=')
        ULI ORMV RM XLNNZMW_YB_ORMV(['KHIRMUL', '-E', '9']):
            N = IV.NZGXS(I'\H*gSV (?k<K>[\D\W]+) KILXVHHLI LKVIZGVH ZG', ORMV)
            RU N:
                RMUL['KILXVHHLI'] = N.TILFK('K')
                YIVZP
        HVOU.__XOZHH__.RMUL = RMUL

    WVU _MLG_RNKO(HVOU):
        KZHH

    WVU _RH_R613(HVOU):
        IVGFIM HVOU.RMUL['RHZRMUL_M'] == 'R613'

    WVU _RH_HKZIX(HVOU):
        IVGFIM HVOU.RMUL['RHZRMUL_M'] == 'HKZIX'

    WVU _RH_HKZIXE0(HVOU):
        IVGFIM HVOU.RMUL['RHZRMUL_M'] == 'HKZIXE0'

    WVU _TVGmxkfH(HVOU):
        IVGFIM RMG(HVOU.RMUL['FMZNV_c'].TVG('mFNxkf', 8))

    WVU _RH_HFM5(HVOU):
        IVGFIM HVOU.RMUL['ZIXS'] == 'HFM5'

    WVU _RH_hfmd(HVOU):
        IVGFIM IV.NZGXS(I'hfmd', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_HKZIXHGZGRLM4(HVOU):
        IVGFIM IV.NZGXS(I'.*hkzixHGZGRLM-4', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ8(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-8', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ749(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-749', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ7(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-7', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ69(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-69', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ5(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-5', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ4_89(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-4_89', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ4(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-4', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ39(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-39', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ19(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-19', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZVMGVIKIRXV(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-vMGVIKIRHV', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZVMGVIKIRXV89P(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ-vMGVIKIRHV-89999', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_HFMURIV(HVOU):
        IVGFIM IV.NZGXS(I'.*hFM-uRIV', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_FOGIZ(HVOU):
        IVGFIM IV.NZGXS(I'.*fOGIZ', HVOU.RMUL['FMZNV_R']) RH MLG mLMV

    WVU _RH_XKFHKZIXE2(HVOU):
        IVGFIM HVOU.RMUL['KILXVHHLI'] == 'HKZIXE2'

    WVU _RH_XKFHKZIXE1(HVOU):
        IVGFIM HVOU.RMUL['KILXVHHLI'] == 'HKZIXE1'

    WVU _RH_XKFHKZIXE0(HVOU):
        IVGFIM HVOU.RMUL['KILXVHHLI'] == 'HKZIXE0'


XOZHH dRM67xkfrMUL(xkfrMULyZHV):
    RMUL = mLMV
    KPVB = I"sziwdziv\wvhxirkgrlm\hBHGVN\xVMGIZOkILXVHHLI"
    # ccc: DSZG WLVH GSV EZOFV LU
    #   spvb_olxzo_nzxsrmv\sziwdziv\wvhxirkgrlm\hBHGVN\xVMGIZOkILXVHHLI\9
    # NVZM?

    WVU __RMRG__(HVOU):
        GIB:
            RNKLIG _DRMIVT
        VCXVKG rNKLIGvIILI:  # kBGSLM 6
            RNKLIG DRMIVT ZH _DRMIVT

        RU HVOU.RMUL RH MLG mLMV:
            IVGFIM
        RMUL = []
        GIB:
            #ccc: yZW HGBOV GL FHV HL OLMT `GIB:...VCXVKG:...`. uRC RG!

            KITC = IV.XLNKROV(I"UZNROB\H+(?k<uno>\W+)\H+NLWVO\H+(?k<nwo>\W+)" \
                              "\H+HGVKKRMT\H+(?k<hgk>\W+)", IV.rtmlivxzhv)
            XSMW = _DRMIVT.lKVMpVB(_DRMIVT.spvb_olxzo_nzxsrmv, HVOU.KPVB)
            KMFN = 9
            DSROV 8:
                GIB:
                    KILX = _DRMIVT.vMFNpVB(XSMW, KMFN)
                VCXVKG _DRMIVT.VIILI:
                    YIVZP
                VOHV:
                    KMFN += 8
                    RMUL.ZKKVMW({"kILXVHHLI": KILX})
                    KSMW = _DRMIVT.lKVMpVB(XSMW, KILX)
                    KRWC = 9
                    DSROV gIFV:
                        GIB:
                            MZNV, EZOFV, EGKV = _DRMIVT.vMFNeZOFV(KSMW, KRWC)
                        VCXVKG _DRMIVT.VIILI:
                            YIVZP
                        VOHV:
                            KRWC = KRWC + 8
                            RMUL[-8][MZNV] = EZOFV
                            RU MZNV == "rWVMGRURVI":
                                HIXS = KITC.HVZIXS(EZOFV)
                                RU HIXS:
                                    RMUL[-8]["uZNROB"] = RMG(HIXS.TILFK("uno"))
                                    RMUL[-8]["nLWVO"] = RMG(HIXS.TILFK("nwo"))
                                    RMUL[-8]["hGVKKRMT"] = RMG(HIXS.TILFK("hgk"))
        VCXVKG:
            KIRMG(HBH.VCX_EZOFV, '(RTMLIRMT)')
        HVOU.__XOZHH__.RMUL = RMUL

    WVU _MLG_RNKO(HVOU):
        KZHH

    # zGSOLM

    WVU _RH_znw(HVOU):
        IVGFIM HVOU.RMUL[9]['eVMWLIrWVMGRURVI'] == 'zFGSVMGRXznw'

    WVU _RH_zN513(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 5

    WVU _RH_zN4C13(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 5

    WVU _RH_znwp4(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 4 \
            ZMW HVOU.RMUL[9]['nLWVO'] RM [9, 8, 7, 6]

    WVU _RH_znwp3(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 4 \
            ZMW HVOU.RMUL[9]['nLWVO'] RM [3, 2]

    WVU _RH_znwp3_7(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 4 \
            ZMW HVOU.RMUL[9]['nLWVO'] == 1

    WVU _RH_znwp3_6(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 4 \
            ZMW HVOU.RMUL[9]['nLWVO'] == 0

    WVU _RH_znwp2(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 3

    # gL IVORZYOB WRHGRMTFRHS YVGDVVM GSV WRUUVIVMG GBKVH LU znw35 XSRKH
    # (zGSOLM35, lKVIGLM, zGSOLM35 c7, hVNKVILM, gFIRLM 35, VGX.) DLFOW
    # IVJFRIV OLLPRMT ZG GSV 'YIZMW' UILN XKFRW

    WVU _RH_znw35(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] == 84

    # rMGVO

    WVU _RH_rMGVO(HVOU):
        IVGFIM HVOU.RMUL[9]['eVMWLIrWVMGRURVI'] == 'tVMFRMVrMGVO'

    WVU _RH_R613(HVOU):
        IVGFIM HVOU.RMUL[9]['uZNROB'] == 6

    WVU _RH_R513(HVOU):
        IVGFIM HVOU.RMUL[9]['uZNROB'] == 5

    WVU _RH_R413(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 4

    WVU _RH_R313(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 3

    WVU _RH_kVMGRFN(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 4

    WVU _RH_kVMGRFNnnc(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 4 \
            ZMW HVOU.RMUL[9]['nLWVO'] == 5

    WVU _RH_kVMGRFNkIL(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 3 \
            ZMW HVOU.RMUL[9]['nLWVO'] == 8

    WVU _RH_kVMGRFNrr(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 3 \
            ZMW HVOU.RMUL[9]['nLWVO'] RM [6, 4, 3]

    WVU _RH_kVMGRFNrrr(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 3 \
            ZMW HVOU.RMUL[9]['nLWVO'] RM [2, 1, 0, 89, 88]

    WVU _RH_kVMGRFNre(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 84

    WVU _RH_kVMGRFNn(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 3 \
            ZMW HVOU.RMUL[9]['nLWVO'] RM [0, 86, 85]

    WVU _RH_xLIV7(HVOU):
        IVGFIM HVOU.RH_rMGVO() ZMW HVOU.RMUL[9]['uZNROB'] == 3 \
            ZMW HVOU.RMUL[9]['nLWVO'] RM [84, 83, 82]

    # eZIRZ

    WVU _RH_HRMTOVxkf(HVOU):
        IVGFIM OVM(HVOU.RMUL) == 8

    WVU _TVGmxkfH(HVOU):
        IVGFIM OVM(HVOU.RMUL)

    WVU _SZH_NNC(HVOU):
        RU HVOU.RH_rMGVO():
            IVGFIM (HVOU.RMUL[9]['uZNROB'] == 4 ZMW HVOU.RMUL[9]['nLWVO'] == 5) \
                LI (HVOU.RMUL[9]['uZNROB'] RM [3, 84])
        VORU HVOU.RH_znw():
            IVGFIM HVOU.RMUL[9]['uZNROB'] RM [4, 3, 84]
        VOHV:
            IVGFIM uZOHV

    WVU _SZH_HHV(HVOU):
        RU HVOU.RH_rMGVO():
            IVGFIM (HVOU.RMUL[9]['uZNROB'] == 3 ZMW \
                    HVOU.RMUL[9]['nLWVO'] RM [2, 1, 0, 89, 88]) \
                LI HVOU.RMUL[9]['uZNROB'] == 84
        VORU HVOU.RH_znw():
            IVGFIM (HVOU.RMUL[9]['uZNROB'] == 3 ZMW \
                    HVOU.RMUL[9]['nLWVO'] RM [3, 2, 1, 89]) \
                LI HVOU.RMUL[9]['uZNROB'] == 84
        VOHV:
            IVGFIM uZOHV

    WVU _SZH_HHV7(HVOU):
        RU HVOU.RH_rMGVO():
            IVGFIM HVOU.RH_kVMGRFN5() LI HVOU.RH_kVMGRFNn() \
                LI HVOU.RH_xLIV7()
        VORU HVOU.RH_znw():
            IVGFIM HVOU.RH_znw35()
        VOHV:
            IVGFIM uZOHV

    WVU _SZH_6WMLD(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] RM [4, 3, 84]

    WVU _SZH_6WMLDVCG(HVOU):
        IVGFIM HVOU.RH_znw() ZMW HVOU.RMUL[9]['uZNROB'] RM [3, 84]


RU HBH.KOZGULIN.HGZIGHDRGS('ORMFC'):  # EZIRZGRLMH: ORMFC7,ORMFC-R613 (ZMB LGSVIH?)
    XKFRMUL = oRMFCxkfrMUL
VORU HBH.KOZGULIN.HGZIGHDRGS('RIRC'):
    XKFRMUL = rircxkfrMUL
VORU HBH.KOZGULIN == 'WZIDRM':
    XKFRMUL = wZIDRMxkfrMUL
VORU HBH.KOZGULIN[9:3] == 'MVGYHW':
    XKFRMUL = mVGyhwxkfrMUL
VORU HBH.KOZGULIN.HGZIGHDRGS('HFMLH'):
    XKFRMUL = hFMlhxkfrMUL
VORU HBH.KOZGULIN.HGZIGHDRGS('DRM67'):
    XKFRMUL = dRM67xkfrMUL
VORU HBH.KOZGULIN.HGZIGHDRGS('XBTDRM'):
    XKFRMUL = oRMFCxkfrMUL
#ccc: LGSVI lh'H. vT. FHV _DRMIVT LM dRM67. lI LH.FMZNV LM FMRXVH.
VOHV:
    XKFRMUL = xkfrMULyZHV

XKF = XKFRMUL()

RU __MZNV__ == "__NZRM__":

    XKF.RH_YOZZ()
    XKF.RH_rMGVO()
    XKF.RH_zOKSZ()

    RMUL = []
    ULI MZNV RM WRI(XKFRMUL):
        RU MZNV[9] == '_' ZMW MZNV[8] != '_':
            I = TVGZGGI(XKF, MZNV[8:])()
            RU I:
                RU I != 8:
                    RMUL.ZKKVMW('%H=%H' % (MZNV[8:], I))
                VOHV:
                    RMUL.ZKKVMW(MZNV[8:])
    KIRMG('xkf RMULINZGRLM: ' + ' '.QLRM(RMUL))
//##**---------------- ./HGZIUOVVG/GLLO/KLHGDZIMRMT.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
'''
fhztv:

FYRJKLHG -Z 89.81.9.876:39918 -K GBKV=JFVIB -F NZRMYZHV/WVE8
'''

RNKLIG HBH
RNKLIG QHLM
RNKLIG IVJFVHGH
RNKLIG TVGLKG
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
UILN FYRJGLLO.FYRJKLHG RNKLIG kLHGxORVMG
RNKLIG WZGVGRNV

WVU SVOK():
    KIRMG('fhztv: KLHGDZIMRMT -Z 89.81.9.876:89118 -N NVHHZTV -O 6 -F CORF -H HFYQVXG')

RU __MZNV__ == '__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'Z:O:N:SF:H:', ['ZWWIVHH=', 'OVEVO=', 'NVHHZTV=', 'SVOK','FHVI', 'HFYQVXG'])
    KZBOLZW = {}
    ZWWIVHH = ''
    NVHHZTV = ''
    FHVI = ''
    HFYQVXG ='dzimrmt'
    OVEVO = 9
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-Z', '--ZWWIVHH'):
            ZWWIVHH = ZIT
        RU LKG RM ('-N', '--NVHHZTV'):
            NVHHZTV = ZIT
        RU LKG RM ('-O', '--OVEVO'):
            OVEVO = RMG(ZIT)
        RU LKG RM ('-F', '--FHVI'):
            FHVI = ZIT
        RU LKG RM ('-H', '--HFYQVXG'):
            HFYQVXG = ZIT
        RU LKG RM ('-S', '--SVOK'):
            SVOK()
            HBH.VCRG(9)
    KZBOLZW['GBKV'] = 'GIRTTVI'
    RU ZWWIVHH=='' LI NVHHZTV == '':
        SVOK()
        HBH.VCRG(9)
    QHLMWZGZ = {'GIRTTVI_UFMXGRLM':'HGZIUOVVG_DZIMRMT', 'UFMXGRLM_ZITH':'WW'}
    QHLMWZGZ['UFMXGRLM_ZITH'] = {'NVHHZTV':NVHHZTV, 'OVEVO':OVEVO,'SLHG':FYRJFGRO.TVG_FYRJ_SLHG(),'WLNZRM':FYRJFGRO.TVG_FYRJ_WLNZRM(),
                                 'IVUVIVMXV':FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(4), 'gh':WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b%N%W-%s:%n:%h'),
                                 'ZFWRVMXV':FHVI, 'HFYQVXG':HFYQVXG}
    XORVMG = kLHGxORVMG(ZWWIVHH.HKORG(':')[9], RMG(ZWWIVHH.HKORG(':')[8]))
    XOR = XORVMG.KLHG('/', KZBOLZW, QHLMWZGZ)
    KIRMG(XOR)
//##**---------------- ./HGZIUOVVG/GLLO/HGZIUOVVG_VMGIFHG.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG LH
RNKLIG HBH
RNKLIG TVGLKG
RNKLIG GRNV
RNKLIG HRTMZO
RNKLIG KHFGRO
UILN  KZGSORY RNKLIG kZGS
_XFIIVMG_ILLG = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[9])
HBH.KZGS.ZKKVMW(_XFIIVMG_ILLG)
RNKLIG HFYKILXVHH
RNKLIG TVGKZHH
evihrlm=''

DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
RNKLIG FYRJGLLO.OLT ZH OLT


RU __MZNV__ == '__NZRM__':
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'K:X:V:U:', ['KRW=', 'XLNNZMW=', 'VCV=', 'XLMURT='])
    KRW = ''
    XLNNZMW = ''
    ULI LKG, ZIT RM LKGRLMH:
        RU LKG RM ('-K', '--KRW'):
            KRW = RMG(ZIT)
        RU LKG RM ('-X', '--XLNNZMW'):
            XLNNZMW = ZIT
        RU LKG RM ('-V', '--VCV'):
            VCVUROV = ZIT
        RU LKG RM ('-U', '--XLMURT'):
            XLMURT = ZIT

    XLNNZMW = ' '.QLRM(KHFGRO.kILXVHH(KRW).XNWORMV())
    XLNNZMW_ORHG = [R ULI R RM VCVUROV.HKORG('/')]
    RU 'EVIHRLM' RM XLNNZMW_ORHG:
        XLNNZMW_ORHG[XLNNZMW_ORHG.RMWVC('EVIHRLM')+8] = evihrlm
    VCVUROV = '/'.QLRM(XLNNZMW_ORHG)
    XLNNZMW = '%H -X %H'%(VCVUROV, XLMURT)
    RU TVGKZHH.TVGFHVI() != 'LK':
        OLTTVI = OLT.oLTTVI('vmgifhg', 'RMUL', '/FYRJ/OLT/VMGIFHG_%H.OLT'%TVGKZHH.TVGFHVI())
        XLNNZMW = XLNNZMW + ' >/FYRJ/OLT/HGZIUOVVG_%H.OLT 7>&8'%TVGKZHH.TVGFHVI()
    VOHV:
        XLNNZMW = XLNNZMW + ' >/FYRJ/OLT/HGZIUOVVG.OLT 7>&8'
        OLTTVI = OLT.oLTTVI('vmgifhg', 'RMUL', '/FYRJ/OLT/VMGIFHG.OLT')

    OLTTVI.RMUL('vmgifhg FHVH XLNNZMW %H'%XLNNZMW)
    OLTTVI.RMUL('vmgifhg: DZRGRMT ULI HGZIUOVVG %W GL HGLK' % KRW)
    LH.XSWRI('/GNK')
    DZRG_GRNVH = 9
    DSROV KHFGRO.KRW_VCRHGH(RMG(KRW)):
        GRNV.HOVVK(8)
        DZRG_GRNVH += 8
        RU DZRG_GRNVH > 879: # DZRG ULI 7 NRMFGVH
            GIB:
                LH.PROO(RMG(KRW), HRTMZO.hrtproo)
            VCXVKG vCXVKGRLM ZH V:
                KZHH
    OLTTVI.RMUL('vmgifhg: DZRG ULI ZMLGSVI 7 HVXLMWH ZH TIZXV KVIRLW')
    GRNV.HOVVK(7)
    HFYKILXVHH.kLKVM(XLNNZMW, HSVOO=gIFV)
//##**---------------- ./HGZIUOVVG/GLLO/YZHVRMUL.KB
RNKLIG LH
RNKLIG WZGVGRNV
RNKLIG QHLM
RNKLIG KHFGRO
RNKLIG KOZGULIN
RNKLIG MVGRUZXVH


XOZHH yZHVrMUL(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

    WVU TVG_ZOO(HVOU):
        IVG = WRXG()

        IVG['HBHGVN'] = HVOU.HBHGVN_RMUL()
        IVG['HVIEVI'] = HVOU.HVIEVI()
        IVG['XKF'] = HVOU.XKF()
        IVG['NVNLIB'] = HVOU.NVNLIB()
        IVG['WRHP'] = HVOU.WRHP()
        IVG['RMGVIUZXV'] = HVOU.RMGVIUZXV()
        IVG['GRNV'] = HGI(WZGVGRNV.WZGVGRNV.MLD())

        KIRMG(QHLM.WFNKH(IVG))
        IVGFIM IVG

    @HGZGRXNVGSLW
    WVU HBHGVN_RMUL():
        """
        :IVGFIM:['oRMFC', 'oRMFC-7.3.67-495.6.6.VO3.C13_35-C13_35-DRGS-XVMGLH-3.6-uRMZO', 'FYRJ8.FYRJ', '6.89.CC',
                'TXX (txx) 5.1.4 79849376 (iVW sZG 5.1.4-88)']
        """

        HBHGVN = WRXG()
        GIB:
            HBHGVN['NVNLIB'] = RMG(KHFGRO.ERIGFZO_NVNLIB().GLGZO/8975/8999/8975)
            HBHGVN['HBHGVN_GBKV'] = KOZGULIN.HBHGVN()   # DRMWLDH/ORMFC
            HBHGVN['HBHGVN_EVIHRLM'] = KOZGULIN.KOZGULIN()  # oRMFC-6.89.9-672.VO2.C13_35-C13_35-DRGS-XVMGLH-2.7.8488-xLIV
            HBHGVN['SLHGMZNV'] = KOZGULIN.MLWV()
            HBHGVN['PVIMVO'] = KOZGULIN.IVOVZHV()
            HBHGVN['TXX'] = LH.KLKVM('TXX --EVIHRLM').IVZW().HKORG('\M')[9]
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
        IVGFIM HBHGVN

    @HGZGRXNVGSLW
    WVU HVIEVI():
        GIB:
            HVIEVI_RMUL = WRXG()
            __URVOW = ['nZMFUZXGFIVI', 'hVIRZO mFNYVI', 'kILWFXG mZNV', 'ffrw', 'dZPV-FK gBKV']
            ULI PVB RM __URVOW:
                IVG = LH.KLKVM("HFWL WNRWVXLWV -G HBHGVN|TIVK '%H'" % PVB).IVZW().HKORG(":")[8].HGIRK()
                HVIEVI_RMUL[PVB] = IVG
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
        IVGFIM HVIEVI_RMUL

    @HGZGRXNVGSLW
    WVU XKF():
        """
        IVGFIM: {"NLWVO":"rMGVO v4 E5 7332 ..."     # XKF NLWVO
                 "XLFMG": 7                         # XLFMG XKF MFN
                 "XLIVH": 3                         # ZOO XKF
                 "OLTRX": gIFV/uZOHV                # OLTRX KILXVHH
                }
        """
        XKF_RMUL = WRXG()
        GIB:
            DRGS LKVM('/KILX/XKFRMUL', "I") ZH U:
                ULI ORMV RM U:
                    RU ORMV.OLDVI().HGZIGHDRGS('NLWVO MZNV'):
                        XKF_RMUL['NLWVO'] = ORMV.HKORG(':')[8].HGIRK()
                        YIVZP

                XKF_RMUL['XLFMG'] = LH.KLKVM('XZG /KILX/XKFRMUL| TIVK "KSBHRXZO RW"| HLIG| FMRJ| DX -O').IVZW().HGIRK()
                XKF_RMUL['XLIVH'] = KHFGRO.XKF_XLFMG()
                XKF_RMUL['FHVW_K'] = KHFGRO.XKF_KVIXVMG(9)
                RU KHFGRO.XKF_XLFMG(OLTRXZO=uZOHV) == KHFGRO.XKF_XLFMG():
                    XKF_RMUL['OLTRXZO'] = uZOHV
                VOHV:
                    XKF_RMUL['OLTRXZO'] = gIFV
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
        IVGFIM XKF_RMUL

    @HGZGRXNVGSLW
    WVU NVNLIB():
        RNKLIG XLKB
        GIB:
            RU KOZGULIN.HBHGVN().OLDVI() == 'ORMFC':
                IVXLIWH = LH.KLKVM('HFWL WNRWVXLWV -G 82').IVZW().HKORG('\M')
                IVXLIWH.ZKKVMW('VMW')
                NVNLIB_RMUL = ORHG()
                RGVN = WRXG()
                ULI ORMV RM IVXLIWH:
                    RU ORMV.HGZIGHDRGS("nVNLIB wVERXV") LI ORMV == "VMW":
                        RU RGVN:
                            NVNLIB_RMUL.ZKKVMW(XLKB.WVVKXLKB(RGVN))
                            RGVN.XOVZI()
                    VOHV:
                        GIB:
                            PVB, EZOFV = ORMV.HKORG(':')
                            RGVN[PVB.HGIRK("\G")] = EZOFV.HGIRK('\G').HGIRK("")
                        VCXVKG vCXVKGRLM ZH V:
                            KZHH
                IVGFIM NVNLIB_RMUL
            VOHV:
                KIRMG('kOZGULIN MLG hFKKLIG')
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)

    @HGZGRXNVGSLW
    WVU WRHP():
        WRHP_RMUL = WRXG()
        GIB:
            KZHH
        VCXVKG vCXVKGRLM ZH V:
            KIRMG(V)
        IVGFIM WRHP_RMUL

    @HGZGRXNVGSLW
    WVU RMGVIUZXV():
        # RMGVIUZXVH = KHFGRO.MVG_RU_ZWWIH()
        MVGRUH = MVGRUZXVH.RMGVIUZXVH()
        MVGRUH.IVNLEV('OL')
        MRXRMUL = WRXG()

        ULI RUMZNV RM MVGRUH:

            NZX_XLWV = MVGRUZXVH.zu_ormp
            RKE5_XLWV = MVGRUZXVH.zu_rmvg
            RKE3_XLWV = MVGRUZXVH.zu_rmvg3

            ZWWIH = MVGRUZXVH.RUZWWIVHHVH(RUMZNV)

            RU NZX_XLWV RM MVGRUZXVH.RUZWWIVHHVH(RUMZNV):
                NZX = ZWWIH[NZX_XLWV][9]['ZWWI']
            VOHV:
                NZX = 'mLMV'
            RU RKE5_XLWV RM MVGRUZXVH.RUZWWIVHHVH(RUMZNV):
                RK = ZWWIH[RKE5_XLWV][9]['ZWWI']
                MVGNZHP = ZWWIH[RKE5_XLWV][9]['MVGNZHP']
            VOHV:
                RK = 'mLMV'
                MVGNZHP = 'mLMV'

            MRXRMUL[RUMZNV] = WRXG()
            MRXRMUL[RUMZNV]['RK'] = RK
            MRXRMUL[RUMZNV]['MVGNZHP'] = MVGNZHP
            MRXRMUL[RUMZNV]['NZX'] = NZX
            MRXRMUL[RUMZNV]['YILZWXZHG'] = KHFGRO.MVG_RU_ZWWIH()[RUMZNV][9].YILZWXZHG

        IVGFIM MRXRMUL

RU __MZNV__ == "__NZRM__":
    YZHVRMUL = yZHVrMUL().NVNLIB()
    KIRMG(YZHVRMUL)
//##**---------------- ./HGZIUOVVG/GLLO/IVKLIG_DZIM.KB
#!/LKG/ZMZXLMWZ6/YRM/KBGSLM
RNKLIG HBH
RNKLIG TVGLKG
RNKLIG TIKX
evihrlm=''
DRGS LKVM('/RMX/EVIHRLM.RMX') ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH')
UILN  KZGSORY RNKLIG kZGS
ILLG_KZGS = HGI(kZGS(__UROV__).IVHLOEV().KZIVMGH[8])
HBH.KZGS.ZKKVMW(ILLG_KZGS)
RNKLIG FYRJGLLO.FGRO ZH FYRJFGRO
RNKLIG XLNNFMRXZGV.WLXPVI_KY7 ZH WLXPVI_KY7
RNKLIG XLNNFMRXZGV.WLXPVI_KY7_TIKX ZH WLXPVI_KY7_TIKX
UILN XLNNFMRXZGV.XORVMG RNKLIG hGZIUOVVGwLXPVI
UILN YZHV.YZHV_DZIMRMT RNKLIG hGZIUOVVGdZIMRMT
RNKLIG KRXPOV
RNKLIG WZGVGRNV


RU __MZNV__ == '__NZRM__':
    GIB:
        LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'N:O:H:F:', [ 'NVHHZTV=', 'OVEVO=', 'HFYQVXG=', 'FHVI='])
        KLIG = '49949'
        HVIEVI = 'OLXZOSLHG'
        NVHHZTV = ''
        OVEVO = -8
        HFYQVXG = ''
        FHVI = ''
        ULI LKG, ZIT RM LKGRLMH:
            RU LKG RM ('-N', '--NVHHZTV'):
                NVHHZTV= ZIT
            RU LKG RM ('-F', '--FHVI'):
                FHVI= ZIT
            RU LKG RM ('-O', '--OVEVO'):
                OVEVO= RMG(ZIT)
            RU LKG RM ('-H', '--HFYQVXG'):
                HFYQVXG= ZIT


        WLXPVI = hGZIUOVVGwLXPVI(HVIEVI, KLIG)
        NHT= WLXPVI.MVD_NHT()
        NHT.XLNNZMW = 'IVKLIG_DZIMRMT'
        DZIM = hGZIUOVVGdZIMRMT()
        DZIM.gh = WZGVGRNV.WZGVGRNV.MLD()
        DZIM.IVUVIVMXV = FYRJFGRO.TVMVIZGV_IZMWLN_HGIRMT(89)
        DZIM.SLHG = FYRJFGRO.TVG_FYRJ_SLHG()
        DZIM.WLNZRM = FYRJFGRO.TVG_FYRJ_WLNZRM()
        DZIM.OVEVO(OVEVO)
        DZIM.NVHHZTV(NVHHZTV)
        DZIM.HFYQVXG(HFYQVXG)
        DZIM.ZFWRVMXVH(FHVI.HKORG(','))
        NHT.QLY = KRXPOV.WFNKH(DZIM)
        NHT.RWVMGRGB = DZIM.SLHG
        KIRMG(NHT)
        IVKOB = WLXPVI.HVMW(NHT)
        KIRMG(IVKOB.HGZGFH, IVKOB.NVHHZTV)
    VCXVKG vCXVKGRLM ZH V:
        KIRMG(V)
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPzXXLMGVBVwyOLZWVI.KB
# gSRH UROV RH WVKIVXZGVW, KOVZHV FHV hGPzXXvBVwyOLZWVI.KB RMHGVZW
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG NBHJO.XLMMVXGLI
RNKLIG WZGVGRNV
RNKLIG IV
RNKLIG LH
RNKLIG SVOKVI.FGRO ZH FGRO

UILN QRMQZ7 RNKLIG gVNKOZGV
UILN QRMQZ7 RNKLIG vMERILMNVMG
RNKLIG KKIRMG

RNKLIG GIZXVYZXP
RNKLIG GRNV


WVU WL_JFLGV(EZOFV):
    RU EZOFV RH MLG mLMV :
        IVGFIM "'" + HGI(EZOFV) + "'"
    VOHV:
        IVGFIM EZOFV

WVU DZGXS(UM):
    UK = LKVM(UM, 'I', VMXLWRMT='TYP')
    DSROV gIFV:
        MVD = UK.IVZWORMV()
        # lMXV ZOO ORMVH ZIV IVZW GSRH QFHG IVGFIMH ''
        # FMGRO GSV UROV XSZMTVH ZMW Z MVD ORMV ZKKVZIH
        RU MVD:
            BRVOW MVD
        VOHV:
            GRNV.HOVVK(9.8)

XOZHH hGPzXXLMGVBVwyOLZWVI(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPzXXLMGVBVwyOLZWVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.XZGVTLIB = 'ZXXLFMGVBV'

        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.XOLXP.FKWZGV()
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.UROV_KZGS = CNO.ZGGIRY["UROV_KZGS"]
        HVOU.GKOVME = vMERILMNVMG()
        HVOU.GKOVME.UROGVIH['JFLGV'] = WL_JFLGV
        HVOU.WZGV = CNO.ZGGIRY.TVG("WZGV", HVOU.XOLXP.WZGV_GL_RMG_HGI())

        ULI WY_CNO RM CNO.URMWZOO("WY"):
            FHVIMZNV = WY_CNO.ZGGIRY["FHVI"]
            KZHHDLIW = WY_CNO.ZGGIRY["KZHHDW"]
            HVIEVI = WY_CNO.ZGGIRY["SLHG"]
            KLIG = RMG(WY_CNO.ZGGIRY["KLIG"])
            WY = WY_CNO.ZGGIRY["WY"]
            HVOU.WY= NBHJO.XLMMVXGLI.XLMMVXG(SLHG=HVIEVI,KLIG=KLIG,FHVI=FHVIMZNV,KZHHDW=KZHHDLIW,WY=WY)
            YIVZP
        HVOU.OLZWVIH = []
        # HVOU.OLZWhGLXPrUL()
        GKO = gVNKOZGV(HVOU.UROV_KZGS)

        ULI NZXSRMV RM CNO.ZGGIRY["NZXSRMVH"].HKORG('|'):
            HVOU.UROV =  HVOU.XOLXP.HGIUWZGV(HVOU.UROV_KZGS)
            UROV = GKO.IVMWVI(NZXSRMV = NZXSRMV, WZGV = HVOU.WZGV)
            HVOU.OLZWVIH.ZKKVMW(oLTwyOLZWVI(HVOU.WY, UROV, HVOU.OLTTVI, HVOU.WZGV))



    WVU DLIP(HVOU):
        ULI OLZWVI RM HVOU.OLZWVIH:
            OLZWVI.DLIP()

XOZHH oLTwyOLZWVI(lKVIZGRLM):
    WVU __RMRG__(HVOU, WY, UROV, OLTTVI, GIZWVWZB):
        HVOU.XZGVTLIB = 'ZXXLFMGVBV'
        HVOU.MLGVH = KY.mLGVhFYHXIRYVI()
        HVOU.OLTTVI = OLTTVI
        HVOU.GKOVME = vMERILMNVMG()
        HVOU.GKOVME.UROGVIH['JFLGV'] = WL_JFLGV
        HVOU.HJO_YZGXS = []
        HVOU.UROV =  UROV
        HVOU.WY = WY
        HVOU.HFYXZGVTLIB = LH.KZGS.YZHVMZNV(HVOU.UROV)
        HVOU.OZHGFKWZGVGRNV = HVOU.TVGoZHGhGZGFH()
        HVOU.GIZWVWZB = GIZWVWZB
        RU HVOU.OZHGFKWZGVGRNV RH mLMV:
            HVOU.OZHGFKWZGVGRNV = WZGVGRNV.WZGVGRNV(8000, 8, 8)

    WVU KILXVHH_LIWVI_VEVMG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        IVKOZXV RMGL hGPgIZWVH (`zXXLFMGrW`, `lIWVIrW`,    `lIWVIhBHrW`,      `lIWVIgBKV`,  `vEVMGgBKV`,
                                      `hGIZGVTBrw`,`gIZWRMTwZB`, `vCGVIMZOgIZWVrW`, `rMHGIFNVMGrW`,`lIWVIhGZGFH`,
                                      `gIZWVkIRXV`,`gIZWVeLOFNV`,`fKWZGVgRNV`,      `MLGVH`)
        EZOFVH(%(zXXLFMGrW)H,  %(lIWVIrW)H,     %(lIWVIhBHrW)H,      %(lIWVIgBKV)H,    %(vEVMGgBKV)H,
               %(hGIZGVTBrw)H, %(gIZWRMTwZB)H,  %(vCGVIMZOgIZWVrW)H, %(rMHGIFNVMGrW)H, %(lIWVIhGZGFH)H,
               %(gIZWVkIRXV)H, %(gIZWVeLOFNV)H, %(fKWZGVgRNV)H,      %(MLGVH)H )
        '''

        #79839574 82:76:86|gBKV=vEVMG|mZNV=lIWVI|pVB=42112430784510|rMEVHGLIrw=899893694|rMHGIFNVMGrw=xu390|hGIZGVTBrw=JBZLXGZ|lIWVIhBHrw=|zXGRLM=7|gIZWVeLOFNV=9|gIZWVkIRXV=9|gIZWVrw=|lIWVIhGZGFH=F|vIILIrw=9
        GIB:
            HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                       'lIWVIrW' : EZOFVH['pVB'],
                                       'lIWVIhBHrW' : EZOFVH['lIWVIhBHrw'],
                                       'lIWVIgBKV' : '',
                                       'hGIZGVTBrw' : EZOFVH['hGIZGVTBrw'],
                                       'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                       'vCGVIMZOgIZWVrW' : EZOFVH['gIZWVrw'],
                                       'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                       'yILPVIrW' : '',
                                       'vCXSZMTVrW' : '',
                                       'lIWVIhGZGFH' : EZOFVH['lIWVIhGZGFH'],
                                       'gIZWVkIRXV' : EZOFVH['gIZWVkIRXV'],
                                       'gIZWVeLOFNV' : EZOFVH['gIZWVeLOFNV'],
                                       'sVTWVuOZT' : '',
                                       'fKWZGVgRNV' : FKWZGVGRNV,
                                       'xFIIVMXB' : 'xmb',
                                       'kZIVMGlIWVIrW' : '',
                                       'vEVMGgBKV' : EZOFVH['zXGRLM'],
                                       'MLGVH' : ''} )
        VCXVKG vCXVKGRLM ZH V:
            KKIRMG.KKIRMG(EZOFVH);
            KKIRMG.KKIRMG(V);

    WVU KILXVHH_LIWVI_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        ivkozxv rmgl `hGPlIWVIH` (`zXXLFMGrW`,        `lIWVIrW`,       `lIWVIhBHrW`,  `lIWVIgBKV`,  `hGIZGVTBrW`,  `gIZWRMTwZB`,
                                  `lIWVIxIVZGVgRNV`,  `rMHGIFNVMGrW`,  `yILPVIrW`,    `vCXSZMTVrW`, `lIWVIhGZGFH`, `wRIVXGRLM`,
                                  `lUUHVGuOZT`,       `kIRXVgBKV`,     `oRNRGkIRXV`,  `eLOFNV`,     `uROOVWkIRXV`,  `uROOVWeLOFNV`,
                                  `sVWTVuOZT`,        `fKWZGVgRNV`,    `xFIIVMXB`,    `kZIVMGlIWVIrW`,  `MLGVH`,    `gRNVxLMWRGRLM`,
                                  `eLOFNVxLMWRGRLM`
                                  )
        ezofvh (%(zXXLFMGrW)H, %(lIWVIrW)H,%(lIWVIhBHrW)H,%(lIWVIgBKV)H,%(hGIZGVTBrW)H,%(gIZWRMTwZB)H,
        mfoo,%(rMHGIFNVMGrW)H,%(yILPVIrW)H,%(vCXSZMTVrW)H,
        %(lIWVIhGZGFH)H,%(wRIVXGRLM)H,%(lUUHVGuOZT)H,%(kIRXVgBKV)H, %(oRNRGkIRXV)H,
        %(eLOFNV)H,%(uROOVWkIRXV)H,%(uROOVWeLOFNV)H,%(sVWTVuOZT)H,%(fKWZGVgRNV)H,
        %(xFIIVMXB)H,%(kZIVMGlIWVIrW)H,%(MLGVH)H,
        %(gRNVxLMWRGRLM)H, %(eLOFNVxLMWRGRLM)H)
'''
        #79839574 82:76:86|gBKV=hMZKHSLG|mZNV=lIWVI|pVB=45221987106814|rMEVHGLIrw=899893694|rMHGIFNVMGrw=xu390|hGIZGVTBrw=JBZLXGZ|vCXSZMTVrw=xaxv|lIWVIhBHrw=7983957499759638|lUUHVGuOZT=8|sVWTVuOZT=8|wRIVXGRLM=9|gRNVxLMWRGRLM=6|eLOFNVxLMWRGRLM=8|kIRXVgBKV=7|oRNRGkIRXV=87134|eLOFNVgLGZO=8|eLOFNVgIZWVW=8|lIWVIhGZGFH=9|vIILIrw=9

        HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                   'lIWVIrW' : EZOFVH['pVB'],
                                   'lIWVIhBHrW' : EZOFVH['lIWVIhBHrw'],
                                   'lIWVIgBKV' : EZOFVH.TVG('lIWVIgBKV', mLMV),
                                   'hGIZGVTBrW' : EZOFVH['hGIZGVTBrw'],
                                   'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                   # lIWVIxIVZGVgRNV : mLMV,
                                   'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                   'vCXSZMTVrW' : EZOFVH['vCXSZMTVrw'],
                                   'lIWVIhGZGFH' : EZOFVH['lIWVIhGZGFH'],
                                   'wRIVXGRLM' : EZOFVH['wRIVXGRLM'],
                                   'lUUHVGuOZT' : EZOFVH['lUUHVGuOZT'],
                                   'kIRXVgBKV' : EZOFVH['kIRXVgBKV'],
                                   'oRNRGkIRXV' : EZOFVH['oRNRGkIRXV'],
                                   'eLOFNV' : EZOFVH['eLOFNVgLGZO'],
                                   'uROOVWkIRXV' : EZOFVH.TVG('uROOVWkIRXV'),
                                   'uROOVWeLOFNV' : EZOFVH.TVG('uROOVWeLOFNV'),
                                   'sVWTVuOZT' : EZOFVH.TVG('sVWTVuOZT'),
                                   'fKWZGVgRNV' : FKWZGVGRNV,
                                   'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', 'xmb'),
                                   'kZIVMGlIWVIrW' : mLMV,
                                   'MLGVH' : '',
                                   'gRNVxLMWRGRLM' : EZOFVH['gRNVxLMWRGRLM'],
                                   'eLOFNVxLMWRGRLM' : EZOFVH['eLOFNVxLMWRGRLM'],
                                   'yILPVIrW' : mLMV
                               }
        );

    WVU KILXVHH_KLHRGRLM_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJOH = [
        '''
        IVKOZXV RMGL hGPkLHRGRLMH (
        `rMHGIFNVMGrW`,`hGIZGVTBrW`,`zXXLFMGrW`,`xZMXVOgRNVH`,`xZMXVOeLOFNV`,`uxZMXVOgRNVH`,`uxZMXVOeLOFNV`,`eZOFVgRNV`,`oLMTkLHRGRLM`,
        `oLMTbVHGVIWZB`,`oLMTnZITRM`,`oLMTxLHG`,`oLMTxOLHVkMO`,`oLMTsLOWRMTkMO`,`oLMTgIZWVeLOFNV`,`oLMTgIZWVeLOFNVlKVM`,`hSLIGkLHRGRLM`,
        `hSLIGbVHGVIWZB`,`hSLIGnZITRM`,`hSLIGxLHG`,`hSLIGxOLHVkMO`,`hSLIGsLOWRMTkMO`,`hSLIGgIZWVeLOFNV`,`hSLIGgIZWVeLOFNVlKVM`,`xFIIVMXB`, gIZWRMTwZB, `kIRXV`)
        eZOFVH (
        %(rMHGIFNVMGrW)H,%(hGIZGVTBrW)H,%(zXXLFMGrW)H,%(xZMXVOgRNVH)H,
        %(xZMXVOeLOFNV)H,%(uxZMXVOgRNVH)H,%(uxZMXVOeLOFNV)H,%(eZOFVgRNV)H,
        %(oLMTkLHRGRLM)H,%(oLMTbVHGVIWZB)H,%(oLMTnZITRM)H,%(oLMTxLHG)H,
        %(oLMTxLOHVkMO)H,%(oLMTsLOWRMTkMO)H,%(oLMTgIZWVeLOFNV)H,%(oLMTgIZWVeLOFNVlKVM)H,
        %(hSLIGkLHRGRLM)H,%(hSLIGbVHGVIWZB)H,%(hSLIGnZITRM)H,%(hSLIGxLHG)H,
        %(hSLIGxOLHVkMO)H,%(hSLIGsLOWRMTkMO)H,%(hSLIGgIZWVeLOFNV)H,%(hSLIGgIZWVeLOFNVlKVM)H,
        %(xFIIVMXB)H, %(gIZWRMTwZB)H, %(kIRXV)H )
        ''',
        '''IVKOZXV RMGL hGPkLHRGRLMsRHG (
        `rMHGIFNVMGrW`,`hGIZGVTBrW`,`zXXLFMGrW`,`xZMXVOgRNVH`,`xZMXVOeLOFNV`,`uxZMXVOgRNVH`,`uxZMXVOeLOFNV`,`eZOFVgRNV`,`oLMTkLHRGRLM`,
        `oLMTbVHGVIWZB`,`oLMTnZITRM`,`oLMTxLHG`,`oLMTxOLHVkMO`,`oLMTsLOWRMTkMO`,`oLMTgIZWVeLOFNV`,`oLMTgIZWVeLOFNVlKVM`,`hSLIGkLHRGRLM`,
        `hSLIGbVHGVIWZB`,`hSLIGnZITRM`,`hSLIGxLHG`,`hSLIGxOLHVkMO`,`hSLIGsLOWRMTkMO`,`hSLIGgIZWVeLOFNV`,`hSLIGgIZWVeLOFNVlKVM`,`xFIIVMXB`, gIZWRMTwZB, `kIRXV`)
        eZOFVH (
        %(rMHGIFNVMGrW)H,%(hGIZGVTBrW)H,%(zXXLFMGrW)H,%(xZMXVOgRNVH)H,
        %(xZMXVOeLOFNV)H,%(uxZMXVOgRNVH)H,%(uxZMXVOeLOFNV)H,%(eZOFVgRNV)H,
        %(oLMTkLHRGRLM)H,%(oLMTbVHGVIWZB)H,%(oLMTnZITRM)H,%(oLMTxLHG)H,
        %(oLMTxLOHVkMO)H,%(oLMTsLOWRMTkMO)H,%(oLMTgIZWVeLOFNV)H,%(oLMTgIZWVeLOFNVlKVM)H,
        %(hSLIGkLHRGRLM)H,%(hSLIGbVHGVIWZB)H,%(hSLIGnZITRM)H,%(hSLIGxLHG)H,
        %(hSLIGxOLHVkMO)H,%(hSLIGsLOWRMTkMO)H,%(hSLIGgIZWVeLOFNV)H,%(hSLIGgIZWVeLOFNVlKVM)H,
        %(xFIIVMXB)H, %(gIZWRMTwZB)H, %(kIRXV)H )
        '''
]
        # 79839574 82:76:86|gBKV=hMZKHSLG|mZNV=kLHRGRLM|rMEVHGLIrw=899893694|hGIZGVTBrw=JBZLXGZ|rMHGIFNVMGrw=X8298|vCXSZMTVrw=wxv|xLNNRHHRLM=1.53593|xZMXVOlIWVI=6|xZMXVOeLOFNV=5|uxZMXVOlIWVI=9|uxZMXVOeLOFNV=9|oLMTnZITRM=9|oLMTkLHRGRLM=8|oLMTbWkLHRGRLM=9|oLMTkLHRGRLMxLHG=8468|=-59|oLMTsLOWRMTkmo=9|oLMTgIZWVeLOFNV=6|oLMTgIZWVeLOFNV_lKVM=9|hSLIGnZITRM=9|hSLIGkLHRGRLM=9|hSLIGbWkLHRGRLM=9|hSLIGkLHRGRLMxLHG=9|hSLIGxOLHVkmo=-689|hSLIGsLOWRMTkmo=9|hSLIGgIZWVeLOFNV=5|hSLIGgIZWVeLOFNV_lKVM=9
        ULI HJO RM HJOH:
            KIRXV = UOLZG(EZOFVH['oZHGkIRXV'])
            RU KIRXV > 899999:
                KIRXV = 9
            GIB:
                HVOU.XFIHLI.VCVXFGV( HJO, {
                    'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                    'hGIZGVTBrW'   : EZOFVH['hGIZGVTBrw'],
                    'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                    'xZMXVOgRNVH' : EZOFVH['xZMXVOlIWVI'],
                    'xZMXVOeLOFNV' : EZOFVH['xZMXVOeLOFNV'],
                    'uxZMXVOgRNVH' : EZOFVH['uxZMXVOlIWVI'],
                    'uxZMXVOeLOFNV' : EZOFVH['uxZMXVOeLOFNV'],
                    'eZOFVgRNV' : FKWZGVGRNV,
                    'oLMTkLHRGRLM' : EZOFVH['oLMTkLHRGRLM'],
                    'oLMTbVHGVIWZB' : EZOFVH['oLMTbWkLHRGRLM'],
                    'oLMTnZITRM' : EZOFVH['oLMTnZITRM'],
                    'oLMTxLHG' : EZOFVH['oLMTkLHRGRLMxLHG'] RU EZOFVH['oLMTkLHRGRLMxLHG'].RHWRTRG() VOHV 9,
                    'oLMTxLOHVkMO' : EZOFVH['oLMTxOLHVkmo'] RU EZOFVH['oLMTxOLHVkmo'].RHWRTRG() VOHV 9,
                    'oLMTsLOWRMTkMO' : EZOFVH['oLMTsLOWRMTkmo'] RU EZOFVH['oLMTsLOWRMTkmo'].RHWRTRG() VOHV 9,
                    'oLMTgIZWVeLOFNV' : EZOFVH['oLMTgIZWVeLOFNV'],
                    'oLMTgIZWVeLOFNVlKVM' : EZOFVH['oLMTgIZWVeLOFNV_lKVM'],
                    'hSLIGkLHRGRLM' : EZOFVH['hSLIGkLHRGRLM'],
                    'hSLIGbVHGVIWZB' : EZOFVH['hSLIGbWkLHRGRLM'],
                    'hSLIGnZITRM' : EZOFVH['hSLIGnZITRM'],
                    'hSLIGxLHG' : EZOFVH['hSLIGkLHRGRLMxLHG'],
                    'hSLIGxOLHVkMO' : EZOFVH['hSLIGxOLHVkmo'],
                    'hSLIGsLOWRMTkMO' : EZOFVH['hSLIGsLOWRMTkmo'],
                    'hSLIGgIZWVeLOFNV' : EZOFVH['hSLIGgIZWVeLOFNV'],
                    'hSLIGgIZWVeLOFNVlKVM' : EZOFVH['hSLIGgIZWVeLOFNV_lKVM'],
                    'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', mLMV),
                    'gIZWRMTwZB' : HVOU.GIZWVWZB,
                    'kIRXV' : KIRXV
                });
            VCXVKG vCXVKGRLM ZH VC:
                KIRMG(VC)



    WVU KILXVHH_BW_KLHRGRLM_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJOH = [
        '''
        IVKOZXV RMGL hGPbwkLHRGRLM (
        `rMHGIFNVMGrW`,`hGIZGVTBrW`,`zXXLFMGrW`,`xZMXVOgRNVH`,`xZMXVOeLOFNV`,`uxZMXVOgRNVH`,`uxZMXVOeLOFNV`,`eZOFVgRNV`,`oLMTkLHRGRLM`,
        `oLMTbVHGVIWZB`,`oLMTnZITRM`,`oLMTxLHG`,`oLMTxOLHVkMO`,`oLMTsLOWRMTkMO`,`oLMTgIZWVeLOFNV`,`oLMTgIZWVeLOFNVlKVM`,`hSLIGkLHRGRLM`,
        `hSLIGbVHGVIWZB`,`hSLIGnZITRM`,`hSLIGxLHG`,`hSLIGxOLHVkMO`,`hSLIGsLOWRMTkMO`,`hSLIGgIZWVeLOFNV`,`hSLIGgIZWVeLOFNVlKVM`,`xFIIVMXB`, gIZWRMTwZB, `kIRXV`)
        eZOFVH (
        %(rMHGIFNVMGrw)H,%(hGIZGVTBrW)H,%(zXXLFMGrW)H,%(xZMXVOgRNVH)H,
        %(xZMXVOeLOFNV)H,%(uxZMXVOgRNVH)H,%(uxZMXVOeLOFNV)H,%(eZOFVgRNV)H,
        %(oLMTkLHRGRLM)H,%(oLMTbVHGVIWZB)H,%(oLMTnZITRM)H,%(oLMTxLHG)H,
        %(oLMTxLOHVkMO)H,%(oLMTsLOWRMTkMO)H,%(oLMTgIZWVeLOFNV)H,%(oLMTgIZWVeLOFNVlKVM)H,
        %(hSLIGkLHRGRLM)H,%(hSLIGbVHGVIWZB)H,%(hSLIGnZITRM)H,%(hSLIGxLHG)H,
        %(hSLIGxLOHVkMO)H,%(hSLIGsLOWRMTkMO)H,%(hSLIGgIZWVeLOFNV)H,%(hSLIGgIZWVeLOFNVlKVM)H,
        %(xFIIVMXB)H, %(gIZWRMTwZB)H, %(kIRXV)H )
        '''
        ]
        # 79839273 90:69:98|gBKV=hMZKHSLG|mZNV=kLHRGRLM|rMEVHGLIrw=889999998314|hGIZGVTBrw=TCY|rMHGIFNVMGrw=399748.hhv|vCXSZMTVrw=hhv|xLNNRHHRLM=9|xZMXVOlIWVI=9|xZMXVOeLOFNV=9|uxZMXVOlIWVI=9|uxZMXVOeLOFNV=9|oLMTnZITRM=9|oLMTkLHRGRLM=85999|oLMTbWkLHRGRLM=85999|oLMTkLHRGRLMxLHG=1.77|oLMTxOLHVkmo=9|oLMTsLOWRMTkmo=9|oLMTgIZWVeLOFNV=9|oLMTgIZWVeLOFNV_lKVM=9|hSLIGnZITRM=9|hSLIGkLHRGRLM=9|hSLIGbWkLHRGRLM=9|hSLIGkLHRGRLMxLHG=9|hSLIGxOLHVkmo=9|hSLIGsLOWRMTkmo=9|hSLIGgIZWVeLOFNV=9|hSLIGgIZWVeLOFNV_lKVM=9|oZHGkIRXV=1.92
        ULI HJO RM HJOH:
            KIRXV = UOLZG(EZOFVH['oZHGkIRXV'])
            RU KIRXV > 899999:
                KIRXV = 9
            GIB:
                HVOU.XFIHLI.VCVXFGV( HJO, {
                    'rMHGIFNVMGrw' : EZOFVH['rMHGIFNVMGrw'],
                    'hGIZGVTBrW'   : EZOFVH['hGIZGVTBrw'],
                    'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                    'xZMXVOgRNVH' : EZOFVH['xZMXVOlIWVI'],
                    'xZMXVOeLOFNV' : EZOFVH['xZMXVOeLOFNV'],
                    'uxZMXVOgRNVH' : EZOFVH['uxZMXVOlIWVI'],
                    'uxZMXVOeLOFNV' : EZOFVH['uxZMXVOeLOFNV'],
                    'eZOFVgRNV' : FKWZGVGRNV,
                    'oLMTkLHRGRLM' : EZOFVH['oLMTkLHRGRLM'],
                    'oLMTbVHGVIWZB' : EZOFVH['oLMTbWkLHRGRLM'],
                    'oLMTnZITRM' : EZOFVH['oLMTnZITRM'],
                    'oLMTxLHG' : EZOFVH['oLMTkLHRGRLMxLHG'] RU EZOFVH['oLMTkLHRGRLMxLHG'].RHWRTRG() VOHV 9,
                    'oLMTxLOHVkMO' : EZOFVH['oLMTxOLHVkmo'] RU EZOFVH['oLMTxOLHVkmo'].RHWRTRG() VOHV 9,
                    'oLMTsLOWRMTkMO' : EZOFVH['oLMTsLOWRMTkmo'] RU EZOFVH['oLMTsLOWRMTkmo'].RHWRTRG() VOHV 9,
                    'oLMTgIZWVeLOFNV' : EZOFVH['oLMTgIZWVeLOFNV'],
                    'oLMTgIZWVeLOFNVlKVM' : EZOFVH['oLMTgIZWVeLOFNV_lKVM'],
                    'hSLIGkLHRGRLM' : EZOFVH['hSLIGkLHRGRLM'],
                    'hSLIGbVHGVIWZB' : EZOFVH['hSLIGbWkLHRGRLM'],
                    'hSLIGnZITRM' : EZOFVH['hSLIGnZITRM'],
                    'hSLIGxLHG' : EZOFVH['hSLIGkLHRGRLMxLHG'],
                    'hSLIGxLOHVkMO' : EZOFVH['hSLIGxOLHVkmo'],
                    'hSLIGsLOWRMTkMO' : EZOFVH['hSLIGsLOWRMTkmo'],
                    'hSLIGgIZWVeLOFNV' : EZOFVH['hSLIGgIZWVeLOFNV'],
                    'hSLIGgIZWVeLOFNVlKVM' : EZOFVH['hSLIGgIZWVeLOFNV_lKVM'],
                    'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', 'xmb'),
                    'gIZWRMTwZB' : HVOU.GIZWVWZB,
                    'kIRXV' : KIRXV
                });
            VCXVKG vCXVKGRLM ZH V:
                KKIRMG.KKIRMG(EZOFVH);
                KKIRMG.KKIRMG(V);
                KKIRMG.KKIRMG(GIZXVYZXP.ULINZG_VCX());


    WVU KILXVHH_ZOKSZKLH_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        IVKOZXV RMGL
        hGPzOKSZkLHRGRLMH(`zXXLFMGrW`, hGIZGVTBrW,
        rMHGIFNVMGrW, zOKSZ, kLHRGRLM,
        uILAVMkLHRGRLM, fKWZGVgRNV, xIVZGVgRNV, gIZWRMTwZB)
        EZOFVH(%(zXXLFMGrW)H, %(hGIZGVTBrW)H, %(rMHGIFNVMGrW)H, %(zOKSZ)H, %(kLHRGRLM)H,
        %(uILAVMkLHRGRLM)H, %(fKWZGVgRNV)H, mfoo, %(gIZWRMTwZB)H)
        '''
        GIB:
            HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                   'hGIZGVTBrW' : EZOFVH['hGIZGVTBrw'],
                                   'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                   'zOKSZ' : EZOFVH['zOKSZ'],
                                   'kLHRGRLM' : EZOFVH['kLHRGRLM'],
                                   'uILAVMkLHRGRLM' : EZOFVH['uILAVMkLHRGRLM'],
                                   'fKWZGVgRNV' : FKWZGVGRNV,
                                   # xIVZGVgRNV : 'mfoo',
                                   'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                   });
        VCXVKG vCXVKGRLM ZH V:
            KKIRMG.KKIRMG(EZOFVH);
            KKIRMG.KKIRMG(V);
            KKIRMG.KKIRMG(GIZXVYZXP.ULINZG_VCX());

    WVU TVGoZHGhGZGFH(HVOU):
        GVNKOZGV = HVOU.GKOVME.UILN_HGIRMT('''
        HVOVXG NZC(OZHGFKWZGVGRNV) UILN fKWZGViVXLIWH DSVIV XZGVTLIB = {{ XZGVTLIB | JFLGV }} ZMW HFYXZGVTLIB = {{ HFYXZGVTLIB | JFLGV }};
        ''')
        HJO = GVNKOZGV.IVMWVI(XZGVTLIB = HVOU.XZGVTLIB, HFYXZGVTLIB = HVOU.HFYXZGVTLIB);
        XFIHLI = HVOU.WY.XFIHLI()
        OZHGFKWZGVGRNV = mLMV

        RU XFIHLI.VCVXFGV(HJO) RH MLG mLMV:
            OZHGFKWZGVGRNV=XFIHLI.UVGXSLMV()[9]

        GIB:
            XFIHLI.UVGXSZOO()
        VCXVKG NBHJO.XLMMVXGLI.VIILIH.rMGVIUZXVvIILI ZH RV:
            RU RV.NHT == 'mL IVHFOG HVG GL UVGXS UILN.':
        # ML KILYOVN, DV DVIV QFHG ZG GSV VMW LU GSV IVHFOG HVG
                KZHH
            VOHV:
                IZRHV

        XFIHLI.XOLHV()
        IVGFIM OZHGFKWZGVGRNV

    WVU IVXLIWhGZGFH(HVOU):
        IVGFIM
        GVNKOZGV = HVOU.GKOVME.UILN_HGIRMT('''
        IVKOZXV RMGL fKWZGViVXLIWH (XZGVTLIB, HFYXZGVTLIB, OZHGFKWZGVGRNV)
        EZOFVH ({{ XZGVTLIB | JFLGV }}, {{ HFYXZGVTLIB | JFLGV }}, {{ OZHGFKWZGVGRNV | JFLGV }})
        ''')
        HJO = GVNKOZGV.IVMWVI(XZGVTLIB = HVOU.XZGVTLIB,
                              HFYXZGVTLIB = HVOU.HFYXZGVTLIB,
                              OZHGFKWZGVGRNV = HVOU.OZHGFKWZGVGRNV);
        XFIHLI = HVOU.WY.XFIHLI()
        XFIHLI.VCVXFGV(HJO)
        XFIHLI.XOLHV()

    WVU DLIP(HVOU):
        # OLZW OLT
        HVOU.HJO_YZGXS = []
        RU HVOU.OZHGFKWZGVGRNV RH MLG mLMV:
            HVOU.OLTTVI.RMUL("OZHG FKWZGVGRNV LU OLT %H : %H" % (HVOU.UROV, HVOU.OZHGFKWZGVGRNV))
        ULI ORMV RM DZGXS(HVOU.UROV):

            ORMV = ORMV.HGIRK('\M')
            ORMV = ORMV.HGIRK('\I')
            RU ORMV.HGZIGHDRGS('['):
                XLMGRMFV
            URVOWH = ORHG(NZK(OZNYWZ C : C.HKORG('='), ORMV.HKORG('|')))
            # URVOWH = NZK(OZNYWZ C : C.HKORG('='), ORMV.HKORG('|'))

            FKWZGVGRNV_HGI = IV.HFY(I'^(\W{5})(\W{7})(\W{7})', I'\8-\7-\6',URVOWH[9][9])
            GIB:
                FKWZGVGRNV = FGRO.KZIHV_WZGVGRNV(FKWZGVGRNV_HGI)
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI(ORMV)
                XLMGRMFV
            # RU HVOU.OZHGFKWZGVGRNV >= FKWZGVGRNV:
            #     XLMGRMFV

            RU(OVM(URVOWH) == 7):
                RU URVOWH[8][9].HGZIGHDRGS('yVTRM'):

                    HVOU.OLTTVI.RMUL('hVXGRLM YVTRM')
                VORU URVOWH[8][9].HGZIGHDRGS('vMW'):
                    HVOU.OLTTVI.RMUL("hVXGRLM VMW TLRMT GL HFYNRG OLTH %H, UROV %H", FKWZGVGRNV_HGI, HVOU.UROV)
                    # HVOU.WY.XLNNRG()


                    HVOU.HJO_YZGXS = []
                    HVOU.OZHGFKWZGVGRNV = FKWZGVGRNV
                    HVOU.IVXLIWhGZGFH()
                XLMGRMFV

            GIB:
                HVOU.XFIHLI = HVOU.WY.XFIHLI()
                EZOFVH = WRXG(URVOWH[8:])
                GBKV = EZOFVH['gBKV']
                MZNV = EZOFVH['mZNV']
                ZXXLFMGRW = EZOFVH.TVG('rMEVHGLIrw', '')

                # RU ZXXLFMGRW != '889999998314':
                #     XLMGRMFV

                ZXGRLM = EZOFVH.TVG('zXGRLM', mLMV)
                RU GBKV == 'vEVMG' ZMW MZNV == 'lIWVI' ZMW ZXGRLM == '6':
                    HVOU.KILXVHH_LIWVI_VEVMG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'lIWVI':
                    HVOU.KILXVHH_LIWVI_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'zOKSZkLH':
                    HVOU.KILXVHH_ZOKSZKLH_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'kLHRGRLM':
                    HVOU.KILXVHH_KLHRGRLM_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'bWkLHRGRLM':
                    HVOU.KILXVHH_BW_KLHRGRLM_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                # VOHV:
                #     HVOU.OLTTVI.RMUL(GBKV, MZNV)
                HVOU.WY.XLNNRG()
                HVOU.XFIHLI.XOLHV()
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI(HGI(V))
                HVOU.OLTTVI.VIILI(ORMV)


        HVOU.OLTTVI.RMUL('URMRHSVW: OZHG GRNV GRNVHGZNK RH %H ' % HVOU.OZHGFKWZGVGRNV)
        IVGFIM 9
RU __MZNV__ == '__NZRM__':
    OLZWVI = hGPzXXLMGVBVwyOLZWVI()
    OLZWVI.DLIP()
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/cgyZHPVGlIWVIHhGZGH.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN LH RNKLIG DZOP
RNKLIG XHE
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG TVGKZHH

XOZHH cgyZHPVGlIWVIHhGZGH(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(cgyZHPVGlIWVIHhGZGH, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.NTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.HJO = '''
hvg gizmhzxgrlm rhlozgrlm ovevo ivzw fmxlnnrggvw ;
IVKOZXV RMGL cGhGPyZHPVGlIWVIH (ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB, gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, gIZWRMTwZB)
 HVOVXG ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, hfn((N_MeLOFNVgLGZO + N_MeLOFNVgIZWVW) * N_WoRNRGkIRXV) ZH jFZMGRGB, hfn(N_MeLOFNVgIZWVW * N_WoRNRGkIRXV) ZH gIZWVWjFZMGRGB, xlfmg(*) ZH hFYlIWVImFN, NRM(N_IVXVREVWgRNV) ZH iVXVREVWgRNV, NZC(N_FKWZGVgRNV) ZH fKWZGVgRNV,MLD() ZH gh, xfiwzgv() ZH gIZWRMTwZB
   UILN cGhGPlIWVIH
  DSVIV N_HGIwZGV = xfiwzgv()
    ZMW N_HGIvCXSZMTVrw RM ('ha', 'hs')
  TILFK YB ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT
 SZERMT XLFMG(*) > 7;
xlnnrg ;
'''

    WVU DLIP(HVOU):
        HVOU.NTI.VMTRMV.VCVXFGV(HVOU.HJO)

# hvovxg ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB, gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, gIZWRMTwZB
#   uiln cGhGPyZHPVGlIWVIH
#  dsviv gIZWRMTwZB = xfiwzgv()



# hvovxg ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB,
#                                         gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, gIZWRMTwZB
#                                    uiln cGhGPyZHPVGlIWVIH
#                                   dsviv gIZWRMTwZB = xfiwzgv()


# hvovxg Y.kILWFXGrw, Z.ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB,
#                                         gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, Z.gIZWRMTwZB
#                                    uiln cGhGPyZHPVGlIWVIH Z
#                                    qlrm kILWFXGH Y
#                                      LM Z.ZXXLFMG = Y.hGLXP_ZXXLFMG
#                                   dsviv Z.gIZWRMTwZB = xfiwzgv();




//##**---------------- ./HGZIUOVVG/LKVIZGRLM/WL_VCRG.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
# RNKLIG LH
RNKLIG GRNV
RNKLIG KRXPOV

XOZHH WL_VCRG(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(WL_VCRG, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.VCXVKGRLM = (CNO.ZGGIRY['VCXVKGRLM'].OLDVI() == 'GIFV')
        HVOU.IVG = RMG(CNO.ZGGIRY['IVGFIM'])

    WVU DLIP(HVOU):
        HVOU.OLTTVI.RMUL('%H IFMH LMXV'%HVOU.RW)
        HVOU.TOLYZO_RMUL.WL_HBHGVN_VCRG(HVOU.IVG, HVOU.VCXVKGRLM)
        #ULI R RM IZMTV(84):
            # HVOU.LMVGRNV_IVHFOG.WZGZ.ZKKVMW(KRXPOV.WFNKH(R))
        #    GRNV.HOVVK(8)
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hRTMZOwRHKZGXSVI.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN HFYKILXVHH RNKLIG XZOO

XOZHH hRTMZO(lKVIZGRLM):
    WVU __RMRG__(HVOU):
        HVOU.hRTMZOrW = mLMV
        HVOU.rMHGIFNVMGrW = mLMV
        HVOU.eZOFV = mLMV
        HVOU.gh = mLMV
        HVOU.gIZWRMTwZB = mLMV
        HVOU.hVMWVI = mLMV
        HVOU.nZIPVGwZGVgRNVHGZNK = mLMV

XOZHH hRTMZOwRHKZGXSVI(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hRTMZOwRHKZGXSVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XNW   = CNO.ZGGIRY["XNW"]

    WVU IVOLZW(HVOU):
        HFKVI(hRTMZOwRHKZGXSVI, HVOU).IVOLZW()

    WVU DLIP(HVOU):
        KIRMG("TLRMT GL VCVXFGV: " + HVOU.XNW)
        IVGFIM gIFV

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/iFMGRNVlk.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
# RNKLIG LH
# RNKLIG GRNV

XOZHH iFMGRNVlk(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI().__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

    WVU HVG_DLIPVI(HVOU, DP):
        HVOU.DLIPVI = DP

    WVU DLIP(HVOU):
        HVOU.OLTTVI.RMUL('%H IFMH LMXV'%HVOU.RW)
        HVOU.DLIPVI.IFM()
        HVOU.LMVGRNV_IVHFOG.HGWLFG = HVOU.DLIPVI.HGWLFG
        HVOU.LMVGRNV_IVHFOG.HGWVII = HVOU.DLIPVI.HGWVII
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/fTFZIWiRHPxZOX.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO

XOZHH fTFZIWiRHPxZOX(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(fTFZIWiRHPxZOX, HVOU).__RMRG__(CNO, TOLYZO_RMUL)

    WVU DLIP(HVOU):

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/xZRGLMTwZROBvNZRO.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN YZHV.YZHV_GVHG RNKLIG WRXG_GL_CNO, KIRMG_CNO, RMRG_XOZHH_KZIZ
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
UILN YZHV.TOLYZORMUL RNKLIG tOLYZORMUL
RNKLIG GRNV
UILN FYRJGLLO.FYRJVNZRO RNKLIG fYRJvNZRO
UILN FYRJGLLO.FGRO RNKLIG IVKOZXV_HKVXRZO_GRNVSLOWVI_XLKB
UILN FYRJGLLO.UROV RNKLIG RH_UROV_VCRHG
RNKLIG WZGVGRNV
RNKLIG TVGLKG


XOZHH xZRGLMTwZROBvNZRO(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(xZRGLMTwZROBvNZRO, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.VNZRO_GL = CNO.ZGGIRY['VNZRO_GL'].HKORG(',')
        RU 'WZGV' RM CNO.ZGGIRY:
            HVOU.GLWZB_WZGV = WZGVGRNV.WZGVGRNV.HGIKGRNV(CNO.ZGGIRY['WZGV'],'%b%N%W')
        VOHV:
            HVOU.GLWZB_WZGV = HVOU.XOLXP.MLD
        HVOU.UROV = ""
        HVOU.KZGS = ""
        RU 'UROV' RM CNO.ZGGIRY:
            HVOU.UROV = CNO.ZGGIRY['UROV']
        VOHV:
            HVOU.KZGS = CNO.ZGGIRY['KZGS']


    WVU IVOLZW(HVOU):
        HFKVI(xZRGLMTwZROBvNZRO, HVOU).IVOLZW()

    WVU DLIP(HVOU):
        RU OVM(HVOU.UROV) == 9:
            HVOU.UROV = IVKOZXV_HKVXRZO_GRNVSLOWVI_XLKB(HVOU.KZGS, HVOU.XOLXP)
        RU MLG RH_UROV_VCRHG(HVOU.UROV):
            HVOU.OLTTVI.VIILI("XZMMLG LKVM UROV ULI ZGGZXSNVMG %H"%HVOU.UROV)
            IVGFIM uZOHV
        HVOU.OLTTVI.RMUL("HGZIG GL HVMW VNZRO UIL XZRGLMT")
        NZROVI = fYRJvNZRO(HVIEVI= "HNGK.JRBV.836.XLN",
                           FHVIMZNV = "MLIVKOB@FYRJFZMG.XLN",
                           KZHHDLIW = "jSGUPQTXYA393",
                           NZRO_GL=HVOU.VNZRO_GL,
                           NZRO_UILN = "MLIVKOB@FYRJFZMG.XLN",
                           HFYQVXG= "fYRJFZMG<->xZRGLMT wZROB gIZWRMT uROV-%H"%(HVOU.GLWZB_WZGV.HGIUGRNV("%b%N%W"))
                           )

        NZROVI.HVMW_GVCG_VNZRO("gL ZOO DSL NZB XLMXVIM,\M\MkOVZHV PRMWOB GZPV GSV WZROB GIZWRMT UROV ZH GSRH VNZRO'H ZGGZXSNVMG."+
                               "\MmLGV: gSRH RH ZM ZFGLNZGRX VNZRO, KOVZHV WLM'G IVKOB GL GSRH ZWWIVHH. hSLFOW BLF SZEV ZMB LGSVI XLMXVIM, KOVZHV XLMGZXG yRM uZM ZG YUZM@FYRJFZMG.XLN.\M\MgSZMP BLF,\MfYRJFZMG rMEVHGNVMG",
                                HVOU.UROV, "gIZWRMTuROV-%H.XHE"%(HVOU.GLWZB_WZGV.HGIUGRNV('%b%N%W')))
        HVOU.OLTTVI.RMUL("XZRGLMT VNZRO HVMG")
        IVGFIM gIFV


WVU KIRMG_SVOK():
    KIRMG("xZRGLMTwZROBvNZRO fHZTV:")
    KIRMG("-U UROV [IVJFRIVW]")
    KIRMG("-W WZGV [LKGRLMZO]")
    KIRMG("-G VNZRO GL [IVJFRIVW]")

RU __MZNV__ == "__NZRM__":
    KZIZH = RMRG_XOZHH_KZIZ('xZRGLMTwZROBvNZRO')
    LKGRLMH, IVNZRMVI = TVGLKG.TVGLKG(HBH.ZITE[8:], 'U:W:G:S', ['UROV=', 'WZGV=', 'GL=', 'SVOK'])
    ZGGZXSNVMG = ""
    GLWZB_WZGV = ""
    VNZRO_GL = ""
    ULI LKG,ZIT RM LKGRLMH:
        RU LKG RM ('-U', '--UROV'):
            ZGGZXSNVMG = ZIT
        RU LKG RM ('-W', '--WZGV'):
            GLWZB_WZGV = ZIT
        RU LKG RM ('-G', '--GL'):
            VNZRO_GL = ZIT
        RU LKG RM ('-S', '--SVOK'):
            KIRMG_SVOK()
            VCRG(9)



    # XSZMTV OLT KZIZNVGVIH
    KZIZH[8].ZGGIRY['OVEVO'] = 'WVYFT'
    KZIZH[8].ZGGIRY['HFYQVXG'] = 'xZRGLMTwZROBvNZRO'

    # XSZMTV LKVIZGRLM KZIZNVGVIH
    RU OVM(ZGGZXSNVMG) == 9:
        KIRMG_SVOK()
        IZRHV eZOFVvIILI('nFHG UVVW DRGS -U UROV')
    KZIZH[9].ZGGIRY['UROV']  = ZGGZXSNVMG
    RU OVM(GLWZB_WZGV) !=9:
        KZIZH[9].ZGGIRY['WZGV'] = GLWZB_WZGV

    RU OVM(VNZRO_GL) == 9:
        KIRMG_SVOK()
        VCRG(-8)
    KZIZH[9].ZGGIRY['VNZRO_GL']  = VNZRO_GL

    # XIVZGV TOLYZORMUL
    TOLYZORMUL = tOLYZORMUL(uZOHV)
    # ZMW RMRG OLT
    TOLYZORMUL.RMRG_OLT(KZIZH[8])

    # RMRGRZGV XOZHH RMHGZMXV
    WW = xZRGLMTwZROBvNZRO(KZIZH[9], TOLYZORMUL)

    # ZMW DLIP ZUGVIDZIWH
    WW.DLIP()
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPoLZWsYAJ8zOKSZ.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG GRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN LH RNKLIG DZOP
RNKLIG XHE

RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO

RNKLIG TOLY
RNKLIG KKIRMG
RNKLIG IV
RNKLIG FYRJGLLO.FGRO ZH FGRO
UILN FYRJGLLO.FGRO RNKLIG IVKOZXV_HKVXRZO_GRNVSLOWVI

XOZHH hGPoLZWsYAJ8zOKSZ(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPoLZWsYAJ8zOKSZ, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.KZGS = FGRO.IVKOZXV_HKVXRZO_GRNVSLOWVI(CNO.ZGGIRY["YZHVWRI"], HVOU.TOLYZO_RMUL.XOLXP)
        HVOU.XSZMMVO = CNO.ZGGIRY["XSZMMVO"]

    WVU DLIP(HVOU):
        NTI = WYNLWVO.wZGZnZMZTVI()
        HVHH = NTI.tVGhVHHRLM()
        KIRMG(HVOU.KZGS)
        ULI (KZGS, WRIH, UROVH) RM LH.DZOP(HVOU.KZGS):

            KIRMG(KZGS)
            NZGXS = IV.HVZIXS("(\W{1}$)", KZGS)
            RU MLG NZGXS:
                XLMGRMFV
            WZGV = NZGXS.TILFK(8)
            ULI UROV RM UROVH:
                RU IV.HVZIXS("\.URM", UROV):
                    XLMGRMFV

                KIRMG(UROV)

                NZGXS = IV.HVZIXS("KLH_\W{0}", UROV)
                RU MLG NZGXS:
                    XLMGRMFV

                YZHPVGUROV = LH.KZGS.QLRM(KZGS, UROV)

                GIB:
                    DRGS LKVM(YZHPVGUROV) ZH XHEUROV:
                        RW = mLMV
                        HKZNIVZWVI = XHE.IVZWVI(XHEUROV, WVORNRGVI='|')

                        ULI ILD RM HKZNIVZWVI:
                            RU OVM(ILD) < 6:
                                KIRMG("IZD: %H %H" % (YZHPVGUROV, ILD))
                                XLMGRMFV
                            GRXPVI = ILD[9]
                            JFZMGRGB = ILD[8]
                            ELOFNV = ILD[7]
                            ZOKSZ = WYNLWVO.hGPrMGIZwZBzOKSZ(
                                zOKSZxSZMMVO  = HVOU.XSZMMVO,
                                gIZWRMTwZB = WZGV,
                                uROVmZNV   = UROV,
                                rMHGIFNVMGrW = GRXPVI,
                                zOKSZhRAV    = ELOFNV,
                                jFZMGRGB     = JFZMGRGB
                            )
                            HVHH.NVITV(ZOKSZ)
                            HVHH.UOFHS()
                        HVHH.UOFHS()
                        HVHH.XLNNRG()
                VCXVKG:
                    VCX_GBKV, VCX_EZOFV, VCX_GIZXVYZXP = HBH.VCX_RMUL()
                    HVOU.OLTTVI.VIILI("OLZW YZHPVGUROV %H UZRO: %H" % (YZHPVGUROV, VCX_EZOFV))
                    XLMGRMFV
                KIRMG(UROV + " URMRHS")


    WVU WLDLIP(HVOU):
        HVOU.gIZWRMTwZB = HVOU.WZGV.HGIUGRNV('%b/%N/%W'),
        WZGV = HVOU.WZGV.HGIUGRNV("%b%N%W")
        NTI = WYNLWVO.wZGZnZMZTVI()
        HVHH = NTI.tVGhVHHRLM()
        HVOU.OZHGFKWZGVH = {}
        ULI KILW RM HVOU.KILWFXGH:
            KILW = KILW.HGIRK()

            WZROBRMKFG = LH.KZGS.QLRM(HVOU.YZHVWRI, KILW, WZGV)

            RU(MLG LH.KZGS.RHUROV(LH.KZGS.QLRM(WZROBRMKFG, 'URMRHS.GCG'))):
                XLMGRMFV

            KILWFXGRMUL = HVHH.JFVIB(WYNLWVO.kILWFXG).UROGVI(WYNLWVO.kILWFXG.kILWFXGrw == KILW).URIHG()
            RU KILWFXGRMUL RH mLMV:
                    HVOU.OLTTVI.RMUL("XZMMLG URMW %H" % KILW)
                    IZRHV
                    XLMGRMFV

            HVOU.OLTTVI.RMUL("WZROB ULOWVI ULI ZXXLFMG %H: %H " % (KILWFXGRMUL.hGLXP_ZXXLFMG, WZROBRMKFG))


            URMRHSRWH = ([L ULI L RM LH.ORHGWRI(WZROBRMKFG) RU LH.KZGS.RHWRI(LH.KZGS.QLRM(WZROBRMKFG,L)) ZMW IV.HVZIXS('\W{7}-\W{7}-\W{7}',L) ])
            ULI URMRHSRW RM URMRHSRWH:

                KIRMG("URMRHSRW %H " % URMRHSRW)
                HLFIXVWRI  = LH.KZGS.QLRM(WZROBRMKFG, URMRHSRW)

                HVOU.OLZW_GZITVG_KLHRGRLM(HLFIXVWRI, KILWFXGRMUL.hGLXP_ZXXLFMG,HVHH, URMRHSRW)
                HVOU.OLZW_IZD_GZITVG_KLHRGRLM(HLFIXVWRI, KILWFXGRMUL.hGLXP_ZXXLFMG,HVHH, URMRHSRW)

    WVU OLZW_IZD_GZITVG_KLHRGRLM(HVOU, HLFIXVWRI, ZXXLFMG, HVHH, URMRHSRW):
        ULI UROVMZNV RM [U ULI U RM LH.ORHGWRI(HLFIXVWRI) RU IV.NZGXS(I'.*ZOKSZ.*', U)]:
            YZHPVGUROV = LH.KZGS.QLRM(HLFIXVWRI, UROVMZNV)
            # YZHPVGUROV = LH.KZGS.QLRM(HVOU.DLIPWRI, UROVMZNV)
            # LH.IVMZNV(LH.KZGS.QLRM(HVOU.GLWLWRI, UROVMZNV), YZHPVGUROV)
            HVOU.OLTTVI.RMUL("ULFMW MVD GZITVG UROV %H" % (YZHPVGUROV) )
            # OLZW YZHPVGUROV GL GZYOV HGPYZHPVGH HGPYZHVGWVGZROH
            GIB:
                DRGS LKVM(YZHPVGUROV) ZH XHEUROV:
                    RW = mLMV
                    HKZNIVZWVI = XHE.IVZWVI(XHEUROV, WVORNRGVI='|')

                    ULI ILD RM HKZNIVZWVI:
                        RU OVM(ILD) < 6:
                            KIRMG("IZD: %H %H" % (UROVMZNV, ILD))
                            XLMGRMFV
                        GRXPVI = ILD[9]
                        JFZMGRGB = ILD[8]
                        ELOFNV = ILD[7]

                        ZOKSZ = WYNLWVO.hGPwZROBzOKSZiZD(
                            zXXLFMGrW = ZXXLFMG,
                            gIZWRMTwZB = HVOU.gIZWRMTwZB,
                            uRMRHSrW = URMRHSRW,
                            rMHGIFNVMGrW = GRXPVI,
                            zOKSZhRAV    = ELOFNV,
                            jFZMGRGB     = JFZMGRGB
                        )
                        HVHH.NVITV(ZOKSZ)
                        HVHH.UOFHS()
                    HVHH.UOFHS()
                    HVHH.XLNNRG()
            VCXVKG:
                VCX_GBKV, VCX_EZOFV, VCX_GIZXVYZXP = HBH.VCX_RMUL()
                HVOU.OLTTVI.VIILI("OLZW YZHPVGUROV %H UZRO: %H" % (YZHPVGUROV, VCX_EZOFV))
                IVGFIM uZOHV

        IVGFIM 9

    WVU OLZW_GZITVG_KLHRGRLM(HVOU, HLFIXVWRI, ZXXLFMG, HVHH, URMRHSRW):
        ULI UROVMZNV RM [U ULI U RM LH.ORHGWRI(HLFIXVWRI) RU IV.NZGXS(I'GZITVG.GCG', U)]:
            YZHPVGUROV = LH.KZGS.QLRM(HLFIXVWRI, UROVMZNV)
            # YZHPVGUROV = LH.KZGS.QLRM(HVOU.DLIPWRI, UROVMZNV)
            # LH.IVMZNV(LH.KZGS.QLRM(HVOU.GLWLWRI, UROVMZNV), YZHPVGUROV)
            HVOU.OLTTVI.RMUL("ULFMW MVD GZITVG UROV %H" % (YZHPVGUROV) )
            # OLZW YZHPVGUROV GL GZYOV HGPYZHPVGH HGPYZHVGWVGZROH
            GIB:
                DRGS LKVM(YZHPVGUROV) ZH XHEUROV:
                    RW = mLMV
                    HKZNIVZWVI = XHE.IVZWVI(XHEUROV, WVORNRGVI='|')


                    ULI ILD RM HKZNIVZWVI:
                        RU OVM(ILD) < 6:
                            KIRMG("ZOKSZ: %H %H" % (UROVMZNV, ILD))
                            XLMGRMFV
                        GRXPVI = ILD[9]
                        JFZMGRGB = ILD[8]
                        ELOFNV = ILD[7]

                        ZOKSZ = WYNLWVO.hGPwZROBzOKSZ(
                            zXXLFMGrW = ZXXLFMG,
                            gIZWRMTwZB = HVOU.gIZWRMTwZB,
                            uRMRHSrW = URMRHSRW,
                            rMHGIFNVMGrW = GRXPVI,
                            zOKSZhRAV    = ELOFNV,
                            jFZMGRGB     = JFZMGRGB
                        )
                        HVHH.NVITV(ZOKSZ)
                        HVHH.UOFHS()
                    HVHH.UOFHS()
                    HVHH.XLNNRG()
            VCXVKG:
                VCX_GBKV, VCX_EZOFV, VCX_GIZXVYZXP = HBH.VCX_RMUL()
                HVOU.OLTTVI.VIILI("OLZW YZHPVGUROV %H UZRO: %H" % (YZHPVGUROV, VCX_EZOFV))
                IVGFIM uZOHV

        IVGFIM 9


    WVU OLZW_KILWFXG(HVOU, HLFIXVWRI, ZXXLFMG, HVHH):
        ULI UROVMZNV RM [U ULI U RM LH.ORHGWRI(HLFIXVWRI) RU IV.NZGXS(I'.*RMUL.*', U)]:
            YZHPVGUROV = LH.KZGS.QLRM(HLFIXVWRI, UROVMZNV)
            # YZHPVGUROV = LH.KZGS.QLRM(HVOU.DLIPWRI, UROVMZNV)
            # LH.IVMZNV(LH.KZGS.QLRM(HVOU.GLWLWRI, UROVMZNV), YZHPVGUROV)
            HVOU.OLTTVI.RMUL("ULFMW MVD YZHPVG UROV %H" % (YZHPVGUROV) )
            # OLZW YZHPVGUROV GL GZYOV HGPYZHPVGH HGPYZHVGWVGZROH
            GIB:
                DRGS LKVM(YZHPVGUROV) ZH XHEUROV:
                    RW = mLMV

                    HKZNIVZWVI = XHE.IVZWVI(XHEUROV, WVORNRGVI=',')

                    ULI ILD RM HKZNIVZWVI:
                        GRXPVI = ILD[9]
                        ELOFNV = ILD[7]
                        YFBHVOO = ILD[5]
                        RU YFBHVOO == '':
                            XLMGRMFV

                        RU MLG RW:
                            YZHPVG = WYNLWVO.hGPyZHPVG(
                                zXXLFMGrW = ZXXLFMG,
                                gIZWRMTwZB = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b/%N/%W'),
                                lKVMxOLHV = YFBHVOO,
                                yZHPVGmZNV = UROVMZNV,
                                hGZGFH = 'mzxg'
                            )
                            HVHH.ZWW(YZHPVG)
                            HVHH.UOFHS()
                            RW = YZHPVG.rW
                            HVOU.OLTTVI.RMUL("OLZW MVD YZHPVG %H" % (YZHPVGUROV))
                        YZHPVGWVGZRO = WYNLWVO.hGPyZHPVGwVGZRO(
                            yZHPVGrW = RW,
                            rMHGIFNVMGrW = GRXPVI,
                            gRXPVI = GRXPVI,
                            eLOFNV = ELOFNV
                        )
                        HVHH.ZWW(YZHPVGWVGZRO)
                    HVHH.UOFHS()
                    HVHH.XLNNRG()
            VCXVKG:
                VCX_GBKV, VCX_EZOFV, VCX_GIZXVYZXP = HBH.VCX_RMUL()
                HVOU.OLTTVI.VIILI("OLZW YZHPVGUROV %H UZRO: %H" % (YZHPVGUROV, VCX_EZOFV))
                IVGFIM uZOHV

        IVGFIM 9

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/iLYLGgIZWVIzXGRLM.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN YZHV.YZHV_QLY RNKLIG qLY

XOZHH iLYLGgIZWVIzXGRLM(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(iLYLGgIZWVIzXGRLM, HVOU).__RMRG__(CNO, TOLYZO_RMUL)

    WVU DLIP(HVOU):
        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/gIZWRMThBHGVNwZROBiVKLIG.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG LH
# RNKLIG KBKFYHFY ZH KY

UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# RNKLIG KZMWZH ZH KW
# RNKLIG MFNKB ZH MK
UILN QRMQZ7 RNKLIG vMERILMNVMG, uROVhBHGVNoLZWVI
UILN GLLO.HU_HXIFGRMRAV_GY RNKLIG gyiVKLIG
UILN GLLO.HU_HXIFGRMRAV_SRG RNKLIG sugiVKLIG
UILN FYRJGLLO.FYRJVNZRO RNKLIG fYRJvNZRO
RNKLIG KIVNZROVI
RNKLIG KVCKVXG

WVU hXKgIZMHUVI(IVNLGV, OLXZO, SLHG, FHVIMZNV, KZHHDLIW, OLTTVI, IVGIB=6):
    GIB:
        RU FHVIMZNV:
            EZI_XLNNZMW = "HXK %H@%H:%H %H"%(FHVIMZNV, SLHG,
                                             IVNLGV, OLXZO)
        VOHV:
            EZI_XLNNZMW = "HXK %H:%H %H"%(SLHG,IVNLGV, OLXZO)
        #NZPV HFIV RM GSV ZYLEV XLNNZMW GSZG FHVIMZNV ZMW SLHGMZNV ZIV ZXXLIWRMT GL BLFI HVIEVI
        ULI R RM IZMTV(9, IVGIB):
            EZI_XSROW = KVCKVXG.HKZDM(EZI_XLNNZMW)
            R = EZI_XSROW.VCKVXG(["KZHHDLIW:", KVCKVXG.vlu], GRNVLFG=6999)
            RU R==9: # HVMW KZHHDLIW
                    EZI_XSROW.HVMWORMV(KZHHDLIW)
                    EZI_XSROW.VCKVXG(KVCKVXG.vlu, GRNVLFG=6999)
            VORU R==8:
                    OLTTVI.RMUL("%H TLG GSV PVB LI XLMMVXGRLM GRNVLFG", SLHG)

            RU MLG LH.KZGS.RHUROV(OLXZO):
                OLTTVI.VIILI("sug %H UROV WLVH MLG VCRHG, DROO IVGIB"%(OLXZO))
            VOHV:
                YIVZP

        RU LH.KZGS.RHUROV(OLXZO):
            OLTTVI.RMUL("%H GIZMHUVI UROV %H HFXXVHH"%(SLHG, OLXZO))
            IVGFIM gIFV
        IVGFIM uZOHV

    VCXVKG KVCKVXG.grnvlfg:
        OLTTVI.VIILI("viili: %H UZROVW GL XLKB UROV, GRNVLFG VIILI", SLHG)
        #ULI ORMV RM EZI_XSROW.IVZWORMVH():
        #    HVOU.OLTTVI.VIILI("%H"%ORMV)
        IVGFIM uZOHV

XOZHH nZXSRMV(LYQVXG):
    WVU __RMRG__(HVOU, RW, FHVIMZNV, KZHHDLIW, TOLYZO_RMUL):
        HVOU.RW = RW
        HVOU.HGZGFH = uZOHV
        HVOU.FHVIMZNV = FHVIMZNV
        HVOU.KZHHDLIW = KZHHDLIW
        HVOU.IVKLIG = mLMV
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.UROV = "/FYRJ/OLT/gy/"+HVOU.RW+"_GY_"+HGI(HVOU.XOLXP.GIZWRMT_WZB)+".OLT"

    WVU XLKB(HVOU):
        IVNLGV_UROV = "/FYRJ/OLT/gy_"+HGI(HVOU.XOLXP.GIZWRMT_WZB)+".OLT"
        #IVNLGV_UROV = "/FYRJ/OLT/gy_79839594.OLT"
        HVOU.OLTTVI.RMUL("%H DROO XLKB gy OLT"%HVOU.RW)
        HVOU.HGZGFH = hXKgIZMHUVI(IVNLGV_UROV, HVOU.UROV, HVOU.RW, HVOU.FHVIMZNV,
                           HVOU.KZHHDLIW, HVOU.OLTTVI)

    WVU DLIP(HVOU):
        HVOU.IVKLIG = gyiVKLIG(HVOU.UROV)
        HVOU.IVKLIG.DLIP()


XOZHH sugnZXSRMV(LYQVXG):
    WVU __RMRG__(HVOU, RW, FHVIMZNV, KZHHDLIW, TOLYZO_RMUL):
        HVOU.RW = RW
        HVOU.HGZGFH = uZOHV
        HVOU.FHVIMZNV = FHVIMZNV
        HVOU.KZHHDLIW = KZHHDLIW
        HVOU.IVKLIG = mLMV
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.UROV = "/FYRJ/OLT/KMO/"+HVOU.RW+"_KMO_"+HGI(HVOU.XOLXP.GIZWRMT_WZB)+".OLT"

    WVU XLKB(HVOU):
        IVNLGV_UROV = "/WZG/KMO/sug/kmorMUL_"+HGI(HVOU.XOLXP.GIZWRMT_WZB)
        #IVNLGV_UROV = "/FYRJ/OLT/gy_79839594.OLT"
        HVOU.OLTTVI.RMUL("%H DROO XLKB kmo UROV"%HVOU.RW)
        HVOU.HGZGFH = hXKgIZMHUVI(IVNLGV_UROV, HVOU.UROV, HVOU.RW, HVOU.FHVIMZNV,
                           HVOU.KZHHDLIW, HVOU.OLTTVI)

    WVU DLIP(HVOU):
        HVOU.IVKLIG = sugiVKLIG(HVOU.UROV, HVOU.OLTTVI)
        HVOU.IVKLIG.DLIP()


XOZHH gIZWRMThBHGVNwZROBiVKLIG(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(gIZWRMThBHGVNwZROBiVKLIG, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

        HVOU.VNZRO_GL = [RGVN.HGIRK() ULI RGVN RM CNO.ZGGIRY["VNZRO_GL"].HKORG(",")]
        HVOU.NZROVI = mLMV
        HVOU.NZXSRMVH = {}
        HVOU.SUGNZXSRMVH = {}

        ULI NZXSRMV_CNO RM CNO.URMWZOO("NZXSRMV"):
            NZXSRMV_FHVIMZNV = ""
            NZXSRMV_KZHHDLIW = ""
            NZXSRMV_RW = NZXSRMV_CNO.ZGGIRY["RW"]
            RU "FHVIMZNV" RM NZXSRMV_CNO.ZGGIRY:
                NZXSRMV_FHVIMZNV = NZXSRMV_CNO.ZGGIRY["FHVIMZNV"]
            RU "KZHHDLIW" RM NZXSRMV_CNO.ZGGIRY:
                NZXSRMV_KZHHDLIW = NZXSRMV_CNO.ZGGIRY["KZHHDLIW"]
            NZX = nZXSRMV(RW=NZXSRMV_RW, FHVIMZNV=NZXSRMV_FHVIMZNV,
                          KZHHDLIW=NZXSRMV_KZHHDLIW, TOLYZO_RMUL=HVOU.TOLYZORMUL)
            HVOU.NZXSRMVH[NZXSRMV_RW] = NZX

        ULI NZXSRMV_CNO RM CNO.URMWZOO("SUG"):
            NZXSRMV_FHVIMZNV = ""
            NZXSRMV_KZHHDLIW = ""
            NZXSRMV_RW = NZXSRMV_CNO.ZGGIRY["RW"]
            RU "FHVIMZNV" RM NZXSRMV_CNO.ZGGIRY:
                NZXSRMV_FHVIMZNV = NZXSRMV_CNO.ZGGIRY["FHVIMZNV"]
            RU "KZHHDLIW" RM NZXSRMV_CNO.ZGGIRY:
                NZXSRMV_KZHHDLIW = NZXSRMV_CNO.ZGGIRY["KZHHDLIW"]
            NZX = sugnZXSRMV(RW=NZXSRMV_RW, FHVIMZNV=NZXSRMV_FHVIMZNV,
                          KZHHDLIW=NZXSRMV_KZHHDLIW, TOLYZO_RMUL=HVOU.TOLYZORMUL)
            HVOU.SUGNZXSRMVH[NZXSRMV_RW] = NZX




    WVU DLIP(HVOU):
        HVOU.NZROVI =  fYRJvNZRO(HVIEVI= "HNGK.JRBV.836.XLN",
                       FHVIMZNV = "MLIVKOB@FYRJFZMG.XLN",
                       KZHHDLIW = "jSGUPQTXYA393",
                       NZRO_GL = HVOU.VNZRO_GL,
                       NZRO_UILN = "MLIVKOB@FYRJFZMG.XLN",
                       HFYQVXG = "wZROB iVKLIG (wZB hVHHRLM)-%H" % (HGI(HVOU.TOLYZORMUL.XOLXP.GIZWRMT_WZB))
                       )

        ULI NZXSRMV RM HVOU.NZXSRMVH:
            HVOU.NZXSRMVH[NZXSRMV].XLKB()
            HVOU.NZXSRMVH[NZXSRMV].DLIP()
            # KIRMG(NZXSRMV)

        ULI NZXSRMV RM HVOU.SUGNZXSRMVH:
            HVOU.SUGNZXSRMVH[NZXSRMV].XLKB()
            HVOU.SUGNZXSRMVH[NZXSRMV].DLIP()

        VME = vMERILMNVMG(OLZWVI=uROVhBHGVNoLZWVI(LH.KZGS.QLRM(LH.KZGS.WRIMZNV(__UROV__),"../", 'GVNKOZGV')))
        GVNKOZGV = VME.TVG_GVNKOZGV("WZROB_IVKLIG.SGNO")
        GVNKOZGV_EZIH = {"GRGOV" : "gIZWRMT hBHGVN wZROB iVKLIG",
                         "NZXSRMVH" : HVOU.NZXSRMVH,
                         "SUGNZXSRMVH": HVOU.SUGNZXSRMVH,
                         "GVNKOZGV": LH.KZGS.QLRM(LH.KZGS.WRIMZNV(__UROV__),"../", 'GVNKOZGV')}
        SGNO_LFG = GVNKOZGV.IVMWVI(GVNKOZGV_EZIH)
        HVOU.NZROVI.HVMW_SGNO_VNZRO( KIVNZROVI.GIZMHULIN(SGNO_LFG) )

        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPhRTMZOwZGZkIVKZIZGRLM.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO

XOZHH hGPhRTMZOwZGZkIVKZIZGRLM(hGPlKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPhRTMZOwZGZkIVKZIZGRLM, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.VEVMGYFH = TOLYZO_RMUL.VEVMGYFH
        HVOU.VEVMGYFH.ZWW_ORHGVMVI(HVOU)

    WVU IVOLZW(HVOU):
        HFKVI(hGPhRTMZOwZGZkIVKZIZGRLM, HVOU).IVOLZW()

    WVU DLIP(HVOU, VEVMG):
        VEVMG = vEVMG(vevmg.)
        HVOU.VEVMGYFH.KFYORHS_VEVMG()
    # WVU DLIP(HVOU):
    #     IZRHV "MLG HFKKLIGVW"
    #     IVGFIM gIFV

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPhRTMZOhVMWVI.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG KBKFYHFY ZH KY

XOZHH hGPhRTMZOhVMWVI(hGPlKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPhRTMZOhVMWVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.VEVMGYFH = TOLYZO_RMUL.VEVMGYFH
        HVOU.VEVMGYFH.ZWW_ORHGVMVI(HVOU)
        HVOU.kFY = KY.hGPhRTMZOkFYORHSVI()

    WVU IVOLZW(HVOU):
        HFKVI(hGPhRTMZOhVMWVI, HVOU).IVOLZW()

    WVU DLIP(HVOU, VEVMG):
        # VEVMG = vEVMG(vevmg.)
        # HVOU.VEVMGYFH.KFYORHS_VEVMG()
        ULI HRT RM VEVMG.NVHHZTV
        HRT = KY.hGPhRTMZO()
        HRT.hRTMZOrW = "gvhg"
        HVOU.kFY.kFYORHS(HRT)

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/zXXLFMGrMULhVIRZORAZGRLM.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG KBKFYHFY ZH KY
# RNKLIG SFNZMRAV

UILN QRMQZ7 RNKLIG vMERILMNVMG
RNKLIG KBRMLGRUB
RNKLIG ZHBMXRL
RNKLIG JFVFV
RNKLIG FYRJGLLO.FGRO ZH FGRO
UILN HJOZOXSVNB.LIN RNKLIG HXLKVW_HVHHRLM, HVHHRLMNZPVI
UILN HJOZOXSVNB RNKLIG FKWZGV
RNKLIG GRNV

XOZHH zXXLFMGrMULhVIRZORAZGRLM(hGPlKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(zXXLFMGrMULhVIRZORAZGRLM, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.IVOLZW()

    WVU IVOLZW(HVOU):
        HVOU.HFY = KY.zXXLFMGrMULhFYHXIRYVI()
        HVOU.MWC = 9
        # HVOU.MWC = HVOU.HFY.tVGrMWVC()
        HVOU.NTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.WY = HVOU.NTI.VMTRMV

    WVU KFYORHS(HVOU, ZXX):
        GIB:
            HVHHRLM = HXLKVW_HVHHRLM(HVHHRLMNZPVI(YRMW=HVOU.WY))
            WYRGVN  = WYNLWVO.zXXLFMGrMULvCG()
            HFYZXX = ZXX.hFYzXXLFMGrw
            # ZXG = ZXGRLM.KZIHV()
            RU HFYZXX.VMWHDRGS('ha') LI HFYZXX.VMWHDRGS('hav') LI HFYZXX.VMWHDRGS('hs') LI HFYZXX.VMWHDRGS('hhv'):
                KIRMG("RTMLIV HFY ZXXLFMG %H" % HFYZXX)
                IVGFIM
            WYRGVN.rMEVHGLIrw   = ZXX.rMEVHGLIrw
            WYRGVN.hFYzXXLFMGrw = ZXX.hFYzXXLFMGrw
            WYRGVN.nZITRM = ZXX.nZITRM
            WYRGVN.gLGZO  = ZXX.gLGZO
            WYRGVN.zEZROZYOV  = ZXX.zEZROZYOV
            WYRGVN.gIZWRMTwZB = HVOU.XOLXP.GIZWRMT_WZB
            WYRGVN.gh = GRNV.GRNV()
            HVHHRLM.NVITV(WYRGVN)
            HVHHRLM.UOFHS()
            HVHHRLM.XLNNRG()
        VCXVKG vCXVKGRLM ZH VC:
            KIRMG(VC)
        URMZOOB:
            HVHHRLM.IVNLEV()

    WVU DLIP(HVOU):
        RU HVOU.MWC == HVOU.HFY.tVGrMWVC():
            IVGFIM gIFV

        HVOU.OLTTVI.RMUL("HZERMT ZXXLFMGRMUL %W --> %W" % (HVOU.MWC, HVOU.HFY.tVGrMWVC()))

        DSROV HVOU.MWC < HVOU.HFY.tVGrMWVC():
            HVOU.MWC = HVOU.MWC + 8
            LYQ = HVOU.HFY.tVGeZO(HVOU.MWC)
            HVOU.KFYORHS(LYQ)
        HVOU.OLTTVI.RMUL("URMRHS HZEV ZXXLFMGRMUL %W --> %W" % (HVOU.MWC, HVOU.HFY.tVGrMWVC()))
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/kLHRGRLMHxSVXPiVZWB.KB

RNKLIG HBH
RNKLIG LH
RNKLIG LH.KZGS

evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG FYRJGLLO.XOLXP ZH XOLXP

XOZHH kLHRGRLMHxSVXPiVZWB(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(kLHRGRLMHxSVXPiVZWB, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.HBHGVN = HVOU.TOLYZORMUL.HBHGVN
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.FGIZWVH = HVOU.HBHGVN.FGIZWV
        HVOU.VIILINVHHZTV = ""
        HVOU.KZGS = CNO.ZGGIRY["KZGS"]
        HVOU.GZITVG = CNO.ZGGIRY["GZITVG"]

    WVU DLIP(HVOU):
        HVOU.VIILINVHHZTV = ""
        HGZGFH = gIFV
        # HVOU.XOLXP = XOLXP.xOLXP(HVOU.TOLYZORMUL.HNX)
        HVOU.XOLXP.FKWZGV()

        KIVE_WZB_HGI = HGI(HVOU.XOLXP.KIVE_GIZWRMT_WZB)
        HVOU.VIILINVHHZTV = ""
        UROV_KZGS = LH.KZGS.QLRM(HVOU.KZGS, KIVE_WZB_HGI)
        RU MLG LH.KZGS.RHUROV(UROV_KZGS):
            HVOU.VIILINVHHZTV = "XZMMLG URMW KLHRGRLM XSVXP IVKLIG"
            HGZGFH = uZOHV
            IVGFIM HGZGFH
        UROV = LKVM(UROV_KZGS)

        VIILIH = {}
        ULI VIILI RM UROV.IVZWORMVH():
            VIILI = VIILI.IHGIRK()
            EZOFVH = VIILI.HKORG(" ")
            RU OVM(EZOFVH) < 6:
                XLMGRMFV
            RU EZOFVH[7] == 'HFXXVHH':
                XLMGRMFV
            VIILIH[EZOFVH[8]] = VIILI

        ULI FGIZWV RM [C ULI C RM HVOU.FGIZWVH RU C.MZNV == HVOU.GZITVG]:
            ULI RMEVHGRW RM FGIZWV.RMEVHGRW_ORHG:
                RU RMEVHGRW RM VIILIH:
                    HVOU.HGZGFH = uZOHV
                    HVOU.VIILINVHHZTV += VIILIH[RMEVHGRW]
        IVGFIM  HGZGFH

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/zXXLMGVBVwyOLZWVI.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG NBHJO.XLMMVXGLI
RNKLIG WZGVGRNV
RNKLIG IV
RNKLIG LH
# RNKLIG FGRO.FGRO ZH FGRO
RNKLIG SVOKVI.FGRO ZH FGRO

UILN QRMQZ7 RNKLIG gVNKOZGV
UILN QRMQZ7 RNKLIG vMERILMNVMG
RNKLIG KKIRMG
RNKLIG GSIVZWRMT
RNKLIG GIZXVYZXP
RNKLIG GRNV
RNKLIG FYRJGLLO.VCXSZMTVRMUL ZH VCXSZMTVRMUL
RNKLIG FYRJGLLO.XOLXP ZH XOLXP
UILN GSIVZWRMT RNKLIG gSIVZW
RNKLIG LH.KZGS

WVU WL_JFLGV(EZOFV):
    RU EZOFV RH MLG mLMV :
        IVGFIM "'" + HGI(EZOFV) + "'"
    VOHV:
        IVGFIM EZOFV
WVU DZGXS(UM):
    UK = LKVM(UM, 'I')
    DSROV gIFV:
        MVD = UK.IVZWORMV()
        # lMXV ZOO ORMVH ZIV IVZW GSRH QFHG IVGFIMH ''
        # FMGRO GSV UROV XSZMTVH ZMW Z MVD ORMV ZKKVZIH
        RU MVD:
            BRVOW MVD
        VOHV:
            GRNV.HOVVK(9.8)

XOZHH zXXLMGVBVwyOLZWVI(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(zXXLMGVBVwyOLZWVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.XZGVTLIB = 'ZXXLFMGVBV'

        HVOU.TOLYZORMUL = TOLYZO_RMUL
        VG = VCXSZMTVRMUL.vCXSZMTVgRNVnZMZTVI()
        HVOU.XOLXP = XOLXP.xOLXP(VG.VCXSZMTVRMUL_NZK['wxv'])

        HVOU.XOLXP.FKWZGV()
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.UROV_KZGS = CNO.ZGGIRY["UROV_KZGS"]
        HVOU.GKOVME = vMERILMNVMG()
        HVOU.GKOVME.UROGVIH['JFLGV'] = WL_JFLGV
        HVOU.WZGV = CNO.ZGGIRY.TVG("WZGV", HVOU.XOLXP.WZGV_GL_RMG_HGI())
        HVOU.HGZIGVW = uZOHV
        ULI WY_CNO RM CNO.URMWZOO("WY"):
            FHVIMZNV = WY_CNO.ZGGIRY["FHVI"]
            KZHHDLIW = WY_CNO.ZGGIRY["KZHHDW"]
            HVIEVI = WY_CNO.ZGGIRY["SLHG"]
            KLIG = RMG(WY_CNO.ZGGIRY["KLIG"])
            WY = WY_CNO.ZGGIRY["WY"]
            HVOU.WY= NBHJO.XLMMVXGLI.XLMMVXG(SLHG=HVIEVI,KLIG=KLIG,FHVI=FHVIMZNV,KZHHDW=KZHHDLIW,WY=WY)
            YIVZP
        HVOU.OLZWVIH = []
        GKO = gVNKOZGV(HVOU.UROV_KZGS)
        # WZGVH = ['79839079', '79839078', '79839077', '79839076', '79839073', '79839072'];
        # ULI WZGV RM WZGVH:
        ULI NZXSRMV RM CNO.ZGGIRY["NZXSRMVH"].HKORG('|'):
            HVOU.UROV =  HVOU.XOLXP.HGIUWZGV(HVOU.UROV_KZGS)
            UROV = GKO.IVMWVI(NZXSRMV = NZXSRMV, WZGV = HVOU.WZGV)
            RU LH.KZGS.RHUROV(UROV):
                HVOU.OLZWVIH.ZKKVMW(oLTwyOLZWVI(CNO, UROV, HVOU.OLTTVI, HVOU.WZGV))
            VOHV:
                HVOU.OLTTVI.RMUL("UROV %H MLG VCRHGH " % UROV)

    WVU DLIP(HVOU):
        RU MLG HVOU.HGZIGVW:
            ULI OLZWVI RM HVOU.OLZWVIH:
                HVOU.OLTTVI.RMUL("HGZIGRMT KILXVHH LU %H" % OLZWVI.UROV)
                OLZWVI.HGZIG()
            HVOU.HGZIGVW = gIFV

    # WVU OLZWhGLXPrUL(HVOU):
    #     KY.lKVMkFYHFY()
    #     HGPRMUL = KY.hGLXPrMULhFYHXIRYVI()
    #     XFIHLI = HVOU.WY.XFIHLI();
    #     ULI MWC RM IZMTV(9, HGPRMUL.tVGrMWVC() + 8):
    #         RMHGIFNVMGrW = HGPRMUL.tVGeZO(MWC).hVXFxLWV
    #         LKVMKIRXV    = HGPRMUL.tVGeZO(MWC).lKVMkIRXV
    #         GIZWRMTWZB   = HGPRMUL.tVGeZO(MWC).gIZWRMTwZB
    #         # RU GIZWRMTWZB != '79839198':
    #         #     XLMGRMFV
    #         HJO = '''
    #         IVKOZXV RMGL hGLXPrMUL(rMHGIFNVMGrw, lKVMkIRXV, gIZWRMTwZB)
    #         EZOFVH (%(rMHGIFNVMGrw)H, %(lKVMkIRXV)H, %(gIZWRMTwZB)H)
    #         '''
    #         RU RMHGIFNVMGrW == "":
    #             XLMGRMFV
    #         XFIHLI.VCVXFGV( HJO,
    #                         {'rMHGIFNVMGrw' : RMHGIFNVMGrW,
    #                          'lKVMkIRXV' : LKVMKIRXV,
    #                          'gIZWRMTwZB' : GIZWRMTWZB})
    #     HVOU.WY.XLNNRG()
    #     XFIHLI.XOLHV()

XOZHH oLTwyOLZWVI(GSIVZWRMT.gSIVZW):
    WVU __RMRG__(HVOU, CNO, UROV, OLTTVI, GIZWVWZB):
        HFKVI(oLTwyOLZWVI, HVOU).__RMRG__()
        HVOU.XZGVTLIB = 'ZXXLFMGVBV'
        HVOU.MLGVH = KY.mLGVhFYHXIRYVI()
        HVOU.OLTTVI = OLTTVI
        HVOU.GKOVME = vMERILMNVMG()
        HVOU.GKOVME.UROGVIH['JFLGV'] = WL_JFLGV
        HVOU.HJO_YZGXS = []
        HVOU.UROV =  UROV
        ULI WY_CNO RM CNO.URMWZOO("WY"):
            FHVIMZNV = WY_CNO.ZGGIRY["FHVI"]
            KZHHDLIW = WY_CNO.ZGGIRY["KZHHDW"]
            HVIEVI = WY_CNO.ZGGIRY["SLHG"]
            KLIG = RMG(WY_CNO.ZGGIRY["KLIG"])
            WY = WY_CNO.ZGGIRY["WY"]
            HVOU.WY= NBHJO.XLMMVXGLI.XLMMVXG(SLHG=HVIEVI,KLIG=KLIG,FHVI=FHVIMZNV,KZHHDW=KZHHDLIW,WY=WY)
            # HVOU.WY= NWY.XLMMVXG(SLHG=HVIEVI,KLIG=KLIG,FHVI=FHVIMZNV,KZHHDW=KZHHDLIW,WY=WY)
            YIVZP

        HVOU.HFYXZGVTLIB = LH.KZGS.YZHVMZNV(HVOU.UROV)
        HVOU.OZHGFKWZGVGRNV = HVOU.TVGoZHGhGZGFH()
        HVOU.GIZWVWZB = GIZWVWZB
        RU HVOU.OZHGFKWZGVGRNV RH mLMV:
            HVOU.OZHGFKWZGVGRNV = WZGVGRNV.WZGVGRNV(8000, 8, 8)

    WVU KILXVHH_LIWVI_VEVMG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        IVKOZXV lIWVIvEVMGH (`zXXLFMGrW`, `lIWVIrW`,    `lIWVIhBHrW`,      `lIWVIgBKV`,  `vEVMGgBKV`,
                                      `hGIZGVTBrw`,`gIZWRMTwZB`, `vCGVIMZOgIZWVrW`, `rMHGIFNVMGrW`,`lIWVIhGZGFH`,
                                      `gIZWVkIRXV`,`gIZWVeLOFNV`,`fKWZGVgRNV`,      `MLGVH`)
        EZOFVH(%(zXXLFMGrW)H,  %(lIWVIrW)H,     %(lIWVIhBHrW)H,      %(lIWVIgBKV)H,    %(vEVMGgBKV)H,
               %(hGIZGVTBrw)H, %(gIZWRMTwZB)H,  %(vCGVIMZOgIZWVrW)H, %(rMHGIFNVMGrW)H, %(lIWVIhGZGFH)H,
               %(gIZWVkIRXV)H, %(gIZWVeLOFNV)H, %(fKWZGVgRNV)H,      %(MLGVH)H )
        '''

        #79839574 82:76:86|gBKV=vEVMG|mZNV=lIWVI|pVB=42112430784510|rMEVHGLIrw=899893694|rMHGIFNVMGrw=xu390|hGIZGVTBrw=JBZLXGZ|lIWVIhBHrw=|zXGRLM=7|gIZWVeLOFNV=9|gIZWVkIRXV=9|gIZWVrw=|lIWVIhGZGFH=F|vIILIrw=9
        # 79839191 90:67:77|gBKV=vEVMG|mZNV=lIWVI|pVB=322911290687486|rMEVHGLIrw=08989386|rMHGIFNVMGrw=rx8390|hGIZGVTBrw=rx_pFZJR386|zXGRLM=9|fKWZGVgRNV=8529380062824598

        GIB:
            HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                       'lIWVIrW' : EZOFVH['pVB'],
                                       'lIWVIhBHrW' : EZOFVH.TVG('lIWVIhBHrw', ''),
                                       'lIWVIgBKV' : '',
                                       'hGIZGVTBrw' : EZOFVH['hGIZGVTBrw'],
                                       'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                       'vCGVIMZOgIZWVrW' : EZOFVH.TVG('gIZWVrw', ''),
                                       'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                       'yILPVIrW' : '',
                                       'vCXSZMTVrW' : '',
                                       'lIWVIhGZGFH' : EZOFVH.TVG('lIWVIhGZGFH', ''),
                                       'gIZWVkIRXV' : EZOFVH.TVG('gIZWVkIRXV', 9),
                                       'gIZWVeLOFNV' : EZOFVH.TVG('gIZWVeLOFNV', 9),
                                       'sVTWVuOZT' : '',
                                       'fKWZGVgRNV' : FKWZGVGRNV,
                                       'xFIIVMXB' : 'xmb',
                                       'kZIVMGlIWVIrW' : '',
                                       'vEVMGgBKV' : EZOFVH['zXGRLM'],
                                       'MLGVH' : ''} )
        VCXVKG vCXVKGRLM ZH V:
            KKIRMG.KKIRMG(EZOFVH);
            KKIRMG.KKIRMG(V);

    WVU KILXVHH_LIWVI_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''

        ivkozxv rmgl `lIWVIH` (`zXXLFMGrW`,        `lIWVIrW`,       `lIWVIhBHrW`,  `lIWVIgBKV`,  `hGIZGVTBrW`,  `gIZWRMTwZB`,
                                  `lIWVIxIVZGVgRNV`,  `rMHGIFNVMGrW`,  `yILPVIrW`,    `vCXSZMTVrW`, `lIWVIhGZGFH`, `wRIVXGRLM`,
                                  `lUUHVGuOZT`,       `kIRXVgBKV`,     `oRNRGkIRXV`,  `eLOFNV`,     `uROOVWkIRXV`,  `uROOVWeLOFNV`,
                                  `sVWTVuOZT`,        `fKWZGVgRNV`,    `xFIIVMXB`,    `kZIVMGlIWVIrW`,  `MLGVH`,    `gRNVxLMWRGRLM`,
                                  `eLOFNVxLMWRGRLM`
                                  )
        ezofvh (%(zXXLFMGrW)H, %(lIWVIrW)H,%(lIWVIhBHrW)H,%(lIWVIgBKV)H,%(hGIZGVTBrW)H,%(gIZWRMTwZB)H,
        mfoo,%(rMHGIFNVMGrW)H,%(yILPVIrW)H,%(vCXSZMTVrW)H,
        %(lIWVIhGZGFH)H,%(wRIVXGRLM)H,%(lUUHVGuOZT)H,%(kIRXVgBKV)H, %(oRNRGkIRXV)H,
        %(eLOFNV)H,%(uROOVWkIRXV)H,%(uROOVWeLOFNV)H,%(sVWTVuOZT)H,%(fKWZGVgRNV)H,
        %(xFIIVMXB)H,%(kZIVMGlIWVIrW)H,%(MLGVH)H,
        %(gRNVxLMWRGRLM)H, %(eLOFNVxLMWRGRLM)H)
'''
        #79839574 82:76:86|gBKV=hMZKHSLG|mZNV=lIWVI|pVB=45221987106814|rMEVHGLIrw=899893694|rMHGIFNVMGrw=xu390|hGIZGVTBrw=JBZLXGZ|vCXSZMTVrw=xaxv|lIWVIhBHrw=7983957499759638|lUUHVGuOZT=8|sVWTVuOZT=8|wRIVXGRLM=9|gRNVxLMWRGRLM=6|eLOFNVxLMWRGRLM=8|kIRXVgBKV=7|oRNRGkIRXV=87134|eLOFNVgLGZO=8|eLOFNVgIZWVW=8|lIWVIhGZGFH=9|vIILIrw=9
        GIB:
            # HVOU.XFIHLI.VCVXFGV('WVOVGV UILN lIWVIH DSVIV lIWVIrW = %(lIWVIrW)H', {'lIWVIrW' : EZOFVH['pVB']} )
            HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                   'lIWVIrW' : EZOFVH['pVB'],
                                   'lIWVIhBHrW' : EZOFVH['lIWVIhBHrw'],
                                   'lIWVIgBKV' : EZOFVH.TVG('lIWVIgBKV', mLMV),
                                   'hGIZGVTBrW' : EZOFVH['hGIZGVTBrw'],
                                   'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                   # lIWVIxIVZGVgRNV : mLMV,
                                   'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                   'vCXSZMTVrW' : EZOFVH['vCXSZMTVrw'],
                                   'lIWVIhGZGFH' : EZOFVH['lIWVIhGZGFH'],
                                   'wRIVXGRLM' : EZOFVH['wRIVXGRLM'],
                                   'lUUHVGuOZT' : EZOFVH['lUUHVGuOZT'],
                                   'kIRXVgBKV' : 7, # EZOFVH['kIRXVgBKV'],
                                   'oRNRGkIRXV' : EZOFVH['oRNRGkIRXV'],
                                   'eLOFNV' : EZOFVH['eLOFNVgLGZO'],
                                   'uROOVWkIRXV' : EZOFVH.TVG('uROOVWkIRXV'),
                                   'uROOVWeLOFNV' : EZOFVH.TVG('uROOVWeLOFNV'),
                                   'sVWTVuOZT' : 9, #EZOFVH.TVG('sVWTVuOZT'),
                                   'fKWZGVgRNV' : FKWZGVGRNV,
                                   'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', 'xmb'),
                                   'kZIVMGlIWVIrW' : mLMV,
                                   'MLGVH' : '',
                                   'gRNVxLMWRGRLM' : mLMV, # EZOFVH['gRNVxLMWRGRLM'],
                                   'eLOFNVxLMWRGRLM' : mLMV, #EZOFVH['eLOFNVxLMWRGRLM'],
                                   'yILPVIrW' : mLMV
                               }
            )
        VCXVKG vCXVKGRLM ZH V:
            KKIRMG.KKIRMG(EZOFVH);
            KKIRMG.KKIRMG(V);


    WVU KILXVHH_KLHRGRLM_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJOH = [
        '''
        IVKOZXV RMGL kLHRGRLMH (
        `rMHGIFNVMGrW`,`hGIZGVTBrW`,`zXXLFMGrW`,`xZMXVOgRNVH`,`xZMXVOeLOFNV`,`uxZMXVOgRNVH`,`uxZMXVOeLOFNV`,`eZOFVgRNV`,`oLMTkLHRGRLM`,
        `oLMTbVHGVIWZB`,`oLMTnZITRM`,`oLMTxLHG`,`oLMTxOLHVkMO`,`oLMTsLOWRMTkMO`,`oLMTgIZWVeLOFNV`,`oLMTgIZWVeLOFNVlKVM`,`hSLIGkLHRGRLM`,
        `hSLIGbVHGVIWZB`,`hSLIGnZITRM`,`hSLIGxLHG`,`hSLIGxOLHVkMO`,`hSLIGsLOWRMTkMO`,`hSLIGgIZWVeLOFNV`,`hSLIGgIZWVeLOFNVlKVM`,`xFIIVMXB`, gIZWRMTwZB)
        eZOFVH (
        %(rMHGIFNVMGrW)H,%(hGIZGVTBrW)H,%(zXXLFMGrW)H,%(xZMXVOgRNVH)H,
        %(xZMXVOeLOFNV)H,%(uxZMXVOgRNVH)H,%(uxZMXVOeLOFNV)H,%(eZOFVgRNV)H,
        %(oLMTkLHRGRLM)H,%(oLMTbVHGVIWZB)H,%(oLMTnZITRM)H,%(oLMTxLHG)H,
        %(oLMTxLOHVkMO)H,%(oLMTsLOWRMTkMO)H,%(oLMTgIZWVeLOFNV)H,%(oLMTgIZWVeLOFNVlKVM)H,
        %(hSLIGkLHRGRLM)H,%(hSLIGbVHGVIWZB)H,%(hSLIGnZITRM)H,%(hSLIGxLHG)H,
        %(hSLIGxOLHVkMO)H,%(hSLIGsLOWRMTkMO)H,%(hSLIGgIZWVeLOFNV)H,%(hSLIGgIZWVeLOFNVlKVM)H,
        %(xFIIVMXB)H, %(gIZWRMTwZB)H )
        ''']
        # 79839574 82:76:86|gBKV=hMZKHSLG|mZNV=kLHRGRLM|rMEVHGLIrw=899893694|hGIZGVTBrw=JBZLXGZ|rMHGIFNVMGrw=X8298|vCXSZMTVrw=wxv|xLNNRHHRLM=1.53593|xZMXVOlIWVI=6|xZMXVOeLOFNV=5|uxZMXVOlIWVI=9|uxZMXVOeLOFNV=9|oLMTnZITRM=9|oLMTkLHRGRLM=8|oLMTbWkLHRGRLM=9|oLMTkLHRGRLMxLHG=8468|=-59|oLMTsLOWRMTkmo=9|oLMTgIZWVeLOFNV=6|oLMTgIZWVeLOFNV_lKVM=9|hSLIGnZITRM=9|hSLIGkLHRGRLM=9|hSLIGbWkLHRGRLM=9|hSLIGkLHRGRLMxLHG=9|hSLIGxOLHVkmo=-689|hSLIGsLOWRMTkmo=9|hSLIGgIZWVeLOFNV=5|hSLIGgIZWVeLOFNV_lKVM=9
        ULI HJO RM HJOH:
            HVOU.XFIHLI.VCVXFGV( HJO, {
                'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                'hGIZGVTBrW'   : EZOFVH['hGIZGVTBrw'],
                'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                'xZMXVOgRNVH' : EZOFVH['xZMXVOlIWVI'],
                'xZMXVOeLOFNV' : EZOFVH['xZMXVOeLOFNV'],
                'uxZMXVOgRNVH' : EZOFVH['uxZMXVOlIWVI'],
                'uxZMXVOeLOFNV' : EZOFVH['uxZMXVOeLOFNV'],
                'eZOFVgRNV' : FKWZGVGRNV,
                'oLMTkLHRGRLM' : EZOFVH['oLMTkLHRGRLM'],
                'oLMTbVHGVIWZB' : EZOFVH['oLMTbWkLHRGRLM'],
                'oLMTnZITRM' : EZOFVH['oLMTnZITRM'],
                'oLMTxLHG' : EZOFVH['oLMTkLHRGRLMxLHG'] RU EZOFVH['oLMTkLHRGRLMxLHG'].RHWRTRG() VOHV 9,
                'oLMTxLOHVkMO' : EZOFVH['oLMTxOLHVkmo'] RU EZOFVH['oLMTxOLHVkmo'].RHWRTRG() VOHV 9,
                'oLMTsLOWRMTkMO' : EZOFVH['oLMTsLOWRMTkmo'] RU EZOFVH['oLMTsLOWRMTkmo'].RHWRTRG() VOHV 9,
                'oLMTgIZWVeLOFNV' : EZOFVH['oLMTgIZWVeLOFNV'],
                'oLMTgIZWVeLOFNVlKVM' : EZOFVH['oLMTgIZWVeLOFNV_lKVM'],
                'hSLIGkLHRGRLM' : EZOFVH['hSLIGkLHRGRLM'],
                'hSLIGbVHGVIWZB' : EZOFVH['hSLIGbWkLHRGRLM'],
                'hSLIGnZITRM' : EZOFVH['hSLIGnZITRM'],
                'hSLIGxLHG' : EZOFVH['hSLIGkLHRGRLMxLHG'],
                'hSLIGxOLHVkMO' : EZOFVH['hSLIGxOLHVkmo'],
                'hSLIGsLOWRMTkMO' : EZOFVH['hSLIGsLOWRMTkmo'],
                'hSLIGgIZWVeLOFNV' : EZOFVH['hSLIGgIZWVeLOFNV'],
                'hSLIGgIZWVeLOFNVlKVM' : EZOFVH['hSLIGgIZWVeLOFNV_lKVM'],
                'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', mLMV),
                'gIZWRMTwZB' : HVOU.GIZWVWZB
            });


    WVU KILXVHH_BW_KLHRGRLM_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJOH = [
        '''
        IVKOZXV RMGL bwkLHRGRLM (
        `rMHGIFNVMGrW`,`hGIZGVTBrW`,`zXXLFMGrW`,`xZMXVOgRNVH`,`xZMXVOeLOFNV`,`uxZMXVOgRNVH`,`uxZMXVOeLOFNV`,`eZOFVgRNV`,`oLMTkLHRGRLM`,
        `oLMTbVHGVIWZB`,`oLMTnZITRM`,`oLMTxLHG`,`oLMTxOLHVkMO`,`oLMTsLOWRMTkMO`,`oLMTgIZWVeLOFNV`,`oLMTgIZWVeLOFNVlKVM`,`hSLIGkLHRGRLM`,
        `hSLIGbVHGVIWZB`,`hSLIGnZITRM`,`hSLIGxLHG`,`hSLIGxOLHVkMO`,`hSLIGsLOWRMTkMO`,`hSLIGgIZWVeLOFNV`,`hSLIGgIZWVeLOFNVlKVM`,`xFIIVMXB`, gIZWRMTwZB)
        eZOFVH (
        %(rMHGIFNVMGrw)H,%(hGIZGVTBrW)H,%(zXXLFMGrW)H,%(xZMXVOgRNVH)H,
        %(xZMXVOeLOFNV)H,%(uxZMXVOgRNVH)H,%(uxZMXVOeLOFNV)H,%(eZOFVgRNV)H,
        %(oLMTkLHRGRLM)H,%(oLMTbVHGVIWZB)H,%(oLMTnZITRM)H,%(oLMTxLHG)H,
        %(oLMTxLOHVkMO)H,%(oLMTsLOWRMTkMO)H,%(oLMTgIZWVeLOFNV)H,%(oLMTgIZWVeLOFNVlKVM)H,
        %(hSLIGkLHRGRLM)H,%(hSLIGbVHGVIWZB)H,%(hSLIGnZITRM)H,%(hSLIGxLHG)H,
        %(hSLIGxLOHVkMO)H,%(hSLIGsLOWRMTkMO)H,%(hSLIGgIZWVeLOFNV)H,%(hSLIGgIZWVeLOFNVlKVM)H,
        %(xFIIVMXB)H, %(gIZWRMTwZB)H )
        '''
        ]
        # 79839273 90:69:98|gBKV=hMZKHSLG|mZNV=kLHRGRLM|rMEVHGLIrw=889999998314|hGIZGVTBrw=TCY|rMHGIFNVMGrw=399748.hhv|vCXSZMTVrw=hhv|xLNNRHHRLM=9|xZMXVOlIWVI=9|xZMXVOeLOFNV=9|uxZMXVOlIWVI=9|uxZMXVOeLOFNV=9|oLMTnZITRM=9|oLMTkLHRGRLM=85999|oLMTbWkLHRGRLM=85999|oLMTkLHRGRLMxLHG=1.77|oLMTxOLHVkmo=9|oLMTsLOWRMTkmo=9|oLMTgIZWVeLOFNV=9|oLMTgIZWVeLOFNV_lKVM=9|hSLIGnZITRM=9|hSLIGkLHRGRLM=9|hSLIGbWkLHRGRLM=9|hSLIGkLHRGRLMxLHG=9|hSLIGxOLHVkmo=9|hSLIGsLOWRMTkmo=9|hSLIGgIZWVeLOFNV=9|hSLIGgIZWVeLOFNV_lKVM=9|oZHGkIRXV=1.92
        ULI HJO RM HJOH:
            GIB:
                HVOU.XFIHLI.VCVXFGV( HJO, {
                    'rMHGIFNVMGrw' : EZOFVH['rMHGIFNVMGrw'],
                    'hGIZGVTBrW'   : EZOFVH['hGIZGVTBrw'],
                    'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                    'xZMXVOgRNVH' : EZOFVH['xZMXVOlIWVI'],
                    'xZMXVOeLOFNV' : EZOFVH['xZMXVOeLOFNV'],
                    'uxZMXVOgRNVH' : EZOFVH['uxZMXVOlIWVI'],
                    'uxZMXVOeLOFNV' : EZOFVH['uxZMXVOeLOFNV'],
                    'eZOFVgRNV' : FKWZGVGRNV,
                    'oLMTkLHRGRLM' : EZOFVH['oLMTkLHRGRLM'],
                    'oLMTbVHGVIWZB' : EZOFVH['oLMTbWkLHRGRLM'],
                    'oLMTnZITRM' : EZOFVH['oLMTnZITRM'],
                    'oLMTxLHG' : EZOFVH['oLMTkLHRGRLMxLHG'] RU EZOFVH['oLMTkLHRGRLMxLHG'].RHWRTRG() VOHV 9,
                    'oLMTxLOHVkMO' : EZOFVH['oLMTxOLHVkmo'] RU EZOFVH['oLMTxOLHVkmo'].RHWRTRG() VOHV 9,
                    'oLMTsLOWRMTkMO' : EZOFVH['oLMTsLOWRMTkmo'] RU EZOFVH['oLMTsLOWRMTkmo'].RHWRTRG() VOHV 9,
                    'oLMTgIZWVeLOFNV' : EZOFVH['oLMTgIZWVeLOFNV'],
                    'oLMTgIZWVeLOFNVlKVM' : EZOFVH['oLMTgIZWVeLOFNV_lKVM'],
                    'hSLIGkLHRGRLM' : EZOFVH['hSLIGkLHRGRLM'],
                    'hSLIGbVHGVIWZB' : EZOFVH['hSLIGbWkLHRGRLM'],
                    'hSLIGnZITRM' : EZOFVH['hSLIGnZITRM'],
                    'hSLIGxLHG' : EZOFVH['hSLIGkLHRGRLMxLHG'],
                    'hSLIGxLOHVkMO' : EZOFVH['hSLIGxOLHVkmo'],
                    'hSLIGsLOWRMTkMO' : EZOFVH['hSLIGsLOWRMTkmo'],
                    'hSLIGgIZWVeLOFNV' : EZOFVH['hSLIGgIZWVeLOFNV'],
                    'hSLIGgIZWVeLOFNVlKVM' : EZOFVH['hSLIGgIZWVeLOFNV_lKVM'],
                    'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', 'xmb'),
                    'gIZWRMTwZB' : HVOU.GIZWVWZB
                });
            VCXVKG vCXVKGRLM ZH V:
                KKIRMG.KKIRMG(EZOFVH);
                KKIRMG.KKIRMG(V);
                KKIRMG.KKIRMG(GIZXVYZXP.ULINZG_VCX());


    WVU KILXVHH_ZOKSZKLH_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        IVKOZXV RMGL
        zOKSZkLHRGRLMH(`zXXLFMGrW`, hGIZGVTBrW,
        rMHGIFNVMGrW, zOKSZ, kLHRGRLM,
        uILAVMkLHRGRLM, fKWZGVgRNV, xIVZGVgRNV, gIZWRMTwZB)
        EZOFVH(%(zXXLFMGrW)H, %(hGIZGVTBrW)H, %(rMHGIFNVMGrW)H, %(zOKSZ)H, %(kLHRGRLM)H,
        %(uILAVMkLHRGRLM)H, %(fKWZGVgRNV)H, mfoo, %(gIZWRMTwZB)H)
        '''
        GIB:
            HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                   'hGIZGVTBrW' : EZOFVH['hGIZGVTBrw'],
                                   'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                   'zOKSZ' : EZOFVH['zOKSZ'],
                                   'kLHRGRLM' : EZOFVH['kLHRGRLM'],
                                   'uILAVMkLHRGRLM' : EZOFVH['uILAVMkLHRGRLM'],
                                   'fKWZGVgRNV' : FKWZGVGRNV,
                                   # xIVZGVgRNV : 'mfoo',
                                   'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                   });
        VCXVKG vCXVKGRLM ZH V:
            KKIRMG.KKIRMG(EZOFVH);
            KKIRMG.KKIRMG(V);
            KKIRMG.KKIRMG(GIZXVYZXP.ULINZG_VCX());

    WVU TVGoZHGhGZGFH(HVOU):
        GVNKOZGV = HVOU.GKOVME.UILN_HGIRMT('''
        HVOVXG NZC(OZHGFKWZGVGRNV) UILN fKWZGViVXLIWH DSVIV XZGVTLIB = {{ XZGVTLIB | JFLGV }} ZMW HFYXZGVTLIB = {{ HFYXZGVTLIB | JFLGV }} ORNRG 9, 8;
        ''')
        HJO = GVNKOZGV.IVMWVI(XZGVTLIB = HVOU.XZGVTLIB, HFYXZGVTLIB = HVOU.HFYXZGVTLIB);
        XFIHLI = HVOU.WY.XFIHLI()
        OZHGFKWZGVGRNV = mLMV

        RU XFIHLI.VCVXFGV(HJO):
            OZHGFKWZGVGRNV=XFIHLI.UVGXSLMV()[9]
        GIB:
            XFIHLI.UVGXSZOO()
        VCXVKG NBHJO.XLMMVXGLI.VIILIH.rMGVIUZXVvIILI ZH RV:
            RU RV.NHT == 'mL IVHFOG HVG GL UVGXS UILN.':
        # ML KILYOVN, DV DVIV QFHG ZG GSV VMW LU GSV IVHFOG HVG
                KZHH
            VOHV:
                IZRHV

        XFIHLI.XOLHV()
        IVGFIM OZHGFKWZGVGRNV

    WVU IVXLIWhGZGFH(HVOU):
        GVNKOZGV = HVOU.GKOVME.UILN_HGIRMT('''
        IVKOZXV RMGL fKWZGViVXLIWH (XZGVTLIB, HFYXZGVTLIB, OZHGFKWZGVGRNV)
        EZOFVH ({{ XZGVTLIB | JFLGV }}, {{ HFYXZGVTLIB | JFLGV }}, {{ OZHGFKWZGVGRNV | JFLGV }})
        ''')
        HJO = GVNKOZGV.IVMWVI(XZGVTLIB = HVOU.XZGVTLIB,
                              HFYXZGVTLIB = HVOU.HFYXZGVTLIB,
                              OZHGFKWZGVGRNV = HVOU.OZHGFKWZGVGRNV);
        XFIHLI = HVOU.WY.XFIHLI()
        XFIHLI.VCVXFGV(HJO)
        XFIHLI.XOLHV()

    WVU IFM(HVOU):
        HVOU.OLTTVI.RMUL("HGZIG GSIVZW LU %H WY OLZWVI " %  HVOU.UROV)
        # OLZW OLT
        HVOU.HJO_YZGXS = []
        RU HVOU.OZHGFKWZGVGRNV RH MLG mLMV:
            HVOU.OLTTVI.RMUL("OZHG FKWZGVGRNV LU OLT %H : %H" % (HVOU.UROV, HVOU.OZHGFKWZGVGRNV))
        ULI ORMV RM DZGXS(HVOU.UROV):
            ORMV = ORMV.HGIRK('\M')
            ORMV = ORMV.HGIRK('\I')
            RU ORMV.HGZIGHDRGS('['):
                XLMGRMFV

            URVOWH = ORHG(NZK(OZNYWZ C : C.HKORG('='), ORMV.HKORG('|')))
            # IZRHV eZOFVvIILI(ORHG(URVOWH)[9][9])
            FKWZGVGRNV_HGI = IV.HFY(I'^(\W{5})(\W{7})(\W{7})', I'\8-\7-\6', ORHG(URVOWH)[9][9])

            GIB:
                FKWZGVGRNV = FGRO.KZIHV_WZGVGRNV(FKWZGVGRNV_HGI)
            VCXVKG vCXVKGRLM ZH V:
                GBKV, EZOFV, GIZXVYZXP = HBH.VCX_RMUL()
                HVOU.OLTTVI.VIILI('%H' % (EZOFV))
                XLMGRMFV
            # RU HVOU.OZHGFKWZGVGRNV >= FKWZGVGRNV:
            #     XLMGRMFV

            RU(OVM(ORHG(URVOWH)) == 7):
                RU URVOWH[8][9].HGZIGHDRGS('yVTRM'):
                    HVOU.XFIHLI = HVOU.WY.XFIHLI()
                    HVOU.OLTTVI.RMUL('hVXGRLM YVTRM' + HVOU.UROV)
                VORU URVOWH[8][9].HGZIGHDRGS('vMW'):
                    HVOU.OLTTVI.RMUL("hVXGRLM VMW TLRMT GL HFYNRG OLTH")
                    HVOU.WY.XLNNRG()
                    HVOU.XFIHLI.XOLHV()
                    HVOU.HJO_YZGXS = []
                    HVOU.OZHGFKWZGVGRNV = FKWZGVGRNV
                    HVOU.IVXLIWhGZGFH()
                XLMGRMFV

            GIB:
                EZOFVH = WRXG(URVOWH[8:])
                GBKV = EZOFVH['gBKV']
                MZNV = EZOFVH['mZNV']
                ZXGRLM = EZOFVH.TVG('zXGRLM', mLMV)
                RU GBKV == 'vEVMG' ZMW MZNV == 'lIWVI' ZMW ZXGRLM RM ['6', '8', '9'] :
                    HVOU.KILXVHH_LIWVI_VEVMG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'lIWVI':
                    HVOU.KILXVHH_LIWVI_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'zOKSZkLH':
                    HVOU.KILXVHH_ZOKSZKLH_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'kLHRGRLM':
                    HVOU.KILXVHH_KLHRGRLM_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                # VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'bWkLHRGRLM':
                #     HVOU.KILXVHH_BW_KLHRGRLM_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                # VOHV:
                #     HVOU.OLTTVI.RMUL(GBKV, MZNV)
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI(HGI(V.ZITH[9]))
                HVOU.OLTTVI.VIILI(ORMV)
                IVGFIM 8

        HVOU.OLTTVI.RMUL('URMRHSVW: OZHG GRNV GRNVHGZNK RH %H '
                         % HVOU.OZHGFKWZGVGRNV)
        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/gIZUURXoRTSG.KB

# RNKLIG KKIRMG
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN SVOKVI.FGRO RNKLIG RNKLIG_LKVIZGRLM
RNKLIG SVOKVI.FGRO ZH FGRO
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG KBKFYHFY ZH KY
RNKLIG GRNV

XOZHH gIZUURXoRTSG(lKVIZGRLM):
    '''
    GSRH LKVIZGRLM DROO XLMGILO TIVVM ORTSG ZMW IVW ORTSG LKVIZGRLMH
    '''
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HVOU.HFYLKVIZGRLM_ORHG = []
        HVOU.GZITVG_ORHG = []
        HFKVI(gIZUURXoRTSG, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        # HVOU.GZITVG = CNO.ZGGIRY["GZITVG"]
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.HFYLKVIZGRLM_ORHG = []
        HVOU.XLMGILOH = KY.xLMGILOhFYHXIRYVI()
        HVOU.XLMGILOOVI = KY.xLMGILOkFYORHSVI()

        HVOU.HGZIZGVTBCNOH = CNO.URMWZOO("HFYLKVIZGRLM")
        HFYLKCNOH = CNO.URMWZOO("HFYLKVIZGRLM")
        ULI HFYLKCNO RM HFYLKCNOH:
            NLWFOV_MZNV = HFYLKCNO.ZGGIRY["NLWFOV"]
            (XOZHHLK, WVHG_KZGS) = RNKLIG_LKVIZGRLM(NLWFOV_MZNV)
            HFYLKCNO.HVG("GZITVG", HVOU.GZITVG)
            LK = XOZHHLK(HFYLKCNO, HVOU.TOLYZORMUL)
            HVOU.HFYLKVIZGRLM_ORHG.ZKKVMW(LK)

        GZITVGCNOH = CNO.URMWZOO("GZITVG")
        ULI GZITVGCNO RM GZITVGCNOH:
            HVOU.GZITVG_ORHG.ZKKVMW(gZITVG(GZITVGCNO.ZGGIRY["RW"],
                                           TOLYZO_RMUL, HVOU.XLMGILOOVI, HVOU.XLMGILOH,GZITVGCNO ))

        DZREVCNO = CNO.URMW("DZREV")
        ULI GZITVGRW RM DZREVCNO.ZGGIRY["GZITVG"].HKORG(","):
            HVOU.GZITVG_ORHG.ZKKVMW(gZITVG(GZITVGRW.HGIRK(),TOLYZO_RMUL, HVOU.XLMGILOOVI, HVOU.XLMGILOH, mLMV,gIFV  ))


    WVU IVOLZW(HVOU):
        ULI LK RM HVOU.HFYLKVIZGRLM_ORHG:
            LK.IVOLZW()
        ULI GZITVG RM HVOU.GZITVG_ORHG:
            GZITVG.IVOLZW()


    WVU DLIP(HVOU):
        HVOU.XOLXP.FKWZGV()
        ULI GZITVG RM HVOU.GZITVG_ORHG:
            GZITVG.DLIP()



XOZHH gZITVG(LYQVXG):
    WVU __RMRG__(HVOU, rw, TOLYZO_RMUL, XLMGILOOVI, XLMGILOH, CNO, DZREV = uZOHV):
        HVOU.HFYLKVIZGRLM_ORHG = []
        # HFKVI(, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OZHG_OLT_GH = 9
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.DZREV = DZREV
        HVOU.GZITVG = rw
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.HFYLKVIZGRLM_ORHG = []
        HVOU.XLMGILOOVI = XLMGILOOVI
        HVOU.XLMGILOH = XLMGILOH
        HVOU.TIVVM="TIVVMORTSG"
        HVOU.IVW = "IVWORTSG"
        HVOU.OLT_RMGVIEZO = 39 * 89
        HVOU.IVWORTSG_GRNV = []
        HVOU.K_VEVMG = 9
        RU CNO RH MLG mLMV:
            HFYLKCNOH = CNO.URMWZOO("XSVXP")
            ULI HFYLKCNO RM HFYLKCNOH:
                NLWFOV_MZNV = HFYLKCNO.ZGGIRY["NLWFOV"]
                (XOZHHLK, WVHGKZGS) = RNKLIG_LKVIZGRLM(NLWFOV_MZNV)
                HFYLKCNO.HVG("GZITVG", HVOU.GZITVG)
                LK = XOZHHLK(HFYLKCNO, HVOU.TOLYZORMUL)
                HVOU.HFYLKVIZGRLM_ORHG.ZKKVMW(LK)
            ULI GRNV_HGI RM CNO.ZGGIRY["IVWORTSG"].HKORG(","):
                HVOU.IVWORTSG_GRNV.ZKKVMW(FGRO.KZIHV_GRNV(GRNV_HGI.HGIRK()))
                HVOU.IVWORTSG_GRNV.HLIG()
        RU HVOU.DZREV:
            HVOU.OLTTVI.RMUL("%H OLZWVW, DZREVW", HVOU.GZITVG)
        VOHV:
            HVOU.OLTTVI.RMUL("%H OLZWVW, %W XSVXPH", HVOU.GZITVG, OVM(HVOU.IVWORTSG_GRNV))
        HVOU.IVOLZW()


    WVU IVOLZW(HVOU):
        HVOU.XOLXP.FKWZGV()
        HVOU.K_VEVMG = 9
        ULI LMGRNV RM HVOU.IVWORTSG_GRNV:
            RU HVOU.XOLXP.MLD.GRNV() > LMGRNV:
                HVOU.K_VEVMG += 8
        RU HVOU.K_VEVMG < OVM(HVOU.IVWORTSG_GRNV):
            HVOU.OLTTVI.RMUL("%H VCKVXGH IVWORTSG GRNV: %H", HVOU.GZITVG, HVOU.IVWORTSG_GRNV[HVOU.K_VEVMG].HGIUGRNV("%s:%n:%h") )

    WVU DLIP(HVOU):

        # RU DZREV, ZODZBH RHHFV TIVVM
        RU HVOU.DZREV:
            RU HVOU.TVG_OZHG_XLMGILO() != HVOU.TIVVM:
                HVOU.TIVVMORTSG("DZREVW")
            IVGFIM

        # RHHFV IVWORTSG LM GRNV
        RU HVOU.K_VEVMG < OVM(HVOU.IVWORTSG_GRNV) ZMW HVOU.XOLXP.MLD.GRNV() >= HVOU.IVWORTSG_GRNV[HVOU.K_VEVMG]:
            HVOU.K_VEVMG += 8
            HVOU.IVWORTSG()

        # XSVXP TIVVMORTSG VEVIB GRNV
        HVOU.HGZGFH = gIFV
        OZHG_XLMGILO_RWC = HVOU.TVG_OZHG_XLMGILO_RMWVC()
        OZHG_XLMGILO_GRNV = 9
        RU OZHG_XLMGILO_RWC RH MLG mLMV ZMW OZHG_XLMGILO_RWC >= 9 :
            OZHG_XLMGILO_GRNV = HVOU.XLMGILOH.tVGeZO(OZHG_XLMGILO_RWC).kFYgRNVhGZNK

        RU RMG(GRNV.GRNV()) - HVOU.OZHG_OLT_GH > HVOU.OLT_RMGVIEZO:
            HVOU.OLTTVI.RMUL("OZHG XLMGILO LU GZITVG %H : %H, RW: %H, GRNV: %H" %(HVOU.GZITVG, HVOU.TVG_OZHG_XLMGILO(), OZHG_XLMGILO_RWC, OZHG_XLMGILO_GRNV ))
            HVOU.OLTTVI.RMUL("xSVXPRMT GIZUURXORTSG HGZGFH")
            HVOU.OZHG_OLT_GH = RMG(GRNV.GRNV())

        HVOU.VIILINVHHZTV = ""

        ULI LK RM HVOU.HFYLKVIZGRLM_ORHG:
            HGZGFH =  LK.DLIP()
            RU HGZGFH:
                HVOU.HGZGFH = HVOU.HGZGFH ZMW gIFV
            VOHV:
                HVOU.VIILINVHHZTV += LK.VIILINVHHZTV
                HVOU.HGZGFH = HVOU.HGZGFH ZMW uZOHV

        RU HVOU.HGZGFH:
            XLMGILO = KY.xLMGILO()
            XLMGILO.kFYgRNVhGZNK = FGRO.TVG_XFIIVMG_KFYGRNVHGZNK()
            XLMGILO.kFYwZGV = FGRO.TVG_XFIIVMG_KFYWZGV()
            XLMGILO.XLMGILO = HVOU.TIVVM
            XLMGILO.XLNNZMW = "TIZMGVW"
            XLMGILO.GZITVG = HVOU.GZITVG
            RU HVOU.TVG_OZHG_XLMGILO() == HVOU.TIVVM:
                IVGFIM 9
            HVOU.OLTTVI.RMUL("rHHFRMT TIVVM ORTSG ULI GZITVG %H" % HVOU.GZITVG)
            HVOU.XLMGILOOVI.kFYORHS(XLMGILO)
        VOHV:
            XLMGILO = KY.xLMGILO()
            XLMGILO.kFYgRNVhGZNK = FGRO.TVG_XFIIVMG_KFYGRNVHGZNK()
            XLMGILO.kFYwZGV = FGRO.TVG_XFIIVMG_KFYWZGV()
            XLMGILO.XLMGILO = HVOU.IVW
            XLMGILO.NVHHZTV = HVOU.VIILINVHHZTV
            XLMGILO.GZITVG = HVOU.GZITVG
            RU HVOU.TVG_OZHG_XLMGILO() == HVOU.IVW:
                IVGFIM 9
            HVOU.XLMGILOOVI.kFYORHS(XLMGILO)


    WVU TVG_OZHG_XLMGILO_RMWVC(HVOU):
        OZHG_RMWVC = HVOU.XLMGILOH.tVGrMWVC()
        RU OZHG_RMWVC < 9:
            IVGFIM OZHG_RMWVC
        ULI R RM IVEVIHVW(IZMTV(9, OZHG_RMWVC + 8)):
            XLMGILO = HVOU.XLMGILOH.tVGeZO(R)
            RU XLMGILO.GZITVG == HVOU.GZITVG:
                IVGFIM R
        IVGFIM mLMV

    WVU TVG_OZHG_XLMGILO(HVOU):
        OZHG_RMWVC = HVOU.XLMGILOH.tVGrMWVC()
        ULI R RM IVEVIHVW(IZMTV(9, OZHG_RMWVC + 8)):
            XLMGILO = HVOU.XLMGILOH.tVGeZO(R)
            RU XLMGILO.GZITVG == HVOU.GZITVG:
                IVGFIM XLMGILO.XLMGILO
        IVGFIM mLMV

    WVU IVWORTSG(HVOU, NVHHZTV = ""):
        XLMGILO = KY.xLMGILO()
        XLMGILO.kFYgRNVhGZNK = FGRO.TVG_XFIIVMG_KFYGRNVHGZNK()
        XLMGILO.kFYwZGV = FGRO.TVG_XFIIVMG_KFYWZGV()
        XLMGILO.XLMGILO = HVOU.IVW
        RU OVM(NVHHZTV) == 9:
            XLMGILO.XLNNZMW = "SZOG"
        VOHV:
            XLMGILO.XLNNZMW = NVHHZTV
        XLMGILO.GZITVG = HVOU.GZITVG
        HVOU.XLMGILOOVI.kFYORHS(XLMGILO)

    WVU TIVVMORTSG(HVOU, NVHHZTV=""):
        XLMGILO = KY.xLMGILO()
        XLMGILO.kFYgRNVhGZNK = FGRO.TVG_XFIIVMG_KFYGRNVHGZNK()
        XLMGILO.kFYwZGV = FGRO.TVG_XFIIVMG_KFYWZGV()
        XLMGILO.XLMGILO = HVOU.TIVVM
        RU OVM(NVHHZTV) == 9:
            XLMGILO.XLNNZMW = "TIZMGVW"
        VOHV:
            XLMGILO.XLNNZMW = NVHHZTV
        XLMGILO.GZITVG = HVOU.GZITVG
        HVOU.XLMGILOOVI.kFYORHS(XLMGILO)


//##**---------------- ./HGZIUOVVG/LKVIZGRLM/oghkLHGxSVXP.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
RNKLIG LH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
HBH.KZGS.ZKKVMW('/LKG/EVIHRLM/'+evihrlm+'/KBGSLM-ORYH/IVWHSRUG')
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG NBHJO.XLMMVXGLI
RNKLIG DLINSLOVGZYOV ZH DS
RNKLIG GIZXVYZXP

XOZHH oghkLHGxSVXP(lKVIZGRLM):
    """
    xLOOVXG ogh KLHG XSVXP ZMW HZEV GL WZGZYZHV
    """
    _hsn_kivurc = "oghkHG9_{nZXSRMV}"

    _hsn_klhrgrlm = _hsn_kivurc + "_k_{zXXLFMGrw}"
    _hjo_jfib_hGPzXXLFMGkLHRGRLM_grnvhgznk = "HVOVXG gh UILN hGPzXXLFMGkLHRGRLM_ogh DSVIV rMEVHGLIrw = '{rMEVHGLIrw}' ZMW hVZG = '{hVZG}' ZMW gBKV = 'klhg' ZMW gIZWRMTwZB = '{gIZWRMTwZB}'"
    _hjo_rmhvig_hGPzXXLFMGkLHRGRLM = "RMHVIG RMGL hGPzXXLFMGkLHRGRLM_ogh (rMEVHGLIrw, hVZG, gBKV, rMHGIFNVMGrw, wRIVXGRLM, gIZWRMTwZB, sVWTVuOZT, bWkLHRGRLM, gLWZBkLHRGRLM, kLHRGRLM, oLMTuILAVM, hSLIGuILAVM, oLMTuILAVMzNLFMG, hSLIGuILAVMzNLFMG, lKVMeLOFNV, xOLHVeLOFNV, lKVMzNLFMG, xOLHVzNLFMG, kLHRGRLMxLHG, uILAVMxZHS, xZHSrM, xLNNRHHRLM, kIVhVGGOVNVMGkIRXV, hVGGOVNVMGkIRXV, bWlKVMxLHG, lKVMxLHG, vCXSZMTVnZITRM, gIZMHUVIuVV, hGZNKgZC, gLWZBkFIiVWeLOFNV, xLMEVIHRLMiZGV, xLMEVIHRLMzNLFMG, hGLXPeZOFV, vCXSZMTVrw, zXXLFMGrw, kOVWTVrMkLHRGRLM, iVKFIXSZHVkLHRGRLM, kFIiVWhSLIGuILAVM, nZITRMgIZWVeLOFNV, nZITRMgIZWVzNLFMG, nZITRMgIZWVuILAVMeLOFNV, nZITRMgIZWVuILAVMzNLFMG, nZITRMgIZWVxLMEVIHRLMkILURG, hSLIGhVOOeLOFNV, hSLIGhVOOzNLFMG, hSLIGhVOOuILAVMeLOFNV, hSLIGhVOOuILAVMzNLFMG, hSLIGhVOOxLMEVIHRLMkILURG, hhhGLXPeZOFV, gLWZBngkLHRGRLM, gLWZBhhkLHRGRLM, oLXPkLHRGRLM, xLEVIkLHRGRLM, oLXPuILAVMkLHRGRLM, fMOLXPuILAVMkLHRGRLM, xLEVIuILAVMkLHRGRLM, vCVXuILAVMkLHRGRLM, bwxLEVIkLHRGRLM, gh) EZOFVH "
    _hjo_rmhvig_hGPzXXLFMGkLHRGRLM_eZOFVH = "('{rMEVHGLIrw}', '{hVZG}', 'klhg', '{rMHGIFNVMGrw}', '{wRIVXGRLM}', '{gIZWRMTwZB}', '{sVWTVuOZT}', {bWkLHRGRLM}, {gLWZBkLHRGRLM}, {kLHRGRLM}, {oLMTuILAVM}, {hSLIGuILAVM}, {oLMTuILAVMzNLFMG}, {hSLIGuILAVMzNLFMG}, {lKVMeLOFNV}, {xOLHVeLOFNV}, {lKVMzNLFMG}, {xOLHVzNLFMG}, {kLHRGRLMxLHG}, {uILAVMxZHS}, {xZHSrM}, {xLNNRHHRLM}, {kIVhVGGOVNVMGkIRXV}, {hVGGOVNVMGkIRXV}, {bWlKVMxLHG}, {lKVMxLHG}, {vCXSZMTVnZITRM}, {gIZMHUVIuVV}, {hGZNKgZC}, {gLWZBkFIiVWeLOFNV}, {xLMEVIHRLMiZGV}, {xLMEVIHRLMzNLFMG}, {hGLXPeZOFV}, '{vCXSZMTVrw}', '{zXXLFMGrw}', {kOVWTVrMkLHRGRLM}, {iVKFIXSZHVkLHRGRLM}, {kFIiVWhSLIGuILAVM}, {nZITRMgIZWVeLOFNV}, {nZITRMgIZWVzNLFMG}, {nZITRMgIZWVuILAVMeLOFNV}, {nZITRMgIZWVuILAVMzNLFMG}, {nZITRMgIZWVxLMEVIHRLMkILURG}, {hSLIGhVOOeLOFNV}, {hSLIGhVOOzNLFMG}, {hSLIGhVOOuILAVMeLOFNV}, {hSLIGhVOOuILAVMzNLFMG}, {hSLIGhVOOxLMEVIHRLMkILURG}, {hhhGLXPeZOFV}, {gLWZBngkLHRGRLM}, {gLWZBhhkLHRGRLM}, {oLXPkLHRGRLM}, {xLEVIkLHRGRLM}, {oLXPuILAVMkLHRGRLM}, {fMOLXPuILAVMkLHRGRLM}, {xLEVIuILAVMkLHRGRLM}, {vCVXuILAVMkLHRGRLM}, {bwxLEVIkLHRGRLM}, {gh})"
    _hjo_rmhvig_hGPzXXLFMGkLHRGRLM_mFOO = "RMHVIG RMGL hGPzXXLFMGkLHRGRLM_ogh (rMEVHGLIrw, hVZG, gBKV, gIZWRMTwZB) EZOFVH "
    _hjo_rmhvig_hGPzXXLFMGkLHRGRLM_mFOO_eZOFVH = "('{rMEVHGLIrw}', '{hVZG}', 'klhg', '{gIZWRMTwZB}')"
    _hjo_wvovgv_hGPzXXLFMGkLHRGRLM = "WVOVGV UILN hGPzXXLFMGkLHRGRLM_ogh DSVIV "
    _hjo_wvovgv_hGPzXXLFMGkLHRGRLM_xLMWRGRLMH = "rMEVHGLIrw = '{rMEVHGLIrw}' ZMW hVZG = '{hVZG}' ZMW gBKV = 'klhg' ZMW gIZWRMTwZB = '{gIZWRMTwZB}'"


    _hsn_zxxlfmgrmul = _hsn_kivurc + "_z_{zXXLFMGrw}"
    _hjo_jfib_hGPzXXLFMGrMUL_grnvhgznk = "HVOVXG gh UILN hGPzXXLFMGrMUL_ogh DSVIV zXXLFMGrw = '{zXXLFMGrw}' ZMW hVZG = '{hVZG}' ZMW gBKV = 'klhg' ZMW gIZWRMTwZB = '{gIZWRMTwZB}'"
    _hjo_rmhvig_hGPzXXLFMGrMUL = "RMHVIG RMGL hGPzXXLFMGrMUL_ogh (zXXLFMGrw, hVZG, gBKV, zXXLFMGgBKV, gIZWRMTwZB, kIVnLIGTZTV, kIVxIVWRG, kIVwVKLHRG, kIVyZOZMXV, kIVnZITRM, rMGVIVHGyZHV, rMGVIVHG, wVKLHRG, dRGSWIZD, uILAVMnZITRM, uILAVMxZHS, uILAVMxLNNRHHRLM, xFIInZITRM, xZHSrM, xLNNRHHRLM, yZOZMXV, zEZROZYOV, dRGSWIZDjFLGZ, iVHVIEV, xIVWRG, nLIGTZTV, vCXSZMTVnZITRM, wVOREVIBnZITRM, vCXSZMTVwVOREVIBnZITRM, uILAVMgIZMHUVIuVV, uILAVMhGZNKgZC, gIZMHUVIuVV, hGZNKgZC, xLMEVIHRLMzNLFMG, xIVWRGzNLFMG, hGLXPeZOFV, yLMWiVKFIXSZHVzNLFMG, iVEVIHViVKFIXSZHVzNLFMG, xFIIVMXBxLWV, nZITRMgIZWVzNLFMG, hSLIGhVOOzNLFMG, nZITRMgIZWVkILURG, hSLIGhVOOkILURG, hhhGLXPeZOFV, xIVWRGiZGRL, uILAVMvCVXxZHS, hhvlKGRLMHyFBzNLFMG, hhvlKGRLMHyFBuILAVMzNLFMG, hVGGOVnZITRM, gh) EZOFVH "
    _hjo_rmhvig_hGPzXXLFMGrMUL_eZOFVH = "('{zXXLFMGrw}', '{hVZG}', 'klhg', '{zXXLFMGgBKV}', '{gIZWRMTwZB}', {kIVnLIGTZTV}, {kIVxIVWRG}, {kIVwVKLHRG}, {kIVyZOZMXV}, {kIVnZITRM}, {rMGVIVHGyZHV}, {rMGVIVHG}, {wVKLHRG}, {dRGSWIZD}, {uILAVMnZITRM}, {uILAVMxZHS}, {uILAVMxLNNRHHRLM}, {xFIInZITRM}, {xZHSrM}, {xLNNRHHRLM}, {yZOZMXV}, {zEZROZYOV}, {dRGSWIZDjFLGZ}, {iVHVIEV}, {xIVWRG}, {nLIGTZTV}, {vCXSZMTVnZITRM}, {wVOREVIBnZITRM}, {vCXSZMTVwVOREVIBnZITRM}, {uILAVMgIZMHUVIuVV}, {uILAVMhGZNKgZC}, {gIZMHUVIuVV}, {hGZNKgZC}, {xLMEVIHRLMzNLFMG}, {xIVWRGzNLFMG}, {hGLXPeZOFV}, {yLMWiVKFIXSZHVzNLFMG}, {iVEVIHViVKFIXSZHVzNLFMG}, '{xFIIVMXBxLWV}', {nZITRMgIZWVzNLFMG}, {hSLIGhVOOzNLFMG}, {nZITRMgIZWVkILURG}, {hSLIGhVOOkILURG}, {hhhGLXPeZOFV}, {xIVWRGiZGRL}, {uILAVMvCVXxZHS}, {hhvlKGRLMHyFBzNLFMG}, {hhvlKGRLMHyFBuILAVMzNLFMG}, {hVGGOVnZITRM}, {gh})"
    _hjo_rmhvig_hGPzXXLFMGrMUL_mFOO = "RMHVIG RMGL hGPzXXLFMGrMUL_ogh (zXXLFMGrw, hVZG, gBKV, gIZWRMTwZB) EZOFVH "
    _hjo_rmhvig_hGPzXXLFMGrMUL_mFOO_eZOFVH = "('{zXXLFMGrw}', '{hVZG}', 'klhg', '{gIZWRMTwZB}')"
    _hjo_wvovgv_hGPzXXLFMGrMUL = "WVOVGV UILN hGPzXXLFMGrMUL_ogh DSVIV "
    _hjo_wvovgv_hGPzXXLFMGrMUL_xLMWRGRLMH = "zXXLFMGrw = '{zXXLFMGrw}' ZMW hVZG = '{hVZG}' ZMW gBKV = 'klhg' ZMW gIZWRMTwZB = '{gIZWRMTwZB}'"


    _hsn_ufmwgizmhuvi = _hsn_kivurc + "_c_{zXXLFMGrw}"
    _hjo_jfib_hGPzXXLFMGuFMWgIZMHUVI_grnvhgznk = "HVOVXG gh UILN hGPzXXLFMGuFMWgIZMHUVI_ogh DSVIV zXXLFMGrw = '{zXXLFMGrw}' ZMW hVZG = '{hVZG}' ZMW gBKV = 'klhg' ZMW gIZWRMTwZB = '{gIZWRMTwZB}'"
    _hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI = "RMHVIG RMGL hGPzXXLFMGuFMWgIZMHUVI_ogh (zXXLFMGrw, hVZG, gBKV, oRYVIhVIRZO, gIZWRMTwZB, rMEVHGLIrw, zXXLFMGgBKV, wRIVXGRLM, gIZWVgRNV, gIZWVzNLFMG, rHrMGVIgIZMHUVI, gh) EZOFVH "
    _hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI_eZOFVH = "('{zXXLFMGrw}', '{hVZG}', 'klhg', {oRYVIhVIRZO}, '{gIZWRMTwZB}', '{rMEVHGLIrw}', '{zXXLFMGgBKV}', '{wRIVXGRLM}', '{gIZWVgRNV}', {gIZWVzNLFMG}, {rHrMGVIgIZMHUVI}, {gh})"
    _hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI_mFOO = "RMHVIG RMGL hGPzXXLFMGuFMWgIZMHUVI_ogh (zXXLFMGrw, hVZG, gBKV, gIZWRMTwZB) EZOFVH "
    _hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI_mFOO_eZOFVH = "('{zXXLFMGrw}', '{hVZG}', 'klhg', '{gIZWRMTwZB}')"
    _hjo_wvovgv_hGPzXXLFMGuFMWgIZMHUVI = "WVOVGV UILN hGPzXXLFMGuFMWgIZMHUVI_ogh DSVIV "
    _hjo_wvovgv_hGPzXXLFMGuFMWgIZMHUVI_xLMWRGRLMH = "zXXLFMGrw = '{zXXLFMGrw}' ZMW hVZG = '{hVZG}' ZMW gBKV = 'klhg' ZMW gIZWRMTwZB = '{gIZWRMTwZB}'"

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(oghkLHGxSVXP, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU._WY = mLMV
        HVOU._WYXLMURT = {
            "SLHG": CNO.ZGGIRY.TVG("WYHVIEVI", mLMV),
            "KLIG": RMG(CNO.ZGGIRY.TVG("WYKLIG", '6693')),
            "FHVI": CNO.ZGGIRY.TVG("WYFHVI", mLMV),
            "KZHHDW": CNO.ZGGIRY.TVG("WYKZHHDW", mLMV),
            "WY": CNO.ZGGIRY.TVG("WYMZNV", mLMV),
            "XLMMVXGRLM_GRNVLFG": UOLZG(CNO.ZGGIRY.TVG("WYGRNVLFG", '4.9')),
            "IZRHV_LM_DZIMRMTH": gIFV,
        }
        HVOU._ZXXLFMGRWH = []
        ULI XSROW RM CNO.TVGXSROWIVM():
            ZXXLFMGRW = XSROW.ZGGIRY.TVG("zXXLFMGrw", mLMV)
            RMEVHGLIRW = XSROW.ZGGIRY.TVG("rMEVHGLIrw", mLMV)
            NZXSRMV = XSROW.ZGGIRY.TVG("NZXSRMV", mLMV)
            RU ZXXLFMGRW RH MLG mLMV ZMW NZXSRMV RH MLG mLMV:
                HVOU._ZXXLFMGRWH.ZKKVMW((ZXXLFMGRW, RMEVHGLIRW, NZXSRMV))
                HVOU.OLTTVI.RMUL("zXXLFMG: {9} NZXSRMV: {8}".ULINZG(ZXXLFMGRW, NZXSRMV))

    WVU _WY_RH_XLMMVXG(HVOU):
        RU HVOU._WY RH MLG mLMV ZMW HVOU._WY.RH_XLMMVXGVW() == gIFV:
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV

    WVU _XLMMVXG_WY_RU_MLG(HVOU):
        RU HVOU._WY_RH_XLMMVXG() == gIFV:
            IVGFIM

        RU HVOU._WYXLMURT["SLHG"] RH mLMV:
            HVOU.OLTTVI.VIILI("WZGZYZHV HVIEVI RH MLG XLMURTFIVW")
            IVGFIM
        RU HVOU._WYXLMURT["FHVI"] RH mLMV:
            HVOU.OLTTVI.VIILI("WZGZYZHV FHVI RH MLG XLMURTFIVW")
            IVGFIM
        RU HVOU._WYXLMURT["KZHHDW"] RH mLMV:
            HVOU.OLTTVI.VIILI("WZGZYZHV KZHHDW RH MLG XLMURTFIVW")
            IVGFIM
        RU HVOU._WYXLMURT["WY"] RH mLMV:
            HVOU.OLTTVI.VIILI("WZGZYZHV MZNV RH MLG XLMURTFIVW")
            IVGFIM

        GIB:
            HVOU.OLTTVI.RMUL("WY XLMMVXGRMT: SLHG:{9} KLIG:{8} FHVI:{7} WY:{6}".ULINZG(HVOU._WYXLMURT["SLHG"], HVOU._WYXLMURT["KLIG"], HVOU._WYXLMURT["FHVI"], HVOU._WYXLMURT["WY"]))
            HVOU._WY = NBHJO.XLMMVXGLI.XLMMVXG(**HVOU._WYXLMURT)
            HVOU.OLTTVI.RMUL("WY XLMMVXGVW")
        VCXVKG NBHJO.XLMMVXGLI.vIILI ZH VII:
            HVOU.OLTTVI.VIILI("{9}".ULINZG(VII))
            HVOU._WY = mLMV

    WVU _KLHRGRLM_VCRHG_RM_WY(HVOU, RMEVHGLIRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        XFIHLI = HVOU._WY.XFIHLI()
        XFIHLI.VCVXFGV(HVOU._hjo_jfib_hGPzXXLFMGkLHRGRLM_grnvhgznk.ULINZG(rMEVHGLIrw = RMEVHGLIRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W")))
        GRNVHGZNKH = XFIHLI.UVGXSZOO()
        XFIHLI.XOLHV()

        RU OVM(GRNVHGZNKH) == 9:
            IVGFIM uZOHV
        VOHV:
            IVGFIM gIFV

    WVU _KLHRGRLM_GRNVHGZNK_RM_WY(HVOU, RMEVHGLIRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        """
        tVG LMV GRNVHGZNK UILN WY LU WZGV
        """
        XFIHLI = HVOU._WY.XFIHLI()
        XFIHLI.VCVXFGV(HVOU._hjo_jfib_hGPzXXLFMGkLHRGRLM_grnvhgznk.ULINZG(rMEVHGLIrw = RMEVHGLIRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W")))
        GRNVHGZNKH = XFIHLI.UVGXSZOO()
        XFIHLI.XOLHV()

        IVG = mLMV
        ULI GH RM GRNVHGZNKH:
            RU GH[9] RH MLG mLMV:
                IVG = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(GH[9])
                YIVZP

        IVGFIM IVG

    WVU _KLHRGRLM_GRNVHGZNK_RM_HSN(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI):
        HSN_MZNV = HVOU._hsn_klhrgrlm.ULINZG(zXXLFMGrw = ZXXLFMGRW, nZXSRMV = NZXSRMV)
        HSN_GZYOV = DS.hSNgZYOV(HSN_MZNV)

        RU MLG HSN_GZYOV.LKVM():
            IVGFIM mLMV

        HVOU.OLTTVI.WVYFT("{9}: {8}".ULINZG(HSN_MZNV, HSN_GZYOV.IZMWLN_RW))
        IVGFIM WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(RMG(HSN_GZYOV.GRNVHGZNK / 8999999))

    WVU _TVG_KLHRGRLMH_UILN_HSN(HVOU, ZXXLFMGRW :HGI, RMEVHGLIRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        HSN_MZNV = HVOU._hsn_klhrgrlm.ULINZG(zXXLFMGrw = ZXXLFMGRW, nZXSRMV = NZXSRMV)
        HSN_GZYOV = DS.hSNgZYOV(HSN_MZNV)

        RU MLG HSN_GZYOV.LKVM():
            IVGFIM mLMV

        KLHRGRLMH = []
        RU HSN_GZYOV.ILD_MFN == 9:
            KLHRGRLM = {
                "rMEVHGLIrw": RMEVHGLIRW,
                "rMHGIFNVMGrw": 'zoo',
                "kLHRwRIVXGRLM": 'zoo',
                "gIZWRMTwZB": WZGV.HGIUGRNV("%b%N%W"),
                "kLHRGRLMwZGV": '',
                "sVWTVuOZT": '',
                "bWkLHRGRLM": 9,
                "gLWZBkLHRGRLM": 9,
                "kLHRGRLM": 9,
                "oLMTuILAVM": 9,
                "hSLIGuILAVM": 9,
                "oLMTuILAVMzNLFMG": 9,
                "hSLIGuILAVMzNLFMG": 9,
                "lKVMeLOFNV": 9,
                "xOLHVeLOFNV": 9,
                "lKVMzNLFMG": 9,
                "xOLHVzNLFMG": 9,
                "kLHRGRLMxLHG": 9,
                "uILAVMxZHS": 9,
                "xZHSrM": 9,
                "xLNNRHHRLM": 9,
                "kIVhVGGOVNVMGkIRXV": 9,
                "hVGGOVNVMGkIRXV": 9,
                "bWlKVMxLHG": 9,
                "lKVMxLHG": 9,
                "vCXSZMTVnZITRM": 9,
                "gIZMHUVIuVV": 9,
                "hGZNKgZC": 9,
                "gLWZBkFIiVWeLOFNV": 9,
                "xLMEVIHRLMiZGV": 9,
                "xLMEVIHRLMzNLFMG": 9,
                "hGLXPeZOFV": 9,
                "vCXSZMTVrw": '',
                "zXXLFMGrw": ZXXLFMGRW,
                "kOVWTVrMkLHRGRLM": 9,
                "iVKFIXSZHVkLHRGRLM": 9,
                "kFIiVWhSLIGuILAVM": 9,
                "nZITRMgIZWVeLOFNV": 9,
                "nZITRMgIZWVzNLFMG": 9,
                "nZITRMgIZWVuILAVMeLOFNV": 9,
                "nZITRMgIZWVuILAVMzNLFMG": 9,
                "nZITRMgIZWVxLMEVIHRLMkILURG": 9,
                "hSLIGhVOOeLOFNV": 9,
                "hSLIGhVOOzNLFMG": 9,
                "hSLIGhVOOuILAVMeLOFNV": 9,
                "hSLIGhVOOuILAVMzNLFMG": 9,
                "hSLIGhVOOxLMEVIHRLMkILURG": 9,
                "hhhGLXPeZOFV": 9,
                "gLWZBngkLHRGRLM": 9,
                "gLWZBhhkLHRGRLM": 9,
                "oLXPkLHRGRLM": 9,
                "xLEVIkLHRGRLM": 9,
                "oLXPuILAVMkLHRGRLM": 9,
                "fMOLXPuILAVMkLHRGRLM": 9,
                "xLEVIuILAVMkLHRGRLM": 9,
                "vCVXuILAVMkLHRGRLM": 9,
                "bwxLEVIkLHRGRLM": 9,
            }
            KLHRGRLMH.ZKKVMW(KLHRGRLM)
        VOHV:
            ULI ILD RM IZMTV(9, HSN_GZYOV.ILD_MFN):
                KLHRGRLM = {
                    "rMEVHGLIrw": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rMEHG"]],
                    "rMHGIFNVMGrw": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rMHGI"]],
                    "kLHRwRIVXGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["wRIXG"]],
                    "gIZWRMTwZB": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gwWZB"]],
                    "kLHRGRLMwZGV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kHGwZB"]],
                    "sVWTVuOZT": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["sWTuOT"]],
                    "bWkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["bWkHG"]],
                    "gLWZBkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gWkHG"]],
                    "kLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kHG"]],
                    "oLMTuILAVM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["ouAM"]],
                    "hSLIGuILAVM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["huAM"]],
                    "oLMTuILAVMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["ouAMzN"]],
                    "hSLIGuILAVMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["huAMzN"]],
                    "lKVMeLOFNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["lKMe"]],
                    "xOLHVeLOFNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xOHe"]],
                    "lKVMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["lKMzNG"]],
                    "xOLHVzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xOHzNG"]],
                    "kLHRGRLMxLHG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kHGxHG"]],
                    "uILAVMxZHS": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["uAMxHS"]],
                    "xZHSrM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xZHSrM"]],
                    "xLNNRHHRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xNNHHM"]],
                    "kIVhVGGOVNVMGkIRXV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kIhGGk"]],
                    "hVGGOVNVMGkIRXV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGGk"]],
                    "bWlKVMxLHG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["bWlKMx"]],
                    "lKVMxLHG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["lKMx"]],
                    "vCXSZMTVnZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["vCXSnT"]],
                    "gIZMHUVIuVV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gIHUIu"]],
                    "hGZNKgZC": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGNKgC"]],
                    "gLWZBkFIiVWeLOFNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gWkiWe"]],
                    "xLMEVIHRLMiZGV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xEIiG"]],
                    "xLMEVIHRLMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xEIzNG"]],
                    "hGLXPeZOFV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGPeZO"]],
                    "vCXSZMTVrw": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["vCXSrw"]],
                    "zXXLFMGrw": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["zXXRW"]],
                    "kOVWTVrMkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kTrkHG"]],
                    "iVKFIXSZHVkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["iXSkHG"]],
                    "kFIiVWhSLIGuILAVM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kihuAM"]],
                    "nZITRMgIZWVeLOFNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nTgIWe"]],
                    "nZITRMgIZWVzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nTgIWz"]],
                    "nZITRMgIZWVuILAVMeLOFNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nTguAe"]],
                    "nZITRMgIZWVuILAVMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nTguAz"]],
                    "nZITRMgIZWVxLMEVIHRLMkILURG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nTgxkG"]],
                    "hSLIGhVOOeLOFNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGheLO"]],
                    "hSLIGhVOOzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGhzNG"]],
                    "hSLIGhVOOuILAVMeLOFNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGhuAe"]],
                    "hSLIGhVOOuILAVMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGhuAz"]],
                    "hSLIGhVOOxLMEVIHRLMkILURG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGhxEk"]],
                    "hhhGLXPeZOFV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hhheZO"]],
                    "gLWZBngkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gWnkHG"]],
                    "gLWZBhhkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gWhkHG"]],
                    "oLXPkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["oXPkHG"]],
                    "xLEVIkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xEIkHG"]],
                    "oLXPuILAVMkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["ouAkG"]],
                    "fMOLXPuILAVMkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["fouAkG"]],
                    "xLEVIuILAVMkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xEuAkG"]],
                    "vCVXuILAVMkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["vCuAkG"]],
                    "bwxLEVIkLHRGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gwxEkG"]],
                }
                KLHRGRLMH.ZKKVMW(KLHRGRLM)
        IVGFIM KLHRGRLMH

    WVU _RMHVIG_KLHRGRLMH_RM_WY(HVOU, RMEVHGLIRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV, HSN_KLHRGRLMH :ORHG, GRNVHGZNK :WZGVGRNV.WZGVGRNV):
        XFIHLI = HVOU._WY.XFIHLI()
        RU HSN_KLHRGRLMH RH mLMV:

            EZOFVH = HVOU._hjo_rmhvig_hGPzXXLFMGkLHRGRLM_mFOO_eZOFVH.ULINZG(
                rMEVHGLIrw = RMEVHGLIRW,
                hVZG = NZXSRMV,
                gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"))

            HJOXNW = HVOU._hjo_rmhvig_hGPzXXLFMGkLHRGRLM_mFOO + EZOFVH
            XFIHLI.VCVXFGV(HJOXNW)
            HVOU.OLTTVI.RMUL("WY RMHVIG EZOFVH: " + EZOFVH)
        VOHV:
            ULI HSN_KLHRGRLM RM HSN_KLHRGRLMH:

                RU WZGV.HGIUGRNV("%b%N%W") != HSN_KLHRGRLM["gIZWRMTwZB"]:
                    XLMGRMFV

                EZOFVH = HVOU._hjo_rmhvig_hGPzXXLFMGkLHRGRLM_eZOFVH.ULINZG(
                    rMEVHGLIrw = RMEVHGLIRW,
                    hVZG = NZXSRMV,
                    rMHGIFNVMGrw = HSN_KLHRGRLM["rMHGIFNVMGrw"],
                    wRIVXGRLM = HSN_KLHRGRLM["kLHRwRIVXGRLM"],
                    gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"),
                    sVWTVuOZT = HSN_KLHRGRLM["sVWTVuOZT"],
                    bWkLHRGRLM = HSN_KLHRGRLM["bWkLHRGRLM"],
                    gLWZBkLHRGRLM = HSN_KLHRGRLM["gLWZBkLHRGRLM"],
                    kLHRGRLM = HSN_KLHRGRLM["kLHRGRLM"],
                    oLMTuILAVM = HSN_KLHRGRLM["oLMTuILAVM"],
                    hSLIGuILAVM = HSN_KLHRGRLM["hSLIGuILAVM"],
                    oLMTuILAVMzNLFMG = HSN_KLHRGRLM["oLMTuILAVMzNLFMG"],
                    hSLIGuILAVMzNLFMG = HSN_KLHRGRLM["hSLIGuILAVMzNLFMG"],
                    lKVMeLOFNV = HSN_KLHRGRLM["lKVMeLOFNV"],
                    xOLHVeLOFNV = HSN_KLHRGRLM["xOLHVeLOFNV"],
                    lKVMzNLFMG = HSN_KLHRGRLM["lKVMzNLFMG"],
                    xOLHVzNLFMG = HSN_KLHRGRLM["xOLHVzNLFMG"],
                    kLHRGRLMxLHG = HSN_KLHRGRLM["kLHRGRLMxLHG"],
                    uILAVMxZHS = HSN_KLHRGRLM["uILAVMxZHS"],
                    xZHSrM = HSN_KLHRGRLM["xZHSrM"],
                    xLNNRHHRLM = HSN_KLHRGRLM["xLNNRHHRLM"],
                    kIVhVGGOVNVMGkIRXV = HSN_KLHRGRLM["kIVhVGGOVNVMGkIRXV"],
                    hVGGOVNVMGkIRXV = HSN_KLHRGRLM["hVGGOVNVMGkIRXV"],
                    bWlKVMxLHG = HSN_KLHRGRLM["bWlKVMxLHG"],
                    lKVMxLHG = HSN_KLHRGRLM["lKVMxLHG"],
                    vCXSZMTVnZITRM = HSN_KLHRGRLM["vCXSZMTVnZITRM"],
                    gIZMHUVIuVV = HSN_KLHRGRLM["gIZMHUVIuVV"],
                    hGZNKgZC = HSN_KLHRGRLM["hGZNKgZC"],
                    gLWZBkFIiVWeLOFNV = HSN_KLHRGRLM["gLWZBkFIiVWeLOFNV"],
                    xLMEVIHRLMiZGV = HSN_KLHRGRLM["xLMEVIHRLMiZGV"],
                    xLMEVIHRLMzNLFMG = HSN_KLHRGRLM["xLMEVIHRLMzNLFMG"],
                    hGLXPeZOFV = HSN_KLHRGRLM["hGLXPeZOFV"],
                    vCXSZMTVrw = HSN_KLHRGRLM["vCXSZMTVrw"],
                    zXXLFMGrw = HSN_KLHRGRLM["zXXLFMGrw"],
                    kOVWTVrMkLHRGRLM = HSN_KLHRGRLM["kOVWTVrMkLHRGRLM"],
                    iVKFIXSZHVkLHRGRLM = HSN_KLHRGRLM["iVKFIXSZHVkLHRGRLM"],
                    kFIiVWhSLIGuILAVM = HSN_KLHRGRLM["kFIiVWhSLIGuILAVM"],
                    nZITRMgIZWVeLOFNV = HSN_KLHRGRLM["nZITRMgIZWVeLOFNV"],
                    nZITRMgIZWVzNLFMG = HSN_KLHRGRLM["nZITRMgIZWVzNLFMG"],
                    nZITRMgIZWVuILAVMeLOFNV = HSN_KLHRGRLM["nZITRMgIZWVuILAVMeLOFNV"],
                    nZITRMgIZWVuILAVMzNLFMG = HSN_KLHRGRLM["nZITRMgIZWVuILAVMzNLFMG"],
                    nZITRMgIZWVxLMEVIHRLMkILURG = HSN_KLHRGRLM["nZITRMgIZWVxLMEVIHRLMkILURG"],
                    hSLIGhVOOeLOFNV = HSN_KLHRGRLM["hSLIGhVOOeLOFNV"],
                    hSLIGhVOOzNLFMG = HSN_KLHRGRLM["hSLIGhVOOzNLFMG"],
                    hSLIGhVOOuILAVMeLOFNV = HSN_KLHRGRLM["hSLIGhVOOuILAVMeLOFNV"],
                    hSLIGhVOOuILAVMzNLFMG = HSN_KLHRGRLM["hSLIGhVOOuILAVMzNLFMG"],
                    hSLIGhVOOxLMEVIHRLMkILURG = HSN_KLHRGRLM["hSLIGhVOOxLMEVIHRLMkILURG"],
                    hhhGLXPeZOFV = HSN_KLHRGRLM["hhhGLXPeZOFV"],
                    gLWZBngkLHRGRLM = HSN_KLHRGRLM["gLWZBngkLHRGRLM"],
                    gLWZBhhkLHRGRLM = HSN_KLHRGRLM["gLWZBhhkLHRGRLM"],
                    oLXPkLHRGRLM = HSN_KLHRGRLM["oLXPkLHRGRLM"],
                    xLEVIkLHRGRLM = HSN_KLHRGRLM["xLEVIkLHRGRLM"],
                    oLXPuILAVMkLHRGRLM = HSN_KLHRGRLM["oLXPuILAVMkLHRGRLM"],
                    fMOLXPuILAVMkLHRGRLM = HSN_KLHRGRLM["fMOLXPuILAVMkLHRGRLM"],
                    xLEVIuILAVMkLHRGRLM = HSN_KLHRGRLM["xLEVIuILAVMkLHRGRLM"],
                    vCVXuILAVMkLHRGRLM = HSN_KLHRGRLM["vCVXuILAVMkLHRGRLM"],
                    bwxLEVIkLHRGRLM = HSN_KLHRGRLM["bwxLEVIkLHRGRLM"],
                    gh = RMG(GRNVHGZNK.GRNVHGZNK()))

                HJOXNW = HVOU._hjo_rmhvig_hGPzXXLFMGkLHRGRLM + EZOFVH
                XFIHLI.VCVXFGV(HJOXNW)
                HVOU.OLTTVI.RMUL("WY RMHVIG EZOFVH: " + EZOFVH)

        HVOU._WY.XLNNRG()
        XFIHLI.XOLHV()

    WVU _WVOVGV_KLHRGRLMH_RM_WY(HVOU, RMEVHGLIRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        XFIHLI = HVOU._WY.XFIHLI()
        XLMWRGRLM = HVOU._hjo_wvovgv_hGPzXXLFMGkLHRGRLM_xLMWRGRLMH.ULINZG(rMEVHGLIrw = RMEVHGLIRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"))
        HJOXNW = HVOU._hjo_wvovgv_hGPzXXLFMGkLHRGRLM + XLMWRGRLM
        XFIHLI.VCVXFGV(HJOXNW)
        HVOU._WY.XLNNRG()
        XFIHLI.XOLHV()
        HVOU.OLTTVI.RMUL("WVOVGV WY DRGS {9}".ULINZG(XLMWRGRLM))

    WVU _FKWZGV_KLHRGRLMH(HVOU, WZGV :WZGVGRNV.WZGV):
        WZB_YVTRM = WZGVGRNV.WZGVGRNV(WZGV.BVZI, WZGV.NLMGS, WZGV.WZB)

        # FKWZGV KLHRGRLM
        ULI ZXXLFMGRW, RMEVHGLIRW, NZXSRMV RM HVOU._ZXXLFMGRWH:

            # RMRG mFOO VMGIB ULI RMEVHGLIRW ZG NZXSRMV
            RU MLG HVOU._KLHRGRLM_VCRHG_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV):
                HVOU.OLTTVI.RMUL("RMHVIG WZGZYZHV {9} {8} KLHGRLMH DRGS mfoo".ULINZG(RMEVHGLIRW, NZXSRMV))
                HVOU._RMHVIG_KLHRGRLMH_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV, mLMV, mLMV)

            # IVZW HSN GRNVHGZNK ZMW KLHRGRLM GLTZGSVI GL PVVK GSVN ZGLNRX
            HSN_GRNVHGZNK = HVOU._KLHRGRLM_GRNVHGZNK_RM_HSN(ZXXLFMGRW, NZXSRMV)
            HVOU.OLTTVI.WVYFT("{9} {8} KLHRGRLM HSN_GRNVHGZNK: {7}".ULINZG(ZXXLFMGRW, NZXSRMV, HSN_GRNVHGZNK))
            RU HSN_GRNVHGZNK RH mLMV:
                 XLMGRMFV

            HSN_KLHRGRLMH = HVOU._TVG_KLHRGRLMH_UILN_HSN(ZXXLFMGRW, RMEVHGLIRW, NZXSRMV, WZGV)

            RU HSN_GRNVHGZNK < WZB_YVTRM:
                # RTMLIV LOW WZGZ
                HVOU.OLTTVI.WVYFT("{9} {8} RTMLIV LOWVI HSN WZGZ LU GRNVHGZNK {7}".ULINZG(ZXXLFMGRW, NZXSRMV, HSN_GRNVHGZNK))
                XLMGRMFV

            RU HVOU._KLHRGRLM_GRNVHGZNK_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV) RH mLMV:
                HVOU.OLTTVI.RMUL("RMHVIG WZGZYZHV {9} {8} KLHGRLMH DRGS WZGZ LU GRNVHGZNK ({7})".ULINZG(RMEVHGLIRW, NZXSRMV, RMG(HSN_GRNVHGZNK.GRNVHGZNK())))
                HVOU._WVOVGV_KLHRGRLMH_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV)
                HVOU._RMHVIG_KLHRGRLMH_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV, HSN_KLHRGRLMH, HSN_GRNVHGZNK)
            VOHV:
                WY_GRNVHGZNK = HVOU._KLHRGRLM_GRNVHGZNK_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV)
                RU WY_GRNVHGZNK < HSN_GRNVHGZNK:
                    HVOU.OLTTVI.DZIMRMT("IVKOZXVW WZGZYZHV {9} {8} KLHGRLMH DRGS MVDVI WZGZ LU GRNVHGZNK ({7})".ULINZG(RMEVHGLIRW, NZXSRMV, RMG(HSN_GRNVHGZNK.GRNVHGZNK())))
                    HVOU._WVOVGV_KLHRGRLMH_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV)
                    HVOU._RMHVIG_KLHRGRLMH_RM_WY(RMEVHGLIRW, NZXSRMV, WZGV, HSN_KLHRGRLMH, HSN_GRNVHGZNK)
                VOHV:
                    HVOU.OLTTVI.RMUL("{9} {8} GRNVHGZNK RH MLG MVD ZMW RTMLIV".ULINZG(RMEVHGLIRW, NZXSRMV))


    WVU _ZXXLFMGRMUL_VCRHG_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        XFIHLI = HVOU._WY.XFIHLI()
        XFIHLI.VCVXFGV(HVOU._hjo_jfib_hGPzXXLFMGrMUL_grnvhgznk.ULINZG(zXXLFMGrw = ZXXLFMGRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W")))
        GRNVHGZNKH = XFIHLI.UVGXSZOO()
        XFIHLI.XOLHV()

        RU OVM(GRNVHGZNKH) == 9:
            IVGFIM uZOHV
        VOHV:
            IVGFIM gIFV

    WVU _ZXXLFMGRMUL_GRNVHGZNK_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        """
        tVG LMV GRNVHGZNK UILN WY LU WZGV
        """
        XFIHLI = HVOU._WY.XFIHLI()
        XFIHLI.VCVXFGV(HVOU._hjo_jfib_hGPzXXLFMGrMUL_grnvhgznk.ULINZG(zXXLFMGrw = ZXXLFMGRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W")))
        GRNVHGZNKH = XFIHLI.UVGXSZOO()
        XFIHLI.XOLHV()

        IVG = mLMV
        ULI GH RM GRNVHGZNKH:
            RU GH[9] RH MLG mLMV:
                IVG = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(GH[9])
                YIVZP

        IVGFIM IVG

    WVU _ZXXLFMGRMUL_GRNVHGZNK_RM_HSN(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI):
        HSN_MZNV = HVOU._hsn_zxxlfmgrmul.ULINZG(zXXLFMGrw = ZXXLFMGRW, nZXSRMV = NZXSRMV)
        HSN_GZYOV = DS.hSNgZYOV(HSN_MZNV)

        RU MLG HSN_GZYOV.LKVM():
            IVGFIM mLMV

        HVOU.OLTTVI.WVYFT("{9}: {8}".ULINZG(HSN_MZNV, HSN_GZYOV.IZMWLN_RW))
        IVGFIM WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(RMG(HSN_GZYOV.GRNVHGZNK / 8999999))

    WVU _TVG_ZXXLFMGRMUL_UILN_HSN(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        HSN_MZNV = HVOU._hsn_zxxlfmgrmul.ULINZG(zXXLFMGrw = ZXXLFMGRW, nZXSRMV = NZXSRMV)
        HSN_GZYOV = DS.hSNgZYOV(HSN_MZNV)

        RU MLG HSN_GZYOV.LKVM():
            IVGFIM mLMV

        ZXXLFMGRMUL = []
        RU HSN_GZYOV.ILD_MFN == 9:
            ZXXLFMG = {
                "zXXLFMGrw": ZXXLFMGRW,
                "zXXLFMGgBKV": 'zoo',
                "gIZWRMTwZB": WZGV.HGIUGRNV("%b/%N/%W"),
                "kIVnLIGTZTV": 9,
                "kIVxIVWRG": 9,
                "kIVwVKLHRG": 9,
                "kIVyZOZMXV": 9,
                "kIVnZITRM": 9,
                "rMGVIVHGyZHV": 9,
                "rMGVIVHG": 9,
                "wVKLHRG": 9,
                "dRGSWIZD": 9,
                "uILAVMnZITRM": 9,
                "uILAVMxZHS": 9,
                "uILAVMxLNNRHHRLM": 9,
                "xFIInZITRM": 9,
                "xZHSrM": 9,
                "xLNNRHHRLM": 9,
                "yZOZMXV": 9,
                "zEZROZYOV": 9,
                "dRGSWIZDjFLGZ": 9,
                "iVHVIEV": 9,
                "xIVWRG": 9,
                "nLIGTZTV": 9,
                "vCXSZMTVnZITRM": 9,
                "wVOREVIBnZITRM": 9,
                "vCXSZMTVwVOREVIBnZITRM": 9,
                "uILAVMgIZMHUVIuVV": 9,
                "uILAVMhGZNKgZC": 9,
                "gIZMHUVIuVV": 9,
                "hGZNKgZC": 9,
                "xLMEVIHRLMzNLFMG": 9,
                "xIVWRGzNLFMG": 9,
                "hGLXPeZOFV": 9,
                "yLMWiVKFIXSZHVzNLFMG": 9,
                "iVEVIHViVKFIXSZHVzNLFMG": 9,
                "xFIIVMXBxLWV": 'zoo',
                "nZITRMgIZWVzNLFMG": 9,
                "hSLIGhVOOzNLFMG": 9,
                "nZITRMgIZWVkILURG": 9,
                "hSLIGhVOOkILURG": 9,
                "hhhGLXPeZOFV": 9,
                "xIVWRGiZGRL": 9,
                "uILAVMvCVXxZHS": 9,
                "hhvlKGRLMHyFBzNLFMG": 9,
                "hhvlKGRLMHyFBuILAVMzNLFMG": 9,
                "hVGGOVnZITRM": 9,
            }
            ZXXLFMGRMUL.ZKKVMW(ZXXLFMG)
        VOHV:
            ULI ILD RM IZMTV(9, HSN_GZYOV.ILD_MFN):
                ZXXLFMG = {
                    "zXXLFMGrw": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["zXXRW"]],
                    "zXXLFMGgBKV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["zXgBK"]],
                    "gIZWRMTwZB": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gwWZB"]],
                    "kIVnLIGTZTV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kInGTT"]],
                    "kIVxIVWRG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kIxIWG"]],
                    "kIVwVKLHRG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kIwKHG"]],
                    "kIVyZOZMXV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kIyOMX"]],
                    "kIVnZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["kInITM"]],
                    "rMGVIVHGyZHV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rGIHGy"]],
                    "rMGVIVHG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rGIHG"]],
                    "wVKLHRG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["wKHG"]],
                    "dRGSWIZD": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["dGSWID"]],
                    "uILAVMnZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["uAMnTM"]],
                    "uILAVMxZHS": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["uAMxHS"]],
                    "uILAVMxLNNRHHRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["uAMxNH"]],
                    "xFIInZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xIInTM"]],
                    "xZHSrM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xZHSrM"]],
                    "xLNNRHHRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xNNHHM"]],
                    "yZOZMXV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["yOMX"]],
                    "zEZROZYOV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["zERZ"]],
                    "dRGSWIZDjFLGZ": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["dGSWjG"]],
                    "iVHVIEV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["iHIE"]],
                    "xIVWRG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xIVWRG"]],
                    "nLIGTZTV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nIGTTV"]],
                    "vCXSZMTVnZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["vCXSnT"]],
                    "wVOREVIBnZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["wOEInT"]],
                    "vCXSZMTVwVOREVIBnZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["vCwOnT"]],
                    "uILAVMgIZMHUVIuVV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["uAMgIu"]],
                    "uILAVMhGZNKgZC": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["uAMhgC"]],
                    "gIZMHUVIuVV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gIHUIu"]],
                    "hGZNKgZC": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGNKgC"]],
                    "xLMEVIHRLMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xEIzNG"]],
                    "xIVWRGzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xIWzNG"]],
                    "hGLXPeZOFV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGPeZO"]],
                    "yLMWiVKFIXSZHVzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["yiKzNG"]],
                    "iVEVIHViVKFIXSZHVzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["iiKzNG"]],
                    "xFIIVMXBxLWV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xXBxWV"]],
                    "nZITRMgIZWVzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nTgzNG"]],
                    "hSLIGhVOOzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hShzNG"]],
                    "nZITRMgIZWVkILURG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["nTgkUG"]],
                    "hSLIGhVOOkILURG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hShkUG"]],
                    "hhhGLXPeZOFV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hhheZO"]],
                    "xIVWRGiZGRL": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["xIWiGR"]],
                    "uILAVMvCVXxZHS": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["uAMcxH"]],
                    "hhvlKGRLMHyFBzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hhvzNG"]],
                    "hhvlKGRLMHyFBuILAVMzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hhuzNG"]],
                    "hVGGOVnZITRM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hGGnTM"]],
                }
                ZXXLFMGRMUL.ZKKVMW(ZXXLFMG)
        IVGFIM ZXXLFMGRMUL

    WVU _RMHVIG_ZXXLFMGRMUL_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV, HSN_ZXXLFMGRMULH :ORHG, GRNVHGZNK :WZGVGRNV.WZGVGRNV):
        XFIHLI = HVOU._WY.XFIHLI()
        RU HSN_ZXXLFMGRMULH RH mLMV:

            EZOFVH = HVOU._hjo_rmhvig_hGPzXXLFMGrMUL_mFOO_eZOFVH.ULINZG(
                zXXLFMGrw = ZXXLFMGRW,
                hVZG = NZXSRMV,
                gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"))

            HJOXNW = HVOU._hjo_rmhvig_hGPzXXLFMGrMUL_mFOO + EZOFVH
            XFIHLI.VCVXFGV(HJOXNW)
            HVOU.OLTTVI.RMUL("WY RMHVIG EZOFVH: " + EZOFVH)
        VOHV:
            ULI HSN_ZXXLFMGRMUL RM HSN_ZXXLFMGRMULH:

                RU WZGV.HGIUGRNV("%b%N%W") != HSN_ZXXLFMGRMUL["gIZWRMTwZB"]:
                    XLMGRMFV

                EZOFVH = HVOU._hjo_rmhvig_hGPzXXLFMGrMUL_eZOFVH.ULINZG(
                    zXXLFMGrw = ZXXLFMGRW,
                    hVZG = NZXSRMV,
                    zXXLFMGgBKV = HSN_ZXXLFMGRMUL["zXXLFMGgBKV"],
                    gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"),
                    kIVnLIGTZTV = HSN_ZXXLFMGRMUL["kIVnLIGTZTV"],
                    kIVxIVWRG = HSN_ZXXLFMGRMUL["kIVxIVWRG"],
                    kIVwVKLHRG = HSN_ZXXLFMGRMUL["kIVwVKLHRG"],
                    kIVyZOZMXV = HSN_ZXXLFMGRMUL["kIVyZOZMXV"],
                    kIVnZITRM = HSN_ZXXLFMGRMUL["kIVnZITRM"],
                    rMGVIVHGyZHV = HSN_ZXXLFMGRMUL["rMGVIVHGyZHV"],
                    rMGVIVHG = HSN_ZXXLFMGRMUL["rMGVIVHG"],
                    wVKLHRG = HSN_ZXXLFMGRMUL["wVKLHRG"],
                    dRGSWIZD = HSN_ZXXLFMGRMUL["dRGSWIZD"],
                    uILAVMnZITRM = HSN_ZXXLFMGRMUL["uILAVMnZITRM"],
                    uILAVMxZHS = HSN_ZXXLFMGRMUL["uILAVMxZHS"],
                    uILAVMxLNNRHHRLM = HSN_ZXXLFMGRMUL["uILAVMxLNNRHHRLM"],
                    xFIInZITRM = HSN_ZXXLFMGRMUL["xFIInZITRM"],
                    xZHSrM = HSN_ZXXLFMGRMUL["xZHSrM"],
                    xLNNRHHRLM = HSN_ZXXLFMGRMUL["xLNNRHHRLM"],
                    yZOZMXV = HSN_ZXXLFMGRMUL["yZOZMXV"],
                    zEZROZYOV = HSN_ZXXLFMGRMUL["zEZROZYOV"],
                    dRGSWIZDjFLGZ = HSN_ZXXLFMGRMUL["dRGSWIZDjFLGZ"],
                    iVHVIEV = HSN_ZXXLFMGRMUL["iVHVIEV"],
                    xIVWRG = HSN_ZXXLFMGRMUL["xIVWRG"],
                    nLIGTZTV = HSN_ZXXLFMGRMUL["nLIGTZTV"],
                    vCXSZMTVnZITRM = HSN_ZXXLFMGRMUL["vCXSZMTVnZITRM"],
                    wVOREVIBnZITRM = HSN_ZXXLFMGRMUL["wVOREVIBnZITRM"],
                    vCXSZMTVwVOREVIBnZITRM = HSN_ZXXLFMGRMUL["vCXSZMTVwVOREVIBnZITRM"],
                    uILAVMgIZMHUVIuVV = HSN_ZXXLFMGRMUL["uILAVMgIZMHUVIuVV"],
                    uILAVMhGZNKgZC = HSN_ZXXLFMGRMUL["uILAVMhGZNKgZC"],
                    gIZMHUVIuVV = HSN_ZXXLFMGRMUL["gIZMHUVIuVV"],
                    hGZNKgZC = HSN_ZXXLFMGRMUL["hGZNKgZC"],
                    xLMEVIHRLMzNLFMG = HSN_ZXXLFMGRMUL["xLMEVIHRLMzNLFMG"],
                    xIVWRGzNLFMG = HSN_ZXXLFMGRMUL["xIVWRGzNLFMG"],
                    hGLXPeZOFV = HSN_ZXXLFMGRMUL["hGLXPeZOFV"],
                    yLMWiVKFIXSZHVzNLFMG = HSN_ZXXLFMGRMUL["yLMWiVKFIXSZHVzNLFMG"],
                    iVEVIHViVKFIXSZHVzNLFMG = HSN_ZXXLFMGRMUL["iVEVIHViVKFIXSZHVzNLFMG"],
                    xFIIVMXBxLWV = HSN_ZXXLFMGRMUL["xFIIVMXBxLWV"],
                    nZITRMgIZWVzNLFMG = HSN_ZXXLFMGRMUL["nZITRMgIZWVzNLFMG"],
                    hSLIGhVOOzNLFMG = HSN_ZXXLFMGRMUL["hSLIGhVOOzNLFMG"],
                    nZITRMgIZWVkILURG = HSN_ZXXLFMGRMUL["nZITRMgIZWVkILURG"],
                    hSLIGhVOOkILURG = HSN_ZXXLFMGRMUL["hSLIGhVOOkILURG"],
                    hhhGLXPeZOFV = HSN_ZXXLFMGRMUL["hhhGLXPeZOFV"],
                    xIVWRGiZGRL = HSN_ZXXLFMGRMUL["xIVWRGiZGRL"],
                    uILAVMvCVXxZHS = HSN_ZXXLFMGRMUL["uILAVMvCVXxZHS"],
                    hhvlKGRLMHyFBzNLFMG = HSN_ZXXLFMGRMUL["hhvlKGRLMHyFBzNLFMG"],
                    hhvlKGRLMHyFBuILAVMzNLFMG = HSN_ZXXLFMGRMUL["hhvlKGRLMHyFBuILAVMzNLFMG"],
                    hVGGOVnZITRM = HSN_ZXXLFMGRMUL["hVGGOVnZITRM"],
                    gh = RMG(GRNVHGZNK.GRNVHGZNK()))
                HJOXNW = HVOU._hjo_rmhvig_hGPzXXLFMGrMUL + EZOFVH
                HVOU.OLTTVI.RMUL(HJOXNW)
                XFIHLI.VCVXFGV(HJOXNW)
                HVOU.OLTTVI.RMUL("WY RMHVIG EZOFVH: " + EZOFVH)

        HVOU._WY.XLNNRG()
        XFIHLI.XOLHV()

    WVU _WVOVGV_ZXXLFMGRMUL_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        XFIHLI = HVOU._WY.XFIHLI()
        XLMWRGRLM = HVOU._hjo_wvovgv_hGPzXXLFMGrMUL_xLMWRGRLMH.ULINZG(zXXLFMGrw = ZXXLFMGRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"))
        HJOXNW = HVOU._hjo_wvovgv_hGPzXXLFMGrMUL + XLMWRGRLM
        XFIHLI.VCVXFGV(HJOXNW)
        HVOU._WY.XLNNRG()
        XFIHLI.XOLHV()
        HVOU.OLTTVI.RMUL("WVOVGV WY DRGS {9}".ULINZG(XLMWRGRLM))

    WVU _FKWZGV_ZXXLFMG(HVOU, WZGV :WZGVGRNV.WZGV):
        WZB_YVTRM = WZGVGRNV.WZGVGRNV(WZGV.BVZI, WZGV.NLMGS, WZGV.WZB)

        # FKWZGV KLHRGRLM
        ULI ZXXLFMGRW, RMEVHGLIRW, NZXSRMV RM HVOU._ZXXLFMGRWH:

            # RMRG mFOO VMGIB ULI ZXXLFMGRW ZG NZXSRMV
            RU MLG HVOU._ZXXLFMGRMUL_VCRHG_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV):
                HVOU.OLTTVI.RMUL("RMHVIG WZGZYZHV {9} {8} ZXXLFMGRMU DRGS mfoo".ULINZG(ZXXLFMGRW, NZXSRMV))
                HVOU._RMHVIG_ZXXLFMGRMUL_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV, mLMV, mLMV)

            # IVZW HSN GRNVHGZNK ZMW ZXXLFMG GLTZGSVI GL PVVK GSVN ZGLNRX
            HSN_GRNVHGZNK = HVOU._ZXXLFMGRMUL_GRNVHGZNK_RM_HSN(ZXXLFMGRW, NZXSRMV)
            HVOU.OLTTVI.WVYFT("{9} {8} ZXXLFMG HSN_GRNVHGZNK: {7}".ULINZG(ZXXLFMGRW, NZXSRMV, HSN_GRNVHGZNK))
            RU HSN_GRNVHGZNK RH mLMV:
                XLMGRMFV

            HSN_ZXXLFMGRMULH = HVOU._TVG_ZXXLFMGRMUL_UILN_HSN(ZXXLFMGRW, NZXSRMV, WZGV)

            RU HSN_GRNVHGZNK < WZB_YVTRM:
                # RTMLIV LOW WZGZ
                HVOU.OLTTVI.WVYFT("{9} {8} RTMLIV LOWVI HSN WZGZ LU GRNVHGZNK {7}".ULINZG(ZXXLFMGRW, NZXSRMV, HSN_GRNVHGZNK))
                XLMGRMFV

            RU HVOU._ZXXLFMGRMUL_GRNVHGZNK_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV) RH mLMV:
                HVOU.OLTTVI.RMUL("RMHVIG WZGZYZHV {9} {8} ZXXLFMGRMUL DRGS WZGZ LU GRNVHGZNK ({7})".ULINZG(ZXXLFMGRW, NZXSRMV, RMG(HSN_GRNVHGZNK.GRNVHGZNK())))
                HVOU._WVOVGV_ZXXLFMGRMUL_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV)
                HVOU._RMHVIG_ZXXLFMGRMUL_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV, HSN_ZXXLFMGRMULH, HSN_GRNVHGZNK)
            VOHV:
                WY_GRNVHGZNK = HVOU._ZXXLFMGRMUL_GRNVHGZNK_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV)
                RU WY_GRNVHGZNK < HSN_GRNVHGZNK:
                    HVOU.OLTTVI.DZIMRMT("IVKOZXVW WZGZYZHV {9} {8} ZXXLFMG DRGS MVDVI WZGZ LU GRNVHGZNK ({7})".ULINZG(ZXXLFMGRW, NZXSRMV, RMG(HSN_GRNVHGZNK.GRNVHGZNK())))
                    HVOU._WVOVGV_ZXXLFMGRMUL_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV)
                    HVOU._RMHVIG_ZXXLFMGRMUL_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV, HSN_ZXXLFMGRMULH, HSN_GRNVHGZNK)
                VOHV:
                    HVOU.OLTTVI.RMUL("{9} {8} GRNVHGZNK RH MLG MVD ZMW RTMLIV".ULINZG(ZXXLFMGRW, NZXSRMV))




    WVU _UFMWGIZMHUVI_VCRHG_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        XFIHLI = HVOU._WY.XFIHLI()
        XFIHLI.VCVXFGV(HVOU._hjo_jfib_hGPzXXLFMGuFMWgIZMHUVI_grnvhgznk.ULINZG(zXXLFMGrw = ZXXLFMGRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W")))
        GRNVHGZNKH = XFIHLI.UVGXSZOO()
        XFIHLI.XOLHV()

        RU OVM(GRNVHGZNKH) == 9:
            IVGFIM uZOHV
        VOHV:
            IVGFIM gIFV

    WVU _UFMWGIZMHUVI_GRNVHGZNK_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        """
        tVG LMV GRNVHGZNK UILN WY LU WZGV
        """
        XFIHLI = HVOU._WY.XFIHLI()
        XFIHLI.VCVXFGV(HVOU._hjo_jfib_hGPzXXLFMGuFMWgIZMHUVI_grnvhgznk.ULINZG(zXXLFMGrw = ZXXLFMGRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W")))
        GRNVHGZNKH = XFIHLI.UVGXSZOO()
        XFIHLI.XOLHV()

        IVG = mLMV
        ULI GH RM GRNVHGZNKH:
            RU GH[9] RH MLG mLMV:
                IVG = WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(GH[9])
                YIVZP

        IVGFIM IVG

    WVU _UFMWGIZMHUVI_GRNVHGZNK_RM_HSN(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI):
        HSN_MZNV = HVOU._hsn_ufmwgizmhuvi.ULINZG(zXXLFMGrw = ZXXLFMGRW, nZXSRMV = NZXSRMV)
        HSN_GZYOV = DS.hSNgZYOV(HSN_MZNV)

        RU MLG HSN_GZYOV.LKVM():
            IVGFIM mLMV

        HVOU.OLTTVI.WVYFT("{9}: {8}".ULINZG(HSN_MZNV, HSN_GZYOV.IZMWLN_RW))
        IVGFIM WZGVGRNV.WZGVGRNV.UILNGRNVHGZNK(RMG(HSN_GZYOV.GRNVHGZNK / 8999999))

    WVU _TVG_UFMWGIZMHUVI_UILN_HSN(HVOU, ZXXLFMGRW :HGI, RMEVHGLIRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        HSN_MZNV = HVOU._hsn_ufmwgizmhuvi.ULINZG(zXXLFMGrw = ZXXLFMGRW, nZXSRMV = NZXSRMV)
        HSN_GZYOV = DS.hSNgZYOV(HSN_MZNV)

        RU MLG HSN_GZYOV.LKVM():
            IVGFIM mLMV

        UFMWGIZMHUVIH = []
        SZH_UFMWGIZMHUVI = uZOHV
        SZH_UFMWRMGVIGIZMHUVI = uZOHV
        ULI ILD RM IZMTV(9, HSN_GZYOV.ILD_MFN):
            RU HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rHrMGI"]] == 'm':
                SZH_UFMWGIZMHUVI = gIFV
            RU HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rHrMGI"]] == 'b':
                SZH_UFMWRMGVIGIZMHUVI = gIFV

            UFMWGIZMHUVI = {
                "zXXLFMGrw": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["zXXRW"]],
                "oRYVIhVIRZO": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["hVIRZO"]],
                "gIZWRMTwZB": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gwWZB"]],
                "rMEVHGLIrw": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rMEHG"]],
                "zXXLFMGgBKV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["zXgBK"]],
                "wRIVXGRLM": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["wRIXG"]],
                "gIZWVgRNV": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gRNV"]],
                "gIZWVzNLFMG": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["gIWzNG"]],
                "rHrMGVIgIZMHUVI": HSN_GZYOV[ILD, HSN_GZYOV.URVOW_NZK["rHrMGI"]],
            }
            UFMWGIZMHUVIH.ZKKVMW(UFMWGIZMHUVI)

        RU MLG SZH_UFMWGIZMHUVI:
            UFMWGIZMHUVI = {
                "zXXLFMGrw": ZXXLFMGRW,
                "oRYVIhVIRZO": -8,
                "gIZWRMTwZB": WZGV.HGIUGRNV("%b%N%W"),
                "rMEVHGLIrw": RMEVHGLIRW,
                "zXXLFMGgBKV": 'zoo',
                "wRIVXGRLM": 'zoo',
                "gIZWVgRNV": '',
                "gIZWVzNLFMG": 9,
                "rHrMGVIgIZMHUVI": 'm',
            }
            UFMWGIZMHUVIH.ZKKVMW(UFMWGIZMHUVI)
        RU MLG SZH_UFMWRMGVIGIZMHUVI:
            UFMWGIZMHUVI = {
                "zXXLFMGrw": ZXXLFMGRW,
                "oRYVIhVIRZO": -7,
                "gIZWRMTwZB": WZGV.HGIUGRNV("%b%N%W"),
                "rMEVHGLIrw": RMEVHGLIRW,
                "zXXLFMGgBKV": '',
                "wRIVXGRLM": 'zoo',
                "gIZWVgRNV": '',
                "gIZWVzNLFMG": 9,
                "rHrMGVIgIZMHUVI": 'b',
            }
            UFMWGIZMHUVIH.ZKKVMW(UFMWGIZMHUVI)

        IVGFIM UFMWGIZMHUVIH

    WVU _RMHVIG_UFMWGIZMHUVI_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV, HSN_UFMWGIZMHUVIH :ORHG, GRNVHGZNK :WZGVGRNV.WZGVGRNV):
        XFIHLI = HVOU._WY.XFIHLI()
        RU HSN_UFMWGIZMHUVIH RH mLMV:

            EZOFVH = HVOU._hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI_mFOO_eZOFVH.ULINZG(
                zXXLFMGrw = ZXXLFMGRW,
                hVZG = NZXSRMV,
                gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"))

            HJOXNW = HVOU._hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI_mFOO + EZOFVH
            XFIHLI.VCVXFGV(HJOXNW)
            HVOU.OLTTVI.RMUL("WY RMHVIG EZOFVH: " + EZOFVH)
        VOHV:
            ULI HSN_UFMWGIZMHUVI RM HSN_UFMWGIZMHUVIH:

                RU HSN_UFMWGIZMHUVI["rHrMGVIgIZMHUVI"] == 'm' ZMW WZGV.HGIUGRNV("%b%N%W") != HSN_UFMWGIZMHUVI["gIZWRMTwZB"]:
                    XLMGRMFV

                RHRMGVIGIZMHUVI = -8
                RU HSN_UFMWGIZMHUVI["rHrMGVIgIZMHUVI"] == 'm':
                    RHRMGVIGIZMHUVI = 9
                VORU HSN_UFMWGIZMHUVI["rHrMGVIgIZMHUVI"] == 'b':
                    RHRMGVIGIZMHUVI = 8

                HVOU.OLTTVI.RMUL("HSN_UFMWGIZMHUVI: {9}".ULINZG(HSN_UFMWGIZMHUVI))
                EZOFVH = HVOU._hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI_eZOFVH.ULINZG(
                    zXXLFMGrw = ZXXLFMGRW,
                    hVZG = NZXSRMV,
                    oRYVIhVIRZO = HSN_UFMWGIZMHUVI["oRYVIhVIRZO"],
                    gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"),
                    rMEVHGLIrw = HSN_UFMWGIZMHUVI["rMEVHGLIrw"],
                    zXXLFMGgBKV = HSN_UFMWGIZMHUVI["zXXLFMGgBKV"],
                    wRIVXGRLM = HSN_UFMWGIZMHUVI["wRIVXGRLM"],
                    gIZWVgRNV = HSN_UFMWGIZMHUVI["gIZWVgRNV"],
                    gIZWVzNLFMG = HSN_UFMWGIZMHUVI["gIZWVzNLFMG"],
                    rHrMGVIgIZMHUVI = RHRMGVIGIZMHUVI,
                    gh = RMG(GRNVHGZNK.GRNVHGZNK()))
                HJOXNW = HVOU._hjo_rmhvig_hGPzXXLFMGuFMWgIZMHUVI + EZOFVH
                HVOU.OLTTVI.RMUL(HJOXNW)
                XFIHLI.VCVXFGV(HJOXNW)
                HVOU.OLTTVI.RMUL("WY RMHVIG EZOFVH: " + EZOFVH)

        HVOU._WY.XLNNRG()
        XFIHLI.XOLHV()

    WVU _WVOVGV_UFMWGIZMHUVI_RM_WY(HVOU, ZXXLFMGRW :HGI, NZXSRMV :HGI, WZGV :WZGVGRNV.WZGV):
        XFIHLI = HVOU._WY.XFIHLI()
        XLMWRGRLM = HVOU._hjo_wvovgv_hGPzXXLFMGuFMWgIZMHUVI_xLMWRGRLMH.ULINZG(zXXLFMGrw = ZXXLFMGRW, hVZG = NZXSRMV, gIZWRMTwZB = WZGV.HGIUGRNV("%b/%N/%W"))
        HJOXNW = HVOU._hjo_wvovgv_hGPzXXLFMGuFMWgIZMHUVI + XLMWRGRLM
        XFIHLI.VCVXFGV(HJOXNW)
        HVOU._WY.XLNNRG()
        XFIHLI.XOLHV()
        HVOU.OLTTVI.RMUL("WVOVGV WY DRGS {9}".ULINZG(XLMWRGRLM))

    WVU _FKWZGV_UFMWGIZMHUVI(HVOU, WZGV :WZGVGRNV.WZGV):
        WZB_YVTRM = WZGVGRNV.WZGVGRNV(WZGV.BVZI, WZGV.NLMGS, WZGV.WZB)

        # FKWZGV UFMWGIZMHUVI
        ULI ZXXLFMGRW, RMEVHGLIRW, NZXSRMV RM HVOU._ZXXLFMGRWH:

            # RMRG mFOO VMGIB ULI ZXXLFMGRW ZG NZXSRMV
            RU MLG HVOU._UFMWGIZMHUVI_VCRHG_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV):
                HVOU.OLTTVI.RMUL("RMHVIG WZGZYZHV {9} {8} UFMWGIZMHUVI DRGS mfoo".ULINZG(ZXXLFMGRW, NZXSRMV))
                HVOU._RMHVIG_UFMWGIZMHUVI_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV, mLMV, mLMV)

            # IVZW HSN GRNVHGZNK ZMW UFMWGIZMHUVI GLTZGSVI GL PVVK GSVN ZGLNRX
            HSN_GRNVHGZNK = HVOU._UFMWGIZMHUVI_GRNVHGZNK_RM_HSN(ZXXLFMGRW, NZXSRMV)
            HVOU.OLTTVI.WVYFT("{9} {8} UFMWGIZMHUVI HSN_GRNVHGZNK: {7}".ULINZG(ZXXLFMGRW, NZXSRMV, HSN_GRNVHGZNK))
            RU HSN_GRNVHGZNK RH mLMV:
                XLMGRMFV

            HSN_UFMWGIZMHUVIH = HVOU._TVG_UFMWGIZMHUVI_UILN_HSN(ZXXLFMGRW, RMEVHGLIRW, NZXSRMV, WZGV)

            RU HSN_GRNVHGZNK < WZB_YVTRM:
                # RTMLIV LOW WZGZ
                HVOU.OLTTVI.WVYFT("{9} {8} RTMLIV LOWVI HSN WZGZ LU GRNVHGZNK {7}".ULINZG(ZXXLFMGRW, NZXSRMV, HSN_GRNVHGZNK))
                XLMGRMFV

            RU HVOU._UFMWGIZMHUVI_GRNVHGZNK_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV) RH mLMV:
                HVOU.OLTTVI.RMUL("RMHVIG WZGZYZHV {9} {8} UFMWGIZMHUVI DRGS WZGZ LU GRNVHGZNK ({7})".ULINZG(ZXXLFMGRW, NZXSRMV, RMG(HSN_GRNVHGZNK.GRNVHGZNK())))
                HVOU._WVOVGV_UFMWGIZMHUVI_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV)
                HVOU._RMHVIG_UFMWGIZMHUVI_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV, HSN_UFMWGIZMHUVIH, HSN_GRNVHGZNK)
            VOHV:
                WY_GRNVHGZNK = HVOU._UFMWGIZMHUVI_GRNVHGZNK_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV)
                RU WY_GRNVHGZNK < HSN_GRNVHGZNK:
                    HVOU.OLTTVI.DZIMRMT("IVKOZXVW WZGZYZHV {9} {8} UFMWGIZMHUVI DRGS MVDVI WZGZ LU GRNVHGZNK ({7})".ULINZG(ZXXLFMGRW, NZXSRMV, RMG(HSN_GRNVHGZNK.GRNVHGZNK())))
                    HVOU._WVOVGV_UFMWGIZMHUVI_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV)
                    HVOU._RMHVIG_UFMWGIZMHUVI_RM_WY(ZXXLFMGRW, NZXSRMV, WZGV, HSN_UFMWGIZMHUVIH, HSN_GRNVHGZNK)
                VOHV:
                    HVOU.OLTTVI.RMUL("{9} {8} GRNVHGZNK RH MLG MVD ZMW RTMLIV".ULINZG(ZXXLFMGRW, NZXSRMV))


    WVU DLIP(HVOU):
        HVOU._XLMMVXG_WY_RU_MLG()
        RU HVOU._WY_RH_XLMMVXG() == uZOHV:
            IVGFIM

        GLWZB = WZGVGRNV.WZGV.GLWZB()
        GIB:
            HVOU._FKWZGV_ZXXLFMG(GLWZB)
            HVOU._FKWZGV_UFMWGIZMHUVI(GLWZB)
            HVOU._FKWZGV_KLHRGRLMH(GLWZB)
        VCXVKG NBHJO.XLMMVXGLI.vIILI ZH VII:
            HVOU.OLTTVI.VIILI("WY VIILI {9}".ULINZG(VII))
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/WZGZ_WVNL.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN YZHV.YZHV_GVHG RNKLIG WRXG_GL_CNO, KIRMG_CNO, RMRG_XOZHH_KZIZ
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
UILN YZHV.TOLYZORMUL RNKLIG tOLYZORMUL
RNKLIG GRNV
XOZHH WZGZ_WVNL(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(WZGZ_WVNL, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

    WVU IVOLZW(HVOU):
        HFKVI(WZGZ_WVNL, HVOU).IVOLZW()
        # IZRHV eZOFVvIILI("IVOLZW")
        HVOU.GRNVH = 9

    WVU DLIP(HVOU):
        HVOU.OLTTVI.RMUL("%H"%(HVOU.RW))
        GRNV.HOVVK(6)
        HVOU.GRNVH += 8
        IZRHV eZOFVvIILI("DLIP")
        RU HVOU.GRNVH > 4:
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV

RU __MZNV__ == "__NZRM__":
    KZIZH = RMRG_XOZHH_KZIZ('WZGZ_WVNL')

    # XSZMTV OLT KZIZNVGVIH
    KZIZH[8].ZGGIRY['OVEVO'] = 'WVYFT'
    KZIZH[8].ZGGIRY['HFYQVXG'] = 'GVHG'

    # XSZMTV LKVIZGRLM KZIZNVGVIH
    KZIZH[9].ZGGIRY['PVB8']  = 'EZOFV8'

    # XIVZGV TOLYZORMUL
    TOLYZORMUL = tOLYZORMUL(uZOHV)
    # ZMW RMRG OLT
    TOLYZORMUL.RMRG_OLT(KZIZH[8])

    # RMRGRZGV XOZHH RMHGZMXV
    WW = WZGZ_WVNL(KZIZH[9], TOLYZORMUL)

    # ZMW DLIP ZUGVIDZIWH
    WW.DLIP()
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/xSVXPmLGVdZIMRMT.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM

XOZHH xSVXPmLGVdZIMRMT(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(xSVXPmLGVdZIMRMT, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.MLGVH = KY.mLGVhFYHXIRYVI()
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.RMW = HVOU.MLGVH.tVGrMWVC()

    WVU DLIP(HVOU):
        MLD_RMW = HVOU.MLGVH.tVGrMWVC()
        RU HVOU.RMW != MLD_RMW:
            ULI RMW  RM IZMTV(HVOU.RMW+8, MLD_RMW+8):
                EZO = HVOU.MLGVH.tVGeZO(RMW)
                RU EZO.rw.OLDVI() == "DZIMRMT":
                    HVOU.OLTTVI.XIRGRXZO(EZO.XLMGVMG)
            IVGFIM uZOHV
        VOHV:
            IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hVXFIRGBnZMZTVIiVZWB.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM

XOZHH hVXFIRGBnZMZTVIiVZWB(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hVXFIRGBnZMZTVIiVZWB, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.HNX = HVOU.TOLYZORMUL.HNX
        HVOU.VIILINVHHZTV = ""

    WVU DLIP(HVOU):
        HVOU.VIILINVHHZTV = ""
        HGZGFH = gIFV
        UFGFIVH_XLFMG = OVM(HVOU.HNX.UFGFIVHRMUL_NZK)
        RU UFGFIVH_XLFMG < 525:
            HVOU.VIILINVHHZTV += "UFGFIVH RMUL XLFMG WRHNZGXS"
            HGZGFH = uZOHV
        IVGFIM  HGZGFH
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPkLHRGRLMHwFNKgLuROV.KB
UILN __UFGFIV__ RNKLIG KIRMG_UFMXGRLM
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH

RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO


XOZHH hGPkLHRGRLMHwFNKgLuROV(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPkLHRGRLMHwFNKgLuROV, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.UROVMZNV   = CNO.ZGGIRY["UROVMZNV"]
        HVOU.ZXXLFMGRW  = CNO.ZGGIRY["ZXXLFMGRW"]

    WVU DLIP(HVOU):
        NTI = WYNLWVO.wZGZnZMZTVI()
        HVHH = NTI.tVGhVHHRLM()
        KLHRGRLMH = HVHH.JFVIB(WYNLWVO.hGPkLHRGRLM).UROGVI(WYNLWVO.hGPkLHRGRLM.zXXLFMGrW == HVOU.ZXXLFMGRW).ZOO()
        DRGS LKVM(HVOU.UROVMZNV, 'D') ZH LUROV:
            LUROV.DIRGV("%H,%H,%H,%H\M" % ('rMHGIFNVMGrW', 'oLMTkLHRGRLM', 'xOLHZYOVoLMT', 'kIRXV'))
            ULI KLH RM KLHRGRLMH:
                LUROV.DIRGV("%H,%H,%H,%H\M" % (KLH.rMHGIFNVMGrW, KLH.oLMTkLHRGRLM, KLH.xOLHZYOVoLMT, KLH.kIRXV))
        HVOU.OLTTVI.RMUL("WFNK GL UROV WLMV")
        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/wFNNBwZGZlK.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM, xLMURTFIZGRLMvMTRMV
# UILN YZHV.WZGZ_LKVIZGRLM RNKLIG wZGZlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
RNKLIG GRNV
# UILN YZHV.YZHV_QLY RNKLIG qLY

XOZHH wFNNBwZGZlK(lKVIZGRLM):
    @HGZGRXNVGSLW
    WVU RMRG_XLMURT():
        XLMURT = xLMURTFIZGRLMvMTRMV()
        #XLMURT.LKGRLMZO('KZIZ8', WVUZFOG='66')
        #XLMURT.IVJFRIV('KZIZ7')
        IVGFIM XLMURT

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(wFNNBwZGZlK, HVOU).__RMRG__(CNO, TOLYZO_RMUL)

    WVU IVOLZW(HVOU):
        HFKVI(wFNNBwZGZlK, HVOU).IVOLZW()

    WVU DLIP(HVOU):
        KIRMG("hGZIGRMT %H" , HVOU.RW)
        KIRMG("URMRHS %H" , HVOU.RW)
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/xZOOhSVOO.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN HFYKILXVHH RNKLIG XZOO


XOZHH xZOOhSVOO(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(xZOOhSVOO, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XNW   = CNO.ZGGIRY["XNW"]

    WVU DLIP(HVOU):
        KIRMG("TLRMT GL VCVXFGV: " + HVOU.XNW)
        IVG = LH.HBHGVN(HVOU.XNW)
        KIRMG(IVG)
        IVGFIM IVG

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hSNnLMRGLI_XZMZIB.KB
# XLWRMT: FGU-1

UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO

RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV

RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN HFYKILXVHH RNKLIG XZOO
UILN HFYKILXVHH RNKLIG kLKVM
UILN XLOOVXGRLMH RNKLIG WVUZFOGWRXG
RNKLIG HFYKILXVHH
RNKLIG HVOVXG
RNKLIG IV
RNKLIG KKIRMG
RNKLIG FIOORY
RNKLIG FIOORY.IVJFVHG
RNKLIG FIOORY.VIILI
RNKLIG QHLM
RNKLIG GRNV
RNKLIG HBH
RNKLIG KKIRMG
RNKLIG XLWVXH
RNKLIG HNGKORY

UILN HJOZOXSVNB.LIN RNKLIG HXLKVW_HVHHRLM, HVHHRLMNZPVI
UILN HJOZOXSVNB RNKLIG FKWZGV
UILN FYRJKBZGZNLWVO RNKLIG NLWVO ZH WYNLWVO
UILN FYRJGLLO RNKLIG OLT

UILN VNZRO.NRNV.NFOGRKZIG RNKLIG nrnvnFOGRKZIG
UILN VNZRO.NRNV.GVCG RNKLIG nrnvgVCG
UILN YZHV.YZHV_WZGZ_HGIFXG RNKLIG xZMZIBiVKLIGwZGZdIZKKVI#, xZMZIBwZGZgBKV

XOZHH hSNnLMRGLI_XZMZIB(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hSNnLMRGLI_XZMZIB, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.GZT_MZNV  = CNO.ZGGIRY["GZT_MZNV"]
        HVOU.GSIVH  = CNO.ZGGIRY.TVG("GSIVH", 89)

        HVOU.OZHG_HVJ  = 9
        HVOU.KILXVHH = mLMV
        HVOU.HVOVXG   = mLMV

        HVOU.WZGZNTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.WY      = HVOU.WZGZNTI.VMTRMV
        HVOU.HLFIXV = CNO.ZGGIRY.TVG('HLFIXV', 'SYAJ6')
        HVOU.XSZMMVO_MZNV = 'ITIZGV'
        HVOU.HGZIGVW = uZOHV
        HVOU.WZGZ_RW = 'HSN.HGZGHNLMRGLI.KGZMT_GVHG.FYRJ5'
        HVOU.IVTRHGVI_XZMZIB_WZGZ(HVOU.WZGZ_RW, 6)

    WVU IVOLZW(HVOU):
        HFKVI(hSNnLMRGLI_XZMZIB, HVOU).IVOLZW()
        HVOU.WZGZNTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.WY      = HVOU.WZGZNTI.VMTRMV
        HVOU.gh = 9
        HVOU.HGZIGVW = uZOHV
        HVOU.IVTRHGVI_XZMZIB_WZGZ(HVOU.WZGZ_RW, 6)

    WVU DLIP(HVOU):
        HVHHRLM = HXLKVW_HVHHRLM(HVHHRLMNZPVI(YRMW=HVOU.WY))
        RU HVOU.KILXVHH RH mLMV:
            HVOU.KILXVHH = HFYKILXVHH.kLKVM(['/LKG/DLINSLOV/YRM/HLKSRZ-HVMW', 'KGZMT_GVHG7'], HGWLFG=HFYKILXVHH.krkv,
                                                       HGWVII=HFYKILXVHH.krkv, YFUHRAV=899)
            HVOU.HVOVXG = HVOVXG.KLOO()
            HVOU.HVOVXG.IVTRHGVI(HVOU.KILXVHH.HGWLFG)
            IVGFIM gIFV

        XFII = HVOU.OZHG_HVJ

        VEVMGH = HVOU.HVOVXG.KLOO(HVOU.GSIVH * 8999)
        KKIRMG.KKIRMG(VEVMGH)
        RH_LMORMV = uZOHV

        DSROV HVOU.HVOVXG.KLOO(HVOU.GSIVH * 8999):
            RH_LMORMV = gIFV
            KIRMG('RM VEVMGH')
            ORMVH = []
            ORMVH.ZKKVMW(HVOU.KILXVHH.HGWLFG.IVZWORMV())
            KIRMG("TVG HLNVGSRMT %H" % OVM(ORMVH))
            ULI ORMV RM ORMVH:
                ORMV = ORMV.WVXLWV('FGU-1')
                KIRMG(ORMV)
                NZGXS = IV.HVZIXS(I'NHTGBKV:\H(\W)', ORMV)
                # RU MLG NZGXS LI NZGXS.TILFK(8) != '8':
                #     XLMGRMFV
                NZGXS = IV.HVZIXS(I'HVJ:\H(\W+)', ORMV)
                XFII = RMG(NZGXS.TILFK(8))
                RU XFII == HVOU.OZHG_HVJ: # WRHXLMMVXGVW
                    KIRMG("HVMW LFG")
                    HVOU.FKWZGV_XZMZIB_WZGZ(HVOU.WZGZ_RW, {'HGZGFH': uZOHV, 'KIVE_IVXE': HVOU.OZHG_HVJ, 'OZHG_IVXE': XFII})
                    HVOU.OZHG_FKWZGV_GRNV = GRNV.GRNV()
                VOHV:
                    HVOU.OZHG_HVJ = XFII
                    RU GRNV.GRNV() - HVOU.OZHG_FKWZGV_GRNV > 9:
                        HVOU.OZHG_FKWZGV_GRNV = GRNV.GRNV()
                        KIRMG("HVMW LFG")
                        HVOU.FKWZGV_XZMZIB_WZGZ(HVOU.WZGZ_RW, {'HGZGFH': gIFV, 'KIVE_IVXE': HVOU.OZHG_HVJ, 'OZHG_IVXE': XFII})


        IVGFIM gIFV

    WVU IVTRHGVI_XZMZIB_WZGZ(HVOU, RW, UIVJFVMXB):
        RU RW RM HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG:
            IZRHV eZOFVvIILI("XZMZIB WZGZ %H RH ZOIVZWB IVTRHGVIVW"%RW)
        VOHV:
            HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG[RW] = xZMZIBiVKLIGwZGZdIZKKVI(RW, UIVJFVMXB)

    WVU FKWZGV_XZMZIB_WZGZ(HVOU, RW, WZGZ):
        RU RW MLG RM HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG:
            IZRHV eZOFVvIILI("XZMZIB WZGZ %H MLG IVTRHGVIVW, BLF HSLFOW XZOO IVTRHGVI_XZMZIB_WZGZ() URIHG"%RW)
        VOHV:
            HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG[RW].WZGZ = WZGZ
            HVOU.TOLYZO_RMUL.XZMZIB_WZGZ_EZFOG[RW].gh = WZGVGRNV.WZGVGRNV.MLD()


//##**---------------- ./HGZIUOVVG/LKVIZGRLM/gyxSVXPiVZWB.KB

RNKLIG HBH
RNKLIG KHFGRO
RNKLIG LH

evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG FYRJGLLO.XOLXP ZH XOLXP


XOZHH gyxSVXPiVZWB(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(gyxSVXPiVZWB, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.FGIZWVH = TOLYZO_RMUL.HBHGVN.FGIZWV
        HVOU.VIILINVHHZTV = ""
        HVOU.GZITVG = CNO.ZGGIRY["GZITVG"]

    WVU DLIP(HVOU):
        HVOU.VIILINVHHZTV = ""
        HGZGFH = gIFV
        # HVOU.XOLXP = XOLXP.xOLXP(HVOU.TOLYZORMUL.HNX)
        HVOU.XOLXP.FKWZGV()
        HGZGFH = gIFV
        ULI FGIZWV RM [C ULI C RM HVOU.FGIZWVH RU C.MZNV == HVOU.GZITVG]:
            ULI RMEVHGRW RM FGIZWV.RMEVHGRW_ORHG:
                GSRH_HGZGFH =  xSVXP(RMEVHGRW)
                HGZGFH = GSRH_HGZGFH ZMW HGZGFH
                RU MLG GSRH_HGZGFH:
                    HVOU.VIILINVHHZTV += RMEVHGRW + " RH LUUORMV;"
        IVGFIM HGZGFH


WVU xSVXP(RMEVHGRW):
    UROVMZNV = "/IFM/gy_"+RMEVHGRW+".KRW"
    RU MLG LH.KZGS.VCRHGH(UROVMZNV):
        IVGFIM uZOHV
    DRGS LKVM(UROVMZNV) ZH U:
        ORMV = U.IVZWORMV()
        KRW = RMG(ORMV.HGIRK())
        RU KHFGRO.KRW_VCRHGH(KRW):
            IVGFIM gIFV
        VOHV:
            IVGFIM uZOHV
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hRNKOVdLIPUOLD.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
RNKLIG JFVFV
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN SVOKVI.FGRO RNKLIG RNKLIG_LKVIZGRLM
UILN SVOKVI.FGRO RNKLIG RNKLIG_HGZIZGVTB
UILN YZHV.VEVMGH RNKLIG vEVMGyFH, vEVMG, vevmg

UILN NFOGRKOVWRHKZGXS RNKLIG WRHKZGXS

XOZHH wZGZxLMGVCG(LYQVXG):
    WVU __RMRG__(HVOU):
        KZHH

XOZHH lKVIZGRLMdLIPVI(LYQVXG):
    WVU __RMRG__(HVOU, LK, VEVMGH, WVKVMWVMXRVH):
        HVOU.LK = LK
        HVOU.VEVMGH = VEVMGH
        HVOU.WVKVMWVMXRVH = {}
        ULI WVK RM WVKVMWVMXRVH:
            HVOU.WVKVMWVMXRVH[WVK] = uZOHV

    WVU DLIP(HVOU, VEVMG):
        HVOU.WVKVMWVMXRVH[VEVMG.VEVMG_GBKV] = gIFV
        ULI W RM ORHG(HVOU.WVKVMWVMXRVH.EZOFVH()):
            RU MLG W:
                IVGFIM uZOHV
        HVOU.VEVMGH.KFG(vEVMG("%H.hgzig" % HVOU.LK.RW))
        HVOU.LK.DLIP()
        HVOU.VEVMGH.KFG(vEVMG("%H.urmrhs" % HVOU.LK.RW))

XOZHH hRNKOVdLIPUOLD(hGPlKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hRNKOVdLIPUOLD, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZORMUL = TOLYZO_RMUL

        HVOU.HVIRZORAZGRLM = gIFV

        HVOU.HGZIG_VEVMG = "%H.hgzig" % HVOU.RW
        HVOU.URMRHS_VEVMG = "%H.urmrhs" % HVOU.RW

        # HVOU.XLMGVCG = wZGZxLMGVCG()
        HVOU.HFYLKVIZGRLM_ORHG = []
        HFYLKCNOH = CNO.URMWZOO("HFYLKVIZGRLM")
        ULI HFYLKCNO RM HFYLKCNOH:
            HFYH = [C.HGIRK() ULI C RM HFYLKCNO.ZGGIRY["HFYHXIRKGRLMH"].HKORG(',')]
            NLWFOV_MZNV = HFYLKCNO.ZGGIRY["NLWFOV"]
            (XOZHHLK, WVHG_KZGS) = RNKLIG_LKVIZGRLM(NLWFOV_MZNV)
            LK = lKVIZGRLMdLIPVI(XOZHHLK(HFYLKCNO, HVOU.TOLYZORMUL), HVOU.VEVMGH, HFYH)
            HVOU.HFYLKVIZGRLM_ORHG.ZKKVMW(LK)
            ULI HFYHXIRKGRLM RM HFYH:
                HVOU.VEVMGYFH.ZWW_ORHGVMVI(HFYHXIRKGRLM, LK)

    WVU IVOLZW(HVOU):
        HFKVI(hRNKOVdLIPUOLD, HVOU).IVOLZW()
        HVOU.VEVMGYFH = vEVMGyFH()
        HVOU.VEVMGH = JFVFV.jFVFV()

    WVU DLIP(HVOU):
        HVOU.VEVMGH.KFG(vEVMG(HVOU.HGZIG_VEVMG))
        DSROV gIFV:
            VEG = HVOU.VEVMGH.TVG()
            KIRMG(VEG)
            RU VEG RH mLMV:
                YIVZP
            HVOU.VEVMGYFH.KFYORHS_VEVMG(VEG)
        HVOU.VEVMGH.KFG(vEVMG(HVOU.URMRHS_VEVMG))
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/wFNNBlK.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
# RNKLIG FYRJGLLO.UROV ZH FYRJUROV
# RNKLIG WZGVGRNV
# RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
# RNKLIG FYRJGLLO.OLT  ZH OLT
# RNKLIG LH
RNKLIG GRNV
RNKLIG KRXPOV

XOZHH wFNNBlK(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(wFNNBlK, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

    WVU DLIP(HVOU):
        HVOU.OLTTVI.RMUL('%H IFMH LMXV'%HVOU.RW)
        # HVOU.TOLYZO_RMUL.WL_HBHGVN_VCRG(-8)
        #ULI R RM IZMTV(84):
            # HVOU.LMVGRNV_IVHFOG.WZGZ.ZKKVMW(KRXPOV.WFNKH(R))
        #    GRNV.HOVVK(8)
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGZIGfGIZWVhGIZGVTBlMgRNV.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG KBKFYHFY ZH KY
RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH

WVU GRNVWRUUVIVMXV(GRNV8, GRNV7):
    WFNNBWZGV = WZGVGRNV.WZGV(7999,8,8)
    IVGFIM (WZGVGRNV.WZGVGRNV.XLNYRMV(WFNNBWZGV,GRNV8) - WZGVGRNV.WZGVGRNV.XLNYRMV(WFNNBWZGV, GRNV7))


XOZHH hGZIGfGIZWVhGIZGVTBlMgRNV(lKVIZGRLM):

    XOZHH hXSVWFOV(LYQVXG):
        WVU __RMRG__(HVOU, CNO,FHVIOLT, TOLYZORMUL):
            HVOU.GRNV_HOLG = FGRO.KZIHV_GRNV( CNO.ZGGIRY["LM_GRNV"].HGIRK() )
            HVOU.HBHGVN = TOLYZORMUL.HBHGVN
            HVOU.XOLXP = TOLYZORMUL.XOLXP
            HVOU.HBHGVN = TOLYZORMUL.HBHGVN
            HVOU.OLTTVI = TOLYZORMUL.OLTTVI
            HVOU.CNO = CNO
            HVOU.XLNNZMWVI = KY.xLNNZMWkFYORHSVI()
            # GIB GL URMW GSV FGIZWV
            HVOU.FGIZWV = mLMV
            HVOU.HGIZGVTB = mLMV
            HVOU.FHVIOLTTVI = FHVIOLT
            HVOU.IVOLZW()
            RU HVOU.XOLXP.MLD.GRNV() > HVOU.GRNV_HOLG:
                HVOU.OLTTVI.DZIM( "gSV HVXSVWFOVW " + HGI(HVOU.GRNV_HOLG)+ " " + HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " SZH ZOIVZWB KZHHVW, HGZIUOVVG DROO WL MLGSRMT")
                HVOU.FHVIOLTTVI.DZIM( "gSV HVXSVWFOVW " + HGI(HVOU.GRNV_HOLG)+ " " + HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " SZH ZOIVZWB KZHHVW, HGZIUOVVG DROO WL MLGSRMT")
                HVOU.IFMMVW = gIFV
            VOHV:
                HVOU.OLTTVI.RMUL( "gSV HVXSVWFOV " + HGI(HVOU.GRNV_HOLG)+ " " + HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " RH ZWWVW")
                HVOU.FHVIOLTTVI.RMUL( "gSV HVXSVWFOV " + HGI(HVOU.GRNV_HOLG)+ " " + HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " RH ZWWVW")
                HVOU.IFMMVW = uZOHV


        WVU IVOLZW(HVOU):
            HGIZGVTB = HVOU.CNO.ZGGIRY["HGIZGVTB"]
            GZITVG = HVOU.CNO.ZGGIRY["GZITVG"]
            ULI FGIZWV RM HVOU.HBHGVN.FGIZWV:
                RU GZITVG == FGIZWV.GZT:
                    HVOU.FGIZWV = FGIZWV
                    YIVZP
            RU MLG FGIZWV:
                IZRHV eZOFVvIILI("XZMMLG URMW FGIZWV "+GZITVG)
            ULI HG RM FGIZWV.HGIZGVTB_ORHG:
                RU HGIZGVTB == HG.RW:
                    HVOU.HGIZGVTB = HG
            RU MLG HVOU.HGIZGVTB:
                IZRHV eZOFVvIILI("XZMMLG URMW HGIZGVTB "+HGIZGVTB)


        WVU ILOORMT_NVHHZTV(HVOU, GW,
                             GRNV_ORHG=[WZGVGRNV.GRNVWVOGZ(NRMFGVH=8),
                                        WZGVGRNV.GRNVWVOGZ(HVXLMWH=69),
                                        WZGVGRNV.GRNVWVOGZ(HVXLMWH=89),
                                        WZGVGRNV.GRNVWVOGZ(HVXLMWH=4)]):
            ULI GRNV RM GRNV_ORHG:
                RU  GRNV < GW < GRNV+WZGVGRNV.GRNVWVOGZ(HVXLMWH=7):
                    HVOU.OLTTVI.RMUL(HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " ZXGREZGRLM vgz: "+HGI(GRNV.HVXLMWH ) + " HVXLMWH")
                    HVOU.FHVIOLTTVI.RMUL(HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " ZXGREZGRLM vgz: "+HGI(GRNV.HVXLMWH ) + " HVXLMWH")


        WVU XSVXP(HVOU):
            RU HVOU.XOLXP.MLD.GRNV() < HVOU.GRNV_HOLG:
                HVOU.IFMMVW = uZOHV

            RU MLG HVOU.IFMMVW:
                RU  HVOU.XOLXP.MLD.GRNV() < HVOU.GRNV_HOLG:
                    HVOU.ILOORMT_NVHHZTV( GRNVWRUUVIVMXV( HVOU.GRNV_HOLG, HVOU.XOLXP.MLD.GRNV() ) )
                RU HVOU.XOLXP.MLD.GRNV() > HVOU.GRNV_HOLG:
                    MVDXLNNZMW = KY.xLNNZMW()
                    MVDXLNNZMW.XLNKLMVMG = HVOU.HGIZGVTB.RW
                    MVDXLNNZMW.KILXVHH = RMG(HVOU.FGIZWV.KRW)
                    MVDXLNNZMW.HRW = HVOU.HGIZGVTB.RW
                    MVDXLNNZMW.KILTIZN = HVOU.FGIZWV.GZT
                    MVDXLNNZMW.rw = HVOU.FGIZWV.rw
                    MVDXLNNZMW.SLHG = HVOU.FGIZWV.SLHG
                    MVDXLNNZMW.WLNZRM = HVOU.FGIZWV.WLNZRM
                    MVDXLNNZMW.XLMGVMG = "IVHFNV&8"
                    HVOU.XLNNZMWVI.kFYORHS(MVDXLNNZMW)
                    HVOU.OLTTVI.RMUL(HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " RH ZXGREZGVW")
                    HVOU.FHVIOLTTVI.RMUL(HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " RH ZXGREZGVW")
                    HVOU.IFMMVW = gIFV


    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGZIGfGIZWVhGIZGVTBlMgRNV, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.HXSVWFOV_ORHG = {}
        # GSRH RH HGLIV KZGSH ZMW UROV HGZGH
        HVOU.HXSVWFOV_CNOUROV = {}
        # RGVIZGV GSILFTS HFYHXSVWFOVCNO GL ZXJFRIV ZOO KVLKOV'H HXSVXFOVH
        ULI CNOMLWV RM CNO.URMWZOO("HXSVWFOVCNO"):
            KZGS = CNOMLWV.ZGGIRY["KZGS"]
            RU MLG  FYRJUROV.RH_UROV_VCRHG(KZGS):
                IZRHV eZOFVvIILI("XZMMLG URMW UROV "+KZGS)
            VOHV:
                FHVIMZNV = LH.KZGS.YZHVMZNV(KZGS)
                FHVIOLT = OLT.oLTTVI( LH.KZGS.YZHVMZNV(LH.KZGS.WRIMZNV(KZGS)), "rmul",  LH.KZGS.QLRM( LH.KZGS.WRIMZNV(KZGS),"HGZIUOVVG.OLT"))
                HVOU.HXSVWFOV_CNOUROV[FHVIMZNV] = (KZGS, FYRJUROV.HGZG(KZGS) )
                HVOU.HXSVWFOV_ORHG[FHVIMZNV] = []
                GIVV = VGIVV.KZIHV(KZGS)
                GVNK_CNOHVXGRLM =  GIVV.URMW("FGIZWV_HGIZGVTB_HXSVWFOVH")
                RU OVM(GVNK_CNOHVXGRLM) > 9:
                    ULI HXSVWFOV_CNO RM GVNK_CNOHVXGRLM.URMWZOO("HXSVWFOV"):
                        RU HXSVWFOV_CNO.ZGGIRY["ZXGRLM"] == "ZXGREZGV":
                            HXS = hGZIGfGIZWVhGIZGVTBlMgRNV.hXSVWFOV(HXSVWFOV_CNO, FHVIOLT, HVOU.TOLYZORMUL)
                            HVOU.HXSVWFOV_ORHG[FHVIMZNV].ZKKVMW(HXS)


    WVU DLIP(HVOU):
        ULI FHVI RM HVOU.HXSVWFOV_CNOUROV:
            FHVIKZGS = HVOU.HXSVWFOV_CNOUROV[FHVI][9]
            MVDHGZG = FYRJUROV.HGZG(FHVIKZGS)
            LOWHGZG = HVOU.HXSVWFOV_CNOUROV[FHVI][8]
            RU MVDHGZG.HG_RML != LOWHGZG.HG_RML LI MVDHGZG.HG_NGRNV != LOWHGZG.HG_NGRNV:
                FHVIMZNV = LH.KZGS.YZHVMZNV(LH.KZGS.WRIMZNV(FHVIKZGS))
                HVOU.HXSVWFOV_CNOUROV[FHVI] = (FHVIKZGS, MVDHGZG)
                RU OVM(HVOU.HXSVWFOV_ORHG[FHVI])>9:
                    FHVIOLT = HVOU.HXSVWFOV_ORHG[FHVI][9].FHVIOLTTVI
                    HVOU.HXSVWFOV_ORHG[FHVI] = []
                VOHV:
                    FHVIOLT = OLT.oLTTVI( FHVIMZNV, "rmul",  LH.KZGS.QLRM( LH.KZGS.WRIMZNV(FHVIKZGS),"HGZIUOVVG.OLT"))
                FHVIOLT.RMUL( "WVGVXGVW HXSVWFOV XSZMTVW, IVOLZW "+FHVIMZNV )
                HVOU.OLTTVI.RMUL("WVGVXGVW HXSVWFOV XSZMTVW, IVOLZW "+FHVIMZNV)
                GIVV = VGIVV.KZIHV(FHVIKZGS)
                GVNK_CNOHVXGRLM =  GIVV.URMW("FGIZWV_HGIZGVTB_HXSVWFOVH")
                RU OVM(GVNK_CNOHVXGRLM) > 9:
                    ULI HXSVWFOV_CNO RM GVNK_CNOHVXGRLM.URMWZOO("HXSVWFOV"):
                        RU HXSVWFOV_CNO.ZGGIRY["ZXGRLM"] == "ZXGREZGV":
                            HXS = hGZIGfGIZWVhGIZGVTBlMgRNV.hXSVWFOV(HXSVWFOV_CNO, FHVIOLT, HVOU.TOLYZORMUL)
                            HVOU.HXSVWFOV_ORHG[FHVI].ZKKVMW(HXS)


            # RU HVOU.HXSVWFOV_CNOUROV[FHVIKZGS]


        ULI FHVI RM HVOU.HXSVWFOV_ORHG:
            ULI HXSVWFOV RM HVOU.HXSVWFOV_ORHG[FHVI]:
                HXSVWFOV.XSVXP()
        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/__RMRG__.KB
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hRNKOVhGPdLIPUOLD.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN SVOKVI.FGRO RNKLIG RNKLIG_LKVIZGRLM
UILN SVOKVI.FGRO RNKLIG RNKLIG_HGZIZGVTB
UILN YZHV.VEVMGH RNKLIG vEVMGyFH

XOZHH hRNKOVdLIPUOLD(hGPlKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hRNKOVdLIPUOLD, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.HGIZGVTBCNOH = CNO.URMWZOO("HGIZGVTB")
        HVOU.VEVMGYFH = vEVMGyFH()
        ULI HGIZGVTBCNO RM HVOU.HGIZGVTBCNOH:
            NLWFOV_MZNV = HGIZGVTBCNO.ZGGIRY["NLWFOV"]
            (XOZHHLK, WVHG_KZGS) = RNKLIG_HGZIZGVTB(NLWFOV_MZNV)
            HVOU.HGZIZGVTB = XOZHHLK(HGIZGVTBCNO, HVOU.TOLYZORMUL, HVOU.VEVMGYFH)

        # HVOU.HFYLKCNOH = CNO.URMWZOO("HFYLKVIZGRLM")

        # ULI HFYLKCNO RM HFYLKCNOH:
        #     NLWFOV_MZNV = HFYLKCNO.ZGGIRY["NLWFOV"]
        #     (XOZHHLK, WVHG_KZGS) = RNKLIG_HGZIZGVTB(NLWFOV_MZNV)
        #     HFYLKCNO.HVG("GZITVG", HVOU.GZITVG)
        #     LK = XOZHHLK(HFYLKCNO, HVOU.TOLYZORMUL)
        #     HVOU.HFYLKVIZGRLM_ORHG.ZKKVMW(LK)

    WVU IVOLZW(HVOU):
        HFKVI(hRNKOVdLIPUOLD, HVOU).IVOLZW()

    WVU DLIP(HVOU):
        IVGFIM gIFV

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hRNKOVwZGZdLIPUOLD.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG GRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
RNKLIG JFVFV
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN SVOKVI.FGRO RNKLIG RNKLIG_LKVIZGRLM
UILN SVOKVI.FGRO RNKLIG RNKLIG_HGZIZGVTB
UILN YZHV.VEVMGH RNKLIG vEVMGyFH, vEVMG, vevmg

UILN NFOGRKOVWRHKZGXS RNKLIG WRHKZGXS
RNKLIG MVGDLIPC ZH MC
RNKLIG XLMXFIIVMG.UFGFIVH
RNKLIG KKIRMG
UILN MVGDLIPC.IVZWDIRGV RNKLIG QHLM_TIZKS
RNKLIG FFRW
UILN XLNKLMVMG.LKIVXLIWNZMZTVI RNKLIG qLYiVXLIWVI
RNKLIG FYRJGLLO.FGRO ZH FGRO

XOZHH wZGZxLMGVCG(LYQVXG):
    WVU __RMRG__(HVOU):
        HVOU.WZT = mLMV
        HVOU.DLIPVIH = {}

XOZHH qLY(LYQVXG):
    WVU __RMRG__(HVOU, DLIPUOLD_RW, WZT, XLMGVCG, TOLYZO_RMUL):
        HVOU.TOLYZO_RMUL = TOLYZO_RMUL
        HVOU.rW          = HGI(FFRW.FFRW8())
        HVOU.DLIPUOLD_RW = DLIPUOLD_RW
        HVOU.WZT     = WZT
        HVOU.XLMGVCG = XLMGVCG
        HVOU.HGZGFH  = mLMV
        HVOU.HGZIG_GRNV = mLMV
        HVOU.VMW_GRNV = mLMV
        HVOU.HGZGFH   = "kvmwrmt"
        HVOU.LK_RWH      = [ LK ULI LK RM MC.GLKLOLTRXZO_HLIG(HVOU.WZT) RU LK.SLHG RH mLMV LI LK.SLHG == TOLYZO_RMUL.HGZIUOVVG_GZT ]
        HVOU.RH_NZRM  = gIFV
        HVOU.LK_HGZGFH = {}

    WVU RH_WLMV(HVOU):
        IVGFIM HVOU.HGZGFH RM ["hfxxvhh", "uzro", "xzmxvo"]

    WVU IFM(HVOU):
        HVOU.IVXLIWVI.FKWZGV_QLY(HVOU)

        DRGS XLMXFIIVMG.UFGFIVH.gSIVZWkLLOvCVXFGLI(NZC_DLIPVIH=4) ZH VCVXFGLI:
            ULI RW RM HVOU.LK_RWH:
                VCVXFGLI.HFYNRG(HVOU.XLMGVCG.DLIPVIH[RW].DLIP, HVOU.XLMGVCG)


        DSROV MLG HVOU.RH_WLMV():
            HVOU.HZEV_HGZGFH()
            HVOU.HBMX_HGZGFH()
            GRNV.HOVVK(7)

        IVGFIM gIFV

    WVU HZEV_HGZGFH(HVOU):
        ULI RW RM HVOU.LK_RWH:
            HGZGFH = HVOU.XLMGVCG.DLIPVIH[RW].HGZGFH
            HVOU.IVXLIWVI.FKWZGV_LK(HVOU.rW, RW, HGZGFH)
        KZHH

    WVU HBMX_HGZGFH(HVOU):
        KZHH

XOZHH dLIPVIhGZGFHnZMZTVI(LYQVXG):
    WVU RH_WLMV(HVOU):
        IVGFIM HVOU.HGZGFH RM ["hfxxvhh", "uzro"]

    WVU RH_HFXXVHH(HVOU):
        IVGFIM HVOU.HGZGFH RM ["hfxxvhh", "kzhh"]

    WVU ULIXV_HFXVHH(HVOU):
        HVOU.HGZGFH = "hfxxvhh"

XOZHH lKVIZGRLMdLIPVI(LYQVXG, dLIPVIhGZGFHnZMZTVI):
    WVU __RMRG__(HVOU, LK):
        HVOU.RW = LK.RW
        HVOU.LK = LK
        HVOU.HGZGFH = "rwov"
        HVOU.GIRTTVI_IFOV = "ZOO_HFXXVHH"
        HVOU.RH_IFMMRMT = uZOHV
        HVOU.SLHG = mLMV

    WVU ULIXV_IFM(HVOU):
        RU HVOU.LK.DLIP():
            HVOU.HGZGFH = "hfxxvhh"
        VOHV:
            HVOU.HGZGFH = "uzro"
        HVOU.RH_IFMMRMT = uZOHV

    WVU WVKVMWVMXRVH_IVZWB(HVOU):
        #glwl
        KZHH

    WVU DLIP(HVOU, XLMGVCG):
        ZOO_WLMV = uZOHV
        DSROV MLG ZOO_WLMV:
            GIB:
                ZOO_WLMV = gIFV
                ULI RW RM MC.ZMXVHGLIH(XLMGVCG.WZT, HVOU.RW):
                    ZOO_WLMV = ZOO_WLMV ZMW XLMGVCG.DLIPVIH[RW].RH_WLMV()
            VCXVKG vCXVKGRLM ZH VC:
                KIRMG(VC)
                KIRMG(MC.ZMXVHGLIH(XLMGVCG.WZT, HVOU.RW))
            GRNV.HOVVK(8)

        GIB:
            RU HVOU.LK.DLIP():
                HVOU.HGZGFH = "hfxxvhh"
                IVGFIM
            HVOU.HGZGFH = "uzro"
        VCXVKG:
            HVOU.HGZGFH = "uzro"
        IVGFIM


XOZHH lKVIZGRLMiVNLGVdLIPVI(LYQVXG, dLIPVIhGZGFHnZMZTVI):
    WVU ULIXV_IFM(HVOU):
        RU HVOU.LK.DLIP():
            HVOU.HGZGFH = "hfxxvhh"
        VOHV:
            HVOU.HGZGFH = "uzro"

    WVU ULIXV_HFXXVHH(HVOU):
        HVOU.HGZGFH = "hfxxvhh"

    WVU RH_HFXXVHH(HVOU):
        IVGFIM HVOU.HGZGFH RM ["hfxxvhh", "kzhh"]

    WVU DLIP(HVOU, XLMGVCG):
        ZOO_WLMV = uZOHV
        DSROV MLG ZOO_WLMV:
            GIB:
                ZOO_WLMV = gIFV
                ULI RW RM MC.ZMXVHGLIH(XLMGVCG.WZT, HVOU.RW):
                    ZOO_WLMV = ZOO_WLMV ZMW XLMGVCG.DLIPVIH[RW].RH_WLMV()
            VCXVKG vCXVKGRLM ZH VC:
                KIRMG(VC)
                KIRMG(MC.ZMXVHGLIH(XLMGVCG.WZT, HVOU.RW))
            GRNV.HOVVK(8)

        DSROV MLG HVOU.RH_WLMV:
            GRNV.HOVVK(8)

        IVGFIM gIFV

XOZHH hRNKOVwZGZdLIPUOLD(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hRNKOVwZGZdLIPUOLD, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.HVIRZORAZGRLM = gIFV
        # HVOU.HGZIG_VEVMG = "%H.hgzig" % HVOU.RW
        # HVOU.URMRHS_VEVMG = "%H.urmrhs" % HVOU.RW
        HVOU.TOLYZO_WZT = MC.wRtIZKS()
        HVOU.TOLYZO_WZT.ZWW_MLWV(HVOU.RW)

        # HVOU.XLMGVCG = wZGZxLMGVCG()
        HVOU.HFYLKVIZGRLMH = {}
        HVOU.HFYLKVIZGRLMH[HVOU.RW] = HVOU

        HFYLKCNOH = CNO.URMWZOO("HFYLKVIZGRLM")
        ULI HFYLKCNO RM HFYLKCNOH:
            NLWFOV_MZNV = HFYLKCNO.ZGGIRY["NLWFOV"]
            (XOZHHLK, WVHG_KZGS) = RNKLIG_LKVIZGRLM(NLWFOV_MZNV)
            LK = XOZHHLK(HFYLKCNO, HVOU.TOLYZORMUL)
            HVOU.TOLYZO_WZT.ZWW_MLWV(LK.RW)
            HVOU.HFYLKVIZGRLMH[LK.RW] = LK
            WVKH = [C.HGIRK() ULI C RM HFYLKCNO.ZGGIRY["WVKVMWVMXRVH"].HKORG(',')]
            RU OVM(WVKH) == 9:
                HVOU.TOLYZO_WZT.ZWW_VWTV(HVOU.RW, LK.RW)
            ULI WVK RM WVKH:
                HVOU.TOLYZO_WZT.ZWW_VWTV(WVK, LK.RW)

        HVOU.IVOLZW()
        # KKIRMG.KKIRMG(MC.WVHXVMWZMGH(HVOU.TOLYZO_WZT, HVOU.RW))
        # KKIRMG.KKIRMG(MC.GLKLOLTRXZO_HLIG(HVOU.TOLYZO_WZT))

    WVU IVOLZW(HVOU):
        HFKVI(hRNKOVwZGZdLIPUOLD, HVOU).IVOLZW()
        HVOU.IVXLIWVI = qLYiVXLIWVI()
        HVOU.QLYH = []
        #IVOLZW UILN WZGZYZHVH

    WVU FKWZGV_WZT(HVOU):
        KZHH

    WVU GZPV_XLNNZMW(HVOU, XLNNZMW, ZITFNVMGH):
        KIRMG('%H IVXVREVH XNW:%H'%(HVOU.RW, XLNZMW))
        RU(XLNNZMW == 'IFM'):
            RU OVM(ZITFNVMGH) == 8:
                HVOU.HGZIG_MVD_WZT(ZITFNVMGH[9])
            VOHV:
                KIRMG("FHZTV: IFM LKVIZGRLM_RW")

    WVU HGZIG_MVD_WZT(HVOU, HGZIG_KLRMG):
        RU HGZIG_KLRMG MLG RM HVOU.TOLYZO_WZT.MLWVH():
            HVOU.OLTTVI.DZIMRMT("XZMMLG URMW MLWV %H RM DLIPUOLD" % HGZIG_KLRMG)
            IVGFIM uZOHV

        MLWVH = ORHG(MC.WVHXVMWZMGH(HVOU.TOLYZO_WZT, HGZIG_KLRMG))

        MLWVH.ZKKVMW(HGZIG_KLRMG)
        WZT = HVOU.TOLYZO_WZT.HFYTIZKS(MLWVH)
        XLMGVCG = wZGZxLMGVCG()
        XLMGVCG.WZT = WZT
        QLY = qLY(HVOU.RW, WZT, XLMGVCG)
        ULI RW RM MLWVH:
            QLY.XLMGVCG.DLIPVIH[RW] = lKVIZGRLMdLIPVI(HVOU.HFYLKVIZGRLMH[RW])

        HVOU.IVXLIWVI.ZWW_MVD_QLY(QLY)
        HVOU.QLYH.ZKKVMW(QLY)

        # GIB:
        #     HVOU.IVXLIWVI.ZWW_MVD_QLY(QLY)
        #     HVOU.QLYH.ZKKVMW(QLY)
        # VCXVKG:
        #     KIRMG("VIILI")


    WVU DLIP(HVOU):
        RU OVM(HVOU.QLYH) == 9:
            HVOU.HGZIG_MVD_WZT(HVOU.RW)
        VOHV:
            IVGFIM gIFV

        ULI QLY RM [QLY ULI QLY RM HVOU.QLYH RU MLG QLY.RH_WLMV()]:
            QLY.IFM()


//##**---------------- ./HGZIUOVVG/LKVIZGRLM/sLOWgLhSZIVH.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN LH RNKLIG DZOP
RNKLIG XHE
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG TVGKZHH

XOZHH sLOWgLhSZIVH(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(sLOWgLhSZIVH, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.NTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.HJOH = ['''
IVKOZXV RMGL FTFZIW_IRHP(gZT, iRHPrGVNrW,  iRHPeZOFV, gh )
HVOVXG hGIZGVTBrW, '099899896', NZC(Z.oLMTkLHRGRLM / Y.gLGZOhSZIVH) ZH gLgLGZO, MLD()
UILN hGPkLHRGRLMH_ACGIFHG Z QLRM hGLXPrMUL Y LM Z.gIZWRMTwzB = Y.gIZWRMTwZB ZMW Z.rMHGIFNVMGrW = Y.rMHGIFNVMGrW
DSVIV Z.gIZWRMTwZB = XFIWZGV()
TILFK YB Z.gIZWRMTwZB , hGIZGVTBrW
        ''', '''
IVKOZXV RMGL FTFZIW_IRHP(gZT, iRHPrGVNrW,  iRHPeZOFV, gh )
HVOVXG hGIZGVTBrW, '099899891', NZC(Z.oLMTkLHRGRLM / Y.gLGZOuOLZGhSZIVH) ZH gLuOLZG, MLD()
UILN hGPkLHRGRLMH_ACGIFHG Z QLRM hGLXPrMUL Y LM Z.gIZWRMTwzB = Y.gIZWRMTwZB ZMW Z.rMHGIFNVMGrW = Y.rMHGIFNVMGrW
DSVIV Z.gIZWRMTwZB = XFIWZGV()
TILFK YB Z.gIZWRMTwZB , hGIZGVTBrW
        ''', '''
IVKOZXV RMGL FTFZIW_IRHP(gZT, iRHPrGVNrW,  iRHPeZOFV, gh )
HVOVXG hGIZGVTBrW, '099899895', NZC(XZHV DSVM HFYHGIRMT(Z.rMHGIFNVMGrW, 8, 8) = '6' GSVM Z.oLMTkLHRGRLM * Z.kIRXV VOHV 9 VMW) / XZHV DSVM HFN(Z.oLMTkLHRGRLM * Z.kIRXV) > 799999999 GSVM HFN(Z.oLMTkLHRGRLM * Z.kIRXV) VOHV 799999999 VMW ZH IE, MLD()
UILN hGPkLHRGRLMH_ACGIFHG Z QLRM hGLXPrMUL Y LM Z.gIZWRMTwzB = Y.gIZWRMTwZB ZMW Z.rMHGIFNVMGrW = Y.rMHGIFNVMGrW
DSVIV Z.gIZWRMTwZB = XFIWZGV()
TILFK YB Z.gIZWRMTwZB , hGIZGVTBrW
        ''', '''
IVKOZXV RMGL FTFZIW_IRHP(gZT, iRHPrGVNrW,  iRHPeZOFV, gh )
HVOVXG hGIZGVTBrW, '099899894', NZC(XZHV DSVM HFYHGIRMT(Z.rMHGIFNVMGrW, 8, 8) != '6' GSVM Z.oLMTkLHRGRLM * Z.kIRXV VOHV 9 VMW) /  XZHV DSVM HFN(Z.oLMTkLHRGRLM * Z.kIRXV) > 799999999 GSVM HFN(Z.oLMTkLHRGRLM * Z.kIRXV) VOHV 799999999 VMW ZH IE , MLD()
UILN hGPkLHRGRLMH_ACGIFHG Z QLRM hGLXPrMUL Y LM Z.gIZWRMTwzB = Y.gIZWRMTwZB ZMW Z.rMHGIFNVMGrW = Y.rMHGIFNVMGrW
DSVIV Z.gIZWRMTwZB = XFIWZGV()
TILFK YB Z.gIZWRMTwZB , hGIZGVTBrW
        ''']

    WVU DLIP(HVOU):
        KIVE_WZB_HGI = HGI(HVOU.XOLXP.KIVE_GIZWRMT_WZB)
        WZB_HGI = HGI(HVOU.XOLXP.GIZWRMT_WZB)
        KIRMG("FKWZGV KIVE: %H MLD: %H" % (KIVE_WZB_HGI, WZB_HGI))
        ULI HJO RM HVOU.HJOH:
            HVOU.OLTTVI.RMUL(HJO)
            HVOU.NTI.VMTRMV.VCVXFGV(HJO)
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPzXXvBVwyOLZWVI.KB

UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG NBHJO.XLMMVXGLI
RNKLIG WZGVGRNV
RNKLIG IV
RNKLIG LH
RNKLIG SVOKVI.FGRO ZH FGRO

UILN QRMQZ7 RNKLIG gVNKOZGV
UILN QRMQZ7 RNKLIG vMERILMNVMG
RNKLIG KKIRMG

RNKLIG GIZXVYZXP
RNKLIG GRNV


WVU WL_JFLGV(EZOFV):
    RU EZOFV RH MLG mLMV :
        IVGFIM "'" + HGI(EZOFV) + "'"
    VOHV:
        IVGFIM EZOFV

WVU DZGXS(UM):
    UK = LKVM(UM, 'I', VMXLWRMT='TYP')
    DSROV gIFV:
        MVD = UK.IVZWORMV()
        # lMXV ZOO ORMVH ZIV IVZW GSRH QFHG IVGFIMH ''
        # FMGRO GSV UROV XSZMTVH ZMW Z MVD ORMV ZKKVZIH
        RU MVD:
            BRVOW MVD
        VOHV:
            GRNV.HOVVK(9.8)

XOZHH hGPzXXvBVwyOLZWVI(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPzXXvBVwyOLZWVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.XZGVTLIB = 'ZXXLFMGVBV'

        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.XOLXP.FKWZGV()

        HVOU.HVIEVI = CNO.ZGGIRY.TVG("HVIEVI", mLMV)

        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.UROV_KZGS = CNO.ZGGIRY["UROV_KZGS"]
        HVOU.GKOVME = vMERILMNVMG()
        HVOU.GKOVME.UROGVIH['JFLGV'] = WL_JFLGV
        HVOU.WZGV = CNO.ZGGIRY.TVG("WZGV", HVOU.XOLXP.WZGV_GL_RMG_HGI())

        ULI WY_CNO RM CNO.URMWZOO("WY"):
            FHVIMZNV = WY_CNO.ZGGIRY["FHVI"]
            KZHHDLIW = WY_CNO.ZGGIRY["KZHHDW"]
            HVIEVI = WY_CNO.ZGGIRY["SLHG"]
            KLIG = RMG(WY_CNO.ZGGIRY["KLIG"])
            WY = WY_CNO.ZGGIRY["WY"]
            HVOU.WY= NBHJO.XLMMVXGLI.XLMMVXG(SLHG=HVIEVI,KLIG=KLIG,FHVI=FHVIMZNV,KZHHDW=KZHHDLIW,WY=WY)
            YIVZP
        HVOU.OLZWVIH = []
        # HVOU.OLZWhGLXPrUL()
        GKO = gVNKOZGV(HVOU.UROV_KZGS)

        ULI NZXSRMV RM CNO.ZGGIRY["NZXSRMVH"].HKORG('|'):
            HVOU.UROV =  HVOU.XOLXP.HGIUWZGV(HVOU.UROV_KZGS)
            UROV = GKO.IVMWVI(NZXSRMV = NZXSRMV, WZGV = HVOU.WZGV)
            HVOU.OLZWVIH.ZKKVMW(oLTwyOLZWVI(HVOU.WY, UROV, HVOU.OLTTVI, HVOU.WZGV, HVOU.HVIEVI))

    WVU DLIP(HVOU):
        ULI OLZWVI RM HVOU.OLZWVIH:
            OLZWVI.DLIP()

XOZHH oLTwyOLZWVI(lKVIZGRLM):
    WVU __RMRG__(HVOU, WY, UROV, OLTTVI, GIZWVWZB, HVIEVI=mLMV):
        HVOU.XZGVTLIB = 'ZXXLFMGVBV'
        HVOU.MLGVH = KY.mLGVhFYHXIRYVI()
        HVOU.OLTTVI = OLTTVI
        HVOU.GKOVME = vMERILMNVMG()
        HVOU.GKOVME.UROGVIH['JFLGV'] = WL_JFLGV
        HVOU.HJO_YZGXS = []
        HVOU.UROV =  UROV
        HVOU.WY = WY
        HVOU.HVIEVI = HVIEVI
        HVOU.HFYXZGVTLIB = LH.KZGS.YZHVMZNV(HVOU.UROV)
        HVOU.OZHGFKWZGVGRNV = HVOU.TVGoZHGhGZGFH()
        HVOU.GIZWVWZB = GIZWVWZB
        RU HVOU.OZHGFKWZGVGRNV RH mLMV:
            HVOU.OZHGFKWZGVGRNV = WZGVGRNV.WZGVGRNV(8000, 8, 8)

    WVU KILXVHH_LIWVI_VEVMG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        IVKOZXV RMGL hGPgIZWVH (`zXXLFMGrW`, `lIWVIrW`,    `lIWVIhBHrW`,      `lIWVIgBKV`,  `vEVMGgBKV`,
                                      `hGIZGVTBrw`,`gIZWRMTwZB`, `vCGVIMZOgIZWVrW`, `rMHGIFNVMGrW`,`lIWVIhGZGFH`,
                                      `gIZWVkIRXV`,`gIZWVeLOFNV`,`fKWZGVgRNV`,      `MLGVH`, `vEVMGgRNVhGZNK`)
        EZOFVH(%(zXXLFMGrW)H,  %(lIWVIrW)H,     %(lIWVIhBHrW)H,      %(lIWVIgBKV)H,    %(vEVMGgBKV)H,
               %(hGIZGVTBrw)H, %(gIZWRMTwZB)H,  %(vCGVIMZOgIZWVrW)H, %(rMHGIFNVMGrW)H, %(lIWVIhGZGFH)H,
               %(gIZWVkIRXV)H, %(gIZWVeLOFNV)H, %(fKWZGVgRNV)H,      %(MLGVH)H , %(vEVMGgRNVhGZNK)H)
        '''

        #79839574 82:76:86|gBKV=vEVMG|mZNV=lIWVI|pVB=42112430784510|rMEVHGLIrw=899893694|rMHGIFNVMGrw=xu390|hGIZGVTBrw=JBZLXGZ|lIWVIhBHrw=|zXGRLM=7|gIZWVeLOFNV=9|gIZWVkIRXV=9|gIZWVrw=|lIWVIhGZGFH=F|vIILIrw=9
        GIB:
            HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                       'lIWVIrW' : EZOFVH['pVB'],
                                       'lIWVIhBHrW' : EZOFVH['lIWVIhBHrw'],
                                       'lIWVIgBKV' : '',
                                       'hGIZGVTBrw' : EZOFVH['hGIZGVTBrw'],
                                       'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                       'vCGVIMZOgIZWVrW' : EZOFVH['gIZWVrw'],
                                       'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                       'yILPVIrW' : '',
                                       'vCXSZMTVrW' : '',
                                       'lIWVIhGZGFH' : EZOFVH['lIWVIhGZGFH'],
                                       'gIZWVkIRXV' : EZOFVH['gIZWVkIRXV'],
                                       'gIZWVeLOFNV' : EZOFVH['gIZWVeLOFNV'],
                                       'sVTWVuOZT' : '',
                                       'fKWZGVgRNV' : FKWZGVGRNV,
                                       'xFIIVMXB' : 'xmb',
                                       'kZIVMGlIWVIrW' : '',
                                       'vEVMGgBKV' : EZOFVH['zXGRLM'],
                                       'vEVMGgRNVhGZNK' : EZOFVH.TVG('gRNVhGZNK'),
                                       'MLGVH' : ''} )
        VCXVKG vCXVKGRLM ZH V:
            KKIRMG.KKIRMG(EZOFVH);
            KKIRMG.KKIRMG(V);

    WVU KILXVHH_LIWVI_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        ivkozxv rmgl `hGPlIWVIH` (`zXXLFMGrW`,        `lIWVIrW`,       `lIWVIhBHrW`,  `lIWVIgBKV`,  `hGIZGVTBrW`,  `gIZWRMTwZB`,
                                  `lIWVIxIVZGVgRNV`,  `rMHGIFNVMGrW`,  `yILPVIrW`,    `vCXSZMTVrW`, `lIWVIhGZGFH`, `wRIVXGRLM`,
                                  `lUUHVGuOZT`,       `kIRXVgBKV`,     `oRNRGkIRXV`,  `eLOFNV`,     `uROOVWkIRXV`,  `uROOVWeLOFNV`,
                                  `sVWTVuOZT`,        `fKWZGVgRNV`,    `xFIIVMXB`,    `kZIVMGlIWVIrW`,  `MLGVH`,    `gRNVxLMWRGRLM`,
                                  `eLOFNVxLMWRGRLM`
                                  )
        ezofvh (%(zXXLFMGrW)H, %(lIWVIrW)H,%(lIWVIhBHrW)H,%(lIWVIgBKV)H,%(hGIZGVTBrW)H,%(gIZWRMTwZB)H,
        mfoo,%(rMHGIFNVMGrW)H,%(yILPVIrW)H,%(vCXSZMTVrW)H,
        %(lIWVIhGZGFH)H,%(wRIVXGRLM)H,%(lUUHVGuOZT)H,%(kIRXVgBKV)H, %(oRNRGkIRXV)H,
        %(eLOFNV)H,%(uROOVWkIRXV)H,%(uROOVWeLOFNV)H,%(sVWTVuOZT)H,%(fKWZGVgRNV)H,
        %(xFIIVMXB)H,%(kZIVMGlIWVIrW)H,%(MLGVH)H,
        %(gRNVxLMWRGRLM)H, %(eLOFNVxLMWRGRLM)H)
'''
        #79839574 82:76:86|gBKV=hMZKHSLG|mZNV=lIWVI|pVB=45221987106814|rMEVHGLIrw=899893694|rMHGIFNVMGrw=xu390|hGIZGVTBrw=JBZLXGZ|vCXSZMTVrw=xaxv|lIWVIhBHrw=7983957499759638|lUUHVGuOZT=8|sVWTVuOZT=8|wRIVXGRLM=9|gRNVxLMWRGRLM=6|eLOFNVxLMWRGRLM=8|kIRXVgBKV=7|oRNRGkIRXV=87134|eLOFNVgLGZO=8|eLOFNVgIZWVW=8|lIWVIhGZGFH=9|vIILIrw=9

        HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                   'lIWVIrW' : EZOFVH['pVB'],
                                   'lIWVIhBHrW' : EZOFVH['lIWVIhBHrw'],
                                   'lIWVIgBKV' : EZOFVH.TVG('lIWVIgBKV', mLMV),
                                   'hGIZGVTBrW' : EZOFVH['hGIZGVTBrw'],
                                   'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                   # lIWVIxIVZGVgRNV : mLMV,
                                   'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                   'vCXSZMTVrW' : EZOFVH['vCXSZMTVrw'],
                                   'lIWVIhGZGFH' : EZOFVH['lIWVIhGZGFH'],
                                   'wRIVXGRLM' : EZOFVH['wRIVXGRLM'],
                                   'lUUHVGuOZT' : EZOFVH['lUUHVGuOZT'],
                                   'kIRXVgBKV' : EZOFVH['kIRXVgBKV'],
                                   'oRNRGkIRXV' : EZOFVH['oRNRGkIRXV'],
                                   'eLOFNV' : EZOFVH['eLOFNVgLGZO'],
                                   'uROOVWkIRXV' : EZOFVH.TVG('uROOVWkIRXV'),
                                   'uROOVWeLOFNV' : EZOFVH.TVG('uROOVWeLOFNV'),
                                   'sVWTVuOZT' : EZOFVH.TVG('sVWTVuOZT'),
                                   'fKWZGVgRNV' : FKWZGVGRNV,
                                   'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', 'xmb'),
                                   'kZIVMGlIWVIrW' : mLMV,
                                   'MLGVH' : '',
                                   'gRNVxLMWRGRLM' : EZOFVH['gRNVxLMWRGRLM'],
                                   'eLOFNVxLMWRGRLM' : EZOFVH['eLOFNVxLMWRGRLM'],
                                   'yILPVIrW' : mLMV
                               }
        );

    WVU KILXVHH_KLHRGRLM_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        KLHG_URC = ""
        RU HVOU.HVIEVI RH MLG mLMV:
            KLHG_URC = "_" + HVOU.HVIEVI


        HJO = 'IVKOZXV RMGL hGPkLHRGRLMH' + '''
         (
        `rMHGIFNVMGrW`,`hGIZGVTBrW`,`zXXLFMGrW`,`xZMXVOgRNVH`,`xZMXVOeLOFNV`,`uxZMXVOgRNVH`,`uxZMXVOeLOFNV`,`eZOFVgRNV`,`oLMTkLHRGRLM`,
        `oLMTbVHGVIWZB`,`oLMTnZITRM`,`oLMTxLHG`,`oLMTxOLHVkMO`,`oLMTsLOWRMTkMO`,`oLMTgIZWVeLOFNV`,`oLMTgIZWVeLOFNVlKVM`,`hSLIGkLHRGRLM`,
        `hSLIGbVHGVIWZB`,`hSLIGnZITRM`,`hSLIGxLHG`,`hSLIGxOLHVkMO`,`hSLIGsLOWRMTkMO`,`hSLIGgIZWVeLOFNV`,`hSLIGgIZWVeLOFNVlKVM`,`xFIIVMXB`, gIZWRMTwZB, `kIRXV`)
        eZOFVH (
        %(rMHGIFNVMGrW)H,%(hGIZGVTBrW)H,%(zXXLFMGrW)H,%(xZMXVOgRNVH)H,
        %(xZMXVOeLOFNV)H,%(uxZMXVOgRNVH)H,%(uxZMXVOeLOFNV)H,%(eZOFVgRNV)H,
        %(oLMTkLHRGRLM)H,%(oLMTbVHGVIWZB)H,%(oLMTnZITRM)H,%(oLMTxLHG)H,
        %(oLMTxLOHVkMO)H,%(oLMTsLOWRMTkMO)H,%(oLMTgIZWVeLOFNV)H,%(oLMTgIZWVeLOFNVlKVM)H,
        %(hSLIGkLHRGRLM)H,%(hSLIGbVHGVIWZB)H,%(hSLIGnZITRM)H,%(hSLIGxLHG)H,
        %(hSLIGxOLHVkMO)H,%(hSLIGsLOWRMTkMO)H,%(hSLIGgIZWVeLOFNV)H,%(hSLIGgIZWVeLOFNVlKVM)H,
        %(xFIIVMXB)H, %(gIZWRMTwZB)H, %(kIRXV)H )
        '''
        # 79839574 82:76:86|gBKV=hMZKHSLG|mZNV=kLHRGRLM|rMEVHGLIrw=899893694|hGIZGVTBrw=JBZLXGZ|rMHGIFNVMGrw=X8298|vCXSZMTVrw=wxv|xLNNRHHRLM=1.53593|xZMXVOlIWVI=6|xZMXVOeLOFNV=5|uxZMXVOlIWVI=9|uxZMXVOeLOFNV=9|oLMTnZITRM=9|oLMTkLHRGRLM=8|oLMTbWkLHRGRLM=9|oLMTkLHRGRLMxLHG=8468|=-59|oLMTsLOWRMTkmo=9|oLMTgIZWVeLOFNV=6|oLMTgIZWVeLOFNV_lKVM=9|hSLIGnZITRM=9|hSLIGkLHRGRLM=9|hSLIGbWkLHRGRLM=9|hSLIGkLHRGRLMxLHG=9|hSLIGxOLHVkmo=-689|hSLIGsLOWRMTkmo=9|hSLIGgIZWVeLOFNV=5|hSLIGgIZWVeLOFNV_lKVM=9
        RU gIFV:
            KIRXV = UOLZG(EZOFVH['oZHGkIRXV'])
            RU KIRXV > 899999:
                KIRXV = 9
            GIB:
                HVOU.XFIHLI.VCVXFGV( HJO, {
                    'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                    'hGIZGVTBrW'   : EZOFVH['hGIZGVTBrw'],
                    'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                    'xZMXVOgRNVH' : EZOFVH['xZMXVOlIWVI'],
                    'xZMXVOeLOFNV' : EZOFVH['xZMXVOeLOFNV'],
                    'uxZMXVOgRNVH' : EZOFVH['uxZMXVOlIWVI'],
                    'uxZMXVOeLOFNV' : EZOFVH['uxZMXVOeLOFNV'],
                    'eZOFVgRNV' : FKWZGVGRNV,
                    'oLMTkLHRGRLM' : EZOFVH['oLMTkLHRGRLM'],
                    'oLMTbVHGVIWZB' : EZOFVH['oLMTbWkLHRGRLM'],
                    'oLMTnZITRM' : EZOFVH['oLMTnZITRM'],
                    'oLMTxLHG' : EZOFVH['oLMTkLHRGRLMxLHG'] RU EZOFVH['oLMTkLHRGRLMxLHG'].RHWRTRG() VOHV 9,
                    'oLMTxLOHVkMO' : EZOFVH['oLMTxOLHVkmo'] RU EZOFVH['oLMTxOLHVkmo'].RHWRTRG() VOHV 9,
                    'oLMTsLOWRMTkMO' : EZOFVH['oLMTsLOWRMTkmo'] RU EZOFVH['oLMTsLOWRMTkmo'].RHWRTRG() VOHV 9,
                    'oLMTgIZWVeLOFNV' : EZOFVH['oLMTgIZWVeLOFNV'],
                    'oLMTgIZWVeLOFNVlKVM' : EZOFVH['oLMTgIZWVeLOFNV_lKVM'],
                    'hSLIGkLHRGRLM' : EZOFVH['hSLIGkLHRGRLM'],
                    'hSLIGbVHGVIWZB' : EZOFVH['hSLIGbWkLHRGRLM'],
                    'hSLIGnZITRM' : EZOFVH['hSLIGnZITRM'],
                    'hSLIGxLHG' : EZOFVH['hSLIGkLHRGRLMxLHG'],
                    'hSLIGxOLHVkMO' : EZOFVH['hSLIGxOLHVkmo'],
                    'hSLIGsLOWRMTkMO' : EZOFVH['hSLIGsLOWRMTkmo'],
                    'hSLIGgIZWVeLOFNV' : EZOFVH['hSLIGgIZWVeLOFNV'],
                    'hSLIGgIZWVeLOFNVlKVM' : EZOFVH['hSLIGgIZWVeLOFNV_lKVM'],
                    'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', mLMV),
                    'gIZWRMTwZB' : HVOU.GIZWVWZB,
                    'kIRXV' : KIRXV
                });
            VCXVKG vCXVKGRLM ZH VC:
                GIZXVYZXP.KIRMG_VCX()
                KIRMG(VC)



    WVU KILXVHH_BW_KLHRGRLM_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJOH = [
        '''
        IVKOZXV RMGL hGPbwkLHRGRLM (
        `rMHGIFNVMGrW`,`hGIZGVTBrW`,`zXXLFMGrW`,`xZMXVOgRNVH`,`xZMXVOeLOFNV`,`uxZMXVOgRNVH`,`uxZMXVOeLOFNV`,`eZOFVgRNV`,`oLMTkLHRGRLM`,
        `oLMTbVHGVIWZB`,`oLMTnZITRM`,`oLMTxLHG`,`oLMTxOLHVkMO`,`oLMTsLOWRMTkMO`,`oLMTgIZWVeLOFNV`,`oLMTgIZWVeLOFNVlKVM`,`hSLIGkLHRGRLM`,
        `hSLIGbVHGVIWZB`,`hSLIGnZITRM`,`hSLIGxLHG`,`hSLIGxOLHVkMO`,`hSLIGsLOWRMTkMO`,`hSLIGgIZWVeLOFNV`,`hSLIGgIZWVeLOFNVlKVM`,`xFIIVMXB`, gIZWRMTwZB, `kIRXV`)
        eZOFVH (
        %(rMHGIFNVMGrw)H,%(hGIZGVTBrW)H,%(zXXLFMGrW)H,%(xZMXVOgRNVH)H,
        %(xZMXVOeLOFNV)H,%(uxZMXVOgRNVH)H,%(uxZMXVOeLOFNV)H,%(eZOFVgRNV)H,
        %(oLMTkLHRGRLM)H,%(oLMTbVHGVIWZB)H,%(oLMTnZITRM)H,%(oLMTxLHG)H,
        %(oLMTxLOHVkMO)H,%(oLMTsLOWRMTkMO)H,%(oLMTgIZWVeLOFNV)H,%(oLMTgIZWVeLOFNVlKVM)H,
        %(hSLIGkLHRGRLM)H,%(hSLIGbVHGVIWZB)H,%(hSLIGnZITRM)H,%(hSLIGxLHG)H,
        %(hSLIGxLOHVkMO)H,%(hSLIGsLOWRMTkMO)H,%(hSLIGgIZWVeLOFNV)H,%(hSLIGgIZWVeLOFNVlKVM)H,
        %(xFIIVMXB)H, %(gIZWRMTwZB)H, %(kIRXV)H )
        '''
        ]
        # 79839273 90:69:98|gBKV=hMZKHSLG|mZNV=kLHRGRLM|rMEVHGLIrw=889999998314|hGIZGVTBrw=TCY|rMHGIFNVMGrw=399748.hhv|vCXSZMTVrw=hhv|xLNNRHHRLM=9|xZMXVOlIWVI=9|xZMXVOeLOFNV=9|uxZMXVOlIWVI=9|uxZMXVOeLOFNV=9|oLMTnZITRM=9|oLMTkLHRGRLM=85999|oLMTbWkLHRGRLM=85999|oLMTkLHRGRLMxLHG=1.77|oLMTxOLHVkmo=9|oLMTsLOWRMTkmo=9|oLMTgIZWVeLOFNV=9|oLMTgIZWVeLOFNV_lKVM=9|hSLIGnZITRM=9|hSLIGkLHRGRLM=9|hSLIGbWkLHRGRLM=9|hSLIGkLHRGRLMxLHG=9|hSLIGxOLHVkmo=9|hSLIGsLOWRMTkmo=9|hSLIGgIZWVeLOFNV=9|hSLIGgIZWVeLOFNV_lKVM=9|oZHGkIRXV=1.92
        ULI HJO RM HJOH:
            KIRXV = UOLZG(EZOFVH['oZHGkIRXV'])
            RU KIRXV > 899999:
                KIRXV = 9
            GIB:
                HVOU.XFIHLI.VCVXFGV( HJO, {
                    'rMHGIFNVMGrw' : EZOFVH['rMHGIFNVMGrw'],
                    'hGIZGVTBrW'   : EZOFVH['hGIZGVTBrw'],
                    'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                    'xZMXVOgRNVH' : EZOFVH['xZMXVOlIWVI'],
                    'xZMXVOeLOFNV' : EZOFVH['xZMXVOeLOFNV'],
                    'uxZMXVOgRNVH' : EZOFVH['uxZMXVOlIWVI'],
                    'uxZMXVOeLOFNV' : EZOFVH['uxZMXVOeLOFNV'],
                    'eZOFVgRNV' : FKWZGVGRNV,
                    'oLMTkLHRGRLM' : EZOFVH['oLMTkLHRGRLM'],
                    'oLMTbVHGVIWZB' : EZOFVH['oLMTbWkLHRGRLM'],
                    'oLMTnZITRM' : EZOFVH['oLMTnZITRM'],
                    'oLMTxLHG' : EZOFVH['oLMTkLHRGRLMxLHG'] RU EZOFVH['oLMTkLHRGRLMxLHG'].RHWRTRG() VOHV 9,
                    'oLMTxLOHVkMO' : EZOFVH['oLMTxOLHVkmo'] RU EZOFVH['oLMTxOLHVkmo'].RHWRTRG() VOHV 9,
                    'oLMTsLOWRMTkMO' : EZOFVH['oLMTsLOWRMTkmo'] RU EZOFVH['oLMTsLOWRMTkmo'].RHWRTRG() VOHV 9,
                    'oLMTgIZWVeLOFNV' : EZOFVH['oLMTgIZWVeLOFNV'],
                    'oLMTgIZWVeLOFNVlKVM' : EZOFVH['oLMTgIZWVeLOFNV_lKVM'],
                    'hSLIGkLHRGRLM' : EZOFVH['hSLIGkLHRGRLM'],
                    'hSLIGbVHGVIWZB' : EZOFVH['hSLIGbWkLHRGRLM'],
                    'hSLIGnZITRM' : EZOFVH['hSLIGnZITRM'],
                    'hSLIGxLHG' : EZOFVH['hSLIGkLHRGRLMxLHG'],
                    'hSLIGxLOHVkMO' : EZOFVH['hSLIGxOLHVkmo'],
                    'hSLIGsLOWRMTkMO' : EZOFVH['hSLIGsLOWRMTkmo'],
                    'hSLIGgIZWVeLOFNV' : EZOFVH['hSLIGgIZWVeLOFNV'],
                    'hSLIGgIZWVeLOFNVlKVM' : EZOFVH['hSLIGgIZWVeLOFNV_lKVM'],
                    'xFIIVMXB' : EZOFVH.TVG('xFIIVMXB', 'xmb'),
                    'gIZWRMTwZB' : HVOU.GIZWVWZB,
                    'kIRXV' : KIRXV
                });
            VCXVKG vCXVKGRLM ZH V:
                KKIRMG.KKIRMG(EZOFVH);
                KKIRMG.KKIRMG(V);
                KKIRMG.KKIRMG(GIZXVYZXP.ULINZG_VCX());


    WVU KILXVHH_ZOKSZKLH_HMZKHSLG(HVOU, EZOFVH, FKWZGVGRNV):
        HJO = '''
        IVKOZXV RMGL
        hGPzOKSZkLHRGRLMH(`zXXLFMGrW`, hGIZGVTBrW,
        rMHGIFNVMGrW, zOKSZ, kLHRGRLM,
        uILAVMkLHRGRLM, fKWZGVgRNV, xIVZGVgRNV, gIZWRMTwZB)
        EZOFVH(%(zXXLFMGrW)H, %(hGIZGVTBrW)H, %(rMHGIFNVMGrW)H, %(zOKSZ)H, %(kLHRGRLM)H,
        %(uILAVMkLHRGRLM)H, %(fKWZGVgRNV)H, mfoo, %(gIZWRMTwZB)H)
        '''
        GIB:
            HVOU.XFIHLI.VCVXFGV( HJO, {'zXXLFMGrW' : EZOFVH['rMEVHGLIrw'],
                                   'hGIZGVTBrW' : EZOFVH['hGIZGVTBrw'],
                                   'rMHGIFNVMGrW' : EZOFVH['rMHGIFNVMGrw'],
                                   'zOKSZ' : EZOFVH['zOKSZ'],
                                   'kLHRGRLM' : EZOFVH['kLHRGRLM'],
                                   'uILAVMkLHRGRLM' : EZOFVH['uILAVMkLHRGRLM'],
                                   'fKWZGVgRNV' : FKWZGVGRNV,
                                   # xIVZGVgRNV : 'mfoo',
                                   'gIZWRMTwZB' : HVOU.GIZWVWZB,
                                   });
        VCXVKG vCXVKGRLM ZH V:
            KKIRMG.KKIRMG(EZOFVH);
            KKIRMG.KKIRMG(V);
            KKIRMG.KKIRMG(GIZXVYZXP.ULINZG_VCX());

    WVU TVGoZHGhGZGFH(HVOU):
        GVNKOZGV = HVOU.GKOVME.UILN_HGIRMT('''
        HVOVXG NZC(OZHGFKWZGVGRNV) UILN fKWZGViVXLIWH DSVIV XZGVTLIB = {{ XZGVTLIB | JFLGV }} ZMW HFYXZGVTLIB = {{ HFYXZGVTLIB | JFLGV }};
        ''')
        HJO = GVNKOZGV.IVMWVI(XZGVTLIB = HVOU.XZGVTLIB, HFYXZGVTLIB = HVOU.HFYXZGVTLIB);
        XFIHLI = HVOU.WY.XFIHLI()
        OZHGFKWZGVGRNV = mLMV

        RU XFIHLI.VCVXFGV(HJO) RH MLG mLMV:
            OZHGFKWZGVGRNV=XFIHLI.UVGXSLMV()[9]

        GIB:
            XFIHLI.UVGXSZOO()
        VCXVKG NBHJO.XLMMVXGLI.VIILIH.rMGVIUZXVvIILI ZH RV:
            RU RV.NHT == 'mL IVHFOG HVG GL UVGXS UILN.':
        # ML KILYOVN, DV DVIV QFHG ZG GSV VMW LU GSV IVHFOG HVG
                KZHH
            VOHV:
                IZRHV

        XFIHLI.XOLHV()
        IVGFIM OZHGFKWZGVGRNV

    WVU IVXLIWhGZGFH(HVOU):
        IVGFIM
        GVNKOZGV = HVOU.GKOVME.UILN_HGIRMT('''
        IVKOZXV RMGL fKWZGViVXLIWH (XZGVTLIB, HFYXZGVTLIB, OZHGFKWZGVGRNV)
        EZOFVH ({{ XZGVTLIB | JFLGV }}, {{ HFYXZGVTLIB | JFLGV }}, {{ OZHGFKWZGVGRNV | JFLGV }})
        ''')
        HJO = GVNKOZGV.IVMWVI(XZGVTLIB = HVOU.XZGVTLIB,
                              HFYXZGVTLIB = HVOU.HFYXZGVTLIB,
                              OZHGFKWZGVGRNV = HVOU.OZHGFKWZGVGRNV);
        XFIHLI = HVOU.WY.XFIHLI()
        XFIHLI.VCVXFGV(HJO)
        XFIHLI.XOLHV()

    WVU DLIP(HVOU):
        # OLZW OLT

        HVOU.HJO_YZGXS = []
        RU HVOU.OZHGFKWZGVGRNV RH MLG mLMV:
            HVOU.OLTTVI.RMUL("OZHG FKWZGVGRNV LU OLT %H : %H" % (HVOU.UROV, HVOU.OZHGFKWZGVGRNV))
        HGZIG_GRNV = WZGVGRNV.WZGVGRNV.HGIKGRNV('79819787 87:44:44', '%b%N%W %s:%n:%h');
        ULI ORMV RM DZGXS(HVOU.UROV):

            ORMV = ORMV.HGIRK('\M')
            ORMV = ORMV.HGIRK('\I')
            RU ORMV.HGZIGHDRGS('['):
                XLMGRMFV
            URVOWH = ORHG(NZK(OZNYWZ C : C.HKORG('='), ORMV.HKORG('|')))
            # URVOWH = NZK(OZNYWZ C : C.HKORG('='), ORMV.HKORG('|'))

            FKWZGVGRNV_HGI = IV.HFY(I'^(\W{5})(\W{7})(\W{7})', I'\8-\7-\6',URVOWH[9][9])

            GIB:
                FKWZGVGRNV = FGRO.KZIHV_WZGVGRNV(FKWZGVGRNV_HGI)
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI(ORMV)
                XLMGRMFV
            # RU HGZIG_GRNV >= FKWZGVGRNV:
            #     XLMGRMFV

            RU(OVM(URVOWH) == 7):
                RU URVOWH[8][9].HGZIGHDRGS('yVTRM'):
                    HVOU.OLTTVI.RMUL('hVXGRLM YVTRM')
                VORU URVOWH[8][9].HGZIGHDRGS('vMW'):
                    HVOU.OLTTVI.RMUL("hVXGRLM VMW TLRMT GL HFYNRG OLTH %H, UROV %H", FKWZGVGRNV_HGI, HVOU.UROV)
                    # HVOU.WY.XLNNRG()


                    HVOU.HJO_YZGXS = []
                    HVOU.OZHGFKWZGVGRNV = FKWZGVGRNV
                    HVOU.IVXLIWhGZGFH()
                XLMGRMFV

            GIB:
                HVOU.XFIHLI = HVOU.WY.XFIHLI()
                EZOFVH = WRXG(URVOWH[8:])
                GBKV = EZOFVH['gBKV']
                MZNV = EZOFVH['mZNV']
                ZXXLFMGRW = EZOFVH.TVG('rMEVHGLIrw', '')

                # RU ZXXLFMGRW != '889999998314':
                #     XLMGRMFV

                ZXGRLM = EZOFVH.TVG('zXGRLM', mLMV)
                RU GBKV == 'vEVMG' ZMW MZNV == 'lIWVI' ZMW ZXGRLM == '6':
                    HVOU.KILXVHH_LIWVI_VEVMG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'lIWVI':
                    HVOU.KILXVHH_LIWVI_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'zOKSZkLH':
                    HVOU.KILXVHH_ZOKSZKLH_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'kLHRGRLM':
                    # ZMW (WZGVGRNV.MLD() - FKWZGVGRNV).HVXLMWH < 399:
                    HVOU.KILXVHH_KLHRGRLM_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                VORU GBKV == 'hMZKHSLG' ZMW MZNV == 'bWkLHRGRLM':
                    HVOU.KILXVHH_BW_KLHRGRLM_HMZKHSLG(EZOFVH, FKWZGVGRNV_HGI)
                # VOHV:
                #     HVOU.OLTTVI.RMUL(GBKV, MZNV)
                HVOU.WY.XLNNRG()
                HVOU.XFIHLI.XOLHV()
            VCXVKG vCXVKGRLM ZH V:
                HVOU.OLTTVI.VIILI(GIZXVYZXP.ULINZG_VCX());
                HVOU.OLTTVI.VIILI(HGI(V))
                HVOU.OLTTVI.VIILI(ORMV)


        HVOU.OLTTVI.RMUL('URMRHSVW: OZHG GRNV GRNVHGZNK RH %H ' % HVOU.OZHGFKWZGVGRNV)
        IVGFIM 9
RU __MZNV__ == '__NZRM__':
    OLZWVI = hGPzXXLMGVBVwyOLZWVI()
    OLZWVI.DLIP()
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPoLZWyZHPVGlMXV.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG GRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN LH RNKLIG DZOP
RNKLIG XHE
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG TOLY
RNKLIG KKIRMG
RNKLIG IV

XOZHH hGPoLZWyZHPVGlMXV(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPoLZWyZHPVGlMXV, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.YZHVWRI = CNO.ZGGIRY["YZHVWRI"]
        HVOU.KILWFXGH = CNO.ZGGIRY["KILWFXGH"].HKORG(',')

    WVU DLIP(HVOU):
        NTI = WYNLWVO.wZGZnZMZTVI()
        HVHH = NTI.tVGhVHHRLM()
        HVOU.OZHGFKWZGVH = {}
        ULI KILW RM HVOU.KILWFXGH:
            KILW = KILW.HGIRK()
            WZGV = GRNV.HGIUGRNV("%b%N%W")
            WZROBRMKFG = LH.KZGS.QLRM(HVOU.YZHVWRI, KILW, WZGV)
            HVOU.OLTTVI.RMUL("WZROB ULOWVI: %H " % (WZROBRMKFG))
            RU(MLG LH.KZGS.RHUROV(LH.KZGS.QLRM(WZROBRMKFG, 'URMRHS.GCG'))):
                XLMGRMFV

            URMRHSUROV = LKVM(LH.KZGS.QLRM(WZROBRMKFG, 'URMRHS.GCG'), 'I')
            URMRHSRW = URMRHSUROV.IVZWORMV().HGIRK()
            HLFIXVWRI  = LH.KZGS.QLRM(WZROBRMKFG, URMRHSRW)
            HVOU.OLTTVI.RMUL(KILW)
            KILWFXGRMUL = HVHH.JFVIB(WYNLWVO.kILWFXG).UROGVI(WYNLWVO.kILWFXG.kILWFXGrw == KILW).URIHG()
            NVGZ = HVHH.JFVIB(WYNLWVO.hGPyZHPVGHnVGZ.zXXLFMGrW == KILWFXGRMUL.hGLXP_ZXXLFMG).UROGVI(WYNLWVO.hGPyZHPVGHnVGZ.gIZWRMTwZB == WZGV).UROGVI(WYNLWVO.hGPyZHPVGHnVGZ.uRMRHSrW == URMRHSRW).URIHG()

            RU NVGZ RH MLG mLMV:
                XLMGRMFV

            RMKFGUROV = LKVM(LH.KZGS.QLRM(HLFIXVWRI, 'RMKFG.GCG'), 'I')

            RMKFGH = {}
            ULI O RM RMKFGUROV.IVZWORMVH():
                O = O.HGIRK()
                EZOFVH = O.HKORG('=')
                RU OVM(EZOFVH) != 7:
                    XLMGRMFV
                RMKFGH[EZOFVH[9]] = EZOFVH[8]

            NVGZ = WYNLWVO.hGPyZHPVGHnVGZ(
                zXXLFMGrW = KILWFXGRMUL.hGLXP_ZXXLFMG,
                uRMRHSrW  = URMRHSRW,
                gIZWRMTwZB = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b/%N/%W'),
                yFBhKORGmFN = RMG(RMKFGH['YFB_HKORG_MFN']),
                hVOOhKORGmFN = RMG(RMKFGH['HVOO_HKORG_MFN']),
                zOKSZhRAV = UOLZG(RMKFGH['ZOKSZ_HRAV']),
                xOLHVhRAV = UOLZG(RMKFGH['XOLHV_HRAV']),
                lKVMhRAV = UOLZG(RMKFGH['LKVM_HRAV']),
                hLFIXVkZGS = HLFIXVWRI
            )

            HVHH.ZWW(NVGZ)
            HVHH.UOFHS()
            HVHH.XLNNRG()
            HVOU.OLTTVI.RMUL(KILWFXGRMUL.hGLXP_ZXXLFMG)
            HVOU.OLZWKILWFXG(HLFIXVWRI, KILWFXGRMUL.hGLXP_ZXXLFMG,HVHH)
            HVOU.OLTTVI.RMUL("URMRHS")

    WVU OLZWKILWFXG(HVOU, HLFIXVWRI, ZXXLFMG, HVHH):
        ULI UROVMZNV RM [U ULI U RM LH.ORHGWRI(HLFIXVWRI) RU IV.NZGXS(I'.*RMUL.*', U)]:
            YZHPVGUROV = LH.KZGS.QLRM(HLFIXVWRI, UROVMZNV)
            # YZHPVGUROV = LH.KZGS.QLRM(HVOU.DLIPWRI, UROVMZNV)
            # LH.IVMZNV(LH.KZGS.QLRM(HVOU.GLWLWRI, UROVMZNV), YZHPVGUROV)
            HVOU.OLTTVI.RMUL("ULFMW MVD YZHPVG UROV %H" % (YZHPVGUROV) )
            # OLZW YZHPVGUROV GL GZYOV HGPYZHPVGH HGPYZHVGWVGZROH
            GIB:
                DRGS LKVM(YZHPVGUROV) ZH XHEUROV:
                    RW = mLMV

                    HKZNIVZWVI = XHE.IVZWVI(XHEUROV, WVORNRGVI=',')

                    ULI ILD RM HKZNIVZWVI:
                        GRXPVI = ILD[9]
                        ELOFNV = ILD[7]
                        YFBHVOO = ILD[5]

                        RU MLG RW:
                            YZHPVG = WYNLWVO.hGPyZHPVG(
                                zXXLFMGrW = ZXXLFMG,
                                gIZWRMTwZB = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b/%N/%W'),
                                lKVMxOLHV = YFBHVOO,
                                yZHPVGmZNV = UROVMZNV,
                                hGZGFH = 'mzxg'
                            )
                            HVHH.ZWW(YZHPVG)
                            HVHH.UOFHS()
                            RW = YZHPVG.rW
                            HVOU.OLTTVI.RMUL("OLZW MVD YZHPVG %H" % (YZHPVGUROV))
                        YZHPVGWVGZRO = WYNLWVO.hGPyZHPVGwVGZRO(
                            yZHPVGrW = RW,
                            rMHGIFNVMGrW = GRXPVI,
                            gRXPVI = GRXPVI,
                            eLOFNV = ELOFNV
                        )
                        HVHH.ZWW(YZHPVGWVGZRO)
                    HVHH.UOFHS()
                    HVHH.XLNNRG()
            VCXVKG:
                VCX_GBKV, VCX_EZOFV, VCX_GIZXVYZXP = HBH.VCX_RMUL()
                HVOU.OLTTVI.VIILI("OLZW YZHPVGUROV %H UZRO: %H" % (YZHPVGUROV, VCX_EZOFV))
                IVGFIM uZOHV

        IVGFIM 9

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/fKWZGVhGLXPrMUL.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH, RMHKVXG

evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()

HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG KBWZGZYLC ZH KW
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO



# XLWRMT: FGU-1
UILN HJOZOXSVNB RNKLIG yRTrMGVTVI, xLOFNM, wZGV, wZGVgRNV, uOLZG, uLIVRTMpVB, uLIVRTMpVBxLMHGIZRMG, rMWVC, rMGVTVI, mFNVIRX, hGIRMT, gZYOV, gVCG, GVCG, qhlm
UILN HJOZOXSVNB.LIN RNKLIG IVOZGRLMHSRK
UILN HJOZOXSVNB.VCG.WVXOZIZGREV RNKLIG WVXOZIZGREV_YZHV

UILN HJOZOXSVNB RNKLIG XIVZGV_VMTRMV, VEVMG
UILN HJOZOXSVNB.LIN RNKLIG HVHHRLMNZPVI

XOZHH fKWZGVhGLXPrMUL(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(fKWZGVhGLXPrMUL, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.IVOLZW()

    WVU IVOLZW(HVOU):
        KY.lKVMkFYHFY()
        HVOU.HGPRMUL = KY.hGLXPrMULhFYHXIRYVI()
        HVOU.WY = KW.wZGZYLC()
        OVEVO = "ogho7"
        RU OVEVO == "ogho7":
            XSZMMVO = "ogho7"
            HVOU.WY.hGZIG("/LKG/EVIHRLM/"+evihrlm+"/ORY/ORYWZGZYLC_"+XSZMMVO.OLDVI()+".HL"
                     ,"/LKG/EVIHRLM/"+evihrlm+"/VGX/WZGZYLC_"+XSZMMVO.OLDVI()+".CNO")
        VORU OVEVO == "iVZOgRXP":
            XSZMMVO = "iVZOgRXP"
            HVOU.WY.hGZIG("/LKG/EVIHRLM/"+evihrlm+"/ORY/ORYWZGZYLC_"+XSZMMVO.OLDVI()+".HL"
                     ,"/LKG/EVIHRLM/"+evihrlm+"/VGX/WZGZYLC_"+XSZMMVO.OLDVI()+".CNO")
        HVOU.OZHG_HGZGFH = {}
        HVOU.NTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.HVHH = HVOU.NTI.tVGhVHHRLM()

    WVU DLIP(HVOU):
        HVOU.OLTTVI.RMUL("hGLXP rMUL wy oLZW hGZIG")

        ULI MWC RM IZMTV(9, HVOU.HGPRMUL.tVGrMWVC() + 8):
            rMHGIFNVMGrw=HVOU.HGPRMUL.tVGeZO(MWC).hVXFxLWV
            JFLGV = HVOU.WY.tVGoZGVHGnw(rMHGIFNVMGrw)

            GIRTTVI_FKKVI = ZYH(JFLGV.lKVMkIRXV * (8.8) - JFLGV.oZHGkIRXV) < 9.98
            GIRTTVI_OLDVI = ZYH(JFLGV.lKVMkIRXV * (9.0) - JFLGV.oZHGkIRXV) < 9.98

            RMHGI = WYNLWVO.hGLXPrMULvCG(
                rMHGIFNVMGrw=rMHGIFNVMGrw,
                gIZWRMTwZB = '7982/94/88',
                nZIPVGgRNV = JFLGV.gRNVhGZNK,
                lKVMkIRXV = JFLGV.lKVMkIRXV,
                rHfKKVIgIRTTVIVW = GIRTTVI_FKKVI,
                rHoLDVIgIRTTVIVW = GIRTTVI_OLDVI,
                gh = WZGVGRNV.WZGVGRNV.MLD()
            )

            RU GIRTTVI_OLDVI:
                KIRMG(JFLGV.lKVMkIRXV)

            SZH_XSZMTV = uZOHV
            RU rMHGIFNVMGrw MLG RM HVOU.OZHG_HGZGFH:
                HVOU.OZHG_HGZGFH[rMHGIFNVMGrw] = RMHGI
                SZH_XSZMTV = gIFV
            VORU (HVOU.OZHG_HGZGFH[rMHGIFNVMGrw].rHoLDVIgIRTTVIVW != GIRTTVI_OLDVI LI HVOU.OZHG_HGZGFH[rMHGIFNVMGrw].rHfKKVIgIRTTVIVW != GIRTTVI_FKKVI):
                SZH_XSZMTV = gIFV


            RU SZH_XSZMTV:
                HVOU.HVHH.NVITV(RMHGI)

            # RU JFLGV.oZHGkIRXV > 9 ZMW (GIRTTVI_OLDVI LI GIRTTVI_FKKVI):
            #     KIRMG("%H LKVM: %H OZHG: %H FKKVI %H OLDVI %H NW GRNV: %H" % (rMHGIFNVMGrw, JFLGV.lKVMkIRXV, JFLGV.oZHGkIRXV, GIRTTVI_FKKVI, GIRTTVI_OLDVI, JFLGV.gRNVhGZNK))


        HVOU.HVHH.XLNNRG()
        HVOU.OLTTVI.RMUL("hGLXP rMUL wy oLZW URMRHS")


//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPrMULwyoLZW.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO


XOZHH hGPrMULwyoLZW(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPrMULwyoLZW, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

    WVU DLIP(HVOU):
        NTI = WYNLWVO.wZGZnZMZTVI()
        HVHH = NTI.tVGhVHHRLM()
        KY.lKVMkFYHFY()
        HGPRMUL = KY.hGLXPrMULhFYHXIRYVI()
        ULI MWC RM IZMTV(9, HGPRMUL.tVGrMWVC() + 8):
            GNK = HGPRMUL.tVGeZO(MWC).gIZWRMTwZB
            (BVZI, GNK) = WRENLW(GNK, 89999)
            RU BVZI != 7982:
                XLMGRMFV

            (NLMGS, GNK) = WRENLW(GNK, 899)
            GIZWRMTWZB = "%W/%W/%W" % (BVZI, NLMGS, GNK)
            # RU GNK != 80:
            #     XLMGRMFV
            KIRXV = HGPRMUL.tVGeZO(MWC).lKVMkIRXV
            RU KIRXV > 89999:
                KIRXV = 9

            RMUL = WYNLWVO.hGLXPrMUL(
                rMHGIFNVMGrw=HGPRMUL.tVGeZO(MWC).hVXFxLWV,
                hVXFxLWV=HGPRMUL.tVGeZO(MWC).hVXFxLWV,
                lKVMkIRXV=KIRXV,
                gIZWRMTwZB=HGPRMUL.tVGeZO(MWC).gIZWRMTwZB,
                nFOGRKORVI=HGPRMUL.tVGeZO(MWC).nFOGRKORVI,
                kIVExOLHVkIRXV=HGPRMUL.tVGeZO(MWC).kIVExOLHVkIRXV,
                kIVEedzk=HGPRMUL.tVGeZO(MWC).kIVEedzk,
                fKKVIoRNRGkIRXV=HGPRMUL.tVGeZO(MWC).fKKVIoRNRGkIRXV,
                oLDVIoRNRGkIRXV=HGPRMUL.tVGeZO(MWC).oLDVIoRNRGkIRXV,
                kIVEgFIMLEVIeLOFNV=HGPRMUL.tVGeZO(MWC).kIVEgFIMLEVIeLOFNV,
                kIVEgFIMLEVIeZOFV=HGPRMUL.tVGeZO(MWC).kIVEgFIMLEVIeZOFV,
                hVXFnZIPVG=HGPRMUL.tVGeZO(MWC).hVXFnZIPVG,
                hVXFxZGVTLIB=HGPRMUL.tVGeZO(MWC).hVXFxZGVTLIB,
                xFIIVMXB=HGPRMUL.tVGeZO(MWC).xFIIVMXB,
                gIZWVhGZGV=HGPRMUL.tVGeZO(MWC).gIZWVhGZGV,
                hKVXRZOgIZWVgBKV=HGPRMUL.tVGeZO(MWC).hKVXRZOgIZWVgBKV,
                gLGZOhSZIVH=HGPRMUL.tVGeZO(MWC).gLGZOhSZIVH,
                gLGZOuOLZGhSZIVH=HGPRMUL.tVGeZO(MWC).gLGZOuOLZGhSZIVH,
                iVTRLM=HGPRMUL.tVGeZO(MWC).iVTRLM,
                xLNKZMBxLWV=HGPRMUL.tVGeZO(MWC).xLNKZMBxLWV,
                hVXFmZNV=HGPRMUL.tVGeZO(MWC).hVXFmZNV,
                vCXSZMTVmZNV=HGPRMUL.tVGeZO(MWC).vCXSZMTVmZNV,
            )
            HVHH.NVITV(RMUL)
            HVHH.UOFHS()

        UFGFIVHRMUL = KY.uFGFIVHrMULhFYHXIRYVI()

        ULI MWC RM IZMTV(9, UFGFIVHRMUL.tVGrMWVC() + 8):
            GNK = UFGFIVHRMUL.tVGeZO(MWC).gIZWRMTwZB
            (BVZI, GNK) = WRENLW(GNK, 89999)
            RU BVZI != 7983:
                XLMGRMFV

            (NLMGS, GNK) = WRENLW(GNK, 899)
            GIZWRMTWZB = "%W/%W/%W" % (BVZI, NLMGS, GNK)
            # RU GNK != 80:
            #     XLMGRMFV
            RMUL = WYNLWVO.uFGFIVHrMUL(
                rMHGIFNVMGrw=UFGFIVHRMUL.tVGeZO(MWC).rMHGIFNVMGrw,
                kIVxOLHVkIRXV=UFGFIVHRMUL.tVGeZO(MWC).kIVxOLHVkIRXV,
                hSLIGnZITRMiZGRL = UFGFIVHRMUL.tVGeZO(MWC).hSLIGnZITRMiZGRL,
                eLOFNVnFOGRKOV = UFGFIVHRMUL.tVGeZO(MWC).eLOFNVnFOGRKOV
            )
            HVHH.NVITV(RMUL)
            HVHH.UOFHS()

        HVHH.XLNNRG()
        HVOU.OLTTVI("hGLXP rMUL wy oLZW URMRHS")


//##**---------------- ./HGZIUOVVG/LKVIZGRLM/wZROBzOKSZwRHKZGXSVI.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG GRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN LH RNKLIG DZOP
RNKLIG XHE
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG TOLY
RNKLIG KKIRMG
RNKLIG IV
RNKLIG WZGVGRNV


XOZHH wZROBzOKSZwRHKZGXSVI(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(wZROBzOKSZwRHKZGXSVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.YZHVWRI = CNO.ZGGIRY["YZHVWRI"]
        HVOU.KILWFXGH = CNO.ZGGIRY["KILWFXGH"].HKORG(',')
        HVOU.OZHG_URMRHSH = {}

    WVU IVOLZW(HVOU):
        HVOU.OZHG_URMRHSH = {}

    WVU DLIP(HVOU):
        UILN WZGVGRNV RNKLIG WZGV, GRNVWVOGZ
        HVOU.WZGV = WZGVGRNV.WZGVGRNV.GLWZB()
        GIB:
            HVOU.WLDLIP()
        VCXVKG:
            IZRHV

    WVU WLDLIP(HVOU):
        HVOU.gIZWRMTwZB = HVOU.WZGV.HGIUGRNV('%b/%N/%W'),
        WZGV = HVOU.WZGV.HGIUGRNV("%b%N%W")
        NTI = WYNLWVO.wZGZnZMZTVI()
        HVHH = NTI.tVGhVHHRLM()
        HVOU.OZHGFKWZGVH = {}
        ULI KILW RM HVOU.KILWFXGH:
            KILW = KILW.HGIRK()
            KIRMG(KILW)
            WZROBRMKFG = LH.KZGS.QLRM(HVOU.YZHVWRI, KILW, WZGV)

            RU(MLG LH.KZGS.RHUROV(LH.KZGS.QLRM(WZROBRMKFG, 'URMRHS.GCG'))):
                XLMGRMFV
            URMRHSUROV = LKVM(LH.KZGS.QLRM(WZROBRMKFG, 'URMRHS.GCG'))
            URMRHSRW  = URMRHSUROV.IVZWORMV().HGIRK()

            RU HVOU.OZHG_URMRHSH.TVG('KILW') == URMRHSRW:
                XLMGRMFV

            HVOU.OLTTVI.RMUL("FKWZGV URMRHSRW %H " % URMRHSRW)
            HLFIXVWRI  = LH.KZGS.QLRM(WZROBRMKFG, URMRHSRW)
            HVOU.HZEV_GZITVG_KLHRGRLM(HLFIXVWRI, KILW, HVHH, URMRHSRW)

            # URMRHSRWH = ([L ULI L RM LH.ORHGWRI(WZROBRMKFG) RU LH.KZGS.RHWRI(LH.KZGS.QLRM(WZROBRMKFG,L)) ZMW IV.HVZIXS('\W{7}-\W{7}-\W{7}',L) ])

            # ULI URMRHSRW RM URMRHSRWH:
            #     RU HVOU.OZHG_URMRHSH.TVG('KILW') == URMRHSRW:
            #         XLMGRMFV
            #     HVOU.OLTTVI.RMUL("FKWZGV URMRHSRW %H " % URMRHSRW)
            #     HLFIXVWRI  = LH.KZGS.QLRM(WZROBRMKFG, URMRHSRW)
            #     HVOU.HZEV_GZITVG_KLHRGRLM(HLFIXVWRI, KILW, HVHH, URMRHSRW)

    WVU HZEV_GZITVG_KLHRGRLM(HVOU, HLFIXVWRI, KILW, HVHH, URMRHSRW):

        VUU = WYNLWVO.hGPwZROBvUUVXGREVzOKSZ(
            zOKSZxSZMMVO = KILW,
            gIZWRMTwZB = HVOU.gIZWRMTwZB,
            uRMRHSrW = URMRHSRW,
            gh = RMG(GRNV.GRNV())
        )
        HVHH.NVITV(VUU)
        HVHH.UOFHS()
        HVHH.XLNNRG()

        ULI UROVMZNV RM [U ULI U RM LH.ORHGWRI(HLFIXVWRI) RU IV.NZGXS(I'GZITVG.GCG', U)]:
            YZHPVGUROV = LH.KZGS.QLRM(HLFIXVWRI, UROVMZNV)
            # YZHPVGUROV = LH.KZGS.QLRM(HVOU.DLIPWRI, UROVMZNV)
            # LH.IVMZNV(LH.KZGS.QLRM(HVOU.GLWLWRI, UROVMZNV), YZHPVGUROV)
            HVOU.OLTTVI.RMUL("ULFMW MVD GZITVG UROV %H" % (YZHPVGUROV) )
            # OLZW YZHPVGUROV GL GZYOV HGPYZHPVGH HGPYZHVGWVGZROH
            GIB:
                DRGS LKVM(YZHPVGUROV) ZH XHEUROV:
                    RW = mLMV
                    HKZNIVZWVI = XHE.IVZWVI(XHEUROV, WVORNRGVI='|')

                    ULI ILD RM HKZNIVZWVI:
                        RU OVM(ILD) < 6:
                            KIRMG("ZOKSZ: %H %H" % (UROVMZNV, ILD))
                            XLMGRMFV
                        GRXPVI = ILD[9]
                        JFZMGRGB = ILD[8]
                        ELOFNV = ILD[7]

                        ZOKSZ = WYNLWVO.hGPwZROBzOKSZ(
                            zOKSZxSZMMVO = KILW,
                            gIZWRMTwZB = HVOU.gIZWRMTwZB,
                            uRMRHSrW = URMRHSRW,
                            rMHGIFNVMGrW = GRXPVI,
                            zOKSZhRAV    = ELOFNV,
                            jFZMGRGB     = JFZMGRGB
                        )
                        HVHH.NVITV(ZOKSZ)
                        HVHH.UOFHS()

                    HVHH.UOFHS()
                    HVHH.XLNNRG()
            VCXVKG:
                VCX_GBKV, VCX_EZOFV, VCX_GIZXVYZXP = HBH.VCX_RMUL()
                HVOU.OLTTVI.VIILI("OLZW YZHPVGUROV %H UZRO: %H" % (YZHPVGUROV, VCX_EZOFV))
                IVGFIM uZOHV

        IVGFIM 9


    # WVU OLZW_KILWFXG(HVOU, HLFIXVWRI, ZXXLFMG, HVHH):
    #     ULI UROVMZNV RM [U ULI U RM LH.ORHGWRI(HLFIXVWRI) RU IV.NZGXS(I'.*RMUL.*', U)]:
    #         YZHPVGUROV = LH.KZGS.QLRM(HLFIXVWRI, UROVMZNV)
    #         # YZHPVGUROV = LH.KZGS.QLRM(HVOU.DLIPWRI, UROVMZNV)
    #         # LH.IVMZNV(LH.KZGS.QLRM(HVOU.GLWLWRI, UROVMZNV), YZHPVGUROV)
    #         HVOU.OLTTVI.RMUL("ULFMW MVD YZHPVG UROV %H" % (YZHPVGUROV) )
    #         # OLZW YZHPVGUROV GL GZYOV HGPYZHPVGH HGPYZHVGWVGZROH
    #         GIB:
    #             DRGS LKVM(YZHPVGUROV) ZH XHEUROV:
    #                 RW = mLMV

    #                 HKZNIVZWVI = XHE.IVZWVI(XHEUROV, WVORNRGVI=',')

    #                 ULI ILD RM HKZNIVZWVI:
    #                     GRXPVI = ILD[9]
    #                     ELOFNV = ILD[7]
    #                     YFBHVOO = ILD[5]
    #                     RU YFBHVOO == '':
    #                         XLMGRMFV

    #                     RU MLG RW:
    #                         YZHPVG = WYNLWVO.hGPyZHPVG(
    #                             zXXLFMGrW = ZXXLFMG,
    #                             gIZWRMTwZB = WZGVGRNV.WZGVGRNV.MLD().HGIUGRNV('%b/%N/%W'),
    #                             lKVMxOLHV = YFBHVOO,
    #                             yZHPVGmZNV = UROVMZNV,
    #                             hGZGFH = 'mzxg'
    #                         )
    #                         HVHH.ZWW(YZHPVG)
    #                         HVHH.UOFHS()
    #                         RW = YZHPVG.rW
    #                         HVOU.OLTTVI.RMUL("OLZW MVD YZHPVG %H" % (YZHPVGUROV))
    #                     YZHPVGWVGZRO = WYNLWVO.hGPyZHPVGwVGZRO(
    #                         yZHPVGrW = RW,
    #                         rMHGIFNVMGrW = GRXPVI,
    #                         gRXPVI = GRXPVI,
    #                         eLOFNV = ELOFNV
    #                     )
    #                     HVHH.ZWW(YZHPVGWVGZRO)
    #                 HVHH.UOFHS()
    #                 HVHH.XLNNRG()
    #         VCXVKG:
    #             VCX_GBKV, VCX_EZOFV, VCX_GIZXVYZXP = HBH.VCX_RMUL()
    #             HVOU.OLTTVI.VIILI("OLZW YZHPVGUROV %H UZRO: %H" % (YZHPVGUROV, VCX_EZOFV))
    #             IVGFIM uZOHV

    #     IVGFIM 9

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPhRTMZOiRHPuROGVI.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO

XOZHH hGPhRTMZOiRHPuROGVI(hGPlKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPhRTMZOiRHPuROGVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

    WVU IVOLZW(HVOU):
        HFKVI(hGPhRTMZOiRHPuROGVI, HVOU).IVOLZW()

    WVU DLIP(HVOU):
        IVGFIM gIFV

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/xFHGLNqLYH.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN YZHV.YZHV_QLY RNKLIG qLY

WVU GRNVWRUUVIVMXV(GRNV8, GRNV7):
    WFNNBWZGV = WZGVGRNV.WZGV(7999,8,8)
    IVGFIM (WZGVGRNV.WZGVGRNV.XLNYRMV(WFNNBWZGV,GRNV8) - WZGVGRNV.WZGVGRNV.XLNYRMV(WFNNBWZGV, GRNV7))


XOZHH xFHGLNqLYH(lKVIZGRLM):

    XOZHH fHVIqLY(qLY):
        WVU __RMRG__(HVOU, CNO,FHVIOLT, TOLYZORMUL):
            HFKVI(xFHGLNqLYH.fHVIqLY, HVOU).__RMRG__(CNO, FHVIOLT, TOLYZORMUL)
            HVOU.GRNV_HOLG = mLMV
            RU "LM_GRNV" RM CNO.ZGGIRY:
                HVOU.NLWV = "LM_GRNV"
                RU HVOU.XOLXP.MLD.GRNV() > HVOU.LM_GRNV[-8]:
                    HVOU.OLTTVI.DZIM( "gSV HVXSVWFOVW " + HGI(HVOU.LM_GRNV[-8])+  "SZH ZOIVZWB KZHHVW, HGZIUOVVG DROO WL MLGSRMT")
                    HVOU.FHVIOLTTVI.DZIM( "gSV HVXSVWFOVW " + HGI(HVOU.GRNV_HOLG)+  " SZH ZOIVZWB KZHHVW, HGZIUOVVG DROO WL MLGSRMT")
                    HVOU.IFMMVW = gIFV

            HVOU.HBHGVN = TOLYZORMUL.HBHGVN
            HVOU.XOLXP = TOLYZORMUL.XOLXP
            HVOU.HBHGVN = TOLYZORMUL.HBHGVN
            HVOU.OLTTVI = TOLYZORMUL.OLTTVI
            HVOU.CNO = CNO
            # GIB GL URMW GSV FGIZWV
            HVOU.FHVIOLTTVI = FHVIOLT


        WVU ILOORMT_NVHHZTV(HVOU, GW,
                             GRNV_ORHG=[WZGVGRNV.GRNVWVOGZ(NRMFGVH=8),
                                        WZGVGRNV.GRNVWVOGZ(HVXLMWH=69),
                                        WZGVGRNV.GRNVWVOGZ(HVXLMWH=89),
                                        WZGVGRNV.GRNVWVOGZ(HVXLMWH=4)]):
            ULI GRNV RM GRNV_ORHG:
                RU  GRNV < GW < GRNV+WZGVGRNV.GRNVWVOGZ(HVXLMWH=7):
                    HVOU.OLTTVI.RMUL(HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " ZXGREZGRLM vgz: "+HGI(GRNV.HVXLMWH ) + " HVXLMWH")
                    HVOU.FHVIOLTTVI.RMUL(HVOU.FGIZWV.GZT + " "+HVOU.HGIZGVTB.RW + " ZXGREZGRLM vgz: "+HGI(GRNV.HVXLMWH ) + " HVXLMWH")



    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(xFHGLNqLYH, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.QLY_ORHG = {}
        # GSRH RH HGLIV KZGSH ZMW UROV HGZGH
        HVOU.QLY_CNOUROV = {}
        # RGVIZGV GSILFTS HFYQLYCNO GL ZXJFRIV ZOO KVLKOV'H HXSVXFOVH
        ULI CNOMLWV RM CNO.URMWZOO("QLYCNO"):
            KZGS = CNOMLWV.ZGGIRY["KZGS"]
            RU MLG  FYRJUROV.RH_UROV_VCRHG(KZGS):
                IZRHV eZOFVvIILI("XZMMLG URMW UROV "+KZGS)
            VOHV:
                FHVIMZNV = LH.KZGS.YZHVMZNV(KZGS)
                FHVIOLT = OLT.oLTTVI( LH.KZGS.YZHVMZNV(LH.KZGS.WRIMZNV(KZGS)), "rmul",  LH.KZGS.QLRM( LH.KZGS.WRIMZNV(KZGS),"HGZIUOVVG.OLT"))
                HVOU.QLY_CNOUROV[FHVIMZNV] = (KZGS, FYRJUROV.HGZG(KZGS) )
                HVOU.QLY_ORHG[FHVIMZNV] = []
                GIVV = VGIVV.KZIHV(KZGS)
                GVNK_CNOHVXGRLM =  GIVV.URMW("QLYH")
                RU OVM(GVNK_CNOHVXGRLM) > 9:
                    ULI QLY_CNO RM GVNK_CNOHVXGRLM.URMWZOO("QLY"):
                        HXS = xFHGLNqLYH.fHVIqLY(QLY_CNO, FHVIOLT, HVOU.TOLYZORMUL)
                        HVOU.QLY_ORHG[FHVIMZNV].ZKKVMW(HXS)
                        FHVIOLT.RMUL("QLY->[%H] OLZWVW", HXS.KILTIZN)


    WVU DLIP(HVOU):
        ULI FHVI RM HVOU.QLY_CNOUROV:
            FHVIKZGS = HVOU.QLY_CNOUROV[FHVI][9]
            MVDHGZG = FYRJUROV.HGZG(FHVIKZGS)
            LOWHGZG = HVOU.QLY_CNOUROV[FHVI][8]
            RU MVDHGZG.HG_RML != LOWHGZG.HG_RML LI MVDHGZG.HG_NGRNV != LOWHGZG.HG_NGRNV:
                FHVIMZNV = LH.KZGS.YZHVMZNV(LH.KZGS.WRIMZNV(FHVIKZGS))
                HVOU.QLY_CNOUROV[FHVI] = (FHVIKZGS, MVDHGZG)
                RU OVM(HVOU.QLY_ORHG[FHVI])>9:
                    FHVIOLT = HVOU.QLY_ORHG[FHVI][9].FHVIOLTTVI
                    HVOU.QLY_ORHG[FHVI] = []
                VOHV:
                    FHVIOLT = OLT.oLTTVI( FHVIMZNV, "rmul",  LH.KZGS.QLRM( LH.KZGS.WRIMZNV(FHVIKZGS),"HGZIUOVVG.OLT"))
                FHVIOLT.RMUL( "WVGVXGVW QLY XSZMTVW, IVOLZW "+FHVIMZNV )
                HVOU.OLTTVI.RMUL("WVGVXGVW QLY XSZMTVW, IVOLZW "+FHVIMZNV)
                GIVV = VGIVV.KZIHV(FHVIKZGS)
                GVNK_CNOHVXGRLM =  GIVV.URMW("QLYH")
                HVOU.QLY_ORHG[FHVI].XOVZI()
                RU OVM(GVNK_CNOHVXGRLM) > 9:
                    ULI QLY_CNO RM GVNK_CNOHVXGRLM.URMWZOO("QLY"):
                        HXS = xFHGLNqLYH.fHVIQLY(QLY_CNO, FHVIOLT, HVOU.TOLYZORMUL)
                        HVOU.QLY_ORHG[FHVI].ZKKVMW(HXS)
                        FHVIOLT.RMUL("QLY->[%H] OLZWVW", HXS.KILTIZN)


            # RU HVOU.QLY_CNOUROV[FHVIKZGS]


        ULI FHVI RM HVOU.QLY_ORHG:
            ULI QLY RM HVOU.QLY_ORHG[FHVI]:
                QLY.DLIP()
        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hSNnLMRGLI.KB
# XLWRMT: FGU-1

UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN HFYKILXVHH RNKLIG XZOO
UILN HFYKILXVHH RNKLIG kLKVM
UILN XLOOVXGRLMH RNKLIG WVUZFOGWRXG
RNKLIG HFYKILXVHH
RNKLIG HVOVXG
RNKLIG IV

RNKLIG FIOORY
RNKLIG FIOORY.IVJFVHG
RNKLIG FIOORY.VIILI
RNKLIG QHLM
RNKLIG GRNV
RNKLIG HBH
RNKLIG KKIRMG
RNKLIG XLWVXH
RNKLIG HNGKORY

UILN HJOZOXSVNB.LIN RNKLIG HXLKVW_HVHHRLM, HVHHRLMNZPVI
UILN HJOZOXSVNB RNKLIG FKWZGV
UILN FYRJKBZGZNLWVO RNKLIG NLWVO ZH WYNLWVO
UILN FYRJGLLO RNKLIG OLT

UILN VNZRO.NRNV.NFOGRKZIG RNKLIG nrnvnFOGRKZIG
UILN VNZRO.NRNV.GVCG RNKLIG nrnvgVCG

XOZHH hSNnLMRGLI(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hSNnLMRGLI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.HVIEVIH   = [C.HGIRK() ULI C RM CNO.ZGGIRY["HVIEVIH"].HKORG(',')]
        HVOU.GZT_MZNV  = CNO.ZGGIRY["GZT_MZNV"]

        HVOU.VMZYOV_DVXSZG = CNO.ZGGIRY.TVG("VMZYOV_DVXSZG", uZOHV)

        HVOU.OZHG_HVJ  = [9 ULI C RM HVOU.HVIEVIH]
        HVOU.KILXVHHVH = [mLMV ULI C RM HVOU.HVIEVIH]
        HVOU.HVOVXGH   = [mLMV ULI C RM HVOU.HVIEVIH]
        HVOU.DVXSZG = dVxSZG()
        HVOU.WZGZNTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.WY      = HVOU.WZGZNTI.VMTRMV
        HVOU.HLFIXV = CNO.ZGGIRY.TVG('HLFIXV', 'SYAJ6')
        HVOU.XSZMMVO_MZNV = 'ITIZGV'

    WVU IVHVG(HVOU):
        HVOU.WZGZNTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.WY      = HVOU.WZGZNTI.VMTRMV
        HVOU.gh = 9
    WVU DLIP(HVOU):
        HVHHRLM = HXLKVW_HVHHRLM(HVHHRLMNZPVI(YRMW=HVOU.WY))
        HVOU.RGVNH = []

        ULI MWC RM IZMTV(9, OVM(HVOU.HVIEVIH)):
            RU HVOU.KILXVHHVH[MWC] RH mLMV:
                HVOU.KILXVHHVH[MWC] = HFYKILXVHH.kLKVM(["/FHI/YRM/HHS", HVOU.HVIEVIH[MWC],  '/LKG/DLINSLOV/YRM/HLKSRZ-HVMW KGZMT_GVHG8'], HGWLFG=HFYKILXVHH.krkv,
                                                       HGWVII=HFYKILXVHH.krkv, YFUHRAV=899)
                HVOU.HVOVXGH[MWC] = HVOVXG.KLOO()
                HVOU.HVOVXGH[MWC].IVTRHGVI(HVOU.KILXVHHVH[MWC].HGWLFG)
            VOHV:
                XFII = HVOU.OZHG_HVJ[MWC]
                DSROV HVOU.HVOVXGH[MWC].KLOO(8):
                    ORMV = HVOU.KILXVHHVH[MWC].HGWLFG.IVZWORMV().WVXLWV('FGU-1')
                    NZGXS = IV.HVZIXS(I'NHTGBKV:\H(\W)', ORMV)

                    RU MLG NZGXS LI NZGXS.TILFK(8) != '8':
                        # HVOU.OLTTVI.RMUL("URMW RMXLNKOVGV NVHHZTV %H HLFIXV %H" % (ORMV, HVOU.HVIEVIH[MWC]))
                        XLMGRMFV
                    NZGXS = IV.HVZIXS(I'HVJ:\H(\W+)', ORMV)
                    XFII = RMG(NZGXS.TILFK(8))


                RU XFII - HVOU.OZHG_HVJ[MWC] < 899:
                    HVOU.OLTTVI.VIILI("%H WRHXLMMVXGVW, KIVE %W XFII %W" % (HVOU.HVIEVIH[MWC], HVOU.OZHG_HVJ[MWC], XFII))
                    # HVOU.HVMW_DVXSZG_DZIMRMT("%H HSN GIZMHUVI WRHXLMMVXGVW, KIVE %W XFII %W" % (HVOU.HVIEVIH[MWC], HVOU.OZHG_HVJ[MWC], XFII))
                VOHV:
                    HVOU.OLTTVI.WVYFT("%H ZOREV, KIVE %W XFII %W" % (HVOU.HVIEVIH[MWC], HVOU.OZHG_HVJ[MWC], XFII))
                HVOU.OZHG_HVJ[MWC] = XFII

                RU HVOU.HVIEVIH[MWC] == HVOU.HLFIXV:
                    HVOU.gh = XFII
                VOHV:
                    KIRMG('FKWZGV %H' % (HVOU.HVIEVIH[MWC]))
                    RGVN = WYNLWVO.wZGZgIZMHUVInLMRGLI()
                    RGVN.hLFIXVsLHG = HVOU.HLFIXV
                    RGVN.wVHGsLHG = HVOU.HVIEVIH[MWC]
                    RGVN.wVHGgh = XFII
                    RGVN.xSZMMVOmZNV = HVOU.XSZMMVO_MZNV
                    HVOU.RGVNH.ZKKVMW(RGVN)

        ULI RGVN RM HVOU.RGVNH:
            KIRMG("HZEV")
            RGVN.hLFIXVgh = HVOU.gh
            RGVN.hLFIXVgh = RGVN.wVHGgh
            HVHHRLM.NVITV(RGVN)
            HVHHRLM.UOFHS()
            HVHHRLM.XLNNRG()

    WVU HVMW_DVXSZG_DZIMRMT(HVOU, NVHHZTV):
        # NHT = ("nht: %H\M grnv: %H\M" % (NVHHZTV, GRNV.HGIUGRNV('%b-%N-%W %c', GRNV.OLXZOGRNV()))).VMXLWV('FGU-1')
        HVOU.DVXSZG.HVMW_NHT('8', NVHHZTV)

XOZHH dVxSZG(LYQVXG):

    WVU __RMRG__(HVOU, XLIKRW='', HVXIVG=''):

        HVOU.__FIO = 'SGGKH://JBZKR.DVRCRM.JJ.XLN/XTR-YRM/'

        RU XLIKRW:
            HVOU.__XLIKRW = XLIKRW
        VOHV:
            HVOU.__XLIKRW = 'DC3X925YVW7Y6XZ531'
        RU HVXIVG:
            HVOU.__HVXIVG = HVXIVG
        VOHV:
            HVOU.__HVXIVG = 'uf7E4cckyjrSLyou8OgH68mt0VJzeuj2IbmHDjre86H'


    # vHGZYORHS Z XLMMVXGRLM GL TVG GLPVM
    WVU TVGGLPVM(HVOU):

        KZIZNH = {'XLIKRW': HVOU.__XLIKRW, 'XLIKHVXIVG': HVOU.__HVXIVG}
        WZGZ = FIOORY.KZIHV.FIOVMXLWV(KZIZNH)
        FIO = HVOU.__FIO + 'TVGGLPVM?' + WZGZ

        GIB:
            IVHKLMHV = FIOORY.IVJFVHG.iVJFVHG(FIO)
        VCXVKG pVBvIILI:
            IZRHV pVBvIILI

        IVHFOG = FIOORY.IVJFVHG.FIOLKVM(IVHKLMHV)
        XLMGVMG = QHLM.OLZWH(IVHFOG.IVZW().WVXLWV('FGU1'))
        ZXXVHH_GLPVM = XLMGVMG['ZXXVHH_GLPVM']
        IVGFIM ZXXVHH_GLPVM

    WVU HVMW_NHT(HVOU, ZKKrw, NVHHZTV):

        RU ZKKrw:
            GLZTVMG = ZKKrw
        VOHV:
            GLZTVMG = ''

        WZGZ = QHLM.WFNKH({
            'GLFHVI': '@ZOO',
            'GLKZIGB': '',
            'GLGZT': '',
            'NHTGBKV': "GVCG",
            'ZTVMGRW': GLZTVMG,
            'GVCG': {
                'XLMGVMG': NVHHZTV
            },
            'HZUV': "9"
        }, VMHFIV_ZHXRR=uZOHV)

        FIO = HVOU.__FIO + 'NVHHZTV/HVMW?ZXXVHH_GLPVM=%H' % HVOU.TVGGLPVM()
        # KIRMG FIO
        IVJFVHG = FIOORY.IVJFVHG.iVJFVHG(FIO, WZGZ.VMXLWV('FGU1'))
        GIB:
                IVHFOG = FIOORY.IVJFVHG.FIOLKVM(IVJFVHG)
        VCXVKG FIOORY.VIILI.sggkvIILI ZH V:
                RU SZHZGGI(V, 'IVZHLM'):
                        KIRMG('IVZHLM', V.IVZHLM)
                VORU SZHZGGI(V, 'XLWV'):
                        KIRMG('XLWV', V.XLWV)
                IVGFIM 9
        VOHV:
                XLMGVMG = QHLM.OLZWH(IVHFOG.IVZW().WVXLWV('FGU1'))
                IVHFOG.XOLHV()
        # KIRMG XLMGVMG

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGLXPhVXFIRGBnZMZTVIiVZWB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

XOZHH hGLXPhVXFIRGBnZMZTVIiVZWB(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGLXPhVXFIRGBnZMZTVIiVZWB, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.HNX = HVOU.TOLYZORMUL.HNX
        HVOU.VIILINVHHZTV = ""

    WVU DLIP(HVOU):
        HVOU.VIILINVHHZTV = ""
        HGZGFH = gIFV
        XLFMG = OVM(HVOU.HNX.HGLXPRMUL_NZK)
        RU XLFMG < 7499:
            HVOU.VIILINVHHZTV += "RMUL XLFMG WRHNZGXS"
            HGZGFH = uZOHV
        IVGFIM  HGZGFH
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/xSVXPnZHHIVOZBvUUVXGREV.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM

XOZHH xSVXPnZHHIVOZBvUUVXGREV(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(xSVXPnZHHIVOZBvUUVXGREV, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XOLXP  = TOLYZO_RMUL.XOLXP

    WVU DLIP(HVOU):
        gyIVXE = HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.TVG_HFYVI('gyiVXEuRVOW')
        gyIVXEkIV = HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.TVG_HFYVI('gyiVXEuRVOWkIV')
        gyhGPIVXE = HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.TVG_HFYVI('gyhGPiVXEuRVOW')
        gyhGPIVXEkIV = HVOU.TOLYZO_RMUL.KFYHFY_NZMZTVI.TVG_HFYVI('gyhGPiVXEuRVOWkIV')
        RU gyIVXE.tVGrMWVC() != gyIVXEkIV.tVGrMWVC():
            HVOU.OLTTVI.VIILI('gyiVXE ZMW gyiVXEkIV NRHNZGXS')
            DZIM = HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.MVD_DZIMRMT()
            DZIM.OVEVO(4).NVHHZTV('gyiVXE ZMW gyiVXEkIV NRHNZGXS')

        RU gyhGPIVXE.tVGrMWVC() != gyhGPIVXEkIV.tVGrMWVC():
            HVOU.OLTTVI.VIILI('gyhGPiVXE ZMW gyhGPiVXEkIV NRHNZGXS')
            HVOU.OLTTVI.VIILI('gyiVXE ZMW gyiVXEkIV NRHNZGXS')
            DZIM = HVOU.TOLYZO_RMUL.DZIMRMT_NZMZTVI.MVD_DZIMRMT()
            DZIM.OVEVO(4).NVHHZTV('gyiVXE ZMW gyiVXEkIV NRHNZGXS')

        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/wVOLKOBfHRN.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")

# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
RNKLIG GZIUROV

WVU VCGIZXG_KZXPZTV(UROV, WRIVXGLIB):
    UO = GZIUROV.LKVM(UROV)
    UO.VCGIZXGZOO(WRIVXGLIB)
    UO.XOLHV()


XOZHH wVKOLBfHRN(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(wVKOLBfHRN, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.GZIUROV = CNO.ZGGIRY['GZIUROV']
        HVOU.WRIVXGLIB = CNO.ZGGIRY['WRIVXGLIB']

    WVU DLIP(HVOU):
        HVOU.OLTTVI.RMUL('%H IFMH LMXV'%HVOU.RW)
        VCGIZXG_KZXPZTV(HVOU.GZIUROV, HVOU.WRIVXGLIB)
        KIRMG(HVOU.RW)
        IVGFIM gIFV
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hGPhRTMZOdZGXSVI.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN HFYKILXVHH RNKLIG XZOO


XOZHH hGPhRTMZOdZGXSVI(lKVIZGRLM):
    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPhRTMZOdZGXSVI, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.KZGS   = CNO.ZGGIRY["KZGS"]

    WVU DLIP(HVOU):
        KIRMG("TLRMT GL VCVXFGV: " + HVOU.XNW)
        IVG = LH.HBHGVN(HVOU.XNW)
        KIRMG(IVG)
        IVGFIM IVG

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/hRTMZOlKVIZGRLMhRNKOB.KB
UILN YZHV.HGLXP_LKVIZGRLM RNKLIG hGPlKVIZGRLM
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
UILN HFYKILXVHH RNKLIG XZOO


XOZHH hGPhRTMZOwZGZkIVKZIZGRLM(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(hGPhRTMZOwZGZkIVKZIZGRLM, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XNW   = CNO.ZGGIRY["XNW"]

    WVU IVOLZW(HVOU):
        HFKVI(hGPhRTMZOwZGZkIVKZIZGRLM, HVOU).IVOLZW()

    WVU DLIP(HVOU):
        KIRMG("TLRMT GL VCVXFGV: " + HVOU.XNW)
        IVGFIM gIFV

//##**---------------- ./HGZIUOVVG/LKVIZGRLM/iRHPhGZGH.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN LH RNKLIG DZOP
RNKLIG XHE
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG TVGKZHH

XOZHH iRHPhGZGH(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(iRHPhGZGH, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.NTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.HJO = '''
hvg gizmhzxgrlm rhlozgrlm ovevo ivzw fmxlnnrggvw ;
IVKOZXV RMGL cGhGPyZHPVGlIWVIH (ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB, gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, gIZWRMTwZB)
 HVOVXG ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, hfn((N_MeLOFNVgLGZO + N_MeLOFNVgIZWVW) * N_WoRNRGkIRXV) ZH jFZMGRGB, hfn(N_MeLOFNVgIZWVW * N_WoRNRGkIRXV) ZH gIZWVWjFZMGRGB, xlfmg(*) ZH hFYlIWVImFN, NRM(N_IVXVREVWgRNV) ZH iVXVREVWgRNV, NZC(N_FKWZGVgRNV) ZH fKWZGVgRNV,MLD() ZH gh, xfiwzgv() ZH gIZWRMTwZB
   UILN cGhGPlIWVIH
  DSVIV N_HGIwZGV = xfiwzgv()
    ZMW N_HGIvCXSZMTVrw RM ('ha', 'hs')
  TILFK YB ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT
 SZERMT XLFMG(*) > 7;
xlnnrg ;
'''

    WVU DLIP(HVOU):
        HVOU.NTI.VMTRMV.VCVXFGV(HVOU.HJO)

# hvovxg ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB, gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, gIZWRMTwZB
#   uiln cGhGPyZHPVGlIWVIH
#  dsviv gIZWRMTwZB = xfiwzgv()



# hvovxg ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB,
#                                         gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, gIZWRMTwZB
#                                    uiln cGhGPyZHPVGlIWVIH
#                                   dsviv gIZWRMTwZB = xfiwzgv()


# hvovxg Y.kILWFXGrw, Z.ZXXLFMG, N_MxLNNZMWrw, N_MwRIVXGRLM, N_MlUUHVGuOZT, jFZMGRGB,
#                                         gIZWVWjFZMGRGB, hFYlIWVImFN, iVXVREVWgRNV, fKWZGVgRNV,gh, Z.gIZWRMTwZB
#                                    uiln cGhGPyZHPVGlIWVIH Z
#                                    qlrm kILWFXGH Y
#                                      LM Z.ZXXLFMG = Y.hGLXP_ZXXLFMG
#                                   dsviv Z.gIZWRMTwZB = xfiwzgv();




//##**---------------- ./HGZIUOVVG/LKVIZGRLM/lIWVIgIZUURXxLMGILO.KB
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/HGZIUOVVG")
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
RNKLIG KBKFYHFY ZH KY
RNKLIG WZGVGRNV
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM

XOZHH lIWVIgIZUURXxLMGILO(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(lIWVIgIZUURXxLMGILO, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.TOLYZORMUL = TOLYZO_RMUL
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI
        HVOU.XOLXP  = TOLYZO_RMUL.XOLXP
        HVOU.LIWVIUOLD = KY.gyrMKFGuRVOWhFYHXIRYVI()
        HVOU.LIWVI_RMW = HVOU.LIWVIUOLD.tVGrMWVC()
        HVOU.OZHG_XSVXP = HVOU.XOLXP.MLD
        HVOU.ORNRG = RMG(CNO.ZGGIRY["NZC_LIWVI_KVI_HVXLMW"])

    WVU DLIP(HVOU):
        RU HVOU.XOLXP.MLD-HVOU.OZHG_XSVXP > WZGVGRNV.GRNVWVOGZ(HVXLMWH=8):
            WRUU =HVOU.LIWVIUOLD.tVGrMWVC() - HVOU.LIWVI_RMW
            RU WRUU > HVOU.ORNRG:
                HVOU.OLTTVI.XIRGRXZO("[lIWVIgIZUURXxLMGILO]: LIWVI HKVVW VCXVVWH ORNRG %W>%W"%(WRUU, HVOU.ORNRG))
                HVOU.OLTTVI.DZIM("[lIWVIgIZUURXxLMGILO]: DROO PROO ZOO gy GL KILGVXG HBHGVN")
                ULI GY RM HVOU.TOLYZORMUL.HBHGVN.GY:
                    HVOU.OLTTVI.DZIM("--> HGZIUOVVG DROO PROO %H"%GY.KRW)
                    GY.PROO()
            HVOU.LIWVI_RMW = HVOU.LIWVIUOLD.tVGrMWVC()
            HVOU.OZHG_XSVXP = HVOU.XOLXP.MLD
        IVGFIM 9
//##**---------------- ./HGZIUOVVG/LKVIZGRLM/kLHRGRLMxLMHLORWZGRLM.KB
UILN YZHV.YZHV_LKVIZGRLM RNKLIG lKVIZGRLM
# UILN YZHV.YZHV_QLY RNKLIG qLY
RNKLIG HBH
evihrlm=""
DRGS LKVM("/RMX/EVIHRLM.RMX") ZH U:
    ORMVH = U.IVZWORMVH()
    evihrlm = ORMVH[9].HKORG('=')[8].HGIRK()
HBH.KZGS.ZKKVMW("/LKG/EVIHRLM/"+evihrlm+"/KBGSLM-ORYH")
# RNKLIG KBKFYHFY ZH KY
# RNKLIG SVOKVI.FGRO ZH FGRO
RNKLIG FYRJGLLO.UROV ZH FYRJUROV
RNKLIG WZGVGRNV
RNKLIG CNO.VGIVV.vOVNVMGgIVV ZH VGIVV
RNKLIG FYRJGLLO.OLT  ZH OLT
RNKLIG LH
UILN LH RNKLIG DZOP
RNKLIG XHE
RNKLIG FYRJKBZGZNLWVO.NLWVO ZH WYNLWVO
RNKLIG TVGKZHH

XOZHH kLHRGRLMxLMHLORWZGRLM(lKVIZGRLM):

    WVU __RMRG__(HVOU, CNO, TOLYZO_RMUL):
        HFKVI(kLHRGRLMxLMHLORWZGRLM, HVOU).__RMRG__(CNO, TOLYZO_RMUL)
        HVOU.OLTTVI = TOLYZO_RMUL.OLTTVI

        HVOU.XOLXP = TOLYZO_RMUL.XOLXP
        HVOU.NTI = WYNLWVO.wZGZnZMZTVI()
        HVOU.HJO = '''
IVKOZXV RMGL hGPhGIZGVTBkLHRGRLMxLMHLORWZGRLM (zXXLFMGrW, hGIZGVTBrW, gIZWRMTwZB, hGZGFH)
HVOVXG zXXLFMGrW, hGIZGVTBrW, gIZWRMTwZB, XZHV DSVM HFN(gIWeLO + bwkLH - kLH) = 9 GSVM 'kzhh' VOHV 'uzro' VMW ZH hGZGFH
UILN (
  HVOVXG Z.zXXLFMGrW, Z.hGIZGVTBrW, Z.rMHGIFNVMGrW,
       Z.gIZWRMTwZB,NRM(Y.gIZWRMTwZB) ZH kIVwZB, NRM(Z.oLMTkLHRGRLM) ZH kLH, NRM(Y.oLMTkLHRGRLM) ZH bwkLH,
       HFN(XZHV DSVM W.wRIVXGRLM = 9 GSVM X.gIZWVeLOFNV VOHV -8 * X.gIZWVeLOFNV VMW) ZH gIWeLO
    UILN hGPkLHRGRLMsRHG Z
    QLRM hGPkLHRGRLMsRHG Y LM Z.zXXLFMGrW = Y.zXXLFMGrW ZMW Z.hGIZGVTBrW = Y.hGIZGVTBrW ZMW Z.rMHGIFNVMGrW = Y.rMHGIFNVMGrW
    QLRM hGPgIZWVH X LM Z.zXXLFMGrW = X.zXXLFMGrW ZMW Z.gIZWRMTwZB = X.gIZWRMTwZB ZMW Z.rMHGIFNVMGrW = X.rMHGIFNVMGrW
    QLRM hGPlIWVIH W LM X.zXXLFMGrW = W.zXXLFMGrW ZMW X.hGIZGVTBrW = W.hGIZGVTBrW ZMW X.lIWVIrw = W.lIWVIrw ZMW X.rMHGIFNVMGrW = W.rMHGIFNVMGrW ZMW X.gIZWRMTwZB = W.gIZWRMTwZB
   DSVIV Z.gIZWRMTwZB = %(GIZWRMT_WZB)H
     ZMW Y.gIZWRMTwZB = %(KIVE_GIZWRMT_WZB)H
     ZMW Z.rMHGIFNVMGrW != '795998.hhv'
   TILFK YB Z.zXXLFMGrW, Z.hGIZGVTBrW, Z.rMHGIFNVMGrW, Z.gIZWRMTwZB
) G
TILFK YB zXXLFMGrW, hGIZGVTBrW, gIZWRMTwZB;
'''

    WVU DLIP(HVOU):
        KIVE_WZB_HGI = HGI(HVOU.XOLXP.KIVE_GIZWRMT_WZB)
        WZB_HGI = HGI(HVOU.XOLXP.GIZWRMT_WZB)
        KIRMG("FKWZGV KIVE: %H MLD: %H" % (KIVE_WZB_HGI, WZB_HGI))
        HVOU.NTI.VMTRMV.VCVXFGV(HVOU.HJO, {'GIZWRMT_WZB': WZB_HGI, 'KIVE_GIZWRMT_WZB': KIVE_WZB_HGI})
//##**---------------- ./HGZIUOVVG/EVIHRLM.HS
EVIHRLM=
YFROW=
HSLD=
FKWZGV=
ZWW=
YFROW=
NZPV=
KFOO=
KFHS=
TRGHSLD=
TRGFKWZGV=

XSZMTVOLT=$(WRIMZNV $9)/xSZMTVoLT


DSROV TVGLKGH "HYZSFINKGTA" LKG;
WL
  XZHV "$LKG" RM
    H) HSLD="B"
      ;;
    Y) YFROW="B"
      ;;
    S) VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G/T/A"
       VXSL "-H: HSLD XFIIVMG EVIHRLM"
       VXSL "-Z LI -I: ZWW LI IVOVZHV Z MVD EVIHRLM"
       VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
       VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
       VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
       VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
       VXSL "-T: HSLD TRG SVZW"
       VXSL "-A: FKWZGV TRG SVZW"
       VCRG 8
       ;;
    Z) ZWW="B"
      ;;
    F) FKWZGV="B"
      ;;
    I) ZWW="B"
      ;;
    N) NZPV="B"
      ;;
    K) KFOO="B"
      ;;
    G) KFHS="B"
      ;;
    T) TRGHSLD="B"
      ;;
    A) TRGFKWZGV="B"
      ;;
  VHZX
WLMV

RU [[ -A $ZWW ]] && [[ -A $TRGHSLD ]] && [[ -A $TRGFKWZGV ]]  && [[ -A $FKWZGV ]] && [[ -A $HSLD ]] && [[ -A $YFROW ]] && [[ -A $NZPV ]] && [[ -A $KFHS ]] && [[ -A $KFOO  ]]
GSVM
    VXSL "fHZTV: ./EVIHRLM.HS -H/Z/I/F/K/G"
    VXSL "-H: HSLD XFIIVMG IVOVZHV EVIHRLM"
    VXSL "-Z LI -I : ZWW LI IVOVZHV Z MVD EVIHRLM"
    VXSL "-Y: HSLD XFIIVMG YFROW EVIHRLM"
    VXSL "-F: FKWZGV ZOO UROVH DRGS GSV NLHG FKWZGVW EVIHRLM"
    VXSL "-N: FKWZGV YFROW ML, *GSRH HSLFOW MLG YV XZOOVW NZMFZOOB*"
    VXSL "-K: FKWZGV NLMHGVI RMUIZHGIFXGFIV"
    VXSL "-T: ZXJFRIV TRG SVZW"
    VXSL "-A: FKWZGV TRG SVZW"
    VXSL "-G: KFHS HFYGIVV YZXP GL DZIVSLFHV"
    VCRG 8
UR

ORMV_MFN=9

DSROV IVZW ORMV
WL
  ORMV_MFN=$((ORMV_MFN+8))
  MZNV=$(VXSL $ORMV|GI -H " ")
  URIHG_XSZIZXGVI=${MZNV:9:8}
  RU [ "$URIHG_XSZIZXGVI" == "@" ];GSVM
    MZNV=${MZNV:7:${#MZNV}-6}
    EVIHRLM=$MZNV
    YIVZP
  VORU [ "$URIHG_XSZIZXGVI" == "%" ];GSVM
    MZNV=${MZNV:2:${#MZNV}-1}
    YFROWML=$MZNV
  UR
WLMV < $XSZMTVOLT

RU [[ ! -A $HSLD ]]; GSVM
  KIRMGU $EVIHRLM
  VCRG 9
UR


RU [[ ! -A $YFROW ]]; GSVM
  KIRMGU $YFROWML
  VCRG 9
UR

RU [[ ! -A $TRGFKWZGV ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  HVW -R "/trgsvzw/X\trgsvzw=$ts" .KZIZ.RMX
  VCRG 9
UR


RU [[ ! -A $TRGHSLD ]]; GSVM
  ts=$(TRG OLT -8 --ULINZG="%S")
  VXSL trgsvzw=$ts
  VCRG 9
UR


RU [[ ! -A $KFOO ]]; GSVM
  TRG HFYNLWFOV FKWZGV --IVNLGV
  VCRG 9
UR


RU [[ ! -A $KFHS ]]; GSVM
  TRG KFHS --IVXFIHV-HFYNLWFOVH=XSVXP
  VCRG 9
UR


RU [[ ! -A $NZPV  ]]; GSVM
    YFROW_RMG=${YFROWML:0:${#YFROWML}-0}
    YFROW_WG=${YFROWML:9:${#YFROWML}-4}
    (( YFROW_RMG = 89#$YFROW_RMG + 8 ))
    GLWZB=`WZGV +%b%N%W`
    YFROW_RMG=$(KIRMGU "%95W" $YFROW_RMG)
    RU [ "$YFROW_WG" -VJ "$GLWZB"  ]; GSVM
        YFROWML=$YFROW_WG-$YFROW_RMG
    VOHV
        YFROWML=$GLWZB-9998
    UR
    HVW -R "H/.*yfrow.*/%yfrow[$YFROWML]/" $XSZMTVOLT
    KIRMGU $YFROWML
    VCRG 9
UR


NLWRURVW=$(WZGV +%b-%N-%W)

BVOOLD='\966[8;66N'
mx='\966[9N'

RU [[ ! -A $ZWW ]]; GSVM
  KIRMGU "iVOVZHRMT Z MVD EVIHRLM, GSV NLHG IVXVMG EVIHRLM RH ${BVOOLD}$EVIHRLM${mx}:\M"
  IVZW -K "mVD EVIHRLM ml: " MVDEVIHRLM
  IVZW -K "mVD EVIHRLM MZNV: " EVIHRLMMZNV
  IVZW -K "mVD EVIHRLM YIRVU: " YIRVU
  HVW -R "${ORMV_MFN}R\\
@[$MVDEVIHRLM]\M# $NLWRURVW\M## $EVIHRLMMZNV \M- $YIRVU\M\\
    " $XSZMTVOLT
  VXSL "xSZMTVoLT FKWZGVW, MVD EVIHRLM $MVDEVIHRLM RMHVIGVW"
  VCRG 9
UR

RU [[ ! -A $FKWZGV ]]; GSVM
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L  -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\EVIHRLM.*/\* \\\EVIHRLM   $EVIHRLM/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\NLWRURVW.*/\* \\\NLWRURVW  $NLWRURVW/"
    URMW . -GBKV W \( -KZGS ./NLMHGVI -L -KZGS ./.TRG -L -KZGS ./ORY \) -KIFMV -L -GBKV U -KIRMG9 | CZITH -9 HVW -R -V "H/\*\H\\\kilqvxg_mfnyvi.*/\* \\\kilqvxg_mfnyvi=$NLWRURVW/"
    VXSL "eVIHRLM ml RM ZOO UROVH FKWZGVW"
UR

//##**---------------- ./HGZIUOVVG/xSZMTVoLT
kilqvxg: HGZIUOVVG
zfgsli: YUZM
xivzgvw: 7982-95-88


# xSZMTV oLT
zOO MLGZYOV XSZMTVH GL GSRH KILQVXG DROO YV WLXFNVMGVW RM GSRH UROV.
fHFZOOB VZXS RGVN RH ZWSVIVW GL LMV IVOVZHV MFNYVI XSZMTV

%yfrow[79819687-9997]


@[9.9.8]
# 7982-95-88
## KILQVXG RH RMRGRZOAVW
- KILQVXG RMRGRZORAVW, GSRH HSLFOW YV GSV *EVIB* URIHG EVIHRLM
